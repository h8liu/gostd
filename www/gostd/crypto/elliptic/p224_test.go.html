<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6990122">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6990178">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6990232">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6990283">package</span>&nbsp;<span class="ident" id="6990291">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6990301">import</span>&nbsp;<span class="op" id="6990308">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990311">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990323">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6990333">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6990336">var</span>&nbsp;<span class="ident" id="6990340">toFromBigTests</span>&nbsp;<span class="op" id="6990355">=</span>&nbsp;<span class="op" id="6990357">[</span><span class="op" id="6990358">]</span><span class="builtintype" id="6990359">string</span><span class="op" id="6990365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990368">&#34;0&#34;</span><span class="op" id="6990371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990374">&#34;1&#34;</span><span class="op" id="6990377">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990380">&#34;23&#34;</span><span class="op" id="6990384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990387">&#34;b70e0cb46bb4bf7f321390b94a03c1d356c01122343280d6105c1d21&#34;</span><span class="op" id="6990445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6990448">&#34;706a46d476dcb76798e6046d89474788d164c18032d268fd10704fa6&#34;</span><span class="op" id="6990506">,</span><br>
<span class="lineno"></span><span class="op" id="6990508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="6990511">func</span>&nbsp;<span class="ident" id="6990516">p224AlternativeToBig</span><span class="op" id="6990536">(</span><span class="ident" id="6990537">in</span>&nbsp;<span class="op" id="6990540">*</span><span class="ident" id="6990541">p224FieldElement</span><span class="op" id="6990557">)</span>&nbsp;<span class="op" id="6990559">*</span><span class="ident" id="6990560">big</span><span class="op" id="6990563">.</span><span class="ident" id="6990564">Int</span>&nbsp;<span class="op" id="6990568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6990571">ret</span>&nbsp;<span class="op" id="6990575">:=</span>&nbsp;<span class="builtinfunc" id="6990578">new</span><span class="op" id="6990581">(</span><span class="ident" id="6990582">big</span><span class="op" id="6990585">.</span><span class="ident" id="6990586">Int</span><span class="op" id="6990589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6990592">tmp</span>&nbsp;<span class="op" id="6990596">:=</span>&nbsp;<span class="builtinfunc" id="6990599">new</span><span class="op" id="6990602">(</span><span class="ident" id="6990603">big</span><span class="op" id="6990606">.</span><span class="ident" id="6990607">Int</span><span class="op" id="6990610">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6990614">for</span>&nbsp;<span class="ident" id="6990618">i</span>&nbsp;<span class="op" id="6990620">:=</span>&nbsp;<span class="builtintype" id="6990623">uint</span><span class="op" id="6990627">(</span><span class="num" id="6990628">0</span><span class="op" id="6990629">)</span><span class="op" id="6990630">;</span>&nbsp;<span class="ident" id="6990632">i</span>&nbsp;<span class="op" id="6990634">&lt;</span>&nbsp;<span class="num" id="6990636">8</span><span class="op" id="6990637">;</span>&nbsp;<span class="ident" id="6990639">i</span><span class="op" id="6990640">++</span>&nbsp;<span class="op" id="6990643">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6990647">tmp</span><span class="op" id="6990650">.</span><span class="ident" id="6990651">SetInt64</span><span class="op" id="6990659">(</span><span class="ident" id="6990660">int64</span><span class="op" id="6990665">(</span><span class="ident" id="6990666">in</span><span class="op" id="6990668">[</span><span class="ident" id="6990669">i</span><span class="op" id="6990670">]</span><span class="op" id="6990671">)</span><span class="op" id="6990672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6990676">tmp</span><span class="op" id="6990679">.</span><span class="ident" id="6990680">Lsh</span><span class="op" id="6990683">(</span><span class="ident" id="6990684">tmp</span><span class="op" id="6990687">,</span>&nbsp;<span class="num" id="6990689">28</span><span class="op" id="6990691">*</span><span class="ident" id="6990692">i</span><span class="op" id="6990693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6990697">ret</span><span class="op" id="6990700">.</span><span class="ident" id="6990701">Add</span><span class="op" id="6990704">(</span><span class="ident" id="6990705">ret</span><span class="op" id="6990708">,</span>&nbsp;<span class="ident" id="6990710">tmp</span><span class="op" id="6990713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6990716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6990719">ret</span><span class="op" id="6990722">.</span><span class="ident" id="6990723">Mod</span><span class="op" id="6990726">(</span><span class="ident" id="6990727">ret</span><span class="op" id="6990730">,</span>&nbsp;<span class="ident" id="6990732">p224</span><span class="op" id="6990736">.</span><span class="ident" id="6990737">P</span><span class="op" id="6990738">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6990741">return</span>&nbsp;<span class="ident" id="6990748">ret</span><br>
<span class="lineno"></span><span class="op" id="6990752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6990755">func</span>&nbsp;<span class="ident" id="6990760">TestToFromBig</span><span class="op" id="6990773">(</span><span class="ident" id="6990774">t</span>&nbsp;<span class="op" id="6990776">*</span><span class="ident" id="6990777">testing</span><span class="op" id="6990784">.</span><span class="ident" id="6990785">T</span><span class="op" id="6990786">)</span>&nbsp;<span class="op" id="6990788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6990791">for</span>&nbsp;<span class="ident" id="6990795">i</span><span class="op" id="6990796">,</span>&nbsp;<span class="ident" id="6990798">test</span>&nbsp;<span class="op" id="6990803">:=</span>&nbsp;<span class="keyword" id="6990806">range</span>&nbsp;<span class="ident" id="6990812">toFromBigTests</span>&nbsp;<span class="op" id="6990827">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6990831">n</span><span class="op" id="6990832">,</span>&nbsp;<span class="ident" id="6990834">_</span>&nbsp;<span class="op" id="6990836">:=</span>&nbsp;<span class="builtinfunc" id="6990839">new</span><span class="op" id="6990842">(</span><span class="ident" id="6990843">big</span><span class="op" id="6990846">.</span><span class="ident" id="6990847">Int</span><span class="op" id="6990850">)</span><span class="op" id="6990851">.</span><span class="ident" id="6990852">SetString</span><span class="op" id="6990861">(</span><span class="ident" id="6990862">test</span><span class="op" id="6990866">,</span>&nbsp;<span class="num" id="6990868">16</span><span class="op" id="6990870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6990874">var</span>&nbsp;<span class="ident" id="6990878">x</span>&nbsp;<span class="ident" id="6990880">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6990899">p224FromBig</span><span class="op" id="6990910">(</span><span class="op" id="6990911">&amp;</span><span class="ident" id="6990912">x</span><span class="op" id="6990913">,</span>&nbsp;<span class="ident" id="6990915">n</span><span class="op" id="6990916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6990920">m</span>&nbsp;<span class="op" id="6990922">:=</span>&nbsp;<span class="ident" id="6990925">p224ToBig</span><span class="op" id="6990934">(</span><span class="op" id="6990935">&amp;</span><span class="ident" id="6990936">x</span><span class="op" id="6990937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6990941">if</span>&nbsp;<span class="ident" id="6990944">n</span><span class="op" id="6990945">.</span><span class="ident" id="6990946">Cmp</span><span class="op" id="6990949">(</span><span class="ident" id="6990950">m</span><span class="op" id="6990951">)</span>&nbsp;<span class="op" id="6990953">!=</span>&nbsp;<span class="num" id="6990956">0</span>&nbsp;<span class="op" id="6990958">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6990963">t</span><span class="op" id="6990964">.</span><span class="ident" id="6990965">Errorf</span><span class="op" id="6990971">(</span><span class="string" id="6990972">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&#34;</span><span class="op" id="6990987">,</span>&nbsp;<span class="ident" id="6990989">i</span><span class="op" id="6990990">,</span>&nbsp;<span class="ident" id="6990992">n</span><span class="op" id="6990993">,</span>&nbsp;<span class="ident" id="6990995">m</span><span class="op" id="6990996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6991000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991004">q</span>&nbsp;<span class="op" id="6991006">:=</span>&nbsp;<span class="ident" id="6991009">p224AlternativeToBig</span><span class="op" id="6991029">(</span><span class="op" id="6991030">&amp;</span><span class="ident" id="6991031">x</span><span class="op" id="6991032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6991036">if</span>&nbsp;<span class="ident" id="6991039">n</span><span class="op" id="6991040">.</span><span class="ident" id="6991041">Cmp</span><span class="op" id="6991044">(</span><span class="ident" id="6991045">q</span><span class="op" id="6991046">)</span>&nbsp;<span class="op" id="6991048">!=</span>&nbsp;<span class="num" id="6991051">0</span>&nbsp;<span class="op" id="6991053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6991058">t</span><span class="op" id="6991059">.</span><span class="ident" id="6991060">Errorf</span><span class="op" id="6991066">(</span><span class="string" id="6991067">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&nbsp;(alternative)&#34;</span><span class="op" id="6991096">,</span>&nbsp;<span class="ident" id="6991098">i</span><span class="op" id="6991099">,</span>&nbsp;<span class="ident" id="6991101">n</span><span class="op" id="6991102">,</span>&nbsp;<span class="ident" id="6991104">m</span><span class="op" id="6991105">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6991109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6991112">}</span><br>
<span class="lineno"></span><span class="op" id="6991114">}</span>
</div>
</body>
</html>
