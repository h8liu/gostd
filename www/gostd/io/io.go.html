<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>io</h2>
<ul>
<li><a href="/gostd/io/io.go.html">io.go</a></li>
<li><a href="/gostd/io/io_test.go.html">io_test.go</a></li>
<li><a href="/gostd/io/multi.go.html">multi.go</a></li>
<li><a href="/gostd/io/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/io/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/io/pipe_test.go.html">pipe_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1408519">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1408574">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1408628">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1408679">//&nbsp;Package&nbsp;io&nbsp;provides&nbsp;basic&nbsp;interfaces&nbsp;to&nbsp;I/O&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1408738">//&nbsp;Its&nbsp;primary&nbsp;job&nbsp;is&nbsp;to&nbsp;wrap&nbsp;existing&nbsp;implementations&nbsp;of&nbsp;such&nbsp;primitives,</span><br>
<span class="lineno"></span><span class="comment" id="1408813">//&nbsp;such&nbsp;as&nbsp;those&nbsp;in&nbsp;package&nbsp;os,&nbsp;into&nbsp;shared&nbsp;public&nbsp;interfaces&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1408880">//&nbsp;abstract&nbsp;the&nbsp;functionality,&nbsp;plus&nbsp;some&nbsp;other&nbsp;related&nbsp;primitives.</span><br>
<span class="lineno"></span><span class="comment" id="1408947">//</span><br>
<span class="lineno">10</span><span class="comment" id="1408950">//&nbsp;Because&nbsp;these&nbsp;interfaces&nbsp;and&nbsp;primitives&nbsp;wrap&nbsp;lower-level&nbsp;operations&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1409026">//&nbsp;various&nbsp;implementations,&nbsp;unless&nbsp;otherwise&nbsp;informed&nbsp;clients&nbsp;should&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="1409099">//&nbsp;assume&nbsp;they&nbsp;are&nbsp;safe&nbsp;for&nbsp;parallel&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="1409147">package</span>&nbsp;<span class="ident" id="1409155">io</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1409159">import</span>&nbsp;<span class="op" id="1409166">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1409169">&#34;errors&#34;</span><br>
<span class="lineno"></span><span class="op" id="1409178">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1409181">//&nbsp;ErrShortWrite&nbsp;means&nbsp;that&nbsp;a&nbsp;write&nbsp;accepted&nbsp;fewer&nbsp;bytes&nbsp;than&nbsp;requested</span><br>
<span class="lineno">20</span><span class="comment" id="1409253">//&nbsp;but&nbsp;failed&nbsp;to&nbsp;return&nbsp;an&nbsp;explicit&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="1409296">var</span>&nbsp;<span class="ident" id="1409300">ErrShortWrite</span>&nbsp;<span class="op" id="1409314">=</span>&nbsp;<span class="ident" id="1409316">errors</span><span class="op" id="1409322">.</span><span class="ident" id="1409323">New</span><span class="op" id="1409326">(</span><span class="string" id="1409327">&#34;short&nbsp;write&#34;</span><span class="op" id="1409340">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1409343">//&nbsp;ErrShortBuffer&nbsp;means&nbsp;that&nbsp;a&nbsp;read&nbsp;required&nbsp;a&nbsp;longer&nbsp;buffer&nbsp;than&nbsp;was&nbsp;provided.</span><br>
<span class="lineno"></span><span class="keyword" id="1409423">var</span>&nbsp;<span class="ident" id="1409427">ErrShortBuffer</span>&nbsp;<span class="op" id="1409442">=</span>&nbsp;<span class="ident" id="1409444">errors</span><span class="op" id="1409450">.</span><span class="ident" id="1409451">New</span><span class="op" id="1409454">(</span><span class="string" id="1409455">&#34;short&nbsp;buffer&#34;</span><span class="op" id="1409469">)</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1409472">//&nbsp;EOF&nbsp;is&nbsp;the&nbsp;error&nbsp;returned&nbsp;by&nbsp;Read&nbsp;when&nbsp;no&nbsp;more&nbsp;input&nbsp;is&nbsp;available.</span><br>
<span class="lineno"></span><span class="comment" id="1409542">//&nbsp;Functions&nbsp;should&nbsp;return&nbsp;EOF&nbsp;only&nbsp;to&nbsp;signal&nbsp;a&nbsp;graceful&nbsp;end&nbsp;of&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1409613">//&nbsp;If&nbsp;the&nbsp;EOF&nbsp;occurs&nbsp;unexpectedly&nbsp;in&nbsp;a&nbsp;structured&nbsp;data&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="1409676">//&nbsp;the&nbsp;appropriate&nbsp;error&nbsp;is&nbsp;either&nbsp;ErrUnexpectedEOF&nbsp;or&nbsp;some&nbsp;other&nbsp;error</span><br>
<span class="lineno">30</span><span class="comment" id="1409748">//&nbsp;giving&nbsp;more&nbsp;detail.</span><br>
<span class="lineno"></span><span class="keyword" id="1409771">var</span>&nbsp;<span class="ident" id="1409775">EOF</span>&nbsp;<span class="op" id="1409779">=</span>&nbsp;<span class="ident" id="1409781">errors</span><span class="op" id="1409787">.</span><span class="ident" id="1409788">New</span><span class="op" id="1409791">(</span><span class="string" id="1409792">&#34;EOF&#34;</span><span class="op" id="1409797">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1409800">//&nbsp;ErrUnexpectedEOF&nbsp;means&nbsp;that&nbsp;EOF&nbsp;was&nbsp;encountered&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1409858">//&nbsp;middle&nbsp;of&nbsp;reading&nbsp;a&nbsp;fixed-size&nbsp;block&nbsp;or&nbsp;data&nbsp;structure.</span><br>
<span class="lineno">35</span><span class="keyword" id="1409917">var</span>&nbsp;<span class="ident" id="1409921">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="1409938">=</span>&nbsp;<span class="ident" id="1409940">errors</span><span class="op" id="1409946">.</span><span class="ident" id="1409947">New</span><span class="op" id="1409950">(</span><span class="string" id="1409951">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="1409967">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1409970">//&nbsp;ErrNoProgress&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;clients&nbsp;of&nbsp;an&nbsp;io.Reader&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="1410036">//&nbsp;many&nbsp;calls&nbsp;to&nbsp;Read&nbsp;have&nbsp;failed&nbsp;to&nbsp;return&nbsp;any&nbsp;data&nbsp;or&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="1410099">//&nbsp;usually&nbsp;the&nbsp;sign&nbsp;of&nbsp;a&nbsp;broken&nbsp;io.Reader&nbsp;implementation.</span><br>
<span class="lineno">40</span><span class="keyword" id="1410157">var</span>&nbsp;<span class="ident" id="1410161">ErrNoProgress</span>&nbsp;<span class="op" id="1410175">=</span>&nbsp;<span class="ident" id="1410177">errors</span><span class="op" id="1410183">.</span><span class="ident" id="1410184">New</span><span class="op" id="1410187">(</span><span class="string" id="1410188">&#34;multiple&nbsp;Read&nbsp;calls&nbsp;return&nbsp;no&nbsp;data&nbsp;or&nbsp;error&#34;</span><span class="op" id="1410233">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1410236">//&nbsp;Reader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1410297">//</span><br>
<span class="lineno"></span><span class="comment" id="1410300">//&nbsp;Read&nbsp;reads&nbsp;up&nbsp;to&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">45</span><span class="comment" id="1410373">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.&nbsp;&nbsp;Even&nbsp;if&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="1410441">//&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch&nbsp;space&nbsp;during&nbsp;the&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1410518">//&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,&nbsp;Read&nbsp;conventionally</span><br>
<span class="lineno"></span><span class="comment" id="1410589">//&nbsp;returns&nbsp;what&nbsp;is&nbsp;available&nbsp;instead&nbsp;of&nbsp;waiting&nbsp;for&nbsp;more.</span><br>
<span class="lineno"></span><span class="comment" id="1410647">//</span><br>
<span class="lineno">50</span><span class="comment" id="1410650">//&nbsp;When&nbsp;Read&nbsp;encounters&nbsp;an&nbsp;error&nbsp;or&nbsp;end-of-file&nbsp;condition&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="1410714">//&nbsp;successfully&nbsp;reading&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes,&nbsp;it&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1410776">//&nbsp;bytes&nbsp;read.&nbsp;&nbsp;It&nbsp;may&nbsp;return&nbsp;the&nbsp;(non-nil)&nbsp;error&nbsp;from&nbsp;the&nbsp;same&nbsp;call</span><br>
<span class="lineno"></span><span class="comment" id="1410845">//&nbsp;or&nbsp;return&nbsp;the&nbsp;error&nbsp;(and&nbsp;n&nbsp;==&nbsp;0)&nbsp;from&nbsp;a&nbsp;subsequent&nbsp;call.</span><br>
<span class="lineno"></span><span class="comment" id="1410905">//&nbsp;An&nbsp;instance&nbsp;of&nbsp;this&nbsp;general&nbsp;case&nbsp;is&nbsp;that&nbsp;a&nbsp;Reader&nbsp;returning</span><br>
<span class="lineno">55</span><span class="comment" id="1410968">//&nbsp;a&nbsp;non-zero&nbsp;number&nbsp;of&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;stream&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="1411033">//&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.&nbsp;&nbsp;The&nbsp;next&nbsp;Read&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="1411098">//&nbsp;return&nbsp;0,&nbsp;EOF&nbsp;regardless.</span><br>
<span class="lineno"></span><span class="comment" id="1411127">//</span><br>
<span class="lineno"></span><span class="comment" id="1411130">//&nbsp;Callers&nbsp;should&nbsp;always&nbsp;process&nbsp;the&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;bytes&nbsp;returned&nbsp;before</span><br>
<span class="lineno">60</span><span class="comment" id="1411195">//&nbsp;considering&nbsp;the&nbsp;error&nbsp;err.&nbsp;&nbsp;Doing&nbsp;so&nbsp;correctly&nbsp;handles&nbsp;I/O&nbsp;errors</span><br>
<span class="lineno"></span><span class="comment" id="1411264">//&nbsp;that&nbsp;happen&nbsp;after&nbsp;reading&nbsp;some&nbsp;bytes&nbsp;and&nbsp;also&nbsp;both&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1411325">//&nbsp;allowed&nbsp;EOF&nbsp;behaviors.</span><br>
<span class="lineno"></span><span class="comment" id="1411351">//</span><br>
<span class="lineno"></span><span class="comment" id="1411354">//&nbsp;Implementations&nbsp;of&nbsp;Read&nbsp;are&nbsp;discouraged&nbsp;from&nbsp;returning&nbsp;a</span><br>
<span class="lineno">65</span><span class="comment" id="1411414">//&nbsp;zero&nbsp;byte&nbsp;count&nbsp;with&nbsp;a&nbsp;nil&nbsp;error,&nbsp;except&nbsp;when&nbsp;len(p)&nbsp;==&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1411476">//&nbsp;Callers&nbsp;should&nbsp;treat&nbsp;a&nbsp;return&nbsp;of&nbsp;0&nbsp;and&nbsp;nil&nbsp;as&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1411541">//&nbsp;nothing&nbsp;happened;&nbsp;in&nbsp;particular&nbsp;it&nbsp;does&nbsp;not&nbsp;indicate&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1411602">//</span><br>
<span class="lineno"></span><span class="comment" id="1411605">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno">70</span><span class="keyword" id="1411643">type</span>&nbsp;<span class="ident" id="1411648">Reader</span>&nbsp;<span class="keyword" id="1411655">interface</span>&nbsp;<span class="op" id="1411665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1411668">Read</span><span class="op" id="1411672">(</span><span class="ident" id="1411673">p</span>&nbsp;<span class="op" id="1411675">[</span><span class="op" id="1411676">]</span><span class="builtintype" id="1411677">byte</span><span class="op" id="1411681">)</span>&nbsp;<span class="op" id="1411683">(</span><span class="ident" id="1411684">n</span>&nbsp;<span class="builtintype" id="1411686">int</span><span class="op" id="1411689">,</span>&nbsp;<span class="ident" id="1411691">err</span>&nbsp;<span class="builtintype" id="1411695">error</span><span class="op" id="1411700">)</span><br>
<span class="lineno"></span><span class="op" id="1411702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1411705">//&nbsp;Writer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">75</span><span class="comment" id="1411767">//</span><br>
<span class="lineno"></span><span class="comment" id="1411770">//&nbsp;Write&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="1411837">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno"></span><span class="comment" id="1411905">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1411971">//&nbsp;Write&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno">80</span><span class="comment" id="1412034">//&nbsp;Write&nbsp;must&nbsp;not&nbsp;modify&nbsp;the&nbsp;slice&nbsp;data,&nbsp;even&nbsp;temporarily.</span><br>
<span class="lineno"></span><span class="comment" id="1412093">//</span><br>
<span class="lineno"></span><span class="comment" id="1412096">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1412134">type</span>&nbsp;<span class="ident" id="1412139">Writer</span>&nbsp;<span class="keyword" id="1412146">interface</span>&nbsp;<span class="op" id="1412156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1412159">Write</span><span class="op" id="1412164">(</span><span class="ident" id="1412165">p</span>&nbsp;<span class="op" id="1412167">[</span><span class="op" id="1412168">]</span><span class="builtintype" id="1412169">byte</span><span class="op" id="1412173">)</span>&nbsp;<span class="op" id="1412175">(</span><span class="ident" id="1412176">n</span>&nbsp;<span class="builtintype" id="1412178">int</span><span class="op" id="1412181">,</span>&nbsp;<span class="ident" id="1412183">err</span>&nbsp;<span class="builtintype" id="1412187">error</span><span class="op" id="1412192">)</span><br>
<span class="lineno">85</span><span class="op" id="1412194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1412197">//&nbsp;Closer&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Close&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1412259">//</span><br>
<span class="lineno"></span><span class="comment" id="1412262">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Close&nbsp;after&nbsp;the&nbsp;first&nbsp;call&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">90</span><span class="comment" id="1412322">//&nbsp;Specific&nbsp;implementations&nbsp;may&nbsp;document&nbsp;their&nbsp;own&nbsp;behavior.</span><br>
<span class="lineno"></span><span class="keyword" id="1412383">type</span>&nbsp;<span class="ident" id="1412388">Closer</span>&nbsp;<span class="keyword" id="1412395">interface</span>&nbsp;<span class="op" id="1412405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1412408">Close</span><span class="op" id="1412413">(</span><span class="op" id="1412414">)</span>&nbsp;<span class="builtintype" id="1412416">error</span><br>
<span class="lineno"></span><span class="op" id="1412422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="1412425">//&nbsp;Seeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;Seek&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1412486">//</span><br>
<span class="lineno"></span><span class="comment" id="1412489">//&nbsp;Seek&nbsp;sets&nbsp;the&nbsp;offset&nbsp;for&nbsp;the&nbsp;next&nbsp;Read&nbsp;or&nbsp;Write&nbsp;to&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1412551">//&nbsp;interpreted&nbsp;according&nbsp;to&nbsp;whence:&nbsp;0&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;origin&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1412621">//&nbsp;the&nbsp;file,&nbsp;1&nbsp;means&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;offset,&nbsp;and&nbsp;2&nbsp;means</span><br>
<span class="lineno">100</span><span class="comment" id="1412686">//&nbsp;relative&nbsp;to&nbsp;the&nbsp;end.&nbsp;&nbsp;Seek&nbsp;returns&nbsp;the&nbsp;new&nbsp;offset&nbsp;and&nbsp;an&nbsp;error,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1412756">//&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1412764">//</span><br>
<span class="lineno"></span><span class="comment" id="1412767">//&nbsp;Seeking&nbsp;to&nbsp;a&nbsp;negative&nbsp;offset&nbsp;is&nbsp;an&nbsp;error.&nbsp;Seeking&nbsp;to&nbsp;any&nbsp;positive</span><br>
<span class="lineno"></span><span class="comment" id="1412836">//&nbsp;offset&nbsp;is&nbsp;legal,&nbsp;but&nbsp;the&nbsp;behavior&nbsp;of&nbsp;subsequent&nbsp;I/O&nbsp;operations&nbsp;on</span><br>
<span class="lineno">105</span><span class="comment" id="1412905">//&nbsp;the&nbsp;underlying&nbsp;object&nbsp;is&nbsp;implementation-dependent.</span><br>
<span class="lineno"></span><span class="keyword" id="1412959">type</span>&nbsp;<span class="ident" id="1412964">Seeker</span>&nbsp;<span class="keyword" id="1412971">interface</span>&nbsp;<span class="op" id="1412981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1412984">Seek</span><span class="op" id="1412988">(</span><span class="ident" id="1412989">offset</span>&nbsp;<span class="ident" id="1412996">int64</span><span class="op" id="1413001">,</span>&nbsp;<span class="ident" id="1413003">whence</span>&nbsp;<span class="builtintype" id="1413010">int</span><span class="op" id="1413013">)</span>&nbsp;<span class="op" id="1413015">(</span><span class="ident" id="1413016">int64</span><span class="op" id="1413021">,</span>&nbsp;<span class="builtintype" id="1413023">error</span><span class="op" id="1413028">)</span><br>
<span class="lineno"></span><span class="op" id="1413030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="1413033">//&nbsp;ReadWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Write&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1413110">type</span>&nbsp;<span class="ident" id="1413115">ReadWriter</span>&nbsp;<span class="keyword" id="1413126">interface</span>&nbsp;<span class="op" id="1413136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413139">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413147">Writer</span><br>
<span class="lineno"></span><span class="op" id="1413154">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="1413157">//&nbsp;ReadCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1413234">type</span>&nbsp;<span class="ident" id="1413239">ReadCloser</span>&nbsp;<span class="keyword" id="1413250">interface</span>&nbsp;<span class="op" id="1413260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413263">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413271">Closer</span><br>
<span class="lineno">120</span><span class="op" id="1413278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1413281">//&nbsp;WriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1413360">type</span>&nbsp;<span class="ident" id="1413365">WriteCloser</span>&nbsp;<span class="keyword" id="1413377">interface</span>&nbsp;<span class="op" id="1413387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413390">Writer</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413398">Closer</span><br>
<span class="lineno"></span><span class="op" id="1413405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1413408">//&nbsp;ReadWriteCloser&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Close&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1413497">type</span>&nbsp;<span class="ident" id="1413502">ReadWriteCloser</span>&nbsp;<span class="keyword" id="1413518">interface</span>&nbsp;<span class="op" id="1413528">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413531">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413539">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413547">Closer</span><br>
<span class="lineno"></span><span class="op" id="1413554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="1413557">//&nbsp;ReadSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1413633">type</span>&nbsp;<span class="ident" id="1413638">ReadSeeker</span>&nbsp;<span class="keyword" id="1413649">interface</span>&nbsp;<span class="op" id="1413659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413662">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413670">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1413677">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="1413680">//&nbsp;WriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1413758">type</span>&nbsp;<span class="ident" id="1413763">WriteSeeker</span>&nbsp;<span class="keyword" id="1413775">interface</span>&nbsp;<span class="op" id="1413785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413788">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413796">Seeker</span><br>
<span class="lineno">145</span><span class="op" id="1413803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1413806">//&nbsp;ReadWriteSeeker&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;groups&nbsp;the&nbsp;basic&nbsp;Read,&nbsp;Write&nbsp;and&nbsp;Seek&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="1413894">type</span>&nbsp;<span class="ident" id="1413899">ReadWriteSeeker</span>&nbsp;<span class="keyword" id="1413915">interface</span>&nbsp;<span class="op" id="1413925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413928">Reader</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413936">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1413944">Seeker</span><br>
<span class="lineno"></span><span class="op" id="1413951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1413954">//&nbsp;ReaderFrom&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno">155</span><span class="comment" id="1414017">//</span><br>
<span class="lineno"></span><span class="comment" id="1414020">//&nbsp;ReadFrom&nbsp;reads&nbsp;data&nbsp;from&nbsp;r&nbsp;until&nbsp;EOF&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="1414070">//&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1414121">//&nbsp;Any&nbsp;error&nbsp;except&nbsp;io.EOF&nbsp;encountered&nbsp;during&nbsp;the&nbsp;read&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="1414194">//</span><br>
<span class="lineno">160</span><span class="comment" id="1414197">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;ReaderFrom&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1414248">type</span>&nbsp;<span class="ident" id="1414253">ReaderFrom</span>&nbsp;<span class="keyword" id="1414264">interface</span>&nbsp;<span class="op" id="1414274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1414277">ReadFrom</span><span class="op" id="1414285">(</span><span class="ident" id="1414286">r</span>&nbsp;<span class="ident" id="1414288">Reader</span><span class="op" id="1414294">)</span>&nbsp;<span class="op" id="1414296">(</span><span class="ident" id="1414297">n</span>&nbsp;<span class="ident" id="1414299">int64</span><span class="op" id="1414304">,</span>&nbsp;<span class="ident" id="1414306">err</span>&nbsp;<span class="builtintype" id="1414310">error</span><span class="op" id="1414315">)</span><br>
<span class="lineno"></span><span class="op" id="1414317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="1414320">//&nbsp;WriterTo&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1414380">//</span><br>
<span class="lineno"></span><span class="comment" id="1414383">//&nbsp;WriteTo&nbsp;writes&nbsp;data&nbsp;to&nbsp;w&nbsp;until&nbsp;there&#39;s&nbsp;no&nbsp;more&nbsp;data&nbsp;to&nbsp;write&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1414450">//&nbsp;when&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;The&nbsp;return&nbsp;value&nbsp;n&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="1414517">//&nbsp;written.&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;during&nbsp;the&nbsp;write&nbsp;is&nbsp;also&nbsp;returned.</span><br>
<span class="lineno">170</span><span class="comment" id="1414586">//</span><br>
<span class="lineno"></span><span class="comment" id="1414589">//&nbsp;The&nbsp;Copy&nbsp;function&nbsp;uses&nbsp;WriterTo&nbsp;if&nbsp;available.</span><br>
<span class="lineno"></span><span class="keyword" id="1414638">type</span>&nbsp;<span class="ident" id="1414643">WriterTo</span>&nbsp;<span class="keyword" id="1414652">interface</span>&nbsp;<span class="op" id="1414662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1414665">WriteTo</span><span class="op" id="1414672">(</span><span class="ident" id="1414673">w</span>&nbsp;<span class="ident" id="1414675">Writer</span><span class="op" id="1414681">)</span>&nbsp;<span class="op" id="1414683">(</span><span class="ident" id="1414684">n</span>&nbsp;<span class="ident" id="1414686">int64</span><span class="op" id="1414691">,</span>&nbsp;<span class="ident" id="1414693">err</span>&nbsp;<span class="builtintype" id="1414697">error</span><span class="op" id="1414702">)</span><br>
<span class="lineno"></span><span class="op" id="1414704">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="1414707">//&nbsp;ReaderAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1414772">//</span><br>
<span class="lineno"></span><span class="comment" id="1414775">//&nbsp;ReadAt&nbsp;reads&nbsp;len(p)&nbsp;bytes&nbsp;into&nbsp;p&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1414841">//&nbsp;underlying&nbsp;input&nbsp;source.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">180</span><span class="comment" id="1414901">//&nbsp;read&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="comment" id="1414955">//</span><br>
<span class="lineno"></span><span class="comment" id="1414958">//&nbsp;When&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1415020">//&nbsp;explaining&nbsp;why&nbsp;more&nbsp;bytes&nbsp;were&nbsp;not&nbsp;returned.&nbsp;&nbsp;In&nbsp;this&nbsp;respect,</span><br>
<span class="lineno"></span><span class="comment" id="1415086">//&nbsp;ReadAt&nbsp;is&nbsp;stricter&nbsp;than&nbsp;Read.</span><br>
<span class="lineno">185</span><span class="comment" id="1415119">//</span><br>
<span class="lineno"></span><span class="comment" id="1415122">//&nbsp;Even&nbsp;if&nbsp;ReadAt&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p),&nbsp;it&nbsp;may&nbsp;use&nbsp;all&nbsp;of&nbsp;p&nbsp;as&nbsp;scratch</span><br>
<span class="lineno"></span><span class="comment" id="1415191">//&nbsp;space&nbsp;during&nbsp;the&nbsp;call.&nbsp;&nbsp;If&nbsp;some&nbsp;data&nbsp;is&nbsp;available&nbsp;but&nbsp;not&nbsp;len(p)&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1415266">//&nbsp;ReadAt&nbsp;blocks&nbsp;until&nbsp;either&nbsp;all&nbsp;the&nbsp;data&nbsp;is&nbsp;available&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="1415342">//&nbsp;In&nbsp;this&nbsp;respect&nbsp;ReadAt&nbsp;is&nbsp;different&nbsp;from&nbsp;Read.</span><br>
<span class="lineno">190</span><span class="comment" id="1415392">//</span><br>
<span class="lineno"></span><span class="comment" id="1415395">//&nbsp;If&nbsp;the&nbsp;n&nbsp;=&nbsp;len(p)&nbsp;bytes&nbsp;returned&nbsp;by&nbsp;ReadAt&nbsp;are&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1415463">//&nbsp;input&nbsp;source,&nbsp;ReadAt&nbsp;may&nbsp;return&nbsp;either&nbsp;err&nbsp;==&nbsp;EOF&nbsp;or&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1415531">//</span><br>
<span class="lineno"></span><span class="comment" id="1415534">//&nbsp;If&nbsp;ReadAt&nbsp;is&nbsp;reading&nbsp;from&nbsp;an&nbsp;input&nbsp;source&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno">195</span><span class="comment" id="1415599">//&nbsp;ReadAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span><span class="comment" id="1415661">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1415677">//</span><br>
<span class="lineno"></span><span class="comment" id="1415680">//&nbsp;Clients&nbsp;of&nbsp;ReadAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;ReadAt&nbsp;calls&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1415742">//&nbsp;same&nbsp;input&nbsp;source.</span><br>
<span class="lineno">200</span><span class="comment" id="1415764">//</span><br>
<span class="lineno"></span><span class="comment" id="1415767">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1415805">type</span>&nbsp;<span class="ident" id="1415810">ReaderAt</span>&nbsp;<span class="keyword" id="1415819">interface</span>&nbsp;<span class="op" id="1415829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1415832">ReadAt</span><span class="op" id="1415838">(</span><span class="ident" id="1415839">p</span>&nbsp;<span class="op" id="1415841">[</span><span class="op" id="1415842">]</span><span class="builtintype" id="1415843">byte</span><span class="op" id="1415847">,</span>&nbsp;<span class="ident" id="1415849">off</span>&nbsp;<span class="ident" id="1415853">int64</span><span class="op" id="1415858">)</span>&nbsp;<span class="op" id="1415860">(</span><span class="ident" id="1415861">n</span>&nbsp;<span class="builtintype" id="1415863">int</span><span class="op" id="1415866">,</span>&nbsp;<span class="ident" id="1415868">err</span>&nbsp;<span class="builtintype" id="1415872">error</span><span class="op" id="1415877">)</span><br>
<span class="lineno"></span><span class="op" id="1415879">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="1415882">//&nbsp;WriterAt&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;basic&nbsp;WriteAt&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1415948">//</span><br>
<span class="lineno"></span><span class="comment" id="1415951">//&nbsp;WriteAt&nbsp;writes&nbsp;len(p)&nbsp;bytes&nbsp;from&nbsp;p&nbsp;to&nbsp;the&nbsp;underlying&nbsp;data&nbsp;stream</span><br>
<span class="lineno"></span><span class="comment" id="1416019">//&nbsp;at&nbsp;offset&nbsp;off.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;from&nbsp;p&nbsp;(0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(p))</span><br>
<span class="lineno">210</span><span class="comment" id="1416103">//&nbsp;and&nbsp;any&nbsp;error&nbsp;encountered&nbsp;that&nbsp;caused&nbsp;the&nbsp;write&nbsp;to&nbsp;stop&nbsp;early.</span><br>
<span class="lineno"></span><span class="comment" id="1416169">//&nbsp;WriteAt&nbsp;must&nbsp;return&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;if&nbsp;it&nbsp;returns&nbsp;n&nbsp;&lt;&nbsp;len(p).</span><br>
<span class="lineno"></span><span class="comment" id="1416234">//</span><br>
<span class="lineno"></span><span class="comment" id="1416237">//&nbsp;If&nbsp;WriteAt&nbsp;is&nbsp;writing&nbsp;to&nbsp;a&nbsp;destination&nbsp;with&nbsp;a&nbsp;seek&nbsp;offset,</span><br>
<span class="lineno"></span><span class="comment" id="1416299">//&nbsp;WriteAt&nbsp;should&nbsp;not&nbsp;affect&nbsp;nor&nbsp;be&nbsp;affected&nbsp;by&nbsp;the&nbsp;underlying</span><br>
<span class="lineno">215</span><span class="comment" id="1416362">//&nbsp;seek&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="1416378">//</span><br>
<span class="lineno"></span><span class="comment" id="1416381">//&nbsp;Clients&nbsp;of&nbsp;WriteAt&nbsp;can&nbsp;execute&nbsp;parallel&nbsp;WriteAt&nbsp;calls&nbsp;on&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="1416450">//&nbsp;destination&nbsp;if&nbsp;the&nbsp;ranges&nbsp;do&nbsp;not&nbsp;overlap.</span><br>
<span class="lineno"></span><span class="comment" id="1416495">//</span><br>
<span class="lineno">220</span><span class="comment" id="1416498">//&nbsp;Implementations&nbsp;must&nbsp;not&nbsp;retain&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="1416536">type</span>&nbsp;<span class="ident" id="1416541">WriterAt</span>&nbsp;<span class="keyword" id="1416550">interface</span>&nbsp;<span class="op" id="1416560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1416563">WriteAt</span><span class="op" id="1416570">(</span><span class="ident" id="1416571">p</span>&nbsp;<span class="op" id="1416573">[</span><span class="op" id="1416574">]</span><span class="builtintype" id="1416575">byte</span><span class="op" id="1416579">,</span>&nbsp;<span class="ident" id="1416581">off</span>&nbsp;<span class="ident" id="1416585">int64</span><span class="op" id="1416590">)</span>&nbsp;<span class="op" id="1416592">(</span><span class="ident" id="1416593">n</span>&nbsp;<span class="builtintype" id="1416595">int</span><span class="op" id="1416598">,</span>&nbsp;<span class="ident" id="1416600">err</span>&nbsp;<span class="builtintype" id="1416604">error</span><span class="op" id="1416609">)</span><br>
<span class="lineno"></span><span class="op" id="1416611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="comment" id="1416614">//&nbsp;ByteReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1416677">//</span><br>
<span class="lineno"></span><span class="comment" id="1416680">//&nbsp;ReadByte&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;byte&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="1416740">//&nbsp;If&nbsp;no&nbsp;byte&nbsp;is&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="1416785">type</span>&nbsp;<span class="ident" id="1416790">ByteReader</span>&nbsp;<span class="keyword" id="1416801">interface</span>&nbsp;<span class="op" id="1416811">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1416814">ReadByte</span><span class="op" id="1416822">(</span><span class="op" id="1416823">)</span>&nbsp;<span class="op" id="1416825">(</span><span class="ident" id="1416826">c</span>&nbsp;<span class="builtintype" id="1416828">byte</span><span class="op" id="1416832">,</span>&nbsp;<span class="ident" id="1416834">err</span>&nbsp;<span class="builtintype" id="1416838">error</span><span class="op" id="1416843">)</span><br>
<span class="lineno"></span><span class="op" id="1416845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1416848">//&nbsp;ByteScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadByte&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1416919">//&nbsp;basic&nbsp;ReadByte&nbsp;method.</span><br>
<span class="lineno">235</span><span class="comment" id="1416945">//</span><br>
<span class="lineno"></span><span class="comment" id="1416948">//&nbsp;UnreadByte&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadByte&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="1417019">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno"></span><span class="comment" id="1417056">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadByte&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno"></span><span class="comment" id="1417126">//&nbsp;call&nbsp;to&nbsp;ReadByte.</span><br>
<span class="lineno">240</span><span class="keyword" id="1417147">type</span>&nbsp;<span class="ident" id="1417152">ByteScanner</span>&nbsp;<span class="keyword" id="1417164">interface</span>&nbsp;<span class="op" id="1417174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417177">ByteReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417189">UnreadByte</span><span class="op" id="1417199">(</span><span class="op" id="1417200">)</span>&nbsp;<span class="builtintype" id="1417202">error</span><br>
<span class="lineno"></span><span class="op" id="1417208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1417211">//&nbsp;ByteWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteByte&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1417275">type</span>&nbsp;<span class="ident" id="1417280">ByteWriter</span>&nbsp;<span class="keyword" id="1417291">interface</span>&nbsp;<span class="op" id="1417301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417304">WriteByte</span><span class="op" id="1417313">(</span><span class="ident" id="1417314">c</span>&nbsp;<span class="builtintype" id="1417316">byte</span><span class="op" id="1417320">)</span>&nbsp;<span class="builtintype" id="1417322">error</span><br>
<span class="lineno"></span><span class="op" id="1417328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1417331">//&nbsp;RuneReader&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1417394">//</span><br>
<span class="lineno"></span><span class="comment" id="1417397">//&nbsp;ReadRune&nbsp;reads&nbsp;a&nbsp;single&nbsp;UTF-8&nbsp;encoded&nbsp;Unicode&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="1417456">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune&nbsp;and&nbsp;its&nbsp;size&nbsp;in&nbsp;bytes.&nbsp;If&nbsp;no&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1417522">//&nbsp;available,&nbsp;err&nbsp;will&nbsp;be&nbsp;set.</span><br>
<span class="lineno">255</span><span class="keyword" id="1417553">type</span>&nbsp;<span class="ident" id="1417558">RuneReader</span>&nbsp;<span class="keyword" id="1417569">interface</span>&nbsp;<span class="op" id="1417579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417582">ReadRune</span><span class="op" id="1417590">(</span><span class="op" id="1417591">)</span>&nbsp;<span class="op" id="1417593">(</span><span class="ident" id="1417594">r</span>&nbsp;<span class="builtintype" id="1417596">rune</span><span class="op" id="1417600">,</span>&nbsp;<span class="ident" id="1417602">size</span>&nbsp;<span class="builtintype" id="1417607">int</span><span class="op" id="1417610">,</span>&nbsp;<span class="ident" id="1417612">err</span>&nbsp;<span class="builtintype" id="1417616">error</span><span class="op" id="1417621">)</span><br>
<span class="lineno"></span><span class="op" id="1417623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1417626">//&nbsp;RuneScanner&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;adds&nbsp;the&nbsp;UnreadRune&nbsp;method&nbsp;to&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="1417697">//&nbsp;basic&nbsp;ReadRune&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="1417723">//</span><br>
<span class="lineno"></span><span class="comment" id="1417726">//&nbsp;UnreadRune&nbsp;causes&nbsp;the&nbsp;next&nbsp;call&nbsp;to&nbsp;ReadRune&nbsp;to&nbsp;return&nbsp;the&nbsp;same&nbsp;rune</span><br>
<span class="lineno"></span><span class="comment" id="1417797">//&nbsp;as&nbsp;the&nbsp;previous&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="comment" id="1417834">//&nbsp;It&nbsp;may&nbsp;be&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;UnreadRune&nbsp;twice&nbsp;without&nbsp;an&nbsp;intervening</span><br>
<span class="lineno">265</span><span class="comment" id="1417904">//&nbsp;call&nbsp;to&nbsp;ReadRune.</span><br>
<span class="lineno"></span><span class="keyword" id="1417925">type</span>&nbsp;<span class="ident" id="1417930">RuneScanner</span>&nbsp;<span class="keyword" id="1417942">interface</span>&nbsp;<span class="op" id="1417952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417955">RuneReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1417967">UnreadRune</span><span class="op" id="1417977">(</span><span class="op" id="1417978">)</span>&nbsp;<span class="builtintype" id="1417980">error</span><br>
<span class="lineno"></span><span class="op" id="1417986">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="1417989">//&nbsp;stringWriter&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;wraps&nbsp;the&nbsp;WriteString&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1418057">type</span>&nbsp;<span class="ident" id="1418062">stringWriter</span>&nbsp;<span class="keyword" id="1418075">interface</span>&nbsp;<span class="op" id="1418085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1418088">WriteString</span><span class="op" id="1418099">(</span><span class="ident" id="1418100">s</span>&nbsp;<span class="builtintype" id="1418102">string</span><span class="op" id="1418108">)</span>&nbsp;<span class="op" id="1418110">(</span><span class="ident" id="1418111">n</span>&nbsp;<span class="builtintype" id="1418113">int</span><span class="op" id="1418116">,</span>&nbsp;<span class="ident" id="1418118">err</span>&nbsp;<span class="builtintype" id="1418122">error</span><span class="op" id="1418127">)</span><br>
<span class="lineno"></span><span class="op" id="1418129">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="1418132">//&nbsp;WriteString&nbsp;writes&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;w,&nbsp;which&nbsp;accepts&nbsp;an&nbsp;array&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1418222">//&nbsp;If&nbsp;w&nbsp;already&nbsp;implements&nbsp;a&nbsp;WriteString&nbsp;method,&nbsp;it&nbsp;is&nbsp;invoked&nbsp;directly.</span><br>
<span class="lineno"></span><span class="keyword" id="1418295">func</span>&nbsp;<span class="ident" id="1418300">WriteString</span><span class="op" id="1418311">(</span><span class="ident" id="1418312">w</span>&nbsp;<span class="ident" id="1418314">Writer</span><span class="op" id="1418320">,</span>&nbsp;<span class="ident" id="1418322">s</span>&nbsp;<span class="builtintype" id="1418324">string</span><span class="op" id="1418330">)</span>&nbsp;<span class="op" id="1418332">(</span><span class="ident" id="1418333">n</span>&nbsp;<span class="builtintype" id="1418335">int</span><span class="op" id="1418338">,</span>&nbsp;<span class="ident" id="1418340">err</span>&nbsp;<span class="builtintype" id="1418344">error</span><span class="op" id="1418349">)</span>&nbsp;<span class="op" id="1418351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1418354">if</span>&nbsp;<span class="ident" id="1418357">sw</span><span class="op" id="1418359">,</span>&nbsp;<span class="ident" id="1418361">ok</span>&nbsp;<span class="op" id="1418364">:=</span>&nbsp;<span class="ident" id="1418367">w</span><span class="op" id="1418368">.</span><span class="op" id="1418369">(</span><span class="ident" id="1418370">stringWriter</span><span class="op" id="1418382">)</span><span class="op" id="1418383">;</span>&nbsp;<span class="ident" id="1418385">ok</span>&nbsp;<span class="op" id="1418388">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1418392">return</span>&nbsp;<span class="ident" id="1418399">sw</span><span class="op" id="1418401">.</span><span class="ident" id="1418402">WriteString</span><span class="op" id="1418413">(</span><span class="ident" id="1418414">s</span><span class="op" id="1418415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1418418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1418421">return</span>&nbsp;<span class="ident" id="1418428">w</span><span class="op" id="1418429">.</span><span class="ident" id="1418430">Write</span><span class="op" id="1418435">(</span><span class="op" id="1418436">[</span><span class="op" id="1418437">]</span><span class="builtintype" id="1418438">byte</span><span class="op" id="1418442">(</span><span class="ident" id="1418443">s</span><span class="op" id="1418444">)</span><span class="op" id="1418445">)</span><br>
<span class="lineno"></span><span class="op" id="1418447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="comment" id="1418450">//&nbsp;ReadAtLeast&nbsp;reads&nbsp;from&nbsp;r&nbsp;into&nbsp;buf&nbsp;until&nbsp;it&nbsp;has&nbsp;read&nbsp;at&nbsp;least&nbsp;min&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="1418525">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1418605">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1418653">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;fewer&nbsp;than&nbsp;min&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1418710">//&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno">290</span><span class="comment" id="1418751">//&nbsp;If&nbsp;min&nbsp;is&nbsp;greater&nbsp;than&nbsp;the&nbsp;length&nbsp;of&nbsp;buf,&nbsp;ReadAtLeast&nbsp;returns&nbsp;ErrShortBuffer.</span><br>
<span class="lineno"></span><span class="comment" id="1418832">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;&gt;=&nbsp;min&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="1418882">func</span>&nbsp;<span class="ident" id="1418887">ReadAtLeast</span><span class="op" id="1418898">(</span><span class="ident" id="1418899">r</span>&nbsp;<span class="ident" id="1418901">Reader</span><span class="op" id="1418907">,</span>&nbsp;<span class="ident" id="1418909">buf</span>&nbsp;<span class="op" id="1418913">[</span><span class="op" id="1418914">]</span><span class="builtintype" id="1418915">byte</span><span class="op" id="1418919">,</span>&nbsp;<span class="ident" id="1418921">min</span>&nbsp;<span class="builtintype" id="1418925">int</span><span class="op" id="1418928">)</span>&nbsp;<span class="op" id="1418930">(</span><span class="ident" id="1418931">n</span>&nbsp;<span class="builtintype" id="1418933">int</span><span class="op" id="1418936">,</span>&nbsp;<span class="ident" id="1418938">err</span>&nbsp;<span class="builtintype" id="1418942">error</span><span class="op" id="1418947">)</span>&nbsp;<span class="op" id="1418949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1418952">if</span>&nbsp;<span class="builtinfunc" id="1418955">len</span><span class="op" id="1418958">(</span><span class="ident" id="1418959">buf</span><span class="op" id="1418962">)</span>&nbsp;<span class="op" id="1418964">&lt;</span>&nbsp;<span class="ident" id="1418966">min</span>&nbsp;<span class="op" id="1418970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1418974">return</span>&nbsp;<span class="num" id="1418981">0</span><span class="op" id="1418982">,</span>&nbsp;<span class="ident" id="1418984">ErrShortBuffer</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1419000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419003">for</span>&nbsp;<span class="ident" id="1419007">n</span>&nbsp;<span class="op" id="1419009">&lt;</span>&nbsp;<span class="ident" id="1419011">min</span>&nbsp;<span class="op" id="1419015">&amp;&amp;</span>&nbsp;<span class="ident" id="1419018">err</span>&nbsp;<span class="op" id="1419022">==</span>&nbsp;<span class="ident" id="1419025">nil</span>&nbsp;<span class="op" id="1419029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419033">var</span>&nbsp;<span class="ident" id="1419037">nn</span>&nbsp;<span class="builtintype" id="1419040">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1419046">nn</span><span class="op" id="1419048">,</span>&nbsp;<span class="ident" id="1419050">err</span>&nbsp;<span class="op" id="1419054">=</span>&nbsp;<span class="ident" id="1419056">r</span><span class="op" id="1419057">.</span><span class="ident" id="1419058">Read</span><span class="op" id="1419062">(</span><span class="ident" id="1419063">buf</span><span class="op" id="1419066">[</span><span class="ident" id="1419067">n</span><span class="op" id="1419068">:</span><span class="op" id="1419069">]</span><span class="op" id="1419070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1419074">n</span>&nbsp;<span class="op" id="1419076">+=</span>&nbsp;<span class="ident" id="1419079">nn</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1419083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419086">if</span>&nbsp;<span class="ident" id="1419089">n</span>&nbsp;<span class="op" id="1419091">&gt;=</span>&nbsp;<span class="ident" id="1419094">min</span>&nbsp;<span class="op" id="1419098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1419102">err</span>&nbsp;<span class="op" id="1419106">=</span>&nbsp;<span class="ident" id="1419108">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1419113">}</span>&nbsp;<span class="keyword" id="1419115">else</span>&nbsp;<span class="keyword" id="1419120">if</span>&nbsp;<span class="ident" id="1419123">n</span>&nbsp;<span class="op" id="1419125">&gt;</span>&nbsp;<span class="num" id="1419127">0</span>&nbsp;<span class="op" id="1419129">&amp;&amp;</span>&nbsp;<span class="ident" id="1419132">err</span>&nbsp;<span class="op" id="1419136">==</span>&nbsp;<span class="ident" id="1419139">EOF</span>&nbsp;<span class="op" id="1419143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1419147">err</span>&nbsp;<span class="op" id="1419151">=</span>&nbsp;<span class="ident" id="1419153">ErrUnexpectedEOF</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1419171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419174">return</span><br>
<span class="lineno"></span><span class="op" id="1419181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1419184">//&nbsp;ReadFull&nbsp;reads&nbsp;exactly&nbsp;len(buf)&nbsp;bytes&nbsp;from&nbsp;r&nbsp;into&nbsp;buf.</span><br>
<span class="lineno">310</span><span class="comment" id="1419242">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;an&nbsp;error&nbsp;if&nbsp;fewer&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1419322">//&nbsp;The&nbsp;error&nbsp;is&nbsp;EOF&nbsp;only&nbsp;if&nbsp;no&nbsp;bytes&nbsp;were&nbsp;read.</span><br>
<span class="lineno"></span><span class="comment" id="1419370">//&nbsp;If&nbsp;an&nbsp;EOF&nbsp;happens&nbsp;after&nbsp;reading&nbsp;some&nbsp;but&nbsp;not&nbsp;all&nbsp;the&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="1419433">//&nbsp;ReadFull&nbsp;returns&nbsp;ErrUnexpectedEOF.</span><br>
<span class="lineno"></span><span class="comment" id="1419471">//&nbsp;On&nbsp;return,&nbsp;n&nbsp;==&nbsp;len(buf)&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno">315</span><span class="keyword" id="1419526">func</span>&nbsp;<span class="ident" id="1419531">ReadFull</span><span class="op" id="1419539">(</span><span class="ident" id="1419540">r</span>&nbsp;<span class="ident" id="1419542">Reader</span><span class="op" id="1419548">,</span>&nbsp;<span class="ident" id="1419550">buf</span>&nbsp;<span class="op" id="1419554">[</span><span class="op" id="1419555">]</span><span class="builtintype" id="1419556">byte</span><span class="op" id="1419560">)</span>&nbsp;<span class="op" id="1419562">(</span><span class="ident" id="1419563">n</span>&nbsp;<span class="builtintype" id="1419565">int</span><span class="op" id="1419568">,</span>&nbsp;<span class="ident" id="1419570">err</span>&nbsp;<span class="builtintype" id="1419574">error</span><span class="op" id="1419579">)</span>&nbsp;<span class="op" id="1419581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1419584">return</span>&nbsp;<span class="ident" id="1419591">ReadAtLeast</span><span class="op" id="1419602">(</span><span class="ident" id="1419603">r</span><span class="op" id="1419604">,</span>&nbsp;<span class="ident" id="1419606">buf</span><span class="op" id="1419609">,</span>&nbsp;<span class="builtinfunc" id="1419611">len</span><span class="op" id="1419614">(</span><span class="ident" id="1419615">buf</span><span class="op" id="1419618">)</span><span class="op" id="1419619">)</span><br>
<span class="lineno"></span><span class="op" id="1419621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1419624">//&nbsp;CopyN&nbsp;copies&nbsp;n&nbsp;bytes&nbsp;(or&nbsp;until&nbsp;an&nbsp;error)&nbsp;from&nbsp;src&nbsp;to&nbsp;dst.</span><br>
<span class="lineno">320</span><span class="comment" id="1419685">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;and&nbsp;the&nbsp;earliest</span><br>
<span class="lineno"></span><span class="comment" id="1419743">//&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying.</span><br>
<span class="lineno"></span><span class="comment" id="1419779">//&nbsp;On&nbsp;return,&nbsp;written&nbsp;==&nbsp;n&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;err&nbsp;==&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="1419833">//</span><br>
<span class="lineno"></span><span class="comment" id="1419836">//&nbsp;If&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno">325</span><span class="comment" id="1419883">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;using&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="1419920">func</span>&nbsp;<span class="ident" id="1419925">CopyN</span><span class="op" id="1419930">(</span><span class="ident" id="1419931">dst</span>&nbsp;<span class="ident" id="1419935">Writer</span><span class="op" id="1419941">,</span>&nbsp;<span class="ident" id="1419943">src</span>&nbsp;<span class="ident" id="1419947">Reader</span><span class="op" id="1419953">,</span>&nbsp;<span class="ident" id="1419955">n</span>&nbsp;<span class="ident" id="1419957">int64</span><span class="op" id="1419962">)</span>&nbsp;<span class="op" id="1419964">(</span><span class="ident" id="1419965">written</span>&nbsp;<span class="ident" id="1419973">int64</span><span class="op" id="1419978">,</span>&nbsp;<span class="ident" id="1419980">err</span>&nbsp;<span class="builtintype" id="1419984">error</span><span class="op" id="1419989">)</span>&nbsp;<span class="op" id="1419991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1419994">written</span><span class="op" id="1420001">,</span>&nbsp;<span class="ident" id="1420003">err</span>&nbsp;<span class="op" id="1420007">=</span>&nbsp;<span class="ident" id="1420009">Copy</span><span class="op" id="1420013">(</span><span class="ident" id="1420014">dst</span><span class="op" id="1420017">,</span>&nbsp;<span class="ident" id="1420019">LimitReader</span><span class="op" id="1420030">(</span><span class="ident" id="1420031">src</span><span class="op" id="1420034">,</span>&nbsp;<span class="ident" id="1420036">n</span><span class="op" id="1420037">)</span><span class="op" id="1420038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420041">if</span>&nbsp;<span class="ident" id="1420044">written</span>&nbsp;<span class="op" id="1420052">==</span>&nbsp;<span class="ident" id="1420055">n</span>&nbsp;<span class="op" id="1420057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420061">return</span>&nbsp;<span class="ident" id="1420068">n</span><span class="op" id="1420069">,</span>&nbsp;<span class="ident" id="1420071">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1420076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420079">if</span>&nbsp;<span class="ident" id="1420082">written</span>&nbsp;<span class="op" id="1420090">&lt;</span>&nbsp;<span class="ident" id="1420092">n</span>&nbsp;<span class="op" id="1420094">&amp;&amp;</span>&nbsp;<span class="ident" id="1420097">err</span>&nbsp;<span class="op" id="1420101">==</span>&nbsp;<span class="ident" id="1420104">nil</span>&nbsp;<span class="op" id="1420108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1420112">//&nbsp;src&nbsp;stopped&nbsp;early;&nbsp;must&nbsp;have&nbsp;been&nbsp;EOF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1420156">err</span>&nbsp;<span class="op" id="1420160">=</span>&nbsp;<span class="ident" id="1420162">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1420167">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420170">return</span><br>
<span class="lineno"></span><span class="op" id="1420177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1420180">//&nbsp;Copy&nbsp;copies&nbsp;from&nbsp;src&nbsp;to&nbsp;dst&nbsp;until&nbsp;either&nbsp;EOF&nbsp;is&nbsp;reached</span><br>
<span class="lineno"></span><span class="comment" id="1420239">//&nbsp;on&nbsp;src&nbsp;or&nbsp;an&nbsp;error&nbsp;occurs.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno">340</span><span class="comment" id="1420301">//&nbsp;copied&nbsp;and&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered&nbsp;while&nbsp;copying,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="1420366">//</span><br>
<span class="lineno"></span><span class="comment" id="1420369">//&nbsp;A&nbsp;successful&nbsp;Copy&nbsp;returns&nbsp;err&nbsp;==&nbsp;nil,&nbsp;not&nbsp;err&nbsp;==&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="comment" id="1420426">//&nbsp;Because&nbsp;Copy&nbsp;is&nbsp;defined&nbsp;to&nbsp;read&nbsp;from&nbsp;src&nbsp;until&nbsp;EOF,&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="1420489">//&nbsp;not&nbsp;treat&nbsp;an&nbsp;EOF&nbsp;from&nbsp;Read&nbsp;as&nbsp;an&nbsp;error&nbsp;to&nbsp;be&nbsp;reported.</span><br>
<span class="lineno">345</span><span class="comment" id="1420547">//</span><br>
<span class="lineno"></span><span class="comment" id="1420550">//&nbsp;If&nbsp;src&nbsp;implements&nbsp;the&nbsp;WriterTo&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1420595">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;src.WriteTo(dst).</span><br>
<span class="lineno"></span><span class="comment" id="1420651">//&nbsp;Otherwise,&nbsp;if&nbsp;dst&nbsp;implements&nbsp;the&nbsp;ReaderFrom&nbsp;interface,</span><br>
<span class="lineno"></span><span class="comment" id="1420709">//&nbsp;the&nbsp;copy&nbsp;is&nbsp;implemented&nbsp;by&nbsp;calling&nbsp;dst.ReadFrom(src).</span><br>
<span class="lineno">350</span><span class="keyword" id="1420766">func</span>&nbsp;<span class="ident" id="1420771">Copy</span><span class="op" id="1420775">(</span><span class="ident" id="1420776">dst</span>&nbsp;<span class="ident" id="1420780">Writer</span><span class="op" id="1420786">,</span>&nbsp;<span class="ident" id="1420788">src</span>&nbsp;<span class="ident" id="1420792">Reader</span><span class="op" id="1420798">)</span>&nbsp;<span class="op" id="1420800">(</span><span class="ident" id="1420801">written</span>&nbsp;<span class="ident" id="1420809">int64</span><span class="op" id="1420814">,</span>&nbsp;<span class="ident" id="1420816">err</span>&nbsp;<span class="builtintype" id="1420820">error</span><span class="op" id="1420825">)</span>&nbsp;<span class="op" id="1420827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1420830">//&nbsp;If&nbsp;the&nbsp;reader&nbsp;has&nbsp;a&nbsp;WriteTo&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1420893">//&nbsp;Avoids&nbsp;an&nbsp;allocation&nbsp;and&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420930">if</span>&nbsp;<span class="ident" id="1420933">wt</span><span class="op" id="1420935">,</span>&nbsp;<span class="ident" id="1420937">ok</span>&nbsp;<span class="op" id="1420940">:=</span>&nbsp;<span class="ident" id="1420943">src</span><span class="op" id="1420946">.</span><span class="op" id="1420947">(</span><span class="ident" id="1420948">WriterTo</span><span class="op" id="1420956">)</span><span class="op" id="1420957">;</span>&nbsp;<span class="ident" id="1420959">ok</span>&nbsp;<span class="op" id="1420962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1420966">return</span>&nbsp;<span class="ident" id="1420973">wt</span><span class="op" id="1420975">.</span><span class="ident" id="1420976">WriteTo</span><span class="op" id="1420983">(</span><span class="ident" id="1420984">dst</span><span class="op" id="1420987">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1420990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1420993">//&nbsp;Similarly,&nbsp;if&nbsp;the&nbsp;writer&nbsp;has&nbsp;a&nbsp;ReadFrom&nbsp;method,&nbsp;use&nbsp;it&nbsp;to&nbsp;do&nbsp;the&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421068">if</span>&nbsp;<span class="ident" id="1421071">rt</span><span class="op" id="1421073">,</span>&nbsp;<span class="ident" id="1421075">ok</span>&nbsp;<span class="op" id="1421078">:=</span>&nbsp;<span class="ident" id="1421081">dst</span><span class="op" id="1421084">.</span><span class="op" id="1421085">(</span><span class="ident" id="1421086">ReaderFrom</span><span class="op" id="1421096">)</span><span class="op" id="1421097">;</span>&nbsp;<span class="ident" id="1421099">ok</span>&nbsp;<span class="op" id="1421102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421106">return</span>&nbsp;<span class="ident" id="1421113">rt</span><span class="op" id="1421115">.</span><span class="ident" id="1421116">ReadFrom</span><span class="op" id="1421124">(</span><span class="ident" id="1421125">src</span><span class="op" id="1421128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1421131">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421134">buf</span>&nbsp;<span class="op" id="1421138">:=</span>&nbsp;<span class="builtinfunc" id="1421141">make</span><span class="op" id="1421145">(</span><span class="op" id="1421146">[</span><span class="op" id="1421147">]</span><span class="builtintype" id="1421148">byte</span><span class="op" id="1421152">,</span>&nbsp;<span class="num" id="1421154">32</span><span class="op" id="1421156">*</span><span class="num" id="1421157">1024</span><span class="op" id="1421161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421164">for</span>&nbsp;<span class="op" id="1421168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421172">nr</span><span class="op" id="1421174">,</span>&nbsp;<span class="ident" id="1421176">er</span>&nbsp;<span class="op" id="1421179">:=</span>&nbsp;<span class="ident" id="1421182">src</span><span class="op" id="1421185">.</span><span class="ident" id="1421186">Read</span><span class="op" id="1421190">(</span><span class="ident" id="1421191">buf</span><span class="op" id="1421194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421198">if</span>&nbsp;<span class="ident" id="1421201">nr</span>&nbsp;<span class="op" id="1421204">&gt;</span>&nbsp;<span class="num" id="1421206">0</span>&nbsp;<span class="op" id="1421208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421213">nw</span><span class="op" id="1421215">,</span>&nbsp;<span class="ident" id="1421217">ew</span>&nbsp;<span class="op" id="1421220">:=</span>&nbsp;<span class="ident" id="1421223">dst</span><span class="op" id="1421226">.</span><span class="ident" id="1421227">Write</span><span class="op" id="1421232">(</span><span class="ident" id="1421233">buf</span><span class="op" id="1421236">[</span><span class="num" id="1421237">0</span><span class="op" id="1421238">:</span><span class="ident" id="1421239">nr</span><span class="op" id="1421241">]</span><span class="op" id="1421242">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421247">if</span>&nbsp;<span class="ident" id="1421250">nw</span>&nbsp;<span class="op" id="1421253">&gt;</span>&nbsp;<span class="num" id="1421255">0</span>&nbsp;<span class="op" id="1421257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421263">written</span>&nbsp;<span class="op" id="1421271">+=</span>&nbsp;<span class="ident" id="1421274">int64</span><span class="op" id="1421279">(</span><span class="ident" id="1421280">nw</span><span class="op" id="1421282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1421287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421292">if</span>&nbsp;<span class="ident" id="1421295">ew</span>&nbsp;<span class="op" id="1421298">!=</span>&nbsp;<span class="ident" id="1421301">nil</span>&nbsp;<span class="op" id="1421305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421311">err</span>&nbsp;<span class="op" id="1421315">=</span>&nbsp;<span class="ident" id="1421317">ew</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421324">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1421333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421338">if</span>&nbsp;<span class="ident" id="1421341">nr</span>&nbsp;<span class="op" id="1421344">!=</span>&nbsp;<span class="ident" id="1421347">nw</span>&nbsp;<span class="op" id="1421350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421356">err</span>&nbsp;<span class="op" id="1421360">=</span>&nbsp;<span class="ident" id="1421362">ErrShortWrite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421380">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1421389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1421393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421397">if</span>&nbsp;<span class="ident" id="1421400">er</span>&nbsp;<span class="op" id="1421403">==</span>&nbsp;<span class="ident" id="1421406">EOF</span>&nbsp;<span class="op" id="1421410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421415">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1421423">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421427">if</span>&nbsp;<span class="ident" id="1421430">er</span>&nbsp;<span class="op" id="1421433">!=</span>&nbsp;<span class="ident" id="1421436">nil</span>&nbsp;<span class="op" id="1421440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421445">err</span>&nbsp;<span class="op" id="1421449">=</span>&nbsp;<span class="ident" id="1421451">er</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421457">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1421465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1421468">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1421471">return</span>&nbsp;<span class="ident" id="1421478">written</span><span class="op" id="1421485">,</span>&nbsp;<span class="ident" id="1421487">err</span><br>
<span class="lineno"></span><span class="op" id="1421491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1421494">//&nbsp;LimitReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1421544">//&nbsp;but&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">390</span><span class="comment" id="1421581">//&nbsp;The&nbsp;underlying&nbsp;implementation&nbsp;is&nbsp;a&nbsp;*LimitedReader.</span><br>
<span class="lineno"></span><span class="keyword" id="1421635">func</span>&nbsp;<span class="ident" id="1421640">LimitReader</span><span class="op" id="1421651">(</span><span class="ident" id="1421652">r</span>&nbsp;<span class="ident" id="1421654">Reader</span><span class="op" id="1421660">,</span>&nbsp;<span class="ident" id="1421662">n</span>&nbsp;<span class="ident" id="1421664">int64</span><span class="op" id="1421669">)</span>&nbsp;<span class="ident" id="1421671">Reader</span>&nbsp;<span class="op" id="1421678">{</span>&nbsp;<span class="keyword" id="1421680">return</span>&nbsp;<span class="op" id="1421687">&amp;</span><span class="ident" id="1421688">LimitedReader</span><span class="op" id="1421701">{</span><span class="ident" id="1421702">r</span><span class="op" id="1421703">,</span>&nbsp;<span class="ident" id="1421705">n</span><span class="op" id="1421706">}</span>&nbsp;<span class="op" id="1421708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1421711">//&nbsp;A&nbsp;LimitedReader&nbsp;reads&nbsp;from&nbsp;R&nbsp;but&nbsp;limits&nbsp;the&nbsp;amount&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1421768">//&nbsp;data&nbsp;returned&nbsp;to&nbsp;just&nbsp;N&nbsp;bytes.&nbsp;Each&nbsp;call&nbsp;to&nbsp;Read</span><br>
<span class="lineno">395</span><span class="comment" id="1421820">//&nbsp;updates&nbsp;N&nbsp;to&nbsp;reflect&nbsp;the&nbsp;new&nbsp;amount&nbsp;remaining.</span><br>
<span class="lineno"></span><span class="keyword" id="1421870">type</span>&nbsp;<span class="ident" id="1421875">LimitedReader</span>&nbsp;<span class="keyword" id="1421889">struct</span>&nbsp;<span class="op" id="1421896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421899">R</span>&nbsp;<span class="ident" id="1421901">Reader</span>&nbsp;<span class="comment" id="1421908">//&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1421930">N</span>&nbsp;<span class="ident" id="1421932">int64</span>&nbsp;&nbsp;<span class="comment" id="1421939">//&nbsp;max&nbsp;bytes&nbsp;remaining</span><br>
<span class="lineno"></span><span class="op" id="1421962">}</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span><span class="keyword" id="1421965">func</span>&nbsp;<span class="op" id="1421970">(</span><span class="ident" id="1421971">l</span>&nbsp;<span class="op" id="1421973">*</span><span class="ident" id="1421974">LimitedReader</span><span class="op" id="1421987">)</span>&nbsp;<span class="ident" id="1421989">Read</span><span class="op" id="1421993">(</span><span class="ident" id="1421994">p</span>&nbsp;<span class="op" id="1421996">[</span><span class="op" id="1421997">]</span><span class="builtintype" id="1421998">byte</span><span class="op" id="1422002">)</span>&nbsp;<span class="op" id="1422004">(</span><span class="ident" id="1422005">n</span>&nbsp;<span class="builtintype" id="1422007">int</span><span class="op" id="1422010">,</span>&nbsp;<span class="ident" id="1422012">err</span>&nbsp;<span class="builtintype" id="1422016">error</span><span class="op" id="1422021">)</span>&nbsp;<span class="op" id="1422023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422026">if</span>&nbsp;<span class="ident" id="1422029">l</span><span class="op" id="1422030">.</span><span class="ident" id="1422031">N</span>&nbsp;<span class="op" id="1422033">&lt;=</span>&nbsp;<span class="num" id="1422036">0</span>&nbsp;<span class="op" id="1422038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422042">return</span>&nbsp;<span class="num" id="1422049">0</span><span class="op" id="1422050">,</span>&nbsp;<span class="ident" id="1422052">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1422057">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422060">if</span>&nbsp;<span class="ident" id="1422063">int64</span><span class="op" id="1422068">(</span><span class="builtinfunc" id="1422069">len</span><span class="op" id="1422072">(</span><span class="ident" id="1422073">p</span><span class="op" id="1422074">)</span><span class="op" id="1422075">)</span>&nbsp;<span class="op" id="1422077">&gt;</span>&nbsp;<span class="ident" id="1422079">l</span><span class="op" id="1422080">.</span><span class="ident" id="1422081">N</span>&nbsp;<span class="op" id="1422083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422087">p</span>&nbsp;<span class="op" id="1422089">=</span>&nbsp;<span class="ident" id="1422091">p</span><span class="op" id="1422092">[</span><span class="num" id="1422093">0</span><span class="op" id="1422094">:</span><span class="ident" id="1422095">l</span><span class="op" id="1422096">.</span><span class="ident" id="1422097">N</span><span class="op" id="1422098">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1422101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422104">n</span><span class="op" id="1422105">,</span>&nbsp;<span class="ident" id="1422107">err</span>&nbsp;<span class="op" id="1422111">=</span>&nbsp;<span class="ident" id="1422113">l</span><span class="op" id="1422114">.</span><span class="ident" id="1422115">R</span><span class="op" id="1422116">.</span><span class="ident" id="1422117">Read</span><span class="op" id="1422121">(</span><span class="ident" id="1422122">p</span><span class="op" id="1422123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422126">l</span><span class="op" id="1422127">.</span><span class="ident" id="1422128">N</span>&nbsp;<span class="op" id="1422130">-=</span>&nbsp;<span class="ident" id="1422133">int64</span><span class="op" id="1422138">(</span><span class="ident" id="1422139">n</span><span class="op" id="1422140">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422143">return</span><br>
<span class="lineno"></span><span class="op" id="1422150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1422153">//&nbsp;NewSectionReader&nbsp;returns&nbsp;a&nbsp;SectionReader&nbsp;that&nbsp;reads&nbsp;from&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="1422215">//&nbsp;starting&nbsp;at&nbsp;offset&nbsp;off&nbsp;and&nbsp;stops&nbsp;with&nbsp;EOF&nbsp;after&nbsp;n&nbsp;bytes.</span><br>
<span class="lineno">415</span><span class="keyword" id="1422275">func</span>&nbsp;<span class="ident" id="1422280">NewSectionReader</span><span class="op" id="1422296">(</span><span class="ident" id="1422297">r</span>&nbsp;<span class="ident" id="1422299">ReaderAt</span><span class="op" id="1422307">,</span>&nbsp;<span class="ident" id="1422309">off</span>&nbsp;<span class="ident" id="1422313">int64</span><span class="op" id="1422318">,</span>&nbsp;<span class="ident" id="1422320">n</span>&nbsp;<span class="ident" id="1422322">int64</span><span class="op" id="1422327">)</span>&nbsp;<span class="op" id="1422329">*</span><span class="ident" id="1422330">SectionReader</span>&nbsp;<span class="op" id="1422344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422347">return</span>&nbsp;<span class="op" id="1422354">&amp;</span><span class="ident" id="1422355">SectionReader</span><span class="op" id="1422368">{</span><span class="ident" id="1422369">r</span><span class="op" id="1422370">,</span>&nbsp;<span class="ident" id="1422372">off</span><span class="op" id="1422375">,</span>&nbsp;<span class="ident" id="1422377">off</span><span class="op" id="1422380">,</span>&nbsp;<span class="ident" id="1422382">off</span>&nbsp;<span class="op" id="1422386">+</span>&nbsp;<span class="ident" id="1422388">n</span><span class="op" id="1422389">}</span><br>
<span class="lineno"></span><span class="op" id="1422391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1422394">//&nbsp;SectionReader&nbsp;implements&nbsp;Read,&nbsp;Seek,&nbsp;and&nbsp;ReadAt&nbsp;on&nbsp;a&nbsp;section</span><br>
<span class="lineno">420</span><span class="comment" id="1422458">//&nbsp;of&nbsp;an&nbsp;underlying&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="1422488">type</span>&nbsp;<span class="ident" id="1422493">SectionReader</span>&nbsp;<span class="keyword" id="1422507">struct</span>&nbsp;<span class="op" id="1422514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422517">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1422523">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422533">base</span>&nbsp;&nbsp;<span class="ident" id="1422539">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422546">off</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1422552">int64</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422559">limit</span>&nbsp;<span class="ident" id="1422565">int64</span><br>
<span class="lineno"></span><span class="op" id="1422571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1422574">func</span>&nbsp;<span class="op" id="1422579">(</span><span class="ident" id="1422580">s</span>&nbsp;<span class="op" id="1422582">*</span><span class="ident" id="1422583">SectionReader</span><span class="op" id="1422596">)</span>&nbsp;<span class="ident" id="1422598">Read</span><span class="op" id="1422602">(</span><span class="ident" id="1422603">p</span>&nbsp;<span class="op" id="1422605">[</span><span class="op" id="1422606">]</span><span class="builtintype" id="1422607">byte</span><span class="op" id="1422611">)</span>&nbsp;<span class="op" id="1422613">(</span><span class="ident" id="1422614">n</span>&nbsp;<span class="builtintype" id="1422616">int</span><span class="op" id="1422619">,</span>&nbsp;<span class="ident" id="1422621">err</span>&nbsp;<span class="builtintype" id="1422625">error</span><span class="op" id="1422630">)</span>&nbsp;<span class="op" id="1422632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422635">if</span>&nbsp;<span class="ident" id="1422638">s</span><span class="op" id="1422639">.</span><span class="ident" id="1422640">off</span>&nbsp;<span class="op" id="1422644">&gt;=</span>&nbsp;<span class="ident" id="1422647">s</span><span class="op" id="1422648">.</span><span class="ident" id="1422649">limit</span>&nbsp;<span class="op" id="1422655">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422659">return</span>&nbsp;<span class="num" id="1422666">0</span><span class="op" id="1422667">,</span>&nbsp;<span class="ident" id="1422669">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1422674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422677">if</span>&nbsp;<span class="ident" id="1422680">max</span>&nbsp;<span class="op" id="1422684">:=</span>&nbsp;<span class="ident" id="1422687">s</span><span class="op" id="1422688">.</span><span class="ident" id="1422689">limit</span>&nbsp;<span class="op" id="1422695">-</span>&nbsp;<span class="ident" id="1422697">s</span><span class="op" id="1422698">.</span><span class="ident" id="1422699">off</span><span class="op" id="1422702">;</span>&nbsp;<span class="ident" id="1422704">int64</span><span class="op" id="1422709">(</span><span class="builtinfunc" id="1422710">len</span><span class="op" id="1422713">(</span><span class="ident" id="1422714">p</span><span class="op" id="1422715">)</span><span class="op" id="1422716">)</span>&nbsp;<span class="op" id="1422718">&gt;</span>&nbsp;<span class="ident" id="1422720">max</span>&nbsp;<span class="op" id="1422724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422728">p</span>&nbsp;<span class="op" id="1422730">=</span>&nbsp;<span class="ident" id="1422732">p</span><span class="op" id="1422733">[</span><span class="num" id="1422734">0</span><span class="op" id="1422735">:</span><span class="ident" id="1422736">max</span><span class="op" id="1422739">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1422742">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422745">n</span><span class="op" id="1422746">,</span>&nbsp;<span class="ident" id="1422748">err</span>&nbsp;<span class="op" id="1422752">=</span>&nbsp;<span class="ident" id="1422754">s</span><span class="op" id="1422755">.</span><span class="ident" id="1422756">r</span><span class="op" id="1422757">.</span><span class="ident" id="1422758">ReadAt</span><span class="op" id="1422764">(</span><span class="ident" id="1422765">p</span><span class="op" id="1422766">,</span>&nbsp;<span class="ident" id="1422768">s</span><span class="op" id="1422769">.</span><span class="ident" id="1422770">off</span><span class="op" id="1422773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1422776">s</span><span class="op" id="1422777">.</span><span class="ident" id="1422778">off</span>&nbsp;<span class="op" id="1422782">+=</span>&nbsp;<span class="ident" id="1422785">int64</span><span class="op" id="1422790">(</span><span class="ident" id="1422791">n</span><span class="op" id="1422792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422795">return</span><br>
<span class="lineno"></span><span class="op" id="1422802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="1422805">var</span>&nbsp;<span class="ident" id="1422809">errWhence</span>&nbsp;<span class="op" id="1422819">=</span>&nbsp;<span class="ident" id="1422821">errors</span><span class="op" id="1422827">.</span><span class="ident" id="1422828">New</span><span class="op" id="1422831">(</span><span class="string" id="1422832">&#34;Seek:&nbsp;invalid&nbsp;whence&#34;</span><span class="op" id="1422854">)</span><br>
<span class="lineno"></span><span class="keyword" id="1422856">var</span>&nbsp;<span class="ident" id="1422860">errOffset</span>&nbsp;<span class="op" id="1422870">=</span>&nbsp;<span class="ident" id="1422872">errors</span><span class="op" id="1422878">.</span><span class="ident" id="1422879">New</span><span class="op" id="1422882">(</span><span class="string" id="1422883">&#34;Seek:&nbsp;invalid&nbsp;offset&#34;</span><span class="op" id="1422905">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1422908">func</span>&nbsp;<span class="op" id="1422913">(</span><span class="ident" id="1422914">s</span>&nbsp;<span class="op" id="1422916">*</span><span class="ident" id="1422917">SectionReader</span><span class="op" id="1422930">)</span>&nbsp;<span class="ident" id="1422932">Seek</span><span class="op" id="1422936">(</span><span class="ident" id="1422937">offset</span>&nbsp;<span class="ident" id="1422944">int64</span><span class="op" id="1422949">,</span>&nbsp;<span class="ident" id="1422951">whence</span>&nbsp;<span class="builtintype" id="1422958">int</span><span class="op" id="1422961">)</span>&nbsp;<span class="op" id="1422963">(</span><span class="ident" id="1422964">int64</span><span class="op" id="1422969">,</span>&nbsp;<span class="builtintype" id="1422971">error</span><span class="op" id="1422976">)</span>&nbsp;<span class="op" id="1422978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422981">switch</span>&nbsp;<span class="ident" id="1422988">whence</span>&nbsp;<span class="op" id="1422995">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1422998">default</span><span class="op" id="1423005">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423009">return</span>&nbsp;<span class="num" id="1423016">0</span><span class="op" id="1423017">,</span>&nbsp;<span class="ident" id="1423019">errWhence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423030">case</span>&nbsp;<span class="num" id="1423035">0</span><span class="op" id="1423036">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423040">offset</span>&nbsp;<span class="op" id="1423047">+=</span>&nbsp;<span class="ident" id="1423050">s</span><span class="op" id="1423051">.</span><span class="ident" id="1423052">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423058">case</span>&nbsp;<span class="num" id="1423063">1</span><span class="op" id="1423064">:</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423068">offset</span>&nbsp;<span class="op" id="1423075">+=</span>&nbsp;<span class="ident" id="1423078">s</span><span class="op" id="1423079">.</span><span class="ident" id="1423080">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423085">case</span>&nbsp;<span class="num" id="1423090">2</span><span class="op" id="1423091">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423095">offset</span>&nbsp;<span class="op" id="1423102">+=</span>&nbsp;<span class="ident" id="1423105">s</span><span class="op" id="1423106">.</span><span class="ident" id="1423107">limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423117">if</span>&nbsp;<span class="ident" id="1423120">offset</span>&nbsp;<span class="op" id="1423127">&lt;</span>&nbsp;<span class="ident" id="1423129">s</span><span class="op" id="1423130">.</span><span class="ident" id="1423131">base</span>&nbsp;<span class="op" id="1423136">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423140">return</span>&nbsp;<span class="num" id="1423147">0</span><span class="op" id="1423148">,</span>&nbsp;<span class="ident" id="1423150">errOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423164">s</span><span class="op" id="1423165">.</span><span class="ident" id="1423166">off</span>&nbsp;<span class="op" id="1423170">=</span>&nbsp;<span class="ident" id="1423172">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423180">return</span>&nbsp;<span class="ident" id="1423187">offset</span>&nbsp;<span class="op" id="1423194">-</span>&nbsp;<span class="ident" id="1423196">s</span><span class="op" id="1423197">.</span><span class="ident" id="1423198">base</span><span class="op" id="1423202">,</span>&nbsp;<span class="ident" id="1423204">nil</span><br>
<span class="lineno"></span><span class="op" id="1423208">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span><span class="keyword" id="1423211">func</span>&nbsp;<span class="op" id="1423216">(</span><span class="ident" id="1423217">s</span>&nbsp;<span class="op" id="1423219">*</span><span class="ident" id="1423220">SectionReader</span><span class="op" id="1423233">)</span>&nbsp;<span class="ident" id="1423235">ReadAt</span><span class="op" id="1423241">(</span><span class="ident" id="1423242">p</span>&nbsp;<span class="op" id="1423244">[</span><span class="op" id="1423245">]</span><span class="builtintype" id="1423246">byte</span><span class="op" id="1423250">,</span>&nbsp;<span class="ident" id="1423252">off</span>&nbsp;<span class="ident" id="1423256">int64</span><span class="op" id="1423261">)</span>&nbsp;<span class="op" id="1423263">(</span><span class="ident" id="1423264">n</span>&nbsp;<span class="builtintype" id="1423266">int</span><span class="op" id="1423269">,</span>&nbsp;<span class="ident" id="1423271">err</span>&nbsp;<span class="builtintype" id="1423275">error</span><span class="op" id="1423280">)</span>&nbsp;<span class="op" id="1423282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423285">if</span>&nbsp;<span class="ident" id="1423288">off</span>&nbsp;<span class="op" id="1423292">&lt;</span>&nbsp;<span class="num" id="1423294">0</span>&nbsp;<span class="op" id="1423296">||</span>&nbsp;<span class="ident" id="1423299">off</span>&nbsp;<span class="op" id="1423303">&gt;=</span>&nbsp;<span class="ident" id="1423306">s</span><span class="op" id="1423307">.</span><span class="ident" id="1423308">limit</span><span class="op" id="1423313">-</span><span class="ident" id="1423314">s</span><span class="op" id="1423315">.</span><span class="ident" id="1423316">base</span>&nbsp;<span class="op" id="1423321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423325">return</span>&nbsp;<span class="num" id="1423332">0</span><span class="op" id="1423333">,</span>&nbsp;<span class="ident" id="1423335">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423340">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423343">off</span>&nbsp;<span class="op" id="1423347">+=</span>&nbsp;<span class="ident" id="1423350">s</span><span class="op" id="1423351">.</span><span class="ident" id="1423352">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423358">if</span>&nbsp;<span class="ident" id="1423361">max</span>&nbsp;<span class="op" id="1423365">:=</span>&nbsp;<span class="ident" id="1423368">s</span><span class="op" id="1423369">.</span><span class="ident" id="1423370">limit</span>&nbsp;<span class="op" id="1423376">-</span>&nbsp;<span class="ident" id="1423378">off</span><span class="op" id="1423381">;</span>&nbsp;<span class="ident" id="1423383">int64</span><span class="op" id="1423388">(</span><span class="builtinfunc" id="1423389">len</span><span class="op" id="1423392">(</span><span class="ident" id="1423393">p</span><span class="op" id="1423394">)</span><span class="op" id="1423395">)</span>&nbsp;<span class="op" id="1423397">&gt;</span>&nbsp;<span class="ident" id="1423399">max</span>&nbsp;<span class="op" id="1423403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423407">p</span>&nbsp;<span class="op" id="1423409">=</span>&nbsp;<span class="ident" id="1423411">p</span><span class="op" id="1423412">[</span><span class="num" id="1423413">0</span><span class="op" id="1423414">:</span><span class="ident" id="1423415">max</span><span class="op" id="1423418">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423422">n</span><span class="op" id="1423423">,</span>&nbsp;<span class="ident" id="1423425">err</span>&nbsp;<span class="op" id="1423429">=</span>&nbsp;<span class="ident" id="1423431">s</span><span class="op" id="1423432">.</span><span class="ident" id="1423433">r</span><span class="op" id="1423434">.</span><span class="ident" id="1423435">ReadAt</span><span class="op" id="1423441">(</span><span class="ident" id="1423442">p</span><span class="op" id="1423443">,</span>&nbsp;<span class="ident" id="1423445">off</span><span class="op" id="1423448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423452">if</span>&nbsp;<span class="ident" id="1423455">err</span>&nbsp;<span class="op" id="1423459">==</span>&nbsp;<span class="ident" id="1423462">nil</span>&nbsp;<span class="op" id="1423466">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1423471">err</span>&nbsp;<span class="op" id="1423475">=</span>&nbsp;<span class="ident" id="1423477">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423487">return</span>&nbsp;<span class="ident" id="1423494">n</span><span class="op" id="1423495">,</span>&nbsp;<span class="ident" id="1423497">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1423502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1423505">return</span>&nbsp;<span class="ident" id="1423512">s</span><span class="op" id="1423513">.</span><span class="ident" id="1423514">r</span><span class="op" id="1423515">.</span><span class="ident" id="1423516">ReadAt</span><span class="op" id="1423522">(</span><span class="ident" id="1423523">p</span><span class="op" id="1423524">,</span>&nbsp;<span class="ident" id="1423526">off</span><span class="op" id="1423529">)</span><br>
<span class="lineno">475</span><span class="op" id="1423531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1423534">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;section&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1423584">func</span>&nbsp;<span class="op" id="1423589">(</span><span class="ident" id="1423590">s</span>&nbsp;<span class="op" id="1423592">*</span><span class="ident" id="1423593">SectionReader</span><span class="op" id="1423606">)</span>&nbsp;<span class="ident" id="1423608">Size</span><span class="op" id="1423612">(</span><span class="op" id="1423613">)</span>&nbsp;<span class="ident" id="1423615">int64</span>&nbsp;<span class="op" id="1423621">{</span>&nbsp;<span class="keyword" id="1423623">return</span>&nbsp;<span class="ident" id="1423630">s</span><span class="op" id="1423631">.</span><span class="ident" id="1423632">limit</span>&nbsp;<span class="op" id="1423638">-</span>&nbsp;<span class="ident" id="1423640">s</span><span class="op" id="1423641">.</span><span class="ident" id="1423642">base</span>&nbsp;<span class="op" id="1423647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="1423650">//&nbsp;TeeReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;writes&nbsp;to&nbsp;w&nbsp;what&nbsp;it&nbsp;reads&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="1423719">//&nbsp;All&nbsp;reads&nbsp;from&nbsp;r&nbsp;performed&nbsp;through&nbsp;it&nbsp;are&nbsp;matched&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1423777">//&nbsp;corresponding&nbsp;writes&nbsp;to&nbsp;w.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;internal&nbsp;buffering&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="1423841">//&nbsp;the&nbsp;write&nbsp;must&nbsp;complete&nbsp;before&nbsp;the&nbsp;read&nbsp;completes.</span><br>
<span class="lineno"></span><span class="comment" id="1423895">//&nbsp;Any&nbsp;error&nbsp;encountered&nbsp;while&nbsp;writing&nbsp;is&nbsp;reported&nbsp;as&nbsp;a&nbsp;read&nbsp;error.</span><br>
<span class="lineno">485</span><span class="keyword" id="1423963">func</span>&nbsp;<span class="ident" id="1423968">TeeReader</span><span class="op" id="1423977">(</span><span class="ident" id="1423978">r</span>&nbsp;<span class="ident" id="1423980">Reader</span><span class="op" id="1423986">,</span>&nbsp;<span class="ident" id="1423988">w</span>&nbsp;<span class="ident" id="1423990">Writer</span><span class="op" id="1423996">)</span>&nbsp;<span class="ident" id="1423998">Reader</span>&nbsp;<span class="op" id="1424005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424008">return</span>&nbsp;<span class="op" id="1424015">&amp;</span><span class="ident" id="1424016">teeReader</span><span class="op" id="1424025">{</span><span class="ident" id="1424026">r</span><span class="op" id="1424027">,</span>&nbsp;<span class="ident" id="1424029">w</span><span class="op" id="1424030">}</span><br>
<span class="lineno"></span><span class="op" id="1424032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1424035">type</span>&nbsp;<span class="ident" id="1424040">teeReader</span>&nbsp;<span class="keyword" id="1424050">struct</span>&nbsp;<span class="op" id="1424057">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1424060">r</span>&nbsp;<span class="ident" id="1424062">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1424070">w</span>&nbsp;<span class="ident" id="1424072">Writer</span><br>
<span class="lineno"></span><span class="op" id="1424079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1424082">func</span>&nbsp;<span class="op" id="1424087">(</span><span class="ident" id="1424088">t</span>&nbsp;<span class="op" id="1424090">*</span><span class="ident" id="1424091">teeReader</span><span class="op" id="1424100">)</span>&nbsp;<span class="ident" id="1424102">Read</span><span class="op" id="1424106">(</span><span class="ident" id="1424107">p</span>&nbsp;<span class="op" id="1424109">[</span><span class="op" id="1424110">]</span><span class="builtintype" id="1424111">byte</span><span class="op" id="1424115">)</span>&nbsp;<span class="op" id="1424117">(</span><span class="ident" id="1424118">n</span>&nbsp;<span class="builtintype" id="1424120">int</span><span class="op" id="1424123">,</span>&nbsp;<span class="ident" id="1424125">err</span>&nbsp;<span class="builtintype" id="1424129">error</span><span class="op" id="1424134">)</span>&nbsp;<span class="op" id="1424136">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1424139">n</span><span class="op" id="1424140">,</span>&nbsp;<span class="ident" id="1424142">err</span>&nbsp;<span class="op" id="1424146">=</span>&nbsp;<span class="ident" id="1424148">t</span><span class="op" id="1424149">.</span><span class="ident" id="1424150">r</span><span class="op" id="1424151">.</span><span class="ident" id="1424152">Read</span><span class="op" id="1424156">(</span><span class="ident" id="1424157">p</span><span class="op" id="1424158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424161">if</span>&nbsp;<span class="ident" id="1424164">n</span>&nbsp;<span class="op" id="1424166">&gt;</span>&nbsp;<span class="num" id="1424168">0</span>&nbsp;<span class="op" id="1424170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424174">if</span>&nbsp;<span class="ident" id="1424177">n</span><span class="op" id="1424178">,</span>&nbsp;<span class="ident" id="1424180">err</span>&nbsp;<span class="op" id="1424184">:=</span>&nbsp;<span class="ident" id="1424187">t</span><span class="op" id="1424188">.</span><span class="ident" id="1424189">w</span><span class="op" id="1424190">.</span><span class="ident" id="1424191">Write</span><span class="op" id="1424196">(</span><span class="ident" id="1424197">p</span><span class="op" id="1424198">[</span><span class="op" id="1424199">:</span><span class="ident" id="1424200">n</span><span class="op" id="1424201">]</span><span class="op" id="1424202">)</span><span class="op" id="1424203">;</span>&nbsp;<span class="ident" id="1424205">err</span>&nbsp;<span class="op" id="1424209">!=</span>&nbsp;<span class="ident" id="1424212">nil</span>&nbsp;<span class="op" id="1424216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424221">return</span>&nbsp;<span class="ident" id="1424228">n</span><span class="op" id="1424229">,</span>&nbsp;<span class="ident" id="1424231">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1424237">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1424240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1424243">return</span><br>
<span class="lineno"></span><span class="op" id="1424250">}</span>
</div>
</body>
</html>
