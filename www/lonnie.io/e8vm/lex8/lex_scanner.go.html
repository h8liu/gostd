<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5840023">package</span>&nbsp;<span class="ident" id="5840031">lex8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5840037">import</span>&nbsp;<span class="op" id="5840044">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5840047">&#34;bytes&#34;</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5840056">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5840061">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5840064">//&nbsp;LexScanner&nbsp;parses&nbsp;a&nbsp;file&nbsp;input&nbsp;stream&nbsp;into&nbsp;tokens.</span><br>
<span class="lineno"></span><span class="keyword" id="5840118">type</span>&nbsp;<span class="ident" id="5840123">LexScanner</span>&nbsp;<span class="keyword" id="5840134">struct</span>&nbsp;<span class="op" id="5840141">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840144">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5840150">*</span><span class="ident" id="5840151">RuneScanner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840164">errs</span>&nbsp;&nbsp;<span class="op" id="5840170">*</span><span class="ident" id="5840171">ErrorList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840182">valid</span>&nbsp;<span class="builtintype" id="5840188">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840195">pos</span>&nbsp;<span class="op" id="5840199">*</span><span class="ident" id="5840200">Pos</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840205">buf</span>&nbsp;<span class="op" id="5840209">*</span><span class="ident" id="5840210">bytes</span><span class="op" id="5840215">.</span><span class="ident" id="5840216">Buffer</span><br>
<span class="lineno"></span><span class="op" id="5840223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5840226">//&nbsp;NewLexScanner&nbsp;creates&nbsp;a&nbsp;new&nbsp;lexer.</span><br>
<span class="lineno"></span><span class="keyword" id="5840264">func</span>&nbsp;<span class="ident" id="5840269">NewLexScanner</span><span class="op" id="5840282">(</span><span class="ident" id="5840283">file</span>&nbsp;<span class="builtintype" id="5840288">string</span><span class="op" id="5840294">,</span>&nbsp;<span class="ident" id="5840296">rc</span>&nbsp;<span class="ident" id="5840299">io</span><span class="op" id="5840301">.</span><span class="ident" id="5840302">ReadCloser</span><span class="op" id="5840312">)</span>&nbsp;<span class="op" id="5840314">*</span><span class="ident" id="5840315">LexScanner</span>&nbsp;<span class="op" id="5840326">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840329">ret</span>&nbsp;<span class="op" id="5840333">:=</span>&nbsp;<span class="builtinfunc" id="5840336">new</span><span class="op" id="5840339">(</span><span class="ident" id="5840340">LexScanner</span><span class="op" id="5840350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840353">ret</span><span class="op" id="5840356">.</span><span class="ident" id="5840357">s</span>&nbsp;<span class="op" id="5840359">=</span>&nbsp;<span class="ident" id="5840361">NewRuneScanner</span><span class="op" id="5840375">(</span><span class="ident" id="5840376">file</span><span class="op" id="5840380">,</span>&nbsp;<span class="ident" id="5840382">rc</span><span class="op" id="5840384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840387">ret</span><span class="op" id="5840390">.</span><span class="ident" id="5840391">errs</span>&nbsp;<span class="op" id="5840396">=</span>&nbsp;<span class="ident" id="5840398">NewErrList</span><span class="op" id="5840408">(</span><span class="op" id="5840409">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840413">ret</span><span class="op" id="5840416">.</span><span class="ident" id="5840417">buf</span>&nbsp;<span class="op" id="5840421">=</span>&nbsp;<span class="builtinfunc" id="5840423">new</span><span class="op" id="5840426">(</span><span class="ident" id="5840427">bytes</span><span class="op" id="5840432">.</span><span class="ident" id="5840433">Buffer</span><span class="op" id="5840439">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840442">ret</span><span class="op" id="5840445">.</span><span class="ident" id="5840446">pos</span>&nbsp;<span class="op" id="5840450">=</span>&nbsp;<span class="ident" id="5840452">ret</span><span class="op" id="5840455">.</span><span class="ident" id="5840456">s</span><span class="op" id="5840457">.</span><span class="ident" id="5840458">Pos</span><span class="op" id="5840461">(</span><span class="op" id="5840462">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840466">return</span>&nbsp;<span class="ident" id="5840473">ret</span><br>
<span class="lineno"></span><span class="op" id="5840477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="5840480">//&nbsp;Next&nbsp;pushes&nbsp;the&nbsp;current&nbsp;rune&nbsp;(if&nbsp;valid)&nbsp;into&nbsp;the&nbsp;buffer,</span><br>
<span class="lineno"></span><span class="comment" id="5840540">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;or&nbsp;error&nbsp;from&nbsp;scanning&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="5840602">//&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="5840613">func</span>&nbsp;<span class="op" id="5840618">(</span><span class="ident" id="5840619">s</span>&nbsp;<span class="op" id="5840621">*</span><span class="ident" id="5840622">LexScanner</span><span class="op" id="5840632">)</span>&nbsp;<span class="ident" id="5840634">Next</span><span class="op" id="5840638">(</span><span class="op" id="5840639">)</span>&nbsp;<span class="op" id="5840641">(</span><span class="builtintype" id="5840642">rune</span><span class="op" id="5840646">,</span>&nbsp;<span class="builtintype" id="5840648">error</span><span class="op" id="5840653">)</span>&nbsp;<span class="op" id="5840655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840658">if</span>&nbsp;<span class="ident" id="5840661">s</span><span class="op" id="5840662">.</span><span class="ident" id="5840663">valid</span>&nbsp;<span class="op" id="5840669">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840673">s</span><span class="op" id="5840674">.</span><span class="ident" id="5840675">buf</span><span class="op" id="5840678">.</span><span class="ident" id="5840679">WriteRune</span><span class="op" id="5840688">(</span><span class="ident" id="5840689">s</span><span class="op" id="5840690">.</span><span class="ident" id="5840691">s</span><span class="op" id="5840692">.</span><span class="ident" id="5840693">Rune</span><span class="op" id="5840697">)</span>&nbsp;<span class="comment" id="5840699">//&nbsp;push&nbsp;into&nbsp;the&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840725">s</span><span class="op" id="5840726">.</span><span class="ident" id="5840727">valid</span>&nbsp;<span class="op" id="5840733">=</span>&nbsp;<span class="ident" id="5840735">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5840742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840746">if</span>&nbsp;<span class="op" id="5840749">!</span><span class="ident" id="5840750">s</span><span class="op" id="5840751">.</span><span class="ident" id="5840752">s</span><span class="op" id="5840753">.</span><span class="ident" id="5840754">Scan</span><span class="op" id="5840758">(</span><span class="op" id="5840759">)</span>&nbsp;<span class="op" id="5840761">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840765">if</span>&nbsp;<span class="ident" id="5840768">s</span><span class="op" id="5840769">.</span><span class="ident" id="5840770">s</span><span class="op" id="5840771">.</span><span class="ident" id="5840772">Err</span>&nbsp;<span class="op" id="5840776">!=</span>&nbsp;<span class="ident" id="5840779">nil</span>&nbsp;<span class="op" id="5840783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840788">return</span>&nbsp;<span class="num" id="5840795">0</span><span class="op" id="5840796">,</span>&nbsp;<span class="ident" id="5840798">s</span><span class="op" id="5840799">.</span><span class="ident" id="5840800">s</span><span class="op" id="5840801">.</span><span class="ident" id="5840802">Err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5840808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840813">return</span>&nbsp;<span class="num" id="5840820">0</span><span class="op" id="5840821">,</span>&nbsp;<span class="ident" id="5840823">io</span><span class="op" id="5840825">.</span><span class="ident" id="5840826">EOF</span>&nbsp;<span class="comment" id="5840830">//&nbsp;signal&nbsp;end&nbsp;of&nbsp;file</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5840853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840857">s</span><span class="op" id="5840858">.</span><span class="ident" id="5840859">valid</span>&nbsp;<span class="op" id="5840865">=</span>&nbsp;<span class="ident" id="5840867">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840873">return</span>&nbsp;<span class="ident" id="5840880">s</span><span class="op" id="5840881">.</span><span class="ident" id="5840882">s</span><span class="op" id="5840883">.</span><span class="ident" id="5840884">Rune</span><span class="op" id="5840888">,</span>&nbsp;<span class="ident" id="5840890">nil</span><br>
<span class="lineno"></span><span class="op" id="5840894">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="5840897">//&nbsp;Accept&nbsp;returns&nbsp;the&nbsp;string&nbsp;buffered,&nbsp;and&nbsp;the&nbsp;starting&nbsp;position</span><br>
<span class="lineno"></span><span class="comment" id="5840962">//&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5840980">func</span>&nbsp;<span class="op" id="5840985">(</span><span class="ident" id="5840986">s</span>&nbsp;<span class="op" id="5840988">*</span><span class="ident" id="5840989">LexScanner</span><span class="op" id="5840999">)</span>&nbsp;<span class="ident" id="5841001">Accept</span><span class="op" id="5841007">(</span><span class="op" id="5841008">)</span>&nbsp;<span class="op" id="5841010">(</span><span class="builtintype" id="5841011">string</span><span class="op" id="5841017">,</span>&nbsp;<span class="op" id="5841019">*</span><span class="ident" id="5841020">Pos</span><span class="op" id="5841023">)</span>&nbsp;<span class="op" id="5841025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841028">ret</span>&nbsp;<span class="op" id="5841032">:=</span>&nbsp;<span class="ident" id="5841035">s</span><span class="op" id="5841036">.</span><span class="ident" id="5841037">buf</span><span class="op" id="5841040">.</span><span class="ident" id="5841041">String</span><span class="op" id="5841047">(</span><span class="op" id="5841048">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841051">s</span><span class="op" id="5841052">.</span><span class="ident" id="5841053">buf</span><span class="op" id="5841056">.</span><span class="ident" id="5841057">Reset</span><span class="op" id="5841062">(</span><span class="op" id="5841063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841066">pos</span>&nbsp;<span class="op" id="5841070">:=</span>&nbsp;<span class="ident" id="5841073">s</span><span class="op" id="5841074">.</span><span class="ident" id="5841075">pos</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841081">s</span><span class="op" id="5841082">.</span><span class="ident" id="5841083">pos</span>&nbsp;<span class="op" id="5841087">=</span>&nbsp;<span class="ident" id="5841089">s</span><span class="op" id="5841090">.</span><span class="ident" id="5841091">s</span><span class="op" id="5841092">.</span><span class="ident" id="5841093">Pos</span><span class="op" id="5841096">(</span><span class="op" id="5841097">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5841101">return</span>&nbsp;<span class="ident" id="5841108">ret</span><span class="op" id="5841111">,</span>&nbsp;<span class="ident" id="5841113">pos</span><br>
<span class="lineno"></span><span class="op" id="5841117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5841120">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;buffer&nbsp;start.</span><br>
<span class="lineno"></span><span class="keyword" id="5841169">func</span>&nbsp;<span class="op" id="5841174">(</span><span class="ident" id="5841175">s</span>&nbsp;<span class="op" id="5841177">*</span><span class="ident" id="5841178">LexScanner</span><span class="op" id="5841188">)</span>&nbsp;<span class="ident" id="5841190">Pos</span><span class="op" id="5841193">(</span><span class="op" id="5841194">)</span>&nbsp;<span class="op" id="5841196">*</span><span class="ident" id="5841197">Pos</span>&nbsp;<span class="op" id="5841201">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5841204">return</span>&nbsp;<span class="ident" id="5841211">s</span><span class="op" id="5841212">.</span><span class="ident" id="5841213">pos</span><br>
<span class="lineno"></span><span class="op" id="5841217">}</span>
</div>
</body>
</html>
