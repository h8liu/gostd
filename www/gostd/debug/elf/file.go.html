<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/elf</h2>
<ul>
<li><a href="/gostd/debug/elf/elf.go.html">elf.go</a></li>
<li><a href="/gostd/debug/elf/elf_test.go.html">elf_test.go</a></li>
<li><a href="/gostd/debug/elf/file.go.html">file.go</a></li>
<li><a href="/gostd/debug/elf/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/elf/symbols_test.go.html">symbols_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5861264">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5861320">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5861374">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5861425">//&nbsp;Package&nbsp;elf&nbsp;implements&nbsp;access&nbsp;to&nbsp;ELF&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5861479">package</span>&nbsp;<span class="ident" id="5861487">elf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5861492">import</span>&nbsp;<span class="op" id="5861499">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5861502">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5861511">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5861526">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5861545">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5861555">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5861562">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5861568">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="5861573">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5861576">//&nbsp;TODO:&nbsp;error&nbsp;reporting&nbsp;detail</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5861609">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Internal&nbsp;ELF&nbsp;representation<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5861648">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;an&nbsp;ELF&nbsp;file&nbsp;header.</span><br>
<span class="lineno">25</span><span class="keyword" id="5861695">type</span>&nbsp;<span class="ident" id="5861700">FileHeader</span>&nbsp;<span class="keyword" id="5861711">struct</span>&nbsp;<span class="op" id="5861718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861721">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861732">Class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861739">Data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861750">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861756">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861767">Version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861776">OSABI</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861787">OSABI</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861794">ABIVersion</span>&nbsp;<span class="builtintype" id="5861805">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861812">ByteOrder</span>&nbsp;&nbsp;<span class="ident" id="5861823">binary</span><span class="op" id="5861829">.</span><span class="ident" id="5861830">ByteOrder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861841">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861852">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861858">Machine</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861869">Machine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861878">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5861889">uint64</span><br>
<span class="lineno">35</span><span class="op" id="5861896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5861899">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5861938">type</span>&nbsp;<span class="ident" id="5861943">File</span>&nbsp;<span class="keyword" id="5861948">struct</span>&nbsp;<span class="op" id="5861955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861958">FileHeader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861970">Sections</span>&nbsp;&nbsp;<span class="op" id="5861980">[</span><span class="op" id="5861981">]</span><span class="op" id="5861982">*</span><span class="ident" id="5861983">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5861992">Progs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5862002">[</span><span class="op" id="5862003">]</span><span class="op" id="5862004">*</span><span class="ident" id="5862005">Prog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862011">closer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862021">io</span><span class="op" id="5862023">.</span><span class="ident" id="5862024">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862032">gnuNeed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5862042">[</span><span class="op" id="5862043">]</span><span class="ident" id="5862044">verneed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862053">gnuVersym</span>&nbsp;<span class="op" id="5862063">[</span><span class="op" id="5862064">]</span><span class="builtintype" id="5862065">byte</span><br>
<span class="lineno">45</span><span class="op" id="5862070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5862073">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5862132">type</span>&nbsp;<span class="ident" id="5862137">SectionHeader</span>&nbsp;<span class="keyword" id="5862151">struct</span>&nbsp;<span class="op" id="5862158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862161">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862171">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862179">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862189">SectionType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862202">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862212">SectionFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862225">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862235">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862243">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862253">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862261">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5862271">uint64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862279">Link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862289">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862297">Info</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5862307">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862315">Addralign</span>&nbsp;<span class="ident" id="5862325">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862333">Entsize</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5862343">uint64</span><br>
<span class="lineno"></span><span class="op" id="5862350">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5862353">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;an&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5862410">type</span>&nbsp;<span class="ident" id="5862415">Section</span>&nbsp;<span class="keyword" id="5862423">struct</span>&nbsp;<span class="op" id="5862430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862433">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5862449">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5862487">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5862527">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5862562">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5862610">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5862660">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862684">io</span><span class="op" id="5862686">.</span><span class="ident" id="5862687">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862697">sr</span>&nbsp;<span class="op" id="5862700">*</span><span class="ident" id="5862701">io</span><span class="op" id="5862703">.</span><span class="ident" id="5862704">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5862718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="5862721">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5862780">func</span>&nbsp;<span class="op" id="5862785">(</span><span class="ident" id="5862786">s</span>&nbsp;<span class="op" id="5862788">*</span><span class="ident" id="5862789">Section</span><span class="op" id="5862796">)</span>&nbsp;<span class="ident" id="5862798">Data</span><span class="op" id="5862802">(</span><span class="op" id="5862803">)</span>&nbsp;<span class="op" id="5862805">(</span><span class="op" id="5862806">[</span><span class="op" id="5862807">]</span><span class="builtintype" id="5862808">byte</span><span class="op" id="5862812">,</span>&nbsp;<span class="builtintype" id="5862814">error</span><span class="op" id="5862819">)</span>&nbsp;<span class="op" id="5862821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862824">dat</span>&nbsp;<span class="op" id="5862828">:=</span>&nbsp;<span class="builtinfunc" id="5862831">make</span><span class="op" id="5862835">(</span><span class="op" id="5862836">[</span><span class="op" id="5862837">]</span><span class="builtintype" id="5862838">byte</span><span class="op" id="5862842">,</span>&nbsp;<span class="ident" id="5862844">s</span><span class="op" id="5862845">.</span><span class="ident" id="5862846">sr</span><span class="op" id="5862848">.</span><span class="ident" id="5862849">Size</span><span class="op" id="5862853">(</span><span class="op" id="5862854">)</span><span class="op" id="5862855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862858">n</span><span class="op" id="5862859">,</span>&nbsp;<span class="ident" id="5862861">err</span>&nbsp;<span class="op" id="5862865">:=</span>&nbsp;<span class="ident" id="5862868">s</span><span class="op" id="5862869">.</span><span class="ident" id="5862870">sr</span><span class="op" id="5862872">.</span><span class="ident" id="5862873">ReadAt</span><span class="op" id="5862879">(</span><span class="ident" id="5862880">dat</span><span class="op" id="5862883">,</span>&nbsp;<span class="num" id="5862885">0</span><span class="op" id="5862886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5862889">if</span>&nbsp;<span class="ident" id="5862892">n</span>&nbsp;<span class="op" id="5862894">==</span>&nbsp;<span class="builtinfunc" id="5862897">len</span><span class="op" id="5862900">(</span><span class="ident" id="5862901">dat</span><span class="op" id="5862904">)</span>&nbsp;<span class="op" id="5862906">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5862910">err</span>&nbsp;<span class="op" id="5862914">=</span>&nbsp;<span class="ident" id="5862916">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5862921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5862924">return</span>&nbsp;<span class="ident" id="5862931">dat</span><span class="op" id="5862934">[</span><span class="num" id="5862935">0</span><span class="op" id="5862936">:</span><span class="ident" id="5862937">n</span><span class="op" id="5862938">]</span><span class="op" id="5862939">,</span>&nbsp;<span class="ident" id="5862941">err</span><br>
<span class="lineno"></span><span class="op" id="5862945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="5862948">//&nbsp;stringTable&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;string&nbsp;table&nbsp;given&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5863011">//&nbsp;specified&nbsp;link&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5863036">func</span>&nbsp;<span class="op" id="5863041">(</span><span class="ident" id="5863042">f</span>&nbsp;<span class="op" id="5863044">*</span><span class="ident" id="5863045">File</span><span class="op" id="5863049">)</span>&nbsp;<span class="ident" id="5863051">stringTable</span><span class="op" id="5863062">(</span><span class="ident" id="5863063">link</span>&nbsp;<span class="builtintype" id="5863068">uint32</span><span class="op" id="5863074">)</span>&nbsp;<span class="op" id="5863076">(</span><span class="op" id="5863077">[</span><span class="op" id="5863078">]</span><span class="builtintype" id="5863079">byte</span><span class="op" id="5863083">,</span>&nbsp;<span class="builtintype" id="5863085">error</span><span class="op" id="5863090">)</span>&nbsp;<span class="op" id="5863092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5863095">if</span>&nbsp;<span class="ident" id="5863098">link</span>&nbsp;<span class="op" id="5863103">&lt;=</span>&nbsp;<span class="num" id="5863106">0</span>&nbsp;<span class="op" id="5863108">||</span>&nbsp;<span class="ident" id="5863111">link</span>&nbsp;<span class="op" id="5863116">&gt;=</span>&nbsp;<span class="builtintype" id="5863119">uint32</span><span class="op" id="5863125">(</span><span class="builtinfunc" id="5863126">len</span><span class="op" id="5863129">(</span><span class="ident" id="5863130">f</span><span class="op" id="5863131">.</span><span class="ident" id="5863132">Sections</span><span class="op" id="5863140">)</span><span class="op" id="5863141">)</span>&nbsp;<span class="op" id="5863143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5863147">return</span>&nbsp;<span class="ident" id="5863154">nil</span><span class="op" id="5863157">,</span>&nbsp;<span class="ident" id="5863159">errors</span><span class="op" id="5863165">.</span><span class="ident" id="5863166">New</span><span class="op" id="5863169">(</span><span class="string" id="5863170">&#34;section&nbsp;has&nbsp;invalid&nbsp;string&nbsp;table&nbsp;link&#34;</span><span class="op" id="5863209">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5863212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5863215">return</span>&nbsp;<span class="ident" id="5863222">f</span><span class="op" id="5863223">.</span><span class="ident" id="5863224">Sections</span><span class="op" id="5863232">[</span><span class="ident" id="5863233">link</span><span class="op" id="5863237">]</span><span class="op" id="5863238">.</span><span class="ident" id="5863239">Data</span><span class="op" id="5863243">(</span><span class="op" id="5863244">)</span><br>
<span class="lineno"></span><span class="op" id="5863246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5863249">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno">95</span><span class="keyword" id="5863307">func</span>&nbsp;<span class="op" id="5863312">(</span><span class="ident" id="5863313">s</span>&nbsp;<span class="op" id="5863315">*</span><span class="ident" id="5863316">Section</span><span class="op" id="5863323">)</span>&nbsp;<span class="ident" id="5863325">Open</span><span class="op" id="5863329">(</span><span class="op" id="5863330">)</span>&nbsp;<span class="ident" id="5863332">io</span><span class="op" id="5863334">.</span><span class="ident" id="5863335">ReadSeeker</span>&nbsp;<span class="op" id="5863346">{</span>&nbsp;<span class="keyword" id="5863348">return</span>&nbsp;<span class="ident" id="5863355">io</span><span class="op" id="5863357">.</span><span class="ident" id="5863358">NewSectionReader</span><span class="op" id="5863374">(</span><span class="ident" id="5863375">s</span><span class="op" id="5863376">.</span><span class="ident" id="5863377">sr</span><span class="op" id="5863379">,</span>&nbsp;<span class="num" id="5863381">0</span><span class="op" id="5863382">,</span>&nbsp;<span class="num" id="5863384">1</span><span class="op" id="5863385">&lt;&lt;</span><span class="num" id="5863387">63</span><span class="op" id="5863389">-</span><span class="num" id="5863390">1</span><span class="op" id="5863391">)</span>&nbsp;<span class="op" id="5863393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5863396">//&nbsp;A&nbsp;ProgHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5863452">type</span>&nbsp;<span class="ident" id="5863457">ProgHeader</span>&nbsp;<span class="keyword" id="5863468">struct</span>&nbsp;<span class="op" id="5863475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863478">Type</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5863485">ProgType</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863495">Flags</span>&nbsp;&nbsp;<span class="ident" id="5863502">ProgFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863512">Off</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5863519">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863527">Vaddr</span>&nbsp;&nbsp;<span class="ident" id="5863534">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863542">Paddr</span>&nbsp;&nbsp;<span class="ident" id="5863549">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863557">Filesz</span>&nbsp;<span class="ident" id="5863564">uint64</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863572">Memsz</span>&nbsp;&nbsp;<span class="ident" id="5863579">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863587">Align</span>&nbsp;&nbsp;<span class="ident" id="5863594">uint64</span><br>
<span class="lineno"></span><span class="op" id="5863601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5863604">//&nbsp;A&nbsp;Prog&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header&nbsp;in&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno">110</span><span class="keyword" id="5863671">type</span>&nbsp;<span class="ident" id="5863676">Prog</span>&nbsp;<span class="keyword" id="5863681">struct</span>&nbsp;<span class="op" id="5863688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863691">ProgHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5863704">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5863742">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5863782">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5863817">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5863865">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5863915">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863939">io</span><span class="op" id="5863941">.</span><span class="ident" id="5863942">ReaderAt</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5863952">sr</span>&nbsp;<span class="op" id="5863955">*</span><span class="ident" id="5863956">io</span><span class="op" id="5863958">.</span><span class="ident" id="5863959">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5863973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5863976">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;program&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="5864039">func</span>&nbsp;<span class="op" id="5864044">(</span><span class="ident" id="5864045">p</span>&nbsp;<span class="op" id="5864047">*</span><span class="ident" id="5864048">Prog</span><span class="op" id="5864052">)</span>&nbsp;<span class="ident" id="5864054">Open</span><span class="op" id="5864058">(</span><span class="op" id="5864059">)</span>&nbsp;<span class="ident" id="5864061">io</span><span class="op" id="5864063">.</span><span class="ident" id="5864064">ReadSeeker</span>&nbsp;<span class="op" id="5864075">{</span>&nbsp;<span class="keyword" id="5864077">return</span>&nbsp;<span class="ident" id="5864084">io</span><span class="op" id="5864086">.</span><span class="ident" id="5864087">NewSectionReader</span><span class="op" id="5864103">(</span><span class="ident" id="5864104">p</span><span class="op" id="5864105">.</span><span class="ident" id="5864106">sr</span><span class="op" id="5864108">,</span>&nbsp;<span class="num" id="5864110">0</span><span class="op" id="5864111">,</span>&nbsp;<span class="num" id="5864113">1</span><span class="op" id="5864114">&lt;&lt;</span><span class="num" id="5864116">63</span><span class="op" id="5864118">-</span><span class="num" id="5864119">1</span><span class="op" id="5864120">)</span>&nbsp;<span class="op" id="5864122">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5864125">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;an&nbsp;ELF&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5864189">type</span>&nbsp;<span class="ident" id="5864194">Symbol</span>&nbsp;<span class="keyword" id="5864201">struct</span>&nbsp;<span class="op" id="5864208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864211">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5864223">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864231">Info</span><span class="op" id="5864235">,</span>&nbsp;<span class="ident" id="5864237">Other</span>&nbsp;<span class="builtintype" id="5864243">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864249">Section</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5864261">SectionIndex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864275">Value</span><span class="op" id="5864280">,</span>&nbsp;<span class="ident" id="5864282">Size</span>&nbsp;<span class="ident" id="5864287">uint64</span><br>
<span class="lineno"></span><span class="op" id="5864294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5864297">/*<br>
<span class="lineno">135</span>&nbsp;*&nbsp;ELF&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5864319">type</span>&nbsp;<span class="ident" id="5864324">FormatError</span>&nbsp;<span class="keyword" id="5864336">struct</span>&nbsp;<span class="op" id="5864343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864346">off</span>&nbsp;<span class="ident" id="5864350">int64</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864357">msg</span>&nbsp;<span class="builtintype" id="5864361">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864369">val</span>&nbsp;<span class="keyword" id="5864373">interface</span><span class="op" id="5864382">{</span><span class="op" id="5864383">}</span><br>
<span class="lineno"></span><span class="op" id="5864385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5864388">func</span>&nbsp;<span class="op" id="5864393">(</span><span class="ident" id="5864394">e</span>&nbsp;<span class="op" id="5864396">*</span><span class="ident" id="5864397">FormatError</span><span class="op" id="5864408">)</span>&nbsp;<span class="ident" id="5864410">Error</span><span class="op" id="5864415">(</span><span class="op" id="5864416">)</span>&nbsp;<span class="builtintype" id="5864418">string</span>&nbsp;<span class="op" id="5864425">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864428">msg</span>&nbsp;<span class="op" id="5864432">:=</span>&nbsp;<span class="ident" id="5864435">e</span><span class="op" id="5864436">.</span><span class="ident" id="5864437">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864442">if</span>&nbsp;<span class="ident" id="5864445">e</span><span class="op" id="5864446">.</span><span class="ident" id="5864447">val</span>&nbsp;<span class="op" id="5864451">!=</span>&nbsp;<span class="ident" id="5864454">nil</span>&nbsp;<span class="op" id="5864458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864462">msg</span>&nbsp;<span class="op" id="5864466">+=</span>&nbsp;<span class="ident" id="5864469">fmt</span><span class="op" id="5864472">.</span><span class="ident" id="5864473">Sprintf</span><span class="op" id="5864480">(</span><span class="string" id="5864481">&#34;&nbsp;&#39;%v&#39;&nbsp;&#34;</span><span class="op" id="5864489">,</span>&nbsp;<span class="ident" id="5864491">e</span><span class="op" id="5864492">.</span><span class="ident" id="5864493">val</span><span class="op" id="5864496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5864499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864502">msg</span>&nbsp;<span class="op" id="5864506">+=</span>&nbsp;<span class="ident" id="5864509">fmt</span><span class="op" id="5864512">.</span><span class="ident" id="5864513">Sprintf</span><span class="op" id="5864520">(</span><span class="string" id="5864521">&#34;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5864544">,</span>&nbsp;<span class="ident" id="5864546">e</span><span class="op" id="5864547">.</span><span class="ident" id="5864548">off</span><span class="op" id="5864551">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864554">return</span>&nbsp;<span class="ident" id="5864561">msg</span><br>
<span class="lineno"></span><span class="op" id="5864565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5864568">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5864653">func</span>&nbsp;<span class="ident" id="5864658">Open</span><span class="op" id="5864662">(</span><span class="ident" id="5864663">name</span>&nbsp;<span class="builtintype" id="5864668">string</span><span class="op" id="5864674">)</span>&nbsp;<span class="op" id="5864676">(</span><span class="op" id="5864677">*</span><span class="ident" id="5864678">File</span><span class="op" id="5864682">,</span>&nbsp;<span class="builtintype" id="5864684">error</span><span class="op" id="5864689">)</span>&nbsp;<span class="op" id="5864691">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864694">f</span><span class="op" id="5864695">,</span>&nbsp;<span class="ident" id="5864697">err</span>&nbsp;<span class="op" id="5864701">:=</span>&nbsp;<span class="ident" id="5864704">os</span><span class="op" id="5864706">.</span><span class="ident" id="5864707">Open</span><span class="op" id="5864711">(</span><span class="ident" id="5864712">name</span><span class="op" id="5864716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864719">if</span>&nbsp;<span class="ident" id="5864722">err</span>&nbsp;<span class="op" id="5864726">!=</span>&nbsp;<span class="ident" id="5864729">nil</span>&nbsp;<span class="op" id="5864733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864737">return</span>&nbsp;<span class="ident" id="5864744">nil</span><span class="op" id="5864747">,</span>&nbsp;<span class="ident" id="5864749">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5864754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864757">ff</span><span class="op" id="5864759">,</span>&nbsp;<span class="ident" id="5864761">err</span>&nbsp;<span class="op" id="5864765">:=</span>&nbsp;<span class="ident" id="5864768">NewFile</span><span class="op" id="5864775">(</span><span class="ident" id="5864776">f</span><span class="op" id="5864777">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864780">if</span>&nbsp;<span class="ident" id="5864783">err</span>&nbsp;<span class="op" id="5864787">!=</span>&nbsp;<span class="ident" id="5864790">nil</span>&nbsp;<span class="op" id="5864794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864798">f</span><span class="op" id="5864799">.</span><span class="ident" id="5864800">Close</span><span class="op" id="5864805">(</span><span class="op" id="5864806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864810">return</span>&nbsp;<span class="ident" id="5864817">nil</span><span class="op" id="5864820">,</span>&nbsp;<span class="ident" id="5864822">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5864827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5864830">ff</span><span class="op" id="5864832">.</span><span class="ident" id="5864833">closer</span>&nbsp;<span class="op" id="5864840">=</span>&nbsp;<span class="ident" id="5864842">f</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5864845">return</span>&nbsp;<span class="ident" id="5864852">ff</span><span class="op" id="5864854">,</span>&nbsp;<span class="ident" id="5864856">nil</span><br>
<span class="lineno"></span><span class="op" id="5864860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5864863">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5864889">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno">170</span><span class="comment" id="5864956">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="5864980">func</span>&nbsp;<span class="op" id="5864985">(</span><span class="ident" id="5864986">f</span>&nbsp;<span class="op" id="5864988">*</span><span class="ident" id="5864989">File</span><span class="op" id="5864993">)</span>&nbsp;<span class="ident" id="5864995">Close</span><span class="op" id="5865000">(</span><span class="op" id="5865001">)</span>&nbsp;<span class="builtintype" id="5865003">error</span>&nbsp;<span class="op" id="5865009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865012">var</span>&nbsp;<span class="ident" id="5865016">err</span>&nbsp;<span class="builtintype" id="5865020">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865027">if</span>&nbsp;<span class="ident" id="5865030">f</span><span class="op" id="5865031">.</span><span class="ident" id="5865032">closer</span>&nbsp;<span class="op" id="5865039">!=</span>&nbsp;<span class="ident" id="5865042">nil</span>&nbsp;<span class="op" id="5865046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865050">err</span>&nbsp;<span class="op" id="5865054">=</span>&nbsp;<span class="ident" id="5865056">f</span><span class="op" id="5865057">.</span><span class="ident" id="5865058">closer</span><span class="op" id="5865064">.</span><span class="ident" id="5865065">Close</span><span class="op" id="5865070">(</span><span class="op" id="5865071">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865075">f</span><span class="op" id="5865076">.</span><span class="ident" id="5865077">closer</span>&nbsp;<span class="op" id="5865084">=</span>&nbsp;<span class="ident" id="5865086">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5865091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865094">return</span>&nbsp;<span class="ident" id="5865101">err</span><br>
<span class="lineno"></span><span class="op" id="5865105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="5865108">//&nbsp;SectionByType&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;in&nbsp;f&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5865165">//&nbsp;given&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5865216">func</span>&nbsp;<span class="op" id="5865221">(</span><span class="ident" id="5865222">f</span>&nbsp;<span class="op" id="5865224">*</span><span class="ident" id="5865225">File</span><span class="op" id="5865229">)</span>&nbsp;<span class="ident" id="5865231">SectionByType</span><span class="op" id="5865244">(</span><span class="ident" id="5865245">typ</span>&nbsp;<span class="ident" id="5865249">SectionType</span><span class="op" id="5865260">)</span>&nbsp;<span class="op" id="5865262">*</span><span class="ident" id="5865263">Section</span>&nbsp;<span class="op" id="5865271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865274">for</span>&nbsp;<span class="ident" id="5865278">_</span><span class="op" id="5865279">,</span>&nbsp;<span class="ident" id="5865281">s</span>&nbsp;<span class="op" id="5865283">:=</span>&nbsp;<span class="keyword" id="5865286">range</span>&nbsp;<span class="ident" id="5865292">f</span><span class="op" id="5865293">.</span><span class="ident" id="5865294">Sections</span>&nbsp;<span class="op" id="5865303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865307">if</span>&nbsp;<span class="ident" id="5865310">s</span><span class="op" id="5865311">.</span><span class="ident" id="5865312">Type</span>&nbsp;<span class="op" id="5865317">==</span>&nbsp;<span class="ident" id="5865320">typ</span>&nbsp;<span class="op" id="5865324">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865329">return</span>&nbsp;<span class="ident" id="5865336">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5865340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5865343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865346">return</span>&nbsp;<span class="ident" id="5865353">nil</span><br>
<span class="lineno"></span><span class="op" id="5865357">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5865360">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;an&nbsp;ELF&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="5865443">//&nbsp;The&nbsp;ELF&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="5865513">func</span>&nbsp;<span class="ident" id="5865518">NewFile</span><span class="op" id="5865525">(</span><span class="ident" id="5865526">r</span>&nbsp;<span class="ident" id="5865528">io</span><span class="op" id="5865530">.</span><span class="ident" id="5865531">ReaderAt</span><span class="op" id="5865539">)</span>&nbsp;<span class="op" id="5865541">(</span><span class="op" id="5865542">*</span><span class="ident" id="5865543">File</span><span class="op" id="5865547">,</span>&nbsp;<span class="builtintype" id="5865549">error</span><span class="op" id="5865554">)</span>&nbsp;<span class="op" id="5865556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865559">sr</span>&nbsp;<span class="op" id="5865562">:=</span>&nbsp;<span class="ident" id="5865565">io</span><span class="op" id="5865567">.</span><span class="ident" id="5865568">NewSectionReader</span><span class="op" id="5865584">(</span><span class="ident" id="5865585">r</span><span class="op" id="5865586">,</span>&nbsp;<span class="num" id="5865588">0</span><span class="op" id="5865589">,</span>&nbsp;<span class="num" id="5865591">1</span><span class="op" id="5865592">&lt;&lt;</span><span class="num" id="5865594">63</span><span class="op" id="5865596">-</span><span class="num" id="5865597">1</span><span class="op" id="5865598">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5865601">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;ELF&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865636">var</span>&nbsp;<span class="ident" id="5865640">ident</span>&nbsp;<span class="op" id="5865646">[</span><span class="num" id="5865647">16</span><span class="op" id="5865649">]</span><span class="builtintype" id="5865650">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865657">if</span>&nbsp;<span class="ident" id="5865660">_</span><span class="op" id="5865661">,</span>&nbsp;<span class="ident" id="5865663">err</span>&nbsp;<span class="op" id="5865667">:=</span>&nbsp;<span class="ident" id="5865670">r</span><span class="op" id="5865671">.</span><span class="ident" id="5865672">ReadAt</span><span class="op" id="5865678">(</span><span class="ident" id="5865679">ident</span><span class="op" id="5865684">[</span><span class="num" id="5865685">0</span><span class="op" id="5865686">:</span><span class="op" id="5865687">]</span><span class="op" id="5865688">,</span>&nbsp;<span class="num" id="5865690">0</span><span class="op" id="5865691">)</span><span class="op" id="5865692">;</span>&nbsp;<span class="ident" id="5865694">err</span>&nbsp;<span class="op" id="5865698">!=</span>&nbsp;<span class="ident" id="5865701">nil</span>&nbsp;<span class="op" id="5865705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865709">return</span>&nbsp;<span class="ident" id="5865716">nil</span><span class="op" id="5865719">,</span>&nbsp;<span class="ident" id="5865721">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5865726">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865729">if</span>&nbsp;<span class="ident" id="5865732">ident</span><span class="op" id="5865737">[</span><span class="num" id="5865738">0</span><span class="op" id="5865739">]</span>&nbsp;<span class="op" id="5865741">!=</span>&nbsp;<span class="string" id="5865744">&#39;\x7f&#39;</span>&nbsp;<span class="op" id="5865751">||</span>&nbsp;<span class="ident" id="5865754">ident</span><span class="op" id="5865759">[</span><span class="num" id="5865760">1</span><span class="op" id="5865761">]</span>&nbsp;<span class="op" id="5865763">!=</span>&nbsp;<span class="string" id="5865766">&#39;E&#39;</span>&nbsp;<span class="op" id="5865770">||</span>&nbsp;<span class="ident" id="5865773">ident</span><span class="op" id="5865778">[</span><span class="num" id="5865779">2</span><span class="op" id="5865780">]</span>&nbsp;<span class="op" id="5865782">!=</span>&nbsp;<span class="string" id="5865785">&#39;L&#39;</span>&nbsp;<span class="op" id="5865789">||</span>&nbsp;<span class="ident" id="5865792">ident</span><span class="op" id="5865797">[</span><span class="num" id="5865798">3</span><span class="op" id="5865799">]</span>&nbsp;<span class="op" id="5865801">!=</span>&nbsp;<span class="string" id="5865804">&#39;F&#39;</span>&nbsp;<span class="op" id="5865808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865812">return</span>&nbsp;<span class="ident" id="5865819">nil</span><span class="op" id="5865822">,</span>&nbsp;<span class="op" id="5865824">&amp;</span><span class="ident" id="5865825">FormatError</span><span class="op" id="5865836">{</span><span class="num" id="5865837">0</span><span class="op" id="5865838">,</span>&nbsp;<span class="string" id="5865840">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="5865858">,</span>&nbsp;<span class="ident" id="5865860">ident</span><span class="op" id="5865865">[</span><span class="num" id="5865866">0</span><span class="op" id="5865867">:</span><span class="num" id="5865868">4</span><span class="op" id="5865869">]</span><span class="op" id="5865870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5865873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865877">f</span>&nbsp;<span class="op" id="5865879">:=</span>&nbsp;<span class="builtinfunc" id="5865882">new</span><span class="op" id="5865885">(</span><span class="ident" id="5865886">File</span><span class="op" id="5865890">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5865893">f</span><span class="op" id="5865894">.</span><span class="ident" id="5865895">Class</span>&nbsp;<span class="op" id="5865901">=</span>&nbsp;<span class="ident" id="5865903">Class</span><span class="op" id="5865908">(</span><span class="ident" id="5865909">ident</span><span class="op" id="5865914">[</span><span class="ident" id="5865915">EI_CLASS</span><span class="op" id="5865923">]</span><span class="op" id="5865924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865927">switch</span>&nbsp;<span class="ident" id="5865934">f</span><span class="op" id="5865935">.</span><span class="ident" id="5865936">Class</span>&nbsp;<span class="op" id="5865942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865945">case</span>&nbsp;<span class="ident" id="5865950">ELFCLASS32</span><span class="op" id="5865960">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865963">case</span>&nbsp;<span class="ident" id="5865968">ELFCLASS64</span><span class="op" id="5865978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5865982">//&nbsp;ok</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5865989">default</span><span class="op" id="5865996">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866000">return</span>&nbsp;<span class="ident" id="5866007">nil</span><span class="op" id="5866010">,</span>&nbsp;<span class="op" id="5866012">&amp;</span><span class="ident" id="5866013">FormatError</span><span class="op" id="5866024">{</span><span class="num" id="5866025">0</span><span class="op" id="5866026">,</span>&nbsp;<span class="string" id="5866028">&#34;unknown&nbsp;ELF&nbsp;class&#34;</span><span class="op" id="5866047">,</span>&nbsp;<span class="ident" id="5866049">f</span><span class="op" id="5866050">.</span><span class="ident" id="5866051">Class</span><span class="op" id="5866056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5866059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866063">f</span><span class="op" id="5866064">.</span><span class="ident" id="5866065">Data</span>&nbsp;<span class="op" id="5866070">=</span>&nbsp;<span class="ident" id="5866072">Data</span><span class="op" id="5866076">(</span><span class="ident" id="5866077">ident</span><span class="op" id="5866082">[</span><span class="ident" id="5866083">EI_DATA</span><span class="op" id="5866090">]</span><span class="op" id="5866091">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866094">switch</span>&nbsp;<span class="ident" id="5866101">f</span><span class="op" id="5866102">.</span><span class="ident" id="5866103">Data</span>&nbsp;<span class="op" id="5866108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866111">case</span>&nbsp;<span class="ident" id="5866116">ELFDATA2LSB</span><span class="op" id="5866127">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866131">f</span><span class="op" id="5866132">.</span><span class="ident" id="5866133">ByteOrder</span>&nbsp;<span class="op" id="5866143">=</span>&nbsp;<span class="ident" id="5866145">binary</span><span class="op" id="5866151">.</span><span class="ident" id="5866152">LittleEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866166">case</span>&nbsp;<span class="ident" id="5866171">ELFDATA2MSB</span><span class="op" id="5866182">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866186">f</span><span class="op" id="5866187">.</span><span class="ident" id="5866188">ByteOrder</span>&nbsp;<span class="op" id="5866198">=</span>&nbsp;<span class="ident" id="5866200">binary</span><span class="op" id="5866206">.</span><span class="ident" id="5866207">BigEndian</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866218">default</span><span class="op" id="5866225">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866229">return</span>&nbsp;<span class="ident" id="5866236">nil</span><span class="op" id="5866239">,</span>&nbsp;<span class="op" id="5866241">&amp;</span><span class="ident" id="5866242">FormatError</span><span class="op" id="5866253">{</span><span class="num" id="5866254">0</span><span class="op" id="5866255">,</span>&nbsp;<span class="string" id="5866257">&#34;unknown&nbsp;ELF&nbsp;data&nbsp;encoding&#34;</span><span class="op" id="5866284">,</span>&nbsp;<span class="ident" id="5866286">f</span><span class="op" id="5866287">.</span><span class="ident" id="5866288">Data</span><span class="op" id="5866292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5866295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866299">f</span><span class="op" id="5866300">.</span><span class="ident" id="5866301">Version</span>&nbsp;<span class="op" id="5866309">=</span>&nbsp;<span class="ident" id="5866311">Version</span><span class="op" id="5866318">(</span><span class="ident" id="5866319">ident</span><span class="op" id="5866324">[</span><span class="ident" id="5866325">EI_VERSION</span><span class="op" id="5866335">]</span><span class="op" id="5866336">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866339">if</span>&nbsp;<span class="ident" id="5866342">f</span><span class="op" id="5866343">.</span><span class="ident" id="5866344">Version</span>&nbsp;<span class="op" id="5866352">!=</span>&nbsp;<span class="ident" id="5866355">EV_CURRENT</span>&nbsp;<span class="op" id="5866366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866370">return</span>&nbsp;<span class="ident" id="5866377">nil</span><span class="op" id="5866380">,</span>&nbsp;<span class="op" id="5866382">&amp;</span><span class="ident" id="5866383">FormatError</span><span class="op" id="5866394">{</span><span class="num" id="5866395">0</span><span class="op" id="5866396">,</span>&nbsp;<span class="string" id="5866398">&#34;unknown&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5866419">,</span>&nbsp;<span class="ident" id="5866421">f</span><span class="op" id="5866422">.</span><span class="ident" id="5866423">Version</span><span class="op" id="5866430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5866433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866437">f</span><span class="op" id="5866438">.</span><span class="ident" id="5866439">OSABI</span>&nbsp;<span class="op" id="5866445">=</span>&nbsp;<span class="ident" id="5866447">OSABI</span><span class="op" id="5866452">(</span><span class="ident" id="5866453">ident</span><span class="op" id="5866458">[</span><span class="ident" id="5866459">EI_OSABI</span><span class="op" id="5866467">]</span><span class="op" id="5866468">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866471">f</span><span class="op" id="5866472">.</span><span class="ident" id="5866473">ABIVersion</span>&nbsp;<span class="op" id="5866484">=</span>&nbsp;<span class="ident" id="5866486">ident</span><span class="op" id="5866491">[</span><span class="ident" id="5866492">EI_ABIVERSION</span><span class="op" id="5866505">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5866509">//&nbsp;Read&nbsp;ELF&nbsp;file&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866534">var</span>&nbsp;<span class="ident" id="5866538">phoff</span>&nbsp;<span class="ident" id="5866544">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866551">var</span>&nbsp;<span class="ident" id="5866555">phentsize</span><span class="op" id="5866564">,</span>&nbsp;<span class="ident" id="5866566">phnum</span>&nbsp;<span class="builtintype" id="5866572">int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866577">var</span>&nbsp;<span class="ident" id="5866581">shoff</span>&nbsp;<span class="ident" id="5866587">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866594">var</span>&nbsp;<span class="ident" id="5866598">shentsize</span><span class="op" id="5866607">,</span>&nbsp;<span class="ident" id="5866609">shnum</span><span class="op" id="5866614">,</span>&nbsp;<span class="ident" id="5866616">shstrndx</span>&nbsp;<span class="builtintype" id="5866625">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866630">shstrndx</span>&nbsp;<span class="op" id="5866639">=</span>&nbsp;<span class="op" id="5866641">-</span><span class="num" id="5866642">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866645">switch</span>&nbsp;<span class="ident" id="5866652">f</span><span class="op" id="5866653">.</span><span class="ident" id="5866654">Class</span>&nbsp;<span class="op" id="5866660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866663">case</span>&nbsp;<span class="ident" id="5866668">ELFCLASS32</span><span class="op" id="5866678">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866682">hdr</span>&nbsp;<span class="op" id="5866686">:=</span>&nbsp;<span class="builtinfunc" id="5866689">new</span><span class="op" id="5866692">(</span><span class="ident" id="5866693">Header32</span><span class="op" id="5866701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866705">sr</span><span class="op" id="5866707">.</span><span class="ident" id="5866708">Seek</span><span class="op" id="5866712">(</span><span class="num" id="5866713">0</span><span class="op" id="5866714">,</span>&nbsp;<span class="ident" id="5866716">os</span><span class="op" id="5866718">.</span><span class="ident" id="5866719">SEEK_SET</span><span class="op" id="5866727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866731">if</span>&nbsp;<span class="ident" id="5866734">err</span>&nbsp;<span class="op" id="5866738">:=</span>&nbsp;<span class="ident" id="5866741">binary</span><span class="op" id="5866747">.</span><span class="ident" id="5866748">Read</span><span class="op" id="5866752">(</span><span class="ident" id="5866753">sr</span><span class="op" id="5866755">,</span>&nbsp;<span class="ident" id="5866757">f</span><span class="op" id="5866758">.</span><span class="ident" id="5866759">ByteOrder</span><span class="op" id="5866768">,</span>&nbsp;<span class="ident" id="5866770">hdr</span><span class="op" id="5866773">)</span><span class="op" id="5866774">;</span>&nbsp;<span class="ident" id="5866776">err</span>&nbsp;<span class="op" id="5866780">!=</span>&nbsp;<span class="ident" id="5866783">nil</span>&nbsp;<span class="op" id="5866787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866792">return</span>&nbsp;<span class="ident" id="5866799">nil</span><span class="op" id="5866802">,</span>&nbsp;<span class="ident" id="5866804">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5866810">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866814">f</span><span class="op" id="5866815">.</span><span class="ident" id="5866816">Type</span>&nbsp;<span class="op" id="5866821">=</span>&nbsp;<span class="ident" id="5866823">Type</span><span class="op" id="5866827">(</span><span class="ident" id="5866828">hdr</span><span class="op" id="5866831">.</span><span class="ident" id="5866832">Type</span><span class="op" id="5866836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866840">f</span><span class="op" id="5866841">.</span><span class="ident" id="5866842">Machine</span>&nbsp;<span class="op" id="5866850">=</span>&nbsp;<span class="ident" id="5866852">Machine</span><span class="op" id="5866859">(</span><span class="ident" id="5866860">hdr</span><span class="op" id="5866863">.</span><span class="ident" id="5866864">Machine</span><span class="op" id="5866871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5866875">f</span><span class="op" id="5866876">.</span><span class="ident" id="5866877">Entry</span>&nbsp;<span class="op" id="5866883">=</span>&nbsp;<span class="ident" id="5866885">uint64</span><span class="op" id="5866891">(</span><span class="ident" id="5866892">hdr</span><span class="op" id="5866895">.</span><span class="ident" id="5866896">Entry</span><span class="op" id="5866901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866905">if</span>&nbsp;<span class="ident" id="5866908">v</span>&nbsp;<span class="op" id="5866910">:=</span>&nbsp;<span class="ident" id="5866913">Version</span><span class="op" id="5866920">(</span><span class="ident" id="5866921">hdr</span><span class="op" id="5866924">.</span><span class="ident" id="5866925">Version</span><span class="op" id="5866932">)</span><span class="op" id="5866933">;</span>&nbsp;<span class="ident" id="5866935">v</span>&nbsp;<span class="op" id="5866937">!=</span>&nbsp;<span class="ident" id="5866940">f</span><span class="op" id="5866941">.</span><span class="ident" id="5866942">Version</span>&nbsp;<span class="op" id="5866950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5866955">return</span>&nbsp;<span class="ident" id="5866962">nil</span><span class="op" id="5866965">,</span>&nbsp;<span class="op" id="5866967">&amp;</span><span class="ident" id="5866968">FormatError</span><span class="op" id="5866979">{</span><span class="num" id="5866980">0</span><span class="op" id="5866981">,</span>&nbsp;<span class="string" id="5866983">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5867007">,</span>&nbsp;<span class="ident" id="5867009">v</span><span class="op" id="5867010">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5867014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867018">phoff</span>&nbsp;<span class="op" id="5867024">=</span>&nbsp;<span class="ident" id="5867026">int64</span><span class="op" id="5867031">(</span><span class="ident" id="5867032">hdr</span><span class="op" id="5867035">.</span><span class="ident" id="5867036">Phoff</span><span class="op" id="5867041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867045">phentsize</span>&nbsp;<span class="op" id="5867055">=</span>&nbsp;<span class="builtintype" id="5867057">int</span><span class="op" id="5867060">(</span><span class="ident" id="5867061">hdr</span><span class="op" id="5867064">.</span><span class="ident" id="5867065">Phentsize</span><span class="op" id="5867074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867078">phnum</span>&nbsp;<span class="op" id="5867084">=</span>&nbsp;<span class="builtintype" id="5867086">int</span><span class="op" id="5867089">(</span><span class="ident" id="5867090">hdr</span><span class="op" id="5867093">.</span><span class="ident" id="5867094">Phnum</span><span class="op" id="5867099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867103">shoff</span>&nbsp;<span class="op" id="5867109">=</span>&nbsp;<span class="ident" id="5867111">int64</span><span class="op" id="5867116">(</span><span class="ident" id="5867117">hdr</span><span class="op" id="5867120">.</span><span class="ident" id="5867121">Shoff</span><span class="op" id="5867126">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867130">shentsize</span>&nbsp;<span class="op" id="5867140">=</span>&nbsp;<span class="builtintype" id="5867142">int</span><span class="op" id="5867145">(</span><span class="ident" id="5867146">hdr</span><span class="op" id="5867149">.</span><span class="ident" id="5867150">Shentsize</span><span class="op" id="5867159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867163">shnum</span>&nbsp;<span class="op" id="5867169">=</span>&nbsp;<span class="builtintype" id="5867171">int</span><span class="op" id="5867174">(</span><span class="ident" id="5867175">hdr</span><span class="op" id="5867178">.</span><span class="ident" id="5867179">Shnum</span><span class="op" id="5867184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867188">shstrndx</span>&nbsp;<span class="op" id="5867197">=</span>&nbsp;<span class="builtintype" id="5867199">int</span><span class="op" id="5867202">(</span><span class="ident" id="5867203">hdr</span><span class="op" id="5867206">.</span><span class="ident" id="5867207">Shstrndx</span><span class="op" id="5867215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867218">case</span>&nbsp;<span class="ident" id="5867223">ELFCLASS64</span><span class="op" id="5867233">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867237">hdr</span>&nbsp;<span class="op" id="5867241">:=</span>&nbsp;<span class="builtinfunc" id="5867244">new</span><span class="op" id="5867247">(</span><span class="ident" id="5867248">Header64</span><span class="op" id="5867256">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867260">sr</span><span class="op" id="5867262">.</span><span class="ident" id="5867263">Seek</span><span class="op" id="5867267">(</span><span class="num" id="5867268">0</span><span class="op" id="5867269">,</span>&nbsp;<span class="ident" id="5867271">os</span><span class="op" id="5867273">.</span><span class="ident" id="5867274">SEEK_SET</span><span class="op" id="5867282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867286">if</span>&nbsp;<span class="ident" id="5867289">err</span>&nbsp;<span class="op" id="5867293">:=</span>&nbsp;<span class="ident" id="5867296">binary</span><span class="op" id="5867302">.</span><span class="ident" id="5867303">Read</span><span class="op" id="5867307">(</span><span class="ident" id="5867308">sr</span><span class="op" id="5867310">,</span>&nbsp;<span class="ident" id="5867312">f</span><span class="op" id="5867313">.</span><span class="ident" id="5867314">ByteOrder</span><span class="op" id="5867323">,</span>&nbsp;<span class="ident" id="5867325">hdr</span><span class="op" id="5867328">)</span><span class="op" id="5867329">;</span>&nbsp;<span class="ident" id="5867331">err</span>&nbsp;<span class="op" id="5867335">!=</span>&nbsp;<span class="ident" id="5867338">nil</span>&nbsp;<span class="op" id="5867342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867347">return</span>&nbsp;<span class="ident" id="5867354">nil</span><span class="op" id="5867357">,</span>&nbsp;<span class="ident" id="5867359">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5867365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867369">f</span><span class="op" id="5867370">.</span><span class="ident" id="5867371">Type</span>&nbsp;<span class="op" id="5867376">=</span>&nbsp;<span class="ident" id="5867378">Type</span><span class="op" id="5867382">(</span><span class="ident" id="5867383">hdr</span><span class="op" id="5867386">.</span><span class="ident" id="5867387">Type</span><span class="op" id="5867391">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867395">f</span><span class="op" id="5867396">.</span><span class="ident" id="5867397">Machine</span>&nbsp;<span class="op" id="5867405">=</span>&nbsp;<span class="ident" id="5867407">Machine</span><span class="op" id="5867414">(</span><span class="ident" id="5867415">hdr</span><span class="op" id="5867418">.</span><span class="ident" id="5867419">Machine</span><span class="op" id="5867426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867430">f</span><span class="op" id="5867431">.</span><span class="ident" id="5867432">Entry</span>&nbsp;<span class="op" id="5867438">=</span>&nbsp;<span class="ident" id="5867440">uint64</span><span class="op" id="5867446">(</span><span class="ident" id="5867447">hdr</span><span class="op" id="5867450">.</span><span class="ident" id="5867451">Entry</span><span class="op" id="5867456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867460">if</span>&nbsp;<span class="ident" id="5867463">v</span>&nbsp;<span class="op" id="5867465">:=</span>&nbsp;<span class="ident" id="5867468">Version</span><span class="op" id="5867475">(</span><span class="ident" id="5867476">hdr</span><span class="op" id="5867479">.</span><span class="ident" id="5867480">Version</span><span class="op" id="5867487">)</span><span class="op" id="5867488">;</span>&nbsp;<span class="ident" id="5867490">v</span>&nbsp;<span class="op" id="5867492">!=</span>&nbsp;<span class="ident" id="5867495">f</span><span class="op" id="5867496">.</span><span class="ident" id="5867497">Version</span>&nbsp;<span class="op" id="5867505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867510">return</span>&nbsp;<span class="ident" id="5867517">nil</span><span class="op" id="5867520">,</span>&nbsp;<span class="op" id="5867522">&amp;</span><span class="ident" id="5867523">FormatError</span><span class="op" id="5867534">{</span><span class="num" id="5867535">0</span><span class="op" id="5867536">,</span>&nbsp;<span class="string" id="5867538">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5867562">,</span>&nbsp;<span class="ident" id="5867564">v</span><span class="op" id="5867565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5867569">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867573">phoff</span>&nbsp;<span class="op" id="5867579">=</span>&nbsp;<span class="ident" id="5867581">int64</span><span class="op" id="5867586">(</span><span class="ident" id="5867587">hdr</span><span class="op" id="5867590">.</span><span class="ident" id="5867591">Phoff</span><span class="op" id="5867596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867600">phentsize</span>&nbsp;<span class="op" id="5867610">=</span>&nbsp;<span class="builtintype" id="5867612">int</span><span class="op" id="5867615">(</span><span class="ident" id="5867616">hdr</span><span class="op" id="5867619">.</span><span class="ident" id="5867620">Phentsize</span><span class="op" id="5867629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867633">phnum</span>&nbsp;<span class="op" id="5867639">=</span>&nbsp;<span class="builtintype" id="5867641">int</span><span class="op" id="5867644">(</span><span class="ident" id="5867645">hdr</span><span class="op" id="5867648">.</span><span class="ident" id="5867649">Phnum</span><span class="op" id="5867654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867658">shoff</span>&nbsp;<span class="op" id="5867664">=</span>&nbsp;<span class="ident" id="5867666">int64</span><span class="op" id="5867671">(</span><span class="ident" id="5867672">hdr</span><span class="op" id="5867675">.</span><span class="ident" id="5867676">Shoff</span><span class="op" id="5867681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867685">shentsize</span>&nbsp;<span class="op" id="5867695">=</span>&nbsp;<span class="builtintype" id="5867697">int</span><span class="op" id="5867700">(</span><span class="ident" id="5867701">hdr</span><span class="op" id="5867704">.</span><span class="ident" id="5867705">Shentsize</span><span class="op" id="5867714">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867718">shnum</span>&nbsp;<span class="op" id="5867724">=</span>&nbsp;<span class="builtintype" id="5867726">int</span><span class="op" id="5867729">(</span><span class="ident" id="5867730">hdr</span><span class="op" id="5867733">.</span><span class="ident" id="5867734">Shnum</span><span class="op" id="5867739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867743">shstrndx</span>&nbsp;<span class="op" id="5867752">=</span>&nbsp;<span class="builtintype" id="5867754">int</span><span class="op" id="5867757">(</span><span class="ident" id="5867758">hdr</span><span class="op" id="5867761">.</span><span class="ident" id="5867762">Shstrndx</span><span class="op" id="5867770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5867773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867777">if</span>&nbsp;<span class="ident" id="5867780">shnum</span>&nbsp;<span class="op" id="5867786">&gt;</span>&nbsp;<span class="num" id="5867788">0</span>&nbsp;<span class="op" id="5867790">&amp;&amp;</span>&nbsp;<span class="ident" id="5867793">shoff</span>&nbsp;<span class="op" id="5867799">&gt;</span>&nbsp;<span class="num" id="5867801">0</span>&nbsp;<span class="op" id="5867803">&amp;&amp;</span>&nbsp;<span class="op" id="5867806">(</span><span class="ident" id="5867807">shstrndx</span>&nbsp;<span class="op" id="5867816">&lt;</span>&nbsp;<span class="num" id="5867818">0</span>&nbsp;<span class="op" id="5867820">||</span>&nbsp;<span class="ident" id="5867823">shstrndx</span>&nbsp;<span class="op" id="5867832">&gt;=</span>&nbsp;<span class="ident" id="5867835">shnum</span><span class="op" id="5867840">)</span>&nbsp;<span class="op" id="5867842">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867846">return</span>&nbsp;<span class="ident" id="5867853">nil</span><span class="op" id="5867856">,</span>&nbsp;<span class="op" id="5867858">&amp;</span><span class="ident" id="5867859">FormatError</span><span class="op" id="5867870">{</span><span class="num" id="5867871">0</span><span class="op" id="5867872">,</span>&nbsp;<span class="string" id="5867874">&#34;invalid&nbsp;ELF&nbsp;shstrndx&#34;</span><span class="op" id="5867896">,</span>&nbsp;<span class="ident" id="5867898">shstrndx</span><span class="op" id="5867906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5867909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5867913">//&nbsp;Read&nbsp;program&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5867938">f</span><span class="op" id="5867939">.</span><span class="ident" id="5867940">Progs</span>&nbsp;<span class="op" id="5867946">=</span>&nbsp;<span class="builtinfunc" id="5867948">make</span><span class="op" id="5867952">(</span><span class="op" id="5867953">[</span><span class="op" id="5867954">]</span><span class="op" id="5867955">*</span><span class="ident" id="5867956">Prog</span><span class="op" id="5867960">,</span>&nbsp;<span class="ident" id="5867962">phnum</span><span class="op" id="5867967">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5867970">for</span>&nbsp;<span class="ident" id="5867974">i</span>&nbsp;<span class="op" id="5867976">:=</span>&nbsp;<span class="num" id="5867979">0</span><span class="op" id="5867980">;</span>&nbsp;<span class="ident" id="5867982">i</span>&nbsp;<span class="op" id="5867984">&lt;</span>&nbsp;<span class="ident" id="5867986">phnum</span><span class="op" id="5867991">;</span>&nbsp;<span class="ident" id="5867993">i</span><span class="op" id="5867994">++</span>&nbsp;<span class="op" id="5867997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868001">off</span>&nbsp;<span class="op" id="5868005">:=</span>&nbsp;<span class="ident" id="5868008">phoff</span>&nbsp;<span class="op" id="5868014">+</span>&nbsp;<span class="ident" id="5868016">int64</span><span class="op" id="5868021">(</span><span class="ident" id="5868022">i</span><span class="op" id="5868023">)</span><span class="op" id="5868024">*</span><span class="ident" id="5868025">int64</span><span class="op" id="5868030">(</span><span class="ident" id="5868031">phentsize</span><span class="op" id="5868040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868044">sr</span><span class="op" id="5868046">.</span><span class="ident" id="5868047">Seek</span><span class="op" id="5868051">(</span><span class="ident" id="5868052">off</span><span class="op" id="5868055">,</span>&nbsp;<span class="ident" id="5868057">os</span><span class="op" id="5868059">.</span><span class="ident" id="5868060">SEEK_SET</span><span class="op" id="5868068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868072">p</span>&nbsp;<span class="op" id="5868074">:=</span>&nbsp;<span class="builtinfunc" id="5868077">new</span><span class="op" id="5868080">(</span><span class="ident" id="5868081">Prog</span><span class="op" id="5868085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5868089">switch</span>&nbsp;<span class="ident" id="5868096">f</span><span class="op" id="5868097">.</span><span class="ident" id="5868098">Class</span>&nbsp;<span class="op" id="5868104">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5868108">case</span>&nbsp;<span class="ident" id="5868113">ELFCLASS32</span><span class="op" id="5868123">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868128">ph</span>&nbsp;<span class="op" id="5868131">:=</span>&nbsp;<span class="builtinfunc" id="5868134">new</span><span class="op" id="5868137">(</span><span class="ident" id="5868138">Prog32</span><span class="op" id="5868144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5868149">if</span>&nbsp;<span class="ident" id="5868152">err</span>&nbsp;<span class="op" id="5868156">:=</span>&nbsp;<span class="ident" id="5868159">binary</span><span class="op" id="5868165">.</span><span class="ident" id="5868166">Read</span><span class="op" id="5868170">(</span><span class="ident" id="5868171">sr</span><span class="op" id="5868173">,</span>&nbsp;<span class="ident" id="5868175">f</span><span class="op" id="5868176">.</span><span class="ident" id="5868177">ByteOrder</span><span class="op" id="5868186">,</span>&nbsp;<span class="ident" id="5868188">ph</span><span class="op" id="5868190">)</span><span class="op" id="5868191">;</span>&nbsp;<span class="ident" id="5868193">err</span>&nbsp;<span class="op" id="5868197">!=</span>&nbsp;<span class="ident" id="5868200">nil</span>&nbsp;<span class="op" id="5868204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5868210">return</span>&nbsp;<span class="ident" id="5868217">nil</span><span class="op" id="5868220">,</span>&nbsp;<span class="ident" id="5868222">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5868229">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868234">p</span><span class="op" id="5868235">.</span><span class="ident" id="5868236">ProgHeader</span>&nbsp;<span class="op" id="5868247">=</span>&nbsp;<span class="ident" id="5868249">ProgHeader</span><span class="op" id="5868259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868265">Type</span><span class="op" id="5868269">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5868273">ProgType</span><span class="op" id="5868281">(</span><span class="ident" id="5868282">ph</span><span class="op" id="5868284">.</span><span class="ident" id="5868285">Type</span><span class="op" id="5868289">)</span><span class="op" id="5868290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868296">Flags</span><span class="op" id="5868301">:</span>&nbsp;&nbsp;<span class="ident" id="5868304">ProgFlag</span><span class="op" id="5868312">(</span><span class="ident" id="5868313">ph</span><span class="op" id="5868315">.</span><span class="ident" id="5868316">Flags</span><span class="op" id="5868321">)</span><span class="op" id="5868322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868328">Off</span><span class="op" id="5868331">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5868336">uint64</span><span class="op" id="5868342">(</span><span class="ident" id="5868343">ph</span><span class="op" id="5868345">.</span><span class="ident" id="5868346">Off</span><span class="op" id="5868349">)</span><span class="op" id="5868350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868356">Vaddr</span><span class="op" id="5868361">:</span>&nbsp;&nbsp;<span class="ident" id="5868364">uint64</span><span class="op" id="5868370">(</span><span class="ident" id="5868371">ph</span><span class="op" id="5868373">.</span><span class="ident" id="5868374">Vaddr</span><span class="op" id="5868379">)</span><span class="op" id="5868380">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868386">Paddr</span><span class="op" id="5868391">:</span>&nbsp;&nbsp;<span class="ident" id="5868394">uint64</span><span class="op" id="5868400">(</span><span class="ident" id="5868401">ph</span><span class="op" id="5868403">.</span><span class="ident" id="5868404">Paddr</span><span class="op" id="5868409">)</span><span class="op" id="5868410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868416">Filesz</span><span class="op" id="5868422">:</span>&nbsp;<span class="ident" id="5868424">uint64</span><span class="op" id="5868430">(</span><span class="ident" id="5868431">ph</span><span class="op" id="5868433">.</span><span class="ident" id="5868434">Filesz</span><span class="op" id="5868440">)</span><span class="op" id="5868441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868447">Memsz</span><span class="op" id="5868452">:</span>&nbsp;&nbsp;<span class="ident" id="5868455">uint64</span><span class="op" id="5868461">(</span><span class="ident" id="5868462">ph</span><span class="op" id="5868464">.</span><span class="ident" id="5868465">Memsz</span><span class="op" id="5868470">)</span><span class="op" id="5868471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868477">Align</span><span class="op" id="5868482">:</span>&nbsp;&nbsp;<span class="ident" id="5868485">uint64</span><span class="op" id="5868491">(</span><span class="ident" id="5868492">ph</span><span class="op" id="5868494">.</span><span class="ident" id="5868495">Align</span><span class="op" id="5868500">)</span><span class="op" id="5868501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5868506">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5868510">case</span>&nbsp;<span class="ident" id="5868515">ELFCLASS64</span><span class="op" id="5868525">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868530">ph</span>&nbsp;<span class="op" id="5868533">:=</span>&nbsp;<span class="builtinfunc" id="5868536">new</span><span class="op" id="5868539">(</span><span class="ident" id="5868540">Prog64</span><span class="op" id="5868546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5868551">if</span>&nbsp;<span class="ident" id="5868554">err</span>&nbsp;<span class="op" id="5868558">:=</span>&nbsp;<span class="ident" id="5868561">binary</span><span class="op" id="5868567">.</span><span class="ident" id="5868568">Read</span><span class="op" id="5868572">(</span><span class="ident" id="5868573">sr</span><span class="op" id="5868575">,</span>&nbsp;<span class="ident" id="5868577">f</span><span class="op" id="5868578">.</span><span class="ident" id="5868579">ByteOrder</span><span class="op" id="5868588">,</span>&nbsp;<span class="ident" id="5868590">ph</span><span class="op" id="5868592">)</span><span class="op" id="5868593">;</span>&nbsp;<span class="ident" id="5868595">err</span>&nbsp;<span class="op" id="5868599">!=</span>&nbsp;<span class="ident" id="5868602">nil</span>&nbsp;<span class="op" id="5868606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5868612">return</span>&nbsp;<span class="ident" id="5868619">nil</span><span class="op" id="5868622">,</span>&nbsp;<span class="ident" id="5868624">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5868631">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868636">p</span><span class="op" id="5868637">.</span><span class="ident" id="5868638">ProgHeader</span>&nbsp;<span class="op" id="5868649">=</span>&nbsp;<span class="ident" id="5868651">ProgHeader</span><span class="op" id="5868661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868667">Type</span><span class="op" id="5868671">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5868675">ProgType</span><span class="op" id="5868683">(</span><span class="ident" id="5868684">ph</span><span class="op" id="5868686">.</span><span class="ident" id="5868687">Type</span><span class="op" id="5868691">)</span><span class="op" id="5868692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868698">Flags</span><span class="op" id="5868703">:</span>&nbsp;&nbsp;<span class="ident" id="5868706">ProgFlag</span><span class="op" id="5868714">(</span><span class="ident" id="5868715">ph</span><span class="op" id="5868717">.</span><span class="ident" id="5868718">Flags</span><span class="op" id="5868723">)</span><span class="op" id="5868724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868730">Off</span><span class="op" id="5868733">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5868738">uint64</span><span class="op" id="5868744">(</span><span class="ident" id="5868745">ph</span><span class="op" id="5868747">.</span><span class="ident" id="5868748">Off</span><span class="op" id="5868751">)</span><span class="op" id="5868752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868758">Vaddr</span><span class="op" id="5868763">:</span>&nbsp;&nbsp;<span class="ident" id="5868766">uint64</span><span class="op" id="5868772">(</span><span class="ident" id="5868773">ph</span><span class="op" id="5868775">.</span><span class="ident" id="5868776">Vaddr</span><span class="op" id="5868781">)</span><span class="op" id="5868782">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868788">Paddr</span><span class="op" id="5868793">:</span>&nbsp;&nbsp;<span class="ident" id="5868796">uint64</span><span class="op" id="5868802">(</span><span class="ident" id="5868803">ph</span><span class="op" id="5868805">.</span><span class="ident" id="5868806">Paddr</span><span class="op" id="5868811">)</span><span class="op" id="5868812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868818">Filesz</span><span class="op" id="5868824">:</span>&nbsp;<span class="ident" id="5868826">uint64</span><span class="op" id="5868832">(</span><span class="ident" id="5868833">ph</span><span class="op" id="5868835">.</span><span class="ident" id="5868836">Filesz</span><span class="op" id="5868842">)</span><span class="op" id="5868843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868849">Memsz</span><span class="op" id="5868854">:</span>&nbsp;&nbsp;<span class="ident" id="5868857">uint64</span><span class="op" id="5868863">(</span><span class="ident" id="5868864">ph</span><span class="op" id="5868866">.</span><span class="ident" id="5868867">Memsz</span><span class="op" id="5868872">)</span><span class="op" id="5868873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868879">Align</span><span class="op" id="5868884">:</span>&nbsp;&nbsp;<span class="ident" id="5868887">uint64</span><span class="op" id="5868893">(</span><span class="ident" id="5868894">ph</span><span class="op" id="5868896">.</span><span class="ident" id="5868897">Align</span><span class="op" id="5868902">)</span><span class="op" id="5868903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5868908">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5868912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868916">p</span><span class="op" id="5868917">.</span><span class="ident" id="5868918">sr</span>&nbsp;<span class="op" id="5868921">=</span>&nbsp;<span class="ident" id="5868923">io</span><span class="op" id="5868925">.</span><span class="ident" id="5868926">NewSectionReader</span><span class="op" id="5868942">(</span><span class="ident" id="5868943">r</span><span class="op" id="5868944">,</span>&nbsp;<span class="ident" id="5868946">int64</span><span class="op" id="5868951">(</span><span class="ident" id="5868952">p</span><span class="op" id="5868953">.</span><span class="ident" id="5868954">Off</span><span class="op" id="5868957">)</span><span class="op" id="5868958">,</span>&nbsp;<span class="ident" id="5868960">int64</span><span class="op" id="5868965">(</span><span class="ident" id="5868966">p</span><span class="op" id="5868967">.</span><span class="ident" id="5868968">Filesz</span><span class="op" id="5868974">)</span><span class="op" id="5868975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868979">p</span><span class="op" id="5868980">.</span><span class="ident" id="5868981">ReaderAt</span>&nbsp;<span class="op" id="5868990">=</span>&nbsp;<span class="ident" id="5868992">p</span><span class="op" id="5868993">.</span><span class="ident" id="5868994">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5868999">f</span><span class="op" id="5869000">.</span><span class="ident" id="5869001">Progs</span><span class="op" id="5869006">[</span><span class="ident" id="5869007">i</span><span class="op" id="5869008">]</span>&nbsp;<span class="op" id="5869010">=</span>&nbsp;<span class="ident" id="5869012">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5869015">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5869019">//&nbsp;Read&nbsp;section&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869044">f</span><span class="op" id="5869045">.</span><span class="ident" id="5869046">Sections</span>&nbsp;<span class="op" id="5869055">=</span>&nbsp;<span class="builtinfunc" id="5869057">make</span><span class="op" id="5869061">(</span><span class="op" id="5869062">[</span><span class="op" id="5869063">]</span><span class="op" id="5869064">*</span><span class="ident" id="5869065">Section</span><span class="op" id="5869072">,</span>&nbsp;<span class="ident" id="5869074">shnum</span><span class="op" id="5869079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869082">names</span>&nbsp;<span class="op" id="5869088">:=</span>&nbsp;<span class="builtinfunc" id="5869091">make</span><span class="op" id="5869095">(</span><span class="op" id="5869096">[</span><span class="op" id="5869097">]</span><span class="builtintype" id="5869098">uint32</span><span class="op" id="5869104">,</span>&nbsp;<span class="ident" id="5869106">shnum</span><span class="op" id="5869111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869114">for</span>&nbsp;<span class="ident" id="5869118">i</span>&nbsp;<span class="op" id="5869120">:=</span>&nbsp;<span class="num" id="5869123">0</span><span class="op" id="5869124">;</span>&nbsp;<span class="ident" id="5869126">i</span>&nbsp;<span class="op" id="5869128">&lt;</span>&nbsp;<span class="ident" id="5869130">shnum</span><span class="op" id="5869135">;</span>&nbsp;<span class="ident" id="5869137">i</span><span class="op" id="5869138">++</span>&nbsp;<span class="op" id="5869141">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869145">off</span>&nbsp;<span class="op" id="5869149">:=</span>&nbsp;<span class="ident" id="5869152">shoff</span>&nbsp;<span class="op" id="5869158">+</span>&nbsp;<span class="ident" id="5869160">int64</span><span class="op" id="5869165">(</span><span class="ident" id="5869166">i</span><span class="op" id="5869167">)</span><span class="op" id="5869168">*</span><span class="ident" id="5869169">int64</span><span class="op" id="5869174">(</span><span class="ident" id="5869175">shentsize</span><span class="op" id="5869184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869188">sr</span><span class="op" id="5869190">.</span><span class="ident" id="5869191">Seek</span><span class="op" id="5869195">(</span><span class="ident" id="5869196">off</span><span class="op" id="5869199">,</span>&nbsp;<span class="ident" id="5869201">os</span><span class="op" id="5869203">.</span><span class="ident" id="5869204">SEEK_SET</span><span class="op" id="5869212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869216">s</span>&nbsp;<span class="op" id="5869218">:=</span>&nbsp;<span class="builtinfunc" id="5869221">new</span><span class="op" id="5869224">(</span><span class="ident" id="5869225">Section</span><span class="op" id="5869232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869236">switch</span>&nbsp;<span class="ident" id="5869243">f</span><span class="op" id="5869244">.</span><span class="ident" id="5869245">Class</span>&nbsp;<span class="op" id="5869251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869255">case</span>&nbsp;<span class="ident" id="5869260">ELFCLASS32</span><span class="op" id="5869270">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869275">sh</span>&nbsp;<span class="op" id="5869278">:=</span>&nbsp;<span class="builtinfunc" id="5869281">new</span><span class="op" id="5869284">(</span><span class="ident" id="5869285">Section32</span><span class="op" id="5869294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869299">if</span>&nbsp;<span class="ident" id="5869302">err</span>&nbsp;<span class="op" id="5869306">:=</span>&nbsp;<span class="ident" id="5869309">binary</span><span class="op" id="5869315">.</span><span class="ident" id="5869316">Read</span><span class="op" id="5869320">(</span><span class="ident" id="5869321">sr</span><span class="op" id="5869323">,</span>&nbsp;<span class="ident" id="5869325">f</span><span class="op" id="5869326">.</span><span class="ident" id="5869327">ByteOrder</span><span class="op" id="5869336">,</span>&nbsp;<span class="ident" id="5869338">sh</span><span class="op" id="5869340">)</span><span class="op" id="5869341">;</span>&nbsp;<span class="ident" id="5869343">err</span>&nbsp;<span class="op" id="5869347">!=</span>&nbsp;<span class="ident" id="5869350">nil</span>&nbsp;<span class="op" id="5869354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869360">return</span>&nbsp;<span class="ident" id="5869367">nil</span><span class="op" id="5869370">,</span>&nbsp;<span class="ident" id="5869372">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5869379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869384">names</span><span class="op" id="5869389">[</span><span class="ident" id="5869390">i</span><span class="op" id="5869391">]</span>&nbsp;<span class="op" id="5869393">=</span>&nbsp;<span class="ident" id="5869395">sh</span><span class="op" id="5869397">.</span><span class="ident" id="5869398">Name</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869406">s</span><span class="op" id="5869407">.</span><span class="ident" id="5869408">SectionHeader</span>&nbsp;<span class="op" id="5869422">=</span>&nbsp;<span class="ident" id="5869424">SectionHeader</span><span class="op" id="5869437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869443">Type</span><span class="op" id="5869447">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869454">SectionType</span><span class="op" id="5869465">(</span><span class="ident" id="5869466">sh</span><span class="op" id="5869468">.</span><span class="ident" id="5869469">Type</span><span class="op" id="5869473">)</span><span class="op" id="5869474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869480">Flags</span><span class="op" id="5869485">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869491">SectionFlag</span><span class="op" id="5869502">(</span><span class="ident" id="5869503">sh</span><span class="op" id="5869505">.</span><span class="ident" id="5869506">Flags</span><span class="op" id="5869511">)</span><span class="op" id="5869512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869518">Addr</span><span class="op" id="5869522">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869529">uint64</span><span class="op" id="5869535">(</span><span class="ident" id="5869536">sh</span><span class="op" id="5869538">.</span><span class="ident" id="5869539">Addr</span><span class="op" id="5869543">)</span><span class="op" id="5869544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869550">Offset</span><span class="op" id="5869556">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869561">uint64</span><span class="op" id="5869567">(</span><span class="ident" id="5869568">sh</span><span class="op" id="5869570">.</span><span class="ident" id="5869571">Off</span><span class="op" id="5869574">)</span><span class="op" id="5869575">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869581">Size</span><span class="op" id="5869585">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869592">uint64</span><span class="op" id="5869598">(</span><span class="ident" id="5869599">sh</span><span class="op" id="5869601">.</span><span class="ident" id="5869602">Size</span><span class="op" id="5869606">)</span><span class="op" id="5869607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869613">Link</span><span class="op" id="5869617">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5869624">uint32</span><span class="op" id="5869630">(</span><span class="ident" id="5869631">sh</span><span class="op" id="5869633">.</span><span class="ident" id="5869634">Link</span><span class="op" id="5869638">)</span><span class="op" id="5869639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869645">Info</span><span class="op" id="5869649">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5869656">uint32</span><span class="op" id="5869662">(</span><span class="ident" id="5869663">sh</span><span class="op" id="5869665">.</span><span class="ident" id="5869666">Info</span><span class="op" id="5869670">)</span><span class="op" id="5869671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869677">Addralign</span><span class="op" id="5869686">:</span>&nbsp;<span class="ident" id="5869688">uint64</span><span class="op" id="5869694">(</span><span class="ident" id="5869695">sh</span><span class="op" id="5869697">.</span><span class="ident" id="5869698">Addralign</span><span class="op" id="5869707">)</span><span class="op" id="5869708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869714">Entsize</span><span class="op" id="5869721">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5869725">uint64</span><span class="op" id="5869731">(</span><span class="ident" id="5869732">sh</span><span class="op" id="5869734">.</span><span class="ident" id="5869735">Entsize</span><span class="op" id="5869742">)</span><span class="op" id="5869743">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5869748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869752">case</span>&nbsp;<span class="ident" id="5869757">ELFCLASS64</span><span class="op" id="5869767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869772">sh</span>&nbsp;<span class="op" id="5869775">:=</span>&nbsp;<span class="builtinfunc" id="5869778">new</span><span class="op" id="5869781">(</span><span class="ident" id="5869782">Section64</span><span class="op" id="5869791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869796">if</span>&nbsp;<span class="ident" id="5869799">err</span>&nbsp;<span class="op" id="5869803">:=</span>&nbsp;<span class="ident" id="5869806">binary</span><span class="op" id="5869812">.</span><span class="ident" id="5869813">Read</span><span class="op" id="5869817">(</span><span class="ident" id="5869818">sr</span><span class="op" id="5869820">,</span>&nbsp;<span class="ident" id="5869822">f</span><span class="op" id="5869823">.</span><span class="ident" id="5869824">ByteOrder</span><span class="op" id="5869833">,</span>&nbsp;<span class="ident" id="5869835">sh</span><span class="op" id="5869837">)</span><span class="op" id="5869838">;</span>&nbsp;<span class="ident" id="5869840">err</span>&nbsp;<span class="op" id="5869844">!=</span>&nbsp;<span class="ident" id="5869847">nil</span>&nbsp;<span class="op" id="5869851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5869857">return</span>&nbsp;<span class="ident" id="5869864">nil</span><span class="op" id="5869867">,</span>&nbsp;<span class="ident" id="5869869">err</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5869876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869881">names</span><span class="op" id="5869886">[</span><span class="ident" id="5869887">i</span><span class="op" id="5869888">]</span>&nbsp;<span class="op" id="5869890">=</span>&nbsp;<span class="ident" id="5869892">sh</span><span class="op" id="5869894">.</span><span class="ident" id="5869895">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869903">s</span><span class="op" id="5869904">.</span><span class="ident" id="5869905">SectionHeader</span>&nbsp;<span class="op" id="5869919">=</span>&nbsp;<span class="ident" id="5869921">SectionHeader</span><span class="op" id="5869934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869940">Type</span><span class="op" id="5869944">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869951">SectionType</span><span class="op" id="5869962">(</span><span class="ident" id="5869963">sh</span><span class="op" id="5869965">.</span><span class="ident" id="5869966">Type</span><span class="op" id="5869970">)</span><span class="op" id="5869971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5869977">Flags</span><span class="op" id="5869982">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5869988">SectionFlag</span><span class="op" id="5869999">(</span><span class="ident" id="5870000">sh</span><span class="op" id="5870002">.</span><span class="ident" id="5870003">Flags</span><span class="op" id="5870008">)</span><span class="op" id="5870009">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870015">Offset</span><span class="op" id="5870021">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5870026">uint64</span><span class="op" id="5870032">(</span><span class="ident" id="5870033">sh</span><span class="op" id="5870035">.</span><span class="ident" id="5870036">Off</span><span class="op" id="5870039">)</span><span class="op" id="5870040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870046">Size</span><span class="op" id="5870050">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5870057">uint64</span><span class="op" id="5870063">(</span><span class="ident" id="5870064">sh</span><span class="op" id="5870066">.</span><span class="ident" id="5870067">Size</span><span class="op" id="5870071">)</span><span class="op" id="5870072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870078">Addr</span><span class="op" id="5870082">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5870089">uint64</span><span class="op" id="5870095">(</span><span class="ident" id="5870096">sh</span><span class="op" id="5870098">.</span><span class="ident" id="5870099">Addr</span><span class="op" id="5870103">)</span><span class="op" id="5870104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870110">Link</span><span class="op" id="5870114">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5870121">uint32</span><span class="op" id="5870127">(</span><span class="ident" id="5870128">sh</span><span class="op" id="5870130">.</span><span class="ident" id="5870131">Link</span><span class="op" id="5870135">)</span><span class="op" id="5870136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870142">Info</span><span class="op" id="5870146">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5870153">uint32</span><span class="op" id="5870159">(</span><span class="ident" id="5870160">sh</span><span class="op" id="5870162">.</span><span class="ident" id="5870163">Info</span><span class="op" id="5870167">)</span><span class="op" id="5870168">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870174">Addralign</span><span class="op" id="5870183">:</span>&nbsp;<span class="ident" id="5870185">uint64</span><span class="op" id="5870191">(</span><span class="ident" id="5870192">sh</span><span class="op" id="5870194">.</span><span class="ident" id="5870195">Addralign</span><span class="op" id="5870204">)</span><span class="op" id="5870205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870211">Entsize</span><span class="op" id="5870218">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5870222">uint64</span><span class="op" id="5870228">(</span><span class="ident" id="5870229">sh</span><span class="op" id="5870231">.</span><span class="ident" id="5870232">Entsize</span><span class="op" id="5870239">)</span><span class="op" id="5870240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870253">s</span><span class="op" id="5870254">.</span><span class="ident" id="5870255">sr</span>&nbsp;<span class="op" id="5870258">=</span>&nbsp;<span class="ident" id="5870260">io</span><span class="op" id="5870262">.</span><span class="ident" id="5870263">NewSectionReader</span><span class="op" id="5870279">(</span><span class="ident" id="5870280">r</span><span class="op" id="5870281">,</span>&nbsp;<span class="ident" id="5870283">int64</span><span class="op" id="5870288">(</span><span class="ident" id="5870289">s</span><span class="op" id="5870290">.</span><span class="ident" id="5870291">Offset</span><span class="op" id="5870297">)</span><span class="op" id="5870298">,</span>&nbsp;<span class="ident" id="5870300">int64</span><span class="op" id="5870305">(</span><span class="ident" id="5870306">s</span><span class="op" id="5870307">.</span><span class="ident" id="5870308">Size</span><span class="op" id="5870312">)</span><span class="op" id="5870313">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870317">s</span><span class="op" id="5870318">.</span><span class="ident" id="5870319">ReaderAt</span>&nbsp;<span class="op" id="5870328">=</span>&nbsp;<span class="ident" id="5870330">s</span><span class="op" id="5870331">.</span><span class="ident" id="5870332">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870337">f</span><span class="op" id="5870338">.</span><span class="ident" id="5870339">Sections</span><span class="op" id="5870347">[</span><span class="ident" id="5870348">i</span><span class="op" id="5870349">]</span>&nbsp;<span class="op" id="5870351">=</span>&nbsp;<span class="ident" id="5870353">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870360">if</span>&nbsp;<span class="builtinfunc" id="5870363">len</span><span class="op" id="5870366">(</span><span class="ident" id="5870367">f</span><span class="op" id="5870368">.</span><span class="ident" id="5870369">Sections</span><span class="op" id="5870377">)</span>&nbsp;<span class="op" id="5870379">==</span>&nbsp;<span class="num" id="5870382">0</span>&nbsp;<span class="op" id="5870384">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870388">return</span>&nbsp;<span class="ident" id="5870395">f</span><span class="op" id="5870396">,</span>&nbsp;<span class="ident" id="5870398">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5870407">//&nbsp;Load&nbsp;section&nbsp;header&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870445">shstrtab</span><span class="op" id="5870453">,</span>&nbsp;<span class="ident" id="5870455">err</span>&nbsp;<span class="op" id="5870459">:=</span>&nbsp;<span class="ident" id="5870462">f</span><span class="op" id="5870463">.</span><span class="ident" id="5870464">Sections</span><span class="op" id="5870472">[</span><span class="ident" id="5870473">shstrndx</span><span class="op" id="5870481">]</span><span class="op" id="5870482">.</span><span class="ident" id="5870483">Data</span><span class="op" id="5870487">(</span><span class="op" id="5870488">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870491">if</span>&nbsp;<span class="ident" id="5870494">err</span>&nbsp;<span class="op" id="5870498">!=</span>&nbsp;<span class="ident" id="5870501">nil</span>&nbsp;<span class="op" id="5870505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870509">return</span>&nbsp;<span class="ident" id="5870516">nil</span><span class="op" id="5870519">,</span>&nbsp;<span class="ident" id="5870521">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870529">for</span>&nbsp;<span class="ident" id="5870533">i</span><span class="op" id="5870534">,</span>&nbsp;<span class="ident" id="5870536">s</span>&nbsp;<span class="op" id="5870538">:=</span>&nbsp;<span class="keyword" id="5870541">range</span>&nbsp;<span class="ident" id="5870547">f</span><span class="op" id="5870548">.</span><span class="ident" id="5870549">Sections</span>&nbsp;<span class="op" id="5870558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870562">var</span>&nbsp;<span class="ident" id="5870566">ok</span>&nbsp;<span class="builtintype" id="5870569">bool</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870576">s</span><span class="op" id="5870577">.</span><span class="ident" id="5870578">Name</span><span class="op" id="5870582">,</span>&nbsp;<span class="ident" id="5870584">ok</span>&nbsp;<span class="op" id="5870587">=</span>&nbsp;<span class="ident" id="5870589">getString</span><span class="op" id="5870598">(</span><span class="ident" id="5870599">shstrtab</span><span class="op" id="5870607">,</span>&nbsp;<span class="builtintype" id="5870609">int</span><span class="op" id="5870612">(</span><span class="ident" id="5870613">names</span><span class="op" id="5870618">[</span><span class="ident" id="5870619">i</span><span class="op" id="5870620">]</span><span class="op" id="5870621">)</span><span class="op" id="5870622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870626">if</span>&nbsp;<span class="op" id="5870629">!</span><span class="ident" id="5870630">ok</span>&nbsp;<span class="op" id="5870633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870638">return</span>&nbsp;<span class="ident" id="5870645">nil</span><span class="op" id="5870648">,</span>&nbsp;<span class="op" id="5870650">&amp;</span><span class="ident" id="5870651">FormatError</span><span class="op" id="5870662">{</span><span class="ident" id="5870663">shoff</span>&nbsp;<span class="op" id="5870669">+</span>&nbsp;<span class="ident" id="5870671">int64</span><span class="op" id="5870676">(</span><span class="ident" id="5870677">i</span><span class="op" id="5870678">*</span><span class="ident" id="5870679">shentsize</span><span class="op" id="5870688">)</span><span class="op" id="5870689">,</span>&nbsp;<span class="string" id="5870691">&#34;bad&nbsp;section&nbsp;name&nbsp;index&#34;</span><span class="op" id="5870715">,</span>&nbsp;<span class="ident" id="5870717">names</span><span class="op" id="5870722">[</span><span class="ident" id="5870723">i</span><span class="op" id="5870724">]</span><span class="op" id="5870725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870732">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870736">return</span>&nbsp;<span class="ident" id="5870743">f</span><span class="op" id="5870744">,</span>&nbsp;<span class="ident" id="5870746">nil</span><br>
<span class="lineno"></span><span class="op" id="5870750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5870753">//&nbsp;getSymbols&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;Symbols&nbsp;from&nbsp;parsing&nbsp;the&nbsp;symbol&nbsp;table</span><br>
<span class="lineno">395</span><span class="comment" id="5870824">//&nbsp;with&nbsp;the&nbsp;given&nbsp;type,&nbsp;along&nbsp;with&nbsp;the&nbsp;associated&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5870888">func</span>&nbsp;<span class="op" id="5870893">(</span><span class="ident" id="5870894">f</span>&nbsp;<span class="op" id="5870896">*</span><span class="ident" id="5870897">File</span><span class="op" id="5870901">)</span>&nbsp;<span class="ident" id="5870903">getSymbols</span><span class="op" id="5870913">(</span><span class="ident" id="5870914">typ</span>&nbsp;<span class="ident" id="5870918">SectionType</span><span class="op" id="5870929">)</span>&nbsp;<span class="op" id="5870931">(</span><span class="op" id="5870932">[</span><span class="op" id="5870933">]</span><span class="ident" id="5870934">Symbol</span><span class="op" id="5870940">,</span>&nbsp;<span class="op" id="5870942">[</span><span class="op" id="5870943">]</span><span class="builtintype" id="5870944">byte</span><span class="op" id="5870948">,</span>&nbsp;<span class="builtintype" id="5870950">error</span><span class="op" id="5870955">)</span>&nbsp;<span class="op" id="5870957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870960">switch</span>&nbsp;<span class="ident" id="5870967">f</span><span class="op" id="5870968">.</span><span class="ident" id="5870969">Class</span>&nbsp;<span class="op" id="5870975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870978">case</span>&nbsp;<span class="ident" id="5870983">ELFCLASS64</span><span class="op" id="5870993">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870997">return</span>&nbsp;<span class="ident" id="5871004">f</span><span class="op" id="5871005">.</span><span class="ident" id="5871006">getSymbols64</span><span class="op" id="5871018">(</span><span class="ident" id="5871019">typ</span><span class="op" id="5871022">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871026">case</span>&nbsp;<span class="ident" id="5871031">ELFCLASS32</span><span class="op" id="5871041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871045">return</span>&nbsp;<span class="ident" id="5871052">f</span><span class="op" id="5871053">.</span><span class="ident" id="5871054">getSymbols32</span><span class="op" id="5871066">(</span><span class="ident" id="5871067">typ</span><span class="op" id="5871070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871077">return</span>&nbsp;<span class="ident" id="5871084">nil</span><span class="op" id="5871087">,</span>&nbsp;<span class="ident" id="5871089">nil</span><span class="op" id="5871092">,</span>&nbsp;<span class="ident" id="5871094">errors</span><span class="op" id="5871100">.</span><span class="ident" id="5871101">New</span><span class="op" id="5871104">(</span><span class="string" id="5871105">&#34;not&nbsp;implemented&#34;</span><span class="op" id="5871122">)</span><br>
<span class="lineno"></span><span class="op" id="5871124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5871127">//&nbsp;ErrNoSymbols&nbsp;is&nbsp;returned&nbsp;by&nbsp;File.Symbols&nbsp;and&nbsp;File.DynamicSymbols</span><br>
<span class="lineno"></span><span class="comment" id="5871195">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section&nbsp;in&nbsp;the&nbsp;File.</span><br>
<span class="lineno">410</span><span class="keyword" id="5871239">var</span>&nbsp;<span class="ident" id="5871243">ErrNoSymbols</span>&nbsp;<span class="op" id="5871256">=</span>&nbsp;<span class="ident" id="5871258">errors</span><span class="op" id="5871264">.</span><span class="ident" id="5871265">New</span><span class="op" id="5871268">(</span><span class="string" id="5871269">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5871288">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5871291">func</span>&nbsp;<span class="op" id="5871296">(</span><span class="ident" id="5871297">f</span>&nbsp;<span class="op" id="5871299">*</span><span class="ident" id="5871300">File</span><span class="op" id="5871304">)</span>&nbsp;<span class="ident" id="5871306">getSymbols32</span><span class="op" id="5871318">(</span><span class="ident" id="5871319">typ</span>&nbsp;<span class="ident" id="5871323">SectionType</span><span class="op" id="5871334">)</span>&nbsp;<span class="op" id="5871336">(</span><span class="op" id="5871337">[</span><span class="op" id="5871338">]</span><span class="ident" id="5871339">Symbol</span><span class="op" id="5871345">,</span>&nbsp;<span class="op" id="5871347">[</span><span class="op" id="5871348">]</span><span class="builtintype" id="5871349">byte</span><span class="op" id="5871353">,</span>&nbsp;<span class="builtintype" id="5871355">error</span><span class="op" id="5871360">)</span>&nbsp;<span class="op" id="5871362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871365">symtabSection</span>&nbsp;<span class="op" id="5871379">:=</span>&nbsp;<span class="ident" id="5871382">f</span><span class="op" id="5871383">.</span><span class="ident" id="5871384">SectionByType</span><span class="op" id="5871397">(</span><span class="ident" id="5871398">typ</span><span class="op" id="5871401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871404">if</span>&nbsp;<span class="ident" id="5871407">symtabSection</span>&nbsp;<span class="op" id="5871421">==</span>&nbsp;<span class="ident" id="5871424">nil</span>&nbsp;<span class="op" id="5871428">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871432">return</span>&nbsp;<span class="ident" id="5871439">nil</span><span class="op" id="5871442">,</span>&nbsp;<span class="ident" id="5871444">nil</span><span class="op" id="5871447">,</span>&nbsp;<span class="ident" id="5871449">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871467">data</span><span class="op" id="5871471">,</span>&nbsp;<span class="ident" id="5871473">err</span>&nbsp;<span class="op" id="5871477">:=</span>&nbsp;<span class="ident" id="5871480">symtabSection</span><span class="op" id="5871493">.</span><span class="ident" id="5871494">Data</span><span class="op" id="5871498">(</span><span class="op" id="5871499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871502">if</span>&nbsp;<span class="ident" id="5871505">err</span>&nbsp;<span class="op" id="5871509">!=</span>&nbsp;<span class="ident" id="5871512">nil</span>&nbsp;<span class="op" id="5871516">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871520">return</span>&nbsp;<span class="ident" id="5871527">nil</span><span class="op" id="5871530">,</span>&nbsp;<span class="ident" id="5871532">nil</span><span class="op" id="5871535">,</span>&nbsp;<span class="ident" id="5871537">errors</span><span class="op" id="5871543">.</span><span class="ident" id="5871544">New</span><span class="op" id="5871547">(</span><span class="string" id="5871548">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5871576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871582">symtab</span>&nbsp;<span class="op" id="5871589">:=</span>&nbsp;<span class="ident" id="5871592">bytes</span><span class="op" id="5871597">.</span><span class="ident" id="5871598">NewReader</span><span class="op" id="5871607">(</span><span class="ident" id="5871608">data</span><span class="op" id="5871612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871615">if</span>&nbsp;<span class="ident" id="5871618">symtab</span><span class="op" id="5871624">.</span><span class="ident" id="5871625">Len</span><span class="op" id="5871628">(</span><span class="op" id="5871629">)</span><span class="op" id="5871630">%</span><span class="ident" id="5871631">Sym32Size</span>&nbsp;<span class="op" id="5871641">!=</span>&nbsp;<span class="num" id="5871644">0</span>&nbsp;<span class="op" id="5871646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871650">return</span>&nbsp;<span class="ident" id="5871657">nil</span><span class="op" id="5871660">,</span>&nbsp;<span class="ident" id="5871662">nil</span><span class="op" id="5871665">,</span>&nbsp;<span class="ident" id="5871667">errors</span><span class="op" id="5871673">.</span><span class="ident" id="5871674">New</span><span class="op" id="5871677">(</span><span class="string" id="5871678">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;SymSize&#34;</span><span class="op" id="5871733">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871740">strdata</span><span class="op" id="5871747">,</span>&nbsp;<span class="ident" id="5871749">err</span>&nbsp;<span class="op" id="5871753">:=</span>&nbsp;<span class="ident" id="5871756">f</span><span class="op" id="5871757">.</span><span class="ident" id="5871758">stringTable</span><span class="op" id="5871769">(</span><span class="ident" id="5871770">symtabSection</span><span class="op" id="5871783">.</span><span class="ident" id="5871784">Link</span><span class="op" id="5871788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871791">if</span>&nbsp;<span class="ident" id="5871794">err</span>&nbsp;<span class="op" id="5871798">!=</span>&nbsp;<span class="ident" id="5871801">nil</span>&nbsp;<span class="op" id="5871805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871809">return</span>&nbsp;<span class="ident" id="5871816">nil</span><span class="op" id="5871819">,</span>&nbsp;<span class="ident" id="5871821">nil</span><span class="op" id="5871824">,</span>&nbsp;<span class="ident" id="5871826">errors</span><span class="op" id="5871832">.</span><span class="ident" id="5871833">New</span><span class="op" id="5871836">(</span><span class="string" id="5871837">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="5871871">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5871878">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871912">var</span>&nbsp;<span class="ident" id="5871916">skip</span>&nbsp;<span class="op" id="5871921">[</span><span class="ident" id="5871922">Sym32Size</span><span class="op" id="5871931">]</span><span class="builtintype" id="5871932">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871938">symtab</span><span class="op" id="5871944">.</span><span class="ident" id="5871945">Read</span><span class="op" id="5871949">(</span><span class="ident" id="5871950">skip</span><span class="op" id="5871954">[</span><span class="op" id="5871955">:</span><span class="op" id="5871956">]</span><span class="op" id="5871957">)</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871961">symbols</span>&nbsp;<span class="op" id="5871969">:=</span>&nbsp;<span class="builtinfunc" id="5871972">make</span><span class="op" id="5871976">(</span><span class="op" id="5871977">[</span><span class="op" id="5871978">]</span><span class="ident" id="5871979">Symbol</span><span class="op" id="5871985">,</span>&nbsp;<span class="ident" id="5871987">symtab</span><span class="op" id="5871993">.</span><span class="ident" id="5871994">Len</span><span class="op" id="5871997">(</span><span class="op" id="5871998">)</span><span class="op" id="5871999">/</span><span class="ident" id="5872000">Sym32Size</span><span class="op" id="5872009">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872013">i</span>&nbsp;<span class="op" id="5872015">:=</span>&nbsp;<span class="num" id="5872018">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872021">var</span>&nbsp;<span class="ident" id="5872025">sym</span>&nbsp;<span class="ident" id="5872029">Sym32</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872036">for</span>&nbsp;<span class="ident" id="5872040">symtab</span><span class="op" id="5872046">.</span><span class="ident" id="5872047">Len</span><span class="op" id="5872050">(</span><span class="op" id="5872051">)</span>&nbsp;<span class="op" id="5872053">&gt;</span>&nbsp;<span class="num" id="5872055">0</span>&nbsp;<span class="op" id="5872057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872061">binary</span><span class="op" id="5872067">.</span><span class="ident" id="5872068">Read</span><span class="op" id="5872072">(</span><span class="ident" id="5872073">symtab</span><span class="op" id="5872079">,</span>&nbsp;<span class="ident" id="5872081">f</span><span class="op" id="5872082">.</span><span class="ident" id="5872083">ByteOrder</span><span class="op" id="5872092">,</span>&nbsp;<span class="op" id="5872094">&amp;</span><span class="ident" id="5872095">sym</span><span class="op" id="5872098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872102">str</span><span class="op" id="5872105">,</span>&nbsp;<span class="ident" id="5872107">_</span>&nbsp;<span class="op" id="5872109">:=</span>&nbsp;<span class="ident" id="5872112">getString</span><span class="op" id="5872121">(</span><span class="ident" id="5872122">strdata</span><span class="op" id="5872129">,</span>&nbsp;<span class="builtintype" id="5872131">int</span><span class="op" id="5872134">(</span><span class="ident" id="5872135">sym</span><span class="op" id="5872138">.</span><span class="ident" id="5872139">Name</span><span class="op" id="5872143">)</span><span class="op" id="5872144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872148">symbols</span><span class="op" id="5872155">[</span><span class="ident" id="5872156">i</span><span class="op" id="5872157">]</span><span class="op" id="5872158">.</span><span class="ident" id="5872159">Name</span>&nbsp;<span class="op" id="5872164">=</span>&nbsp;<span class="ident" id="5872166">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872172">symbols</span><span class="op" id="5872179">[</span><span class="ident" id="5872180">i</span><span class="op" id="5872181">]</span><span class="op" id="5872182">.</span><span class="ident" id="5872183">Info</span>&nbsp;<span class="op" id="5872188">=</span>&nbsp;<span class="ident" id="5872190">sym</span><span class="op" id="5872193">.</span><span class="ident" id="5872194">Info</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872201">symbols</span><span class="op" id="5872208">[</span><span class="ident" id="5872209">i</span><span class="op" id="5872210">]</span><span class="op" id="5872211">.</span><span class="ident" id="5872212">Other</span>&nbsp;<span class="op" id="5872218">=</span>&nbsp;<span class="ident" id="5872220">sym</span><span class="op" id="5872223">.</span><span class="ident" id="5872224">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872232">symbols</span><span class="op" id="5872239">[</span><span class="ident" id="5872240">i</span><span class="op" id="5872241">]</span><span class="op" id="5872242">.</span><span class="ident" id="5872243">Section</span>&nbsp;<span class="op" id="5872251">=</span>&nbsp;<span class="ident" id="5872253">SectionIndex</span><span class="op" id="5872265">(</span><span class="ident" id="5872266">sym</span><span class="op" id="5872269">.</span><span class="ident" id="5872270">Shndx</span><span class="op" id="5872275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872279">symbols</span><span class="op" id="5872286">[</span><span class="ident" id="5872287">i</span><span class="op" id="5872288">]</span><span class="op" id="5872289">.</span><span class="ident" id="5872290">Value</span>&nbsp;<span class="op" id="5872296">=</span>&nbsp;<span class="ident" id="5872298">uint64</span><span class="op" id="5872304">(</span><span class="ident" id="5872305">sym</span><span class="op" id="5872308">.</span><span class="ident" id="5872309">Value</span><span class="op" id="5872314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872318">symbols</span><span class="op" id="5872325">[</span><span class="ident" id="5872326">i</span><span class="op" id="5872327">]</span><span class="op" id="5872328">.</span><span class="ident" id="5872329">Size</span>&nbsp;<span class="op" id="5872334">=</span>&nbsp;<span class="ident" id="5872336">uint64</span><span class="op" id="5872342">(</span><span class="ident" id="5872343">sym</span><span class="op" id="5872346">.</span><span class="ident" id="5872347">Size</span><span class="op" id="5872351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872355">i</span><span class="op" id="5872356">++</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5872360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872364">return</span>&nbsp;<span class="ident" id="5872371">symbols</span><span class="op" id="5872378">,</span>&nbsp;<span class="ident" id="5872380">strdata</span><span class="op" id="5872387">,</span>&nbsp;<span class="ident" id="5872389">nil</span><br>
<span class="lineno"></span><span class="op" id="5872393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword" id="5872396">func</span>&nbsp;<span class="op" id="5872401">(</span><span class="ident" id="5872402">f</span>&nbsp;<span class="op" id="5872404">*</span><span class="ident" id="5872405">File</span><span class="op" id="5872409">)</span>&nbsp;<span class="ident" id="5872411">getSymbols64</span><span class="op" id="5872423">(</span><span class="ident" id="5872424">typ</span>&nbsp;<span class="ident" id="5872428">SectionType</span><span class="op" id="5872439">)</span>&nbsp;<span class="op" id="5872441">(</span><span class="op" id="5872442">[</span><span class="op" id="5872443">]</span><span class="ident" id="5872444">Symbol</span><span class="op" id="5872450">,</span>&nbsp;<span class="op" id="5872452">[</span><span class="op" id="5872453">]</span><span class="builtintype" id="5872454">byte</span><span class="op" id="5872458">,</span>&nbsp;<span class="builtintype" id="5872460">error</span><span class="op" id="5872465">)</span>&nbsp;<span class="op" id="5872467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872470">symtabSection</span>&nbsp;<span class="op" id="5872484">:=</span>&nbsp;<span class="ident" id="5872487">f</span><span class="op" id="5872488">.</span><span class="ident" id="5872489">SectionByType</span><span class="op" id="5872502">(</span><span class="ident" id="5872503">typ</span><span class="op" id="5872506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872509">if</span>&nbsp;<span class="ident" id="5872512">symtabSection</span>&nbsp;<span class="op" id="5872526">==</span>&nbsp;<span class="ident" id="5872529">nil</span>&nbsp;<span class="op" id="5872533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872537">return</span>&nbsp;<span class="ident" id="5872544">nil</span><span class="op" id="5872547">,</span>&nbsp;<span class="ident" id="5872549">nil</span><span class="op" id="5872552">,</span>&nbsp;<span class="ident" id="5872554">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5872568">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872572">data</span><span class="op" id="5872576">,</span>&nbsp;<span class="ident" id="5872578">err</span>&nbsp;<span class="op" id="5872582">:=</span>&nbsp;<span class="ident" id="5872585">symtabSection</span><span class="op" id="5872598">.</span><span class="ident" id="5872599">Data</span><span class="op" id="5872603">(</span><span class="op" id="5872604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872607">if</span>&nbsp;<span class="ident" id="5872610">err</span>&nbsp;<span class="op" id="5872614">!=</span>&nbsp;<span class="ident" id="5872617">nil</span>&nbsp;<span class="op" id="5872621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872625">return</span>&nbsp;<span class="ident" id="5872632">nil</span><span class="op" id="5872635">,</span>&nbsp;<span class="ident" id="5872637">nil</span><span class="op" id="5872640">,</span>&nbsp;<span class="ident" id="5872642">errors</span><span class="op" id="5872648">.</span><span class="ident" id="5872649">New</span><span class="op" id="5872652">(</span><span class="string" id="5872653">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5872681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5872684">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872687">symtab</span>&nbsp;<span class="op" id="5872694">:=</span>&nbsp;<span class="ident" id="5872697">bytes</span><span class="op" id="5872702">.</span><span class="ident" id="5872703">NewReader</span><span class="op" id="5872712">(</span><span class="ident" id="5872713">data</span><span class="op" id="5872717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872720">if</span>&nbsp;<span class="ident" id="5872723">symtab</span><span class="op" id="5872729">.</span><span class="ident" id="5872730">Len</span><span class="op" id="5872733">(</span><span class="op" id="5872734">)</span><span class="op" id="5872735">%</span><span class="ident" id="5872736">Sym64Size</span>&nbsp;<span class="op" id="5872746">!=</span>&nbsp;<span class="num" id="5872749">0</span>&nbsp;<span class="op" id="5872751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872755">return</span>&nbsp;<span class="ident" id="5872762">nil</span><span class="op" id="5872765">,</span>&nbsp;<span class="ident" id="5872767">nil</span><span class="op" id="5872770">,</span>&nbsp;<span class="ident" id="5872772">errors</span><span class="op" id="5872778">.</span><span class="ident" id="5872779">New</span><span class="op" id="5872782">(</span><span class="string" id="5872783">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;Sym64Size&#34;</span><span class="op" id="5872840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5872843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872847">strdata</span><span class="op" id="5872854">,</span>&nbsp;<span class="ident" id="5872856">err</span>&nbsp;<span class="op" id="5872860">:=</span>&nbsp;<span class="ident" id="5872863">f</span><span class="op" id="5872864">.</span><span class="ident" id="5872865">stringTable</span><span class="op" id="5872876">(</span><span class="ident" id="5872877">symtabSection</span><span class="op" id="5872890">.</span><span class="ident" id="5872891">Link</span><span class="op" id="5872895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872898">if</span>&nbsp;<span class="ident" id="5872901">err</span>&nbsp;<span class="op" id="5872905">!=</span>&nbsp;<span class="ident" id="5872908">nil</span>&nbsp;<span class="op" id="5872912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872916">return</span>&nbsp;<span class="ident" id="5872923">nil</span><span class="op" id="5872926">,</span>&nbsp;<span class="ident" id="5872928">nil</span><span class="op" id="5872931">,</span>&nbsp;<span class="ident" id="5872933">errors</span><span class="op" id="5872939">.</span><span class="ident" id="5872940">New</span><span class="op" id="5872943">(</span><span class="string" id="5872944">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="5872978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5872981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5872985">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873019">var</span>&nbsp;<span class="ident" id="5873023">skip</span>&nbsp;<span class="op" id="5873028">[</span><span class="ident" id="5873029">Sym64Size</span><span class="op" id="5873038">]</span><span class="builtintype" id="5873039">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873045">symtab</span><span class="op" id="5873051">.</span><span class="ident" id="5873052">Read</span><span class="op" id="5873056">(</span><span class="ident" id="5873057">skip</span><span class="op" id="5873061">[</span><span class="op" id="5873062">:</span><span class="op" id="5873063">]</span><span class="op" id="5873064">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873068">symbols</span>&nbsp;<span class="op" id="5873076">:=</span>&nbsp;<span class="builtinfunc" id="5873079">make</span><span class="op" id="5873083">(</span><span class="op" id="5873084">[</span><span class="op" id="5873085">]</span><span class="ident" id="5873086">Symbol</span><span class="op" id="5873092">,</span>&nbsp;<span class="ident" id="5873094">symtab</span><span class="op" id="5873100">.</span><span class="ident" id="5873101">Len</span><span class="op" id="5873104">(</span><span class="op" id="5873105">)</span><span class="op" id="5873106">/</span><span class="ident" id="5873107">Sym64Size</span><span class="op" id="5873116">)</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873120">i</span>&nbsp;<span class="op" id="5873122">:=</span>&nbsp;<span class="num" id="5873125">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873128">var</span>&nbsp;<span class="ident" id="5873132">sym</span>&nbsp;<span class="ident" id="5873136">Sym64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873143">for</span>&nbsp;<span class="ident" id="5873147">symtab</span><span class="op" id="5873153">.</span><span class="ident" id="5873154">Len</span><span class="op" id="5873157">(</span><span class="op" id="5873158">)</span>&nbsp;<span class="op" id="5873160">&gt;</span>&nbsp;<span class="num" id="5873162">0</span>&nbsp;<span class="op" id="5873164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873168">binary</span><span class="op" id="5873174">.</span><span class="ident" id="5873175">Read</span><span class="op" id="5873179">(</span><span class="ident" id="5873180">symtab</span><span class="op" id="5873186">,</span>&nbsp;<span class="ident" id="5873188">f</span><span class="op" id="5873189">.</span><span class="ident" id="5873190">ByteOrder</span><span class="op" id="5873199">,</span>&nbsp;<span class="op" id="5873201">&amp;</span><span class="ident" id="5873202">sym</span><span class="op" id="5873205">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873209">str</span><span class="op" id="5873212">,</span>&nbsp;<span class="ident" id="5873214">_</span>&nbsp;<span class="op" id="5873216">:=</span>&nbsp;<span class="ident" id="5873219">getString</span><span class="op" id="5873228">(</span><span class="ident" id="5873229">strdata</span><span class="op" id="5873236">,</span>&nbsp;<span class="builtintype" id="5873238">int</span><span class="op" id="5873241">(</span><span class="ident" id="5873242">sym</span><span class="op" id="5873245">.</span><span class="ident" id="5873246">Name</span><span class="op" id="5873250">)</span><span class="op" id="5873251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873255">symbols</span><span class="op" id="5873262">[</span><span class="ident" id="5873263">i</span><span class="op" id="5873264">]</span><span class="op" id="5873265">.</span><span class="ident" id="5873266">Name</span>&nbsp;<span class="op" id="5873271">=</span>&nbsp;<span class="ident" id="5873273">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873279">symbols</span><span class="op" id="5873286">[</span><span class="ident" id="5873287">i</span><span class="op" id="5873288">]</span><span class="op" id="5873289">.</span><span class="ident" id="5873290">Info</span>&nbsp;<span class="op" id="5873295">=</span>&nbsp;<span class="ident" id="5873297">sym</span><span class="op" id="5873300">.</span><span class="ident" id="5873301">Info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873308">symbols</span><span class="op" id="5873315">[</span><span class="ident" id="5873316">i</span><span class="op" id="5873317">]</span><span class="op" id="5873318">.</span><span class="ident" id="5873319">Other</span>&nbsp;<span class="op" id="5873325">=</span>&nbsp;<span class="ident" id="5873327">sym</span><span class="op" id="5873330">.</span><span class="ident" id="5873331">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873339">symbols</span><span class="op" id="5873346">[</span><span class="ident" id="5873347">i</span><span class="op" id="5873348">]</span><span class="op" id="5873349">.</span><span class="ident" id="5873350">Section</span>&nbsp;<span class="op" id="5873358">=</span>&nbsp;<span class="ident" id="5873360">SectionIndex</span><span class="op" id="5873372">(</span><span class="ident" id="5873373">sym</span><span class="op" id="5873376">.</span><span class="ident" id="5873377">Shndx</span><span class="op" id="5873382">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873386">symbols</span><span class="op" id="5873393">[</span><span class="ident" id="5873394">i</span><span class="op" id="5873395">]</span><span class="op" id="5873396">.</span><span class="ident" id="5873397">Value</span>&nbsp;<span class="op" id="5873403">=</span>&nbsp;<span class="ident" id="5873405">sym</span><span class="op" id="5873408">.</span><span class="ident" id="5873409">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873417">symbols</span><span class="op" id="5873424">[</span><span class="ident" id="5873425">i</span><span class="op" id="5873426">]</span><span class="op" id="5873427">.</span><span class="ident" id="5873428">Size</span>&nbsp;<span class="op" id="5873433">=</span>&nbsp;<span class="ident" id="5873435">sym</span><span class="op" id="5873438">.</span><span class="ident" id="5873439">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5873446">i</span><span class="op" id="5873447">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873455">return</span>&nbsp;<span class="ident" id="5873462">symbols</span><span class="op" id="5873469">,</span>&nbsp;<span class="ident" id="5873471">strdata</span><span class="op" id="5873478">,</span>&nbsp;<span class="ident" id="5873480">nil</span><br>
<span class="lineno"></span><span class="op" id="5873484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5873487">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;an&nbsp;ELF&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5873544">func</span>&nbsp;<span class="ident" id="5873549">getString</span><span class="op" id="5873558">(</span><span class="ident" id="5873559">section</span>&nbsp;<span class="op" id="5873567">[</span><span class="op" id="5873568">]</span><span class="builtintype" id="5873569">byte</span><span class="op" id="5873573">,</span>&nbsp;<span class="ident" id="5873575">start</span>&nbsp;<span class="builtintype" id="5873581">int</span><span class="op" id="5873584">)</span>&nbsp;<span class="op" id="5873586">(</span><span class="builtintype" id="5873587">string</span><span class="op" id="5873593">,</span>&nbsp;<span class="builtintype" id="5873595">bool</span><span class="op" id="5873599">)</span>&nbsp;<span class="op" id="5873601">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873604">if</span>&nbsp;<span class="ident" id="5873607">start</span>&nbsp;<span class="op" id="5873613">&lt;</span>&nbsp;<span class="num" id="5873615">0</span>&nbsp;<span class="op" id="5873617">||</span>&nbsp;<span class="ident" id="5873620">start</span>&nbsp;<span class="op" id="5873626">&gt;=</span>&nbsp;<span class="builtinfunc" id="5873629">len</span><span class="op" id="5873632">(</span><span class="ident" id="5873633">section</span><span class="op" id="5873640">)</span>&nbsp;<span class="op" id="5873642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873646">return</span>&nbsp;<span class="string" id="5873653">&#34;&#34;</span><span class="op" id="5873655">,</span>&nbsp;<span class="builtintype" id="5873657">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873668">for</span>&nbsp;<span class="ident" id="5873672">end</span>&nbsp;<span class="op" id="5873676">:=</span>&nbsp;<span class="ident" id="5873679">start</span><span class="op" id="5873684">;</span>&nbsp;<span class="ident" id="5873686">end</span>&nbsp;<span class="op" id="5873690">&lt;</span>&nbsp;<span class="builtinfunc" id="5873692">len</span><span class="op" id="5873695">(</span><span class="ident" id="5873696">section</span><span class="op" id="5873703">)</span><span class="op" id="5873704">;</span>&nbsp;<span class="ident" id="5873706">end</span><span class="op" id="5873709">++</span>&nbsp;<span class="op" id="5873712">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873716">if</span>&nbsp;<span class="ident" id="5873719">section</span><span class="op" id="5873726">[</span><span class="ident" id="5873727">end</span><span class="op" id="5873730">]</span>&nbsp;<span class="op" id="5873732">==</span>&nbsp;<span class="num" id="5873735">0</span>&nbsp;<span class="op" id="5873737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873742">return</span>&nbsp;<span class="builtintype" id="5873749">string</span><span class="op" id="5873755">(</span><span class="ident" id="5873756">section</span><span class="op" id="5873763">[</span><span class="ident" id="5873764">start</span><span class="op" id="5873769">:</span><span class="ident" id="5873770">end</span><span class="op" id="5873773">]</span><span class="op" id="5873774">)</span><span class="op" id="5873775">,</span>&nbsp;<span class="builtintype" id="5873777">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5873787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873790">return</span>&nbsp;<span class="string" id="5873797">&#34;&#34;</span><span class="op" id="5873799">,</span>&nbsp;<span class="builtintype" id="5873801">false</span><br>
<span class="lineno">510</span><span class="op" id="5873807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5873810">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5873878">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5873897">func</span>&nbsp;<span class="op" id="5873902">(</span><span class="ident" id="5873903">f</span>&nbsp;<span class="op" id="5873905">*</span><span class="ident" id="5873906">File</span><span class="op" id="5873910">)</span>&nbsp;<span class="ident" id="5873912">Section</span><span class="op" id="5873919">(</span><span class="ident" id="5873920">name</span>&nbsp;<span class="builtintype" id="5873925">string</span><span class="op" id="5873931">)</span>&nbsp;<span class="op" id="5873933">*</span><span class="ident" id="5873934">Section</span>&nbsp;<span class="op" id="5873942">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873945">for</span>&nbsp;<span class="ident" id="5873949">_</span><span class="op" id="5873950">,</span>&nbsp;<span class="ident" id="5873952">s</span>&nbsp;<span class="op" id="5873954">:=</span>&nbsp;<span class="keyword" id="5873957">range</span>&nbsp;<span class="ident" id="5873963">f</span><span class="op" id="5873964">.</span><span class="ident" id="5873965">Sections</span>&nbsp;<span class="op" id="5873974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5873978">if</span>&nbsp;<span class="ident" id="5873981">s</span><span class="op" id="5873982">.</span><span class="ident" id="5873983">Name</span>&nbsp;<span class="op" id="5873988">==</span>&nbsp;<span class="ident" id="5873991">name</span>&nbsp;<span class="op" id="5873996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874001">return</span>&nbsp;<span class="ident" id="5874008">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874015">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874018">return</span>&nbsp;<span class="ident" id="5874025">nil</span><br>
<span class="lineno"></span><span class="op" id="5874029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5874032">//&nbsp;applyRelocations&nbsp;applies&nbsp;relocations&nbsp;to&nbsp;dst.&nbsp;rels&nbsp;is&nbsp;a&nbsp;relocations&nbsp;section</span><br>
<span class="lineno"></span><span class="comment" id="5874110">//&nbsp;in&nbsp;RELA&nbsp;format.</span><br>
<span class="lineno">525</span><span class="keyword" id="5874129">func</span>&nbsp;<span class="op" id="5874134">(</span><span class="ident" id="5874135">f</span>&nbsp;<span class="op" id="5874137">*</span><span class="ident" id="5874138">File</span><span class="op" id="5874142">)</span>&nbsp;<span class="ident" id="5874144">applyRelocations</span><span class="op" id="5874160">(</span><span class="ident" id="5874161">dst</span>&nbsp;<span class="op" id="5874165">[</span><span class="op" id="5874166">]</span><span class="builtintype" id="5874167">byte</span><span class="op" id="5874171">,</span>&nbsp;<span class="ident" id="5874173">rels</span>&nbsp;<span class="op" id="5874178">[</span><span class="op" id="5874179">]</span><span class="builtintype" id="5874180">byte</span><span class="op" id="5874184">)</span>&nbsp;<span class="builtintype" id="5874186">error</span>&nbsp;<span class="op" id="5874192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874195">if</span>&nbsp;<span class="ident" id="5874198">f</span><span class="op" id="5874199">.</span><span class="ident" id="5874200">Class</span>&nbsp;<span class="op" id="5874206">==</span>&nbsp;<span class="ident" id="5874209">ELFCLASS64</span>&nbsp;<span class="op" id="5874220">&amp;&amp;</span>&nbsp;<span class="ident" id="5874223">f</span><span class="op" id="5874224">.</span><span class="ident" id="5874225">Machine</span>&nbsp;<span class="op" id="5874233">==</span>&nbsp;<span class="ident" id="5874236">EM_X86_64</span>&nbsp;<span class="op" id="5874246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874250">return</span>&nbsp;<span class="ident" id="5874257">f</span><span class="op" id="5874258">.</span><span class="ident" id="5874259">applyRelocationsAMD64</span><span class="op" id="5874280">(</span><span class="ident" id="5874281">dst</span><span class="op" id="5874284">,</span>&nbsp;<span class="ident" id="5874286">rels</span><span class="op" id="5874290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874296">if</span>&nbsp;<span class="ident" id="5874299">f</span><span class="op" id="5874300">.</span><span class="ident" id="5874301">Class</span>&nbsp;<span class="op" id="5874307">==</span>&nbsp;<span class="ident" id="5874310">ELFCLASS32</span>&nbsp;<span class="op" id="5874321">&amp;&amp;</span>&nbsp;<span class="ident" id="5874324">f</span><span class="op" id="5874325">.</span><span class="ident" id="5874326">Machine</span>&nbsp;<span class="op" id="5874334">==</span>&nbsp;<span class="ident" id="5874337">EM_386</span>&nbsp;<span class="op" id="5874344">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874348">return</span>&nbsp;<span class="ident" id="5874355">f</span><span class="op" id="5874356">.</span><span class="ident" id="5874357">applyRelocations386</span><span class="op" id="5874376">(</span><span class="ident" id="5874377">dst</span><span class="op" id="5874380">,</span>&nbsp;<span class="ident" id="5874382">rels</span><span class="op" id="5874386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874392">if</span>&nbsp;<span class="ident" id="5874395">f</span><span class="op" id="5874396">.</span><span class="ident" id="5874397">Class</span>&nbsp;<span class="op" id="5874403">==</span>&nbsp;<span class="ident" id="5874406">ELFCLASS64</span>&nbsp;<span class="op" id="5874417">&amp;&amp;</span>&nbsp;<span class="ident" id="5874420">f</span><span class="op" id="5874421">.</span><span class="ident" id="5874422">Machine</span>&nbsp;<span class="op" id="5874430">==</span>&nbsp;<span class="ident" id="5874433">EM_AARCH64</span>&nbsp;<span class="op" id="5874444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874448">return</span>&nbsp;<span class="ident" id="5874455">f</span><span class="op" id="5874456">.</span><span class="ident" id="5874457">applyRelocationsARM64</span><span class="op" id="5874478">(</span><span class="ident" id="5874479">dst</span><span class="op" id="5874482">,</span>&nbsp;<span class="ident" id="5874484">rels</span><span class="op" id="5874488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874491">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874495">return</span>&nbsp;<span class="ident" id="5874502">errors</span><span class="op" id="5874508">.</span><span class="ident" id="5874509">New</span><span class="op" id="5874512">(</span><span class="string" id="5874513">&#34;not&nbsp;implemented&#34;</span><span class="op" id="5874530">)</span><br>
<span class="lineno"></span><span class="op" id="5874532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5874535">func</span>&nbsp;<span class="op" id="5874540">(</span><span class="ident" id="5874541">f</span>&nbsp;<span class="op" id="5874543">*</span><span class="ident" id="5874544">File</span><span class="op" id="5874548">)</span>&nbsp;<span class="ident" id="5874550">applyRelocationsAMD64</span><span class="op" id="5874571">(</span><span class="ident" id="5874572">dst</span>&nbsp;<span class="op" id="5874576">[</span><span class="op" id="5874577">]</span><span class="builtintype" id="5874578">byte</span><span class="op" id="5874582">,</span>&nbsp;<span class="ident" id="5874584">rels</span>&nbsp;<span class="op" id="5874589">[</span><span class="op" id="5874590">]</span><span class="builtintype" id="5874591">byte</span><span class="op" id="5874595">)</span>&nbsp;<span class="builtintype" id="5874597">error</span>&nbsp;<span class="op" id="5874603">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5874606">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874636">if</span>&nbsp;<span class="builtinfunc" id="5874639">len</span><span class="op" id="5874642">(</span><span class="ident" id="5874643">rels</span><span class="op" id="5874647">)</span><span class="op" id="5874648">%</span><span class="num" id="5874649">24</span>&nbsp;<span class="op" id="5874652">!=</span>&nbsp;<span class="num" id="5874655">0</span>&nbsp;<span class="op" id="5874657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874661">return</span>&nbsp;<span class="ident" id="5874668">errors</span><span class="op" id="5874674">.</span><span class="ident" id="5874675">New</span><span class="op" id="5874678">(</span><span class="string" id="5874679">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="5874733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874740">symbols</span><span class="op" id="5874747">,</span>&nbsp;<span class="ident" id="5874749">_</span><span class="op" id="5874750">,</span>&nbsp;<span class="ident" id="5874752">err</span>&nbsp;<span class="op" id="5874756">:=</span>&nbsp;<span class="ident" id="5874759">f</span><span class="op" id="5874760">.</span><span class="ident" id="5874761">getSymbols</span><span class="op" id="5874771">(</span><span class="ident" id="5874772">SHT_SYMTAB</span><span class="op" id="5874782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874785">if</span>&nbsp;<span class="ident" id="5874788">err</span>&nbsp;<span class="op" id="5874792">!=</span>&nbsp;<span class="ident" id="5874795">nil</span>&nbsp;<span class="op" id="5874799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874803">return</span>&nbsp;<span class="ident" id="5874810">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5874815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874819">b</span>&nbsp;<span class="op" id="5874821">:=</span>&nbsp;<span class="ident" id="5874824">bytes</span><span class="op" id="5874829">.</span><span class="ident" id="5874830">NewReader</span><span class="op" id="5874839">(</span><span class="ident" id="5874840">rels</span><span class="op" id="5874844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874847">var</span>&nbsp;<span class="ident" id="5874851">rela</span>&nbsp;<span class="ident" id="5874856">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874865">for</span>&nbsp;<span class="ident" id="5874869">b</span><span class="op" id="5874870">.</span><span class="ident" id="5874871">Len</span><span class="op" id="5874874">(</span><span class="op" id="5874875">)</span>&nbsp;<span class="op" id="5874877">&gt;</span>&nbsp;<span class="num" id="5874879">0</span>&nbsp;<span class="op" id="5874881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874885">binary</span><span class="op" id="5874891">.</span><span class="ident" id="5874892">Read</span><span class="op" id="5874896">(</span><span class="ident" id="5874897">b</span><span class="op" id="5874898">,</span>&nbsp;<span class="ident" id="5874900">f</span><span class="op" id="5874901">.</span><span class="ident" id="5874902">ByteOrder</span><span class="op" id="5874911">,</span>&nbsp;<span class="op" id="5874913">&amp;</span><span class="ident" id="5874914">rela</span><span class="op" id="5874918">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874922">symNo</span>&nbsp;<span class="op" id="5874928">:=</span>&nbsp;<span class="ident" id="5874931">rela</span><span class="op" id="5874935">.</span><span class="ident" id="5874936">Info</span>&nbsp;<span class="op" id="5874941">&gt;&gt;</span>&nbsp;<span class="num" id="5874944">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5874949">t</span>&nbsp;<span class="op" id="5874951">:=</span>&nbsp;<span class="ident" id="5874954">R_X86_64</span><span class="op" id="5874962">(</span><span class="ident" id="5874963">rela</span><span class="op" id="5874967">.</span><span class="ident" id="5874968">Info</span>&nbsp;<span class="op" id="5874973">&amp;</span>&nbsp;<span class="num" id="5874975">0xffff</span><span class="op" id="5874981">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5874986">if</span>&nbsp;<span class="ident" id="5874989">symNo</span>&nbsp;<span class="op" id="5874995">==</span>&nbsp;<span class="num" id="5874998">0</span>&nbsp;<span class="op" id="5875000">||</span>&nbsp;<span class="ident" id="5875003">symNo</span>&nbsp;<span class="op" id="5875009">&gt;</span>&nbsp;<span class="ident" id="5875011">uint64</span><span class="op" id="5875017">(</span><span class="builtinfunc" id="5875018">len</span><span class="op" id="5875021">(</span><span class="ident" id="5875022">symbols</span><span class="op" id="5875029">)</span><span class="op" id="5875030">)</span>&nbsp;<span class="op" id="5875032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875037">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875052">sym</span>&nbsp;<span class="op" id="5875056">:=</span>&nbsp;<span class="op" id="5875059">&amp;</span><span class="ident" id="5875060">symbols</span><span class="op" id="5875067">[</span><span class="ident" id="5875068">symNo</span><span class="op" id="5875073">-</span><span class="num" id="5875074">1</span><span class="op" id="5875075">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875079">if</span>&nbsp;<span class="ident" id="5875082">SymType</span><span class="op" id="5875089">(</span><span class="ident" id="5875090">sym</span><span class="op" id="5875093">.</span><span class="ident" id="5875094">Info</span><span class="op" id="5875098">&amp;</span><span class="num" id="5875099">0xf</span><span class="op" id="5875102">)</span>&nbsp;<span class="op" id="5875104">!=</span>&nbsp;<span class="ident" id="5875107">STT_SECTION</span>&nbsp;<span class="op" id="5875119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5875124">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875179">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5875195">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5875248">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5875303">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875350">switch</span>&nbsp;<span class="ident" id="5875357">t</span>&nbsp;<span class="op" id="5875359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875363">case</span>&nbsp;<span class="ident" id="5875368">R_X86_64_64</span><span class="op" id="5875379">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875384">if</span>&nbsp;<span class="ident" id="5875387">rela</span><span class="op" id="5875391">.</span><span class="ident" id="5875392">Off</span><span class="op" id="5875395">+</span><span class="num" id="5875396">8</span>&nbsp;<span class="op" id="5875398">&gt;=</span>&nbsp;<span class="ident" id="5875401">uint64</span><span class="op" id="5875407">(</span><span class="builtinfunc" id="5875408">len</span><span class="op" id="5875411">(</span><span class="ident" id="5875412">dst</span><span class="op" id="5875415">)</span><span class="op" id="5875416">)</span>&nbsp;<span class="op" id="5875418">||</span>&nbsp;<span class="ident" id="5875421">rela</span><span class="op" id="5875425">.</span><span class="ident" id="5875426">Addend</span>&nbsp;<span class="op" id="5875433">&lt;</span>&nbsp;<span class="num" id="5875435">0</span>&nbsp;<span class="op" id="5875437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875443">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875460">f</span><span class="op" id="5875461">.</span><span class="ident" id="5875462">ByteOrder</span><span class="op" id="5875471">.</span><span class="ident" id="5875472">PutUint64</span><span class="op" id="5875481">(</span><span class="ident" id="5875482">dst</span><span class="op" id="5875485">[</span><span class="ident" id="5875486">rela</span><span class="op" id="5875490">.</span><span class="ident" id="5875491">Off</span><span class="op" id="5875494">:</span><span class="ident" id="5875495">rela</span><span class="op" id="5875499">.</span><span class="ident" id="5875500">Off</span><span class="op" id="5875503">+</span><span class="num" id="5875504">8</span><span class="op" id="5875505">]</span><span class="op" id="5875506">,</span>&nbsp;<span class="ident" id="5875508">uint64</span><span class="op" id="5875514">(</span><span class="ident" id="5875515">rela</span><span class="op" id="5875519">.</span><span class="ident" id="5875520">Addend</span><span class="op" id="5875526">)</span><span class="op" id="5875527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875531">case</span>&nbsp;<span class="ident" id="5875536">R_X86_64_32</span><span class="op" id="5875547">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875552">if</span>&nbsp;<span class="ident" id="5875555">rela</span><span class="op" id="5875559">.</span><span class="ident" id="5875560">Off</span><span class="op" id="5875563">+</span><span class="num" id="5875564">4</span>&nbsp;<span class="op" id="5875566">&gt;=</span>&nbsp;<span class="ident" id="5875569">uint64</span><span class="op" id="5875575">(</span><span class="builtinfunc" id="5875576">len</span><span class="op" id="5875579">(</span><span class="ident" id="5875580">dst</span><span class="op" id="5875583">)</span><span class="op" id="5875584">)</span>&nbsp;<span class="op" id="5875586">||</span>&nbsp;<span class="ident" id="5875589">rela</span><span class="op" id="5875593">.</span><span class="ident" id="5875594">Addend</span>&nbsp;<span class="op" id="5875601">&lt;</span>&nbsp;<span class="num" id="5875603">0</span>&nbsp;<span class="op" id="5875605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875611">continue</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875628">f</span><span class="op" id="5875629">.</span><span class="ident" id="5875630">ByteOrder</span><span class="op" id="5875639">.</span><span class="ident" id="5875640">PutUint32</span><span class="op" id="5875649">(</span><span class="ident" id="5875650">dst</span><span class="op" id="5875653">[</span><span class="ident" id="5875654">rela</span><span class="op" id="5875658">.</span><span class="ident" id="5875659">Off</span><span class="op" id="5875662">:</span><span class="ident" id="5875663">rela</span><span class="op" id="5875667">.</span><span class="ident" id="5875668">Off</span><span class="op" id="5875671">+</span><span class="num" id="5875672">4</span><span class="op" id="5875673">]</span><span class="op" id="5875674">,</span>&nbsp;<span class="builtintype" id="5875676">uint32</span><span class="op" id="5875682">(</span><span class="ident" id="5875683">rela</span><span class="op" id="5875687">.</span><span class="ident" id="5875688">Addend</span><span class="op" id="5875694">)</span><span class="op" id="5875695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875706">return</span>&nbsp;<span class="ident" id="5875713">nil</span><br>
<span class="lineno"></span><span class="op" id="5875717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5875720">func</span>&nbsp;<span class="op" id="5875725">(</span><span class="ident" id="5875726">f</span>&nbsp;<span class="op" id="5875728">*</span><span class="ident" id="5875729">File</span><span class="op" id="5875733">)</span>&nbsp;<span class="ident" id="5875735">applyRelocations386</span><span class="op" id="5875754">(</span><span class="ident" id="5875755">dst</span>&nbsp;<span class="op" id="5875759">[</span><span class="op" id="5875760">]</span><span class="builtintype" id="5875761">byte</span><span class="op" id="5875765">,</span>&nbsp;<span class="ident" id="5875767">rels</span>&nbsp;<span class="op" id="5875772">[</span><span class="op" id="5875773">]</span><span class="builtintype" id="5875774">byte</span><span class="op" id="5875778">)</span>&nbsp;<span class="builtintype" id="5875780">error</span>&nbsp;<span class="op" id="5875786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5875789">//&nbsp;8&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rel32.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875817">if</span>&nbsp;<span class="builtinfunc" id="5875820">len</span><span class="op" id="5875823">(</span><span class="ident" id="5875824">rels</span><span class="op" id="5875828">)</span><span class="op" id="5875829">%</span><span class="num" id="5875830">8</span>&nbsp;<span class="op" id="5875832">!=</span>&nbsp;<span class="num" id="5875835">0</span>&nbsp;<span class="op" id="5875837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875841">return</span>&nbsp;<span class="ident" id="5875848">errors</span><span class="op" id="5875854">.</span><span class="ident" id="5875855">New</span><span class="op" id="5875858">(</span><span class="string" id="5875859">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&#34;</span><span class="op" id="5875912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875919">symbols</span><span class="op" id="5875926">,</span>&nbsp;<span class="ident" id="5875928">_</span><span class="op" id="5875929">,</span>&nbsp;<span class="ident" id="5875931">err</span>&nbsp;<span class="op" id="5875935">:=</span>&nbsp;<span class="ident" id="5875938">f</span><span class="op" id="5875939">.</span><span class="ident" id="5875940">getSymbols</span><span class="op" id="5875950">(</span><span class="ident" id="5875951">SHT_SYMTAB</span><span class="op" id="5875961">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875964">if</span>&nbsp;<span class="ident" id="5875967">err</span>&nbsp;<span class="op" id="5875971">!=</span>&nbsp;<span class="ident" id="5875974">nil</span>&nbsp;<span class="op" id="5875978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5875982">return</span>&nbsp;<span class="ident" id="5875989">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5875994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5875998">b</span>&nbsp;<span class="op" id="5876000">:=</span>&nbsp;<span class="ident" id="5876003">bytes</span><span class="op" id="5876008">.</span><span class="ident" id="5876009">NewReader</span><span class="op" id="5876018">(</span><span class="ident" id="5876019">rels</span><span class="op" id="5876023">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876026">var</span>&nbsp;<span class="ident" id="5876030">rel</span>&nbsp;<span class="ident" id="5876034">Rel32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876042">for</span>&nbsp;<span class="ident" id="5876046">b</span><span class="op" id="5876047">.</span><span class="ident" id="5876048">Len</span><span class="op" id="5876051">(</span><span class="op" id="5876052">)</span>&nbsp;<span class="op" id="5876054">&gt;</span>&nbsp;<span class="num" id="5876056">0</span>&nbsp;<span class="op" id="5876058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876062">binary</span><span class="op" id="5876068">.</span><span class="ident" id="5876069">Read</span><span class="op" id="5876073">(</span><span class="ident" id="5876074">b</span><span class="op" id="5876075">,</span>&nbsp;<span class="ident" id="5876077">f</span><span class="op" id="5876078">.</span><span class="ident" id="5876079">ByteOrder</span><span class="op" id="5876088">,</span>&nbsp;<span class="op" id="5876090">&amp;</span><span class="ident" id="5876091">rel</span><span class="op" id="5876094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876098">symNo</span>&nbsp;<span class="op" id="5876104">:=</span>&nbsp;<span class="ident" id="5876107">rel</span><span class="op" id="5876110">.</span><span class="ident" id="5876111">Info</span>&nbsp;<span class="op" id="5876116">&gt;&gt;</span>&nbsp;<span class="num" id="5876119">8</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876123">t</span>&nbsp;<span class="op" id="5876125">:=</span>&nbsp;<span class="ident" id="5876128">R_386</span><span class="op" id="5876133">(</span><span class="ident" id="5876134">rel</span><span class="op" id="5876137">.</span><span class="ident" id="5876138">Info</span>&nbsp;<span class="op" id="5876143">&amp;</span>&nbsp;<span class="num" id="5876145">0xff</span><span class="op" id="5876149">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876154">if</span>&nbsp;<span class="ident" id="5876157">symNo</span>&nbsp;<span class="op" id="5876163">==</span>&nbsp;<span class="num" id="5876166">0</span>&nbsp;<span class="op" id="5876168">||</span>&nbsp;<span class="ident" id="5876171">symNo</span>&nbsp;<span class="op" id="5876177">&gt;</span>&nbsp;<span class="builtintype" id="5876179">uint32</span><span class="op" id="5876185">(</span><span class="builtinfunc" id="5876186">len</span><span class="op" id="5876189">(</span><span class="ident" id="5876190">symbols</span><span class="op" id="5876197">)</span><span class="op" id="5876198">)</span>&nbsp;<span class="op" id="5876200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876205">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876216">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876220">sym</span>&nbsp;<span class="op" id="5876224">:=</span>&nbsp;<span class="op" id="5876227">&amp;</span><span class="ident" id="5876228">symbols</span><span class="op" id="5876235">[</span><span class="ident" id="5876236">symNo</span><span class="op" id="5876241">-</span><span class="num" id="5876242">1</span><span class="op" id="5876243">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876248">if</span>&nbsp;<span class="ident" id="5876251">t</span>&nbsp;<span class="op" id="5876253">==</span>&nbsp;<span class="ident" id="5876256">R_386_32</span>&nbsp;<span class="op" id="5876265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876270">if</span>&nbsp;<span class="ident" id="5876273">rel</span><span class="op" id="5876276">.</span><span class="ident" id="5876277">Off</span><span class="op" id="5876280">+</span><span class="num" id="5876281">4</span>&nbsp;<span class="op" id="5876283">&gt;=</span>&nbsp;<span class="builtintype" id="5876286">uint32</span><span class="op" id="5876292">(</span><span class="builtinfunc" id="5876293">len</span><span class="op" id="5876296">(</span><span class="ident" id="5876297">dst</span><span class="op" id="5876300">)</span><span class="op" id="5876301">)</span>&nbsp;<span class="op" id="5876303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876309">continue</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876326">val</span>&nbsp;<span class="op" id="5876330">:=</span>&nbsp;<span class="ident" id="5876333">f</span><span class="op" id="5876334">.</span><span class="ident" id="5876335">ByteOrder</span><span class="op" id="5876344">.</span><span class="ident" id="5876345">Uint32</span><span class="op" id="5876351">(</span><span class="ident" id="5876352">dst</span><span class="op" id="5876355">[</span><span class="ident" id="5876356">rel</span><span class="op" id="5876359">.</span><span class="ident" id="5876360">Off</span>&nbsp;<span class="op" id="5876364">:</span>&nbsp;<span class="ident" id="5876366">rel</span><span class="op" id="5876369">.</span><span class="ident" id="5876370">Off</span><span class="op" id="5876373">+</span><span class="num" id="5876374">4</span><span class="op" id="5876375">]</span><span class="op" id="5876376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876381">val</span>&nbsp;<span class="op" id="5876385">+=</span>&nbsp;<span class="builtintype" id="5876388">uint32</span><span class="op" id="5876394">(</span><span class="ident" id="5876395">sym</span><span class="op" id="5876398">.</span><span class="ident" id="5876399">Value</span><span class="op" id="5876404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876409">f</span><span class="op" id="5876410">.</span><span class="ident" id="5876411">ByteOrder</span><span class="op" id="5876420">.</span><span class="ident" id="5876421">PutUint32</span><span class="op" id="5876430">(</span><span class="ident" id="5876431">dst</span><span class="op" id="5876434">[</span><span class="ident" id="5876435">rel</span><span class="op" id="5876438">.</span><span class="ident" id="5876439">Off</span><span class="op" id="5876442">:</span><span class="ident" id="5876443">rel</span><span class="op" id="5876446">.</span><span class="ident" id="5876447">Off</span><span class="op" id="5876450">+</span><span class="num" id="5876451">4</span><span class="op" id="5876452">]</span><span class="op" id="5876453">,</span>&nbsp;<span class="ident" id="5876455">val</span><span class="op" id="5876458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876462">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876469">return</span>&nbsp;<span class="ident" id="5876476">nil</span><br>
<span class="lineno"></span><span class="op" id="5876480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="keyword" id="5876483">func</span>&nbsp;<span class="op" id="5876488">(</span><span class="ident" id="5876489">f</span>&nbsp;<span class="op" id="5876491">*</span><span class="ident" id="5876492">File</span><span class="op" id="5876496">)</span>&nbsp;<span class="ident" id="5876498">applyRelocationsARM64</span><span class="op" id="5876519">(</span><span class="ident" id="5876520">dst</span>&nbsp;<span class="op" id="5876524">[</span><span class="op" id="5876525">]</span><span class="builtintype" id="5876526">byte</span><span class="op" id="5876530">,</span>&nbsp;<span class="ident" id="5876532">rels</span>&nbsp;<span class="op" id="5876537">[</span><span class="op" id="5876538">]</span><span class="builtintype" id="5876539">byte</span><span class="op" id="5876543">)</span>&nbsp;<span class="builtintype" id="5876545">error</span>&nbsp;<span class="op" id="5876551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5876554">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876584">if</span>&nbsp;<span class="builtinfunc" id="5876587">len</span><span class="op" id="5876590">(</span><span class="ident" id="5876591">rels</span><span class="op" id="5876595">)</span><span class="op" id="5876596">%</span><span class="num" id="5876597">24</span>&nbsp;<span class="op" id="5876600">!=</span>&nbsp;<span class="num" id="5876603">0</span>&nbsp;<span class="op" id="5876605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876609">return</span>&nbsp;<span class="ident" id="5876616">errors</span><span class="op" id="5876622">.</span><span class="ident" id="5876623">New</span><span class="op" id="5876626">(</span><span class="string" id="5876627">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="5876681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876684">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876688">symbols</span><span class="op" id="5876695">,</span>&nbsp;<span class="ident" id="5876697">_</span><span class="op" id="5876698">,</span>&nbsp;<span class="ident" id="5876700">err</span>&nbsp;<span class="op" id="5876704">:=</span>&nbsp;<span class="ident" id="5876707">f</span><span class="op" id="5876708">.</span><span class="ident" id="5876709">getSymbols</span><span class="op" id="5876719">(</span><span class="ident" id="5876720">SHT_SYMTAB</span><span class="op" id="5876730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876733">if</span>&nbsp;<span class="ident" id="5876736">err</span>&nbsp;<span class="op" id="5876740">!=</span>&nbsp;<span class="ident" id="5876743">nil</span>&nbsp;<span class="op" id="5876747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876751">return</span>&nbsp;<span class="ident" id="5876758">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876763">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876767">b</span>&nbsp;<span class="op" id="5876769">:=</span>&nbsp;<span class="ident" id="5876772">bytes</span><span class="op" id="5876777">.</span><span class="ident" id="5876778">NewReader</span><span class="op" id="5876787">(</span><span class="ident" id="5876788">rels</span><span class="op" id="5876792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876795">var</span>&nbsp;<span class="ident" id="5876799">rela</span>&nbsp;<span class="ident" id="5876804">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876813">for</span>&nbsp;<span class="ident" id="5876817">b</span><span class="op" id="5876818">.</span><span class="ident" id="5876819">Len</span><span class="op" id="5876822">(</span><span class="op" id="5876823">)</span>&nbsp;<span class="op" id="5876825">&gt;</span>&nbsp;<span class="num" id="5876827">0</span>&nbsp;<span class="op" id="5876829">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876833">binary</span><span class="op" id="5876839">.</span><span class="ident" id="5876840">Read</span><span class="op" id="5876844">(</span><span class="ident" id="5876845">b</span><span class="op" id="5876846">,</span>&nbsp;<span class="ident" id="5876848">f</span><span class="op" id="5876849">.</span><span class="ident" id="5876850">ByteOrder</span><span class="op" id="5876859">,</span>&nbsp;<span class="op" id="5876861">&amp;</span><span class="ident" id="5876862">rela</span><span class="op" id="5876866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876870">symNo</span>&nbsp;<span class="op" id="5876876">:=</span>&nbsp;<span class="ident" id="5876879">rela</span><span class="op" id="5876883">.</span><span class="ident" id="5876884">Info</span>&nbsp;<span class="op" id="5876889">&gt;&gt;</span>&nbsp;<span class="num" id="5876892">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5876897">t</span>&nbsp;<span class="op" id="5876899">:=</span>&nbsp;<span class="ident" id="5876902">R_AARCH64</span><span class="op" id="5876911">(</span><span class="ident" id="5876912">rela</span><span class="op" id="5876916">.</span><span class="ident" id="5876917">Info</span>&nbsp;<span class="op" id="5876922">&amp;</span>&nbsp;<span class="num" id="5876924">0xffff</span><span class="op" id="5876930">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876935">if</span>&nbsp;<span class="ident" id="5876938">symNo</span>&nbsp;<span class="op" id="5876944">==</span>&nbsp;<span class="num" id="5876947">0</span>&nbsp;<span class="op" id="5876949">||</span>&nbsp;<span class="ident" id="5876952">symNo</span>&nbsp;<span class="op" id="5876958">&gt;</span>&nbsp;<span class="ident" id="5876960">uint64</span><span class="op" id="5876966">(</span><span class="builtinfunc" id="5876967">len</span><span class="op" id="5876970">(</span><span class="ident" id="5876971">symbols</span><span class="op" id="5876978">)</span><span class="op" id="5876979">)</span>&nbsp;<span class="op" id="5876981">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5876986">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5876997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877001">sym</span>&nbsp;<span class="op" id="5877005">:=</span>&nbsp;<span class="op" id="5877008">&amp;</span><span class="ident" id="5877009">symbols</span><span class="op" id="5877016">[</span><span class="ident" id="5877017">symNo</span><span class="op" id="5877022">-</span><span class="num" id="5877023">1</span><span class="op" id="5877024">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877028">if</span>&nbsp;<span class="ident" id="5877031">SymType</span><span class="op" id="5877038">(</span><span class="ident" id="5877039">sym</span><span class="op" id="5877042">.</span><span class="ident" id="5877043">Info</span><span class="op" id="5877047">&amp;</span><span class="num" id="5877048">0xf</span><span class="op" id="5877051">)</span>&nbsp;<span class="op" id="5877053">!=</span>&nbsp;<span class="ident" id="5877056">STT_SECTION</span>&nbsp;<span class="op" id="5877068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5877073">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877128">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5877139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5877144">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5877197">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5877252">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877299">switch</span>&nbsp;<span class="ident" id="5877306">t</span>&nbsp;<span class="op" id="5877308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877312">case</span>&nbsp;<span class="ident" id="5877317">R_AARCH64_ABS64</span><span class="op" id="5877332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877337">if</span>&nbsp;<span class="ident" id="5877340">rela</span><span class="op" id="5877344">.</span><span class="ident" id="5877345">Off</span><span class="op" id="5877348">+</span><span class="num" id="5877349">8</span>&nbsp;<span class="op" id="5877351">&gt;=</span>&nbsp;<span class="ident" id="5877354">uint64</span><span class="op" id="5877360">(</span><span class="builtinfunc" id="5877361">len</span><span class="op" id="5877364">(</span><span class="ident" id="5877365">dst</span><span class="op" id="5877368">)</span><span class="op" id="5877369">)</span>&nbsp;<span class="op" id="5877371">||</span>&nbsp;<span class="ident" id="5877374">rela</span><span class="op" id="5877378">.</span><span class="ident" id="5877379">Addend</span>&nbsp;<span class="op" id="5877386">&lt;</span>&nbsp;<span class="num" id="5877388">0</span>&nbsp;<span class="op" id="5877390">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877396">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5877408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877413">f</span><span class="op" id="5877414">.</span><span class="ident" id="5877415">ByteOrder</span><span class="op" id="5877424">.</span><span class="ident" id="5877425">PutUint64</span><span class="op" id="5877434">(</span><span class="ident" id="5877435">dst</span><span class="op" id="5877438">[</span><span class="ident" id="5877439">rela</span><span class="op" id="5877443">.</span><span class="ident" id="5877444">Off</span><span class="op" id="5877447">:</span><span class="ident" id="5877448">rela</span><span class="op" id="5877452">.</span><span class="ident" id="5877453">Off</span><span class="op" id="5877456">+</span><span class="num" id="5877457">8</span><span class="op" id="5877458">]</span><span class="op" id="5877459">,</span>&nbsp;<span class="ident" id="5877461">uint64</span><span class="op" id="5877467">(</span><span class="ident" id="5877468">rela</span><span class="op" id="5877472">.</span><span class="ident" id="5877473">Addend</span><span class="op" id="5877479">)</span><span class="op" id="5877480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877484">case</span>&nbsp;<span class="ident" id="5877489">R_AARCH64_ABS32</span><span class="op" id="5877504">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877509">if</span>&nbsp;<span class="ident" id="5877512">rela</span><span class="op" id="5877516">.</span><span class="ident" id="5877517">Off</span><span class="op" id="5877520">+</span><span class="num" id="5877521">4</span>&nbsp;<span class="op" id="5877523">&gt;=</span>&nbsp;<span class="ident" id="5877526">uint64</span><span class="op" id="5877532">(</span><span class="builtinfunc" id="5877533">len</span><span class="op" id="5877536">(</span><span class="ident" id="5877537">dst</span><span class="op" id="5877540">)</span><span class="op" id="5877541">)</span>&nbsp;<span class="op" id="5877543">||</span>&nbsp;<span class="ident" id="5877546">rela</span><span class="op" id="5877550">.</span><span class="ident" id="5877551">Addend</span>&nbsp;<span class="op" id="5877558">&lt;</span>&nbsp;<span class="num" id="5877560">0</span>&nbsp;<span class="op" id="5877562">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877568">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5877580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877585">f</span><span class="op" id="5877586">.</span><span class="ident" id="5877587">ByteOrder</span><span class="op" id="5877596">.</span><span class="ident" id="5877597">PutUint32</span><span class="op" id="5877606">(</span><span class="ident" id="5877607">dst</span><span class="op" id="5877610">[</span><span class="ident" id="5877611">rela</span><span class="op" id="5877615">.</span><span class="ident" id="5877616">Off</span><span class="op" id="5877619">:</span><span class="ident" id="5877620">rela</span><span class="op" id="5877624">.</span><span class="ident" id="5877625">Off</span><span class="op" id="5877628">+</span><span class="num" id="5877629">4</span><span class="op" id="5877630">]</span><span class="op" id="5877631">,</span>&nbsp;<span class="builtintype" id="5877633">uint32</span><span class="op" id="5877639">(</span><span class="ident" id="5877640">rela</span><span class="op" id="5877644">.</span><span class="ident" id="5877645">Addend</span><span class="op" id="5877651">)</span><span class="op" id="5877652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5877656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5877659">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877663">return</span>&nbsp;<span class="ident" id="5877670">nil</span><br>
<span class="lineno"></span><span class="op" id="5877674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5877677">func</span>&nbsp;<span class="op" id="5877682">(</span><span class="ident" id="5877683">f</span>&nbsp;<span class="op" id="5877685">*</span><span class="ident" id="5877686">File</span><span class="op" id="5877690">)</span>&nbsp;<span class="ident" id="5877692">DWARF</span><span class="op" id="5877697">(</span><span class="op" id="5877698">)</span>&nbsp;<span class="op" id="5877700">(</span><span class="op" id="5877701">*</span><span class="ident" id="5877702">dwarf</span><span class="op" id="5877707">.</span><span class="ident" id="5877708">Data</span><span class="op" id="5877712">,</span>&nbsp;<span class="builtintype" id="5877714">error</span><span class="op" id="5877719">)</span>&nbsp;<span class="op" id="5877721">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5877724">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5877775">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5877830">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877889">var</span>&nbsp;<span class="ident" id="5877893">names</span>&nbsp;<span class="op" id="5877899">=</span>&nbsp;<span class="op" id="5877901">[</span><span class="op" id="5877902">...</span><span class="op" id="5877905">]</span><span class="builtintype" id="5877906">string</span><span class="op" id="5877912">{</span><span class="string" id="5877913">&#34;abbrev&#34;</span><span class="op" id="5877921">,</span>&nbsp;<span class="string" id="5877923">&#34;info&#34;</span><span class="op" id="5877929">,</span>&nbsp;<span class="string" id="5877931">&#34;str&#34;</span><span class="op" id="5877936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877939">var</span>&nbsp;<span class="ident" id="5877943">dat</span>&nbsp;<span class="op" id="5877947">[</span><span class="builtinfunc" id="5877948">len</span><span class="op" id="5877951">(</span><span class="ident" id="5877952">names</span><span class="op" id="5877957">)</span><span class="op" id="5877958">]</span><span class="op" id="5877959">[</span><span class="op" id="5877960">]</span><span class="builtintype" id="5877961">byte</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5877967">for</span>&nbsp;<span class="ident" id="5877971">i</span><span class="op" id="5877972">,</span>&nbsp;<span class="ident" id="5877974">name</span>&nbsp;<span class="op" id="5877979">:=</span>&nbsp;<span class="keyword" id="5877982">range</span>&nbsp;<span class="ident" id="5877988">names</span>&nbsp;<span class="op" id="5877994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5877998">name</span>&nbsp;<span class="op" id="5878003">=</span>&nbsp;<span class="string" id="5878005">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="5878015">+</span>&nbsp;<span class="ident" id="5878017">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878024">s</span>&nbsp;<span class="op" id="5878026">:=</span>&nbsp;<span class="ident" id="5878029">f</span><span class="op" id="5878030">.</span><span class="ident" id="5878031">Section</span><span class="op" id="5878038">(</span><span class="ident" id="5878039">name</span><span class="op" id="5878043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878047">if</span>&nbsp;<span class="ident" id="5878050">s</span>&nbsp;<span class="op" id="5878052">==</span>&nbsp;<span class="ident" id="5878055">nil</span>&nbsp;<span class="op" id="5878059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878064">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878079">b</span><span class="op" id="5878080">,</span>&nbsp;<span class="ident" id="5878082">err</span>&nbsp;<span class="op" id="5878086">:=</span>&nbsp;<span class="ident" id="5878089">s</span><span class="op" id="5878090">.</span><span class="ident" id="5878091">Data</span><span class="op" id="5878095">(</span><span class="op" id="5878096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878100">if</span>&nbsp;<span class="ident" id="5878103">err</span>&nbsp;<span class="op" id="5878107">!=</span>&nbsp;<span class="ident" id="5878110">nil</span>&nbsp;<span class="op" id="5878114">&amp;&amp;</span>&nbsp;<span class="ident" id="5878117">uint64</span><span class="op" id="5878123">(</span><span class="builtinfunc" id="5878124">len</span><span class="op" id="5878127">(</span><span class="ident" id="5878128">b</span><span class="op" id="5878129">)</span><span class="op" id="5878130">)</span>&nbsp;<span class="op" id="5878132">&lt;</span>&nbsp;<span class="ident" id="5878134">s</span><span class="op" id="5878135">.</span><span class="ident" id="5878136">Size</span>&nbsp;<span class="op" id="5878141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878146">return</span>&nbsp;<span class="ident" id="5878153">nil</span><span class="op" id="5878156">,</span>&nbsp;<span class="ident" id="5878158">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878164">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878168">dat</span><span class="op" id="5878171">[</span><span class="ident" id="5878172">i</span><span class="op" id="5878173">]</span>&nbsp;<span class="op" id="5878175">=</span>&nbsp;<span class="ident" id="5878177">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5878184">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;relocation&nbsp;table&nbsp;for&nbsp;.debug_info,&nbsp;we&nbsp;have&nbsp;to&nbsp;process&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5878257">//&nbsp;now&nbsp;otherwise&nbsp;the&nbsp;data&nbsp;in&nbsp;.debug_info&nbsp;is&nbsp;invalid&nbsp;for&nbsp;x86-64&nbsp;objects.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878330">rela</span>&nbsp;<span class="op" id="5878335">:=</span>&nbsp;<span class="ident" id="5878338">f</span><span class="op" id="5878339">.</span><span class="ident" id="5878340">Section</span><span class="op" id="5878347">(</span><span class="string" id="5878348">&#34;.rela.debug_info&#34;</span><span class="op" id="5878366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878369">if</span>&nbsp;<span class="ident" id="5878372">rela</span>&nbsp;<span class="op" id="5878377">!=</span>&nbsp;<span class="ident" id="5878380">nil</span>&nbsp;<span class="op" id="5878384">&amp;&amp;</span>&nbsp;<span class="ident" id="5878387">rela</span><span class="op" id="5878391">.</span><span class="ident" id="5878392">Type</span>&nbsp;<span class="op" id="5878397">==</span>&nbsp;<span class="ident" id="5878400">SHT_RELA</span>&nbsp;<span class="op" id="5878409">&amp;&amp;</span>&nbsp;<span class="op" id="5878412">(</span><span class="ident" id="5878413">f</span><span class="op" id="5878414">.</span><span class="ident" id="5878415">Machine</span>&nbsp;<span class="op" id="5878423">==</span>&nbsp;<span class="ident" id="5878426">EM_X86_64</span>&nbsp;<span class="op" id="5878436">||</span>&nbsp;<span class="ident" id="5878439">f</span><span class="op" id="5878440">.</span><span class="ident" id="5878441">Machine</span>&nbsp;<span class="op" id="5878449">==</span>&nbsp;<span class="ident" id="5878452">EM_AARCH64</span><span class="op" id="5878462">)</span>&nbsp;<span class="op" id="5878464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878468">data</span><span class="op" id="5878472">,</span>&nbsp;<span class="ident" id="5878474">err</span>&nbsp;<span class="op" id="5878478">:=</span>&nbsp;<span class="ident" id="5878481">rela</span><span class="op" id="5878485">.</span><span class="ident" id="5878486">Data</span><span class="op" id="5878490">(</span><span class="op" id="5878491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878495">if</span>&nbsp;<span class="ident" id="5878498">err</span>&nbsp;<span class="op" id="5878502">!=</span>&nbsp;<span class="ident" id="5878505">nil</span>&nbsp;<span class="op" id="5878509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878514">return</span>&nbsp;<span class="ident" id="5878521">nil</span><span class="op" id="5878524">,</span>&nbsp;<span class="ident" id="5878526">err</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878536">err</span>&nbsp;<span class="op" id="5878540">=</span>&nbsp;<span class="ident" id="5878542">f</span><span class="op" id="5878543">.</span><span class="ident" id="5878544">applyRelocations</span><span class="op" id="5878560">(</span><span class="ident" id="5878561">dat</span><span class="op" id="5878564">[</span><span class="num" id="5878565">1</span><span class="op" id="5878566">]</span><span class="op" id="5878567">,</span>&nbsp;<span class="ident" id="5878569">data</span><span class="op" id="5878573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878577">if</span>&nbsp;<span class="ident" id="5878580">err</span>&nbsp;<span class="op" id="5878584">!=</span>&nbsp;<span class="ident" id="5878587">nil</span>&nbsp;<span class="op" id="5878591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878596">return</span>&nbsp;<span class="ident" id="5878603">nil</span><span class="op" id="5878606">,</span>&nbsp;<span class="ident" id="5878608">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878614">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5878621">//&nbsp;When&nbsp;using&nbsp;clang&nbsp;we&nbsp;need&nbsp;to&nbsp;process&nbsp;relocations&nbsp;even&nbsp;for&nbsp;386.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878687">rel</span>&nbsp;<span class="op" id="5878691">:=</span>&nbsp;<span class="ident" id="5878694">f</span><span class="op" id="5878695">.</span><span class="ident" id="5878696">Section</span><span class="op" id="5878703">(</span><span class="string" id="5878704">&#34;.rel.debug_info&#34;</span><span class="op" id="5878721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878724">if</span>&nbsp;<span class="ident" id="5878727">rel</span>&nbsp;<span class="op" id="5878731">!=</span>&nbsp;<span class="ident" id="5878734">nil</span>&nbsp;<span class="op" id="5878738">&amp;&amp;</span>&nbsp;<span class="ident" id="5878741">rel</span><span class="op" id="5878744">.</span><span class="ident" id="5878745">Type</span>&nbsp;<span class="op" id="5878750">==</span>&nbsp;<span class="ident" id="5878753">SHT_REL</span>&nbsp;<span class="op" id="5878761">&amp;&amp;</span>&nbsp;<span class="ident" id="5878764">f</span><span class="op" id="5878765">.</span><span class="ident" id="5878766">Machine</span>&nbsp;<span class="op" id="5878774">==</span>&nbsp;<span class="ident" id="5878777">EM_386</span>&nbsp;<span class="op" id="5878784">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878788">data</span><span class="op" id="5878792">,</span>&nbsp;<span class="ident" id="5878794">err</span>&nbsp;<span class="op" id="5878798">:=</span>&nbsp;<span class="ident" id="5878801">rel</span><span class="op" id="5878804">.</span><span class="ident" id="5878805">Data</span><span class="op" id="5878809">(</span><span class="op" id="5878810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878814">if</span>&nbsp;<span class="ident" id="5878817">err</span>&nbsp;<span class="op" id="5878821">!=</span>&nbsp;<span class="ident" id="5878824">nil</span>&nbsp;<span class="op" id="5878828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878833">return</span>&nbsp;<span class="ident" id="5878840">nil</span><span class="op" id="5878843">,</span>&nbsp;<span class="ident" id="5878845">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878855">err</span>&nbsp;<span class="op" id="5878859">=</span>&nbsp;<span class="ident" id="5878861">f</span><span class="op" id="5878862">.</span><span class="ident" id="5878863">applyRelocations</span><span class="op" id="5878879">(</span><span class="ident" id="5878880">dat</span><span class="op" id="5878883">[</span><span class="num" id="5878884">1</span><span class="op" id="5878885">]</span><span class="op" id="5878886">,</span>&nbsp;<span class="ident" id="5878888">data</span><span class="op" id="5878892">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878896">if</span>&nbsp;<span class="ident" id="5878899">err</span>&nbsp;<span class="op" id="5878903">!=</span>&nbsp;<span class="ident" id="5878906">nil</span>&nbsp;<span class="op" id="5878910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5878915">return</span>&nbsp;<span class="ident" id="5878922">nil</span><span class="op" id="5878925">,</span>&nbsp;<span class="ident" id="5878927">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5878936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878940">abbrev</span><span class="op" id="5878946">,</span>&nbsp;<span class="ident" id="5878948">info</span><span class="op" id="5878952">,</span>&nbsp;<span class="ident" id="5878954">str</span>&nbsp;<span class="op" id="5878958">:=</span>&nbsp;<span class="ident" id="5878961">dat</span><span class="op" id="5878964">[</span><span class="num" id="5878965">0</span><span class="op" id="5878966">]</span><span class="op" id="5878967">,</span>&nbsp;<span class="ident" id="5878969">dat</span><span class="op" id="5878972">[</span><span class="num" id="5878973">1</span><span class="op" id="5878974">]</span><span class="op" id="5878975">,</span>&nbsp;<span class="ident" id="5878977">dat</span><span class="op" id="5878980">[</span><span class="num" id="5878981">2</span><span class="op" id="5878982">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5878985">d</span><span class="op" id="5878986">,</span>&nbsp;<span class="ident" id="5878988">err</span>&nbsp;<span class="op" id="5878992">:=</span>&nbsp;<span class="ident" id="5878995">dwarf</span><span class="op" id="5879000">.</span><span class="ident" id="5879001">New</span><span class="op" id="5879004">(</span><span class="ident" id="5879005">abbrev</span><span class="op" id="5879011">,</span>&nbsp;<span class="ident" id="5879013">nil</span><span class="op" id="5879016">,</span>&nbsp;<span class="ident" id="5879018">nil</span><span class="op" id="5879021">,</span>&nbsp;<span class="ident" id="5879023">info</span><span class="op" id="5879027">,</span>&nbsp;<span class="ident" id="5879029">nil</span><span class="op" id="5879032">,</span>&nbsp;<span class="ident" id="5879034">nil</span><span class="op" id="5879037">,</span>&nbsp;<span class="ident" id="5879039">nil</span><span class="op" id="5879042">,</span>&nbsp;<span class="ident" id="5879044">str</span><span class="op" id="5879047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879050">if</span>&nbsp;<span class="ident" id="5879053">err</span>&nbsp;<span class="op" id="5879057">!=</span>&nbsp;<span class="ident" id="5879060">nil</span>&nbsp;<span class="op" id="5879064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879068">return</span>&nbsp;<span class="ident" id="5879075">nil</span><span class="op" id="5879078">,</span>&nbsp;<span class="ident" id="5879080">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879085">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5879089">//&nbsp;Look&nbsp;for&nbsp;DWARF4&nbsp;.debug_types&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879132">for</span>&nbsp;<span class="ident" id="5879136">i</span><span class="op" id="5879137">,</span>&nbsp;<span class="ident" id="5879139">s</span>&nbsp;<span class="op" id="5879141">:=</span>&nbsp;<span class="keyword" id="5879144">range</span>&nbsp;<span class="ident" id="5879150">f</span><span class="op" id="5879151">.</span><span class="ident" id="5879152">Sections</span>&nbsp;<span class="op" id="5879161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879165">if</span>&nbsp;<span class="ident" id="5879168">s</span><span class="op" id="5879169">.</span><span class="ident" id="5879170">Name</span>&nbsp;<span class="op" id="5879175">==</span>&nbsp;<span class="string" id="5879178">&#34;.debug_types&#34;</span>&nbsp;<span class="op" id="5879193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879198">b</span><span class="op" id="5879199">,</span>&nbsp;<span class="ident" id="5879201">err</span>&nbsp;<span class="op" id="5879205">:=</span>&nbsp;<span class="ident" id="5879208">s</span><span class="op" id="5879209">.</span><span class="ident" id="5879210">Data</span><span class="op" id="5879214">(</span><span class="op" id="5879215">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879220">if</span>&nbsp;<span class="ident" id="5879223">err</span>&nbsp;<span class="op" id="5879227">!=</span>&nbsp;<span class="ident" id="5879230">nil</span>&nbsp;<span class="op" id="5879234">&amp;&amp;</span>&nbsp;<span class="ident" id="5879237">uint64</span><span class="op" id="5879243">(</span><span class="builtinfunc" id="5879244">len</span><span class="op" id="5879247">(</span><span class="ident" id="5879248">b</span><span class="op" id="5879249">)</span><span class="op" id="5879250">)</span>&nbsp;<span class="op" id="5879252">&lt;</span>&nbsp;<span class="ident" id="5879254">s</span><span class="op" id="5879255">.</span><span class="ident" id="5879256">Size</span>&nbsp;<span class="op" id="5879261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879267">return</span>&nbsp;<span class="ident" id="5879274">nil</span><span class="op" id="5879277">,</span>&nbsp;<span class="ident" id="5879279">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879292">for</span>&nbsp;<span class="ident" id="5879296">_</span><span class="op" id="5879297">,</span>&nbsp;<span class="ident" id="5879299">r</span>&nbsp;<span class="op" id="5879301">:=</span>&nbsp;<span class="keyword" id="5879304">range</span>&nbsp;<span class="ident" id="5879310">f</span><span class="op" id="5879311">.</span><span class="ident" id="5879312">Sections</span>&nbsp;<span class="op" id="5879321">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879327">if</span>&nbsp;<span class="ident" id="5879330">r</span><span class="op" id="5879331">.</span><span class="ident" id="5879332">Type</span>&nbsp;<span class="op" id="5879337">!=</span>&nbsp;<span class="ident" id="5879340">SHT_RELA</span>&nbsp;<span class="op" id="5879349">&amp;&amp;</span>&nbsp;<span class="ident" id="5879352">r</span><span class="op" id="5879353">.</span><span class="ident" id="5879354">Type</span>&nbsp;<span class="op" id="5879359">!=</span>&nbsp;<span class="ident" id="5879362">SHT_REL</span>&nbsp;<span class="op" id="5879370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879377">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879396">if</span>&nbsp;<span class="builtintype" id="5879399">int</span><span class="op" id="5879402">(</span><span class="ident" id="5879403">r</span><span class="op" id="5879404">.</span><span class="ident" id="5879405">Info</span><span class="op" id="5879409">)</span>&nbsp;<span class="op" id="5879411">!=</span>&nbsp;<span class="ident" id="5879414">i</span>&nbsp;<span class="op" id="5879416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879423">continue</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879442">rd</span><span class="op" id="5879444">,</span>&nbsp;<span class="ident" id="5879446">err</span>&nbsp;<span class="op" id="5879450">:=</span>&nbsp;<span class="ident" id="5879453">r</span><span class="op" id="5879454">.</span><span class="ident" id="5879455">Data</span><span class="op" id="5879459">(</span><span class="op" id="5879460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879466">if</span>&nbsp;<span class="ident" id="5879469">err</span>&nbsp;<span class="op" id="5879473">!=</span>&nbsp;<span class="ident" id="5879476">nil</span>&nbsp;<span class="op" id="5879480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879487">return</span>&nbsp;<span class="ident" id="5879494">nil</span><span class="op" id="5879497">,</span>&nbsp;<span class="ident" id="5879499">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879507">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879513">err</span>&nbsp;<span class="op" id="5879517">=</span>&nbsp;<span class="ident" id="5879519">f</span><span class="op" id="5879520">.</span><span class="ident" id="5879521">applyRelocations</span><span class="op" id="5879537">(</span><span class="ident" id="5879538">b</span><span class="op" id="5879539">,</span>&nbsp;<span class="ident" id="5879541">rd</span><span class="op" id="5879543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879549">if</span>&nbsp;<span class="ident" id="5879552">err</span>&nbsp;<span class="op" id="5879556">!=</span>&nbsp;<span class="ident" id="5879559">nil</span>&nbsp;<span class="op" id="5879563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879570">return</span>&nbsp;<span class="ident" id="5879577">nil</span><span class="op" id="5879580">,</span>&nbsp;<span class="ident" id="5879582">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879595">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5879601">err</span>&nbsp;<span class="op" id="5879605">=</span>&nbsp;<span class="ident" id="5879607">d</span><span class="op" id="5879608">.</span><span class="ident" id="5879609">AddTypes</span><span class="op" id="5879617">(</span><span class="ident" id="5879618">fmt</span><span class="op" id="5879621">.</span><span class="ident" id="5879622">Sprintf</span><span class="op" id="5879629">(</span><span class="string" id="5879630">&#34;types-%d&#34;</span><span class="op" id="5879640">,</span>&nbsp;<span class="ident" id="5879642">i</span><span class="op" id="5879643">)</span><span class="op" id="5879644">,</span>&nbsp;<span class="ident" id="5879646">b</span><span class="op" id="5879647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879652">if</span>&nbsp;<span class="ident" id="5879655">err</span>&nbsp;<span class="op" id="5879659">!=</span>&nbsp;<span class="ident" id="5879662">nil</span>&nbsp;<span class="op" id="5879666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879672">return</span>&nbsp;<span class="ident" id="5879679">nil</span><span class="op" id="5879682">,</span>&nbsp;<span class="ident" id="5879684">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879691">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5879698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5879702">return</span>&nbsp;<span class="ident" id="5879709">d</span><span class="op" id="5879710">,</span>&nbsp;<span class="ident" id="5879712">nil</span><br>
<span class="lineno"></span><span class="op" id="5879716">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="5879719">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="5879802">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="5879823">//</span><br>
<span class="lineno"></span><span class="comment" id="5879826">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Go&nbsp;1.0,&nbsp;Symbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno">765</span><span class="comment" id="5879902">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="5879976">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="5880022">func</span>&nbsp;<span class="op" id="5880027">(</span><span class="ident" id="5880028">f</span>&nbsp;<span class="op" id="5880030">*</span><span class="ident" id="5880031">File</span><span class="op" id="5880035">)</span>&nbsp;<span class="ident" id="5880037">Symbols</span><span class="op" id="5880044">(</span><span class="op" id="5880045">)</span>&nbsp;<span class="op" id="5880047">(</span><span class="op" id="5880048">[</span><span class="op" id="5880049">]</span><span class="ident" id="5880050">Symbol</span><span class="op" id="5880056">,</span>&nbsp;<span class="builtintype" id="5880058">error</span><span class="op" id="5880063">)</span>&nbsp;<span class="op" id="5880065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880068">sym</span><span class="op" id="5880071">,</span>&nbsp;<span class="ident" id="5880073">_</span><span class="op" id="5880074">,</span>&nbsp;<span class="ident" id="5880076">err</span>&nbsp;<span class="op" id="5880080">:=</span>&nbsp;<span class="ident" id="5880083">f</span><span class="op" id="5880084">.</span><span class="ident" id="5880085">getSymbols</span><span class="op" id="5880095">(</span><span class="ident" id="5880096">SHT_SYMTAB</span><span class="op" id="5880106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5880109">return</span>&nbsp;<span class="ident" id="5880116">sym</span><span class="op" id="5880119">,</span>&nbsp;<span class="ident" id="5880121">err</span><br>
<span class="lineno">770</span><span class="op" id="5880125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5880128">//&nbsp;DynamicSymbols&nbsp;returns&nbsp;the&nbsp;dynamic&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="5880198">//&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="5880247">//</span><br>
<span class="lineno">775</span><span class="comment" id="5880250">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Symbols,&nbsp;DynamicSymbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="5880334">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="5880408">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="5880454">func</span>&nbsp;<span class="op" id="5880459">(</span><span class="ident" id="5880460">f</span>&nbsp;<span class="op" id="5880462">*</span><span class="ident" id="5880463">File</span><span class="op" id="5880467">)</span>&nbsp;<span class="ident" id="5880469">DynamicSymbols</span><span class="op" id="5880483">(</span><span class="op" id="5880484">)</span>&nbsp;<span class="op" id="5880486">(</span><span class="op" id="5880487">[</span><span class="op" id="5880488">]</span><span class="ident" id="5880489">Symbol</span><span class="op" id="5880495">,</span>&nbsp;<span class="builtintype" id="5880497">error</span><span class="op" id="5880502">)</span>&nbsp;<span class="op" id="5880504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880507">sym</span><span class="op" id="5880510">,</span>&nbsp;<span class="ident" id="5880512">_</span><span class="op" id="5880513">,</span>&nbsp;<span class="ident" id="5880515">err</span>&nbsp;<span class="op" id="5880519">:=</span>&nbsp;<span class="ident" id="5880522">f</span><span class="op" id="5880523">.</span><span class="ident" id="5880524">getSymbols</span><span class="op" id="5880534">(</span><span class="ident" id="5880535">SHT_DYNSYM</span><span class="op" id="5880545">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5880548">return</span>&nbsp;<span class="ident" id="5880555">sym</span><span class="op" id="5880558">,</span>&nbsp;<span class="ident" id="5880560">err</span><br>
<span class="lineno"></span><span class="op" id="5880564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5880567">type</span>&nbsp;<span class="ident" id="5880572">ImportedSymbol</span>&nbsp;<span class="keyword" id="5880587">struct</span>&nbsp;<span class="op" id="5880594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880597">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5880605">string</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880613">Version</span>&nbsp;<span class="builtintype" id="5880621">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880629">Library</span>&nbsp;<span class="builtintype" id="5880637">string</span><br>
<span class="lineno"></span><span class="op" id="5880644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5880647">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno">790</span><span class="comment" id="5880699">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5880754">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5880808">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="5880844">func</span>&nbsp;<span class="op" id="5880849">(</span><span class="ident" id="5880850">f</span>&nbsp;<span class="op" id="5880852">*</span><span class="ident" id="5880853">File</span><span class="op" id="5880857">)</span>&nbsp;<span class="ident" id="5880859">ImportedSymbols</span><span class="op" id="5880874">(</span><span class="op" id="5880875">)</span>&nbsp;<span class="op" id="5880877">(</span><span class="op" id="5880878">[</span><span class="op" id="5880879">]</span><span class="ident" id="5880880">ImportedSymbol</span><span class="op" id="5880894">,</span>&nbsp;<span class="builtintype" id="5880896">error</span><span class="op" id="5880901">)</span>&nbsp;<span class="op" id="5880903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880906">sym</span><span class="op" id="5880909">,</span>&nbsp;<span class="ident" id="5880911">str</span><span class="op" id="5880914">,</span>&nbsp;<span class="ident" id="5880916">err</span>&nbsp;<span class="op" id="5880920">:=</span>&nbsp;<span class="ident" id="5880923">f</span><span class="op" id="5880924">.</span><span class="ident" id="5880925">getSymbols</span><span class="op" id="5880935">(</span><span class="ident" id="5880936">SHT_DYNSYM</span><span class="op" id="5880946">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5880949">if</span>&nbsp;<span class="ident" id="5880952">err</span>&nbsp;<span class="op" id="5880956">!=</span>&nbsp;<span class="ident" id="5880959">nil</span>&nbsp;<span class="op" id="5880963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5880967">return</span>&nbsp;<span class="ident" id="5880974">nil</span><span class="op" id="5880977">,</span>&nbsp;<span class="ident" id="5880979">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5880984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5880987">f</span><span class="op" id="5880988">.</span><span class="ident" id="5880989">gnuVersionInit</span><span class="op" id="5881003">(</span><span class="ident" id="5881004">str</span><span class="op" id="5881007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881010">var</span>&nbsp;<span class="ident" id="5881014">all</span>&nbsp;<span class="op" id="5881018">[</span><span class="op" id="5881019">]</span><span class="ident" id="5881020">ImportedSymbol</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881036">for</span>&nbsp;<span class="ident" id="5881040">i</span><span class="op" id="5881041">,</span>&nbsp;<span class="ident" id="5881043">s</span>&nbsp;<span class="op" id="5881045">:=</span>&nbsp;<span class="keyword" id="5881048">range</span>&nbsp;<span class="ident" id="5881054">sym</span>&nbsp;<span class="op" id="5881058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881062">if</span>&nbsp;<span class="ident" id="5881065">ST_BIND</span><span class="op" id="5881072">(</span><span class="ident" id="5881073">s</span><span class="op" id="5881074">.</span><span class="ident" id="5881075">Info</span><span class="op" id="5881079">)</span>&nbsp;<span class="op" id="5881081">==</span>&nbsp;<span class="ident" id="5881084">STB_GLOBAL</span>&nbsp;<span class="op" id="5881095">&amp;&amp;</span>&nbsp;<span class="ident" id="5881098">s</span><span class="op" id="5881099">.</span><span class="ident" id="5881100">Section</span>&nbsp;<span class="op" id="5881108">==</span>&nbsp;<span class="ident" id="5881111">SHN_UNDEF</span>&nbsp;<span class="op" id="5881121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881126">all</span>&nbsp;<span class="op" id="5881130">=</span>&nbsp;<span class="builtinfunc" id="5881132">append</span><span class="op" id="5881138">(</span><span class="ident" id="5881139">all</span><span class="op" id="5881142">,</span>&nbsp;<span class="ident" id="5881144">ImportedSymbol</span><span class="op" id="5881158">{</span><span class="ident" id="5881159">Name</span><span class="op" id="5881163">:</span>&nbsp;<span class="ident" id="5881165">s</span><span class="op" id="5881166">.</span><span class="ident" id="5881167">Name</span><span class="op" id="5881171">}</span><span class="op" id="5881172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881177">f</span><span class="op" id="5881178">.</span><span class="ident" id="5881179">gnuVersion</span><span class="op" id="5881189">(</span><span class="ident" id="5881190">i</span><span class="op" id="5881191">,</span>&nbsp;<span class="op" id="5881193">&amp;</span><span class="ident" id="5881194">all</span><span class="op" id="5881197">[</span><span class="builtinfunc" id="5881198">len</span><span class="op" id="5881201">(</span><span class="ident" id="5881202">all</span><span class="op" id="5881205">)</span><span class="op" id="5881206">-</span><span class="num" id="5881207">1</span><span class="op" id="5881208">]</span><span class="op" id="5881209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5881213">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5881216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881219">return</span>&nbsp;<span class="ident" id="5881226">all</span><span class="op" id="5881229">,</span>&nbsp;<span class="ident" id="5881231">nil</span><br>
<span class="lineno"></span><span class="op" id="5881235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5881238">type</span>&nbsp;<span class="ident" id="5881243">verneed</span>&nbsp;<span class="keyword" id="5881251">struct</span>&nbsp;<span class="op" id="5881258">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881261">File</span>&nbsp;<span class="builtintype" id="5881266">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881274">Name</span>&nbsp;<span class="builtintype" id="5881279">string</span><br>
<span class="lineno"></span><span class="op" id="5881286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5881289">//&nbsp;gnuVersionInit&nbsp;parses&nbsp;the&nbsp;GNU&nbsp;version&nbsp;tables</span><br>
<span class="lineno">815</span><span class="comment" id="5881337">//&nbsp;for&nbsp;use&nbsp;by&nbsp;calls&nbsp;to&nbsp;gnuVersion.</span><br>
<span class="lineno"></span><span class="keyword" id="5881372">func</span>&nbsp;<span class="op" id="5881377">(</span><span class="ident" id="5881378">f</span>&nbsp;<span class="op" id="5881380">*</span><span class="ident" id="5881381">File</span><span class="op" id="5881385">)</span>&nbsp;<span class="ident" id="5881387">gnuVersionInit</span><span class="op" id="5881401">(</span><span class="ident" id="5881402">str</span>&nbsp;<span class="op" id="5881406">[</span><span class="op" id="5881407">]</span><span class="builtintype" id="5881408">byte</span><span class="op" id="5881412">)</span>&nbsp;<span class="op" id="5881414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5881417">//&nbsp;Accumulate&nbsp;verneed&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881453">vn</span>&nbsp;<span class="op" id="5881456">:=</span>&nbsp;<span class="ident" id="5881459">f</span><span class="op" id="5881460">.</span><span class="ident" id="5881461">SectionByType</span><span class="op" id="5881474">(</span><span class="ident" id="5881475">SHT_GNU_VERNEED</span><span class="op" id="5881490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881493">if</span>&nbsp;<span class="ident" id="5881496">vn</span>&nbsp;<span class="op" id="5881499">==</span>&nbsp;<span class="ident" id="5881502">nil</span>&nbsp;<span class="op" id="5881506">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881510">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5881518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881521">d</span><span class="op" id="5881522">,</span>&nbsp;<span class="ident" id="5881524">_</span>&nbsp;<span class="op" id="5881526">:=</span>&nbsp;<span class="ident" id="5881529">vn</span><span class="op" id="5881531">.</span><span class="ident" id="5881532">Data</span><span class="op" id="5881536">(</span><span class="op" id="5881537">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881541">var</span>&nbsp;<span class="ident" id="5881545">need</span>&nbsp;<span class="op" id="5881550">[</span><span class="op" id="5881551">]</span><span class="ident" id="5881552">verneed</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881561">i</span>&nbsp;<span class="op" id="5881563">:=</span>&nbsp;<span class="num" id="5881566">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881569">for</span>&nbsp;<span class="op" id="5881573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881577">if</span>&nbsp;<span class="ident" id="5881580">i</span><span class="op" id="5881581">+</span><span class="num" id="5881582">16</span>&nbsp;<span class="op" id="5881585">&gt;</span>&nbsp;<span class="builtinfunc" id="5881587">len</span><span class="op" id="5881590">(</span><span class="ident" id="5881591">d</span><span class="op" id="5881592">)</span>&nbsp;<span class="op" id="5881594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881599">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5881607">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881611">vers</span>&nbsp;<span class="op" id="5881616">:=</span>&nbsp;<span class="ident" id="5881619">f</span><span class="op" id="5881620">.</span><span class="ident" id="5881621">ByteOrder</span><span class="op" id="5881630">.</span><span class="ident" id="5881631">Uint16</span><span class="op" id="5881637">(</span><span class="ident" id="5881638">d</span><span class="op" id="5881639">[</span><span class="ident" id="5881640">i</span>&nbsp;<span class="op" id="5881642">:</span>&nbsp;<span class="ident" id="5881644">i</span><span class="op" id="5881645">+</span><span class="num" id="5881646">2</span><span class="op" id="5881647">]</span><span class="op" id="5881648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881652">if</span>&nbsp;<span class="ident" id="5881655">vers</span>&nbsp;<span class="op" id="5881660">!=</span>&nbsp;<span class="num" id="5881663">1</span>&nbsp;<span class="op" id="5881665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881670">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5881678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881682">cnt</span>&nbsp;<span class="op" id="5881686">:=</span>&nbsp;<span class="ident" id="5881689">f</span><span class="op" id="5881690">.</span><span class="ident" id="5881691">ByteOrder</span><span class="op" id="5881700">.</span><span class="ident" id="5881701">Uint16</span><span class="op" id="5881707">(</span><span class="ident" id="5881708">d</span><span class="op" id="5881709">[</span><span class="ident" id="5881710">i</span><span class="op" id="5881711">+</span><span class="num" id="5881712">2</span>&nbsp;<span class="op" id="5881714">:</span>&nbsp;<span class="ident" id="5881716">i</span><span class="op" id="5881717">+</span><span class="num" id="5881718">4</span><span class="op" id="5881719">]</span><span class="op" id="5881720">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881724">fileoff</span>&nbsp;<span class="op" id="5881732">:=</span>&nbsp;<span class="ident" id="5881735">f</span><span class="op" id="5881736">.</span><span class="ident" id="5881737">ByteOrder</span><span class="op" id="5881746">.</span><span class="ident" id="5881747">Uint32</span><span class="op" id="5881753">(</span><span class="ident" id="5881754">d</span><span class="op" id="5881755">[</span><span class="ident" id="5881756">i</span><span class="op" id="5881757">+</span><span class="num" id="5881758">4</span>&nbsp;<span class="op" id="5881760">:</span>&nbsp;<span class="ident" id="5881762">i</span><span class="op" id="5881763">+</span><span class="num" id="5881764">8</span><span class="op" id="5881765">]</span><span class="op" id="5881766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881770">aux</span>&nbsp;<span class="op" id="5881774">:=</span>&nbsp;<span class="ident" id="5881777">f</span><span class="op" id="5881778">.</span><span class="ident" id="5881779">ByteOrder</span><span class="op" id="5881788">.</span><span class="ident" id="5881789">Uint32</span><span class="op" id="5881795">(</span><span class="ident" id="5881796">d</span><span class="op" id="5881797">[</span><span class="ident" id="5881798">i</span><span class="op" id="5881799">+</span><span class="num" id="5881800">8</span>&nbsp;<span class="op" id="5881802">:</span>&nbsp;<span class="ident" id="5881804">i</span><span class="op" id="5881805">+</span><span class="num" id="5881806">12</span><span class="op" id="5881808">]</span><span class="op" id="5881809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881813">next</span>&nbsp;<span class="op" id="5881818">:=</span>&nbsp;<span class="ident" id="5881821">f</span><span class="op" id="5881822">.</span><span class="ident" id="5881823">ByteOrder</span><span class="op" id="5881832">.</span><span class="ident" id="5881833">Uint32</span><span class="op" id="5881839">(</span><span class="ident" id="5881840">d</span><span class="op" id="5881841">[</span><span class="ident" id="5881842">i</span><span class="op" id="5881843">+</span><span class="num" id="5881844">12</span>&nbsp;<span class="op" id="5881847">:</span>&nbsp;<span class="ident" id="5881849">i</span><span class="op" id="5881850">+</span><span class="num" id="5881851">16</span><span class="op" id="5881853">]</span><span class="op" id="5881854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881858">file</span><span class="op" id="5881862">,</span>&nbsp;<span class="ident" id="5881864">_</span>&nbsp;<span class="op" id="5881866">:=</span>&nbsp;<span class="ident" id="5881869">getString</span><span class="op" id="5881878">(</span><span class="ident" id="5881879">str</span><span class="op" id="5881882">,</span>&nbsp;<span class="builtintype" id="5881884">int</span><span class="op" id="5881887">(</span><span class="ident" id="5881888">fileoff</span><span class="op" id="5881895">)</span><span class="op" id="5881896">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881901">var</span>&nbsp;<span class="ident" id="5881905">name</span>&nbsp;<span class="builtintype" id="5881910">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5881919">j</span>&nbsp;<span class="op" id="5881921">:=</span>&nbsp;<span class="ident" id="5881924">i</span>&nbsp;<span class="op" id="5881926">+</span>&nbsp;<span class="builtintype" id="5881928">int</span><span class="op" id="5881931">(</span><span class="ident" id="5881932">aux</span><span class="op" id="5881935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881939">for</span>&nbsp;<span class="ident" id="5881943">c</span>&nbsp;<span class="op" id="5881945">:=</span>&nbsp;<span class="num" id="5881948">0</span><span class="op" id="5881949">;</span>&nbsp;<span class="ident" id="5881951">c</span>&nbsp;<span class="op" id="5881953">&lt;</span>&nbsp;<span class="builtintype" id="5881955">int</span><span class="op" id="5881958">(</span><span class="ident" id="5881959">cnt</span><span class="op" id="5881962">)</span><span class="op" id="5881963">;</span>&nbsp;<span class="ident" id="5881965">c</span><span class="op" id="5881966">++</span>&nbsp;<span class="op" id="5881969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881974">if</span>&nbsp;<span class="ident" id="5881977">j</span><span class="op" id="5881978">+</span><span class="num" id="5881979">16</span>&nbsp;<span class="op" id="5881982">&gt;</span>&nbsp;<span class="builtinfunc" id="5881984">len</span><span class="op" id="5881987">(</span><span class="ident" id="5881988">d</span><span class="op" id="5881989">)</span>&nbsp;<span class="op" id="5881991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5881997">break</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5882011">//&nbsp;hash&nbsp;:=&nbsp;f.ByteOrder.Uint32(d[j:j+4])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5882054">//&nbsp;flags&nbsp;:=&nbsp;f.ByteOrder.Uint16(d[j+4:j+6])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882100">other</span>&nbsp;<span class="op" id="5882106">:=</span>&nbsp;<span class="ident" id="5882109">f</span><span class="op" id="5882110">.</span><span class="ident" id="5882111">ByteOrder</span><span class="op" id="5882120">.</span><span class="ident" id="5882121">Uint16</span><span class="op" id="5882127">(</span><span class="ident" id="5882128">d</span><span class="op" id="5882129">[</span><span class="ident" id="5882130">j</span><span class="op" id="5882131">+</span><span class="num" id="5882132">6</span>&nbsp;<span class="op" id="5882134">:</span>&nbsp;<span class="ident" id="5882136">j</span><span class="op" id="5882137">+</span><span class="num" id="5882138">8</span><span class="op" id="5882139">]</span><span class="op" id="5882140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882145">nameoff</span>&nbsp;<span class="op" id="5882153">:=</span>&nbsp;<span class="ident" id="5882156">f</span><span class="op" id="5882157">.</span><span class="ident" id="5882158">ByteOrder</span><span class="op" id="5882167">.</span><span class="ident" id="5882168">Uint32</span><span class="op" id="5882174">(</span><span class="ident" id="5882175">d</span><span class="op" id="5882176">[</span><span class="ident" id="5882177">j</span><span class="op" id="5882178">+</span><span class="num" id="5882179">8</span>&nbsp;<span class="op" id="5882181">:</span>&nbsp;<span class="ident" id="5882183">j</span><span class="op" id="5882184">+</span><span class="num" id="5882185">12</span><span class="op" id="5882187">]</span><span class="op" id="5882188">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882193">next</span>&nbsp;<span class="op" id="5882198">:=</span>&nbsp;<span class="ident" id="5882201">f</span><span class="op" id="5882202">.</span><span class="ident" id="5882203">ByteOrder</span><span class="op" id="5882212">.</span><span class="ident" id="5882213">Uint32</span><span class="op" id="5882219">(</span><span class="ident" id="5882220">d</span><span class="op" id="5882221">[</span><span class="ident" id="5882222">j</span><span class="op" id="5882223">+</span><span class="num" id="5882224">12</span>&nbsp;<span class="op" id="5882227">:</span>&nbsp;<span class="ident" id="5882229">j</span><span class="op" id="5882230">+</span><span class="num" id="5882231">16</span><span class="op" id="5882233">]</span><span class="op" id="5882234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882239">name</span><span class="op" id="5882243">,</span>&nbsp;<span class="ident" id="5882245">_</span>&nbsp;<span class="op" id="5882247">=</span>&nbsp;<span class="ident" id="5882249">getString</span><span class="op" id="5882258">(</span><span class="ident" id="5882259">str</span><span class="op" id="5882262">,</span>&nbsp;<span class="builtintype" id="5882264">int</span><span class="op" id="5882267">(</span><span class="ident" id="5882268">nameoff</span><span class="op" id="5882275">)</span><span class="op" id="5882276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882281">ndx</span>&nbsp;<span class="op" id="5882285">:=</span>&nbsp;<span class="builtintype" id="5882288">int</span><span class="op" id="5882291">(</span><span class="ident" id="5882292">other</span><span class="op" id="5882297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882302">if</span>&nbsp;<span class="ident" id="5882305">ndx</span>&nbsp;<span class="op" id="5882309">&gt;=</span>&nbsp;<span class="builtinfunc" id="5882312">len</span><span class="op" id="5882315">(</span><span class="ident" id="5882316">need</span><span class="op" id="5882320">)</span>&nbsp;<span class="op" id="5882322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882328">a</span>&nbsp;<span class="op" id="5882330">:=</span>&nbsp;<span class="builtinfunc" id="5882333">make</span><span class="op" id="5882337">(</span><span class="op" id="5882338">[</span><span class="op" id="5882339">]</span><span class="ident" id="5882340">verneed</span><span class="op" id="5882347">,</span>&nbsp;<span class="num" id="5882349">2</span><span class="op" id="5882350">*</span><span class="op" id="5882351">(</span><span class="ident" id="5882352">ndx</span><span class="op" id="5882355">+</span><span class="num" id="5882356">1</span><span class="op" id="5882357">)</span><span class="op" id="5882358">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5882364">copy</span><span class="op" id="5882368">(</span><span class="ident" id="5882369">a</span><span class="op" id="5882370">,</span>&nbsp;<span class="ident" id="5882372">need</span><span class="op" id="5882376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882382">need</span>&nbsp;<span class="op" id="5882387">=</span>&nbsp;<span class="ident" id="5882389">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882400">need</span><span class="op" id="5882404">[</span><span class="ident" id="5882405">ndx</span><span class="op" id="5882408">]</span>&nbsp;<span class="op" id="5882410">=</span>&nbsp;<span class="ident" id="5882412">verneed</span><span class="op" id="5882419">{</span><span class="ident" id="5882420">file</span><span class="op" id="5882424">,</span>&nbsp;<span class="ident" id="5882426">name</span><span class="op" id="5882430">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882435">if</span>&nbsp;<span class="ident" id="5882438">next</span>&nbsp;<span class="op" id="5882443">==</span>&nbsp;<span class="num" id="5882446">0</span>&nbsp;<span class="op" id="5882448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882454">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882468">j</span>&nbsp;<span class="op" id="5882470">+=</span>&nbsp;<span class="builtintype" id="5882473">int</span><span class="op" id="5882476">(</span><span class="ident" id="5882477">next</span><span class="op" id="5882481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882485">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882490">if</span>&nbsp;<span class="ident" id="5882493">next</span>&nbsp;<span class="op" id="5882498">==</span>&nbsp;<span class="num" id="5882501">0</span>&nbsp;<span class="op" id="5882503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882508">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882520">i</span>&nbsp;<span class="op" id="5882522">+=</span>&nbsp;<span class="builtintype" id="5882525">int</span><span class="op" id="5882528">(</span><span class="ident" id="5882529">next</span><span class="op" id="5882533">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5882540">//&nbsp;Versym&nbsp;parallels&nbsp;symbol&nbsp;table,&nbsp;indexing&nbsp;into&nbsp;verneed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882598">vs</span>&nbsp;<span class="op" id="5882601">:=</span>&nbsp;<span class="ident" id="5882604">f</span><span class="op" id="5882605">.</span><span class="ident" id="5882606">SectionByType</span><span class="op" id="5882619">(</span><span class="ident" id="5882620">SHT_GNU_VERSYM</span><span class="op" id="5882634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882637">if</span>&nbsp;<span class="ident" id="5882640">vs</span>&nbsp;<span class="op" id="5882643">==</span>&nbsp;<span class="ident" id="5882646">nil</span>&nbsp;<span class="op" id="5882650">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882654">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882665">d</span><span class="op" id="5882666">,</span>&nbsp;<span class="ident" id="5882668">_</span>&nbsp;<span class="op" id="5882670">=</span>&nbsp;<span class="ident" id="5882672">vs</span><span class="op" id="5882674">.</span><span class="ident" id="5882675">Data</span><span class="op" id="5882679">(</span><span class="op" id="5882680">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882684">f</span><span class="op" id="5882685">.</span><span class="ident" id="5882686">gnuNeed</span>&nbsp;<span class="op" id="5882694">=</span>&nbsp;<span class="ident" id="5882696">need</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882702">f</span><span class="op" id="5882703">.</span><span class="ident" id="5882704">gnuVersym</span>&nbsp;<span class="op" id="5882714">=</span>&nbsp;<span class="ident" id="5882716">d</span><br>
<span class="lineno"></span><span class="op" id="5882718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5882721">//&nbsp;gnuVersion&nbsp;adds&nbsp;Library&nbsp;and&nbsp;Version&nbsp;information&nbsp;to&nbsp;sym,</span><br>
<span class="lineno"></span><span class="comment" id="5882780">//&nbsp;which&nbsp;came&nbsp;from&nbsp;offset&nbsp;i&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">885</span><span class="keyword" id="5882829">func</span>&nbsp;<span class="op" id="5882834">(</span><span class="ident" id="5882835">f</span>&nbsp;<span class="op" id="5882837">*</span><span class="ident" id="5882838">File</span><span class="op" id="5882842">)</span>&nbsp;<span class="ident" id="5882844">gnuVersion</span><span class="op" id="5882854">(</span><span class="ident" id="5882855">i</span>&nbsp;<span class="builtintype" id="5882857">int</span><span class="op" id="5882860">,</span>&nbsp;<span class="ident" id="5882862">sym</span>&nbsp;<span class="op" id="5882866">*</span><span class="ident" id="5882867">ImportedSymbol</span><span class="op" id="5882881">)</span>&nbsp;<span class="op" id="5882883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5882886">//&nbsp;Each&nbsp;entry&nbsp;is&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882915">i</span>&nbsp;<span class="op" id="5882917">=</span>&nbsp;<span class="op" id="5882919">(</span><span class="ident" id="5882920">i</span>&nbsp;<span class="op" id="5882922">+</span>&nbsp;<span class="num" id="5882924">1</span><span class="op" id="5882925">)</span>&nbsp;<span class="op" id="5882927">*</span>&nbsp;<span class="num" id="5882929">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882932">if</span>&nbsp;<span class="ident" id="5882935">i</span>&nbsp;<span class="op" id="5882937">&gt;=</span>&nbsp;<span class="builtinfunc" id="5882940">len</span><span class="op" id="5882943">(</span><span class="ident" id="5882944">f</span><span class="op" id="5882945">.</span><span class="ident" id="5882946">gnuVersym</span><span class="op" id="5882955">)</span>&nbsp;<span class="op" id="5882957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5882961">return</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5882969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5882972">j</span>&nbsp;<span class="op" id="5882974">:=</span>&nbsp;<span class="builtintype" id="5882977">int</span><span class="op" id="5882980">(</span><span class="ident" id="5882981">f</span><span class="op" id="5882982">.</span><span class="ident" id="5882983">ByteOrder</span><span class="op" id="5882992">.</span><span class="ident" id="5882993">Uint16</span><span class="op" id="5882999">(</span><span class="ident" id="5883000">f</span><span class="op" id="5883001">.</span><span class="ident" id="5883002">gnuVersym</span><span class="op" id="5883011">[</span><span class="ident" id="5883012">i</span><span class="op" id="5883013">:</span><span class="op" id="5883014">]</span><span class="op" id="5883015">)</span><span class="op" id="5883016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883019">if</span>&nbsp;<span class="ident" id="5883022">j</span>&nbsp;<span class="op" id="5883024">&lt;</span>&nbsp;<span class="num" id="5883026">2</span>&nbsp;<span class="op" id="5883028">||</span>&nbsp;<span class="ident" id="5883031">j</span>&nbsp;<span class="op" id="5883033">&gt;=</span>&nbsp;<span class="builtinfunc" id="5883036">len</span><span class="op" id="5883039">(</span><span class="ident" id="5883040">f</span><span class="op" id="5883041">.</span><span class="ident" id="5883042">gnuNeed</span><span class="op" id="5883049">)</span>&nbsp;<span class="op" id="5883051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883055">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5883063">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883066">n</span>&nbsp;<span class="op" id="5883068">:=</span>&nbsp;<span class="op" id="5883071">&amp;</span><span class="ident" id="5883072">f</span><span class="op" id="5883073">.</span><span class="ident" id="5883074">gnuNeed</span><span class="op" id="5883081">[</span><span class="ident" id="5883082">j</span><span class="op" id="5883083">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883086">sym</span><span class="op" id="5883089">.</span><span class="ident" id="5883090">Library</span>&nbsp;<span class="op" id="5883098">=</span>&nbsp;<span class="ident" id="5883100">n</span><span class="op" id="5883101">.</span><span class="ident" id="5883102">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883108">sym</span><span class="op" id="5883111">.</span><span class="ident" id="5883112">Version</span>&nbsp;<span class="op" id="5883120">=</span>&nbsp;<span class="ident" id="5883122">n</span><span class="op" id="5883123">.</span><span class="ident" id="5883124">Name</span><br>
<span class="lineno"></span><span class="op" id="5883129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="5883132">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="5883188">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5883243">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="5883291">func</span>&nbsp;<span class="op" id="5883296">(</span><span class="ident" id="5883297">f</span>&nbsp;<span class="op" id="5883299">*</span><span class="ident" id="5883300">File</span><span class="op" id="5883304">)</span>&nbsp;<span class="ident" id="5883306">ImportedLibraries</span><span class="op" id="5883323">(</span><span class="op" id="5883324">)</span>&nbsp;<span class="op" id="5883326">(</span><span class="op" id="5883327">[</span><span class="op" id="5883328">]</span><span class="builtintype" id="5883329">string</span><span class="op" id="5883335">,</span>&nbsp;<span class="builtintype" id="5883337">error</span><span class="op" id="5883342">)</span>&nbsp;<span class="op" id="5883344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883347">return</span>&nbsp;<span class="ident" id="5883354">f</span><span class="op" id="5883355">.</span><span class="ident" id="5883356">DynString</span><span class="op" id="5883365">(</span><span class="ident" id="5883366">DT_NEEDED</span><span class="op" id="5883375">)</span><br>
<span class="lineno">905</span><span class="op" id="5883377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5883380">//&nbsp;DynString&nbsp;returns&nbsp;the&nbsp;strings&nbsp;listed&nbsp;for&nbsp;the&nbsp;given&nbsp;tag&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;dynamic</span><br>
<span class="lineno"></span><span class="comment" id="5883460">//&nbsp;section.</span><br>
<span class="lineno"></span><span class="comment" id="5883472">//</span><br>
<span class="lineno">910</span><span class="comment" id="5883475">//&nbsp;The&nbsp;tag&nbsp;must&nbsp;be&nbsp;one&nbsp;that&nbsp;takes&nbsp;string&nbsp;values:&nbsp;DT_NEEDED,&nbsp;DT_SONAME,&nbsp;DT_RPATH,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5883559">//&nbsp;DT_RUNPATH.</span><br>
<span class="lineno"></span><span class="keyword" id="5883574">func</span>&nbsp;<span class="op" id="5883579">(</span><span class="ident" id="5883580">f</span>&nbsp;<span class="op" id="5883582">*</span><span class="ident" id="5883583">File</span><span class="op" id="5883587">)</span>&nbsp;<span class="ident" id="5883589">DynString</span><span class="op" id="5883598">(</span><span class="ident" id="5883599">tag</span>&nbsp;<span class="ident" id="5883603">DynTag</span><span class="op" id="5883609">)</span>&nbsp;<span class="op" id="5883611">(</span><span class="op" id="5883612">[</span><span class="op" id="5883613">]</span><span class="builtintype" id="5883614">string</span><span class="op" id="5883620">,</span>&nbsp;<span class="builtintype" id="5883622">error</span><span class="op" id="5883627">)</span>&nbsp;<span class="op" id="5883629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883632">switch</span>&nbsp;<span class="ident" id="5883639">tag</span>&nbsp;<span class="op" id="5883643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883646">case</span>&nbsp;<span class="ident" id="5883651">DT_NEEDED</span><span class="op" id="5883660">,</span>&nbsp;<span class="ident" id="5883662">DT_SONAME</span><span class="op" id="5883671">,</span>&nbsp;<span class="ident" id="5883673">DT_RPATH</span><span class="op" id="5883681">,</span>&nbsp;<span class="ident" id="5883683">DT_RUNPATH</span><span class="op" id="5883693">:</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883696">default</span><span class="op" id="5883703">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883707">return</span>&nbsp;<span class="ident" id="5883714">nil</span><span class="op" id="5883717">,</span>&nbsp;<span class="ident" id="5883719">fmt</span><span class="op" id="5883722">.</span><span class="ident" id="5883723">Errorf</span><span class="op" id="5883729">(</span><span class="string" id="5883730">&#34;non-string-valued&nbsp;tag&nbsp;%v&#34;</span><span class="op" id="5883756">,</span>&nbsp;<span class="ident" id="5883758">tag</span><span class="op" id="5883761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5883764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883767">ds</span>&nbsp;<span class="op" id="5883770">:=</span>&nbsp;<span class="ident" id="5883773">f</span><span class="op" id="5883774">.</span><span class="ident" id="5883775">SectionByType</span><span class="op" id="5883788">(</span><span class="ident" id="5883789">SHT_DYNAMIC</span><span class="op" id="5883800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883803">if</span>&nbsp;<span class="ident" id="5883806">ds</span>&nbsp;<span class="op" id="5883809">==</span>&nbsp;<span class="ident" id="5883812">nil</span>&nbsp;<span class="op" id="5883816">{</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5883820">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883854">return</span>&nbsp;<span class="ident" id="5883861">nil</span><span class="op" id="5883864">,</span>&nbsp;<span class="ident" id="5883866">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5883871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883874">d</span><span class="op" id="5883875">,</span>&nbsp;<span class="ident" id="5883877">err</span>&nbsp;<span class="op" id="5883881">:=</span>&nbsp;<span class="ident" id="5883884">ds</span><span class="op" id="5883886">.</span><span class="ident" id="5883887">Data</span><span class="op" id="5883891">(</span><span class="op" id="5883892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883895">if</span>&nbsp;<span class="ident" id="5883898">err</span>&nbsp;<span class="op" id="5883902">!=</span>&nbsp;<span class="ident" id="5883905">nil</span>&nbsp;<span class="op" id="5883909">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883913">return</span>&nbsp;<span class="ident" id="5883920">nil</span><span class="op" id="5883923">,</span>&nbsp;<span class="ident" id="5883925">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5883930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5883933">str</span><span class="op" id="5883936">,</span>&nbsp;<span class="ident" id="5883938">err</span>&nbsp;<span class="op" id="5883942">:=</span>&nbsp;<span class="ident" id="5883945">f</span><span class="op" id="5883946">.</span><span class="ident" id="5883947">stringTable</span><span class="op" id="5883958">(</span><span class="ident" id="5883959">ds</span><span class="op" id="5883961">.</span><span class="ident" id="5883962">Link</span><span class="op" id="5883966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883969">if</span>&nbsp;<span class="ident" id="5883972">err</span>&nbsp;<span class="op" id="5883976">!=</span>&nbsp;<span class="ident" id="5883979">nil</span>&nbsp;<span class="op" id="5883983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5883987">return</span>&nbsp;<span class="ident" id="5883994">nil</span><span class="op" id="5883997">,</span>&nbsp;<span class="ident" id="5883999">err</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5884004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884007">var</span>&nbsp;<span class="ident" id="5884011">all</span>&nbsp;<span class="op" id="5884015">[</span><span class="op" id="5884016">]</span><span class="builtintype" id="5884017">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884025">for</span>&nbsp;<span class="builtinfunc" id="5884029">len</span><span class="op" id="5884032">(</span><span class="ident" id="5884033">d</span><span class="op" id="5884034">)</span>&nbsp;<span class="op" id="5884036">&gt;</span>&nbsp;<span class="num" id="5884038">0</span>&nbsp;<span class="op" id="5884040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884044">var</span>&nbsp;<span class="ident" id="5884048">t</span>&nbsp;<span class="ident" id="5884050">DynTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884059">var</span>&nbsp;<span class="ident" id="5884063">v</span>&nbsp;<span class="ident" id="5884065">uint64</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884074">switch</span>&nbsp;<span class="ident" id="5884081">f</span><span class="op" id="5884082">.</span><span class="ident" id="5884083">Class</span>&nbsp;<span class="op" id="5884089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884093">case</span>&nbsp;<span class="ident" id="5884098">ELFCLASS32</span><span class="op" id="5884108">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884113">t</span>&nbsp;<span class="op" id="5884115">=</span>&nbsp;<span class="ident" id="5884117">DynTag</span><span class="op" id="5884123">(</span><span class="ident" id="5884124">f</span><span class="op" id="5884125">.</span><span class="ident" id="5884126">ByteOrder</span><span class="op" id="5884135">.</span><span class="ident" id="5884136">Uint32</span><span class="op" id="5884142">(</span><span class="ident" id="5884143">d</span><span class="op" id="5884144">[</span><span class="num" id="5884145">0</span><span class="op" id="5884146">:</span><span class="num" id="5884147">4</span><span class="op" id="5884148">]</span><span class="op" id="5884149">)</span><span class="op" id="5884150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884155">v</span>&nbsp;<span class="op" id="5884157">=</span>&nbsp;<span class="ident" id="5884159">uint64</span><span class="op" id="5884165">(</span><span class="ident" id="5884166">f</span><span class="op" id="5884167">.</span><span class="ident" id="5884168">ByteOrder</span><span class="op" id="5884177">.</span><span class="ident" id="5884178">Uint32</span><span class="op" id="5884184">(</span><span class="ident" id="5884185">d</span><span class="op" id="5884186">[</span><span class="num" id="5884187">4</span><span class="op" id="5884188">:</span><span class="num" id="5884189">8</span><span class="op" id="5884190">]</span><span class="op" id="5884191">)</span><span class="op" id="5884192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884197">d</span>&nbsp;<span class="op" id="5884199">=</span>&nbsp;<span class="ident" id="5884201">d</span><span class="op" id="5884202">[</span><span class="num" id="5884203">8</span><span class="op" id="5884204">:</span><span class="op" id="5884205">]</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884209">case</span>&nbsp;<span class="ident" id="5884214">ELFCLASS64</span><span class="op" id="5884224">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884229">t</span>&nbsp;<span class="op" id="5884231">=</span>&nbsp;<span class="ident" id="5884233">DynTag</span><span class="op" id="5884239">(</span><span class="ident" id="5884240">f</span><span class="op" id="5884241">.</span><span class="ident" id="5884242">ByteOrder</span><span class="op" id="5884251">.</span><span class="ident" id="5884252">Uint64</span><span class="op" id="5884258">(</span><span class="ident" id="5884259">d</span><span class="op" id="5884260">[</span><span class="num" id="5884261">0</span><span class="op" id="5884262">:</span><span class="num" id="5884263">8</span><span class="op" id="5884264">]</span><span class="op" id="5884265">)</span><span class="op" id="5884266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884271">v</span>&nbsp;<span class="op" id="5884273">=</span>&nbsp;<span class="ident" id="5884275">f</span><span class="op" id="5884276">.</span><span class="ident" id="5884277">ByteOrder</span><span class="op" id="5884286">.</span><span class="ident" id="5884287">Uint64</span><span class="op" id="5884293">(</span><span class="ident" id="5884294">d</span><span class="op" id="5884295">[</span><span class="num" id="5884296">8</span><span class="op" id="5884297">:</span><span class="num" id="5884298">16</span><span class="op" id="5884300">]</span><span class="op" id="5884301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884306">d</span>&nbsp;<span class="op" id="5884308">=</span>&nbsp;<span class="ident" id="5884310">d</span><span class="op" id="5884311">[</span><span class="num" id="5884312">16</span><span class="op" id="5884314">:</span><span class="op" id="5884315">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5884319">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884323">if</span>&nbsp;<span class="ident" id="5884326">t</span>&nbsp;<span class="op" id="5884328">==</span>&nbsp;<span class="ident" id="5884331">tag</span>&nbsp;<span class="op" id="5884335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884340">s</span><span class="op" id="5884341">,</span>&nbsp;<span class="ident" id="5884343">ok</span>&nbsp;<span class="op" id="5884346">:=</span>&nbsp;<span class="ident" id="5884349">getString</span><span class="op" id="5884358">(</span><span class="ident" id="5884359">str</span><span class="op" id="5884362">,</span>&nbsp;<span class="builtintype" id="5884364">int</span><span class="op" id="5884367">(</span><span class="ident" id="5884368">v</span><span class="op" id="5884369">)</span><span class="op" id="5884370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884375">if</span>&nbsp;<span class="ident" id="5884378">ok</span>&nbsp;<span class="op" id="5884381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5884387">all</span>&nbsp;<span class="op" id="5884391">=</span>&nbsp;<span class="builtinfunc" id="5884393">append</span><span class="op" id="5884399">(</span><span class="ident" id="5884400">all</span><span class="op" id="5884403">,</span>&nbsp;<span class="ident" id="5884405">s</span><span class="op" id="5884406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5884411">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5884415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5884418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5884421">return</span>&nbsp;<span class="ident" id="5884428">all</span><span class="op" id="5884431">,</span>&nbsp;<span class="ident" id="5884433">nil</span><br>
<span class="lineno"></span><span class="op" id="5884437">}</span>
</div>
</body>
</html>
