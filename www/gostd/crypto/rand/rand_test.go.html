<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rand</h2>
<ul>
<li><a href="/gostd/crypto/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/crypto/rand/rand_linux.go.html">rand_linux.go</a></li>
<li><a href="/gostd/crypto/rand/rand_test.go.html" class="current">rand_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand_unix.go.html">rand_unix.go</a></li>
<li><a href="/gostd/crypto/rand/util.go.html">util.go</a></li>
<li><a href="/gostd/crypto/rand/util_test.go.html">util_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7485088">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7485144">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7485198">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7485249">package</span>&nbsp;<span class="ident" id="7485257">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7485263">import</span>&nbsp;<span class="op" id="7485270">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7485273">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7485282">&#34;compress/flate&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7485300">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7485306">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7485316">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7485319">func</span>&nbsp;<span class="ident" id="7485324">TestRead</span><span class="op" id="7485332">(</span><span class="ident" id="7485333">t</span>&nbsp;<span class="op" id="7485335">*</span><span class="ident" id="7485336">testing</span><span class="op" id="7485343">.</span><span class="ident" id="7485344">T</span><span class="op" id="7485345">)</span>&nbsp;<span class="op" id="7485347">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7485350">var</span>&nbsp;<span class="ident" id="7485354">n</span>&nbsp;<span class="builtintype" id="7485356">int</span>&nbsp;<span class="op" id="7485360">=</span>&nbsp;<span class="num" id="7485362">4e6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7485367">if</span>&nbsp;<span class="ident" id="7485370">testing</span><span class="op" id="7485377">.</span><span class="ident" id="7485378">Short</span><span class="op" id="7485383">(</span><span class="op" id="7485384">)</span>&nbsp;<span class="op" id="7485386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485390">n</span>&nbsp;<span class="op" id="7485392">=</span>&nbsp;<span class="num" id="7485394">1e5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7485399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485402">b</span>&nbsp;<span class="op" id="7485404">:=</span>&nbsp;<span class="builtinfunc" id="7485407">make</span><span class="op" id="7485411">(</span><span class="op" id="7485412">[</span><span class="op" id="7485413">]</span><span class="builtintype" id="7485414">byte</span><span class="op" id="7485418">,</span>&nbsp;<span class="ident" id="7485420">n</span><span class="op" id="7485421">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485424">n</span><span class="op" id="7485425">,</span>&nbsp;<span class="ident" id="7485427">err</span>&nbsp;<span class="op" id="7485431">:=</span>&nbsp;<span class="ident" id="7485434">io</span><span class="op" id="7485436">.</span><span class="ident" id="7485437">ReadFull</span><span class="op" id="7485445">(</span><span class="ident" id="7485446">Reader</span><span class="op" id="7485452">,</span>&nbsp;<span class="ident" id="7485454">b</span><span class="op" id="7485455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7485458">if</span>&nbsp;<span class="ident" id="7485461">n</span>&nbsp;<span class="op" id="7485463">!=</span>&nbsp;<span class="builtinfunc" id="7485466">len</span><span class="op" id="7485469">(</span><span class="ident" id="7485470">b</span><span class="op" id="7485471">)</span>&nbsp;<span class="op" id="7485473">||</span>&nbsp;<span class="ident" id="7485476">err</span>&nbsp;<span class="op" id="7485480">!=</span>&nbsp;<span class="ident" id="7485483">nil</span>&nbsp;<span class="op" id="7485487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485491">t</span><span class="op" id="7485492">.</span><span class="ident" id="7485493">Fatalf</span><span class="op" id="7485499">(</span><span class="string" id="7485500">&#34;ReadFull(buf)&nbsp;=&nbsp;%d,&nbsp;%s&#34;</span><span class="op" id="7485524">,</span>&nbsp;<span class="ident" id="7485526">n</span><span class="op" id="7485527">,</span>&nbsp;<span class="ident" id="7485529">err</span><span class="op" id="7485532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7485535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7485539">var</span>&nbsp;<span class="ident" id="7485543">z</span>&nbsp;<span class="ident" id="7485545">bytes</span><span class="op" id="7485550">.</span><span class="ident" id="7485551">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485559">f</span><span class="op" id="7485560">,</span>&nbsp;<span class="ident" id="7485562">_</span>&nbsp;<span class="op" id="7485564">:=</span>&nbsp;<span class="ident" id="7485567">flate</span><span class="op" id="7485572">.</span><span class="ident" id="7485573">NewWriter</span><span class="op" id="7485582">(</span><span class="op" id="7485583">&amp;</span><span class="ident" id="7485584">z</span><span class="op" id="7485585">,</span>&nbsp;<span class="num" id="7485587">5</span><span class="op" id="7485588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485591">f</span><span class="op" id="7485592">.</span><span class="ident" id="7485593">Write</span><span class="op" id="7485598">(</span><span class="ident" id="7485599">b</span><span class="op" id="7485600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485603">f</span><span class="op" id="7485604">.</span><span class="ident" id="7485605">Close</span><span class="op" id="7485610">(</span><span class="op" id="7485611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7485614">if</span>&nbsp;<span class="ident" id="7485617">z</span><span class="op" id="7485618">.</span><span class="ident" id="7485619">Len</span><span class="op" id="7485622">(</span><span class="op" id="7485623">)</span>&nbsp;<span class="op" id="7485625">&lt;</span>&nbsp;<span class="builtinfunc" id="7485627">len</span><span class="op" id="7485630">(</span><span class="ident" id="7485631">b</span><span class="op" id="7485632">)</span><span class="op" id="7485633">*</span><span class="num" id="7485634">99</span><span class="op" id="7485636">/</span><span class="num" id="7485637">100</span>&nbsp;<span class="op" id="7485641">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485645">t</span><span class="op" id="7485646">.</span><span class="ident" id="7485647">Fatalf</span><span class="op" id="7485653">(</span><span class="string" id="7485654">&#34;Compressed&nbsp;%d&nbsp;-&gt;&nbsp;%d&#34;</span><span class="op" id="7485675">,</span>&nbsp;<span class="builtinfunc" id="7485677">len</span><span class="op" id="7485680">(</span><span class="ident" id="7485681">b</span><span class="op" id="7485682">)</span><span class="op" id="7485683">,</span>&nbsp;<span class="ident" id="7485685">z</span><span class="op" id="7485686">.</span><span class="ident" id="7485687">Len</span><span class="op" id="7485690">(</span><span class="op" id="7485691">)</span><span class="op" id="7485692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7485695">}</span><br>
<span class="lineno"></span><span class="op" id="7485697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7485700">func</span>&nbsp;<span class="ident" id="7485705">TestReadEmpty</span><span class="op" id="7485718">(</span><span class="ident" id="7485719">t</span>&nbsp;<span class="op" id="7485721">*</span><span class="ident" id="7485722">testing</span><span class="op" id="7485729">.</span><span class="ident" id="7485730">T</span><span class="op" id="7485731">)</span>&nbsp;<span class="op" id="7485733">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485736">n</span><span class="op" id="7485737">,</span>&nbsp;<span class="ident" id="7485739">err</span>&nbsp;<span class="op" id="7485743">:=</span>&nbsp;<span class="ident" id="7485746">Reader</span><span class="op" id="7485752">.</span><span class="ident" id="7485753">Read</span><span class="op" id="7485757">(</span><span class="builtinfunc" id="7485758">make</span><span class="op" id="7485762">(</span><span class="op" id="7485763">[</span><span class="op" id="7485764">]</span><span class="builtintype" id="7485765">byte</span><span class="op" id="7485769">,</span>&nbsp;<span class="num" id="7485771">0</span><span class="op" id="7485772">)</span><span class="op" id="7485773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7485776">if</span>&nbsp;<span class="ident" id="7485779">n</span>&nbsp;<span class="op" id="7485781">!=</span>&nbsp;<span class="num" id="7485784">0</span>&nbsp;<span class="op" id="7485786">||</span>&nbsp;<span class="ident" id="7485789">err</span>&nbsp;<span class="op" id="7485793">!=</span>&nbsp;<span class="ident" id="7485796">nil</span>&nbsp;<span class="op" id="7485800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485804">t</span><span class="op" id="7485805">.</span><span class="ident" id="7485806">Fatalf</span><span class="op" id="7485812">(</span><span class="string" id="7485813">&#34;Read(make([]byte,&nbsp;0))&nbsp;=&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="7485845">,</span>&nbsp;<span class="ident" id="7485847">n</span><span class="op" id="7485848">,</span>&nbsp;<span class="ident" id="7485850">err</span><span class="op" id="7485853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7485856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485859">n</span><span class="op" id="7485860">,</span>&nbsp;<span class="ident" id="7485862">err</span>&nbsp;<span class="op" id="7485866">=</span>&nbsp;<span class="ident" id="7485868">Reader</span><span class="op" id="7485874">.</span><span class="ident" id="7485875">Read</span><span class="op" id="7485879">(</span><span class="ident" id="7485880">nil</span><span class="op" id="7485883">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7485886">if</span>&nbsp;<span class="ident" id="7485889">n</span>&nbsp;<span class="op" id="7485891">!=</span>&nbsp;<span class="num" id="7485894">0</span>&nbsp;<span class="op" id="7485896">||</span>&nbsp;<span class="ident" id="7485899">err</span>&nbsp;<span class="op" id="7485903">!=</span>&nbsp;<span class="ident" id="7485906">nil</span>&nbsp;<span class="op" id="7485910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7485914">t</span><span class="op" id="7485915">.</span><span class="ident" id="7485916">Fatalf</span><span class="op" id="7485922">(</span><span class="string" id="7485923">&#34;Read(nil)&nbsp;=&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="7485943">,</span>&nbsp;<span class="ident" id="7485945">n</span><span class="op" id="7485946">,</span>&nbsp;<span class="ident" id="7485948">err</span><span class="op" id="7485951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7485954">}</span><br>
<span class="lineno"></span><span class="op" id="7485956">}</span>
</div>
</body>
</html>
