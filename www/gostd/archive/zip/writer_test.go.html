<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/zip</h2>
<ul>
<li><a href="/gostd/archive/zip/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/zip/reader.go.html">reader.go</a></li>
<li><a href="/gostd/archive/zip/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/zip/register.go.html">register.go</a></li>
<li><a href="/gostd/archive/zip/struct.go.html">struct.go</a></li>
<li><a href="/gostd/archive/zip/writer.go.html">writer.go</a></li>
<li><a href="/gostd/archive/zip/writer_test.go.html" class="current">writer_test.go</a></li>
<li><a href="/gostd/archive/zip/zip_test.go.html">zip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7200751">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7200806">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7200860">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7200911">package</span>&nbsp;<span class="ident" id="7200919">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7200924">import</span>&nbsp;<span class="op" id="7200931">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7200934">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7200943">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7200949">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7200962">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7200975">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7200981">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7200991">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="7200994">//&nbsp;TODO(adg):&nbsp;a&nbsp;more&nbsp;sophisticated&nbsp;test&nbsp;suite</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7201041">type</span>&nbsp;<span class="ident" id="7201046">WriteTest</span>&nbsp;<span class="keyword" id="7201056">struct</span>&nbsp;<span class="op" id="7201063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201066">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7201073">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201081">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7201088">[</span><span class="op" id="7201089">]</span><span class="builtintype" id="7201090">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201096">Method</span>&nbsp;<span class="builtintype" id="7201103">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201111">Mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7201118">os</span><span class="op" id="7201120">.</span><span class="ident" id="7201121">FileMode</span><br>
<span class="lineno"></span><span class="op" id="7201130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="7201133">var</span>&nbsp;<span class="ident" id="7201137">writeTests</span>&nbsp;<span class="op" id="7201148">=</span>&nbsp;<span class="op" id="7201150">[</span><span class="op" id="7201151">]</span><span class="ident" id="7201152">WriteTest</span><span class="op" id="7201161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7201164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201168">Name</span><span class="op" id="7201172">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7201176">&#34;foo&#34;</span><span class="op" id="7201181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201185">Data</span><span class="op" id="7201189">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7201193">[</span><span class="op" id="7201194">]</span><span class="builtintype" id="7201195">byte</span><span class="op" id="7201199">(</span><span class="string" id="7201200">&#34;Rabbits,&nbsp;guinea&nbsp;pigs,&nbsp;gophers,&nbsp;marsupial&nbsp;rats,&nbsp;and&nbsp;quolls.&#34;</span><span class="op" id="7201260">)</span><span class="op" id="7201261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201265">Method</span><span class="op" id="7201271">:</span>&nbsp;<span class="ident" id="7201273">Store</span><span class="op" id="7201278">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201282">Mode</span><span class="op" id="7201286">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7201290">0666</span><span class="op" id="7201294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7201297">}</span><span class="op" id="7201298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7201301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201305">Name</span><span class="op" id="7201309">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7201313">&#34;bar&#34;</span><span class="op" id="7201318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201322">Data</span><span class="op" id="7201326">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7201330">nil</span><span class="op" id="7201333">,</span>&nbsp;<span class="comment" id="7201335">//&nbsp;large&nbsp;data&nbsp;set&nbsp;in&nbsp;the&nbsp;test</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201367">Method</span><span class="op" id="7201373">:</span>&nbsp;<span class="ident" id="7201375">Deflate</span><span class="op" id="7201382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201386">Mode</span><span class="op" id="7201390">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7201394">0644</span><span class="op" id="7201398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7201401">}</span><span class="op" id="7201402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7201405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201409">Name</span><span class="op" id="7201413">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7201417">&#34;setuid&#34;</span><span class="op" id="7201425">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201429">Data</span><span class="op" id="7201433">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7201437">[</span><span class="op" id="7201438">]</span><span class="builtintype" id="7201439">byte</span><span class="op" id="7201443">(</span><span class="string" id="7201444">&#34;setuid&nbsp;file&#34;</span><span class="op" id="7201457">)</span><span class="op" id="7201458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201462">Method</span><span class="op" id="7201468">:</span>&nbsp;<span class="ident" id="7201470">Deflate</span><span class="op" id="7201477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201481">Mode</span><span class="op" id="7201485">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7201489">0755</span>&nbsp;<span class="op" id="7201494">|</span>&nbsp;<span class="ident" id="7201496">os</span><span class="op" id="7201498">.</span><span class="ident" id="7201499">ModeSetuid</span><span class="op" id="7201509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7201512">}</span><span class="op" id="7201513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7201516">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201520">Name</span><span class="op" id="7201524">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7201528">&#34;setgid&#34;</span><span class="op" id="7201536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201540">Data</span><span class="op" id="7201544">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7201548">[</span><span class="op" id="7201549">]</span><span class="builtintype" id="7201550">byte</span><span class="op" id="7201554">(</span><span class="string" id="7201555">&#34;setgid&nbsp;file&#34;</span><span class="op" id="7201568">)</span><span class="op" id="7201569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201573">Method</span><span class="op" id="7201579">:</span>&nbsp;<span class="ident" id="7201581">Deflate</span><span class="op" id="7201588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201592">Mode</span><span class="op" id="7201596">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7201600">0755</span>&nbsp;<span class="op" id="7201605">|</span>&nbsp;<span class="ident" id="7201607">os</span><span class="op" id="7201609">.</span><span class="ident" id="7201610">ModeSetgid</span><span class="op" id="7201620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7201623">}</span><span class="op" id="7201624">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7201627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201631">Name</span><span class="op" id="7201635">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7201639">&#34;symlink&#34;</span><span class="op" id="7201648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201652">Data</span><span class="op" id="7201656">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7201660">[</span><span class="op" id="7201661">]</span><span class="builtintype" id="7201662">byte</span><span class="op" id="7201666">(</span><span class="string" id="7201667">&#34;../link/target&#34;</span><span class="op" id="7201683">)</span><span class="op" id="7201684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201688">Method</span><span class="op" id="7201694">:</span>&nbsp;<span class="ident" id="7201696">Deflate</span><span class="op" id="7201703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201707">Mode</span><span class="op" id="7201711">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7201715">0755</span>&nbsp;<span class="op" id="7201720">|</span>&nbsp;<span class="ident" id="7201722">os</span><span class="op" id="7201724">.</span><span class="ident" id="7201725">ModeSymlink</span><span class="op" id="7201736">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7201739">}</span><span class="op" id="7201740">,</span><br>
<span class="lineno"></span><span class="op" id="7201742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7201745">func</span>&nbsp;<span class="ident" id="7201750">TestWriter</span><span class="op" id="7201760">(</span><span class="ident" id="7201761">t</span>&nbsp;<span class="op" id="7201763">*</span><span class="ident" id="7201764">testing</span><span class="op" id="7201771">.</span><span class="ident" id="7201772">T</span><span class="op" id="7201773">)</span>&nbsp;<span class="op" id="7201775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201778">largeData</span>&nbsp;<span class="op" id="7201788">:=</span>&nbsp;<span class="builtinfunc" id="7201791">make</span><span class="op" id="7201795">(</span><span class="op" id="7201796">[</span><span class="op" id="7201797">]</span><span class="builtintype" id="7201798">byte</span><span class="op" id="7201802">,</span>&nbsp;<span class="num" id="7201804">1</span><span class="op" id="7201805">&lt;&lt;</span><span class="num" id="7201807">17</span><span class="op" id="7201809">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7201812">for</span>&nbsp;<span class="ident" id="7201816">i</span>&nbsp;<span class="op" id="7201818">:=</span>&nbsp;<span class="keyword" id="7201821">range</span>&nbsp;<span class="ident" id="7201827">largeData</span>&nbsp;<span class="op" id="7201837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201841">largeData</span><span class="op" id="7201850">[</span><span class="ident" id="7201851">i</span><span class="op" id="7201852">]</span>&nbsp;<span class="op" id="7201854">=</span>&nbsp;<span class="builtintype" id="7201856">byte</span><span class="op" id="7201860">(</span><span class="ident" id="7201861">rand</span><span class="op" id="7201865">.</span><span class="ident" id="7201866">Int</span><span class="op" id="7201869">(</span><span class="op" id="7201870">)</span><span class="op" id="7201871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7201874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201877">writeTests</span><span class="op" id="7201887">[</span><span class="num" id="7201888">1</span><span class="op" id="7201889">]</span><span class="op" id="7201890">.</span><span class="ident" id="7201891">Data</span>&nbsp;<span class="op" id="7201896">=</span>&nbsp;<span class="ident" id="7201898">largeData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7201909">defer</span>&nbsp;<span class="keyword" id="7201915">func</span><span class="op" id="7201919">(</span><span class="op" id="7201920">)</span>&nbsp;<span class="op" id="7201922">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201926">writeTests</span><span class="op" id="7201936">[</span><span class="num" id="7201937">1</span><span class="op" id="7201938">]</span><span class="op" id="7201939">.</span><span class="ident" id="7201940">Data</span>&nbsp;<span class="op" id="7201945">=</span>&nbsp;<span class="builtintype" id="7201947">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7201952">}</span><span class="op" id="7201953">(</span><span class="op" id="7201954">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7201958">//&nbsp;write&nbsp;a&nbsp;zip&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7201979">buf</span>&nbsp;<span class="op" id="7201983">:=</span>&nbsp;<span class="builtinfunc" id="7201986">new</span><span class="op" id="7201989">(</span><span class="ident" id="7201990">bytes</span><span class="op" id="7201995">.</span><span class="ident" id="7201996">Buffer</span><span class="op" id="7202002">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202005">w</span>&nbsp;<span class="op" id="7202007">:=</span>&nbsp;<span class="ident" id="7202010">NewWriter</span><span class="op" id="7202019">(</span><span class="ident" id="7202020">buf</span><span class="op" id="7202023">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7202027">for</span>&nbsp;<span class="ident" id="7202031">_</span><span class="op" id="7202032">,</span>&nbsp;<span class="ident" id="7202034">wt</span>&nbsp;<span class="op" id="7202037">:=</span>&nbsp;<span class="keyword" id="7202040">range</span>&nbsp;<span class="ident" id="7202046">writeTests</span>&nbsp;<span class="op" id="7202057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202061">testCreate</span><span class="op" id="7202071">(</span><span class="ident" id="7202072">t</span><span class="op" id="7202073">,</span>&nbsp;<span class="ident" id="7202075">w</span><span class="op" id="7202076">,</span>&nbsp;<span class="op" id="7202078">&amp;</span><span class="ident" id="7202079">wt</span><span class="op" id="7202081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7202084">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7202088">if</span>&nbsp;<span class="ident" id="7202091">err</span>&nbsp;<span class="op" id="7202095">:=</span>&nbsp;<span class="ident" id="7202098">w</span><span class="op" id="7202099">.</span><span class="ident" id="7202100">Close</span><span class="op" id="7202105">(</span><span class="op" id="7202106">)</span><span class="op" id="7202107">;</span>&nbsp;<span class="ident" id="7202109">err</span>&nbsp;<span class="op" id="7202113">!=</span>&nbsp;<span class="builtintype" id="7202116">nil</span>&nbsp;<span class="op" id="7202120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202124">t</span><span class="op" id="7202125">.</span><span class="ident" id="7202126">Fatal</span><span class="op" id="7202131">(</span><span class="ident" id="7202132">err</span><span class="op" id="7202135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7202138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7202142">//&nbsp;read&nbsp;it&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202159">r</span><span class="op" id="7202160">,</span>&nbsp;<span class="ident" id="7202162">err</span>&nbsp;<span class="op" id="7202166">:=</span>&nbsp;<span class="ident" id="7202169">NewReader</span><span class="op" id="7202178">(</span><span class="ident" id="7202179">bytes</span><span class="op" id="7202184">.</span><span class="ident" id="7202185">NewReader</span><span class="op" id="7202194">(</span><span class="ident" id="7202195">buf</span><span class="op" id="7202198">.</span><span class="ident" id="7202199">Bytes</span><span class="op" id="7202204">(</span><span class="op" id="7202205">)</span><span class="op" id="7202206">)</span><span class="op" id="7202207">,</span>&nbsp;<span class="builtintype" id="7202209">int64</span><span class="op" id="7202214">(</span><span class="ident" id="7202215">buf</span><span class="op" id="7202218">.</span><span class="ident" id="7202219">Len</span><span class="op" id="7202222">(</span><span class="op" id="7202223">)</span><span class="op" id="7202224">)</span><span class="op" id="7202225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7202228">if</span>&nbsp;<span class="ident" id="7202231">err</span>&nbsp;<span class="op" id="7202235">!=</span>&nbsp;<span class="builtintype" id="7202238">nil</span>&nbsp;<span class="op" id="7202242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202246">t</span><span class="op" id="7202247">.</span><span class="ident" id="7202248">Fatal</span><span class="op" id="7202253">(</span><span class="ident" id="7202254">err</span><span class="op" id="7202257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7202260">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7202263">for</span>&nbsp;<span class="ident" id="7202267">i</span><span class="op" id="7202268">,</span>&nbsp;<span class="ident" id="7202270">wt</span>&nbsp;<span class="op" id="7202273">:=</span>&nbsp;<span class="keyword" id="7202276">range</span>&nbsp;<span class="ident" id="7202282">writeTests</span>&nbsp;<span class="op" id="7202293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202297">testReadFile</span><span class="op" id="7202309">(</span><span class="ident" id="7202310">t</span><span class="op" id="7202311">,</span>&nbsp;<span class="ident" id="7202313">r</span><span class="op" id="7202314">.</span><span class="ident" id="7202315">File</span><span class="op" id="7202319">[</span><span class="ident" id="7202320">i</span><span class="op" id="7202321">]</span><span class="op" id="7202322">,</span>&nbsp;<span class="op" id="7202324">&amp;</span><span class="ident" id="7202325">wt</span><span class="op" id="7202327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7202330">}</span><br>
<span class="lineno"></span><span class="op" id="7202332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7202335">func</span>&nbsp;<span class="ident" id="7202340">TestWriterFlush</span><span class="op" id="7202355">(</span><span class="ident" id="7202356">t</span>&nbsp;<span class="op" id="7202358">*</span><span class="ident" id="7202359">testing</span><span class="op" id="7202366">.</span><span class="ident" id="7202367">T</span><span class="op" id="7202368">)</span>&nbsp;<span class="op" id="7202370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7202373">var</span>&nbsp;<span class="ident" id="7202377">buf</span>&nbsp;<span class="ident" id="7202381">bytes</span><span class="op" id="7202386">.</span><span class="ident" id="7202387">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202395">w</span>&nbsp;<span class="op" id="7202397">:=</span>&nbsp;<span class="ident" id="7202400">NewWriter</span><span class="op" id="7202409">(</span><span class="keyword" id="7202410">struct</span><span class="op" id="7202416">{</span>&nbsp;<span class="ident" id="7202418">io</span><span class="op" id="7202420">.</span><span class="ident" id="7202421">Writer</span>&nbsp;<span class="op" id="7202428">}</span><span class="op" id="7202429">{</span><span class="op" id="7202430">&amp;</span><span class="ident" id="7202431">buf</span><span class="op" id="7202434">}</span><span class="op" id="7202435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202438">_</span><span class="op" id="7202439">,</span>&nbsp;<span class="ident" id="7202441">err</span>&nbsp;<span class="op" id="7202445">:=</span>&nbsp;<span class="ident" id="7202448">w</span><span class="op" id="7202449">.</span><span class="ident" id="7202450">Create</span><span class="op" id="7202456">(</span><span class="string" id="7202457">&#34;foo&#34;</span><span class="op" id="7202462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7202465">if</span>&nbsp;<span class="ident" id="7202468">err</span>&nbsp;<span class="op" id="7202472">!=</span>&nbsp;<span class="builtintype" id="7202475">nil</span>&nbsp;<span class="op" id="7202479">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202483">t</span><span class="op" id="7202484">.</span><span class="ident" id="7202485">Fatal</span><span class="op" id="7202490">(</span><span class="ident" id="7202491">err</span><span class="op" id="7202494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7202497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7202500">if</span>&nbsp;<span class="ident" id="7202503">buf</span><span class="op" id="7202506">.</span><span class="ident" id="7202507">Len</span><span class="op" id="7202510">(</span><span class="op" id="7202511">)</span>&nbsp;<span class="op" id="7202513">&gt;</span>&nbsp;<span class="num" id="7202515">0</span>&nbsp;<span class="op" id="7202517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202521">t</span><span class="op" id="7202522">.</span><span class="ident" id="7202523">Fatalf</span><span class="op" id="7202529">(</span><span class="string" id="7202530">&#34;Unexpected&nbsp;%d&nbsp;bytes&nbsp;already&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="7202569">,</span>&nbsp;<span class="ident" id="7202571">buf</span><span class="op" id="7202574">.</span><span class="ident" id="7202575">Len</span><span class="op" id="7202578">(</span><span class="op" id="7202579">)</span><span class="op" id="7202580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7202583">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7202586">if</span>&nbsp;<span class="ident" id="7202589">err</span>&nbsp;<span class="op" id="7202593">:=</span>&nbsp;<span class="ident" id="7202596">w</span><span class="op" id="7202597">.</span><span class="ident" id="7202598">Flush</span><span class="op" id="7202603">(</span><span class="op" id="7202604">)</span><span class="op" id="7202605">;</span>&nbsp;<span class="ident" id="7202607">err</span>&nbsp;<span class="op" id="7202611">!=</span>&nbsp;<span class="builtintype" id="7202614">nil</span>&nbsp;<span class="op" id="7202618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202622">t</span><span class="op" id="7202623">.</span><span class="ident" id="7202624">Fatal</span><span class="op" id="7202629">(</span><span class="ident" id="7202630">err</span><span class="op" id="7202633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7202636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7202639">if</span>&nbsp;<span class="ident" id="7202642">buf</span><span class="op" id="7202645">.</span><span class="ident" id="7202646">Len</span><span class="op" id="7202649">(</span><span class="op" id="7202650">)</span>&nbsp;<span class="op" id="7202652">==</span>&nbsp;<span class="num" id="7202655">0</span>&nbsp;<span class="op" id="7202657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202661">t</span><span class="op" id="7202662">.</span><span class="ident" id="7202663">Fatal</span><span class="op" id="7202668">(</span><span class="string" id="7202669">&#34;No&nbsp;bytes&nbsp;written&nbsp;after&nbsp;Flush&#34;</span><span class="op" id="7202699">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7202702">}</span><br>
<span class="lineno"></span><span class="op" id="7202704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7202707">func</span>&nbsp;<span class="ident" id="7202712">testCreate</span><span class="op" id="7202722">(</span><span class="ident" id="7202723">t</span>&nbsp;<span class="op" id="7202725">*</span><span class="ident" id="7202726">testing</span><span class="op" id="7202733">.</span><span class="ident" id="7202734">T</span><span class="op" id="7202735">,</span>&nbsp;<span class="ident" id="7202737">w</span>&nbsp;<span class="op" id="7202739">*</span><span class="ident" id="7202740">Writer</span><span class="op" id="7202746">,</span>&nbsp;<span class="ident" id="7202748">wt</span>&nbsp;<span class="op" id="7202751">*</span><span class="ident" id="7202752">WriteTest</span><span class="op" id="7202761">)</span>&nbsp;<span class="op" id="7202763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202766">header</span>&nbsp;<span class="op" id="7202773">:=</span>&nbsp;<span class="op" id="7202776">&amp;</span><span class="ident" id="7202777">FileHeader</span><span class="op" id="7202787">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202791">Name</span><span class="op" id="7202795">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7202799">wt</span><span class="op" id="7202801">.</span><span class="ident" id="7202802">Name</span><span class="op" id="7202806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202810">Method</span><span class="op" id="7202816">:</span>&nbsp;<span class="ident" id="7202818">wt</span><span class="op" id="7202820">.</span><span class="ident" id="7202821">Method</span><span class="op" id="7202827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7202830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7202833">if</span>&nbsp;<span class="ident" id="7202836">wt</span><span class="op" id="7202838">.</span><span class="ident" id="7202839">Mode</span>&nbsp;<span class="op" id="7202844">!=</span>&nbsp;<span class="num" id="7202847">0</span>&nbsp;<span class="op" id="7202849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202853">header</span><span class="op" id="7202859">.</span><span class="ident" id="7202860">SetMode</span><span class="op" id="7202867">(</span><span class="ident" id="7202868">wt</span><span class="op" id="7202870">.</span><span class="ident" id="7202871">Mode</span><span class="op" id="7202875">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7202878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202881">f</span><span class="op" id="7202882">,</span>&nbsp;<span class="ident" id="7202884">err</span>&nbsp;<span class="op" id="7202888">:=</span>&nbsp;<span class="ident" id="7202891">w</span><span class="op" id="7202892">.</span><span class="ident" id="7202893">CreateHeader</span><span class="op" id="7202905">(</span><span class="ident" id="7202906">header</span><span class="op" id="7202912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7202915">if</span>&nbsp;<span class="ident" id="7202918">err</span>&nbsp;<span class="op" id="7202922">!=</span>&nbsp;<span class="builtintype" id="7202925">nil</span>&nbsp;<span class="op" id="7202929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202933">t</span><span class="op" id="7202934">.</span><span class="ident" id="7202935">Fatal</span><span class="op" id="7202940">(</span><span class="ident" id="7202941">err</span><span class="op" id="7202944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7202947">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202950">_</span><span class="op" id="7202951">,</span>&nbsp;<span class="ident" id="7202953">err</span>&nbsp;<span class="op" id="7202957">=</span>&nbsp;<span class="ident" id="7202959">f</span><span class="op" id="7202960">.</span><span class="ident" id="7202961">Write</span><span class="op" id="7202966">(</span><span class="ident" id="7202967">wt</span><span class="op" id="7202969">.</span><span class="ident" id="7202970">Data</span><span class="op" id="7202974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7202977">if</span>&nbsp;<span class="ident" id="7202980">err</span>&nbsp;<span class="op" id="7202984">!=</span>&nbsp;<span class="builtintype" id="7202987">nil</span>&nbsp;<span class="op" id="7202991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7202995">t</span><span class="op" id="7202996">.</span><span class="ident" id="7202997">Fatal</span><span class="op" id="7203002">(</span><span class="ident" id="7203003">err</span><span class="op" id="7203006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7203009">}</span><br>
<span class="lineno"></span><span class="op" id="7203011">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7203014">func</span>&nbsp;<span class="ident" id="7203019">testReadFile</span><span class="op" id="7203031">(</span><span class="ident" id="7203032">t</span>&nbsp;<span class="op" id="7203034">*</span><span class="ident" id="7203035">testing</span><span class="op" id="7203042">.</span><span class="ident" id="7203043">T</span><span class="op" id="7203044">,</span>&nbsp;<span class="ident" id="7203046">f</span>&nbsp;<span class="op" id="7203048">*</span><span class="ident" id="7203049">File</span><span class="op" id="7203053">,</span>&nbsp;<span class="ident" id="7203055">wt</span>&nbsp;<span class="op" id="7203058">*</span><span class="ident" id="7203059">WriteTest</span><span class="op" id="7203068">)</span>&nbsp;<span class="op" id="7203070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7203073">if</span>&nbsp;<span class="ident" id="7203076">f</span><span class="op" id="7203077">.</span><span class="ident" id="7203078">Name</span>&nbsp;<span class="op" id="7203083">!=</span>&nbsp;<span class="ident" id="7203086">wt</span><span class="op" id="7203088">.</span><span class="ident" id="7203089">Name</span>&nbsp;<span class="op" id="7203094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203098">t</span><span class="op" id="7203099">.</span><span class="ident" id="7203100">Fatalf</span><span class="op" id="7203106">(</span><span class="string" id="7203107">&#34;File&nbsp;name:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7203135">,</span>&nbsp;<span class="ident" id="7203137">f</span><span class="op" id="7203138">.</span><span class="ident" id="7203139">Name</span><span class="op" id="7203143">,</span>&nbsp;<span class="ident" id="7203145">wt</span><span class="op" id="7203147">.</span><span class="ident" id="7203148">Name</span><span class="op" id="7203152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7203155">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203158">testFileMode</span><span class="op" id="7203170">(</span><span class="ident" id="7203171">t</span><span class="op" id="7203172">,</span>&nbsp;<span class="ident" id="7203174">wt</span><span class="op" id="7203176">.</span><span class="ident" id="7203177">Name</span><span class="op" id="7203181">,</span>&nbsp;<span class="ident" id="7203183">f</span><span class="op" id="7203184">,</span>&nbsp;<span class="ident" id="7203186">wt</span><span class="op" id="7203188">.</span><span class="ident" id="7203189">Mode</span><span class="op" id="7203193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203196">rc</span><span class="op" id="7203198">,</span>&nbsp;<span class="ident" id="7203200">err</span>&nbsp;<span class="op" id="7203204">:=</span>&nbsp;<span class="ident" id="7203207">f</span><span class="op" id="7203208">.</span><span class="ident" id="7203209">Open</span><span class="op" id="7203213">(</span><span class="op" id="7203214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7203217">if</span>&nbsp;<span class="ident" id="7203220">err</span>&nbsp;<span class="op" id="7203224">!=</span>&nbsp;<span class="builtintype" id="7203227">nil</span>&nbsp;<span class="op" id="7203231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203235">t</span><span class="op" id="7203236">.</span><span class="ident" id="7203237">Fatal</span><span class="op" id="7203242">(</span><span class="string" id="7203243">&#34;opening:&#34;</span><span class="op" id="7203253">,</span>&nbsp;<span class="ident" id="7203255">err</span><span class="op" id="7203258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7203261">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203264">b</span><span class="op" id="7203265">,</span>&nbsp;<span class="ident" id="7203267">err</span>&nbsp;<span class="op" id="7203271">:=</span>&nbsp;<span class="ident" id="7203274">ioutil</span><span class="op" id="7203280">.</span><span class="ident" id="7203281">ReadAll</span><span class="op" id="7203288">(</span><span class="ident" id="7203289">rc</span><span class="op" id="7203291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7203294">if</span>&nbsp;<span class="ident" id="7203297">err</span>&nbsp;<span class="op" id="7203301">!=</span>&nbsp;<span class="builtintype" id="7203304">nil</span>&nbsp;<span class="op" id="7203308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203312">t</span><span class="op" id="7203313">.</span><span class="ident" id="7203314">Fatal</span><span class="op" id="7203319">(</span><span class="string" id="7203320">&#34;reading:&#34;</span><span class="op" id="7203330">,</span>&nbsp;<span class="ident" id="7203332">err</span><span class="op" id="7203335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7203338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203341">err</span>&nbsp;<span class="op" id="7203345">=</span>&nbsp;<span class="ident" id="7203347">rc</span><span class="op" id="7203349">.</span><span class="ident" id="7203350">Close</span><span class="op" id="7203355">(</span><span class="op" id="7203356">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7203359">if</span>&nbsp;<span class="ident" id="7203362">err</span>&nbsp;<span class="op" id="7203366">!=</span>&nbsp;<span class="builtintype" id="7203369">nil</span>&nbsp;<span class="op" id="7203373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203377">t</span><span class="op" id="7203378">.</span><span class="ident" id="7203379">Fatal</span><span class="op" id="7203384">(</span><span class="string" id="7203385">&#34;closing:&#34;</span><span class="op" id="7203395">,</span>&nbsp;<span class="ident" id="7203397">err</span><span class="op" id="7203400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7203403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7203406">if</span>&nbsp;<span class="op" id="7203409">!</span><span class="ident" id="7203410">bytes</span><span class="op" id="7203415">.</span><span class="ident" id="7203416">Equal</span><span class="op" id="7203421">(</span><span class="ident" id="7203422">b</span><span class="op" id="7203423">,</span>&nbsp;<span class="ident" id="7203425">wt</span><span class="op" id="7203427">.</span><span class="ident" id="7203428">Data</span><span class="op" id="7203432">)</span>&nbsp;<span class="op" id="7203434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203438">t</span><span class="op" id="7203439">.</span><span class="ident" id="7203440">Errorf</span><span class="op" id="7203446">(</span><span class="string" id="7203447">&#34;File&nbsp;contents&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7203474">,</span>&nbsp;<span class="ident" id="7203476">b</span><span class="op" id="7203477">,</span>&nbsp;<span class="ident" id="7203479">wt</span><span class="op" id="7203481">.</span><span class="ident" id="7203482">Data</span><span class="op" id="7203486">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7203489">}</span><br>
<span class="lineno"></span><span class="op" id="7203491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7203494">func</span>&nbsp;<span class="ident" id="7203499">BenchmarkCompressedZipGarbage</span><span class="op" id="7203528">(</span><span class="ident" id="7203529">b</span>&nbsp;<span class="op" id="7203531">*</span><span class="ident" id="7203532">testing</span><span class="op" id="7203539">.</span><span class="ident" id="7203540">B</span><span class="op" id="7203541">)</span>&nbsp;<span class="op" id="7203543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203546">b</span><span class="op" id="7203547">.</span><span class="ident" id="7203548">ReportAllocs</span><span class="op" id="7203560">(</span><span class="op" id="7203561">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7203564">var</span>&nbsp;<span class="ident" id="7203568">buf</span>&nbsp;<span class="ident" id="7203572">bytes</span><span class="op" id="7203577">.</span><span class="ident" id="7203578">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203586">bigBuf</span>&nbsp;<span class="op" id="7203593">:=</span>&nbsp;<span class="ident" id="7203596">bytes</span><span class="op" id="7203601">.</span><span class="ident" id="7203602">Repeat</span><span class="op" id="7203608">(</span><span class="op" id="7203609">[</span><span class="op" id="7203610">]</span><span class="builtintype" id="7203611">byte</span><span class="op" id="7203615">(</span><span class="string" id="7203616">&#34;a&#34;</span><span class="op" id="7203619">)</span><span class="op" id="7203620">,</span>&nbsp;<span class="num" id="7203622">1</span><span class="op" id="7203623">&lt;&lt;</span><span class="num" id="7203625">20</span><span class="op" id="7203627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7203630">for</span>&nbsp;<span class="ident" id="7203634">i</span>&nbsp;<span class="op" id="7203636">:=</span>&nbsp;<span class="num" id="7203639">0</span><span class="op" id="7203640">;</span>&nbsp;<span class="ident" id="7203642">i</span>&nbsp;<span class="op" id="7203644">&lt;</span>&nbsp;<span class="ident" id="7203646">b</span><span class="op" id="7203647">.</span><span class="ident" id="7203648">N</span><span class="op" id="7203649">;</span>&nbsp;<span class="ident" id="7203651">i</span><span class="op" id="7203652">++</span>&nbsp;<span class="op" id="7203655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203659">buf</span><span class="op" id="7203662">.</span><span class="ident" id="7203663">Reset</span><span class="op" id="7203668">(</span><span class="op" id="7203669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203673">zw</span>&nbsp;<span class="op" id="7203676">:=</span>&nbsp;<span class="ident" id="7203679">NewWriter</span><span class="op" id="7203688">(</span><span class="op" id="7203689">&amp;</span><span class="ident" id="7203690">buf</span><span class="op" id="7203693">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7203697">for</span>&nbsp;<span class="ident" id="7203701">j</span>&nbsp;<span class="op" id="7203703">:=</span>&nbsp;<span class="num" id="7203706">0</span><span class="op" id="7203707">;</span>&nbsp;<span class="ident" id="7203709">j</span>&nbsp;<span class="op" id="7203711">&lt;</span>&nbsp;<span class="num" id="7203713">3</span><span class="op" id="7203714">;</span>&nbsp;<span class="ident" id="7203716">j</span><span class="op" id="7203717">++</span>&nbsp;<span class="op" id="7203720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203725">w</span><span class="op" id="7203726">,</span>&nbsp;<span class="ident" id="7203728">_</span>&nbsp;<span class="op" id="7203730">:=</span>&nbsp;<span class="ident" id="7203733">zw</span><span class="op" id="7203735">.</span><span class="ident" id="7203736">CreateHeader</span><span class="op" id="7203748">(</span><span class="op" id="7203749">&amp;</span><span class="ident" id="7203750">FileHeader</span><span class="op" id="7203760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203766">Name</span><span class="op" id="7203770">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7203774">&#34;foo&#34;</span><span class="op" id="7203779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203785">Method</span><span class="op" id="7203791">:</span>&nbsp;<span class="ident" id="7203793">Deflate</span><span class="op" id="7203800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7203805">}</span><span class="op" id="7203806">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203811">w</span><span class="op" id="7203812">.</span><span class="ident" id="7203813">Write</span><span class="op" id="7203818">(</span><span class="ident" id="7203819">bigBuf</span><span class="op" id="7203825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7203829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7203833">zw</span><span class="op" id="7203835">.</span><span class="ident" id="7203836">Close</span><span class="op" id="7203841">(</span><span class="op" id="7203842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7203845">}</span><br>
<span class="lineno"></span><span class="op" id="7203847">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
