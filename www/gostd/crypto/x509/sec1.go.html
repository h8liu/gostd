<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3589082">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3589137">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3589191">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3589242">package</span>&nbsp;<span class="ident" id="3589250">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3589256">import</span>&nbsp;<span class="op" id="3589263">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3589266">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3589282">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3589301">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3589318">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3589328">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3589335">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="3589346">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3589349">const</span>&nbsp;<span class="ident" id="3589355">ecPrivKeyVersion</span>&nbsp;<span class="op" id="3589372">=</span>&nbsp;<span class="num" id="3589374">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3589377">//&nbsp;ecPrivateKey&nbsp;reflects&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="3589449">//&nbsp;References:</span><br>
<span class="lineno">20</span><span class="comment" id="3589464">//&nbsp;&nbsp;&nbsp;RFC5915</span><br>
<span class="lineno"></span><span class="comment" id="3589477">//&nbsp;&nbsp;&nbsp;SEC1&nbsp;-&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><span class="comment" id="3589538">//&nbsp;Per&nbsp;RFC5915&nbsp;the&nbsp;NamedCurveOID&nbsp;is&nbsp;marked&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL,&nbsp;however&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3589611">//&nbsp;most&nbsp;cases&nbsp;it&nbsp;is&nbsp;not.</span><br>
<span class="lineno"></span><span class="keyword" id="3589636">type</span>&nbsp;<span class="ident" id="3589641">ecPrivateKey</span>&nbsp;<span class="keyword" id="3589654">struct</span>&nbsp;<span class="op" id="3589661">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589664">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3589678">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589683">PrivateKey</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3589697">[</span><span class="op" id="3589698">]</span><span class="builtintype" id="3589699">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589705">NamedCurveOID</span>&nbsp;<span class="ident" id="3589719">asn1</span><span class="op" id="3589723">.</span><span class="ident" id="3589724">ObjectIdentifier</span>&nbsp;<span class="string" id="3589741">`asn1:&#34;optional,explicit,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589775">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3589789">asn1</span><span class="op" id="3589793">.</span><span class="ident" id="3589794">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3589811">`asn1:&#34;optional,explicit,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3589844">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="3589847">//&nbsp;ParseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="keyword" id="3589922">func</span>&nbsp;<span class="ident" id="3589927">ParseECPrivateKey</span><span class="op" id="3589944">(</span><span class="ident" id="3589945">der</span>&nbsp;<span class="op" id="3589949">[</span><span class="op" id="3589950">]</span><span class="builtintype" id="3589951">byte</span><span class="op" id="3589955">)</span>&nbsp;<span class="op" id="3589957">(</span><span class="ident" id="3589958">key</span>&nbsp;<span class="op" id="3589962">*</span><span class="ident" id="3589963">ecdsa</span><span class="op" id="3589968">.</span><span class="ident" id="3589969">PrivateKey</span><span class="op" id="3589979">,</span>&nbsp;<span class="ident" id="3589981">err</span>&nbsp;<span class="builtintype" id="3589985">error</span><span class="op" id="3589990">)</span>&nbsp;<span class="op" id="3589992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3589995">return</span>&nbsp;<span class="ident" id="3590002">parseECPrivateKey</span><span class="op" id="3590019">(</span><span class="ident" id="3590020">nil</span><span class="op" id="3590023">,</span>&nbsp;<span class="ident" id="3590025">der</span><span class="op" id="3590028">)</span><br>
<span class="lineno"></span><span class="op" id="3590030">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3590033">//&nbsp;MarshalECPrivateKey&nbsp;marshals&nbsp;an&nbsp;EC&nbsp;private&nbsp;key&nbsp;into&nbsp;ASN.1,&nbsp;DER&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="3590107">func</span>&nbsp;<span class="ident" id="3590112">MarshalECPrivateKey</span><span class="op" id="3590131">(</span><span class="ident" id="3590132">key</span>&nbsp;<span class="op" id="3590136">*</span><span class="ident" id="3590137">ecdsa</span><span class="op" id="3590142">.</span><span class="ident" id="3590143">PrivateKey</span><span class="op" id="3590153">)</span>&nbsp;<span class="op" id="3590155">(</span><span class="op" id="3590156">[</span><span class="op" id="3590157">]</span><span class="builtintype" id="3590158">byte</span><span class="op" id="3590162">,</span>&nbsp;<span class="builtintype" id="3590164">error</span><span class="op" id="3590169">)</span>&nbsp;<span class="op" id="3590171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590174">oid</span><span class="op" id="3590177">,</span>&nbsp;<span class="ident" id="3590179">ok</span>&nbsp;<span class="op" id="3590182">:=</span>&nbsp;<span class="ident" id="3590185">oidFromNamedCurve</span><span class="op" id="3590202">(</span><span class="ident" id="3590203">key</span><span class="op" id="3590206">.</span><span class="ident" id="3590207">Curve</span><span class="op" id="3590212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3590215">if</span>&nbsp;<span class="op" id="3590218">!</span><span class="ident" id="3590219">ok</span>&nbsp;<span class="op" id="3590222">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3590226">return</span>&nbsp;<span class="ident" id="3590233">nil</span><span class="op" id="3590236">,</span>&nbsp;<span class="ident" id="3590238">errors</span><span class="op" id="3590244">.</span><span class="ident" id="3590245">New</span><span class="op" id="3590248">(</span><span class="string" id="3590249">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3590279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3590282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3590285">return</span>&nbsp;<span class="ident" id="3590292">asn1</span><span class="op" id="3590296">.</span><span class="ident" id="3590297">Marshal</span><span class="op" id="3590304">(</span><span class="ident" id="3590305">ecPrivateKey</span><span class="op" id="3590317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590321">Version</span><span class="op" id="3590328">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3590336">1</span><span class="op" id="3590337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590341">PrivateKey</span><span class="op" id="3590351">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3590356">key</span><span class="op" id="3590359">.</span><span class="ident" id="3590360">D</span><span class="op" id="3590361">.</span><span class="ident" id="3590362">Bytes</span><span class="op" id="3590367">(</span><span class="op" id="3590368">)</span><span class="op" id="3590369">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590373">NamedCurveOID</span><span class="op" id="3590386">:</span>&nbsp;<span class="ident" id="3590388">oid</span><span class="op" id="3590391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590395">PublicKey</span><span class="op" id="3590404">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3590410">asn1</span><span class="op" id="3590414">.</span><span class="ident" id="3590415">BitString</span><span class="op" id="3590424">{</span><span class="ident" id="3590425">Bytes</span><span class="op" id="3590430">:</span>&nbsp;<span class="ident" id="3590432">elliptic</span><span class="op" id="3590440">.</span><span class="ident" id="3590441">Marshal</span><span class="op" id="3590448">(</span><span class="ident" id="3590449">key</span><span class="op" id="3590452">.</span><span class="ident" id="3590453">Curve</span><span class="op" id="3590458">,</span>&nbsp;<span class="ident" id="3590460">key</span><span class="op" id="3590463">.</span><span class="ident" id="3590464">X</span><span class="op" id="3590465">,</span>&nbsp;<span class="ident" id="3590467">key</span><span class="op" id="3590470">.</span><span class="ident" id="3590471">Y</span><span class="op" id="3590472">)</span><span class="op" id="3590473">}</span><span class="op" id="3590474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3590477">}</span><span class="op" id="3590478">)</span><br>
<span class="lineno"></span><span class="op" id="3590480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="3590483">//&nbsp;parseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="3590558">//&nbsp;The&nbsp;OID&nbsp;for&nbsp;the&nbsp;named&nbsp;curve&nbsp;may&nbsp;be&nbsp;provided&nbsp;from&nbsp;another&nbsp;source&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3590634">//&nbsp;the&nbsp;PKCS8&nbsp;container)&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;provided&nbsp;then&nbsp;use&nbsp;this&nbsp;instead&nbsp;of&nbsp;the&nbsp;OID</span><br>
<span class="lineno"></span><span class="comment" id="3590711">//&nbsp;that&nbsp;may&nbsp;exist&nbsp;in&nbsp;the&nbsp;EC&nbsp;private&nbsp;key&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="3590762">func</span>&nbsp;<span class="ident" id="3590767">parseECPrivateKey</span><span class="op" id="3590784">(</span><span class="ident" id="3590785">namedCurveOID</span>&nbsp;<span class="op" id="3590799">*</span><span class="ident" id="3590800">asn1</span><span class="op" id="3590804">.</span><span class="ident" id="3590805">ObjectIdentifier</span><span class="op" id="3590821">,</span>&nbsp;<span class="ident" id="3590823">der</span>&nbsp;<span class="op" id="3590827">[</span><span class="op" id="3590828">]</span><span class="builtintype" id="3590829">byte</span><span class="op" id="3590833">)</span>&nbsp;<span class="op" id="3590835">(</span><span class="ident" id="3590836">key</span>&nbsp;<span class="op" id="3590840">*</span><span class="ident" id="3590841">ecdsa</span><span class="op" id="3590846">.</span><span class="ident" id="3590847">PrivateKey</span><span class="op" id="3590857">,</span>&nbsp;<span class="ident" id="3590859">err</span>&nbsp;<span class="builtintype" id="3590863">error</span><span class="op" id="3590868">)</span>&nbsp;<span class="op" id="3590870">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3590873">var</span>&nbsp;<span class="ident" id="3590877">privKey</span>&nbsp;<span class="ident" id="3590885">ecPrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3590899">if</span>&nbsp;<span class="ident" id="3590902">_</span><span class="op" id="3590903">,</span>&nbsp;<span class="ident" id="3590905">err</span>&nbsp;<span class="op" id="3590909">:=</span>&nbsp;<span class="ident" id="3590912">asn1</span><span class="op" id="3590916">.</span><span class="ident" id="3590917">Unmarshal</span><span class="op" id="3590926">(</span><span class="ident" id="3590927">der</span><span class="op" id="3590930">,</span>&nbsp;<span class="op" id="3590932">&amp;</span><span class="ident" id="3590933">privKey</span><span class="op" id="3590940">)</span><span class="op" id="3590941">;</span>&nbsp;<span class="ident" id="3590943">err</span>&nbsp;<span class="op" id="3590947">!=</span>&nbsp;<span class="ident" id="3590950">nil</span>&nbsp;<span class="op" id="3590954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3590958">return</span>&nbsp;<span class="ident" id="3590965">nil</span><span class="op" id="3590968">,</span>&nbsp;<span class="ident" id="3590970">errors</span><span class="op" id="3590976">.</span><span class="ident" id="3590977">New</span><span class="op" id="3590980">(</span><span class="string" id="3590981">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key:&nbsp;&#34;</span>&nbsp;<span class="op" id="3591022">+</span>&nbsp;<span class="ident" id="3591024">err</span><span class="op" id="3591027">.</span><span class="ident" id="3591028">Error</span><span class="op" id="3591033">(</span><span class="op" id="3591034">)</span><span class="op" id="3591035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3591038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3591041">if</span>&nbsp;<span class="ident" id="3591044">privKey</span><span class="op" id="3591051">.</span><span class="ident" id="3591052">Version</span>&nbsp;<span class="op" id="3591060">!=</span>&nbsp;<span class="ident" id="3591063">ecPrivKeyVersion</span>&nbsp;<span class="op" id="3591080">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3591084">return</span>&nbsp;<span class="ident" id="3591091">nil</span><span class="op" id="3591094">,</span>&nbsp;<span class="ident" id="3591096">fmt</span><span class="op" id="3591099">.</span><span class="ident" id="3591100">Errorf</span><span class="op" id="3591106">(</span><span class="string" id="3591107">&#34;x509:&nbsp;unknown&nbsp;EC&nbsp;private&nbsp;key&nbsp;version&nbsp;%d&#34;</span><span class="op" id="3591148">,</span>&nbsp;<span class="ident" id="3591150">privKey</span><span class="op" id="3591157">.</span><span class="ident" id="3591158">Version</span><span class="op" id="3591165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3591168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3591172">var</span>&nbsp;<span class="ident" id="3591176">curve</span>&nbsp;<span class="ident" id="3591182">elliptic</span><span class="op" id="3591190">.</span><span class="ident" id="3591191">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3591198">if</span>&nbsp;<span class="ident" id="3591201">namedCurveOID</span>&nbsp;<span class="op" id="3591215">!=</span>&nbsp;<span class="ident" id="3591218">nil</span>&nbsp;<span class="op" id="3591222">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591226">curve</span>&nbsp;<span class="op" id="3591232">=</span>&nbsp;<span class="ident" id="3591234">namedCurveFromOID</span><span class="op" id="3591251">(</span><span class="op" id="3591252">*</span><span class="ident" id="3591253">namedCurveOID</span><span class="op" id="3591266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3591269">}</span>&nbsp;<span class="keyword" id="3591271">else</span>&nbsp;<span class="op" id="3591276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591280">curve</span>&nbsp;<span class="op" id="3591286">=</span>&nbsp;<span class="ident" id="3591288">namedCurveFromOID</span><span class="op" id="3591305">(</span><span class="ident" id="3591306">privKey</span><span class="op" id="3591313">.</span><span class="ident" id="3591314">NamedCurveOID</span><span class="op" id="3591327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3591330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3591333">if</span>&nbsp;<span class="ident" id="3591336">curve</span>&nbsp;<span class="op" id="3591342">==</span>&nbsp;<span class="ident" id="3591345">nil</span>&nbsp;<span class="op" id="3591349">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3591353">return</span>&nbsp;<span class="ident" id="3591360">nil</span><span class="op" id="3591363">,</span>&nbsp;<span class="ident" id="3591365">errors</span><span class="op" id="3591371">.</span><span class="ident" id="3591372">New</span><span class="op" id="3591375">(</span><span class="string" id="3591376">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3591406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3591409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591413">k</span>&nbsp;<span class="op" id="3591415">:=</span>&nbsp;<span class="builtinfunc" id="3591418">new</span><span class="op" id="3591421">(</span><span class="ident" id="3591422">big</span><span class="op" id="3591425">.</span><span class="ident" id="3591426">Int</span><span class="op" id="3591429">)</span><span class="op" id="3591430">.</span><span class="ident" id="3591431">SetBytes</span><span class="op" id="3591439">(</span><span class="ident" id="3591440">privKey</span><span class="op" id="3591447">.</span><span class="ident" id="3591448">PrivateKey</span><span class="op" id="3591458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3591461">if</span>&nbsp;<span class="ident" id="3591464">k</span><span class="op" id="3591465">.</span><span class="ident" id="3591466">Cmp</span><span class="op" id="3591469">(</span><span class="ident" id="3591470">curve</span><span class="op" id="3591475">.</span><span class="ident" id="3591476">Params</span><span class="op" id="3591482">(</span><span class="op" id="3591483">)</span><span class="op" id="3591484">.</span><span class="ident" id="3591485">N</span><span class="op" id="3591486">)</span>&nbsp;<span class="op" id="3591488">&gt;=</span>&nbsp;<span class="num" id="3591491">0</span>&nbsp;<span class="op" id="3591493">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3591497">return</span>&nbsp;<span class="ident" id="3591504">nil</span><span class="op" id="3591507">,</span>&nbsp;<span class="ident" id="3591509">errors</span><span class="op" id="3591515">.</span><span class="ident" id="3591516">New</span><span class="op" id="3591519">(</span><span class="string" id="3591520">&#34;x509:&nbsp;invalid&nbsp;elliptic&nbsp;curve&nbsp;private&nbsp;key&nbsp;value&#34;</span><span class="op" id="3591568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3591571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591574">priv</span>&nbsp;<span class="op" id="3591579">:=</span>&nbsp;<span class="builtinfunc" id="3591582">new</span><span class="op" id="3591585">(</span><span class="ident" id="3591586">ecdsa</span><span class="op" id="3591591">.</span><span class="ident" id="3591592">PrivateKey</span><span class="op" id="3591602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591605">priv</span><span class="op" id="3591609">.</span><span class="ident" id="3591610">Curve</span>&nbsp;<span class="op" id="3591616">=</span>&nbsp;<span class="ident" id="3591618">curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591625">priv</span><span class="op" id="3591629">.</span><span class="ident" id="3591630">D</span>&nbsp;<span class="op" id="3591632">=</span>&nbsp;<span class="ident" id="3591634">k</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591637">priv</span><span class="op" id="3591641">.</span><span class="ident" id="3591642">X</span><span class="op" id="3591643">,</span>&nbsp;<span class="ident" id="3591645">priv</span><span class="op" id="3591649">.</span><span class="ident" id="3591650">Y</span>&nbsp;<span class="op" id="3591652">=</span>&nbsp;<span class="ident" id="3591654">curve</span><span class="op" id="3591659">.</span><span class="ident" id="3591660">ScalarBaseMult</span><span class="op" id="3591674">(</span><span class="ident" id="3591675">privKey</span><span class="op" id="3591682">.</span><span class="ident" id="3591683">PrivateKey</span><span class="op" id="3591693">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3591697">return</span>&nbsp;<span class="ident" id="3591704">priv</span><span class="op" id="3591708">,</span>&nbsp;<span class="ident" id="3591710">nil</span><br>
<span class="lineno"></span><span class="op" id="3591714">}</span>
</div>
</body>
</html>
