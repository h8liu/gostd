<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3407493">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3407548">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3407602">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3407653">package</span>&nbsp;<span class="ident" id="3407661">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3407671">import</span>&nbsp;<span class="op" id="3407678">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3407681">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3407690">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3407697">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3407703">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3407714">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3407725">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3407733">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3407744">&#34;text/template/parse&#34;</span><br>
<span class="lineno"></span><span class="op" id="3407766">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3407769">//&nbsp;state&nbsp;represents&nbsp;the&nbsp;state&nbsp;of&nbsp;an&nbsp;execution.&nbsp;It&#39;s&nbsp;not&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3407837">//&nbsp;template&nbsp;so&nbsp;that&nbsp;multiple&nbsp;executions&nbsp;of&nbsp;the&nbsp;same&nbsp;template</span><br>
<span class="lineno">20</span><span class="comment" id="3407898">//&nbsp;can&nbsp;execute&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="3407926">type</span>&nbsp;<span class="ident" id="3407931">state</span>&nbsp;<span class="keyword" id="3407937">struct</span>&nbsp;<span class="op" id="3407944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407947">tmpl</span>&nbsp;<span class="op" id="3407952">*</span><span class="ident" id="3407953">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407963">wr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3407968">io</span><span class="op" id="3407970">.</span><span class="ident" id="3407971">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3407979">node</span>&nbsp;<span class="ident" id="3407984">parse</span><span class="op" id="3407989">.</span><span class="ident" id="3407990">Node</span>&nbsp;<span class="comment" id="3407995">//&nbsp;current&nbsp;node,&nbsp;for&nbsp;errors</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408024">vars</span>&nbsp;<span class="op" id="3408029">[</span><span class="op" id="3408030">]</span><span class="ident" id="3408031">variable</span>&nbsp;<span class="comment" id="3408040">//&nbsp;push-down&nbsp;stack&nbsp;of&nbsp;variable&nbsp;values.</span><br>
<span class="lineno"></span><span class="op" id="3408079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3408082">//&nbsp;variable&nbsp;holds&nbsp;the&nbsp;dynamic&nbsp;value&nbsp;of&nbsp;a&nbsp;variable&nbsp;such&nbsp;as&nbsp;$,&nbsp;$x&nbsp;etc.</span><br>
<span class="lineno"></span><span class="keyword" id="3408151">type</span>&nbsp;<span class="ident" id="3408156">variable</span>&nbsp;<span class="keyword" id="3408165">struct</span>&nbsp;<span class="op" id="3408172">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408175">name</span>&nbsp;&nbsp;<span class="builtintype" id="3408181">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408189">value</span>&nbsp;<span class="ident" id="3408195">reflect</span><span class="op" id="3408202">.</span><span class="ident" id="3408203">Value</span><br>
<span class="lineno"></span><span class="op" id="3408209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3408212">//&nbsp;push&nbsp;pushes&nbsp;a&nbsp;new&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno">35</span><span class="keyword" id="3408256">func</span>&nbsp;<span class="op" id="3408261">(</span><span class="ident" id="3408262">s</span>&nbsp;<span class="op" id="3408264">*</span><span class="ident" id="3408265">state</span><span class="op" id="3408270">)</span>&nbsp;<span class="ident" id="3408272">push</span><span class="op" id="3408276">(</span><span class="ident" id="3408277">name</span>&nbsp;<span class="builtintype" id="3408282">string</span><span class="op" id="3408288">,</span>&nbsp;<span class="ident" id="3408290">value</span>&nbsp;<span class="ident" id="3408296">reflect</span><span class="op" id="3408303">.</span><span class="ident" id="3408304">Value</span><span class="op" id="3408309">)</span>&nbsp;<span class="op" id="3408311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408314">s</span><span class="op" id="3408315">.</span><span class="ident" id="3408316">vars</span>&nbsp;<span class="op" id="3408321">=</span>&nbsp;<span class="builtinfunc" id="3408323">append</span><span class="op" id="3408329">(</span><span class="ident" id="3408330">s</span><span class="op" id="3408331">.</span><span class="ident" id="3408332">vars</span><span class="op" id="3408336">,</span>&nbsp;<span class="ident" id="3408338">variable</span><span class="op" id="3408346">{</span><span class="ident" id="3408347">name</span><span class="op" id="3408351">,</span>&nbsp;<span class="ident" id="3408353">value</span><span class="op" id="3408358">}</span><span class="op" id="3408359">)</span><br>
<span class="lineno"></span><span class="op" id="3408361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3408364">//&nbsp;mark&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;variable&nbsp;stack.</span><br>
<span class="lineno">40</span><span class="keyword" id="3408414">func</span>&nbsp;<span class="op" id="3408419">(</span><span class="ident" id="3408420">s</span>&nbsp;<span class="op" id="3408422">*</span><span class="ident" id="3408423">state</span><span class="op" id="3408428">)</span>&nbsp;<span class="ident" id="3408430">mark</span><span class="op" id="3408434">(</span><span class="op" id="3408435">)</span>&nbsp;<span class="builtintype" id="3408437">int</span>&nbsp;<span class="op" id="3408441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408444">return</span>&nbsp;<span class="builtinfunc" id="3408451">len</span><span class="op" id="3408454">(</span><span class="ident" id="3408455">s</span><span class="op" id="3408456">.</span><span class="ident" id="3408457">vars</span><span class="op" id="3408461">)</span><br>
<span class="lineno"></span><span class="op" id="3408463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3408466">//&nbsp;pop&nbsp;pops&nbsp;the&nbsp;variable&nbsp;stack&nbsp;up&nbsp;to&nbsp;the&nbsp;mark.</span><br>
<span class="lineno">45</span><span class="keyword" id="3408513">func</span>&nbsp;<span class="op" id="3408518">(</span><span class="ident" id="3408519">s</span>&nbsp;<span class="op" id="3408521">*</span><span class="ident" id="3408522">state</span><span class="op" id="3408527">)</span>&nbsp;<span class="ident" id="3408529">pop</span><span class="op" id="3408532">(</span><span class="ident" id="3408533">mark</span>&nbsp;<span class="builtintype" id="3408538">int</span><span class="op" id="3408541">)</span>&nbsp;<span class="op" id="3408543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408546">s</span><span class="op" id="3408547">.</span><span class="ident" id="3408548">vars</span>&nbsp;<span class="op" id="3408553">=</span>&nbsp;<span class="ident" id="3408555">s</span><span class="op" id="3408556">.</span><span class="ident" id="3408557">vars</span><span class="op" id="3408561">[</span><span class="num" id="3408562">0</span><span class="op" id="3408563">:</span><span class="ident" id="3408564">mark</span><span class="op" id="3408568">]</span><br>
<span class="lineno"></span><span class="op" id="3408570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3408573">//&nbsp;setVar&nbsp;overwrites&nbsp;the&nbsp;top-nth&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.&nbsp;Used&nbsp;by&nbsp;range&nbsp;iterations.</span><br>
<span class="lineno">50</span><span class="keyword" id="3408655">func</span>&nbsp;<span class="op" id="3408660">(</span><span class="ident" id="3408661">s</span>&nbsp;<span class="op" id="3408663">*</span><span class="ident" id="3408664">state</span><span class="op" id="3408669">)</span>&nbsp;<span class="ident" id="3408671">setVar</span><span class="op" id="3408677">(</span><span class="ident" id="3408678">n</span>&nbsp;<span class="builtintype" id="3408680">int</span><span class="op" id="3408683">,</span>&nbsp;<span class="ident" id="3408685">value</span>&nbsp;<span class="ident" id="3408691">reflect</span><span class="op" id="3408698">.</span><span class="ident" id="3408699">Value</span><span class="op" id="3408704">)</span>&nbsp;<span class="op" id="3408706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408709">s</span><span class="op" id="3408710">.</span><span class="ident" id="3408711">vars</span><span class="op" id="3408715">[</span><span class="builtinfunc" id="3408716">len</span><span class="op" id="3408719">(</span><span class="ident" id="3408720">s</span><span class="op" id="3408721">.</span><span class="ident" id="3408722">vars</span><span class="op" id="3408726">)</span><span class="op" id="3408727">-</span><span class="ident" id="3408728">n</span><span class="op" id="3408729">]</span><span class="op" id="3408730">.</span><span class="ident" id="3408731">value</span>&nbsp;<span class="op" id="3408737">=</span>&nbsp;<span class="ident" id="3408739">value</span><br>
<span class="lineno"></span><span class="op" id="3408745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3408748">//&nbsp;varValue&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;named&nbsp;variable.</span><br>
<span class="lineno">55</span><span class="keyword" id="3408801">func</span>&nbsp;<span class="op" id="3408806">(</span><span class="ident" id="3408807">s</span>&nbsp;<span class="op" id="3408809">*</span><span class="ident" id="3408810">state</span><span class="op" id="3408815">)</span>&nbsp;<span class="ident" id="3408817">varValue</span><span class="op" id="3408825">(</span><span class="ident" id="3408826">name</span>&nbsp;<span class="builtintype" id="3408831">string</span><span class="op" id="3408837">)</span>&nbsp;<span class="ident" id="3408839">reflect</span><span class="op" id="3408846">.</span><span class="ident" id="3408847">Value</span>&nbsp;<span class="op" id="3408853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408856">for</span>&nbsp;<span class="ident" id="3408860">i</span>&nbsp;<span class="op" id="3408862">:=</span>&nbsp;<span class="ident" id="3408865">s</span><span class="op" id="3408866">.</span><span class="ident" id="3408867">mark</span><span class="op" id="3408871">(</span><span class="op" id="3408872">)</span>&nbsp;<span class="op" id="3408874">-</span>&nbsp;<span class="num" id="3408876">1</span><span class="op" id="3408877">;</span>&nbsp;<span class="ident" id="3408879">i</span>&nbsp;<span class="op" id="3408881">&gt;=</span>&nbsp;<span class="num" id="3408884">0</span><span class="op" id="3408885">;</span>&nbsp;<span class="ident" id="3408887">i</span><span class="op" id="3408888">--</span>&nbsp;<span class="op" id="3408891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408895">if</span>&nbsp;<span class="ident" id="3408898">s</span><span class="op" id="3408899">.</span><span class="ident" id="3408900">vars</span><span class="op" id="3408904">[</span><span class="ident" id="3408905">i</span><span class="op" id="3408906">]</span><span class="op" id="3408907">.</span><span class="ident" id="3408908">name</span>&nbsp;<span class="op" id="3408913">==</span>&nbsp;<span class="ident" id="3408916">name</span>&nbsp;<span class="op" id="3408921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408926">return</span>&nbsp;<span class="ident" id="3408933">s</span><span class="op" id="3408934">.</span><span class="ident" id="3408935">vars</span><span class="op" id="3408939">[</span><span class="ident" id="3408940">i</span><span class="op" id="3408941">]</span><span class="op" id="3408942">.</span><span class="ident" id="3408943">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3408951">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3408954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3408957">s</span><span class="op" id="3408958">.</span><span class="ident" id="3408959">errorf</span><span class="op" id="3408965">(</span><span class="string" id="3408966">&#34;undefined&nbsp;variable:&nbsp;%s&#34;</span><span class="op" id="3408990">,</span>&nbsp;<span class="ident" id="3408992">name</span><span class="op" id="3408996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3408999">return</span>&nbsp;<span class="ident" id="3409006">zero</span><br>
<span class="lineno"></span><span class="op" id="3409011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="3409014">var</span>&nbsp;<span class="ident" id="3409018">zero</span>&nbsp;<span class="ident" id="3409023">reflect</span><span class="op" id="3409030">.</span><span class="ident" id="3409031">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3409038">//&nbsp;at&nbsp;marks&nbsp;the&nbsp;state&nbsp;to&nbsp;be&nbsp;on&nbsp;node&nbsp;n,&nbsp;for&nbsp;error&nbsp;reporting.</span><br>
<span class="lineno"></span><span class="keyword" id="3409098">func</span>&nbsp;<span class="op" id="3409103">(</span><span class="ident" id="3409104">s</span>&nbsp;<span class="op" id="3409106">*</span><span class="ident" id="3409107">state</span><span class="op" id="3409112">)</span>&nbsp;<span class="ident" id="3409114">at</span><span class="op" id="3409116">(</span><span class="ident" id="3409117">node</span>&nbsp;<span class="ident" id="3409122">parse</span><span class="op" id="3409127">.</span><span class="ident" id="3409128">Node</span><span class="op" id="3409132">)</span>&nbsp;<span class="op" id="3409134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409137">s</span><span class="op" id="3409138">.</span><span class="ident" id="3409139">node</span>&nbsp;<span class="op" id="3409144">=</span>&nbsp;<span class="ident" id="3409146">node</span><br>
<span class="lineno">70</span><span class="op" id="3409151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3409154">//&nbsp;doublePercent&nbsp;returns&nbsp;the&nbsp;string&nbsp;with&nbsp;%&#39;s&nbsp;replaced&nbsp;by&nbsp;%%,&nbsp;if&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="3409229">//&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;used&nbsp;safely&nbsp;inside&nbsp;a&nbsp;Printf&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3409288">func</span>&nbsp;<span class="ident" id="3409293">doublePercent</span><span class="op" id="3409306">(</span><span class="ident" id="3409307">str</span>&nbsp;<span class="builtintype" id="3409311">string</span><span class="op" id="3409317">)</span>&nbsp;<span class="builtintype" id="3409319">string</span>&nbsp;<span class="op" id="3409326">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409329">if</span>&nbsp;<span class="ident" id="3409332">strings</span><span class="op" id="3409339">.</span><span class="ident" id="3409340">Contains</span><span class="op" id="3409348">(</span><span class="ident" id="3409349">str</span><span class="op" id="3409352">,</span>&nbsp;<span class="string" id="3409354">&#34;%&#34;</span><span class="op" id="3409357">)</span>&nbsp;<span class="op" id="3409359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409363">str</span>&nbsp;<span class="op" id="3409367">=</span>&nbsp;<span class="ident" id="3409369">strings</span><span class="op" id="3409376">.</span><span class="ident" id="3409377">Replace</span><span class="op" id="3409384">(</span><span class="ident" id="3409385">str</span><span class="op" id="3409388">,</span>&nbsp;<span class="string" id="3409390">&#34;%&#34;</span><span class="op" id="3409393">,</span>&nbsp;<span class="string" id="3409395">&#34;%%&#34;</span><span class="op" id="3409399">,</span>&nbsp;<span class="op" id="3409401">-</span><span class="num" id="3409402">1</span><span class="op" id="3409403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3409406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409409">return</span>&nbsp;<span class="ident" id="3409416">str</span><br>
<span class="lineno"></span><span class="op" id="3409420">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="3409423">//&nbsp;errorf&nbsp;formats&nbsp;the&nbsp;error&nbsp;and&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="3409478">func</span>&nbsp;<span class="op" id="3409483">(</span><span class="ident" id="3409484">s</span>&nbsp;<span class="op" id="3409486">*</span><span class="ident" id="3409487">state</span><span class="op" id="3409492">)</span>&nbsp;<span class="ident" id="3409494">errorf</span><span class="op" id="3409500">(</span><span class="ident" id="3409501">format</span>&nbsp;<span class="builtintype" id="3409508">string</span><span class="op" id="3409514">,</span>&nbsp;<span class="ident" id="3409516">args</span>&nbsp;<span class="op" id="3409521">...</span><span class="keyword" id="3409524">interface</span><span class="op" id="3409533">{</span><span class="op" id="3409534">}</span><span class="op" id="3409535">)</span>&nbsp;<span class="op" id="3409537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409540">name</span>&nbsp;<span class="op" id="3409545">:=</span>&nbsp;<span class="ident" id="3409548">doublePercent</span><span class="op" id="3409561">(</span><span class="ident" id="3409562">s</span><span class="op" id="3409563">.</span><span class="ident" id="3409564">tmpl</span><span class="op" id="3409568">.</span><span class="ident" id="3409569">Name</span><span class="op" id="3409573">(</span><span class="op" id="3409574">)</span><span class="op" id="3409575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3409578">if</span>&nbsp;<span class="ident" id="3409581">s</span><span class="op" id="3409582">.</span><span class="ident" id="3409583">node</span>&nbsp;<span class="op" id="3409588">==</span>&nbsp;<span class="ident" id="3409591">nil</span>&nbsp;<span class="op" id="3409595">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409599">format</span>&nbsp;<span class="op" id="3409606">=</span>&nbsp;<span class="ident" id="3409608">fmt</span><span class="op" id="3409611">.</span><span class="ident" id="3409612">Sprintf</span><span class="op" id="3409619">(</span><span class="string" id="3409620">&#34;template:&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="3409638">,</span>&nbsp;<span class="ident" id="3409640">name</span><span class="op" id="3409644">,</span>&nbsp;<span class="ident" id="3409646">format</span><span class="op" id="3409652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3409655">}</span>&nbsp;<span class="keyword" id="3409657">else</span>&nbsp;<span class="op" id="3409662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409666">location</span><span class="op" id="3409674">,</span>&nbsp;<span class="ident" id="3409676">context</span>&nbsp;<span class="op" id="3409684">:=</span>&nbsp;<span class="ident" id="3409687">s</span><span class="op" id="3409688">.</span><span class="ident" id="3409689">tmpl</span><span class="op" id="3409693">.</span><span class="ident" id="3409694">ErrorContext</span><span class="op" id="3409706">(</span><span class="ident" id="3409707">s</span><span class="op" id="3409708">.</span><span class="ident" id="3409709">node</span><span class="op" id="3409713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409717">format</span>&nbsp;<span class="op" id="3409724">=</span>&nbsp;<span class="ident" id="3409726">fmt</span><span class="op" id="3409729">.</span><span class="ident" id="3409730">Sprintf</span><span class="op" id="3409737">(</span><span class="string" id="3409738">&#34;template:&nbsp;%s:&nbsp;executing&nbsp;%q&nbsp;at&nbsp;&lt;%s&gt;:&nbsp;%s&#34;</span><span class="op" id="3409778">,</span>&nbsp;<span class="ident" id="3409780">location</span><span class="op" id="3409788">,</span>&nbsp;<span class="ident" id="3409790">name</span><span class="op" id="3409794">,</span>&nbsp;<span class="ident" id="3409796">doublePercent</span><span class="op" id="3409809">(</span><span class="ident" id="3409810">context</span><span class="op" id="3409817">)</span><span class="op" id="3409818">,</span>&nbsp;<span class="ident" id="3409820">format</span><span class="op" id="3409826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3409829">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3409832">panic</span><span class="op" id="3409837">(</span><span class="ident" id="3409838">fmt</span><span class="op" id="3409841">.</span><span class="ident" id="3409842">Errorf</span><span class="op" id="3409848">(</span><span class="ident" id="3409849">format</span><span class="op" id="3409855">,</span>&nbsp;<span class="ident" id="3409857">args</span><span class="op" id="3409861">...</span><span class="op" id="3409864">)</span><span class="op" id="3409865">)</span><br>
<span class="lineno"></span><span class="op" id="3409867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3409870">//&nbsp;errRecover&nbsp;is&nbsp;the&nbsp;handler&nbsp;that&nbsp;turns&nbsp;panics&nbsp;into&nbsp;returns&nbsp;from&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="comment" id="3409943">//&nbsp;level&nbsp;of&nbsp;Parse.</span><br>
<span class="lineno">95</span><span class="keyword" id="3409962">func</span>&nbsp;<span class="ident" id="3409967">errRecover</span><span class="op" id="3409977">(</span><span class="ident" id="3409978">errp</span>&nbsp;<span class="op" id="3409983">*</span><span class="builtintype" id="3409984">error</span><span class="op" id="3409989">)</span>&nbsp;<span class="op" id="3409991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3409994">e</span>&nbsp;<span class="op" id="3409996">:=</span>&nbsp;<span class="builtinfunc" id="3409999">recover</span><span class="op" id="3410006">(</span><span class="op" id="3410007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410010">if</span>&nbsp;<span class="ident" id="3410013">e</span>&nbsp;<span class="op" id="3410015">!=</span>&nbsp;<span class="ident" id="3410018">nil</span>&nbsp;<span class="op" id="3410022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410026">switch</span>&nbsp;<span class="ident" id="3410033">err</span>&nbsp;<span class="op" id="3410037">:=</span>&nbsp;<span class="ident" id="3410040">e</span><span class="op" id="3410041">.</span><span class="op" id="3410042">(</span><span class="keyword" id="3410043">type</span><span class="op" id="3410047">)</span>&nbsp;<span class="op" id="3410049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410053">case</span>&nbsp;<span class="ident" id="3410058">runtime</span><span class="op" id="3410065">.</span><span class="ident" id="3410066">Error</span><span class="op" id="3410071">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3410076">panic</span><span class="op" id="3410081">(</span><span class="ident" id="3410082">e</span><span class="op" id="3410083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410087">case</span>&nbsp;<span class="builtintype" id="3410092">error</span><span class="op" id="3410097">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3410102">*</span><span class="ident" id="3410103">errp</span>&nbsp;<span class="op" id="3410108">=</span>&nbsp;<span class="ident" id="3410110">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410116">default</span><span class="op" id="3410123">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3410128">panic</span><span class="op" id="3410133">(</span><span class="ident" id="3410134">e</span><span class="op" id="3410135">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3410139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3410142">}</span><br>
<span class="lineno"></span><span class="op" id="3410144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3410147">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">110</span><span class="comment" id="3410229">//&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="3410290">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="3410358">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3410431">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="3410453">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno">115</span><span class="keyword" id="3410503">func</span>&nbsp;<span class="op" id="3410508">(</span><span class="ident" id="3410509">t</span>&nbsp;<span class="op" id="3410511">*</span><span class="ident" id="3410512">Template</span><span class="op" id="3410520">)</span>&nbsp;<span class="ident" id="3410522">ExecuteTemplate</span><span class="op" id="3410537">(</span><span class="ident" id="3410538">wr</span>&nbsp;<span class="ident" id="3410541">io</span><span class="op" id="3410543">.</span><span class="ident" id="3410544">Writer</span><span class="op" id="3410550">,</span>&nbsp;<span class="ident" id="3410552">name</span>&nbsp;<span class="builtintype" id="3410557">string</span><span class="op" id="3410563">,</span>&nbsp;<span class="ident" id="3410565">data</span>&nbsp;<span class="keyword" id="3410570">interface</span><span class="op" id="3410579">{</span><span class="op" id="3410580">}</span><span class="op" id="3410581">)</span>&nbsp;<span class="builtintype" id="3410583">error</span>&nbsp;<span class="op" id="3410589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3410592">tmpl</span>&nbsp;<span class="op" id="3410597">:=</span>&nbsp;<span class="ident" id="3410600">t</span><span class="op" id="3410601">.</span><span class="ident" id="3410602">tmpl</span><span class="op" id="3410606">[</span><span class="ident" id="3410607">name</span><span class="op" id="3410611">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410614">if</span>&nbsp;<span class="ident" id="3410617">tmpl</span>&nbsp;<span class="op" id="3410622">==</span>&nbsp;<span class="ident" id="3410625">nil</span>&nbsp;<span class="op" id="3410629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410633">return</span>&nbsp;<span class="ident" id="3410640">fmt</span><span class="op" id="3410643">.</span><span class="ident" id="3410644">Errorf</span><span class="op" id="3410650">(</span><span class="string" id="3410651">&#34;template:&nbsp;no&nbsp;template&nbsp;%q&nbsp;associated&nbsp;with&nbsp;template&nbsp;%q&#34;</span><span class="op" id="3410705">,</span>&nbsp;<span class="ident" id="3410707">name</span><span class="op" id="3410711">,</span>&nbsp;<span class="ident" id="3410713">t</span><span class="op" id="3410714">.</span><span class="ident" id="3410715">name</span><span class="op" id="3410719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3410722">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3410725">return</span>&nbsp;<span class="ident" id="3410732">tmpl</span><span class="op" id="3410736">.</span><span class="ident" id="3410737">Execute</span><span class="op" id="3410744">(</span><span class="ident" id="3410745">wr</span><span class="op" id="3410747">,</span>&nbsp;<span class="ident" id="3410749">data</span><span class="op" id="3410753">)</span><br>
<span class="lineno"></span><span class="op" id="3410755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3410758">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="3410825">//&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">125</span><span class="comment" id="3410857">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="3410925">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3410998">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="3411020">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="3411070">func</span>&nbsp;<span class="op" id="3411075">(</span><span class="ident" id="3411076">t</span>&nbsp;<span class="op" id="3411078">*</span><span class="ident" id="3411079">Template</span><span class="op" id="3411087">)</span>&nbsp;<span class="ident" id="3411089">Execute</span><span class="op" id="3411096">(</span><span class="ident" id="3411097">wr</span>&nbsp;<span class="ident" id="3411100">io</span><span class="op" id="3411102">.</span><span class="ident" id="3411103">Writer</span><span class="op" id="3411109">,</span>&nbsp;<span class="ident" id="3411111">data</span>&nbsp;<span class="keyword" id="3411116">interface</span><span class="op" id="3411125">{</span><span class="op" id="3411126">}</span><span class="op" id="3411127">)</span>&nbsp;<span class="op" id="3411129">(</span><span class="ident" id="3411130">err</span>&nbsp;<span class="builtintype" id="3411134">error</span><span class="op" id="3411139">)</span>&nbsp;<span class="op" id="3411141">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411144">defer</span>&nbsp;<span class="ident" id="3411150">errRecover</span><span class="op" id="3411160">(</span><span class="op" id="3411161">&amp;</span><span class="ident" id="3411162">err</span><span class="op" id="3411165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411168">value</span>&nbsp;<span class="op" id="3411174">:=</span>&nbsp;<span class="ident" id="3411177">reflect</span><span class="op" id="3411184">.</span><span class="ident" id="3411185">ValueOf</span><span class="op" id="3411192">(</span><span class="ident" id="3411193">data</span><span class="op" id="3411197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411200">state</span>&nbsp;<span class="op" id="3411206">:=</span>&nbsp;<span class="op" id="3411209">&amp;</span><span class="ident" id="3411210">state</span><span class="op" id="3411215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411219">tmpl</span><span class="op" id="3411223">:</span>&nbsp;<span class="ident" id="3411225">t</span><span class="op" id="3411226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411230">wr</span><span class="op" id="3411232">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3411236">wr</span><span class="op" id="3411238">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411242">vars</span><span class="op" id="3411246">:</span>&nbsp;<span class="op" id="3411248">[</span><span class="op" id="3411249">]</span><span class="ident" id="3411250">variable</span><span class="op" id="3411258">{</span><span class="op" id="3411259">{</span><span class="string" id="3411260">&#34;$&#34;</span><span class="op" id="3411263">,</span>&nbsp;<span class="ident" id="3411265">value</span><span class="op" id="3411270">}</span><span class="op" id="3411271">}</span><span class="op" id="3411272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3411275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411278">t</span><span class="op" id="3411279">.</span><span class="ident" id="3411280">init</span><span class="op" id="3411284">(</span><span class="op" id="3411285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411288">if</span>&nbsp;<span class="ident" id="3411291">t</span><span class="op" id="3411292">.</span><span class="ident" id="3411293">Tree</span>&nbsp;<span class="op" id="3411298">==</span>&nbsp;<span class="ident" id="3411301">nil</span>&nbsp;<span class="op" id="3411305">||</span>&nbsp;<span class="ident" id="3411308">t</span><span class="op" id="3411309">.</span><span class="ident" id="3411310">Root</span>&nbsp;<span class="op" id="3411315">==</span>&nbsp;<span class="ident" id="3411318">nil</span>&nbsp;<span class="op" id="3411322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411326">var</span>&nbsp;<span class="ident" id="3411330">b</span>&nbsp;<span class="ident" id="3411332">bytes</span><span class="op" id="3411337">.</span><span class="ident" id="3411338">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411347">for</span>&nbsp;<span class="ident" id="3411351">name</span><span class="op" id="3411355">,</span>&nbsp;<span class="ident" id="3411357">tmpl</span>&nbsp;<span class="op" id="3411362">:=</span>&nbsp;<span class="keyword" id="3411365">range</span>&nbsp;<span class="ident" id="3411371">t</span><span class="op" id="3411372">.</span><span class="ident" id="3411373">tmpl</span>&nbsp;<span class="op" id="3411378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411383">if</span>&nbsp;<span class="ident" id="3411386">tmpl</span><span class="op" id="3411390">.</span><span class="ident" id="3411391">Tree</span>&nbsp;<span class="op" id="3411396">==</span>&nbsp;<span class="ident" id="3411399">nil</span>&nbsp;<span class="op" id="3411403">||</span>&nbsp;<span class="ident" id="3411406">tmpl</span><span class="op" id="3411410">.</span><span class="ident" id="3411411">Root</span>&nbsp;<span class="op" id="3411416">==</span>&nbsp;<span class="ident" id="3411419">nil</span>&nbsp;<span class="op" id="3411423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411429">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3411441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411446">if</span>&nbsp;<span class="ident" id="3411449">b</span><span class="op" id="3411450">.</span><span class="ident" id="3411451">Len</span><span class="op" id="3411454">(</span><span class="op" id="3411455">)</span>&nbsp;<span class="op" id="3411457">&gt;</span>&nbsp;<span class="num" id="3411459">0</span>&nbsp;<span class="op" id="3411461">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411467">b</span><span class="op" id="3411468">.</span><span class="ident" id="3411469">WriteString</span><span class="op" id="3411480">(</span><span class="string" id="3411481">&#34;,&nbsp;&#34;</span><span class="op" id="3411485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3411490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411495">fmt</span><span class="op" id="3411498">.</span><span class="ident" id="3411499">Fprintf</span><span class="op" id="3411506">(</span><span class="op" id="3411507">&amp;</span><span class="ident" id="3411508">b</span><span class="op" id="3411509">,</span>&nbsp;<span class="string" id="3411511">&#34;%q&#34;</span><span class="op" id="3411515">,</span>&nbsp;<span class="ident" id="3411517">name</span><span class="op" id="3411521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3411525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411529">var</span>&nbsp;<span class="ident" id="3411533">s</span>&nbsp;<span class="builtintype" id="3411535">string</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411544">if</span>&nbsp;<span class="ident" id="3411547">b</span><span class="op" id="3411548">.</span><span class="ident" id="3411549">Len</span><span class="op" id="3411552">(</span><span class="op" id="3411553">)</span>&nbsp;<span class="op" id="3411555">&gt;</span>&nbsp;<span class="num" id="3411557">0</span>&nbsp;<span class="op" id="3411559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411564">s</span>&nbsp;<span class="op" id="3411566">=</span>&nbsp;<span class="string" id="3411568">&#34;;&nbsp;defined&nbsp;templates&nbsp;are:&nbsp;&#34;</span>&nbsp;<span class="op" id="3411596">+</span>&nbsp;<span class="ident" id="3411598">b</span><span class="op" id="3411599">.</span><span class="ident" id="3411600">String</span><span class="op" id="3411606">(</span><span class="op" id="3411607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3411611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411615">state</span><span class="op" id="3411620">.</span><span class="ident" id="3411621">errorf</span><span class="op" id="3411627">(</span><span class="string" id="3411628">&#34;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;or&nbsp;empty&nbsp;template%s&#34;</span><span class="op" id="3411669">,</span>&nbsp;<span class="ident" id="3411671">t</span><span class="op" id="3411672">.</span><span class="ident" id="3411673">Name</span><span class="op" id="3411677">(</span><span class="op" id="3411678">)</span><span class="op" id="3411679">,</span>&nbsp;<span class="ident" id="3411681">s</span><span class="op" id="3411682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3411685">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411688">state</span><span class="op" id="3411693">.</span><span class="ident" id="3411694">walk</span><span class="op" id="3411698">(</span><span class="ident" id="3411699">value</span><span class="op" id="3411704">,</span>&nbsp;<span class="ident" id="3411706">t</span><span class="op" id="3411707">.</span><span class="ident" id="3411708">Root</span><span class="op" id="3411712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411715">return</span><br>
<span class="lineno"></span><span class="op" id="3411722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3411725">//&nbsp;Walk&nbsp;functions&nbsp;step&nbsp;through&nbsp;the&nbsp;major&nbsp;pieces&nbsp;of&nbsp;the&nbsp;template&nbsp;structure,</span><br>
<span class="lineno">160</span><span class="comment" id="3411800">//&nbsp;generating&nbsp;output&nbsp;as&nbsp;they&nbsp;go.</span><br>
<span class="lineno"></span><span class="keyword" id="3411833">func</span>&nbsp;<span class="op" id="3411838">(</span><span class="ident" id="3411839">s</span>&nbsp;<span class="op" id="3411841">*</span><span class="ident" id="3411842">state</span><span class="op" id="3411847">)</span>&nbsp;<span class="ident" id="3411849">walk</span><span class="op" id="3411853">(</span><span class="ident" id="3411854">dot</span>&nbsp;<span class="ident" id="3411858">reflect</span><span class="op" id="3411865">.</span><span class="ident" id="3411866">Value</span><span class="op" id="3411871">,</span>&nbsp;<span class="ident" id="3411873">node</span>&nbsp;<span class="ident" id="3411878">parse</span><span class="op" id="3411883">.</span><span class="ident" id="3411884">Node</span><span class="op" id="3411888">)</span>&nbsp;<span class="op" id="3411890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3411893">s</span><span class="op" id="3411894">.</span><span class="ident" id="3411895">at</span><span class="op" id="3411897">(</span><span class="ident" id="3411898">node</span><span class="op" id="3411902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411905">switch</span>&nbsp;<span class="ident" id="3411912">node</span>&nbsp;<span class="op" id="3411917">:=</span>&nbsp;<span class="ident" id="3411920">node</span><span class="op" id="3411924">.</span><span class="op" id="3411925">(</span><span class="keyword" id="3411926">type</span><span class="op" id="3411930">)</span>&nbsp;<span class="op" id="3411932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3411935">case</span>&nbsp;<span class="op" id="3411940">*</span><span class="ident" id="3411941">parse</span><span class="op" id="3411946">.</span><span class="ident" id="3411947">ActionNode</span><span class="op" id="3411957">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3411961">//&nbsp;Do&nbsp;not&nbsp;pop&nbsp;variables&nbsp;so&nbsp;they&nbsp;persist&nbsp;until&nbsp;next&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3412019">//&nbsp;Also,&nbsp;if&nbsp;the&nbsp;action&nbsp;declares&nbsp;variables,&nbsp;don&#39;t&nbsp;print&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412088">val</span>&nbsp;<span class="op" id="3412092">:=</span>&nbsp;<span class="ident" id="3412095">s</span><span class="op" id="3412096">.</span><span class="ident" id="3412097">evalPipeline</span><span class="op" id="3412109">(</span><span class="ident" id="3412110">dot</span><span class="op" id="3412113">,</span>&nbsp;<span class="ident" id="3412115">node</span><span class="op" id="3412119">.</span><span class="ident" id="3412120">Pipe</span><span class="op" id="3412124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412128">if</span>&nbsp;<span class="builtinfunc" id="3412131">len</span><span class="op" id="3412134">(</span><span class="ident" id="3412135">node</span><span class="op" id="3412139">.</span><span class="ident" id="3412140">Pipe</span><span class="op" id="3412144">.</span><span class="ident" id="3412145">Decl</span><span class="op" id="3412149">)</span>&nbsp;<span class="op" id="3412151">==</span>&nbsp;<span class="num" id="3412154">0</span>&nbsp;<span class="op" id="3412156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412161">s</span><span class="op" id="3412162">.</span><span class="ident" id="3412163">printValue</span><span class="op" id="3412173">(</span><span class="ident" id="3412174">node</span><span class="op" id="3412178">,</span>&nbsp;<span class="ident" id="3412180">val</span><span class="op" id="3412183">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3412187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412190">case</span>&nbsp;<span class="op" id="3412195">*</span><span class="ident" id="3412196">parse</span><span class="op" id="3412201">.</span><span class="ident" id="3412202">IfNode</span><span class="op" id="3412208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412212">s</span><span class="op" id="3412213">.</span><span class="ident" id="3412214">walkIfOrWith</span><span class="op" id="3412226">(</span><span class="ident" id="3412227">parse</span><span class="op" id="3412232">.</span><span class="ident" id="3412233">NodeIf</span><span class="op" id="3412239">,</span>&nbsp;<span class="ident" id="3412241">dot</span><span class="op" id="3412244">,</span>&nbsp;<span class="ident" id="3412246">node</span><span class="op" id="3412250">.</span><span class="ident" id="3412251">Pipe</span><span class="op" id="3412255">,</span>&nbsp;<span class="ident" id="3412257">node</span><span class="op" id="3412261">.</span><span class="ident" id="3412262">List</span><span class="op" id="3412266">,</span>&nbsp;<span class="ident" id="3412268">node</span><span class="op" id="3412272">.</span><span class="ident" id="3412273">ElseList</span><span class="op" id="3412281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412284">case</span>&nbsp;<span class="op" id="3412289">*</span><span class="ident" id="3412290">parse</span><span class="op" id="3412295">.</span><span class="ident" id="3412296">ListNode</span><span class="op" id="3412304">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412308">for</span>&nbsp;<span class="ident" id="3412312">_</span><span class="op" id="3412313">,</span>&nbsp;<span class="ident" id="3412315">node</span>&nbsp;<span class="op" id="3412320">:=</span>&nbsp;<span class="keyword" id="3412323">range</span>&nbsp;<span class="ident" id="3412329">node</span><span class="op" id="3412333">.</span><span class="ident" id="3412334">Nodes</span>&nbsp;<span class="op" id="3412340">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412345">s</span><span class="op" id="3412346">.</span><span class="ident" id="3412347">walk</span><span class="op" id="3412351">(</span><span class="ident" id="3412352">dot</span><span class="op" id="3412355">,</span>&nbsp;<span class="ident" id="3412357">node</span><span class="op" id="3412361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3412365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412368">case</span>&nbsp;<span class="op" id="3412373">*</span><span class="ident" id="3412374">parse</span><span class="op" id="3412379">.</span><span class="ident" id="3412380">RangeNode</span><span class="op" id="3412389">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412393">s</span><span class="op" id="3412394">.</span><span class="ident" id="3412395">walkRange</span><span class="op" id="3412404">(</span><span class="ident" id="3412405">dot</span><span class="op" id="3412408">,</span>&nbsp;<span class="ident" id="3412410">node</span><span class="op" id="3412414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412417">case</span>&nbsp;<span class="op" id="3412422">*</span><span class="ident" id="3412423">parse</span><span class="op" id="3412428">.</span><span class="ident" id="3412429">TemplateNode</span><span class="op" id="3412441">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412445">s</span><span class="op" id="3412446">.</span><span class="ident" id="3412447">walkTemplate</span><span class="op" id="3412459">(</span><span class="ident" id="3412460">dot</span><span class="op" id="3412463">,</span>&nbsp;<span class="ident" id="3412465">node</span><span class="op" id="3412469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412472">case</span>&nbsp;<span class="op" id="3412477">*</span><span class="ident" id="3412478">parse</span><span class="op" id="3412483">.</span><span class="ident" id="3412484">TextNode</span><span class="op" id="3412492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412496">if</span>&nbsp;<span class="ident" id="3412499">_</span><span class="op" id="3412500">,</span>&nbsp;<span class="ident" id="3412502">err</span>&nbsp;<span class="op" id="3412506">:=</span>&nbsp;<span class="ident" id="3412509">s</span><span class="op" id="3412510">.</span><span class="ident" id="3412511">wr</span><span class="op" id="3412513">.</span><span class="ident" id="3412514">Write</span><span class="op" id="3412519">(</span><span class="ident" id="3412520">node</span><span class="op" id="3412524">.</span><span class="ident" id="3412525">Text</span><span class="op" id="3412529">)</span><span class="op" id="3412530">;</span>&nbsp;<span class="ident" id="3412532">err</span>&nbsp;<span class="op" id="3412536">!=</span>&nbsp;<span class="ident" id="3412539">nil</span>&nbsp;<span class="op" id="3412543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412548">s</span><span class="op" id="3412549">.</span><span class="ident" id="3412550">errorf</span><span class="op" id="3412556">(</span><span class="string" id="3412557">&#34;%s&#34;</span><span class="op" id="3412561">,</span>&nbsp;<span class="ident" id="3412563">err</span><span class="op" id="3412566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3412570">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412573">case</span>&nbsp;<span class="op" id="3412578">*</span><span class="ident" id="3412579">parse</span><span class="op" id="3412584">.</span><span class="ident" id="3412585">WithNode</span><span class="op" id="3412593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412597">s</span><span class="op" id="3412598">.</span><span class="ident" id="3412599">walkIfOrWith</span><span class="op" id="3412611">(</span><span class="ident" id="3412612">parse</span><span class="op" id="3412617">.</span><span class="ident" id="3412618">NodeWith</span><span class="op" id="3412626">,</span>&nbsp;<span class="ident" id="3412628">dot</span><span class="op" id="3412631">,</span>&nbsp;<span class="ident" id="3412633">node</span><span class="op" id="3412637">.</span><span class="ident" id="3412638">Pipe</span><span class="op" id="3412642">,</span>&nbsp;<span class="ident" id="3412644">node</span><span class="op" id="3412648">.</span><span class="ident" id="3412649">List</span><span class="op" id="3412653">,</span>&nbsp;<span class="ident" id="3412655">node</span><span class="op" id="3412659">.</span><span class="ident" id="3412660">ElseList</span><span class="op" id="3412668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412671">default</span><span class="op" id="3412678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3412682">s</span><span class="op" id="3412683">.</span><span class="ident" id="3412684">errorf</span><span class="op" id="3412690">(</span><span class="string" id="3412691">&#34;unknown&nbsp;node:&nbsp;%s&#34;</span><span class="op" id="3412709">,</span>&nbsp;<span class="ident" id="3412711">node</span><span class="op" id="3412715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3412718">}</span><br>
<span class="lineno">190</span><span class="op" id="3412720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3412723">//&nbsp;walkIfOrWith&nbsp;walks&nbsp;an&nbsp;&#39;if&#39;&nbsp;or&nbsp;&#39;with&#39;&nbsp;node.&nbsp;The&nbsp;two&nbsp;control&nbsp;structures</span><br>
<span class="lineno"></span><span class="comment" id="3412796">//&nbsp;are&nbsp;identical&nbsp;in&nbsp;behavior&nbsp;except&nbsp;that&nbsp;&#39;with&#39;&nbsp;sets&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="3412854">func</span>&nbsp;<span class="op" id="3412859">(</span><span class="ident" id="3412860">s</span>&nbsp;<span class="op" id="3412862">*</span><span class="ident" id="3412863">state</span><span class="op" id="3412868">)</span>&nbsp;<span class="ident" id="3412870">walkIfOrWith</span><span class="op" id="3412882">(</span><span class="ident" id="3412883">typ</span>&nbsp;<span class="ident" id="3412887">parse</span><span class="op" id="3412892">.</span><span class="ident" id="3412893">NodeType</span><span class="op" id="3412901">,</span>&nbsp;<span class="ident" id="3412903">dot</span>&nbsp;<span class="ident" id="3412907">reflect</span><span class="op" id="3412914">.</span><span class="ident" id="3412915">Value</span><span class="op" id="3412920">,</span>&nbsp;<span class="ident" id="3412922">pipe</span>&nbsp;<span class="op" id="3412927">*</span><span class="ident" id="3412928">parse</span><span class="op" id="3412933">.</span><span class="ident" id="3412934">PipeNode</span><span class="op" id="3412942">,</span>&nbsp;<span class="ident" id="3412944">list</span><span class="op" id="3412948">,</span>&nbsp;<span class="ident" id="3412950">elseList</span>&nbsp;<span class="op" id="3412959">*</span><span class="ident" id="3412960">parse</span><span class="op" id="3412965">.</span><span class="ident" id="3412966">ListNode</span><span class="op" id="3412974">)</span>&nbsp;<span class="op" id="3412976">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3412979">defer</span>&nbsp;<span class="ident" id="3412985">s</span><span class="op" id="3412986">.</span><span class="ident" id="3412987">pop</span><span class="op" id="3412990">(</span><span class="ident" id="3412991">s</span><span class="op" id="3412992">.</span><span class="ident" id="3412993">mark</span><span class="op" id="3412997">(</span><span class="op" id="3412998">)</span><span class="op" id="3412999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413002">val</span>&nbsp;<span class="op" id="3413006">:=</span>&nbsp;<span class="ident" id="3413009">s</span><span class="op" id="3413010">.</span><span class="ident" id="3413011">evalPipeline</span><span class="op" id="3413023">(</span><span class="ident" id="3413024">dot</span><span class="op" id="3413027">,</span>&nbsp;<span class="ident" id="3413029">pipe</span><span class="op" id="3413033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413036">truth</span><span class="op" id="3413041">,</span>&nbsp;<span class="ident" id="3413043">ok</span>&nbsp;<span class="op" id="3413046">:=</span>&nbsp;<span class="ident" id="3413049">isTrue</span><span class="op" id="3413055">(</span><span class="ident" id="3413056">val</span><span class="op" id="3413059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413062">if</span>&nbsp;<span class="op" id="3413065">!</span><span class="ident" id="3413066">ok</span>&nbsp;<span class="op" id="3413069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413073">s</span><span class="op" id="3413074">.</span><span class="ident" id="3413075">errorf</span><span class="op" id="3413081">(</span><span class="string" id="3413082">&#34;if/with&nbsp;can&#39;t&nbsp;use&nbsp;%v&#34;</span><span class="op" id="3413104">,</span>&nbsp;<span class="ident" id="3413106">val</span><span class="op" id="3413109">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3413112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413115">if</span>&nbsp;<span class="ident" id="3413118">truth</span>&nbsp;<span class="op" id="3413124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413128">if</span>&nbsp;<span class="ident" id="3413131">typ</span>&nbsp;<span class="op" id="3413135">==</span>&nbsp;<span class="ident" id="3413138">parse</span><span class="op" id="3413143">.</span><span class="ident" id="3413144">NodeWith</span>&nbsp;<span class="op" id="3413153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413158">s</span><span class="op" id="3413159">.</span><span class="ident" id="3413160">walk</span><span class="op" id="3413164">(</span><span class="ident" id="3413165">val</span><span class="op" id="3413168">,</span>&nbsp;<span class="ident" id="3413170">list</span><span class="op" id="3413174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3413178">}</span>&nbsp;<span class="keyword" id="3413180">else</span>&nbsp;<span class="op" id="3413185">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413190">s</span><span class="op" id="3413191">.</span><span class="ident" id="3413192">walk</span><span class="op" id="3413196">(</span><span class="ident" id="3413197">dot</span><span class="op" id="3413200">,</span>&nbsp;<span class="ident" id="3413202">list</span><span class="op" id="3413206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3413210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3413213">}</span>&nbsp;<span class="keyword" id="3413215">else</span>&nbsp;<span class="keyword" id="3413220">if</span>&nbsp;<span class="ident" id="3413223">elseList</span>&nbsp;<span class="op" id="3413232">!=</span>&nbsp;<span class="ident" id="3413235">nil</span>&nbsp;<span class="op" id="3413239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413243">s</span><span class="op" id="3413244">.</span><span class="ident" id="3413245">walk</span><span class="op" id="3413249">(</span><span class="ident" id="3413250">dot</span><span class="op" id="3413253">,</span>&nbsp;<span class="ident" id="3413255">elseList</span><span class="op" id="3413263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3413266">}</span><br>
<span class="lineno">210</span><span class="op" id="3413268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3413271">//&nbsp;isTrue&nbsp;reports&nbsp;whether&nbsp;the&nbsp;value&nbsp;is&nbsp;&#39;true&#39;,&nbsp;in&nbsp;the&nbsp;sense&nbsp;of&nbsp;not&nbsp;the&nbsp;zero&nbsp;of&nbsp;its&nbsp;type,</span><br>
<span class="lineno"></span><span class="comment" id="3413360">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;value&nbsp;has&nbsp;a&nbsp;meaningful&nbsp;truth&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="3413415">func</span>&nbsp;<span class="ident" id="3413420">isTrue</span><span class="op" id="3413426">(</span><span class="ident" id="3413427">val</span>&nbsp;<span class="ident" id="3413431">reflect</span><span class="op" id="3413438">.</span><span class="ident" id="3413439">Value</span><span class="op" id="3413444">)</span>&nbsp;<span class="op" id="3413446">(</span><span class="ident" id="3413447">truth</span><span class="op" id="3413452">,</span>&nbsp;<span class="ident" id="3413454">ok</span>&nbsp;<span class="builtintype" id="3413457">bool</span><span class="op" id="3413461">)</span>&nbsp;<span class="op" id="3413463">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413466">if</span>&nbsp;<span class="op" id="3413469">!</span><span class="ident" id="3413470">val</span><span class="op" id="3413473">.</span><span class="ident" id="3413474">IsValid</span><span class="op" id="3413481">(</span><span class="op" id="3413482">)</span>&nbsp;<span class="op" id="3413484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3413488">//&nbsp;Something&nbsp;like&nbsp;var&nbsp;x&nbsp;interface{},&nbsp;never&nbsp;set.&nbsp;It&#39;s&nbsp;a&nbsp;form&nbsp;of&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413558">return</span>&nbsp;<span class="builtintype" id="3413565">false</span><span class="op" id="3413570">,</span>&nbsp;<span class="builtintype" id="3413572">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3413578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413581">switch</span>&nbsp;<span class="ident" id="3413588">val</span><span class="op" id="3413591">.</span><span class="ident" id="3413592">Kind</span><span class="op" id="3413596">(</span><span class="op" id="3413597">)</span>&nbsp;<span class="op" id="3413599">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413602">case</span>&nbsp;<span class="ident" id="3413607">reflect</span><span class="op" id="3413614">.</span><span class="ident" id="3413615">Array</span><span class="op" id="3413620">,</span>&nbsp;<span class="ident" id="3413622">reflect</span><span class="op" id="3413629">.</span><span class="ident" id="3413630">Map</span><span class="op" id="3413633">,</span>&nbsp;<span class="ident" id="3413635">reflect</span><span class="op" id="3413642">.</span><span class="ident" id="3413643">Slice</span><span class="op" id="3413648">,</span>&nbsp;<span class="ident" id="3413650">reflect</span><span class="op" id="3413657">.</span><span class="ident" id="3413658">String</span><span class="op" id="3413664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413668">truth</span>&nbsp;<span class="op" id="3413674">=</span>&nbsp;<span class="ident" id="3413676">val</span><span class="op" id="3413679">.</span><span class="ident" id="3413680">Len</span><span class="op" id="3413683">(</span><span class="op" id="3413684">)</span>&nbsp;<span class="op" id="3413686">&gt;</span>&nbsp;<span class="num" id="3413688">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413691">case</span>&nbsp;<span class="ident" id="3413696">reflect</span><span class="op" id="3413703">.</span><span class="ident" id="3413704">Bool</span><span class="op" id="3413708">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413712">truth</span>&nbsp;<span class="op" id="3413718">=</span>&nbsp;<span class="ident" id="3413720">val</span><span class="op" id="3413723">.</span><span class="ident" id="3413724">Bool</span><span class="op" id="3413728">(</span><span class="op" id="3413729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413732">case</span>&nbsp;<span class="ident" id="3413737">reflect</span><span class="op" id="3413744">.</span><span class="ident" id="3413745">Complex64</span><span class="op" id="3413754">,</span>&nbsp;<span class="ident" id="3413756">reflect</span><span class="op" id="3413763">.</span><span class="ident" id="3413764">Complex128</span><span class="op" id="3413774">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413778">truth</span>&nbsp;<span class="op" id="3413784">=</span>&nbsp;<span class="ident" id="3413786">val</span><span class="op" id="3413789">.</span><span class="ident" id="3413790">Complex</span><span class="op" id="3413797">(</span><span class="op" id="3413798">)</span>&nbsp;<span class="op" id="3413800">!=</span>&nbsp;<span class="num" id="3413803">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413806">case</span>&nbsp;<span class="ident" id="3413811">reflect</span><span class="op" id="3413818">.</span><span class="ident" id="3413819">Chan</span><span class="op" id="3413823">,</span>&nbsp;<span class="ident" id="3413825">reflect</span><span class="op" id="3413832">.</span><span class="ident" id="3413833">Func</span><span class="op" id="3413837">,</span>&nbsp;<span class="ident" id="3413839">reflect</span><span class="op" id="3413846">.</span><span class="ident" id="3413847">Ptr</span><span class="op" id="3413850">,</span>&nbsp;<span class="ident" id="3413852">reflect</span><span class="op" id="3413859">.</span><span class="ident" id="3413860">Interface</span><span class="op" id="3413869">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413873">truth</span>&nbsp;<span class="op" id="3413879">=</span>&nbsp;<span class="op" id="3413881">!</span><span class="ident" id="3413882">val</span><span class="op" id="3413885">.</span><span class="ident" id="3413886">IsNil</span><span class="op" id="3413891">(</span><span class="op" id="3413892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413895">case</span>&nbsp;<span class="ident" id="3413900">reflect</span><span class="op" id="3413907">.</span><span class="ident" id="3413908">Int</span><span class="op" id="3413911">,</span>&nbsp;<span class="ident" id="3413913">reflect</span><span class="op" id="3413920">.</span><span class="ident" id="3413921">Int8</span><span class="op" id="3413925">,</span>&nbsp;<span class="ident" id="3413927">reflect</span><span class="op" id="3413934">.</span><span class="ident" id="3413935">Int16</span><span class="op" id="3413940">,</span>&nbsp;<span class="ident" id="3413942">reflect</span><span class="op" id="3413949">.</span><span class="ident" id="3413950">Int32</span><span class="op" id="3413955">,</span>&nbsp;<span class="ident" id="3413957">reflect</span><span class="op" id="3413964">.</span><span class="ident" id="3413965">Int64</span><span class="op" id="3413970">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3413974">truth</span>&nbsp;<span class="op" id="3413980">=</span>&nbsp;<span class="ident" id="3413982">val</span><span class="op" id="3413985">.</span><span class="ident" id="3413986">Int</span><span class="op" id="3413989">(</span><span class="op" id="3413990">)</span>&nbsp;<span class="op" id="3413992">!=</span>&nbsp;<span class="num" id="3413995">0</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3413998">case</span>&nbsp;<span class="ident" id="3414003">reflect</span><span class="op" id="3414010">.</span><span class="ident" id="3414011">Float32</span><span class="op" id="3414018">,</span>&nbsp;<span class="ident" id="3414020">reflect</span><span class="op" id="3414027">.</span><span class="ident" id="3414028">Float64</span><span class="op" id="3414035">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414039">truth</span>&nbsp;<span class="op" id="3414045">=</span>&nbsp;<span class="ident" id="3414047">val</span><span class="op" id="3414050">.</span><span class="ident" id="3414051">Float</span><span class="op" id="3414056">(</span><span class="op" id="3414057">)</span>&nbsp;<span class="op" id="3414059">!=</span>&nbsp;<span class="num" id="3414062">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414065">case</span>&nbsp;<span class="ident" id="3414070">reflect</span><span class="op" id="3414077">.</span><span class="ident" id="3414078">Uint</span><span class="op" id="3414082">,</span>&nbsp;<span class="ident" id="3414084">reflect</span><span class="op" id="3414091">.</span><span class="ident" id="3414092">Uint8</span><span class="op" id="3414097">,</span>&nbsp;<span class="ident" id="3414099">reflect</span><span class="op" id="3414106">.</span><span class="ident" id="3414107">Uint16</span><span class="op" id="3414113">,</span>&nbsp;<span class="ident" id="3414115">reflect</span><span class="op" id="3414122">.</span><span class="ident" id="3414123">Uint32</span><span class="op" id="3414129">,</span>&nbsp;<span class="ident" id="3414131">reflect</span><span class="op" id="3414138">.</span><span class="ident" id="3414139">Uint64</span><span class="op" id="3414145">,</span>&nbsp;<span class="ident" id="3414147">reflect</span><span class="op" id="3414154">.</span><span class="ident" id="3414155">Uintptr</span><span class="op" id="3414162">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414166">truth</span>&nbsp;<span class="op" id="3414172">=</span>&nbsp;<span class="ident" id="3414174">val</span><span class="op" id="3414177">.</span><span class="ident" id="3414178">Uint</span><span class="op" id="3414182">(</span><span class="op" id="3414183">)</span>&nbsp;<span class="op" id="3414185">!=</span>&nbsp;<span class="num" id="3414188">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414191">case</span>&nbsp;<span class="ident" id="3414196">reflect</span><span class="op" id="3414203">.</span><span class="ident" id="3414204">Struct</span><span class="op" id="3414210">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414214">truth</span>&nbsp;<span class="op" id="3414220">=</span>&nbsp;<span class="builtintype" id="3414222">true</span>&nbsp;<span class="comment" id="3414227">//&nbsp;Struct&nbsp;values&nbsp;are&nbsp;always&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414262">default</span><span class="op" id="3414269">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414273">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3414281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414284">return</span>&nbsp;<span class="ident" id="3414291">truth</span><span class="op" id="3414296">,</span>&nbsp;<span class="builtintype" id="3414298">true</span><br>
<span class="lineno">240</span><span class="op" id="3414303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3414306">func</span>&nbsp;<span class="op" id="3414311">(</span><span class="ident" id="3414312">s</span>&nbsp;<span class="op" id="3414314">*</span><span class="ident" id="3414315">state</span><span class="op" id="3414320">)</span>&nbsp;<span class="ident" id="3414322">walkRange</span><span class="op" id="3414331">(</span><span class="ident" id="3414332">dot</span>&nbsp;<span class="ident" id="3414336">reflect</span><span class="op" id="3414343">.</span><span class="ident" id="3414344">Value</span><span class="op" id="3414349">,</span>&nbsp;<span class="ident" id="3414351">r</span>&nbsp;<span class="op" id="3414353">*</span><span class="ident" id="3414354">parse</span><span class="op" id="3414359">.</span><span class="ident" id="3414360">RangeNode</span><span class="op" id="3414369">)</span>&nbsp;<span class="op" id="3414371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414374">s</span><span class="op" id="3414375">.</span><span class="ident" id="3414376">at</span><span class="op" id="3414378">(</span><span class="ident" id="3414379">r</span><span class="op" id="3414380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414383">defer</span>&nbsp;<span class="ident" id="3414389">s</span><span class="op" id="3414390">.</span><span class="ident" id="3414391">pop</span><span class="op" id="3414394">(</span><span class="ident" id="3414395">s</span><span class="op" id="3414396">.</span><span class="ident" id="3414397">mark</span><span class="op" id="3414401">(</span><span class="op" id="3414402">)</span><span class="op" id="3414403">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414406">val</span><span class="op" id="3414409">,</span>&nbsp;<span class="ident" id="3414411">_</span>&nbsp;<span class="op" id="3414413">:=</span>&nbsp;<span class="ident" id="3414416">indirect</span><span class="op" id="3414424">(</span><span class="ident" id="3414425">s</span><span class="op" id="3414426">.</span><span class="ident" id="3414427">evalPipeline</span><span class="op" id="3414439">(</span><span class="ident" id="3414440">dot</span><span class="op" id="3414443">,</span>&nbsp;<span class="ident" id="3414445">r</span><span class="op" id="3414446">.</span><span class="ident" id="3414447">Pipe</span><span class="op" id="3414451">)</span><span class="op" id="3414452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3414455">//&nbsp;mark&nbsp;top&nbsp;of&nbsp;stack&nbsp;before&nbsp;any&nbsp;variables&nbsp;in&nbsp;the&nbsp;body&nbsp;are&nbsp;pushed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414522">mark</span>&nbsp;<span class="op" id="3414527">:=</span>&nbsp;<span class="ident" id="3414530">s</span><span class="op" id="3414531">.</span><span class="ident" id="3414532">mark</span><span class="op" id="3414536">(</span><span class="op" id="3414537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414540">oneIteration</span>&nbsp;<span class="op" id="3414553">:=</span>&nbsp;<span class="keyword" id="3414556">func</span><span class="op" id="3414560">(</span><span class="ident" id="3414561">index</span><span class="op" id="3414566">,</span>&nbsp;<span class="ident" id="3414568">elem</span>&nbsp;<span class="ident" id="3414573">reflect</span><span class="op" id="3414580">.</span><span class="ident" id="3414581">Value</span><span class="op" id="3414586">)</span>&nbsp;<span class="op" id="3414588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3414592">//&nbsp;Set&nbsp;top&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;second&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;element.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414665">if</span>&nbsp;<span class="builtinfunc" id="3414668">len</span><span class="op" id="3414671">(</span><span class="ident" id="3414672">r</span><span class="op" id="3414673">.</span><span class="ident" id="3414674">Pipe</span><span class="op" id="3414678">.</span><span class="ident" id="3414679">Decl</span><span class="op" id="3414683">)</span>&nbsp;<span class="op" id="3414685">&gt;</span>&nbsp;<span class="num" id="3414687">0</span>&nbsp;<span class="op" id="3414689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414694">s</span><span class="op" id="3414695">.</span><span class="ident" id="3414696">setVar</span><span class="op" id="3414702">(</span><span class="num" id="3414703">1</span><span class="op" id="3414704">,</span>&nbsp;<span class="ident" id="3414706">elem</span><span class="op" id="3414710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3414714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3414718">//&nbsp;Set&nbsp;next&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;first&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;index.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414789">if</span>&nbsp;<span class="builtinfunc" id="3414792">len</span><span class="op" id="3414795">(</span><span class="ident" id="3414796">r</span><span class="op" id="3414797">.</span><span class="ident" id="3414798">Pipe</span><span class="op" id="3414802">.</span><span class="ident" id="3414803">Decl</span><span class="op" id="3414807">)</span>&nbsp;<span class="op" id="3414809">&gt;</span>&nbsp;<span class="num" id="3414811">1</span>&nbsp;<span class="op" id="3414813">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414818">s</span><span class="op" id="3414819">.</span><span class="ident" id="3414820">setVar</span><span class="op" id="3414826">(</span><span class="num" id="3414827">2</span><span class="op" id="3414828">,</span>&nbsp;<span class="ident" id="3414830">index</span><span class="op" id="3414835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3414839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414843">s</span><span class="op" id="3414844">.</span><span class="ident" id="3414845">walk</span><span class="op" id="3414849">(</span><span class="ident" id="3414850">elem</span><span class="op" id="3414854">,</span>&nbsp;<span class="ident" id="3414856">r</span><span class="op" id="3414857">.</span><span class="ident" id="3414858">List</span><span class="op" id="3414862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3414866">s</span><span class="op" id="3414867">.</span><span class="ident" id="3414868">pop</span><span class="op" id="3414871">(</span><span class="ident" id="3414872">mark</span><span class="op" id="3414876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3414879">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414882">switch</span>&nbsp;<span class="ident" id="3414889">val</span><span class="op" id="3414892">.</span><span class="ident" id="3414893">Kind</span><span class="op" id="3414897">(</span><span class="op" id="3414898">)</span>&nbsp;<span class="op" id="3414900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414903">case</span>&nbsp;<span class="ident" id="3414908">reflect</span><span class="op" id="3414915">.</span><span class="ident" id="3414916">Array</span><span class="op" id="3414921">,</span>&nbsp;<span class="ident" id="3414923">reflect</span><span class="op" id="3414930">.</span><span class="ident" id="3414931">Slice</span><span class="op" id="3414936">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414940">if</span>&nbsp;<span class="ident" id="3414943">val</span><span class="op" id="3414946">.</span><span class="ident" id="3414947">Len</span><span class="op" id="3414950">(</span><span class="op" id="3414951">)</span>&nbsp;<span class="op" id="3414953">==</span>&nbsp;<span class="num" id="3414956">0</span>&nbsp;<span class="op" id="3414958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414963">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3414971">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3414975">for</span>&nbsp;<span class="ident" id="3414979">i</span>&nbsp;<span class="op" id="3414981">:=</span>&nbsp;<span class="num" id="3414984">0</span><span class="op" id="3414985">;</span>&nbsp;<span class="ident" id="3414987">i</span>&nbsp;<span class="op" id="3414989">&lt;</span>&nbsp;<span class="ident" id="3414991">val</span><span class="op" id="3414994">.</span><span class="ident" id="3414995">Len</span><span class="op" id="3414998">(</span><span class="op" id="3414999">)</span><span class="op" id="3415000">;</span>&nbsp;<span class="ident" id="3415002">i</span><span class="op" id="3415003">++</span>&nbsp;<span class="op" id="3415006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415011">oneIteration</span><span class="op" id="3415023">(</span><span class="ident" id="3415024">reflect</span><span class="op" id="3415031">.</span><span class="ident" id="3415032">ValueOf</span><span class="op" id="3415039">(</span><span class="ident" id="3415040">i</span><span class="op" id="3415041">)</span><span class="op" id="3415042">,</span>&nbsp;<span class="ident" id="3415044">val</span><span class="op" id="3415047">.</span><span class="ident" id="3415048">Index</span><span class="op" id="3415053">(</span><span class="ident" id="3415054">i</span><span class="op" id="3415055">)</span><span class="op" id="3415056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415064">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415072">case</span>&nbsp;<span class="ident" id="3415077">reflect</span><span class="op" id="3415084">.</span><span class="ident" id="3415085">Map</span><span class="op" id="3415088">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415092">if</span>&nbsp;<span class="ident" id="3415095">val</span><span class="op" id="3415098">.</span><span class="ident" id="3415099">Len</span><span class="op" id="3415102">(</span><span class="op" id="3415103">)</span>&nbsp;<span class="op" id="3415105">==</span>&nbsp;<span class="num" id="3415108">0</span>&nbsp;<span class="op" id="3415110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415115">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415127">for</span>&nbsp;<span class="ident" id="3415131">_</span><span class="op" id="3415132">,</span>&nbsp;<span class="ident" id="3415134">key</span>&nbsp;<span class="op" id="3415138">:=</span>&nbsp;<span class="keyword" id="3415141">range</span>&nbsp;<span class="ident" id="3415147">sortKeys</span><span class="op" id="3415155">(</span><span class="ident" id="3415156">val</span><span class="op" id="3415159">.</span><span class="ident" id="3415160">MapKeys</span><span class="op" id="3415167">(</span><span class="op" id="3415168">)</span><span class="op" id="3415169">)</span>&nbsp;<span class="op" id="3415171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415176">oneIteration</span><span class="op" id="3415188">(</span><span class="ident" id="3415189">key</span><span class="op" id="3415192">,</span>&nbsp;<span class="ident" id="3415194">val</span><span class="op" id="3415197">.</span><span class="ident" id="3415198">MapIndex</span><span class="op" id="3415206">(</span><span class="ident" id="3415207">key</span><span class="op" id="3415210">)</span><span class="op" id="3415211">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415219">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415227">case</span>&nbsp;<span class="ident" id="3415232">reflect</span><span class="op" id="3415239">.</span><span class="ident" id="3415240">Chan</span><span class="op" id="3415244">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415248">if</span>&nbsp;<span class="ident" id="3415251">val</span><span class="op" id="3415254">.</span><span class="ident" id="3415255">IsNil</span><span class="op" id="3415260">(</span><span class="op" id="3415261">)</span>&nbsp;<span class="op" id="3415263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415268">break</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415280">i</span>&nbsp;<span class="op" id="3415282">:=</span>&nbsp;<span class="num" id="3415285">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415289">for</span>&nbsp;<span class="op" id="3415293">;</span>&nbsp;<span class="op" id="3415295">;</span>&nbsp;<span class="ident" id="3415297">i</span><span class="op" id="3415298">++</span>&nbsp;<span class="op" id="3415301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415306">elem</span><span class="op" id="3415310">,</span>&nbsp;<span class="ident" id="3415312">ok</span>&nbsp;<span class="op" id="3415315">:=</span>&nbsp;<span class="ident" id="3415318">val</span><span class="op" id="3415321">.</span><span class="ident" id="3415322">Recv</span><span class="op" id="3415326">(</span><span class="op" id="3415327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415332">if</span>&nbsp;<span class="op" id="3415335">!</span><span class="ident" id="3415336">ok</span>&nbsp;<span class="op" id="3415339">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415345">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415359">oneIteration</span><span class="op" id="3415371">(</span><span class="ident" id="3415372">reflect</span><span class="op" id="3415379">.</span><span class="ident" id="3415380">ValueOf</span><span class="op" id="3415387">(</span><span class="ident" id="3415388">i</span><span class="op" id="3415389">)</span><span class="op" id="3415390">,</span>&nbsp;<span class="ident" id="3415392">elem</span><span class="op" id="3415396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415404">if</span>&nbsp;<span class="ident" id="3415407">i</span>&nbsp;<span class="op" id="3415409">==</span>&nbsp;<span class="num" id="3415412">0</span>&nbsp;<span class="op" id="3415414">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415419">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415431">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415439">case</span>&nbsp;<span class="ident" id="3415444">reflect</span><span class="op" id="3415451">.</span><span class="ident" id="3415452">Invalid</span><span class="op" id="3415459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415463">break</span>&nbsp;<span class="comment" id="3415469">//&nbsp;An&nbsp;invalid&nbsp;value&nbsp;is&nbsp;likely&nbsp;a&nbsp;nil&nbsp;map,&nbsp;etc.&nbsp;and&nbsp;acts&nbsp;like&nbsp;an&nbsp;empty&nbsp;map.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415544">default</span><span class="op" id="3415551">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415555">s</span><span class="op" id="3415556">.</span><span class="ident" id="3415557">errorf</span><span class="op" id="3415563">(</span><span class="string" id="3415564">&#34;range&nbsp;can&#39;t&nbsp;iterate&nbsp;over&nbsp;%v&#34;</span><span class="op" id="3415593">,</span>&nbsp;<span class="ident" id="3415595">val</span><span class="op" id="3415598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415604">if</span>&nbsp;<span class="ident" id="3415607">r</span><span class="op" id="3415608">.</span><span class="ident" id="3415609">ElseList</span>&nbsp;<span class="op" id="3415618">!=</span>&nbsp;<span class="ident" id="3415621">nil</span>&nbsp;<span class="op" id="3415625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415629">s</span><span class="op" id="3415630">.</span><span class="ident" id="3415631">walk</span><span class="op" id="3415635">(</span><span class="ident" id="3415636">dot</span><span class="op" id="3415639">,</span>&nbsp;<span class="ident" id="3415641">r</span><span class="op" id="3415642">.</span><span class="ident" id="3415643">ElseList</span><span class="op" id="3415651">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415654">}</span><br>
<span class="lineno"></span><span class="op" id="3415656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3415659">func</span>&nbsp;<span class="op" id="3415664">(</span><span class="ident" id="3415665">s</span>&nbsp;<span class="op" id="3415667">*</span><span class="ident" id="3415668">state</span><span class="op" id="3415673">)</span>&nbsp;<span class="ident" id="3415675">walkTemplate</span><span class="op" id="3415687">(</span><span class="ident" id="3415688">dot</span>&nbsp;<span class="ident" id="3415692">reflect</span><span class="op" id="3415699">.</span><span class="ident" id="3415700">Value</span><span class="op" id="3415705">,</span>&nbsp;<span class="ident" id="3415707">t</span>&nbsp;<span class="op" id="3415709">*</span><span class="ident" id="3415710">parse</span><span class="op" id="3415715">.</span><span class="ident" id="3415716">TemplateNode</span><span class="op" id="3415728">)</span>&nbsp;<span class="op" id="3415730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415733">s</span><span class="op" id="3415734">.</span><span class="ident" id="3415735">at</span><span class="op" id="3415737">(</span><span class="ident" id="3415738">t</span><span class="op" id="3415739">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415742">tmpl</span>&nbsp;<span class="op" id="3415747">:=</span>&nbsp;<span class="ident" id="3415750">s</span><span class="op" id="3415751">.</span><span class="ident" id="3415752">tmpl</span><span class="op" id="3415756">.</span><span class="ident" id="3415757">tmpl</span><span class="op" id="3415761">[</span><span class="ident" id="3415762">t</span><span class="op" id="3415763">.</span><span class="ident" id="3415764">Name</span><span class="op" id="3415768">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3415771">if</span>&nbsp;<span class="ident" id="3415774">tmpl</span>&nbsp;<span class="op" id="3415779">==</span>&nbsp;<span class="ident" id="3415782">nil</span>&nbsp;<span class="op" id="3415786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415790">s</span><span class="op" id="3415791">.</span><span class="ident" id="3415792">errorf</span><span class="op" id="3415798">(</span><span class="string" id="3415799">&#34;template&nbsp;%q&nbsp;not&nbsp;defined&#34;</span><span class="op" id="3415824">,</span>&nbsp;<span class="ident" id="3415826">t</span><span class="op" id="3415827">.</span><span class="ident" id="3415828">Name</span><span class="op" id="3415832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3415835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3415838">//&nbsp;Variables&nbsp;declared&nbsp;by&nbsp;the&nbsp;pipeline&nbsp;persist.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415886">dot</span>&nbsp;<span class="op" id="3415890">=</span>&nbsp;<span class="ident" id="3415892">s</span><span class="op" id="3415893">.</span><span class="ident" id="3415894">evalPipeline</span><span class="op" id="3415906">(</span><span class="ident" id="3415907">dot</span><span class="op" id="3415910">,</span>&nbsp;<span class="ident" id="3415912">t</span><span class="op" id="3415913">.</span><span class="ident" id="3415914">Pipe</span><span class="op" id="3415918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415921">newState</span>&nbsp;<span class="op" id="3415930">:=</span>&nbsp;<span class="op" id="3415933">*</span><span class="ident" id="3415934">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3415937">newState</span><span class="op" id="3415945">.</span><span class="ident" id="3415946">tmpl</span>&nbsp;<span class="op" id="3415951">=</span>&nbsp;<span class="ident" id="3415953">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3415959">//&nbsp;No&nbsp;dynamic&nbsp;scoping:&nbsp;template&nbsp;invocations&nbsp;inherit&nbsp;no&nbsp;variables.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416026">newState</span><span class="op" id="3416034">.</span><span class="ident" id="3416035">vars</span>&nbsp;<span class="op" id="3416040">=</span>&nbsp;<span class="op" id="3416042">[</span><span class="op" id="3416043">]</span><span class="ident" id="3416044">variable</span><span class="op" id="3416052">{</span><span class="op" id="3416053">{</span><span class="string" id="3416054">&#34;$&#34;</span><span class="op" id="3416057">,</span>&nbsp;<span class="ident" id="3416059">dot</span><span class="op" id="3416062">}</span><span class="op" id="3416063">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416066">newState</span><span class="op" id="3416074">.</span><span class="ident" id="3416075">walk</span><span class="op" id="3416079">(</span><span class="ident" id="3416080">dot</span><span class="op" id="3416083">,</span>&nbsp;<span class="ident" id="3416085">tmpl</span><span class="op" id="3416089">.</span><span class="ident" id="3416090">Root</span><span class="op" id="3416094">)</span><br>
<span class="lineno"></span><span class="op" id="3416096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3416099">//&nbsp;Eval&nbsp;functions&nbsp;evaluate&nbsp;pipelines,&nbsp;commands,&nbsp;and&nbsp;their&nbsp;elements&nbsp;and&nbsp;extract</span><br>
<span class="lineno"></span><span class="comment" id="3416178">//&nbsp;values&nbsp;from&nbsp;the&nbsp;data&nbsp;structure&nbsp;by&nbsp;examining&nbsp;fields,&nbsp;calling&nbsp;methods,&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">320</span><span class="comment" id="3416261">//&nbsp;The&nbsp;printing&nbsp;of&nbsp;those&nbsp;values&nbsp;happens&nbsp;only&nbsp;through&nbsp;walk&nbsp;functions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3416331">//&nbsp;evalPipeline&nbsp;returns&nbsp;the&nbsp;value&nbsp;acquired&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;pipeline.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3416407">//&nbsp;pipeline&nbsp;has&nbsp;a&nbsp;variable&nbsp;declaration,&nbsp;the&nbsp;variable&nbsp;will&nbsp;be&nbsp;pushed&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3416482">//&nbsp;stack.&nbsp;Callers&nbsp;should&nbsp;therefore&nbsp;pop&nbsp;the&nbsp;stack&nbsp;after&nbsp;they&nbsp;are&nbsp;finished</span><br>
<span class="lineno">325</span><span class="comment" id="3416555">//&nbsp;executing&nbsp;commands&nbsp;depending&nbsp;on&nbsp;the&nbsp;pipeline&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="3416610">func</span>&nbsp;<span class="op" id="3416615">(</span><span class="ident" id="3416616">s</span>&nbsp;<span class="op" id="3416618">*</span><span class="ident" id="3416619">state</span><span class="op" id="3416624">)</span>&nbsp;<span class="ident" id="3416626">evalPipeline</span><span class="op" id="3416638">(</span><span class="ident" id="3416639">dot</span>&nbsp;<span class="ident" id="3416643">reflect</span><span class="op" id="3416650">.</span><span class="ident" id="3416651">Value</span><span class="op" id="3416656">,</span>&nbsp;<span class="ident" id="3416658">pipe</span>&nbsp;<span class="op" id="3416663">*</span><span class="ident" id="3416664">parse</span><span class="op" id="3416669">.</span><span class="ident" id="3416670">PipeNode</span><span class="op" id="3416678">)</span>&nbsp;<span class="op" id="3416680">(</span><span class="ident" id="3416681">value</span>&nbsp;<span class="ident" id="3416687">reflect</span><span class="op" id="3416694">.</span><span class="ident" id="3416695">Value</span><span class="op" id="3416700">)</span>&nbsp;<span class="op" id="3416702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416705">if</span>&nbsp;<span class="ident" id="3416708">pipe</span>&nbsp;<span class="op" id="3416713">==</span>&nbsp;<span class="ident" id="3416716">nil</span>&nbsp;<span class="op" id="3416720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416724">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3416732">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416735">s</span><span class="op" id="3416736">.</span><span class="ident" id="3416737">at</span><span class="op" id="3416739">(</span><span class="ident" id="3416740">pipe</span><span class="op" id="3416744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416747">for</span>&nbsp;<span class="ident" id="3416751">_</span><span class="op" id="3416752">,</span>&nbsp;<span class="ident" id="3416754">cmd</span>&nbsp;<span class="op" id="3416758">:=</span>&nbsp;<span class="keyword" id="3416761">range</span>&nbsp;<span class="ident" id="3416767">pipe</span><span class="op" id="3416771">.</span><span class="ident" id="3416772">Cmds</span>&nbsp;<span class="op" id="3416777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3416781">value</span>&nbsp;<span class="op" id="3416787">=</span>&nbsp;<span class="ident" id="3416789">s</span><span class="op" id="3416790">.</span><span class="ident" id="3416791">evalCommand</span><span class="op" id="3416802">(</span><span class="ident" id="3416803">dot</span><span class="op" id="3416806">,</span>&nbsp;<span class="ident" id="3416808">cmd</span><span class="op" id="3416811">,</span>&nbsp;<span class="ident" id="3416813">value</span><span class="op" id="3416818">)</span>&nbsp;<span class="comment" id="3416820">//&nbsp;previous&nbsp;value&nbsp;is&nbsp;this&nbsp;one&#39;s&nbsp;final&nbsp;arg.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3416865">//&nbsp;If&nbsp;the&nbsp;object&nbsp;has&nbsp;type&nbsp;interface{},&nbsp;dig&nbsp;down&nbsp;one&nbsp;level&nbsp;to&nbsp;the&nbsp;thing&nbsp;inside.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3416946">if</span>&nbsp;<span class="ident" id="3416949">value</span><span class="op" id="3416954">.</span><span class="ident" id="3416955">Kind</span><span class="op" id="3416959">(</span><span class="op" id="3416960">)</span>&nbsp;<span class="op" id="3416962">==</span>&nbsp;<span class="ident" id="3416965">reflect</span><span class="op" id="3416972">.</span><span class="ident" id="3416973">Interface</span>&nbsp;<span class="op" id="3416983">&amp;&amp;</span>&nbsp;<span class="ident" id="3416986">value</span><span class="op" id="3416991">.</span><span class="ident" id="3416992">Type</span><span class="op" id="3416996">(</span><span class="op" id="3416997">)</span><span class="op" id="3416998">.</span><span class="ident" id="3416999">NumMethod</span><span class="op" id="3417008">(</span><span class="op" id="3417009">)</span>&nbsp;<span class="op" id="3417011">==</span>&nbsp;<span class="num" id="3417014">0</span>&nbsp;<span class="op" id="3417016">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417021">value</span>&nbsp;<span class="op" id="3417027">=</span>&nbsp;<span class="ident" id="3417029">reflect</span><span class="op" id="3417036">.</span><span class="ident" id="3417037">ValueOf</span><span class="op" id="3417044">(</span><span class="ident" id="3417045">value</span><span class="op" id="3417050">.</span><span class="ident" id="3417051">Interface</span><span class="op" id="3417060">(</span><span class="op" id="3417061">)</span><span class="op" id="3417062">)</span>&nbsp;<span class="comment" id="3417064">//&nbsp;lovely!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3417077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3417080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417083">for</span>&nbsp;<span class="ident" id="3417087">_</span><span class="op" id="3417088">,</span>&nbsp;<span class="ident" id="3417090">variable</span>&nbsp;<span class="op" id="3417099">:=</span>&nbsp;<span class="keyword" id="3417102">range</span>&nbsp;<span class="ident" id="3417108">pipe</span><span class="op" id="3417112">.</span><span class="ident" id="3417113">Decl</span>&nbsp;<span class="op" id="3417118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417122">s</span><span class="op" id="3417123">.</span><span class="ident" id="3417124">push</span><span class="op" id="3417128">(</span><span class="ident" id="3417129">variable</span><span class="op" id="3417137">.</span><span class="ident" id="3417138">Ident</span><span class="op" id="3417143">[</span><span class="num" id="3417144">0</span><span class="op" id="3417145">]</span><span class="op" id="3417146">,</span>&nbsp;<span class="ident" id="3417148">value</span><span class="op" id="3417153">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3417156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417159">return</span>&nbsp;<span class="ident" id="3417166">value</span><br>
<span class="lineno"></span><span class="op" id="3417172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3417175">func</span>&nbsp;<span class="op" id="3417180">(</span><span class="ident" id="3417181">s</span>&nbsp;<span class="op" id="3417183">*</span><span class="ident" id="3417184">state</span><span class="op" id="3417189">)</span>&nbsp;<span class="ident" id="3417191">notAFunction</span><span class="op" id="3417203">(</span><span class="ident" id="3417204">args</span>&nbsp;<span class="op" id="3417209">[</span><span class="op" id="3417210">]</span><span class="ident" id="3417211">parse</span><span class="op" id="3417216">.</span><span class="ident" id="3417217">Node</span><span class="op" id="3417221">,</span>&nbsp;<span class="ident" id="3417223">final</span>&nbsp;<span class="ident" id="3417229">reflect</span><span class="op" id="3417236">.</span><span class="ident" id="3417237">Value</span><span class="op" id="3417242">)</span>&nbsp;<span class="op" id="3417244">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417247">if</span>&nbsp;<span class="builtinfunc" id="3417250">len</span><span class="op" id="3417253">(</span><span class="ident" id="3417254">args</span><span class="op" id="3417258">)</span>&nbsp;<span class="op" id="3417260">&gt;</span>&nbsp;<span class="num" id="3417262">1</span>&nbsp;<span class="op" id="3417264">||</span>&nbsp;<span class="ident" id="3417267">final</span><span class="op" id="3417272">.</span><span class="ident" id="3417273">IsValid</span><span class="op" id="3417280">(</span><span class="op" id="3417281">)</span>&nbsp;<span class="op" id="3417283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417287">s</span><span class="op" id="3417288">.</span><span class="ident" id="3417289">errorf</span><span class="op" id="3417295">(</span><span class="string" id="3417296">&#34;can&#39;t&nbsp;give&nbsp;argument&nbsp;to&nbsp;non-function&nbsp;%s&#34;</span><span class="op" id="3417336">,</span>&nbsp;<span class="ident" id="3417338">args</span><span class="op" id="3417342">[</span><span class="num" id="3417343">0</span><span class="op" id="3417344">]</span><span class="op" id="3417345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3417348">}</span><br>
<span class="lineno"></span><span class="op" id="3417350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3417353">func</span>&nbsp;<span class="op" id="3417358">(</span><span class="ident" id="3417359">s</span>&nbsp;<span class="op" id="3417361">*</span><span class="ident" id="3417362">state</span><span class="op" id="3417367">)</span>&nbsp;<span class="ident" id="3417369">evalCommand</span><span class="op" id="3417380">(</span><span class="ident" id="3417381">dot</span>&nbsp;<span class="ident" id="3417385">reflect</span><span class="op" id="3417392">.</span><span class="ident" id="3417393">Value</span><span class="op" id="3417398">,</span>&nbsp;<span class="ident" id="3417400">cmd</span>&nbsp;<span class="op" id="3417404">*</span><span class="ident" id="3417405">parse</span><span class="op" id="3417410">.</span><span class="ident" id="3417411">CommandNode</span><span class="op" id="3417422">,</span>&nbsp;<span class="ident" id="3417424">final</span>&nbsp;<span class="ident" id="3417430">reflect</span><span class="op" id="3417437">.</span><span class="ident" id="3417438">Value</span><span class="op" id="3417443">)</span>&nbsp;<span class="ident" id="3417445">reflect</span><span class="op" id="3417452">.</span><span class="ident" id="3417453">Value</span>&nbsp;<span class="op" id="3417459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3417462">firstWord</span>&nbsp;<span class="op" id="3417472">:=</span>&nbsp;<span class="ident" id="3417475">cmd</span><span class="op" id="3417478">.</span><span class="ident" id="3417479">Args</span><span class="op" id="3417483">[</span><span class="num" id="3417484">0</span><span class="op" id="3417485">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417488">switch</span>&nbsp;<span class="ident" id="3417495">n</span>&nbsp;<span class="op" id="3417497">:=</span>&nbsp;<span class="ident" id="3417500">firstWord</span><span class="op" id="3417509">.</span><span class="op" id="3417510">(</span><span class="keyword" id="3417511">type</span><span class="op" id="3417515">)</span>&nbsp;<span class="op" id="3417517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417520">case</span>&nbsp;<span class="op" id="3417525">*</span><span class="ident" id="3417526">parse</span><span class="op" id="3417531">.</span><span class="ident" id="3417532">FieldNode</span><span class="op" id="3417541">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417545">return</span>&nbsp;<span class="ident" id="3417552">s</span><span class="op" id="3417553">.</span><span class="ident" id="3417554">evalFieldNode</span><span class="op" id="3417567">(</span><span class="ident" id="3417568">dot</span><span class="op" id="3417571">,</span>&nbsp;<span class="ident" id="3417573">n</span><span class="op" id="3417574">,</span>&nbsp;<span class="ident" id="3417576">cmd</span><span class="op" id="3417579">.</span><span class="ident" id="3417580">Args</span><span class="op" id="3417584">,</span>&nbsp;<span class="ident" id="3417586">final</span><span class="op" id="3417591">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417594">case</span>&nbsp;<span class="op" id="3417599">*</span><span class="ident" id="3417600">parse</span><span class="op" id="3417605">.</span><span class="ident" id="3417606">ChainNode</span><span class="op" id="3417615">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417619">return</span>&nbsp;<span class="ident" id="3417626">s</span><span class="op" id="3417627">.</span><span class="ident" id="3417628">evalChainNode</span><span class="op" id="3417641">(</span><span class="ident" id="3417642">dot</span><span class="op" id="3417645">,</span>&nbsp;<span class="ident" id="3417647">n</span><span class="op" id="3417648">,</span>&nbsp;<span class="ident" id="3417650">cmd</span><span class="op" id="3417653">.</span><span class="ident" id="3417654">Args</span><span class="op" id="3417658">,</span>&nbsp;<span class="ident" id="3417660">final</span><span class="op" id="3417665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417668">case</span>&nbsp;<span class="op" id="3417673">*</span><span class="ident" id="3417674">parse</span><span class="op" id="3417679">.</span><span class="ident" id="3417680">IdentifierNode</span><span class="op" id="3417694">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3417698">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417723">return</span>&nbsp;<span class="ident" id="3417730">s</span><span class="op" id="3417731">.</span><span class="ident" id="3417732">evalFunction</span><span class="op" id="3417744">(</span><span class="ident" id="3417745">dot</span><span class="op" id="3417748">,</span>&nbsp;<span class="ident" id="3417750">n</span><span class="op" id="3417751">,</span>&nbsp;<span class="ident" id="3417753">cmd</span><span class="op" id="3417756">,</span>&nbsp;<span class="ident" id="3417758">cmd</span><span class="op" id="3417761">.</span><span class="ident" id="3417762">Args</span><span class="op" id="3417766">,</span>&nbsp;<span class="ident" id="3417768">final</span><span class="op" id="3417773">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417776">case</span>&nbsp;<span class="op" id="3417781">*</span><span class="ident" id="3417782">parse</span><span class="op" id="3417787">.</span><span class="ident" id="3417788">PipeNode</span><span class="op" id="3417796">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3417800">//&nbsp;Parenthesized&nbsp;pipeline.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;all&nbsp;inside&nbsp;the&nbsp;pipeline;&nbsp;final&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417890">return</span>&nbsp;<span class="ident" id="3417897">s</span><span class="op" id="3417898">.</span><span class="ident" id="3417899">evalPipeline</span><span class="op" id="3417911">(</span><span class="ident" id="3417912">dot</span><span class="op" id="3417915">,</span>&nbsp;<span class="ident" id="3417917">n</span><span class="op" id="3417918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417921">case</span>&nbsp;<span class="op" id="3417926">*</span><span class="ident" id="3417927">parse</span><span class="op" id="3417932">.</span><span class="ident" id="3417933">VariableNode</span><span class="op" id="3417945">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3417949">return</span>&nbsp;<span class="ident" id="3417956">s</span><span class="op" id="3417957">.</span><span class="ident" id="3417958">evalVariableNode</span><span class="op" id="3417974">(</span><span class="ident" id="3417975">dot</span><span class="op" id="3417978">,</span>&nbsp;<span class="ident" id="3417980">n</span><span class="op" id="3417981">,</span>&nbsp;<span class="ident" id="3417983">cmd</span><span class="op" id="3417986">.</span><span class="ident" id="3417987">Args</span><span class="op" id="3417991">,</span>&nbsp;<span class="ident" id="3417993">final</span><span class="op" id="3417998">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3418001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418004">s</span><span class="op" id="3418005">.</span><span class="ident" id="3418006">at</span><span class="op" id="3418008">(</span><span class="ident" id="3418009">firstWord</span><span class="op" id="3418018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418021">s</span><span class="op" id="3418022">.</span><span class="ident" id="3418023">notAFunction</span><span class="op" id="3418035">(</span><span class="ident" id="3418036">cmd</span><span class="op" id="3418039">.</span><span class="ident" id="3418040">Args</span><span class="op" id="3418044">,</span>&nbsp;<span class="ident" id="3418046">final</span><span class="op" id="3418051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418054">switch</span>&nbsp;<span class="ident" id="3418061">word</span>&nbsp;<span class="op" id="3418066">:=</span>&nbsp;<span class="ident" id="3418069">firstWord</span><span class="op" id="3418078">.</span><span class="op" id="3418079">(</span><span class="keyword" id="3418080">type</span><span class="op" id="3418084">)</span>&nbsp;<span class="op" id="3418086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418089">case</span>&nbsp;<span class="op" id="3418094">*</span><span class="ident" id="3418095">parse</span><span class="op" id="3418100">.</span><span class="ident" id="3418101">BoolNode</span><span class="op" id="3418109">:</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418113">return</span>&nbsp;<span class="ident" id="3418120">reflect</span><span class="op" id="3418127">.</span><span class="ident" id="3418128">ValueOf</span><span class="op" id="3418135">(</span><span class="ident" id="3418136">word</span><span class="op" id="3418140">.</span><span class="ident" id="3418141">True</span><span class="op" id="3418145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418148">case</span>&nbsp;<span class="op" id="3418153">*</span><span class="ident" id="3418154">parse</span><span class="op" id="3418159">.</span><span class="ident" id="3418160">DotNode</span><span class="op" id="3418167">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418171">return</span>&nbsp;<span class="ident" id="3418178">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418183">case</span>&nbsp;<span class="op" id="3418188">*</span><span class="ident" id="3418189">parse</span><span class="op" id="3418194">.</span><span class="ident" id="3418195">NilNode</span><span class="op" id="3418202">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418206">s</span><span class="op" id="3418207">.</span><span class="ident" id="3418208">errorf</span><span class="op" id="3418214">(</span><span class="string" id="3418215">&#34;nil&nbsp;is&nbsp;not&nbsp;a&nbsp;command&#34;</span><span class="op" id="3418237">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418240">case</span>&nbsp;<span class="op" id="3418245">*</span><span class="ident" id="3418246">parse</span><span class="op" id="3418251">.</span><span class="ident" id="3418252">NumberNode</span><span class="op" id="3418262">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418266">return</span>&nbsp;<span class="ident" id="3418273">s</span><span class="op" id="3418274">.</span><span class="ident" id="3418275">idealConstant</span><span class="op" id="3418288">(</span><span class="ident" id="3418289">word</span><span class="op" id="3418293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418296">case</span>&nbsp;<span class="op" id="3418301">*</span><span class="ident" id="3418302">parse</span><span class="op" id="3418307">.</span><span class="ident" id="3418308">StringNode</span><span class="op" id="3418318">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3418322">return</span>&nbsp;<span class="ident" id="3418329">reflect</span><span class="op" id="3418336">.</span><span class="ident" id="3418337">ValueOf</span><span class="op" id="3418344">(</span><span class="ident" id="3418345">word</span><span class="op" id="3418349">.</span><span class="ident" id="3418350">Text</span><span class="op" id="3418354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3418357">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418360">s</span><span class="op" id="3418361">.</span><span class="ident" id="3418362">errorf</span><span class="op" id="3418368">(</span><span class="string" id="3418369">&#34;can&#39;t&nbsp;evaluate&nbsp;command&nbsp;%q&#34;</span><span class="op" id="3418396">,</span>&nbsp;<span class="ident" id="3418398">firstWord</span><span class="op" id="3418407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3418410">panic</span><span class="op" id="3418415">(</span><span class="string" id="3418416">&#34;not&nbsp;reached&#34;</span><span class="op" id="3418429">)</span><br>
<span class="lineno"></span><span class="op" id="3418431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3418434">//&nbsp;idealConstant&nbsp;is&nbsp;called&nbsp;to&nbsp;return&nbsp;the&nbsp;value&nbsp;of&nbsp;a&nbsp;number&nbsp;in&nbsp;a&nbsp;context&nbsp;where</span><br>
<span class="lineno">385</span><span class="comment" id="3418512">//&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;syntax&nbsp;of&nbsp;the&nbsp;number&nbsp;tells&nbsp;us</span><br>
<span class="lineno"></span><span class="comment" id="3418587">//&nbsp;its&nbsp;type,&nbsp;and&nbsp;we&nbsp;use&nbsp;Go&nbsp;rules&nbsp;to&nbsp;resolve.&nbsp;&nbsp;Note&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;thing&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3418664">//&nbsp;a&nbsp;uint&nbsp;ideal&nbsp;constant&nbsp;in&nbsp;this&nbsp;situation&nbsp;-&nbsp;the&nbsp;value&nbsp;must&nbsp;be&nbsp;of&nbsp;int&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3418740">func</span>&nbsp;<span class="op" id="3418745">(</span><span class="ident" id="3418746">s</span>&nbsp;<span class="op" id="3418748">*</span><span class="ident" id="3418749">state</span><span class="op" id="3418754">)</span>&nbsp;<span class="ident" id="3418756">idealConstant</span><span class="op" id="3418769">(</span><span class="ident" id="3418770">constant</span>&nbsp;<span class="op" id="3418779">*</span><span class="ident" id="3418780">parse</span><span class="op" id="3418785">.</span><span class="ident" id="3418786">NumberNode</span><span class="op" id="3418796">)</span>&nbsp;<span class="ident" id="3418798">reflect</span><span class="op" id="3418805">.</span><span class="ident" id="3418806">Value</span>&nbsp;<span class="op" id="3418812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3418815">//&nbsp;These&nbsp;are&nbsp;ideal&nbsp;constants&nbsp;but&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3418872">//&nbsp;and&nbsp;we&nbsp;have&nbsp;no&nbsp;context.&nbsp;&nbsp;(If&nbsp;it&nbsp;was&nbsp;a&nbsp;method&nbsp;argument,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3418931">//&nbsp;we&#39;d&nbsp;know&nbsp;what&nbsp;we&nbsp;need.)&nbsp;The&nbsp;syntax&nbsp;guides&nbsp;us&nbsp;to&nbsp;some&nbsp;extent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3418997">s</span><span class="op" id="3418998">.</span><span class="ident" id="3418999">at</span><span class="op" id="3419001">(</span><span class="ident" id="3419002">constant</span><span class="op" id="3419010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419013">switch</span>&nbsp;<span class="op" id="3419020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419023">case</span>&nbsp;<span class="ident" id="3419028">constant</span><span class="op" id="3419036">.</span><span class="ident" id="3419037">IsComplex</span><span class="op" id="3419046">:</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419050">return</span>&nbsp;<span class="ident" id="3419057">reflect</span><span class="op" id="3419064">.</span><span class="ident" id="3419065">ValueOf</span><span class="op" id="3419072">(</span><span class="ident" id="3419073">constant</span><span class="op" id="3419081">.</span><span class="ident" id="3419082">Complex128</span><span class="op" id="3419092">)</span>&nbsp;<span class="comment" id="3419094">//&nbsp;incontrovertible.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419116">case</span>&nbsp;<span class="ident" id="3419121">constant</span><span class="op" id="3419129">.</span><span class="ident" id="3419130">IsFloat</span>&nbsp;<span class="op" id="3419138">&amp;&amp;</span>&nbsp;<span class="op" id="3419141">!</span><span class="ident" id="3419142">isHexConstant</span><span class="op" id="3419155">(</span><span class="ident" id="3419156">constant</span><span class="op" id="3419164">.</span><span class="ident" id="3419165">Text</span><span class="op" id="3419169">)</span>&nbsp;<span class="op" id="3419171">&amp;&amp;</span>&nbsp;<span class="ident" id="3419174">strings</span><span class="op" id="3419181">.</span><span class="ident" id="3419182">IndexAny</span><span class="op" id="3419190">(</span><span class="ident" id="3419191">constant</span><span class="op" id="3419199">.</span><span class="ident" id="3419200">Text</span><span class="op" id="3419204">,</span>&nbsp;<span class="string" id="3419206">&#34;.eE&#34;</span><span class="op" id="3419211">)</span>&nbsp;<span class="op" id="3419213">&gt;=</span>&nbsp;<span class="num" id="3419216">0</span><span class="op" id="3419217">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419221">return</span>&nbsp;<span class="ident" id="3419228">reflect</span><span class="op" id="3419235">.</span><span class="ident" id="3419236">ValueOf</span><span class="op" id="3419243">(</span><span class="ident" id="3419244">constant</span><span class="op" id="3419252">.</span><span class="ident" id="3419253">Float64</span><span class="op" id="3419260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419263">case</span>&nbsp;<span class="ident" id="3419268">constant</span><span class="op" id="3419276">.</span><span class="ident" id="3419277">IsInt</span><span class="op" id="3419282">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419286">n</span>&nbsp;<span class="op" id="3419288">:=</span>&nbsp;<span class="builtintype" id="3419291">int</span><span class="op" id="3419294">(</span><span class="ident" id="3419295">constant</span><span class="op" id="3419303">.</span><span class="ident" id="3419304">Int64</span><span class="op" id="3419309">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419313">if</span>&nbsp;<span class="ident" id="3419316">int64</span><span class="op" id="3419321">(</span><span class="ident" id="3419322">n</span><span class="op" id="3419323">)</span>&nbsp;<span class="op" id="3419325">!=</span>&nbsp;<span class="ident" id="3419328">constant</span><span class="op" id="3419336">.</span><span class="ident" id="3419337">Int64</span>&nbsp;<span class="op" id="3419343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419348">s</span><span class="op" id="3419349">.</span><span class="ident" id="3419350">errorf</span><span class="op" id="3419356">(</span><span class="string" id="3419357">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="3419375">,</span>&nbsp;<span class="ident" id="3419377">constant</span><span class="op" id="3419385">.</span><span class="ident" id="3419386">Text</span><span class="op" id="3419390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3419394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419398">return</span>&nbsp;<span class="ident" id="3419405">reflect</span><span class="op" id="3419412">.</span><span class="ident" id="3419413">ValueOf</span><span class="op" id="3419420">(</span><span class="ident" id="3419421">n</span><span class="op" id="3419422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419425">case</span>&nbsp;<span class="ident" id="3419430">constant</span><span class="op" id="3419438">.</span><span class="ident" id="3419439">IsUint</span><span class="op" id="3419445">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419449">s</span><span class="op" id="3419450">.</span><span class="ident" id="3419451">errorf</span><span class="op" id="3419457">(</span><span class="string" id="3419458">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="3419476">,</span>&nbsp;<span class="ident" id="3419478">constant</span><span class="op" id="3419486">.</span><span class="ident" id="3419487">Text</span><span class="op" id="3419491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3419494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419497">return</span>&nbsp;<span class="ident" id="3419504">zero</span><br>
<span class="lineno"></span><span class="op" id="3419509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="3419512">func</span>&nbsp;<span class="ident" id="3419517">isHexConstant</span><span class="op" id="3419530">(</span><span class="ident" id="3419531">s</span>&nbsp;<span class="builtintype" id="3419533">string</span><span class="op" id="3419539">)</span>&nbsp;<span class="builtintype" id="3419541">bool</span>&nbsp;<span class="op" id="3419546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419549">return</span>&nbsp;<span class="builtinfunc" id="3419556">len</span><span class="op" id="3419559">(</span><span class="ident" id="3419560">s</span><span class="op" id="3419561">)</span>&nbsp;<span class="op" id="3419563">&gt;</span>&nbsp;<span class="num" id="3419565">2</span>&nbsp;<span class="op" id="3419567">&amp;&amp;</span>&nbsp;<span class="ident" id="3419570">s</span><span class="op" id="3419571">[</span><span class="num" id="3419572">0</span><span class="op" id="3419573">]</span>&nbsp;<span class="op" id="3419575">==</span>&nbsp;<span class="string" id="3419578">&#39;0&#39;</span>&nbsp;<span class="op" id="3419582">&amp;&amp;</span>&nbsp;<span class="op" id="3419585">(</span><span class="ident" id="3419586">s</span><span class="op" id="3419587">[</span><span class="num" id="3419588">1</span><span class="op" id="3419589">]</span>&nbsp;<span class="op" id="3419591">==</span>&nbsp;<span class="string" id="3419594">&#39;x&#39;</span>&nbsp;<span class="op" id="3419598">||</span>&nbsp;<span class="ident" id="3419601">s</span><span class="op" id="3419602">[</span><span class="num" id="3419603">1</span><span class="op" id="3419604">]</span>&nbsp;<span class="op" id="3419606">==</span>&nbsp;<span class="string" id="3419609">&#39;X&#39;</span><span class="op" id="3419612">)</span><br>
<span class="lineno"></span><span class="op" id="3419614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3419617">func</span>&nbsp;<span class="op" id="3419622">(</span><span class="ident" id="3419623">s</span>&nbsp;<span class="op" id="3419625">*</span><span class="ident" id="3419626">state</span><span class="op" id="3419631">)</span>&nbsp;<span class="ident" id="3419633">evalFieldNode</span><span class="op" id="3419646">(</span><span class="ident" id="3419647">dot</span>&nbsp;<span class="ident" id="3419651">reflect</span><span class="op" id="3419658">.</span><span class="ident" id="3419659">Value</span><span class="op" id="3419664">,</span>&nbsp;<span class="ident" id="3419666">field</span>&nbsp;<span class="op" id="3419672">*</span><span class="ident" id="3419673">parse</span><span class="op" id="3419678">.</span><span class="ident" id="3419679">FieldNode</span><span class="op" id="3419688">,</span>&nbsp;<span class="ident" id="3419690">args</span>&nbsp;<span class="op" id="3419695">[</span><span class="op" id="3419696">]</span><span class="ident" id="3419697">parse</span><span class="op" id="3419702">.</span><span class="ident" id="3419703">Node</span><span class="op" id="3419707">,</span>&nbsp;<span class="ident" id="3419709">final</span>&nbsp;<span class="ident" id="3419715">reflect</span><span class="op" id="3419722">.</span><span class="ident" id="3419723">Value</span><span class="op" id="3419728">)</span>&nbsp;<span class="ident" id="3419730">reflect</span><span class="op" id="3419737">.</span><span class="ident" id="3419738">Value</span>&nbsp;<span class="op" id="3419744">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419747">s</span><span class="op" id="3419748">.</span><span class="ident" id="3419749">at</span><span class="op" id="3419751">(</span><span class="ident" id="3419752">field</span><span class="op" id="3419757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3419760">return</span>&nbsp;<span class="ident" id="3419767">s</span><span class="op" id="3419768">.</span><span class="ident" id="3419769">evalFieldChain</span><span class="op" id="3419783">(</span><span class="ident" id="3419784">dot</span><span class="op" id="3419787">,</span>&nbsp;<span class="ident" id="3419789">dot</span><span class="op" id="3419792">,</span>&nbsp;<span class="ident" id="3419794">field</span><span class="op" id="3419799">,</span>&nbsp;<span class="ident" id="3419801">field</span><span class="op" id="3419806">.</span><span class="ident" id="3419807">Ident</span><span class="op" id="3419812">,</span>&nbsp;<span class="ident" id="3419814">args</span><span class="op" id="3419818">,</span>&nbsp;<span class="ident" id="3419820">final</span><span class="op" id="3419825">)</span><br>
<span class="lineno"></span><span class="op" id="3419827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3419830">func</span>&nbsp;<span class="op" id="3419835">(</span><span class="ident" id="3419836">s</span>&nbsp;<span class="op" id="3419838">*</span><span class="ident" id="3419839">state</span><span class="op" id="3419844">)</span>&nbsp;<span class="ident" id="3419846">evalChainNode</span><span class="op" id="3419859">(</span><span class="ident" id="3419860">dot</span>&nbsp;<span class="ident" id="3419864">reflect</span><span class="op" id="3419871">.</span><span class="ident" id="3419872">Value</span><span class="op" id="3419877">,</span>&nbsp;<span class="ident" id="3419879">chain</span>&nbsp;<span class="op" id="3419885">*</span><span class="ident" id="3419886">parse</span><span class="op" id="3419891">.</span><span class="ident" id="3419892">ChainNode</span><span class="op" id="3419901">,</span>&nbsp;<span class="ident" id="3419903">args</span>&nbsp;<span class="op" id="3419908">[</span><span class="op" id="3419909">]</span><span class="ident" id="3419910">parse</span><span class="op" id="3419915">.</span><span class="ident" id="3419916">Node</span><span class="op" id="3419920">,</span>&nbsp;<span class="ident" id="3419922">final</span>&nbsp;<span class="ident" id="3419928">reflect</span><span class="op" id="3419935">.</span><span class="ident" id="3419936">Value</span><span class="op" id="3419941">)</span>&nbsp;<span class="ident" id="3419943">reflect</span><span class="op" id="3419950">.</span><span class="ident" id="3419951">Value</span>&nbsp;<span class="op" id="3419957">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3419960">s</span><span class="op" id="3419961">.</span><span class="ident" id="3419962">at</span><span class="op" id="3419964">(</span><span class="ident" id="3419965">chain</span><span class="op" id="3419970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3419973">//&nbsp;(pipe).Field1.Field2&nbsp;has&nbsp;pipe&nbsp;as&nbsp;.Node,&nbsp;fields&nbsp;as&nbsp;.Field.&nbsp;Eval&nbsp;the&nbsp;pipeline,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420071">pipe</span>&nbsp;<span class="op" id="3420076">:=</span>&nbsp;<span class="ident" id="3420079">s</span><span class="op" id="3420080">.</span><span class="ident" id="3420081">evalArg</span><span class="op" id="3420088">(</span><span class="ident" id="3420089">dot</span><span class="op" id="3420092">,</span>&nbsp;<span class="ident" id="3420094">nil</span><span class="op" id="3420097">,</span>&nbsp;<span class="ident" id="3420099">chain</span><span class="op" id="3420104">.</span><span class="ident" id="3420105">Node</span><span class="op" id="3420109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420112">if</span>&nbsp;<span class="builtinfunc" id="3420115">len</span><span class="op" id="3420118">(</span><span class="ident" id="3420119">chain</span><span class="op" id="3420124">.</span><span class="ident" id="3420125">Field</span><span class="op" id="3420130">)</span>&nbsp;<span class="op" id="3420132">==</span>&nbsp;<span class="num" id="3420135">0</span>&nbsp;<span class="op" id="3420137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420141">s</span><span class="op" id="3420142">.</span><span class="ident" id="3420143">errorf</span><span class="op" id="3420149">(</span><span class="string" id="3420150">&#34;internal&nbsp;error:&nbsp;no&nbsp;fields&nbsp;in&nbsp;evalChainNode&#34;</span><span class="op" id="3420194">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3420197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420200">return</span>&nbsp;<span class="ident" id="3420207">s</span><span class="op" id="3420208">.</span><span class="ident" id="3420209">evalFieldChain</span><span class="op" id="3420223">(</span><span class="ident" id="3420224">dot</span><span class="op" id="3420227">,</span>&nbsp;<span class="ident" id="3420229">pipe</span><span class="op" id="3420233">,</span>&nbsp;<span class="ident" id="3420235">chain</span><span class="op" id="3420240">,</span>&nbsp;<span class="ident" id="3420242">chain</span><span class="op" id="3420247">.</span><span class="ident" id="3420248">Field</span><span class="op" id="3420253">,</span>&nbsp;<span class="ident" id="3420255">args</span><span class="op" id="3420259">,</span>&nbsp;<span class="ident" id="3420261">final</span><span class="op" id="3420266">)</span><br>
<span class="lineno"></span><span class="op" id="3420268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3420271">func</span>&nbsp;<span class="op" id="3420276">(</span><span class="ident" id="3420277">s</span>&nbsp;<span class="op" id="3420279">*</span><span class="ident" id="3420280">state</span><span class="op" id="3420285">)</span>&nbsp;<span class="ident" id="3420287">evalVariableNode</span><span class="op" id="3420303">(</span><span class="ident" id="3420304">dot</span>&nbsp;<span class="ident" id="3420308">reflect</span><span class="op" id="3420315">.</span><span class="ident" id="3420316">Value</span><span class="op" id="3420321">,</span>&nbsp;<span class="ident" id="3420323">variable</span>&nbsp;<span class="op" id="3420332">*</span><span class="ident" id="3420333">parse</span><span class="op" id="3420338">.</span><span class="ident" id="3420339">VariableNode</span><span class="op" id="3420351">,</span>&nbsp;<span class="ident" id="3420353">args</span>&nbsp;<span class="op" id="3420358">[</span><span class="op" id="3420359">]</span><span class="ident" id="3420360">parse</span><span class="op" id="3420365">.</span><span class="ident" id="3420366">Node</span><span class="op" id="3420370">,</span>&nbsp;<span class="ident" id="3420372">final</span>&nbsp;<span class="ident" id="3420378">reflect</span><span class="op" id="3420385">.</span><span class="ident" id="3420386">Value</span><span class="op" id="3420391">)</span>&nbsp;<span class="ident" id="3420393">reflect</span><span class="op" id="3420400">.</span><span class="ident" id="3420401">Value</span>&nbsp;<span class="op" id="3420407">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3420410">//&nbsp;$x.Field&nbsp;has&nbsp;$x&nbsp;as&nbsp;the&nbsp;first&nbsp;ident,&nbsp;Field&nbsp;as&nbsp;the&nbsp;second.&nbsp;Eval&nbsp;the&nbsp;var,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420502">s</span><span class="op" id="3420503">.</span><span class="ident" id="3420504">at</span><span class="op" id="3420506">(</span><span class="ident" id="3420507">variable</span><span class="op" id="3420515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420518">value</span>&nbsp;<span class="op" id="3420524">:=</span>&nbsp;<span class="ident" id="3420527">s</span><span class="op" id="3420528">.</span><span class="ident" id="3420529">varValue</span><span class="op" id="3420537">(</span><span class="ident" id="3420538">variable</span><span class="op" id="3420546">.</span><span class="ident" id="3420547">Ident</span><span class="op" id="3420552">[</span><span class="num" id="3420553">0</span><span class="op" id="3420554">]</span><span class="op" id="3420555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420558">if</span>&nbsp;<span class="builtinfunc" id="3420561">len</span><span class="op" id="3420564">(</span><span class="ident" id="3420565">variable</span><span class="op" id="3420573">.</span><span class="ident" id="3420574">Ident</span><span class="op" id="3420579">)</span>&nbsp;<span class="op" id="3420581">==</span>&nbsp;<span class="num" id="3420584">1</span>&nbsp;<span class="op" id="3420586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3420590">s</span><span class="op" id="3420591">.</span><span class="ident" id="3420592">notAFunction</span><span class="op" id="3420604">(</span><span class="ident" id="3420605">args</span><span class="op" id="3420609">,</span>&nbsp;<span class="ident" id="3420611">final</span><span class="op" id="3420616">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420620">return</span>&nbsp;<span class="ident" id="3420627">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3420634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3420637">return</span>&nbsp;<span class="ident" id="3420644">s</span><span class="op" id="3420645">.</span><span class="ident" id="3420646">evalFieldChain</span><span class="op" id="3420660">(</span><span class="ident" id="3420661">dot</span><span class="op" id="3420664">,</span>&nbsp;<span class="ident" id="3420666">value</span><span class="op" id="3420671">,</span>&nbsp;<span class="ident" id="3420673">variable</span><span class="op" id="3420681">,</span>&nbsp;<span class="ident" id="3420683">variable</span><span class="op" id="3420691">.</span><span class="ident" id="3420692">Ident</span><span class="op" id="3420697">[</span><span class="num" id="3420698">1</span><span class="op" id="3420699">:</span><span class="op" id="3420700">]</span><span class="op" id="3420701">,</span>&nbsp;<span class="ident" id="3420703">args</span><span class="op" id="3420707">,</span>&nbsp;<span class="ident" id="3420709">final</span><span class="op" id="3420714">)</span><br>
<span class="lineno"></span><span class="op" id="3420716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="3420719">//&nbsp;evalFieldChain&nbsp;evaluates&nbsp;.X.Y.Z&nbsp;possibly&nbsp;followed&nbsp;by&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="3420786">//&nbsp;dot&nbsp;is&nbsp;the&nbsp;environment&nbsp;in&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;arguments,&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="3420850">//&nbsp;receiver&nbsp;is&nbsp;the&nbsp;value&nbsp;being&nbsp;walked&nbsp;along&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="3420905">func</span>&nbsp;<span class="op" id="3420910">(</span><span class="ident" id="3420911">s</span>&nbsp;<span class="op" id="3420913">*</span><span class="ident" id="3420914">state</span><span class="op" id="3420919">)</span>&nbsp;<span class="ident" id="3420921">evalFieldChain</span><span class="op" id="3420935">(</span><span class="ident" id="3420936">dot</span><span class="op" id="3420939">,</span>&nbsp;<span class="ident" id="3420941">receiver</span>&nbsp;<span class="ident" id="3420950">reflect</span><span class="op" id="3420957">.</span><span class="ident" id="3420958">Value</span><span class="op" id="3420963">,</span>&nbsp;<span class="ident" id="3420965">node</span>&nbsp;<span class="ident" id="3420970">parse</span><span class="op" id="3420975">.</span><span class="ident" id="3420976">Node</span><span class="op" id="3420980">,</span>&nbsp;<span class="ident" id="3420982">ident</span>&nbsp;<span class="op" id="3420988">[</span><span class="op" id="3420989">]</span><span class="builtintype" id="3420990">string</span><span class="op" id="3420996">,</span>&nbsp;<span class="ident" id="3420998">args</span>&nbsp;<span class="op" id="3421003">[</span><span class="op" id="3421004">]</span><span class="ident" id="3421005">parse</span><span class="op" id="3421010">.</span><span class="ident" id="3421011">Node</span><span class="op" id="3421015">,</span>&nbsp;<span class="ident" id="3421017">final</span>&nbsp;<span class="ident" id="3421023">reflect</span><span class="op" id="3421030">.</span><span class="ident" id="3421031">Value</span><span class="op" id="3421036">)</span>&nbsp;<span class="ident" id="3421038">reflect</span><span class="op" id="3421045">.</span><span class="ident" id="3421046">Value</span>&nbsp;<span class="op" id="3421052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421055">n</span>&nbsp;<span class="op" id="3421057">:=</span>&nbsp;<span class="builtinfunc" id="3421060">len</span><span class="op" id="3421063">(</span><span class="ident" id="3421064">ident</span><span class="op" id="3421069">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421072">for</span>&nbsp;<span class="ident" id="3421076">i</span>&nbsp;<span class="op" id="3421078">:=</span>&nbsp;<span class="num" id="3421081">0</span><span class="op" id="3421082">;</span>&nbsp;<span class="ident" id="3421084">i</span>&nbsp;<span class="op" id="3421086">&lt;</span>&nbsp;<span class="ident" id="3421088">n</span><span class="op" id="3421089">-</span><span class="num" id="3421090">1</span><span class="op" id="3421091">;</span>&nbsp;<span class="ident" id="3421093">i</span><span class="op" id="3421094">++</span>&nbsp;<span class="op" id="3421097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421101">receiver</span>&nbsp;<span class="op" id="3421110">=</span>&nbsp;<span class="ident" id="3421112">s</span><span class="op" id="3421113">.</span><span class="ident" id="3421114">evalField</span><span class="op" id="3421123">(</span><span class="ident" id="3421124">dot</span><span class="op" id="3421127">,</span>&nbsp;<span class="ident" id="3421129">ident</span><span class="op" id="3421134">[</span><span class="ident" id="3421135">i</span><span class="op" id="3421136">]</span><span class="op" id="3421137">,</span>&nbsp;<span class="ident" id="3421139">node</span><span class="op" id="3421143">,</span>&nbsp;<span class="ident" id="3421145">nil</span><span class="op" id="3421148">,</span>&nbsp;<span class="ident" id="3421150">zero</span><span class="op" id="3421154">,</span>&nbsp;<span class="ident" id="3421156">receiver</span><span class="op" id="3421164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3421167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3421170">//&nbsp;Now&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;it&nbsp;gets&nbsp;the&nbsp;arguments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421219">return</span>&nbsp;<span class="ident" id="3421226">s</span><span class="op" id="3421227">.</span><span class="ident" id="3421228">evalField</span><span class="op" id="3421237">(</span><span class="ident" id="3421238">dot</span><span class="op" id="3421241">,</span>&nbsp;<span class="ident" id="3421243">ident</span><span class="op" id="3421248">[</span><span class="ident" id="3421249">n</span><span class="op" id="3421250">-</span><span class="num" id="3421251">1</span><span class="op" id="3421252">]</span><span class="op" id="3421253">,</span>&nbsp;<span class="ident" id="3421255">node</span><span class="op" id="3421259">,</span>&nbsp;<span class="ident" id="3421261">args</span><span class="op" id="3421265">,</span>&nbsp;<span class="ident" id="3421267">final</span><span class="op" id="3421272">,</span>&nbsp;<span class="ident" id="3421274">receiver</span><span class="op" id="3421282">)</span><br>
<span class="lineno">450</span><span class="op" id="3421284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3421287">func</span>&nbsp;<span class="op" id="3421292">(</span><span class="ident" id="3421293">s</span>&nbsp;<span class="op" id="3421295">*</span><span class="ident" id="3421296">state</span><span class="op" id="3421301">)</span>&nbsp;<span class="ident" id="3421303">evalFunction</span><span class="op" id="3421315">(</span><span class="ident" id="3421316">dot</span>&nbsp;<span class="ident" id="3421320">reflect</span><span class="op" id="3421327">.</span><span class="ident" id="3421328">Value</span><span class="op" id="3421333">,</span>&nbsp;<span class="ident" id="3421335">node</span>&nbsp;<span class="op" id="3421340">*</span><span class="ident" id="3421341">parse</span><span class="op" id="3421346">.</span><span class="ident" id="3421347">IdentifierNode</span><span class="op" id="3421361">,</span>&nbsp;<span class="ident" id="3421363">cmd</span>&nbsp;<span class="ident" id="3421367">parse</span><span class="op" id="3421372">.</span><span class="ident" id="3421373">Node</span><span class="op" id="3421377">,</span>&nbsp;<span class="ident" id="3421379">args</span>&nbsp;<span class="op" id="3421384">[</span><span class="op" id="3421385">]</span><span class="ident" id="3421386">parse</span><span class="op" id="3421391">.</span><span class="ident" id="3421392">Node</span><span class="op" id="3421396">,</span>&nbsp;<span class="ident" id="3421398">final</span>&nbsp;<span class="ident" id="3421404">reflect</span><span class="op" id="3421411">.</span><span class="ident" id="3421412">Value</span><span class="op" id="3421417">)</span>&nbsp;<span class="ident" id="3421419">reflect</span><span class="op" id="3421426">.</span><span class="ident" id="3421427">Value</span>&nbsp;<span class="op" id="3421433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421436">s</span><span class="op" id="3421437">.</span><span class="ident" id="3421438">at</span><span class="op" id="3421440">(</span><span class="ident" id="3421441">node</span><span class="op" id="3421445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421448">name</span>&nbsp;<span class="op" id="3421453">:=</span>&nbsp;<span class="ident" id="3421456">node</span><span class="op" id="3421460">.</span><span class="ident" id="3421461">Ident</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421468">function</span><span class="op" id="3421476">,</span>&nbsp;<span class="ident" id="3421478">ok</span>&nbsp;<span class="op" id="3421481">:=</span>&nbsp;<span class="ident" id="3421484">findFunction</span><span class="op" id="3421496">(</span><span class="ident" id="3421497">name</span><span class="op" id="3421501">,</span>&nbsp;<span class="ident" id="3421503">s</span><span class="op" id="3421504">.</span><span class="ident" id="3421505">tmpl</span><span class="op" id="3421509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421512">if</span>&nbsp;<span class="op" id="3421515">!</span><span class="ident" id="3421516">ok</span>&nbsp;<span class="op" id="3421519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3421523">s</span><span class="op" id="3421524">.</span><span class="ident" id="3421525">errorf</span><span class="op" id="3421531">(</span><span class="string" id="3421532">&#34;%q&nbsp;is&nbsp;not&nbsp;a&nbsp;defined&nbsp;function&#34;</span><span class="op" id="3421562">,</span>&nbsp;<span class="ident" id="3421564">name</span><span class="op" id="3421568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3421571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421574">return</span>&nbsp;<span class="ident" id="3421581">s</span><span class="op" id="3421582">.</span><span class="ident" id="3421583">evalCall</span><span class="op" id="3421591">(</span><span class="ident" id="3421592">dot</span><span class="op" id="3421595">,</span>&nbsp;<span class="ident" id="3421597">function</span><span class="op" id="3421605">,</span>&nbsp;<span class="ident" id="3421607">cmd</span><span class="op" id="3421610">,</span>&nbsp;<span class="ident" id="3421612">name</span><span class="op" id="3421616">,</span>&nbsp;<span class="ident" id="3421618">args</span><span class="op" id="3421622">,</span>&nbsp;<span class="ident" id="3421624">final</span><span class="op" id="3421629">)</span><br>
<span class="lineno">460</span><span class="op" id="3421631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3421634">//&nbsp;evalField&nbsp;evaluates&nbsp;an&nbsp;expression&nbsp;like&nbsp;(.Field)&nbsp;or&nbsp;(.Field&nbsp;arg1&nbsp;arg2).</span><br>
<span class="lineno"></span><span class="comment" id="3421708">//&nbsp;The&nbsp;&#39;final&#39;&nbsp;argument&nbsp;represents&nbsp;the&nbsp;return&nbsp;value&nbsp;from&nbsp;the&nbsp;preceding</span><br>
<span class="lineno"></span><span class="comment" id="3421779">//&nbsp;value&nbsp;of&nbsp;the&nbsp;pipeline,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">465</span><span class="keyword" id="3421813">func</span>&nbsp;<span class="op" id="3421818">(</span><span class="ident" id="3421819">s</span>&nbsp;<span class="op" id="3421821">*</span><span class="ident" id="3421822">state</span><span class="op" id="3421827">)</span>&nbsp;<span class="ident" id="3421829">evalField</span><span class="op" id="3421838">(</span><span class="ident" id="3421839">dot</span>&nbsp;<span class="ident" id="3421843">reflect</span><span class="op" id="3421850">.</span><span class="ident" id="3421851">Value</span><span class="op" id="3421856">,</span>&nbsp;<span class="ident" id="3421858">fieldName</span>&nbsp;<span class="builtintype" id="3421868">string</span><span class="op" id="3421874">,</span>&nbsp;<span class="ident" id="3421876">node</span>&nbsp;<span class="ident" id="3421881">parse</span><span class="op" id="3421886">.</span><span class="ident" id="3421887">Node</span><span class="op" id="3421891">,</span>&nbsp;<span class="ident" id="3421893">args</span>&nbsp;<span class="op" id="3421898">[</span><span class="op" id="3421899">]</span><span class="ident" id="3421900">parse</span><span class="op" id="3421905">.</span><span class="ident" id="3421906">Node</span><span class="op" id="3421910">,</span>&nbsp;<span class="ident" id="3421912">final</span><span class="op" id="3421917">,</span>&nbsp;<span class="ident" id="3421919">receiver</span>&nbsp;<span class="ident" id="3421928">reflect</span><span class="op" id="3421935">.</span><span class="ident" id="3421936">Value</span><span class="op" id="3421941">)</span>&nbsp;<span class="ident" id="3421943">reflect</span><span class="op" id="3421950">.</span><span class="ident" id="3421951">Value</span>&nbsp;<span class="op" id="3421957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421960">if</span>&nbsp;<span class="op" id="3421963">!</span><span class="ident" id="3421964">receiver</span><span class="op" id="3421972">.</span><span class="ident" id="3421973">IsValid</span><span class="op" id="3421980">(</span><span class="op" id="3421981">)</span>&nbsp;<span class="op" id="3421983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3421987">return</span>&nbsp;<span class="ident" id="3421994">zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3422000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422003">typ</span>&nbsp;<span class="op" id="3422007">:=</span>&nbsp;<span class="ident" id="3422010">receiver</span><span class="op" id="3422018">.</span><span class="ident" id="3422019">Type</span><span class="op" id="3422023">(</span><span class="op" id="3422024">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422027">receiver</span><span class="op" id="3422035">,</span>&nbsp;<span class="ident" id="3422037">_</span>&nbsp;<span class="op" id="3422039">=</span>&nbsp;<span class="ident" id="3422041">indirect</span><span class="op" id="3422049">(</span><span class="ident" id="3422050">receiver</span><span class="op" id="3422058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3422061">//&nbsp;Unless&nbsp;it&#39;s&nbsp;an&nbsp;interface,&nbsp;need&nbsp;to&nbsp;get&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;*T&nbsp;to&nbsp;guarantee</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3422138">//&nbsp;we&nbsp;see&nbsp;all&nbsp;methods&nbsp;of&nbsp;T&nbsp;and&nbsp;*T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422174">ptr</span>&nbsp;<span class="op" id="3422178">:=</span>&nbsp;<span class="ident" id="3422181">receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422191">if</span>&nbsp;<span class="ident" id="3422194">ptr</span><span class="op" id="3422197">.</span><span class="ident" id="3422198">Kind</span><span class="op" id="3422202">(</span><span class="op" id="3422203">)</span>&nbsp;<span class="op" id="3422205">!=</span>&nbsp;<span class="ident" id="3422208">reflect</span><span class="op" id="3422215">.</span><span class="ident" id="3422216">Interface</span>&nbsp;<span class="op" id="3422226">&amp;&amp;</span>&nbsp;<span class="ident" id="3422229">ptr</span><span class="op" id="3422232">.</span><span class="ident" id="3422233">CanAddr</span><span class="op" id="3422240">(</span><span class="op" id="3422241">)</span>&nbsp;<span class="op" id="3422243">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422247">ptr</span>&nbsp;<span class="op" id="3422251">=</span>&nbsp;<span class="ident" id="3422253">ptr</span><span class="op" id="3422256">.</span><span class="ident" id="3422257">Addr</span><span class="op" id="3422261">(</span><span class="op" id="3422262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3422265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422268">if</span>&nbsp;<span class="ident" id="3422271">method</span>&nbsp;<span class="op" id="3422278">:=</span>&nbsp;<span class="ident" id="3422281">ptr</span><span class="op" id="3422284">.</span><span class="ident" id="3422285">MethodByName</span><span class="op" id="3422297">(</span><span class="ident" id="3422298">fieldName</span><span class="op" id="3422307">)</span><span class="op" id="3422308">;</span>&nbsp;<span class="ident" id="3422310">method</span><span class="op" id="3422316">.</span><span class="ident" id="3422317">IsValid</span><span class="op" id="3422324">(</span><span class="op" id="3422325">)</span>&nbsp;<span class="op" id="3422327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422331">return</span>&nbsp;<span class="ident" id="3422338">s</span><span class="op" id="3422339">.</span><span class="ident" id="3422340">evalCall</span><span class="op" id="3422348">(</span><span class="ident" id="3422349">dot</span><span class="op" id="3422352">,</span>&nbsp;<span class="ident" id="3422354">method</span><span class="op" id="3422360">,</span>&nbsp;<span class="ident" id="3422362">node</span><span class="op" id="3422366">,</span>&nbsp;<span class="ident" id="3422368">fieldName</span><span class="op" id="3422377">,</span>&nbsp;<span class="ident" id="3422379">args</span><span class="op" id="3422383">,</span>&nbsp;<span class="ident" id="3422385">final</span><span class="op" id="3422390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3422393">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422396">hasArgs</span>&nbsp;<span class="op" id="3422404">:=</span>&nbsp;<span class="builtinfunc" id="3422407">len</span><span class="op" id="3422410">(</span><span class="ident" id="3422411">args</span><span class="op" id="3422415">)</span>&nbsp;<span class="op" id="3422417">&gt;</span>&nbsp;<span class="num" id="3422419">1</span>&nbsp;<span class="op" id="3422421">||</span>&nbsp;<span class="ident" id="3422424">final</span><span class="op" id="3422429">.</span><span class="ident" id="3422430">IsValid</span><span class="op" id="3422437">(</span><span class="op" id="3422438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3422441">//&nbsp;It&#39;s&nbsp;not&nbsp;a&nbsp;method;&nbsp;must&nbsp;be&nbsp;a&nbsp;field&nbsp;of&nbsp;a&nbsp;struct&nbsp;or&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;map.&nbsp;The&nbsp;receiver&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422546">receiver</span><span class="op" id="3422554">,</span>&nbsp;<span class="ident" id="3422556">isNil</span>&nbsp;<span class="op" id="3422562">:=</span>&nbsp;<span class="ident" id="3422565">indirect</span><span class="op" id="3422573">(</span><span class="ident" id="3422574">receiver</span><span class="op" id="3422582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422585">if</span>&nbsp;<span class="ident" id="3422588">isNil</span>&nbsp;<span class="op" id="3422594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422598">s</span><span class="op" id="3422599">.</span><span class="ident" id="3422600">errorf</span><span class="op" id="3422606">(</span><span class="string" id="3422607">&#34;nil&nbsp;pointer&nbsp;evaluating&nbsp;%s.%s&#34;</span><span class="op" id="3422637">,</span>&nbsp;<span class="ident" id="3422639">typ</span><span class="op" id="3422642">,</span>&nbsp;<span class="ident" id="3422644">fieldName</span><span class="op" id="3422653">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3422656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422659">switch</span>&nbsp;<span class="ident" id="3422666">receiver</span><span class="op" id="3422674">.</span><span class="ident" id="3422675">Kind</span><span class="op" id="3422679">(</span><span class="op" id="3422680">)</span>&nbsp;<span class="op" id="3422682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422685">case</span>&nbsp;<span class="ident" id="3422690">reflect</span><span class="op" id="3422697">.</span><span class="ident" id="3422698">Struct</span><span class="op" id="3422704">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422708">tField</span><span class="op" id="3422714">,</span>&nbsp;<span class="ident" id="3422716">ok</span>&nbsp;<span class="op" id="3422719">:=</span>&nbsp;<span class="ident" id="3422722">receiver</span><span class="op" id="3422730">.</span><span class="ident" id="3422731">Type</span><span class="op" id="3422735">(</span><span class="op" id="3422736">)</span><span class="op" id="3422737">.</span><span class="ident" id="3422738">FieldByName</span><span class="op" id="3422749">(</span><span class="ident" id="3422750">fieldName</span><span class="op" id="3422759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422763">if</span>&nbsp;<span class="ident" id="3422766">ok</span>&nbsp;<span class="op" id="3422769">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422774">field</span>&nbsp;<span class="op" id="3422780">:=</span>&nbsp;<span class="ident" id="3422783">receiver</span><span class="op" id="3422791">.</span><span class="ident" id="3422792">FieldByIndex</span><span class="op" id="3422804">(</span><span class="ident" id="3422805">tField</span><span class="op" id="3422811">.</span><span class="ident" id="3422812">Index</span><span class="op" id="3422817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422822">if</span>&nbsp;<span class="ident" id="3422825">tField</span><span class="op" id="3422831">.</span><span class="ident" id="3422832">PkgPath</span>&nbsp;<span class="op" id="3422840">!=</span>&nbsp;<span class="string" id="3422843">&#34;&#34;</span>&nbsp;<span class="op" id="3422846">{</span>&nbsp;<span class="comment" id="3422848">//&nbsp;field&nbsp;is&nbsp;unexported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3422875">s</span><span class="op" id="3422876">.</span><span class="ident" id="3422877">errorf</span><span class="op" id="3422883">(</span><span class="string" id="3422884">&#34;%s&nbsp;is&nbsp;an&nbsp;unexported&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3422929">,</span>&nbsp;<span class="ident" id="3422931">fieldName</span><span class="op" id="3422940">,</span>&nbsp;<span class="ident" id="3422942">typ</span><span class="op" id="3422945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3422950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3422955">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;function,&nbsp;we&nbsp;must&nbsp;call&nbsp;it.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3422998">if</span>&nbsp;<span class="ident" id="3423001">hasArgs</span>&nbsp;<span class="op" id="3423009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423015">s</span><span class="op" id="3423016">.</span><span class="ident" id="3423017">errorf</span><span class="op" id="3423023">(</span><span class="string" id="3423024">&#34;%s&nbsp;has&nbsp;arguments&nbsp;but&nbsp;cannot&nbsp;be&nbsp;invoked&nbsp;as&nbsp;function&#34;</span><span class="op" id="3423076">,</span>&nbsp;<span class="ident" id="3423078">fieldName</span><span class="op" id="3423087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3423092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3423097">return</span>&nbsp;<span class="ident" id="3423104">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3423112">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423116">s</span><span class="op" id="3423117">.</span><span class="ident" id="3423118">errorf</span><span class="op" id="3423124">(</span><span class="string" id="3423125">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3423162">,</span>&nbsp;<span class="ident" id="3423164">fieldName</span><span class="op" id="3423173">,</span>&nbsp;<span class="ident" id="3423175">typ</span><span class="op" id="3423178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3423181">case</span>&nbsp;<span class="ident" id="3423186">reflect</span><span class="op" id="3423193">.</span><span class="ident" id="3423194">Map</span><span class="op" id="3423197">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3423201">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;map,&nbsp;attempt&nbsp;to&nbsp;use&nbsp;the&nbsp;field&nbsp;name&nbsp;as&nbsp;a&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423261">nameVal</span>&nbsp;<span class="op" id="3423269">:=</span>&nbsp;<span class="ident" id="3423272">reflect</span><span class="op" id="3423279">.</span><span class="ident" id="3423280">ValueOf</span><span class="op" id="3423287">(</span><span class="ident" id="3423288">fieldName</span><span class="op" id="3423297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3423301">if</span>&nbsp;<span class="ident" id="3423304">nameVal</span><span class="op" id="3423311">.</span><span class="ident" id="3423312">Type</span><span class="op" id="3423316">(</span><span class="op" id="3423317">)</span><span class="op" id="3423318">.</span><span class="ident" id="3423319">AssignableTo</span><span class="op" id="3423331">(</span><span class="ident" id="3423332">receiver</span><span class="op" id="3423340">.</span><span class="ident" id="3423341">Type</span><span class="op" id="3423345">(</span><span class="op" id="3423346">)</span><span class="op" id="3423347">.</span><span class="ident" id="3423348">Key</span><span class="op" id="3423351">(</span><span class="op" id="3423352">)</span><span class="op" id="3423353">)</span>&nbsp;<span class="op" id="3423355">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3423360">if</span>&nbsp;<span class="ident" id="3423363">hasArgs</span>&nbsp;<span class="op" id="3423371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423377">s</span><span class="op" id="3423378">.</span><span class="ident" id="3423379">errorf</span><span class="op" id="3423385">(</span><span class="string" id="3423386">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;method&nbsp;but&nbsp;has&nbsp;arguments&#34;</span><span class="op" id="3423424">,</span>&nbsp;<span class="ident" id="3423426">fieldName</span><span class="op" id="3423435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3423440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3423445">return</span>&nbsp;<span class="ident" id="3423452">receiver</span><span class="op" id="3423460">.</span><span class="ident" id="3423461">MapIndex</span><span class="op" id="3423469">(</span><span class="ident" id="3423470">nameVal</span><span class="op" id="3423477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3423481">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3423484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423487">s</span><span class="op" id="3423488">.</span><span class="ident" id="3423489">errorf</span><span class="op" id="3423495">(</span><span class="string" id="3423496">&#34;can&#39;t&nbsp;evaluate&nbsp;field&nbsp;%s&nbsp;in&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3423532">,</span>&nbsp;<span class="ident" id="3423534">fieldName</span><span class="op" id="3423543">,</span>&nbsp;<span class="ident" id="3423545">typ</span><span class="op" id="3423548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3423551">panic</span><span class="op" id="3423556">(</span><span class="string" id="3423557">&#34;not&nbsp;reached&#34;</span><span class="op" id="3423570">)</span><br>
<span class="lineno"></span><span class="op" id="3423572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="3423575">var</span>&nbsp;<span class="op" id="3423579">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423582">errorType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3423598">=</span>&nbsp;<span class="ident" id="3423600">reflect</span><span class="op" id="3423607">.</span><span class="ident" id="3423608">TypeOf</span><span class="op" id="3423614">(</span><span class="op" id="3423615">(</span><span class="op" id="3423616">*</span><span class="builtintype" id="3423617">error</span><span class="op" id="3423622">)</span><span class="op" id="3423623">(</span><span class="ident" id="3423624">nil</span><span class="op" id="3423627">)</span><span class="op" id="3423628">)</span><span class="op" id="3423629">.</span><span class="ident" id="3423630">Elem</span><span class="op" id="3423634">(</span><span class="op" id="3423635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3423638">fmtStringerType</span>&nbsp;<span class="op" id="3423654">=</span>&nbsp;<span class="ident" id="3423656">reflect</span><span class="op" id="3423663">.</span><span class="ident" id="3423664">TypeOf</span><span class="op" id="3423670">(</span><span class="op" id="3423671">(</span><span class="op" id="3423672">*</span><span class="ident" id="3423673">fmt</span><span class="op" id="3423676">.</span><span class="ident" id="3423677">Stringer</span><span class="op" id="3423685">)</span><span class="op" id="3423686">(</span><span class="ident" id="3423687">nil</span><span class="op" id="3423690">)</span><span class="op" id="3423691">)</span><span class="op" id="3423692">.</span><span class="ident" id="3423693">Elem</span><span class="op" id="3423697">(</span><span class="op" id="3423698">)</span><br>
<span class="lineno"></span><span class="op" id="3423700">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="comment" id="3423703">//&nbsp;evalCall&nbsp;executes&nbsp;a&nbsp;function&nbsp;or&nbsp;method&nbsp;call.&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;fun&nbsp;already&nbsp;has&nbsp;the&nbsp;receiver&nbsp;bound,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="3423808">//&nbsp;it&nbsp;looks&nbsp;just&nbsp;like&nbsp;a&nbsp;function&nbsp;call.&nbsp;&nbsp;The&nbsp;arg&nbsp;list,&nbsp;if&nbsp;non-nil,&nbsp;includes&nbsp;(in&nbsp;the&nbsp;manner&nbsp;of&nbsp;the&nbsp;shell),&nbsp;arg[0]</span><br>
<span class="lineno"></span><span class="comment" id="3423920">//&nbsp;as&nbsp;the&nbsp;function&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="3423947">func</span>&nbsp;<span class="op" id="3423952">(</span><span class="ident" id="3423953">s</span>&nbsp;<span class="op" id="3423955">*</span><span class="ident" id="3423956">state</span><span class="op" id="3423961">)</span>&nbsp;<span class="ident" id="3423963">evalCall</span><span class="op" id="3423971">(</span><span class="ident" id="3423972">dot</span><span class="op" id="3423975">,</span>&nbsp;<span class="ident" id="3423977">fun</span>&nbsp;<span class="ident" id="3423981">reflect</span><span class="op" id="3423988">.</span><span class="ident" id="3423989">Value</span><span class="op" id="3423994">,</span>&nbsp;<span class="ident" id="3423996">node</span>&nbsp;<span class="ident" id="3424001">parse</span><span class="op" id="3424006">.</span><span class="ident" id="3424007">Node</span><span class="op" id="3424011">,</span>&nbsp;<span class="ident" id="3424013">name</span>&nbsp;<span class="builtintype" id="3424018">string</span><span class="op" id="3424024">,</span>&nbsp;<span class="ident" id="3424026">args</span>&nbsp;<span class="op" id="3424031">[</span><span class="op" id="3424032">]</span><span class="ident" id="3424033">parse</span><span class="op" id="3424038">.</span><span class="ident" id="3424039">Node</span><span class="op" id="3424043">,</span>&nbsp;<span class="ident" id="3424045">final</span>&nbsp;<span class="ident" id="3424051">reflect</span><span class="op" id="3424058">.</span><span class="ident" id="3424059">Value</span><span class="op" id="3424064">)</span>&nbsp;<span class="ident" id="3424066">reflect</span><span class="op" id="3424073">.</span><span class="ident" id="3424074">Value</span>&nbsp;<span class="op" id="3424080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424083">if</span>&nbsp;<span class="ident" id="3424086">args</span>&nbsp;<span class="op" id="3424091">!=</span>&nbsp;<span class="ident" id="3424094">nil</span>&nbsp;<span class="op" id="3424098">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424102">args</span>&nbsp;<span class="op" id="3424107">=</span>&nbsp;<span class="ident" id="3424109">args</span><span class="op" id="3424113">[</span><span class="num" id="3424114">1</span><span class="op" id="3424115">:</span><span class="op" id="3424116">]</span>&nbsp;<span class="comment" id="3424118">//&nbsp;Zeroth&nbsp;arg&nbsp;is&nbsp;function&nbsp;name/node;&nbsp;not&nbsp;passed&nbsp;to&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424183">typ</span>&nbsp;<span class="op" id="3424187">:=</span>&nbsp;<span class="ident" id="3424190">fun</span><span class="op" id="3424193">.</span><span class="ident" id="3424194">Type</span><span class="op" id="3424198">(</span><span class="op" id="3424199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424202">numIn</span>&nbsp;<span class="op" id="3424208">:=</span>&nbsp;<span class="builtinfunc" id="3424211">len</span><span class="op" id="3424214">(</span><span class="ident" id="3424215">args</span><span class="op" id="3424219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424222">if</span>&nbsp;<span class="ident" id="3424225">final</span><span class="op" id="3424230">.</span><span class="ident" id="3424231">IsValid</span><span class="op" id="3424238">(</span><span class="op" id="3424239">)</span>&nbsp;<span class="op" id="3424241">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424245">numIn</span><span class="op" id="3424250">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424257">numFixed</span>&nbsp;<span class="op" id="3424266">:=</span>&nbsp;<span class="builtinfunc" id="3424269">len</span><span class="op" id="3424272">(</span><span class="ident" id="3424273">args</span><span class="op" id="3424277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424280">if</span>&nbsp;<span class="ident" id="3424283">typ</span><span class="op" id="3424286">.</span><span class="ident" id="3424287">IsVariadic</span><span class="op" id="3424297">(</span><span class="op" id="3424298">)</span>&nbsp;<span class="op" id="3424300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424304">numFixed</span>&nbsp;<span class="op" id="3424313">=</span>&nbsp;<span class="ident" id="3424315">typ</span><span class="op" id="3424318">.</span><span class="ident" id="3424319">NumIn</span><span class="op" id="3424324">(</span><span class="op" id="3424325">)</span>&nbsp;<span class="op" id="3424327">-</span>&nbsp;<span class="num" id="3424329">1</span>&nbsp;<span class="comment" id="3424331">//&nbsp;last&nbsp;arg&nbsp;is&nbsp;the&nbsp;variadic&nbsp;one.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424366">if</span>&nbsp;<span class="ident" id="3424369">numIn</span>&nbsp;<span class="op" id="3424375">&lt;</span>&nbsp;<span class="ident" id="3424377">numFixed</span>&nbsp;<span class="op" id="3424386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424391">s</span><span class="op" id="3424392">.</span><span class="ident" id="3424393">errorf</span><span class="op" id="3424399">(</span><span class="string" id="3424400">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="3424454">,</span>&nbsp;<span class="ident" id="3424456">name</span><span class="op" id="3424460">,</span>&nbsp;<span class="ident" id="3424462">typ</span><span class="op" id="3424465">.</span><span class="ident" id="3424466">NumIn</span><span class="op" id="3424471">(</span><span class="op" id="3424472">)</span><span class="op" id="3424473">-</span><span class="num" id="3424474">1</span><span class="op" id="3424475">,</span>&nbsp;<span class="builtinfunc" id="3424477">len</span><span class="op" id="3424480">(</span><span class="ident" id="3424481">args</span><span class="op" id="3424485">)</span><span class="op" id="3424486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424493">}</span>&nbsp;<span class="keyword" id="3424495">else</span>&nbsp;<span class="keyword" id="3424500">if</span>&nbsp;<span class="ident" id="3424503">numIn</span>&nbsp;<span class="op" id="3424509">&lt;</span>&nbsp;<span class="ident" id="3424511">typ</span><span class="op" id="3424514">.</span><span class="ident" id="3424515">NumIn</span><span class="op" id="3424520">(</span><span class="op" id="3424521">)</span><span class="op" id="3424522">-</span><span class="num" id="3424523">1</span>&nbsp;<span class="op" id="3424525">||</span>&nbsp;<span class="op" id="3424528">!</span><span class="ident" id="3424529">typ</span><span class="op" id="3424532">.</span><span class="ident" id="3424533">IsVariadic</span><span class="op" id="3424543">(</span><span class="op" id="3424544">)</span>&nbsp;<span class="op" id="3424546">&amp;&amp;</span>&nbsp;<span class="ident" id="3424549">numIn</span>&nbsp;<span class="op" id="3424555">!=</span>&nbsp;<span class="ident" id="3424558">typ</span><span class="op" id="3424561">.</span><span class="ident" id="3424562">NumIn</span><span class="op" id="3424567">(</span><span class="op" id="3424568">)</span>&nbsp;<span class="op" id="3424570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424574">s</span><span class="op" id="3424575">.</span><span class="ident" id="3424576">errorf</span><span class="op" id="3424582">(</span><span class="string" id="3424583">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="3424628">,</span>&nbsp;<span class="ident" id="3424630">name</span><span class="op" id="3424634">,</span>&nbsp;<span class="ident" id="3424636">typ</span><span class="op" id="3424639">.</span><span class="ident" id="3424640">NumIn</span><span class="op" id="3424645">(</span><span class="op" id="3424646">)</span><span class="op" id="3424647">,</span>&nbsp;<span class="builtinfunc" id="3424649">len</span><span class="op" id="3424652">(</span><span class="ident" id="3424653">args</span><span class="op" id="3424657">)</span><span class="op" id="3424658">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424664">if</span>&nbsp;<span class="op" id="3424667">!</span><span class="ident" id="3424668">goodFunc</span><span class="op" id="3424676">(</span><span class="ident" id="3424677">typ</span><span class="op" id="3424680">)</span>&nbsp;<span class="op" id="3424682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3424686">//&nbsp;TODO:&nbsp;This&nbsp;could&nbsp;still&nbsp;be&nbsp;a&nbsp;confusing&nbsp;error;&nbsp;maybe&nbsp;goodFunc&nbsp;should&nbsp;provide&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424772">s</span><span class="op" id="3424773">.</span><span class="ident" id="3424774">errorf</span><span class="op" id="3424780">(</span><span class="string" id="3424781">&#34;can&#39;t&nbsp;call&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="3424828">,</span>&nbsp;<span class="ident" id="3424830">name</span><span class="op" id="3424834">,</span>&nbsp;<span class="ident" id="3424836">typ</span><span class="op" id="3424839">.</span><span class="ident" id="3424840">NumOut</span><span class="op" id="3424846">(</span><span class="op" id="3424847">)</span><span class="op" id="3424848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3424851">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3424854">//&nbsp;Build&nbsp;the&nbsp;arg&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424878">argv</span>&nbsp;<span class="op" id="3424883">:=</span>&nbsp;<span class="builtinfunc" id="3424886">make</span><span class="op" id="3424890">(</span><span class="op" id="3424891">[</span><span class="op" id="3424892">]</span><span class="ident" id="3424893">reflect</span><span class="op" id="3424900">.</span><span class="ident" id="3424901">Value</span><span class="op" id="3424906">,</span>&nbsp;<span class="ident" id="3424908">numIn</span><span class="op" id="3424913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3424916">//&nbsp;Args&nbsp;must&nbsp;be&nbsp;evaluated.&nbsp;Fixed&nbsp;args&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3424962">i</span>&nbsp;<span class="op" id="3424964">:=</span>&nbsp;<span class="num" id="3424967">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3424970">for</span>&nbsp;<span class="op" id="3424974">;</span>&nbsp;<span class="ident" id="3424976">i</span>&nbsp;<span class="op" id="3424978">&lt;</span>&nbsp;<span class="ident" id="3424980">numFixed</span>&nbsp;<span class="op" id="3424989">&amp;&amp;</span>&nbsp;<span class="ident" id="3424992">i</span>&nbsp;<span class="op" id="3424994">&lt;</span>&nbsp;<span class="builtinfunc" id="3424996">len</span><span class="op" id="3424999">(</span><span class="ident" id="3425000">args</span><span class="op" id="3425004">)</span><span class="op" id="3425005">;</span>&nbsp;<span class="ident" id="3425007">i</span><span class="op" id="3425008">++</span>&nbsp;<span class="op" id="3425011">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425015">argv</span><span class="op" id="3425019">[</span><span class="ident" id="3425020">i</span><span class="op" id="3425021">]</span>&nbsp;<span class="op" id="3425023">=</span>&nbsp;<span class="ident" id="3425025">s</span><span class="op" id="3425026">.</span><span class="ident" id="3425027">evalArg</span><span class="op" id="3425034">(</span><span class="ident" id="3425035">dot</span><span class="op" id="3425038">,</span>&nbsp;<span class="ident" id="3425040">typ</span><span class="op" id="3425043">.</span><span class="ident" id="3425044">In</span><span class="op" id="3425046">(</span><span class="ident" id="3425047">i</span><span class="op" id="3425048">)</span><span class="op" id="3425049">,</span>&nbsp;<span class="ident" id="3425051">args</span><span class="op" id="3425055">[</span><span class="ident" id="3425056">i</span><span class="op" id="3425057">]</span><span class="op" id="3425058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3425064">//&nbsp;Now&nbsp;the&nbsp;...&nbsp;args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425086">if</span>&nbsp;<span class="ident" id="3425089">typ</span><span class="op" id="3425092">.</span><span class="ident" id="3425093">IsVariadic</span><span class="op" id="3425103">(</span><span class="op" id="3425104">)</span>&nbsp;<span class="op" id="3425106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425110">argType</span>&nbsp;<span class="op" id="3425118">:=</span>&nbsp;<span class="ident" id="3425121">typ</span><span class="op" id="3425124">.</span><span class="ident" id="3425125">In</span><span class="op" id="3425127">(</span><span class="ident" id="3425128">typ</span><span class="op" id="3425131">.</span><span class="ident" id="3425132">NumIn</span><span class="op" id="3425137">(</span><span class="op" id="3425138">)</span>&nbsp;<span class="op" id="3425140">-</span>&nbsp;<span class="num" id="3425142">1</span><span class="op" id="3425143">)</span><span class="op" id="3425144">.</span><span class="ident" id="3425145">Elem</span><span class="op" id="3425149">(</span><span class="op" id="3425150">)</span>&nbsp;<span class="comment" id="3425152">//&nbsp;Argument&nbsp;is&nbsp;a&nbsp;slice.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425178">for</span>&nbsp;<span class="op" id="3425182">;</span>&nbsp;<span class="ident" id="3425184">i</span>&nbsp;<span class="op" id="3425186">&lt;</span>&nbsp;<span class="builtinfunc" id="3425188">len</span><span class="op" id="3425191">(</span><span class="ident" id="3425192">args</span><span class="op" id="3425196">)</span><span class="op" id="3425197">;</span>&nbsp;<span class="ident" id="3425199">i</span><span class="op" id="3425200">++</span>&nbsp;<span class="op" id="3425203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425208">argv</span><span class="op" id="3425212">[</span><span class="ident" id="3425213">i</span><span class="op" id="3425214">]</span>&nbsp;<span class="op" id="3425216">=</span>&nbsp;<span class="ident" id="3425218">s</span><span class="op" id="3425219">.</span><span class="ident" id="3425220">evalArg</span><span class="op" id="3425227">(</span><span class="ident" id="3425228">dot</span><span class="op" id="3425231">,</span>&nbsp;<span class="ident" id="3425233">argType</span><span class="op" id="3425240">,</span>&nbsp;<span class="ident" id="3425242">args</span><span class="op" id="3425246">[</span><span class="ident" id="3425247">i</span><span class="op" id="3425248">]</span><span class="op" id="3425249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3425259">//&nbsp;Add&nbsp;final&nbsp;value&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425293">if</span>&nbsp;<span class="ident" id="3425296">final</span><span class="op" id="3425301">.</span><span class="ident" id="3425302">IsValid</span><span class="op" id="3425309">(</span><span class="op" id="3425310">)</span>&nbsp;<span class="op" id="3425312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425316">t</span>&nbsp;<span class="op" id="3425318">:=</span>&nbsp;<span class="ident" id="3425321">typ</span><span class="op" id="3425324">.</span><span class="ident" id="3425325">In</span><span class="op" id="3425327">(</span><span class="ident" id="3425328">typ</span><span class="op" id="3425331">.</span><span class="ident" id="3425332">NumIn</span><span class="op" id="3425337">(</span><span class="op" id="3425338">)</span>&nbsp;<span class="op" id="3425340">-</span>&nbsp;<span class="num" id="3425342">1</span><span class="op" id="3425343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425347">if</span>&nbsp;<span class="ident" id="3425350">typ</span><span class="op" id="3425353">.</span><span class="ident" id="3425354">IsVariadic</span><span class="op" id="3425364">(</span><span class="op" id="3425365">)</span>&nbsp;<span class="op" id="3425367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425372">t</span>&nbsp;<span class="op" id="3425374">=</span>&nbsp;<span class="ident" id="3425376">t</span><span class="op" id="3425377">.</span><span class="ident" id="3425378">Elem</span><span class="op" id="3425382">(</span><span class="op" id="3425383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425387">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425391">argv</span><span class="op" id="3425395">[</span><span class="ident" id="3425396">i</span><span class="op" id="3425397">]</span>&nbsp;<span class="op" id="3425399">=</span>&nbsp;<span class="ident" id="3425401">s</span><span class="op" id="3425402">.</span><span class="ident" id="3425403">validateType</span><span class="op" id="3425415">(</span><span class="ident" id="3425416">final</span><span class="op" id="3425421">,</span>&nbsp;<span class="ident" id="3425423">t</span><span class="op" id="3425424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425430">result</span>&nbsp;<span class="op" id="3425437">:=</span>&nbsp;<span class="ident" id="3425440">fun</span><span class="op" id="3425443">.</span><span class="ident" id="3425444">Call</span><span class="op" id="3425448">(</span><span class="ident" id="3425449">argv</span><span class="op" id="3425453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3425456">//&nbsp;If&nbsp;we&nbsp;have&nbsp;an&nbsp;error&nbsp;that&nbsp;is&nbsp;not&nbsp;nil,&nbsp;stop&nbsp;execution&nbsp;and&nbsp;return&nbsp;that&nbsp;error&nbsp;to&nbsp;the&nbsp;caller.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425549">if</span>&nbsp;<span class="builtinfunc" id="3425552">len</span><span class="op" id="3425555">(</span><span class="ident" id="3425556">result</span><span class="op" id="3425562">)</span>&nbsp;<span class="op" id="3425564">==</span>&nbsp;<span class="num" id="3425567">2</span>&nbsp;<span class="op" id="3425569">&amp;&amp;</span>&nbsp;<span class="op" id="3425572">!</span><span class="ident" id="3425573">result</span><span class="op" id="3425579">[</span><span class="num" id="3425580">1</span><span class="op" id="3425581">]</span><span class="op" id="3425582">.</span><span class="ident" id="3425583">IsNil</span><span class="op" id="3425588">(</span><span class="op" id="3425589">)</span>&nbsp;<span class="op" id="3425591">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425595">s</span><span class="op" id="3425596">.</span><span class="ident" id="3425597">at</span><span class="op" id="3425599">(</span><span class="ident" id="3425600">node</span><span class="op" id="3425604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425608">s</span><span class="op" id="3425609">.</span><span class="ident" id="3425610">errorf</span><span class="op" id="3425616">(</span><span class="string" id="3425617">&#34;error&nbsp;calling&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="3425639">,</span>&nbsp;<span class="ident" id="3425641">name</span><span class="op" id="3425645">,</span>&nbsp;<span class="ident" id="3425647">result</span><span class="op" id="3425653">[</span><span class="num" id="3425654">1</span><span class="op" id="3425655">]</span><span class="op" id="3425656">.</span><span class="ident" id="3425657">Interface</span><span class="op" id="3425666">(</span><span class="op" id="3425667">)</span><span class="op" id="3425668">.</span><span class="op" id="3425669">(</span><span class="builtintype" id="3425670">error</span><span class="op" id="3425675">)</span><span class="op" id="3425676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425682">return</span>&nbsp;<span class="ident" id="3425689">result</span><span class="op" id="3425695">[</span><span class="num" id="3425696">0</span><span class="op" id="3425697">]</span><br>
<span class="lineno"></span><span class="op" id="3425699">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="3425702">//&nbsp;canBeNil&nbsp;reports&nbsp;whether&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;can&nbsp;be&nbsp;assigned&nbsp;to&nbsp;the&nbsp;type.&nbsp;See&nbsp;reflect.Zero.</span><br>
<span class="lineno"></span><span class="keyword" id="3425792">func</span>&nbsp;<span class="ident" id="3425797">canBeNil</span><span class="op" id="3425805">(</span><span class="ident" id="3425806">typ</span>&nbsp;<span class="ident" id="3425810">reflect</span><span class="op" id="3425817">.</span><span class="ident" id="3425818">Type</span><span class="op" id="3425822">)</span>&nbsp;<span class="builtintype" id="3425824">bool</span>&nbsp;<span class="op" id="3425829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425832">switch</span>&nbsp;<span class="ident" id="3425839">typ</span><span class="op" id="3425842">.</span><span class="ident" id="3425843">Kind</span><span class="op" id="3425847">(</span><span class="op" id="3425848">)</span>&nbsp;<span class="op" id="3425850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425853">case</span>&nbsp;<span class="ident" id="3425858">reflect</span><span class="op" id="3425865">.</span><span class="ident" id="3425866">Chan</span><span class="op" id="3425870">,</span>&nbsp;<span class="ident" id="3425872">reflect</span><span class="op" id="3425879">.</span><span class="ident" id="3425880">Func</span><span class="op" id="3425884">,</span>&nbsp;<span class="ident" id="3425886">reflect</span><span class="op" id="3425893">.</span><span class="ident" id="3425894">Interface</span><span class="op" id="3425903">,</span>&nbsp;<span class="ident" id="3425905">reflect</span><span class="op" id="3425912">.</span><span class="ident" id="3425913">Map</span><span class="op" id="3425916">,</span>&nbsp;<span class="ident" id="3425918">reflect</span><span class="op" id="3425925">.</span><span class="ident" id="3425926">Ptr</span><span class="op" id="3425929">,</span>&nbsp;<span class="ident" id="3425931">reflect</span><span class="op" id="3425938">.</span><span class="ident" id="3425939">Slice</span><span class="op" id="3425944">:</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425948">return</span>&nbsp;<span class="builtintype" id="3425955">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425964">return</span>&nbsp;<span class="builtintype" id="3425971">false</span><br>
<span class="lineno"></span><span class="op" id="3425977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="comment" id="3425980">//&nbsp;validateType&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;value&nbsp;is&nbsp;valid&nbsp;and&nbsp;assignable&nbsp;to&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3426059">func</span>&nbsp;<span class="op" id="3426064">(</span><span class="ident" id="3426065">s</span>&nbsp;<span class="op" id="3426067">*</span><span class="ident" id="3426068">state</span><span class="op" id="3426073">)</span>&nbsp;<span class="ident" id="3426075">validateType</span><span class="op" id="3426087">(</span><span class="ident" id="3426088">value</span>&nbsp;<span class="ident" id="3426094">reflect</span><span class="op" id="3426101">.</span><span class="ident" id="3426102">Value</span><span class="op" id="3426107">,</span>&nbsp;<span class="ident" id="3426109">typ</span>&nbsp;<span class="ident" id="3426113">reflect</span><span class="op" id="3426120">.</span><span class="ident" id="3426121">Type</span><span class="op" id="3426125">)</span>&nbsp;<span class="ident" id="3426127">reflect</span><span class="op" id="3426134">.</span><span class="ident" id="3426135">Value</span>&nbsp;<span class="op" id="3426141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426144">if</span>&nbsp;<span class="op" id="3426147">!</span><span class="ident" id="3426148">value</span><span class="op" id="3426153">.</span><span class="ident" id="3426154">IsValid</span><span class="op" id="3426161">(</span><span class="op" id="3426162">)</span>&nbsp;<span class="op" id="3426164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426168">if</span>&nbsp;<span class="ident" id="3426171">typ</span>&nbsp;<span class="op" id="3426175">==</span>&nbsp;<span class="ident" id="3426178">nil</span>&nbsp;<span class="op" id="3426182">||</span>&nbsp;<span class="ident" id="3426185">canBeNil</span><span class="op" id="3426193">(</span><span class="ident" id="3426194">typ</span><span class="op" id="3426197">)</span>&nbsp;<span class="op" id="3426199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3426204">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;interface{}.&nbsp;Accept&nbsp;as&nbsp;a&nbsp;proper&nbsp;nil&nbsp;value.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426268">return</span>&nbsp;<span class="ident" id="3426275">reflect</span><span class="op" id="3426282">.</span><span class="ident" id="3426283">Zero</span><span class="op" id="3426287">(</span><span class="ident" id="3426288">typ</span><span class="op" id="3426291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426299">s</span><span class="op" id="3426300">.</span><span class="ident" id="3426301">errorf</span><span class="op" id="3426307">(</span><span class="string" id="3426308">&#34;invalid&nbsp;value;&nbsp;expected&nbsp;%s&#34;</span><span class="op" id="3426336">,</span>&nbsp;<span class="ident" id="3426338">typ</span><span class="op" id="3426341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426347">if</span>&nbsp;<span class="ident" id="3426350">typ</span>&nbsp;<span class="op" id="3426354">!=</span>&nbsp;<span class="ident" id="3426357">nil</span>&nbsp;<span class="op" id="3426361">&amp;&amp;</span>&nbsp;<span class="op" id="3426364">!</span><span class="ident" id="3426365">value</span><span class="op" id="3426370">.</span><span class="ident" id="3426371">Type</span><span class="op" id="3426375">(</span><span class="op" id="3426376">)</span><span class="op" id="3426377">.</span><span class="ident" id="3426378">AssignableTo</span><span class="op" id="3426390">(</span><span class="ident" id="3426391">typ</span><span class="op" id="3426394">)</span>&nbsp;<span class="op" id="3426396">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426400">if</span>&nbsp;<span class="ident" id="3426403">value</span><span class="op" id="3426408">.</span><span class="ident" id="3426409">Kind</span><span class="op" id="3426413">(</span><span class="op" id="3426414">)</span>&nbsp;<span class="op" id="3426416">==</span>&nbsp;<span class="ident" id="3426419">reflect</span><span class="op" id="3426426">.</span><span class="ident" id="3426427">Interface</span>&nbsp;<span class="op" id="3426437">&amp;&amp;</span>&nbsp;<span class="op" id="3426440">!</span><span class="ident" id="3426441">value</span><span class="op" id="3426446">.</span><span class="ident" id="3426447">IsNil</span><span class="op" id="3426452">(</span><span class="op" id="3426453">)</span>&nbsp;<span class="op" id="3426455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426460">value</span>&nbsp;<span class="op" id="3426466">=</span>&nbsp;<span class="ident" id="3426468">value</span><span class="op" id="3426473">.</span><span class="ident" id="3426474">Elem</span><span class="op" id="3426478">(</span><span class="op" id="3426479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426484">if</span>&nbsp;<span class="ident" id="3426487">value</span><span class="op" id="3426492">.</span><span class="ident" id="3426493">Type</span><span class="op" id="3426497">(</span><span class="op" id="3426498">)</span><span class="op" id="3426499">.</span><span class="ident" id="3426500">AssignableTo</span><span class="op" id="3426512">(</span><span class="ident" id="3426513">typ</span><span class="op" id="3426516">)</span>&nbsp;<span class="op" id="3426518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426524">return</span>&nbsp;<span class="ident" id="3426531">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426540">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3426545">//&nbsp;fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3426566">//&nbsp;Does&nbsp;one&nbsp;dereference&nbsp;or&nbsp;indirection&nbsp;work?&nbsp;We&nbsp;could&nbsp;do&nbsp;more,&nbsp;as&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3426637">//&nbsp;do&nbsp;with&nbsp;method&nbsp;receivers,&nbsp;but&nbsp;that&nbsp;gets&nbsp;messy&nbsp;and&nbsp;method&nbsp;receivers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3426709">//&nbsp;are&nbsp;much&nbsp;more&nbsp;constrained,&nbsp;so&nbsp;it&nbsp;makes&nbsp;more&nbsp;sense&nbsp;there&nbsp;than&nbsp;here.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3426781">//&nbsp;Besides,&nbsp;one&nbsp;is&nbsp;almost&nbsp;always&nbsp;all&nbsp;you&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426830">switch</span>&nbsp;<span class="op" id="3426837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426841">case</span>&nbsp;<span class="ident" id="3426846">value</span><span class="op" id="3426851">.</span><span class="ident" id="3426852">Kind</span><span class="op" id="3426856">(</span><span class="op" id="3426857">)</span>&nbsp;<span class="op" id="3426859">==</span>&nbsp;<span class="ident" id="3426862">reflect</span><span class="op" id="3426869">.</span><span class="ident" id="3426870">Ptr</span>&nbsp;<span class="op" id="3426874">&amp;&amp;</span>&nbsp;<span class="ident" id="3426877">value</span><span class="op" id="3426882">.</span><span class="ident" id="3426883">Type</span><span class="op" id="3426887">(</span><span class="op" id="3426888">)</span><span class="op" id="3426889">.</span><span class="ident" id="3426890">Elem</span><span class="op" id="3426894">(</span><span class="op" id="3426895">)</span><span class="op" id="3426896">.</span><span class="ident" id="3426897">AssignableTo</span><span class="op" id="3426909">(</span><span class="ident" id="3426910">typ</span><span class="op" id="3426913">)</span><span class="op" id="3426914">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426919">value</span>&nbsp;<span class="op" id="3426925">=</span>&nbsp;<span class="ident" id="3426927">value</span><span class="op" id="3426932">.</span><span class="ident" id="3426933">Elem</span><span class="op" id="3426937">(</span><span class="op" id="3426938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426943">if</span>&nbsp;<span class="op" id="3426946">!</span><span class="ident" id="3426947">value</span><span class="op" id="3426952">.</span><span class="ident" id="3426953">IsValid</span><span class="op" id="3426960">(</span><span class="op" id="3426961">)</span>&nbsp;<span class="op" id="3426963">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426969">s</span><span class="op" id="3426970">.</span><span class="ident" id="3426971">errorf</span><span class="op" id="3426977">(</span><span class="string" id="3426978">&#34;dereference&nbsp;of&nbsp;nil&nbsp;pointer&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3427017">,</span>&nbsp;<span class="ident" id="3427019">typ</span><span class="op" id="3427022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3427027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427031">case</span>&nbsp;<span class="ident" id="3427036">reflect</span><span class="op" id="3427043">.</span><span class="ident" id="3427044">PtrTo</span><span class="op" id="3427049">(</span><span class="ident" id="3427050">value</span><span class="op" id="3427055">.</span><span class="ident" id="3427056">Type</span><span class="op" id="3427060">(</span><span class="op" id="3427061">)</span><span class="op" id="3427062">)</span><span class="op" id="3427063">.</span><span class="ident" id="3427064">AssignableTo</span><span class="op" id="3427076">(</span><span class="ident" id="3427077">typ</span><span class="op" id="3427080">)</span>&nbsp;<span class="op" id="3427082">&amp;&amp;</span>&nbsp;<span class="ident" id="3427085">value</span><span class="op" id="3427090">.</span><span class="ident" id="3427091">CanAddr</span><span class="op" id="3427098">(</span><span class="op" id="3427099">)</span><span class="op" id="3427100">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427105">value</span>&nbsp;<span class="op" id="3427111">=</span>&nbsp;<span class="ident" id="3427113">value</span><span class="op" id="3427118">.</span><span class="ident" id="3427119">Addr</span><span class="op" id="3427123">(</span><span class="op" id="3427124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427128">default</span><span class="op" id="3427135">:</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427140">s</span><span class="op" id="3427141">.</span><span class="ident" id="3427142">errorf</span><span class="op" id="3427148">(</span><span class="string" id="3427149">&#34;wrong&nbsp;type&nbsp;for&nbsp;value;&nbsp;expected&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="3427192">,</span>&nbsp;<span class="ident" id="3427194">typ</span><span class="op" id="3427197">,</span>&nbsp;<span class="ident" id="3427199">value</span><span class="op" id="3427204">.</span><span class="ident" id="3427205">Type</span><span class="op" id="3427209">(</span><span class="op" id="3427210">)</span><span class="op" id="3427211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3427215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3427218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427221">return</span>&nbsp;<span class="ident" id="3427228">value</span><br>
<span class="lineno"></span><span class="op" id="3427234">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="3427237">func</span>&nbsp;<span class="op" id="3427242">(</span><span class="ident" id="3427243">s</span>&nbsp;<span class="op" id="3427245">*</span><span class="ident" id="3427246">state</span><span class="op" id="3427251">)</span>&nbsp;<span class="ident" id="3427253">evalArg</span><span class="op" id="3427260">(</span><span class="ident" id="3427261">dot</span>&nbsp;<span class="ident" id="3427265">reflect</span><span class="op" id="3427272">.</span><span class="ident" id="3427273">Value</span><span class="op" id="3427278">,</span>&nbsp;<span class="ident" id="3427280">typ</span>&nbsp;<span class="ident" id="3427284">reflect</span><span class="op" id="3427291">.</span><span class="ident" id="3427292">Type</span><span class="op" id="3427296">,</span>&nbsp;<span class="ident" id="3427298">n</span>&nbsp;<span class="ident" id="3427300">parse</span><span class="op" id="3427305">.</span><span class="ident" id="3427306">Node</span><span class="op" id="3427310">)</span>&nbsp;<span class="ident" id="3427312">reflect</span><span class="op" id="3427319">.</span><span class="ident" id="3427320">Value</span>&nbsp;<span class="op" id="3427326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427329">s</span><span class="op" id="3427330">.</span><span class="ident" id="3427331">at</span><span class="op" id="3427333">(</span><span class="ident" id="3427334">n</span><span class="op" id="3427335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427338">switch</span>&nbsp;<span class="ident" id="3427345">arg</span>&nbsp;<span class="op" id="3427349">:=</span>&nbsp;<span class="ident" id="3427352">n</span><span class="op" id="3427353">.</span><span class="op" id="3427354">(</span><span class="keyword" id="3427355">type</span><span class="op" id="3427359">)</span>&nbsp;<span class="op" id="3427361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427364">case</span>&nbsp;<span class="op" id="3427369">*</span><span class="ident" id="3427370">parse</span><span class="op" id="3427375">.</span><span class="ident" id="3427376">DotNode</span><span class="op" id="3427383">:</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427387">return</span>&nbsp;<span class="ident" id="3427394">s</span><span class="op" id="3427395">.</span><span class="ident" id="3427396">validateType</span><span class="op" id="3427408">(</span><span class="ident" id="3427409">dot</span><span class="op" id="3427412">,</span>&nbsp;<span class="ident" id="3427414">typ</span><span class="op" id="3427417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427420">case</span>&nbsp;<span class="op" id="3427425">*</span><span class="ident" id="3427426">parse</span><span class="op" id="3427431">.</span><span class="ident" id="3427432">NilNode</span><span class="op" id="3427439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427443">if</span>&nbsp;<span class="ident" id="3427446">canBeNil</span><span class="op" id="3427454">(</span><span class="ident" id="3427455">typ</span><span class="op" id="3427458">)</span>&nbsp;<span class="op" id="3427460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427465">return</span>&nbsp;<span class="ident" id="3427472">reflect</span><span class="op" id="3427479">.</span><span class="ident" id="3427480">Zero</span><span class="op" id="3427484">(</span><span class="ident" id="3427485">typ</span><span class="op" id="3427488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3427492">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3427496">s</span><span class="op" id="3427497">.</span><span class="ident" id="3427498">errorf</span><span class="op" id="3427504">(</span><span class="string" id="3427505">&#34;cannot&nbsp;assign&nbsp;nil&nbsp;to&nbsp;%s&#34;</span><span class="op" id="3427530">,</span>&nbsp;<span class="ident" id="3427532">typ</span><span class="op" id="3427535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427538">case</span>&nbsp;<span class="op" id="3427543">*</span><span class="ident" id="3427544">parse</span><span class="op" id="3427549">.</span><span class="ident" id="3427550">FieldNode</span><span class="op" id="3427559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427563">return</span>&nbsp;<span class="ident" id="3427570">s</span><span class="op" id="3427571">.</span><span class="ident" id="3427572">validateType</span><span class="op" id="3427584">(</span><span class="ident" id="3427585">s</span><span class="op" id="3427586">.</span><span class="ident" id="3427587">evalFieldNode</span><span class="op" id="3427600">(</span><span class="ident" id="3427601">dot</span><span class="op" id="3427604">,</span>&nbsp;<span class="ident" id="3427606">arg</span><span class="op" id="3427609">,</span>&nbsp;<span class="op" id="3427611">[</span><span class="op" id="3427612">]</span><span class="ident" id="3427613">parse</span><span class="op" id="3427618">.</span><span class="ident" id="3427619">Node</span><span class="op" id="3427623">{</span><span class="ident" id="3427624">n</span><span class="op" id="3427625">}</span><span class="op" id="3427626">,</span>&nbsp;<span class="ident" id="3427628">zero</span><span class="op" id="3427632">)</span><span class="op" id="3427633">,</span>&nbsp;<span class="ident" id="3427635">typ</span><span class="op" id="3427638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427641">case</span>&nbsp;<span class="op" id="3427646">*</span><span class="ident" id="3427647">parse</span><span class="op" id="3427652">.</span><span class="ident" id="3427653">VariableNode</span><span class="op" id="3427665">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427669">return</span>&nbsp;<span class="ident" id="3427676">s</span><span class="op" id="3427677">.</span><span class="ident" id="3427678">validateType</span><span class="op" id="3427690">(</span><span class="ident" id="3427691">s</span><span class="op" id="3427692">.</span><span class="ident" id="3427693">evalVariableNode</span><span class="op" id="3427709">(</span><span class="ident" id="3427710">dot</span><span class="op" id="3427713">,</span>&nbsp;<span class="ident" id="3427715">arg</span><span class="op" id="3427718">,</span>&nbsp;<span class="ident" id="3427720">nil</span><span class="op" id="3427723">,</span>&nbsp;<span class="ident" id="3427725">zero</span><span class="op" id="3427729">)</span><span class="op" id="3427730">,</span>&nbsp;<span class="ident" id="3427732">typ</span><span class="op" id="3427735">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427738">case</span>&nbsp;<span class="op" id="3427743">*</span><span class="ident" id="3427744">parse</span><span class="op" id="3427749">.</span><span class="ident" id="3427750">PipeNode</span><span class="op" id="3427758">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427762">return</span>&nbsp;<span class="ident" id="3427769">s</span><span class="op" id="3427770">.</span><span class="ident" id="3427771">validateType</span><span class="op" id="3427783">(</span><span class="ident" id="3427784">s</span><span class="op" id="3427785">.</span><span class="ident" id="3427786">evalPipeline</span><span class="op" id="3427798">(</span><span class="ident" id="3427799">dot</span><span class="op" id="3427802">,</span>&nbsp;<span class="ident" id="3427804">arg</span><span class="op" id="3427807">)</span><span class="op" id="3427808">,</span>&nbsp;<span class="ident" id="3427810">typ</span><span class="op" id="3427813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427816">case</span>&nbsp;<span class="op" id="3427821">*</span><span class="ident" id="3427822">parse</span><span class="op" id="3427827">.</span><span class="ident" id="3427828">IdentifierNode</span><span class="op" id="3427842">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427846">return</span>&nbsp;<span class="ident" id="3427853">s</span><span class="op" id="3427854">.</span><span class="ident" id="3427855">evalFunction</span><span class="op" id="3427867">(</span><span class="ident" id="3427868">dot</span><span class="op" id="3427871">,</span>&nbsp;<span class="ident" id="3427873">arg</span><span class="op" id="3427876">,</span>&nbsp;<span class="ident" id="3427878">arg</span><span class="op" id="3427881">,</span>&nbsp;<span class="ident" id="3427883">nil</span><span class="op" id="3427886">,</span>&nbsp;<span class="ident" id="3427888">zero</span><span class="op" id="3427892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427895">case</span>&nbsp;<span class="op" id="3427900">*</span><span class="ident" id="3427901">parse</span><span class="op" id="3427906">.</span><span class="ident" id="3427907">ChainNode</span><span class="op" id="3427916">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427920">return</span>&nbsp;<span class="ident" id="3427927">s</span><span class="op" id="3427928">.</span><span class="ident" id="3427929">validateType</span><span class="op" id="3427941">(</span><span class="ident" id="3427942">s</span><span class="op" id="3427943">.</span><span class="ident" id="3427944">evalChainNode</span><span class="op" id="3427957">(</span><span class="ident" id="3427958">dot</span><span class="op" id="3427961">,</span>&nbsp;<span class="ident" id="3427963">arg</span><span class="op" id="3427966">,</span>&nbsp;<span class="ident" id="3427968">nil</span><span class="op" id="3427971">,</span>&nbsp;<span class="ident" id="3427973">zero</span><span class="op" id="3427977">)</span><span class="op" id="3427978">,</span>&nbsp;<span class="ident" id="3427980">typ</span><span class="op" id="3427983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3427986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3427989">switch</span>&nbsp;<span class="ident" id="3427996">typ</span><span class="op" id="3427999">.</span><span class="ident" id="3428000">Kind</span><span class="op" id="3428004">(</span><span class="op" id="3428005">)</span>&nbsp;<span class="op" id="3428007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428010">case</span>&nbsp;<span class="ident" id="3428015">reflect</span><span class="op" id="3428022">.</span><span class="ident" id="3428023">Bool</span><span class="op" id="3428027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428031">return</span>&nbsp;<span class="ident" id="3428038">s</span><span class="op" id="3428039">.</span><span class="ident" id="3428040">evalBool</span><span class="op" id="3428048">(</span><span class="ident" id="3428049">typ</span><span class="op" id="3428052">,</span>&nbsp;<span class="ident" id="3428054">n</span><span class="op" id="3428055">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428058">case</span>&nbsp;<span class="ident" id="3428063">reflect</span><span class="op" id="3428070">.</span><span class="ident" id="3428071">Complex64</span><span class="op" id="3428080">,</span>&nbsp;<span class="ident" id="3428082">reflect</span><span class="op" id="3428089">.</span><span class="ident" id="3428090">Complex128</span><span class="op" id="3428100">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428104">return</span>&nbsp;<span class="ident" id="3428111">s</span><span class="op" id="3428112">.</span><span class="ident" id="3428113">evalComplex</span><span class="op" id="3428124">(</span><span class="ident" id="3428125">typ</span><span class="op" id="3428128">,</span>&nbsp;<span class="ident" id="3428130">n</span><span class="op" id="3428131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428134">case</span>&nbsp;<span class="ident" id="3428139">reflect</span><span class="op" id="3428146">.</span><span class="ident" id="3428147">Float32</span><span class="op" id="3428154">,</span>&nbsp;<span class="ident" id="3428156">reflect</span><span class="op" id="3428163">.</span><span class="ident" id="3428164">Float64</span><span class="op" id="3428171">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428175">return</span>&nbsp;<span class="ident" id="3428182">s</span><span class="op" id="3428183">.</span><span class="ident" id="3428184">evalFloat</span><span class="op" id="3428193">(</span><span class="ident" id="3428194">typ</span><span class="op" id="3428197">,</span>&nbsp;<span class="ident" id="3428199">n</span><span class="op" id="3428200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428203">case</span>&nbsp;<span class="ident" id="3428208">reflect</span><span class="op" id="3428215">.</span><span class="ident" id="3428216">Int</span><span class="op" id="3428219">,</span>&nbsp;<span class="ident" id="3428221">reflect</span><span class="op" id="3428228">.</span><span class="ident" id="3428229">Int8</span><span class="op" id="3428233">,</span>&nbsp;<span class="ident" id="3428235">reflect</span><span class="op" id="3428242">.</span><span class="ident" id="3428243">Int16</span><span class="op" id="3428248">,</span>&nbsp;<span class="ident" id="3428250">reflect</span><span class="op" id="3428257">.</span><span class="ident" id="3428258">Int32</span><span class="op" id="3428263">,</span>&nbsp;<span class="ident" id="3428265">reflect</span><span class="op" id="3428272">.</span><span class="ident" id="3428273">Int64</span><span class="op" id="3428278">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428282">return</span>&nbsp;<span class="ident" id="3428289">s</span><span class="op" id="3428290">.</span><span class="ident" id="3428291">evalInteger</span><span class="op" id="3428302">(</span><span class="ident" id="3428303">typ</span><span class="op" id="3428306">,</span>&nbsp;<span class="ident" id="3428308">n</span><span class="op" id="3428309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428312">case</span>&nbsp;<span class="ident" id="3428317">reflect</span><span class="op" id="3428324">.</span><span class="ident" id="3428325">Interface</span><span class="op" id="3428334">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428338">if</span>&nbsp;<span class="ident" id="3428341">typ</span><span class="op" id="3428344">.</span><span class="ident" id="3428345">NumMethod</span><span class="op" id="3428354">(</span><span class="op" id="3428355">)</span>&nbsp;<span class="op" id="3428357">==</span>&nbsp;<span class="num" id="3428360">0</span>&nbsp;<span class="op" id="3428362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428367">return</span>&nbsp;<span class="ident" id="3428374">s</span><span class="op" id="3428375">.</span><span class="ident" id="3428376">evalEmptyInterface</span><span class="op" id="3428394">(</span><span class="ident" id="3428395">dot</span><span class="op" id="3428398">,</span>&nbsp;<span class="ident" id="3428400">n</span><span class="op" id="3428401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3428405">}</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428408">case</span>&nbsp;<span class="ident" id="3428413">reflect</span><span class="op" id="3428420">.</span><span class="ident" id="3428421">String</span><span class="op" id="3428427">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428431">return</span>&nbsp;<span class="ident" id="3428438">s</span><span class="op" id="3428439">.</span><span class="ident" id="3428440">evalString</span><span class="op" id="3428450">(</span><span class="ident" id="3428451">typ</span><span class="op" id="3428454">,</span>&nbsp;<span class="ident" id="3428456">n</span><span class="op" id="3428457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428460">case</span>&nbsp;<span class="ident" id="3428465">reflect</span><span class="op" id="3428472">.</span><span class="ident" id="3428473">Uint</span><span class="op" id="3428477">,</span>&nbsp;<span class="ident" id="3428479">reflect</span><span class="op" id="3428486">.</span><span class="ident" id="3428487">Uint8</span><span class="op" id="3428492">,</span>&nbsp;<span class="ident" id="3428494">reflect</span><span class="op" id="3428501">.</span><span class="ident" id="3428502">Uint16</span><span class="op" id="3428508">,</span>&nbsp;<span class="ident" id="3428510">reflect</span><span class="op" id="3428517">.</span><span class="ident" id="3428518">Uint32</span><span class="op" id="3428524">,</span>&nbsp;<span class="ident" id="3428526">reflect</span><span class="op" id="3428533">.</span><span class="ident" id="3428534">Uint64</span><span class="op" id="3428540">,</span>&nbsp;<span class="ident" id="3428542">reflect</span><span class="op" id="3428549">.</span><span class="ident" id="3428550">Uintptr</span><span class="op" id="3428557">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428561">return</span>&nbsp;<span class="ident" id="3428568">s</span><span class="op" id="3428569">.</span><span class="ident" id="3428570">evalUnsignedInteger</span><span class="op" id="3428589">(</span><span class="ident" id="3428590">typ</span><span class="op" id="3428593">,</span>&nbsp;<span class="ident" id="3428595">n</span><span class="op" id="3428596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3428599">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428602">s</span><span class="op" id="3428603">.</span><span class="ident" id="3428604">errorf</span><span class="op" id="3428610">(</span><span class="string" id="3428611">&#34;can&#39;t&nbsp;handle&nbsp;%s&nbsp;for&nbsp;arg&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3428647">,</span>&nbsp;<span class="ident" id="3428649">n</span><span class="op" id="3428650">,</span>&nbsp;<span class="ident" id="3428652">typ</span><span class="op" id="3428655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3428658">panic</span><span class="op" id="3428663">(</span><span class="string" id="3428664">&#34;not&nbsp;reached&#34;</span><span class="op" id="3428677">)</span><br>
<span class="lineno"></span><span class="op" id="3428679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3428682">func</span>&nbsp;<span class="op" id="3428687">(</span><span class="ident" id="3428688">s</span>&nbsp;<span class="op" id="3428690">*</span><span class="ident" id="3428691">state</span><span class="op" id="3428696">)</span>&nbsp;<span class="ident" id="3428698">evalBool</span><span class="op" id="3428706">(</span><span class="ident" id="3428707">typ</span>&nbsp;<span class="ident" id="3428711">reflect</span><span class="op" id="3428718">.</span><span class="ident" id="3428719">Type</span><span class="op" id="3428723">,</span>&nbsp;<span class="ident" id="3428725">n</span>&nbsp;<span class="ident" id="3428727">parse</span><span class="op" id="3428732">.</span><span class="ident" id="3428733">Node</span><span class="op" id="3428737">)</span>&nbsp;<span class="ident" id="3428739">reflect</span><span class="op" id="3428746">.</span><span class="ident" id="3428747">Value</span>&nbsp;<span class="op" id="3428753">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428756">s</span><span class="op" id="3428757">.</span><span class="ident" id="3428758">at</span><span class="op" id="3428760">(</span><span class="ident" id="3428761">n</span><span class="op" id="3428762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428765">if</span>&nbsp;<span class="ident" id="3428768">n</span><span class="op" id="3428769">,</span>&nbsp;<span class="ident" id="3428771">ok</span>&nbsp;<span class="op" id="3428774">:=</span>&nbsp;<span class="ident" id="3428777">n</span><span class="op" id="3428778">.</span><span class="op" id="3428779">(</span><span class="op" id="3428780">*</span><span class="ident" id="3428781">parse</span><span class="op" id="3428786">.</span><span class="ident" id="3428787">BoolNode</span><span class="op" id="3428795">)</span><span class="op" id="3428796">;</span>&nbsp;<span class="ident" id="3428798">ok</span>&nbsp;<span class="op" id="3428801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428805">value</span>&nbsp;<span class="op" id="3428811">:=</span>&nbsp;<span class="ident" id="3428814">reflect</span><span class="op" id="3428821">.</span><span class="ident" id="3428822">New</span><span class="op" id="3428825">(</span><span class="ident" id="3428826">typ</span><span class="op" id="3428829">)</span><span class="op" id="3428830">.</span><span class="ident" id="3428831">Elem</span><span class="op" id="3428835">(</span><span class="op" id="3428836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428840">value</span><span class="op" id="3428845">.</span><span class="ident" id="3428846">SetBool</span><span class="op" id="3428853">(</span><span class="ident" id="3428854">n</span><span class="op" id="3428855">.</span><span class="ident" id="3428856">True</span><span class="op" id="3428860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3428864">return</span>&nbsp;<span class="ident" id="3428871">value</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3428878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3428881">s</span><span class="op" id="3428882">.</span><span class="ident" id="3428883">errorf</span><span class="op" id="3428889">(</span><span class="string" id="3428890">&#34;expected&nbsp;bool;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3428915">,</span>&nbsp;<span class="ident" id="3428917">n</span><span class="op" id="3428918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3428921">panic</span><span class="op" id="3428926">(</span><span class="string" id="3428927">&#34;not&nbsp;reached&#34;</span><span class="op" id="3428940">)</span><br>
<span class="lineno"></span><span class="op" id="3428942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="3428945">func</span>&nbsp;<span class="op" id="3428950">(</span><span class="ident" id="3428951">s</span>&nbsp;<span class="op" id="3428953">*</span><span class="ident" id="3428954">state</span><span class="op" id="3428959">)</span>&nbsp;<span class="ident" id="3428961">evalString</span><span class="op" id="3428971">(</span><span class="ident" id="3428972">typ</span>&nbsp;<span class="ident" id="3428976">reflect</span><span class="op" id="3428983">.</span><span class="ident" id="3428984">Type</span><span class="op" id="3428988">,</span>&nbsp;<span class="ident" id="3428990">n</span>&nbsp;<span class="ident" id="3428992">parse</span><span class="op" id="3428997">.</span><span class="ident" id="3428998">Node</span><span class="op" id="3429002">)</span>&nbsp;<span class="ident" id="3429004">reflect</span><span class="op" id="3429011">.</span><span class="ident" id="3429012">Value</span>&nbsp;<span class="op" id="3429018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429021">s</span><span class="op" id="3429022">.</span><span class="ident" id="3429023">at</span><span class="op" id="3429025">(</span><span class="ident" id="3429026">n</span><span class="op" id="3429027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429030">if</span>&nbsp;<span class="ident" id="3429033">n</span><span class="op" id="3429034">,</span>&nbsp;<span class="ident" id="3429036">ok</span>&nbsp;<span class="op" id="3429039">:=</span>&nbsp;<span class="ident" id="3429042">n</span><span class="op" id="3429043">.</span><span class="op" id="3429044">(</span><span class="op" id="3429045">*</span><span class="ident" id="3429046">parse</span><span class="op" id="3429051">.</span><span class="ident" id="3429052">StringNode</span><span class="op" id="3429062">)</span><span class="op" id="3429063">;</span>&nbsp;<span class="ident" id="3429065">ok</span>&nbsp;<span class="op" id="3429068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429072">value</span>&nbsp;<span class="op" id="3429078">:=</span>&nbsp;<span class="ident" id="3429081">reflect</span><span class="op" id="3429088">.</span><span class="ident" id="3429089">New</span><span class="op" id="3429092">(</span><span class="ident" id="3429093">typ</span><span class="op" id="3429096">)</span><span class="op" id="3429097">.</span><span class="ident" id="3429098">Elem</span><span class="op" id="3429102">(</span><span class="op" id="3429103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429107">value</span><span class="op" id="3429112">.</span><span class="ident" id="3429113">SetString</span><span class="op" id="3429122">(</span><span class="ident" id="3429123">n</span><span class="op" id="3429124">.</span><span class="ident" id="3429125">Text</span><span class="op" id="3429129">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429133">return</span>&nbsp;<span class="ident" id="3429140">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429150">s</span><span class="op" id="3429151">.</span><span class="ident" id="3429152">errorf</span><span class="op" id="3429158">(</span><span class="string" id="3429159">&#34;expected&nbsp;string;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3429186">,</span>&nbsp;<span class="ident" id="3429188">n</span><span class="op" id="3429189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3429192">panic</span><span class="op" id="3429197">(</span><span class="string" id="3429198">&#34;not&nbsp;reached&#34;</span><span class="op" id="3429211">)</span><br>
<span class="lineno"></span><span class="op" id="3429213">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="3429216">func</span>&nbsp;<span class="op" id="3429221">(</span><span class="ident" id="3429222">s</span>&nbsp;<span class="op" id="3429224">*</span><span class="ident" id="3429225">state</span><span class="op" id="3429230">)</span>&nbsp;<span class="ident" id="3429232">evalInteger</span><span class="op" id="3429243">(</span><span class="ident" id="3429244">typ</span>&nbsp;<span class="ident" id="3429248">reflect</span><span class="op" id="3429255">.</span><span class="ident" id="3429256">Type</span><span class="op" id="3429260">,</span>&nbsp;<span class="ident" id="3429262">n</span>&nbsp;<span class="ident" id="3429264">parse</span><span class="op" id="3429269">.</span><span class="ident" id="3429270">Node</span><span class="op" id="3429274">)</span>&nbsp;<span class="ident" id="3429276">reflect</span><span class="op" id="3429283">.</span><span class="ident" id="3429284">Value</span>&nbsp;<span class="op" id="3429290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429293">s</span><span class="op" id="3429294">.</span><span class="ident" id="3429295">at</span><span class="op" id="3429297">(</span><span class="ident" id="3429298">n</span><span class="op" id="3429299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429302">if</span>&nbsp;<span class="ident" id="3429305">n</span><span class="op" id="3429306">,</span>&nbsp;<span class="ident" id="3429308">ok</span>&nbsp;<span class="op" id="3429311">:=</span>&nbsp;<span class="ident" id="3429314">n</span><span class="op" id="3429315">.</span><span class="op" id="3429316">(</span><span class="op" id="3429317">*</span><span class="ident" id="3429318">parse</span><span class="op" id="3429323">.</span><span class="ident" id="3429324">NumberNode</span><span class="op" id="3429334">)</span><span class="op" id="3429335">;</span>&nbsp;<span class="ident" id="3429337">ok</span>&nbsp;<span class="op" id="3429340">&amp;&amp;</span>&nbsp;<span class="ident" id="3429343">n</span><span class="op" id="3429344">.</span><span class="ident" id="3429345">IsInt</span>&nbsp;<span class="op" id="3429351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429355">value</span>&nbsp;<span class="op" id="3429361">:=</span>&nbsp;<span class="ident" id="3429364">reflect</span><span class="op" id="3429371">.</span><span class="ident" id="3429372">New</span><span class="op" id="3429375">(</span><span class="ident" id="3429376">typ</span><span class="op" id="3429379">)</span><span class="op" id="3429380">.</span><span class="ident" id="3429381">Elem</span><span class="op" id="3429385">(</span><span class="op" id="3429386">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429390">value</span><span class="op" id="3429395">.</span><span class="ident" id="3429396">SetInt</span><span class="op" id="3429402">(</span><span class="ident" id="3429403">n</span><span class="op" id="3429404">.</span><span class="ident" id="3429405">Int64</span><span class="op" id="3429410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429414">return</span>&nbsp;<span class="ident" id="3429421">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429431">s</span><span class="op" id="3429432">.</span><span class="ident" id="3429433">errorf</span><span class="op" id="3429439">(</span><span class="string" id="3429440">&#34;expected&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3429468">,</span>&nbsp;<span class="ident" id="3429470">n</span><span class="op" id="3429471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3429474">panic</span><span class="op" id="3429479">(</span><span class="string" id="3429480">&#34;not&nbsp;reached&#34;</span><span class="op" id="3429493">)</span><br>
<span class="lineno">695</span><span class="op" id="3429495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3429498">func</span>&nbsp;<span class="op" id="3429503">(</span><span class="ident" id="3429504">s</span>&nbsp;<span class="op" id="3429506">*</span><span class="ident" id="3429507">state</span><span class="op" id="3429512">)</span>&nbsp;<span class="ident" id="3429514">evalUnsignedInteger</span><span class="op" id="3429533">(</span><span class="ident" id="3429534">typ</span>&nbsp;<span class="ident" id="3429538">reflect</span><span class="op" id="3429545">.</span><span class="ident" id="3429546">Type</span><span class="op" id="3429550">,</span>&nbsp;<span class="ident" id="3429552">n</span>&nbsp;<span class="ident" id="3429554">parse</span><span class="op" id="3429559">.</span><span class="ident" id="3429560">Node</span><span class="op" id="3429564">)</span>&nbsp;<span class="ident" id="3429566">reflect</span><span class="op" id="3429573">.</span><span class="ident" id="3429574">Value</span>&nbsp;<span class="op" id="3429580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429583">s</span><span class="op" id="3429584">.</span><span class="ident" id="3429585">at</span><span class="op" id="3429587">(</span><span class="ident" id="3429588">n</span><span class="op" id="3429589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429592">if</span>&nbsp;<span class="ident" id="3429595">n</span><span class="op" id="3429596">,</span>&nbsp;<span class="ident" id="3429598">ok</span>&nbsp;<span class="op" id="3429601">:=</span>&nbsp;<span class="ident" id="3429604">n</span><span class="op" id="3429605">.</span><span class="op" id="3429606">(</span><span class="op" id="3429607">*</span><span class="ident" id="3429608">parse</span><span class="op" id="3429613">.</span><span class="ident" id="3429614">NumberNode</span><span class="op" id="3429624">)</span><span class="op" id="3429625">;</span>&nbsp;<span class="ident" id="3429627">ok</span>&nbsp;<span class="op" id="3429630">&amp;&amp;</span>&nbsp;<span class="ident" id="3429633">n</span><span class="op" id="3429634">.</span><span class="ident" id="3429635">IsUint</span>&nbsp;<span class="op" id="3429642">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429646">value</span>&nbsp;<span class="op" id="3429652">:=</span>&nbsp;<span class="ident" id="3429655">reflect</span><span class="op" id="3429662">.</span><span class="ident" id="3429663">New</span><span class="op" id="3429666">(</span><span class="ident" id="3429667">typ</span><span class="op" id="3429670">)</span><span class="op" id="3429671">.</span><span class="ident" id="3429672">Elem</span><span class="op" id="3429676">(</span><span class="op" id="3429677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429681">value</span><span class="op" id="3429686">.</span><span class="ident" id="3429687">SetUint</span><span class="op" id="3429694">(</span><span class="ident" id="3429695">n</span><span class="op" id="3429696">.</span><span class="ident" id="3429697">Uint64</span><span class="op" id="3429703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429707">return</span>&nbsp;<span class="ident" id="3429714">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3429721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429724">s</span><span class="op" id="3429725">.</span><span class="ident" id="3429726">errorf</span><span class="op" id="3429732">(</span><span class="string" id="3429733">&#34;expected&nbsp;unsigned&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3429770">,</span>&nbsp;<span class="ident" id="3429772">n</span><span class="op" id="3429773">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3429776">panic</span><span class="op" id="3429781">(</span><span class="string" id="3429782">&#34;not&nbsp;reached&#34;</span><span class="op" id="3429795">)</span><br>
<span class="lineno"></span><span class="op" id="3429797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3429800">func</span>&nbsp;<span class="op" id="3429805">(</span><span class="ident" id="3429806">s</span>&nbsp;<span class="op" id="3429808">*</span><span class="ident" id="3429809">state</span><span class="op" id="3429814">)</span>&nbsp;<span class="ident" id="3429816">evalFloat</span><span class="op" id="3429825">(</span><span class="ident" id="3429826">typ</span>&nbsp;<span class="ident" id="3429830">reflect</span><span class="op" id="3429837">.</span><span class="ident" id="3429838">Type</span><span class="op" id="3429842">,</span>&nbsp;<span class="ident" id="3429844">n</span>&nbsp;<span class="ident" id="3429846">parse</span><span class="op" id="3429851">.</span><span class="ident" id="3429852">Node</span><span class="op" id="3429856">)</span>&nbsp;<span class="ident" id="3429858">reflect</span><span class="op" id="3429865">.</span><span class="ident" id="3429866">Value</span>&nbsp;<span class="op" id="3429872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429875">s</span><span class="op" id="3429876">.</span><span class="ident" id="3429877">at</span><span class="op" id="3429879">(</span><span class="ident" id="3429880">n</span><span class="op" id="3429881">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3429884">if</span>&nbsp;<span class="ident" id="3429887">n</span><span class="op" id="3429888">,</span>&nbsp;<span class="ident" id="3429890">ok</span>&nbsp;<span class="op" id="3429893">:=</span>&nbsp;<span class="ident" id="3429896">n</span><span class="op" id="3429897">.</span><span class="op" id="3429898">(</span><span class="op" id="3429899">*</span><span class="ident" id="3429900">parse</span><span class="op" id="3429905">.</span><span class="ident" id="3429906">NumberNode</span><span class="op" id="3429916">)</span><span class="op" id="3429917">;</span>&nbsp;<span class="ident" id="3429919">ok</span>&nbsp;<span class="op" id="3429922">&amp;&amp;</span>&nbsp;<span class="ident" id="3429925">n</span><span class="op" id="3429926">.</span><span class="ident" id="3429927">IsFloat</span>&nbsp;<span class="op" id="3429935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429939">value</span>&nbsp;<span class="op" id="3429945">:=</span>&nbsp;<span class="ident" id="3429948">reflect</span><span class="op" id="3429955">.</span><span class="ident" id="3429956">New</span><span class="op" id="3429959">(</span><span class="ident" id="3429960">typ</span><span class="op" id="3429963">)</span><span class="op" id="3429964">.</span><span class="ident" id="3429965">Elem</span><span class="op" id="3429969">(</span><span class="op" id="3429970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3429974">value</span><span class="op" id="3429979">.</span><span class="ident" id="3429980">SetFloat</span><span class="op" id="3429988">(</span><span class="ident" id="3429989">n</span><span class="op" id="3429990">.</span><span class="ident" id="3429991">Float64</span><span class="op" id="3429998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430002">return</span>&nbsp;<span class="ident" id="3430009">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3430016">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3430019">s</span><span class="op" id="3430020">.</span><span class="ident" id="3430021">errorf</span><span class="op" id="3430027">(</span><span class="string" id="3430028">&#34;expected&nbsp;float;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3430054">,</span>&nbsp;<span class="ident" id="3430056">n</span><span class="op" id="3430057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3430060">panic</span><span class="op" id="3430065">(</span><span class="string" id="3430066">&#34;not&nbsp;reached&#34;</span><span class="op" id="3430079">)</span><br>
<span class="lineno"></span><span class="op" id="3430081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3430084">func</span>&nbsp;<span class="op" id="3430089">(</span><span class="ident" id="3430090">s</span>&nbsp;<span class="op" id="3430092">*</span><span class="ident" id="3430093">state</span><span class="op" id="3430098">)</span>&nbsp;<span class="ident" id="3430100">evalComplex</span><span class="op" id="3430111">(</span><span class="ident" id="3430112">typ</span>&nbsp;<span class="ident" id="3430116">reflect</span><span class="op" id="3430123">.</span><span class="ident" id="3430124">Type</span><span class="op" id="3430128">,</span>&nbsp;<span class="ident" id="3430130">n</span>&nbsp;<span class="ident" id="3430132">parse</span><span class="op" id="3430137">.</span><span class="ident" id="3430138">Node</span><span class="op" id="3430142">)</span>&nbsp;<span class="ident" id="3430144">reflect</span><span class="op" id="3430151">.</span><span class="ident" id="3430152">Value</span>&nbsp;<span class="op" id="3430158">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430161">if</span>&nbsp;<span class="ident" id="3430164">n</span><span class="op" id="3430165">,</span>&nbsp;<span class="ident" id="3430167">ok</span>&nbsp;<span class="op" id="3430170">:=</span>&nbsp;<span class="ident" id="3430173">n</span><span class="op" id="3430174">.</span><span class="op" id="3430175">(</span><span class="op" id="3430176">*</span><span class="ident" id="3430177">parse</span><span class="op" id="3430182">.</span><span class="ident" id="3430183">NumberNode</span><span class="op" id="3430193">)</span><span class="op" id="3430194">;</span>&nbsp;<span class="ident" id="3430196">ok</span>&nbsp;<span class="op" id="3430199">&amp;&amp;</span>&nbsp;<span class="ident" id="3430202">n</span><span class="op" id="3430203">.</span><span class="ident" id="3430204">IsComplex</span>&nbsp;<span class="op" id="3430214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3430218">value</span>&nbsp;<span class="op" id="3430224">:=</span>&nbsp;<span class="ident" id="3430227">reflect</span><span class="op" id="3430234">.</span><span class="ident" id="3430235">New</span><span class="op" id="3430238">(</span><span class="ident" id="3430239">typ</span><span class="op" id="3430242">)</span><span class="op" id="3430243">.</span><span class="ident" id="3430244">Elem</span><span class="op" id="3430248">(</span><span class="op" id="3430249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3430253">value</span><span class="op" id="3430258">.</span><span class="ident" id="3430259">SetComplex</span><span class="op" id="3430269">(</span><span class="ident" id="3430270">n</span><span class="op" id="3430271">.</span><span class="ident" id="3430272">Complex128</span><span class="op" id="3430282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430286">return</span>&nbsp;<span class="ident" id="3430293">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3430300">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3430303">s</span><span class="op" id="3430304">.</span><span class="ident" id="3430305">errorf</span><span class="op" id="3430311">(</span><span class="string" id="3430312">&#34;expected&nbsp;complex;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3430340">,</span>&nbsp;<span class="ident" id="3430342">n</span><span class="op" id="3430343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3430346">panic</span><span class="op" id="3430351">(</span><span class="string" id="3430352">&#34;not&nbsp;reached&#34;</span><span class="op" id="3430365">)</span><br>
<span class="lineno"></span><span class="op" id="3430367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3430370">func</span>&nbsp;<span class="op" id="3430375">(</span><span class="ident" id="3430376">s</span>&nbsp;<span class="op" id="3430378">*</span><span class="ident" id="3430379">state</span><span class="op" id="3430384">)</span>&nbsp;<span class="ident" id="3430386">evalEmptyInterface</span><span class="op" id="3430404">(</span><span class="ident" id="3430405">dot</span>&nbsp;<span class="ident" id="3430409">reflect</span><span class="op" id="3430416">.</span><span class="ident" id="3430417">Value</span><span class="op" id="3430422">,</span>&nbsp;<span class="ident" id="3430424">n</span>&nbsp;<span class="ident" id="3430426">parse</span><span class="op" id="3430431">.</span><span class="ident" id="3430432">Node</span><span class="op" id="3430436">)</span>&nbsp;<span class="ident" id="3430438">reflect</span><span class="op" id="3430445">.</span><span class="ident" id="3430446">Value</span>&nbsp;<span class="op" id="3430452">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3430455">s</span><span class="op" id="3430456">.</span><span class="ident" id="3430457">at</span><span class="op" id="3430459">(</span><span class="ident" id="3430460">n</span><span class="op" id="3430461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430464">switch</span>&nbsp;<span class="ident" id="3430471">n</span>&nbsp;<span class="op" id="3430473">:=</span>&nbsp;<span class="ident" id="3430476">n</span><span class="op" id="3430477">.</span><span class="op" id="3430478">(</span><span class="keyword" id="3430479">type</span><span class="op" id="3430483">)</span>&nbsp;<span class="op" id="3430485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430488">case</span>&nbsp;<span class="op" id="3430493">*</span><span class="ident" id="3430494">parse</span><span class="op" id="3430499">.</span><span class="ident" id="3430500">BoolNode</span><span class="op" id="3430508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430512">return</span>&nbsp;<span class="ident" id="3430519">reflect</span><span class="op" id="3430526">.</span><span class="ident" id="3430527">ValueOf</span><span class="op" id="3430534">(</span><span class="ident" id="3430535">n</span><span class="op" id="3430536">.</span><span class="ident" id="3430537">True</span><span class="op" id="3430541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430544">case</span>&nbsp;<span class="op" id="3430549">*</span><span class="ident" id="3430550">parse</span><span class="op" id="3430555">.</span><span class="ident" id="3430556">DotNode</span><span class="op" id="3430563">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430567">return</span>&nbsp;<span class="ident" id="3430574">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430579">case</span>&nbsp;<span class="op" id="3430584">*</span><span class="ident" id="3430585">parse</span><span class="op" id="3430590">.</span><span class="ident" id="3430591">FieldNode</span><span class="op" id="3430600">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430604">return</span>&nbsp;<span class="ident" id="3430611">s</span><span class="op" id="3430612">.</span><span class="ident" id="3430613">evalFieldNode</span><span class="op" id="3430626">(</span><span class="ident" id="3430627">dot</span><span class="op" id="3430630">,</span>&nbsp;<span class="ident" id="3430632">n</span><span class="op" id="3430633">,</span>&nbsp;<span class="ident" id="3430635">nil</span><span class="op" id="3430638">,</span>&nbsp;<span class="ident" id="3430640">zero</span><span class="op" id="3430644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430647">case</span>&nbsp;<span class="op" id="3430652">*</span><span class="ident" id="3430653">parse</span><span class="op" id="3430658">.</span><span class="ident" id="3430659">IdentifierNode</span><span class="op" id="3430673">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430677">return</span>&nbsp;<span class="ident" id="3430684">s</span><span class="op" id="3430685">.</span><span class="ident" id="3430686">evalFunction</span><span class="op" id="3430698">(</span><span class="ident" id="3430699">dot</span><span class="op" id="3430702">,</span>&nbsp;<span class="ident" id="3430704">n</span><span class="op" id="3430705">,</span>&nbsp;<span class="ident" id="3430707">n</span><span class="op" id="3430708">,</span>&nbsp;<span class="ident" id="3430710">nil</span><span class="op" id="3430713">,</span>&nbsp;<span class="ident" id="3430715">zero</span><span class="op" id="3430719">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430722">case</span>&nbsp;<span class="op" id="3430727">*</span><span class="ident" id="3430728">parse</span><span class="op" id="3430733">.</span><span class="ident" id="3430734">NilNode</span><span class="op" id="3430741">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3430745">//&nbsp;NilNode&nbsp;is&nbsp;handled&nbsp;in&nbsp;evalArg,&nbsp;the&nbsp;only&nbsp;place&nbsp;that&nbsp;calls&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3430813">s</span><span class="op" id="3430814">.</span><span class="ident" id="3430815">errorf</span><span class="op" id="3430821">(</span><span class="string" id="3430822">&#34;evalEmptyInterface:&nbsp;nil&nbsp;(can&#39;t&nbsp;happen)&#34;</span><span class="op" id="3430862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430865">case</span>&nbsp;<span class="op" id="3430870">*</span><span class="ident" id="3430871">parse</span><span class="op" id="3430876">.</span><span class="ident" id="3430877">NumberNode</span><span class="op" id="3430887">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430891">return</span>&nbsp;<span class="ident" id="3430898">s</span><span class="op" id="3430899">.</span><span class="ident" id="3430900">idealConstant</span><span class="op" id="3430913">(</span><span class="ident" id="3430914">n</span><span class="op" id="3430915">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430918">case</span>&nbsp;<span class="op" id="3430923">*</span><span class="ident" id="3430924">parse</span><span class="op" id="3430929">.</span><span class="ident" id="3430930">StringNode</span><span class="op" id="3430940">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430944">return</span>&nbsp;<span class="ident" id="3430951">reflect</span><span class="op" id="3430958">.</span><span class="ident" id="3430959">ValueOf</span><span class="op" id="3430966">(</span><span class="ident" id="3430967">n</span><span class="op" id="3430968">.</span><span class="ident" id="3430969">Text</span><span class="op" id="3430973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3430976">case</span>&nbsp;<span class="op" id="3430981">*</span><span class="ident" id="3430982">parse</span><span class="op" id="3430987">.</span><span class="ident" id="3430988">VariableNode</span><span class="op" id="3431000">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3431004">return</span>&nbsp;<span class="ident" id="3431011">s</span><span class="op" id="3431012">.</span><span class="ident" id="3431013">evalVariableNode</span><span class="op" id="3431029">(</span><span class="ident" id="3431030">dot</span><span class="op" id="3431033">,</span>&nbsp;<span class="ident" id="3431035">n</span><span class="op" id="3431036">,</span>&nbsp;<span class="ident" id="3431038">nil</span><span class="op" id="3431041">,</span>&nbsp;<span class="ident" id="3431043">zero</span><span class="op" id="3431047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3431050">case</span>&nbsp;<span class="op" id="3431055">*</span><span class="ident" id="3431056">parse</span><span class="op" id="3431061">.</span><span class="ident" id="3431062">PipeNode</span><span class="op" id="3431070">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3431074">return</span>&nbsp;<span class="ident" id="3431081">s</span><span class="op" id="3431082">.</span><span class="ident" id="3431083">evalPipeline</span><span class="op" id="3431095">(</span><span class="ident" id="3431096">dot</span><span class="op" id="3431099">,</span>&nbsp;<span class="ident" id="3431101">n</span><span class="op" id="3431102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3431105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3431108">s</span><span class="op" id="3431109">.</span><span class="ident" id="3431110">errorf</span><span class="op" id="3431116">(</span><span class="string" id="3431117">&#34;can&#39;t&nbsp;handle&nbsp;assignment&nbsp;of&nbsp;%s&nbsp;to&nbsp;empty&nbsp;interface&nbsp;argument&#34;</span><span class="op" id="3431176">,</span>&nbsp;<span class="ident" id="3431178">n</span><span class="op" id="3431179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3431182">panic</span><span class="op" id="3431187">(</span><span class="string" id="3431188">&#34;not&nbsp;reached&#34;</span><span class="op" id="3431201">)</span><br>
<span class="lineno"></span><span class="op" id="3431203">}</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="comment" id="3431206">//&nbsp;indirect&nbsp;returns&nbsp;the&nbsp;item&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;indirection,&nbsp;and&nbsp;a&nbsp;bool&nbsp;to&nbsp;indicate&nbsp;if&nbsp;it&#39;s&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="3431298">//&nbsp;We&nbsp;indirect&nbsp;through&nbsp;pointers&nbsp;and&nbsp;empty&nbsp;interfaces&nbsp;(only)&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="3431366">//&nbsp;non-empty&nbsp;interfaces&nbsp;have&nbsp;methods&nbsp;we&nbsp;might&nbsp;need.</span><br>
<span class="lineno"></span><span class="keyword" id="3431418">func</span>&nbsp;<span class="ident" id="3431423">indirect</span><span class="op" id="3431431">(</span><span class="ident" id="3431432">v</span>&nbsp;<span class="ident" id="3431434">reflect</span><span class="op" id="3431441">.</span><span class="ident" id="3431442">Value</span><span class="op" id="3431447">)</span>&nbsp;<span class="op" id="3431449">(</span><span class="ident" id="3431450">rv</span>&nbsp;<span class="ident" id="3431453">reflect</span><span class="op" id="3431460">.</span><span class="ident" id="3431461">Value</span><span class="op" id="3431466">,</span>&nbsp;<span class="ident" id="3431468">isNil</span>&nbsp;<span class="builtintype" id="3431474">bool</span><span class="op" id="3431478">)</span>&nbsp;<span class="op" id="3431480">{</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3431483">for</span>&nbsp;<span class="op" id="3431487">;</span>&nbsp;<span class="ident" id="3431489">v</span><span class="op" id="3431490">.</span><span class="ident" id="3431491">Kind</span><span class="op" id="3431495">(</span><span class="op" id="3431496">)</span>&nbsp;<span class="op" id="3431498">==</span>&nbsp;<span class="ident" id="3431501">reflect</span><span class="op" id="3431508">.</span><span class="ident" id="3431509">Ptr</span>&nbsp;<span class="op" id="3431513">||</span>&nbsp;<span class="ident" id="3431516">v</span><span class="op" id="3431517">.</span><span class="ident" id="3431518">Kind</span><span class="op" id="3431522">(</span><span class="op" id="3431523">)</span>&nbsp;<span class="op" id="3431525">==</span>&nbsp;<span class="ident" id="3431528">reflect</span><span class="op" id="3431535">.</span><span class="ident" id="3431536">Interface</span><span class="op" id="3431545">;</span>&nbsp;<span class="ident" id="3431547">v</span>&nbsp;<span class="op" id="3431549">=</span>&nbsp;<span class="ident" id="3431551">v</span><span class="op" id="3431552">.</span><span class="ident" id="3431553">Elem</span><span class="op" id="3431557">(</span><span class="op" id="3431558">)</span>&nbsp;<span class="op" id="3431560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3431564">if</span>&nbsp;<span class="ident" id="3431567">v</span><span class="op" id="3431568">.</span><span class="ident" id="3431569">IsNil</span><span class="op" id="3431574">(</span><span class="op" id="3431575">)</span>&nbsp;<span class="op" id="3431577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3431582">return</span>&nbsp;<span class="ident" id="3431589">v</span><span class="op" id="3431590">,</span>&nbsp;<span class="builtintype" id="3431592">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3431599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3431603">if</span>&nbsp;<span class="ident" id="3431606">v</span><span class="op" id="3431607">.</span><span class="ident" id="3431608">Kind</span><span class="op" id="3431612">(</span><span class="op" id="3431613">)</span>&nbsp;<span class="op" id="3431615">==</span>&nbsp;<span class="ident" id="3431618">reflect</span><span class="op" id="3431625">.</span><span class="ident" id="3431626">Interface</span>&nbsp;<span class="op" id="3431636">&amp;&amp;</span>&nbsp;<span class="ident" id="3431639">v</span><span class="op" id="3431640">.</span><span class="ident" id="3431641">NumMethod</span><span class="op" id="3431650">(</span><span class="op" id="3431651">)</span>&nbsp;<span class="op" id="3431653">&gt;</span>&nbsp;<span class="num" id="3431655">0</span>&nbsp;<span class="op" id="3431657">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3431662">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3431670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3431673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3431676">return</span>&nbsp;<span class="ident" id="3431683">v</span><span class="op" id="3431684">,</span>&nbsp;<span class="builtintype" id="3431686">false</span><br>
<span class="lineno"></span><span class="op" id="3431692">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="comment" id="3431695">//&nbsp;printValue&nbsp;writes&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of&nbsp;the&nbsp;value&nbsp;to&nbsp;the&nbsp;output&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3431773">//&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="3431790">func</span>&nbsp;<span class="op" id="3431795">(</span><span class="ident" id="3431796">s</span>&nbsp;<span class="op" id="3431798">*</span><span class="ident" id="3431799">state</span><span class="op" id="3431804">)</span>&nbsp;<span class="ident" id="3431806">printValue</span><span class="op" id="3431816">(</span><span class="ident" id="3431817">n</span>&nbsp;<span class="ident" id="3431819">parse</span><span class="op" id="3431824">.</span><span class="ident" id="3431825">Node</span><span class="op" id="3431829">,</span>&nbsp;<span class="ident" id="3431831">v</span>&nbsp;<span class="ident" id="3431833">reflect</span><span class="op" id="3431840">.</span><span class="ident" id="3431841">Value</span><span class="op" id="3431846">)</span>&nbsp;<span class="op" id="3431848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3431851">s</span><span class="op" id="3431852">.</span><span class="ident" id="3431853">at</span><span class="op" id="3431855">(</span><span class="ident" id="3431856">n</span><span class="op" id="3431857">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3431860">iface</span><span class="op" id="3431865">,</span>&nbsp;<span class="ident" id="3431867">ok</span>&nbsp;<span class="op" id="3431870">:=</span>&nbsp;<span class="ident" id="3431873">printableValue</span><span class="op" id="3431887">(</span><span class="ident" id="3431888">v</span><span class="op" id="3431889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3431892">if</span>&nbsp;<span class="op" id="3431895">!</span><span class="ident" id="3431896">ok</span>&nbsp;<span class="op" id="3431899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3431903">s</span><span class="op" id="3431904">.</span><span class="ident" id="3431905">errorf</span><span class="op" id="3431911">(</span><span class="string" id="3431912">&#34;can&#39;t&nbsp;print&nbsp;%s&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3431939">,</span>&nbsp;<span class="ident" id="3431941">n</span><span class="op" id="3431942">,</span>&nbsp;<span class="ident" id="3431944">v</span><span class="op" id="3431945">.</span><span class="ident" id="3431946">Type</span><span class="op" id="3431950">(</span><span class="op" id="3431951">)</span><span class="op" id="3431952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3431955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3431958">fmt</span><span class="op" id="3431961">.</span><span class="ident" id="3431962">Fprint</span><span class="op" id="3431968">(</span><span class="ident" id="3431969">s</span><span class="op" id="3431970">.</span><span class="ident" id="3431971">wr</span><span class="op" id="3431973">,</span>&nbsp;<span class="ident" id="3431975">iface</span><span class="op" id="3431980">)</span><br>
<span class="lineno">780</span><span class="op" id="3431982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3431985">//&nbsp;printableValue&nbsp;returns&nbsp;the,&nbsp;possibly&nbsp;indirected,&nbsp;interface&nbsp;value&nbsp;inside&nbsp;v&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3432067">//&nbsp;is&nbsp;best&nbsp;for&nbsp;a&nbsp;call&nbsp;to&nbsp;formatted&nbsp;printer.</span><br>
<span class="lineno"></span><span class="keyword" id="3432111">func</span>&nbsp;<span class="ident" id="3432116">printableValue</span><span class="op" id="3432130">(</span><span class="ident" id="3432131">v</span>&nbsp;<span class="ident" id="3432133">reflect</span><span class="op" id="3432140">.</span><span class="ident" id="3432141">Value</span><span class="op" id="3432146">)</span>&nbsp;<span class="op" id="3432148">(</span><span class="keyword" id="3432149">interface</span><span class="op" id="3432158">{</span><span class="op" id="3432159">}</span><span class="op" id="3432160">,</span>&nbsp;<span class="builtintype" id="3432162">bool</span><span class="op" id="3432166">)</span>&nbsp;<span class="op" id="3432168">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3432171">if</span>&nbsp;<span class="ident" id="3432174">v</span><span class="op" id="3432175">.</span><span class="ident" id="3432176">Kind</span><span class="op" id="3432180">(</span><span class="op" id="3432181">)</span>&nbsp;<span class="op" id="3432183">==</span>&nbsp;<span class="ident" id="3432186">reflect</span><span class="op" id="3432193">.</span><span class="ident" id="3432194">Ptr</span>&nbsp;<span class="op" id="3432198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3432202">v</span><span class="op" id="3432203">,</span>&nbsp;<span class="ident" id="3432205">_</span>&nbsp;<span class="op" id="3432207">=</span>&nbsp;<span class="ident" id="3432209">indirect</span><span class="op" id="3432217">(</span><span class="ident" id="3432218">v</span><span class="op" id="3432219">)</span>&nbsp;<span class="comment" id="3432221">//&nbsp;fmt.Fprint&nbsp;handles&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3432249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3432252">if</span>&nbsp;<span class="op" id="3432255">!</span><span class="ident" id="3432256">v</span><span class="op" id="3432257">.</span><span class="ident" id="3432258">IsValid</span><span class="op" id="3432265">(</span><span class="op" id="3432266">)</span>&nbsp;<span class="op" id="3432268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3432272">return</span>&nbsp;<span class="string" id="3432279">&#34;&lt;no&nbsp;value&gt;&#34;</span><span class="op" id="3432291">,</span>&nbsp;<span class="builtintype" id="3432293">true</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3432299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3432303">if</span>&nbsp;<span class="op" id="3432306">!</span><span class="ident" id="3432307">v</span><span class="op" id="3432308">.</span><span class="ident" id="3432309">Type</span><span class="op" id="3432313">(</span><span class="op" id="3432314">)</span><span class="op" id="3432315">.</span><span class="ident" id="3432316">Implements</span><span class="op" id="3432326">(</span><span class="ident" id="3432327">errorType</span><span class="op" id="3432336">)</span>&nbsp;<span class="op" id="3432338">&amp;&amp;</span>&nbsp;<span class="op" id="3432341">!</span><span class="ident" id="3432342">v</span><span class="op" id="3432343">.</span><span class="ident" id="3432344">Type</span><span class="op" id="3432348">(</span><span class="op" id="3432349">)</span><span class="op" id="3432350">.</span><span class="ident" id="3432351">Implements</span><span class="op" id="3432361">(</span><span class="ident" id="3432362">fmtStringerType</span><span class="op" id="3432377">)</span>&nbsp;<span class="op" id="3432379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3432383">if</span>&nbsp;<span class="ident" id="3432386">v</span><span class="op" id="3432387">.</span><span class="ident" id="3432388">CanAddr</span><span class="op" id="3432395">(</span><span class="op" id="3432396">)</span>&nbsp;<span class="op" id="3432398">&amp;&amp;</span>&nbsp;<span class="op" id="3432401">(</span><span class="ident" id="3432402">reflect</span><span class="op" id="3432409">.</span><span class="ident" id="3432410">PtrTo</span><span class="op" id="3432415">(</span><span class="ident" id="3432416">v</span><span class="op" id="3432417">.</span><span class="ident" id="3432418">Type</span><span class="op" id="3432422">(</span><span class="op" id="3432423">)</span><span class="op" id="3432424">)</span><span class="op" id="3432425">.</span><span class="ident" id="3432426">Implements</span><span class="op" id="3432436">(</span><span class="ident" id="3432437">errorType</span><span class="op" id="3432446">)</span>&nbsp;<span class="op" id="3432448">||</span>&nbsp;<span class="ident" id="3432451">reflect</span><span class="op" id="3432458">.</span><span class="ident" id="3432459">PtrTo</span><span class="op" id="3432464">(</span><span class="ident" id="3432465">v</span><span class="op" id="3432466">.</span><span class="ident" id="3432467">Type</span><span class="op" id="3432471">(</span><span class="op" id="3432472">)</span><span class="op" id="3432473">)</span><span class="op" id="3432474">.</span><span class="ident" id="3432475">Implements</span><span class="op" id="3432485">(</span><span class="ident" id="3432486">fmtStringerType</span><span class="op" id="3432501">)</span><span class="op" id="3432502">)</span>&nbsp;<span class="op" id="3432504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3432509">v</span>&nbsp;<span class="op" id="3432511">=</span>&nbsp;<span class="ident" id="3432513">v</span><span class="op" id="3432514">.</span><span class="ident" id="3432515">Addr</span><span class="op" id="3432519">(</span><span class="op" id="3432520">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3432524">}</span>&nbsp;<span class="keyword" id="3432526">else</span>&nbsp;<span class="op" id="3432531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3432536">switch</span>&nbsp;<span class="ident" id="3432543">v</span><span class="op" id="3432544">.</span><span class="ident" id="3432545">Kind</span><span class="op" id="3432549">(</span><span class="op" id="3432550">)</span>&nbsp;<span class="op" id="3432552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3432557">case</span>&nbsp;<span class="ident" id="3432562">reflect</span><span class="op" id="3432569">.</span><span class="ident" id="3432570">Chan</span><span class="op" id="3432574">,</span>&nbsp;<span class="ident" id="3432576">reflect</span><span class="op" id="3432583">.</span><span class="ident" id="3432584">Func</span><span class="op" id="3432588">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3432594">return</span>&nbsp;<span class="ident" id="3432601">nil</span><span class="op" id="3432604">,</span>&nbsp;<span class="builtintype" id="3432606">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3432615">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3432619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3432622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3432625">return</span>&nbsp;<span class="ident" id="3432632">v</span><span class="op" id="3432633">.</span><span class="ident" id="3432634">Interface</span><span class="op" id="3432643">(</span><span class="op" id="3432644">)</span><span class="op" id="3432645">,</span>&nbsp;<span class="builtintype" id="3432647">true</span><br>
<span class="lineno"></span><span class="op" id="3432652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="comment" id="3432655">//&nbsp;Types&nbsp;to&nbsp;help&nbsp;sort&nbsp;the&nbsp;keys&nbsp;in&nbsp;a&nbsp;map&nbsp;for&nbsp;reproducible&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3432721">type</span>&nbsp;<span class="ident" id="3432726">rvs</span>&nbsp;<span class="op" id="3432730">[</span><span class="op" id="3432731">]</span><span class="ident" id="3432732">reflect</span><span class="op" id="3432739">.</span><span class="ident" id="3432740">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3432747">func</span>&nbsp;<span class="op" id="3432752">(</span><span class="ident" id="3432753">x</span>&nbsp;<span class="ident" id="3432755">rvs</span><span class="op" id="3432758">)</span>&nbsp;<span class="ident" id="3432760">Len</span><span class="op" id="3432763">(</span><span class="op" id="3432764">)</span>&nbsp;<span class="builtintype" id="3432766">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3432775">{</span>&nbsp;<span class="keyword" id="3432777">return</span>&nbsp;<span class="builtinfunc" id="3432784">len</span><span class="op" id="3432787">(</span><span class="ident" id="3432788">x</span><span class="op" id="3432789">)</span>&nbsp;<span class="op" id="3432791">}</span><br>
<span class="lineno">810</span><span class="keyword" id="3432793">func</span>&nbsp;<span class="op" id="3432798">(</span><span class="ident" id="3432799">x</span>&nbsp;<span class="ident" id="3432801">rvs</span><span class="op" id="3432804">)</span>&nbsp;<span class="ident" id="3432806">Swap</span><span class="op" id="3432810">(</span><span class="ident" id="3432811">i</span><span class="op" id="3432812">,</span>&nbsp;<span class="ident" id="3432814">j</span>&nbsp;<span class="builtintype" id="3432816">int</span><span class="op" id="3432819">)</span>&nbsp;<span class="op" id="3432821">{</span>&nbsp;<span class="ident" id="3432823">x</span><span class="op" id="3432824">[</span><span class="ident" id="3432825">i</span><span class="op" id="3432826">]</span><span class="op" id="3432827">,</span>&nbsp;<span class="ident" id="3432829">x</span><span class="op" id="3432830">[</span><span class="ident" id="3432831">j</span><span class="op" id="3432832">]</span>&nbsp;<span class="op" id="3432834">=</span>&nbsp;<span class="ident" id="3432836">x</span><span class="op" id="3432837">[</span><span class="ident" id="3432838">j</span><span class="op" id="3432839">]</span><span class="op" id="3432840">,</span>&nbsp;<span class="ident" id="3432842">x</span><span class="op" id="3432843">[</span><span class="ident" id="3432844">i</span><span class="op" id="3432845">]</span>&nbsp;<span class="op" id="3432847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3432850">type</span>&nbsp;<span class="ident" id="3432855">rvInts</span>&nbsp;<span class="keyword" id="3432862">struct</span><span class="op" id="3432868">{</span>&nbsp;<span class="ident" id="3432870">rvs</span>&nbsp;<span class="op" id="3432874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3432877">func</span>&nbsp;<span class="op" id="3432882">(</span><span class="ident" id="3432883">x</span>&nbsp;<span class="ident" id="3432885">rvInts</span><span class="op" id="3432891">)</span>&nbsp;<span class="ident" id="3432893">Less</span><span class="op" id="3432897">(</span><span class="ident" id="3432898">i</span><span class="op" id="3432899">,</span>&nbsp;<span class="ident" id="3432901">j</span>&nbsp;<span class="builtintype" id="3432903">int</span><span class="op" id="3432906">)</span>&nbsp;<span class="builtintype" id="3432908">bool</span>&nbsp;<span class="op" id="3432913">{</span>&nbsp;<span class="keyword" id="3432915">return</span>&nbsp;<span class="ident" id="3432922">x</span><span class="op" id="3432923">.</span><span class="ident" id="3432924">rvs</span><span class="op" id="3432927">[</span><span class="ident" id="3432928">i</span><span class="op" id="3432929">]</span><span class="op" id="3432930">.</span><span class="ident" id="3432931">Int</span><span class="op" id="3432934">(</span><span class="op" id="3432935">)</span>&nbsp;<span class="op" id="3432937">&lt;</span>&nbsp;<span class="ident" id="3432939">x</span><span class="op" id="3432940">.</span><span class="ident" id="3432941">rvs</span><span class="op" id="3432944">[</span><span class="ident" id="3432945">j</span><span class="op" id="3432946">]</span><span class="op" id="3432947">.</span><span class="ident" id="3432948">Int</span><span class="op" id="3432951">(</span><span class="op" id="3432952">)</span>&nbsp;<span class="op" id="3432954">}</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="keyword" id="3432957">type</span>&nbsp;<span class="ident" id="3432962">rvUints</span>&nbsp;<span class="keyword" id="3432970">struct</span><span class="op" id="3432976">{</span>&nbsp;<span class="ident" id="3432978">rvs</span>&nbsp;<span class="op" id="3432982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3432985">func</span>&nbsp;<span class="op" id="3432990">(</span><span class="ident" id="3432991">x</span>&nbsp;<span class="ident" id="3432993">rvUints</span><span class="op" id="3433000">)</span>&nbsp;<span class="ident" id="3433002">Less</span><span class="op" id="3433006">(</span><span class="ident" id="3433007">i</span><span class="op" id="3433008">,</span>&nbsp;<span class="ident" id="3433010">j</span>&nbsp;<span class="builtintype" id="3433012">int</span><span class="op" id="3433015">)</span>&nbsp;<span class="builtintype" id="3433017">bool</span>&nbsp;<span class="op" id="3433022">{</span>&nbsp;<span class="keyword" id="3433024">return</span>&nbsp;<span class="ident" id="3433031">x</span><span class="op" id="3433032">.</span><span class="ident" id="3433033">rvs</span><span class="op" id="3433036">[</span><span class="ident" id="3433037">i</span><span class="op" id="3433038">]</span><span class="op" id="3433039">.</span><span class="ident" id="3433040">Uint</span><span class="op" id="3433044">(</span><span class="op" id="3433045">)</span>&nbsp;<span class="op" id="3433047">&lt;</span>&nbsp;<span class="ident" id="3433049">x</span><span class="op" id="3433050">.</span><span class="ident" id="3433051">rvs</span><span class="op" id="3433054">[</span><span class="ident" id="3433055">j</span><span class="op" id="3433056">]</span><span class="op" id="3433057">.</span><span class="ident" id="3433058">Uint</span><span class="op" id="3433062">(</span><span class="op" id="3433063">)</span>&nbsp;<span class="op" id="3433065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span><span class="keyword" id="3433068">type</span>&nbsp;<span class="ident" id="3433073">rvFloats</span>&nbsp;<span class="keyword" id="3433082">struct</span><span class="op" id="3433088">{</span>&nbsp;<span class="ident" id="3433090">rvs</span>&nbsp;<span class="op" id="3433094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3433097">func</span>&nbsp;<span class="op" id="3433102">(</span><span class="ident" id="3433103">x</span>&nbsp;<span class="ident" id="3433105">rvFloats</span><span class="op" id="3433113">)</span>&nbsp;<span class="ident" id="3433115">Less</span><span class="op" id="3433119">(</span><span class="ident" id="3433120">i</span><span class="op" id="3433121">,</span>&nbsp;<span class="ident" id="3433123">j</span>&nbsp;<span class="builtintype" id="3433125">int</span><span class="op" id="3433128">)</span>&nbsp;<span class="builtintype" id="3433130">bool</span>&nbsp;<span class="op" id="3433135">{</span>&nbsp;<span class="keyword" id="3433137">return</span>&nbsp;<span class="ident" id="3433144">x</span><span class="op" id="3433145">.</span><span class="ident" id="3433146">rvs</span><span class="op" id="3433149">[</span><span class="ident" id="3433150">i</span><span class="op" id="3433151">]</span><span class="op" id="3433152">.</span><span class="ident" id="3433153">Float</span><span class="op" id="3433158">(</span><span class="op" id="3433159">)</span>&nbsp;<span class="op" id="3433161">&lt;</span>&nbsp;<span class="ident" id="3433163">x</span><span class="op" id="3433164">.</span><span class="ident" id="3433165">rvs</span><span class="op" id="3433168">[</span><span class="ident" id="3433169">j</span><span class="op" id="3433170">]</span><span class="op" id="3433171">.</span><span class="ident" id="3433172">Float</span><span class="op" id="3433177">(</span><span class="op" id="3433178">)</span>&nbsp;<span class="op" id="3433180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3433183">type</span>&nbsp;<span class="ident" id="3433188">rvStrings</span>&nbsp;<span class="keyword" id="3433198">struct</span><span class="op" id="3433204">{</span>&nbsp;<span class="ident" id="3433206">rvs</span>&nbsp;<span class="op" id="3433210">}</span><br>
<span class="lineno">825</span><br>
<span class="lineno"></span><span class="keyword" id="3433213">func</span>&nbsp;<span class="op" id="3433218">(</span><span class="ident" id="3433219">x</span>&nbsp;<span class="ident" id="3433221">rvStrings</span><span class="op" id="3433230">)</span>&nbsp;<span class="ident" id="3433232">Less</span><span class="op" id="3433236">(</span><span class="ident" id="3433237">i</span><span class="op" id="3433238">,</span>&nbsp;<span class="ident" id="3433240">j</span>&nbsp;<span class="builtintype" id="3433242">int</span><span class="op" id="3433245">)</span>&nbsp;<span class="builtintype" id="3433247">bool</span>&nbsp;<span class="op" id="3433252">{</span>&nbsp;<span class="keyword" id="3433254">return</span>&nbsp;<span class="ident" id="3433261">x</span><span class="op" id="3433262">.</span><span class="ident" id="3433263">rvs</span><span class="op" id="3433266">[</span><span class="ident" id="3433267">i</span><span class="op" id="3433268">]</span><span class="op" id="3433269">.</span><span class="ident" id="3433270">String</span><span class="op" id="3433276">(</span><span class="op" id="3433277">)</span>&nbsp;<span class="op" id="3433279">&lt;</span>&nbsp;<span class="ident" id="3433281">x</span><span class="op" id="3433282">.</span><span class="ident" id="3433283">rvs</span><span class="op" id="3433286">[</span><span class="ident" id="3433287">j</span><span class="op" id="3433288">]</span><span class="op" id="3433289">.</span><span class="ident" id="3433290">String</span><span class="op" id="3433296">(</span><span class="op" id="3433297">)</span>&nbsp;<span class="op" id="3433299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3433302">//&nbsp;sortKeys&nbsp;sorts&nbsp;(if&nbsp;it&nbsp;can)&nbsp;the&nbsp;slice&nbsp;of&nbsp;reflect.Values,&nbsp;which&nbsp;is&nbsp;a&nbsp;slice&nbsp;of&nbsp;map&nbsp;keys.</span><br>
<span class="lineno"></span><span class="keyword" id="3433391">func</span>&nbsp;<span class="ident" id="3433396">sortKeys</span><span class="op" id="3433404">(</span><span class="ident" id="3433405">v</span>&nbsp;<span class="op" id="3433407">[</span><span class="op" id="3433408">]</span><span class="ident" id="3433409">reflect</span><span class="op" id="3433416">.</span><span class="ident" id="3433417">Value</span><span class="op" id="3433422">)</span>&nbsp;<span class="op" id="3433424">[</span><span class="op" id="3433425">]</span><span class="ident" id="3433426">reflect</span><span class="op" id="3433433">.</span><span class="ident" id="3433434">Value</span>&nbsp;<span class="op" id="3433440">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3433443">if</span>&nbsp;<span class="builtinfunc" id="3433446">len</span><span class="op" id="3433449">(</span><span class="ident" id="3433450">v</span><span class="op" id="3433451">)</span>&nbsp;<span class="op" id="3433453">&lt;=</span>&nbsp;<span class="num" id="3433456">1</span>&nbsp;<span class="op" id="3433458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3433462">return</span>&nbsp;<span class="ident" id="3433469">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3433472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3433475">switch</span>&nbsp;<span class="ident" id="3433482">v</span><span class="op" id="3433483">[</span><span class="num" id="3433484">0</span><span class="op" id="3433485">]</span><span class="op" id="3433486">.</span><span class="ident" id="3433487">Kind</span><span class="op" id="3433491">(</span><span class="op" id="3433492">)</span>&nbsp;<span class="op" id="3433494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3433497">case</span>&nbsp;<span class="ident" id="3433502">reflect</span><span class="op" id="3433509">.</span><span class="ident" id="3433510">Float32</span><span class="op" id="3433517">,</span>&nbsp;<span class="ident" id="3433519">reflect</span><span class="op" id="3433526">.</span><span class="ident" id="3433527">Float64</span><span class="op" id="3433534">:</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3433538">sort</span><span class="op" id="3433542">.</span><span class="ident" id="3433543">Sort</span><span class="op" id="3433547">(</span><span class="ident" id="3433548">rvFloats</span><span class="op" id="3433556">{</span><span class="ident" id="3433557">v</span><span class="op" id="3433558">}</span><span class="op" id="3433559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3433562">case</span>&nbsp;<span class="ident" id="3433567">reflect</span><span class="op" id="3433574">.</span><span class="ident" id="3433575">Int</span><span class="op" id="3433578">,</span>&nbsp;<span class="ident" id="3433580">reflect</span><span class="op" id="3433587">.</span><span class="ident" id="3433588">Int8</span><span class="op" id="3433592">,</span>&nbsp;<span class="ident" id="3433594">reflect</span><span class="op" id="3433601">.</span><span class="ident" id="3433602">Int16</span><span class="op" id="3433607">,</span>&nbsp;<span class="ident" id="3433609">reflect</span><span class="op" id="3433616">.</span><span class="ident" id="3433617">Int32</span><span class="op" id="3433622">,</span>&nbsp;<span class="ident" id="3433624">reflect</span><span class="op" id="3433631">.</span><span class="ident" id="3433632">Int64</span><span class="op" id="3433637">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3433641">sort</span><span class="op" id="3433645">.</span><span class="ident" id="3433646">Sort</span><span class="op" id="3433650">(</span><span class="ident" id="3433651">rvInts</span><span class="op" id="3433657">{</span><span class="ident" id="3433658">v</span><span class="op" id="3433659">}</span><span class="op" id="3433660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3433663">case</span>&nbsp;<span class="ident" id="3433668">reflect</span><span class="op" id="3433675">.</span><span class="ident" id="3433676">String</span><span class="op" id="3433682">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3433686">sort</span><span class="op" id="3433690">.</span><span class="ident" id="3433691">Sort</span><span class="op" id="3433695">(</span><span class="ident" id="3433696">rvStrings</span><span class="op" id="3433705">{</span><span class="ident" id="3433706">v</span><span class="op" id="3433707">}</span><span class="op" id="3433708">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3433711">case</span>&nbsp;<span class="ident" id="3433716">reflect</span><span class="op" id="3433723">.</span><span class="ident" id="3433724">Uint</span><span class="op" id="3433728">,</span>&nbsp;<span class="ident" id="3433730">reflect</span><span class="op" id="3433737">.</span><span class="ident" id="3433738">Uint8</span><span class="op" id="3433743">,</span>&nbsp;<span class="ident" id="3433745">reflect</span><span class="op" id="3433752">.</span><span class="ident" id="3433753">Uint16</span><span class="op" id="3433759">,</span>&nbsp;<span class="ident" id="3433761">reflect</span><span class="op" id="3433768">.</span><span class="ident" id="3433769">Uint32</span><span class="op" id="3433775">,</span>&nbsp;<span class="ident" id="3433777">reflect</span><span class="op" id="3433784">.</span><span class="ident" id="3433785">Uint64</span><span class="op" id="3433791">,</span>&nbsp;<span class="ident" id="3433793">reflect</span><span class="op" id="3433800">.</span><span class="ident" id="3433801">Uintptr</span><span class="op" id="3433808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3433812">sort</span><span class="op" id="3433816">.</span><span class="ident" id="3433817">Sort</span><span class="op" id="3433821">(</span><span class="ident" id="3433822">rvUints</span><span class="op" id="3433829">{</span><span class="ident" id="3433830">v</span><span class="op" id="3433831">}</span><span class="op" id="3433832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3433835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3433838">return</span>&nbsp;<span class="ident" id="3433845">v</span><br>
<span class="lineno"></span><span class="op" id="3433847">}</span>
</div>
</body>
</html>
