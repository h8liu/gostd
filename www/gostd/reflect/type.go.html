<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2496489">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2496544">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2496598">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2496649">//&nbsp;Package&nbsp;reflect&nbsp;implements&nbsp;run-time&nbsp;reflection,&nbsp;allowing&nbsp;a&nbsp;program&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2496722">//&nbsp;manipulate&nbsp;objects&nbsp;with&nbsp;arbitrary&nbsp;types.&nbsp;&nbsp;The&nbsp;typical&nbsp;use&nbsp;is&nbsp;to&nbsp;take&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2496802">//&nbsp;with&nbsp;static&nbsp;type&nbsp;interface{}&nbsp;and&nbsp;extract&nbsp;its&nbsp;dynamic&nbsp;type&nbsp;information&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2496878">//&nbsp;calling&nbsp;TypeOf,&nbsp;which&nbsp;returns&nbsp;a&nbsp;Type.</span><br>
<span class="lineno"></span><span class="comment" id="2496919">//</span><br>
<span class="lineno">10</span><span class="comment" id="2496922">//&nbsp;A&nbsp;call&nbsp;to&nbsp;ValueOf&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;the&nbsp;run-time&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="2496991">//&nbsp;Zero&nbsp;takes&nbsp;a&nbsp;Type&nbsp;and&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;a&nbsp;zero&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2497058">//&nbsp;for&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2497076">//</span><br>
<span class="lineno"></span><span class="comment" id="2497079">//&nbsp;See&nbsp;&#34;The&nbsp;Laws&nbsp;of&nbsp;Reflection&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;reflection&nbsp;in&nbsp;Go:</span><br>
<span class="lineno">15</span><span class="comment" id="2497152">//&nbsp;http://golang.org/doc/articles/laws_of_reflection.html</span><br>
<span class="lineno"></span><span class="keyword" id="2497210">package</span>&nbsp;<span class="ident" id="2497218">reflect</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2497227">import</span>&nbsp;<span class="op" id="2497234">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2497237">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2497248">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2497259">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2497267">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2497276">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2497279">//&nbsp;Type&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2497323">//</span><br>
<span class="lineno"></span><span class="comment" id="2497326">//&nbsp;Not&nbsp;all&nbsp;methods&nbsp;apply&nbsp;to&nbsp;all&nbsp;kinds&nbsp;of&nbsp;types.&nbsp;&nbsp;Restrictions,</span><br>
<span class="lineno"></span><span class="comment" id="2497389">//&nbsp;if&nbsp;any,&nbsp;are&nbsp;noted&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;each&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2497448">//&nbsp;Use&nbsp;the&nbsp;Kind&nbsp;method&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;before</span><br>
<span class="lineno">30</span><span class="comment" id="2497507">//&nbsp;calling&nbsp;kind-specific&nbsp;methods.&nbsp;&nbsp;Calling&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="2497559">//&nbsp;inappropriate&nbsp;to&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;causes&nbsp;a&nbsp;run-time&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="2497621">type</span>&nbsp;<span class="ident" id="2497626">Type</span>&nbsp;<span class="keyword" id="2497631">interface</span>&nbsp;<span class="op" id="2497641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2497644">//&nbsp;Methods&nbsp;applicable&nbsp;to&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2497682">//&nbsp;Align&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2497737">//&nbsp;this&nbsp;type&nbsp;when&nbsp;allocated&nbsp;in&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2497777">Align</span><span class="op" id="2497782">(</span><span class="op" id="2497783">)</span>&nbsp;<span class="builtintype" id="2497785">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2497791">//&nbsp;FieldAlign&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2497851">//&nbsp;this&nbsp;type&nbsp;when&nbsp;used&nbsp;as&nbsp;a&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2497899">FieldAlign</span><span class="op" id="2497909">(</span><span class="op" id="2497910">)</span>&nbsp;<span class="builtintype" id="2497912">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2497918">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2497979">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumMethod()).</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498036">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498040">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498114">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498183">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498187">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498257">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2498326">Method</span><span class="op" id="2498332">(</span><span class="builtintype" id="2498333">int</span><span class="op" id="2498336">)</span>&nbsp;<span class="ident" id="2498338">Method</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498347">//&nbsp;MethodByName&nbsp;returns&nbsp;the&nbsp;method&nbsp;with&nbsp;that&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498412">//&nbsp;method&nbsp;set&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;method&nbsp;was&nbsp;found.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498477">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498481">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498555">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498624">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498628">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498698">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2498767">MethodByName</span><span class="op" id="2498779">(</span><span class="builtintype" id="2498780">string</span><span class="op" id="2498786">)</span>&nbsp;<span class="op" id="2498788">(</span><span class="ident" id="2498789">Method</span><span class="op" id="2498795">,</span>&nbsp;<span class="builtintype" id="2498797">bool</span><span class="op" id="2498801">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498805">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2498875">NumMethod</span><span class="op" id="2498884">(</span><span class="op" id="2498885">)</span>&nbsp;<span class="builtintype" id="2498887">int</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498893">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;type&#39;s&nbsp;name&nbsp;within&nbsp;its&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2498946">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;string&nbsp;for&nbsp;unnamed&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2498996">Name</span><span class="op" id="2499000">(</span><span class="op" id="2499001">)</span>&nbsp;<span class="builtintype" id="2499003">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499012">//&nbsp;PkgPath&nbsp;returns&nbsp;a&nbsp;named&nbsp;type&#39;s&nbsp;package&nbsp;path,&nbsp;that&nbsp;is,&nbsp;the&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499086">//&nbsp;that&nbsp;uniquely&nbsp;identifies&nbsp;the&nbsp;package,&nbsp;such&nbsp;as&nbsp;&#34;encoding/base64&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499155">//&nbsp;If&nbsp;the&nbsp;type&nbsp;was&nbsp;predeclared&nbsp;(string,&nbsp;error)&nbsp;or&nbsp;unnamed&nbsp;(*T,&nbsp;struct{},&nbsp;[]int),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499237">//&nbsp;the&nbsp;package&nbsp;path&nbsp;will&nbsp;be&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499284">PkgPath</span><span class="op" id="2499291">(</span><span class="op" id="2499292">)</span>&nbsp;<span class="builtintype" id="2499294">string</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499303">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;needed&nbsp;to&nbsp;store</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499356">//&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;given&nbsp;type;&nbsp;it&nbsp;is&nbsp;analogous&nbsp;to&nbsp;unsafe.Sizeof.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499421">Size</span><span class="op" id="2499425">(</span><span class="op" id="2499426">)</span>&nbsp;<span class="builtintype" id="2499428">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499438">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499494">//&nbsp;The&nbsp;string&nbsp;representation&nbsp;may&nbsp;use&nbsp;shortened&nbsp;package&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499556">//&nbsp;(e.g.,&nbsp;base64&nbsp;instead&nbsp;of&nbsp;&#34;encoding/base64&#34;)&nbsp;and&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499615">//&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique&nbsp;among&nbsp;types.&nbsp;&nbsp;To&nbsp;test&nbsp;for&nbsp;equality,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499679">//&nbsp;compare&nbsp;the&nbsp;Types&nbsp;directly.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499711">String</span><span class="op" id="2499717">(</span><span class="op" id="2499718">)</span>&nbsp;<span class="builtintype" id="2499720">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499729">//&nbsp;Kind&nbsp;returns&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499778">Kind</span><span class="op" id="2499782">(</span><span class="op" id="2499783">)</span>&nbsp;<span class="ident" id="2499785">Kind</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499792">//&nbsp;Implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499865">Implements</span><span class="op" id="2499875">(</span><span class="ident" id="2499876">u</span>&nbsp;<span class="ident" id="2499878">Type</span><span class="op" id="2499882">)</span>&nbsp;<span class="builtintype" id="2499884">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499891">//&nbsp;AssignableTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;assignable&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2499969">AssignableTo</span><span class="op" id="2499981">(</span><span class="ident" id="2499982">u</span>&nbsp;<span class="ident" id="2499984">Type</span><span class="op" id="2499988">)</span>&nbsp;<span class="builtintype" id="2499990">bool</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2499997">//&nbsp;ConvertibleTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;convertible&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500077">ConvertibleTo</span><span class="op" id="2500090">(</span><span class="ident" id="2500091">u</span>&nbsp;<span class="ident" id="2500093">Type</span><span class="op" id="2500097">)</span>&nbsp;<span class="builtintype" id="2500099">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500106">//&nbsp;Comparable&nbsp;returns&nbsp;true&nbsp;if&nbsp;values&nbsp;of&nbsp;this&nbsp;type&nbsp;are&nbsp;comparable.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500173">Comparable</span><span class="op" id="2500183">(</span><span class="op" id="2500184">)</span>&nbsp;<span class="builtintype" id="2500186">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500193">//&nbsp;Methods&nbsp;applicable&nbsp;only&nbsp;to&nbsp;some&nbsp;types,&nbsp;depending&nbsp;on&nbsp;Kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500255">//&nbsp;The&nbsp;methods&nbsp;allowed&nbsp;for&nbsp;each&nbsp;kind&nbsp;are:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500298">//</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500302">//&nbsp;&nbsp;&nbsp;&nbspInt*,&nbsp;Uint*,&nbsp;Float*,&nbsp;Complex*:&nbsp;Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500342">//&nbsp;&nbsp;&nbsp;&nbspArray:&nbsp;Elem,&nbsp;Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500363">//&nbsp;&nbsp;&nbsp;&nbspChan:&nbsp;ChanDir,&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500387">//&nbsp;&nbsp;&nbsp;&nbspFunc:&nbsp;In,&nbsp;NumIn,&nbsp;Out,&nbsp;NumOut,&nbsp;IsVariadic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500433">//&nbsp;&nbsp;&nbsp;&nbspMap:&nbsp;Key,&nbsp;Elem</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500452">//&nbsp;&nbsp;&nbsp;&nbspPtr:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500466">//&nbsp;&nbsp;&nbsp;&nbspSlice:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500482">//&nbsp;&nbsp;&nbsp;&nbspStruct:&nbsp;Field,&nbsp;FieldByIndex,&nbsp;FieldByName,&nbsp;FieldByNameFunc,&nbsp;NumField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500555">//&nbsp;Bits&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;type&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500602">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500653">//&nbsp;sized&nbsp;or&nbsp;unsized&nbsp;Int,&nbsp;Uint,&nbsp;Float,&nbsp;or&nbsp;Complex&nbsp;kinds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500710">Bits</span><span class="op" id="2500714">(</span><span class="op" id="2500715">)</span>&nbsp;<span class="builtintype" id="2500717">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500723">//&nbsp;ChanDir&nbsp;returns&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500771">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2500817">ChanDir</span><span class="op" id="2500824">(</span><span class="op" id="2500825">)</span>&nbsp;<span class="ident" id="2500827">ChanDir</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500837">//&nbsp;IsVariadic&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;final&nbsp;input&nbsp;parameter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500908">//&nbsp;is&nbsp;a&nbsp;&#34;...&#34;&nbsp;parameter.&nbsp;&nbsp;If&nbsp;so,&nbsp;t.In(t.NumIn()&nbsp;-&nbsp;1)&nbsp;returns&nbsp;the&nbsp;parameter&#39;s</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2500986">//&nbsp;implicit&nbsp;actual&nbsp;type&nbsp;[]T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501016">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501020">//&nbsp;For&nbsp;concreteness,&nbsp;if&nbsp;t&nbsp;represents&nbsp;func(x&nbsp;int,&nbsp;y&nbsp;...&nbsp;float64),&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501091">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501095">//&nbsp;&nbsp;&nbsp;&nbspt.NumIn()&nbsp;==&nbsp;2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501114">//&nbsp;&nbsp;&nbsp;&nbspt.In(0)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;int&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501156">//&nbsp;&nbsp;&nbsp;&nbspt.In(1)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;[]float64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501204">//&nbsp;&nbsp;&nbsp;&nbspt.IsVariadic()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501231">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501235">//&nbsp;IsVariadic&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501289">IsVariadic</span><span class="op" id="2501299">(</span><span class="op" id="2501300">)</span>&nbsp;<span class="builtintype" id="2501302">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501309">//&nbsp;Elem&nbsp;returns&nbsp;a&nbsp;type&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501349">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Chan,&nbsp;Map,&nbsp;Ptr,&nbsp;or&nbsp;Slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501422">Elem</span><span class="op" id="2501426">(</span><span class="op" id="2501427">)</span>&nbsp;<span class="ident" id="2501429">Type</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501436">//&nbsp;Field&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501482">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501530">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumField()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501586">Field</span><span class="op" id="2501591">(</span><span class="ident" id="2501592">i</span>&nbsp;<span class="builtintype" id="2501594">int</span><span class="op" id="2501597">)</span>&nbsp;<span class="ident" id="2501599">StructField</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501613">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501669">//&nbsp;to&nbsp;the&nbsp;index&nbsp;sequence.&nbsp;&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501731">//&nbsp;successively&nbsp;for&nbsp;each&nbsp;index&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501766">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501814">FieldByIndex</span><span class="op" id="2501826">(</span><span class="ident" id="2501827">index</span>&nbsp;<span class="op" id="2501833">[</span><span class="op" id="2501834">]</span><span class="builtintype" id="2501835">int</span><span class="op" id="2501838">)</span>&nbsp;<span class="ident" id="2501840">StructField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501854">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2501915">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2501968">FieldByName</span><span class="op" id="2501979">(</span><span class="ident" id="2501980">name</span>&nbsp;<span class="builtintype" id="2501985">string</span><span class="op" id="2501991">)</span>&nbsp;<span class="op" id="2501993">(</span><span class="ident" id="2501994">StructField</span><span class="op" id="2502005">,</span>&nbsp;<span class="builtintype" id="2502007">bool</span><span class="op" id="2502011">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502015">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;first&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502078">//&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502144">//&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502169">FieldByNameFunc</span><span class="op" id="2502184">(</span><span class="ident" id="2502185">match</span>&nbsp;<span class="keyword" id="2502191">func</span><span class="op" id="2502195">(</span><span class="builtintype" id="2502196">string</span><span class="op" id="2502202">)</span>&nbsp;<span class="builtintype" id="2502204">bool</span><span class="op" id="2502208">)</span>&nbsp;<span class="op" id="2502210">(</span><span class="ident" id="2502211">StructField</span><span class="op" id="2502222">,</span>&nbsp;<span class="builtintype" id="2502224">bool</span><span class="op" id="2502228">)</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502232">//&nbsp;In&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;input&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502299">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502345">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumIn()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502398">In</span><span class="op" id="2502400">(</span><span class="ident" id="2502401">i</span>&nbsp;<span class="builtintype" id="2502403">int</span><span class="op" id="2502406">)</span>&nbsp;<span class="ident" id="2502408">Type</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502415">//&nbsp;Key&nbsp;returns&nbsp;a&nbsp;map&nbsp;type&#39;s&nbsp;key&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502454">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502499">Key</span><span class="op" id="2502502">(</span><span class="op" id="2502503">)</span>&nbsp;<span class="ident" id="2502505">Type</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502512">//&nbsp;Len&nbsp;returns&nbsp;an&nbsp;array&nbsp;type&#39;s&nbsp;length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502552">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502599">Len</span><span class="op" id="2502602">(</span><span class="op" id="2502603">)</span>&nbsp;<span class="builtintype" id="2502605">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502611">//&nbsp;NumField&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;field&nbsp;count.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502661">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502709">NumField</span><span class="op" id="2502717">(</span><span class="op" id="2502718">)</span>&nbsp;<span class="builtintype" id="2502720">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502726">//&nbsp;NumIn&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;input&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502785">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502831">NumIn</span><span class="op" id="2502836">(</span><span class="op" id="2502837">)</span>&nbsp;<span class="builtintype" id="2502839">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502845">//&nbsp;NumOut&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;output&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502906">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2502952">NumOut</span><span class="op" id="2502958">(</span><span class="op" id="2502959">)</span>&nbsp;<span class="builtintype" id="2502961">int</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2502967">//&nbsp;Out&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;output&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2503036">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2503082">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumOut()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503136">Out</span><span class="op" id="2503139">(</span><span class="ident" id="2503140">i</span>&nbsp;<span class="builtintype" id="2503142">int</span><span class="op" id="2503145">)</span>&nbsp;<span class="ident" id="2503147">Type</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503154">common</span><span class="op" id="2503160">(</span><span class="op" id="2503161">)</span>&nbsp;<span class="op" id="2503163">*</span><span class="ident" id="2503164">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2503171">uncommon</span><span class="op" id="2503179">(</span><span class="op" id="2503180">)</span>&nbsp;<span class="op" id="2503182">*</span><span class="ident" id="2503183">uncommonType</span><br>
<span class="lineno"></span><span class="op" id="2503196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="2503199">//&nbsp;BUG(rsc):&nbsp;FieldByName&nbsp;and&nbsp;related&nbsp;functions&nbsp;consider&nbsp;struct&nbsp;field&nbsp;names&nbsp;to&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span><span class="comment" id="2503286">//&nbsp;if&nbsp;the&nbsp;names&nbsp;are&nbsp;equal,&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;unexported&nbsp;names&nbsp;originating</span><br>
<span class="lineno"></span><span class="comment" id="2503359">//&nbsp;in&nbsp;different&nbsp;packages.&nbsp;The&nbsp;practical&nbsp;effect&nbsp;of&nbsp;this&nbsp;is&nbsp;that&nbsp;the&nbsp;result&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2503436">//&nbsp;t.FieldByName(&#34;x&#34;)&nbsp;is&nbsp;not&nbsp;well&nbsp;defined&nbsp;if&nbsp;the&nbsp;struct&nbsp;type&nbsp;t&nbsp;contains</span><br>
<span class="lineno"></span><span class="comment" id="2503508">//&nbsp;multiple&nbsp;fields&nbsp;named&nbsp;x&nbsp;(embedded&nbsp;from&nbsp;different&nbsp;packages).</span><br>
<span class="lineno">200</span><span class="comment" id="2503571">//&nbsp;FieldByName&nbsp;may&nbsp;return&nbsp;one&nbsp;of&nbsp;the&nbsp;fields&nbsp;named&nbsp;x&nbsp;or&nbsp;may&nbsp;report&nbsp;that&nbsp;there&nbsp;are&nbsp;none.</span><br>
<span class="lineno"></span><span class="comment" id="2503658">//&nbsp;See&nbsp;golang.org/issue/4876&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2503706">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;These&nbsp;data&nbsp;structures&nbsp;are&nbsp;known&nbsp;to&nbsp;the&nbsp;compiler&nbsp;(../../cmd/gc/reflect.c).<br>
<span class="lineno">205</span>&nbsp;*&nbsp;A&nbsp;few&nbsp;are&nbsp;known&nbsp;to&nbsp;../runtime/type.go&nbsp;to&nbsp;convey&nbsp;to&nbsp;debuggers.<br>
<span class="lineno"></span>&nbsp;*&nbsp;They&nbsp;are&nbsp;also&nbsp;known&nbsp;to&nbsp;../runtime/type.h.<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2503901">//&nbsp;A&nbsp;Kind&nbsp;represents&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;type&nbsp;that&nbsp;a&nbsp;Type&nbsp;represents.</span><br>
<span class="lineno">210</span><span class="comment" id="2503972">//&nbsp;The&nbsp;zero&nbsp;Kind&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;kind.</span><br>
<span class="lineno"></span><span class="keyword" id="2504010">type</span>&nbsp;<span class="ident" id="2504015">Kind</span>&nbsp;<span class="builtintype" id="2504020">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2504026">const</span>&nbsp;<span class="op" id="2504032">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504035">Invalid</span>&nbsp;<span class="ident" id="2504043">Kind</span>&nbsp;<span class="op" id="2504048">=</span>&nbsp;<span class="ident" id="2504050">iota</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504056">Bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504062">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504067">Int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504073">Int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504080">Int32</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504087">Int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504094">Uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504100">Uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504107">Uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504115">Uint32</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504123">Uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504131">Uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504140">Float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504149">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504158">Complex64</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504169">Complex128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504181">Array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504188">Chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504194">Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504200">Interface</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504211">Map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504216">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504221">Slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504228">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504236">Struct</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504244">UnsafePointer</span><br>
<span class="lineno"></span><span class="op" id="2504258">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2504261">//&nbsp;rtype&nbsp;is&nbsp;the&nbsp;common&nbsp;implementation&nbsp;of&nbsp;most&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="2504315">//&nbsp;It&nbsp;is&nbsp;embedded&nbsp;in&nbsp;other,&nbsp;public&nbsp;struct&nbsp;types,&nbsp;but&nbsp;always</span><br>
<span class="lineno">245</span><span class="comment" id="2504375">//&nbsp;with&nbsp;a&nbsp;unique&nbsp;tag&nbsp;like&nbsp;`reflect:&#34;array&#34;`&nbsp;or&nbsp;`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="2504438">//&nbsp;so&nbsp;that&nbsp;code&nbsp;cannot&nbsp;convert&nbsp;from,&nbsp;say,&nbsp;*arrayType&nbsp;to&nbsp;*ptrType.</span><br>
<span class="lineno"></span><span class="keyword" id="2504504">type</span>&nbsp;<span class="ident" id="2504509">rtype</span>&nbsp;<span class="keyword" id="2504515">struct</span>&nbsp;<span class="op" id="2504522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504525">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2504539">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504548">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2504562">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2504580">//&nbsp;hash&nbsp;of&nbsp;type;&nbsp;avoids&nbsp;computation&nbsp;in&nbsp;hash&nbsp;tables</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504632">_</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2504646">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2504664">//&nbsp;unused/padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504683">align</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2504697">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2504715">//&nbsp;alignment&nbsp;of&nbsp;variable&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504756">fieldAlign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2504770">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2504788">//&nbsp;alignment&nbsp;of&nbsp;struct&nbsp;field&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504833">kind</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2504847">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2504865">//&nbsp;enumeration&nbsp;for&nbsp;C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504887">alg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2504901">*</span><span class="ident" id="2504902">typeAlg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2504919">//&nbsp;algorithm&nbsp;table&nbsp;(../runtime/runtime.h:/Alg)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2504967">gc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2504981">[</span><span class="num" id="2504982">2</span><span class="op" id="2504983">]</span><span class="ident" id="2504984">unsafe</span><span class="op" id="2504990">.</span><span class="ident" id="2504991">Pointer</span>&nbsp;<span class="comment" id="2504999">//&nbsp;garbage&nbsp;collection&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2505027">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2505041">*</span><span class="builtintype" id="2505042">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2505059">//&nbsp;string&nbsp;form;&nbsp;unnecessary&nbsp;but&nbsp;undeniably&nbsp;useful</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2505110">*</span><span class="ident" id="2505111">uncommonType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2505142">//&nbsp;(relatively)&nbsp;uncommon&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505175">ptrToThis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2505189">*</span><span class="ident" id="2505190">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2505207">//&nbsp;type&nbsp;for&nbsp;pointer&nbsp;to&nbsp;this&nbsp;type,&nbsp;if&nbsp;used&nbsp;in&nbsp;binary&nbsp;or&nbsp;has&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505275">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505289">unsafe</span><span class="op" id="2505295">.</span><span class="ident" id="2505296">Pointer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2505307">//&nbsp;pointer&nbsp;to&nbsp;zero&nbsp;value</span><br>
<span class="lineno">260</span><span class="op" id="2505332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2505335">type</span>&nbsp;<span class="ident" id="2505340">typeAlg</span>&nbsp;<span class="keyword" id="2505348">struct</span>&nbsp;<span class="op" id="2505355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2505358">//&nbsp;function&nbsp;for&nbsp;hashing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2505404">//&nbsp;(ptr&nbsp;to&nbsp;object,&nbsp;size,&nbsp;seed)&nbsp;-&gt;&nbsp;hash</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505444">hash</span>&nbsp;<span class="keyword" id="2505449">func</span><span class="op" id="2505453">(</span><span class="ident" id="2505454">unsafe</span><span class="op" id="2505460">.</span><span class="ident" id="2505461">Pointer</span><span class="op" id="2505468">,</span>&nbsp;<span class="builtintype" id="2505470">uintptr</span><span class="op" id="2505477">,</span>&nbsp;<span class="builtintype" id="2505479">uintptr</span><span class="op" id="2505486">)</span>&nbsp;<span class="builtintype" id="2505488">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2505497">//&nbsp;function&nbsp;for&nbsp;comparing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2505545">//&nbsp;(ptr&nbsp;to&nbsp;object&nbsp;A,&nbsp;ptr&nbsp;to&nbsp;object&nbsp;B,&nbsp;size)&nbsp;-&gt;&nbsp;==?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505597">equal</span>&nbsp;<span class="keyword" id="2505603">func</span><span class="op" id="2505607">(</span><span class="ident" id="2505608">unsafe</span><span class="op" id="2505614">.</span><span class="ident" id="2505615">Pointer</span><span class="op" id="2505622">,</span>&nbsp;<span class="ident" id="2505624">unsafe</span><span class="op" id="2505630">.</span><span class="ident" id="2505631">Pointer</span><span class="op" id="2505638">,</span>&nbsp;<span class="builtintype" id="2505640">uintptr</span><span class="op" id="2505647">)</span>&nbsp;<span class="builtintype" id="2505649">bool</span><br>
<span class="lineno"></span><span class="op" id="2505654">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="2505657">//&nbsp;Method&nbsp;on&nbsp;non-interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2505689">type</span>&nbsp;<span class="ident" id="2505694">method</span>&nbsp;<span class="keyword" id="2505701">struct</span>&nbsp;<span class="op" id="2505708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505711">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2505719">*</span><span class="builtintype" id="2505720">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2505734">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505753">pkgPath</span>&nbsp;<span class="op" id="2505761">*</span><span class="builtintype" id="2505762">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2505776">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505826">mtyp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2505834">*</span><span class="ident" id="2505835">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2505849">//&nbsp;method&nbsp;type&nbsp;(without&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505884">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2505892">*</span><span class="ident" id="2505893">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2505907">//&nbsp;.(*FuncType)&nbsp;underneath&nbsp;(with&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2505951">ifn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505959">unsafe</span><span class="op" id="2505965">.</span><span class="ident" id="2505966">Pointer</span>&nbsp;<span class="comment" id="2505974">//&nbsp;fn&nbsp;used&nbsp;in&nbsp;interface&nbsp;call&nbsp;(one-word&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506024">tfn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506032">unsafe</span><span class="op" id="2506038">.</span><span class="ident" id="2506039">Pointer</span>&nbsp;<span class="comment" id="2506047">//&nbsp;fn&nbsp;used&nbsp;for&nbsp;normal&nbsp;method&nbsp;call</span><br>
<span class="lineno"></span><span class="op" id="2506081">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="2506084">//&nbsp;uncommonType&nbsp;is&nbsp;present&nbsp;only&nbsp;for&nbsp;types&nbsp;with&nbsp;names&nbsp;or&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="2506148">//&nbsp;(if&nbsp;T&nbsp;is&nbsp;a&nbsp;named&nbsp;type,&nbsp;the&nbsp;uncommonTypes&nbsp;for&nbsp;T&nbsp;and&nbsp;*T&nbsp;have&nbsp;methods).</span><br>
<span class="lineno"></span><span class="comment" id="2506220">//&nbsp;Using&nbsp;a&nbsp;pointer&nbsp;to&nbsp;this&nbsp;struct&nbsp;reduces&nbsp;the&nbsp;overall&nbsp;size&nbsp;required</span><br>
<span class="lineno"></span><span class="comment" id="2506288">//&nbsp;to&nbsp;describe&nbsp;an&nbsp;unnamed&nbsp;type&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno">285</span><span class="keyword" id="2506336">type</span>&nbsp;<span class="ident" id="2506341">uncommonType</span>&nbsp;<span class="keyword" id="2506354">struct</span>&nbsp;<span class="op" id="2506361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506364">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506372">*</span><span class="builtintype" id="2506373">string</span>&nbsp;&nbsp;<span class="comment" id="2506381">//&nbsp;name&nbsp;of&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506398">pkgPath</span>&nbsp;<span class="op" id="2506406">*</span><span class="builtintype" id="2506407">string</span>&nbsp;&nbsp;<span class="comment" id="2506415">//&nbsp;import&nbsp;path;&nbsp;nil&nbsp;for&nbsp;built-in&nbsp;types&nbsp;like&nbsp;int,&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506472">methods</span>&nbsp;<span class="op" id="2506480">[</span><span class="op" id="2506481">]</span><span class="ident" id="2506482">method</span>&nbsp;<span class="comment" id="2506489">//&nbsp;methods&nbsp;associated&nbsp;with&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2506521">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="2506524">//&nbsp;ChanDir&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno"></span><span class="keyword" id="2506574">type</span>&nbsp;<span class="ident" id="2506579">ChanDir</span>&nbsp;<span class="builtintype" id="2506587">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2506592">const</span>&nbsp;<span class="op" id="2506598">(</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506601">RecvDir</span>&nbsp;<span class="ident" id="2506609">ChanDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506629">=</span>&nbsp;<span class="num" id="2506631">1</span>&nbsp;<span class="op" id="2506633">&lt;&lt;</span>&nbsp;<span class="ident" id="2506636">iota</span>&nbsp;<span class="comment" id="2506641">//&nbsp;&lt;-chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506652">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2506692">//&nbsp;chan&lt;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506703">BothDir</span>&nbsp;<span class="op" id="2506711">=</span>&nbsp;<span class="ident" id="2506713">RecvDir</span>&nbsp;<span class="op" id="2506721">|</span>&nbsp;<span class="ident" id="2506723">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2506743">//&nbsp;chan</span><br>
<span class="lineno"></span><span class="op" id="2506751">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="2506754">//&nbsp;arrayType&nbsp;represents&nbsp;a&nbsp;fixed&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2506798">type</span>&nbsp;<span class="ident" id="2506803">arrayType</span>&nbsp;<span class="keyword" id="2506813">struct</span>&nbsp;<span class="op" id="2506820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506823">rtype</span>&nbsp;<span class="string" id="2506829">`reflect:&#34;array&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506848">elem</span>&nbsp;&nbsp;<span class="op" id="2506854">*</span><span class="ident" id="2506855">rtype</span>&nbsp;<span class="comment" id="2506861">//&nbsp;array&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506884">slice</span>&nbsp;<span class="op" id="2506890">*</span><span class="ident" id="2506891">rtype</span>&nbsp;<span class="comment" id="2506897">//&nbsp;slice&nbsp;type</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2506912">len</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2506918">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2506926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2506929">//&nbsp;chanType&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2506968">type</span>&nbsp;<span class="ident" id="2506973">chanType</span>&nbsp;<span class="keyword" id="2506982">struct</span>&nbsp;<span class="op" id="2506989">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2506992">rtype</span>&nbsp;<span class="string" id="2506998">`reflect:&#34;chan&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507016">elem</span>&nbsp;&nbsp;<span class="op" id="2507022">*</span><span class="ident" id="2507023">rtype</span>&nbsp;&nbsp;<span class="comment" id="2507030">//&nbsp;channel&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507055">dir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2507061">uintptr</span>&nbsp;<span class="comment" id="2507069">//&nbsp;channel&nbsp;direction&nbsp;(ChanDir)</span><br>
<span class="lineno"></span><span class="op" id="2507100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2507103">//&nbsp;funcType&nbsp;represents&nbsp;a&nbsp;function&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2507143">type</span>&nbsp;<span class="ident" id="2507148">funcType</span>&nbsp;<span class="keyword" id="2507157">struct</span>&nbsp;<span class="op" id="2507164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507167">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2507177">`reflect:&#34;func&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507195">dotdotdot</span>&nbsp;<span class="builtintype" id="2507205">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2507214">//&nbsp;last&nbsp;input&nbsp;parameter&nbsp;is&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507246">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507256">[</span><span class="op" id="2507257">]</span><span class="op" id="2507258">*</span><span class="ident" id="2507259">rtype</span>&nbsp;<span class="comment" id="2507265">//&nbsp;input&nbsp;parameter&nbsp;types</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507291">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507301">[</span><span class="op" id="2507302">]</span><span class="op" id="2507303">*</span><span class="ident" id="2507304">rtype</span>&nbsp;<span class="comment" id="2507310">//&nbsp;output&nbsp;parameter&nbsp;types</span><br>
<span class="lineno"></span><span class="op" id="2507336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2507339">//&nbsp;imethod&nbsp;represents&nbsp;a&nbsp;method&nbsp;on&nbsp;an&nbsp;interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2507391">type</span>&nbsp;<span class="ident" id="2507396">imethod</span>&nbsp;<span class="keyword" id="2507404">struct</span>&nbsp;<span class="op" id="2507411">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507414">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507422">*</span><span class="builtintype" id="2507423">string</span>&nbsp;<span class="comment" id="2507430">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507449">pkgPath</span>&nbsp;<span class="op" id="2507457">*</span><span class="builtintype" id="2507458">string</span>&nbsp;<span class="comment" id="2507465">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507515">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507523">*</span><span class="ident" id="2507524">rtype</span>&nbsp;&nbsp;<span class="comment" id="2507531">//&nbsp;.(*FuncType)&nbsp;underneath</span><br>
<span class="lineno"></span><span class="op" id="2507558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="comment" id="2507561">//&nbsp;interfaceType&nbsp;represents&nbsp;an&nbsp;interface&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2507608">type</span>&nbsp;<span class="ident" id="2507613">interfaceType</span>&nbsp;<span class="keyword" id="2507627">struct</span>&nbsp;<span class="op" id="2507634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507637">rtype</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2507645">`reflect:&#34;interface&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507668">methods</span>&nbsp;<span class="op" id="2507676">[</span><span class="op" id="2507677">]</span><span class="ident" id="2507678">imethod</span>&nbsp;<span class="comment" id="2507686">//&nbsp;sorted&nbsp;by&nbsp;hash</span><br>
<span class="lineno"></span><span class="op" id="2507704">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="comment" id="2507707">//&nbsp;mapType&nbsp;represents&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2507741">type</span>&nbsp;<span class="ident" id="2507746">mapType</span>&nbsp;<span class="keyword" id="2507754">struct</span>&nbsp;<span class="op" id="2507761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507764">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2507778">`reflect:&#34;map&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507795">key</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507809">*</span><span class="ident" id="2507810">rtype</span>&nbsp;<span class="comment" id="2507816">//&nbsp;map&nbsp;key&nbsp;type</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507833">elem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507847">*</span><span class="ident" id="2507848">rtype</span>&nbsp;<span class="comment" id="2507854">//&nbsp;map&nbsp;element&nbsp;(value)&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507883">bucket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507897">*</span><span class="ident" id="2507898">rtype</span>&nbsp;<span class="comment" id="2507904">//&nbsp;internal&nbsp;bucket&nbsp;structure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507934">hmap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507948">*</span><span class="ident" id="2507949">rtype</span>&nbsp;<span class="comment" id="2507955">//&nbsp;internal&nbsp;map&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2507979">keysize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2507993">uint8</span>&nbsp;&nbsp;<span class="comment" id="2508000">//&nbsp;size&nbsp;of&nbsp;key&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508021">indirectkey</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2508035">uint8</span>&nbsp;&nbsp;<span class="comment" id="2508042">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;key&nbsp;instead&nbsp;of&nbsp;key&nbsp;itself</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508085">valuesize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2508099">uint8</span>&nbsp;&nbsp;<span class="comment" id="2508106">//&nbsp;size&nbsp;of&nbsp;value&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508129">indirectvalue</span>&nbsp;<span class="builtintype" id="2508143">uint8</span>&nbsp;&nbsp;<span class="comment" id="2508150">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;value&nbsp;instead&nbsp;of&nbsp;value&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508197">bucketsize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2508211">uint16</span>&nbsp;<span class="comment" id="2508218">//&nbsp;size&nbsp;of&nbsp;bucket</span><br>
<span class="lineno"></span><span class="op" id="2508236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="2508239">//&nbsp;ptrType&nbsp;represents&nbsp;a&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2508277">type</span>&nbsp;<span class="ident" id="2508282">ptrType</span>&nbsp;<span class="keyword" id="2508290">struct</span>&nbsp;<span class="op" id="2508297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508300">rtype</span>&nbsp;<span class="string" id="2508306">`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508323">elem</span>&nbsp;&nbsp;<span class="op" id="2508329">*</span><span class="ident" id="2508330">rtype</span>&nbsp;<span class="comment" id="2508336">//&nbsp;pointer&nbsp;element&nbsp;(pointed&nbsp;at)&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2508373">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2508376">//&nbsp;sliceType&nbsp;represents&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2508414">type</span>&nbsp;<span class="ident" id="2508419">sliceType</span>&nbsp;<span class="keyword" id="2508429">struct</span>&nbsp;<span class="op" id="2508436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508439">rtype</span>&nbsp;<span class="string" id="2508445">`reflect:&#34;slice&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508464">elem</span>&nbsp;&nbsp;<span class="op" id="2508470">*</span><span class="ident" id="2508471">rtype</span>&nbsp;<span class="comment" id="2508477">//&nbsp;slice&nbsp;element&nbsp;type</span><br>
<span class="lineno">360</span><span class="op" id="2508499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2508502">//&nbsp;Struct&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="2508518">type</span>&nbsp;<span class="ident" id="2508523">structField</span>&nbsp;<span class="keyword" id="2508535">struct</span>&nbsp;<span class="op" id="2508542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508545">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2508553">*</span><span class="builtintype" id="2508554">string</span>&nbsp;<span class="comment" id="2508561">//&nbsp;nil&nbsp;for&nbsp;embedded&nbsp;fields</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508589">pkgPath</span>&nbsp;<span class="op" id="2508597">*</span><span class="builtintype" id="2508598">string</span>&nbsp;<span class="comment" id="2508605">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508655">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2508663">*</span><span class="ident" id="2508664">rtype</span>&nbsp;&nbsp;<span class="comment" id="2508671">//&nbsp;type&nbsp;of&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508689">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2508697">*</span><span class="builtintype" id="2508698">string</span>&nbsp;<span class="comment" id="2508705">//&nbsp;nil&nbsp;if&nbsp;no&nbsp;tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508723">offset</span>&nbsp;&nbsp;<span class="builtintype" id="2508731">uintptr</span>&nbsp;<span class="comment" id="2508739">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;field&nbsp;within&nbsp;struct</span><br>
<span class="lineno"></span><span class="op" id="2508777">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="2508780">//&nbsp;structType&nbsp;represents&nbsp;a&nbsp;struct&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2508820">type</span>&nbsp;<span class="ident" id="2508825">structType</span>&nbsp;<span class="keyword" id="2508836">struct</span>&nbsp;<span class="op" id="2508843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508846">rtype</span>&nbsp;&nbsp;<span class="string" id="2508853">`reflect:&#34;struct&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2508873">fields</span>&nbsp;<span class="op" id="2508880">[</span><span class="op" id="2508881">]</span><span class="ident" id="2508882">structField</span>&nbsp;<span class="comment" id="2508894">//&nbsp;sorted&nbsp;by&nbsp;offset</span><br>
<span class="lineno">375</span><span class="op" id="2508914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2508917">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;knows&nbsp;the&nbsp;exact&nbsp;layout&nbsp;of&nbsp;all&nbsp;the&nbsp;data&nbsp;structures&nbsp;above.<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;does&nbsp;not&nbsp;know&nbsp;about&nbsp;the&nbsp;data&nbsp;structures&nbsp;and&nbsp;methods&nbsp;below.<br>
<span class="lineno">380</span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2509073">//&nbsp;Method&nbsp;represents&nbsp;a&nbsp;single&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2509111">type</span>&nbsp;<span class="ident" id="2509116">Method</span>&nbsp;<span class="keyword" id="2509123">struct</span>&nbsp;<span class="op" id="2509130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2509133">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;method&nbsp;name.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2509162">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2509235">//&nbsp;method&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;method&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2509305">//&nbsp;The&nbsp;combination&nbsp;of&nbsp;PkgPath&nbsp;and&nbsp;Name&nbsp;uniquely&nbsp;identifies&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2509374">//&nbsp;in&nbsp;a&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2509395">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509456">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2509464">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509472">PkgPath</span>&nbsp;<span class="builtintype" id="2509480">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509489">Type</span>&nbsp;&nbsp;<span class="ident" id="2509495">Type</span>&nbsp;&nbsp;<span class="comment" id="2509501">//&nbsp;method&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509517">Func</span>&nbsp;&nbsp;<span class="ident" id="2509523">Value</span>&nbsp;<span class="comment" id="2509529">//&nbsp;func&nbsp;with&nbsp;receiver&nbsp;as&nbsp;first&nbsp;argument</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509570">Index</span>&nbsp;<span class="builtintype" id="2509576">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2509582">//&nbsp;index&nbsp;for&nbsp;Type.Method</span><br>
<span class="lineno"></span><span class="op" id="2509607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2509610">const</span>&nbsp;<span class="op" id="2509616">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509619">kindDirectIface</span>&nbsp;<span class="op" id="2509635">=</span>&nbsp;<span class="num" id="2509637">1</span>&nbsp;<span class="op" id="2509639">&lt;&lt;</span>&nbsp;<span class="num" id="2509642">5</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509645">kindGCProg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2509661">=</span>&nbsp;<span class="num" id="2509663">1</span>&nbsp;<span class="op" id="2509665">&lt;&lt;</span>&nbsp;<span class="num" id="2509668">6</span>&nbsp;<span class="comment" id="2509670">//&nbsp;Type.gc&nbsp;points&nbsp;to&nbsp;GC&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509703">kindNoPointers</span>&nbsp;&nbsp;<span class="op" id="2509719">=</span>&nbsp;<span class="num" id="2509721">1</span>&nbsp;<span class="op" id="2509723">&lt;&lt;</span>&nbsp;<span class="num" id="2509726">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509729">kindMask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2509745">=</span>&nbsp;<span class="op" id="2509747">(</span><span class="num" id="2509748">1</span>&nbsp;<span class="op" id="2509750">&lt;&lt;</span>&nbsp;<span class="num" id="2509753">5</span><span class="op" id="2509754">)</span>&nbsp;<span class="op" id="2509756">-</span>&nbsp;<span class="num" id="2509758">1</span><br>
<span class="lineno"></span><span class="op" id="2509760">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="keyword" id="2509763">func</span>&nbsp;<span class="op" id="2509768">(</span><span class="ident" id="2509769">k</span>&nbsp;<span class="ident" id="2509771">Kind</span><span class="op" id="2509775">)</span>&nbsp;<span class="ident" id="2509777">String</span><span class="op" id="2509783">(</span><span class="op" id="2509784">)</span>&nbsp;<span class="builtintype" id="2509786">string</span>&nbsp;<span class="op" id="2509793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509796">if</span>&nbsp;<span class="builtintype" id="2509799">int</span><span class="op" id="2509802">(</span><span class="ident" id="2509803">k</span><span class="op" id="2509804">)</span>&nbsp;<span class="op" id="2509806">&lt;</span>&nbsp;<span class="builtinfunc" id="2509808">len</span><span class="op" id="2509811">(</span><span class="ident" id="2509812">kindNames</span><span class="op" id="2509821">)</span>&nbsp;<span class="op" id="2509823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509827">return</span>&nbsp;<span class="ident" id="2509834">kindNames</span><span class="op" id="2509843">[</span><span class="ident" id="2509844">k</span><span class="op" id="2509845">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2509848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2509851">return</span>&nbsp;<span class="string" id="2509858">&#34;kind&#34;</span>&nbsp;<span class="op" id="2509865">+</span>&nbsp;<span class="ident" id="2509867">strconv</span><span class="op" id="2509874">.</span><span class="ident" id="2509875">Itoa</span><span class="op" id="2509879">(</span><span class="builtintype" id="2509880">int</span><span class="op" id="2509883">(</span><span class="ident" id="2509884">k</span><span class="op" id="2509885">)</span><span class="op" id="2509886">)</span><br>
<span class="lineno">410</span><span class="op" id="2509888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2509891">var</span>&nbsp;<span class="ident" id="2509895">kindNames</span>&nbsp;<span class="op" id="2509905">=</span>&nbsp;<span class="op" id="2509907">[</span><span class="op" id="2509908">]</span><span class="builtintype" id="2509909">string</span><span class="op" id="2509915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509918">Invalid</span><span class="op" id="2509925">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2509933">&#34;invalid&#34;</span><span class="op" id="2509942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509945">Bool</span><span class="op" id="2509949">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2509960">&#34;bool&#34;</span><span class="op" id="2509966">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509969">Int</span><span class="op" id="2509972">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2509984">&#34;int&#34;</span><span class="op" id="2509989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2509992">Int8</span><span class="op" id="2509996">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510007">&#34;int8&#34;</span><span class="op" id="2510013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510016">Int16</span><span class="op" id="2510021">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510031">&#34;int16&#34;</span><span class="op" id="2510038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510041">Int32</span><span class="op" id="2510046">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510056">&#34;int32&#34;</span><span class="op" id="2510063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510066">Int64</span><span class="op" id="2510071">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510081">&#34;int64&#34;</span><span class="op" id="2510088">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510091">Uint</span><span class="op" id="2510095">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510106">&#34;uint&#34;</span><span class="op" id="2510112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510115">Uint8</span><span class="op" id="2510120">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510130">&#34;uint8&#34;</span><span class="op" id="2510137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510140">Uint16</span><span class="op" id="2510146">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510155">&#34;uint16&#34;</span><span class="op" id="2510163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510166">Uint32</span><span class="op" id="2510172">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510181">&#34;uint32&#34;</span><span class="op" id="2510189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510192">Uint64</span><span class="op" id="2510198">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510207">&#34;uint64&#34;</span><span class="op" id="2510215">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510218">Uintptr</span><span class="op" id="2510225">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510233">&#34;uintptr&#34;</span><span class="op" id="2510242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510245">Float32</span><span class="op" id="2510252">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510260">&#34;float32&#34;</span><span class="op" id="2510269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510272">Float64</span><span class="op" id="2510279">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510287">&#34;float64&#34;</span><span class="op" id="2510296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510299">Complex64</span><span class="op" id="2510308">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510314">&#34;complex64&#34;</span><span class="op" id="2510325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510328">Complex128</span><span class="op" id="2510338">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510343">&#34;complex128&#34;</span><span class="op" id="2510355">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510358">Array</span><span class="op" id="2510363">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510373">&#34;array&#34;</span><span class="op" id="2510380">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510383">Chan</span><span class="op" id="2510387">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510398">&#34;chan&#34;</span><span class="op" id="2510404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510407">Func</span><span class="op" id="2510411">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510422">&#34;func&#34;</span><span class="op" id="2510428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510431">Interface</span><span class="op" id="2510440">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510446">&#34;interface&#34;</span><span class="op" id="2510457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510460">Map</span><span class="op" id="2510463">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510475">&#34;map&#34;</span><span class="op" id="2510480">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510483">Ptr</span><span class="op" id="2510486">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510498">&#34;ptr&#34;</span><span class="op" id="2510503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510506">Slice</span><span class="op" id="2510511">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510521">&#34;slice&#34;</span><span class="op" id="2510528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510531">String</span><span class="op" id="2510537">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510546">&#34;string&#34;</span><span class="op" id="2510554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510557">Struct</span><span class="op" id="2510563">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2510572">&#34;struct&#34;</span><span class="op" id="2510580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2510583">UnsafePointer</span><span class="op" id="2510596">:</span>&nbsp;<span class="string" id="2510598">&#34;unsafe.Pointer&#34;</span><span class="op" id="2510614">,</span><br>
<span class="lineno">440</span><span class="op" id="2510616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2510619">func</span>&nbsp;<span class="op" id="2510624">(</span><span class="ident" id="2510625">t</span>&nbsp;<span class="op" id="2510627">*</span><span class="ident" id="2510628">uncommonType</span><span class="op" id="2510640">)</span>&nbsp;<span class="ident" id="2510642">uncommon</span><span class="op" id="2510650">(</span><span class="op" id="2510651">)</span>&nbsp;<span class="op" id="2510653">*</span><span class="ident" id="2510654">uncommonType</span>&nbsp;<span class="op" id="2510667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510670">return</span>&nbsp;<span class="ident" id="2510677">t</span><br>
<span class="lineno"></span><span class="op" id="2510679">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="2510682">func</span>&nbsp;<span class="op" id="2510687">(</span><span class="ident" id="2510688">t</span>&nbsp;<span class="op" id="2510690">*</span><span class="ident" id="2510691">uncommonType</span><span class="op" id="2510703">)</span>&nbsp;<span class="ident" id="2510705">PkgPath</span><span class="op" id="2510712">(</span><span class="op" id="2510713">)</span>&nbsp;<span class="builtintype" id="2510715">string</span>&nbsp;<span class="op" id="2510722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510725">if</span>&nbsp;<span class="ident" id="2510728">t</span>&nbsp;<span class="op" id="2510730">==</span>&nbsp;<span class="ident" id="2510733">nil</span>&nbsp;<span class="op" id="2510737">||</span>&nbsp;<span class="ident" id="2510740">t</span><span class="op" id="2510741">.</span><span class="ident" id="2510742">pkgPath</span>&nbsp;<span class="op" id="2510750">==</span>&nbsp;<span class="ident" id="2510753">nil</span>&nbsp;<span class="op" id="2510757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510761">return</span>&nbsp;<span class="string" id="2510768">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2510772">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510775">return</span>&nbsp;<span class="op" id="2510782">*</span><span class="ident" id="2510783">t</span><span class="op" id="2510784">.</span><span class="ident" id="2510785">pkgPath</span><br>
<span class="lineno"></span><span class="op" id="2510793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2510796">func</span>&nbsp;<span class="op" id="2510801">(</span><span class="ident" id="2510802">t</span>&nbsp;<span class="op" id="2510804">*</span><span class="ident" id="2510805">uncommonType</span><span class="op" id="2510817">)</span>&nbsp;<span class="ident" id="2510819">Name</span><span class="op" id="2510823">(</span><span class="op" id="2510824">)</span>&nbsp;<span class="builtintype" id="2510826">string</span>&nbsp;<span class="op" id="2510833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510836">if</span>&nbsp;<span class="ident" id="2510839">t</span>&nbsp;<span class="op" id="2510841">==</span>&nbsp;<span class="ident" id="2510844">nil</span>&nbsp;<span class="op" id="2510848">||</span>&nbsp;<span class="ident" id="2510851">t</span><span class="op" id="2510852">.</span><span class="ident" id="2510853">name</span>&nbsp;<span class="op" id="2510858">==</span>&nbsp;<span class="ident" id="2510861">nil</span>&nbsp;<span class="op" id="2510865">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510869">return</span>&nbsp;<span class="string" id="2510876">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2510880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2510883">return</span>&nbsp;<span class="op" id="2510890">*</span><span class="ident" id="2510891">t</span><span class="op" id="2510892">.</span><span class="ident" id="2510893">name</span><br>
<span class="lineno"></span><span class="op" id="2510898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="2510901">func</span>&nbsp;<span class="op" id="2510906">(</span><span class="ident" id="2510907">t</span>&nbsp;<span class="op" id="2510909">*</span><span class="ident" id="2510910">rtype</span><span class="op" id="2510915">)</span>&nbsp;<span class="ident" id="2510917">String</span><span class="op" id="2510923">(</span><span class="op" id="2510924">)</span>&nbsp;<span class="builtintype" id="2510926">string</span>&nbsp;<span class="op" id="2510933">{</span>&nbsp;<span class="keyword" id="2510935">return</span>&nbsp;<span class="op" id="2510942">*</span><span class="ident" id="2510943">t</span><span class="op" id="2510944">.</span><span class="builtintype" id="2510945">string</span>&nbsp;<span class="op" id="2510952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2510955">func</span>&nbsp;<span class="op" id="2510960">(</span><span class="ident" id="2510961">t</span>&nbsp;<span class="op" id="2510963">*</span><span class="ident" id="2510964">rtype</span><span class="op" id="2510969">)</span>&nbsp;<span class="ident" id="2510971">Size</span><span class="op" id="2510975">(</span><span class="op" id="2510976">)</span>&nbsp;<span class="builtintype" id="2510978">uintptr</span>&nbsp;<span class="op" id="2510986">{</span>&nbsp;<span class="keyword" id="2510988">return</span>&nbsp;<span class="ident" id="2510995">t</span><span class="op" id="2510996">.</span><span class="ident" id="2510997">size</span>&nbsp;<span class="op" id="2511002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2511005">func</span>&nbsp;<span class="op" id="2511010">(</span><span class="ident" id="2511011">t</span>&nbsp;<span class="op" id="2511013">*</span><span class="ident" id="2511014">rtype</span><span class="op" id="2511019">)</span>&nbsp;<span class="ident" id="2511021">Bits</span><span class="op" id="2511025">(</span><span class="op" id="2511026">)</span>&nbsp;<span class="builtintype" id="2511028">int</span>&nbsp;<span class="op" id="2511032">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511035">if</span>&nbsp;<span class="ident" id="2511038">t</span>&nbsp;<span class="op" id="2511040">==</span>&nbsp;<span class="ident" id="2511043">nil</span>&nbsp;<span class="op" id="2511047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2511051">panic</span><span class="op" id="2511056">(</span><span class="string" id="2511057">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;nil&nbsp;Type&#34;</span><span class="op" id="2511084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2511087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511090">k</span>&nbsp;<span class="op" id="2511092">:=</span>&nbsp;<span class="ident" id="2511095">t</span><span class="op" id="2511096">.</span><span class="ident" id="2511097">Kind</span><span class="op" id="2511101">(</span><span class="op" id="2511102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511105">if</span>&nbsp;<span class="ident" id="2511108">k</span>&nbsp;<span class="op" id="2511110">&lt;</span>&nbsp;<span class="ident" id="2511112">Int</span>&nbsp;<span class="op" id="2511116">||</span>&nbsp;<span class="ident" id="2511119">k</span>&nbsp;<span class="op" id="2511121">&gt;</span>&nbsp;<span class="ident" id="2511123">Complex128</span>&nbsp;<span class="op" id="2511134">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2511138">panic</span><span class="op" id="2511143">(</span><span class="string" id="2511144">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;non-arithmetic&nbsp;Type&nbsp;&#34;</span>&nbsp;<span class="op" id="2511184">+</span>&nbsp;<span class="ident" id="2511186">t</span><span class="op" id="2511187">.</span><span class="ident" id="2511188">String</span><span class="op" id="2511194">(</span><span class="op" id="2511195">)</span><span class="op" id="2511196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2511199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511202">return</span>&nbsp;<span class="builtintype" id="2511209">int</span><span class="op" id="2511212">(</span><span class="ident" id="2511213">t</span><span class="op" id="2511214">.</span><span class="ident" id="2511215">size</span><span class="op" id="2511219">)</span>&nbsp;<span class="op" id="2511221">*</span>&nbsp;<span class="num" id="2511223">8</span><br>
<span class="lineno"></span><span class="op" id="2511225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="2511228">func</span>&nbsp;<span class="op" id="2511233">(</span><span class="ident" id="2511234">t</span>&nbsp;<span class="op" id="2511236">*</span><span class="ident" id="2511237">rtype</span><span class="op" id="2511242">)</span>&nbsp;<span class="ident" id="2511244">Align</span><span class="op" id="2511249">(</span><span class="op" id="2511250">)</span>&nbsp;<span class="builtintype" id="2511252">int</span>&nbsp;<span class="op" id="2511256">{</span>&nbsp;<span class="keyword" id="2511258">return</span>&nbsp;<span class="builtintype" id="2511265">int</span><span class="op" id="2511268">(</span><span class="ident" id="2511269">t</span><span class="op" id="2511270">.</span><span class="ident" id="2511271">align</span><span class="op" id="2511276">)</span>&nbsp;<span class="op" id="2511278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2511281">func</span>&nbsp;<span class="op" id="2511286">(</span><span class="ident" id="2511287">t</span>&nbsp;<span class="op" id="2511289">*</span><span class="ident" id="2511290">rtype</span><span class="op" id="2511295">)</span>&nbsp;<span class="ident" id="2511297">FieldAlign</span><span class="op" id="2511307">(</span><span class="op" id="2511308">)</span>&nbsp;<span class="builtintype" id="2511310">int</span>&nbsp;<span class="op" id="2511314">{</span>&nbsp;<span class="keyword" id="2511316">return</span>&nbsp;<span class="builtintype" id="2511323">int</span><span class="op" id="2511326">(</span><span class="ident" id="2511327">t</span><span class="op" id="2511328">.</span><span class="ident" id="2511329">fieldAlign</span><span class="op" id="2511339">)</span>&nbsp;<span class="op" id="2511341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2511344">func</span>&nbsp;<span class="op" id="2511349">(</span><span class="ident" id="2511350">t</span>&nbsp;<span class="op" id="2511352">*</span><span class="ident" id="2511353">rtype</span><span class="op" id="2511358">)</span>&nbsp;<span class="ident" id="2511360">Kind</span><span class="op" id="2511364">(</span><span class="op" id="2511365">)</span>&nbsp;<span class="ident" id="2511367">Kind</span>&nbsp;<span class="op" id="2511372">{</span>&nbsp;<span class="keyword" id="2511374">return</span>&nbsp;<span class="ident" id="2511381">Kind</span><span class="op" id="2511385">(</span><span class="ident" id="2511386">t</span><span class="op" id="2511387">.</span><span class="ident" id="2511388">kind</span>&nbsp;<span class="op" id="2511393">&amp;</span>&nbsp;<span class="ident" id="2511395">kindMask</span><span class="op" id="2511403">)</span>&nbsp;<span class="op" id="2511405">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="keyword" id="2511408">func</span>&nbsp;<span class="op" id="2511413">(</span><span class="ident" id="2511414">t</span>&nbsp;<span class="op" id="2511416">*</span><span class="ident" id="2511417">rtype</span><span class="op" id="2511422">)</span>&nbsp;<span class="ident" id="2511424">pointers</span><span class="op" id="2511432">(</span><span class="op" id="2511433">)</span>&nbsp;<span class="builtintype" id="2511435">bool</span>&nbsp;<span class="op" id="2511440">{</span>&nbsp;<span class="keyword" id="2511442">return</span>&nbsp;<span class="ident" id="2511449">t</span><span class="op" id="2511450">.</span><span class="ident" id="2511451">kind</span><span class="op" id="2511455">&amp;</span><span class="ident" id="2511456">kindNoPointers</span>&nbsp;<span class="op" id="2511471">==</span>&nbsp;<span class="num" id="2511474">0</span>&nbsp;<span class="op" id="2511476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2511479">func</span>&nbsp;<span class="op" id="2511484">(</span><span class="ident" id="2511485">t</span>&nbsp;<span class="op" id="2511487">*</span><span class="ident" id="2511488">rtype</span><span class="op" id="2511493">)</span>&nbsp;<span class="ident" id="2511495">common</span><span class="op" id="2511501">(</span><span class="op" id="2511502">)</span>&nbsp;<span class="op" id="2511504">*</span><span class="ident" id="2511505">rtype</span>&nbsp;<span class="op" id="2511511">{</span>&nbsp;<span class="keyword" id="2511513">return</span>&nbsp;<span class="ident" id="2511520">t</span>&nbsp;<span class="op" id="2511522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2511525">func</span>&nbsp;<span class="op" id="2511530">(</span><span class="ident" id="2511531">t</span>&nbsp;<span class="op" id="2511533">*</span><span class="ident" id="2511534">uncommonType</span><span class="op" id="2511546">)</span>&nbsp;<span class="ident" id="2511548">Method</span><span class="op" id="2511554">(</span><span class="ident" id="2511555">i</span>&nbsp;<span class="builtintype" id="2511557">int</span><span class="op" id="2511560">)</span>&nbsp;<span class="op" id="2511562">(</span><span class="ident" id="2511563">m</span>&nbsp;<span class="ident" id="2511565">Method</span><span class="op" id="2511571">)</span>&nbsp;<span class="op" id="2511573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511576">if</span>&nbsp;<span class="ident" id="2511579">t</span>&nbsp;<span class="op" id="2511581">==</span>&nbsp;<span class="ident" id="2511584">nil</span>&nbsp;<span class="op" id="2511588">||</span>&nbsp;<span class="ident" id="2511591">i</span>&nbsp;<span class="op" id="2511593">&lt;</span>&nbsp;<span class="num" id="2511595">0</span>&nbsp;<span class="op" id="2511597">||</span>&nbsp;<span class="ident" id="2511600">i</span>&nbsp;<span class="op" id="2511602">&gt;=</span>&nbsp;<span class="builtinfunc" id="2511605">len</span><span class="op" id="2511608">(</span><span class="ident" id="2511609">t</span><span class="op" id="2511610">.</span><span class="ident" id="2511611">methods</span><span class="op" id="2511618">)</span>&nbsp;<span class="op" id="2511620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2511624">panic</span><span class="op" id="2511629">(</span><span class="string" id="2511630">&#34;reflect:&nbsp;Method&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="2511666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2511669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511672">p</span>&nbsp;<span class="op" id="2511674">:=</span>&nbsp;<span class="op" id="2511677">&amp;</span><span class="ident" id="2511678">t</span><span class="op" id="2511679">.</span><span class="ident" id="2511680">methods</span><span class="op" id="2511687">[</span><span class="ident" id="2511688">i</span><span class="op" id="2511689">]</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511692">if</span>&nbsp;<span class="ident" id="2511695">p</span><span class="op" id="2511696">.</span><span class="ident" id="2511697">name</span>&nbsp;<span class="op" id="2511702">!=</span>&nbsp;<span class="ident" id="2511705">nil</span>&nbsp;<span class="op" id="2511709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511713">m</span><span class="op" id="2511714">.</span><span class="ident" id="2511715">Name</span>&nbsp;<span class="op" id="2511720">=</span>&nbsp;<span class="op" id="2511722">*</span><span class="ident" id="2511723">p</span><span class="op" id="2511724">.</span><span class="ident" id="2511725">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2511731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511734">fl</span>&nbsp;<span class="op" id="2511737">:=</span>&nbsp;<span class="ident" id="2511740">flag</span><span class="op" id="2511744">(</span><span class="ident" id="2511745">Func</span><span class="op" id="2511749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511752">if</span>&nbsp;<span class="ident" id="2511755">p</span><span class="op" id="2511756">.</span><span class="ident" id="2511757">pkgPath</span>&nbsp;<span class="op" id="2511765">!=</span>&nbsp;<span class="ident" id="2511768">nil</span>&nbsp;<span class="op" id="2511772">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511776">m</span><span class="op" id="2511777">.</span><span class="ident" id="2511778">PkgPath</span>&nbsp;<span class="op" id="2511786">=</span>&nbsp;<span class="op" id="2511788">*</span><span class="ident" id="2511789">p</span><span class="op" id="2511790">.</span><span class="ident" id="2511791">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511801">fl</span>&nbsp;<span class="op" id="2511804">|=</span>&nbsp;<span class="ident" id="2511807">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2511815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511818">mt</span>&nbsp;<span class="op" id="2511821">:=</span>&nbsp;<span class="ident" id="2511824">p</span><span class="op" id="2511825">.</span><span class="ident" id="2511826">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511831">m</span><span class="op" id="2511832">.</span><span class="ident" id="2511833">Type</span>&nbsp;<span class="op" id="2511838">=</span>&nbsp;<span class="ident" id="2511840">mt</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511844">fn</span>&nbsp;<span class="op" id="2511847">:=</span>&nbsp;<span class="ident" id="2511850">unsafe</span><span class="op" id="2511856">.</span><span class="ident" id="2511857">Pointer</span><span class="op" id="2511864">(</span><span class="op" id="2511865">&amp;</span><span class="ident" id="2511866">p</span><span class="op" id="2511867">.</span><span class="ident" id="2511868">tfn</span><span class="op" id="2511871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511874">m</span><span class="op" id="2511875">.</span><span class="ident" id="2511876">Func</span>&nbsp;<span class="op" id="2511881">=</span>&nbsp;<span class="ident" id="2511883">Value</span><span class="op" id="2511888">{</span><span class="ident" id="2511889">mt</span><span class="op" id="2511891">,</span>&nbsp;<span class="ident" id="2511893">fn</span><span class="op" id="2511895">,</span>&nbsp;<span class="ident" id="2511897">fl</span><span class="op" id="2511899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2511902">m</span><span class="op" id="2511903">.</span><span class="ident" id="2511904">Index</span>&nbsp;<span class="op" id="2511910">=</span>&nbsp;<span class="ident" id="2511912">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511915">return</span><br>
<span class="lineno"></span><span class="op" id="2511922">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="2511925">func</span>&nbsp;<span class="op" id="2511930">(</span><span class="ident" id="2511931">t</span>&nbsp;<span class="op" id="2511933">*</span><span class="ident" id="2511934">uncommonType</span><span class="op" id="2511946">)</span>&nbsp;<span class="ident" id="2511948">NumMethod</span><span class="op" id="2511957">(</span><span class="op" id="2511958">)</span>&nbsp;<span class="builtintype" id="2511960">int</span>&nbsp;<span class="op" id="2511964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511967">if</span>&nbsp;<span class="ident" id="2511970">t</span>&nbsp;<span class="op" id="2511972">==</span>&nbsp;<span class="ident" id="2511975">nil</span>&nbsp;<span class="op" id="2511979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511983">return</span>&nbsp;<span class="num" id="2511990">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2511993">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2511996">return</span>&nbsp;<span class="builtinfunc" id="2512003">len</span><span class="op" id="2512006">(</span><span class="ident" id="2512007">t</span><span class="op" id="2512008">.</span><span class="ident" id="2512009">methods</span><span class="op" id="2512016">)</span><br>
<span class="lineno"></span><span class="op" id="2512018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2512021">func</span>&nbsp;<span class="op" id="2512026">(</span><span class="ident" id="2512027">t</span>&nbsp;<span class="op" id="2512029">*</span><span class="ident" id="2512030">uncommonType</span><span class="op" id="2512042">)</span>&nbsp;<span class="ident" id="2512044">MethodByName</span><span class="op" id="2512056">(</span><span class="ident" id="2512057">name</span>&nbsp;<span class="builtintype" id="2512062">string</span><span class="op" id="2512068">)</span>&nbsp;<span class="op" id="2512070">(</span><span class="ident" id="2512071">m</span>&nbsp;<span class="ident" id="2512073">Method</span><span class="op" id="2512079">,</span>&nbsp;<span class="ident" id="2512081">ok</span>&nbsp;<span class="builtintype" id="2512084">bool</span><span class="op" id="2512088">)</span>&nbsp;<span class="op" id="2512090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512093">if</span>&nbsp;<span class="ident" id="2512096">t</span>&nbsp;<span class="op" id="2512098">==</span>&nbsp;<span class="ident" id="2512101">nil</span>&nbsp;<span class="op" id="2512105">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512109">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2512117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512120">var</span>&nbsp;<span class="ident" id="2512124">p</span>&nbsp;<span class="op" id="2512126">*</span><span class="ident" id="2512127">method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512135">for</span>&nbsp;<span class="ident" id="2512139">i</span>&nbsp;<span class="op" id="2512141">:=</span>&nbsp;<span class="keyword" id="2512144">range</span>&nbsp;<span class="ident" id="2512150">t</span><span class="op" id="2512151">.</span><span class="ident" id="2512152">methods</span>&nbsp;<span class="op" id="2512160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512164">p</span>&nbsp;<span class="op" id="2512166">=</span>&nbsp;<span class="op" id="2512168">&amp;</span><span class="ident" id="2512169">t</span><span class="op" id="2512170">.</span><span class="ident" id="2512171">methods</span><span class="op" id="2512178">[</span><span class="ident" id="2512179">i</span><span class="op" id="2512180">]</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512184">if</span>&nbsp;<span class="ident" id="2512187">p</span><span class="op" id="2512188">.</span><span class="ident" id="2512189">name</span>&nbsp;<span class="op" id="2512194">!=</span>&nbsp;<span class="ident" id="2512197">nil</span>&nbsp;<span class="op" id="2512201">&amp;&amp;</span>&nbsp;<span class="op" id="2512204">*</span><span class="ident" id="2512205">p</span><span class="op" id="2512206">.</span><span class="ident" id="2512207">name</span>&nbsp;<span class="op" id="2512212">==</span>&nbsp;<span class="ident" id="2512215">name</span>&nbsp;<span class="op" id="2512220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512225">return</span>&nbsp;<span class="ident" id="2512232">t</span><span class="op" id="2512233">.</span><span class="ident" id="2512234">Method</span><span class="op" id="2512240">(</span><span class="ident" id="2512241">i</span><span class="op" id="2512242">)</span><span class="op" id="2512243">,</span>&nbsp;<span class="builtintype" id="2512245">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2512252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2512255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512258">return</span><br>
<span class="lineno">525</span><span class="op" id="2512265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2512268">//&nbsp;TODO(rsc):&nbsp;6g&nbsp;supplies&nbsp;these,&nbsp;but&nbsp;they&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2512318">//&nbsp;as&nbsp;efficient&nbsp;as&nbsp;they&nbsp;could&nbsp;be:&nbsp;they&nbsp;have&nbsp;commonType</span><br>
<span class="lineno"></span><span class="comment" id="2512373">//&nbsp;as&nbsp;the&nbsp;receiver&nbsp;instead&nbsp;of&nbsp;*rtype.</span><br>
<span class="lineno">530</span><span class="keyword" id="2512411">func</span>&nbsp;<span class="op" id="2512416">(</span><span class="ident" id="2512417">t</span>&nbsp;<span class="op" id="2512419">*</span><span class="ident" id="2512420">rtype</span><span class="op" id="2512425">)</span>&nbsp;<span class="ident" id="2512427">NumMethod</span><span class="op" id="2512436">(</span><span class="op" id="2512437">)</span>&nbsp;<span class="builtintype" id="2512439">int</span>&nbsp;<span class="op" id="2512443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512446">if</span>&nbsp;<span class="ident" id="2512449">t</span><span class="op" id="2512450">.</span><span class="ident" id="2512451">Kind</span><span class="op" id="2512455">(</span><span class="op" id="2512456">)</span>&nbsp;<span class="op" id="2512458">==</span>&nbsp;<span class="ident" id="2512461">Interface</span>&nbsp;<span class="op" id="2512471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512475">tt</span>&nbsp;<span class="op" id="2512478">:=</span>&nbsp;<span class="op" id="2512481">(</span><span class="op" id="2512482">*</span><span class="ident" id="2512483">interfaceType</span><span class="op" id="2512496">)</span><span class="op" id="2512497">(</span><span class="ident" id="2512498">unsafe</span><span class="op" id="2512504">.</span><span class="ident" id="2512505">Pointer</span><span class="op" id="2512512">(</span><span class="ident" id="2512513">t</span><span class="op" id="2512514">)</span><span class="op" id="2512515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512519">return</span>&nbsp;<span class="ident" id="2512526">tt</span><span class="op" id="2512528">.</span><span class="ident" id="2512529">NumMethod</span><span class="op" id="2512538">(</span><span class="op" id="2512539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2512542">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512545">return</span>&nbsp;<span class="ident" id="2512552">t</span><span class="op" id="2512553">.</span><span class="ident" id="2512554">uncommonType</span><span class="op" id="2512566">.</span><span class="ident" id="2512567">NumMethod</span><span class="op" id="2512576">(</span><span class="op" id="2512577">)</span><br>
<span class="lineno"></span><span class="op" id="2512579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2512582">func</span>&nbsp;<span class="op" id="2512587">(</span><span class="ident" id="2512588">t</span>&nbsp;<span class="op" id="2512590">*</span><span class="ident" id="2512591">rtype</span><span class="op" id="2512596">)</span>&nbsp;<span class="ident" id="2512598">Method</span><span class="op" id="2512604">(</span><span class="ident" id="2512605">i</span>&nbsp;<span class="builtintype" id="2512607">int</span><span class="op" id="2512610">)</span>&nbsp;<span class="op" id="2512612">(</span><span class="ident" id="2512613">m</span>&nbsp;<span class="ident" id="2512615">Method</span><span class="op" id="2512621">)</span>&nbsp;<span class="op" id="2512623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512626">if</span>&nbsp;<span class="ident" id="2512629">t</span><span class="op" id="2512630">.</span><span class="ident" id="2512631">Kind</span><span class="op" id="2512635">(</span><span class="op" id="2512636">)</span>&nbsp;<span class="op" id="2512638">==</span>&nbsp;<span class="ident" id="2512641">Interface</span>&nbsp;<span class="op" id="2512651">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512655">tt</span>&nbsp;<span class="op" id="2512658">:=</span>&nbsp;<span class="op" id="2512661">(</span><span class="op" id="2512662">*</span><span class="ident" id="2512663">interfaceType</span><span class="op" id="2512676">)</span><span class="op" id="2512677">(</span><span class="ident" id="2512678">unsafe</span><span class="op" id="2512684">.</span><span class="ident" id="2512685">Pointer</span><span class="op" id="2512692">(</span><span class="ident" id="2512693">t</span><span class="op" id="2512694">)</span><span class="op" id="2512695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512699">return</span>&nbsp;<span class="ident" id="2512706">tt</span><span class="op" id="2512708">.</span><span class="ident" id="2512709">Method</span><span class="op" id="2512715">(</span><span class="ident" id="2512716">i</span><span class="op" id="2512717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2512720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512723">return</span>&nbsp;<span class="ident" id="2512730">t</span><span class="op" id="2512731">.</span><span class="ident" id="2512732">uncommonType</span><span class="op" id="2512744">.</span><span class="ident" id="2512745">Method</span><span class="op" id="2512751">(</span><span class="ident" id="2512752">i</span><span class="op" id="2512753">)</span><br>
<span class="lineno"></span><span class="op" id="2512755">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="keyword" id="2512758">func</span>&nbsp;<span class="op" id="2512763">(</span><span class="ident" id="2512764">t</span>&nbsp;<span class="op" id="2512766">*</span><span class="ident" id="2512767">rtype</span><span class="op" id="2512772">)</span>&nbsp;<span class="ident" id="2512774">MethodByName</span><span class="op" id="2512786">(</span><span class="ident" id="2512787">name</span>&nbsp;<span class="builtintype" id="2512792">string</span><span class="op" id="2512798">)</span>&nbsp;<span class="op" id="2512800">(</span><span class="ident" id="2512801">m</span>&nbsp;<span class="ident" id="2512803">Method</span><span class="op" id="2512809">,</span>&nbsp;<span class="ident" id="2512811">ok</span>&nbsp;<span class="builtintype" id="2512814">bool</span><span class="op" id="2512818">)</span>&nbsp;<span class="op" id="2512820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512823">if</span>&nbsp;<span class="ident" id="2512826">t</span><span class="op" id="2512827">.</span><span class="ident" id="2512828">Kind</span><span class="op" id="2512832">(</span><span class="op" id="2512833">)</span>&nbsp;<span class="op" id="2512835">==</span>&nbsp;<span class="ident" id="2512838">Interface</span>&nbsp;<span class="op" id="2512848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2512852">tt</span>&nbsp;<span class="op" id="2512855">:=</span>&nbsp;<span class="op" id="2512858">(</span><span class="op" id="2512859">*</span><span class="ident" id="2512860">interfaceType</span><span class="op" id="2512873">)</span><span class="op" id="2512874">(</span><span class="ident" id="2512875">unsafe</span><span class="op" id="2512881">.</span><span class="ident" id="2512882">Pointer</span><span class="op" id="2512889">(</span><span class="ident" id="2512890">t</span><span class="op" id="2512891">)</span><span class="op" id="2512892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512896">return</span>&nbsp;<span class="ident" id="2512903">tt</span><span class="op" id="2512905">.</span><span class="ident" id="2512906">MethodByName</span><span class="op" id="2512918">(</span><span class="ident" id="2512919">name</span><span class="op" id="2512923">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2512926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2512929">return</span>&nbsp;<span class="ident" id="2512936">t</span><span class="op" id="2512937">.</span><span class="ident" id="2512938">uncommonType</span><span class="op" id="2512950">.</span><span class="ident" id="2512951">MethodByName</span><span class="op" id="2512963">(</span><span class="ident" id="2512964">name</span><span class="op" id="2512968">)</span><br>
<span class="lineno"></span><span class="op" id="2512970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2512973">func</span>&nbsp;<span class="op" id="2512978">(</span><span class="ident" id="2512979">t</span>&nbsp;<span class="op" id="2512981">*</span><span class="ident" id="2512982">rtype</span><span class="op" id="2512987">)</span>&nbsp;<span class="ident" id="2512989">PkgPath</span><span class="op" id="2512996">(</span><span class="op" id="2512997">)</span>&nbsp;<span class="builtintype" id="2512999">string</span>&nbsp;<span class="op" id="2513006">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513009">return</span>&nbsp;<span class="ident" id="2513016">t</span><span class="op" id="2513017">.</span><span class="ident" id="2513018">uncommonType</span><span class="op" id="2513030">.</span><span class="ident" id="2513031">PkgPath</span><span class="op" id="2513038">(</span><span class="op" id="2513039">)</span><br>
<span class="lineno"></span><span class="op" id="2513041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2513044">func</span>&nbsp;<span class="op" id="2513049">(</span><span class="ident" id="2513050">t</span>&nbsp;<span class="op" id="2513052">*</span><span class="ident" id="2513053">rtype</span><span class="op" id="2513058">)</span>&nbsp;<span class="ident" id="2513060">Name</span><span class="op" id="2513064">(</span><span class="op" id="2513065">)</span>&nbsp;<span class="builtintype" id="2513067">string</span>&nbsp;<span class="op" id="2513074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513077">return</span>&nbsp;<span class="ident" id="2513084">t</span><span class="op" id="2513085">.</span><span class="ident" id="2513086">uncommonType</span><span class="op" id="2513098">.</span><span class="ident" id="2513099">Name</span><span class="op" id="2513103">(</span><span class="op" id="2513104">)</span><br>
<span class="lineno">560</span><span class="op" id="2513106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2513109">func</span>&nbsp;<span class="op" id="2513114">(</span><span class="ident" id="2513115">t</span>&nbsp;<span class="op" id="2513117">*</span><span class="ident" id="2513118">rtype</span><span class="op" id="2513123">)</span>&nbsp;<span class="ident" id="2513125">ChanDir</span><span class="op" id="2513132">(</span><span class="op" id="2513133">)</span>&nbsp;<span class="ident" id="2513135">ChanDir</span>&nbsp;<span class="op" id="2513143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513146">if</span>&nbsp;<span class="ident" id="2513149">t</span><span class="op" id="2513150">.</span><span class="ident" id="2513151">Kind</span><span class="op" id="2513155">(</span><span class="op" id="2513156">)</span>&nbsp;<span class="op" id="2513158">!=</span>&nbsp;<span class="ident" id="2513161">Chan</span>&nbsp;<span class="op" id="2513166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2513170">panic</span><span class="op" id="2513175">(</span><span class="string" id="2513176">&#34;reflect:&nbsp;ChanDir&nbsp;of&nbsp;non-chan&nbsp;type&#34;</span><span class="op" id="2513211">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2513214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513217">tt</span>&nbsp;<span class="op" id="2513220">:=</span>&nbsp;<span class="op" id="2513223">(</span><span class="op" id="2513224">*</span><span class="ident" id="2513225">chanType</span><span class="op" id="2513233">)</span><span class="op" id="2513234">(</span><span class="ident" id="2513235">unsafe</span><span class="op" id="2513241">.</span><span class="ident" id="2513242">Pointer</span><span class="op" id="2513249">(</span><span class="ident" id="2513250">t</span><span class="op" id="2513251">)</span><span class="op" id="2513252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513255">return</span>&nbsp;<span class="ident" id="2513262">ChanDir</span><span class="op" id="2513269">(</span><span class="ident" id="2513270">tt</span><span class="op" id="2513272">.</span><span class="ident" id="2513273">dir</span><span class="op" id="2513276">)</span><br>
<span class="lineno"></span><span class="op" id="2513278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="keyword" id="2513281">func</span>&nbsp;<span class="op" id="2513286">(</span><span class="ident" id="2513287">t</span>&nbsp;<span class="op" id="2513289">*</span><span class="ident" id="2513290">rtype</span><span class="op" id="2513295">)</span>&nbsp;<span class="ident" id="2513297">IsVariadic</span><span class="op" id="2513307">(</span><span class="op" id="2513308">)</span>&nbsp;<span class="builtintype" id="2513310">bool</span>&nbsp;<span class="op" id="2513315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513318">if</span>&nbsp;<span class="ident" id="2513321">t</span><span class="op" id="2513322">.</span><span class="ident" id="2513323">Kind</span><span class="op" id="2513327">(</span><span class="op" id="2513328">)</span>&nbsp;<span class="op" id="2513330">!=</span>&nbsp;<span class="ident" id="2513333">Func</span>&nbsp;<span class="op" id="2513338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2513342">panic</span><span class="op" id="2513347">(</span><span class="string" id="2513348">&#34;reflect:&nbsp;IsVariadic&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2513386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2513389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513392">tt</span>&nbsp;<span class="op" id="2513395">:=</span>&nbsp;<span class="op" id="2513398">(</span><span class="op" id="2513399">*</span><span class="ident" id="2513400">funcType</span><span class="op" id="2513408">)</span><span class="op" id="2513409">(</span><span class="ident" id="2513410">unsafe</span><span class="op" id="2513416">.</span><span class="ident" id="2513417">Pointer</span><span class="op" id="2513424">(</span><span class="ident" id="2513425">t</span><span class="op" id="2513426">)</span><span class="op" id="2513427">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513430">return</span>&nbsp;<span class="ident" id="2513437">tt</span><span class="op" id="2513439">.</span><span class="ident" id="2513440">dotdotdot</span><br>
<span class="lineno"></span><span class="op" id="2513450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2513453">func</span>&nbsp;<span class="op" id="2513458">(</span><span class="ident" id="2513459">t</span>&nbsp;<span class="op" id="2513461">*</span><span class="ident" id="2513462">rtype</span><span class="op" id="2513467">)</span>&nbsp;<span class="ident" id="2513469">Elem</span><span class="op" id="2513473">(</span><span class="op" id="2513474">)</span>&nbsp;<span class="ident" id="2513476">Type</span>&nbsp;<span class="op" id="2513481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513484">switch</span>&nbsp;<span class="ident" id="2513491">t</span><span class="op" id="2513492">.</span><span class="ident" id="2513493">Kind</span><span class="op" id="2513497">(</span><span class="op" id="2513498">)</span>&nbsp;<span class="op" id="2513500">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513503">case</span>&nbsp;<span class="ident" id="2513508">Array</span><span class="op" id="2513513">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513517">tt</span>&nbsp;<span class="op" id="2513520">:=</span>&nbsp;<span class="op" id="2513523">(</span><span class="op" id="2513524">*</span><span class="ident" id="2513525">arrayType</span><span class="op" id="2513534">)</span><span class="op" id="2513535">(</span><span class="ident" id="2513536">unsafe</span><span class="op" id="2513542">.</span><span class="ident" id="2513543">Pointer</span><span class="op" id="2513550">(</span><span class="ident" id="2513551">t</span><span class="op" id="2513552">)</span><span class="op" id="2513553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513557">return</span>&nbsp;<span class="ident" id="2513564">toType</span><span class="op" id="2513570">(</span><span class="ident" id="2513571">tt</span><span class="op" id="2513573">.</span><span class="ident" id="2513574">elem</span><span class="op" id="2513578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513581">case</span>&nbsp;<span class="ident" id="2513586">Chan</span><span class="op" id="2513590">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513594">tt</span>&nbsp;<span class="op" id="2513597">:=</span>&nbsp;<span class="op" id="2513600">(</span><span class="op" id="2513601">*</span><span class="ident" id="2513602">chanType</span><span class="op" id="2513610">)</span><span class="op" id="2513611">(</span><span class="ident" id="2513612">unsafe</span><span class="op" id="2513618">.</span><span class="ident" id="2513619">Pointer</span><span class="op" id="2513626">(</span><span class="ident" id="2513627">t</span><span class="op" id="2513628">)</span><span class="op" id="2513629">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513633">return</span>&nbsp;<span class="ident" id="2513640">toType</span><span class="op" id="2513646">(</span><span class="ident" id="2513647">tt</span><span class="op" id="2513649">.</span><span class="ident" id="2513650">elem</span><span class="op" id="2513654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513657">case</span>&nbsp;<span class="ident" id="2513662">Map</span><span class="op" id="2513665">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513669">tt</span>&nbsp;<span class="op" id="2513672">:=</span>&nbsp;<span class="op" id="2513675">(</span><span class="op" id="2513676">*</span><span class="ident" id="2513677">mapType</span><span class="op" id="2513684">)</span><span class="op" id="2513685">(</span><span class="ident" id="2513686">unsafe</span><span class="op" id="2513692">.</span><span class="ident" id="2513693">Pointer</span><span class="op" id="2513700">(</span><span class="ident" id="2513701">t</span><span class="op" id="2513702">)</span><span class="op" id="2513703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513707">return</span>&nbsp;<span class="ident" id="2513714">toType</span><span class="op" id="2513720">(</span><span class="ident" id="2513721">tt</span><span class="op" id="2513723">.</span><span class="ident" id="2513724">elem</span><span class="op" id="2513728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513731">case</span>&nbsp;<span class="ident" id="2513736">Ptr</span><span class="op" id="2513739">:</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513743">tt</span>&nbsp;<span class="op" id="2513746">:=</span>&nbsp;<span class="op" id="2513749">(</span><span class="op" id="2513750">*</span><span class="ident" id="2513751">ptrType</span><span class="op" id="2513758">)</span><span class="op" id="2513759">(</span><span class="ident" id="2513760">unsafe</span><span class="op" id="2513766">.</span><span class="ident" id="2513767">Pointer</span><span class="op" id="2513774">(</span><span class="ident" id="2513775">t</span><span class="op" id="2513776">)</span><span class="op" id="2513777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513781">return</span>&nbsp;<span class="ident" id="2513788">toType</span><span class="op" id="2513794">(</span><span class="ident" id="2513795">tt</span><span class="op" id="2513797">.</span><span class="ident" id="2513798">elem</span><span class="op" id="2513802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513805">case</span>&nbsp;<span class="ident" id="2513810">Slice</span><span class="op" id="2513815">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2513819">tt</span>&nbsp;<span class="op" id="2513822">:=</span>&nbsp;<span class="op" id="2513825">(</span><span class="op" id="2513826">*</span><span class="ident" id="2513827">sliceType</span><span class="op" id="2513836">)</span><span class="op" id="2513837">(</span><span class="ident" id="2513838">unsafe</span><span class="op" id="2513844">.</span><span class="ident" id="2513845">Pointer</span><span class="op" id="2513852">(</span><span class="ident" id="2513853">t</span><span class="op" id="2513854">)</span><span class="op" id="2513855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513859">return</span>&nbsp;<span class="ident" id="2513866">toType</span><span class="op" id="2513872">(</span><span class="ident" id="2513873">tt</span><span class="op" id="2513875">.</span><span class="ident" id="2513876">elem</span><span class="op" id="2513880">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2513883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2513886">panic</span><span class="op" id="2513891">(</span><span class="string" id="2513892">&#34;reflect:&nbsp;Elem&nbsp;of&nbsp;invalid&nbsp;type&#34;</span><span class="op" id="2513923">)</span><br>
<span class="lineno"></span><span class="op" id="2513925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2513928">func</span>&nbsp;<span class="op" id="2513933">(</span><span class="ident" id="2513934">t</span>&nbsp;<span class="op" id="2513936">*</span><span class="ident" id="2513937">rtype</span><span class="op" id="2513942">)</span>&nbsp;<span class="ident" id="2513944">Field</span><span class="op" id="2513949">(</span><span class="ident" id="2513950">i</span>&nbsp;<span class="builtintype" id="2513952">int</span><span class="op" id="2513955">)</span>&nbsp;<span class="ident" id="2513957">StructField</span>&nbsp;<span class="op" id="2513969">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2513972">if</span>&nbsp;<span class="ident" id="2513975">t</span><span class="op" id="2513976">.</span><span class="ident" id="2513977">Kind</span><span class="op" id="2513981">(</span><span class="op" id="2513982">)</span>&nbsp;<span class="op" id="2513984">!=</span>&nbsp;<span class="ident" id="2513987">Struct</span>&nbsp;<span class="op" id="2513994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2513998">panic</span><span class="op" id="2514003">(</span><span class="string" id="2514004">&#34;reflect:&nbsp;Field&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2514039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514045">tt</span>&nbsp;<span class="op" id="2514048">:=</span>&nbsp;<span class="op" id="2514051">(</span><span class="op" id="2514052">*</span><span class="ident" id="2514053">structType</span><span class="op" id="2514063">)</span><span class="op" id="2514064">(</span><span class="ident" id="2514065">unsafe</span><span class="op" id="2514071">.</span><span class="ident" id="2514072">Pointer</span><span class="op" id="2514079">(</span><span class="ident" id="2514080">t</span><span class="op" id="2514081">)</span><span class="op" id="2514082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514085">return</span>&nbsp;<span class="ident" id="2514092">tt</span><span class="op" id="2514094">.</span><span class="ident" id="2514095">Field</span><span class="op" id="2514100">(</span><span class="ident" id="2514101">i</span><span class="op" id="2514102">)</span><br>
<span class="lineno">605</span><span class="op" id="2514104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2514107">func</span>&nbsp;<span class="op" id="2514112">(</span><span class="ident" id="2514113">t</span>&nbsp;<span class="op" id="2514115">*</span><span class="ident" id="2514116">rtype</span><span class="op" id="2514121">)</span>&nbsp;<span class="ident" id="2514123">FieldByIndex</span><span class="op" id="2514135">(</span><span class="ident" id="2514136">index</span>&nbsp;<span class="op" id="2514142">[</span><span class="op" id="2514143">]</span><span class="builtintype" id="2514144">int</span><span class="op" id="2514147">)</span>&nbsp;<span class="ident" id="2514149">StructField</span>&nbsp;<span class="op" id="2514161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514164">if</span>&nbsp;<span class="ident" id="2514167">t</span><span class="op" id="2514168">.</span><span class="ident" id="2514169">Kind</span><span class="op" id="2514173">(</span><span class="op" id="2514174">)</span>&nbsp;<span class="op" id="2514176">!=</span>&nbsp;<span class="ident" id="2514179">Struct</span>&nbsp;<span class="op" id="2514186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2514190">panic</span><span class="op" id="2514195">(</span><span class="string" id="2514196">&#34;reflect:&nbsp;FieldByIndex&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2514238">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514244">tt</span>&nbsp;<span class="op" id="2514247">:=</span>&nbsp;<span class="op" id="2514250">(</span><span class="op" id="2514251">*</span><span class="ident" id="2514252">structType</span><span class="op" id="2514262">)</span><span class="op" id="2514263">(</span><span class="ident" id="2514264">unsafe</span><span class="op" id="2514270">.</span><span class="ident" id="2514271">Pointer</span><span class="op" id="2514278">(</span><span class="ident" id="2514279">t</span><span class="op" id="2514280">)</span><span class="op" id="2514281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514284">return</span>&nbsp;<span class="ident" id="2514291">tt</span><span class="op" id="2514293">.</span><span class="ident" id="2514294">FieldByIndex</span><span class="op" id="2514306">(</span><span class="ident" id="2514307">index</span><span class="op" id="2514312">)</span><br>
<span class="lineno"></span><span class="op" id="2514314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="2514317">func</span>&nbsp;<span class="op" id="2514322">(</span><span class="ident" id="2514323">t</span>&nbsp;<span class="op" id="2514325">*</span><span class="ident" id="2514326">rtype</span><span class="op" id="2514331">)</span>&nbsp;<span class="ident" id="2514333">FieldByName</span><span class="op" id="2514344">(</span><span class="ident" id="2514345">name</span>&nbsp;<span class="builtintype" id="2514350">string</span><span class="op" id="2514356">)</span>&nbsp;<span class="op" id="2514358">(</span><span class="ident" id="2514359">StructField</span><span class="op" id="2514370">,</span>&nbsp;<span class="builtintype" id="2514372">bool</span><span class="op" id="2514376">)</span>&nbsp;<span class="op" id="2514378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514381">if</span>&nbsp;<span class="ident" id="2514384">t</span><span class="op" id="2514385">.</span><span class="ident" id="2514386">Kind</span><span class="op" id="2514390">(</span><span class="op" id="2514391">)</span>&nbsp;<span class="op" id="2514393">!=</span>&nbsp;<span class="ident" id="2514396">Struct</span>&nbsp;<span class="op" id="2514403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2514407">panic</span><span class="op" id="2514412">(</span><span class="string" id="2514413">&#34;reflect:&nbsp;FieldByName&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2514454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514460">tt</span>&nbsp;<span class="op" id="2514463">:=</span>&nbsp;<span class="op" id="2514466">(</span><span class="op" id="2514467">*</span><span class="ident" id="2514468">structType</span><span class="op" id="2514478">)</span><span class="op" id="2514479">(</span><span class="ident" id="2514480">unsafe</span><span class="op" id="2514486">.</span><span class="ident" id="2514487">Pointer</span><span class="op" id="2514494">(</span><span class="ident" id="2514495">t</span><span class="op" id="2514496">)</span><span class="op" id="2514497">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514500">return</span>&nbsp;<span class="ident" id="2514507">tt</span><span class="op" id="2514509">.</span><span class="ident" id="2514510">FieldByName</span><span class="op" id="2514521">(</span><span class="ident" id="2514522">name</span><span class="op" id="2514526">)</span><br>
<span class="lineno"></span><span class="op" id="2514528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2514531">func</span>&nbsp;<span class="op" id="2514536">(</span><span class="ident" id="2514537">t</span>&nbsp;<span class="op" id="2514539">*</span><span class="ident" id="2514540">rtype</span><span class="op" id="2514545">)</span>&nbsp;<span class="ident" id="2514547">FieldByNameFunc</span><span class="op" id="2514562">(</span><span class="ident" id="2514563">match</span>&nbsp;<span class="keyword" id="2514569">func</span><span class="op" id="2514573">(</span><span class="builtintype" id="2514574">string</span><span class="op" id="2514580">)</span>&nbsp;<span class="builtintype" id="2514582">bool</span><span class="op" id="2514586">)</span>&nbsp;<span class="op" id="2514588">(</span><span class="ident" id="2514589">StructField</span><span class="op" id="2514600">,</span>&nbsp;<span class="builtintype" id="2514602">bool</span><span class="op" id="2514606">)</span>&nbsp;<span class="op" id="2514608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514611">if</span>&nbsp;<span class="ident" id="2514614">t</span><span class="op" id="2514615">.</span><span class="ident" id="2514616">Kind</span><span class="op" id="2514620">(</span><span class="op" id="2514621">)</span>&nbsp;<span class="op" id="2514623">!=</span>&nbsp;<span class="ident" id="2514626">Struct</span>&nbsp;<span class="op" id="2514633">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2514637">panic</span><span class="op" id="2514642">(</span><span class="string" id="2514643">&#34;reflect:&nbsp;FieldByNameFunc&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2514688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514694">tt</span>&nbsp;<span class="op" id="2514697">:=</span>&nbsp;<span class="op" id="2514700">(</span><span class="op" id="2514701">*</span><span class="ident" id="2514702">structType</span><span class="op" id="2514712">)</span><span class="op" id="2514713">(</span><span class="ident" id="2514714">unsafe</span><span class="op" id="2514720">.</span><span class="ident" id="2514721">Pointer</span><span class="op" id="2514728">(</span><span class="ident" id="2514729">t</span><span class="op" id="2514730">)</span><span class="op" id="2514731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514734">return</span>&nbsp;<span class="ident" id="2514741">tt</span><span class="op" id="2514743">.</span><span class="ident" id="2514744">FieldByNameFunc</span><span class="op" id="2514759">(</span><span class="ident" id="2514760">match</span><span class="op" id="2514765">)</span><br>
<span class="lineno"></span><span class="op" id="2514767">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="2514770">func</span>&nbsp;<span class="op" id="2514775">(</span><span class="ident" id="2514776">t</span>&nbsp;<span class="op" id="2514778">*</span><span class="ident" id="2514779">rtype</span><span class="op" id="2514784">)</span>&nbsp;<span class="ident" id="2514786">In</span><span class="op" id="2514788">(</span><span class="ident" id="2514789">i</span>&nbsp;<span class="builtintype" id="2514791">int</span><span class="op" id="2514794">)</span>&nbsp;<span class="ident" id="2514796">Type</span>&nbsp;<span class="op" id="2514801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514804">if</span>&nbsp;<span class="ident" id="2514807">t</span><span class="op" id="2514808">.</span><span class="ident" id="2514809">Kind</span><span class="op" id="2514813">(</span><span class="op" id="2514814">)</span>&nbsp;<span class="op" id="2514816">!=</span>&nbsp;<span class="ident" id="2514819">Func</span>&nbsp;<span class="op" id="2514824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2514828">panic</span><span class="op" id="2514833">(</span><span class="string" id="2514834">&#34;reflect:&nbsp;In&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2514864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2514867">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2514870">tt</span>&nbsp;<span class="op" id="2514873">:=</span>&nbsp;<span class="op" id="2514876">(</span><span class="op" id="2514877">*</span><span class="ident" id="2514878">funcType</span><span class="op" id="2514886">)</span><span class="op" id="2514887">(</span><span class="ident" id="2514888">unsafe</span><span class="op" id="2514894">.</span><span class="ident" id="2514895">Pointer</span><span class="op" id="2514902">(</span><span class="ident" id="2514903">t</span><span class="op" id="2514904">)</span><span class="op" id="2514905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514908">return</span>&nbsp;<span class="ident" id="2514915">toType</span><span class="op" id="2514921">(</span><span class="ident" id="2514922">tt</span><span class="op" id="2514924">.</span><span class="ident" id="2514925">in</span><span class="op" id="2514927">[</span><span class="ident" id="2514928">i</span><span class="op" id="2514929">]</span><span class="op" id="2514930">)</span><br>
<span class="lineno"></span><span class="op" id="2514932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2514935">func</span>&nbsp;<span class="op" id="2514940">(</span><span class="ident" id="2514941">t</span>&nbsp;<span class="op" id="2514943">*</span><span class="ident" id="2514944">rtype</span><span class="op" id="2514949">)</span>&nbsp;<span class="ident" id="2514951">Key</span><span class="op" id="2514954">(</span><span class="op" id="2514955">)</span>&nbsp;<span class="ident" id="2514957">Type</span>&nbsp;<span class="op" id="2514962">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2514965">if</span>&nbsp;<span class="ident" id="2514968">t</span><span class="op" id="2514969">.</span><span class="ident" id="2514970">Kind</span><span class="op" id="2514974">(</span><span class="op" id="2514975">)</span>&nbsp;<span class="op" id="2514977">!=</span>&nbsp;<span class="ident" id="2514980">Map</span>&nbsp;<span class="op" id="2514984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2514988">panic</span><span class="op" id="2514993">(</span><span class="string" id="2514994">&#34;reflect:&nbsp;Key&nbsp;of&nbsp;non-map&nbsp;type&#34;</span><span class="op" id="2515024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2515027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515030">tt</span>&nbsp;<span class="op" id="2515033">:=</span>&nbsp;<span class="op" id="2515036">(</span><span class="op" id="2515037">*</span><span class="ident" id="2515038">mapType</span><span class="op" id="2515045">)</span><span class="op" id="2515046">(</span><span class="ident" id="2515047">unsafe</span><span class="op" id="2515053">.</span><span class="ident" id="2515054">Pointer</span><span class="op" id="2515061">(</span><span class="ident" id="2515062">t</span><span class="op" id="2515063">)</span><span class="op" id="2515064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515067">return</span>&nbsp;<span class="ident" id="2515074">toType</span><span class="op" id="2515080">(</span><span class="ident" id="2515081">tt</span><span class="op" id="2515083">.</span><span class="ident" id="2515084">key</span><span class="op" id="2515087">)</span><br>
<span class="lineno">645</span><span class="op" id="2515089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2515092">func</span>&nbsp;<span class="op" id="2515097">(</span><span class="ident" id="2515098">t</span>&nbsp;<span class="op" id="2515100">*</span><span class="ident" id="2515101">rtype</span><span class="op" id="2515106">)</span>&nbsp;<span class="ident" id="2515108">Len</span><span class="op" id="2515111">(</span><span class="op" id="2515112">)</span>&nbsp;<span class="builtintype" id="2515114">int</span>&nbsp;<span class="op" id="2515118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515121">if</span>&nbsp;<span class="ident" id="2515124">t</span><span class="op" id="2515125">.</span><span class="ident" id="2515126">Kind</span><span class="op" id="2515130">(</span><span class="op" id="2515131">)</span>&nbsp;<span class="op" id="2515133">!=</span>&nbsp;<span class="ident" id="2515136">Array</span>&nbsp;<span class="op" id="2515142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2515146">panic</span><span class="op" id="2515151">(</span><span class="string" id="2515152">&#34;reflect:&nbsp;Len&nbsp;of&nbsp;non-array&nbsp;type&#34;</span><span class="op" id="2515184">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2515187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515190">tt</span>&nbsp;<span class="op" id="2515193">:=</span>&nbsp;<span class="op" id="2515196">(</span><span class="op" id="2515197">*</span><span class="ident" id="2515198">arrayType</span><span class="op" id="2515207">)</span><span class="op" id="2515208">(</span><span class="ident" id="2515209">unsafe</span><span class="op" id="2515215">.</span><span class="ident" id="2515216">Pointer</span><span class="op" id="2515223">(</span><span class="ident" id="2515224">t</span><span class="op" id="2515225">)</span><span class="op" id="2515226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515229">return</span>&nbsp;<span class="builtintype" id="2515236">int</span><span class="op" id="2515239">(</span><span class="ident" id="2515240">tt</span><span class="op" id="2515242">.</span><span class="builtinfunc" id="2515243">len</span><span class="op" id="2515246">)</span><br>
<span class="lineno"></span><span class="op" id="2515248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="2515251">func</span>&nbsp;<span class="op" id="2515256">(</span><span class="ident" id="2515257">t</span>&nbsp;<span class="op" id="2515259">*</span><span class="ident" id="2515260">rtype</span><span class="op" id="2515265">)</span>&nbsp;<span class="ident" id="2515267">NumField</span><span class="op" id="2515275">(</span><span class="op" id="2515276">)</span>&nbsp;<span class="builtintype" id="2515278">int</span>&nbsp;<span class="op" id="2515282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515285">if</span>&nbsp;<span class="ident" id="2515288">t</span><span class="op" id="2515289">.</span><span class="ident" id="2515290">Kind</span><span class="op" id="2515294">(</span><span class="op" id="2515295">)</span>&nbsp;<span class="op" id="2515297">!=</span>&nbsp;<span class="ident" id="2515300">Struct</span>&nbsp;<span class="op" id="2515307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2515311">panic</span><span class="op" id="2515316">(</span><span class="string" id="2515317">&#34;reflect:&nbsp;NumField&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2515355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2515358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515361">tt</span>&nbsp;<span class="op" id="2515364">:=</span>&nbsp;<span class="op" id="2515367">(</span><span class="op" id="2515368">*</span><span class="ident" id="2515369">structType</span><span class="op" id="2515379">)</span><span class="op" id="2515380">(</span><span class="ident" id="2515381">unsafe</span><span class="op" id="2515387">.</span><span class="ident" id="2515388">Pointer</span><span class="op" id="2515395">(</span><span class="ident" id="2515396">t</span><span class="op" id="2515397">)</span><span class="op" id="2515398">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515401">return</span>&nbsp;<span class="builtinfunc" id="2515408">len</span><span class="op" id="2515411">(</span><span class="ident" id="2515412">tt</span><span class="op" id="2515414">.</span><span class="ident" id="2515415">fields</span><span class="op" id="2515421">)</span><br>
<span class="lineno"></span><span class="op" id="2515423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2515426">func</span>&nbsp;<span class="op" id="2515431">(</span><span class="ident" id="2515432">t</span>&nbsp;<span class="op" id="2515434">*</span><span class="ident" id="2515435">rtype</span><span class="op" id="2515440">)</span>&nbsp;<span class="ident" id="2515442">NumIn</span><span class="op" id="2515447">(</span><span class="op" id="2515448">)</span>&nbsp;<span class="builtintype" id="2515450">int</span>&nbsp;<span class="op" id="2515454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515457">if</span>&nbsp;<span class="ident" id="2515460">t</span><span class="op" id="2515461">.</span><span class="ident" id="2515462">Kind</span><span class="op" id="2515466">(</span><span class="op" id="2515467">)</span>&nbsp;<span class="op" id="2515469">!=</span>&nbsp;<span class="ident" id="2515472">Func</span>&nbsp;<span class="op" id="2515477">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2515481">panic</span><span class="op" id="2515486">(</span><span class="string" id="2515487">&#34;reflect:&nbsp;NumIn&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2515520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2515523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515526">tt</span>&nbsp;<span class="op" id="2515529">:=</span>&nbsp;<span class="op" id="2515532">(</span><span class="op" id="2515533">*</span><span class="ident" id="2515534">funcType</span><span class="op" id="2515542">)</span><span class="op" id="2515543">(</span><span class="ident" id="2515544">unsafe</span><span class="op" id="2515550">.</span><span class="ident" id="2515551">Pointer</span><span class="op" id="2515558">(</span><span class="ident" id="2515559">t</span><span class="op" id="2515560">)</span><span class="op" id="2515561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515564">return</span>&nbsp;<span class="builtinfunc" id="2515571">len</span><span class="op" id="2515574">(</span><span class="ident" id="2515575">tt</span><span class="op" id="2515577">.</span><span class="ident" id="2515578">in</span><span class="op" id="2515580">)</span><br>
<span class="lineno"></span><span class="op" id="2515582">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="2515585">func</span>&nbsp;<span class="op" id="2515590">(</span><span class="ident" id="2515591">t</span>&nbsp;<span class="op" id="2515593">*</span><span class="ident" id="2515594">rtype</span><span class="op" id="2515599">)</span>&nbsp;<span class="ident" id="2515601">NumOut</span><span class="op" id="2515607">(</span><span class="op" id="2515608">)</span>&nbsp;<span class="builtintype" id="2515610">int</span>&nbsp;<span class="op" id="2515614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515617">if</span>&nbsp;<span class="ident" id="2515620">t</span><span class="op" id="2515621">.</span><span class="ident" id="2515622">Kind</span><span class="op" id="2515626">(</span><span class="op" id="2515627">)</span>&nbsp;<span class="op" id="2515629">!=</span>&nbsp;<span class="ident" id="2515632">Func</span>&nbsp;<span class="op" id="2515637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2515641">panic</span><span class="op" id="2515646">(</span><span class="string" id="2515647">&#34;reflect:&nbsp;NumOut&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2515681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2515684">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515687">tt</span>&nbsp;<span class="op" id="2515690">:=</span>&nbsp;<span class="op" id="2515693">(</span><span class="op" id="2515694">*</span><span class="ident" id="2515695">funcType</span><span class="op" id="2515703">)</span><span class="op" id="2515704">(</span><span class="ident" id="2515705">unsafe</span><span class="op" id="2515711">.</span><span class="ident" id="2515712">Pointer</span><span class="op" id="2515719">(</span><span class="ident" id="2515720">t</span><span class="op" id="2515721">)</span><span class="op" id="2515722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515725">return</span>&nbsp;<span class="builtinfunc" id="2515732">len</span><span class="op" id="2515735">(</span><span class="ident" id="2515736">tt</span><span class="op" id="2515738">.</span><span class="ident" id="2515739">out</span><span class="op" id="2515742">)</span><br>
<span class="lineno"></span><span class="op" id="2515744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2515747">func</span>&nbsp;<span class="op" id="2515752">(</span><span class="ident" id="2515753">t</span>&nbsp;<span class="op" id="2515755">*</span><span class="ident" id="2515756">rtype</span><span class="op" id="2515761">)</span>&nbsp;<span class="ident" id="2515763">Out</span><span class="op" id="2515766">(</span><span class="ident" id="2515767">i</span>&nbsp;<span class="builtintype" id="2515769">int</span><span class="op" id="2515772">)</span>&nbsp;<span class="ident" id="2515774">Type</span>&nbsp;<span class="op" id="2515779">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515782">if</span>&nbsp;<span class="ident" id="2515785">t</span><span class="op" id="2515786">.</span><span class="ident" id="2515787">Kind</span><span class="op" id="2515791">(</span><span class="op" id="2515792">)</span>&nbsp;<span class="op" id="2515794">!=</span>&nbsp;<span class="ident" id="2515797">Func</span>&nbsp;<span class="op" id="2515802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2515806">panic</span><span class="op" id="2515811">(</span><span class="string" id="2515812">&#34;reflect:&nbsp;Out&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2515843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2515846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2515849">tt</span>&nbsp;<span class="op" id="2515852">:=</span>&nbsp;<span class="op" id="2515855">(</span><span class="op" id="2515856">*</span><span class="ident" id="2515857">funcType</span><span class="op" id="2515865">)</span><span class="op" id="2515866">(</span><span class="ident" id="2515867">unsafe</span><span class="op" id="2515873">.</span><span class="ident" id="2515874">Pointer</span><span class="op" id="2515881">(</span><span class="ident" id="2515882">t</span><span class="op" id="2515883">)</span><span class="op" id="2515884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515887">return</span>&nbsp;<span class="ident" id="2515894">toType</span><span class="op" id="2515900">(</span><span class="ident" id="2515901">tt</span><span class="op" id="2515903">.</span><span class="ident" id="2515904">out</span><span class="op" id="2515907">[</span><span class="ident" id="2515908">i</span><span class="op" id="2515909">]</span><span class="op" id="2515910">)</span><br>
<span class="lineno">685</span><span class="op" id="2515912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2515915">func</span>&nbsp;<span class="op" id="2515920">(</span><span class="ident" id="2515921">d</span>&nbsp;<span class="ident" id="2515923">ChanDir</span><span class="op" id="2515930">)</span>&nbsp;<span class="ident" id="2515932">String</span><span class="op" id="2515938">(</span><span class="op" id="2515939">)</span>&nbsp;<span class="builtintype" id="2515941">string</span>&nbsp;<span class="op" id="2515948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515951">switch</span>&nbsp;<span class="ident" id="2515958">d</span>&nbsp;<span class="op" id="2515960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515963">case</span>&nbsp;<span class="ident" id="2515968">SendDir</span><span class="op" id="2515975">:</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515979">return</span>&nbsp;<span class="string" id="2515986">&#34;chan&lt;-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2515996">case</span>&nbsp;<span class="ident" id="2516001">RecvDir</span><span class="op" id="2516008">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516012">return</span>&nbsp;<span class="string" id="2516019">&#34;&lt;-chan&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516029">case</span>&nbsp;<span class="ident" id="2516034">BothDir</span><span class="op" id="2516041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516045">return</span>&nbsp;<span class="string" id="2516052">&#34;chan&#34;</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2516060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516063">return</span>&nbsp;<span class="string" id="2516070">&#34;ChanDir&#34;</span>&nbsp;<span class="op" id="2516080">+</span>&nbsp;<span class="ident" id="2516082">strconv</span><span class="op" id="2516089">.</span><span class="ident" id="2516090">Itoa</span><span class="op" id="2516094">(</span><span class="builtintype" id="2516095">int</span><span class="op" id="2516098">(</span><span class="ident" id="2516099">d</span><span class="op" id="2516100">)</span><span class="op" id="2516101">)</span><br>
<span class="lineno"></span><span class="op" id="2516103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2516106">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">700</span><span class="keyword" id="2516166">func</span>&nbsp;<span class="op" id="2516171">(</span><span class="ident" id="2516172">t</span>&nbsp;<span class="op" id="2516174">*</span><span class="ident" id="2516175">interfaceType</span><span class="op" id="2516188">)</span>&nbsp;<span class="ident" id="2516190">Method</span><span class="op" id="2516196">(</span><span class="ident" id="2516197">i</span>&nbsp;<span class="builtintype" id="2516199">int</span><span class="op" id="2516202">)</span>&nbsp;<span class="op" id="2516204">(</span><span class="ident" id="2516205">m</span>&nbsp;<span class="ident" id="2516207">Method</span><span class="op" id="2516213">)</span>&nbsp;<span class="op" id="2516215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516218">if</span>&nbsp;<span class="ident" id="2516221">i</span>&nbsp;<span class="op" id="2516223">&lt;</span>&nbsp;<span class="num" id="2516225">0</span>&nbsp;<span class="op" id="2516227">||</span>&nbsp;<span class="ident" id="2516230">i</span>&nbsp;<span class="op" id="2516232">&gt;=</span>&nbsp;<span class="builtinfunc" id="2516235">len</span><span class="op" id="2516238">(</span><span class="ident" id="2516239">t</span><span class="op" id="2516240">.</span><span class="ident" id="2516241">methods</span><span class="op" id="2516248">)</span>&nbsp;<span class="op" id="2516250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516254">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2516262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516265">p</span>&nbsp;<span class="op" id="2516267">:=</span>&nbsp;<span class="op" id="2516270">&amp;</span><span class="ident" id="2516271">t</span><span class="op" id="2516272">.</span><span class="ident" id="2516273">methods</span><span class="op" id="2516280">[</span><span class="ident" id="2516281">i</span><span class="op" id="2516282">]</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516285">m</span><span class="op" id="2516286">.</span><span class="ident" id="2516287">Name</span>&nbsp;<span class="op" id="2516292">=</span>&nbsp;<span class="op" id="2516294">*</span><span class="ident" id="2516295">p</span><span class="op" id="2516296">.</span><span class="ident" id="2516297">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516303">if</span>&nbsp;<span class="ident" id="2516306">p</span><span class="op" id="2516307">.</span><span class="ident" id="2516308">pkgPath</span>&nbsp;<span class="op" id="2516316">!=</span>&nbsp;<span class="ident" id="2516319">nil</span>&nbsp;<span class="op" id="2516323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516327">m</span><span class="op" id="2516328">.</span><span class="ident" id="2516329">PkgPath</span>&nbsp;<span class="op" id="2516337">=</span>&nbsp;<span class="op" id="2516339">*</span><span class="ident" id="2516340">p</span><span class="op" id="2516341">.</span><span class="ident" id="2516342">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2516351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516354">m</span><span class="op" id="2516355">.</span><span class="ident" id="2516356">Type</span>&nbsp;<span class="op" id="2516361">=</span>&nbsp;<span class="ident" id="2516363">toType</span><span class="op" id="2516369">(</span><span class="ident" id="2516370">p</span><span class="op" id="2516371">.</span><span class="ident" id="2516372">typ</span><span class="op" id="2516375">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516378">m</span><span class="op" id="2516379">.</span><span class="ident" id="2516380">Index</span>&nbsp;<span class="op" id="2516386">=</span>&nbsp;<span class="ident" id="2516388">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516391">return</span><br>
<span class="lineno"></span><span class="op" id="2516398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2516401">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;interface&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">715</span><span class="keyword" id="2516480">func</span>&nbsp;<span class="op" id="2516485">(</span><span class="ident" id="2516486">t</span>&nbsp;<span class="op" id="2516488">*</span><span class="ident" id="2516489">interfaceType</span><span class="op" id="2516502">)</span>&nbsp;<span class="ident" id="2516504">NumMethod</span><span class="op" id="2516513">(</span><span class="op" id="2516514">)</span>&nbsp;<span class="builtintype" id="2516516">int</span>&nbsp;<span class="op" id="2516520">{</span>&nbsp;<span class="keyword" id="2516522">return</span>&nbsp;<span class="builtinfunc" id="2516529">len</span><span class="op" id="2516532">(</span><span class="ident" id="2516533">t</span><span class="op" id="2516534">.</span><span class="ident" id="2516535">methods</span><span class="op" id="2516542">)</span>&nbsp;<span class="op" id="2516544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2516547">//&nbsp;MethodByName&nbsp;method&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="2516616">func</span>&nbsp;<span class="op" id="2516621">(</span><span class="ident" id="2516622">t</span>&nbsp;<span class="op" id="2516624">*</span><span class="ident" id="2516625">interfaceType</span><span class="op" id="2516638">)</span>&nbsp;<span class="ident" id="2516640">MethodByName</span><span class="op" id="2516652">(</span><span class="ident" id="2516653">name</span>&nbsp;<span class="builtintype" id="2516658">string</span><span class="op" id="2516664">)</span>&nbsp;<span class="op" id="2516666">(</span><span class="ident" id="2516667">m</span>&nbsp;<span class="ident" id="2516669">Method</span><span class="op" id="2516675">,</span>&nbsp;<span class="ident" id="2516677">ok</span>&nbsp;<span class="builtintype" id="2516680">bool</span><span class="op" id="2516684">)</span>&nbsp;<span class="op" id="2516686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516689">if</span>&nbsp;<span class="ident" id="2516692">t</span>&nbsp;<span class="op" id="2516694">==</span>&nbsp;<span class="ident" id="2516697">nil</span>&nbsp;<span class="op" id="2516701">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516705">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2516713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516716">var</span>&nbsp;<span class="ident" id="2516720">p</span>&nbsp;<span class="op" id="2516722">*</span><span class="ident" id="2516723">imethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516732">for</span>&nbsp;<span class="ident" id="2516736">i</span>&nbsp;<span class="op" id="2516738">:=</span>&nbsp;<span class="keyword" id="2516741">range</span>&nbsp;<span class="ident" id="2516747">t</span><span class="op" id="2516748">.</span><span class="ident" id="2516749">methods</span>&nbsp;<span class="op" id="2516757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2516761">p</span>&nbsp;<span class="op" id="2516763">=</span>&nbsp;<span class="op" id="2516765">&amp;</span><span class="ident" id="2516766">t</span><span class="op" id="2516767">.</span><span class="ident" id="2516768">methods</span><span class="op" id="2516775">[</span><span class="ident" id="2516776">i</span><span class="op" id="2516777">]</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516781">if</span>&nbsp;<span class="op" id="2516784">*</span><span class="ident" id="2516785">p</span><span class="op" id="2516786">.</span><span class="ident" id="2516787">name</span>&nbsp;<span class="op" id="2516792">==</span>&nbsp;<span class="ident" id="2516795">name</span>&nbsp;<span class="op" id="2516800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516805">return</span>&nbsp;<span class="ident" id="2516812">t</span><span class="op" id="2516813">.</span><span class="ident" id="2516814">Method</span><span class="op" id="2516820">(</span><span class="ident" id="2516821">i</span><span class="op" id="2516822">)</span><span class="op" id="2516823">,</span>&nbsp;<span class="builtintype" id="2516825">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2516832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2516835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2516838">return</span><br>
<span class="lineno">730</span><span class="op" id="2516845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2516848">//&nbsp;A&nbsp;StructField&nbsp;describes&nbsp;a&nbsp;single&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="2516903">type</span>&nbsp;<span class="ident" id="2516908">StructField</span>&nbsp;<span class="keyword" id="2516920">struct</span>&nbsp;<span class="op" id="2516927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2516930">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2516958">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2517031">//&nbsp;field&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2517099">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517160">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2517168">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517176">PkgPath</span>&nbsp;<span class="builtintype" id="2517184">string</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517193">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2517203">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517213">//&nbsp;field&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517228">Tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2517238">StructTag</span>&nbsp;<span class="comment" id="2517248">//&nbsp;field&nbsp;tag&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517269">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2517279">uintptr</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2517289">//&nbsp;offset&nbsp;within&nbsp;struct,&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517324">Index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2517334">[</span><span class="op" id="2517335">]</span><span class="builtintype" id="2517336">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517344">//&nbsp;index&nbsp;sequence&nbsp;for&nbsp;Type.FieldByIndex</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2517385">Anonymous</span>&nbsp;<span class="builtintype" id="2517395">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2517405">//&nbsp;is&nbsp;an&nbsp;embedded&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="2517429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2517432">//&nbsp;A&nbsp;StructTag&nbsp;is&nbsp;the&nbsp;tag&nbsp;string&nbsp;in&nbsp;a&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="2517484">//</span><br>
<span class="lineno">750</span><span class="comment" id="2517487">//&nbsp;By&nbsp;convention,&nbsp;tag&nbsp;strings&nbsp;are&nbsp;a&nbsp;concatenation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2517540">//&nbsp;optionally&nbsp;space-separated&nbsp;key:&#34;value&#34;&nbsp;pairs.</span><br>
<span class="lineno"></span><span class="comment" id="2517589">//&nbsp;Each&nbsp;key&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of&nbsp;non-control</span><br>
<span class="lineno"></span><span class="comment" id="2517649">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;space&nbsp;(U+0020&nbsp;&#39;&nbsp;&#39;),&nbsp;quote&nbsp;(U+0022&nbsp;&#39;&#34;&#39;),</span><br>
<span class="lineno"></span><span class="comment" id="2517714">//&nbsp;and&nbsp;colon&nbsp;(U+003A&nbsp;&#39;:&#39;).&nbsp;&nbsp;Each&nbsp;value&nbsp;is&nbsp;quoted&nbsp;using&nbsp;U+0022&nbsp;&#39;&#34;&#39;</span><br>
<span class="lineno">755</span><span class="comment" id="2517780">//&nbsp;characters&nbsp;and&nbsp;Go&nbsp;string&nbsp;literal&nbsp;syntax.</span><br>
<span class="lineno"></span><span class="keyword" id="2517824">type</span>&nbsp;<span class="ident" id="2517829">StructTag</span>&nbsp;<span class="builtintype" id="2517839">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2517847">//&nbsp;Get&nbsp;returns&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;key&nbsp;in&nbsp;the&nbsp;tag&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2517911">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;key&nbsp;in&nbsp;the&nbsp;tag,&nbsp;Get&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno">760</span><span class="comment" id="2517980">//&nbsp;If&nbsp;the&nbsp;tag&nbsp;does&nbsp;not&nbsp;have&nbsp;the&nbsp;conventional&nbsp;format,&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2518043">//&nbsp;returned&nbsp;by&nbsp;Get&nbsp;is&nbsp;unspecified.</span><br>
<span class="lineno"></span><span class="keyword" id="2518078">func</span>&nbsp;<span class="op" id="2518083">(</span><span class="ident" id="2518084">tag</span>&nbsp;<span class="ident" id="2518088">StructTag</span><span class="op" id="2518097">)</span>&nbsp;<span class="ident" id="2518099">Get</span><span class="op" id="2518102">(</span><span class="ident" id="2518103">key</span>&nbsp;<span class="builtintype" id="2518107">string</span><span class="op" id="2518113">)</span>&nbsp;<span class="builtintype" id="2518115">string</span>&nbsp;<span class="op" id="2518122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518125">for</span>&nbsp;<span class="ident" id="2518129">tag</span>&nbsp;<span class="op" id="2518133">!=</span>&nbsp;<span class="string" id="2518136">&#34;&#34;</span>&nbsp;<span class="op" id="2518139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2518143">//&nbsp;skip&nbsp;leading&nbsp;space</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518167">i</span>&nbsp;<span class="op" id="2518169">:=</span>&nbsp;<span class="num" id="2518172">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518176">for</span>&nbsp;<span class="ident" id="2518180">i</span>&nbsp;<span class="op" id="2518182">&lt;</span>&nbsp;<span class="builtinfunc" id="2518184">len</span><span class="op" id="2518187">(</span><span class="ident" id="2518188">tag</span><span class="op" id="2518191">)</span>&nbsp;<span class="op" id="2518193">&amp;&amp;</span>&nbsp;<span class="ident" id="2518196">tag</span><span class="op" id="2518199">[</span><span class="ident" id="2518200">i</span><span class="op" id="2518201">]</span>&nbsp;<span class="op" id="2518203">==</span>&nbsp;<span class="string" id="2518206">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2518210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518215">i</span><span class="op" id="2518216">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518225">tag</span>&nbsp;<span class="op" id="2518229">=</span>&nbsp;<span class="ident" id="2518231">tag</span><span class="op" id="2518234">[</span><span class="ident" id="2518235">i</span><span class="op" id="2518236">:</span><span class="op" id="2518237">]</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518241">if</span>&nbsp;<span class="ident" id="2518244">tag</span>&nbsp;<span class="op" id="2518248">==</span>&nbsp;<span class="string" id="2518251">&#34;&#34;</span>&nbsp;<span class="op" id="2518254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518259">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2518272">//&nbsp;scan&nbsp;to&nbsp;colon.</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2518292">//&nbsp;a&nbsp;space&nbsp;or&nbsp;a&nbsp;quote&nbsp;is&nbsp;a&nbsp;syntax&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518334">i</span>&nbsp;<span class="op" id="2518336">=</span>&nbsp;<span class="num" id="2518338">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518342">for</span>&nbsp;<span class="ident" id="2518346">i</span>&nbsp;<span class="op" id="2518348">&lt;</span>&nbsp;<span class="builtinfunc" id="2518350">len</span><span class="op" id="2518353">(</span><span class="ident" id="2518354">tag</span><span class="op" id="2518357">)</span>&nbsp;<span class="op" id="2518359">&amp;&amp;</span>&nbsp;<span class="ident" id="2518362">tag</span><span class="op" id="2518365">[</span><span class="ident" id="2518366">i</span><span class="op" id="2518367">]</span>&nbsp;<span class="op" id="2518369">!=</span>&nbsp;<span class="string" id="2518372">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2518376">&amp;&amp;</span>&nbsp;<span class="ident" id="2518379">tag</span><span class="op" id="2518382">[</span><span class="ident" id="2518383">i</span><span class="op" id="2518384">]</span>&nbsp;<span class="op" id="2518386">!=</span>&nbsp;<span class="string" id="2518389">&#39;:&#39;</span>&nbsp;<span class="op" id="2518393">&amp;&amp;</span>&nbsp;<span class="ident" id="2518396">tag</span><span class="op" id="2518399">[</span><span class="ident" id="2518400">i</span><span class="op" id="2518401">]</span>&nbsp;<span class="op" id="2518403">!=</span>&nbsp;<span class="string" id="2518406">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2518410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518415">i</span><span class="op" id="2518416">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518421">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518425">if</span>&nbsp;<span class="ident" id="2518428">i</span><span class="op" id="2518429">+</span><span class="num" id="2518430">1</span>&nbsp;<span class="op" id="2518432">&gt;=</span>&nbsp;<span class="builtinfunc" id="2518435">len</span><span class="op" id="2518438">(</span><span class="ident" id="2518439">tag</span><span class="op" id="2518442">)</span>&nbsp;<span class="op" id="2518444">||</span>&nbsp;<span class="ident" id="2518447">tag</span><span class="op" id="2518450">[</span><span class="ident" id="2518451">i</span><span class="op" id="2518452">]</span>&nbsp;<span class="op" id="2518454">!=</span>&nbsp;<span class="string" id="2518457">&#39;:&#39;</span>&nbsp;<span class="op" id="2518461">||</span>&nbsp;<span class="ident" id="2518464">tag</span><span class="op" id="2518467">[</span><span class="ident" id="2518468">i</span><span class="op" id="2518469">+</span><span class="num" id="2518470">1</span><span class="op" id="2518471">]</span>&nbsp;<span class="op" id="2518473">!=</span>&nbsp;<span class="string" id="2518476">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2518480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518485">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518497">name</span>&nbsp;<span class="op" id="2518502">:=</span>&nbsp;<span class="builtintype" id="2518505">string</span><span class="op" id="2518511">(</span><span class="ident" id="2518512">tag</span><span class="op" id="2518515">[</span><span class="op" id="2518516">:</span><span class="ident" id="2518517">i</span><span class="op" id="2518518">]</span><span class="op" id="2518519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518523">tag</span>&nbsp;<span class="op" id="2518527">=</span>&nbsp;<span class="ident" id="2518529">tag</span><span class="op" id="2518532">[</span><span class="ident" id="2518533">i</span><span class="op" id="2518534">+</span><span class="num" id="2518535">1</span><span class="op" id="2518536">:</span><span class="op" id="2518537">]</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2518542">//&nbsp;scan&nbsp;quoted&nbsp;string&nbsp;to&nbsp;find&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518580">i</span>&nbsp;<span class="op" id="2518582">=</span>&nbsp;<span class="num" id="2518584">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518588">for</span>&nbsp;<span class="ident" id="2518592">i</span>&nbsp;<span class="op" id="2518594">&lt;</span>&nbsp;<span class="builtinfunc" id="2518596">len</span><span class="op" id="2518599">(</span><span class="ident" id="2518600">tag</span><span class="op" id="2518603">)</span>&nbsp;<span class="op" id="2518605">&amp;&amp;</span>&nbsp;<span class="ident" id="2518608">tag</span><span class="op" id="2518611">[</span><span class="ident" id="2518612">i</span><span class="op" id="2518613">]</span>&nbsp;<span class="op" id="2518615">!=</span>&nbsp;<span class="string" id="2518618">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2518622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518627">if</span>&nbsp;<span class="ident" id="2518630">tag</span><span class="op" id="2518633">[</span><span class="ident" id="2518634">i</span><span class="op" id="2518635">]</span>&nbsp;<span class="op" id="2518637">==</span>&nbsp;<span class="string" id="2518640">&#39;\\&#39;</span>&nbsp;<span class="op" id="2518645">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518651">i</span><span class="op" id="2518652">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518663">i</span><span class="op" id="2518664">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518673">if</span>&nbsp;<span class="ident" id="2518676">i</span>&nbsp;<span class="op" id="2518678">&gt;=</span>&nbsp;<span class="builtinfunc" id="2518681">len</span><span class="op" id="2518684">(</span><span class="ident" id="2518685">tag</span><span class="op" id="2518688">)</span>&nbsp;<span class="op" id="2518690">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518695">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518707">qvalue</span>&nbsp;<span class="op" id="2518714">:=</span>&nbsp;<span class="builtintype" id="2518717">string</span><span class="op" id="2518723">(</span><span class="ident" id="2518724">tag</span><span class="op" id="2518727">[</span><span class="op" id="2518728">:</span><span class="ident" id="2518729">i</span><span class="op" id="2518730">+</span><span class="num" id="2518731">1</span><span class="op" id="2518732">]</span><span class="op" id="2518733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518737">tag</span>&nbsp;<span class="op" id="2518741">=</span>&nbsp;<span class="ident" id="2518743">tag</span><span class="op" id="2518746">[</span><span class="ident" id="2518747">i</span><span class="op" id="2518748">+</span><span class="num" id="2518749">1</span><span class="op" id="2518750">:</span><span class="op" id="2518751">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518756">if</span>&nbsp;<span class="ident" id="2518759">key</span>&nbsp;<span class="op" id="2518763">==</span>&nbsp;<span class="ident" id="2518766">name</span>&nbsp;<span class="op" id="2518771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518776">value</span><span class="op" id="2518781">,</span>&nbsp;<span class="ident" id="2518783">_</span>&nbsp;<span class="op" id="2518785">:=</span>&nbsp;<span class="ident" id="2518788">strconv</span><span class="op" id="2518795">.</span><span class="ident" id="2518796">Unquote</span><span class="op" id="2518803">(</span><span class="ident" id="2518804">qvalue</span><span class="op" id="2518810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518815">return</span>&nbsp;<span class="ident" id="2518822">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518833">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518836">return</span>&nbsp;<span class="string" id="2518843">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2518846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2518849">//&nbsp;Field&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="2518889">func</span>&nbsp;<span class="op" id="2518894">(</span><span class="ident" id="2518895">t</span>&nbsp;<span class="op" id="2518897">*</span><span class="ident" id="2518898">structType</span><span class="op" id="2518908">)</span>&nbsp;<span class="ident" id="2518910">Field</span><span class="op" id="2518915">(</span><span class="ident" id="2518916">i</span>&nbsp;<span class="builtintype" id="2518918">int</span><span class="op" id="2518921">)</span>&nbsp;<span class="op" id="2518923">(</span><span class="ident" id="2518924">f</span>&nbsp;<span class="ident" id="2518926">StructField</span><span class="op" id="2518937">)</span>&nbsp;<span class="op" id="2518939">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518942">if</span>&nbsp;<span class="ident" id="2518945">i</span>&nbsp;<span class="op" id="2518947">&lt;</span>&nbsp;<span class="num" id="2518949">0</span>&nbsp;<span class="op" id="2518951">||</span>&nbsp;<span class="ident" id="2518954">i</span>&nbsp;<span class="op" id="2518956">&gt;=</span>&nbsp;<span class="builtinfunc" id="2518959">len</span><span class="op" id="2518962">(</span><span class="ident" id="2518963">t</span><span class="op" id="2518964">.</span><span class="ident" id="2518965">fields</span><span class="op" id="2518971">)</span>&nbsp;<span class="op" id="2518973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2518977">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2518985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2518988">p</span>&nbsp;<span class="op" id="2518990">:=</span>&nbsp;<span class="op" id="2518993">&amp;</span><span class="ident" id="2518994">t</span><span class="op" id="2518995">.</span><span class="ident" id="2518996">fields</span><span class="op" id="2519002">[</span><span class="ident" id="2519003">i</span><span class="op" id="2519004">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519007">f</span><span class="op" id="2519008">.</span><span class="ident" id="2519009">Type</span>&nbsp;<span class="op" id="2519014">=</span>&nbsp;<span class="ident" id="2519016">toType</span><span class="op" id="2519022">(</span><span class="ident" id="2519023">p</span><span class="op" id="2519024">.</span><span class="ident" id="2519025">typ</span><span class="op" id="2519028">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519031">if</span>&nbsp;<span class="ident" id="2519034">p</span><span class="op" id="2519035">.</span><span class="ident" id="2519036">name</span>&nbsp;<span class="op" id="2519041">!=</span>&nbsp;<span class="ident" id="2519044">nil</span>&nbsp;<span class="op" id="2519048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519052">f</span><span class="op" id="2519053">.</span><span class="ident" id="2519054">Name</span>&nbsp;<span class="op" id="2519059">=</span>&nbsp;<span class="op" id="2519061">*</span><span class="ident" id="2519062">p</span><span class="op" id="2519063">.</span><span class="ident" id="2519064">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519070">}</span>&nbsp;<span class="keyword" id="2519072">else</span>&nbsp;<span class="op" id="2519077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519081">t</span>&nbsp;<span class="op" id="2519083">:=</span>&nbsp;<span class="ident" id="2519086">f</span><span class="op" id="2519087">.</span><span class="ident" id="2519088">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519095">if</span>&nbsp;<span class="ident" id="2519098">t</span><span class="op" id="2519099">.</span><span class="ident" id="2519100">Kind</span><span class="op" id="2519104">(</span><span class="op" id="2519105">)</span>&nbsp;<span class="op" id="2519107">==</span>&nbsp;<span class="ident" id="2519110">Ptr</span>&nbsp;<span class="op" id="2519114">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519119">t</span>&nbsp;<span class="op" id="2519121">=</span>&nbsp;<span class="ident" id="2519123">t</span><span class="op" id="2519124">.</span><span class="ident" id="2519125">Elem</span><span class="op" id="2519129">(</span><span class="op" id="2519130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519138">f</span><span class="op" id="2519139">.</span><span class="ident" id="2519140">Name</span>&nbsp;<span class="op" id="2519145">=</span>&nbsp;<span class="ident" id="2519147">t</span><span class="op" id="2519148">.</span><span class="ident" id="2519149">Name</span><span class="op" id="2519153">(</span><span class="op" id="2519154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519158">f</span><span class="op" id="2519159">.</span><span class="ident" id="2519160">Anonymous</span>&nbsp;<span class="op" id="2519170">=</span>&nbsp;<span class="builtintype" id="2519172">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519178">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519181">if</span>&nbsp;<span class="ident" id="2519184">p</span><span class="op" id="2519185">.</span><span class="ident" id="2519186">pkgPath</span>&nbsp;<span class="op" id="2519194">!=</span>&nbsp;<span class="ident" id="2519197">nil</span>&nbsp;<span class="op" id="2519201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519205">f</span><span class="op" id="2519206">.</span><span class="ident" id="2519207">PkgPath</span>&nbsp;<span class="op" id="2519215">=</span>&nbsp;<span class="op" id="2519217">*</span><span class="ident" id="2519218">p</span><span class="op" id="2519219">.</span><span class="ident" id="2519220">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519232">if</span>&nbsp;<span class="ident" id="2519235">p</span><span class="op" id="2519236">.</span><span class="ident" id="2519237">tag</span>&nbsp;<span class="op" id="2519241">!=</span>&nbsp;<span class="ident" id="2519244">nil</span>&nbsp;<span class="op" id="2519248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519252">f</span><span class="op" id="2519253">.</span><span class="ident" id="2519254">Tag</span>&nbsp;<span class="op" id="2519258">=</span>&nbsp;<span class="ident" id="2519260">StructTag</span><span class="op" id="2519269">(</span><span class="op" id="2519270">*</span><span class="ident" id="2519271">p</span><span class="op" id="2519272">.</span><span class="ident" id="2519273">tag</span><span class="op" id="2519276">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2519279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519282">f</span><span class="op" id="2519283">.</span><span class="ident" id="2519284">Offset</span>&nbsp;<span class="op" id="2519291">=</span>&nbsp;<span class="ident" id="2519293">p</span><span class="op" id="2519294">.</span><span class="ident" id="2519295">offset</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2519304">//&nbsp;NOTE(rsc):&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;allocation&nbsp;in&nbsp;the&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2519364">//&nbsp;presented&nbsp;by&nbsp;a&nbsp;reflect.Type.&nbsp;&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;avoid,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2519425">//&nbsp;at&nbsp;least&nbsp;in&nbsp;the&nbsp;common&nbsp;cases,&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2519484">//&nbsp;that&nbsp;misbehaving&nbsp;clients&nbsp;of&nbsp;reflect&nbsp;cannot&nbsp;affect&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2519544">//&nbsp;uses&nbsp;of&nbsp;reflect.&nbsp;&nbsp;One&nbsp;possibility&nbsp;is&nbsp;CL&nbsp;5371098,&nbsp;but&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2519604">//&nbsp;postponed&nbsp;that&nbsp;ugliness&nbsp;until&nbsp;there&nbsp;is&nbsp;a&nbsp;demonstrated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2519662">//&nbsp;need&nbsp;for&nbsp;the&nbsp;performance.&nbsp;&nbsp;This&nbsp;is&nbsp;issue&nbsp;2320.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519713">f</span><span class="op" id="2519714">.</span><span class="ident" id="2519715">Index</span>&nbsp;<span class="op" id="2519721">=</span>&nbsp;<span class="op" id="2519723">[</span><span class="op" id="2519724">]</span><span class="builtintype" id="2519725">int</span><span class="op" id="2519728">{</span><span class="ident" id="2519729">i</span><span class="op" id="2519730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2519733">return</span><br>
<span class="lineno"></span><span class="op" id="2519740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2519743">//&nbsp;TODO(gri):&nbsp;Should&nbsp;there&nbsp;be&nbsp;an&nbsp;error/bool&nbsp;indicator&nbsp;if&nbsp;the&nbsp;index</span><br>
<span class="lineno">845</span><span class="comment" id="2519810">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;wrong&nbsp;for&nbsp;FieldByIndex?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2519852">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="2519917">func</span>&nbsp;<span class="op" id="2519922">(</span><span class="ident" id="2519923">t</span>&nbsp;<span class="op" id="2519925">*</span><span class="ident" id="2519926">structType</span><span class="op" id="2519936">)</span>&nbsp;<span class="ident" id="2519938">FieldByIndex</span><span class="op" id="2519950">(</span><span class="ident" id="2519951">index</span>&nbsp;<span class="op" id="2519957">[</span><span class="op" id="2519958">]</span><span class="builtintype" id="2519959">int</span><span class="op" id="2519962">)</span>&nbsp;<span class="op" id="2519964">(</span><span class="ident" id="2519965">f</span>&nbsp;<span class="ident" id="2519967">StructField</span><span class="op" id="2519978">)</span>&nbsp;<span class="op" id="2519980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2519983">f</span><span class="op" id="2519984">.</span><span class="ident" id="2519985">Type</span>&nbsp;<span class="op" id="2519990">=</span>&nbsp;<span class="ident" id="2519992">toType</span><span class="op" id="2519998">(</span><span class="op" id="2519999">&amp;</span><span class="ident" id="2520000">t</span><span class="op" id="2520001">.</span><span class="ident" id="2520002">rtype</span><span class="op" id="2520007">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520010">for</span>&nbsp;<span class="ident" id="2520014">i</span><span class="op" id="2520015">,</span>&nbsp;<span class="ident" id="2520017">x</span>&nbsp;<span class="op" id="2520019">:=</span>&nbsp;<span class="keyword" id="2520022">range</span>&nbsp;<span class="ident" id="2520028">index</span>&nbsp;<span class="op" id="2520034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520038">if</span>&nbsp;<span class="ident" id="2520041">i</span>&nbsp;<span class="op" id="2520043">&gt;</span>&nbsp;<span class="num" id="2520045">0</span>&nbsp;<span class="op" id="2520047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520052">ft</span>&nbsp;<span class="op" id="2520055">:=</span>&nbsp;<span class="ident" id="2520058">f</span><span class="op" id="2520059">.</span><span class="ident" id="2520060">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520068">if</span>&nbsp;<span class="ident" id="2520071">ft</span><span class="op" id="2520073">.</span><span class="ident" id="2520074">Kind</span><span class="op" id="2520078">(</span><span class="op" id="2520079">)</span>&nbsp;<span class="op" id="2520081">==</span>&nbsp;<span class="ident" id="2520084">Ptr</span>&nbsp;<span class="op" id="2520088">&amp;&amp;</span>&nbsp;<span class="ident" id="2520091">ft</span><span class="op" id="2520093">.</span><span class="ident" id="2520094">Elem</span><span class="op" id="2520098">(</span><span class="op" id="2520099">)</span><span class="op" id="2520100">.</span><span class="ident" id="2520101">Kind</span><span class="op" id="2520105">(</span><span class="op" id="2520106">)</span>&nbsp;<span class="op" id="2520108">==</span>&nbsp;<span class="ident" id="2520111">Struct</span>&nbsp;<span class="op" id="2520118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520124">ft</span>&nbsp;<span class="op" id="2520127">=</span>&nbsp;<span class="ident" id="2520129">ft</span><span class="op" id="2520131">.</span><span class="ident" id="2520132">Elem</span><span class="op" id="2520136">(</span><span class="op" id="2520137">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2520142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520147">f</span><span class="op" id="2520148">.</span><span class="ident" id="2520149">Type</span>&nbsp;<span class="op" id="2520154">=</span>&nbsp;<span class="ident" id="2520156">ft</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2520161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520165">f</span>&nbsp;<span class="op" id="2520167">=</span>&nbsp;<span class="ident" id="2520169">f</span><span class="op" id="2520170">.</span><span class="ident" id="2520171">Type</span><span class="op" id="2520175">.</span><span class="ident" id="2520176">Field</span><span class="op" id="2520181">(</span><span class="ident" id="2520182">x</span><span class="op" id="2520183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2520186">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2520189">return</span><br>
<span class="lineno"></span><span class="op" id="2520196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2520199">//&nbsp;A&nbsp;fieldScan&nbsp;represents&nbsp;an&nbsp;item&nbsp;on&nbsp;the&nbsp;fieldByNameFunc&nbsp;scan&nbsp;work&nbsp;list.</span><br>
<span class="lineno"></span><span class="keyword" id="2520272">type</span>&nbsp;<span class="ident" id="2520277">fieldScan</span>&nbsp;<span class="keyword" id="2520287">struct</span>&nbsp;<span class="op" id="2520294">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520297">typ</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2520303">*</span><span class="ident" id="2520304">structType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2520316">index</span>&nbsp;<span class="op" id="2520322">[</span><span class="op" id="2520323">]</span><span class="builtintype" id="2520324">int</span><br>
<span class="lineno"></span><span class="op" id="2520328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2520331">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;that&nbsp;satisfies&nbsp;the</span><br>
<span class="lineno">870</span><span class="comment" id="2520406">//&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2520474">func</span>&nbsp;<span class="op" id="2520479">(</span><span class="ident" id="2520480">t</span>&nbsp;<span class="op" id="2520482">*</span><span class="ident" id="2520483">structType</span><span class="op" id="2520493">)</span>&nbsp;<span class="ident" id="2520495">FieldByNameFunc</span><span class="op" id="2520510">(</span><span class="ident" id="2520511">match</span>&nbsp;<span class="keyword" id="2520517">func</span><span class="op" id="2520521">(</span><span class="builtintype" id="2520522">string</span><span class="op" id="2520528">)</span>&nbsp;<span class="builtintype" id="2520530">bool</span><span class="op" id="2520534">)</span>&nbsp;<span class="op" id="2520536">(</span><span class="ident" id="2520537">result</span>&nbsp;<span class="ident" id="2520544">StructField</span><span class="op" id="2520555">,</span>&nbsp;<span class="ident" id="2520557">ok</span>&nbsp;<span class="builtintype" id="2520560">bool</span><span class="op" id="2520564">)</span>&nbsp;<span class="op" id="2520566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2520569">//&nbsp;This&nbsp;uses&nbsp;the&nbsp;same&nbsp;condition&nbsp;that&nbsp;the&nbsp;Go&nbsp;language&nbsp;does:&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;unique&nbsp;instance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2520661">//&nbsp;of&nbsp;the&nbsp;match&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;instances&nbsp;of&nbsp;a&nbsp;match&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2520752">//&nbsp;same&nbsp;depth,&nbsp;they&nbsp;annihilate&nbsp;each&nbsp;other&nbsp;and&nbsp;inhibit&nbsp;any&nbsp;possible&nbsp;match&nbsp;at&nbsp;a&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2520844">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth&nbsp;first&nbsp;search,&nbsp;one&nbsp;depth&nbsp;level&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2520915">//&nbsp;The&nbsp;current&nbsp;and&nbsp;next&nbsp;slices&nbsp;are&nbsp;work&nbsp;queues:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2520964">//&nbsp;current&nbsp;lists&nbsp;the&nbsp;fields&nbsp;to&nbsp;visit&nbsp;on&nbsp;this&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2521023">//&nbsp;and&nbsp;next&nbsp;lists&nbsp;the&nbsp;fields&nbsp;on&nbsp;the&nbsp;next&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521078">current</span>&nbsp;<span class="op" id="2521086">:=</span>&nbsp;<span class="op" id="2521089">[</span><span class="op" id="2521090">]</span><span class="ident" id="2521091">fieldScan</span><span class="op" id="2521100">{</span><span class="op" id="2521101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521104">next</span>&nbsp;<span class="op" id="2521109">:=</span>&nbsp;<span class="op" id="2521112">[</span><span class="op" id="2521113">]</span><span class="ident" id="2521114">fieldScan</span><span class="op" id="2521123">{</span><span class="op" id="2521124">{</span><span class="ident" id="2521125">typ</span><span class="op" id="2521128">:</span>&nbsp;<span class="ident" id="2521130">t</span><span class="op" id="2521131">}</span><span class="op" id="2521132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2521136">//&nbsp;nextCount&nbsp;records&nbsp;the&nbsp;number&nbsp;of&nbsp;times&nbsp;an&nbsp;embedded&nbsp;type&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2521204">//&nbsp;encountered&nbsp;and&nbsp;considered&nbsp;for&nbsp;queueing&nbsp;in&nbsp;the&nbsp;&#39;next&#39;&nbsp;slice.</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2521269">//&nbsp;We&nbsp;only&nbsp;queue&nbsp;the&nbsp;first&nbsp;one,&nbsp;but&nbsp;we&nbsp;increment&nbsp;the&nbsp;count&nbsp;on&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2521338">//&nbsp;If&nbsp;a&nbsp;struct&nbsp;type&nbsp;T&nbsp;can&nbsp;be&nbsp;reached&nbsp;more&nbsp;than&nbsp;once&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2521415">//&nbsp;then&nbsp;it&nbsp;annihilates&nbsp;itself&nbsp;and&nbsp;need&nbsp;not&nbsp;be&nbsp;considered&nbsp;at&nbsp;all&nbsp;when&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2521488">//&nbsp;process&nbsp;that&nbsp;next&nbsp;depth&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521523">var</span>&nbsp;<span class="ident" id="2521527">nextCount</span>&nbsp;<span class="keyword" id="2521537">map</span><span class="op" id="2521540">[</span><span class="op" id="2521541">*</span><span class="ident" id="2521542">structType</span><span class="op" id="2521552">]</span><span class="builtintype" id="2521553">int</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2521559">//&nbsp;visited&nbsp;records&nbsp;the&nbsp;structs&nbsp;that&nbsp;have&nbsp;been&nbsp;considered&nbsp;already.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2521626">//&nbsp;Embedded&nbsp;pointer&nbsp;fields&nbsp;can&nbsp;create&nbsp;cycles&nbsp;in&nbsp;the&nbsp;graph&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2521688">//&nbsp;reachable&nbsp;embedded&nbsp;types;&nbsp;visited&nbsp;avoids&nbsp;following&nbsp;those&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2521757">//&nbsp;It&nbsp;also&nbsp;avoids&nbsp;duplicated&nbsp;effort:&nbsp;if&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;the&nbsp;field&nbsp;in&nbsp;an</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2521829">//&nbsp;embedded&nbsp;type&nbsp;T&nbsp;at&nbsp;level&nbsp;2,&nbsp;we&nbsp;won&#39;t&nbsp;find&nbsp;it&nbsp;in&nbsp;one&nbsp;at&nbsp;level&nbsp;4&nbsp;either.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521904">visited</span>&nbsp;<span class="op" id="2521912">:=</span>&nbsp;<span class="keyword" id="2521915">map</span><span class="op" id="2521918">[</span><span class="op" id="2521919">*</span><span class="ident" id="2521920">structType</span><span class="op" id="2521930">]</span><span class="builtintype" id="2521931">bool</span><span class="op" id="2521935">{</span><span class="op" id="2521936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2521940">for</span>&nbsp;<span class="builtinfunc" id="2521944">len</span><span class="op" id="2521947">(</span><span class="ident" id="2521948">next</span><span class="op" id="2521952">)</span>&nbsp;<span class="op" id="2521954">&gt;</span>&nbsp;<span class="num" id="2521956">0</span>&nbsp;<span class="op" id="2521958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521962">current</span><span class="op" id="2521969">,</span>&nbsp;<span class="ident" id="2521971">next</span>&nbsp;<span class="op" id="2521976">=</span>&nbsp;<span class="ident" id="2521978">next</span><span class="op" id="2521982">,</span>&nbsp;<span class="ident" id="2521984">current</span><span class="op" id="2521991">[</span><span class="op" id="2521992">:</span><span class="num" id="2521993">0</span><span class="op" id="2521994">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2521998">count</span>&nbsp;<span class="op" id="2522004">:=</span>&nbsp;<span class="ident" id="2522007">nextCount</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522019">nextCount</span>&nbsp;<span class="op" id="2522029">=</span>&nbsp;<span class="ident" id="2522031">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522038">//&nbsp;Process&nbsp;all&nbsp;the&nbsp;fields&nbsp;at&nbsp;this&nbsp;depth,&nbsp;now&nbsp;listed&nbsp;in&nbsp;&#39;current&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522106">//&nbsp;The&nbsp;loop&nbsp;queues&nbsp;embedded&nbsp;fields&nbsp;found&nbsp;in&nbsp;&#39;next&#39;,&nbsp;for&nbsp;processing&nbsp;during&nbsp;the&nbsp;next</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522191">//&nbsp;iteration.&nbsp;The&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;current&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522266">//&nbsp;in&nbsp;&#39;count&#39;;&nbsp;the&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;next&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded&nbsp;in&nbsp;&#39;nextCount&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522355">for</span>&nbsp;<span class="ident" id="2522359">_</span><span class="op" id="2522360">,</span>&nbsp;<span class="ident" id="2522362">scan</span>&nbsp;<span class="op" id="2522367">:=</span>&nbsp;<span class="keyword" id="2522370">range</span>&nbsp;<span class="ident" id="2522376">current</span>&nbsp;<span class="op" id="2522384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522389">t</span>&nbsp;<span class="op" id="2522391">:=</span>&nbsp;<span class="ident" id="2522394">scan</span><span class="op" id="2522398">.</span><span class="ident" id="2522399">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522406">if</span>&nbsp;<span class="ident" id="2522409">visited</span><span class="op" id="2522416">[</span><span class="ident" id="2522417">t</span><span class="op" id="2522418">]</span>&nbsp;<span class="op" id="2522420">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522426">//&nbsp;We&#39;ve&nbsp;looked&nbsp;through&nbsp;this&nbsp;type&nbsp;before,&nbsp;at&nbsp;a&nbsp;higher&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522491">//&nbsp;That&nbsp;higher&nbsp;level&nbsp;would&nbsp;shadow&nbsp;the&nbsp;lower&nbsp;level&nbsp;we&#39;re&nbsp;now&nbsp;at,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522559">//&nbsp;so&nbsp;this&nbsp;one&nbsp;can&#39;t&nbsp;be&nbsp;useful&nbsp;to&nbsp;us.&nbsp;Ignore&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522612">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2522624">}</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522629">visited</span><span class="op" id="2522636">[</span><span class="ident" id="2522637">t</span><span class="op" id="2522638">]</span>&nbsp;<span class="op" id="2522640">=</span>&nbsp;<span class="builtintype" id="2522642">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522650">for</span>&nbsp;<span class="ident" id="2522654">i</span>&nbsp;<span class="op" id="2522656">:=</span>&nbsp;<span class="keyword" id="2522659">range</span>&nbsp;<span class="ident" id="2522665">t</span><span class="op" id="2522666">.</span><span class="ident" id="2522667">fields</span>&nbsp;<span class="op" id="2522674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522680">f</span>&nbsp;<span class="op" id="2522682">:=</span>&nbsp;<span class="op" id="2522685">&amp;</span><span class="ident" id="2522686">t</span><span class="op" id="2522687">.</span><span class="ident" id="2522688">fields</span><span class="op" id="2522694">[</span><span class="ident" id="2522695">i</span><span class="op" id="2522696">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522702">//&nbsp;Find&nbsp;name&nbsp;and&nbsp;type&nbsp;for&nbsp;field&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522741">var</span>&nbsp;<span class="ident" id="2522745">fname</span>&nbsp;<span class="builtintype" id="2522751">string</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522762">var</span>&nbsp;<span class="ident" id="2522766">ntyp</span>&nbsp;<span class="op" id="2522771">*</span><span class="ident" id="2522772">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522782">if</span>&nbsp;<span class="ident" id="2522785">f</span><span class="op" id="2522786">.</span><span class="ident" id="2522787">name</span>&nbsp;<span class="op" id="2522792">!=</span>&nbsp;<span class="ident" id="2522795">nil</span>&nbsp;<span class="op" id="2522799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522806">fname</span>&nbsp;<span class="op" id="2522812">=</span>&nbsp;<span class="op" id="2522814">*</span><span class="ident" id="2522815">f</span><span class="op" id="2522816">.</span><span class="ident" id="2522817">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2522826">}</span>&nbsp;<span class="keyword" id="2522828">else</span>&nbsp;<span class="op" id="2522833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522840">//&nbsp;Anonymous&nbsp;field&nbsp;of&nbsp;type&nbsp;T&nbsp;or&nbsp;*T.</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2522881">//&nbsp;Name&nbsp;taken&nbsp;from&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522911">ntyp</span>&nbsp;<span class="op" id="2522916">=</span>&nbsp;<span class="ident" id="2522918">f</span><span class="op" id="2522919">.</span><span class="ident" id="2522920">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2522929">if</span>&nbsp;<span class="ident" id="2522932">ntyp</span><span class="op" id="2522936">.</span><span class="ident" id="2522937">Kind</span><span class="op" id="2522941">(</span><span class="op" id="2522942">)</span>&nbsp;<span class="op" id="2522944">==</span>&nbsp;<span class="ident" id="2522947">Ptr</span>&nbsp;<span class="op" id="2522951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522959">ntyp</span>&nbsp;<span class="op" id="2522964">=</span>&nbsp;<span class="ident" id="2522966">ntyp</span><span class="op" id="2522970">.</span><span class="ident" id="2522971">Elem</span><span class="op" id="2522975">(</span><span class="op" id="2522976">)</span><span class="op" id="2522977">.</span><span class="ident" id="2522978">common</span><span class="op" id="2522984">(</span><span class="op" id="2522985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2522992">}</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2522999">fname</span>&nbsp;<span class="op" id="2523005">=</span>&nbsp;<span class="ident" id="2523007">ntyp</span><span class="op" id="2523011">.</span><span class="ident" id="2523012">Name</span><span class="op" id="2523016">(</span><span class="op" id="2523017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523030">//&nbsp;Does&nbsp;it&nbsp;match?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523052">if</span>&nbsp;<span class="ident" id="2523055">match</span><span class="op" id="2523060">(</span><span class="ident" id="2523061">fname</span><span class="op" id="2523066">)</span>&nbsp;<span class="op" id="2523068">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523075">//&nbsp;Potential&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523099">if</span>&nbsp;<span class="ident" id="2523102">count</span><span class="op" id="2523107">[</span><span class="ident" id="2523108">t</span><span class="op" id="2523109">]</span>&nbsp;<span class="op" id="2523111">&gt;</span>&nbsp;<span class="num" id="2523113">1</span>&nbsp;<span class="op" id="2523115">||</span>&nbsp;<span class="ident" id="2523118">ok</span>&nbsp;<span class="op" id="2523121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523129">//&nbsp;Name&nbsp;appeared&nbsp;multiple&nbsp;times&nbsp;at&nbsp;this&nbsp;level:&nbsp;annihilate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523194">return</span>&nbsp;<span class="ident" id="2523201">StructField</span><span class="op" id="2523212">{</span><span class="op" id="2523213">}</span><span class="op" id="2523214">,</span>&nbsp;<span class="builtintype" id="2523216">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523227">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523234">result</span>&nbsp;<span class="op" id="2523241">=</span>&nbsp;<span class="ident" id="2523243">t</span><span class="op" id="2523244">.</span><span class="ident" id="2523245">Field</span><span class="op" id="2523250">(</span><span class="ident" id="2523251">i</span><span class="op" id="2523252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523259">result</span><span class="op" id="2523265">.</span><span class="ident" id="2523266">Index</span>&nbsp;<span class="op" id="2523272">=</span>&nbsp;<span class="ident" id="2523274">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523283">result</span><span class="op" id="2523289">.</span><span class="ident" id="2523290">Index</span>&nbsp;<span class="op" id="2523296">=</span>&nbsp;<span class="builtinfunc" id="2523298">append</span><span class="op" id="2523304">(</span><span class="ident" id="2523305">result</span><span class="op" id="2523311">.</span><span class="ident" id="2523312">Index</span><span class="op" id="2523317">,</span>&nbsp;<span class="ident" id="2523319">scan</span><span class="op" id="2523323">.</span><span class="ident" id="2523324">index</span><span class="op" id="2523329">...</span><span class="op" id="2523332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523339">result</span><span class="op" id="2523345">.</span><span class="ident" id="2523346">Index</span>&nbsp;<span class="op" id="2523352">=</span>&nbsp;<span class="builtinfunc" id="2523354">append</span><span class="op" id="2523360">(</span><span class="ident" id="2523361">result</span><span class="op" id="2523367">.</span><span class="ident" id="2523368">Index</span><span class="op" id="2523373">,</span>&nbsp;<span class="ident" id="2523375">i</span><span class="op" id="2523376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523383">ok</span>&nbsp;<span class="op" id="2523386">=</span>&nbsp;<span class="builtintype" id="2523388">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523398">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523418">//&nbsp;Queue&nbsp;embedded&nbsp;struct&nbsp;fields&nbsp;for&nbsp;processing&nbsp;with&nbsp;next&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523486">//&nbsp;but&nbsp;only&nbsp;if&nbsp;we&nbsp;haven&#39;t&nbsp;seen&nbsp;a&nbsp;match&nbsp;yet&nbsp;at&nbsp;this&nbsp;level&nbsp;and&nbsp;only</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2523556">//&nbsp;if&nbsp;the&nbsp;embedded&nbsp;types&nbsp;haven&#39;t&nbsp;already&nbsp;been&nbsp;queued.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523614">if</span>&nbsp;<span class="ident" id="2523617">ok</span>&nbsp;<span class="op" id="2523620">||</span>&nbsp;<span class="ident" id="2523623">ntyp</span>&nbsp;<span class="op" id="2523628">==</span>&nbsp;<span class="ident" id="2523631">nil</span>&nbsp;<span class="op" id="2523635">||</span>&nbsp;<span class="ident" id="2523638">ntyp</span><span class="op" id="2523642">.</span><span class="ident" id="2523643">Kind</span><span class="op" id="2523647">(</span><span class="op" id="2523648">)</span>&nbsp;<span class="op" id="2523650">!=</span>&nbsp;<span class="ident" id="2523653">Struct</span>&nbsp;<span class="op" id="2523660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523667">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523686">styp</span>&nbsp;<span class="op" id="2523691">:=</span>&nbsp;<span class="op" id="2523694">(</span><span class="op" id="2523695">*</span><span class="ident" id="2523696">structType</span><span class="op" id="2523706">)</span><span class="op" id="2523707">(</span><span class="ident" id="2523708">unsafe</span><span class="op" id="2523714">.</span><span class="ident" id="2523715">Pointer</span><span class="op" id="2523722">(</span><span class="ident" id="2523723">ntyp</span><span class="op" id="2523727">)</span><span class="op" id="2523728">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523734">if</span>&nbsp;<span class="ident" id="2523737">nextCount</span><span class="op" id="2523746">[</span><span class="ident" id="2523747">styp</span><span class="op" id="2523751">]</span>&nbsp;<span class="op" id="2523753">&gt;</span>&nbsp;<span class="num" id="2523755">0</span>&nbsp;<span class="op" id="2523757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523764">nextCount</span><span class="op" id="2523773">[</span><span class="ident" id="2523774">styp</span><span class="op" id="2523778">]</span>&nbsp;<span class="op" id="2523780">=</span>&nbsp;<span class="num" id="2523782">2</span>&nbsp;<span class="comment" id="2523784">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523822">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523841">if</span>&nbsp;<span class="ident" id="2523844">nextCount</span>&nbsp;<span class="op" id="2523854">==</span>&nbsp;<span class="ident" id="2523857">nil</span>&nbsp;<span class="op" id="2523861">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523868">nextCount</span>&nbsp;<span class="op" id="2523878">=</span>&nbsp;<span class="keyword" id="2523880">map</span><span class="op" id="2523883">[</span><span class="op" id="2523884">*</span><span class="ident" id="2523885">structType</span><span class="op" id="2523895">]</span><span class="builtintype" id="2523896">int</span><span class="op" id="2523899">{</span><span class="op" id="2523900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2523906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523912">nextCount</span><span class="op" id="2523921">[</span><span class="ident" id="2523922">styp</span><span class="op" id="2523926">]</span>&nbsp;<span class="op" id="2523928">=</span>&nbsp;<span class="num" id="2523930">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2523936">if</span>&nbsp;<span class="ident" id="2523939">count</span><span class="op" id="2523944">[</span><span class="ident" id="2523945">t</span><span class="op" id="2523946">]</span>&nbsp;<span class="op" id="2523948">&gt;</span>&nbsp;<span class="num" id="2523950">1</span>&nbsp;<span class="op" id="2523952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2523959">nextCount</span><span class="op" id="2523968">[</span><span class="ident" id="2523969">styp</span><span class="op" id="2523973">]</span>&nbsp;<span class="op" id="2523975">=</span>&nbsp;<span class="num" id="2523977">2</span>&nbsp;<span class="comment" id="2523979">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524022">var</span>&nbsp;<span class="ident" id="2524026">index</span>&nbsp;<span class="op" id="2524032">[</span><span class="op" id="2524033">]</span><span class="builtintype" id="2524034">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524042">index</span>&nbsp;<span class="op" id="2524048">=</span>&nbsp;<span class="builtinfunc" id="2524050">append</span><span class="op" id="2524056">(</span><span class="ident" id="2524057">index</span><span class="op" id="2524062">,</span>&nbsp;<span class="ident" id="2524064">scan</span><span class="op" id="2524068">.</span><span class="ident" id="2524069">index</span><span class="op" id="2524074">...</span><span class="op" id="2524077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524083">index</span>&nbsp;<span class="op" id="2524089">=</span>&nbsp;<span class="builtinfunc" id="2524091">append</span><span class="op" id="2524097">(</span><span class="ident" id="2524098">index</span><span class="op" id="2524103">,</span>&nbsp;<span class="ident" id="2524105">i</span><span class="op" id="2524106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524112">next</span>&nbsp;<span class="op" id="2524117">=</span>&nbsp;<span class="builtinfunc" id="2524119">append</span><span class="op" id="2524125">(</span><span class="ident" id="2524126">next</span><span class="op" id="2524130">,</span>&nbsp;<span class="ident" id="2524132">fieldScan</span><span class="op" id="2524141">{</span><span class="ident" id="2524142">styp</span><span class="op" id="2524146">,</span>&nbsp;<span class="ident" id="2524148">index</span><span class="op" id="2524153">}</span><span class="op" id="2524154">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524167">if</span>&nbsp;<span class="ident" id="2524170">ok</span>&nbsp;<span class="op" id="2524173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524178">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524186">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524192">return</span><br>
<span class="lineno"></span><span class="op" id="2524199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2524202">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">980</span><span class="comment" id="2524262">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2524315">func</span>&nbsp;<span class="op" id="2524320">(</span><span class="ident" id="2524321">t</span>&nbsp;<span class="op" id="2524323">*</span><span class="ident" id="2524324">structType</span><span class="op" id="2524334">)</span>&nbsp;<span class="ident" id="2524336">FieldByName</span><span class="op" id="2524347">(</span><span class="ident" id="2524348">name</span>&nbsp;<span class="builtintype" id="2524353">string</span><span class="op" id="2524359">)</span>&nbsp;<span class="op" id="2524361">(</span><span class="ident" id="2524362">f</span>&nbsp;<span class="ident" id="2524364">StructField</span><span class="op" id="2524375">,</span>&nbsp;<span class="ident" id="2524377">present</span>&nbsp;<span class="builtintype" id="2524385">bool</span><span class="op" id="2524389">)</span>&nbsp;<span class="op" id="2524391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2524394">//&nbsp;Quick&nbsp;check&nbsp;for&nbsp;top-level&nbsp;name,&nbsp;or&nbsp;struct&nbsp;without&nbsp;anonymous&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524466">hasAnon</span>&nbsp;<span class="op" id="2524474">:=</span>&nbsp;<span class="builtintype" id="2524477">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524484">if</span>&nbsp;<span class="ident" id="2524487">name</span>&nbsp;<span class="op" id="2524492">!=</span>&nbsp;<span class="string" id="2524495">&#34;&#34;</span>&nbsp;<span class="op" id="2524498">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524502">for</span>&nbsp;<span class="ident" id="2524506">i</span>&nbsp;<span class="op" id="2524508">:=</span>&nbsp;<span class="keyword" id="2524511">range</span>&nbsp;<span class="ident" id="2524517">t</span><span class="op" id="2524518">.</span><span class="ident" id="2524519">fields</span>&nbsp;<span class="op" id="2524526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524531">tf</span>&nbsp;<span class="op" id="2524534">:=</span>&nbsp;<span class="op" id="2524537">&amp;</span><span class="ident" id="2524538">t</span><span class="op" id="2524539">.</span><span class="ident" id="2524540">fields</span><span class="op" id="2524546">[</span><span class="ident" id="2524547">i</span><span class="op" id="2524548">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524553">if</span>&nbsp;<span class="ident" id="2524556">tf</span><span class="op" id="2524558">.</span><span class="ident" id="2524559">name</span>&nbsp;<span class="op" id="2524564">==</span>&nbsp;<span class="ident" id="2524567">nil</span>&nbsp;<span class="op" id="2524571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524577">hasAnon</span>&nbsp;<span class="op" id="2524585">=</span>&nbsp;<span class="builtintype" id="2524587">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524596">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524613">if</span>&nbsp;<span class="op" id="2524616">*</span><span class="ident" id="2524617">tf</span><span class="op" id="2524619">.</span><span class="ident" id="2524620">name</span>&nbsp;<span class="op" id="2524625">==</span>&nbsp;<span class="ident" id="2524628">name</span>&nbsp;<span class="op" id="2524633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524639">return</span>&nbsp;<span class="ident" id="2524646">t</span><span class="op" id="2524647">.</span><span class="ident" id="2524648">Field</span><span class="op" id="2524653">(</span><span class="ident" id="2524654">i</span><span class="op" id="2524655">)</span><span class="op" id="2524656">,</span>&nbsp;<span class="builtintype" id="2524658">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524670">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524676">if</span>&nbsp;<span class="op" id="2524679">!</span><span class="ident" id="2524680">hasAnon</span>&nbsp;<span class="op" id="2524688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524692">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2524700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524703">return</span>&nbsp;<span class="ident" id="2524710">t</span><span class="op" id="2524711">.</span><span class="ident" id="2524712">FieldByNameFunc</span><span class="op" id="2524727">(</span><span class="keyword" id="2524728">func</span><span class="op" id="2524732">(</span><span class="ident" id="2524733">s</span>&nbsp;<span class="builtintype" id="2524735">string</span><span class="op" id="2524741">)</span>&nbsp;<span class="builtintype" id="2524743">bool</span>&nbsp;<span class="op" id="2524748">{</span>&nbsp;<span class="keyword" id="2524750">return</span>&nbsp;<span class="ident" id="2524757">s</span>&nbsp;<span class="op" id="2524759">==</span>&nbsp;<span class="ident" id="2524762">name</span>&nbsp;<span class="op" id="2524767">}</span><span class="op" id="2524768">)</span><br>
<span class="lineno">1000</span><span class="op" id="2524770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2524773">//&nbsp;TypeOf&nbsp;returns&nbsp;the&nbsp;reflection&nbsp;Type&nbsp;of&nbsp;the&nbsp;value&nbsp;in&nbsp;the&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="2524844">//&nbsp;TypeOf(nil)&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2524872">func</span>&nbsp;<span class="ident" id="2524877">TypeOf</span><span class="op" id="2524883">(</span><span class="ident" id="2524884">i</span>&nbsp;<span class="keyword" id="2524886">interface</span><span class="op" id="2524895">{</span><span class="op" id="2524896">}</span><span class="op" id="2524897">)</span>&nbsp;<span class="ident" id="2524899">Type</span>&nbsp;<span class="op" id="2524904">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2524907">eface</span>&nbsp;<span class="op" id="2524913">:=</span>&nbsp;<span class="op" id="2524916">*</span><span class="op" id="2524917">(</span><span class="op" id="2524918">*</span><span class="ident" id="2524919">emptyInterface</span><span class="op" id="2524933">)</span><span class="op" id="2524934">(</span><span class="ident" id="2524935">unsafe</span><span class="op" id="2524941">.</span><span class="ident" id="2524942">Pointer</span><span class="op" id="2524949">(</span><span class="op" id="2524950">&amp;</span><span class="ident" id="2524951">i</span><span class="op" id="2524952">)</span><span class="op" id="2524953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2524956">return</span>&nbsp;<span class="ident" id="2524963">toType</span><span class="op" id="2524969">(</span><span class="ident" id="2524970">eface</span><span class="op" id="2524975">.</span><span class="ident" id="2524976">typ</span><span class="op" id="2524979">)</span><br>
<span class="lineno"></span><span class="op" id="2524981">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2524984">//&nbsp;ptrMap&nbsp;is&nbsp;the&nbsp;cache&nbsp;for&nbsp;PtrTo.</span><br>
<span class="lineno">1010</span><span class="keyword" id="2525018">var</span>&nbsp;<span class="ident" id="2525022">ptrMap</span>&nbsp;<span class="keyword" id="2525029">struct</span>&nbsp;<span class="op" id="2525036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525039">sync</span><span class="op" id="2525043">.</span><span class="ident" id="2525044">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525053">m</span>&nbsp;<span class="keyword" id="2525055">map</span><span class="op" id="2525058">[</span><span class="op" id="2525059">*</span><span class="ident" id="2525060">rtype</span><span class="op" id="2525065">]</span><span class="op" id="2525066">*</span><span class="ident" id="2525067">ptrType</span><br>
<span class="lineno"></span><span class="op" id="2525075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1015</span><span class="comment" id="2525078">//&nbsp;PtrTo&nbsp;returns&nbsp;the&nbsp;pointer&nbsp;type&nbsp;with&nbsp;element&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2525128">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;type&nbsp;Foo,&nbsp;PtrTo(t)&nbsp;represents&nbsp;*Foo.</span><br>
<span class="lineno"></span><span class="keyword" id="2525196">func</span>&nbsp;<span class="ident" id="2525201">PtrTo</span><span class="op" id="2525206">(</span><span class="ident" id="2525207">t</span>&nbsp;<span class="ident" id="2525209">Type</span><span class="op" id="2525213">)</span>&nbsp;<span class="ident" id="2525215">Type</span>&nbsp;<span class="op" id="2525220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525223">return</span>&nbsp;<span class="ident" id="2525230">t</span><span class="op" id="2525231">.</span><span class="op" id="2525232">(</span><span class="op" id="2525233">*</span><span class="ident" id="2525234">rtype</span><span class="op" id="2525239">)</span><span class="op" id="2525240">.</span><span class="ident" id="2525241">ptrTo</span><span class="op" id="2525246">(</span><span class="op" id="2525247">)</span><br>
<span class="lineno"></span><span class="op" id="2525249">}</span><br>
<span class="lineno">1020</span><br>
<span class="lineno"></span><span class="keyword" id="2525252">func</span>&nbsp;<span class="op" id="2525257">(</span><span class="ident" id="2525258">t</span>&nbsp;<span class="op" id="2525260">*</span><span class="ident" id="2525261">rtype</span><span class="op" id="2525266">)</span>&nbsp;<span class="ident" id="2525268">ptrTo</span><span class="op" id="2525273">(</span><span class="op" id="2525274">)</span>&nbsp;<span class="op" id="2525276">*</span><span class="ident" id="2525277">rtype</span>&nbsp;<span class="op" id="2525283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525286">if</span>&nbsp;<span class="ident" id="2525289">p</span>&nbsp;<span class="op" id="2525291">:=</span>&nbsp;<span class="ident" id="2525294">t</span><span class="op" id="2525295">.</span><span class="ident" id="2525296">ptrToThis</span><span class="op" id="2525305">;</span>&nbsp;<span class="ident" id="2525307">p</span>&nbsp;<span class="op" id="2525309">!=</span>&nbsp;<span class="ident" id="2525312">nil</span>&nbsp;<span class="op" id="2525316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525320">return</span>&nbsp;<span class="ident" id="2525327">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2525330">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525334">//&nbsp;Otherwise,&nbsp;synthesize&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525365">//&nbsp;This&nbsp;only&nbsp;happens&nbsp;for&nbsp;pointers&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525417">//&nbsp;We&nbsp;keep&nbsp;the&nbsp;mapping&nbsp;in&nbsp;a&nbsp;map&nbsp;on&nbsp;the&nbsp;side,&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525471">//&nbsp;this&nbsp;operation&nbsp;is&nbsp;rare&nbsp;and&nbsp;a&nbsp;separate&nbsp;map&nbsp;lets&nbsp;us&nbsp;keep</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525530">//&nbsp;the&nbsp;type&nbsp;structures&nbsp;in&nbsp;read-only&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525575">ptrMap</span><span class="op" id="2525581">.</span><span class="ident" id="2525582">RLock</span><span class="op" id="2525587">(</span><span class="op" id="2525588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525591">if</span>&nbsp;<span class="ident" id="2525594">m</span>&nbsp;<span class="op" id="2525596">:=</span>&nbsp;<span class="ident" id="2525599">ptrMap</span><span class="op" id="2525605">.</span><span class="ident" id="2525606">m</span><span class="op" id="2525607">;</span>&nbsp;<span class="ident" id="2525609">m</span>&nbsp;<span class="op" id="2525611">!=</span>&nbsp;<span class="ident" id="2525614">nil</span>&nbsp;<span class="op" id="2525618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525622">if</span>&nbsp;<span class="ident" id="2525625">p</span>&nbsp;<span class="op" id="2525627">:=</span>&nbsp;<span class="ident" id="2525630">m</span><span class="op" id="2525631">[</span><span class="ident" id="2525632">t</span><span class="op" id="2525633">]</span><span class="op" id="2525634">;</span>&nbsp;<span class="ident" id="2525636">p</span>&nbsp;<span class="op" id="2525638">!=</span>&nbsp;<span class="ident" id="2525641">nil</span>&nbsp;<span class="op" id="2525645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525650">ptrMap</span><span class="op" id="2525656">.</span><span class="ident" id="2525657">RUnlock</span><span class="op" id="2525664">(</span><span class="op" id="2525665">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525670">return</span>&nbsp;<span class="op" id="2525677">&amp;</span><span class="ident" id="2525678">p</span><span class="op" id="2525679">.</span><span class="ident" id="2525680">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2525688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2525691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525694">ptrMap</span><span class="op" id="2525700">.</span><span class="ident" id="2525701">RUnlock</span><span class="op" id="2525708">(</span><span class="op" id="2525709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525712">ptrMap</span><span class="op" id="2525718">.</span><span class="ident" id="2525719">Lock</span><span class="op" id="2525723">(</span><span class="op" id="2525724">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525727">if</span>&nbsp;<span class="ident" id="2525730">ptrMap</span><span class="op" id="2525736">.</span><span class="ident" id="2525737">m</span>&nbsp;<span class="op" id="2525739">==</span>&nbsp;<span class="ident" id="2525742">nil</span>&nbsp;<span class="op" id="2525746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525750">ptrMap</span><span class="op" id="2525756">.</span><span class="ident" id="2525757">m</span>&nbsp;<span class="op" id="2525759">=</span>&nbsp;<span class="builtinfunc" id="2525761">make</span><span class="op" id="2525765">(</span><span class="keyword" id="2525766">map</span><span class="op" id="2525769">[</span><span class="op" id="2525770">*</span><span class="ident" id="2525771">rtype</span><span class="op" id="2525776">]</span><span class="op" id="2525777">*</span><span class="ident" id="2525778">ptrType</span><span class="op" id="2525785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2525788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525791">p</span>&nbsp;<span class="op" id="2525793">:=</span>&nbsp;<span class="ident" id="2525796">ptrMap</span><span class="op" id="2525802">.</span><span class="ident" id="2525803">m</span><span class="op" id="2525804">[</span><span class="ident" id="2525805">t</span><span class="op" id="2525806">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525809">if</span>&nbsp;<span class="ident" id="2525812">p</span>&nbsp;<span class="op" id="2525814">!=</span>&nbsp;<span class="ident" id="2525817">nil</span>&nbsp;<span class="op" id="2525821">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525825">//&nbsp;some&nbsp;other&nbsp;goroutine&nbsp;won&nbsp;the&nbsp;race&nbsp;and&nbsp;created&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2525879">ptrMap</span><span class="op" id="2525885">.</span><span class="ident" id="2525886">Unlock</span><span class="op" id="2525892">(</span><span class="op" id="2525893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2525897">return</span>&nbsp;<span class="op" id="2525904">&amp;</span><span class="ident" id="2525905">p</span><span class="op" id="2525906">.</span><span class="ident" id="2525907">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2525914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525918">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;ptrType&nbsp;starting&nbsp;with&nbsp;the&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2525973">//&nbsp;of&nbsp;an&nbsp;*unsafe.Pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526000">p</span>&nbsp;<span class="op" id="2526002">=</span>&nbsp;<span class="builtinfunc" id="2526004">new</span><span class="op" id="2526007">(</span><span class="ident" id="2526008">ptrType</span><span class="op" id="2526015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2526018">var</span>&nbsp;<span class="ident" id="2526022">iptr</span>&nbsp;<span class="keyword" id="2526027">interface</span><span class="op" id="2526036">{</span><span class="op" id="2526037">}</span>&nbsp;<span class="op" id="2526039">=</span>&nbsp;<span class="op" id="2526041">(</span><span class="op" id="2526042">*</span><span class="ident" id="2526043">unsafe</span><span class="op" id="2526049">.</span><span class="ident" id="2526050">Pointer</span><span class="op" id="2526057">)</span><span class="op" id="2526058">(</span><span class="ident" id="2526059">nil</span><span class="op" id="2526062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526065">prototype</span>&nbsp;<span class="op" id="2526075">:=</span>&nbsp;<span class="op" id="2526078">*</span><span class="op" id="2526079">(</span><span class="op" id="2526080">*</span><span class="op" id="2526081">*</span><span class="ident" id="2526082">ptrType</span><span class="op" id="2526089">)</span><span class="op" id="2526090">(</span><span class="ident" id="2526091">unsafe</span><span class="op" id="2526097">.</span><span class="ident" id="2526098">Pointer</span><span class="op" id="2526105">(</span><span class="op" id="2526106">&amp;</span><span class="ident" id="2526107">iptr</span><span class="op" id="2526111">)</span><span class="op" id="2526112">)</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2526115">*</span><span class="ident" id="2526116">p</span>&nbsp;<span class="op" id="2526118">=</span>&nbsp;<span class="op" id="2526120">*</span><span class="ident" id="2526121">prototype</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526133">s</span>&nbsp;<span class="op" id="2526135">:=</span>&nbsp;<span class="string" id="2526138">&#34;*&#34;</span>&nbsp;<span class="op" id="2526142">+</span>&nbsp;<span class="op" id="2526144">*</span><span class="ident" id="2526145">t</span><span class="op" id="2526146">.</span><span class="builtintype" id="2526147">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526155">p</span><span class="op" id="2526156">.</span><span class="builtintype" id="2526157">string</span>&nbsp;<span class="op" id="2526164">=</span>&nbsp;<span class="op" id="2526166">&amp;</span><span class="ident" id="2526167">s</span><br>
<span class="lineno"></span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2526171">//&nbsp;For&nbsp;the&nbsp;type&nbsp;structures&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary,&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2526227">//&nbsp;compiler&nbsp;provides&nbsp;a&nbsp;good&nbsp;hash&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2526276">//&nbsp;Create&nbsp;a&nbsp;good&nbsp;hash&nbsp;for&nbsp;the&nbsp;new&nbsp;string&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2526327">//&nbsp;the&nbsp;FNV-1&nbsp;hash&#39;s&nbsp;mixing&nbsp;function&nbsp;to&nbsp;combine&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2526379">//&nbsp;old&nbsp;hash&nbsp;and&nbsp;the&nbsp;new&nbsp;&#34;*&#34;.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526409">p</span><span class="op" id="2526410">.</span><span class="ident" id="2526411">hash</span>&nbsp;<span class="op" id="2526416">=</span>&nbsp;<span class="ident" id="2526418">fnv1</span><span class="op" id="2526422">(</span><span class="ident" id="2526423">t</span><span class="op" id="2526424">.</span><span class="ident" id="2526425">hash</span><span class="op" id="2526429">,</span>&nbsp;<span class="string" id="2526431">&#39;*&#39;</span><span class="op" id="2526434">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526438">p</span><span class="op" id="2526439">.</span><span class="ident" id="2526440">uncommonType</span>&nbsp;<span class="op" id="2526453">=</span>&nbsp;<span class="ident" id="2526455">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526460">p</span><span class="op" id="2526461">.</span><span class="ident" id="2526462">ptrToThis</span>&nbsp;<span class="op" id="2526472">=</span>&nbsp;<span class="ident" id="2526474">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526479">p</span><span class="op" id="2526480">.</span><span class="ident" id="2526481">zero</span>&nbsp;<span class="op" id="2526486">=</span>&nbsp;<span class="ident" id="2526488">unsafe</span><span class="op" id="2526494">.</span><span class="ident" id="2526495">Pointer</span><span class="op" id="2526502">(</span><span class="op" id="2526503">&amp;</span><span class="builtinfunc" id="2526504">make</span><span class="op" id="2526508">(</span><span class="op" id="2526509">[</span><span class="op" id="2526510">]</span><span class="builtintype" id="2526511">byte</span><span class="op" id="2526515">,</span>&nbsp;<span class="ident" id="2526517">p</span><span class="op" id="2526518">.</span><span class="ident" id="2526519">size</span><span class="op" id="2526523">)</span><span class="op" id="2526524">[</span><span class="num" id="2526525">0</span><span class="op" id="2526526">]</span><span class="op" id="2526527">)</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526530">p</span><span class="op" id="2526531">.</span><span class="ident" id="2526532">elem</span>&nbsp;<span class="op" id="2526537">=</span>&nbsp;<span class="ident" id="2526539">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526543">ptrMap</span><span class="op" id="2526549">.</span><span class="ident" id="2526550">m</span><span class="op" id="2526551">[</span><span class="ident" id="2526552">t</span><span class="op" id="2526553">]</span>&nbsp;<span class="op" id="2526555">=</span>&nbsp;<span class="ident" id="2526557">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526560">ptrMap</span><span class="op" id="2526566">.</span><span class="ident" id="2526567">Unlock</span><span class="op" id="2526573">(</span><span class="op" id="2526574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2526577">return</span>&nbsp;<span class="op" id="2526584">&amp;</span><span class="ident" id="2526585">p</span><span class="op" id="2526586">.</span><span class="ident" id="2526587">rtype</span><br>
<span class="lineno">1075</span><span class="op" id="2526593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2526596">//&nbsp;fnv1&nbsp;incorporates&nbsp;the&nbsp;list&nbsp;of&nbsp;bytes&nbsp;into&nbsp;the&nbsp;hash&nbsp;x&nbsp;using&nbsp;the&nbsp;FNV-1&nbsp;hash&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="2526682">func</span>&nbsp;<span class="ident" id="2526687">fnv1</span><span class="op" id="2526691">(</span><span class="ident" id="2526692">x</span>&nbsp;<span class="builtintype" id="2526694">uint32</span><span class="op" id="2526700">,</span>&nbsp;<span class="ident" id="2526702">list</span>&nbsp;<span class="op" id="2526707">...</span><span class="builtintype" id="2526710">byte</span><span class="op" id="2526714">)</span>&nbsp;<span class="builtintype" id="2526716">uint32</span>&nbsp;<span class="op" id="2526723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2526726">for</span>&nbsp;<span class="ident" id="2526730">_</span><span class="op" id="2526731">,</span>&nbsp;<span class="ident" id="2526733">b</span>&nbsp;<span class="op" id="2526735">:=</span>&nbsp;<span class="keyword" id="2526738">range</span>&nbsp;<span class="ident" id="2526744">list</span>&nbsp;<span class="op" id="2526749">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2526753">x</span>&nbsp;<span class="op" id="2526755">=</span>&nbsp;<span class="ident" id="2526757">x</span><span class="op" id="2526758">*</span><span class="num" id="2526759">16777619</span>&nbsp;<span class="op" id="2526768">^</span>&nbsp;<span class="builtintype" id="2526770">uint32</span><span class="op" id="2526776">(</span><span class="ident" id="2526777">b</span><span class="op" id="2526778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2526781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2526784">return</span>&nbsp;<span class="ident" id="2526791">x</span><br>
<span class="lineno"></span><span class="op" id="2526793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1085</span><span class="keyword" id="2526796">func</span>&nbsp;<span class="op" id="2526801">(</span><span class="ident" id="2526802">t</span>&nbsp;<span class="op" id="2526804">*</span><span class="ident" id="2526805">rtype</span><span class="op" id="2526810">)</span>&nbsp;<span class="ident" id="2526812">Implements</span><span class="op" id="2526822">(</span><span class="ident" id="2526823">u</span>&nbsp;<span class="ident" id="2526825">Type</span><span class="op" id="2526829">)</span>&nbsp;<span class="builtintype" id="2526831">bool</span>&nbsp;<span class="op" id="2526836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2526839">if</span>&nbsp;<span class="ident" id="2526842">u</span>&nbsp;<span class="op" id="2526844">==</span>&nbsp;<span class="ident" id="2526847">nil</span>&nbsp;<span class="op" id="2526851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2526855">panic</span><span class="op" id="2526860">(</span><span class="string" id="2526861">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2526906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2526909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2526912">if</span>&nbsp;<span class="ident" id="2526915">u</span><span class="op" id="2526916">.</span><span class="ident" id="2526917">Kind</span><span class="op" id="2526921">(</span><span class="op" id="2526922">)</span>&nbsp;<span class="op" id="2526924">!=</span>&nbsp;<span class="ident" id="2526927">Interface</span>&nbsp;<span class="op" id="2526937">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2526941">panic</span><span class="op" id="2526946">(</span><span class="string" id="2526947">&#34;reflect:&nbsp;non-interface&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2527002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2527005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527008">return</span>&nbsp;<span class="ident" id="2527015">implements</span><span class="op" id="2527025">(</span><span class="ident" id="2527026">u</span><span class="op" id="2527027">.</span><span class="op" id="2527028">(</span><span class="op" id="2527029">*</span><span class="ident" id="2527030">rtype</span><span class="op" id="2527035">)</span><span class="op" id="2527036">,</span>&nbsp;<span class="ident" id="2527038">t</span><span class="op" id="2527039">)</span><br>
<span class="lineno"></span><span class="op" id="2527041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span><span class="keyword" id="2527044">func</span>&nbsp;<span class="op" id="2527049">(</span><span class="ident" id="2527050">t</span>&nbsp;<span class="op" id="2527052">*</span><span class="ident" id="2527053">rtype</span><span class="op" id="2527058">)</span>&nbsp;<span class="ident" id="2527060">AssignableTo</span><span class="op" id="2527072">(</span><span class="ident" id="2527073">u</span>&nbsp;<span class="ident" id="2527075">Type</span><span class="op" id="2527079">)</span>&nbsp;<span class="builtintype" id="2527081">bool</span>&nbsp;<span class="op" id="2527086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527089">if</span>&nbsp;<span class="ident" id="2527092">u</span>&nbsp;<span class="op" id="2527094">==</span>&nbsp;<span class="ident" id="2527097">nil</span>&nbsp;<span class="op" id="2527101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2527105">panic</span><span class="op" id="2527110">(</span><span class="string" id="2527111">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.AssignableTo&#34;</span><span class="op" id="2527158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2527161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527164">uu</span>&nbsp;<span class="op" id="2527167">:=</span>&nbsp;<span class="ident" id="2527170">u</span><span class="op" id="2527171">.</span><span class="op" id="2527172">(</span><span class="op" id="2527173">*</span><span class="ident" id="2527174">rtype</span><span class="op" id="2527179">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527182">return</span>&nbsp;<span class="ident" id="2527189">directlyAssignable</span><span class="op" id="2527207">(</span><span class="ident" id="2527208">uu</span><span class="op" id="2527210">,</span>&nbsp;<span class="ident" id="2527212">t</span><span class="op" id="2527213">)</span>&nbsp;<span class="op" id="2527215">||</span>&nbsp;<span class="ident" id="2527218">implements</span><span class="op" id="2527228">(</span><span class="ident" id="2527229">uu</span><span class="op" id="2527231">,</span>&nbsp;<span class="ident" id="2527233">t</span><span class="op" id="2527234">)</span><br>
<span class="lineno"></span><span class="op" id="2527236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2527239">func</span>&nbsp;<span class="op" id="2527244">(</span><span class="ident" id="2527245">t</span>&nbsp;<span class="op" id="2527247">*</span><span class="ident" id="2527248">rtype</span><span class="op" id="2527253">)</span>&nbsp;<span class="ident" id="2527255">ConvertibleTo</span><span class="op" id="2527268">(</span><span class="ident" id="2527269">u</span>&nbsp;<span class="ident" id="2527271">Type</span><span class="op" id="2527275">)</span>&nbsp;<span class="builtintype" id="2527277">bool</span>&nbsp;<span class="op" id="2527282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527285">if</span>&nbsp;<span class="ident" id="2527288">u</span>&nbsp;<span class="op" id="2527290">==</span>&nbsp;<span class="ident" id="2527293">nil</span>&nbsp;<span class="op" id="2527297">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2527301">panic</span><span class="op" id="2527306">(</span><span class="string" id="2527307">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.ConvertibleTo&#34;</span><span class="op" id="2527355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2527358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527361">uu</span>&nbsp;<span class="op" id="2527364">:=</span>&nbsp;<span class="ident" id="2527367">u</span><span class="op" id="2527368">.</span><span class="op" id="2527369">(</span><span class="op" id="2527370">*</span><span class="ident" id="2527371">rtype</span><span class="op" id="2527376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527379">return</span>&nbsp;<span class="ident" id="2527386">convertOp</span><span class="op" id="2527395">(</span><span class="ident" id="2527396">uu</span><span class="op" id="2527398">,</span>&nbsp;<span class="ident" id="2527400">t</span><span class="op" id="2527401">)</span>&nbsp;<span class="op" id="2527403">!=</span>&nbsp;<span class="ident" id="2527406">nil</span><br>
<span class="lineno"></span><span class="op" id="2527410">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span><span class="keyword" id="2527413">func</span>&nbsp;<span class="op" id="2527418">(</span><span class="ident" id="2527419">t</span>&nbsp;<span class="op" id="2527421">*</span><span class="ident" id="2527422">rtype</span><span class="op" id="2527427">)</span>&nbsp;<span class="ident" id="2527429">Comparable</span><span class="op" id="2527439">(</span><span class="op" id="2527440">)</span>&nbsp;<span class="builtintype" id="2527442">bool</span>&nbsp;<span class="op" id="2527447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527450">return</span>&nbsp;<span class="ident" id="2527457">t</span><span class="op" id="2527458">.</span><span class="ident" id="2527459">alg</span>&nbsp;<span class="op" id="2527463">!=</span>&nbsp;<span class="ident" id="2527466">nil</span>&nbsp;<span class="op" id="2527470">&amp;&amp;</span>&nbsp;<span class="ident" id="2527473">t</span><span class="op" id="2527474">.</span><span class="ident" id="2527475">alg</span><span class="op" id="2527478">.</span><span class="ident" id="2527479">equal</span>&nbsp;<span class="op" id="2527485">!=</span>&nbsp;<span class="ident" id="2527488">nil</span><br>
<span class="lineno"></span><span class="op" id="2527492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2527495">//&nbsp;implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;V&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="keyword" id="2527569">func</span>&nbsp;<span class="ident" id="2527574">implements</span><span class="op" id="2527584">(</span><span class="ident" id="2527585">T</span><span class="op" id="2527586">,</span>&nbsp;<span class="ident" id="2527588">V</span>&nbsp;<span class="op" id="2527590">*</span><span class="ident" id="2527591">rtype</span><span class="op" id="2527596">)</span>&nbsp;<span class="builtintype" id="2527598">bool</span>&nbsp;<span class="op" id="2527603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527606">if</span>&nbsp;<span class="ident" id="2527609">T</span><span class="op" id="2527610">.</span><span class="ident" id="2527611">Kind</span><span class="op" id="2527615">(</span><span class="op" id="2527616">)</span>&nbsp;<span class="op" id="2527618">!=</span>&nbsp;<span class="ident" id="2527621">Interface</span>&nbsp;<span class="op" id="2527631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527635">return</span>&nbsp;<span class="builtintype" id="2527642">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2527649">}</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2527652">t</span>&nbsp;<span class="op" id="2527654">:=</span>&nbsp;<span class="op" id="2527657">(</span><span class="op" id="2527658">*</span><span class="ident" id="2527659">interfaceType</span><span class="op" id="2527672">)</span><span class="op" id="2527673">(</span><span class="ident" id="2527674">unsafe</span><span class="op" id="2527680">.</span><span class="ident" id="2527681">Pointer</span><span class="op" id="2527688">(</span><span class="ident" id="2527689">T</span><span class="op" id="2527690">)</span><span class="op" id="2527691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527694">if</span>&nbsp;<span class="builtinfunc" id="2527697">len</span><span class="op" id="2527700">(</span><span class="ident" id="2527701">t</span><span class="op" id="2527702">.</span><span class="ident" id="2527703">methods</span><span class="op" id="2527710">)</span>&nbsp;<span class="op" id="2527712">==</span>&nbsp;<span class="num" id="2527715">0</span>&nbsp;<span class="op" id="2527717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2527721">return</span>&nbsp;<span class="builtintype" id="2527728">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2527734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527738">//&nbsp;The&nbsp;same&nbsp;algorithm&nbsp;applies&nbsp;in&nbsp;both&nbsp;cases,&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527792">//&nbsp;method&nbsp;tables&nbsp;for&nbsp;an&nbsp;interface&nbsp;type&nbsp;and&nbsp;a&nbsp;concrete&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527852">//&nbsp;are&nbsp;different,&nbsp;so&nbsp;the&nbsp;code&nbsp;is&nbsp;duplicated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527898">//&nbsp;In&nbsp;both&nbsp;cases&nbsp;the&nbsp;algorithm&nbsp;is&nbsp;a&nbsp;linear&nbsp;scan&nbsp;over&nbsp;the&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2527960">//&nbsp;lists&nbsp;-&nbsp;T&#39;s&nbsp;methods&nbsp;and&nbsp;V&#39;s&nbsp;methods&nbsp;-&nbsp;simultaneously.</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528018">//&nbsp;Since&nbsp;method&nbsp;tables&nbsp;are&nbsp;stored&nbsp;in&nbsp;a&nbsp;unique&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528078">//&nbsp;(alphabetical,&nbsp;with&nbsp;no&nbsp;duplicate&nbsp;method&nbsp;names),&nbsp;the&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528139">//&nbsp;through&nbsp;V&#39;s&nbsp;methods&nbsp;must&nbsp;hit&nbsp;a&nbsp;match&nbsp;for&nbsp;each&nbsp;of&nbsp;T&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528196">//&nbsp;methods&nbsp;along&nbsp;the&nbsp;way,&nbsp;or&nbsp;else&nbsp;V&nbsp;does&nbsp;not&nbsp;implement&nbsp;T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528255">//&nbsp;This&nbsp;lets&nbsp;us&nbsp;run&nbsp;the&nbsp;scan&nbsp;in&nbsp;overall&nbsp;linear&nbsp;time&nbsp;instead&nbsp;of</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528319">//&nbsp;the&nbsp;quadratic&nbsp;time&nbsp;&nbsp;a&nbsp;naive&nbsp;search&nbsp;would&nbsp;require.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2528373">//&nbsp;See&nbsp;also&nbsp;../runtime/iface.c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528406">if</span>&nbsp;<span class="ident" id="2528409">V</span><span class="op" id="2528410">.</span><span class="ident" id="2528411">Kind</span><span class="op" id="2528415">(</span><span class="op" id="2528416">)</span>&nbsp;<span class="op" id="2528418">==</span>&nbsp;<span class="ident" id="2528421">Interface</span>&nbsp;<span class="op" id="2528431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528435">v</span>&nbsp;<span class="op" id="2528437">:=</span>&nbsp;<span class="op" id="2528440">(</span><span class="op" id="2528441">*</span><span class="ident" id="2528442">interfaceType</span><span class="op" id="2528455">)</span><span class="op" id="2528456">(</span><span class="ident" id="2528457">unsafe</span><span class="op" id="2528463">.</span><span class="ident" id="2528464">Pointer</span><span class="op" id="2528471">(</span><span class="ident" id="2528472">V</span><span class="op" id="2528473">)</span><span class="op" id="2528474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528478">i</span>&nbsp;<span class="op" id="2528480">:=</span>&nbsp;<span class="num" id="2528483">0</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528487">for</span>&nbsp;<span class="ident" id="2528491">j</span>&nbsp;<span class="op" id="2528493">:=</span>&nbsp;<span class="num" id="2528496">0</span><span class="op" id="2528497">;</span>&nbsp;<span class="ident" id="2528499">j</span>&nbsp;<span class="op" id="2528501">&lt;</span>&nbsp;<span class="builtinfunc" id="2528503">len</span><span class="op" id="2528506">(</span><span class="ident" id="2528507">v</span><span class="op" id="2528508">.</span><span class="ident" id="2528509">methods</span><span class="op" id="2528516">)</span><span class="op" id="2528517">;</span>&nbsp;<span class="ident" id="2528519">j</span><span class="op" id="2528520">++</span>&nbsp;<span class="op" id="2528523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528528">tm</span>&nbsp;<span class="op" id="2528531">:=</span>&nbsp;<span class="op" id="2528534">&amp;</span><span class="ident" id="2528535">t</span><span class="op" id="2528536">.</span><span class="ident" id="2528537">methods</span><span class="op" id="2528544">[</span><span class="ident" id="2528545">i</span><span class="op" id="2528546">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528551">vm</span>&nbsp;<span class="op" id="2528554">:=</span>&nbsp;<span class="op" id="2528557">&amp;</span><span class="ident" id="2528558">v</span><span class="op" id="2528559">.</span><span class="ident" id="2528560">methods</span><span class="op" id="2528567">[</span><span class="ident" id="2528568">j</span><span class="op" id="2528569">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528574">if</span>&nbsp;<span class="ident" id="2528577">vm</span><span class="op" id="2528579">.</span><span class="ident" id="2528580">name</span>&nbsp;<span class="op" id="2528585">==</span>&nbsp;<span class="ident" id="2528588">tm</span><span class="op" id="2528590">.</span><span class="ident" id="2528591">name</span>&nbsp;<span class="op" id="2528596">&amp;&amp;</span>&nbsp;<span class="ident" id="2528599">vm</span><span class="op" id="2528601">.</span><span class="ident" id="2528602">pkgPath</span>&nbsp;<span class="op" id="2528610">==</span>&nbsp;<span class="ident" id="2528613">tm</span><span class="op" id="2528615">.</span><span class="ident" id="2528616">pkgPath</span>&nbsp;<span class="op" id="2528624">&amp;&amp;</span>&nbsp;<span class="ident" id="2528627">vm</span><span class="op" id="2528629">.</span><span class="ident" id="2528630">typ</span>&nbsp;<span class="op" id="2528634">==</span>&nbsp;<span class="ident" id="2528637">tm</span><span class="op" id="2528639">.</span><span class="ident" id="2528640">typ</span>&nbsp;<span class="op" id="2528644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528650">if</span>&nbsp;<span class="ident" id="2528653">i</span><span class="op" id="2528654">++</span><span class="op" id="2528656">;</span>&nbsp;<span class="ident" id="2528658">i</span>&nbsp;<span class="op" id="2528660">&gt;=</span>&nbsp;<span class="builtinfunc" id="2528663">len</span><span class="op" id="2528666">(</span><span class="ident" id="2528667">t</span><span class="op" id="2528668">.</span><span class="ident" id="2528669">methods</span><span class="op" id="2528676">)</span>&nbsp;<span class="op" id="2528678">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528685">return</span>&nbsp;<span class="builtintype" id="2528692">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528714">return</span>&nbsp;<span class="builtintype" id="2528721">false</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528732">v</span>&nbsp;<span class="op" id="2528734">:=</span>&nbsp;<span class="ident" id="2528737">V</span><span class="op" id="2528738">.</span><span class="ident" id="2528739">uncommon</span><span class="op" id="2528747">(</span><span class="op" id="2528748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528751">if</span>&nbsp;<span class="ident" id="2528754">v</span>&nbsp;<span class="op" id="2528756">==</span>&nbsp;<span class="ident" id="2528759">nil</span>&nbsp;<span class="op" id="2528763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528767">return</span>&nbsp;<span class="builtintype" id="2528774">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2528781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528784">i</span>&nbsp;<span class="op" id="2528786">:=</span>&nbsp;<span class="num" id="2528789">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528792">for</span>&nbsp;<span class="ident" id="2528796">j</span>&nbsp;<span class="op" id="2528798">:=</span>&nbsp;<span class="num" id="2528801">0</span><span class="op" id="2528802">;</span>&nbsp;<span class="ident" id="2528804">j</span>&nbsp;<span class="op" id="2528806">&lt;</span>&nbsp;<span class="builtinfunc" id="2528808">len</span><span class="op" id="2528811">(</span><span class="ident" id="2528812">v</span><span class="op" id="2528813">.</span><span class="ident" id="2528814">methods</span><span class="op" id="2528821">)</span><span class="op" id="2528822">;</span>&nbsp;<span class="ident" id="2528824">j</span><span class="op" id="2528825">++</span>&nbsp;<span class="op" id="2528828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528832">tm</span>&nbsp;<span class="op" id="2528835">:=</span>&nbsp;<span class="op" id="2528838">&amp;</span><span class="ident" id="2528839">t</span><span class="op" id="2528840">.</span><span class="ident" id="2528841">methods</span><span class="op" id="2528848">[</span><span class="ident" id="2528849">i</span><span class="op" id="2528850">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2528854">vm</span>&nbsp;<span class="op" id="2528857">:=</span>&nbsp;<span class="op" id="2528860">&amp;</span><span class="ident" id="2528861">v</span><span class="op" id="2528862">.</span><span class="ident" id="2528863">methods</span><span class="op" id="2528870">[</span><span class="ident" id="2528871">j</span><span class="op" id="2528872">]</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528876">if</span>&nbsp;<span class="ident" id="2528879">vm</span><span class="op" id="2528881">.</span><span class="ident" id="2528882">name</span>&nbsp;<span class="op" id="2528887">==</span>&nbsp;<span class="ident" id="2528890">tm</span><span class="op" id="2528892">.</span><span class="ident" id="2528893">name</span>&nbsp;<span class="op" id="2528898">&amp;&amp;</span>&nbsp;<span class="ident" id="2528901">vm</span><span class="op" id="2528903">.</span><span class="ident" id="2528904">pkgPath</span>&nbsp;<span class="op" id="2528912">==</span>&nbsp;<span class="ident" id="2528915">tm</span><span class="op" id="2528917">.</span><span class="ident" id="2528918">pkgPath</span>&nbsp;<span class="op" id="2528926">&amp;&amp;</span>&nbsp;<span class="ident" id="2528929">vm</span><span class="op" id="2528931">.</span><span class="ident" id="2528932">mtyp</span>&nbsp;<span class="op" id="2528937">==</span>&nbsp;<span class="ident" id="2528940">tm</span><span class="op" id="2528942">.</span><span class="ident" id="2528943">typ</span>&nbsp;<span class="op" id="2528947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528952">if</span>&nbsp;<span class="ident" id="2528955">i</span><span class="op" id="2528956">++</span><span class="op" id="2528958">;</span>&nbsp;<span class="ident" id="2528960">i</span>&nbsp;<span class="op" id="2528962">&gt;=</span>&nbsp;<span class="builtinfunc" id="2528965">len</span><span class="op" id="2528968">(</span><span class="ident" id="2528969">t</span><span class="op" id="2528970">.</span><span class="ident" id="2528971">methods</span><span class="op" id="2528978">)</span>&nbsp;<span class="op" id="2528980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2528986">return</span>&nbsp;<span class="builtintype" id="2528993">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529005">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529011">return</span>&nbsp;<span class="builtintype" id="2529018">false</span><br>
<span class="lineno"></span><span class="op" id="2529024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2529027">//&nbsp;directlyAssignable&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;x&nbsp;of&nbsp;type&nbsp;V&nbsp;can&nbsp;be&nbsp;directly</span><br>
<span class="lineno">1170</span><span class="comment" id="2529101">//&nbsp;assigned&nbsp;(using&nbsp;memmove)&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="comment" id="2529151">//&nbsp;http://golang.org/doc/go_spec.html#Assignability</span><br>
<span class="lineno"></span><span class="comment" id="2529203">//&nbsp;Ignoring&nbsp;the&nbsp;interface&nbsp;rules&nbsp;(implemented&nbsp;elsewhere)</span><br>
<span class="lineno"></span><span class="comment" id="2529259">//&nbsp;and&nbsp;the&nbsp;ideal&nbsp;constant&nbsp;rules&nbsp;(no&nbsp;ideal&nbsp;constants&nbsp;at&nbsp;run&nbsp;time).</span><br>
<span class="lineno"></span><span class="keyword" id="2529325">func</span>&nbsp;<span class="ident" id="2529330">directlyAssignable</span><span class="op" id="2529348">(</span><span class="ident" id="2529349">T</span><span class="op" id="2529350">,</span>&nbsp;<span class="ident" id="2529352">V</span>&nbsp;<span class="op" id="2529354">*</span><span class="ident" id="2529355">rtype</span><span class="op" id="2529360">)</span>&nbsp;<span class="builtintype" id="2529362">bool</span>&nbsp;<span class="op" id="2529367">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529370">//&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;is&nbsp;identical&nbsp;to&nbsp;T?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529404">if</span>&nbsp;<span class="ident" id="2529407">T</span>&nbsp;<span class="op" id="2529409">==</span>&nbsp;<span class="ident" id="2529412">V</span>&nbsp;<span class="op" id="2529414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529418">return</span>&nbsp;<span class="builtintype" id="2529425">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529435">//&nbsp;Otherwise&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;be&nbsp;unnamed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529489">//&nbsp;and&nbsp;they&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529527">if</span>&nbsp;<span class="ident" id="2529530">T</span><span class="op" id="2529531">.</span><span class="ident" id="2529532">Name</span><span class="op" id="2529536">(</span><span class="op" id="2529537">)</span>&nbsp;<span class="op" id="2529539">!=</span>&nbsp;<span class="string" id="2529542">&#34;&#34;</span>&nbsp;<span class="op" id="2529545">&amp;&amp;</span>&nbsp;<span class="ident" id="2529548">V</span><span class="op" id="2529549">.</span><span class="ident" id="2529550">Name</span><span class="op" id="2529554">(</span><span class="op" id="2529555">)</span>&nbsp;<span class="op" id="2529557">!=</span>&nbsp;<span class="string" id="2529560">&#34;&#34;</span>&nbsp;<span class="op" id="2529563">||</span>&nbsp;<span class="ident" id="2529566">T</span><span class="op" id="2529567">.</span><span class="ident" id="2529568">Kind</span><span class="op" id="2529572">(</span><span class="op" id="2529573">)</span>&nbsp;<span class="op" id="2529575">!=</span>&nbsp;<span class="ident" id="2529578">V</span><span class="op" id="2529579">.</span><span class="ident" id="2529580">Kind</span><span class="op" id="2529584">(</span><span class="op" id="2529585">)</span>&nbsp;<span class="op" id="2529587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529591">return</span>&nbsp;<span class="builtintype" id="2529598">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529605">}</span><br>
<span class="lineno">1185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529609">//&nbsp;x&#39;s&nbsp;type&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;&nbsp;have&nbsp;identical&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529669">return</span>&nbsp;<span class="ident" id="2529676">haveIdenticalUnderlyingType</span><span class="op" id="2529703">(</span><span class="ident" id="2529704">T</span><span class="op" id="2529705">,</span>&nbsp;<span class="ident" id="2529707">V</span><span class="op" id="2529708">)</span><br>
<span class="lineno"></span><span class="op" id="2529710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1190</span><span class="keyword" id="2529713">func</span>&nbsp;<span class="ident" id="2529718">haveIdenticalUnderlyingType</span><span class="op" id="2529745">(</span><span class="ident" id="2529746">T</span><span class="op" id="2529747">,</span>&nbsp;<span class="ident" id="2529749">V</span>&nbsp;<span class="op" id="2529751">*</span><span class="ident" id="2529752">rtype</span><span class="op" id="2529757">)</span>&nbsp;<span class="builtintype" id="2529759">bool</span>&nbsp;<span class="op" id="2529764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529767">if</span>&nbsp;<span class="ident" id="2529770">T</span>&nbsp;<span class="op" id="2529772">==</span>&nbsp;<span class="ident" id="2529775">V</span>&nbsp;<span class="op" id="2529777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529781">return</span>&nbsp;<span class="builtintype" id="2529788">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2529798">kind</span>&nbsp;<span class="op" id="2529803">:=</span>&nbsp;<span class="ident" id="2529806">T</span><span class="op" id="2529807">.</span><span class="ident" id="2529808">Kind</span><span class="op" id="2529812">(</span><span class="op" id="2529813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529816">if</span>&nbsp;<span class="ident" id="2529819">kind</span>&nbsp;<span class="op" id="2529824">!=</span>&nbsp;<span class="ident" id="2529827">V</span><span class="op" id="2529828">.</span><span class="ident" id="2529829">Kind</span><span class="op" id="2529833">(</span><span class="op" id="2529834">)</span>&nbsp;<span class="op" id="2529836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529840">return</span>&nbsp;<span class="builtintype" id="2529847">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2529854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529858">//&nbsp;Non-composite&nbsp;types&nbsp;of&nbsp;equal&nbsp;kind&nbsp;have&nbsp;same&nbsp;underlying&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2529922">//&nbsp;(the&nbsp;predefined&nbsp;instance&nbsp;of&nbsp;the&nbsp;type).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2529965">if</span>&nbsp;<span class="ident" id="2529968">Bool</span>&nbsp;<span class="op" id="2529973">&lt;=</span>&nbsp;<span class="ident" id="2529976">kind</span>&nbsp;<span class="op" id="2529981">&amp;&amp;</span>&nbsp;<span class="ident" id="2529984">kind</span>&nbsp;<span class="op" id="2529989">&lt;=</span>&nbsp;<span class="ident" id="2529992">Complex128</span>&nbsp;<span class="op" id="2530003">||</span>&nbsp;<span class="ident" id="2530006">kind</span>&nbsp;<span class="op" id="2530011">==</span>&nbsp;<span class="ident" id="2530014">String</span>&nbsp;<span class="op" id="2530021">||</span>&nbsp;<span class="ident" id="2530024">kind</span>&nbsp;<span class="op" id="2530029">==</span>&nbsp;<span class="ident" id="2530032">UnsafePointer</span>&nbsp;<span class="op" id="2530046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530050">return</span>&nbsp;<span class="builtintype" id="2530057">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530063">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2530067">//&nbsp;Composite&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530088">switch</span>&nbsp;<span class="ident" id="2530095">kind</span>&nbsp;<span class="op" id="2530100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530103">case</span>&nbsp;<span class="ident" id="2530108">Array</span><span class="op" id="2530113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530117">return</span>&nbsp;<span class="ident" id="2530124">T</span><span class="op" id="2530125">.</span><span class="ident" id="2530126">Elem</span><span class="op" id="2530130">(</span><span class="op" id="2530131">)</span>&nbsp;<span class="op" id="2530133">==</span>&nbsp;<span class="ident" id="2530136">V</span><span class="op" id="2530137">.</span><span class="ident" id="2530138">Elem</span><span class="op" id="2530142">(</span><span class="op" id="2530143">)</span>&nbsp;<span class="op" id="2530145">&amp;&amp;</span>&nbsp;<span class="ident" id="2530148">T</span><span class="op" id="2530149">.</span><span class="ident" id="2530150">Len</span><span class="op" id="2530153">(</span><span class="op" id="2530154">)</span>&nbsp;<span class="op" id="2530156">==</span>&nbsp;<span class="ident" id="2530159">V</span><span class="op" id="2530160">.</span><span class="ident" id="2530161">Len</span><span class="op" id="2530164">(</span><span class="op" id="2530165">)</span><br>
<span class="lineno">1210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530169">case</span>&nbsp;<span class="ident" id="2530174">Chan</span><span class="op" id="2530178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2530182">//&nbsp;Special&nbsp;case:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2530201">//&nbsp;x&nbsp;is&nbsp;a&nbsp;bidirectional&nbsp;channel&nbsp;value,&nbsp;T&nbsp;is&nbsp;a&nbsp;channel&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2530263">//&nbsp;and&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;and&nbsp;T&nbsp;have&nbsp;identical&nbsp;element&nbsp;types.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530319">if</span>&nbsp;<span class="ident" id="2530322">V</span><span class="op" id="2530323">.</span><span class="ident" id="2530324">ChanDir</span><span class="op" id="2530331">(</span><span class="op" id="2530332">)</span>&nbsp;<span class="op" id="2530334">==</span>&nbsp;<span class="ident" id="2530337">BothDir</span>&nbsp;<span class="op" id="2530345">&amp;&amp;</span>&nbsp;<span class="ident" id="2530348">T</span><span class="op" id="2530349">.</span><span class="ident" id="2530350">Elem</span><span class="op" id="2530354">(</span><span class="op" id="2530355">)</span>&nbsp;<span class="op" id="2530357">==</span>&nbsp;<span class="ident" id="2530360">V</span><span class="op" id="2530361">.</span><span class="ident" id="2530362">Elem</span><span class="op" id="2530366">(</span><span class="op" id="2530367">)</span>&nbsp;<span class="op" id="2530369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530374">return</span>&nbsp;<span class="builtintype" id="2530381">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2530393">//&nbsp;Otherwise&nbsp;continue&nbsp;test&nbsp;for&nbsp;identical&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530453">return</span>&nbsp;<span class="ident" id="2530460">V</span><span class="op" id="2530461">.</span><span class="ident" id="2530462">ChanDir</span><span class="op" id="2530469">(</span><span class="op" id="2530470">)</span>&nbsp;<span class="op" id="2530472">==</span>&nbsp;<span class="ident" id="2530475">T</span><span class="op" id="2530476">.</span><span class="ident" id="2530477">ChanDir</span><span class="op" id="2530484">(</span><span class="op" id="2530485">)</span>&nbsp;<span class="op" id="2530487">&amp;&amp;</span>&nbsp;<span class="ident" id="2530490">T</span><span class="op" id="2530491">.</span><span class="ident" id="2530492">Elem</span><span class="op" id="2530496">(</span><span class="op" id="2530497">)</span>&nbsp;<span class="op" id="2530499">==</span>&nbsp;<span class="ident" id="2530502">V</span><span class="op" id="2530503">.</span><span class="ident" id="2530504">Elem</span><span class="op" id="2530508">(</span><span class="op" id="2530509">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530513">case</span>&nbsp;<span class="ident" id="2530518">Func</span><span class="op" id="2530522">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530526">t</span>&nbsp;<span class="op" id="2530528">:=</span>&nbsp;<span class="op" id="2530531">(</span><span class="op" id="2530532">*</span><span class="ident" id="2530533">funcType</span><span class="op" id="2530541">)</span><span class="op" id="2530542">(</span><span class="ident" id="2530543">unsafe</span><span class="op" id="2530549">.</span><span class="ident" id="2530550">Pointer</span><span class="op" id="2530557">(</span><span class="ident" id="2530558">T</span><span class="op" id="2530559">)</span><span class="op" id="2530560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530564">v</span>&nbsp;<span class="op" id="2530566">:=</span>&nbsp;<span class="op" id="2530569">(</span><span class="op" id="2530570">*</span><span class="ident" id="2530571">funcType</span><span class="op" id="2530579">)</span><span class="op" id="2530580">(</span><span class="ident" id="2530581">unsafe</span><span class="op" id="2530587">.</span><span class="ident" id="2530588">Pointer</span><span class="op" id="2530595">(</span><span class="ident" id="2530596">V</span><span class="op" id="2530597">)</span><span class="op" id="2530598">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530602">if</span>&nbsp;<span class="ident" id="2530605">t</span><span class="op" id="2530606">.</span><span class="ident" id="2530607">dotdotdot</span>&nbsp;<span class="op" id="2530617">!=</span>&nbsp;<span class="ident" id="2530620">v</span><span class="op" id="2530621">.</span><span class="ident" id="2530622">dotdotdot</span>&nbsp;<span class="op" id="2530632">||</span>&nbsp;<span class="builtinfunc" id="2530635">len</span><span class="op" id="2530638">(</span><span class="ident" id="2530639">t</span><span class="op" id="2530640">.</span><span class="ident" id="2530641">in</span><span class="op" id="2530643">)</span>&nbsp;<span class="op" id="2530645">!=</span>&nbsp;<span class="builtinfunc" id="2530648">len</span><span class="op" id="2530651">(</span><span class="ident" id="2530652">v</span><span class="op" id="2530653">.</span><span class="ident" id="2530654">in</span><span class="op" id="2530656">)</span>&nbsp;<span class="op" id="2530658">||</span>&nbsp;<span class="builtinfunc" id="2530661">len</span><span class="op" id="2530664">(</span><span class="ident" id="2530665">t</span><span class="op" id="2530666">.</span><span class="ident" id="2530667">out</span><span class="op" id="2530670">)</span>&nbsp;<span class="op" id="2530672">!=</span>&nbsp;<span class="builtinfunc" id="2530675">len</span><span class="op" id="2530678">(</span><span class="ident" id="2530679">v</span><span class="op" id="2530680">.</span><span class="ident" id="2530681">out</span><span class="op" id="2530684">)</span>&nbsp;<span class="op" id="2530686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530691">return</span>&nbsp;<span class="builtintype" id="2530698">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530710">for</span>&nbsp;<span class="ident" id="2530714">i</span><span class="op" id="2530715">,</span>&nbsp;<span class="ident" id="2530717">typ</span>&nbsp;<span class="op" id="2530721">:=</span>&nbsp;<span class="keyword" id="2530724">range</span>&nbsp;<span class="ident" id="2530730">t</span><span class="op" id="2530731">.</span><span class="ident" id="2530732">in</span>&nbsp;<span class="op" id="2530735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530740">if</span>&nbsp;<span class="ident" id="2530743">typ</span>&nbsp;<span class="op" id="2530747">!=</span>&nbsp;<span class="ident" id="2530750">v</span><span class="op" id="2530751">.</span><span class="ident" id="2530752">in</span><span class="op" id="2530754">[</span><span class="ident" id="2530755">i</span><span class="op" id="2530756">]</span>&nbsp;<span class="op" id="2530758">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530764">return</span>&nbsp;<span class="builtintype" id="2530771">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530788">for</span>&nbsp;<span class="ident" id="2530792">i</span><span class="op" id="2530793">,</span>&nbsp;<span class="ident" id="2530795">typ</span>&nbsp;<span class="op" id="2530799">:=</span>&nbsp;<span class="keyword" id="2530802">range</span>&nbsp;<span class="ident" id="2530808">t</span><span class="op" id="2530809">.</span><span class="ident" id="2530810">out</span>&nbsp;<span class="op" id="2530814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530819">if</span>&nbsp;<span class="ident" id="2530822">typ</span>&nbsp;<span class="op" id="2530826">!=</span>&nbsp;<span class="ident" id="2530829">v</span><span class="op" id="2530830">.</span><span class="ident" id="2530831">out</span><span class="op" id="2530834">[</span><span class="ident" id="2530835">i</span><span class="op" id="2530836">]</span>&nbsp;<span class="op" id="2530838">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530844">return</span>&nbsp;<span class="builtintype" id="2530851">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2530864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530868">return</span>&nbsp;<span class="builtintype" id="2530875">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530882">case</span>&nbsp;<span class="ident" id="2530887">Interface</span><span class="op" id="2530896">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530900">t</span>&nbsp;<span class="op" id="2530902">:=</span>&nbsp;<span class="op" id="2530905">(</span><span class="op" id="2530906">*</span><span class="ident" id="2530907">interfaceType</span><span class="op" id="2530920">)</span><span class="op" id="2530921">(</span><span class="ident" id="2530922">unsafe</span><span class="op" id="2530928">.</span><span class="ident" id="2530929">Pointer</span><span class="op" id="2530936">(</span><span class="ident" id="2530937">T</span><span class="op" id="2530938">)</span><span class="op" id="2530939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2530943">v</span>&nbsp;<span class="op" id="2530945">:=</span>&nbsp;<span class="op" id="2530948">(</span><span class="op" id="2530949">*</span><span class="ident" id="2530950">interfaceType</span><span class="op" id="2530963">)</span><span class="op" id="2530964">(</span><span class="ident" id="2530965">unsafe</span><span class="op" id="2530971">.</span><span class="ident" id="2530972">Pointer</span><span class="op" id="2530979">(</span><span class="ident" id="2530980">V</span><span class="op" id="2530981">)</span><span class="op" id="2530982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2530986">if</span>&nbsp;<span class="builtinfunc" id="2530989">len</span><span class="op" id="2530992">(</span><span class="ident" id="2530993">t</span><span class="op" id="2530994">.</span><span class="ident" id="2530995">methods</span><span class="op" id="2531002">)</span>&nbsp;<span class="op" id="2531004">==</span>&nbsp;<span class="num" id="2531007">0</span>&nbsp;<span class="op" id="2531009">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2531012">len</span><span class="op" id="2531015">(</span><span class="ident" id="2531016">v</span><span class="op" id="2531017">.</span><span class="ident" id="2531018">methods</span><span class="op" id="2531025">)</span>&nbsp;<span class="op" id="2531027">==</span>&nbsp;<span class="num" id="2531030">0</span>&nbsp;<span class="op" id="2531032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531037">return</span>&nbsp;<span class="builtintype" id="2531044">true</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2531055">//&nbsp;Might&nbsp;have&nbsp;the&nbsp;same&nbsp;methods&nbsp;but&nbsp;still</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2531098">//&nbsp;need&nbsp;a&nbsp;run&nbsp;time&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531131">return</span>&nbsp;<span class="builtintype" id="2531138">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531146">case</span>&nbsp;<span class="ident" id="2531151">Map</span><span class="op" id="2531154">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531158">return</span>&nbsp;<span class="ident" id="2531165">T</span><span class="op" id="2531166">.</span><span class="ident" id="2531167">Key</span><span class="op" id="2531170">(</span><span class="op" id="2531171">)</span>&nbsp;<span class="op" id="2531173">==</span>&nbsp;<span class="ident" id="2531176">V</span><span class="op" id="2531177">.</span><span class="ident" id="2531178">Key</span><span class="op" id="2531181">(</span><span class="op" id="2531182">)</span>&nbsp;<span class="op" id="2531184">&amp;&amp;</span>&nbsp;<span class="ident" id="2531187">T</span><span class="op" id="2531188">.</span><span class="ident" id="2531189">Elem</span><span class="op" id="2531193">(</span><span class="op" id="2531194">)</span>&nbsp;<span class="op" id="2531196">==</span>&nbsp;<span class="ident" id="2531199">V</span><span class="op" id="2531200">.</span><span class="ident" id="2531201">Elem</span><span class="op" id="2531205">(</span><span class="op" id="2531206">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531210">case</span>&nbsp;<span class="ident" id="2531215">Ptr</span><span class="op" id="2531218">,</span>&nbsp;<span class="ident" id="2531220">Slice</span><span class="op" id="2531225">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531229">return</span>&nbsp;<span class="ident" id="2531236">T</span><span class="op" id="2531237">.</span><span class="ident" id="2531238">Elem</span><span class="op" id="2531242">(</span><span class="op" id="2531243">)</span>&nbsp;<span class="op" id="2531245">==</span>&nbsp;<span class="ident" id="2531248">V</span><span class="op" id="2531249">.</span><span class="ident" id="2531250">Elem</span><span class="op" id="2531254">(</span><span class="op" id="2531255">)</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531259">case</span>&nbsp;<span class="ident" id="2531264">Struct</span><span class="op" id="2531270">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531274">t</span>&nbsp;<span class="op" id="2531276">:=</span>&nbsp;<span class="op" id="2531279">(</span><span class="op" id="2531280">*</span><span class="ident" id="2531281">structType</span><span class="op" id="2531291">)</span><span class="op" id="2531292">(</span><span class="ident" id="2531293">unsafe</span><span class="op" id="2531299">.</span><span class="ident" id="2531300">Pointer</span><span class="op" id="2531307">(</span><span class="ident" id="2531308">T</span><span class="op" id="2531309">)</span><span class="op" id="2531310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531314">v</span>&nbsp;<span class="op" id="2531316">:=</span>&nbsp;<span class="op" id="2531319">(</span><span class="op" id="2531320">*</span><span class="ident" id="2531321">structType</span><span class="op" id="2531331">)</span><span class="op" id="2531332">(</span><span class="ident" id="2531333">unsafe</span><span class="op" id="2531339">.</span><span class="ident" id="2531340">Pointer</span><span class="op" id="2531347">(</span><span class="ident" id="2531348">V</span><span class="op" id="2531349">)</span><span class="op" id="2531350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531354">if</span>&nbsp;<span class="builtinfunc" id="2531357">len</span><span class="op" id="2531360">(</span><span class="ident" id="2531361">t</span><span class="op" id="2531362">.</span><span class="ident" id="2531363">fields</span><span class="op" id="2531369">)</span>&nbsp;<span class="op" id="2531371">!=</span>&nbsp;<span class="builtinfunc" id="2531374">len</span><span class="op" id="2531377">(</span><span class="ident" id="2531378">v</span><span class="op" id="2531379">.</span><span class="ident" id="2531380">fields</span><span class="op" id="2531386">)</span>&nbsp;<span class="op" id="2531388">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531393">return</span>&nbsp;<span class="builtintype" id="2531400">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531412">for</span>&nbsp;<span class="ident" id="2531416">i</span>&nbsp;<span class="op" id="2531418">:=</span>&nbsp;<span class="keyword" id="2531421">range</span>&nbsp;<span class="ident" id="2531427">t</span><span class="op" id="2531428">.</span><span class="ident" id="2531429">fields</span>&nbsp;<span class="op" id="2531436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531441">tf</span>&nbsp;<span class="op" id="2531444">:=</span>&nbsp;<span class="op" id="2531447">&amp;</span><span class="ident" id="2531448">t</span><span class="op" id="2531449">.</span><span class="ident" id="2531450">fields</span><span class="op" id="2531456">[</span><span class="ident" id="2531457">i</span><span class="op" id="2531458">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2531463">vf</span>&nbsp;<span class="op" id="2531466">:=</span>&nbsp;<span class="op" id="2531469">&amp;</span><span class="ident" id="2531470">v</span><span class="op" id="2531471">.</span><span class="ident" id="2531472">fields</span><span class="op" id="2531478">[</span><span class="ident" id="2531479">i</span><span class="op" id="2531480">]</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531485">if</span>&nbsp;<span class="ident" id="2531488">tf</span><span class="op" id="2531490">.</span><span class="ident" id="2531491">name</span>&nbsp;<span class="op" id="2531496">!=</span>&nbsp;<span class="ident" id="2531499">vf</span><span class="op" id="2531501">.</span><span class="ident" id="2531502">name</span>&nbsp;<span class="op" id="2531507">&amp;&amp;</span>&nbsp;<span class="op" id="2531510">(</span><span class="ident" id="2531511">tf</span><span class="op" id="2531513">.</span><span class="ident" id="2531514">name</span>&nbsp;<span class="op" id="2531519">==</span>&nbsp;<span class="ident" id="2531522">nil</span>&nbsp;<span class="op" id="2531526">||</span>&nbsp;<span class="ident" id="2531529">vf</span><span class="op" id="2531531">.</span><span class="ident" id="2531532">name</span>&nbsp;<span class="op" id="2531537">==</span>&nbsp;<span class="ident" id="2531540">nil</span>&nbsp;<span class="op" id="2531544">||</span>&nbsp;<span class="op" id="2531547">*</span><span class="ident" id="2531548">tf</span><span class="op" id="2531550">.</span><span class="ident" id="2531551">name</span>&nbsp;<span class="op" id="2531556">!=</span>&nbsp;<span class="op" id="2531559">*</span><span class="ident" id="2531560">vf</span><span class="op" id="2531562">.</span><span class="ident" id="2531563">name</span><span class="op" id="2531567">)</span>&nbsp;<span class="op" id="2531569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531575">return</span>&nbsp;<span class="builtintype" id="2531582">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531596">if</span>&nbsp;<span class="ident" id="2531599">tf</span><span class="op" id="2531601">.</span><span class="ident" id="2531602">pkgPath</span>&nbsp;<span class="op" id="2531610">!=</span>&nbsp;<span class="ident" id="2531613">vf</span><span class="op" id="2531615">.</span><span class="ident" id="2531616">pkgPath</span>&nbsp;<span class="op" id="2531624">&amp;&amp;</span>&nbsp;<span class="op" id="2531627">(</span><span class="ident" id="2531628">tf</span><span class="op" id="2531630">.</span><span class="ident" id="2531631">pkgPath</span>&nbsp;<span class="op" id="2531639">==</span>&nbsp;<span class="ident" id="2531642">nil</span>&nbsp;<span class="op" id="2531646">||</span>&nbsp;<span class="ident" id="2531649">vf</span><span class="op" id="2531651">.</span><span class="ident" id="2531652">pkgPath</span>&nbsp;<span class="op" id="2531660">==</span>&nbsp;<span class="ident" id="2531663">nil</span>&nbsp;<span class="op" id="2531667">||</span>&nbsp;<span class="op" id="2531670">*</span><span class="ident" id="2531671">tf</span><span class="op" id="2531673">.</span><span class="ident" id="2531674">pkgPath</span>&nbsp;<span class="op" id="2531682">!=</span>&nbsp;<span class="op" id="2531685">*</span><span class="ident" id="2531686">vf</span><span class="op" id="2531688">.</span><span class="ident" id="2531689">pkgPath</span><span class="op" id="2531696">)</span>&nbsp;<span class="op" id="2531698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531704">return</span>&nbsp;<span class="builtintype" id="2531711">false</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531725">if</span>&nbsp;<span class="ident" id="2531728">tf</span><span class="op" id="2531730">.</span><span class="ident" id="2531731">typ</span>&nbsp;<span class="op" id="2531735">!=</span>&nbsp;<span class="ident" id="2531738">vf</span><span class="op" id="2531740">.</span><span class="ident" id="2531741">typ</span>&nbsp;<span class="op" id="2531745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531751">return</span>&nbsp;<span class="builtintype" id="2531758">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531772">if</span>&nbsp;<span class="ident" id="2531775">tf</span><span class="op" id="2531777">.</span><span class="ident" id="2531778">tag</span>&nbsp;<span class="op" id="2531782">!=</span>&nbsp;<span class="ident" id="2531785">vf</span><span class="op" id="2531787">.</span><span class="ident" id="2531788">tag</span>&nbsp;<span class="op" id="2531792">&amp;&amp;</span>&nbsp;<span class="op" id="2531795">(</span><span class="ident" id="2531796">tf</span><span class="op" id="2531798">.</span><span class="ident" id="2531799">tag</span>&nbsp;<span class="op" id="2531803">==</span>&nbsp;<span class="ident" id="2531806">nil</span>&nbsp;<span class="op" id="2531810">||</span>&nbsp;<span class="ident" id="2531813">vf</span><span class="op" id="2531815">.</span><span class="ident" id="2531816">tag</span>&nbsp;<span class="op" id="2531820">==</span>&nbsp;<span class="ident" id="2531823">nil</span>&nbsp;<span class="op" id="2531827">||</span>&nbsp;<span class="op" id="2531830">*</span><span class="ident" id="2531831">tf</span><span class="op" id="2531833">.</span><span class="ident" id="2531834">tag</span>&nbsp;<span class="op" id="2531838">!=</span>&nbsp;<span class="op" id="2531841">*</span><span class="ident" id="2531842">vf</span><span class="op" id="2531844">.</span><span class="ident" id="2531845">tag</span><span class="op" id="2531848">)</span>&nbsp;<span class="op" id="2531850">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531856">return</span>&nbsp;<span class="builtintype" id="2531863">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531877">if</span>&nbsp;<span class="ident" id="2531880">tf</span><span class="op" id="2531882">.</span><span class="ident" id="2531883">offset</span>&nbsp;<span class="op" id="2531890">!=</span>&nbsp;<span class="ident" id="2531893">vf</span><span class="op" id="2531895">.</span><span class="ident" id="2531896">offset</span>&nbsp;<span class="op" id="2531903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531909">return</span>&nbsp;<span class="builtintype" id="2531916">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531925">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531933">return</span>&nbsp;<span class="builtintype" id="2531940">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2531946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2531950">return</span>&nbsp;<span class="builtintype" id="2531957">false</span><br>
<span class="lineno">1285</span><span class="op" id="2531963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2531966">//&nbsp;typelinks&nbsp;is&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="comment" id="2532014">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;&#39;typelink&#39;&nbsp;information&nbsp;in&nbsp;the&nbsp;binary,</span><br>
<span class="lineno"></span><span class="comment" id="2532085">//&nbsp;which&nbsp;is&nbsp;to&nbsp;say&nbsp;a&nbsp;slice&nbsp;of&nbsp;known&nbsp;types,&nbsp;sorted&nbsp;by&nbsp;string.</span><br>
<span class="lineno">1290</span><span class="comment" id="2532146">//&nbsp;Note&nbsp;that&nbsp;strings&nbsp;are&nbsp;not&nbsp;unique&nbsp;identifiers&nbsp;for&nbsp;types:</span><br>
<span class="lineno"></span><span class="comment" id="2532205">//&nbsp;there&nbsp;can&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;with&nbsp;a&nbsp;given&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2532256">//&nbsp;Only&nbsp;types&nbsp;we&nbsp;might&nbsp;want&nbsp;to&nbsp;look&nbsp;up&nbsp;are&nbsp;included:</span><br>
<span class="lineno"></span><span class="comment" id="2532309">//&nbsp;channels,&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;arrays.</span><br>
<span class="lineno"></span><span class="keyword" id="2532348">func</span>&nbsp;<span class="ident" id="2532353">typelinks</span><span class="op" id="2532362">(</span><span class="op" id="2532363">)</span>&nbsp;<span class="op" id="2532365">[</span><span class="op" id="2532366">]</span><span class="op" id="2532367">*</span><span class="ident" id="2532368">rtype</span><br>
<span class="lineno">1295</span><br>
<span class="lineno"></span><span class="comment" id="2532375">//&nbsp;typesByString&nbsp;returns&nbsp;the&nbsp;subslice&nbsp;of&nbsp;typelinks()&nbsp;whose&nbsp;elements&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2532448">//&nbsp;the&nbsp;given&nbsp;string&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="2532484">//&nbsp;It&nbsp;may&nbsp;be&nbsp;empty&nbsp;(no&nbsp;known&nbsp;types&nbsp;with&nbsp;that&nbsp;string)&nbsp;or&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2532549">//&nbsp;multiple&nbsp;elements&nbsp;(multiple&nbsp;types&nbsp;with&nbsp;that&nbsp;string).</span><br>
<span class="lineno">1300</span><span class="keyword" id="2532605">func</span>&nbsp;<span class="ident" id="2532610">typesByString</span><span class="op" id="2532623">(</span><span class="ident" id="2532624">s</span>&nbsp;<span class="builtintype" id="2532626">string</span><span class="op" id="2532632">)</span>&nbsp;<span class="op" id="2532634">[</span><span class="op" id="2532635">]</span><span class="op" id="2532636">*</span><span class="ident" id="2532637">rtype</span>&nbsp;<span class="op" id="2532643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532646">typ</span>&nbsp;<span class="op" id="2532650">:=</span>&nbsp;<span class="ident" id="2532653">typelinks</span><span class="op" id="2532662">(</span><span class="op" id="2532663">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532667">//&nbsp;We&nbsp;are&nbsp;looking&nbsp;for&nbsp;the&nbsp;first&nbsp;index&nbsp;i&nbsp;where&nbsp;the&nbsp;string&nbsp;becomes&nbsp;&gt;=&nbsp;s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532739">//&nbsp;This&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;sort.Search,&nbsp;with&nbsp;f(h)&nbsp;replaced&nbsp;by&nbsp;(*typ[h].string&nbsp;&gt;=&nbsp;s).</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532819">i</span><span class="op" id="2532820">,</span>&nbsp;<span class="ident" id="2532822">j</span>&nbsp;<span class="op" id="2532824">:=</span>&nbsp;<span class="num" id="2532827">0</span><span class="op" id="2532828">,</span>&nbsp;<span class="builtinfunc" id="2532830">len</span><span class="op" id="2532833">(</span><span class="ident" id="2532834">typ</span><span class="op" id="2532837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532840">for</span>&nbsp;<span class="ident" id="2532844">i</span>&nbsp;<span class="op" id="2532846">&lt;</span>&nbsp;<span class="ident" id="2532848">j</span>&nbsp;<span class="op" id="2532850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532854">h</span>&nbsp;<span class="op" id="2532856">:=</span>&nbsp;<span class="ident" id="2532859">i</span>&nbsp;<span class="op" id="2532861">+</span>&nbsp;<span class="op" id="2532863">(</span><span class="ident" id="2532864">j</span><span class="op" id="2532865">-</span><span class="ident" id="2532866">i</span><span class="op" id="2532867">)</span><span class="op" id="2532868">/</span><span class="num" id="2532869">2</span>&nbsp;<span class="comment" id="2532871">//&nbsp;avoid&nbsp;overflow&nbsp;when&nbsp;computing&nbsp;h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2532908">//&nbsp;i&nbsp;&nbsp;h&nbsp;&lt;&nbsp;j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2532925">if</span>&nbsp;<span class="op" id="2532928">!</span><span class="op" id="2532929">(</span><span class="op" id="2532930">*</span><span class="ident" id="2532931">typ</span><span class="op" id="2532934">[</span><span class="ident" id="2532935">h</span><span class="op" id="2532936">]</span><span class="op" id="2532937">.</span><span class="builtintype" id="2532938">string</span>&nbsp;<span class="op" id="2532945">&gt;=</span>&nbsp;<span class="ident" id="2532948">s</span><span class="op" id="2532949">)</span>&nbsp;<span class="op" id="2532951">{</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2532956">i</span>&nbsp;<span class="op" id="2532958">=</span>&nbsp;<span class="ident" id="2532960">h</span>&nbsp;<span class="op" id="2532962">+</span>&nbsp;<span class="num" id="2532964">1</span>&nbsp;<span class="comment" id="2532966">//&nbsp;preserves&nbsp;f(i-1)&nbsp;==&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2532997">}</span>&nbsp;<span class="keyword" id="2532999">else</span>&nbsp;<span class="op" id="2533004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533009">j</span>&nbsp;<span class="op" id="2533011">=</span>&nbsp;<span class="ident" id="2533013">h</span>&nbsp;<span class="comment" id="2533015">//&nbsp;preserves&nbsp;f(j)&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533046">}</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2533049">//&nbsp;i&nbsp;==&nbsp;j,&nbsp;f(i-1)&nbsp;==&nbsp;false,&nbsp;and&nbsp;f(j)&nbsp;(=&nbsp;f(i))&nbsp;==&nbsp;true&nbsp;&nbsp;=&gt;&nbsp;&nbsp;answer&nbsp;is&nbsp;i.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2533123">//&nbsp;Having&nbsp;found&nbsp;the&nbsp;first,&nbsp;linear&nbsp;scan&nbsp;forward&nbsp;to&nbsp;find&nbsp;the&nbsp;last.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2533189">//&nbsp;We&nbsp;could&nbsp;do&nbsp;a&nbsp;second&nbsp;binary&nbsp;search,&nbsp;but&nbsp;the&nbsp;caller&nbsp;is&nbsp;going</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2533253">//&nbsp;to&nbsp;do&nbsp;a&nbsp;linear&nbsp;scan&nbsp;anyway.</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533285">j</span>&nbsp;<span class="op" id="2533287">=</span>&nbsp;<span class="ident" id="2533289">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533292">for</span>&nbsp;<span class="ident" id="2533296">j</span>&nbsp;<span class="op" id="2533298">&lt;</span>&nbsp;<span class="builtinfunc" id="2533300">len</span><span class="op" id="2533303">(</span><span class="ident" id="2533304">typ</span><span class="op" id="2533307">)</span>&nbsp;<span class="op" id="2533309">&amp;&amp;</span>&nbsp;<span class="op" id="2533312">*</span><span class="ident" id="2533313">typ</span><span class="op" id="2533316">[</span><span class="ident" id="2533317">j</span><span class="op" id="2533318">]</span><span class="op" id="2533319">.</span><span class="builtintype" id="2533320">string</span>&nbsp;<span class="op" id="2533327">==</span>&nbsp;<span class="ident" id="2533330">s</span>&nbsp;<span class="op" id="2533332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533336">j</span><span class="op" id="2533337">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2533341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2533345">//&nbsp;This&nbsp;slice&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;string&nbsp;is&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2533402">return</span>&nbsp;<span class="ident" id="2533409">typ</span><span class="op" id="2533412">[</span><span class="ident" id="2533413">i</span><span class="op" id="2533414">:</span><span class="ident" id="2533415">j</span><span class="op" id="2533416">]</span><br>
<span class="lineno"></span><span class="op" id="2533418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2533421">//&nbsp;The&nbsp;lookupCache&nbsp;caches&nbsp;ChanOf,&nbsp;MapOf,&nbsp;and&nbsp;SliceOf&nbsp;lookups.</span><br>
<span class="lineno">1330</span><span class="keyword" id="2533483">var</span>&nbsp;<span class="ident" id="2533487">lookupCache</span>&nbsp;<span class="keyword" id="2533499">struct</span>&nbsp;<span class="op" id="2533506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533509">sync</span><span class="op" id="2533513">.</span><span class="ident" id="2533514">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533523">m</span>&nbsp;<span class="keyword" id="2533525">map</span><span class="op" id="2533528">[</span><span class="ident" id="2533529">cacheKey</span><span class="op" id="2533537">]</span><span class="op" id="2533538">*</span><span class="ident" id="2533539">rtype</span><br>
<span class="lineno"></span><span class="op" id="2533545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="comment" id="2533548">//&nbsp;A&nbsp;cacheKey&nbsp;is&nbsp;the&nbsp;key&nbsp;for&nbsp;use&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2533601">//&nbsp;Four&nbsp;values&nbsp;describe&nbsp;any&nbsp;of&nbsp;the&nbsp;types&nbsp;we&nbsp;are&nbsp;looking&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="2533662">//&nbsp;type&nbsp;kind,&nbsp;one&nbsp;or&nbsp;two&nbsp;subtypes,&nbsp;and&nbsp;an&nbsp;extra&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="2533719">type</span>&nbsp;<span class="ident" id="2533724">cacheKey</span>&nbsp;<span class="keyword" id="2533733">struct</span>&nbsp;<span class="op" id="2533740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533743">kind</span>&nbsp;&nbsp;<span class="ident" id="2533749">Kind</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533755">t1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2533761">*</span><span class="ident" id="2533762">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533769">t2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2533775">*</span><span class="ident" id="2533776">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2533783">extra</span>&nbsp;<span class="builtintype" id="2533789">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2533797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1345</span><span class="comment" id="2533800">//&nbsp;cacheGet&nbsp;looks&nbsp;for&nbsp;a&nbsp;type&nbsp;under&nbsp;the&nbsp;key&nbsp;k&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2533865">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;one,&nbsp;it&nbsp;returns&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2533907">//&nbsp;If&nbsp;not,&nbsp;it&nbsp;returns&nbsp;nil&nbsp;with&nbsp;the&nbsp;cache&nbsp;locked.</span><br>
<span class="lineno"></span><span class="comment" id="2533956">//&nbsp;The&nbsp;caller&nbsp;is&nbsp;expected&nbsp;to&nbsp;use&nbsp;cachePut&nbsp;to&nbsp;unlock&nbsp;the&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="2534019">func</span>&nbsp;<span class="ident" id="2534024">cacheGet</span><span class="op" id="2534032">(</span><span class="ident" id="2534033">k</span>&nbsp;<span class="ident" id="2534035">cacheKey</span><span class="op" id="2534043">)</span>&nbsp;<span class="ident" id="2534045">Type</span>&nbsp;<span class="op" id="2534050">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534053">lookupCache</span><span class="op" id="2534064">.</span><span class="ident" id="2534065">RLock</span><span class="op" id="2534070">(</span><span class="op" id="2534071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534074">t</span>&nbsp;<span class="op" id="2534076">:=</span>&nbsp;<span class="ident" id="2534079">lookupCache</span><span class="op" id="2534090">.</span><span class="ident" id="2534091">m</span><span class="op" id="2534092">[</span><span class="ident" id="2534093">k</span><span class="op" id="2534094">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534097">lookupCache</span><span class="op" id="2534108">.</span><span class="ident" id="2534109">RUnlock</span><span class="op" id="2534116">(</span><span class="op" id="2534117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534120">if</span>&nbsp;<span class="ident" id="2534123">t</span>&nbsp;<span class="op" id="2534125">!=</span>&nbsp;<span class="ident" id="2534128">nil</span>&nbsp;<span class="op" id="2534132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534136">return</span>&nbsp;<span class="ident" id="2534143">t</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2534146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534150">lookupCache</span><span class="op" id="2534161">.</span><span class="ident" id="2534162">Lock</span><span class="op" id="2534166">(</span><span class="op" id="2534167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534170">t</span>&nbsp;<span class="op" id="2534172">=</span>&nbsp;<span class="ident" id="2534174">lookupCache</span><span class="op" id="2534185">.</span><span class="ident" id="2534186">m</span><span class="op" id="2534187">[</span><span class="ident" id="2534188">k</span><span class="op" id="2534189">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534192">if</span>&nbsp;<span class="ident" id="2534195">t</span>&nbsp;<span class="op" id="2534197">!=</span>&nbsp;<span class="ident" id="2534200">nil</span>&nbsp;<span class="op" id="2534204">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534208">lookupCache</span><span class="op" id="2534219">.</span><span class="ident" id="2534220">Unlock</span><span class="op" id="2534226">(</span><span class="op" id="2534227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534231">return</span>&nbsp;<span class="ident" id="2534238">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2534241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534245">if</span>&nbsp;<span class="ident" id="2534248">lookupCache</span><span class="op" id="2534259">.</span><span class="ident" id="2534260">m</span>&nbsp;<span class="op" id="2534262">==</span>&nbsp;<span class="ident" id="2534265">nil</span>&nbsp;<span class="op" id="2534269">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534273">lookupCache</span><span class="op" id="2534284">.</span><span class="ident" id="2534285">m</span>&nbsp;<span class="op" id="2534287">=</span>&nbsp;<span class="builtinfunc" id="2534289">make</span><span class="op" id="2534293">(</span><span class="keyword" id="2534294">map</span><span class="op" id="2534297">[</span><span class="ident" id="2534298">cacheKey</span><span class="op" id="2534306">]</span><span class="op" id="2534307">*</span><span class="ident" id="2534308">rtype</span><span class="op" id="2534313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2534316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534320">return</span>&nbsp;<span class="ident" id="2534327">nil</span><br>
<span class="lineno"></span><span class="op" id="2534331">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="2534334">//&nbsp;cachePut&nbsp;stores&nbsp;the&nbsp;given&nbsp;type&nbsp;in&nbsp;the&nbsp;cache,&nbsp;unlocks&nbsp;the&nbsp;cache,</span><br>
<span class="lineno"></span><span class="comment" id="2534401">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type.&nbsp;It&nbsp;is&nbsp;expected&nbsp;that&nbsp;the&nbsp;cache&nbsp;is&nbsp;locked</span><br>
<span class="lineno"></span><span class="comment" id="2534466">//&nbsp;because&nbsp;cacheGet&nbsp;returned&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2534500">func</span>&nbsp;<span class="ident" id="2534505">cachePut</span><span class="op" id="2534513">(</span><span class="ident" id="2534514">k</span>&nbsp;<span class="ident" id="2534516">cacheKey</span><span class="op" id="2534524">,</span>&nbsp;<span class="ident" id="2534526">t</span>&nbsp;<span class="op" id="2534528">*</span><span class="ident" id="2534529">rtype</span><span class="op" id="2534534">)</span>&nbsp;<span class="ident" id="2534536">Type</span>&nbsp;<span class="op" id="2534541">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534544">lookupCache</span><span class="op" id="2534555">.</span><span class="ident" id="2534556">m</span><span class="op" id="2534557">[</span><span class="ident" id="2534558">k</span><span class="op" id="2534559">]</span>&nbsp;<span class="op" id="2534561">=</span>&nbsp;<span class="ident" id="2534563">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534566">lookupCache</span><span class="op" id="2534577">.</span><span class="ident" id="2534578">Unlock</span><span class="op" id="2534584">(</span><span class="op" id="2534585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2534588">return</span>&nbsp;<span class="ident" id="2534595">t</span><br>
<span class="lineno"></span><span class="op" id="2534597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span><span class="comment" id="2534600">//&nbsp;ChanOf&nbsp;returns&nbsp;the&nbsp;channel&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;direction&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2534678">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ChanOf(RecvDir,&nbsp;t)&nbsp;represents&nbsp;&lt;-chan&nbsp;int.</span><br>
<span class="lineno"></span><span class="comment" id="2534757">//</span><br>
<span class="lineno"></span><span class="comment" id="2534760">//&nbsp;The&nbsp;gc&nbsp;runtime&nbsp;imposes&nbsp;a&nbsp;limit&nbsp;of&nbsp;64&nbsp;kB&nbsp;on&nbsp;channel&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2534829">//&nbsp;If&nbsp;t&#39;s&nbsp;size&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;exceeds&nbsp;this&nbsp;limit,&nbsp;ChanOf&nbsp;panics.</span><br>
<span class="lineno">1385</span><span class="keyword" id="2534894">func</span>&nbsp;<span class="ident" id="2534899">ChanOf</span><span class="op" id="2534905">(</span><span class="ident" id="2534906">dir</span>&nbsp;<span class="ident" id="2534910">ChanDir</span><span class="op" id="2534917">,</span>&nbsp;<span class="ident" id="2534919">t</span>&nbsp;<span class="ident" id="2534921">Type</span><span class="op" id="2534925">)</span>&nbsp;<span class="ident" id="2534927">Type</span>&nbsp;<span class="op" id="2534932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534935">typ</span>&nbsp;<span class="op" id="2534939">:=</span>&nbsp;<span class="ident" id="2534942">t</span><span class="op" id="2534943">.</span><span class="op" id="2534944">(</span><span class="op" id="2534945">*</span><span class="ident" id="2534946">rtype</span><span class="op" id="2534951">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2534955">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2534974">ckey</span>&nbsp;<span class="op" id="2534979">:=</span>&nbsp;<span class="ident" id="2534982">cacheKey</span><span class="op" id="2534990">{</span><span class="ident" id="2534991">Chan</span><span class="op" id="2534995">,</span>&nbsp;<span class="ident" id="2534997">typ</span><span class="op" id="2535000">,</span>&nbsp;<span class="ident" id="2535002">nil</span><span class="op" id="2535005">,</span>&nbsp;<span class="builtintype" id="2535007">uintptr</span><span class="op" id="2535014">(</span><span class="ident" id="2535015">dir</span><span class="op" id="2535018">)</span><span class="op" id="2535019">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535022">if</span>&nbsp;<span class="ident" id="2535025">ch</span>&nbsp;<span class="op" id="2535028">:=</span>&nbsp;<span class="ident" id="2535031">cacheGet</span><span class="op" id="2535039">(</span><span class="ident" id="2535040">ckey</span><span class="op" id="2535044">)</span><span class="op" id="2535045">;</span>&nbsp;<span class="ident" id="2535047">ch</span>&nbsp;<span class="op" id="2535050">!=</span>&nbsp;<span class="ident" id="2535053">nil</span>&nbsp;<span class="op" id="2535057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535061">return</span>&nbsp;<span class="ident" id="2535068">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2535076">//&nbsp;This&nbsp;restriction&nbsp;is&nbsp;imposed&nbsp;by&nbsp;the&nbsp;gc&nbsp;compiler&nbsp;and&nbsp;the&nbsp;runtime.</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535144">if</span>&nbsp;<span class="ident" id="2535147">typ</span><span class="op" id="2535150">.</span><span class="ident" id="2535151">size</span>&nbsp;<span class="op" id="2535156">&gt;=</span>&nbsp;<span class="num" id="2535159">1</span><span class="op" id="2535160">&lt;&lt;</span><span class="num" id="2535162">16</span>&nbsp;<span class="op" id="2535165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535169">lookupCache</span><span class="op" id="2535180">.</span><span class="ident" id="2535181">Unlock</span><span class="op" id="2535187">(</span><span class="op" id="2535188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2535192">panic</span><span class="op" id="2535197">(</span><span class="string" id="2535198">&#34;reflect.ChanOf:&nbsp;element&nbsp;size&nbsp;too&nbsp;large&#34;</span><span class="op" id="2535238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2535245">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2535270">//&nbsp;TODO:&nbsp;Precedence&nbsp;when&nbsp;constructing&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535317">var</span>&nbsp;<span class="ident" id="2535321">s</span>&nbsp;<span class="builtintype" id="2535323">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535331">switch</span>&nbsp;<span class="ident" id="2535338">dir</span>&nbsp;<span class="op" id="2535342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535345">default</span><span class="op" id="2535352">:</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535356">lookupCache</span><span class="op" id="2535367">.</span><span class="ident" id="2535368">Unlock</span><span class="op" id="2535374">(</span><span class="op" id="2535375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2535379">panic</span><span class="op" id="2535384">(</span><span class="string" id="2535385">&#34;reflect.ChanOf:&nbsp;invalid&nbsp;dir&#34;</span><span class="op" id="2535414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535417">case</span>&nbsp;<span class="ident" id="2535422">SendDir</span><span class="op" id="2535429">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535433">s</span>&nbsp;<span class="op" id="2535435">=</span>&nbsp;<span class="string" id="2535437">&#34;chan&lt;-&nbsp;&#34;</span>&nbsp;<span class="op" id="2535447">+</span>&nbsp;<span class="op" id="2535449">*</span><span class="ident" id="2535450">typ</span><span class="op" id="2535453">.</span><span class="builtintype" id="2535454">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535462">case</span>&nbsp;<span class="ident" id="2535467">RecvDir</span><span class="op" id="2535474">:</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535478">s</span>&nbsp;<span class="op" id="2535480">=</span>&nbsp;<span class="string" id="2535482">&#34;&lt;-chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2535492">+</span>&nbsp;<span class="op" id="2535494">*</span><span class="ident" id="2535495">typ</span><span class="op" id="2535498">.</span><span class="builtintype" id="2535499">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535507">case</span>&nbsp;<span class="ident" id="2535512">BothDir</span><span class="op" id="2535519">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535523">s</span>&nbsp;<span class="op" id="2535525">=</span>&nbsp;<span class="string" id="2535527">&#34;chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2535535">+</span>&nbsp;<span class="op" id="2535537">*</span><span class="ident" id="2535538">typ</span><span class="op" id="2535541">.</span><span class="builtintype" id="2535542">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535553">for</span>&nbsp;<span class="ident" id="2535557">_</span><span class="op" id="2535558">,</span>&nbsp;<span class="ident" id="2535560">tt</span>&nbsp;<span class="op" id="2535563">:=</span>&nbsp;<span class="keyword" id="2535566">range</span>&nbsp;<span class="ident" id="2535572">typesByString</span><span class="op" id="2535585">(</span><span class="ident" id="2535586">s</span><span class="op" id="2535587">)</span>&nbsp;<span class="op" id="2535589">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535593">ch</span>&nbsp;<span class="op" id="2535596">:=</span>&nbsp;<span class="op" id="2535599">(</span><span class="op" id="2535600">*</span><span class="ident" id="2535601">chanType</span><span class="op" id="2535609">)</span><span class="op" id="2535610">(</span><span class="ident" id="2535611">unsafe</span><span class="op" id="2535617">.</span><span class="ident" id="2535618">Pointer</span><span class="op" id="2535625">(</span><span class="ident" id="2535626">tt</span><span class="op" id="2535628">)</span><span class="op" id="2535629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535633">if</span>&nbsp;<span class="ident" id="2535636">ch</span><span class="op" id="2535638">.</span><span class="ident" id="2535639">elem</span>&nbsp;<span class="op" id="2535644">==</span>&nbsp;<span class="ident" id="2535647">typ</span>&nbsp;<span class="op" id="2535651">&amp;&amp;</span>&nbsp;<span class="ident" id="2535654">ch</span><span class="op" id="2535656">.</span><span class="ident" id="2535657">dir</span>&nbsp;<span class="op" id="2535661">==</span>&nbsp;<span class="builtintype" id="2535664">uintptr</span><span class="op" id="2535671">(</span><span class="ident" id="2535672">dir</span><span class="op" id="2535675">)</span>&nbsp;<span class="op" id="2535677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535682">return</span>&nbsp;<span class="ident" id="2535689">cachePut</span><span class="op" id="2535697">(</span><span class="ident" id="2535698">ckey</span><span class="op" id="2535702">,</span>&nbsp;<span class="ident" id="2535704">tt</span><span class="op" id="2535706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535713">}</span><br>
<span class="lineno">1420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2535717">//&nbsp;Make&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2535742">var</span>&nbsp;<span class="ident" id="2535746">ichan</span>&nbsp;<span class="keyword" id="2535752">interface</span><span class="op" id="2535761">{</span><span class="op" id="2535762">}</span>&nbsp;<span class="op" id="2535764">=</span>&nbsp;<span class="op" id="2535766">(</span><span class="keyword" id="2535767">chan</span>&nbsp;<span class="ident" id="2535772">unsafe</span><span class="op" id="2535778">.</span><span class="ident" id="2535779">Pointer</span><span class="op" id="2535786">)</span><span class="op" id="2535787">(</span><span class="ident" id="2535788">nil</span><span class="op" id="2535791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535794">prototype</span>&nbsp;<span class="op" id="2535804">:=</span>&nbsp;<span class="op" id="2535807">*</span><span class="op" id="2535808">(</span><span class="op" id="2535809">*</span><span class="op" id="2535810">*</span><span class="ident" id="2535811">chanType</span><span class="op" id="2535819">)</span><span class="op" id="2535820">(</span><span class="ident" id="2535821">unsafe</span><span class="op" id="2535827">.</span><span class="ident" id="2535828">Pointer</span><span class="op" id="2535835">(</span><span class="op" id="2535836">&amp;</span><span class="ident" id="2535837">ichan</span><span class="op" id="2535842">)</span><span class="op" id="2535843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535846">ch</span>&nbsp;<span class="op" id="2535849">:=</span>&nbsp;<span class="builtinfunc" id="2535852">new</span><span class="op" id="2535855">(</span><span class="ident" id="2535856">chanType</span><span class="op" id="2535864">)</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2535867">*</span><span class="ident" id="2535868">ch</span>&nbsp;<span class="op" id="2535871">=</span>&nbsp;<span class="op" id="2535873">*</span><span class="ident" id="2535874">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535885">ch</span><span class="op" id="2535887">.</span><span class="builtintype" id="2535888">string</span>&nbsp;<span class="op" id="2535895">=</span>&nbsp;<span class="op" id="2535897">&amp;</span><span class="ident" id="2535898">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535901">ch</span><span class="op" id="2535903">.</span><span class="ident" id="2535904">hash</span>&nbsp;<span class="op" id="2535909">=</span>&nbsp;<span class="ident" id="2535911">fnv1</span><span class="op" id="2535915">(</span><span class="ident" id="2535916">typ</span><span class="op" id="2535919">.</span><span class="ident" id="2535920">hash</span><span class="op" id="2535924">,</span>&nbsp;<span class="string" id="2535926">&#39;c&#39;</span><span class="op" id="2535929">,</span>&nbsp;<span class="builtintype" id="2535931">byte</span><span class="op" id="2535935">(</span><span class="ident" id="2535936">dir</span><span class="op" id="2535939">)</span><span class="op" id="2535940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535943">ch</span><span class="op" id="2535945">.</span><span class="ident" id="2535946">elem</span>&nbsp;<span class="op" id="2535951">=</span>&nbsp;<span class="ident" id="2535953">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535958">ch</span><span class="op" id="2535960">.</span><span class="ident" id="2535961">uncommonType</span>&nbsp;<span class="op" id="2535974">=</span>&nbsp;<span class="ident" id="2535976">nil</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2535981">ch</span><span class="op" id="2535983">.</span><span class="ident" id="2535984">ptrToThis</span>&nbsp;<span class="op" id="2535994">=</span>&nbsp;<span class="ident" id="2535996">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536001">ch</span><span class="op" id="2536003">.</span><span class="ident" id="2536004">zero</span>&nbsp;<span class="op" id="2536009">=</span>&nbsp;<span class="ident" id="2536011">unsafe</span><span class="op" id="2536017">.</span><span class="ident" id="2536018">Pointer</span><span class="op" id="2536025">(</span><span class="op" id="2536026">&amp;</span><span class="builtinfunc" id="2536027">make</span><span class="op" id="2536031">(</span><span class="op" id="2536032">[</span><span class="op" id="2536033">]</span><span class="builtintype" id="2536034">byte</span><span class="op" id="2536038">,</span>&nbsp;<span class="ident" id="2536040">ch</span><span class="op" id="2536042">.</span><span class="ident" id="2536043">size</span><span class="op" id="2536047">)</span><span class="op" id="2536048">[</span><span class="num" id="2536049">0</span><span class="op" id="2536050">]</span><span class="op" id="2536051">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536055">return</span>&nbsp;<span class="ident" id="2536062">cachePut</span><span class="op" id="2536070">(</span><span class="ident" id="2536071">ckey</span><span class="op" id="2536075">,</span>&nbsp;<span class="op" id="2536077">&amp;</span><span class="ident" id="2536078">ch</span><span class="op" id="2536080">.</span><span class="ident" id="2536081">rtype</span><span class="op" id="2536086">)</span><br>
<span class="lineno"></span><span class="op" id="2536088">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="keyword" id="2536091">func</span>&nbsp;<span class="ident" id="2536096">ismapkey</span><span class="op" id="2536104">(</span><span class="op" id="2536105">*</span><span class="ident" id="2536106">rtype</span><span class="op" id="2536111">)</span>&nbsp;<span class="builtintype" id="2536113">bool</span>&nbsp;<span class="comment" id="2536118">//&nbsp;implemented&nbsp;in&nbsp;runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2536145">//&nbsp;MapOf&nbsp;returns&nbsp;the&nbsp;map&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;key&nbsp;and&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2536213">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;k&nbsp;represents&nbsp;int&nbsp;and&nbsp;e&nbsp;represents&nbsp;string,</span><br>
<span class="lineno">1440</span><span class="comment" id="2536274">//&nbsp;MapOf(k,&nbsp;e)&nbsp;represents&nbsp;map[int]string.</span><br>
<span class="lineno"></span><span class="comment" id="2536316">//</span><br>
<span class="lineno"></span><span class="comment" id="2536319">//&nbsp;If&nbsp;the&nbsp;key&nbsp;type&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;map&nbsp;key&nbsp;type&nbsp;(that&nbsp;is,&nbsp;if&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2536387">//&nbsp;not&nbsp;implement&nbsp;Go&#39;s&nbsp;==&nbsp;operator),&nbsp;MapOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="keyword" id="2536437">func</span>&nbsp;<span class="ident" id="2536442">MapOf</span><span class="op" id="2536447">(</span><span class="ident" id="2536448">key</span><span class="op" id="2536451">,</span>&nbsp;<span class="ident" id="2536453">elem</span>&nbsp;<span class="ident" id="2536458">Type</span><span class="op" id="2536462">)</span>&nbsp;<span class="ident" id="2536464">Type</span>&nbsp;<span class="op" id="2536469">{</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536472">ktyp</span>&nbsp;<span class="op" id="2536477">:=</span>&nbsp;<span class="ident" id="2536480">key</span><span class="op" id="2536483">.</span><span class="op" id="2536484">(</span><span class="op" id="2536485">*</span><span class="ident" id="2536486">rtype</span><span class="op" id="2536491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536494">etyp</span>&nbsp;<span class="op" id="2536499">:=</span>&nbsp;<span class="ident" id="2536502">elem</span><span class="op" id="2536506">.</span><span class="op" id="2536507">(</span><span class="op" id="2536508">*</span><span class="ident" id="2536509">rtype</span><span class="op" id="2536514">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536518">if</span>&nbsp;<span class="op" id="2536521">!</span><span class="ident" id="2536522">ismapkey</span><span class="op" id="2536530">(</span><span class="ident" id="2536531">ktyp</span><span class="op" id="2536535">)</span>&nbsp;<span class="op" id="2536537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2536541">panic</span><span class="op" id="2536546">(</span><span class="string" id="2536547">&#34;reflect.MapOf:&nbsp;invalid&nbsp;key&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="2536582">+</span>&nbsp;<span class="ident" id="2536584">ktyp</span><span class="op" id="2536588">.</span><span class="ident" id="2536589">String</span><span class="op" id="2536595">(</span><span class="op" id="2536596">)</span><span class="op" id="2536597">)</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2536604">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536623">ckey</span>&nbsp;<span class="op" id="2536628">:=</span>&nbsp;<span class="ident" id="2536631">cacheKey</span><span class="op" id="2536639">{</span><span class="ident" id="2536640">Map</span><span class="op" id="2536643">,</span>&nbsp;<span class="ident" id="2536645">ktyp</span><span class="op" id="2536649">,</span>&nbsp;<span class="ident" id="2536651">etyp</span><span class="op" id="2536655">,</span>&nbsp;<span class="num" id="2536657">0</span><span class="op" id="2536658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536661">if</span>&nbsp;<span class="ident" id="2536664">mt</span>&nbsp;<span class="op" id="2536667">:=</span>&nbsp;<span class="ident" id="2536670">cacheGet</span><span class="op" id="2536678">(</span><span class="ident" id="2536679">ckey</span><span class="op" id="2536683">)</span><span class="op" id="2536684">;</span>&nbsp;<span class="ident" id="2536686">mt</span>&nbsp;<span class="op" id="2536689">!=</span>&nbsp;<span class="ident" id="2536692">nil</span>&nbsp;<span class="op" id="2536696">{</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536700">return</span>&nbsp;<span class="ident" id="2536707">mt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2536715">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536740">s</span>&nbsp;<span class="op" id="2536742">:=</span>&nbsp;<span class="string" id="2536745">&#34;map[&#34;</span>&nbsp;<span class="op" id="2536752">+</span>&nbsp;<span class="op" id="2536754">*</span><span class="ident" id="2536755">ktyp</span><span class="op" id="2536759">.</span><span class="builtintype" id="2536760">string</span>&nbsp;<span class="op" id="2536767">+</span>&nbsp;<span class="string" id="2536769">&#34;]&#34;</span>&nbsp;<span class="op" id="2536773">+</span>&nbsp;<span class="op" id="2536775">*</span><span class="ident" id="2536776">etyp</span><span class="op" id="2536780">.</span><span class="builtintype" id="2536781">string</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536789">for</span>&nbsp;<span class="ident" id="2536793">_</span><span class="op" id="2536794">,</span>&nbsp;<span class="ident" id="2536796">tt</span>&nbsp;<span class="op" id="2536799">:=</span>&nbsp;<span class="keyword" id="2536802">range</span>&nbsp;<span class="ident" id="2536808">typesByString</span><span class="op" id="2536821">(</span><span class="ident" id="2536822">s</span><span class="op" id="2536823">)</span>&nbsp;<span class="op" id="2536825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2536829">mt</span>&nbsp;<span class="op" id="2536832">:=</span>&nbsp;<span class="op" id="2536835">(</span><span class="op" id="2536836">*</span><span class="ident" id="2536837">mapType</span><span class="op" id="2536844">)</span><span class="op" id="2536845">(</span><span class="ident" id="2536846">unsafe</span><span class="op" id="2536852">.</span><span class="ident" id="2536853">Pointer</span><span class="op" id="2536860">(</span><span class="ident" id="2536861">tt</span><span class="op" id="2536863">)</span><span class="op" id="2536864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536868">if</span>&nbsp;<span class="ident" id="2536871">mt</span><span class="op" id="2536873">.</span><span class="ident" id="2536874">key</span>&nbsp;<span class="op" id="2536878">==</span>&nbsp;<span class="ident" id="2536881">ktyp</span>&nbsp;<span class="op" id="2536886">&amp;&amp;</span>&nbsp;<span class="ident" id="2536889">mt</span><span class="op" id="2536891">.</span><span class="ident" id="2536892">elem</span>&nbsp;<span class="op" id="2536897">==</span>&nbsp;<span class="ident" id="2536900">etyp</span>&nbsp;<span class="op" id="2536905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536910">return</span>&nbsp;<span class="ident" id="2536917">cachePut</span><span class="op" id="2536925">(</span><span class="ident" id="2536926">ckey</span><span class="op" id="2536930">,</span>&nbsp;<span class="ident" id="2536932">tt</span><span class="op" id="2536934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536938">}</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2536941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2536945">//&nbsp;Make&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2536966">var</span>&nbsp;<span class="ident" id="2536970">imap</span>&nbsp;<span class="keyword" id="2536975">interface</span><span class="op" id="2536984">{</span><span class="op" id="2536985">}</span>&nbsp;<span class="op" id="2536987">=</span>&nbsp;<span class="op" id="2536989">(</span><span class="keyword" id="2536990">map</span><span class="op" id="2536993">[</span><span class="ident" id="2536994">unsafe</span><span class="op" id="2537000">.</span><span class="ident" id="2537001">Pointer</span><span class="op" id="2537008">]</span><span class="ident" id="2537009">unsafe</span><span class="op" id="2537015">.</span><span class="ident" id="2537016">Pointer</span><span class="op" id="2537023">)</span><span class="op" id="2537024">(</span><span class="ident" id="2537025">nil</span><span class="op" id="2537028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537031">prototype</span>&nbsp;<span class="op" id="2537041">:=</span>&nbsp;<span class="op" id="2537044">*</span><span class="op" id="2537045">(</span><span class="op" id="2537046">*</span><span class="op" id="2537047">*</span><span class="ident" id="2537048">mapType</span><span class="op" id="2537055">)</span><span class="op" id="2537056">(</span><span class="ident" id="2537057">unsafe</span><span class="op" id="2537063">.</span><span class="ident" id="2537064">Pointer</span><span class="op" id="2537071">(</span><span class="op" id="2537072">&amp;</span><span class="ident" id="2537073">imap</span><span class="op" id="2537077">)</span><span class="op" id="2537078">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537081">mt</span>&nbsp;<span class="op" id="2537084">:=</span>&nbsp;<span class="builtinfunc" id="2537087">new</span><span class="op" id="2537090">(</span><span class="ident" id="2537091">mapType</span><span class="op" id="2537098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2537101">*</span><span class="ident" id="2537102">mt</span>&nbsp;<span class="op" id="2537105">=</span>&nbsp;<span class="op" id="2537107">*</span><span class="ident" id="2537108">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537119">mt</span><span class="op" id="2537121">.</span><span class="builtintype" id="2537122">string</span>&nbsp;<span class="op" id="2537129">=</span>&nbsp;<span class="op" id="2537131">&amp;</span><span class="ident" id="2537132">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537135">mt</span><span class="op" id="2537137">.</span><span class="ident" id="2537138">hash</span>&nbsp;<span class="op" id="2537143">=</span>&nbsp;<span class="ident" id="2537145">fnv1</span><span class="op" id="2537149">(</span><span class="ident" id="2537150">etyp</span><span class="op" id="2537154">.</span><span class="ident" id="2537155">hash</span><span class="op" id="2537159">,</span>&nbsp;<span class="string" id="2537161">&#39;m&#39;</span><span class="op" id="2537164">,</span>&nbsp;<span class="builtintype" id="2537166">byte</span><span class="op" id="2537170">(</span><span class="ident" id="2537171">ktyp</span><span class="op" id="2537175">.</span><span class="ident" id="2537176">hash</span><span class="op" id="2537180">&gt;&gt;</span><span class="num" id="2537182">24</span><span class="op" id="2537184">)</span><span class="op" id="2537185">,</span>&nbsp;<span class="builtintype" id="2537187">byte</span><span class="op" id="2537191">(</span><span class="ident" id="2537192">ktyp</span><span class="op" id="2537196">.</span><span class="ident" id="2537197">hash</span><span class="op" id="2537201">&gt;&gt;</span><span class="num" id="2537203">16</span><span class="op" id="2537205">)</span><span class="op" id="2537206">,</span>&nbsp;<span class="builtintype" id="2537208">byte</span><span class="op" id="2537212">(</span><span class="ident" id="2537213">ktyp</span><span class="op" id="2537217">.</span><span class="ident" id="2537218">hash</span><span class="op" id="2537222">&gt;&gt;</span><span class="num" id="2537224">8</span><span class="op" id="2537225">)</span><span class="op" id="2537226">,</span>&nbsp;<span class="builtintype" id="2537228">byte</span><span class="op" id="2537232">(</span><span class="ident" id="2537233">ktyp</span><span class="op" id="2537237">.</span><span class="ident" id="2537238">hash</span><span class="op" id="2537242">)</span><span class="op" id="2537243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537246">mt</span><span class="op" id="2537248">.</span><span class="ident" id="2537249">key</span>&nbsp;<span class="op" id="2537253">=</span>&nbsp;<span class="ident" id="2537255">ktyp</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537261">mt</span><span class="op" id="2537263">.</span><span class="ident" id="2537264">elem</span>&nbsp;<span class="op" id="2537269">=</span>&nbsp;<span class="ident" id="2537271">etyp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537277">mt</span><span class="op" id="2537279">.</span><span class="ident" id="2537280">bucket</span>&nbsp;<span class="op" id="2537287">=</span>&nbsp;<span class="ident" id="2537289">bucketOf</span><span class="op" id="2537297">(</span><span class="ident" id="2537298">ktyp</span><span class="op" id="2537302">,</span>&nbsp;<span class="ident" id="2537304">etyp</span><span class="op" id="2537308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2537311">if</span>&nbsp;<span class="ident" id="2537314">ktyp</span><span class="op" id="2537318">.</span><span class="ident" id="2537319">size</span>&nbsp;<span class="op" id="2537324">&gt;</span>&nbsp;<span class="ident" id="2537326">maxKeySize</span>&nbsp;<span class="op" id="2537337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537341">mt</span><span class="op" id="2537343">.</span><span class="ident" id="2537344">keysize</span>&nbsp;<span class="op" id="2537352">=</span>&nbsp;<span class="builtintype" id="2537354">uint8</span><span class="op" id="2537359">(</span><span class="ident" id="2537360">ptrSize</span><span class="op" id="2537367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537371">mt</span><span class="op" id="2537373">.</span><span class="ident" id="2537374">indirectkey</span>&nbsp;<span class="op" id="2537386">=</span>&nbsp;<span class="num" id="2537388">1</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2537391">}</span>&nbsp;<span class="keyword" id="2537393">else</span>&nbsp;<span class="op" id="2537398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537402">mt</span><span class="op" id="2537404">.</span><span class="ident" id="2537405">keysize</span>&nbsp;<span class="op" id="2537413">=</span>&nbsp;<span class="builtintype" id="2537415">uint8</span><span class="op" id="2537420">(</span><span class="ident" id="2537421">ktyp</span><span class="op" id="2537425">.</span><span class="ident" id="2537426">size</span><span class="op" id="2537430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537434">mt</span><span class="op" id="2537436">.</span><span class="ident" id="2537437">indirectkey</span>&nbsp;<span class="op" id="2537449">=</span>&nbsp;<span class="num" id="2537451">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2537454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2537457">if</span>&nbsp;<span class="ident" id="2537460">etyp</span><span class="op" id="2537464">.</span><span class="ident" id="2537465">size</span>&nbsp;<span class="op" id="2537470">&gt;</span>&nbsp;<span class="ident" id="2537472">maxValSize</span>&nbsp;<span class="op" id="2537483">{</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537487">mt</span><span class="op" id="2537489">.</span><span class="ident" id="2537490">valuesize</span>&nbsp;<span class="op" id="2537500">=</span>&nbsp;<span class="builtintype" id="2537502">uint8</span><span class="op" id="2537507">(</span><span class="ident" id="2537508">ptrSize</span><span class="op" id="2537515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537519">mt</span><span class="op" id="2537521">.</span><span class="ident" id="2537522">indirectvalue</span>&nbsp;<span class="op" id="2537536">=</span>&nbsp;<span class="num" id="2537538">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2537541">}</span>&nbsp;<span class="keyword" id="2537543">else</span>&nbsp;<span class="op" id="2537548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537552">mt</span><span class="op" id="2537554">.</span><span class="ident" id="2537555">valuesize</span>&nbsp;<span class="op" id="2537565">=</span>&nbsp;<span class="builtintype" id="2537567">uint8</span><span class="op" id="2537572">(</span><span class="ident" id="2537573">etyp</span><span class="op" id="2537577">.</span><span class="ident" id="2537578">size</span><span class="op" id="2537582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537586">mt</span><span class="op" id="2537588">.</span><span class="ident" id="2537589">indirectvalue</span>&nbsp;<span class="op" id="2537603">=</span>&nbsp;<span class="num" id="2537605">0</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2537608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537611">mt</span><span class="op" id="2537613">.</span><span class="ident" id="2537614">bucketsize</span>&nbsp;<span class="op" id="2537625">=</span>&nbsp;<span class="builtintype" id="2537627">uint16</span><span class="op" id="2537633">(</span><span class="ident" id="2537634">mt</span><span class="op" id="2537636">.</span><span class="ident" id="2537637">bucket</span><span class="op" id="2537643">.</span><span class="ident" id="2537644">size</span><span class="op" id="2537648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537651">mt</span><span class="op" id="2537653">.</span><span class="ident" id="2537654">uncommonType</span>&nbsp;<span class="op" id="2537667">=</span>&nbsp;<span class="ident" id="2537669">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537674">mt</span><span class="op" id="2537676">.</span><span class="ident" id="2537677">ptrToThis</span>&nbsp;<span class="op" id="2537687">=</span>&nbsp;<span class="ident" id="2537689">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537694">mt</span><span class="op" id="2537696">.</span><span class="ident" id="2537697">zero</span>&nbsp;<span class="op" id="2537702">=</span>&nbsp;<span class="ident" id="2537704">unsafe</span><span class="op" id="2537710">.</span><span class="ident" id="2537711">Pointer</span><span class="op" id="2537718">(</span><span class="op" id="2537719">&amp;</span><span class="builtinfunc" id="2537720">make</span><span class="op" id="2537724">(</span><span class="op" id="2537725">[</span><span class="op" id="2537726">]</span><span class="builtintype" id="2537727">byte</span><span class="op" id="2537731">,</span>&nbsp;<span class="ident" id="2537733">mt</span><span class="op" id="2537735">.</span><span class="ident" id="2537736">size</span><span class="op" id="2537740">)</span><span class="op" id="2537741">[</span><span class="num" id="2537742">0</span><span class="op" id="2537743">]</span><span class="op" id="2537744">)</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2537748">return</span>&nbsp;<span class="ident" id="2537755">cachePut</span><span class="op" id="2537763">(</span><span class="ident" id="2537764">ckey</span><span class="op" id="2537768">,</span>&nbsp;<span class="op" id="2537770">&amp;</span><span class="ident" id="2537771">mt</span><span class="op" id="2537773">.</span><span class="ident" id="2537774">rtype</span><span class="op" id="2537779">)</span><br>
<span class="lineno"></span><span class="op" id="2537781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2537784">//&nbsp;gcProg&nbsp;is&nbsp;a&nbsp;helper&nbsp;type&nbsp;for&nbsp;generatation&nbsp;of&nbsp;GC&nbsp;pointer&nbsp;info.</span><br>
<span class="lineno">1500</span><span class="keyword" id="2537848">type</span>&nbsp;<span class="ident" id="2537853">gcProg</span>&nbsp;<span class="keyword" id="2537860">struct</span>&nbsp;<span class="op" id="2537867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537870">gc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2537875">[</span><span class="op" id="2537876">]</span><span class="builtintype" id="2537877">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537883">size</span>&nbsp;<span class="builtintype" id="2537888">uintptr</span>&nbsp;<span class="comment" id="2537896">//&nbsp;size&nbsp;of&nbsp;type&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><span class="op" id="2537921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1505</span><span class="keyword" id="2537924">func</span>&nbsp;<span class="op" id="2537929">(</span><span class="ident" id="2537930">gc</span>&nbsp;<span class="op" id="2537933">*</span><span class="ident" id="2537934">gcProg</span><span class="op" id="2537940">)</span>&nbsp;<span class="builtinfunc" id="2537942">append</span><span class="op" id="2537948">(</span><span class="ident" id="2537949">v</span>&nbsp;<span class="builtintype" id="2537951">byte</span><span class="op" id="2537955">)</span>&nbsp;<span class="op" id="2537957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537960">gc</span><span class="op" id="2537962">.</span><span class="ident" id="2537963">align</span><span class="op" id="2537968">(</span><span class="ident" id="2537969">unsafe</span><span class="op" id="2537975">.</span><span class="ident" id="2537976">Sizeof</span><span class="op" id="2537982">(</span><span class="builtintype" id="2537983">uintptr</span><span class="op" id="2537990">(</span><span class="num" id="2537991">0</span><span class="op" id="2537992">)</span><span class="op" id="2537993">)</span><span class="op" id="2537994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2537997">gc</span><span class="op" id="2537999">.</span><span class="ident" id="2538000">appendWord</span><span class="op" id="2538010">(</span><span class="ident" id="2538011">v</span><span class="op" id="2538012">)</span><br>
<span class="lineno"></span><span class="op" id="2538014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1510</span><span class="comment" id="2538017">//&nbsp;Appends&nbsp;t&#39;s&nbsp;type&nbsp;info&nbsp;to&nbsp;the&nbsp;current&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2538066">func</span>&nbsp;<span class="op" id="2538071">(</span><span class="ident" id="2538072">gc</span>&nbsp;<span class="op" id="2538075">*</span><span class="ident" id="2538076">gcProg</span><span class="op" id="2538082">)</span>&nbsp;<span class="ident" id="2538084">appendProg</span><span class="op" id="2538094">(</span><span class="ident" id="2538095">t</span>&nbsp;<span class="op" id="2538097">*</span><span class="ident" id="2538098">rtype</span><span class="op" id="2538103">)</span>&nbsp;<span class="op" id="2538105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538108">gc</span><span class="op" id="2538110">.</span><span class="ident" id="2538111">align</span><span class="op" id="2538116">(</span><span class="builtintype" id="2538117">uintptr</span><span class="op" id="2538124">(</span><span class="ident" id="2538125">t</span><span class="op" id="2538126">.</span><span class="ident" id="2538127">align</span><span class="op" id="2538132">)</span><span class="op" id="2538133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538136">if</span>&nbsp;<span class="op" id="2538139">!</span><span class="ident" id="2538140">t</span><span class="op" id="2538141">.</span><span class="ident" id="2538142">pointers</span><span class="op" id="2538150">(</span><span class="op" id="2538151">)</span>&nbsp;<span class="op" id="2538153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538157">gc</span><span class="op" id="2538159">.</span><span class="ident" id="2538160">size</span>&nbsp;<span class="op" id="2538165">+=</span>&nbsp;<span class="ident" id="2538168">t</span><span class="op" id="2538169">.</span><span class="ident" id="2538170">size</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538177">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2538185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538188">switch</span>&nbsp;<span class="ident" id="2538195">t</span><span class="op" id="2538196">.</span><span class="ident" id="2538197">Kind</span><span class="op" id="2538201">(</span><span class="op" id="2538202">)</span>&nbsp;<span class="op" id="2538204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538207">default</span><span class="op" id="2538214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2538218">panic</span><span class="op" id="2538223">(</span><span class="string" id="2538224">&#34;reflect:&nbsp;non-pointer&nbsp;type&nbsp;marked&nbsp;as&nbsp;having&nbsp;pointers&#34;</span><span class="op" id="2538277">)</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538280">case</span>&nbsp;<span class="ident" id="2538285">Ptr</span><span class="op" id="2538288">,</span>&nbsp;<span class="ident" id="2538290">UnsafePointer</span><span class="op" id="2538303">,</span>&nbsp;<span class="ident" id="2538305">Chan</span><span class="op" id="2538309">,</span>&nbsp;<span class="ident" id="2538311">Func</span><span class="op" id="2538315">,</span>&nbsp;<span class="ident" id="2538317">Map</span><span class="op" id="2538320">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538324">gc</span><span class="op" id="2538326">.</span><span class="ident" id="2538327">appendWord</span><span class="op" id="2538337">(</span><span class="ident" id="2538338">bitsPointer</span><span class="op" id="2538349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538352">case</span>&nbsp;<span class="ident" id="2538357">Slice</span><span class="op" id="2538362">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538366">gc</span><span class="op" id="2538368">.</span><span class="ident" id="2538369">appendWord</span><span class="op" id="2538379">(</span><span class="ident" id="2538380">bitsPointer</span><span class="op" id="2538391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538395">gc</span><span class="op" id="2538397">.</span><span class="ident" id="2538398">appendWord</span><span class="op" id="2538408">(</span><span class="ident" id="2538409">bitsScalar</span><span class="op" id="2538419">)</span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538423">gc</span><span class="op" id="2538425">.</span><span class="ident" id="2538426">appendWord</span><span class="op" id="2538436">(</span><span class="ident" id="2538437">bitsScalar</span><span class="op" id="2538447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538450">case</span>&nbsp;<span class="ident" id="2538455">String</span><span class="op" id="2538461">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538465">gc</span><span class="op" id="2538467">.</span><span class="ident" id="2538468">appendWord</span><span class="op" id="2538478">(</span><span class="ident" id="2538479">bitsPointer</span><span class="op" id="2538490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538494">gc</span><span class="op" id="2538496">.</span><span class="ident" id="2538497">appendWord</span><span class="op" id="2538507">(</span><span class="ident" id="2538508">bitsScalar</span><span class="op" id="2538518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538521">case</span>&nbsp;<span class="ident" id="2538526">Array</span><span class="op" id="2538531">:</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538535">c</span>&nbsp;<span class="op" id="2538537">:=</span>&nbsp;<span class="ident" id="2538540">t</span><span class="op" id="2538541">.</span><span class="ident" id="2538542">Len</span><span class="op" id="2538545">(</span><span class="op" id="2538546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538550">e</span>&nbsp;<span class="op" id="2538552">:=</span>&nbsp;<span class="ident" id="2538555">t</span><span class="op" id="2538556">.</span><span class="ident" id="2538557">Elem</span><span class="op" id="2538561">(</span><span class="op" id="2538562">)</span><span class="op" id="2538563">.</span><span class="ident" id="2538564">common</span><span class="op" id="2538570">(</span><span class="op" id="2538571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538575">for</span>&nbsp;<span class="ident" id="2538579">i</span>&nbsp;<span class="op" id="2538581">:=</span>&nbsp;<span class="num" id="2538584">0</span><span class="op" id="2538585">;</span>&nbsp;<span class="ident" id="2538587">i</span>&nbsp;<span class="op" id="2538589">&lt;</span>&nbsp;<span class="ident" id="2538591">c</span><span class="op" id="2538592">;</span>&nbsp;<span class="ident" id="2538594">i</span><span class="op" id="2538595">++</span>&nbsp;<span class="op" id="2538598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538603">gc</span><span class="op" id="2538605">.</span><span class="ident" id="2538606">appendProg</span><span class="op" id="2538616">(</span><span class="ident" id="2538617">e</span><span class="op" id="2538618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2538622">}</span><br>
<span class="lineno">1535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538625">case</span>&nbsp;<span class="ident" id="2538630">Interface</span><span class="op" id="2538639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538643">gc</span><span class="op" id="2538645">.</span><span class="ident" id="2538646">appendWord</span><span class="op" id="2538656">(</span><span class="ident" id="2538657">bitsMultiWord</span><span class="op" id="2538670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538674">if</span>&nbsp;<span class="ident" id="2538677">t</span><span class="op" id="2538678">.</span><span class="ident" id="2538679">NumMethod</span><span class="op" id="2538688">(</span><span class="op" id="2538689">)</span>&nbsp;<span class="op" id="2538691">==</span>&nbsp;<span class="num" id="2538694">0</span>&nbsp;<span class="op" id="2538696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538701">gc</span><span class="op" id="2538703">.</span><span class="ident" id="2538704">appendWord</span><span class="op" id="2538714">(</span><span class="ident" id="2538715">bitsEface</span><span class="op" id="2538724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2538728">}</span>&nbsp;<span class="keyword" id="2538730">else</span>&nbsp;<span class="op" id="2538735">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538740">gc</span><span class="op" id="2538742">.</span><span class="ident" id="2538743">appendWord</span><span class="op" id="2538753">(</span><span class="ident" id="2538754">bitsIface</span><span class="op" id="2538763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2538767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538770">case</span>&nbsp;<span class="ident" id="2538775">Struct</span><span class="op" id="2538781">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538785">c</span>&nbsp;<span class="op" id="2538787">:=</span>&nbsp;<span class="ident" id="2538790">t</span><span class="op" id="2538791">.</span><span class="ident" id="2538792">NumField</span><span class="op" id="2538800">(</span><span class="op" id="2538801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538805">for</span>&nbsp;<span class="ident" id="2538809">i</span>&nbsp;<span class="op" id="2538811">:=</span>&nbsp;<span class="num" id="2538814">0</span><span class="op" id="2538815">;</span>&nbsp;<span class="ident" id="2538817">i</span>&nbsp;<span class="op" id="2538819">&lt;</span>&nbsp;<span class="ident" id="2538821">c</span><span class="op" id="2538822">;</span>&nbsp;<span class="ident" id="2538824">i</span><span class="op" id="2538825">++</span>&nbsp;<span class="op" id="2538828">{</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538833">gc</span><span class="op" id="2538835">.</span><span class="ident" id="2538836">appendProg</span><span class="op" id="2538846">(</span><span class="ident" id="2538847">t</span><span class="op" id="2538848">.</span><span class="ident" id="2538849">Field</span><span class="op" id="2538854">(</span><span class="ident" id="2538855">i</span><span class="op" id="2538856">)</span><span class="op" id="2538857">.</span><span class="ident" id="2538858">Type</span><span class="op" id="2538862">.</span><span class="ident" id="2538863">common</span><span class="op" id="2538869">(</span><span class="op" id="2538870">)</span><span class="op" id="2538871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2538875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538879">gc</span><span class="op" id="2538881">.</span><span class="ident" id="2538882">align</span><span class="op" id="2538887">(</span><span class="builtintype" id="2538888">uintptr</span><span class="op" id="2538895">(</span><span class="ident" id="2538896">t</span><span class="op" id="2538897">.</span><span class="ident" id="2538898">align</span><span class="op" id="2538903">)</span><span class="op" id="2538904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2538907">}</span><br>
<span class="lineno"></span><span class="op" id="2538909">}</span><br>
<span class="lineno">1550</span><br>
<span class="lineno"></span><span class="keyword" id="2538912">func</span>&nbsp;<span class="op" id="2538917">(</span><span class="ident" id="2538918">gc</span>&nbsp;<span class="op" id="2538921">*</span><span class="ident" id="2538922">gcProg</span><span class="op" id="2538928">)</span>&nbsp;<span class="ident" id="2538930">appendWord</span><span class="op" id="2538940">(</span><span class="ident" id="2538941">v</span>&nbsp;<span class="builtintype" id="2538943">byte</span><span class="op" id="2538947">)</span>&nbsp;<span class="op" id="2538949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2538952">ptrsize</span>&nbsp;<span class="op" id="2538960">:=</span>&nbsp;<span class="ident" id="2538963">unsafe</span><span class="op" id="2538969">.</span><span class="ident" id="2538970">Sizeof</span><span class="op" id="2538976">(</span><span class="builtintype" id="2538977">uintptr</span><span class="op" id="2538984">(</span><span class="num" id="2538985">0</span><span class="op" id="2538986">)</span><span class="op" id="2538987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2538990">if</span>&nbsp;<span class="ident" id="2538993">gc</span><span class="op" id="2538995">.</span><span class="ident" id="2538996">size</span><span class="op" id="2539000">%</span><span class="ident" id="2539001">ptrsize</span>&nbsp;<span class="op" id="2539009">!=</span>&nbsp;<span class="num" id="2539012">0</span>&nbsp;<span class="op" id="2539014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2539018">panic</span><span class="op" id="2539023">(</span><span class="string" id="2539024">&#34;reflect:&nbsp;unaligned&nbsp;GC&nbsp;program&#34;</span><span class="op" id="2539055">)</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2539058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539061">nptr</span>&nbsp;<span class="op" id="2539066">:=</span>&nbsp;<span class="ident" id="2539069">gc</span><span class="op" id="2539071">.</span><span class="ident" id="2539072">size</span>&nbsp;<span class="op" id="2539077">/</span>&nbsp;<span class="ident" id="2539079">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539088">for</span>&nbsp;<span class="builtintype" id="2539092">uintptr</span><span class="op" id="2539099">(</span><span class="builtinfunc" id="2539100">len</span><span class="op" id="2539103">(</span><span class="ident" id="2539104">gc</span><span class="op" id="2539106">.</span><span class="ident" id="2539107">gc</span><span class="op" id="2539109">)</span><span class="op" id="2539110">)</span>&nbsp;<span class="op" id="2539112">&lt;</span>&nbsp;<span class="ident" id="2539114">nptr</span><span class="op" id="2539118">/</span><span class="num" id="2539119">2</span><span class="op" id="2539120">+</span><span class="num" id="2539121">1</span>&nbsp;<span class="op" id="2539123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539127">gc</span><span class="op" id="2539129">.</span><span class="ident" id="2539130">gc</span>&nbsp;<span class="op" id="2539133">=</span>&nbsp;<span class="builtinfunc" id="2539135">append</span><span class="op" id="2539141">(</span><span class="ident" id="2539142">gc</span><span class="op" id="2539144">.</span><span class="ident" id="2539145">gc</span><span class="op" id="2539147">,</span>&nbsp;<span class="num" id="2539149">0x44</span><span class="op" id="2539153">)</span>&nbsp;<span class="comment" id="2539155">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2539170">}</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539173">gc</span><span class="op" id="2539175">.</span><span class="ident" id="2539176">gc</span><span class="op" id="2539178">[</span><span class="ident" id="2539179">nptr</span><span class="op" id="2539183">/</span><span class="num" id="2539184">2</span><span class="op" id="2539185">]</span>&nbsp;<span class="op" id="2539187">&amp;=</span>&nbsp;<span class="op" id="2539190">^</span><span class="op" id="2539191">(</span><span class="num" id="2539192">3</span>&nbsp;<span class="op" id="2539194">&lt;&lt;</span>&nbsp;<span class="op" id="2539197">(</span><span class="op" id="2539198">(</span><span class="ident" id="2539199">nptr</span><span class="op" id="2539203">%</span><span class="num" id="2539204">2</span><span class="op" id="2539205">)</span><span class="op" id="2539206">*</span><span class="num" id="2539207">4</span>&nbsp;<span class="op" id="2539209">+</span>&nbsp;<span class="num" id="2539211">2</span><span class="op" id="2539212">)</span><span class="op" id="2539213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539216">gc</span><span class="op" id="2539218">.</span><span class="ident" id="2539219">gc</span><span class="op" id="2539221">[</span><span class="ident" id="2539222">nptr</span><span class="op" id="2539226">/</span><span class="num" id="2539227">2</span><span class="op" id="2539228">]</span>&nbsp;<span class="op" id="2539230">|=</span>&nbsp;<span class="ident" id="2539233">v</span>&nbsp;<span class="op" id="2539235">&lt;&lt;</span>&nbsp;<span class="op" id="2539238">(</span><span class="op" id="2539239">(</span><span class="ident" id="2539240">nptr</span><span class="op" id="2539244">%</span><span class="num" id="2539245">2</span><span class="op" id="2539246">)</span><span class="op" id="2539247">*</span><span class="num" id="2539248">4</span>&nbsp;<span class="op" id="2539250">+</span>&nbsp;<span class="num" id="2539252">2</span><span class="op" id="2539253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539256">gc</span><span class="op" id="2539258">.</span><span class="ident" id="2539259">size</span>&nbsp;<span class="op" id="2539264">+=</span>&nbsp;<span class="ident" id="2539267">ptrsize</span><br>
<span class="lineno"></span><span class="op" id="2539275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="keyword" id="2539278">func</span>&nbsp;<span class="op" id="2539283">(</span><span class="ident" id="2539284">gc</span>&nbsp;<span class="op" id="2539287">*</span><span class="ident" id="2539288">gcProg</span><span class="op" id="2539294">)</span>&nbsp;<span class="ident" id="2539296">finalize</span><span class="op" id="2539304">(</span><span class="op" id="2539305">)</span>&nbsp;<span class="ident" id="2539307">unsafe</span><span class="op" id="2539313">.</span><span class="ident" id="2539314">Pointer</span>&nbsp;<span class="op" id="2539322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539325">if</span>&nbsp;<span class="ident" id="2539328">gc</span><span class="op" id="2539330">.</span><span class="ident" id="2539331">size</span>&nbsp;<span class="op" id="2539336">==</span>&nbsp;<span class="num" id="2539339">0</span>&nbsp;<span class="op" id="2539341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539345">return</span>&nbsp;<span class="ident" id="2539352">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2539357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539360">ptrsize</span>&nbsp;<span class="op" id="2539368">:=</span>&nbsp;<span class="ident" id="2539371">unsafe</span><span class="op" id="2539377">.</span><span class="ident" id="2539378">Sizeof</span><span class="op" id="2539384">(</span><span class="builtintype" id="2539385">uintptr</span><span class="op" id="2539392">(</span><span class="num" id="2539393">0</span><span class="op" id="2539394">)</span><span class="op" id="2539395">)</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539398">gc</span><span class="op" id="2539400">.</span><span class="ident" id="2539401">align</span><span class="op" id="2539406">(</span><span class="ident" id="2539407">ptrsize</span><span class="op" id="2539414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539417">nptr</span>&nbsp;<span class="op" id="2539422">:=</span>&nbsp;<span class="ident" id="2539425">gc</span><span class="op" id="2539427">.</span><span class="ident" id="2539428">size</span>&nbsp;<span class="op" id="2539433">/</span>&nbsp;<span class="ident" id="2539435">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539444">for</span>&nbsp;<span class="builtintype" id="2539448">uintptr</span><span class="op" id="2539455">(</span><span class="builtinfunc" id="2539456">len</span><span class="op" id="2539459">(</span><span class="ident" id="2539460">gc</span><span class="op" id="2539462">.</span><span class="ident" id="2539463">gc</span><span class="op" id="2539465">)</span><span class="op" id="2539466">)</span>&nbsp;<span class="op" id="2539468">&lt;</span>&nbsp;<span class="ident" id="2539470">nptr</span><span class="op" id="2539474">/</span><span class="num" id="2539475">2</span><span class="op" id="2539476">+</span><span class="num" id="2539477">1</span>&nbsp;<span class="op" id="2539479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539483">gc</span><span class="op" id="2539485">.</span><span class="ident" id="2539486">gc</span>&nbsp;<span class="op" id="2539489">=</span>&nbsp;<span class="builtinfunc" id="2539491">append</span><span class="op" id="2539497">(</span><span class="ident" id="2539498">gc</span><span class="op" id="2539500">.</span><span class="ident" id="2539501">gc</span><span class="op" id="2539503">,</span>&nbsp;<span class="num" id="2539505">0x44</span><span class="op" id="2539509">)</span>&nbsp;<span class="comment" id="2539511">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2539526">}</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2539529">//&nbsp;If&nbsp;number&nbsp;of&nbsp;words&nbsp;is&nbsp;odd,&nbsp;repeat&nbsp;the&nbsp;mask&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2539583">//&nbsp;Compiler&nbsp;does&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539611">if</span>&nbsp;<span class="ident" id="2539614">nptr</span><span class="op" id="2539618">%</span><span class="num" id="2539619">2</span>&nbsp;<span class="op" id="2539621">!=</span>&nbsp;<span class="num" id="2539624">0</span>&nbsp;<span class="op" id="2539626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539630">for</span>&nbsp;<span class="ident" id="2539634">i</span>&nbsp;<span class="op" id="2539636">:=</span>&nbsp;<span class="builtintype" id="2539639">uintptr</span><span class="op" id="2539646">(</span><span class="num" id="2539647">0</span><span class="op" id="2539648">)</span><span class="op" id="2539649">;</span>&nbsp;<span class="ident" id="2539651">i</span>&nbsp;<span class="op" id="2539653">&lt;</span>&nbsp;<span class="ident" id="2539655">nptr</span><span class="op" id="2539659">;</span>&nbsp;<span class="ident" id="2539661">i</span><span class="op" id="2539662">++</span>&nbsp;<span class="op" id="2539665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539670">gc</span><span class="op" id="2539672">.</span><span class="ident" id="2539673">appendWord</span><span class="op" id="2539683">(</span><span class="ident" id="2539684">extractGCWord</span><span class="op" id="2539697">(</span><span class="ident" id="2539698">gc</span><span class="op" id="2539700">.</span><span class="ident" id="2539701">gc</span><span class="op" id="2539703">,</span>&nbsp;<span class="ident" id="2539705">i</span><span class="op" id="2539706">)</span><span class="op" id="2539707">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2539711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2539714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539717">return</span>&nbsp;<span class="ident" id="2539724">unsafe</span><span class="op" id="2539730">.</span><span class="ident" id="2539731">Pointer</span><span class="op" id="2539738">(</span><span class="op" id="2539739">&amp;</span><span class="ident" id="2539740">gc</span><span class="op" id="2539742">.</span><span class="ident" id="2539743">gc</span><span class="op" id="2539745">[</span><span class="num" id="2539746">0</span><span class="op" id="2539747">]</span><span class="op" id="2539748">)</span><br>
<span class="lineno"></span><span class="op" id="2539750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span><span class="keyword" id="2539753">func</span>&nbsp;<span class="ident" id="2539758">extractGCWord</span><span class="op" id="2539771">(</span><span class="ident" id="2539772">gc</span>&nbsp;<span class="op" id="2539775">[</span><span class="op" id="2539776">]</span><span class="builtintype" id="2539777">byte</span><span class="op" id="2539781">,</span>&nbsp;<span class="ident" id="2539783">i</span>&nbsp;<span class="builtintype" id="2539785">uintptr</span><span class="op" id="2539792">)</span>&nbsp;<span class="builtintype" id="2539794">byte</span>&nbsp;<span class="op" id="2539799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2539802">return</span>&nbsp;<span class="op" id="2539809">(</span><span class="ident" id="2539810">gc</span><span class="op" id="2539812">[</span><span class="ident" id="2539813">i</span><span class="op" id="2539814">/</span><span class="num" id="2539815">2</span><span class="op" id="2539816">]</span>&nbsp;<span class="op" id="2539818">&gt;&gt;</span>&nbsp;<span class="op" id="2539821">(</span><span class="op" id="2539822">(</span><span class="ident" id="2539823">i</span><span class="op" id="2539824">%</span><span class="num" id="2539825">2</span><span class="op" id="2539826">)</span><span class="op" id="2539827">*</span><span class="num" id="2539828">4</span>&nbsp;<span class="op" id="2539830">+</span>&nbsp;<span class="num" id="2539832">2</span><span class="op" id="2539833">)</span><span class="op" id="2539834">)</span>&nbsp;<span class="op" id="2539836">&amp;</span>&nbsp;<span class="num" id="2539838">3</span><br>
<span class="lineno"></span><span class="op" id="2539840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2539843">func</span>&nbsp;<span class="op" id="2539848">(</span><span class="ident" id="2539849">gc</span>&nbsp;<span class="op" id="2539852">*</span><span class="ident" id="2539853">gcProg</span><span class="op" id="2539859">)</span>&nbsp;<span class="ident" id="2539861">align</span><span class="op" id="2539866">(</span><span class="ident" id="2539867">a</span>&nbsp;<span class="builtintype" id="2539869">uintptr</span><span class="op" id="2539876">)</span>&nbsp;<span class="op" id="2539878">{</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539881">gc</span><span class="op" id="2539883">.</span><span class="ident" id="2539884">size</span>&nbsp;<span class="op" id="2539889">=</span>&nbsp;<span class="ident" id="2539891">align</span><span class="op" id="2539896">(</span><span class="ident" id="2539897">gc</span><span class="op" id="2539899">.</span><span class="ident" id="2539900">size</span><span class="op" id="2539904">,</span>&nbsp;<span class="ident" id="2539906">a</span><span class="op" id="2539907">)</span><br>
<span class="lineno"></span><span class="op" id="2539909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2539912">//&nbsp;These&nbsp;constants&nbsp;must&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/mgc0.h.</span><br>
<span class="lineno"></span><span class="keyword" id="2539973">const</span>&nbsp;<span class="op" id="2539979">(</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2539982">bitsScalar</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2539996">=</span>&nbsp;<span class="num" id="2539998">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540001">bitsPointer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2540015">=</span>&nbsp;<span class="num" id="2540017">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540020">bitsMultiWord</span>&nbsp;<span class="op" id="2540034">=</span>&nbsp;<span class="num" id="2540036">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540040">bitsIface</span>&nbsp;<span class="op" id="2540050">=</span>&nbsp;<span class="num" id="2540052">2</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540055">bitsEface</span>&nbsp;<span class="op" id="2540065">=</span>&nbsp;<span class="num" id="2540067">3</span><br>
<span class="lineno"></span><span class="op" id="2540069">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2540072">//&nbsp;Make&nbsp;sure&nbsp;these&nbsp;routines&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../../runtime/hashmap.go!</span><br>
<span class="lineno"></span><span class="comment" id="2540144">//&nbsp;These&nbsp;types&nbsp;exist&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno">1605</span><span class="comment" id="2540216">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2540291">//&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2540322">const</span>&nbsp;<span class="op" id="2540328">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540331">bucketSize</span>&nbsp;<span class="op" id="2540342">=</span>&nbsp;<span class="num" id="2540344">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540347">maxKeySize</span>&nbsp;<span class="op" id="2540358">=</span>&nbsp;<span class="num" id="2540360">128</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540365">maxValSize</span>&nbsp;<span class="op" id="2540376">=</span>&nbsp;<span class="num" id="2540378">128</span><br>
<span class="lineno"></span><span class="op" id="2540382">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2540385">func</span>&nbsp;<span class="ident" id="2540390">bucketOf</span><span class="op" id="2540398">(</span><span class="ident" id="2540399">ktyp</span><span class="op" id="2540403">,</span>&nbsp;<span class="ident" id="2540405">etyp</span>&nbsp;<span class="op" id="2540410">*</span><span class="ident" id="2540411">rtype</span><span class="op" id="2540416">)</span>&nbsp;<span class="op" id="2540418">*</span><span class="ident" id="2540419">rtype</span>&nbsp;<span class="op" id="2540425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540428">if</span>&nbsp;<span class="ident" id="2540431">ktyp</span><span class="op" id="2540435">.</span><span class="ident" id="2540436">size</span>&nbsp;<span class="op" id="2540441">&gt;</span>&nbsp;<span class="ident" id="2540443">maxKeySize</span>&nbsp;<span class="op" id="2540454">{</span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540458">ktyp</span>&nbsp;<span class="op" id="2540463">=</span>&nbsp;<span class="ident" id="2540465">PtrTo</span><span class="op" id="2540470">(</span><span class="ident" id="2540471">ktyp</span><span class="op" id="2540475">)</span><span class="op" id="2540476">.</span><span class="op" id="2540477">(</span><span class="op" id="2540478">*</span><span class="ident" id="2540479">rtype</span><span class="op" id="2540484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2540487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540490">if</span>&nbsp;<span class="ident" id="2540493">etyp</span><span class="op" id="2540497">.</span><span class="ident" id="2540498">size</span>&nbsp;<span class="op" id="2540503">&gt;</span>&nbsp;<span class="ident" id="2540505">maxValSize</span>&nbsp;<span class="op" id="2540516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540520">etyp</span>&nbsp;<span class="op" id="2540525">=</span>&nbsp;<span class="ident" id="2540527">PtrTo</span><span class="op" id="2540532">(</span><span class="ident" id="2540533">etyp</span><span class="op" id="2540537">)</span><span class="op" id="2540538">.</span><span class="op" id="2540539">(</span><span class="op" id="2540540">*</span><span class="ident" id="2540541">rtype</span><span class="op" id="2540546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2540549">}</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540552">ptrsize</span>&nbsp;<span class="op" id="2540560">:=</span>&nbsp;<span class="ident" id="2540563">unsafe</span><span class="op" id="2540569">.</span><span class="ident" id="2540570">Sizeof</span><span class="op" id="2540576">(</span><span class="builtintype" id="2540577">uintptr</span><span class="op" id="2540584">(</span><span class="num" id="2540585">0</span><span class="op" id="2540586">)</span><span class="op" id="2540587">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540591">var</span>&nbsp;<span class="ident" id="2540595">gc</span>&nbsp;<span class="ident" id="2540598">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2540606">//&nbsp;topbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540618">for</span>&nbsp;<span class="ident" id="2540622">i</span>&nbsp;<span class="op" id="2540624">:=</span>&nbsp;<span class="num" id="2540627">0</span><span class="op" id="2540628">;</span>&nbsp;<span class="ident" id="2540630">i</span>&nbsp;<span class="op" id="2540632">&lt;</span>&nbsp;<span class="builtintype" id="2540634">int</span><span class="op" id="2540637">(</span><span class="ident" id="2540638">bucketSize</span><span class="op" id="2540648">*</span><span class="ident" id="2540649">unsafe</span><span class="op" id="2540655">.</span><span class="ident" id="2540656">Sizeof</span><span class="op" id="2540662">(</span><span class="builtintype" id="2540663">uint8</span><span class="op" id="2540668">(</span><span class="num" id="2540669">0</span><span class="op" id="2540670">)</span><span class="op" id="2540671">)</span><span class="op" id="2540672">/</span><span class="ident" id="2540673">ptrsize</span><span class="op" id="2540680">)</span><span class="op" id="2540681">;</span>&nbsp;<span class="ident" id="2540683">i</span><span class="op" id="2540684">++</span>&nbsp;<span class="op" id="2540687">{</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540691">gc</span><span class="op" id="2540693">.</span><span class="builtinfunc" id="2540694">append</span><span class="op" id="2540700">(</span><span class="ident" id="2540701">bitsScalar</span><span class="op" id="2540711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2540714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540717">gc</span><span class="op" id="2540719">.</span><span class="builtinfunc" id="2540720">append</span><span class="op" id="2540726">(</span><span class="ident" id="2540727">bitsPointer</span><span class="op" id="2540738">)</span>&nbsp;<span class="comment" id="2540740">//&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540753">if</span>&nbsp;<span class="ident" id="2540756">runtime</span><span class="op" id="2540763">.</span><span class="ident" id="2540764">GOARCH</span>&nbsp;<span class="op" id="2540771">==</span>&nbsp;<span class="string" id="2540774">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2540785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540789">gc</span><span class="op" id="2540791">.</span><span class="builtinfunc" id="2540792">append</span><span class="op" id="2540798">(</span><span class="ident" id="2540799">bitsScalar</span><span class="op" id="2540809">)</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2540812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2540815">//&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540824">for</span>&nbsp;<span class="ident" id="2540828">i</span>&nbsp;<span class="op" id="2540830">:=</span>&nbsp;<span class="num" id="2540833">0</span><span class="op" id="2540834">;</span>&nbsp;<span class="ident" id="2540836">i</span>&nbsp;<span class="op" id="2540838">&lt;</span>&nbsp;<span class="ident" id="2540840">bucketSize</span><span class="op" id="2540850">;</span>&nbsp;<span class="ident" id="2540852">i</span><span class="op" id="2540853">++</span>&nbsp;<span class="op" id="2540856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540860">gc</span><span class="op" id="2540862">.</span><span class="ident" id="2540863">appendProg</span><span class="op" id="2540873">(</span><span class="ident" id="2540874">ktyp</span><span class="op" id="2540878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2540881">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2540884">//&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2540895">for</span>&nbsp;<span class="ident" id="2540899">i</span>&nbsp;<span class="op" id="2540901">:=</span>&nbsp;<span class="num" id="2540904">0</span><span class="op" id="2540905">;</span>&nbsp;<span class="ident" id="2540907">i</span>&nbsp;<span class="op" id="2540909">&lt;</span>&nbsp;<span class="ident" id="2540911">bucketSize</span><span class="op" id="2540921">;</span>&nbsp;<span class="ident" id="2540923">i</span><span class="op" id="2540924">++</span>&nbsp;<span class="op" id="2540927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540931">gc</span><span class="op" id="2540933">.</span><span class="ident" id="2540934">appendProg</span><span class="op" id="2540944">(</span><span class="ident" id="2540945">etyp</span><span class="op" id="2540949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2540952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540956">b</span>&nbsp;<span class="op" id="2540958">:=</span>&nbsp;<span class="builtinfunc" id="2540961">new</span><span class="op" id="2540964">(</span><span class="ident" id="2540965">rtype</span><span class="op" id="2540970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540973">b</span><span class="op" id="2540974">.</span><span class="ident" id="2540975">size</span>&nbsp;<span class="op" id="2540980">=</span>&nbsp;<span class="ident" id="2540982">gc</span><span class="op" id="2540984">.</span><span class="ident" id="2540985">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2540991">b</span><span class="op" id="2540992">.</span><span class="ident" id="2540993">gc</span><span class="op" id="2540995">[</span><span class="num" id="2540996">0</span><span class="op" id="2540997">]</span>&nbsp;<span class="op" id="2540999">=</span>&nbsp;<span class="ident" id="2541001">gc</span><span class="op" id="2541003">.</span><span class="ident" id="2541004">finalize</span><span class="op" id="2541012">(</span><span class="op" id="2541013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541016">s</span>&nbsp;<span class="op" id="2541018">:=</span>&nbsp;<span class="string" id="2541021">&#34;bucket(&#34;</span>&nbsp;<span class="op" id="2541031">+</span>&nbsp;<span class="op" id="2541033">*</span><span class="ident" id="2541034">ktyp</span><span class="op" id="2541038">.</span><span class="builtintype" id="2541039">string</span>&nbsp;<span class="op" id="2541046">+</span>&nbsp;<span class="string" id="2541048">&#34;,&#34;</span>&nbsp;<span class="op" id="2541052">+</span>&nbsp;<span class="op" id="2541054">*</span><span class="ident" id="2541055">etyp</span><span class="op" id="2541059">.</span><span class="builtintype" id="2541060">string</span>&nbsp;<span class="op" id="2541067">+</span>&nbsp;<span class="string" id="2541069">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541074">b</span><span class="op" id="2541075">.</span><span class="builtintype" id="2541076">string</span>&nbsp;<span class="op" id="2541083">=</span>&nbsp;<span class="op" id="2541085">&amp;</span><span class="ident" id="2541086">s</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541089">return</span>&nbsp;<span class="ident" id="2541096">b</span><br>
<span class="lineno"></span><span class="op" id="2541098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2541101">//&nbsp;SliceOf&nbsp;returns&nbsp;the&nbsp;slice&nbsp;type&nbsp;with&nbsp;element&nbsp;type&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2541156">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;SliceOf(t)&nbsp;represents&nbsp;[]int.</span><br>
<span class="lineno">1650</span><span class="keyword" id="2541222">func</span>&nbsp;<span class="ident" id="2541227">SliceOf</span><span class="op" id="2541234">(</span><span class="ident" id="2541235">t</span>&nbsp;<span class="ident" id="2541237">Type</span><span class="op" id="2541241">)</span>&nbsp;<span class="ident" id="2541243">Type</span>&nbsp;<span class="op" id="2541248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541251">typ</span>&nbsp;<span class="op" id="2541255">:=</span>&nbsp;<span class="ident" id="2541258">t</span><span class="op" id="2541259">.</span><span class="op" id="2541260">(</span><span class="op" id="2541261">*</span><span class="ident" id="2541262">rtype</span><span class="op" id="2541267">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2541271">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541290">ckey</span>&nbsp;<span class="op" id="2541295">:=</span>&nbsp;<span class="ident" id="2541298">cacheKey</span><span class="op" id="2541306">{</span><span class="ident" id="2541307">Slice</span><span class="op" id="2541312">,</span>&nbsp;<span class="ident" id="2541314">typ</span><span class="op" id="2541317">,</span>&nbsp;<span class="ident" id="2541319">nil</span><span class="op" id="2541322">,</span>&nbsp;<span class="num" id="2541324">0</span><span class="op" id="2541325">}</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541328">if</span>&nbsp;<span class="ident" id="2541331">slice</span>&nbsp;<span class="op" id="2541337">:=</span>&nbsp;<span class="ident" id="2541340">cacheGet</span><span class="op" id="2541348">(</span><span class="ident" id="2541349">ckey</span><span class="op" id="2541353">)</span><span class="op" id="2541354">;</span>&nbsp;<span class="ident" id="2541356">slice</span>&nbsp;<span class="op" id="2541362">!=</span>&nbsp;<span class="ident" id="2541365">nil</span>&nbsp;<span class="op" id="2541369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541373">return</span>&nbsp;<span class="ident" id="2541380">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2541387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2541391">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541416">s</span>&nbsp;<span class="op" id="2541418">:=</span>&nbsp;<span class="string" id="2541421">&#34;[]&#34;</span>&nbsp;<span class="op" id="2541426">+</span>&nbsp;<span class="op" id="2541428">*</span><span class="ident" id="2541429">typ</span><span class="op" id="2541432">.</span><span class="builtintype" id="2541433">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541441">for</span>&nbsp;<span class="ident" id="2541445">_</span><span class="op" id="2541446">,</span>&nbsp;<span class="ident" id="2541448">tt</span>&nbsp;<span class="op" id="2541451">:=</span>&nbsp;<span class="keyword" id="2541454">range</span>&nbsp;<span class="ident" id="2541460">typesByString</span><span class="op" id="2541473">(</span><span class="ident" id="2541474">s</span><span class="op" id="2541475">)</span>&nbsp;<span class="op" id="2541477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541481">slice</span>&nbsp;<span class="op" id="2541487">:=</span>&nbsp;<span class="op" id="2541490">(</span><span class="op" id="2541491">*</span><span class="ident" id="2541492">sliceType</span><span class="op" id="2541501">)</span><span class="op" id="2541502">(</span><span class="ident" id="2541503">unsafe</span><span class="op" id="2541509">.</span><span class="ident" id="2541510">Pointer</span><span class="op" id="2541517">(</span><span class="ident" id="2541518">tt</span><span class="op" id="2541520">)</span><span class="op" id="2541521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541525">if</span>&nbsp;<span class="ident" id="2541528">slice</span><span class="op" id="2541533">.</span><span class="ident" id="2541534">elem</span>&nbsp;<span class="op" id="2541539">==</span>&nbsp;<span class="ident" id="2541542">typ</span>&nbsp;<span class="op" id="2541546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541551">return</span>&nbsp;<span class="ident" id="2541558">cachePut</span><span class="op" id="2541566">(</span><span class="ident" id="2541567">ckey</span><span class="op" id="2541571">,</span>&nbsp;<span class="ident" id="2541573">tt</span><span class="op" id="2541575">)</span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2541579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2541582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2541586">//&nbsp;Make&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541609">var</span>&nbsp;<span class="ident" id="2541613">islice</span>&nbsp;<span class="keyword" id="2541620">interface</span><span class="op" id="2541629">{</span><span class="op" id="2541630">}</span>&nbsp;<span class="op" id="2541632">=</span>&nbsp;<span class="op" id="2541634">(</span><span class="op" id="2541635">[</span><span class="op" id="2541636">]</span><span class="ident" id="2541637">unsafe</span><span class="op" id="2541643">.</span><span class="ident" id="2541644">Pointer</span><span class="op" id="2541651">)</span><span class="op" id="2541652">(</span><span class="ident" id="2541653">nil</span><span class="op" id="2541656">)</span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541659">prototype</span>&nbsp;<span class="op" id="2541669">:=</span>&nbsp;<span class="op" id="2541672">*</span><span class="op" id="2541673">(</span><span class="op" id="2541674">*</span><span class="op" id="2541675">*</span><span class="ident" id="2541676">sliceType</span><span class="op" id="2541685">)</span><span class="op" id="2541686">(</span><span class="ident" id="2541687">unsafe</span><span class="op" id="2541693">.</span><span class="ident" id="2541694">Pointer</span><span class="op" id="2541701">(</span><span class="op" id="2541702">&amp;</span><span class="ident" id="2541703">islice</span><span class="op" id="2541709">)</span><span class="op" id="2541710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541713">slice</span>&nbsp;<span class="op" id="2541719">:=</span>&nbsp;<span class="builtinfunc" id="2541722">new</span><span class="op" id="2541725">(</span><span class="ident" id="2541726">sliceType</span><span class="op" id="2541735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2541738">*</span><span class="ident" id="2541739">slice</span>&nbsp;<span class="op" id="2541745">=</span>&nbsp;<span class="op" id="2541747">*</span><span class="ident" id="2541748">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541759">slice</span><span class="op" id="2541764">.</span><span class="builtintype" id="2541765">string</span>&nbsp;<span class="op" id="2541772">=</span>&nbsp;<span class="op" id="2541774">&amp;</span><span class="ident" id="2541775">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541778">slice</span><span class="op" id="2541783">.</span><span class="ident" id="2541784">hash</span>&nbsp;<span class="op" id="2541789">=</span>&nbsp;<span class="ident" id="2541791">fnv1</span><span class="op" id="2541795">(</span><span class="ident" id="2541796">typ</span><span class="op" id="2541799">.</span><span class="ident" id="2541800">hash</span><span class="op" id="2541804">,</span>&nbsp;<span class="string" id="2541806">&#39;[&#39;</span><span class="op" id="2541809">)</span><br>
<span class="lineno">1675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541812">slice</span><span class="op" id="2541817">.</span><span class="ident" id="2541818">elem</span>&nbsp;<span class="op" id="2541823">=</span>&nbsp;<span class="ident" id="2541825">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541830">slice</span><span class="op" id="2541835">.</span><span class="ident" id="2541836">uncommonType</span>&nbsp;<span class="op" id="2541849">=</span>&nbsp;<span class="ident" id="2541851">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541856">slice</span><span class="op" id="2541861">.</span><span class="ident" id="2541862">ptrToThis</span>&nbsp;<span class="op" id="2541872">=</span>&nbsp;<span class="ident" id="2541874">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2541879">slice</span><span class="op" id="2541884">.</span><span class="ident" id="2541885">zero</span>&nbsp;<span class="op" id="2541890">=</span>&nbsp;<span class="ident" id="2541892">unsafe</span><span class="op" id="2541898">.</span><span class="ident" id="2541899">Pointer</span><span class="op" id="2541906">(</span><span class="op" id="2541907">&amp;</span><span class="builtinfunc" id="2541908">make</span><span class="op" id="2541912">(</span><span class="op" id="2541913">[</span><span class="op" id="2541914">]</span><span class="builtintype" id="2541915">byte</span><span class="op" id="2541919">,</span>&nbsp;<span class="ident" id="2541921">slice</span><span class="op" id="2541926">.</span><span class="ident" id="2541927">size</span><span class="op" id="2541931">)</span><span class="op" id="2541932">[</span><span class="num" id="2541933">0</span><span class="op" id="2541934">]</span><span class="op" id="2541935">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2541939">return</span>&nbsp;<span class="ident" id="2541946">cachePut</span><span class="op" id="2541954">(</span><span class="ident" id="2541955">ckey</span><span class="op" id="2541959">,</span>&nbsp;<span class="op" id="2541961">&amp;</span><span class="ident" id="2541962">slice</span><span class="op" id="2541967">.</span><span class="ident" id="2541968">rtype</span><span class="op" id="2541973">)</span><br>
<span class="lineno"></span><span class="op" id="2541975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2541978">//&nbsp;ArrayOf&nbsp;returns&nbsp;the&nbsp;array&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;count&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2542051">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ArrayOf(5,&nbsp;t)&nbsp;represents&nbsp;[5]int.</span><br>
<span class="lineno">1685</span><span class="comment" id="2542121">//</span><br>
<span class="lineno"></span><span class="comment" id="2542124">//&nbsp;If&nbsp;the&nbsp;resulting&nbsp;type&nbsp;would&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;available&nbsp;address&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="2542199">//&nbsp;ArrayOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2542218">//</span><br>
<span class="lineno"></span><span class="comment" id="2542221">//&nbsp;TODO(rsc):&nbsp;Unexported&nbsp;for&nbsp;now.&nbsp;Export&nbsp;once&nbsp;the&nbsp;alg&nbsp;field&nbsp;is&nbsp;set&nbsp;correctly</span><br>
<span class="lineno">1690</span><span class="comment" id="2542298">//&nbsp;for&nbsp;the&nbsp;type.&nbsp;This&nbsp;may&nbsp;require&nbsp;significant&nbsp;work.</span><br>
<span class="lineno"></span><span class="comment" id="2542350">//</span><br>
<span class="lineno"></span><span class="comment" id="2542353">//&nbsp;TODO(rsc):&nbsp;TestArrayOf&nbsp;is&nbsp;also&nbsp;disabled.&nbsp;Re-enable.</span><br>
<span class="lineno"></span><span class="keyword" id="2542408">func</span>&nbsp;<span class="ident" id="2542413">arrayOf</span><span class="op" id="2542420">(</span><span class="ident" id="2542421">count</span>&nbsp;<span class="builtintype" id="2542427">int</span><span class="op" id="2542430">,</span>&nbsp;<span class="ident" id="2542432">elem</span>&nbsp;<span class="ident" id="2542437">Type</span><span class="op" id="2542441">)</span>&nbsp;<span class="ident" id="2542443">Type</span>&nbsp;<span class="op" id="2542448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542451">typ</span>&nbsp;<span class="op" id="2542455">:=</span>&nbsp;<span class="ident" id="2542458">elem</span><span class="op" id="2542462">.</span><span class="op" id="2542463">(</span><span class="op" id="2542464">*</span><span class="ident" id="2542465">rtype</span><span class="op" id="2542470">)</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542473">slice</span>&nbsp;<span class="op" id="2542479">:=</span>&nbsp;<span class="ident" id="2542482">SliceOf</span><span class="op" id="2542489">(</span><span class="ident" id="2542490">elem</span><span class="op" id="2542494">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2542498">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542517">ckey</span>&nbsp;<span class="op" id="2542522">:=</span>&nbsp;<span class="ident" id="2542525">cacheKey</span><span class="op" id="2542533">{</span><span class="ident" id="2542534">Array</span><span class="op" id="2542539">,</span>&nbsp;<span class="ident" id="2542541">typ</span><span class="op" id="2542544">,</span>&nbsp;<span class="ident" id="2542546">nil</span><span class="op" id="2542549">,</span>&nbsp;<span class="builtintype" id="2542551">uintptr</span><span class="op" id="2542558">(</span><span class="ident" id="2542559">count</span><span class="op" id="2542564">)</span><span class="op" id="2542565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2542568">if</span>&nbsp;<span class="ident" id="2542571">slice</span>&nbsp;<span class="op" id="2542577">:=</span>&nbsp;<span class="ident" id="2542580">cacheGet</span><span class="op" id="2542588">(</span><span class="ident" id="2542589">ckey</span><span class="op" id="2542593">)</span><span class="op" id="2542594">;</span>&nbsp;<span class="ident" id="2542596">slice</span>&nbsp;<span class="op" id="2542602">!=</span>&nbsp;<span class="ident" id="2542605">nil</span>&nbsp;<span class="op" id="2542609">{</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2542613">return</span>&nbsp;<span class="ident" id="2542620">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2542627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2542631">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542656">s</span>&nbsp;<span class="op" id="2542658">:=</span>&nbsp;<span class="string" id="2542661">&#34;[&#34;</span>&nbsp;<span class="op" id="2542665">+</span>&nbsp;<span class="ident" id="2542667">strconv</span><span class="op" id="2542674">.</span><span class="ident" id="2542675">Itoa</span><span class="op" id="2542679">(</span><span class="ident" id="2542680">count</span><span class="op" id="2542685">)</span>&nbsp;<span class="op" id="2542687">+</span>&nbsp;<span class="string" id="2542689">&#34;]&#34;</span>&nbsp;<span class="op" id="2542693">+</span>&nbsp;<span class="op" id="2542695">*</span><span class="ident" id="2542696">typ</span><span class="op" id="2542699">.</span><span class="builtintype" id="2542700">string</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2542708">for</span>&nbsp;<span class="ident" id="2542712">_</span><span class="op" id="2542713">,</span>&nbsp;<span class="ident" id="2542715">tt</span>&nbsp;<span class="op" id="2542718">:=</span>&nbsp;<span class="keyword" id="2542721">range</span>&nbsp;<span class="ident" id="2542727">typesByString</span><span class="op" id="2542740">(</span><span class="ident" id="2542741">s</span><span class="op" id="2542742">)</span>&nbsp;<span class="op" id="2542744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542748">slice</span>&nbsp;<span class="op" id="2542754">:=</span>&nbsp;<span class="op" id="2542757">(</span><span class="op" id="2542758">*</span><span class="ident" id="2542759">sliceType</span><span class="op" id="2542768">)</span><span class="op" id="2542769">(</span><span class="ident" id="2542770">unsafe</span><span class="op" id="2542776">.</span><span class="ident" id="2542777">Pointer</span><span class="op" id="2542784">(</span><span class="ident" id="2542785">tt</span><span class="op" id="2542787">)</span><span class="op" id="2542788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2542792">if</span>&nbsp;<span class="ident" id="2542795">slice</span><span class="op" id="2542800">.</span><span class="ident" id="2542801">elem</span>&nbsp;<span class="op" id="2542806">==</span>&nbsp;<span class="ident" id="2542809">typ</span>&nbsp;<span class="op" id="2542813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2542818">return</span>&nbsp;<span class="ident" id="2542825">cachePut</span><span class="op" id="2542833">(</span><span class="ident" id="2542834">ckey</span><span class="op" id="2542838">,</span>&nbsp;<span class="ident" id="2542840">tt</span><span class="op" id="2542842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2542846">}</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2542849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2542853">//&nbsp;Make&nbsp;an&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2542877">var</span>&nbsp;<span class="ident" id="2542881">iarray</span>&nbsp;<span class="keyword" id="2542888">interface</span><span class="op" id="2542897">{</span><span class="op" id="2542898">}</span>&nbsp;<span class="op" id="2542900">=</span>&nbsp;<span class="op" id="2542902">[</span><span class="num" id="2542903">1</span><span class="op" id="2542904">]</span><span class="ident" id="2542905">unsafe</span><span class="op" id="2542911">.</span><span class="ident" id="2542912">Pointer</span><span class="op" id="2542919">{</span><span class="op" id="2542920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542923">prototype</span>&nbsp;<span class="op" id="2542933">:=</span>&nbsp;<span class="op" id="2542936">*</span><span class="op" id="2542937">(</span><span class="op" id="2542938">*</span><span class="op" id="2542939">*</span><span class="ident" id="2542940">arrayType</span><span class="op" id="2542949">)</span><span class="op" id="2542950">(</span><span class="ident" id="2542951">unsafe</span><span class="op" id="2542957">.</span><span class="ident" id="2542958">Pointer</span><span class="op" id="2542965">(</span><span class="op" id="2542966">&amp;</span><span class="ident" id="2542967">iarray</span><span class="op" id="2542973">)</span><span class="op" id="2542974">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2542977">array</span>&nbsp;<span class="op" id="2542983">:=</span>&nbsp;<span class="builtinfunc" id="2542986">new</span><span class="op" id="2542989">(</span><span class="ident" id="2542990">arrayType</span><span class="op" id="2542999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2543002">*</span><span class="ident" id="2543003">array</span>&nbsp;<span class="op" id="2543009">=</span>&nbsp;<span class="op" id="2543011">*</span><span class="ident" id="2543012">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2543023">//&nbsp;TODO:&nbsp;Set&nbsp;extra&nbsp;kind&nbsp;bits&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543064">array</span><span class="op" id="2543069">.</span><span class="builtintype" id="2543070">string</span>&nbsp;<span class="op" id="2543077">=</span>&nbsp;<span class="op" id="2543079">&amp;</span><span class="ident" id="2543080">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543083">array</span><span class="op" id="2543088">.</span><span class="ident" id="2543089">hash</span>&nbsp;<span class="op" id="2543094">=</span>&nbsp;<span class="ident" id="2543096">fnv1</span><span class="op" id="2543100">(</span><span class="ident" id="2543101">typ</span><span class="op" id="2543104">.</span><span class="ident" id="2543105">hash</span><span class="op" id="2543109">,</span>&nbsp;<span class="string" id="2543111">&#39;[&#39;</span><span class="op" id="2543114">)</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543117">for</span>&nbsp;<span class="ident" id="2543121">n</span>&nbsp;<span class="op" id="2543123">:=</span>&nbsp;<span class="builtintype" id="2543126">uint32</span><span class="op" id="2543132">(</span><span class="ident" id="2543133">count</span><span class="op" id="2543138">)</span><span class="op" id="2543139">;</span>&nbsp;<span class="ident" id="2543141">n</span>&nbsp;<span class="op" id="2543143">&gt;</span>&nbsp;<span class="num" id="2543145">0</span><span class="op" id="2543146">;</span>&nbsp;<span class="ident" id="2543148">n</span>&nbsp;<span class="op" id="2543150">&gt;&gt;=</span>&nbsp;<span class="num" id="2543154">8</span>&nbsp;<span class="op" id="2543156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543160">array</span><span class="op" id="2543165">.</span><span class="ident" id="2543166">hash</span>&nbsp;<span class="op" id="2543171">=</span>&nbsp;<span class="ident" id="2543173">fnv1</span><span class="op" id="2543177">(</span><span class="ident" id="2543178">array</span><span class="op" id="2543183">.</span><span class="ident" id="2543184">hash</span><span class="op" id="2543188">,</span>&nbsp;<span class="builtintype" id="2543190">byte</span><span class="op" id="2543194">(</span><span class="ident" id="2543195">n</span><span class="op" id="2543196">)</span><span class="op" id="2543197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2543200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543203">array</span><span class="op" id="2543208">.</span><span class="ident" id="2543209">hash</span>&nbsp;<span class="op" id="2543214">=</span>&nbsp;<span class="ident" id="2543216">fnv1</span><span class="op" id="2543220">(</span><span class="ident" id="2543221">array</span><span class="op" id="2543226">.</span><span class="ident" id="2543227">hash</span><span class="op" id="2543231">,</span>&nbsp;<span class="string" id="2543233">&#39;]&#39;</span><span class="op" id="2543236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543239">array</span><span class="op" id="2543244">.</span><span class="ident" id="2543245">elem</span>&nbsp;<span class="op" id="2543250">=</span>&nbsp;<span class="ident" id="2543252">typ</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543257">max</span>&nbsp;<span class="op" id="2543261">:=</span>&nbsp;<span class="op" id="2543264">^</span><span class="builtintype" id="2543265">uintptr</span><span class="op" id="2543272">(</span><span class="num" id="2543273">0</span><span class="op" id="2543274">)</span>&nbsp;<span class="op" id="2543276">/</span>&nbsp;<span class="ident" id="2543278">typ</span><span class="op" id="2543281">.</span><span class="ident" id="2543282">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543288">if</span>&nbsp;<span class="builtintype" id="2543291">uintptr</span><span class="op" id="2543298">(</span><span class="ident" id="2543299">count</span><span class="op" id="2543304">)</span>&nbsp;<span class="op" id="2543306">&gt;</span>&nbsp;<span class="ident" id="2543308">max</span>&nbsp;<span class="op" id="2543312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2543316">panic</span><span class="op" id="2543321">(</span><span class="string" id="2543322">&#34;reflect.ArrayOf:&nbsp;array&nbsp;size&nbsp;would&nbsp;exceed&nbsp;virtual&nbsp;address&nbsp;space&#34;</span><span class="op" id="2543386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2543389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543392">array</span><span class="op" id="2543397">.</span><span class="ident" id="2543398">size</span>&nbsp;<span class="op" id="2543403">=</span>&nbsp;<span class="ident" id="2543405">typ</span><span class="op" id="2543408">.</span><span class="ident" id="2543409">size</span>&nbsp;<span class="op" id="2543414">*</span>&nbsp;<span class="builtintype" id="2543416">uintptr</span><span class="op" id="2543423">(</span><span class="ident" id="2543424">count</span><span class="op" id="2543429">)</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543432">array</span><span class="op" id="2543437">.</span><span class="ident" id="2543438">align</span>&nbsp;<span class="op" id="2543444">=</span>&nbsp;<span class="ident" id="2543446">typ</span><span class="op" id="2543449">.</span><span class="ident" id="2543450">align</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543457">array</span><span class="op" id="2543462">.</span><span class="ident" id="2543463">fieldAlign</span>&nbsp;<span class="op" id="2543474">=</span>&nbsp;<span class="ident" id="2543476">typ</span><span class="op" id="2543479">.</span><span class="ident" id="2543480">fieldAlign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2543492">//&nbsp;TODO:&nbsp;array.alg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2543512">//&nbsp;TODO:&nbsp;array.gc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2543531">//&nbsp;TODO:</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543541">array</span><span class="op" id="2543546">.</span><span class="ident" id="2543547">uncommonType</span>&nbsp;<span class="op" id="2543560">=</span>&nbsp;<span class="ident" id="2543562">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543567">array</span><span class="op" id="2543572">.</span><span class="ident" id="2543573">ptrToThis</span>&nbsp;<span class="op" id="2543583">=</span>&nbsp;<span class="ident" id="2543585">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543590">array</span><span class="op" id="2543595">.</span><span class="ident" id="2543596">zero</span>&nbsp;<span class="op" id="2543601">=</span>&nbsp;<span class="ident" id="2543603">unsafe</span><span class="op" id="2543609">.</span><span class="ident" id="2543610">Pointer</span><span class="op" id="2543617">(</span><span class="op" id="2543618">&amp;</span><span class="builtinfunc" id="2543619">make</span><span class="op" id="2543623">(</span><span class="op" id="2543624">[</span><span class="op" id="2543625">]</span><span class="builtintype" id="2543626">byte</span><span class="op" id="2543630">,</span>&nbsp;<span class="ident" id="2543632">array</span><span class="op" id="2543637">.</span><span class="ident" id="2543638">size</span><span class="op" id="2543642">)</span><span class="op" id="2543643">[</span><span class="num" id="2543644">0</span><span class="op" id="2543645">]</span><span class="op" id="2543646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543649">array</span><span class="op" id="2543654">.</span><span class="builtinfunc" id="2543655">len</span>&nbsp;<span class="op" id="2543659">=</span>&nbsp;<span class="builtintype" id="2543661">uintptr</span><span class="op" id="2543668">(</span><span class="ident" id="2543669">count</span><span class="op" id="2543674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2543677">array</span><span class="op" id="2543682">.</span><span class="ident" id="2543683">slice</span>&nbsp;<span class="op" id="2543689">=</span>&nbsp;<span class="ident" id="2543691">slice</span><span class="op" id="2543696">.</span><span class="op" id="2543697">(</span><span class="op" id="2543698">*</span><span class="ident" id="2543699">rtype</span><span class="op" id="2543704">)</span><br>
<span class="lineno">1740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2543708">return</span>&nbsp;<span class="ident" id="2543715">cachePut</span><span class="op" id="2543723">(</span><span class="ident" id="2543724">ckey</span><span class="op" id="2543728">,</span>&nbsp;<span class="op" id="2543730">&amp;</span><span class="ident" id="2543731">array</span><span class="op" id="2543736">.</span><span class="ident" id="2543737">rtype</span><span class="op" id="2543742">)</span><br>
<span class="lineno"></span><span class="op" id="2543744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2543747">//&nbsp;toType&nbsp;converts&nbsp;from&nbsp;a&nbsp;*rtype&nbsp;to&nbsp;a&nbsp;Type&nbsp;that&nbsp;can&nbsp;be&nbsp;returned</span><br>
<span class="lineno">1745</span><span class="comment" id="2543811">//&nbsp;to&nbsp;the&nbsp;client&nbsp;of&nbsp;package&nbsp;reflect.&nbsp;In&nbsp;gc,&nbsp;the&nbsp;only&nbsp;concern&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2543880">//&nbsp;a&nbsp;nil&nbsp;*rtype&nbsp;must&nbsp;be&nbsp;replaced&nbsp;by&nbsp;a&nbsp;nil&nbsp;Type,&nbsp;but&nbsp;in&nbsp;gccgo&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2543946">//&nbsp;function&nbsp;takes&nbsp;care&nbsp;of&nbsp;ensuring&nbsp;that&nbsp;multiple&nbsp;*rtype&nbsp;for&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2544015">//&nbsp;type&nbsp;are&nbsp;coalesced&nbsp;into&nbsp;a&nbsp;single&nbsp;Type.</span><br>
<span class="lineno"></span><span class="keyword" id="2544057">func</span>&nbsp;<span class="ident" id="2544062">toType</span><span class="op" id="2544068">(</span><span class="ident" id="2544069">t</span>&nbsp;<span class="op" id="2544071">*</span><span class="ident" id="2544072">rtype</span><span class="op" id="2544077">)</span>&nbsp;<span class="ident" id="2544079">Type</span>&nbsp;<span class="op" id="2544084">{</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544087">if</span>&nbsp;<span class="ident" id="2544090">t</span>&nbsp;<span class="op" id="2544092">==</span>&nbsp;<span class="ident" id="2544095">nil</span>&nbsp;<span class="op" id="2544099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544103">return</span>&nbsp;<span class="ident" id="2544110">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2544115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544118">return</span>&nbsp;<span class="ident" id="2544125">t</span><br>
<span class="lineno"></span><span class="op" id="2544127">}</span><br>
<span class="lineno">1755</span><br>
<span class="lineno"></span><span class="keyword" id="2544130">type</span>&nbsp;<span class="ident" id="2544135">layoutKey</span>&nbsp;<span class="keyword" id="2544145">struct</span>&nbsp;<span class="op" id="2544152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544155">t</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2544160">*</span><span class="ident" id="2544161">rtype</span>&nbsp;<span class="comment" id="2544167">//&nbsp;function&nbsp;signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544190">rcvr</span>&nbsp;<span class="op" id="2544195">*</span><span class="ident" id="2544196">rtype</span>&nbsp;<span class="comment" id="2544202">//&nbsp;receiver&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;none</span><br>
<span class="lineno"></span><span class="op" id="2544235">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span><span class="keyword" id="2544238">type</span>&nbsp;<span class="ident" id="2544243">layoutType</span>&nbsp;<span class="keyword" id="2544254">struct</span>&nbsp;<span class="op" id="2544261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544264">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2544274">*</span><span class="ident" id="2544275">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544282">argSize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2544292">uintptr</span>&nbsp;<span class="comment" id="2544300">//&nbsp;size&nbsp;of&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544322">retOffset</span>&nbsp;<span class="builtintype" id="2544332">uintptr</span>&nbsp;<span class="comment" id="2544340">//&nbsp;offset&nbsp;of&nbsp;return&nbsp;values.</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544369">stack</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2544379">*</span><span class="ident" id="2544380">bitVector</span><br>
<span class="lineno"></span><span class="op" id="2544390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2544393">var</span>&nbsp;<span class="ident" id="2544397">layoutCache</span>&nbsp;<span class="keyword" id="2544409">struct</span>&nbsp;<span class="op" id="2544416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544419">sync</span><span class="op" id="2544423">.</span><span class="ident" id="2544424">RWMutex</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2544433">m</span>&nbsp;<span class="keyword" id="2544435">map</span><span class="op" id="2544438">[</span><span class="ident" id="2544439">layoutKey</span><span class="op" id="2544448">]</span><span class="ident" id="2544449">layoutType</span><br>
<span class="lineno"></span><span class="op" id="2544460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2544463">//&nbsp;funcLayout&nbsp;computes&nbsp;a&nbsp;struct&nbsp;type&nbsp;representing&nbsp;the&nbsp;layout&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2544531">//&nbsp;function&nbsp;arguments&nbsp;and&nbsp;return&nbsp;values&nbsp;for&nbsp;the&nbsp;function&nbsp;type&nbsp;t.</span><br>
<span class="lineno">1775</span><span class="comment" id="2544596">//&nbsp;If&nbsp;rcvr&nbsp;!=&nbsp;nil,&nbsp;rcvr&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="2544656">//&nbsp;The&nbsp;returned&nbsp;type&nbsp;exists&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2544735">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2544803">//&nbsp;the&nbsp;name&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2544843">func</span>&nbsp;<span class="ident" id="2544848">funcLayout</span><span class="op" id="2544858">(</span><span class="ident" id="2544859">t</span>&nbsp;<span class="op" id="2544861">*</span><span class="ident" id="2544862">rtype</span><span class="op" id="2544867">,</span>&nbsp;<span class="ident" id="2544869">rcvr</span>&nbsp;<span class="op" id="2544874">*</span><span class="ident" id="2544875">rtype</span><span class="op" id="2544880">)</span>&nbsp;<span class="op" id="2544882">(</span><span class="ident" id="2544883">frametype</span>&nbsp;<span class="op" id="2544893">*</span><span class="ident" id="2544894">rtype</span><span class="op" id="2544899">,</span>&nbsp;<span class="ident" id="2544901">argSize</span><span class="op" id="2544908">,</span>&nbsp;<span class="ident" id="2544910">retOffset</span>&nbsp;<span class="builtintype" id="2544920">uintptr</span><span class="op" id="2544927">,</span>&nbsp;<span class="ident" id="2544929">stack</span>&nbsp;<span class="op" id="2544935">*</span><span class="ident" id="2544936">bitVector</span><span class="op" id="2544945">)</span>&nbsp;<span class="op" id="2544947">{</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2544950">if</span>&nbsp;<span class="ident" id="2544953">t</span><span class="op" id="2544954">.</span><span class="ident" id="2544955">Kind</span><span class="op" id="2544959">(</span><span class="op" id="2544960">)</span>&nbsp;<span class="op" id="2544962">!=</span>&nbsp;<span class="ident" id="2544965">Func</span>&nbsp;<span class="op" id="2544970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2544974">panic</span><span class="op" id="2544979">(</span><span class="string" id="2544980">&#34;reflect:&nbsp;funcLayout&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2545018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545024">if</span>&nbsp;<span class="ident" id="2545027">rcvr</span>&nbsp;<span class="op" id="2545032">!=</span>&nbsp;<span class="ident" id="2545035">nil</span>&nbsp;<span class="op" id="2545039">&amp;&amp;</span>&nbsp;<span class="ident" id="2545042">rcvr</span><span class="op" id="2545046">.</span><span class="ident" id="2545047">Kind</span><span class="op" id="2545051">(</span><span class="op" id="2545052">)</span>&nbsp;<span class="op" id="2545054">==</span>&nbsp;<span class="ident" id="2545057">Interface</span>&nbsp;<span class="op" id="2545067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2545071">panic</span><span class="op" id="2545076">(</span><span class="string" id="2545077">&#34;reflect:&nbsp;funcLayout&nbsp;with&nbsp;interface&nbsp;receiver&nbsp;&#34;</span>&nbsp;<span class="op" id="2545124">+</span>&nbsp;<span class="ident" id="2545126">rcvr</span><span class="op" id="2545130">.</span><span class="ident" id="2545131">String</span><span class="op" id="2545137">(</span><span class="op" id="2545138">)</span><span class="op" id="2545139">)</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545145">k</span>&nbsp;<span class="op" id="2545147">:=</span>&nbsp;<span class="ident" id="2545150">layoutKey</span><span class="op" id="2545159">{</span><span class="ident" id="2545160">t</span><span class="op" id="2545161">,</span>&nbsp;<span class="ident" id="2545163">rcvr</span><span class="op" id="2545167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545170">layoutCache</span><span class="op" id="2545181">.</span><span class="ident" id="2545182">RLock</span><span class="op" id="2545187">(</span><span class="op" id="2545188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545191">if</span>&nbsp;<span class="ident" id="2545194">x</span>&nbsp;<span class="op" id="2545196">:=</span>&nbsp;<span class="ident" id="2545199">layoutCache</span><span class="op" id="2545210">.</span><span class="ident" id="2545211">m</span><span class="op" id="2545212">[</span><span class="ident" id="2545213">k</span><span class="op" id="2545214">]</span><span class="op" id="2545215">;</span>&nbsp;<span class="ident" id="2545217">x</span><span class="op" id="2545218">.</span><span class="ident" id="2545219">t</span>&nbsp;<span class="op" id="2545221">!=</span>&nbsp;<span class="ident" id="2545224">nil</span>&nbsp;<span class="op" id="2545228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545232">layoutCache</span><span class="op" id="2545243">.</span><span class="ident" id="2545244">RUnlock</span><span class="op" id="2545251">(</span><span class="op" id="2545252">)</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545256">return</span>&nbsp;<span class="ident" id="2545263">x</span><span class="op" id="2545264">.</span><span class="ident" id="2545265">t</span><span class="op" id="2545266">,</span>&nbsp;<span class="ident" id="2545268">x</span><span class="op" id="2545269">.</span><span class="ident" id="2545270">argSize</span><span class="op" id="2545277">,</span>&nbsp;<span class="ident" id="2545279">x</span><span class="op" id="2545280">.</span><span class="ident" id="2545281">retOffset</span><span class="op" id="2545290">,</span>&nbsp;<span class="ident" id="2545292">x</span><span class="op" id="2545293">.</span><span class="ident" id="2545294">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545304">layoutCache</span><span class="op" id="2545315">.</span><span class="ident" id="2545316">RUnlock</span><span class="op" id="2545323">(</span><span class="op" id="2545324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545327">layoutCache</span><span class="op" id="2545338">.</span><span class="ident" id="2545339">Lock</span><span class="op" id="2545343">(</span><span class="op" id="2545344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545347">if</span>&nbsp;<span class="ident" id="2545350">x</span>&nbsp;<span class="op" id="2545352">:=</span>&nbsp;<span class="ident" id="2545355">layoutCache</span><span class="op" id="2545366">.</span><span class="ident" id="2545367">m</span><span class="op" id="2545368">[</span><span class="ident" id="2545369">k</span><span class="op" id="2545370">]</span><span class="op" id="2545371">;</span>&nbsp;<span class="ident" id="2545373">x</span><span class="op" id="2545374">.</span><span class="ident" id="2545375">t</span>&nbsp;<span class="op" id="2545377">!=</span>&nbsp;<span class="ident" id="2545380">nil</span>&nbsp;<span class="op" id="2545384">{</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545388">layoutCache</span><span class="op" id="2545399">.</span><span class="ident" id="2545400">Unlock</span><span class="op" id="2545406">(</span><span class="op" id="2545407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545411">return</span>&nbsp;<span class="ident" id="2545418">x</span><span class="op" id="2545419">.</span><span class="ident" id="2545420">t</span><span class="op" id="2545421">,</span>&nbsp;<span class="ident" id="2545423">x</span><span class="op" id="2545424">.</span><span class="ident" id="2545425">argSize</span><span class="op" id="2545432">,</span>&nbsp;<span class="ident" id="2545434">x</span><span class="op" id="2545435">.</span><span class="ident" id="2545436">retOffset</span><span class="op" id="2545445">,</span>&nbsp;<span class="ident" id="2545447">x</span><span class="op" id="2545448">.</span><span class="ident" id="2545449">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545460">tt</span>&nbsp;<span class="op" id="2545463">:=</span>&nbsp;<span class="op" id="2545466">(</span><span class="op" id="2545467">*</span><span class="ident" id="2545468">funcType</span><span class="op" id="2545476">)</span><span class="op" id="2545477">(</span><span class="ident" id="2545478">unsafe</span><span class="op" id="2545484">.</span><span class="ident" id="2545485">Pointer</span><span class="op" id="2545492">(</span><span class="ident" id="2545493">t</span><span class="op" id="2545494">)</span><span class="op" id="2545495">)</span><br>
<span class="lineno">1800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2545499">//&nbsp;compute&nbsp;gc&nbsp;program&nbsp;&amp;&nbsp;stack&nbsp;bitmap&nbsp;for&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545551">stack</span>&nbsp;<span class="op" id="2545557">=</span>&nbsp;<span class="builtinfunc" id="2545559">new</span><span class="op" id="2545562">(</span><span class="ident" id="2545563">bitVector</span><span class="op" id="2545572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545575">var</span>&nbsp;<span class="ident" id="2545579">gc</span>&nbsp;<span class="ident" id="2545582">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545590">var</span>&nbsp;<span class="ident" id="2545594">offset</span>&nbsp;<span class="builtintype" id="2545601">uintptr</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545610">if</span>&nbsp;<span class="ident" id="2545613">rcvr</span>&nbsp;<span class="op" id="2545618">!=</span>&nbsp;<span class="ident" id="2545621">nil</span>&nbsp;<span class="op" id="2545625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2545629">//&nbsp;Reflect&nbsp;uses&nbsp;the&nbsp;&#34;interface&#34;&nbsp;calling&nbsp;convention&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2545686">//&nbsp;methods,&nbsp;where&nbsp;receivers&nbsp;take&nbsp;one&nbsp;word&nbsp;of&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2545742">//&nbsp;space&nbsp;no&nbsp;matter&nbsp;how&nbsp;big&nbsp;they&nbsp;actually&nbsp;are.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2545790">if</span>&nbsp;<span class="ident" id="2545793">ifaceIndir</span><span class="op" id="2545803">(</span><span class="ident" id="2545804">rcvr</span><span class="op" id="2545808">)</span>&nbsp;<span class="op" id="2545810">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2545815">//&nbsp;we&nbsp;pass&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545856">gc</span><span class="op" id="2545858">.</span><span class="builtinfunc" id="2545859">append</span><span class="op" id="2545865">(</span><span class="ident" id="2545866">bitsPointer</span><span class="op" id="2545877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2545882">stack</span><span class="op" id="2545887">.</span><span class="ident" id="2545888">append2</span><span class="op" id="2545895">(</span><span class="ident" id="2545896">bitsPointer</span><span class="op" id="2545907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2545911">}</span>&nbsp;<span class="keyword" id="2545913">else</span>&nbsp;<span class="keyword" id="2545918">if</span>&nbsp;<span class="ident" id="2545921">rcvr</span><span class="op" id="2545925">.</span><span class="ident" id="2545926">pointers</span><span class="op" id="2545934">(</span><span class="op" id="2545935">)</span>&nbsp;<span class="op" id="2545937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2545942">//&nbsp;rcvr&nbsp;is&nbsp;a&nbsp;one-word&nbsp;pointer&nbsp;object.&nbsp;&nbsp;Its&nbsp;gc&nbsp;program</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2545999">//&nbsp;is&nbsp;just&nbsp;what&nbsp;we&nbsp;need&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546032">gc</span><span class="op" id="2546034">.</span><span class="builtinfunc" id="2546035">append</span><span class="op" id="2546041">(</span><span class="ident" id="2546042">bitsPointer</span><span class="op" id="2546053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546058">stack</span><span class="op" id="2546063">.</span><span class="ident" id="2546064">append2</span><span class="op" id="2546071">(</span><span class="ident" id="2546072">bitsPointer</span><span class="op" id="2546083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546087">}</span>&nbsp;<span class="keyword" id="2546089">else</span>&nbsp;<span class="op" id="2546094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546099">gc</span><span class="op" id="2546101">.</span><span class="builtinfunc" id="2546102">append</span><span class="op" id="2546108">(</span><span class="ident" id="2546109">bitsScalar</span><span class="op" id="2546119">)</span><br>
<span class="lineno">1820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546124">stack</span><span class="op" id="2546129">.</span><span class="ident" id="2546130">append2</span><span class="op" id="2546137">(</span><span class="ident" id="2546138">bitsScalar</span><span class="op" id="2546148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546156">offset</span>&nbsp;<span class="op" id="2546163">+=</span>&nbsp;<span class="ident" id="2546166">ptrSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546178">for</span>&nbsp;<span class="ident" id="2546182">_</span><span class="op" id="2546183">,</span>&nbsp;<span class="ident" id="2546185">arg</span>&nbsp;<span class="op" id="2546189">:=</span>&nbsp;<span class="keyword" id="2546192">range</span>&nbsp;<span class="ident" id="2546198">tt</span><span class="op" id="2546200">.</span><span class="ident" id="2546201">in</span>&nbsp;<span class="op" id="2546204">{</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546208">gc</span><span class="op" id="2546210">.</span><span class="ident" id="2546211">appendProg</span><span class="op" id="2546221">(</span><span class="ident" id="2546222">arg</span><span class="op" id="2546225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546229">addTypeBits</span><span class="op" id="2546240">(</span><span class="ident" id="2546241">stack</span><span class="op" id="2546246">,</span>&nbsp;<span class="op" id="2546248">&amp;</span><span class="ident" id="2546249">offset</span><span class="op" id="2546255">,</span>&nbsp;<span class="ident" id="2546257">arg</span><span class="op" id="2546260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546266">argSize</span>&nbsp;<span class="op" id="2546274">=</span>&nbsp;<span class="ident" id="2546276">gc</span><span class="op" id="2546278">.</span><span class="ident" id="2546279">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546285">if</span>&nbsp;<span class="ident" id="2546288">runtime</span><span class="op" id="2546295">.</span><span class="ident" id="2546296">GOARCH</span>&nbsp;<span class="op" id="2546303">==</span>&nbsp;<span class="string" id="2546306">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2546317">{</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546321">gc</span><span class="op" id="2546323">.</span><span class="ident" id="2546324">align</span><span class="op" id="2546329">(</span><span class="num" id="2546330">8</span><span class="op" id="2546331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546337">gc</span><span class="op" id="2546339">.</span><span class="ident" id="2546340">align</span><span class="op" id="2546345">(</span><span class="ident" id="2546346">ptrSize</span><span class="op" id="2546353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546356">retOffset</span>&nbsp;<span class="op" id="2546366">=</span>&nbsp;<span class="ident" id="2546368">gc</span><span class="op" id="2546370">.</span><span class="ident" id="2546371">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546377">for</span>&nbsp;<span class="ident" id="2546381">_</span><span class="op" id="2546382">,</span>&nbsp;<span class="ident" id="2546384">res</span>&nbsp;<span class="op" id="2546388">:=</span>&nbsp;<span class="keyword" id="2546391">range</span>&nbsp;<span class="ident" id="2546397">tt</span><span class="op" id="2546399">.</span><span class="ident" id="2546400">out</span>&nbsp;<span class="op" id="2546404">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546408">gc</span><span class="op" id="2546410">.</span><span class="ident" id="2546411">appendProg</span><span class="op" id="2546421">(</span><span class="ident" id="2546422">res</span><span class="op" id="2546425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2546429">//&nbsp;stack&nbsp;map&nbsp;does&nbsp;not&nbsp;need&nbsp;result&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546472">gc</span><span class="op" id="2546474">.</span><span class="ident" id="2546475">align</span><span class="op" id="2546480">(</span><span class="ident" id="2546481">ptrSize</span><span class="op" id="2546488">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2546492">//&nbsp;build&nbsp;dummy&nbsp;rtype&nbsp;holding&nbsp;gc&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546533">x</span>&nbsp;<span class="op" id="2546535">:=</span>&nbsp;<span class="builtinfunc" id="2546538">new</span><span class="op" id="2546541">(</span><span class="ident" id="2546542">rtype</span><span class="op" id="2546547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546550">x</span><span class="op" id="2546551">.</span><span class="ident" id="2546552">size</span>&nbsp;<span class="op" id="2546557">=</span>&nbsp;<span class="ident" id="2546559">gc</span><span class="op" id="2546561">.</span><span class="ident" id="2546562">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546568">x</span><span class="op" id="2546569">.</span><span class="ident" id="2546570">gc</span><span class="op" id="2546572">[</span><span class="num" id="2546573">0</span><span class="op" id="2546574">]</span>&nbsp;<span class="op" id="2546576">=</span>&nbsp;<span class="ident" id="2546578">gc</span><span class="op" id="2546580">.</span><span class="ident" id="2546581">finalize</span><span class="op" id="2546589">(</span><span class="op" id="2546590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546593">var</span>&nbsp;<span class="ident" id="2546597">s</span>&nbsp;<span class="builtintype" id="2546599">string</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546607">if</span>&nbsp;<span class="ident" id="2546610">rcvr</span>&nbsp;<span class="op" id="2546615">!=</span>&nbsp;<span class="ident" id="2546618">nil</span>&nbsp;<span class="op" id="2546622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546626">s</span>&nbsp;<span class="op" id="2546628">=</span>&nbsp;<span class="string" id="2546630">&#34;methodargs(&#34;</span>&nbsp;<span class="op" id="2546644">+</span>&nbsp;<span class="op" id="2546646">*</span><span class="ident" id="2546647">rcvr</span><span class="op" id="2546651">.</span><span class="builtintype" id="2546652">string</span>&nbsp;<span class="op" id="2546659">+</span>&nbsp;<span class="string" id="2546661">&#34;)(&#34;</span>&nbsp;<span class="op" id="2546666">+</span>&nbsp;<span class="op" id="2546668">*</span><span class="ident" id="2546669">t</span><span class="op" id="2546670">.</span><span class="builtintype" id="2546671">string</span>&nbsp;<span class="op" id="2546678">+</span>&nbsp;<span class="string" id="2546680">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546685">}</span>&nbsp;<span class="keyword" id="2546687">else</span>&nbsp;<span class="op" id="2546692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546696">s</span>&nbsp;<span class="op" id="2546698">=</span>&nbsp;<span class="string" id="2546700">&#34;funcargs(&#34;</span>&nbsp;<span class="op" id="2546712">+</span>&nbsp;<span class="op" id="2546714">*</span><span class="ident" id="2546715">t</span><span class="op" id="2546716">.</span><span class="builtintype" id="2546717">string</span>&nbsp;<span class="op" id="2546724">+</span>&nbsp;<span class="string" id="2546726">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546731">}</span><br>
<span class="lineno">1850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546734">x</span><span class="op" id="2546735">.</span><span class="builtintype" id="2546736">string</span>&nbsp;<span class="op" id="2546743">=</span>&nbsp;<span class="op" id="2546745">&amp;</span><span class="ident" id="2546746">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2546750">//&nbsp;cache&nbsp;result&nbsp;for&nbsp;future&nbsp;callers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2546786">if</span>&nbsp;<span class="ident" id="2546789">layoutCache</span><span class="op" id="2546800">.</span><span class="ident" id="2546801">m</span>&nbsp;<span class="op" id="2546803">==</span>&nbsp;<span class="ident" id="2546806">nil</span>&nbsp;<span class="op" id="2546810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546814">layoutCache</span><span class="op" id="2546825">.</span><span class="ident" id="2546826">m</span>&nbsp;<span class="op" id="2546828">=</span>&nbsp;<span class="builtinfunc" id="2546830">make</span><span class="op" id="2546834">(</span><span class="keyword" id="2546835">map</span><span class="op" id="2546838">[</span><span class="ident" id="2546839">layoutKey</span><span class="op" id="2546848">]</span><span class="ident" id="2546849">layoutType</span><span class="op" id="2546859">)</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546865">layoutCache</span><span class="op" id="2546876">.</span><span class="ident" id="2546877">m</span><span class="op" id="2546878">[</span><span class="ident" id="2546879">k</span><span class="op" id="2546880">]</span>&nbsp;<span class="op" id="2546882">=</span>&nbsp;<span class="ident" id="2546884">layoutType</span><span class="op" id="2546894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546898">t</span><span class="op" id="2546899">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2546909">x</span><span class="op" id="2546910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546914">argSize</span><span class="op" id="2546921">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2546925">argSize</span><span class="op" id="2546932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546936">retOffset</span><span class="op" id="2546945">:</span>&nbsp;<span class="ident" id="2546947">retOffset</span><span class="op" id="2546956">,</span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546960">stack</span><span class="op" id="2546965">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2546971">stack</span><span class="op" id="2546976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2546979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2546982">layoutCache</span><span class="op" id="2546993">.</span><span class="ident" id="2546994">Unlock</span><span class="op" id="2547000">(</span><span class="op" id="2547001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547004">return</span>&nbsp;<span class="ident" id="2547011">x</span><span class="op" id="2547012">,</span>&nbsp;<span class="ident" id="2547014">argSize</span><span class="op" id="2547021">,</span>&nbsp;<span class="ident" id="2547023">retOffset</span><span class="op" id="2547032">,</span>&nbsp;<span class="ident" id="2547034">stack</span><br>
<span class="lineno"></span><span class="op" id="2547040">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span><span class="comment" id="2547043">//&nbsp;ifaceIndir&nbsp;reports&nbsp;whether&nbsp;t&nbsp;is&nbsp;stored&nbsp;indirectly&nbsp;in&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="2547119">func</span>&nbsp;<span class="ident" id="2547124">ifaceIndir</span><span class="op" id="2547134">(</span><span class="ident" id="2547135">t</span>&nbsp;<span class="op" id="2547137">*</span><span class="ident" id="2547138">rtype</span><span class="op" id="2547143">)</span>&nbsp;<span class="builtintype" id="2547145">bool</span>&nbsp;<span class="op" id="2547150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547153">return</span>&nbsp;<span class="ident" id="2547160">t</span><span class="op" id="2547161">.</span><span class="ident" id="2547162">kind</span><span class="op" id="2547166">&amp;</span><span class="ident" id="2547167">kindDirectIface</span>&nbsp;<span class="op" id="2547183">==</span>&nbsp;<span class="num" id="2547186">0</span><br>
<span class="lineno"></span><span class="op" id="2547188">}</span><br>
<span class="lineno">1870</span><br>
<span class="lineno"></span><span class="comment" id="2547191">//&nbsp;Layout&nbsp;matches&nbsp;runtime.BitVector&nbsp;(well&nbsp;enough).</span><br>
<span class="lineno"></span><span class="keyword" id="2547242">type</span>&nbsp;<span class="ident" id="2547247">bitVector</span>&nbsp;<span class="keyword" id="2547257">struct</span>&nbsp;<span class="op" id="2547264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547267">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2547272">uint32</span>&nbsp;<span class="comment" id="2547279">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547298">data</span>&nbsp;<span class="op" id="2547303">[</span><span class="op" id="2547304">]</span><span class="builtintype" id="2547305">byte</span><br>
<span class="lineno">1875</span><span class="op" id="2547310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2547313">//&nbsp;append&nbsp;a&nbsp;bit&nbsp;pair&nbsp;to&nbsp;the&nbsp;bitmap.</span><br>
<span class="lineno"></span><span class="keyword" id="2547349">func</span>&nbsp;<span class="op" id="2547354">(</span><span class="ident" id="2547355">bv</span>&nbsp;<span class="op" id="2547358">*</span><span class="ident" id="2547359">bitVector</span><span class="op" id="2547368">)</span>&nbsp;<span class="ident" id="2547370">append2</span><span class="op" id="2547377">(</span><span class="ident" id="2547378">bits</span>&nbsp;<span class="builtintype" id="2547383">uint8</span><span class="op" id="2547388">)</span>&nbsp;<span class="op" id="2547390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2547393">//&nbsp;assume&nbsp;bv.n&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;2,&nbsp;since&nbsp;append2&nbsp;is&nbsp;the&nbsp;only&nbsp;operation.</span><br>
<span class="lineno">1880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547466">if</span>&nbsp;<span class="ident" id="2547469">bv</span><span class="op" id="2547471">.</span><span class="ident" id="2547472">n</span><span class="op" id="2547473">%</span><span class="num" id="2547474">8</span>&nbsp;<span class="op" id="2547476">==</span>&nbsp;<span class="num" id="2547479">0</span>&nbsp;<span class="op" id="2547481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547485">bv</span><span class="op" id="2547487">.</span><span class="ident" id="2547488">data</span>&nbsp;<span class="op" id="2547493">=</span>&nbsp;<span class="builtinfunc" id="2547495">append</span><span class="op" id="2547501">(</span><span class="ident" id="2547502">bv</span><span class="op" id="2547504">.</span><span class="ident" id="2547505">data</span><span class="op" id="2547509">,</span>&nbsp;<span class="num" id="2547511">0</span><span class="op" id="2547512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2547515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547518">bv</span><span class="op" id="2547520">.</span><span class="ident" id="2547521">data</span><span class="op" id="2547525">[</span><span class="ident" id="2547526">bv</span><span class="op" id="2547528">.</span><span class="ident" id="2547529">n</span><span class="op" id="2547530">/</span><span class="num" id="2547531">8</span><span class="op" id="2547532">]</span>&nbsp;<span class="op" id="2547534">|=</span>&nbsp;<span class="ident" id="2547537">bits</span>&nbsp;<span class="op" id="2547542">&lt;&lt;</span>&nbsp;<span class="op" id="2547545">(</span><span class="ident" id="2547546">bv</span><span class="op" id="2547548">.</span><span class="ident" id="2547549">n</span>&nbsp;<span class="op" id="2547551">%</span>&nbsp;<span class="num" id="2547553">8</span><span class="op" id="2547554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547557">bv</span><span class="op" id="2547559">.</span><span class="ident" id="2547560">n</span>&nbsp;<span class="op" id="2547562">+=</span>&nbsp;<span class="num" id="2547565">2</span><br>
<span class="lineno">1885</span><span class="op" id="2547567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2547570">func</span>&nbsp;<span class="ident" id="2547575">addTypeBits</span><span class="op" id="2547586">(</span><span class="ident" id="2547587">bv</span>&nbsp;<span class="op" id="2547590">*</span><span class="ident" id="2547591">bitVector</span><span class="op" id="2547600">,</span>&nbsp;<span class="ident" id="2547602">offset</span>&nbsp;<span class="op" id="2547609">*</span><span class="builtintype" id="2547610">uintptr</span><span class="op" id="2547617">,</span>&nbsp;<span class="ident" id="2547619">t</span>&nbsp;<span class="op" id="2547621">*</span><span class="ident" id="2547622">rtype</span><span class="op" id="2547627">)</span>&nbsp;<span class="op" id="2547629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2547632">*</span><span class="ident" id="2547633">offset</span>&nbsp;<span class="op" id="2547640">=</span>&nbsp;<span class="ident" id="2547642">align</span><span class="op" id="2547647">(</span><span class="op" id="2547648">*</span><span class="ident" id="2547649">offset</span><span class="op" id="2547655">,</span>&nbsp;<span class="builtintype" id="2547657">uintptr</span><span class="op" id="2547664">(</span><span class="ident" id="2547665">t</span><span class="op" id="2547666">.</span><span class="ident" id="2547667">align</span><span class="op" id="2547672">)</span><span class="op" id="2547673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547676">if</span>&nbsp;<span class="ident" id="2547679">t</span><span class="op" id="2547680">.</span><span class="ident" id="2547681">kind</span><span class="op" id="2547685">&amp;</span><span class="ident" id="2547686">kindNoPointers</span>&nbsp;<span class="op" id="2547701">!=</span>&nbsp;<span class="num" id="2547704">0</span>&nbsp;<span class="op" id="2547706">{</span><br>
<span class="lineno">1890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2547710">*</span><span class="ident" id="2547711">offset</span>&nbsp;<span class="op" id="2547718">+=</span>&nbsp;<span class="ident" id="2547721">t</span><span class="op" id="2547722">.</span><span class="ident" id="2547723">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547730">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2547738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547742">switch</span>&nbsp;<span class="ident" id="2547749">Kind</span><span class="op" id="2547753">(</span><span class="ident" id="2547754">t</span><span class="op" id="2547755">.</span><span class="ident" id="2547756">kind</span>&nbsp;<span class="op" id="2547761">&amp;</span>&nbsp;<span class="ident" id="2547763">kindMask</span><span class="op" id="2547771">)</span>&nbsp;<span class="op" id="2547773">{</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547776">case</span>&nbsp;<span class="ident" id="2547781">Chan</span><span class="op" id="2547785">,</span>&nbsp;<span class="ident" id="2547787">Func</span><span class="op" id="2547791">,</span>&nbsp;<span class="ident" id="2547793">Map</span><span class="op" id="2547796">,</span>&nbsp;<span class="ident" id="2547798">Ptr</span><span class="op" id="2547801">,</span>&nbsp;<span class="ident" id="2547803">Slice</span><span class="op" id="2547808">,</span>&nbsp;<span class="ident" id="2547810">String</span><span class="op" id="2547816">,</span>&nbsp;<span class="ident" id="2547818">UnsafePointer</span><span class="op" id="2547831">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2547835">//&nbsp;1&nbsp;pointer&nbsp;at&nbsp;start&nbsp;of&nbsp;representation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547877">for</span>&nbsp;<span class="ident" id="2547881">bv</span><span class="op" id="2547883">.</span><span class="ident" id="2547884">n</span>&nbsp;<span class="op" id="2547886">&lt;</span>&nbsp;<span class="num" id="2547888">2</span><span class="op" id="2547889">*</span><span class="builtintype" id="2547890">uint32</span><span class="op" id="2547896">(</span><span class="op" id="2547897">*</span><span class="ident" id="2547898">offset</span><span class="op" id="2547904">/</span><span class="builtintype" id="2547905">uintptr</span><span class="op" id="2547912">(</span><span class="ident" id="2547913">ptrSize</span><span class="op" id="2547920">)</span><span class="op" id="2547921">)</span>&nbsp;<span class="op" id="2547923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547928">bv</span><span class="op" id="2547930">.</span><span class="ident" id="2547931">append2</span><span class="op" id="2547938">(</span><span class="ident" id="2547939">bitsScalar</span><span class="op" id="2547949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2547953">}</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2547957">bv</span><span class="op" id="2547959">.</span><span class="ident" id="2547960">append2</span><span class="op" id="2547967">(</span><span class="ident" id="2547968">bitsPointer</span><span class="op" id="2547979">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2547983">case</span>&nbsp;<span class="ident" id="2547988">Interface</span><span class="op" id="2547997">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548001">//&nbsp;2&nbsp;pointers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548017">for</span>&nbsp;<span class="ident" id="2548021">bv</span><span class="op" id="2548023">.</span><span class="ident" id="2548024">n</span>&nbsp;<span class="op" id="2548026">&lt;</span>&nbsp;<span class="num" id="2548028">2</span><span class="op" id="2548029">*</span><span class="builtintype" id="2548030">uint32</span><span class="op" id="2548036">(</span><span class="op" id="2548037">*</span><span class="ident" id="2548038">offset</span><span class="op" id="2548044">/</span><span class="builtintype" id="2548045">uintptr</span><span class="op" id="2548052">(</span><span class="ident" id="2548053">ptrSize</span><span class="op" id="2548060">)</span><span class="op" id="2548061">)</span>&nbsp;<span class="op" id="2548063">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548068">bv</span><span class="op" id="2548070">.</span><span class="ident" id="2548071">append2</span><span class="op" id="2548078">(</span><span class="ident" id="2548079">bitsScalar</span><span class="op" id="2548089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2548093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548097">bv</span><span class="op" id="2548099">.</span><span class="ident" id="2548100">append2</span><span class="op" id="2548107">(</span><span class="ident" id="2548108">bitsPointer</span><span class="op" id="2548119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548123">bv</span><span class="op" id="2548125">.</span><span class="ident" id="2548126">append2</span><span class="op" id="2548133">(</span><span class="ident" id="2548134">bitsPointer</span><span class="op" id="2548145">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548149">case</span>&nbsp;<span class="ident" id="2548154">Array</span><span class="op" id="2548159">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548163">//&nbsp;repeat&nbsp;inner&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548186">tt</span>&nbsp;<span class="op" id="2548189">:=</span>&nbsp;<span class="op" id="2548192">(</span><span class="op" id="2548193">*</span><span class="ident" id="2548194">arrayType</span><span class="op" id="2548203">)</span><span class="op" id="2548204">(</span><span class="ident" id="2548205">unsafe</span><span class="op" id="2548211">.</span><span class="ident" id="2548212">Pointer</span><span class="op" id="2548219">(</span><span class="ident" id="2548220">t</span><span class="op" id="2548221">)</span><span class="op" id="2548222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548226">for</span>&nbsp;<span class="ident" id="2548230">i</span>&nbsp;<span class="op" id="2548232">:=</span>&nbsp;<span class="num" id="2548235">0</span><span class="op" id="2548236">;</span>&nbsp;<span class="ident" id="2548238">i</span>&nbsp;<span class="op" id="2548240">&lt;</span>&nbsp;<span class="builtintype" id="2548242">int</span><span class="op" id="2548245">(</span><span class="ident" id="2548246">tt</span><span class="op" id="2548248">.</span><span class="builtinfunc" id="2548249">len</span><span class="op" id="2548252">)</span><span class="op" id="2548253">;</span>&nbsp;<span class="ident" id="2548255">i</span><span class="op" id="2548256">++</span>&nbsp;<span class="op" id="2548259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548264">addTypeBits</span><span class="op" id="2548275">(</span><span class="ident" id="2548276">bv</span><span class="op" id="2548278">,</span>&nbsp;<span class="ident" id="2548280">offset</span><span class="op" id="2548286">,</span>&nbsp;<span class="ident" id="2548288">tt</span><span class="op" id="2548290">.</span><span class="ident" id="2548291">elem</span><span class="op" id="2548295">)</span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2548299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548303">case</span>&nbsp;<span class="ident" id="2548308">Struct</span><span class="op" id="2548314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2548318">//&nbsp;apply&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548336">tt</span>&nbsp;<span class="op" id="2548339">:=</span>&nbsp;<span class="op" id="2548342">(</span><span class="op" id="2548343">*</span><span class="ident" id="2548344">structType</span><span class="op" id="2548354">)</span><span class="op" id="2548355">(</span><span class="ident" id="2548356">unsafe</span><span class="op" id="2548362">.</span><span class="ident" id="2548363">Pointer</span><span class="op" id="2548370">(</span><span class="ident" id="2548371">t</span><span class="op" id="2548372">)</span><span class="op" id="2548373">)</span><br>
<span class="lineno">1920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548377">start</span>&nbsp;<span class="op" id="2548383">:=</span>&nbsp;<span class="op" id="2548386">*</span><span class="ident" id="2548387">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2548396">for</span>&nbsp;<span class="ident" id="2548400">i</span>&nbsp;<span class="op" id="2548402">:=</span>&nbsp;<span class="keyword" id="2548405">range</span>&nbsp;<span class="ident" id="2548411">tt</span><span class="op" id="2548413">.</span><span class="ident" id="2548414">fields</span>&nbsp;<span class="op" id="2548421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548426">f</span>&nbsp;<span class="op" id="2548428">:=</span>&nbsp;<span class="op" id="2548431">&amp;</span><span class="ident" id="2548432">tt</span><span class="op" id="2548434">.</span><span class="ident" id="2548435">fields</span><span class="op" id="2548441">[</span><span class="ident" id="2548442">i</span><span class="op" id="2548443">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548448">off</span>&nbsp;<span class="op" id="2548452">:=</span>&nbsp;<span class="ident" id="2548455">start</span>&nbsp;<span class="op" id="2548461">+</span>&nbsp;<span class="ident" id="2548463">f</span><span class="op" id="2548464">.</span><span class="ident" id="2548465">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2548475">addTypeBits</span><span class="op" id="2548486">(</span><span class="ident" id="2548487">bv</span><span class="op" id="2548489">,</span>&nbsp;<span class="op" id="2548491">&amp;</span><span class="ident" id="2548492">off</span><span class="op" id="2548495">,</span>&nbsp;<span class="ident" id="2548497">f</span><span class="op" id="2548498">.</span><span class="ident" id="2548499">typ</span><span class="op" id="2548502">)</span><br>
<span class="lineno">1925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2548506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2548509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2548513">*</span><span class="ident" id="2548514">offset</span>&nbsp;<span class="op" id="2548521">+=</span>&nbsp;<span class="ident" id="2548524">t</span><span class="op" id="2548525">.</span><span class="ident" id="2548526">size</span><br>
<span class="lineno"></span><span class="op" id="2548531">}</span>
</div>
</body>
</html>
