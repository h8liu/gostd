<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html" class="current">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4294430">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4294485">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4294539">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4294590">package</span>&nbsp;<span class="ident" id="4294598">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4294608">import</span>&nbsp;<span class="op" id="4294615">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4294618">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="4294624">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="4294627">//&nbsp;context&nbsp;describes&nbsp;the&nbsp;state&nbsp;an&nbsp;HTML&nbsp;parser&nbsp;must&nbsp;be&nbsp;in&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4294704">//&nbsp;portion&nbsp;of&nbsp;HTML&nbsp;produced&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;particular&nbsp;template&nbsp;node.</span><br>
<span class="lineno"></span><span class="comment" id="4294774">//</span><br>
<span class="lineno"></span><span class="comment" id="4294777">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;context&nbsp;is&nbsp;the&nbsp;start&nbsp;context&nbsp;for&nbsp;a&nbsp;template&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="4294852">//&nbsp;produces&nbsp;an&nbsp;HTML&nbsp;fragment&nbsp;as&nbsp;defined&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4294895">//&nbsp;http://www.w3.org/TR/html5/syntax.html#the-end</span><br>
<span class="lineno"></span><span class="comment" id="4294945">//&nbsp;where&nbsp;the&nbsp;context&nbsp;element&nbsp;is&nbsp;null.</span><br>
<span class="lineno"></span><span class="keyword" id="4294983">type</span>&nbsp;<span class="ident" id="4294988">context</span>&nbsp;<span class="keyword" id="4294996">struct</span>&nbsp;<span class="op" id="4295003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295006">state</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4295014">state</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295021">delim</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4295029">delim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295036">urlPart</span>&nbsp;<span class="ident" id="4295044">urlPart</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295053">jsCtx</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4295061">jsCtx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295068">attr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295076">attr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295082">element</span>&nbsp;<span class="ident" id="4295090">element</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295099">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4295107">*</span><span class="ident" id="4295108">Error</span><br>
<span class="lineno"></span><span class="op" id="4295114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4295117">func</span>&nbsp;<span class="op" id="4295122">(</span><span class="ident" id="4295123">c</span>&nbsp;<span class="ident" id="4295125">context</span><span class="op" id="4295132">)</span>&nbsp;<span class="ident" id="4295134">String</span><span class="op" id="4295140">(</span><span class="op" id="4295141">)</span>&nbsp;<span class="builtintype" id="4295143">string</span>&nbsp;<span class="op" id="4295150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4295153">return</span>&nbsp;<span class="ident" id="4295160">fmt</span><span class="op" id="4295163">.</span><span class="ident" id="4295164">Sprintf</span><span class="op" id="4295171">(</span><span class="string" id="4295172">&#34;{%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v}&#34;</span><span class="op" id="4295196">,</span>&nbsp;<span class="ident" id="4295198">c</span><span class="op" id="4295199">.</span><span class="ident" id="4295200">state</span><span class="op" id="4295205">,</span>&nbsp;<span class="ident" id="4295207">c</span><span class="op" id="4295208">.</span><span class="ident" id="4295209">delim</span><span class="op" id="4295214">,</span>&nbsp;<span class="ident" id="4295216">c</span><span class="op" id="4295217">.</span><span class="ident" id="4295218">urlPart</span><span class="op" id="4295225">,</span>&nbsp;<span class="ident" id="4295227">c</span><span class="op" id="4295228">.</span><span class="ident" id="4295229">jsCtx</span><span class="op" id="4295234">,</span>&nbsp;<span class="ident" id="4295236">c</span><span class="op" id="4295237">.</span><span class="ident" id="4295238">attr</span><span class="op" id="4295242">,</span>&nbsp;<span class="ident" id="4295244">c</span><span class="op" id="4295245">.</span><span class="ident" id="4295246">element</span><span class="op" id="4295253">,</span>&nbsp;<span class="ident" id="4295255">c</span><span class="op" id="4295256">.</span><span class="ident" id="4295257">err</span><span class="op" id="4295260">)</span><br>
<span class="lineno">30</span><span class="op" id="4295262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4295265">//&nbsp;eq&nbsp;reports&nbsp;whether&nbsp;two&nbsp;contexts&nbsp;are&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="4295311">func</span>&nbsp;<span class="op" id="4295316">(</span><span class="ident" id="4295317">c</span>&nbsp;<span class="ident" id="4295319">context</span><span class="op" id="4295326">)</span>&nbsp;<span class="ident" id="4295328">eq</span><span class="op" id="4295330">(</span><span class="ident" id="4295331">d</span>&nbsp;<span class="ident" id="4295333">context</span><span class="op" id="4295340">)</span>&nbsp;<span class="builtintype" id="4295342">bool</span>&nbsp;<span class="op" id="4295347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4295350">return</span>&nbsp;<span class="ident" id="4295357">c</span><span class="op" id="4295358">.</span><span class="ident" id="4295359">state</span>&nbsp;<span class="op" id="4295365">==</span>&nbsp;<span class="ident" id="4295368">d</span><span class="op" id="4295369">.</span><span class="ident" id="4295370">state</span>&nbsp;<span class="op" id="4295376">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295381">c</span><span class="op" id="4295382">.</span><span class="ident" id="4295383">delim</span>&nbsp;<span class="op" id="4295389">==</span>&nbsp;<span class="ident" id="4295392">d</span><span class="op" id="4295393">.</span><span class="ident" id="4295394">delim</span>&nbsp;<span class="op" id="4295400">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295405">c</span><span class="op" id="4295406">.</span><span class="ident" id="4295407">urlPart</span>&nbsp;<span class="op" id="4295415">==</span>&nbsp;<span class="ident" id="4295418">d</span><span class="op" id="4295419">.</span><span class="ident" id="4295420">urlPart</span>&nbsp;<span class="op" id="4295428">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295433">c</span><span class="op" id="4295434">.</span><span class="ident" id="4295435">jsCtx</span>&nbsp;<span class="op" id="4295441">==</span>&nbsp;<span class="ident" id="4295444">d</span><span class="op" id="4295445">.</span><span class="ident" id="4295446">jsCtx</span>&nbsp;<span class="op" id="4295452">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295457">c</span><span class="op" id="4295458">.</span><span class="ident" id="4295459">attr</span>&nbsp;<span class="op" id="4295464">==</span>&nbsp;<span class="ident" id="4295467">d</span><span class="op" id="4295468">.</span><span class="ident" id="4295469">attr</span>&nbsp;<span class="op" id="4295474">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295479">c</span><span class="op" id="4295480">.</span><span class="ident" id="4295481">element</span>&nbsp;<span class="op" id="4295489">==</span>&nbsp;<span class="ident" id="4295492">d</span><span class="op" id="4295493">.</span><span class="ident" id="4295494">element</span>&nbsp;<span class="op" id="4295502">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295507">c</span><span class="op" id="4295508">.</span><span class="ident" id="4295509">err</span>&nbsp;<span class="op" id="4295513">==</span>&nbsp;<span class="ident" id="4295516">d</span><span class="op" id="4295517">.</span><span class="ident" id="4295518">err</span><br>
<span class="lineno"></span><span class="op" id="4295522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4295525">//&nbsp;mangle&nbsp;produces&nbsp;an&nbsp;identifier&nbsp;that&nbsp;includes&nbsp;a&nbsp;suffix&nbsp;that&nbsp;distinguishes&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4295603">//&nbsp;from&nbsp;template&nbsp;names&nbsp;mangled&nbsp;with&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno">45</span><span class="keyword" id="4295659">func</span>&nbsp;<span class="op" id="4295664">(</span><span class="ident" id="4295665">c</span>&nbsp;<span class="ident" id="4295667">context</span><span class="op" id="4295674">)</span>&nbsp;<span class="ident" id="4295676">mangle</span><span class="op" id="4295682">(</span><span class="ident" id="4295683">templateName</span>&nbsp;<span class="builtintype" id="4295696">string</span><span class="op" id="4295702">)</span>&nbsp;<span class="builtintype" id="4295704">string</span>&nbsp;<span class="op" id="4295711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4295714">//&nbsp;The&nbsp;mangled&nbsp;name&nbsp;for&nbsp;the&nbsp;default&nbsp;context&nbsp;is&nbsp;the&nbsp;input&nbsp;templateName.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4295786">if</span>&nbsp;<span class="ident" id="4295789">c</span><span class="op" id="4295790">.</span><span class="ident" id="4295791">state</span>&nbsp;<span class="op" id="4295797">==</span>&nbsp;<span class="ident" id="4295800">stateText</span>&nbsp;<span class="op" id="4295810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4295814">return</span>&nbsp;<span class="ident" id="4295821">templateName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4295835">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295838">s</span>&nbsp;<span class="op" id="4295840">:=</span>&nbsp;<span class="ident" id="4295843">templateName</span>&nbsp;<span class="op" id="4295856">+</span>&nbsp;<span class="string" id="4295858">&#34;$htmltemplate_&#34;</span>&nbsp;<span class="op" id="4295875">+</span>&nbsp;<span class="ident" id="4295877">c</span><span class="op" id="4295878">.</span><span class="ident" id="4295879">state</span><span class="op" id="4295884">.</span><span class="ident" id="4295885">String</span><span class="op" id="4295891">(</span><span class="op" id="4295892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4295895">if</span>&nbsp;<span class="ident" id="4295898">c</span><span class="op" id="4295899">.</span><span class="ident" id="4295900">delim</span>&nbsp;<span class="op" id="4295906">!=</span>&nbsp;<span class="num" id="4295909">0</span>&nbsp;<span class="op" id="4295911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295915">s</span>&nbsp;<span class="op" id="4295917">+=</span>&nbsp;<span class="string" id="4295920">&#34;_&#34;</span>&nbsp;<span class="op" id="4295924">+</span>&nbsp;<span class="ident" id="4295926">c</span><span class="op" id="4295927">.</span><span class="ident" id="4295928">delim</span><span class="op" id="4295933">.</span><span class="ident" id="4295934">String</span><span class="op" id="4295940">(</span><span class="op" id="4295941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4295944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4295947">if</span>&nbsp;<span class="ident" id="4295950">c</span><span class="op" id="4295951">.</span><span class="ident" id="4295952">urlPart</span>&nbsp;<span class="op" id="4295960">!=</span>&nbsp;<span class="num" id="4295963">0</span>&nbsp;<span class="op" id="4295965">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4295969">s</span>&nbsp;<span class="op" id="4295971">+=</span>&nbsp;<span class="string" id="4295974">&#34;_&#34;</span>&nbsp;<span class="op" id="4295978">+</span>&nbsp;<span class="ident" id="4295980">c</span><span class="op" id="4295981">.</span><span class="ident" id="4295982">urlPart</span><span class="op" id="4295989">.</span><span class="ident" id="4295990">String</span><span class="op" id="4295996">(</span><span class="op" id="4295997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4296000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4296003">if</span>&nbsp;<span class="ident" id="4296006">c</span><span class="op" id="4296007">.</span><span class="ident" id="4296008">jsCtx</span>&nbsp;<span class="op" id="4296014">!=</span>&nbsp;<span class="num" id="4296017">0</span>&nbsp;<span class="op" id="4296019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4296023">s</span>&nbsp;<span class="op" id="4296025">+=</span>&nbsp;<span class="string" id="4296028">&#34;_&#34;</span>&nbsp;<span class="op" id="4296032">+</span>&nbsp;<span class="ident" id="4296034">c</span><span class="op" id="4296035">.</span><span class="ident" id="4296036">jsCtx</span><span class="op" id="4296041">.</span><span class="ident" id="4296042">String</span><span class="op" id="4296048">(</span><span class="op" id="4296049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4296052">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4296055">if</span>&nbsp;<span class="ident" id="4296058">c</span><span class="op" id="4296059">.</span><span class="ident" id="4296060">attr</span>&nbsp;<span class="op" id="4296065">!=</span>&nbsp;<span class="num" id="4296068">0</span>&nbsp;<span class="op" id="4296070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4296074">s</span>&nbsp;<span class="op" id="4296076">+=</span>&nbsp;<span class="string" id="4296079">&#34;_&#34;</span>&nbsp;<span class="op" id="4296083">+</span>&nbsp;<span class="ident" id="4296085">c</span><span class="op" id="4296086">.</span><span class="ident" id="4296087">attr</span><span class="op" id="4296091">.</span><span class="ident" id="4296092">String</span><span class="op" id="4296098">(</span><span class="op" id="4296099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4296102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4296105">if</span>&nbsp;<span class="ident" id="4296108">c</span><span class="op" id="4296109">.</span><span class="ident" id="4296110">element</span>&nbsp;<span class="op" id="4296118">!=</span>&nbsp;<span class="num" id="4296121">0</span>&nbsp;<span class="op" id="4296123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4296127">s</span>&nbsp;<span class="op" id="4296129">+=</span>&nbsp;<span class="string" id="4296132">&#34;_&#34;</span>&nbsp;<span class="op" id="4296136">+</span>&nbsp;<span class="ident" id="4296138">c</span><span class="op" id="4296139">.</span><span class="ident" id="4296140">element</span><span class="op" id="4296147">.</span><span class="ident" id="4296148">String</span><span class="op" id="4296154">(</span><span class="op" id="4296155">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4296158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4296161">return</span>&nbsp;<span class="ident" id="4296168">s</span><br>
<span class="lineno"></span><span class="op" id="4296170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4296173">//&nbsp;state&nbsp;describes&nbsp;a&nbsp;high-level&nbsp;HTML&nbsp;parser&nbsp;state.</span><br>
<span class="lineno">70</span><span class="comment" id="4296224">//</span><br>
<span class="lineno"></span><span class="comment" id="4296227">//&nbsp;It&nbsp;bounds&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;element&nbsp;stack,&nbsp;and&nbsp;by&nbsp;extension&nbsp;the&nbsp;HTML&nbsp;insertion</span><br>
<span class="lineno"></span><span class="comment" id="4296306">//&nbsp;mode,&nbsp;but&nbsp;also&nbsp;contains&nbsp;state&nbsp;that&nbsp;does&nbsp;not&nbsp;correspond&nbsp;to&nbsp;anything&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4296383">//&nbsp;HTML5&nbsp;parsing&nbsp;algorithm&nbsp;because&nbsp;a&nbsp;single&nbsp;token&nbsp;production&nbsp;in&nbsp;the&nbsp;HTML</span><br>
<span class="lineno"></span><span class="comment" id="4296456">//&nbsp;grammar&nbsp;may&nbsp;contain&nbsp;embedded&nbsp;actions&nbsp;in&nbsp;a&nbsp;template.&nbsp;For&nbsp;instance,&nbsp;the&nbsp;quoted</span><br>
<span class="lineno">75</span><span class="comment" id="4296536">//&nbsp;HTML&nbsp;attribute&nbsp;produced&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4296566">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;title=&#34;Hello&nbsp;{{.World}}&#34;&gt;</span><br>
<span class="lineno"></span><span class="comment" id="4296604">//&nbsp;is&nbsp;a&nbsp;single&nbsp;token&nbsp;in&nbsp;HTML&#39;s&nbsp;grammar&nbsp;but&nbsp;in&nbsp;a&nbsp;template&nbsp;spans&nbsp;several&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="4296682">type</span>&nbsp;<span class="ident" id="4296687">state</span>&nbsp;<span class="builtintype" id="4296693">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="4296700">const</span>&nbsp;<span class="op" id="4296706">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4296709">//&nbsp;stateText&nbsp;is&nbsp;parsed&nbsp;character&nbsp;data.&nbsp;An&nbsp;HTML&nbsp;parser&nbsp;is&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4296770">//&nbsp;this&nbsp;state&nbsp;when&nbsp;its&nbsp;parse&nbsp;position&nbsp;is&nbsp;outside&nbsp;an&nbsp;HTML&nbsp;tag,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4296833">//&nbsp;directive,&nbsp;comment,&nbsp;and&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4296883">stateText</span>&nbsp;<span class="ident" id="4296893">state</span>&nbsp;<span class="op" id="4296899">=</span>&nbsp;<span class="ident" id="4296901">iota</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4296907">//&nbsp;stateTag&nbsp;occurs&nbsp;before&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;or&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4296973">stateTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4296983">//&nbsp;stateAttrName&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;attribute&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4297034">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;^name^&nbsp;=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4297086">stateAttrName</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4297101">//&nbsp;stateAfterName&nbsp;occurs&nbsp;after&nbsp;an&nbsp;attr&nbsp;name&nbsp;has&nbsp;ended&nbsp;but&nbsp;before&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4297171">//&nbsp;equals&nbsp;sign.&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name^&nbsp;^=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4297236">stateAfterName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4297252">//&nbsp;stateBeforeValue&nbsp;occurs&nbsp;after&nbsp;the&nbsp;equals&nbsp;sign&nbsp;but&nbsp;before&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4297324">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name&nbsp;=^&nbsp;^value`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4297376">stateBeforeValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4297394">//&nbsp;stateHTMLCmt&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;&lt;!--&nbsp;HTML&nbsp;comment&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4297451">stateHTMLCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4297465">//&nbsp;stateRCDATA&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;RCDATA&nbsp;element&nbsp;(&lt;textarea&gt;&nbsp;or&nbsp;&lt;title&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4297537">//&nbsp;as&nbsp;described&nbsp;at&nbsp;http://www.w3.org/TR/html5/syntax.html#elements-0</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4297607">stateRCDATA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4297620">//&nbsp;stateAttr&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4297689">stateAttr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4297700">//&nbsp;stateURL&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4297769">stateURL</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4297779">//&nbsp;stateJS&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;event&nbsp;handler&nbsp;or&nbsp;script&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4297841">stateJS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4297850">//&nbsp;stateJSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4297916">stateJSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4297930">//&nbsp;stateJSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4297996">stateJSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4298010">//&nbsp;stateJSRegexp&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4298071">stateJSRegexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4298086">//&nbsp;stateJSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4298154">stateJSBlockCmt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4298171">//&nbsp;stateJSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4298234">stateJSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4298250">//&nbsp;stateCSS&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;&lt;style&gt;&nbsp;element&nbsp;or&nbsp;style&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4298315">stateCSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4298325">//&nbsp;stateCSSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4298385">stateCSSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4298400">//&nbsp;stateCSSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4298460">stateCSSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4298475">//&nbsp;stateCSSDqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;url(&#34;...&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4298539">stateCSSDqURL</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4298554">//&nbsp;stateCSSSqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;url(&#39;...&#39;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4298618">stateCSSSqURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4298633">//&nbsp;stateCSSURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;unquoted&nbsp;url(...).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4298688">stateCSSURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4298701">//&nbsp;stateCSSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4298763">stateCSSBlockCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4298781">//&nbsp;stateCSSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4298838">stateCSSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4298855">//&nbsp;stateError&nbsp;is&nbsp;an&nbsp;infectious&nbsp;error&nbsp;state&nbsp;outside&nbsp;any&nbsp;valid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4298917">//&nbsp;HTML/CSS/JS&nbsp;construct.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4298944">stateError</span><br>
<span class="lineno"></span><span class="op" id="4298955">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4298958">var</span>&nbsp;<span class="ident" id="4298962">stateNames</span>&nbsp;<span class="op" id="4298973">=</span>&nbsp;<span class="op" id="4298975">[</span><span class="op" id="4298976">...</span><span class="op" id="4298979">]</span><span class="builtintype" id="4298980">string</span><span class="op" id="4298986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4298989">stateText</span><span class="op" id="4298998">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299007">&#34;stateText&#34;</span><span class="op" id="4299018">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299021">stateTag</span><span class="op" id="4299029">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299039">&#34;stateTag&#34;</span><span class="op" id="4299049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299052">stateAttrName</span><span class="op" id="4299065">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299070">&#34;stateAttrName&#34;</span><span class="op" id="4299085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299088">stateAfterName</span><span class="op" id="4299102">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4299106">&#34;stateAfterName&#34;</span><span class="op" id="4299122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299125">stateBeforeValue</span><span class="op" id="4299141">:</span>&nbsp;<span class="string" id="4299143">&#34;stateBeforeValue&#34;</span><span class="op" id="4299161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299164">stateHTMLCmt</span><span class="op" id="4299176">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299182">&#34;stateHTMLCmt&#34;</span><span class="op" id="4299196">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299199">stateRCDATA</span><span class="op" id="4299210">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299217">&#34;stateRCDATA&#34;</span><span class="op" id="4299230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299233">stateAttr</span><span class="op" id="4299242">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299251">&#34;stateAttr&#34;</span><span class="op" id="4299262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299265">stateURL</span><span class="op" id="4299273">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299283">&#34;stateURL&#34;</span><span class="op" id="4299293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299296">stateJS</span><span class="op" id="4299303">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299314">&#34;stateJS&#34;</span><span class="op" id="4299323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299326">stateJSDqStr</span><span class="op" id="4299338">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299344">&#34;stateJSDqStr&#34;</span><span class="op" id="4299358">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299361">stateJSSqStr</span><span class="op" id="4299373">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299379">&#34;stateJSSqStr&#34;</span><span class="op" id="4299393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299396">stateJSRegexp</span><span class="op" id="4299409">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299414">&#34;stateJSRegexp&#34;</span><span class="op" id="4299429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299432">stateJSBlockCmt</span><span class="op" id="4299447">:</span>&nbsp;&nbsp;<span class="string" id="4299450">&#34;stateJSBlockCmt&#34;</span><span class="op" id="4299467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299470">stateJSLineCmt</span><span class="op" id="4299484">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4299488">&#34;stateJSLineCmt&#34;</span><span class="op" id="4299504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299507">stateCSS</span><span class="op" id="4299515">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299525">&#34;stateCSS&#34;</span><span class="op" id="4299535">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299538">stateCSSDqStr</span><span class="op" id="4299551">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299556">&#34;stateCSSDqStr&#34;</span><span class="op" id="4299571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299574">stateCSSSqStr</span><span class="op" id="4299587">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299592">&#34;stateCSSSqStr&#34;</span><span class="op" id="4299607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299610">stateCSSDqURL</span><span class="op" id="4299623">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299628">&#34;stateCSSDqURL&#34;</span><span class="op" id="4299643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299646">stateCSSSqURL</span><span class="op" id="4299659">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299664">&#34;stateCSSSqURL&#34;</span><span class="op" id="4299679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299682">stateCSSURL</span><span class="op" id="4299693">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299700">&#34;stateCSSURL&#34;</span><span class="op" id="4299713">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299716">stateCSSBlockCmt</span><span class="op" id="4299732">:</span>&nbsp;<span class="string" id="4299734">&#34;stateCSSBlockCmt&#34;</span><span class="op" id="4299752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299755">stateCSSLineCmt</span><span class="op" id="4299770">:</span>&nbsp;&nbsp;<span class="string" id="4299773">&#34;stateCSSLineCmt&#34;</span><span class="op" id="4299790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4299793">stateError</span><span class="op" id="4299803">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4299811">&#34;stateError&#34;</span><span class="op" id="4299823">,</span><br>
<span class="lineno"></span><span class="op" id="4299825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="4299828">func</span>&nbsp;<span class="op" id="4299833">(</span><span class="ident" id="4299834">s</span>&nbsp;<span class="ident" id="4299836">state</span><span class="op" id="4299841">)</span>&nbsp;<span class="ident" id="4299843">String</span><span class="op" id="4299849">(</span><span class="op" id="4299850">)</span>&nbsp;<span class="builtintype" id="4299852">string</span>&nbsp;<span class="op" id="4299859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4299862">if</span>&nbsp;<span class="builtintype" id="4299865">int</span><span class="op" id="4299868">(</span><span class="ident" id="4299869">s</span><span class="op" id="4299870">)</span>&nbsp;<span class="op" id="4299872">&lt;</span>&nbsp;<span class="builtinfunc" id="4299874">len</span><span class="op" id="4299877">(</span><span class="ident" id="4299878">stateNames</span><span class="op" id="4299888">)</span>&nbsp;<span class="op" id="4299890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4299894">return</span>&nbsp;<span class="ident" id="4299901">stateNames</span><span class="op" id="4299911">[</span><span class="ident" id="4299912">s</span><span class="op" id="4299913">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4299916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4299919">return</span>&nbsp;<span class="ident" id="4299926">fmt</span><span class="op" id="4299929">.</span><span class="ident" id="4299930">Sprintf</span><span class="op" id="4299937">(</span><span class="string" id="4299938">&#34;illegal&nbsp;state&nbsp;%d&#34;</span><span class="op" id="4299956">,</span>&nbsp;<span class="builtintype" id="4299958">int</span><span class="op" id="4299961">(</span><span class="ident" id="4299962">s</span><span class="op" id="4299963">)</span><span class="op" id="4299964">)</span><br>
<span class="lineno">170</span><span class="op" id="4299966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4299969">//&nbsp;isComment&nbsp;is&nbsp;true&nbsp;for&nbsp;any&nbsp;state&nbsp;that&nbsp;contains&nbsp;content&nbsp;meant&nbsp;for&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="4300045">//&nbsp;authors&nbsp;&amp;&nbsp;maintainers,&nbsp;not&nbsp;for&nbsp;end-users&nbsp;or&nbsp;machines.</span><br>
<span class="lineno"></span><span class="keyword" id="4300102">func</span>&nbsp;<span class="ident" id="4300107">isComment</span><span class="op" id="4300116">(</span><span class="ident" id="4300117">s</span>&nbsp;<span class="ident" id="4300119">state</span><span class="op" id="4300124">)</span>&nbsp;<span class="builtintype" id="4300126">bool</span>&nbsp;<span class="op" id="4300131">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4300134">switch</span>&nbsp;<span class="ident" id="4300141">s</span>&nbsp;<span class="op" id="4300143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4300146">case</span>&nbsp;<span class="ident" id="4300151">stateHTMLCmt</span><span class="op" id="4300163">,</span>&nbsp;<span class="ident" id="4300165">stateJSBlockCmt</span><span class="op" id="4300180">,</span>&nbsp;<span class="ident" id="4300182">stateJSLineCmt</span><span class="op" id="4300196">,</span>&nbsp;<span class="ident" id="4300198">stateCSSBlockCmt</span><span class="op" id="4300214">,</span>&nbsp;<span class="ident" id="4300216">stateCSSLineCmt</span><span class="op" id="4300231">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4300235">return</span>&nbsp;<span class="builtintype" id="4300242">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4300248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4300251">return</span>&nbsp;<span class="builtintype" id="4300258">false</span><br>
<span class="lineno">180</span><span class="op" id="4300264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4300267">//&nbsp;isInTag&nbsp;return&nbsp;whether&nbsp;s&nbsp;occurs&nbsp;solely&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="4300329">func</span>&nbsp;<span class="ident" id="4300334">isInTag</span><span class="op" id="4300341">(</span><span class="ident" id="4300342">s</span>&nbsp;<span class="ident" id="4300344">state</span><span class="op" id="4300349">)</span>&nbsp;<span class="builtintype" id="4300351">bool</span>&nbsp;<span class="op" id="4300356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4300359">switch</span>&nbsp;<span class="ident" id="4300366">s</span>&nbsp;<span class="op" id="4300368">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4300371">case</span>&nbsp;<span class="ident" id="4300376">stateTag</span><span class="op" id="4300384">,</span>&nbsp;<span class="ident" id="4300386">stateAttrName</span><span class="op" id="4300399">,</span>&nbsp;<span class="ident" id="4300401">stateAfterName</span><span class="op" id="4300415">,</span>&nbsp;<span class="ident" id="4300417">stateBeforeValue</span><span class="op" id="4300433">,</span>&nbsp;<span class="ident" id="4300435">stateAttr</span><span class="op" id="4300444">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4300448">return</span>&nbsp;<span class="builtintype" id="4300455">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4300461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4300464">return</span>&nbsp;<span class="builtintype" id="4300471">false</span><br>
<span class="lineno"></span><span class="op" id="4300477">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4300480">//&nbsp;delim&nbsp;is&nbsp;the&nbsp;delimiter&nbsp;that&nbsp;will&nbsp;end&nbsp;the&nbsp;current&nbsp;HTML&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="4300548">type</span>&nbsp;<span class="ident" id="4300553">delim</span>&nbsp;<span class="builtintype" id="4300559">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4300566">const</span>&nbsp;<span class="op" id="4300572">(</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4300575">//&nbsp;delimNone&nbsp;occurs&nbsp;outside&nbsp;any&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4300619">delimNone</span>&nbsp;<span class="ident" id="4300629">delim</span>&nbsp;<span class="op" id="4300635">=</span>&nbsp;<span class="ident" id="4300637">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4300643">//&nbsp;delimDoubleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;double&nbsp;quote&nbsp;(&#34;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4300717">delimDoubleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4300735">//&nbsp;delimSingleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;single&nbsp;quote&nbsp;(&#39;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4300809">delimSingleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4300827">//&nbsp;delimSpaceOrTagEnd&nbsp;occurs&nbsp;when&nbsp;a&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket&nbsp;(&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4300897">//&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4300923">delimSpaceOrTagEnd</span><br>
<span class="lineno"></span><span class="op" id="4300942">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="4300945">var</span>&nbsp;<span class="ident" id="4300949">delimNames</span>&nbsp;<span class="op" id="4300960">=</span>&nbsp;<span class="op" id="4300962">[</span><span class="op" id="4300963">...</span><span class="op" id="4300966">]</span><span class="builtintype" id="4300967">string</span><span class="op" id="4300973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4300976">delimNone</span><span class="op" id="4300985">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4300996">&#34;delimNone&#34;</span><span class="op" id="4301007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4301010">delimDoubleQuote</span><span class="op" id="4301026">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4301030">&#34;delimDoubleQuote&#34;</span><span class="op" id="4301048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4301051">delimSingleQuote</span><span class="op" id="4301067">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4301071">&#34;delimSingleQuote&#34;</span><span class="op" id="4301089">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4301092">delimSpaceOrTagEnd</span><span class="op" id="4301110">:</span>&nbsp;<span class="string" id="4301112">&#34;delimSpaceOrTagEnd&#34;</span><span class="op" id="4301132">,</span><br>
<span class="lineno"></span><span class="op" id="4301134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4301137">func</span>&nbsp;<span class="op" id="4301142">(</span><span class="ident" id="4301143">d</span>&nbsp;<span class="ident" id="4301145">delim</span><span class="op" id="4301150">)</span>&nbsp;<span class="ident" id="4301152">String</span><span class="op" id="4301158">(</span><span class="op" id="4301159">)</span>&nbsp;<span class="builtintype" id="4301161">string</span>&nbsp;<span class="op" id="4301168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4301171">if</span>&nbsp;<span class="builtintype" id="4301174">int</span><span class="op" id="4301177">(</span><span class="ident" id="4301178">d</span><span class="op" id="4301179">)</span>&nbsp;<span class="op" id="4301181">&lt;</span>&nbsp;<span class="builtinfunc" id="4301183">len</span><span class="op" id="4301186">(</span><span class="ident" id="4301187">delimNames</span><span class="op" id="4301197">)</span>&nbsp;<span class="op" id="4301199">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4301203">return</span>&nbsp;<span class="ident" id="4301210">delimNames</span><span class="op" id="4301220">[</span><span class="ident" id="4301221">d</span><span class="op" id="4301222">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4301225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4301228">return</span>&nbsp;<span class="ident" id="4301235">fmt</span><span class="op" id="4301238">.</span><span class="ident" id="4301239">Sprintf</span><span class="op" id="4301246">(</span><span class="string" id="4301247">&#34;illegal&nbsp;delim&nbsp;%d&#34;</span><span class="op" id="4301265">,</span>&nbsp;<span class="builtintype" id="4301267">int</span><span class="op" id="4301270">(</span><span class="ident" id="4301271">d</span><span class="op" id="4301272">)</span><span class="op" id="4301273">)</span><br>
<span class="lineno"></span><span class="op" id="4301275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="4301278">//&nbsp;urlPart&nbsp;identifies&nbsp;a&nbsp;part&nbsp;in&nbsp;an&nbsp;RFC&nbsp;3986&nbsp;hierarchical&nbsp;URL&nbsp;to&nbsp;allow&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="4301358">//&nbsp;encoding&nbsp;strategies.</span><br>
<span class="lineno"></span><span class="keyword" id="4301382">type</span>&nbsp;<span class="ident" id="4301387">urlPart</span>&nbsp;<span class="builtintype" id="4301395">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4301402">const</span>&nbsp;<span class="op" id="4301408">(</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4301411">//&nbsp;urlPartNone&nbsp;occurs&nbsp;when&nbsp;not&nbsp;in&nbsp;a&nbsp;URL,&nbsp;or&nbsp;possibly&nbsp;at&nbsp;the&nbsp;start:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4301479">//&nbsp;^&nbsp;in&nbsp;&#34;^http://auth/path?k=v#frag&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4301518">urlPartNone</span>&nbsp;<span class="ident" id="4301530">urlPart</span>&nbsp;<span class="op" id="4301538">=</span>&nbsp;<span class="ident" id="4301540">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4301546">//&nbsp;urlPartPreQuery&nbsp;occurs&nbsp;in&nbsp;the&nbsp;scheme,&nbsp;authority,&nbsp;or&nbsp;path;&nbsp;between&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4301620">//&nbsp;^s&nbsp;in&nbsp;&#34;h^ttp://auth/path^?k=v#frag&#34;.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4301661">urlPartPreQuery</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4301678">//&nbsp;urlPartQueryOrFrag&nbsp;occurs&nbsp;in&nbsp;the&nbsp;query&nbsp;portion&nbsp;between&nbsp;the&nbsp;^s&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4301747">//&nbsp;&#34;http://auth/path?^k=v#frag^&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4301782">urlPartQueryOrFrag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4301802">//&nbsp;urlPartUnknown&nbsp;occurs&nbsp;due&nbsp;to&nbsp;joining&nbsp;of&nbsp;contexts&nbsp;both&nbsp;before&nbsp;and</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4301871">//&nbsp;after&nbsp;the&nbsp;query&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4301902">urlPartUnknown</span><br>
<span class="lineno"></span><span class="op" id="4301917">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4301920">var</span>&nbsp;<span class="ident" id="4301924">urlPartNames</span>&nbsp;<span class="op" id="4301937">=</span>&nbsp;<span class="op" id="4301939">[</span><span class="op" id="4301940">...</span><span class="op" id="4301943">]</span><span class="builtintype" id="4301944">string</span><span class="op" id="4301950">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4301953">urlPartNone</span><span class="op" id="4301964">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4301973">&#34;urlPartNone&#34;</span><span class="op" id="4301986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4301989">urlPartPreQuery</span><span class="op" id="4302004">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4302009">&#34;urlPartPreQuery&#34;</span><span class="op" id="4302026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4302029">urlPartQueryOrFrag</span><span class="op" id="4302047">:</span>&nbsp;<span class="string" id="4302049">&#34;urlPartQueryOrFrag&#34;</span><span class="op" id="4302069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4302072">urlPartUnknown</span><span class="op" id="4302086">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4302092">&#34;urlPartUnknown&#34;</span><span class="op" id="4302108">,</span><br>
<span class="lineno"></span><span class="op" id="4302110">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4302113">func</span>&nbsp;<span class="op" id="4302118">(</span><span class="ident" id="4302119">u</span>&nbsp;<span class="ident" id="4302121">urlPart</span><span class="op" id="4302128">)</span>&nbsp;<span class="ident" id="4302130">String</span><span class="op" id="4302136">(</span><span class="op" id="4302137">)</span>&nbsp;<span class="builtintype" id="4302139">string</span>&nbsp;<span class="op" id="4302146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4302149">if</span>&nbsp;<span class="builtintype" id="4302152">int</span><span class="op" id="4302155">(</span><span class="ident" id="4302156">u</span><span class="op" id="4302157">)</span>&nbsp;<span class="op" id="4302159">&lt;</span>&nbsp;<span class="builtinfunc" id="4302161">len</span><span class="op" id="4302164">(</span><span class="ident" id="4302165">urlPartNames</span><span class="op" id="4302177">)</span>&nbsp;<span class="op" id="4302179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4302183">return</span>&nbsp;<span class="ident" id="4302190">urlPartNames</span><span class="op" id="4302202">[</span><span class="ident" id="4302203">u</span><span class="op" id="4302204">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4302207">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4302210">return</span>&nbsp;<span class="ident" id="4302217">fmt</span><span class="op" id="4302220">.</span><span class="ident" id="4302221">Sprintf</span><span class="op" id="4302228">(</span><span class="string" id="4302229">&#34;illegal&nbsp;urlPart&nbsp;%d&#34;</span><span class="op" id="4302249">,</span>&nbsp;<span class="builtintype" id="4302251">int</span><span class="op" id="4302254">(</span><span class="ident" id="4302255">u</span><span class="op" id="4302256">)</span><span class="op" id="4302257">)</span><br>
<span class="lineno"></span><span class="op" id="4302259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4302262">//&nbsp;jsCtx&nbsp;determines&nbsp;whether&nbsp;a&nbsp;&#39;/&#39;&nbsp;starts&nbsp;a&nbsp;regular&nbsp;expression&nbsp;literal&nbsp;or&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4302337">//&nbsp;division&nbsp;operator.</span><br>
<span class="lineno">255</span><span class="keyword" id="4302359">type</span>&nbsp;<span class="ident" id="4302364">jsCtx</span>&nbsp;<span class="builtintype" id="4302370">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4302377">const</span>&nbsp;<span class="op" id="4302383">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4302386">//&nbsp;jsCtxRegexp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4302451">jsCtxRegexp</span>&nbsp;<span class="ident" id="4302463">jsCtx</span>&nbsp;<span class="op" id="4302469">=</span>&nbsp;<span class="ident" id="4302471">iota</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4302477">//&nbsp;jsCtxDivOp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;division&nbsp;operator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4302544">jsCtxDivOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4302556">//&nbsp;jsCtxUnknown&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;is&nbsp;ambiguous&nbsp;due&nbsp;to&nbsp;context&nbsp;joining.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4302629">jsCtxUnknown</span><br>
<span class="lineno"></span><span class="op" id="4302642">)</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4302645">func</span>&nbsp;<span class="op" id="4302650">(</span><span class="ident" id="4302651">c</span>&nbsp;<span class="ident" id="4302653">jsCtx</span><span class="op" id="4302658">)</span>&nbsp;<span class="ident" id="4302660">String</span><span class="op" id="4302666">(</span><span class="op" id="4302667">)</span>&nbsp;<span class="builtintype" id="4302669">string</span>&nbsp;<span class="op" id="4302676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4302679">switch</span>&nbsp;<span class="ident" id="4302686">c</span>&nbsp;<span class="op" id="4302688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4302691">case</span>&nbsp;<span class="ident" id="4302696">jsCtxRegexp</span><span class="op" id="4302707">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4302711">return</span>&nbsp;<span class="string" id="4302718">&#34;jsCtxRegexp&#34;</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4302733">case</span>&nbsp;<span class="ident" id="4302738">jsCtxDivOp</span><span class="op" id="4302748">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4302752">return</span>&nbsp;<span class="string" id="4302759">&#34;jsCtxDivOp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4302773">case</span>&nbsp;<span class="ident" id="4302778">jsCtxUnknown</span><span class="op" id="4302790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4302794">return</span>&nbsp;<span class="string" id="4302801">&#34;jsCtxUnknown&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4302817">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4302820">return</span>&nbsp;<span class="ident" id="4302827">fmt</span><span class="op" id="4302830">.</span><span class="ident" id="4302831">Sprintf</span><span class="op" id="4302838">(</span><span class="string" id="4302839">&#34;illegal&nbsp;jsCtx&nbsp;%d&#34;</span><span class="op" id="4302857">,</span>&nbsp;<span class="builtintype" id="4302859">int</span><span class="op" id="4302862">(</span><span class="ident" id="4302863">c</span><span class="op" id="4302864">)</span><span class="op" id="4302865">)</span><br>
<span class="lineno"></span><span class="op" id="4302867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4302870">//&nbsp;element&nbsp;identifies&nbsp;the&nbsp;HTML&nbsp;element&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag&nbsp;or&nbsp;special&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="4302950">//&nbsp;Certain&nbsp;HTML&nbsp;element&nbsp;(for&nbsp;example&nbsp;&lt;script&gt;&nbsp;and&nbsp;&lt;style&gt;)&nbsp;have&nbsp;bodies&nbsp;that&nbsp;are</span><br>
<span class="lineno">280</span><span class="comment" id="4303030">//&nbsp;treated&nbsp;differently&nbsp;from&nbsp;stateText&nbsp;so&nbsp;the&nbsp;element&nbsp;type&nbsp;is&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4303104">//&nbsp;transition&nbsp;into&nbsp;the&nbsp;correct&nbsp;context&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag&nbsp;and&nbsp;to&nbsp;identify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4303183">//&nbsp;end&nbsp;delimiter&nbsp;for&nbsp;the&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="4303214">type</span>&nbsp;<span class="ident" id="4303219">element</span>&nbsp;<span class="builtintype" id="4303227">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="4303234">const</span>&nbsp;<span class="op" id="4303240">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4303243">//&nbsp;elementNone&nbsp;occurs&nbsp;outside&nbsp;a&nbsp;special&nbsp;tag&nbsp;or&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4303313">elementNone</span>&nbsp;<span class="ident" id="4303325">element</span>&nbsp;<span class="op" id="4303333">=</span>&nbsp;<span class="ident" id="4303335">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4303341">//&nbsp;elementScript&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;script&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4303405">elementScript</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4303420">//&nbsp;elementStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;style&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4303482">elementStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4303496">//&nbsp;elementTextarea&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;textarea&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4303562">elementTextarea</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4303579">//&nbsp;elementTitle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;title&gt;&nbsp;element.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4303639">elementTitle</span><br>
<span class="lineno"></span><span class="op" id="4303652">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4303655">var</span>&nbsp;<span class="ident" id="4303659">elementNames</span>&nbsp;<span class="op" id="4303672">=</span>&nbsp;<span class="op" id="4303674">[</span><span class="op" id="4303675">...</span><span class="op" id="4303678">]</span><span class="builtintype" id="4303679">string</span><span class="op" id="4303685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4303688">elementNone</span><span class="op" id="4303699">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4303705">&#34;elementNone&#34;</span><span class="op" id="4303718">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4303721">elementScript</span><span class="op" id="4303734">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4303738">&#34;elementScript&#34;</span><span class="op" id="4303753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4303756">elementStyle</span><span class="op" id="4303768">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4303773">&#34;elementStyle&#34;</span><span class="op" id="4303787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4303790">elementTextarea</span><span class="op" id="4303805">:</span>&nbsp;<span class="string" id="4303807">&#34;elementTextarea&#34;</span><span class="op" id="4303824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4303827">elementTitle</span><span class="op" id="4303839">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4303844">&#34;elementTitle&#34;</span><span class="op" id="4303858">,</span><br>
<span class="lineno"></span><span class="op" id="4303860">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="4303863">func</span>&nbsp;<span class="op" id="4303868">(</span><span class="ident" id="4303869">e</span>&nbsp;<span class="ident" id="4303871">element</span><span class="op" id="4303878">)</span>&nbsp;<span class="ident" id="4303880">String</span><span class="op" id="4303886">(</span><span class="op" id="4303887">)</span>&nbsp;<span class="builtintype" id="4303889">string</span>&nbsp;<span class="op" id="4303896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4303899">if</span>&nbsp;<span class="builtintype" id="4303902">int</span><span class="op" id="4303905">(</span><span class="ident" id="4303906">e</span><span class="op" id="4303907">)</span>&nbsp;<span class="op" id="4303909">&lt;</span>&nbsp;<span class="builtinfunc" id="4303911">len</span><span class="op" id="4303914">(</span><span class="ident" id="4303915">elementNames</span><span class="op" id="4303927">)</span>&nbsp;<span class="op" id="4303929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4303933">return</span>&nbsp;<span class="ident" id="4303940">elementNames</span><span class="op" id="4303952">[</span><span class="ident" id="4303953">e</span><span class="op" id="4303954">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4303957">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4303960">return</span>&nbsp;<span class="ident" id="4303967">fmt</span><span class="op" id="4303970">.</span><span class="ident" id="4303971">Sprintf</span><span class="op" id="4303978">(</span><span class="string" id="4303979">&#34;illegal&nbsp;element&nbsp;%d&#34;</span><span class="op" id="4303999">,</span>&nbsp;<span class="builtintype" id="4304001">int</span><span class="op" id="4304004">(</span><span class="ident" id="4304005">e</span><span class="op" id="4304006">)</span><span class="op" id="4304007">)</span><br>
<span class="lineno"></span><span class="op" id="4304009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4304012">//&nbsp;attr&nbsp;identifies&nbsp;the&nbsp;most&nbsp;recent&nbsp;HTML&nbsp;attribute&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="4304087">type</span>&nbsp;<span class="ident" id="4304092">attr</span>&nbsp;<span class="builtintype" id="4304097">uint8</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="4304104">const</span>&nbsp;<span class="op" id="4304110">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4304113">//&nbsp;attrNone&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;normal&nbsp;attribute&nbsp;or&nbsp;no&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4304177">attrNone</span>&nbsp;<span class="ident" id="4304186">attr</span>&nbsp;<span class="op" id="4304191">=</span>&nbsp;<span class="ident" id="4304193">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4304199">//&nbsp;attrScript&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;event&nbsp;handler&nbsp;attribute.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4304257">attrScript</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4304269">//&nbsp;attrStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;style&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;CSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4304338">attrStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4304349">//&nbsp;attrURL&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4304411">attrURL</span><br>
<span class="lineno">325</span><span class="op" id="4304419">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4304422">var</span>&nbsp;<span class="ident" id="4304426">attrNames</span>&nbsp;<span class="op" id="4304436">=</span>&nbsp;<span class="op" id="4304438">[</span><span class="op" id="4304439">...</span><span class="op" id="4304442">]</span><span class="builtintype" id="4304443">string</span><span class="op" id="4304449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4304452">attrNone</span><span class="op" id="4304460">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4304464">&#34;attrNone&#34;</span><span class="op" id="4304474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4304477">attrScript</span><span class="op" id="4304487">:</span>&nbsp;<span class="string" id="4304489">&#34;attrScript&#34;</span><span class="op" id="4304501">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4304504">attrStyle</span><span class="op" id="4304513">:</span>&nbsp;&nbsp;<span class="string" id="4304516">&#34;attrStyle&#34;</span><span class="op" id="4304527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4304530">attrURL</span><span class="op" id="4304537">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4304542">&#34;attrURL&#34;</span><span class="op" id="4304551">,</span><br>
<span class="lineno"></span><span class="op" id="4304553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4304556">func</span>&nbsp;<span class="op" id="4304561">(</span><span class="ident" id="4304562">a</span>&nbsp;<span class="ident" id="4304564">attr</span><span class="op" id="4304568">)</span>&nbsp;<span class="ident" id="4304570">String</span><span class="op" id="4304576">(</span><span class="op" id="4304577">)</span>&nbsp;<span class="builtintype" id="4304579">string</span>&nbsp;<span class="op" id="4304586">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4304589">if</span>&nbsp;<span class="builtintype" id="4304592">int</span><span class="op" id="4304595">(</span><span class="ident" id="4304596">a</span><span class="op" id="4304597">)</span>&nbsp;<span class="op" id="4304599">&lt;</span>&nbsp;<span class="builtinfunc" id="4304601">len</span><span class="op" id="4304604">(</span><span class="ident" id="4304605">attrNames</span><span class="op" id="4304614">)</span>&nbsp;<span class="op" id="4304616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4304620">return</span>&nbsp;<span class="ident" id="4304627">attrNames</span><span class="op" id="4304636">[</span><span class="ident" id="4304637">a</span><span class="op" id="4304638">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4304641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4304644">return</span>&nbsp;<span class="ident" id="4304651">fmt</span><span class="op" id="4304654">.</span><span class="ident" id="4304655">Sprintf</span><span class="op" id="4304662">(</span><span class="string" id="4304663">&#34;illegal&nbsp;attr&nbsp;%d&#34;</span><span class="op" id="4304680">,</span>&nbsp;<span class="builtintype" id="4304682">int</span><span class="op" id="4304685">(</span><span class="ident" id="4304686">a</span><span class="op" id="4304687">)</span><span class="op" id="4304688">)</span><br>
<span class="lineno"></span><span class="op" id="4304690">}</span>
</div>
</body>
</html>
