<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html" class="current">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4112718">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4112774">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4112828">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4112879">package</span>&nbsp;<span class="ident" id="4112887">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4112897">//&nbsp;This&nbsp;is&nbsp;a&nbsp;constant-time,&nbsp;32-bit&nbsp;implementation&nbsp;of&nbsp;P224.&nbsp;See&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="4112972">//&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><span class="comment" id="4112990">//</span><br>
<span class="lineno">10</span><span class="comment" id="4112993">//&nbsp;See&nbsp;http://www.imperialviolet.org/2010/12/04/ecc.html&nbsp;([1])&nbsp;for&nbsp;background.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4113073">import</span>&nbsp;<span class="op" id="4113080">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4113083">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4113094">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4113097">var</span>&nbsp;<span class="ident" id="4113101">p224</span>&nbsp;<span class="ident" id="4113106">p224Curve</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4113117">type</span>&nbsp;<span class="ident" id="4113122">p224Curve</span>&nbsp;<span class="keyword" id="4113132">struct</span>&nbsp;<span class="op" id="4113139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4113142">*</span><span class="ident" id="4113143">CurveParams</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113156">gx</span><span class="op" id="4113158">,</span>&nbsp;<span class="ident" id="4113160">gy</span><span class="op" id="4113162">,</span>&nbsp;<span class="ident" id="4113164">b</span>&nbsp;<span class="ident" id="4113166">p224FieldElement</span><br>
<span class="lineno"></span><span class="op" id="4113183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4113186">func</span>&nbsp;<span class="ident" id="4113191">initP224</span><span class="op" id="4113199">(</span><span class="op" id="4113200">)</span>&nbsp;<span class="op" id="4113202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4113205">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113239">p224</span><span class="op" id="4113243">.</span><span class="ident" id="4113244">CurveParams</span>&nbsp;<span class="op" id="4113256">=</span>&nbsp;<span class="builtinfunc" id="4113258">new</span><span class="op" id="4113261">(</span><span class="ident" id="4113262">CurveParams</span><span class="op" id="4113273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113276">p224</span><span class="op" id="4113280">.</span><span class="ident" id="4113281">P</span><span class="op" id="4113282">,</span>&nbsp;<span class="ident" id="4113284">_</span>&nbsp;<span class="op" id="4113286">=</span>&nbsp;<span class="builtinfunc" id="4113288">new</span><span class="op" id="4113291">(</span><span class="ident" id="4113292">big</span><span class="op" id="4113295">.</span><span class="ident" id="4113296">Int</span><span class="op" id="4113299">)</span><span class="op" id="4113300">.</span><span class="ident" id="4113301">SetString</span><span class="op" id="4113310">(</span><span class="string" id="4113311">&#34;26959946667150639794667015087019630673557916260026308143510066298881&#34;</span><span class="op" id="4113381">,</span>&nbsp;<span class="num" id="4113383">10</span><span class="op" id="4113385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113388">p224</span><span class="op" id="4113392">.</span><span class="ident" id="4113393">N</span><span class="op" id="4113394">,</span>&nbsp;<span class="ident" id="4113396">_</span>&nbsp;<span class="op" id="4113398">=</span>&nbsp;<span class="builtinfunc" id="4113400">new</span><span class="op" id="4113403">(</span><span class="ident" id="4113404">big</span><span class="op" id="4113407">.</span><span class="ident" id="4113408">Int</span><span class="op" id="4113411">)</span><span class="op" id="4113412">.</span><span class="ident" id="4113413">SetString</span><span class="op" id="4113422">(</span><span class="string" id="4113423">&#34;26959946667150639794667015087019625940457807714424391721682722368061&#34;</span><span class="op" id="4113493">,</span>&nbsp;<span class="num" id="4113495">10</span><span class="op" id="4113497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113500">p224</span><span class="op" id="4113504">.</span><span class="ident" id="4113505">B</span><span class="op" id="4113506">,</span>&nbsp;<span class="ident" id="4113508">_</span>&nbsp;<span class="op" id="4113510">=</span>&nbsp;<span class="builtinfunc" id="4113512">new</span><span class="op" id="4113515">(</span><span class="ident" id="4113516">big</span><span class="op" id="4113519">.</span><span class="ident" id="4113520">Int</span><span class="op" id="4113523">)</span><span class="op" id="4113524">.</span><span class="ident" id="4113525">SetString</span><span class="op" id="4113534">(</span><span class="string" id="4113535">&#34;b4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4&#34;</span><span class="op" id="4113593">,</span>&nbsp;<span class="num" id="4113595">16</span><span class="op" id="4113597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113600">p224</span><span class="op" id="4113604">.</span><span class="ident" id="4113605">Gx</span><span class="op" id="4113607">,</span>&nbsp;<span class="ident" id="4113609">_</span>&nbsp;<span class="op" id="4113611">=</span>&nbsp;<span class="builtinfunc" id="4113613">new</span><span class="op" id="4113616">(</span><span class="ident" id="4113617">big</span><span class="op" id="4113620">.</span><span class="ident" id="4113621">Int</span><span class="op" id="4113624">)</span><span class="op" id="4113625">.</span><span class="ident" id="4113626">SetString</span><span class="op" id="4113635">(</span><span class="string" id="4113636">&#34;b70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21&#34;</span><span class="op" id="4113694">,</span>&nbsp;<span class="num" id="4113696">16</span><span class="op" id="4113698">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113701">p224</span><span class="op" id="4113705">.</span><span class="ident" id="4113706">Gy</span><span class="op" id="4113708">,</span>&nbsp;<span class="ident" id="4113710">_</span>&nbsp;<span class="op" id="4113712">=</span>&nbsp;<span class="builtinfunc" id="4113714">new</span><span class="op" id="4113717">(</span><span class="ident" id="4113718">big</span><span class="op" id="4113721">.</span><span class="ident" id="4113722">Int</span><span class="op" id="4113725">)</span><span class="op" id="4113726">.</span><span class="ident" id="4113727">SetString</span><span class="op" id="4113736">(</span><span class="string" id="4113737">&#34;bd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34&#34;</span><span class="op" id="4113795">,</span>&nbsp;<span class="num" id="4113797">16</span><span class="op" id="4113799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113802">p224</span><span class="op" id="4113806">.</span><span class="ident" id="4113807">BitSize</span>&nbsp;<span class="op" id="4113815">=</span>&nbsp;<span class="num" id="4113817">224</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113823">p224FromBig</span><span class="op" id="4113834">(</span><span class="op" id="4113835">&amp;</span><span class="ident" id="4113836">p224</span><span class="op" id="4113840">.</span><span class="ident" id="4113841">gx</span><span class="op" id="4113843">,</span>&nbsp;<span class="ident" id="4113845">p224</span><span class="op" id="4113849">.</span><span class="ident" id="4113850">Gx</span><span class="op" id="4113852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113855">p224FromBig</span><span class="op" id="4113866">(</span><span class="op" id="4113867">&amp;</span><span class="ident" id="4113868">p224</span><span class="op" id="4113872">.</span><span class="ident" id="4113873">gy</span><span class="op" id="4113875">,</span>&nbsp;<span class="ident" id="4113877">p224</span><span class="op" id="4113881">.</span><span class="ident" id="4113882">Gy</span><span class="op" id="4113884">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4113887">p224FromBig</span><span class="op" id="4113898">(</span><span class="op" id="4113899">&amp;</span><span class="ident" id="4113900">p224</span><span class="op" id="4113904">.</span><span class="ident" id="4113905">b</span><span class="op" id="4113906">,</span>&nbsp;<span class="ident" id="4113908">p224</span><span class="op" id="4113912">.</span><span class="ident" id="4113913">B</span><span class="op" id="4113914">)</span><br>
<span class="lineno"></span><span class="op" id="4113916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4113919">//&nbsp;P224&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-224&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2)</span><br>
<span class="lineno"></span><span class="keyword" id="4113998">func</span>&nbsp;<span class="ident" id="4114003">P224</span><span class="op" id="4114007">(</span><span class="op" id="4114008">)</span>&nbsp;<span class="ident" id="4114010">Curve</span>&nbsp;<span class="op" id="4114016">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114019">initonce</span><span class="op" id="4114027">.</span><span class="ident" id="4114028">Do</span><span class="op" id="4114030">(</span><span class="ident" id="4114031">initAll</span><span class="op" id="4114038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114041">return</span>&nbsp;<span class="ident" id="4114048">p224</span><br>
<span class="lineno"></span><span class="op" id="4114053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4114056">func</span>&nbsp;<span class="op" id="4114061">(</span><span class="ident" id="4114062">curve</span>&nbsp;<span class="ident" id="4114068">p224Curve</span><span class="op" id="4114077">)</span>&nbsp;<span class="ident" id="4114079">Params</span><span class="op" id="4114085">(</span><span class="op" id="4114086">)</span>&nbsp;<span class="op" id="4114088">*</span><span class="ident" id="4114089">CurveParams</span>&nbsp;<span class="op" id="4114101">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114104">return</span>&nbsp;<span class="ident" id="4114111">curve</span><span class="op" id="4114116">.</span><span class="ident" id="4114117">CurveParams</span><br>
<span class="lineno"></span><span class="op" id="4114129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4114132">func</span>&nbsp;<span class="op" id="4114137">(</span><span class="ident" id="4114138">curve</span>&nbsp;<span class="ident" id="4114144">p224Curve</span><span class="op" id="4114153">)</span>&nbsp;<span class="ident" id="4114155">IsOnCurve</span><span class="op" id="4114164">(</span><span class="ident" id="4114165">bigX</span><span class="op" id="4114169">,</span>&nbsp;<span class="ident" id="4114171">bigY</span>&nbsp;<span class="op" id="4114176">*</span><span class="ident" id="4114177">big</span><span class="op" id="4114180">.</span><span class="ident" id="4114181">Int</span><span class="op" id="4114184">)</span>&nbsp;<span class="builtintype" id="4114186">bool</span>&nbsp;<span class="op" id="4114191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114194">var</span>&nbsp;<span class="ident" id="4114198">x</span><span class="op" id="4114199">,</span>&nbsp;<span class="ident" id="4114201">y</span>&nbsp;<span class="ident" id="4114203">p224FieldElement</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114221">p224FromBig</span><span class="op" id="4114232">(</span><span class="op" id="4114233">&amp;</span><span class="ident" id="4114234">x</span><span class="op" id="4114235">,</span>&nbsp;<span class="ident" id="4114237">bigX</span><span class="op" id="4114241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114244">p224FromBig</span><span class="op" id="4114255">(</span><span class="op" id="4114256">&amp;</span><span class="ident" id="4114257">y</span><span class="op" id="4114258">,</span>&nbsp;<span class="ident" id="4114260">bigY</span><span class="op" id="4114264">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4114268">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114291">var</span>&nbsp;<span class="ident" id="4114295">tmp</span>&nbsp;<span class="ident" id="4114299">p224LargeFieldElement</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114322">var</span>&nbsp;<span class="ident" id="4114326">x3</span>&nbsp;<span class="ident" id="4114329">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114347">p224Square</span><span class="op" id="4114357">(</span><span class="op" id="4114358">&amp;</span><span class="ident" id="4114359">x3</span><span class="op" id="4114361">,</span>&nbsp;<span class="op" id="4114363">&amp;</span><span class="ident" id="4114364">x</span><span class="op" id="4114365">,</span>&nbsp;<span class="op" id="4114367">&amp;</span><span class="ident" id="4114368">tmp</span><span class="op" id="4114371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114374">p224Mul</span><span class="op" id="4114381">(</span><span class="op" id="4114382">&amp;</span><span class="ident" id="4114383">x3</span><span class="op" id="4114385">,</span>&nbsp;<span class="op" id="4114387">&amp;</span><span class="ident" id="4114388">x3</span><span class="op" id="4114390">,</span>&nbsp;<span class="op" id="4114392">&amp;</span><span class="ident" id="4114393">x</span><span class="op" id="4114394">,</span>&nbsp;<span class="op" id="4114396">&amp;</span><span class="ident" id="4114397">tmp</span><span class="op" id="4114400">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114404">for</span>&nbsp;<span class="ident" id="4114408">i</span>&nbsp;<span class="op" id="4114410">:=</span>&nbsp;<span class="num" id="4114413">0</span><span class="op" id="4114414">;</span>&nbsp;<span class="ident" id="4114416">i</span>&nbsp;<span class="op" id="4114418">&lt;</span>&nbsp;<span class="num" id="4114420">8</span><span class="op" id="4114421">;</span>&nbsp;<span class="ident" id="4114423">i</span><span class="op" id="4114424">++</span>&nbsp;<span class="op" id="4114427">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114431">x</span><span class="op" id="4114432">[</span><span class="ident" id="4114433">i</span><span class="op" id="4114434">]</span>&nbsp;<span class="op" id="4114436">*=</span>&nbsp;<span class="num" id="4114439">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4114442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114445">p224Sub</span><span class="op" id="4114452">(</span><span class="op" id="4114453">&amp;</span><span class="ident" id="4114454">x3</span><span class="op" id="4114456">,</span>&nbsp;<span class="op" id="4114458">&amp;</span><span class="ident" id="4114459">x3</span><span class="op" id="4114461">,</span>&nbsp;<span class="op" id="4114463">&amp;</span><span class="ident" id="4114464">x</span><span class="op" id="4114465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114468">p224Reduce</span><span class="op" id="4114478">(</span><span class="op" id="4114479">&amp;</span><span class="ident" id="4114480">x3</span><span class="op" id="4114482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114485">p224Add</span><span class="op" id="4114492">(</span><span class="op" id="4114493">&amp;</span><span class="ident" id="4114494">x3</span><span class="op" id="4114496">,</span>&nbsp;<span class="op" id="4114498">&amp;</span><span class="ident" id="4114499">x3</span><span class="op" id="4114501">,</span>&nbsp;<span class="op" id="4114503">&amp;</span><span class="ident" id="4114504">curve</span><span class="op" id="4114509">.</span><span class="ident" id="4114510">b</span><span class="op" id="4114511">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114514">p224Contract</span><span class="op" id="4114526">(</span><span class="op" id="4114527">&amp;</span><span class="ident" id="4114528">x3</span><span class="op" id="4114530">,</span>&nbsp;<span class="op" id="4114532">&amp;</span><span class="ident" id="4114533">x3</span><span class="op" id="4114535">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114539">p224Square</span><span class="op" id="4114549">(</span><span class="op" id="4114550">&amp;</span><span class="ident" id="4114551">y</span><span class="op" id="4114552">,</span>&nbsp;<span class="op" id="4114554">&amp;</span><span class="ident" id="4114555">y</span><span class="op" id="4114556">,</span>&nbsp;<span class="op" id="4114558">&amp;</span><span class="ident" id="4114559">tmp</span><span class="op" id="4114562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114565">p224Contract</span><span class="op" id="4114577">(</span><span class="op" id="4114578">&amp;</span><span class="ident" id="4114579">y</span><span class="op" id="4114580">,</span>&nbsp;<span class="op" id="4114582">&amp;</span><span class="ident" id="4114583">y</span><span class="op" id="4114584">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114588">for</span>&nbsp;<span class="ident" id="4114592">i</span>&nbsp;<span class="op" id="4114594">:=</span>&nbsp;<span class="num" id="4114597">0</span><span class="op" id="4114598">;</span>&nbsp;<span class="ident" id="4114600">i</span>&nbsp;<span class="op" id="4114602">&lt;</span>&nbsp;<span class="num" id="4114604">8</span><span class="op" id="4114605">;</span>&nbsp;<span class="ident" id="4114607">i</span><span class="op" id="4114608">++</span>&nbsp;<span class="op" id="4114611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114615">if</span>&nbsp;<span class="ident" id="4114618">y</span><span class="op" id="4114619">[</span><span class="ident" id="4114620">i</span><span class="op" id="4114621">]</span>&nbsp;<span class="op" id="4114623">!=</span>&nbsp;<span class="ident" id="4114626">x3</span><span class="op" id="4114628">[</span><span class="ident" id="4114629">i</span><span class="op" id="4114630">]</span>&nbsp;<span class="op" id="4114632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114637">return</span>&nbsp;<span class="builtintype" id="4114644">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4114652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4114655">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114658">return</span>&nbsp;<span class="builtintype" id="4114665">true</span><br>
<span class="lineno"></span><span class="op" id="4114670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4114673">func</span>&nbsp;<span class="op" id="4114678">(</span><span class="ident" id="4114679">p224Curve</span><span class="op" id="4114688">)</span>&nbsp;<span class="ident" id="4114690">Add</span><span class="op" id="4114693">(</span><span class="ident" id="4114694">bigX1</span><span class="op" id="4114699">,</span>&nbsp;<span class="ident" id="4114701">bigY1</span><span class="op" id="4114706">,</span>&nbsp;<span class="ident" id="4114708">bigX2</span><span class="op" id="4114713">,</span>&nbsp;<span class="ident" id="4114715">bigY2</span>&nbsp;<span class="op" id="4114721">*</span><span class="ident" id="4114722">big</span><span class="op" id="4114725">.</span><span class="ident" id="4114726">Int</span><span class="op" id="4114729">)</span>&nbsp;<span class="op" id="4114731">(</span><span class="ident" id="4114732">x</span><span class="op" id="4114733">,</span>&nbsp;<span class="ident" id="4114735">y</span>&nbsp;<span class="op" id="4114737">*</span><span class="ident" id="4114738">big</span><span class="op" id="4114741">.</span><span class="ident" id="4114742">Int</span><span class="op" id="4114745">)</span>&nbsp;<span class="op" id="4114747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114750">var</span>&nbsp;<span class="ident" id="4114754">x1</span><span class="op" id="4114756">,</span>&nbsp;<span class="ident" id="4114758">y1</span><span class="op" id="4114760">,</span>&nbsp;<span class="ident" id="4114762">z1</span><span class="op" id="4114764">,</span>&nbsp;<span class="ident" id="4114766">x2</span><span class="op" id="4114768">,</span>&nbsp;<span class="ident" id="4114770">y2</span><span class="op" id="4114772">,</span>&nbsp;<span class="ident" id="4114774">z2</span><span class="op" id="4114776">,</span>&nbsp;<span class="ident" id="4114778">x3</span><span class="op" id="4114780">,</span>&nbsp;<span class="ident" id="4114782">y3</span><span class="op" id="4114784">,</span>&nbsp;<span class="ident" id="4114786">z3</span>&nbsp;<span class="ident" id="4114789">p224FieldElement</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114808">p224FromBig</span><span class="op" id="4114819">(</span><span class="op" id="4114820">&amp;</span><span class="ident" id="4114821">x1</span><span class="op" id="4114823">,</span>&nbsp;<span class="ident" id="4114825">bigX1</span><span class="op" id="4114830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114833">p224FromBig</span><span class="op" id="4114844">(</span><span class="op" id="4114845">&amp;</span><span class="ident" id="4114846">y1</span><span class="op" id="4114848">,</span>&nbsp;<span class="ident" id="4114850">bigY1</span><span class="op" id="4114855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114858">if</span>&nbsp;<span class="ident" id="4114861">bigX1</span><span class="op" id="4114866">.</span><span class="ident" id="4114867">Sign</span><span class="op" id="4114871">(</span><span class="op" id="4114872">)</span>&nbsp;<span class="op" id="4114874">!=</span>&nbsp;<span class="num" id="4114877">0</span>&nbsp;<span class="op" id="4114879">||</span>&nbsp;<span class="ident" id="4114882">bigY1</span><span class="op" id="4114887">.</span><span class="ident" id="4114888">Sign</span><span class="op" id="4114892">(</span><span class="op" id="4114893">)</span>&nbsp;<span class="op" id="4114895">!=</span>&nbsp;<span class="num" id="4114898">0</span>&nbsp;<span class="op" id="4114900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114904">z1</span><span class="op" id="4114906">[</span><span class="num" id="4114907">0</span><span class="op" id="4114908">]</span>&nbsp;<span class="op" id="4114910">=</span>&nbsp;<span class="num" id="4114912">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4114915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114918">p224FromBig</span><span class="op" id="4114929">(</span><span class="op" id="4114930">&amp;</span><span class="ident" id="4114931">x2</span><span class="op" id="4114933">,</span>&nbsp;<span class="ident" id="4114935">bigX2</span><span class="op" id="4114940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4114943">p224FromBig</span><span class="op" id="4114954">(</span><span class="op" id="4114955">&amp;</span><span class="ident" id="4114956">y2</span><span class="op" id="4114958">,</span>&nbsp;<span class="ident" id="4114960">bigY2</span><span class="op" id="4114965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4114968">if</span>&nbsp;<span class="ident" id="4114971">bigX2</span><span class="op" id="4114976">.</span><span class="ident" id="4114977">Sign</span><span class="op" id="4114981">(</span><span class="op" id="4114982">)</span>&nbsp;<span class="op" id="4114984">!=</span>&nbsp;<span class="num" id="4114987">0</span>&nbsp;<span class="op" id="4114989">||</span>&nbsp;<span class="ident" id="4114992">bigY2</span><span class="op" id="4114997">.</span><span class="ident" id="4114998">Sign</span><span class="op" id="4115002">(</span><span class="op" id="4115003">)</span>&nbsp;<span class="op" id="4115005">!=</span>&nbsp;<span class="num" id="4115008">0</span>&nbsp;<span class="op" id="4115010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115014">z2</span><span class="op" id="4115016">[</span><span class="num" id="4115017">0</span><span class="op" id="4115018">]</span>&nbsp;<span class="op" id="4115020">=</span>&nbsp;<span class="num" id="4115022">1</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4115025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115029">p224AddJacobian</span><span class="op" id="4115044">(</span><span class="op" id="4115045">&amp;</span><span class="ident" id="4115046">x3</span><span class="op" id="4115048">,</span>&nbsp;<span class="op" id="4115050">&amp;</span><span class="ident" id="4115051">y3</span><span class="op" id="4115053">,</span>&nbsp;<span class="op" id="4115055">&amp;</span><span class="ident" id="4115056">z3</span><span class="op" id="4115058">,</span>&nbsp;<span class="op" id="4115060">&amp;</span><span class="ident" id="4115061">x1</span><span class="op" id="4115063">,</span>&nbsp;<span class="op" id="4115065">&amp;</span><span class="ident" id="4115066">y1</span><span class="op" id="4115068">,</span>&nbsp;<span class="op" id="4115070">&amp;</span><span class="ident" id="4115071">z1</span><span class="op" id="4115073">,</span>&nbsp;<span class="op" id="4115075">&amp;</span><span class="ident" id="4115076">x2</span><span class="op" id="4115078">,</span>&nbsp;<span class="op" id="4115080">&amp;</span><span class="ident" id="4115081">y2</span><span class="op" id="4115083">,</span>&nbsp;<span class="op" id="4115085">&amp;</span><span class="ident" id="4115086">z2</span><span class="op" id="4115088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4115091">return</span>&nbsp;<span class="ident" id="4115098">p224ToAffine</span><span class="op" id="4115110">(</span><span class="op" id="4115111">&amp;</span><span class="ident" id="4115112">x3</span><span class="op" id="4115114">,</span>&nbsp;<span class="op" id="4115116">&amp;</span><span class="ident" id="4115117">y3</span><span class="op" id="4115119">,</span>&nbsp;<span class="op" id="4115121">&amp;</span><span class="ident" id="4115122">z3</span><span class="op" id="4115124">)</span><br>
<span class="lineno"></span><span class="op" id="4115126">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4115129">func</span>&nbsp;<span class="op" id="4115134">(</span><span class="ident" id="4115135">p224Curve</span><span class="op" id="4115144">)</span>&nbsp;<span class="ident" id="4115146">Double</span><span class="op" id="4115152">(</span><span class="ident" id="4115153">bigX1</span><span class="op" id="4115158">,</span>&nbsp;<span class="ident" id="4115160">bigY1</span>&nbsp;<span class="op" id="4115166">*</span><span class="ident" id="4115167">big</span><span class="op" id="4115170">.</span><span class="ident" id="4115171">Int</span><span class="op" id="4115174">)</span>&nbsp;<span class="op" id="4115176">(</span><span class="ident" id="4115177">x</span><span class="op" id="4115178">,</span>&nbsp;<span class="ident" id="4115180">y</span>&nbsp;<span class="op" id="4115182">*</span><span class="ident" id="4115183">big</span><span class="op" id="4115186">.</span><span class="ident" id="4115187">Int</span><span class="op" id="4115190">)</span>&nbsp;<span class="op" id="4115192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4115195">var</span>&nbsp;<span class="ident" id="4115199">x1</span><span class="op" id="4115201">,</span>&nbsp;<span class="ident" id="4115203">y1</span><span class="op" id="4115205">,</span>&nbsp;<span class="ident" id="4115207">z1</span><span class="op" id="4115209">,</span>&nbsp;<span class="ident" id="4115211">x2</span><span class="op" id="4115213">,</span>&nbsp;<span class="ident" id="4115215">y2</span><span class="op" id="4115217">,</span>&nbsp;<span class="ident" id="4115219">z2</span>&nbsp;<span class="ident" id="4115222">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115241">p224FromBig</span><span class="op" id="4115252">(</span><span class="op" id="4115253">&amp;</span><span class="ident" id="4115254">x1</span><span class="op" id="4115256">,</span>&nbsp;<span class="ident" id="4115258">bigX1</span><span class="op" id="4115263">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115266">p224FromBig</span><span class="op" id="4115277">(</span><span class="op" id="4115278">&amp;</span><span class="ident" id="4115279">y1</span><span class="op" id="4115281">,</span>&nbsp;<span class="ident" id="4115283">bigY1</span><span class="op" id="4115288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115291">z1</span><span class="op" id="4115293">[</span><span class="num" id="4115294">0</span><span class="op" id="4115295">]</span>&nbsp;<span class="op" id="4115297">=</span>&nbsp;<span class="num" id="4115299">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115303">p224DoubleJacobian</span><span class="op" id="4115321">(</span><span class="op" id="4115322">&amp;</span><span class="ident" id="4115323">x2</span><span class="op" id="4115325">,</span>&nbsp;<span class="op" id="4115327">&amp;</span><span class="ident" id="4115328">y2</span><span class="op" id="4115330">,</span>&nbsp;<span class="op" id="4115332">&amp;</span><span class="ident" id="4115333">z2</span><span class="op" id="4115335">,</span>&nbsp;<span class="op" id="4115337">&amp;</span><span class="ident" id="4115338">x1</span><span class="op" id="4115340">,</span>&nbsp;<span class="op" id="4115342">&amp;</span><span class="ident" id="4115343">y1</span><span class="op" id="4115345">,</span>&nbsp;<span class="op" id="4115347">&amp;</span><span class="ident" id="4115348">z1</span><span class="op" id="4115350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4115353">return</span>&nbsp;<span class="ident" id="4115360">p224ToAffine</span><span class="op" id="4115372">(</span><span class="op" id="4115373">&amp;</span><span class="ident" id="4115374">x2</span><span class="op" id="4115376">,</span>&nbsp;<span class="op" id="4115378">&amp;</span><span class="ident" id="4115379">y2</span><span class="op" id="4115381">,</span>&nbsp;<span class="op" id="4115383">&amp;</span><span class="ident" id="4115384">z2</span><span class="op" id="4115386">)</span><br>
<span class="lineno">105</span><span class="op" id="4115388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4115391">func</span>&nbsp;<span class="op" id="4115396">(</span><span class="ident" id="4115397">p224Curve</span><span class="op" id="4115406">)</span>&nbsp;<span class="ident" id="4115408">ScalarMult</span><span class="op" id="4115418">(</span><span class="ident" id="4115419">bigX1</span><span class="op" id="4115424">,</span>&nbsp;<span class="ident" id="4115426">bigY1</span>&nbsp;<span class="op" id="4115432">*</span><span class="ident" id="4115433">big</span><span class="op" id="4115436">.</span><span class="ident" id="4115437">Int</span><span class="op" id="4115440">,</span>&nbsp;<span class="ident" id="4115442">scalar</span>&nbsp;<span class="op" id="4115449">[</span><span class="op" id="4115450">]</span><span class="builtintype" id="4115451">byte</span><span class="op" id="4115455">)</span>&nbsp;<span class="op" id="4115457">(</span><span class="ident" id="4115458">x</span><span class="op" id="4115459">,</span>&nbsp;<span class="ident" id="4115461">y</span>&nbsp;<span class="op" id="4115463">*</span><span class="ident" id="4115464">big</span><span class="op" id="4115467">.</span><span class="ident" id="4115468">Int</span><span class="op" id="4115471">)</span>&nbsp;<span class="op" id="4115473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4115476">var</span>&nbsp;<span class="ident" id="4115480">x1</span><span class="op" id="4115482">,</span>&nbsp;<span class="ident" id="4115484">y1</span><span class="op" id="4115486">,</span>&nbsp;<span class="ident" id="4115488">z1</span><span class="op" id="4115490">,</span>&nbsp;<span class="ident" id="4115492">x2</span><span class="op" id="4115494">,</span>&nbsp;<span class="ident" id="4115496">y2</span><span class="op" id="4115498">,</span>&nbsp;<span class="ident" id="4115500">z2</span>&nbsp;<span class="ident" id="4115503">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115522">p224FromBig</span><span class="op" id="4115533">(</span><span class="op" id="4115534">&amp;</span><span class="ident" id="4115535">x1</span><span class="op" id="4115537">,</span>&nbsp;<span class="ident" id="4115539">bigX1</span><span class="op" id="4115544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115547">p224FromBig</span><span class="op" id="4115558">(</span><span class="op" id="4115559">&amp;</span><span class="ident" id="4115560">y1</span><span class="op" id="4115562">,</span>&nbsp;<span class="ident" id="4115564">bigY1</span><span class="op" id="4115569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115572">z1</span><span class="op" id="4115574">[</span><span class="num" id="4115575">0</span><span class="op" id="4115576">]</span>&nbsp;<span class="op" id="4115578">=</span>&nbsp;<span class="num" id="4115580">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115584">p224ScalarMult</span><span class="op" id="4115598">(</span><span class="op" id="4115599">&amp;</span><span class="ident" id="4115600">x2</span><span class="op" id="4115602">,</span>&nbsp;<span class="op" id="4115604">&amp;</span><span class="ident" id="4115605">y2</span><span class="op" id="4115607">,</span>&nbsp;<span class="op" id="4115609">&amp;</span><span class="ident" id="4115610">z2</span><span class="op" id="4115612">,</span>&nbsp;<span class="op" id="4115614">&amp;</span><span class="ident" id="4115615">x1</span><span class="op" id="4115617">,</span>&nbsp;<span class="op" id="4115619">&amp;</span><span class="ident" id="4115620">y1</span><span class="op" id="4115622">,</span>&nbsp;<span class="op" id="4115624">&amp;</span><span class="ident" id="4115625">z1</span><span class="op" id="4115627">,</span>&nbsp;<span class="ident" id="4115629">scalar</span><span class="op" id="4115635">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4115638">return</span>&nbsp;<span class="ident" id="4115645">p224ToAffine</span><span class="op" id="4115657">(</span><span class="op" id="4115658">&amp;</span><span class="ident" id="4115659">x2</span><span class="op" id="4115661">,</span>&nbsp;<span class="op" id="4115663">&amp;</span><span class="ident" id="4115664">y2</span><span class="op" id="4115666">,</span>&nbsp;<span class="op" id="4115668">&amp;</span><span class="ident" id="4115669">z2</span><span class="op" id="4115671">)</span><br>
<span class="lineno"></span><span class="op" id="4115673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4115676">func</span>&nbsp;<span class="op" id="4115681">(</span><span class="ident" id="4115682">curve</span>&nbsp;<span class="ident" id="4115688">p224Curve</span><span class="op" id="4115697">)</span>&nbsp;<span class="ident" id="4115699">ScalarBaseMult</span><span class="op" id="4115713">(</span><span class="ident" id="4115714">scalar</span>&nbsp;<span class="op" id="4115721">[</span><span class="op" id="4115722">]</span><span class="builtintype" id="4115723">byte</span><span class="op" id="4115727">)</span>&nbsp;<span class="op" id="4115729">(</span><span class="ident" id="4115730">x</span><span class="op" id="4115731">,</span>&nbsp;<span class="ident" id="4115733">y</span>&nbsp;<span class="op" id="4115735">*</span><span class="ident" id="4115736">big</span><span class="op" id="4115739">.</span><span class="ident" id="4115740">Int</span><span class="op" id="4115743">)</span>&nbsp;<span class="op" id="4115745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4115748">var</span>&nbsp;<span class="ident" id="4115752">z1</span><span class="op" id="4115754">,</span>&nbsp;<span class="ident" id="4115756">x2</span><span class="op" id="4115758">,</span>&nbsp;<span class="ident" id="4115760">y2</span><span class="op" id="4115762">,</span>&nbsp;<span class="ident" id="4115764">z2</span>&nbsp;<span class="ident" id="4115767">p224FieldElement</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115786">z1</span><span class="op" id="4115788">[</span><span class="num" id="4115789">0</span><span class="op" id="4115790">]</span>&nbsp;<span class="op" id="4115792">=</span>&nbsp;<span class="num" id="4115794">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4115797">p224ScalarMult</span><span class="op" id="4115811">(</span><span class="op" id="4115812">&amp;</span><span class="ident" id="4115813">x2</span><span class="op" id="4115815">,</span>&nbsp;<span class="op" id="4115817">&amp;</span><span class="ident" id="4115818">y2</span><span class="op" id="4115820">,</span>&nbsp;<span class="op" id="4115822">&amp;</span><span class="ident" id="4115823">z2</span><span class="op" id="4115825">,</span>&nbsp;<span class="op" id="4115827">&amp;</span><span class="ident" id="4115828">curve</span><span class="op" id="4115833">.</span><span class="ident" id="4115834">gx</span><span class="op" id="4115836">,</span>&nbsp;<span class="op" id="4115838">&amp;</span><span class="ident" id="4115839">curve</span><span class="op" id="4115844">.</span><span class="ident" id="4115845">gy</span><span class="op" id="4115847">,</span>&nbsp;<span class="op" id="4115849">&amp;</span><span class="ident" id="4115850">z1</span><span class="op" id="4115852">,</span>&nbsp;<span class="ident" id="4115854">scalar</span><span class="op" id="4115860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4115863">return</span>&nbsp;<span class="ident" id="4115870">p224ToAffine</span><span class="op" id="4115882">(</span><span class="op" id="4115883">&amp;</span><span class="ident" id="4115884">x2</span><span class="op" id="4115886">,</span>&nbsp;<span class="op" id="4115888">&amp;</span><span class="ident" id="4115889">y2</span><span class="op" id="4115891">,</span>&nbsp;<span class="op" id="4115893">&amp;</span><span class="ident" id="4115894">z2</span><span class="op" id="4115896">)</span><br>
<span class="lineno"></span><span class="op" id="4115898">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4115901">//&nbsp;Field&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4115929">//</span><br>
<span class="lineno"></span><span class="comment" id="4115932">//&nbsp;The&nbsp;field&nbsp;that&nbsp;we&#39;re&nbsp;dealing&nbsp;with&nbsp;is&nbsp;ℤ/pℤ&nbsp;where&nbsp;p&nbsp;=&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;+&nbsp;1.</span><br>
<span class="lineno"></span><span class="comment" id="4116011">//</span><br>
<span class="lineno">130</span><span class="comment" id="4116014">//&nbsp;Field&nbsp;elements&nbsp;are&nbsp;represented&nbsp;by&nbsp;a&nbsp;FieldElement,&nbsp;which&nbsp;is&nbsp;a&nbsp;typedef&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4116092">//&nbsp;array&nbsp;of&nbsp;8&nbsp;uint32&#39;s.&nbsp;The&nbsp;value&nbsp;of&nbsp;a&nbsp;FieldElement,&nbsp;a,&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="4116152">//&nbsp;&nbsp;&nbsp;a[0]&nbsp;+&nbsp;2**28·a[1]&nbsp;+&nbsp;2**56·a[1]&nbsp;+&nbsp;...&nbsp;+&nbsp;2**196·a[7]</span><br>
<span class="lineno"></span><span class="comment" id="4116211">//</span><br>
<span class="lineno"></span><span class="comment" id="4116214">//&nbsp;Using&nbsp;28-bit&nbsp;limbs&nbsp;means&nbsp;that&nbsp;there&#39;s&nbsp;only&nbsp;4&nbsp;bits&nbsp;of&nbsp;headroom,&nbsp;which&nbsp;is&nbsp;less</span><br>
<span class="lineno">135</span><span class="comment" id="4116294">//&nbsp;than&nbsp;we&nbsp;would&nbsp;really&nbsp;like.&nbsp;But&nbsp;it&nbsp;has&nbsp;the&nbsp;useful&nbsp;feature&nbsp;that&nbsp;we&nbsp;hit&nbsp;2**224</span><br>
<span class="lineno"></span><span class="comment" id="4116373">//&nbsp;exactly,&nbsp;making&nbsp;the&nbsp;reflections&nbsp;during&nbsp;a&nbsp;reduce&nbsp;much&nbsp;nicer.</span><br>
<span class="lineno"></span><span class="keyword" id="4116436">type</span>&nbsp;<span class="ident" id="4116441">p224FieldElement</span>&nbsp;<span class="op" id="4116458">[</span><span class="num" id="4116459">8</span><span class="op" id="4116460">]</span><span class="builtintype" id="4116461">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4116469">//&nbsp;p224P&nbsp;is&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;field,&nbsp;represented&nbsp;as&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno">140</span><span class="keyword" id="4116540">var</span>&nbsp;<span class="ident" id="4116544">p224P</span>&nbsp;<span class="op" id="4116550">=</span>&nbsp;<span class="op" id="4116552">[</span><span class="num" id="4116553">8</span><span class="op" id="4116554">]</span><span class="builtintype" id="4116555">uint32</span><span class="op" id="4116561">{</span><span class="num" id="4116562">1</span><span class="op" id="4116563">,</span>&nbsp;<span class="num" id="4116565">0</span><span class="op" id="4116566">,</span>&nbsp;<span class="num" id="4116568">0</span><span class="op" id="4116569">,</span>&nbsp;<span class="num" id="4116571">0xffff000</span><span class="op" id="4116580">,</span>&nbsp;<span class="num" id="4116582">0xfffffff</span><span class="op" id="4116591">,</span>&nbsp;<span class="num" id="4116593">0xfffffff</span><span class="op" id="4116602">,</span>&nbsp;<span class="num" id="4116604">0xfffffff</span><span class="op" id="4116613">,</span>&nbsp;<span class="num" id="4116615">0xfffffff</span><span class="op" id="4116624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4116627">//&nbsp;p224IsZero&nbsp;returns&nbsp;1&nbsp;if&nbsp;a&nbsp;==&nbsp;0&nbsp;mod&nbsp;p&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="4116684">//</span><br>
<span class="lineno"></span><span class="comment" id="4116687">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">145</span><span class="keyword" id="4116703">func</span>&nbsp;<span class="ident" id="4116708">p224IsZero</span><span class="op" id="4116718">(</span><span class="ident" id="4116719">a</span>&nbsp;<span class="op" id="4116721">*</span><span class="ident" id="4116722">p224FieldElement</span><span class="op" id="4116738">)</span>&nbsp;<span class="builtintype" id="4116740">uint32</span>&nbsp;<span class="op" id="4116747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4116750">//&nbsp;Since&nbsp;a&nbsp;p224FieldElement&nbsp;contains&nbsp;224&nbsp;bits&nbsp;there&nbsp;are&nbsp;two&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4116820">//&nbsp;representations&nbsp;of&nbsp;0:&nbsp;0&nbsp;and&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4116855">var</span>&nbsp;<span class="ident" id="4116859">minimal</span>&nbsp;<span class="ident" id="4116867">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116885">p224Contract</span><span class="op" id="4116897">(</span><span class="op" id="4116898">&amp;</span><span class="ident" id="4116899">minimal</span><span class="op" id="4116906">,</span>&nbsp;<span class="ident" id="4116908">a</span><span class="op" id="4116909">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4116913">var</span>&nbsp;<span class="ident" id="4116917">isZero</span><span class="op" id="4116923">,</span>&nbsp;<span class="ident" id="4116925">isP</span>&nbsp;<span class="builtintype" id="4116929">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4116937">for</span>&nbsp;<span class="ident" id="4116941">i</span><span class="op" id="4116942">,</span>&nbsp;<span class="ident" id="4116944">v</span>&nbsp;<span class="op" id="4116946">:=</span>&nbsp;<span class="keyword" id="4116949">range</span>&nbsp;<span class="ident" id="4116955">minimal</span>&nbsp;<span class="op" id="4116963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116967">isZero</span>&nbsp;<span class="op" id="4116974">|=</span>&nbsp;<span class="ident" id="4116977">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4116981">isP</span>&nbsp;<span class="op" id="4116985">|=</span>&nbsp;<span class="ident" id="4116988">v</span>&nbsp;<span class="op" id="4116990">-</span>&nbsp;<span class="ident" id="4116992">p224P</span><span class="op" id="4116997">[</span><span class="ident" id="4116998">i</span><span class="op" id="4116999">]</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4117002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4117006">//&nbsp;If&nbsp;either&nbsp;isZero&nbsp;or&nbsp;isP&nbsp;is&nbsp;0,&nbsp;then&nbsp;we&nbsp;should&nbsp;return&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117065">isZero</span>&nbsp;<span class="op" id="4117072">|=</span>&nbsp;<span class="ident" id="4117075">isZero</span>&nbsp;<span class="op" id="4117082">&gt;&gt;</span>&nbsp;<span class="num" id="4117085">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117089">isZero</span>&nbsp;<span class="op" id="4117096">|=</span>&nbsp;<span class="ident" id="4117099">isZero</span>&nbsp;<span class="op" id="4117106">&gt;&gt;</span>&nbsp;<span class="num" id="4117109">8</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117112">isZero</span>&nbsp;<span class="op" id="4117119">|=</span>&nbsp;<span class="ident" id="4117122">isZero</span>&nbsp;<span class="op" id="4117129">&gt;&gt;</span>&nbsp;<span class="num" id="4117132">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117135">isZero</span>&nbsp;<span class="op" id="4117142">|=</span>&nbsp;<span class="ident" id="4117145">isZero</span>&nbsp;<span class="op" id="4117152">&gt;&gt;</span>&nbsp;<span class="num" id="4117155">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117158">isZero</span>&nbsp;<span class="op" id="4117165">|=</span>&nbsp;<span class="ident" id="4117168">isZero</span>&nbsp;<span class="op" id="4117175">&gt;&gt;</span>&nbsp;<span class="num" id="4117178">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117182">isP</span>&nbsp;<span class="op" id="4117186">|=</span>&nbsp;<span class="ident" id="4117189">isP</span>&nbsp;<span class="op" id="4117193">&gt;&gt;</span>&nbsp;<span class="num" id="4117196">16</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117200">isP</span>&nbsp;<span class="op" id="4117204">|=</span>&nbsp;<span class="ident" id="4117207">isP</span>&nbsp;<span class="op" id="4117211">&gt;&gt;</span>&nbsp;<span class="num" id="4117214">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117217">isP</span>&nbsp;<span class="op" id="4117221">|=</span>&nbsp;<span class="ident" id="4117224">isP</span>&nbsp;<span class="op" id="4117228">&gt;&gt;</span>&nbsp;<span class="num" id="4117231">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117234">isP</span>&nbsp;<span class="op" id="4117238">|=</span>&nbsp;<span class="ident" id="4117241">isP</span>&nbsp;<span class="op" id="4117245">&gt;&gt;</span>&nbsp;<span class="num" id="4117248">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117251">isP</span>&nbsp;<span class="op" id="4117255">|=</span>&nbsp;<span class="ident" id="4117258">isP</span>&nbsp;<span class="op" id="4117262">&gt;&gt;</span>&nbsp;<span class="num" id="4117265">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4117269">//&nbsp;For&nbsp;isZero&nbsp;and&nbsp;isP,&nbsp;the&nbsp;LSB&nbsp;is&nbsp;0&nbsp;iff&nbsp;all&nbsp;the&nbsp;bits&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117333">result</span>&nbsp;<span class="op" id="4117340">:=</span>&nbsp;<span class="ident" id="4117343">isZero</span>&nbsp;<span class="op" id="4117350">&amp;</span>&nbsp;<span class="ident" id="4117352">isP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117357">result</span>&nbsp;<span class="op" id="4117364">=</span>&nbsp;<span class="op" id="4117366">(</span><span class="op" id="4117367">^</span><span class="ident" id="4117368">result</span><span class="op" id="4117374">)</span>&nbsp;<span class="op" id="4117376">&amp;</span>&nbsp;<span class="num" id="4117378">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4117382">return</span>&nbsp;<span class="ident" id="4117389">result</span><br>
<span class="lineno">175</span><span class="op" id="4117396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4117399">//&nbsp;p224Add&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b</span><br>
<span class="lineno"></span><span class="comment" id="4117430">//</span><br>
<span class="lineno"></span><span class="comment" id="4117433">//&nbsp;a[i]&nbsp;+&nbsp;b[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno">180</span><span class="keyword" id="4117456">func</span>&nbsp;<span class="ident" id="4117461">p224Add</span><span class="op" id="4117468">(</span><span class="ident" id="4117469">out</span><span class="op" id="4117472">,</span>&nbsp;<span class="ident" id="4117474">a</span><span class="op" id="4117475">,</span>&nbsp;<span class="ident" id="4117477">b</span>&nbsp;<span class="op" id="4117479">*</span><span class="ident" id="4117480">p224FieldElement</span><span class="op" id="4117496">)</span>&nbsp;<span class="op" id="4117498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4117501">for</span>&nbsp;<span class="ident" id="4117505">i</span>&nbsp;<span class="op" id="4117507">:=</span>&nbsp;<span class="num" id="4117510">0</span><span class="op" id="4117511">;</span>&nbsp;<span class="ident" id="4117513">i</span>&nbsp;<span class="op" id="4117515">&lt;</span>&nbsp;<span class="num" id="4117517">8</span><span class="op" id="4117518">;</span>&nbsp;<span class="ident" id="4117520">i</span><span class="op" id="4117521">++</span>&nbsp;<span class="op" id="4117524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4117528">out</span><span class="op" id="4117531">[</span><span class="ident" id="4117532">i</span><span class="op" id="4117533">]</span>&nbsp;<span class="op" id="4117535">=</span>&nbsp;<span class="ident" id="4117537">a</span><span class="op" id="4117538">[</span><span class="ident" id="4117539">i</span><span class="op" id="4117540">]</span>&nbsp;<span class="op" id="4117542">+</span>&nbsp;<span class="ident" id="4117544">b</span><span class="op" id="4117545">[</span><span class="ident" id="4117546">i</span><span class="op" id="4117547">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4117550">}</span><br>
<span class="lineno"></span><span class="op" id="4117552">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="4117555">const</span>&nbsp;<span class="ident" id="4117561">two31p3</span>&nbsp;<span class="op" id="4117569">=</span>&nbsp;<span class="num" id="4117571">1</span><span class="op" id="4117572">&lt;&lt;</span><span class="num" id="4117574">31</span>&nbsp;<span class="op" id="4117577">+</span>&nbsp;<span class="num" id="4117579">1</span><span class="op" id="4117580">&lt;&lt;</span><span class="num" id="4117582">3</span><br>
<span class="lineno"></span><span class="keyword" id="4117584">const</span>&nbsp;<span class="ident" id="4117590">two31m3</span>&nbsp;<span class="op" id="4117598">=</span>&nbsp;<span class="num" id="4117600">1</span><span class="op" id="4117601">&lt;&lt;</span><span class="num" id="4117603">31</span>&nbsp;<span class="op" id="4117606">-</span>&nbsp;<span class="num" id="4117608">1</span><span class="op" id="4117609">&lt;&lt;</span><span class="num" id="4117611">3</span><br>
<span class="lineno"></span><span class="keyword" id="4117613">const</span>&nbsp;<span class="ident" id="4117619">two31m15m3</span>&nbsp;<span class="op" id="4117630">=</span>&nbsp;<span class="num" id="4117632">1</span><span class="op" id="4117633">&lt;&lt;</span><span class="num" id="4117635">31</span>&nbsp;<span class="op" id="4117638">-</span>&nbsp;<span class="num" id="4117640">1</span><span class="op" id="4117641">&lt;&lt;</span><span class="num" id="4117643">15</span>&nbsp;<span class="op" id="4117646">-</span>&nbsp;<span class="num" id="4117648">1</span><span class="op" id="4117649">&lt;&lt;</span><span class="num" id="4117651">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4117654">//&nbsp;p224ZeroModP31&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;31&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs&nbsp;so&nbsp;that&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="4117731">//&nbsp;subtract&nbsp;smaller&nbsp;amounts&nbsp;without&nbsp;underflow.&nbsp;See&nbsp;the&nbsp;section&nbsp;&#34;Subtraction&#34;&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4117811">//&nbsp;[1]&nbsp;for&nbsp;reasoning.</span><br>
<span class="lineno"></span><span class="keyword" id="4117833">var</span>&nbsp;<span class="ident" id="4117837">p224ZeroModP31</span>&nbsp;<span class="op" id="4117852">=</span>&nbsp;<span class="op" id="4117854">[</span><span class="op" id="4117855">]</span><span class="builtintype" id="4117856">uint32</span><span class="op" id="4117862">{</span><span class="ident" id="4117863">two31p3</span><span class="op" id="4117870">,</span>&nbsp;<span class="ident" id="4117872">two31m3</span><span class="op" id="4117879">,</span>&nbsp;<span class="ident" id="4117881">two31m3</span><span class="op" id="4117888">,</span>&nbsp;<span class="ident" id="4117890">two31m15m3</span><span class="op" id="4117900">,</span>&nbsp;<span class="ident" id="4117902">two31m3</span><span class="op" id="4117909">,</span>&nbsp;<span class="ident" id="4117911">two31m3</span><span class="op" id="4117918">,</span>&nbsp;<span class="ident" id="4117920">two31m3</span><span class="op" id="4117927">,</span>&nbsp;<span class="ident" id="4117929">two31m3</span><span class="op" id="4117936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="4117939">//&nbsp;p224Sub&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a-b</span><br>
<span class="lineno"></span><span class="comment" id="4117970">//</span><br>
<span class="lineno"></span><span class="comment" id="4117973">//&nbsp;a[i],&nbsp;b[i]&nbsp;&lt;&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4117995">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno"></span><span class="keyword" id="4118013">func</span>&nbsp;<span class="ident" id="4118018">p224Sub</span><span class="op" id="4118025">(</span><span class="ident" id="4118026">out</span><span class="op" id="4118029">,</span>&nbsp;<span class="ident" id="4118031">a</span><span class="op" id="4118032">,</span>&nbsp;<span class="ident" id="4118034">b</span>&nbsp;<span class="op" id="4118036">*</span><span class="ident" id="4118037">p224FieldElement</span><span class="op" id="4118053">)</span>&nbsp;<span class="op" id="4118055">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4118058">for</span>&nbsp;<span class="ident" id="4118062">i</span>&nbsp;<span class="op" id="4118064">:=</span>&nbsp;<span class="num" id="4118067">0</span><span class="op" id="4118068">;</span>&nbsp;<span class="ident" id="4118070">i</span>&nbsp;<span class="op" id="4118072">&lt;</span>&nbsp;<span class="num" id="4118074">8</span><span class="op" id="4118075">;</span>&nbsp;<span class="ident" id="4118077">i</span><span class="op" id="4118078">++</span>&nbsp;<span class="op" id="4118081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4118085">out</span><span class="op" id="4118088">[</span><span class="ident" id="4118089">i</span><span class="op" id="4118090">]</span>&nbsp;<span class="op" id="4118092">=</span>&nbsp;<span class="ident" id="4118094">a</span><span class="op" id="4118095">[</span><span class="ident" id="4118096">i</span><span class="op" id="4118097">]</span>&nbsp;<span class="op" id="4118099">+</span>&nbsp;<span class="ident" id="4118101">p224ZeroModP31</span><span class="op" id="4118115">[</span><span class="ident" id="4118116">i</span><span class="op" id="4118117">]</span>&nbsp;<span class="op" id="4118119">-</span>&nbsp;<span class="ident" id="4118121">b</span><span class="op" id="4118122">[</span><span class="ident" id="4118123">i</span><span class="op" id="4118124">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4118127">}</span><br>
<span class="lineno"></span><span class="op" id="4118129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="4118132">//&nbsp;LargeFieldElement&nbsp;also&nbsp;represents&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;field.&nbsp;The&nbsp;limbs&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4118208">//&nbsp;still&nbsp;spaced&nbsp;28-bits&nbsp;apart&nbsp;and&nbsp;in&nbsp;little-endian&nbsp;order.&nbsp;So&nbsp;the&nbsp;limbs&nbsp;are&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4118286">//&nbsp;0,&nbsp;28,&nbsp;56,&nbsp;...,&nbsp;392&nbsp;bits,&nbsp;each&nbsp;64-bits&nbsp;wide.</span><br>
<span class="lineno"></span><span class="keyword" id="4118334">type</span>&nbsp;<span class="ident" id="4118339">p224LargeFieldElement</span>&nbsp;<span class="op" id="4118361">[</span><span class="num" id="4118362">15</span><span class="op" id="4118364">]</span><span class="ident" id="4118365">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="4118373">const</span>&nbsp;<span class="ident" id="4118379">two63p35</span>&nbsp;<span class="op" id="4118388">=</span>&nbsp;<span class="num" id="4118390">1</span><span class="op" id="4118391">&lt;&lt;</span><span class="num" id="4118393">63</span>&nbsp;<span class="op" id="4118396">+</span>&nbsp;<span class="num" id="4118398">1</span><span class="op" id="4118399">&lt;&lt;</span><span class="num" id="4118401">35</span><br>
<span class="lineno"></span><span class="keyword" id="4118404">const</span>&nbsp;<span class="ident" id="4118410">two63m35</span>&nbsp;<span class="op" id="4118419">=</span>&nbsp;<span class="num" id="4118421">1</span><span class="op" id="4118422">&lt;&lt;</span><span class="num" id="4118424">63</span>&nbsp;<span class="op" id="4118427">-</span>&nbsp;<span class="num" id="4118429">1</span><span class="op" id="4118430">&lt;&lt;</span><span class="num" id="4118432">35</span><br>
<span class="lineno"></span><span class="keyword" id="4118435">const</span>&nbsp;<span class="ident" id="4118441">two63m35m19</span>&nbsp;<span class="op" id="4118453">=</span>&nbsp;<span class="num" id="4118455">1</span><span class="op" id="4118456">&lt;&lt;</span><span class="num" id="4118458">63</span>&nbsp;<span class="op" id="4118461">-</span>&nbsp;<span class="num" id="4118463">1</span><span class="op" id="4118464">&lt;&lt;</span><span class="num" id="4118466">35</span>&nbsp;<span class="op" id="4118469">-</span>&nbsp;<span class="num" id="4118471">1</span><span class="op" id="4118472">&lt;&lt;</span><span class="num" id="4118474">19</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4118478">//&nbsp;p224ZeroModP63&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;63&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs.&nbsp;See&nbsp;the&nbsp;section</span><br>
<span class="lineno">215</span><span class="comment" id="4118557">//&nbsp;&#34;Subtraction&#34;&nbsp;in&nbsp;[1]&nbsp;for&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="4118590">var</span>&nbsp;<span class="ident" id="4118594">p224ZeroModP63</span>&nbsp;<span class="op" id="4118609">=</span>&nbsp;<span class="op" id="4118611">[</span><span class="num" id="4118612">8</span><span class="op" id="4118613">]</span><span class="ident" id="4118614">uint64</span><span class="op" id="4118620">{</span><span class="ident" id="4118621">two63p35</span><span class="op" id="4118629">,</span>&nbsp;<span class="ident" id="4118631">two63m35</span><span class="op" id="4118639">,</span>&nbsp;<span class="ident" id="4118641">two63m35</span><span class="op" id="4118649">,</span>&nbsp;<span class="ident" id="4118651">two63m35</span><span class="op" id="4118659">,</span>&nbsp;<span class="ident" id="4118661">two63m35m19</span><span class="op" id="4118672">,</span>&nbsp;<span class="ident" id="4118674">two63m35</span><span class="op" id="4118682">,</span>&nbsp;<span class="ident" id="4118684">two63m35</span><span class="op" id="4118692">,</span>&nbsp;<span class="ident" id="4118694">two63m35</span><span class="op" id="4118702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4118705">const</span>&nbsp;<span class="ident" id="4118711">bottom12Bits</span>&nbsp;<span class="op" id="4118724">=</span>&nbsp;<span class="num" id="4118726">0xfff</span><br>
<span class="lineno"></span><span class="keyword" id="4118732">const</span>&nbsp;<span class="ident" id="4118738">bottom28Bits</span>&nbsp;<span class="op" id="4118751">=</span>&nbsp;<span class="num" id="4118753">0xfffffff</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="4118764">//&nbsp;p224Mul&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*b</span><br>
<span class="lineno"></span><span class="comment" id="4118795">//</span><br>
<span class="lineno"></span><span class="comment" id="4118798">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29,&nbsp;b[i]&nbsp;&lt;&nbsp;2**30&nbsp;(or&nbsp;vice&nbsp;versa)</span><br>
<span class="lineno"></span><span class="comment" id="4118844">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">225</span><span class="keyword" id="4118862">func</span>&nbsp;<span class="ident" id="4118867">p224Mul</span><span class="op" id="4118874">(</span><span class="ident" id="4118875">out</span><span class="op" id="4118878">,</span>&nbsp;<span class="ident" id="4118880">a</span><span class="op" id="4118881">,</span>&nbsp;<span class="ident" id="4118883">b</span>&nbsp;<span class="op" id="4118885">*</span><span class="ident" id="4118886">p224FieldElement</span><span class="op" id="4118902">,</span>&nbsp;<span class="ident" id="4118904">tmp</span>&nbsp;<span class="op" id="4118908">*</span><span class="ident" id="4118909">p224LargeFieldElement</span><span class="op" id="4118930">)</span>&nbsp;<span class="op" id="4118932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4118935">for</span>&nbsp;<span class="ident" id="4118939">i</span>&nbsp;<span class="op" id="4118941">:=</span>&nbsp;<span class="num" id="4118944">0</span><span class="op" id="4118945">;</span>&nbsp;<span class="ident" id="4118947">i</span>&nbsp;<span class="op" id="4118949">&lt;</span>&nbsp;<span class="num" id="4118951">15</span><span class="op" id="4118953">;</span>&nbsp;<span class="ident" id="4118955">i</span><span class="op" id="4118956">++</span>&nbsp;<span class="op" id="4118959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4118963">tmp</span><span class="op" id="4118966">[</span><span class="ident" id="4118967">i</span><span class="op" id="4118968">]</span>&nbsp;<span class="op" id="4118970">=</span>&nbsp;<span class="num" id="4118972">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4118975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4118979">for</span>&nbsp;<span class="ident" id="4118983">i</span>&nbsp;<span class="op" id="4118985">:=</span>&nbsp;<span class="num" id="4118988">0</span><span class="op" id="4118989">;</span>&nbsp;<span class="ident" id="4118991">i</span>&nbsp;<span class="op" id="4118993">&lt;</span>&nbsp;<span class="num" id="4118995">8</span><span class="op" id="4118996">;</span>&nbsp;<span class="ident" id="4118998">i</span><span class="op" id="4118999">++</span>&nbsp;<span class="op" id="4119002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4119006">for</span>&nbsp;<span class="ident" id="4119010">j</span>&nbsp;<span class="op" id="4119012">:=</span>&nbsp;<span class="num" id="4119015">0</span><span class="op" id="4119016">;</span>&nbsp;<span class="ident" id="4119018">j</span>&nbsp;<span class="op" id="4119020">&lt;</span>&nbsp;<span class="num" id="4119022">8</span><span class="op" id="4119023">;</span>&nbsp;<span class="ident" id="4119025">j</span><span class="op" id="4119026">++</span>&nbsp;<span class="op" id="4119029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119034">tmp</span><span class="op" id="4119037">[</span><span class="ident" id="4119038">i</span><span class="op" id="4119039">+</span><span class="ident" id="4119040">j</span><span class="op" id="4119041">]</span>&nbsp;<span class="op" id="4119043">+=</span>&nbsp;<span class="ident" id="4119046">uint64</span><span class="op" id="4119052">(</span><span class="ident" id="4119053">a</span><span class="op" id="4119054">[</span><span class="ident" id="4119055">i</span><span class="op" id="4119056">]</span><span class="op" id="4119057">)</span>&nbsp;<span class="op" id="4119059">*</span>&nbsp;<span class="ident" id="4119061">uint64</span><span class="op" id="4119067">(</span><span class="ident" id="4119068">b</span><span class="op" id="4119069">[</span><span class="ident" id="4119070">j</span><span class="op" id="4119071">]</span><span class="op" id="4119072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119079">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119083">p224ReduceLarge</span><span class="op" id="4119098">(</span><span class="ident" id="4119099">out</span><span class="op" id="4119102">,</span>&nbsp;<span class="ident" id="4119104">tmp</span><span class="op" id="4119107">)</span><br>
<span class="lineno"></span><span class="op" id="4119109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4119112">//&nbsp;Square&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*a</span><br>
<span class="lineno">240</span><span class="comment" id="4119142">//</span><br>
<span class="lineno"></span><span class="comment" id="4119145">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4119161">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="keyword" id="4119179">func</span>&nbsp;<span class="ident" id="4119184">p224Square</span><span class="op" id="4119194">(</span><span class="ident" id="4119195">out</span><span class="op" id="4119198">,</span>&nbsp;<span class="ident" id="4119200">a</span>&nbsp;<span class="op" id="4119202">*</span><span class="ident" id="4119203">p224FieldElement</span><span class="op" id="4119219">,</span>&nbsp;<span class="ident" id="4119221">tmp</span>&nbsp;<span class="op" id="4119225">*</span><span class="ident" id="4119226">p224LargeFieldElement</span><span class="op" id="4119247">)</span>&nbsp;<span class="op" id="4119249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4119252">for</span>&nbsp;<span class="ident" id="4119256">i</span>&nbsp;<span class="op" id="4119258">:=</span>&nbsp;<span class="num" id="4119261">0</span><span class="op" id="4119262">;</span>&nbsp;<span class="ident" id="4119264">i</span>&nbsp;<span class="op" id="4119266">&lt;</span>&nbsp;<span class="num" id="4119268">15</span><span class="op" id="4119270">;</span>&nbsp;<span class="ident" id="4119272">i</span><span class="op" id="4119273">++</span>&nbsp;<span class="op" id="4119276">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119280">tmp</span><span class="op" id="4119283">[</span><span class="ident" id="4119284">i</span><span class="op" id="4119285">]</span>&nbsp;<span class="op" id="4119287">=</span>&nbsp;<span class="num" id="4119289">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4119296">for</span>&nbsp;<span class="ident" id="4119300">i</span>&nbsp;<span class="op" id="4119302">:=</span>&nbsp;<span class="num" id="4119305">0</span><span class="op" id="4119306">;</span>&nbsp;<span class="ident" id="4119308">i</span>&nbsp;<span class="op" id="4119310">&lt;</span>&nbsp;<span class="num" id="4119312">8</span><span class="op" id="4119313">;</span>&nbsp;<span class="ident" id="4119315">i</span><span class="op" id="4119316">++</span>&nbsp;<span class="op" id="4119319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4119323">for</span>&nbsp;<span class="ident" id="4119327">j</span>&nbsp;<span class="op" id="4119329">:=</span>&nbsp;<span class="num" id="4119332">0</span><span class="op" id="4119333">;</span>&nbsp;<span class="ident" id="4119335">j</span>&nbsp;<span class="op" id="4119337">&lt;=</span>&nbsp;<span class="ident" id="4119340">i</span><span class="op" id="4119341">;</span>&nbsp;<span class="ident" id="4119343">j</span><span class="op" id="4119344">++</span>&nbsp;<span class="op" id="4119347">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119352">r</span>&nbsp;<span class="op" id="4119354">:=</span>&nbsp;<span class="ident" id="4119357">uint64</span><span class="op" id="4119363">(</span><span class="ident" id="4119364">a</span><span class="op" id="4119365">[</span><span class="ident" id="4119366">i</span><span class="op" id="4119367">]</span><span class="op" id="4119368">)</span>&nbsp;<span class="op" id="4119370">*</span>&nbsp;<span class="ident" id="4119372">uint64</span><span class="op" id="4119378">(</span><span class="ident" id="4119379">a</span><span class="op" id="4119380">[</span><span class="ident" id="4119381">j</span><span class="op" id="4119382">]</span><span class="op" id="4119383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4119388">if</span>&nbsp;<span class="ident" id="4119391">i</span>&nbsp;<span class="op" id="4119393">==</span>&nbsp;<span class="ident" id="4119396">j</span>&nbsp;<span class="op" id="4119398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119404">tmp</span><span class="op" id="4119407">[</span><span class="ident" id="4119408">i</span><span class="op" id="4119409">+</span><span class="ident" id="4119410">j</span><span class="op" id="4119411">]</span>&nbsp;<span class="op" id="4119413">+=</span>&nbsp;<span class="ident" id="4119416">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119421">}</span>&nbsp;<span class="keyword" id="4119423">else</span>&nbsp;<span class="op" id="4119428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119434">tmp</span><span class="op" id="4119437">[</span><span class="ident" id="4119438">i</span><span class="op" id="4119439">+</span><span class="ident" id="4119440">j</span><span class="op" id="4119441">]</span>&nbsp;<span class="op" id="4119443">+=</span>&nbsp;<span class="ident" id="4119446">r</span>&nbsp;<span class="op" id="4119448">&lt;&lt;</span>&nbsp;<span class="num" id="4119451">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119467">p224ReduceLarge</span><span class="op" id="4119482">(</span><span class="ident" id="4119483">out</span><span class="op" id="4119486">,</span>&nbsp;<span class="ident" id="4119488">tmp</span><span class="op" id="4119491">)</span><br>
<span class="lineno">260</span><span class="op" id="4119493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4119496">//&nbsp;ReduceLarge&nbsp;converts&nbsp;a&nbsp;p224LargeFieldElement&nbsp;to&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno"></span><span class="comment" id="4119567">//</span><br>
<span class="lineno"></span><span class="comment" id="4119570">//&nbsp;in[i]&nbsp;&lt;&nbsp;2**62</span><br>
<span class="lineno">265</span><span class="keyword" id="4119587">func</span>&nbsp;<span class="ident" id="4119592">p224ReduceLarge</span><span class="op" id="4119607">(</span><span class="ident" id="4119608">out</span>&nbsp;<span class="op" id="4119612">*</span><span class="ident" id="4119613">p224FieldElement</span><span class="op" id="4119629">,</span>&nbsp;<span class="ident" id="4119631">in</span>&nbsp;<span class="op" id="4119634">*</span><span class="ident" id="4119635">p224LargeFieldElement</span><span class="op" id="4119656">)</span>&nbsp;<span class="op" id="4119658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4119661">for</span>&nbsp;<span class="ident" id="4119665">i</span>&nbsp;<span class="op" id="4119667">:=</span>&nbsp;<span class="num" id="4119670">0</span><span class="op" id="4119671">;</span>&nbsp;<span class="ident" id="4119673">i</span>&nbsp;<span class="op" id="4119675">&lt;</span>&nbsp;<span class="num" id="4119677">8</span><span class="op" id="4119678">;</span>&nbsp;<span class="ident" id="4119680">i</span><span class="op" id="4119681">++</span>&nbsp;<span class="op" id="4119684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119688">in</span><span class="op" id="4119690">[</span><span class="ident" id="4119691">i</span><span class="op" id="4119692">]</span>&nbsp;<span class="op" id="4119694">+=</span>&nbsp;<span class="ident" id="4119697">p224ZeroModP63</span><span class="op" id="4119711">[</span><span class="ident" id="4119712">i</span><span class="op" id="4119713">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4119720">//&nbsp;Eliminate&nbsp;the&nbsp;coefficients&nbsp;at&nbsp;2**224&nbsp;and&nbsp;greater.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4119774">for</span>&nbsp;<span class="ident" id="4119778">i</span>&nbsp;<span class="op" id="4119780">:=</span>&nbsp;<span class="num" id="4119783">14</span><span class="op" id="4119785">;</span>&nbsp;<span class="ident" id="4119787">i</span>&nbsp;<span class="op" id="4119789">&gt;=</span>&nbsp;<span class="num" id="4119792">8</span><span class="op" id="4119793">;</span>&nbsp;<span class="ident" id="4119795">i</span><span class="op" id="4119796">--</span>&nbsp;<span class="op" id="4119799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119803">in</span><span class="op" id="4119805">[</span><span class="ident" id="4119806">i</span><span class="op" id="4119807">-</span><span class="num" id="4119808">8</span><span class="op" id="4119809">]</span>&nbsp;<span class="op" id="4119811">-=</span>&nbsp;<span class="ident" id="4119814">in</span><span class="op" id="4119816">[</span><span class="ident" id="4119817">i</span><span class="op" id="4119818">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119822">in</span><span class="op" id="4119824">[</span><span class="ident" id="4119825">i</span><span class="op" id="4119826">-</span><span class="num" id="4119827">5</span><span class="op" id="4119828">]</span>&nbsp;<span class="op" id="4119830">+=</span>&nbsp;<span class="op" id="4119833">(</span><span class="ident" id="4119834">in</span><span class="op" id="4119836">[</span><span class="ident" id="4119837">i</span><span class="op" id="4119838">]</span>&nbsp;<span class="op" id="4119840">&amp;</span>&nbsp;<span class="num" id="4119842">0xffff</span><span class="op" id="4119848">)</span>&nbsp;<span class="op" id="4119850">&lt;&lt;</span>&nbsp;<span class="num" id="4119853">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119858">in</span><span class="op" id="4119860">[</span><span class="ident" id="4119861">i</span><span class="op" id="4119862">-</span><span class="num" id="4119863">4</span><span class="op" id="4119864">]</span>&nbsp;<span class="op" id="4119866">+=</span>&nbsp;<span class="ident" id="4119869">in</span><span class="op" id="4119871">[</span><span class="ident" id="4119872">i</span><span class="op" id="4119873">]</span>&nbsp;<span class="op" id="4119875">&gt;&gt;</span>&nbsp;<span class="num" id="4119878">16</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4119882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4119885">in</span><span class="op" id="4119887">[</span><span class="num" id="4119888">8</span><span class="op" id="4119889">]</span>&nbsp;<span class="op" id="4119891">=</span>&nbsp;<span class="num" id="4119893">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4119896">//&nbsp;in[0..8]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4119918">//&nbsp;As&nbsp;the&nbsp;values&nbsp;become&nbsp;small&nbsp;enough,&nbsp;we&nbsp;start&nbsp;to&nbsp;store&nbsp;them&nbsp;in&nbsp;|out|</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4119989">//&nbsp;and&nbsp;use&nbsp;32-bit&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4120020">for</span>&nbsp;<span class="ident" id="4120024">i</span>&nbsp;<span class="op" id="4120026">:=</span>&nbsp;<span class="num" id="4120029">1</span><span class="op" id="4120030">;</span>&nbsp;<span class="ident" id="4120032">i</span>&nbsp;<span class="op" id="4120034">&lt;</span>&nbsp;<span class="num" id="4120036">8</span><span class="op" id="4120037">;</span>&nbsp;<span class="ident" id="4120039">i</span><span class="op" id="4120040">++</span>&nbsp;<span class="op" id="4120043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120047">in</span><span class="op" id="4120049">[</span><span class="ident" id="4120050">i</span><span class="op" id="4120051">+</span><span class="num" id="4120052">1</span><span class="op" id="4120053">]</span>&nbsp;<span class="op" id="4120055">+=</span>&nbsp;<span class="ident" id="4120058">in</span><span class="op" id="4120060">[</span><span class="ident" id="4120061">i</span><span class="op" id="4120062">]</span>&nbsp;<span class="op" id="4120064">&gt;&gt;</span>&nbsp;<span class="num" id="4120067">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120072">out</span><span class="op" id="4120075">[</span><span class="ident" id="4120076">i</span><span class="op" id="4120077">]</span>&nbsp;<span class="op" id="4120079">=</span>&nbsp;<span class="builtintype" id="4120081">uint32</span><span class="op" id="4120087">(</span><span class="ident" id="4120088">in</span><span class="op" id="4120090">[</span><span class="ident" id="4120091">i</span><span class="op" id="4120092">]</span>&nbsp;<span class="op" id="4120094">&amp;</span>&nbsp;<span class="ident" id="4120096">bottom28Bits</span><span class="op" id="4120108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4120111">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120114">in</span><span class="op" id="4120116">[</span><span class="num" id="4120117">0</span><span class="op" id="4120118">]</span>&nbsp;<span class="op" id="4120120">-=</span>&nbsp;<span class="ident" id="4120123">in</span><span class="op" id="4120125">[</span><span class="num" id="4120126">8</span><span class="op" id="4120127">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120130">out</span><span class="op" id="4120133">[</span><span class="num" id="4120134">3</span><span class="op" id="4120135">]</span>&nbsp;<span class="op" id="4120137">+=</span>&nbsp;<span class="builtintype" id="4120140">uint32</span><span class="op" id="4120146">(</span><span class="ident" id="4120147">in</span><span class="op" id="4120149">[</span><span class="num" id="4120150">8</span><span class="op" id="4120151">]</span><span class="op" id="4120152">&amp;</span><span class="num" id="4120153">0xffff</span><span class="op" id="4120159">)</span>&nbsp;<span class="op" id="4120161">&lt;&lt;</span>&nbsp;<span class="num" id="4120164">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120168">out</span><span class="op" id="4120171">[</span><span class="num" id="4120172">4</span><span class="op" id="4120173">]</span>&nbsp;<span class="op" id="4120175">+=</span>&nbsp;<span class="builtintype" id="4120178">uint32</span><span class="op" id="4120184">(</span><span class="ident" id="4120185">in</span><span class="op" id="4120187">[</span><span class="num" id="4120188">8</span><span class="op" id="4120189">]</span>&nbsp;<span class="op" id="4120191">&gt;&gt;</span>&nbsp;<span class="num" id="4120194">16</span><span class="op" id="4120196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120199">//&nbsp;in[0]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120217">//&nbsp;out[3]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120236">//&nbsp;out[4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120255">//&nbsp;out[1,2,5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120282">out</span><span class="op" id="4120285">[</span><span class="num" id="4120286">0</span><span class="op" id="4120287">]</span>&nbsp;<span class="op" id="4120289">=</span>&nbsp;<span class="builtintype" id="4120291">uint32</span><span class="op" id="4120297">(</span><span class="ident" id="4120298">in</span><span class="op" id="4120300">[</span><span class="num" id="4120301">0</span><span class="op" id="4120302">]</span>&nbsp;<span class="op" id="4120304">&amp;</span>&nbsp;<span class="ident" id="4120306">bottom28Bits</span><span class="op" id="4120318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120321">out</span><span class="op" id="4120324">[</span><span class="num" id="4120325">1</span><span class="op" id="4120326">]</span>&nbsp;<span class="op" id="4120328">+=</span>&nbsp;<span class="builtintype" id="4120331">uint32</span><span class="op" id="4120337">(</span><span class="op" id="4120338">(</span><span class="ident" id="4120339">in</span><span class="op" id="4120341">[</span><span class="num" id="4120342">0</span><span class="op" id="4120343">]</span>&nbsp;<span class="op" id="4120345">&gt;&gt;</span>&nbsp;<span class="num" id="4120348">28</span><span class="op" id="4120350">)</span>&nbsp;<span class="op" id="4120352">&amp;</span>&nbsp;<span class="ident" id="4120354">bottom28Bits</span><span class="op" id="4120366">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120369">out</span><span class="op" id="4120372">[</span><span class="num" id="4120373">2</span><span class="op" id="4120374">]</span>&nbsp;<span class="op" id="4120376">+=</span>&nbsp;<span class="builtintype" id="4120379">uint32</span><span class="op" id="4120385">(</span><span class="ident" id="4120386">in</span><span class="op" id="4120388">[</span><span class="num" id="4120389">0</span><span class="op" id="4120390">]</span>&nbsp;<span class="op" id="4120392">&gt;&gt;</span>&nbsp;<span class="num" id="4120395">56</span><span class="op" id="4120397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120400">//&nbsp;out[0]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120419">//&nbsp;out[1..4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120441">//&nbsp;out[5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="op" id="4120462">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="4120465">//&nbsp;Reduce&nbsp;reduces&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;a&nbsp;to&nbsp;smaller&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="comment" id="4120524">//</span><br>
<span class="lineno"></span><span class="comment" id="4120527">//&nbsp;On&nbsp;entry:&nbsp;a[i]&nbsp;&lt;&nbsp;2**31&nbsp;+&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4120561">//&nbsp;On&nbsp;exit:&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">305</span><span class="keyword" id="4120586">func</span>&nbsp;<span class="ident" id="4120591">p224Reduce</span><span class="op" id="4120601">(</span><span class="ident" id="4120602">a</span>&nbsp;<span class="op" id="4120604">*</span><span class="ident" id="4120605">p224FieldElement</span><span class="op" id="4120621">)</span>&nbsp;<span class="op" id="4120623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4120626">for</span>&nbsp;<span class="ident" id="4120630">i</span>&nbsp;<span class="op" id="4120632">:=</span>&nbsp;<span class="num" id="4120635">0</span><span class="op" id="4120636">;</span>&nbsp;<span class="ident" id="4120638">i</span>&nbsp;<span class="op" id="4120640">&lt;</span>&nbsp;<span class="num" id="4120642">7</span><span class="op" id="4120643">;</span>&nbsp;<span class="ident" id="4120645">i</span><span class="op" id="4120646">++</span>&nbsp;<span class="op" id="4120649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120653">a</span><span class="op" id="4120654">[</span><span class="ident" id="4120655">i</span><span class="op" id="4120656">+</span><span class="num" id="4120657">1</span><span class="op" id="4120658">]</span>&nbsp;<span class="op" id="4120660">+=</span>&nbsp;<span class="ident" id="4120663">a</span><span class="op" id="4120664">[</span><span class="ident" id="4120665">i</span><span class="op" id="4120666">]</span>&nbsp;<span class="op" id="4120668">&gt;&gt;</span>&nbsp;<span class="num" id="4120671">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120676">a</span><span class="op" id="4120677">[</span><span class="ident" id="4120678">i</span><span class="op" id="4120679">]</span>&nbsp;<span class="op" id="4120681">&amp;=</span>&nbsp;<span class="ident" id="4120684">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4120698">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120701">top</span>&nbsp;<span class="op" id="4120705">:=</span>&nbsp;<span class="ident" id="4120708">a</span><span class="op" id="4120709">[</span><span class="num" id="4120710">7</span><span class="op" id="4120711">]</span>&nbsp;<span class="op" id="4120713">&gt;&gt;</span>&nbsp;<span class="num" id="4120716">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120720">a</span><span class="op" id="4120721">[</span><span class="num" id="4120722">7</span><span class="op" id="4120723">]</span>&nbsp;<span class="op" id="4120725">&amp;=</span>&nbsp;<span class="ident" id="4120728">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120743">//&nbsp;top&nbsp;&lt;&nbsp;2**4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120758">mask</span>&nbsp;<span class="op" id="4120763">:=</span>&nbsp;<span class="ident" id="4120766">top</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120771">mask</span>&nbsp;<span class="op" id="4120776">|=</span>&nbsp;<span class="ident" id="4120779">mask</span>&nbsp;<span class="op" id="4120784">&gt;&gt;</span>&nbsp;<span class="num" id="4120787">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120790">mask</span>&nbsp;<span class="op" id="4120795">|=</span>&nbsp;<span class="ident" id="4120798">mask</span>&nbsp;<span class="op" id="4120803">&gt;&gt;</span>&nbsp;<span class="num" id="4120806">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120809">mask</span>&nbsp;<span class="op" id="4120814">&lt;&lt;=</span>&nbsp;<span class="num" id="4120818">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120822">mask</span>&nbsp;<span class="op" id="4120827">=</span>&nbsp;<span class="builtintype" id="4120829">uint32</span><span class="op" id="4120835">(</span><span class="builtintype" id="4120836">int32</span><span class="op" id="4120841">(</span><span class="ident" id="4120842">mask</span><span class="op" id="4120846">)</span>&nbsp;<span class="op" id="4120848">&gt;&gt;</span>&nbsp;<span class="num" id="4120851">31</span><span class="op" id="4120853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120856">//&nbsp;Mask&nbsp;is&nbsp;all&nbsp;ones&nbsp;if&nbsp;top&nbsp;!=&nbsp;0,&nbsp;all&nbsp;zero&nbsp;otherwise</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120910">a</span><span class="op" id="4120911">[</span><span class="num" id="4120912">0</span><span class="op" id="4120913">]</span>&nbsp;<span class="op" id="4120915">-=</span>&nbsp;<span class="ident" id="4120918">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4120923">a</span><span class="op" id="4120924">[</span><span class="num" id="4120925">3</span><span class="op" id="4120926">]</span>&nbsp;<span class="op" id="4120928">+=</span>&nbsp;<span class="ident" id="4120931">top</span>&nbsp;<span class="op" id="4120935">&lt;&lt;</span>&nbsp;<span class="num" id="4120938">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4120943">//&nbsp;We&nbsp;may&nbsp;have&nbsp;just&nbsp;made&nbsp;a[0]&nbsp;negative&nbsp;but,&nbsp;if&nbsp;we&nbsp;did,&nbsp;then&nbsp;we&nbsp;must</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4121012">//&nbsp;have&nbsp;added&nbsp;something&nbsp;to&nbsp;a[3],&nbsp;this&nbsp;it&#39;s&nbsp;&gt;&nbsp;2**12.&nbsp;Therefore&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4121082">//&nbsp;carry&nbsp;down&nbsp;to&nbsp;a[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121106">a</span><span class="op" id="4121107">[</span><span class="num" id="4121108">3</span><span class="op" id="4121109">]</span>&nbsp;<span class="op" id="4121111">-=</span>&nbsp;<span class="num" id="4121114">1</span>&nbsp;<span class="op" id="4121116">&amp;</span>&nbsp;<span class="ident" id="4121118">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121124">a</span><span class="op" id="4121125">[</span><span class="num" id="4121126">2</span><span class="op" id="4121127">]</span>&nbsp;<span class="op" id="4121129">+=</span>&nbsp;<span class="ident" id="4121132">mask</span>&nbsp;<span class="op" id="4121137">&amp;</span>&nbsp;<span class="op" id="4121139">(</span><span class="num" id="4121140">1</span><span class="op" id="4121141">&lt;&lt;</span><span class="num" id="4121143">28</span>&nbsp;<span class="op" id="4121146">-</span>&nbsp;<span class="num" id="4121148">1</span><span class="op" id="4121149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121152">a</span><span class="op" id="4121153">[</span><span class="num" id="4121154">1</span><span class="op" id="4121155">]</span>&nbsp;<span class="op" id="4121157">+=</span>&nbsp;<span class="ident" id="4121160">mask</span>&nbsp;<span class="op" id="4121165">&amp;</span>&nbsp;<span class="op" id="4121167">(</span><span class="num" id="4121168">1</span><span class="op" id="4121169">&lt;&lt;</span><span class="num" id="4121171">28</span>&nbsp;<span class="op" id="4121174">-</span>&nbsp;<span class="num" id="4121176">1</span><span class="op" id="4121177">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121180">a</span><span class="op" id="4121181">[</span><span class="num" id="4121182">0</span><span class="op" id="4121183">]</span>&nbsp;<span class="op" id="4121185">+=</span>&nbsp;<span class="ident" id="4121188">mask</span>&nbsp;<span class="op" id="4121193">&amp;</span>&nbsp;<span class="op" id="4121195">(</span><span class="num" id="4121196">1</span>&nbsp;<span class="op" id="4121198">&lt;&lt;</span>&nbsp;<span class="num" id="4121201">28</span><span class="op" id="4121203">)</span><br>
<span class="lineno"></span><span class="op" id="4121205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4121208">//&nbsp;p224Invert&nbsp;calculates&nbsp;*out&nbsp;=&nbsp;in**-1&nbsp;by&nbsp;computing&nbsp;in**(2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1),</span><br>
<span class="lineno"></span><span class="comment" id="4121286">//&nbsp;i.e.&nbsp;Fermat&#39;s&nbsp;little&nbsp;theorem.</span><br>
<span class="lineno">335</span><span class="keyword" id="4121319">func</span>&nbsp;<span class="ident" id="4121324">p224Invert</span><span class="op" id="4121334">(</span><span class="ident" id="4121335">out</span><span class="op" id="4121338">,</span>&nbsp;<span class="ident" id="4121340">in</span>&nbsp;<span class="op" id="4121343">*</span><span class="ident" id="4121344">p224FieldElement</span><span class="op" id="4121360">)</span>&nbsp;<span class="op" id="4121362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4121365">var</span>&nbsp;<span class="ident" id="4121369">f1</span><span class="op" id="4121371">,</span>&nbsp;<span class="ident" id="4121373">f2</span><span class="op" id="4121375">,</span>&nbsp;<span class="ident" id="4121377">f3</span><span class="op" id="4121379">,</span>&nbsp;<span class="ident" id="4121381">f4</span>&nbsp;<span class="ident" id="4121384">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4121402">var</span>&nbsp;<span class="ident" id="4121406">c</span>&nbsp;<span class="ident" id="4121408">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121432">p224Square</span><span class="op" id="4121442">(</span><span class="op" id="4121443">&amp;</span><span class="ident" id="4121444">f1</span><span class="op" id="4121446">,</span>&nbsp;<span class="ident" id="4121448">in</span><span class="op" id="4121450">,</span>&nbsp;<span class="op" id="4121452">&amp;</span><span class="ident" id="4121453">c</span><span class="op" id="4121454">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4121459">//&nbsp;2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121465">p224Mul</span><span class="op" id="4121472">(</span><span class="op" id="4121473">&amp;</span><span class="ident" id="4121474">f1</span><span class="op" id="4121476">,</span>&nbsp;<span class="op" id="4121478">&amp;</span><span class="ident" id="4121479">f1</span><span class="op" id="4121481">,</span>&nbsp;<span class="ident" id="4121483">in</span><span class="op" id="4121485">,</span>&nbsp;<span class="op" id="4121487">&amp;</span><span class="ident" id="4121488">c</span><span class="op" id="4121489">)</span>&nbsp;&nbsp;<span class="comment" id="4121492">//&nbsp;2**2&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121505">p224Square</span><span class="op" id="4121515">(</span><span class="op" id="4121516">&amp;</span><span class="ident" id="4121517">f1</span><span class="op" id="4121519">,</span>&nbsp;<span class="op" id="4121521">&amp;</span><span class="ident" id="4121522">f1</span><span class="op" id="4121524">,</span>&nbsp;<span class="op" id="4121526">&amp;</span><span class="ident" id="4121527">c</span><span class="op" id="4121528">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4121532">//&nbsp;2**3&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121545">p224Mul</span><span class="op" id="4121552">(</span><span class="op" id="4121553">&amp;</span><span class="ident" id="4121554">f1</span><span class="op" id="4121556">,</span>&nbsp;<span class="op" id="4121558">&amp;</span><span class="ident" id="4121559">f1</span><span class="op" id="4121561">,</span>&nbsp;<span class="ident" id="4121563">in</span><span class="op" id="4121565">,</span>&nbsp;<span class="op" id="4121567">&amp;</span><span class="ident" id="4121568">c</span><span class="op" id="4121569">)</span>&nbsp;&nbsp;<span class="comment" id="4121572">//&nbsp;2**3&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121585">p224Square</span><span class="op" id="4121595">(</span><span class="op" id="4121596">&amp;</span><span class="ident" id="4121597">f2</span><span class="op" id="4121599">,</span>&nbsp;<span class="op" id="4121601">&amp;</span><span class="ident" id="4121602">f1</span><span class="op" id="4121604">,</span>&nbsp;<span class="op" id="4121606">&amp;</span><span class="ident" id="4121607">c</span><span class="op" id="4121608">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4121612">//&nbsp;2**4&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121625">p224Square</span><span class="op" id="4121635">(</span><span class="op" id="4121636">&amp;</span><span class="ident" id="4121637">f2</span><span class="op" id="4121639">,</span>&nbsp;<span class="op" id="4121641">&amp;</span><span class="ident" id="4121642">f2</span><span class="op" id="4121644">,</span>&nbsp;<span class="op" id="4121646">&amp;</span><span class="ident" id="4121647">c</span><span class="op" id="4121648">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4121652">//&nbsp;2**5&nbsp;-&nbsp;4</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121665">p224Square</span><span class="op" id="4121675">(</span><span class="op" id="4121676">&amp;</span><span class="ident" id="4121677">f2</span><span class="op" id="4121679">,</span>&nbsp;<span class="op" id="4121681">&amp;</span><span class="ident" id="4121682">f2</span><span class="op" id="4121684">,</span>&nbsp;<span class="op" id="4121686">&amp;</span><span class="ident" id="4121687">c</span><span class="op" id="4121688">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4121692">//&nbsp;2**6&nbsp;-&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121705">p224Mul</span><span class="op" id="4121712">(</span><span class="op" id="4121713">&amp;</span><span class="ident" id="4121714">f1</span><span class="op" id="4121716">,</span>&nbsp;<span class="op" id="4121718">&amp;</span><span class="ident" id="4121719">f1</span><span class="op" id="4121721">,</span>&nbsp;<span class="op" id="4121723">&amp;</span><span class="ident" id="4121724">f2</span><span class="op" id="4121726">,</span>&nbsp;<span class="op" id="4121728">&amp;</span><span class="ident" id="4121729">c</span><span class="op" id="4121730">)</span>&nbsp;<span class="comment" id="4121732">//&nbsp;2**6&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121745">p224Square</span><span class="op" id="4121755">(</span><span class="op" id="4121756">&amp;</span><span class="ident" id="4121757">f2</span><span class="op" id="4121759">,</span>&nbsp;<span class="op" id="4121761">&amp;</span><span class="ident" id="4121762">f1</span><span class="op" id="4121764">,</span>&nbsp;<span class="op" id="4121766">&amp;</span><span class="ident" id="4121767">c</span><span class="op" id="4121768">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4121772">//&nbsp;2**7&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4121785">for</span>&nbsp;<span class="ident" id="4121789">i</span>&nbsp;<span class="op" id="4121791">:=</span>&nbsp;<span class="num" id="4121794">0</span><span class="op" id="4121795">;</span>&nbsp;<span class="ident" id="4121797">i</span>&nbsp;<span class="op" id="4121799">&lt;</span>&nbsp;<span class="num" id="4121801">5</span><span class="op" id="4121802">;</span>&nbsp;<span class="ident" id="4121804">i</span><span class="op" id="4121805">++</span>&nbsp;<span class="op" id="4121808">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4121812">//&nbsp;2**12&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121830">p224Square</span><span class="op" id="4121840">(</span><span class="op" id="4121841">&amp;</span><span class="ident" id="4121842">f2</span><span class="op" id="4121844">,</span>&nbsp;<span class="op" id="4121846">&amp;</span><span class="ident" id="4121847">f2</span><span class="op" id="4121849">,</span>&nbsp;<span class="op" id="4121851">&amp;</span><span class="ident" id="4121852">c</span><span class="op" id="4121853">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4121856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121859">p224Mul</span><span class="op" id="4121866">(</span><span class="op" id="4121867">&amp;</span><span class="ident" id="4121868">f2</span><span class="op" id="4121870">,</span>&nbsp;<span class="op" id="4121872">&amp;</span><span class="ident" id="4121873">f2</span><span class="op" id="4121875">,</span>&nbsp;<span class="op" id="4121877">&amp;</span><span class="ident" id="4121878">f1</span><span class="op" id="4121880">,</span>&nbsp;<span class="op" id="4121882">&amp;</span><span class="ident" id="4121883">c</span><span class="op" id="4121884">)</span>&nbsp;<span class="comment" id="4121886">//&nbsp;2**12&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121900">p224Square</span><span class="op" id="4121910">(</span><span class="op" id="4121911">&amp;</span><span class="ident" id="4121912">f3</span><span class="op" id="4121914">,</span>&nbsp;<span class="op" id="4121916">&amp;</span><span class="ident" id="4121917">f2</span><span class="op" id="4121919">,</span>&nbsp;<span class="op" id="4121921">&amp;</span><span class="ident" id="4121922">c</span><span class="op" id="4121923">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4121927">//&nbsp;2**13&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4121941">for</span>&nbsp;<span class="ident" id="4121945">i</span>&nbsp;<span class="op" id="4121947">:=</span>&nbsp;<span class="num" id="4121950">0</span><span class="op" id="4121951">;</span>&nbsp;<span class="ident" id="4121953">i</span>&nbsp;<span class="op" id="4121955">&lt;</span>&nbsp;<span class="num" id="4121957">11</span><span class="op" id="4121959">;</span>&nbsp;<span class="ident" id="4121961">i</span><span class="op" id="4121962">++</span>&nbsp;<span class="op" id="4121965">{</span>&nbsp;&nbsp;<span class="comment" id="4121968">//&nbsp;2**24&nbsp;-&nbsp;2**12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4121987">p224Square</span><span class="op" id="4121997">(</span><span class="op" id="4121998">&amp;</span><span class="ident" id="4121999">f3</span><span class="op" id="4122001">,</span>&nbsp;<span class="op" id="4122003">&amp;</span><span class="ident" id="4122004">f3</span><span class="op" id="4122006">,</span>&nbsp;<span class="op" id="4122008">&amp;</span><span class="ident" id="4122009">c</span><span class="op" id="4122010">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4122013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122016">p224Mul</span><span class="op" id="4122023">(</span><span class="op" id="4122024">&amp;</span><span class="ident" id="4122025">f2</span><span class="op" id="4122027">,</span>&nbsp;<span class="op" id="4122029">&amp;</span><span class="ident" id="4122030">f3</span><span class="op" id="4122032">,</span>&nbsp;<span class="op" id="4122034">&amp;</span><span class="ident" id="4122035">f2</span><span class="op" id="4122037">,</span>&nbsp;<span class="op" id="4122039">&amp;</span><span class="ident" id="4122040">c</span><span class="op" id="4122041">)</span>&nbsp;<span class="comment" id="4122043">//&nbsp;2**24&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122057">p224Square</span><span class="op" id="4122067">(</span><span class="op" id="4122068">&amp;</span><span class="ident" id="4122069">f3</span><span class="op" id="4122071">,</span>&nbsp;<span class="op" id="4122073">&amp;</span><span class="ident" id="4122074">f2</span><span class="op" id="4122076">,</span>&nbsp;<span class="op" id="4122078">&amp;</span><span class="ident" id="4122079">c</span><span class="op" id="4122080">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4122084">//&nbsp;2**25&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4122098">for</span>&nbsp;<span class="ident" id="4122102">i</span>&nbsp;<span class="op" id="4122104">:=</span>&nbsp;<span class="num" id="4122107">0</span><span class="op" id="4122108">;</span>&nbsp;<span class="ident" id="4122110">i</span>&nbsp;<span class="op" id="4122112">&lt;</span>&nbsp;<span class="num" id="4122114">23</span><span class="op" id="4122116">;</span>&nbsp;<span class="ident" id="4122118">i</span><span class="op" id="4122119">++</span>&nbsp;<span class="op" id="4122122">{</span>&nbsp;&nbsp;<span class="comment" id="4122125">//&nbsp;2**48&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122144">p224Square</span><span class="op" id="4122154">(</span><span class="op" id="4122155">&amp;</span><span class="ident" id="4122156">f3</span><span class="op" id="4122158">,</span>&nbsp;<span class="op" id="4122160">&amp;</span><span class="ident" id="4122161">f3</span><span class="op" id="4122163">,</span>&nbsp;<span class="op" id="4122165">&amp;</span><span class="ident" id="4122166">c</span><span class="op" id="4122167">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4122170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122173">p224Mul</span><span class="op" id="4122180">(</span><span class="op" id="4122181">&amp;</span><span class="ident" id="4122182">f3</span><span class="op" id="4122184">,</span>&nbsp;<span class="op" id="4122186">&amp;</span><span class="ident" id="4122187">f3</span><span class="op" id="4122189">,</span>&nbsp;<span class="op" id="4122191">&amp;</span><span class="ident" id="4122192">f2</span><span class="op" id="4122194">,</span>&nbsp;<span class="op" id="4122196">&amp;</span><span class="ident" id="4122197">c</span><span class="op" id="4122198">)</span>&nbsp;<span class="comment" id="4122200">//&nbsp;2**48&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122214">p224Square</span><span class="op" id="4122224">(</span><span class="op" id="4122225">&amp;</span><span class="ident" id="4122226">f4</span><span class="op" id="4122228">,</span>&nbsp;<span class="op" id="4122230">&amp;</span><span class="ident" id="4122231">f3</span><span class="op" id="4122233">,</span>&nbsp;<span class="op" id="4122235">&amp;</span><span class="ident" id="4122236">c</span><span class="op" id="4122237">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4122241">//&nbsp;2**49&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4122255">for</span>&nbsp;<span class="ident" id="4122259">i</span>&nbsp;<span class="op" id="4122261">:=</span>&nbsp;<span class="num" id="4122264">0</span><span class="op" id="4122265">;</span>&nbsp;<span class="ident" id="4122267">i</span>&nbsp;<span class="op" id="4122269">&lt;</span>&nbsp;<span class="num" id="4122271">47</span><span class="op" id="4122273">;</span>&nbsp;<span class="ident" id="4122275">i</span><span class="op" id="4122276">++</span>&nbsp;<span class="op" id="4122279">{</span>&nbsp;&nbsp;<span class="comment" id="4122282">//&nbsp;2**96&nbsp;-&nbsp;2**48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122301">p224Square</span><span class="op" id="4122311">(</span><span class="op" id="4122312">&amp;</span><span class="ident" id="4122313">f4</span><span class="op" id="4122315">,</span>&nbsp;<span class="op" id="4122317">&amp;</span><span class="ident" id="4122318">f4</span><span class="op" id="4122320">,</span>&nbsp;<span class="op" id="4122322">&amp;</span><span class="ident" id="4122323">c</span><span class="op" id="4122324">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4122327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122330">p224Mul</span><span class="op" id="4122337">(</span><span class="op" id="4122338">&amp;</span><span class="ident" id="4122339">f3</span><span class="op" id="4122341">,</span>&nbsp;<span class="op" id="4122343">&amp;</span><span class="ident" id="4122344">f3</span><span class="op" id="4122346">,</span>&nbsp;<span class="op" id="4122348">&amp;</span><span class="ident" id="4122349">f4</span><span class="op" id="4122351">,</span>&nbsp;<span class="op" id="4122353">&amp;</span><span class="ident" id="4122354">c</span><span class="op" id="4122355">)</span>&nbsp;<span class="comment" id="4122357">//&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122371">p224Square</span><span class="op" id="4122381">(</span><span class="op" id="4122382">&amp;</span><span class="ident" id="4122383">f4</span><span class="op" id="4122385">,</span>&nbsp;<span class="op" id="4122387">&amp;</span><span class="ident" id="4122388">f3</span><span class="op" id="4122390">,</span>&nbsp;<span class="op" id="4122392">&amp;</span><span class="ident" id="4122393">c</span><span class="op" id="4122394">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4122398">//&nbsp;2**97&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4122412">for</span>&nbsp;<span class="ident" id="4122416">i</span>&nbsp;<span class="op" id="4122418">:=</span>&nbsp;<span class="num" id="4122421">0</span><span class="op" id="4122422">;</span>&nbsp;<span class="ident" id="4122424">i</span>&nbsp;<span class="op" id="4122426">&lt;</span>&nbsp;<span class="num" id="4122428">23</span><span class="op" id="4122430">;</span>&nbsp;<span class="ident" id="4122432">i</span><span class="op" id="4122433">++</span>&nbsp;<span class="op" id="4122436">{</span>&nbsp;&nbsp;<span class="comment" id="4122439">//&nbsp;2**120&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122459">p224Square</span><span class="op" id="4122469">(</span><span class="op" id="4122470">&amp;</span><span class="ident" id="4122471">f4</span><span class="op" id="4122473">,</span>&nbsp;<span class="op" id="4122475">&amp;</span><span class="ident" id="4122476">f4</span><span class="op" id="4122478">,</span>&nbsp;<span class="op" id="4122480">&amp;</span><span class="ident" id="4122481">c</span><span class="op" id="4122482">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4122485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122488">p224Mul</span><span class="op" id="4122495">(</span><span class="op" id="4122496">&amp;</span><span class="ident" id="4122497">f2</span><span class="op" id="4122499">,</span>&nbsp;<span class="op" id="4122501">&amp;</span><span class="ident" id="4122502">f4</span><span class="op" id="4122504">,</span>&nbsp;<span class="op" id="4122506">&amp;</span><span class="ident" id="4122507">f2</span><span class="op" id="4122509">,</span>&nbsp;<span class="op" id="4122511">&amp;</span><span class="ident" id="4122512">c</span><span class="op" id="4122513">)</span>&nbsp;<span class="comment" id="4122515">//&nbsp;2**120&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4122530">for</span>&nbsp;<span class="ident" id="4122534">i</span>&nbsp;<span class="op" id="4122536">:=</span>&nbsp;<span class="num" id="4122539">0</span><span class="op" id="4122540">;</span>&nbsp;<span class="ident" id="4122542">i</span>&nbsp;<span class="op" id="4122544">&lt;</span>&nbsp;<span class="num" id="4122546">6</span><span class="op" id="4122547">;</span>&nbsp;<span class="ident" id="4122549">i</span><span class="op" id="4122550">++</span>&nbsp;<span class="op" id="4122553">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4122557">//&nbsp;2**126&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122576">p224Square</span><span class="op" id="4122586">(</span><span class="op" id="4122587">&amp;</span><span class="ident" id="4122588">f2</span><span class="op" id="4122590">,</span>&nbsp;<span class="op" id="4122592">&amp;</span><span class="ident" id="4122593">f2</span><span class="op" id="4122595">,</span>&nbsp;<span class="op" id="4122597">&amp;</span><span class="ident" id="4122598">c</span><span class="op" id="4122599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4122602">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122605">p224Mul</span><span class="op" id="4122612">(</span><span class="op" id="4122613">&amp;</span><span class="ident" id="4122614">f1</span><span class="op" id="4122616">,</span>&nbsp;<span class="op" id="4122618">&amp;</span><span class="ident" id="4122619">f1</span><span class="op" id="4122621">,</span>&nbsp;<span class="op" id="4122623">&amp;</span><span class="ident" id="4122624">f2</span><span class="op" id="4122626">,</span>&nbsp;<span class="op" id="4122628">&amp;</span><span class="ident" id="4122629">c</span><span class="op" id="4122630">)</span>&nbsp;<span class="comment" id="4122632">//&nbsp;2**126&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122647">p224Square</span><span class="op" id="4122657">(</span><span class="op" id="4122658">&amp;</span><span class="ident" id="4122659">f1</span><span class="op" id="4122661">,</span>&nbsp;<span class="op" id="4122663">&amp;</span><span class="ident" id="4122664">f1</span><span class="op" id="4122666">,</span>&nbsp;<span class="op" id="4122668">&amp;</span><span class="ident" id="4122669">c</span><span class="op" id="4122670">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4122674">//&nbsp;2**127&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122689">p224Mul</span><span class="op" id="4122696">(</span><span class="op" id="4122697">&amp;</span><span class="ident" id="4122698">f1</span><span class="op" id="4122700">,</span>&nbsp;<span class="op" id="4122702">&amp;</span><span class="ident" id="4122703">f1</span><span class="op" id="4122705">,</span>&nbsp;<span class="ident" id="4122707">in</span><span class="op" id="4122709">,</span>&nbsp;<span class="op" id="4122711">&amp;</span><span class="ident" id="4122712">c</span><span class="op" id="4122713">)</span>&nbsp;&nbsp;<span class="comment" id="4122716">//&nbsp;2**127&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4122731">for</span>&nbsp;<span class="ident" id="4122735">i</span>&nbsp;<span class="op" id="4122737">:=</span>&nbsp;<span class="num" id="4122740">0</span><span class="op" id="4122741">;</span>&nbsp;<span class="ident" id="4122743">i</span>&nbsp;<span class="op" id="4122745">&lt;</span>&nbsp;<span class="num" id="4122747">97</span><span class="op" id="4122749">;</span>&nbsp;<span class="ident" id="4122751">i</span><span class="op" id="4122752">++</span>&nbsp;<span class="op" id="4122755">{</span>&nbsp;&nbsp;<span class="comment" id="4122758">//&nbsp;2**224&nbsp;-&nbsp;2**97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122778">p224Square</span><span class="op" id="4122788">(</span><span class="op" id="4122789">&amp;</span><span class="ident" id="4122790">f1</span><span class="op" id="4122792">,</span>&nbsp;<span class="op" id="4122794">&amp;</span><span class="ident" id="4122795">f1</span><span class="op" id="4122797">,</span>&nbsp;<span class="op" id="4122799">&amp;</span><span class="ident" id="4122800">c</span><span class="op" id="4122801">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4122804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4122807">p224Mul</span><span class="op" id="4122814">(</span><span class="ident" id="4122815">out</span><span class="op" id="4122818">,</span>&nbsp;<span class="op" id="4122820">&amp;</span><span class="ident" id="4122821">f1</span><span class="op" id="4122823">,</span>&nbsp;<span class="op" id="4122825">&amp;</span><span class="ident" id="4122826">f3</span><span class="op" id="4122828">,</span>&nbsp;<span class="op" id="4122830">&amp;</span><span class="ident" id="4122831">c</span><span class="op" id="4122832">)</span>&nbsp;<span class="comment" id="4122834">//&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span><span class="op" id="4122856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4122859">//&nbsp;p224Contract&nbsp;converts&nbsp;a&nbsp;FieldElement&nbsp;to&nbsp;its&nbsp;unique,&nbsp;minimal&nbsp;form.</span><br>
<span class="lineno">385</span><span class="comment" id="4122928">//</span><br>
<span class="lineno"></span><span class="comment" id="4122931">//&nbsp;On&nbsp;entry,&nbsp;in[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4122958">//&nbsp;On&nbsp;exit,&nbsp;in[i]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="keyword" id="4122984">func</span>&nbsp;<span class="ident" id="4122989">p224Contract</span><span class="op" id="4123001">(</span><span class="ident" id="4123002">out</span><span class="op" id="4123005">,</span>&nbsp;<span class="ident" id="4123007">in</span>&nbsp;<span class="op" id="4123010">*</span><span class="ident" id="4123011">p224FieldElement</span><span class="op" id="4123027">)</span>&nbsp;<span class="op" id="4123029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4123032">copy</span><span class="op" id="4123036">(</span><span class="ident" id="4123037">out</span><span class="op" id="4123040">[</span><span class="op" id="4123041">:</span><span class="op" id="4123042">]</span><span class="op" id="4123043">,</span>&nbsp;<span class="ident" id="4123045">in</span><span class="op" id="4123047">[</span><span class="op" id="4123048">:</span><span class="op" id="4123049">]</span><span class="op" id="4123050">)</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123054">for</span>&nbsp;<span class="ident" id="4123058">i</span>&nbsp;<span class="op" id="4123060">:=</span>&nbsp;<span class="num" id="4123063">0</span><span class="op" id="4123064">;</span>&nbsp;<span class="ident" id="4123066">i</span>&nbsp;<span class="op" id="4123068">&lt;</span>&nbsp;<span class="num" id="4123070">7</span><span class="op" id="4123071">;</span>&nbsp;<span class="ident" id="4123073">i</span><span class="op" id="4123074">++</span>&nbsp;<span class="op" id="4123077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123081">out</span><span class="op" id="4123084">[</span><span class="ident" id="4123085">i</span><span class="op" id="4123086">+</span><span class="num" id="4123087">1</span><span class="op" id="4123088">]</span>&nbsp;<span class="op" id="4123090">+=</span>&nbsp;<span class="ident" id="4123093">out</span><span class="op" id="4123096">[</span><span class="ident" id="4123097">i</span><span class="op" id="4123098">]</span>&nbsp;<span class="op" id="4123100">&gt;&gt;</span>&nbsp;<span class="num" id="4123103">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123108">out</span><span class="op" id="4123111">[</span><span class="ident" id="4123112">i</span><span class="op" id="4123113">]</span>&nbsp;<span class="op" id="4123115">&amp;=</span>&nbsp;<span class="ident" id="4123118">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4123132">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123135">top</span>&nbsp;<span class="op" id="4123139">:=</span>&nbsp;<span class="ident" id="4123142">out</span><span class="op" id="4123145">[</span><span class="num" id="4123146">7</span><span class="op" id="4123147">]</span>&nbsp;<span class="op" id="4123149">&gt;&gt;</span>&nbsp;<span class="num" id="4123152">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123156">out</span><span class="op" id="4123159">[</span><span class="num" id="4123160">7</span><span class="op" id="4123161">]</span>&nbsp;<span class="op" id="4123163">&amp;=</span>&nbsp;<span class="ident" id="4123166">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123181">out</span><span class="op" id="4123184">[</span><span class="num" id="4123185">0</span><span class="op" id="4123186">]</span>&nbsp;<span class="op" id="4123188">-=</span>&nbsp;<span class="ident" id="4123191">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123196">out</span><span class="op" id="4123199">[</span><span class="num" id="4123200">3</span><span class="op" id="4123201">]</span>&nbsp;<span class="op" id="4123203">+=</span>&nbsp;<span class="ident" id="4123206">top</span>&nbsp;<span class="op" id="4123210">&lt;&lt;</span>&nbsp;<span class="num" id="4123213">12</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4123218">//&nbsp;We&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[i]&nbsp;negative.&nbsp;So&nbsp;we&nbsp;carry&nbsp;down.&nbsp;If&nbsp;we&nbsp;made</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4123290">//&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is&nbsp;sufficiently&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4123360">//&nbsp;because&nbsp;we&nbsp;just&nbsp;added&nbsp;to&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123393">for</span>&nbsp;<span class="ident" id="4123397">i</span>&nbsp;<span class="op" id="4123399">:=</span>&nbsp;<span class="num" id="4123402">0</span><span class="op" id="4123403">;</span>&nbsp;<span class="ident" id="4123405">i</span>&nbsp;<span class="op" id="4123407">&lt;</span>&nbsp;<span class="num" id="4123409">3</span><span class="op" id="4123410">;</span>&nbsp;<span class="ident" id="4123412">i</span><span class="op" id="4123413">++</span>&nbsp;<span class="op" id="4123416">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123420">mask</span>&nbsp;<span class="op" id="4123425">:=</span>&nbsp;<span class="builtintype" id="4123428">uint32</span><span class="op" id="4123434">(</span><span class="builtintype" id="4123435">int32</span><span class="op" id="4123440">(</span><span class="ident" id="4123441">out</span><span class="op" id="4123444">[</span><span class="ident" id="4123445">i</span><span class="op" id="4123446">]</span><span class="op" id="4123447">)</span>&nbsp;<span class="op" id="4123449">&gt;&gt;</span>&nbsp;<span class="num" id="4123452">31</span><span class="op" id="4123454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123458">out</span><span class="op" id="4123461">[</span><span class="ident" id="4123462">i</span><span class="op" id="4123463">]</span>&nbsp;<span class="op" id="4123465">+=</span>&nbsp;<span class="op" id="4123468">(</span><span class="num" id="4123469">1</span>&nbsp;<span class="op" id="4123471">&lt;&lt;</span>&nbsp;<span class="num" id="4123474">28</span><span class="op" id="4123476">)</span>&nbsp;<span class="op" id="4123478">&amp;</span>&nbsp;<span class="ident" id="4123480">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123487">out</span><span class="op" id="4123490">[</span><span class="ident" id="4123491">i</span><span class="op" id="4123492">+</span><span class="num" id="4123493">1</span><span class="op" id="4123494">]</span>&nbsp;<span class="op" id="4123496">-=</span>&nbsp;<span class="num" id="4123499">1</span>&nbsp;<span class="op" id="4123501">&amp;</span>&nbsp;<span class="ident" id="4123503">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4123509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4123513">//&nbsp;We&nbsp;might&nbsp;have&nbsp;pushed&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;so&nbsp;we&nbsp;perform&nbsp;another,&nbsp;partial,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4123588">//&nbsp;carry&nbsp;chain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4123605">for</span>&nbsp;<span class="ident" id="4123609">i</span>&nbsp;<span class="op" id="4123611">:=</span>&nbsp;<span class="num" id="4123614">3</span><span class="op" id="4123615">;</span>&nbsp;<span class="ident" id="4123617">i</span>&nbsp;<span class="op" id="4123619">&lt;</span>&nbsp;<span class="num" id="4123621">7</span><span class="op" id="4123622">;</span>&nbsp;<span class="ident" id="4123624">i</span><span class="op" id="4123625">++</span>&nbsp;<span class="op" id="4123628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123632">out</span><span class="op" id="4123635">[</span><span class="ident" id="4123636">i</span><span class="op" id="4123637">+</span><span class="num" id="4123638">1</span><span class="op" id="4123639">]</span>&nbsp;<span class="op" id="4123641">+=</span>&nbsp;<span class="ident" id="4123644">out</span><span class="op" id="4123647">[</span><span class="ident" id="4123648">i</span><span class="op" id="4123649">]</span>&nbsp;<span class="op" id="4123651">&gt;&gt;</span>&nbsp;<span class="num" id="4123654">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123659">out</span><span class="op" id="4123662">[</span><span class="ident" id="4123663">i</span><span class="op" id="4123664">]</span>&nbsp;<span class="op" id="4123666">&amp;=</span>&nbsp;<span class="ident" id="4123669">bottom28Bits</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4123683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123686">top</span>&nbsp;<span class="op" id="4123690">=</span>&nbsp;<span class="ident" id="4123692">out</span><span class="op" id="4123695">[</span><span class="num" id="4123696">7</span><span class="op" id="4123697">]</span>&nbsp;<span class="op" id="4123699">&gt;&gt;</span>&nbsp;<span class="num" id="4123702">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123706">out</span><span class="op" id="4123709">[</span><span class="num" id="4123710">7</span><span class="op" id="4123711">]</span>&nbsp;<span class="op" id="4123713">&amp;=</span>&nbsp;<span class="ident" id="4123716">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4123731">//&nbsp;Eliminate&nbsp;top&nbsp;while&nbsp;maintaining&nbsp;the&nbsp;same&nbsp;value&nbsp;mod&nbsp;p.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123789">out</span><span class="op" id="4123792">[</span><span class="num" id="4123793">0</span><span class="op" id="4123794">]</span>&nbsp;<span class="op" id="4123796">-=</span>&nbsp;<span class="ident" id="4123799">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4123804">out</span><span class="op" id="4123807">[</span><span class="num" id="4123808">3</span><span class="op" id="4123809">]</span>&nbsp;<span class="op" id="4123811">+=</span>&nbsp;<span class="ident" id="4123814">top</span>&nbsp;<span class="op" id="4123818">&lt;&lt;</span>&nbsp;<span class="num" id="4123821">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4123826">//&nbsp;There&nbsp;are&nbsp;two&nbsp;cases&nbsp;to&nbsp;consider&nbsp;for&nbsp;out[3]:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4123874">//&nbsp;&nbsp;&nbsp;1)&nbsp;The&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top,&nbsp;we&nbsp;didn&#39;t&nbsp;push&nbsp;out[3]&nbsp;over</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4123949">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2**28.&nbsp;In&nbsp;this&nbsp;case,&nbsp;the&nbsp;partial&nbsp;carry&nbsp;chain&nbsp;didn&#39;t&nbsp;change&nbsp;any&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124028">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;top&nbsp;is&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124054">//&nbsp;&nbsp;&nbsp;2)&nbsp;We&nbsp;did&nbsp;push&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;the&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124132">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;first&nbsp;value&nbsp;of&nbsp;top&nbsp;was&nbsp;in&nbsp;[0..16),&nbsp;therefore,&nbsp;prior&nbsp;to&nbsp;eliminating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124212">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;first&nbsp;top,&nbsp;0xfff1000&nbsp;&lt;=&nbsp;out[3]&nbsp;&lt;=&nbsp;0xfffffff.&nbsp;Therefore,&nbsp;after</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124287">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflowing&nbsp;and&nbsp;being&nbsp;reduced&nbsp;by&nbsp;the&nbsp;second&nbsp;carry&nbsp;chain,&nbsp;out[3]&nbsp;&lt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124363">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf000.&nbsp;Thus&nbsp;it&nbsp;cannot&nbsp;have&nbsp;overflowed&nbsp;when&nbsp;we&nbsp;eliminated&nbsp;top&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124442">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124465">//&nbsp;Again,&nbsp;we&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[0]&nbsp;negative,&nbsp;so&nbsp;do&nbsp;the&nbsp;same&nbsp;carry&nbsp;down.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124542">//&nbsp;As&nbsp;before,&nbsp;if&nbsp;we&nbsp;made&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124612">//&nbsp;sufficiently&nbsp;positive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4124639">for</span>&nbsp;<span class="ident" id="4124643">i</span>&nbsp;<span class="op" id="4124645">:=</span>&nbsp;<span class="num" id="4124648">0</span><span class="op" id="4124649">;</span>&nbsp;<span class="ident" id="4124651">i</span>&nbsp;<span class="op" id="4124653">&lt;</span>&nbsp;<span class="num" id="4124655">3</span><span class="op" id="4124656">;</span>&nbsp;<span class="ident" id="4124658">i</span><span class="op" id="4124659">++</span>&nbsp;<span class="op" id="4124662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4124666">mask</span>&nbsp;<span class="op" id="4124671">:=</span>&nbsp;<span class="builtintype" id="4124674">uint32</span><span class="op" id="4124680">(</span><span class="builtintype" id="4124681">int32</span><span class="op" id="4124686">(</span><span class="ident" id="4124687">out</span><span class="op" id="4124690">[</span><span class="ident" id="4124691">i</span><span class="op" id="4124692">]</span><span class="op" id="4124693">)</span>&nbsp;<span class="op" id="4124695">&gt;&gt;</span>&nbsp;<span class="num" id="4124698">31</span><span class="op" id="4124700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4124704">out</span><span class="op" id="4124707">[</span><span class="ident" id="4124708">i</span><span class="op" id="4124709">]</span>&nbsp;<span class="op" id="4124711">+=</span>&nbsp;<span class="op" id="4124714">(</span><span class="num" id="4124715">1</span>&nbsp;<span class="op" id="4124717">&lt;&lt;</span>&nbsp;<span class="num" id="4124720">28</span><span class="op" id="4124722">)</span>&nbsp;<span class="op" id="4124724">&amp;</span>&nbsp;<span class="ident" id="4124726">mask</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4124733">out</span><span class="op" id="4124736">[</span><span class="ident" id="4124737">i</span><span class="op" id="4124738">+</span><span class="num" id="4124739">1</span><span class="op" id="4124740">]</span>&nbsp;<span class="op" id="4124742">-=</span>&nbsp;<span class="num" id="4124745">1</span>&nbsp;<span class="op" id="4124747">&amp;</span>&nbsp;<span class="ident" id="4124749">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4124755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124759">//&nbsp;Now&nbsp;we&nbsp;see&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p&nbsp;and,&nbsp;if&nbsp;so,&nbsp;subtract&nbsp;p.</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124820">//&nbsp;First&nbsp;we&nbsp;build&nbsp;a&nbsp;mask&nbsp;from&nbsp;the&nbsp;top&nbsp;four&nbsp;limbs,&nbsp;which&nbsp;must&nbsp;all&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124889">//&nbsp;equal&nbsp;to&nbsp;bottom28Bits&nbsp;if&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p.&nbsp;If&nbsp;top4AllOnes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4124958">//&nbsp;ends&nbsp;up&nbsp;with&nbsp;any&nbsp;zero&nbsp;bits&nbsp;in&nbsp;the&nbsp;bottom&nbsp;28&nbsp;bits,&nbsp;then&nbsp;this&nbsp;wasn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4125029">//&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125039">top4AllOnes</span>&nbsp;<span class="op" id="4125051">:=</span>&nbsp;<span class="builtintype" id="4125054">uint32</span><span class="op" id="4125060">(</span><span class="num" id="4125061">0xffffffff</span><span class="op" id="4125071">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4125074">for</span>&nbsp;<span class="ident" id="4125078">i</span>&nbsp;<span class="op" id="4125080">:=</span>&nbsp;<span class="num" id="4125083">4</span><span class="op" id="4125084">;</span>&nbsp;<span class="ident" id="4125086">i</span>&nbsp;<span class="op" id="4125088">&lt;</span>&nbsp;<span class="num" id="4125090">8</span><span class="op" id="4125091">;</span>&nbsp;<span class="ident" id="4125093">i</span><span class="op" id="4125094">++</span>&nbsp;<span class="op" id="4125097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125101">top4AllOnes</span>&nbsp;<span class="op" id="4125113">&amp;=</span>&nbsp;<span class="ident" id="4125116">out</span><span class="op" id="4125119">[</span><span class="ident" id="4125120">i</span><span class="op" id="4125121">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4125124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125127">top4AllOnes</span>&nbsp;<span class="op" id="4125139">|=</span>&nbsp;<span class="num" id="4125142">0xf0000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4125154">//&nbsp;Now&nbsp;we&nbsp;replicate&nbsp;any&nbsp;zero&nbsp;bits&nbsp;to&nbsp;all&nbsp;the&nbsp;bits&nbsp;in&nbsp;top4AllOnes.</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125221">top4AllOnes</span>&nbsp;<span class="op" id="4125233">&amp;=</span>&nbsp;<span class="ident" id="4125236">top4AllOnes</span>&nbsp;<span class="op" id="4125248">&gt;&gt;</span>&nbsp;<span class="num" id="4125251">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125255">top4AllOnes</span>&nbsp;<span class="op" id="4125267">&amp;=</span>&nbsp;<span class="ident" id="4125270">top4AllOnes</span>&nbsp;<span class="op" id="4125282">&gt;&gt;</span>&nbsp;<span class="num" id="4125285">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125288">top4AllOnes</span>&nbsp;<span class="op" id="4125300">&amp;=</span>&nbsp;<span class="ident" id="4125303">top4AllOnes</span>&nbsp;<span class="op" id="4125315">&gt;&gt;</span>&nbsp;<span class="num" id="4125318">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125321">top4AllOnes</span>&nbsp;<span class="op" id="4125333">&amp;=</span>&nbsp;<span class="ident" id="4125336">top4AllOnes</span>&nbsp;<span class="op" id="4125348">&gt;&gt;</span>&nbsp;<span class="num" id="4125351">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125354">top4AllOnes</span>&nbsp;<span class="op" id="4125366">&amp;=</span>&nbsp;<span class="ident" id="4125369">top4AllOnes</span>&nbsp;<span class="op" id="4125381">&gt;&gt;</span>&nbsp;<span class="num" id="4125384">1</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125387">top4AllOnes</span>&nbsp;<span class="op" id="4125399">=</span>&nbsp;<span class="builtintype" id="4125401">uint32</span><span class="op" id="4125407">(</span><span class="builtintype" id="4125408">int32</span><span class="op" id="4125413">(</span><span class="ident" id="4125414">top4AllOnes</span><span class="op" id="4125425">&lt;&lt;</span><span class="num" id="4125427">31</span><span class="op" id="4125429">)</span>&nbsp;<span class="op" id="4125431">&gt;&gt;</span>&nbsp;<span class="num" id="4125434">31</span><span class="op" id="4125436">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4125440">//&nbsp;Now&nbsp;we&nbsp;test&nbsp;whether&nbsp;the&nbsp;bottom&nbsp;three&nbsp;limbs&nbsp;are&nbsp;non-zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125501">bottom3NonZero</span>&nbsp;<span class="op" id="4125516">:=</span>&nbsp;<span class="ident" id="4125519">out</span><span class="op" id="4125522">[</span><span class="num" id="4125523">0</span><span class="op" id="4125524">]</span>&nbsp;<span class="op" id="4125526">|</span>&nbsp;<span class="ident" id="4125528">out</span><span class="op" id="4125531">[</span><span class="num" id="4125532">1</span><span class="op" id="4125533">]</span>&nbsp;<span class="op" id="4125535">|</span>&nbsp;<span class="ident" id="4125537">out</span><span class="op" id="4125540">[</span><span class="num" id="4125541">2</span><span class="op" id="4125542">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125545">bottom3NonZero</span>&nbsp;<span class="op" id="4125560">|=</span>&nbsp;<span class="ident" id="4125563">bottom3NonZero</span>&nbsp;<span class="op" id="4125578">&gt;&gt;</span>&nbsp;<span class="num" id="4125581">16</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125585">bottom3NonZero</span>&nbsp;<span class="op" id="4125600">|=</span>&nbsp;<span class="ident" id="4125603">bottom3NonZero</span>&nbsp;<span class="op" id="4125618">&gt;&gt;</span>&nbsp;<span class="num" id="4125621">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125624">bottom3NonZero</span>&nbsp;<span class="op" id="4125639">|=</span>&nbsp;<span class="ident" id="4125642">bottom3NonZero</span>&nbsp;<span class="op" id="4125657">&gt;&gt;</span>&nbsp;<span class="num" id="4125660">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125663">bottom3NonZero</span>&nbsp;<span class="op" id="4125678">|=</span>&nbsp;<span class="ident" id="4125681">bottom3NonZero</span>&nbsp;<span class="op" id="4125696">&gt;&gt;</span>&nbsp;<span class="num" id="4125699">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125702">bottom3NonZero</span>&nbsp;<span class="op" id="4125717">|=</span>&nbsp;<span class="ident" id="4125720">bottom3NonZero</span>&nbsp;<span class="op" id="4125735">&gt;&gt;</span>&nbsp;<span class="num" id="4125738">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4125741">bottom3NonZero</span>&nbsp;<span class="op" id="4125756">=</span>&nbsp;<span class="builtintype" id="4125758">uint32</span><span class="op" id="4125764">(</span><span class="builtintype" id="4125765">int32</span><span class="op" id="4125770">(</span><span class="ident" id="4125771">bottom3NonZero</span><span class="op" id="4125785">&lt;&lt;</span><span class="num" id="4125787">31</span><span class="op" id="4125789">)</span>&nbsp;<span class="op" id="4125791">&gt;&gt;</span>&nbsp;<span class="num" id="4125794">31</span><span class="op" id="4125796">)</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4125800">//&nbsp;Everything&nbsp;depends&nbsp;on&nbsp;the&nbsp;value&nbsp;of&nbsp;out[3].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4125847">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&gt;&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4125924">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;=&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;and&nbsp;bottom3NonZero&nbsp;!=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4125997">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4126035">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&lt;&nbsp;0xffff000,&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&lt;&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126091">n</span>&nbsp;<span class="op" id="4126093">:=</span>&nbsp;<span class="ident" id="4126096">out</span><span class="op" id="4126099">[</span><span class="num" id="4126100">3</span><span class="op" id="4126101">]</span>&nbsp;<span class="op" id="4126103">-</span>&nbsp;<span class="num" id="4126105">0xffff000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126116">out3Equal</span>&nbsp;<span class="op" id="4126126">:=</span>&nbsp;<span class="ident" id="4126129">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126132">out3Equal</span>&nbsp;<span class="op" id="4126142">|=</span>&nbsp;<span class="ident" id="4126145">out3Equal</span>&nbsp;<span class="op" id="4126155">&gt;&gt;</span>&nbsp;<span class="num" id="4126158">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126162">out3Equal</span>&nbsp;<span class="op" id="4126172">|=</span>&nbsp;<span class="ident" id="4126175">out3Equal</span>&nbsp;<span class="op" id="4126185">&gt;&gt;</span>&nbsp;<span class="num" id="4126188">8</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126191">out3Equal</span>&nbsp;<span class="op" id="4126201">|=</span>&nbsp;<span class="ident" id="4126204">out3Equal</span>&nbsp;<span class="op" id="4126214">&gt;&gt;</span>&nbsp;<span class="num" id="4126217">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126220">out3Equal</span>&nbsp;<span class="op" id="4126230">|=</span>&nbsp;<span class="ident" id="4126233">out3Equal</span>&nbsp;<span class="op" id="4126243">&gt;&gt;</span>&nbsp;<span class="num" id="4126246">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126249">out3Equal</span>&nbsp;<span class="op" id="4126259">|=</span>&nbsp;<span class="ident" id="4126262">out3Equal</span>&nbsp;<span class="op" id="4126272">&gt;&gt;</span>&nbsp;<span class="num" id="4126275">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126278">out3Equal</span>&nbsp;<span class="op" id="4126288">=</span>&nbsp;<span class="op" id="4126290">^</span><span class="builtintype" id="4126291">uint32</span><span class="op" id="4126297">(</span><span class="builtintype" id="4126298">int32</span><span class="op" id="4126303">(</span><span class="ident" id="4126304">out3Equal</span><span class="op" id="4126313">&lt;&lt;</span><span class="num" id="4126315">31</span><span class="op" id="4126317">)</span>&nbsp;<span class="op" id="4126319">&gt;&gt;</span>&nbsp;<span class="num" id="4126322">31</span><span class="op" id="4126324">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4126328">//&nbsp;If&nbsp;out[3]&nbsp;&gt;&nbsp;0xffff000&nbsp;then&nbsp;n&#39;s&nbsp;MSB&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126381">out3GT</span>&nbsp;<span class="op" id="4126388">:=</span>&nbsp;<span class="op" id="4126391">^</span><span class="builtintype" id="4126392">uint32</span><span class="op" id="4126398">(</span><span class="builtintype" id="4126399">int32</span><span class="op" id="4126404">(</span><span class="ident" id="4126405">n</span><span class="op" id="4126406">)</span>&nbsp;<span class="op" id="4126408">&gt;&gt;</span>&nbsp;<span class="num" id="4126411">31</span><span class="op" id="4126413">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126417">mask</span>&nbsp;<span class="op" id="4126422">:=</span>&nbsp;<span class="ident" id="4126425">top4AllOnes</span>&nbsp;<span class="op" id="4126437">&amp;</span>&nbsp;<span class="op" id="4126439">(</span><span class="op" id="4126440">(</span><span class="ident" id="4126441">out3Equal</span>&nbsp;<span class="op" id="4126451">&amp;</span>&nbsp;<span class="ident" id="4126453">bottom3NonZero</span><span class="op" id="4126467">)</span>&nbsp;<span class="op" id="4126469">|</span>&nbsp;<span class="ident" id="4126471">out3GT</span><span class="op" id="4126477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126480">out</span><span class="op" id="4126483">[</span><span class="num" id="4126484">0</span><span class="op" id="4126485">]</span>&nbsp;<span class="op" id="4126487">-=</span>&nbsp;<span class="num" id="4126490">1</span>&nbsp;<span class="op" id="4126492">&amp;</span>&nbsp;<span class="ident" id="4126494">mask</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126500">out</span><span class="op" id="4126503">[</span><span class="num" id="4126504">3</span><span class="op" id="4126505">]</span>&nbsp;<span class="op" id="4126507">-=</span>&nbsp;<span class="num" id="4126510">0xffff000</span>&nbsp;<span class="op" id="4126520">&amp;</span>&nbsp;<span class="ident" id="4126522">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126528">out</span><span class="op" id="4126531">[</span><span class="num" id="4126532">4</span><span class="op" id="4126533">]</span>&nbsp;<span class="op" id="4126535">-=</span>&nbsp;<span class="num" id="4126538">0xfffffff</span>&nbsp;<span class="op" id="4126548">&amp;</span>&nbsp;<span class="ident" id="4126550">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126556">out</span><span class="op" id="4126559">[</span><span class="num" id="4126560">5</span><span class="op" id="4126561">]</span>&nbsp;<span class="op" id="4126563">-=</span>&nbsp;<span class="num" id="4126566">0xfffffff</span>&nbsp;<span class="op" id="4126576">&amp;</span>&nbsp;<span class="ident" id="4126578">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126584">out</span><span class="op" id="4126587">[</span><span class="num" id="4126588">6</span><span class="op" id="4126589">]</span>&nbsp;<span class="op" id="4126591">-=</span>&nbsp;<span class="num" id="4126594">0xfffffff</span>&nbsp;<span class="op" id="4126604">&amp;</span>&nbsp;<span class="ident" id="4126606">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4126612">out</span><span class="op" id="4126615">[</span><span class="num" id="4126616">7</span><span class="op" id="4126617">]</span>&nbsp;<span class="op" id="4126619">-=</span>&nbsp;<span class="num" id="4126622">0xfffffff</span>&nbsp;<span class="op" id="4126632">&amp;</span>&nbsp;<span class="ident" id="4126634">mask</span><br>
<span class="lineno">495</span><span class="op" id="4126639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4126642">//&nbsp;Group&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4126670">//</span><br>
<span class="lineno"></span><span class="comment" id="4126673">//&nbsp;These&nbsp;functions&nbsp;deal&nbsp;with&nbsp;group&nbsp;elements.&nbsp;The&nbsp;group&nbsp;is&nbsp;an&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno">500</span><span class="comment" id="4126749">//&nbsp;group&nbsp;with&nbsp;a&nbsp;=&nbsp;-3&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4126809">//&nbsp;p224AddJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b&nbsp;where&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="4126862">func</span>&nbsp;<span class="ident" id="4126867">p224AddJacobian</span><span class="op" id="4126882">(</span><span class="ident" id="4126883">x3</span><span class="op" id="4126885">,</span>&nbsp;<span class="ident" id="4126887">y3</span><span class="op" id="4126889">,</span>&nbsp;<span class="ident" id="4126891">z3</span><span class="op" id="4126893">,</span>&nbsp;<span class="ident" id="4126895">x1</span><span class="op" id="4126897">,</span>&nbsp;<span class="ident" id="4126899">y1</span><span class="op" id="4126901">,</span>&nbsp;<span class="ident" id="4126903">z1</span><span class="op" id="4126905">,</span>&nbsp;<span class="ident" id="4126907">x2</span><span class="op" id="4126909">,</span>&nbsp;<span class="ident" id="4126911">y2</span><span class="op" id="4126913">,</span>&nbsp;<span class="ident" id="4126915">z2</span>&nbsp;<span class="op" id="4126918">*</span><span class="ident" id="4126919">p224FieldElement</span><span class="op" id="4126935">)</span>&nbsp;<span class="op" id="4126937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4126940">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-p224Add-2007-bl</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127034">var</span>&nbsp;<span class="ident" id="4127038">z1z1</span><span class="op" id="4127042">,</span>&nbsp;<span class="ident" id="4127044">z2z2</span><span class="op" id="4127048">,</span>&nbsp;<span class="ident" id="4127050">u1</span><span class="op" id="4127052">,</span>&nbsp;<span class="ident" id="4127054">u2</span><span class="op" id="4127056">,</span>&nbsp;<span class="ident" id="4127058">s1</span><span class="op" id="4127060">,</span>&nbsp;<span class="ident" id="4127062">s2</span><span class="op" id="4127064">,</span>&nbsp;<span class="ident" id="4127066">h</span><span class="op" id="4127067">,</span>&nbsp;<span class="ident" id="4127069">i</span><span class="op" id="4127070">,</span>&nbsp;<span class="ident" id="4127072">j</span><span class="op" id="4127073">,</span>&nbsp;<span class="ident" id="4127075">r</span><span class="op" id="4127076">,</span>&nbsp;<span class="ident" id="4127078">v</span>&nbsp;<span class="ident" id="4127080">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127098">var</span>&nbsp;<span class="ident" id="4127102">c</span>&nbsp;<span class="ident" id="4127104">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127128">z1IsZero</span>&nbsp;<span class="op" id="4127137">:=</span>&nbsp;<span class="ident" id="4127140">p224IsZero</span><span class="op" id="4127150">(</span><span class="ident" id="4127151">z1</span><span class="op" id="4127153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127156">z2IsZero</span>&nbsp;<span class="op" id="4127165">:=</span>&nbsp;<span class="ident" id="4127168">p224IsZero</span><span class="op" id="4127178">(</span><span class="ident" id="4127179">z2</span><span class="op" id="4127181">)</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4127185">//&nbsp;Z1Z1&nbsp;=&nbsp;Z1²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127201">p224Square</span><span class="op" id="4127211">(</span><span class="op" id="4127212">&amp;</span><span class="ident" id="4127213">z1z1</span><span class="op" id="4127217">,</span>&nbsp;<span class="ident" id="4127219">z1</span><span class="op" id="4127221">,</span>&nbsp;<span class="op" id="4127223">&amp;</span><span class="ident" id="4127224">c</span><span class="op" id="4127225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4127228">//&nbsp;Z2Z2&nbsp;=&nbsp;Z2²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127244">p224Square</span><span class="op" id="4127254">(</span><span class="op" id="4127255">&amp;</span><span class="ident" id="4127256">z2z2</span><span class="op" id="4127260">,</span>&nbsp;<span class="ident" id="4127262">z2</span><span class="op" id="4127264">,</span>&nbsp;<span class="op" id="4127266">&amp;</span><span class="ident" id="4127267">c</span><span class="op" id="4127268">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4127271">//&nbsp;U1&nbsp;=&nbsp;X1*Z2Z2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127288">p224Mul</span><span class="op" id="4127295">(</span><span class="op" id="4127296">&amp;</span><span class="ident" id="4127297">u1</span><span class="op" id="4127299">,</span>&nbsp;<span class="ident" id="4127301">x1</span><span class="op" id="4127303">,</span>&nbsp;<span class="op" id="4127305">&amp;</span><span class="ident" id="4127306">z2z2</span><span class="op" id="4127310">,</span>&nbsp;<span class="op" id="4127312">&amp;</span><span class="ident" id="4127313">c</span><span class="op" id="4127314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4127317">//&nbsp;U2&nbsp;=&nbsp;X2*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127334">p224Mul</span><span class="op" id="4127341">(</span><span class="op" id="4127342">&amp;</span><span class="ident" id="4127343">u2</span><span class="op" id="4127345">,</span>&nbsp;<span class="ident" id="4127347">x2</span><span class="op" id="4127349">,</span>&nbsp;<span class="op" id="4127351">&amp;</span><span class="ident" id="4127352">z1z1</span><span class="op" id="4127356">,</span>&nbsp;<span class="op" id="4127358">&amp;</span><span class="ident" id="4127359">c</span><span class="op" id="4127360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4127363">//&nbsp;S1&nbsp;=&nbsp;Y1*Z2*Z2Z2</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127383">p224Mul</span><span class="op" id="4127390">(</span><span class="op" id="4127391">&amp;</span><span class="ident" id="4127392">s1</span><span class="op" id="4127394">,</span>&nbsp;<span class="ident" id="4127396">z2</span><span class="op" id="4127398">,</span>&nbsp;<span class="op" id="4127400">&amp;</span><span class="ident" id="4127401">z2z2</span><span class="op" id="4127405">,</span>&nbsp;<span class="op" id="4127407">&amp;</span><span class="ident" id="4127408">c</span><span class="op" id="4127409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127412">p224Mul</span><span class="op" id="4127419">(</span><span class="op" id="4127420">&amp;</span><span class="ident" id="4127421">s1</span><span class="op" id="4127423">,</span>&nbsp;<span class="ident" id="4127425">y1</span><span class="op" id="4127427">,</span>&nbsp;<span class="op" id="4127429">&amp;</span><span class="ident" id="4127430">s1</span><span class="op" id="4127432">,</span>&nbsp;<span class="op" id="4127434">&amp;</span><span class="ident" id="4127435">c</span><span class="op" id="4127436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4127439">//&nbsp;S2&nbsp;=&nbsp;Y2*Z1*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127459">p224Mul</span><span class="op" id="4127466">(</span><span class="op" id="4127467">&amp;</span><span class="ident" id="4127468">s2</span><span class="op" id="4127470">,</span>&nbsp;<span class="ident" id="4127472">z1</span><span class="op" id="4127474">,</span>&nbsp;<span class="op" id="4127476">&amp;</span><span class="ident" id="4127477">z1z1</span><span class="op" id="4127481">,</span>&nbsp;<span class="op" id="4127483">&amp;</span><span class="ident" id="4127484">c</span><span class="op" id="4127485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127488">p224Mul</span><span class="op" id="4127495">(</span><span class="op" id="4127496">&amp;</span><span class="ident" id="4127497">s2</span><span class="op" id="4127499">,</span>&nbsp;<span class="ident" id="4127501">y2</span><span class="op" id="4127503">,</span>&nbsp;<span class="op" id="4127505">&amp;</span><span class="ident" id="4127506">s2</span><span class="op" id="4127508">,</span>&nbsp;<span class="op" id="4127510">&amp;</span><span class="ident" id="4127511">c</span><span class="op" id="4127512">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4127515">//&nbsp;H&nbsp;=&nbsp;U2-U1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127529">p224Sub</span><span class="op" id="4127536">(</span><span class="op" id="4127537">&amp;</span><span class="ident" id="4127538">h</span><span class="op" id="4127539">,</span>&nbsp;<span class="op" id="4127541">&amp;</span><span class="ident" id="4127542">u2</span><span class="op" id="4127544">,</span>&nbsp;<span class="op" id="4127546">&amp;</span><span class="ident" id="4127547">u1</span><span class="op" id="4127549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127552">p224Reduce</span><span class="op" id="4127562">(</span><span class="op" id="4127563">&amp;</span><span class="ident" id="4127564">h</span><span class="op" id="4127565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127568">xEqual</span>&nbsp;<span class="op" id="4127575">:=</span>&nbsp;<span class="ident" id="4127578">p224IsZero</span><span class="op" id="4127588">(</span><span class="op" id="4127589">&amp;</span><span class="ident" id="4127590">h</span><span class="op" id="4127591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4127594">//&nbsp;I&nbsp;=&nbsp;(2*H)²</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127610">for</span>&nbsp;<span class="ident" id="4127614">j</span>&nbsp;<span class="op" id="4127616">:=</span>&nbsp;<span class="num" id="4127619">0</span><span class="op" id="4127620">;</span>&nbsp;<span class="ident" id="4127622">j</span>&nbsp;<span class="op" id="4127624">&lt;</span>&nbsp;<span class="num" id="4127626">8</span><span class="op" id="4127627">;</span>&nbsp;<span class="ident" id="4127629">j</span><span class="op" id="4127630">++</span>&nbsp;<span class="op" id="4127633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127637">i</span><span class="op" id="4127638">[</span><span class="ident" id="4127639">j</span><span class="op" id="4127640">]</span>&nbsp;<span class="op" id="4127642">=</span>&nbsp;<span class="ident" id="4127644">h</span><span class="op" id="4127645">[</span><span class="ident" id="4127646">j</span><span class="op" id="4127647">]</span>&nbsp;<span class="op" id="4127649">&lt;&lt;</span>&nbsp;<span class="num" id="4127652">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4127655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127658">p224Reduce</span><span class="op" id="4127668">(</span><span class="op" id="4127669">&amp;</span><span class="ident" id="4127670">i</span><span class="op" id="4127671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127674">p224Square</span><span class="op" id="4127684">(</span><span class="op" id="4127685">&amp;</span><span class="ident" id="4127686">i</span><span class="op" id="4127687">,</span>&nbsp;<span class="op" id="4127689">&amp;</span><span class="ident" id="4127690">i</span><span class="op" id="4127691">,</span>&nbsp;<span class="op" id="4127693">&amp;</span><span class="ident" id="4127694">c</span><span class="op" id="4127695">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4127698">//&nbsp;J&nbsp;=&nbsp;H*I</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127710">p224Mul</span><span class="op" id="4127717">(</span><span class="op" id="4127718">&amp;</span><span class="ident" id="4127719">j</span><span class="op" id="4127720">,</span>&nbsp;<span class="op" id="4127722">&amp;</span><span class="ident" id="4127723">h</span><span class="op" id="4127724">,</span>&nbsp;<span class="op" id="4127726">&amp;</span><span class="ident" id="4127727">i</span><span class="op" id="4127728">,</span>&nbsp;<span class="op" id="4127730">&amp;</span><span class="ident" id="4127731">c</span><span class="op" id="4127732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4127735">//&nbsp;r&nbsp;=&nbsp;2*(S2-S1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127753">p224Sub</span><span class="op" id="4127760">(</span><span class="op" id="4127761">&amp;</span><span class="ident" id="4127762">r</span><span class="op" id="4127763">,</span>&nbsp;<span class="op" id="4127765">&amp;</span><span class="ident" id="4127766">s2</span><span class="op" id="4127768">,</span>&nbsp;<span class="op" id="4127770">&amp;</span><span class="ident" id="4127771">s1</span><span class="op" id="4127773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127776">p224Reduce</span><span class="op" id="4127786">(</span><span class="op" id="4127787">&amp;</span><span class="ident" id="4127788">r</span><span class="op" id="4127789">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127792">yEqual</span>&nbsp;<span class="op" id="4127799">:=</span>&nbsp;<span class="ident" id="4127802">p224IsZero</span><span class="op" id="4127812">(</span><span class="op" id="4127813">&amp;</span><span class="ident" id="4127814">r</span><span class="op" id="4127815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127818">if</span>&nbsp;<span class="ident" id="4127821">xEqual</span>&nbsp;<span class="op" id="4127828">==</span>&nbsp;<span class="num" id="4127831">1</span>&nbsp;<span class="op" id="4127833">&amp;&amp;</span>&nbsp;<span class="ident" id="4127836">yEqual</span>&nbsp;<span class="op" id="4127843">==</span>&nbsp;<span class="num" id="4127846">1</span>&nbsp;<span class="op" id="4127848">&amp;&amp;</span>&nbsp;<span class="ident" id="4127851">z1IsZero</span>&nbsp;<span class="op" id="4127860">==</span>&nbsp;<span class="num" id="4127863">0</span>&nbsp;<span class="op" id="4127865">&amp;&amp;</span>&nbsp;<span class="ident" id="4127868">z2IsZero</span>&nbsp;<span class="op" id="4127877">==</span>&nbsp;<span class="num" id="4127880">0</span>&nbsp;<span class="op" id="4127882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127886">p224DoubleJacobian</span><span class="op" id="4127904">(</span><span class="ident" id="4127905">x3</span><span class="op" id="4127907">,</span>&nbsp;<span class="ident" id="4127909">y3</span><span class="op" id="4127911">,</span>&nbsp;<span class="ident" id="4127913">z3</span><span class="op" id="4127915">,</span>&nbsp;<span class="ident" id="4127917">x1</span><span class="op" id="4127919">,</span>&nbsp;<span class="ident" id="4127921">y1</span><span class="op" id="4127923">,</span>&nbsp;<span class="ident" id="4127925">z1</span><span class="op" id="4127927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127931">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4127939">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4127942">for</span>&nbsp;<span class="ident" id="4127946">i</span>&nbsp;<span class="op" id="4127948">:=</span>&nbsp;<span class="num" id="4127951">0</span><span class="op" id="4127952">;</span>&nbsp;<span class="ident" id="4127954">i</span>&nbsp;<span class="op" id="4127956">&lt;</span>&nbsp;<span class="num" id="4127958">8</span><span class="op" id="4127959">;</span>&nbsp;<span class="ident" id="4127961">i</span><span class="op" id="4127962">++</span>&nbsp;<span class="op" id="4127965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127969">r</span><span class="op" id="4127970">[</span><span class="ident" id="4127971">i</span><span class="op" id="4127972">]</span>&nbsp;<span class="op" id="4127974">&lt;&lt;=</span>&nbsp;<span class="num" id="4127978">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4127981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4127984">p224Reduce</span><span class="op" id="4127994">(</span><span class="op" id="4127995">&amp;</span><span class="ident" id="4127996">r</span><span class="op" id="4127997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4128000">//&nbsp;V&nbsp;=&nbsp;U1*I</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128013">p224Mul</span><span class="op" id="4128020">(</span><span class="op" id="4128021">&amp;</span><span class="ident" id="4128022">v</span><span class="op" id="4128023">,</span>&nbsp;<span class="op" id="4128025">&amp;</span><span class="ident" id="4128026">u1</span><span class="op" id="4128028">,</span>&nbsp;<span class="op" id="4128030">&amp;</span><span class="ident" id="4128031">i</span><span class="op" id="4128032">,</span>&nbsp;<span class="op" id="4128034">&amp;</span><span class="ident" id="4128035">c</span><span class="op" id="4128036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4128039">//&nbsp;Z3&nbsp;=&nbsp;((Z1+Z2)²-Z1Z1-Z2Z2)*H</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128072">p224Add</span><span class="op" id="4128079">(</span><span class="op" id="4128080">&amp;</span><span class="ident" id="4128081">z1z1</span><span class="op" id="4128085">,</span>&nbsp;<span class="op" id="4128087">&amp;</span><span class="ident" id="4128088">z1z1</span><span class="op" id="4128092">,</span>&nbsp;<span class="op" id="4128094">&amp;</span><span class="ident" id="4128095">z2z2</span><span class="op" id="4128099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128102">p224Add</span><span class="op" id="4128109">(</span><span class="op" id="4128110">&amp;</span><span class="ident" id="4128111">z2z2</span><span class="op" id="4128115">,</span>&nbsp;<span class="ident" id="4128117">z1</span><span class="op" id="4128119">,</span>&nbsp;<span class="ident" id="4128121">z2</span><span class="op" id="4128123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128126">p224Reduce</span><span class="op" id="4128136">(</span><span class="op" id="4128137">&amp;</span><span class="ident" id="4128138">z2z2</span><span class="op" id="4128142">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128145">p224Square</span><span class="op" id="4128155">(</span><span class="op" id="4128156">&amp;</span><span class="ident" id="4128157">z2z2</span><span class="op" id="4128161">,</span>&nbsp;<span class="op" id="4128163">&amp;</span><span class="ident" id="4128164">z2z2</span><span class="op" id="4128168">,</span>&nbsp;<span class="op" id="4128170">&amp;</span><span class="ident" id="4128171">c</span><span class="op" id="4128172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128175">p224Sub</span><span class="op" id="4128182">(</span><span class="ident" id="4128183">z3</span><span class="op" id="4128185">,</span>&nbsp;<span class="op" id="4128187">&amp;</span><span class="ident" id="4128188">z2z2</span><span class="op" id="4128192">,</span>&nbsp;<span class="op" id="4128194">&amp;</span><span class="ident" id="4128195">z1z1</span><span class="op" id="4128199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128202">p224Reduce</span><span class="op" id="4128212">(</span><span class="ident" id="4128213">z3</span><span class="op" id="4128215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128218">p224Mul</span><span class="op" id="4128225">(</span><span class="ident" id="4128226">z3</span><span class="op" id="4128228">,</span>&nbsp;<span class="ident" id="4128230">z3</span><span class="op" id="4128232">,</span>&nbsp;<span class="op" id="4128234">&amp;</span><span class="ident" id="4128235">h</span><span class="op" id="4128236">,</span>&nbsp;<span class="op" id="4128238">&amp;</span><span class="ident" id="4128239">c</span><span class="op" id="4128240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4128243">//&nbsp;X3&nbsp;=&nbsp;r²-J-2*V</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4128262">for</span>&nbsp;<span class="ident" id="4128266">i</span>&nbsp;<span class="op" id="4128268">:=</span>&nbsp;<span class="num" id="4128271">0</span><span class="op" id="4128272">;</span>&nbsp;<span class="ident" id="4128274">i</span>&nbsp;<span class="op" id="4128276">&lt;</span>&nbsp;<span class="num" id="4128278">8</span><span class="op" id="4128279">;</span>&nbsp;<span class="ident" id="4128281">i</span><span class="op" id="4128282">++</span>&nbsp;<span class="op" id="4128285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128289">z1z1</span><span class="op" id="4128293">[</span><span class="ident" id="4128294">i</span><span class="op" id="4128295">]</span>&nbsp;<span class="op" id="4128297">=</span>&nbsp;<span class="ident" id="4128299">v</span><span class="op" id="4128300">[</span><span class="ident" id="4128301">i</span><span class="op" id="4128302">]</span>&nbsp;<span class="op" id="4128304">&lt;&lt;</span>&nbsp;<span class="num" id="4128307">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4128310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128313">p224Add</span><span class="op" id="4128320">(</span><span class="op" id="4128321">&amp;</span><span class="ident" id="4128322">z1z1</span><span class="op" id="4128326">,</span>&nbsp;<span class="op" id="4128328">&amp;</span><span class="ident" id="4128329">j</span><span class="op" id="4128330">,</span>&nbsp;<span class="op" id="4128332">&amp;</span><span class="ident" id="4128333">z1z1</span><span class="op" id="4128337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128340">p224Reduce</span><span class="op" id="4128350">(</span><span class="op" id="4128351">&amp;</span><span class="ident" id="4128352">z1z1</span><span class="op" id="4128356">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128359">p224Square</span><span class="op" id="4128369">(</span><span class="ident" id="4128370">x3</span><span class="op" id="4128372">,</span>&nbsp;<span class="op" id="4128374">&amp;</span><span class="ident" id="4128375">r</span><span class="op" id="4128376">,</span>&nbsp;<span class="op" id="4128378">&amp;</span><span class="ident" id="4128379">c</span><span class="op" id="4128380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128383">p224Sub</span><span class="op" id="4128390">(</span><span class="ident" id="4128391">x3</span><span class="op" id="4128393">,</span>&nbsp;<span class="ident" id="4128395">x3</span><span class="op" id="4128397">,</span>&nbsp;<span class="op" id="4128399">&amp;</span><span class="ident" id="4128400">z1z1</span><span class="op" id="4128404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128407">p224Reduce</span><span class="op" id="4128417">(</span><span class="ident" id="4128418">x3</span><span class="op" id="4128420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4128423">//&nbsp;Y3&nbsp;=&nbsp;r*(V-X3)-2*S1*J</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4128448">for</span>&nbsp;<span class="ident" id="4128452">i</span>&nbsp;<span class="op" id="4128454">:=</span>&nbsp;<span class="num" id="4128457">0</span><span class="op" id="4128458">;</span>&nbsp;<span class="ident" id="4128460">i</span>&nbsp;<span class="op" id="4128462">&lt;</span>&nbsp;<span class="num" id="4128464">8</span><span class="op" id="4128465">;</span>&nbsp;<span class="ident" id="4128467">i</span><span class="op" id="4128468">++</span>&nbsp;<span class="op" id="4128471">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128475">s1</span><span class="op" id="4128477">[</span><span class="ident" id="4128478">i</span><span class="op" id="4128479">]</span>&nbsp;<span class="op" id="4128481">&lt;&lt;=</span>&nbsp;<span class="num" id="4128485">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4128488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128491">p224Mul</span><span class="op" id="4128498">(</span><span class="op" id="4128499">&amp;</span><span class="ident" id="4128500">s1</span><span class="op" id="4128502">,</span>&nbsp;<span class="op" id="4128504">&amp;</span><span class="ident" id="4128505">s1</span><span class="op" id="4128507">,</span>&nbsp;<span class="op" id="4128509">&amp;</span><span class="ident" id="4128510">j</span><span class="op" id="4128511">,</span>&nbsp;<span class="op" id="4128513">&amp;</span><span class="ident" id="4128514">c</span><span class="op" id="4128515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128518">p224Sub</span><span class="op" id="4128525">(</span><span class="op" id="4128526">&amp;</span><span class="ident" id="4128527">z1z1</span><span class="op" id="4128531">,</span>&nbsp;<span class="op" id="4128533">&amp;</span><span class="ident" id="4128534">v</span><span class="op" id="4128535">,</span>&nbsp;<span class="ident" id="4128537">x3</span><span class="op" id="4128539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128542">p224Reduce</span><span class="op" id="4128552">(</span><span class="op" id="4128553">&amp;</span><span class="ident" id="4128554">z1z1</span><span class="op" id="4128558">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128561">p224Mul</span><span class="op" id="4128568">(</span><span class="op" id="4128569">&amp;</span><span class="ident" id="4128570">z1z1</span><span class="op" id="4128574">,</span>&nbsp;<span class="op" id="4128576">&amp;</span><span class="ident" id="4128577">z1z1</span><span class="op" id="4128581">,</span>&nbsp;<span class="op" id="4128583">&amp;</span><span class="ident" id="4128584">r</span><span class="op" id="4128585">,</span>&nbsp;<span class="op" id="4128587">&amp;</span><span class="ident" id="4128588">c</span><span class="op" id="4128589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128592">p224Sub</span><span class="op" id="4128599">(</span><span class="ident" id="4128600">y3</span><span class="op" id="4128602">,</span>&nbsp;<span class="op" id="4128604">&amp;</span><span class="ident" id="4128605">z1z1</span><span class="op" id="4128609">,</span>&nbsp;<span class="op" id="4128611">&amp;</span><span class="ident" id="4128612">s1</span><span class="op" id="4128614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128617">p224Reduce</span><span class="op" id="4128627">(</span><span class="ident" id="4128628">y3</span><span class="op" id="4128630">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128634">p224CopyConditional</span><span class="op" id="4128653">(</span><span class="ident" id="4128654">x3</span><span class="op" id="4128656">,</span>&nbsp;<span class="ident" id="4128658">x2</span><span class="op" id="4128660">,</span>&nbsp;<span class="ident" id="4128662">z1IsZero</span><span class="op" id="4128670">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128673">p224CopyConditional</span><span class="op" id="4128692">(</span><span class="ident" id="4128693">x3</span><span class="op" id="4128695">,</span>&nbsp;<span class="ident" id="4128697">x1</span><span class="op" id="4128699">,</span>&nbsp;<span class="ident" id="4128701">z2IsZero</span><span class="op" id="4128709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128712">p224CopyConditional</span><span class="op" id="4128731">(</span><span class="ident" id="4128732">y3</span><span class="op" id="4128734">,</span>&nbsp;<span class="ident" id="4128736">y2</span><span class="op" id="4128738">,</span>&nbsp;<span class="ident" id="4128740">z1IsZero</span><span class="op" id="4128748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128751">p224CopyConditional</span><span class="op" id="4128770">(</span><span class="ident" id="4128771">y3</span><span class="op" id="4128773">,</span>&nbsp;<span class="ident" id="4128775">y1</span><span class="op" id="4128777">,</span>&nbsp;<span class="ident" id="4128779">z2IsZero</span><span class="op" id="4128787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128790">p224CopyConditional</span><span class="op" id="4128809">(</span><span class="ident" id="4128810">z3</span><span class="op" id="4128812">,</span>&nbsp;<span class="ident" id="4128814">z2</span><span class="op" id="4128816">,</span>&nbsp;<span class="ident" id="4128818">z1IsZero</span><span class="op" id="4128826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4128829">p224CopyConditional</span><span class="op" id="4128848">(</span><span class="ident" id="4128849">z3</span><span class="op" id="4128851">,</span>&nbsp;<span class="ident" id="4128853">z1</span><span class="op" id="4128855">,</span>&nbsp;<span class="ident" id="4128857">z2IsZero</span><span class="op" id="4128865">)</span><br>
<span class="lineno">585</span><span class="op" id="4128867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4128870">//&nbsp;p224DoubleJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+a.</span><br>
<span class="lineno"></span><span class="keyword" id="4128913">func</span>&nbsp;<span class="ident" id="4128918">p224DoubleJacobian</span><span class="op" id="4128936">(</span><span class="ident" id="4128937">x3</span><span class="op" id="4128939">,</span>&nbsp;<span class="ident" id="4128941">y3</span><span class="op" id="4128943">,</span>&nbsp;<span class="ident" id="4128945">z3</span><span class="op" id="4128947">,</span>&nbsp;<span class="ident" id="4128949">x1</span><span class="op" id="4128951">,</span>&nbsp;<span class="ident" id="4128953">y1</span><span class="op" id="4128955">,</span>&nbsp;<span class="ident" id="4128957">z1</span>&nbsp;<span class="op" id="4128960">*</span><span class="ident" id="4128961">p224FieldElement</span><span class="op" id="4128977">)</span>&nbsp;<span class="op" id="4128979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4128982">var</span>&nbsp;<span class="ident" id="4128986">delta</span><span class="op" id="4128991">,</span>&nbsp;<span class="ident" id="4128993">gamma</span><span class="op" id="4128998">,</span>&nbsp;<span class="ident" id="4129000">beta</span><span class="op" id="4129004">,</span>&nbsp;<span class="ident" id="4129006">alpha</span><span class="op" id="4129011">,</span>&nbsp;<span class="ident" id="4129013">t</span>&nbsp;<span class="ident" id="4129015">p224FieldElement</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4129033">var</span>&nbsp;<span class="ident" id="4129037">c</span>&nbsp;<span class="ident" id="4129039">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129063">p224Square</span><span class="op" id="4129073">(</span><span class="op" id="4129074">&amp;</span><span class="ident" id="4129075">delta</span><span class="op" id="4129080">,</span>&nbsp;<span class="ident" id="4129082">z1</span><span class="op" id="4129084">,</span>&nbsp;<span class="op" id="4129086">&amp;</span><span class="ident" id="4129087">c</span><span class="op" id="4129088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129091">p224Square</span><span class="op" id="4129101">(</span><span class="op" id="4129102">&amp;</span><span class="ident" id="4129103">gamma</span><span class="op" id="4129108">,</span>&nbsp;<span class="ident" id="4129110">y1</span><span class="op" id="4129112">,</span>&nbsp;<span class="op" id="4129114">&amp;</span><span class="ident" id="4129115">c</span><span class="op" id="4129116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129119">p224Mul</span><span class="op" id="4129126">(</span><span class="op" id="4129127">&amp;</span><span class="ident" id="4129128">beta</span><span class="op" id="4129132">,</span>&nbsp;<span class="ident" id="4129134">x1</span><span class="op" id="4129136">,</span>&nbsp;<span class="op" id="4129138">&amp;</span><span class="ident" id="4129139">gamma</span><span class="op" id="4129144">,</span>&nbsp;<span class="op" id="4129146">&amp;</span><span class="ident" id="4129147">c</span><span class="op" id="4129148">)</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4129152">//&nbsp;alpha&nbsp;=&nbsp;3*(X1-delta)*(X1+delta)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129188">p224Add</span><span class="op" id="4129195">(</span><span class="op" id="4129196">&amp;</span><span class="ident" id="4129197">t</span><span class="op" id="4129198">,</span>&nbsp;<span class="ident" id="4129200">x1</span><span class="op" id="4129202">,</span>&nbsp;<span class="op" id="4129204">&amp;</span><span class="ident" id="4129205">delta</span><span class="op" id="4129210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4129213">for</span>&nbsp;<span class="ident" id="4129217">i</span>&nbsp;<span class="op" id="4129219">:=</span>&nbsp;<span class="num" id="4129222">0</span><span class="op" id="4129223">;</span>&nbsp;<span class="ident" id="4129225">i</span>&nbsp;<span class="op" id="4129227">&lt;</span>&nbsp;<span class="num" id="4129229">8</span><span class="op" id="4129230">;</span>&nbsp;<span class="ident" id="4129232">i</span><span class="op" id="4129233">++</span>&nbsp;<span class="op" id="4129236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129240">t</span><span class="op" id="4129241">[</span><span class="ident" id="4129242">i</span><span class="op" id="4129243">]</span>&nbsp;<span class="op" id="4129245">+=</span>&nbsp;<span class="ident" id="4129248">t</span><span class="op" id="4129249">[</span><span class="ident" id="4129250">i</span><span class="op" id="4129251">]</span>&nbsp;<span class="op" id="4129253">&lt;&lt;</span>&nbsp;<span class="num" id="4129256">1</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4129259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129262">p224Reduce</span><span class="op" id="4129272">(</span><span class="op" id="4129273">&amp;</span><span class="ident" id="4129274">t</span><span class="op" id="4129275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129278">p224Sub</span><span class="op" id="4129285">(</span><span class="op" id="4129286">&amp;</span><span class="ident" id="4129287">alpha</span><span class="op" id="4129292">,</span>&nbsp;<span class="ident" id="4129294">x1</span><span class="op" id="4129296">,</span>&nbsp;<span class="op" id="4129298">&amp;</span><span class="ident" id="4129299">delta</span><span class="op" id="4129304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129307">p224Reduce</span><span class="op" id="4129317">(</span><span class="op" id="4129318">&amp;</span><span class="ident" id="4129319">alpha</span><span class="op" id="4129324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129327">p224Mul</span><span class="op" id="4129334">(</span><span class="op" id="4129335">&amp;</span><span class="ident" id="4129336">alpha</span><span class="op" id="4129341">,</span>&nbsp;<span class="op" id="4129343">&amp;</span><span class="ident" id="4129344">alpha</span><span class="op" id="4129349">,</span>&nbsp;<span class="op" id="4129351">&amp;</span><span class="ident" id="4129352">t</span><span class="op" id="4129353">,</span>&nbsp;<span class="op" id="4129355">&amp;</span><span class="ident" id="4129356">c</span><span class="op" id="4129357">)</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4129361">//&nbsp;Z3&nbsp;=&nbsp;(Y1+Z1)²-gamma-delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129392">p224Add</span><span class="op" id="4129399">(</span><span class="ident" id="4129400">z3</span><span class="op" id="4129402">,</span>&nbsp;<span class="ident" id="4129404">y1</span><span class="op" id="4129406">,</span>&nbsp;<span class="ident" id="4129408">z1</span><span class="op" id="4129410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129413">p224Reduce</span><span class="op" id="4129423">(</span><span class="ident" id="4129424">z3</span><span class="op" id="4129426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129429">p224Square</span><span class="op" id="4129439">(</span><span class="ident" id="4129440">z3</span><span class="op" id="4129442">,</span>&nbsp;<span class="ident" id="4129444">z3</span><span class="op" id="4129446">,</span>&nbsp;<span class="op" id="4129448">&amp;</span><span class="ident" id="4129449">c</span><span class="op" id="4129450">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129453">p224Sub</span><span class="op" id="4129460">(</span><span class="ident" id="4129461">z3</span><span class="op" id="4129463">,</span>&nbsp;<span class="ident" id="4129465">z3</span><span class="op" id="4129467">,</span>&nbsp;<span class="op" id="4129469">&amp;</span><span class="ident" id="4129470">gamma</span><span class="op" id="4129475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129478">p224Reduce</span><span class="op" id="4129488">(</span><span class="ident" id="4129489">z3</span><span class="op" id="4129491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129494">p224Sub</span><span class="op" id="4129501">(</span><span class="ident" id="4129502">z3</span><span class="op" id="4129504">,</span>&nbsp;<span class="ident" id="4129506">z3</span><span class="op" id="4129508">,</span>&nbsp;<span class="op" id="4129510">&amp;</span><span class="ident" id="4129511">delta</span><span class="op" id="4129516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129519">p224Reduce</span><span class="op" id="4129529">(</span><span class="ident" id="4129530">z3</span><span class="op" id="4129532">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4129536">//&nbsp;X3&nbsp;=&nbsp;alpha²-8*beta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4129560">for</span>&nbsp;<span class="ident" id="4129564">i</span>&nbsp;<span class="op" id="4129566">:=</span>&nbsp;<span class="num" id="4129569">0</span><span class="op" id="4129570">;</span>&nbsp;<span class="ident" id="4129572">i</span>&nbsp;<span class="op" id="4129574">&lt;</span>&nbsp;<span class="num" id="4129576">8</span><span class="op" id="4129577">;</span>&nbsp;<span class="ident" id="4129579">i</span><span class="op" id="4129580">++</span>&nbsp;<span class="op" id="4129583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129587">delta</span><span class="op" id="4129592">[</span><span class="ident" id="4129593">i</span><span class="op" id="4129594">]</span>&nbsp;<span class="op" id="4129596">=</span>&nbsp;<span class="ident" id="4129598">beta</span><span class="op" id="4129602">[</span><span class="ident" id="4129603">i</span><span class="op" id="4129604">]</span>&nbsp;<span class="op" id="4129606">&lt;&lt;</span>&nbsp;<span class="num" id="4129609">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4129612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129615">p224Reduce</span><span class="op" id="4129625">(</span><span class="op" id="4129626">&amp;</span><span class="ident" id="4129627">delta</span><span class="op" id="4129632">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129635">p224Square</span><span class="op" id="4129645">(</span><span class="ident" id="4129646">x3</span><span class="op" id="4129648">,</span>&nbsp;<span class="op" id="4129650">&amp;</span><span class="ident" id="4129651">alpha</span><span class="op" id="4129656">,</span>&nbsp;<span class="op" id="4129658">&amp;</span><span class="ident" id="4129659">c</span><span class="op" id="4129660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129663">p224Sub</span><span class="op" id="4129670">(</span><span class="ident" id="4129671">x3</span><span class="op" id="4129673">,</span>&nbsp;<span class="ident" id="4129675">x3</span><span class="op" id="4129677">,</span>&nbsp;<span class="op" id="4129679">&amp;</span><span class="ident" id="4129680">delta</span><span class="op" id="4129685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129688">p224Reduce</span><span class="op" id="4129698">(</span><span class="ident" id="4129699">x3</span><span class="op" id="4129701">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4129705">//&nbsp;Y3&nbsp;=&nbsp;alpha*(4*beta-X3)-8*gamma²</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4129742">for</span>&nbsp;<span class="ident" id="4129746">i</span>&nbsp;<span class="op" id="4129748">:=</span>&nbsp;<span class="num" id="4129751">0</span><span class="op" id="4129752">;</span>&nbsp;<span class="ident" id="4129754">i</span>&nbsp;<span class="op" id="4129756">&lt;</span>&nbsp;<span class="num" id="4129758">8</span><span class="op" id="4129759">;</span>&nbsp;<span class="ident" id="4129761">i</span><span class="op" id="4129762">++</span>&nbsp;<span class="op" id="4129765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129769">beta</span><span class="op" id="4129773">[</span><span class="ident" id="4129774">i</span><span class="op" id="4129775">]</span>&nbsp;<span class="op" id="4129777">&lt;&lt;=</span>&nbsp;<span class="num" id="4129781">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4129784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129787">p224Sub</span><span class="op" id="4129794">(</span><span class="op" id="4129795">&amp;</span><span class="ident" id="4129796">beta</span><span class="op" id="4129800">,</span>&nbsp;<span class="op" id="4129802">&amp;</span><span class="ident" id="4129803">beta</span><span class="op" id="4129807">,</span>&nbsp;<span class="ident" id="4129809">x3</span><span class="op" id="4129811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129814">p224Reduce</span><span class="op" id="4129824">(</span><span class="op" id="4129825">&amp;</span><span class="ident" id="4129826">beta</span><span class="op" id="4129830">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129833">p224Square</span><span class="op" id="4129843">(</span><span class="op" id="4129844">&amp;</span><span class="ident" id="4129845">gamma</span><span class="op" id="4129850">,</span>&nbsp;<span class="op" id="4129852">&amp;</span><span class="ident" id="4129853">gamma</span><span class="op" id="4129858">,</span>&nbsp;<span class="op" id="4129860">&amp;</span><span class="ident" id="4129861">c</span><span class="op" id="4129862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4129865">for</span>&nbsp;<span class="ident" id="4129869">i</span>&nbsp;<span class="op" id="4129871">:=</span>&nbsp;<span class="num" id="4129874">0</span><span class="op" id="4129875">;</span>&nbsp;<span class="ident" id="4129877">i</span>&nbsp;<span class="op" id="4129879">&lt;</span>&nbsp;<span class="num" id="4129881">8</span><span class="op" id="4129882">;</span>&nbsp;<span class="ident" id="4129884">i</span><span class="op" id="4129885">++</span>&nbsp;<span class="op" id="4129888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129892">gamma</span><span class="op" id="4129897">[</span><span class="ident" id="4129898">i</span><span class="op" id="4129899">]</span>&nbsp;<span class="op" id="4129901">&lt;&lt;=</span>&nbsp;<span class="num" id="4129905">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4129908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129911">p224Reduce</span><span class="op" id="4129921">(</span><span class="op" id="4129922">&amp;</span><span class="ident" id="4129923">gamma</span><span class="op" id="4129928">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129931">p224Mul</span><span class="op" id="4129938">(</span><span class="ident" id="4129939">y3</span><span class="op" id="4129941">,</span>&nbsp;<span class="op" id="4129943">&amp;</span><span class="ident" id="4129944">alpha</span><span class="op" id="4129949">,</span>&nbsp;<span class="op" id="4129951">&amp;</span><span class="ident" id="4129952">beta</span><span class="op" id="4129956">,</span>&nbsp;<span class="op" id="4129958">&amp;</span><span class="ident" id="4129959">c</span><span class="op" id="4129960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129963">p224Sub</span><span class="op" id="4129970">(</span><span class="ident" id="4129971">y3</span><span class="op" id="4129973">,</span>&nbsp;<span class="ident" id="4129975">y3</span><span class="op" id="4129977">,</span>&nbsp;<span class="op" id="4129979">&amp;</span><span class="ident" id="4129980">gamma</span><span class="op" id="4129985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129988">p224Reduce</span><span class="op" id="4129998">(</span><span class="ident" id="4129999">y3</span><span class="op" id="4130001">)</span><br>
<span class="lineno"></span><span class="op" id="4130003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span><span class="comment" id="4130006">//&nbsp;p224CopyConditional&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in&nbsp;iff&nbsp;the&nbsp;least-significant-bit&nbsp;of&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="4130086">//&nbsp;is&nbsp;true,&nbsp;and&nbsp;it&nbsp;runs&nbsp;in&nbsp;constant&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4130128">func</span>&nbsp;<span class="ident" id="4130133">p224CopyConditional</span><span class="op" id="4130152">(</span><span class="ident" id="4130153">out</span><span class="op" id="4130156">,</span>&nbsp;<span class="ident" id="4130158">in</span>&nbsp;<span class="op" id="4130161">*</span><span class="ident" id="4130162">p224FieldElement</span><span class="op" id="4130178">,</span>&nbsp;<span class="ident" id="4130180">control</span>&nbsp;<span class="builtintype" id="4130188">uint32</span><span class="op" id="4130194">)</span>&nbsp;<span class="op" id="4130196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4130199">control</span>&nbsp;<span class="op" id="4130207">&lt;&lt;=</span>&nbsp;<span class="num" id="4130211">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4130215">control</span>&nbsp;<span class="op" id="4130223">=</span>&nbsp;<span class="builtintype" id="4130225">uint32</span><span class="op" id="4130231">(</span><span class="builtintype" id="4130232">int32</span><span class="op" id="4130237">(</span><span class="ident" id="4130238">control</span><span class="op" id="4130245">)</span>&nbsp;<span class="op" id="4130247">&gt;&gt;</span>&nbsp;<span class="num" id="4130250">31</span><span class="op" id="4130252">)</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4130256">for</span>&nbsp;<span class="ident" id="4130260">i</span>&nbsp;<span class="op" id="4130262">:=</span>&nbsp;<span class="num" id="4130265">0</span><span class="op" id="4130266">;</span>&nbsp;<span class="ident" id="4130268">i</span>&nbsp;<span class="op" id="4130270">&lt;</span>&nbsp;<span class="num" id="4130272">8</span><span class="op" id="4130273">;</span>&nbsp;<span class="ident" id="4130275">i</span><span class="op" id="4130276">++</span>&nbsp;<span class="op" id="4130279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4130283">out</span><span class="op" id="4130286">[</span><span class="ident" id="4130287">i</span><span class="op" id="4130288">]</span>&nbsp;<span class="op" id="4130290">^=</span>&nbsp;<span class="op" id="4130293">(</span><span class="ident" id="4130294">out</span><span class="op" id="4130297">[</span><span class="ident" id="4130298">i</span><span class="op" id="4130299">]</span>&nbsp;<span class="op" id="4130301">^</span>&nbsp;<span class="ident" id="4130303">in</span><span class="op" id="4130305">[</span><span class="ident" id="4130306">i</span><span class="op" id="4130307">]</span><span class="op" id="4130308">)</span>&nbsp;<span class="op" id="4130310">&amp;</span>&nbsp;<span class="ident" id="4130312">control</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4130321">}</span><br>
<span class="lineno"></span><span class="op" id="4130323">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span><span class="keyword" id="4130326">func</span>&nbsp;<span class="ident" id="4130331">p224ScalarMult</span><span class="op" id="4130345">(</span><span class="ident" id="4130346">outX</span><span class="op" id="4130350">,</span>&nbsp;<span class="ident" id="4130352">outY</span><span class="op" id="4130356">,</span>&nbsp;<span class="ident" id="4130358">outZ</span><span class="op" id="4130362">,</span>&nbsp;<span class="ident" id="4130364">inX</span><span class="op" id="4130367">,</span>&nbsp;<span class="ident" id="4130369">inY</span><span class="op" id="4130372">,</span>&nbsp;<span class="ident" id="4130374">inZ</span>&nbsp;<span class="op" id="4130378">*</span><span class="ident" id="4130379">p224FieldElement</span><span class="op" id="4130395">,</span>&nbsp;<span class="ident" id="4130397">scalar</span>&nbsp;<span class="op" id="4130404">[</span><span class="op" id="4130405">]</span><span class="builtintype" id="4130406">byte</span><span class="op" id="4130410">)</span>&nbsp;<span class="op" id="4130412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4130415">var</span>&nbsp;<span class="ident" id="4130419">xx</span><span class="op" id="4130421">,</span>&nbsp;<span class="ident" id="4130423">yy</span><span class="op" id="4130425">,</span>&nbsp;<span class="ident" id="4130427">zz</span>&nbsp;<span class="ident" id="4130430">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4130448">for</span>&nbsp;<span class="ident" id="4130452">i</span>&nbsp;<span class="op" id="4130454">:=</span>&nbsp;<span class="num" id="4130457">0</span><span class="op" id="4130458">;</span>&nbsp;<span class="ident" id="4130460">i</span>&nbsp;<span class="op" id="4130462">&lt;</span>&nbsp;<span class="num" id="4130464">8</span><span class="op" id="4130465">;</span>&nbsp;<span class="ident" id="4130467">i</span><span class="op" id="4130468">++</span>&nbsp;<span class="op" id="4130471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4130475">outX</span><span class="op" id="4130479">[</span><span class="ident" id="4130480">i</span><span class="op" id="4130481">]</span>&nbsp;<span class="op" id="4130483">=</span>&nbsp;<span class="num" id="4130485">0</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4130489">outY</span><span class="op" id="4130493">[</span><span class="ident" id="4130494">i</span><span class="op" id="4130495">]</span>&nbsp;<span class="op" id="4130497">=</span>&nbsp;<span class="num" id="4130499">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4130503">outZ</span><span class="op" id="4130507">[</span><span class="ident" id="4130508">i</span><span class="op" id="4130509">]</span>&nbsp;<span class="op" id="4130511">=</span>&nbsp;<span class="num" id="4130513">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4130516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4130520">for</span>&nbsp;<span class="ident" id="4130524">_</span><span class="op" id="4130525">,</span>&nbsp;<span class="builtintype" id="4130527">byte</span>&nbsp;<span class="op" id="4130532">:=</span>&nbsp;<span class="keyword" id="4130535">range</span>&nbsp;<span class="ident" id="4130541">scalar</span>&nbsp;<span class="op" id="4130548">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4130552">for</span>&nbsp;<span class="ident" id="4130556">bitNum</span>&nbsp;<span class="op" id="4130563">:=</span>&nbsp;<span class="builtintype" id="4130566">uint</span><span class="op" id="4130570">(</span><span class="num" id="4130571">0</span><span class="op" id="4130572">)</span><span class="op" id="4130573">;</span>&nbsp;<span class="ident" id="4130575">bitNum</span>&nbsp;<span class="op" id="4130582">&lt;</span>&nbsp;<span class="num" id="4130584">8</span><span class="op" id="4130585">;</span>&nbsp;<span class="ident" id="4130587">bitNum</span><span class="op" id="4130593">++</span>&nbsp;<span class="op" id="4130596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4130601">p224DoubleJacobian</span><span class="op" id="4130619">(</span><span class="ident" id="4130620">outX</span><span class="op" id="4130624">,</span>&nbsp;<span class="ident" id="4130626">outY</span><span class="op" id="4130630">,</span>&nbsp;<span class="ident" id="4130632">outZ</span><span class="op" id="4130636">,</span>&nbsp;<span class="ident" id="4130638">outX</span><span class="op" id="4130642">,</span>&nbsp;<span class="ident" id="4130644">outY</span><span class="op" id="4130648">,</span>&nbsp;<span class="ident" id="4130650">outZ</span><span class="op" id="4130654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4130659">bit</span>&nbsp;<span class="op" id="4130663">:=</span>&nbsp;<span class="builtintype" id="4130666">uint32</span><span class="op" id="4130672">(</span><span class="op" id="4130673">(</span><span class="builtintype" id="4130674">byte</span>&nbsp;<span class="op" id="4130679">&gt;&gt;</span>&nbsp;<span class="op" id="4130682">(</span><span class="num" id="4130683">7</span>&nbsp;<span class="op" id="4130685">-</span>&nbsp;<span class="ident" id="4130687">bitNum</span><span class="op" id="4130693">)</span><span class="op" id="4130694">)</span>&nbsp;<span class="op" id="4130696">&amp;</span>&nbsp;<span class="num" id="4130698">1</span><span class="op" id="4130699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4130704">p224AddJacobian</span><span class="op" id="4130719">(</span><span class="op" id="4130720">&amp;</span><span class="ident" id="4130721">xx</span><span class="op" id="4130723">,</span>&nbsp;<span class="op" id="4130725">&amp;</span><span class="ident" id="4130726">yy</span><span class="op" id="4130728">,</span>&nbsp;<span class="op" id="4130730">&amp;</span><span class="ident" id="4130731">zz</span><span class="op" id="4130733">,</span>&nbsp;<span class="ident" id="4130735">inX</span><span class="op" id="4130738">,</span>&nbsp;<span class="ident" id="4130740">inY</span><span class="op" id="4130743">,</span>&nbsp;<span class="ident" id="4130745">inZ</span><span class="op" id="4130748">,</span>&nbsp;<span class="ident" id="4130750">outX</span><span class="op" id="4130754">,</span>&nbsp;<span class="ident" id="4130756">outY</span><span class="op" id="4130760">,</span>&nbsp;<span class="ident" id="4130762">outZ</span><span class="op" id="4130766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4130771">p224CopyConditional</span><span class="op" id="4130790">(</span><span class="ident" id="4130791">outX</span><span class="op" id="4130795">,</span>&nbsp;<span class="op" id="4130797">&amp;</span><span class="ident" id="4130798">xx</span><span class="op" id="4130800">,</span>&nbsp;<span class="ident" id="4130802">bit</span><span class="op" id="4130805">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4130810">p224CopyConditional</span><span class="op" id="4130829">(</span><span class="ident" id="4130830">outY</span><span class="op" id="4130834">,</span>&nbsp;<span class="op" id="4130836">&amp;</span><span class="ident" id="4130837">yy</span><span class="op" id="4130839">,</span>&nbsp;<span class="ident" id="4130841">bit</span><span class="op" id="4130844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4130849">p224CopyConditional</span><span class="op" id="4130868">(</span><span class="ident" id="4130869">outZ</span><span class="op" id="4130873">,</span>&nbsp;<span class="op" id="4130875">&amp;</span><span class="ident" id="4130876">zz</span><span class="op" id="4130878">,</span>&nbsp;<span class="ident" id="4130880">bit</span><span class="op" id="4130883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4130887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4130890">}</span><br>
<span class="lineno"></span><span class="op" id="4130892">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="4130895">//&nbsp;p224ToAffine&nbsp;converts&nbsp;from&nbsp;Jacobian&nbsp;to&nbsp;affine&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4130950">func</span>&nbsp;<span class="ident" id="4130955">p224ToAffine</span><span class="op" id="4130967">(</span><span class="ident" id="4130968">x</span><span class="op" id="4130969">,</span>&nbsp;<span class="ident" id="4130971">y</span><span class="op" id="4130972">,</span>&nbsp;<span class="ident" id="4130974">z</span>&nbsp;<span class="op" id="4130976">*</span><span class="ident" id="4130977">p224FieldElement</span><span class="op" id="4130993">)</span>&nbsp;<span class="op" id="4130995">(</span><span class="op" id="4130996">*</span><span class="ident" id="4130997">big</span><span class="op" id="4131000">.</span><span class="ident" id="4131001">Int</span><span class="op" id="4131004">,</span>&nbsp;<span class="op" id="4131006">*</span><span class="ident" id="4131007">big</span><span class="op" id="4131010">.</span><span class="ident" id="4131011">Int</span><span class="op" id="4131014">)</span>&nbsp;<span class="op" id="4131016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4131019">var</span>&nbsp;<span class="ident" id="4131023">zinv</span><span class="op" id="4131027">,</span>&nbsp;<span class="ident" id="4131029">zinvsq</span><span class="op" id="4131035">,</span>&nbsp;<span class="ident" id="4131037">outx</span><span class="op" id="4131041">,</span>&nbsp;<span class="ident" id="4131043">outy</span>&nbsp;<span class="ident" id="4131048">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4131066">var</span>&nbsp;<span class="ident" id="4131070">tmp</span>&nbsp;<span class="ident" id="4131074">p224LargeFieldElement</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4131098">if</span>&nbsp;<span class="ident" id="4131101">isPointAtInfinity</span>&nbsp;<span class="op" id="4131119">:=</span>&nbsp;<span class="ident" id="4131122">p224IsZero</span><span class="op" id="4131132">(</span><span class="ident" id="4131133">z</span><span class="op" id="4131134">)</span><span class="op" id="4131135">;</span>&nbsp;<span class="ident" id="4131137">isPointAtInfinity</span>&nbsp;<span class="op" id="4131155">==</span>&nbsp;<span class="num" id="4131158">1</span>&nbsp;<span class="op" id="4131160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4131164">return</span>&nbsp;<span class="builtinfunc" id="4131171">new</span><span class="op" id="4131174">(</span><span class="ident" id="4131175">big</span><span class="op" id="4131178">.</span><span class="ident" id="4131179">Int</span><span class="op" id="4131182">)</span><span class="op" id="4131183">,</span>&nbsp;<span class="builtinfunc" id="4131185">new</span><span class="op" id="4131188">(</span><span class="ident" id="4131189">big</span><span class="op" id="4131192">.</span><span class="ident" id="4131193">Int</span><span class="op" id="4131196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4131199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4131203">p224Invert</span><span class="op" id="4131213">(</span><span class="op" id="4131214">&amp;</span><span class="ident" id="4131215">zinv</span><span class="op" id="4131219">,</span>&nbsp;<span class="ident" id="4131221">z</span><span class="op" id="4131222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4131225">p224Square</span><span class="op" id="4131235">(</span><span class="op" id="4131236">&amp;</span><span class="ident" id="4131237">zinvsq</span><span class="op" id="4131243">,</span>&nbsp;<span class="op" id="4131245">&amp;</span><span class="ident" id="4131246">zinv</span><span class="op" id="4131250">,</span>&nbsp;<span class="op" id="4131252">&amp;</span><span class="ident" id="4131253">tmp</span><span class="op" id="4131256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4131259">p224Mul</span><span class="op" id="4131266">(</span><span class="ident" id="4131267">x</span><span class="op" id="4131268">,</span>&nbsp;<span class="ident" id="4131270">x</span><span class="op" id="4131271">,</span>&nbsp;<span class="op" id="4131273">&amp;</span><span class="ident" id="4131274">zinvsq</span><span class="op" id="4131280">,</span>&nbsp;<span class="op" id="4131282">&amp;</span><span class="ident" id="4131283">tmp</span><span class="op" id="4131286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4131289">p224Mul</span><span class="op" id="4131296">(</span><span class="op" id="4131297">&amp;</span><span class="ident" id="4131298">zinvsq</span><span class="op" id="4131304">,</span>&nbsp;<span class="op" id="4131306">&amp;</span><span class="ident" id="4131307">zinvsq</span><span class="op" id="4131313">,</span>&nbsp;<span class="op" id="4131315">&amp;</span><span class="ident" id="4131316">zinv</span><span class="op" id="4131320">,</span>&nbsp;<span class="op" id="4131322">&amp;</span><span class="ident" id="4131323">tmp</span><span class="op" id="4131326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4131329">p224Mul</span><span class="op" id="4131336">(</span><span class="ident" id="4131337">y</span><span class="op" id="4131338">,</span>&nbsp;<span class="ident" id="4131340">y</span><span class="op" id="4131341">,</span>&nbsp;<span class="op" id="4131343">&amp;</span><span class="ident" id="4131344">zinvsq</span><span class="op" id="4131350">,</span>&nbsp;<span class="op" id="4131352">&amp;</span><span class="ident" id="4131353">tmp</span><span class="op" id="4131356">)</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4131360">p224Contract</span><span class="op" id="4131372">(</span><span class="op" id="4131373">&amp;</span><span class="ident" id="4131374">outx</span><span class="op" id="4131378">,</span>&nbsp;<span class="ident" id="4131380">x</span><span class="op" id="4131381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4131384">p224Contract</span><span class="op" id="4131396">(</span><span class="op" id="4131397">&amp;</span><span class="ident" id="4131398">outy</span><span class="op" id="4131402">,</span>&nbsp;<span class="ident" id="4131404">y</span><span class="op" id="4131405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4131408">return</span>&nbsp;<span class="ident" id="4131415">p224ToBig</span><span class="op" id="4131424">(</span><span class="op" id="4131425">&amp;</span><span class="ident" id="4131426">outx</span><span class="op" id="4131430">)</span><span class="op" id="4131431">,</span>&nbsp;<span class="ident" id="4131433">p224ToBig</span><span class="op" id="4131442">(</span><span class="op" id="4131443">&amp;</span><span class="ident" id="4131444">outy</span><span class="op" id="4131448">)</span><br>
<span class="lineno"></span><span class="op" id="4131450">}</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="comment" id="4131453">//&nbsp;get28BitsFromEnd&nbsp;returns&nbsp;the&nbsp;least-significant&nbsp;28&nbsp;bits&nbsp;from&nbsp;buf&gt;&gt;shift,</span><br>
<span class="lineno"></span><span class="comment" id="4131528">//&nbsp;where&nbsp;buf&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4131580">func</span>&nbsp;<span class="ident" id="4131585">get28BitsFromEnd</span><span class="op" id="4131601">(</span><span class="ident" id="4131602">buf</span>&nbsp;<span class="op" id="4131606">[</span><span class="op" id="4131607">]</span><span class="builtintype" id="4131608">byte</span><span class="op" id="4131612">,</span>&nbsp;<span class="ident" id="4131614">shift</span>&nbsp;<span class="builtintype" id="4131620">uint</span><span class="op" id="4131624">)</span>&nbsp;<span class="op" id="4131626">(</span><span class="builtintype" id="4131627">uint32</span><span class="op" id="4131633">,</span>&nbsp;<span class="op" id="4131635">[</span><span class="op" id="4131636">]</span><span class="builtintype" id="4131637">byte</span><span class="op" id="4131641">)</span>&nbsp;<span class="op" id="4131643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4131646">var</span>&nbsp;<span class="ident" id="4131650">ret</span>&nbsp;<span class="builtintype" id="4131654">uint32</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4131663">for</span>&nbsp;<span class="ident" id="4131667">i</span>&nbsp;<span class="op" id="4131669">:=</span>&nbsp;<span class="builtintype" id="4131672">uint</span><span class="op" id="4131676">(</span><span class="num" id="4131677">0</span><span class="op" id="4131678">)</span><span class="op" id="4131679">;</span>&nbsp;<span class="ident" id="4131681">i</span>&nbsp;<span class="op" id="4131683">&lt;</span>&nbsp;<span class="num" id="4131685">4</span><span class="op" id="4131686">;</span>&nbsp;<span class="ident" id="4131688">i</span><span class="op" id="4131689">++</span>&nbsp;<span class="op" id="4131692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4131696">var</span>&nbsp;<span class="ident" id="4131700">b</span>&nbsp;<span class="builtintype" id="4131702">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4131709">if</span>&nbsp;<span class="ident" id="4131712">l</span>&nbsp;<span class="op" id="4131714">:=</span>&nbsp;<span class="builtinfunc" id="4131717">len</span><span class="op" id="4131720">(</span><span class="ident" id="4131721">buf</span><span class="op" id="4131724">)</span><span class="op" id="4131725">;</span>&nbsp;<span class="ident" id="4131727">l</span>&nbsp;<span class="op" id="4131729">&gt;</span>&nbsp;<span class="num" id="4131731">0</span>&nbsp;<span class="op" id="4131733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4131738">b</span>&nbsp;<span class="op" id="4131740">=</span>&nbsp;<span class="ident" id="4131742">buf</span><span class="op" id="4131745">[</span><span class="ident" id="4131746">l</span><span class="op" id="4131747">-</span><span class="num" id="4131748">1</span><span class="op" id="4131749">]</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4131754">//&nbsp;We&nbsp;don&#39;t&nbsp;remove&nbsp;the&nbsp;byte&nbsp;if&nbsp;we&#39;re&nbsp;about&nbsp;to&nbsp;return&nbsp;and&nbsp;we&#39;re&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4131824">//&nbsp;reading&nbsp;all&nbsp;of&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4131849">if</span>&nbsp;<span class="ident" id="4131852">i</span>&nbsp;<span class="op" id="4131854">!=</span>&nbsp;<span class="num" id="4131857">3</span>&nbsp;<span class="op" id="4131859">||</span>&nbsp;<span class="ident" id="4131862">shift</span>&nbsp;<span class="op" id="4131868">==</span>&nbsp;<span class="num" id="4131871">4</span>&nbsp;<span class="op" id="4131873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4131879">buf</span>&nbsp;<span class="op" id="4131883">=</span>&nbsp;<span class="ident" id="4131885">buf</span><span class="op" id="4131888">[</span><span class="op" id="4131889">:</span><span class="ident" id="4131890">l</span><span class="op" id="4131891">-</span><span class="num" id="4131892">1</span><span class="op" id="4131893">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4131898">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4131902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4131906">ret</span>&nbsp;<span class="op" id="4131910">|=</span>&nbsp;<span class="builtintype" id="4131913">uint32</span><span class="op" id="4131919">(</span><span class="ident" id="4131920">b</span><span class="op" id="4131921">)</span>&nbsp;<span class="op" id="4131923">&lt;&lt;</span>&nbsp;<span class="op" id="4131926">(</span><span class="num" id="4131927">8</span>&nbsp;<span class="op" id="4131929">*</span>&nbsp;<span class="ident" id="4131931">i</span><span class="op" id="4131932">)</span>&nbsp;<span class="op" id="4131934">&gt;&gt;</span>&nbsp;<span class="ident" id="4131937">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4131944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4131947">ret</span>&nbsp;<span class="op" id="4131951">&amp;=</span>&nbsp;<span class="ident" id="4131954">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4131968">return</span>&nbsp;<span class="ident" id="4131975">ret</span><span class="op" id="4131978">,</span>&nbsp;<span class="ident" id="4131980">buf</span><br>
<span class="lineno">710</span><span class="op" id="4131984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4131987">//&nbsp;p224FromBig&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in.</span><br>
<span class="lineno"></span><span class="keyword" id="4132019">func</span>&nbsp;<span class="ident" id="4132024">p224FromBig</span><span class="op" id="4132035">(</span><span class="ident" id="4132036">out</span>&nbsp;<span class="op" id="4132040">*</span><span class="ident" id="4132041">p224FieldElement</span><span class="op" id="4132057">,</span>&nbsp;<span class="ident" id="4132059">in</span>&nbsp;<span class="op" id="4132062">*</span><span class="ident" id="4132063">big</span><span class="op" id="4132066">.</span><span class="ident" id="4132067">Int</span><span class="op" id="4132070">)</span>&nbsp;<span class="op" id="4132072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132075">bytes</span>&nbsp;<span class="op" id="4132081">:=</span>&nbsp;<span class="ident" id="4132084">in</span><span class="op" id="4132086">.</span><span class="ident" id="4132087">Bytes</span><span class="op" id="4132092">(</span><span class="op" id="4132093">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132096">out</span><span class="op" id="4132099">[</span><span class="num" id="4132100">0</span><span class="op" id="4132101">]</span><span class="op" id="4132102">,</span>&nbsp;<span class="ident" id="4132104">bytes</span>&nbsp;<span class="op" id="4132110">=</span>&nbsp;<span class="ident" id="4132112">get28BitsFromEnd</span><span class="op" id="4132128">(</span><span class="ident" id="4132129">bytes</span><span class="op" id="4132134">,</span>&nbsp;<span class="num" id="4132136">0</span><span class="op" id="4132137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132140">out</span><span class="op" id="4132143">[</span><span class="num" id="4132144">1</span><span class="op" id="4132145">]</span><span class="op" id="4132146">,</span>&nbsp;<span class="ident" id="4132148">bytes</span>&nbsp;<span class="op" id="4132154">=</span>&nbsp;<span class="ident" id="4132156">get28BitsFromEnd</span><span class="op" id="4132172">(</span><span class="ident" id="4132173">bytes</span><span class="op" id="4132178">,</span>&nbsp;<span class="num" id="4132180">4</span><span class="op" id="4132181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132184">out</span><span class="op" id="4132187">[</span><span class="num" id="4132188">2</span><span class="op" id="4132189">]</span><span class="op" id="4132190">,</span>&nbsp;<span class="ident" id="4132192">bytes</span>&nbsp;<span class="op" id="4132198">=</span>&nbsp;<span class="ident" id="4132200">get28BitsFromEnd</span><span class="op" id="4132216">(</span><span class="ident" id="4132217">bytes</span><span class="op" id="4132222">,</span>&nbsp;<span class="num" id="4132224">0</span><span class="op" id="4132225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132228">out</span><span class="op" id="4132231">[</span><span class="num" id="4132232">3</span><span class="op" id="4132233">]</span><span class="op" id="4132234">,</span>&nbsp;<span class="ident" id="4132236">bytes</span>&nbsp;<span class="op" id="4132242">=</span>&nbsp;<span class="ident" id="4132244">get28BitsFromEnd</span><span class="op" id="4132260">(</span><span class="ident" id="4132261">bytes</span><span class="op" id="4132266">,</span>&nbsp;<span class="num" id="4132268">4</span><span class="op" id="4132269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132272">out</span><span class="op" id="4132275">[</span><span class="num" id="4132276">4</span><span class="op" id="4132277">]</span><span class="op" id="4132278">,</span>&nbsp;<span class="ident" id="4132280">bytes</span>&nbsp;<span class="op" id="4132286">=</span>&nbsp;<span class="ident" id="4132288">get28BitsFromEnd</span><span class="op" id="4132304">(</span><span class="ident" id="4132305">bytes</span><span class="op" id="4132310">,</span>&nbsp;<span class="num" id="4132312">0</span><span class="op" id="4132313">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132316">out</span><span class="op" id="4132319">[</span><span class="num" id="4132320">5</span><span class="op" id="4132321">]</span><span class="op" id="4132322">,</span>&nbsp;<span class="ident" id="4132324">bytes</span>&nbsp;<span class="op" id="4132330">=</span>&nbsp;<span class="ident" id="4132332">get28BitsFromEnd</span><span class="op" id="4132348">(</span><span class="ident" id="4132349">bytes</span><span class="op" id="4132354">,</span>&nbsp;<span class="num" id="4132356">4</span><span class="op" id="4132357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132360">out</span><span class="op" id="4132363">[</span><span class="num" id="4132364">6</span><span class="op" id="4132365">]</span><span class="op" id="4132366">,</span>&nbsp;<span class="ident" id="4132368">bytes</span>&nbsp;<span class="op" id="4132374">=</span>&nbsp;<span class="ident" id="4132376">get28BitsFromEnd</span><span class="op" id="4132392">(</span><span class="ident" id="4132393">bytes</span><span class="op" id="4132398">,</span>&nbsp;<span class="num" id="4132400">0</span><span class="op" id="4132401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132404">out</span><span class="op" id="4132407">[</span><span class="num" id="4132408">7</span><span class="op" id="4132409">]</span><span class="op" id="4132410">,</span>&nbsp;<span class="ident" id="4132412">bytes</span>&nbsp;<span class="op" id="4132418">=</span>&nbsp;<span class="ident" id="4132420">get28BitsFromEnd</span><span class="op" id="4132436">(</span><span class="ident" id="4132437">bytes</span><span class="op" id="4132442">,</span>&nbsp;<span class="num" id="4132444">4</span><span class="op" id="4132445">)</span><br>
<span class="lineno"></span><span class="op" id="4132447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="comment" id="4132450">//&nbsp;p224ToBig&nbsp;returns&nbsp;in&nbsp;as&nbsp;a&nbsp;big.Int.</span><br>
<span class="lineno"></span><span class="keyword" id="4132488">func</span>&nbsp;<span class="ident" id="4132493">p224ToBig</span><span class="op" id="4132502">(</span><span class="ident" id="4132503">in</span>&nbsp;<span class="op" id="4132506">*</span><span class="ident" id="4132507">p224FieldElement</span><span class="op" id="4132523">)</span>&nbsp;<span class="op" id="4132525">*</span><span class="ident" id="4132526">big</span><span class="op" id="4132529">.</span><span class="ident" id="4132530">Int</span>&nbsp;<span class="op" id="4132534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4132537">var</span>&nbsp;<span class="ident" id="4132541">buf</span>&nbsp;<span class="op" id="4132545">[</span><span class="num" id="4132546">28</span><span class="op" id="4132548">]</span><span class="builtintype" id="4132549">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132555">buf</span><span class="op" id="4132558">[</span><span class="num" id="4132559">27</span><span class="op" id="4132561">]</span>&nbsp;<span class="op" id="4132563">=</span>&nbsp;<span class="builtintype" id="4132565">byte</span><span class="op" id="4132569">(</span><span class="ident" id="4132570">in</span><span class="op" id="4132572">[</span><span class="num" id="4132573">0</span><span class="op" id="4132574">]</span><span class="op" id="4132575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132578">buf</span><span class="op" id="4132581">[</span><span class="num" id="4132582">26</span><span class="op" id="4132584">]</span>&nbsp;<span class="op" id="4132586">=</span>&nbsp;<span class="builtintype" id="4132588">byte</span><span class="op" id="4132592">(</span><span class="ident" id="4132593">in</span><span class="op" id="4132595">[</span><span class="num" id="4132596">0</span><span class="op" id="4132597">]</span>&nbsp;<span class="op" id="4132599">&gt;&gt;</span>&nbsp;<span class="num" id="4132602">8</span><span class="op" id="4132603">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132606">buf</span><span class="op" id="4132609">[</span><span class="num" id="4132610">25</span><span class="op" id="4132612">]</span>&nbsp;<span class="op" id="4132614">=</span>&nbsp;<span class="builtintype" id="4132616">byte</span><span class="op" id="4132620">(</span><span class="ident" id="4132621">in</span><span class="op" id="4132623">[</span><span class="num" id="4132624">0</span><span class="op" id="4132625">]</span>&nbsp;<span class="op" id="4132627">&gt;&gt;</span>&nbsp;<span class="num" id="4132630">16</span><span class="op" id="4132632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132635">buf</span><span class="op" id="4132638">[</span><span class="num" id="4132639">24</span><span class="op" id="4132641">]</span>&nbsp;<span class="op" id="4132643">=</span>&nbsp;<span class="builtintype" id="4132645">byte</span><span class="op" id="4132649">(</span><span class="op" id="4132650">(</span><span class="op" id="4132651">(</span><span class="ident" id="4132652">in</span><span class="op" id="4132654">[</span><span class="num" id="4132655">0</span><span class="op" id="4132656">]</span>&nbsp;<span class="op" id="4132658">&gt;&gt;</span>&nbsp;<span class="num" id="4132661">24</span><span class="op" id="4132663">)</span>&nbsp;<span class="op" id="4132665">&amp;</span>&nbsp;<span class="num" id="4132667">0x0f</span><span class="op" id="4132671">)</span>&nbsp;<span class="op" id="4132673">|</span>&nbsp;<span class="op" id="4132675">(</span><span class="ident" id="4132676">in</span><span class="op" id="4132678">[</span><span class="num" id="4132679">1</span><span class="op" id="4132680">]</span><span class="op" id="4132681">&lt;&lt;</span><span class="num" id="4132683">4</span><span class="op" id="4132684">)</span><span class="op" id="4132685">&amp;</span><span class="num" id="4132686">0xf0</span><span class="op" id="4132690">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132694">buf</span><span class="op" id="4132697">[</span><span class="num" id="4132698">23</span><span class="op" id="4132700">]</span>&nbsp;<span class="op" id="4132702">=</span>&nbsp;<span class="builtintype" id="4132704">byte</span><span class="op" id="4132708">(</span><span class="ident" id="4132709">in</span><span class="op" id="4132711">[</span><span class="num" id="4132712">1</span><span class="op" id="4132713">]</span>&nbsp;<span class="op" id="4132715">&gt;&gt;</span>&nbsp;<span class="num" id="4132718">4</span><span class="op" id="4132719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132722">buf</span><span class="op" id="4132725">[</span><span class="num" id="4132726">22</span><span class="op" id="4132728">]</span>&nbsp;<span class="op" id="4132730">=</span>&nbsp;<span class="builtintype" id="4132732">byte</span><span class="op" id="4132736">(</span><span class="ident" id="4132737">in</span><span class="op" id="4132739">[</span><span class="num" id="4132740">1</span><span class="op" id="4132741">]</span>&nbsp;<span class="op" id="4132743">&gt;&gt;</span>&nbsp;<span class="num" id="4132746">12</span><span class="op" id="4132748">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132751">buf</span><span class="op" id="4132754">[</span><span class="num" id="4132755">21</span><span class="op" id="4132757">]</span>&nbsp;<span class="op" id="4132759">=</span>&nbsp;<span class="builtintype" id="4132761">byte</span><span class="op" id="4132765">(</span><span class="ident" id="4132766">in</span><span class="op" id="4132768">[</span><span class="num" id="4132769">1</span><span class="op" id="4132770">]</span>&nbsp;<span class="op" id="4132772">&gt;&gt;</span>&nbsp;<span class="num" id="4132775">20</span><span class="op" id="4132777">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132781">buf</span><span class="op" id="4132784">[</span><span class="num" id="4132785">20</span><span class="op" id="4132787">]</span>&nbsp;<span class="op" id="4132789">=</span>&nbsp;<span class="builtintype" id="4132791">byte</span><span class="op" id="4132795">(</span><span class="ident" id="4132796">in</span><span class="op" id="4132798">[</span><span class="num" id="4132799">2</span><span class="op" id="4132800">]</span><span class="op" id="4132801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132804">buf</span><span class="op" id="4132807">[</span><span class="num" id="4132808">19</span><span class="op" id="4132810">]</span>&nbsp;<span class="op" id="4132812">=</span>&nbsp;<span class="builtintype" id="4132814">byte</span><span class="op" id="4132818">(</span><span class="ident" id="4132819">in</span><span class="op" id="4132821">[</span><span class="num" id="4132822">2</span><span class="op" id="4132823">]</span>&nbsp;<span class="op" id="4132825">&gt;&gt;</span>&nbsp;<span class="num" id="4132828">8</span><span class="op" id="4132829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132832">buf</span><span class="op" id="4132835">[</span><span class="num" id="4132836">18</span><span class="op" id="4132838">]</span>&nbsp;<span class="op" id="4132840">=</span>&nbsp;<span class="builtintype" id="4132842">byte</span><span class="op" id="4132846">(</span><span class="ident" id="4132847">in</span><span class="op" id="4132849">[</span><span class="num" id="4132850">2</span><span class="op" id="4132851">]</span>&nbsp;<span class="op" id="4132853">&gt;&gt;</span>&nbsp;<span class="num" id="4132856">16</span><span class="op" id="4132858">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132861">buf</span><span class="op" id="4132864">[</span><span class="num" id="4132865">17</span><span class="op" id="4132867">]</span>&nbsp;<span class="op" id="4132869">=</span>&nbsp;<span class="builtintype" id="4132871">byte</span><span class="op" id="4132875">(</span><span class="op" id="4132876">(</span><span class="op" id="4132877">(</span><span class="ident" id="4132878">in</span><span class="op" id="4132880">[</span><span class="num" id="4132881">2</span><span class="op" id="4132882">]</span>&nbsp;<span class="op" id="4132884">&gt;&gt;</span>&nbsp;<span class="num" id="4132887">24</span><span class="op" id="4132889">)</span>&nbsp;<span class="op" id="4132891">&amp;</span>&nbsp;<span class="num" id="4132893">0x0f</span><span class="op" id="4132897">)</span>&nbsp;<span class="op" id="4132899">|</span>&nbsp;<span class="op" id="4132901">(</span><span class="ident" id="4132902">in</span><span class="op" id="4132904">[</span><span class="num" id="4132905">3</span><span class="op" id="4132906">]</span><span class="op" id="4132907">&lt;&lt;</span><span class="num" id="4132909">4</span><span class="op" id="4132910">)</span><span class="op" id="4132911">&amp;</span><span class="num" id="4132912">0xf0</span><span class="op" id="4132916">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132920">buf</span><span class="op" id="4132923">[</span><span class="num" id="4132924">16</span><span class="op" id="4132926">]</span>&nbsp;<span class="op" id="4132928">=</span>&nbsp;<span class="builtintype" id="4132930">byte</span><span class="op" id="4132934">(</span><span class="ident" id="4132935">in</span><span class="op" id="4132937">[</span><span class="num" id="4132938">3</span><span class="op" id="4132939">]</span>&nbsp;<span class="op" id="4132941">&gt;&gt;</span>&nbsp;<span class="num" id="4132944">4</span><span class="op" id="4132945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132948">buf</span><span class="op" id="4132951">[</span><span class="num" id="4132952">15</span><span class="op" id="4132954">]</span>&nbsp;<span class="op" id="4132956">=</span>&nbsp;<span class="builtintype" id="4132958">byte</span><span class="op" id="4132962">(</span><span class="ident" id="4132963">in</span><span class="op" id="4132965">[</span><span class="num" id="4132966">3</span><span class="op" id="4132967">]</span>&nbsp;<span class="op" id="4132969">&gt;&gt;</span>&nbsp;<span class="num" id="4132972">12</span><span class="op" id="4132974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132977">buf</span><span class="op" id="4132980">[</span><span class="num" id="4132981">14</span><span class="op" id="4132983">]</span>&nbsp;<span class="op" id="4132985">=</span>&nbsp;<span class="builtintype" id="4132987">byte</span><span class="op" id="4132991">(</span><span class="ident" id="4132992">in</span><span class="op" id="4132994">[</span><span class="num" id="4132995">3</span><span class="op" id="4132996">]</span>&nbsp;<span class="op" id="4132998">&gt;&gt;</span>&nbsp;<span class="num" id="4133001">20</span><span class="op" id="4133003">)</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133007">buf</span><span class="op" id="4133010">[</span><span class="num" id="4133011">13</span><span class="op" id="4133013">]</span>&nbsp;<span class="op" id="4133015">=</span>&nbsp;<span class="builtintype" id="4133017">byte</span><span class="op" id="4133021">(</span><span class="ident" id="4133022">in</span><span class="op" id="4133024">[</span><span class="num" id="4133025">4</span><span class="op" id="4133026">]</span><span class="op" id="4133027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133030">buf</span><span class="op" id="4133033">[</span><span class="num" id="4133034">12</span><span class="op" id="4133036">]</span>&nbsp;<span class="op" id="4133038">=</span>&nbsp;<span class="builtintype" id="4133040">byte</span><span class="op" id="4133044">(</span><span class="ident" id="4133045">in</span><span class="op" id="4133047">[</span><span class="num" id="4133048">4</span><span class="op" id="4133049">]</span>&nbsp;<span class="op" id="4133051">&gt;&gt;</span>&nbsp;<span class="num" id="4133054">8</span><span class="op" id="4133055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133058">buf</span><span class="op" id="4133061">[</span><span class="num" id="4133062">11</span><span class="op" id="4133064">]</span>&nbsp;<span class="op" id="4133066">=</span>&nbsp;<span class="builtintype" id="4133068">byte</span><span class="op" id="4133072">(</span><span class="ident" id="4133073">in</span><span class="op" id="4133075">[</span><span class="num" id="4133076">4</span><span class="op" id="4133077">]</span>&nbsp;<span class="op" id="4133079">&gt;&gt;</span>&nbsp;<span class="num" id="4133082">16</span><span class="op" id="4133084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133087">buf</span><span class="op" id="4133090">[</span><span class="num" id="4133091">10</span><span class="op" id="4133093">]</span>&nbsp;<span class="op" id="4133095">=</span>&nbsp;<span class="builtintype" id="4133097">byte</span><span class="op" id="4133101">(</span><span class="op" id="4133102">(</span><span class="op" id="4133103">(</span><span class="ident" id="4133104">in</span><span class="op" id="4133106">[</span><span class="num" id="4133107">4</span><span class="op" id="4133108">]</span>&nbsp;<span class="op" id="4133110">&gt;&gt;</span>&nbsp;<span class="num" id="4133113">24</span><span class="op" id="4133115">)</span>&nbsp;<span class="op" id="4133117">&amp;</span>&nbsp;<span class="num" id="4133119">0x0f</span><span class="op" id="4133123">)</span>&nbsp;<span class="op" id="4133125">|</span>&nbsp;<span class="op" id="4133127">(</span><span class="ident" id="4133128">in</span><span class="op" id="4133130">[</span><span class="num" id="4133131">5</span><span class="op" id="4133132">]</span><span class="op" id="4133133">&lt;&lt;</span><span class="num" id="4133135">4</span><span class="op" id="4133136">)</span><span class="op" id="4133137">&amp;</span><span class="num" id="4133138">0xf0</span><span class="op" id="4133142">)</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133146">buf</span><span class="op" id="4133149">[</span><span class="num" id="4133150">9</span><span class="op" id="4133151">]</span>&nbsp;<span class="op" id="4133153">=</span>&nbsp;<span class="builtintype" id="4133155">byte</span><span class="op" id="4133159">(</span><span class="ident" id="4133160">in</span><span class="op" id="4133162">[</span><span class="num" id="4133163">5</span><span class="op" id="4133164">]</span>&nbsp;<span class="op" id="4133166">&gt;&gt;</span>&nbsp;<span class="num" id="4133169">4</span><span class="op" id="4133170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133173">buf</span><span class="op" id="4133176">[</span><span class="num" id="4133177">8</span><span class="op" id="4133178">]</span>&nbsp;<span class="op" id="4133180">=</span>&nbsp;<span class="builtintype" id="4133182">byte</span><span class="op" id="4133186">(</span><span class="ident" id="4133187">in</span><span class="op" id="4133189">[</span><span class="num" id="4133190">5</span><span class="op" id="4133191">]</span>&nbsp;<span class="op" id="4133193">&gt;&gt;</span>&nbsp;<span class="num" id="4133196">12</span><span class="op" id="4133198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133201">buf</span><span class="op" id="4133204">[</span><span class="num" id="4133205">7</span><span class="op" id="4133206">]</span>&nbsp;<span class="op" id="4133208">=</span>&nbsp;<span class="builtintype" id="4133210">byte</span><span class="op" id="4133214">(</span><span class="ident" id="4133215">in</span><span class="op" id="4133217">[</span><span class="num" id="4133218">5</span><span class="op" id="4133219">]</span>&nbsp;<span class="op" id="4133221">&gt;&gt;</span>&nbsp;<span class="num" id="4133224">20</span><span class="op" id="4133226">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133230">buf</span><span class="op" id="4133233">[</span><span class="num" id="4133234">6</span><span class="op" id="4133235">]</span>&nbsp;<span class="op" id="4133237">=</span>&nbsp;<span class="builtintype" id="4133239">byte</span><span class="op" id="4133243">(</span><span class="ident" id="4133244">in</span><span class="op" id="4133246">[</span><span class="num" id="4133247">6</span><span class="op" id="4133248">]</span><span class="op" id="4133249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133252">buf</span><span class="op" id="4133255">[</span><span class="num" id="4133256">5</span><span class="op" id="4133257">]</span>&nbsp;<span class="op" id="4133259">=</span>&nbsp;<span class="builtintype" id="4133261">byte</span><span class="op" id="4133265">(</span><span class="ident" id="4133266">in</span><span class="op" id="4133268">[</span><span class="num" id="4133269">6</span><span class="op" id="4133270">]</span>&nbsp;<span class="op" id="4133272">&gt;&gt;</span>&nbsp;<span class="num" id="4133275">8</span><span class="op" id="4133276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133279">buf</span><span class="op" id="4133282">[</span><span class="num" id="4133283">4</span><span class="op" id="4133284">]</span>&nbsp;<span class="op" id="4133286">=</span>&nbsp;<span class="builtintype" id="4133288">byte</span><span class="op" id="4133292">(</span><span class="ident" id="4133293">in</span><span class="op" id="4133295">[</span><span class="num" id="4133296">6</span><span class="op" id="4133297">]</span>&nbsp;<span class="op" id="4133299">&gt;&gt;</span>&nbsp;<span class="num" id="4133302">16</span><span class="op" id="4133304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133307">buf</span><span class="op" id="4133310">[</span><span class="num" id="4133311">3</span><span class="op" id="4133312">]</span>&nbsp;<span class="op" id="4133314">=</span>&nbsp;<span class="builtintype" id="4133316">byte</span><span class="op" id="4133320">(</span><span class="op" id="4133321">(</span><span class="op" id="4133322">(</span><span class="ident" id="4133323">in</span><span class="op" id="4133325">[</span><span class="num" id="4133326">6</span><span class="op" id="4133327">]</span>&nbsp;<span class="op" id="4133329">&gt;&gt;</span>&nbsp;<span class="num" id="4133332">24</span><span class="op" id="4133334">)</span>&nbsp;<span class="op" id="4133336">&amp;</span>&nbsp;<span class="num" id="4133338">0x0f</span><span class="op" id="4133342">)</span>&nbsp;<span class="op" id="4133344">|</span>&nbsp;<span class="op" id="4133346">(</span><span class="ident" id="4133347">in</span><span class="op" id="4133349">[</span><span class="num" id="4133350">7</span><span class="op" id="4133351">]</span><span class="op" id="4133352">&lt;&lt;</span><span class="num" id="4133354">4</span><span class="op" id="4133355">)</span><span class="op" id="4133356">&amp;</span><span class="num" id="4133357">0xf0</span><span class="op" id="4133361">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133365">buf</span><span class="op" id="4133368">[</span><span class="num" id="4133369">2</span><span class="op" id="4133370">]</span>&nbsp;<span class="op" id="4133372">=</span>&nbsp;<span class="builtintype" id="4133374">byte</span><span class="op" id="4133378">(</span><span class="ident" id="4133379">in</span><span class="op" id="4133381">[</span><span class="num" id="4133382">7</span><span class="op" id="4133383">]</span>&nbsp;<span class="op" id="4133385">&gt;&gt;</span>&nbsp;<span class="num" id="4133388">4</span><span class="op" id="4133389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133392">buf</span><span class="op" id="4133395">[</span><span class="num" id="4133396">1</span><span class="op" id="4133397">]</span>&nbsp;<span class="op" id="4133399">=</span>&nbsp;<span class="builtintype" id="4133401">byte</span><span class="op" id="4133405">(</span><span class="ident" id="4133406">in</span><span class="op" id="4133408">[</span><span class="num" id="4133409">7</span><span class="op" id="4133410">]</span>&nbsp;<span class="op" id="4133412">&gt;&gt;</span>&nbsp;<span class="num" id="4133415">12</span><span class="op" id="4133417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133420">buf</span><span class="op" id="4133423">[</span><span class="num" id="4133424">0</span><span class="op" id="4133425">]</span>&nbsp;<span class="op" id="4133427">=</span>&nbsp;<span class="builtintype" id="4133429">byte</span><span class="op" id="4133433">(</span><span class="ident" id="4133434">in</span><span class="op" id="4133436">[</span><span class="num" id="4133437">7</span><span class="op" id="4133438">]</span>&nbsp;<span class="op" id="4133440">&gt;&gt;</span>&nbsp;<span class="num" id="4133443">20</span><span class="op" id="4133445">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4133449">return</span>&nbsp;<span class="builtinfunc" id="4133456">new</span><span class="op" id="4133459">(</span><span class="ident" id="4133460">big</span><span class="op" id="4133463">.</span><span class="ident" id="4133464">Int</span><span class="op" id="4133467">)</span><span class="op" id="4133468">.</span><span class="ident" id="4133469">SetBytes</span><span class="op" id="4133477">(</span><span class="ident" id="4133478">buf</span><span class="op" id="4133481">[</span><span class="op" id="4133482">:</span><span class="op" id="4133483">]</span><span class="op" id="4133484">)</span><br>
<span class="lineno">765</span><span class="op" id="4133486">}</span>
</div>
</body>
</html>
