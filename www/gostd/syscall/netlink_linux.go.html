<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html" class="current">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2498886">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2498942">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2498996">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2499047">//&nbsp;Netlink&nbsp;sockets&nbsp;and&nbsp;messages</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2499080">package</span>&nbsp;<span class="ident" id="2499088">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2499097">import</span>&nbsp;<span class="string" id="2499104">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2499114">//&nbsp;Round&nbsp;the&nbsp;length&nbsp;of&nbsp;a&nbsp;netlink&nbsp;message&nbsp;up&nbsp;to&nbsp;align&nbsp;it&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="2499180">func</span>&nbsp;<span class="ident" id="2499185">nlmAlignOf</span><span class="op" id="2499195">(</span><span class="ident" id="2499196">msglen</span>&nbsp;<span class="builtintype" id="2499203">int</span><span class="op" id="2499206">)</span>&nbsp;<span class="builtintype" id="2499208">int</span>&nbsp;<span class="op" id="2499212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2499215">return</span>&nbsp;<span class="op" id="2499222">(</span><span class="ident" id="2499223"><a href="/gostd/syscall/netlink_linux.go.html#2499196">msglen</a></span>&nbsp;<span class="op" id="2499230">+</span>&nbsp;<span class="ident" id="2499232"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2576089">NLMSG_ALIGNTO</a></span>&nbsp;<span class="op" id="2499246">-</span>&nbsp;<span class="num" id="2499248">1</span><span class="op" id="2499249">)</span>&nbsp;<span class="op" id="2499251">&amp;</span>&nbsp;<span class="op" id="2499253">^</span><span class="op" id="2499254">(</span><span class="ident" id="2499255"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2576089">NLMSG_ALIGNTO</a></span>&nbsp;<span class="op" id="2499269">-</span>&nbsp;<span class="num" id="2499271">1</span><span class="op" id="2499272">)</span><br>
<span class="lineno"></span><span class="op" id="2499274">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2499277">//&nbsp;Round&nbsp;the&nbsp;length&nbsp;of&nbsp;a&nbsp;netlink&nbsp;route&nbsp;attribute&nbsp;up&nbsp;to&nbsp;align&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="2499341">//&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="2499354">func</span>&nbsp;<span class="ident" id="2499359">rtaAlignOf</span><span class="op" id="2499369">(</span><span class="ident" id="2499370">attrlen</span>&nbsp;<span class="builtintype" id="2499378">int</span><span class="op" id="2499381">)</span>&nbsp;<span class="builtintype" id="2499383">int</span>&nbsp;<span class="op" id="2499387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2499390">return</span>&nbsp;<span class="op" id="2499397">(</span><span class="ident" id="2499398"><a href="/gostd/syscall/netlink_linux.go.html#2499370">attrlen</a></span>&nbsp;<span class="op" id="2499406">+</span>&nbsp;<span class="ident" id="2499408"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2584172">RTA_ALIGNTO</a></span>&nbsp;<span class="op" id="2499420">-</span>&nbsp;<span class="num" id="2499422">1</span><span class="op" id="2499423">)</span>&nbsp;<span class="op" id="2499425">&amp;</span>&nbsp;<span class="op" id="2499427">^</span><span class="op" id="2499428">(</span><span class="ident" id="2499429"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2584172">RTA_ALIGNTO</a></span>&nbsp;<span class="op" id="2499441">-</span>&nbsp;<span class="num" id="2499443">1</span><span class="op" id="2499444">)</span><br>
<span class="lineno">20</span><span class="op" id="2499446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2499449">//&nbsp;NetlinkRouteRequest&nbsp;represents&nbsp;a&nbsp;request&nbsp;message&nbsp;to&nbsp;receive&nbsp;routing</span><br>
<span class="lineno"></span><span class="comment" id="2499520">//&nbsp;and&nbsp;link&nbsp;states&nbsp;from&nbsp;the&nbsp;kernel.</span><br>
<span class="lineno"></span><span class="keyword" id="2499556">type</span>&nbsp;<span class="ident" id="2499561">NetlinkRouteRequest</span>&nbsp;<span class="keyword" id="2499581">struct</span>&nbsp;<span class="op" id="2499588">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2499591">Header</span>&nbsp;<span class="ident" id="2499598"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673944">NlMsghdr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2499608">Data</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2499615"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674095">RtGenmsg</a></span><br>
<span class="lineno"></span><span class="op" id="2499624">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2499627">func</span>&nbsp;<span class="op" id="2499632">(</span><span class="ident" id="2499633">rr</span>&nbsp;<span class="op" id="2499636">*</span><span class="ident" id="2499637"><a href="/gostd/syscall/netlink_linux.go.html#2499561">NetlinkRouteRequest</a></span><span class="op" id="2499656">)</span>&nbsp;<span class="ident" id="2499658">toWireFormat</span><span class="op" id="2499670">(</span><span class="op" id="2499671">)</span>&nbsp;<span class="op" id="2499673">[</span><span class="op" id="2499674">]</span><span class="builtintype" id="2499675">byte</span>&nbsp;<span class="op" id="2499680">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2499683">b</span>&nbsp;<span class="op" id="2499685">:=</span>&nbsp;<span class="builtinfunc" id="2499688">make</span><span class="op" id="2499692">(</span><span class="op" id="2499693">[</span><span class="op" id="2499694">]</span><span class="builtintype" id="2499695">byte</span><span class="op" id="2499699">,</span>&nbsp;<span class="ident" id="2499701"><a href="/gostd/syscall/netlink_linux.go.html#2499633">rr</a></span><span class="op" id="2499703">.</span><span class="ident" id="2499704"><a href="/gostd/syscall/netlink_linux.go.html#2499591">Header</a></span><span class="op" id="2499710">.</span><span class="ident" id="2499711"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673963">Len</a></span><span class="op" id="2499714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2499717">*</span><span class="op" id="2499718">(</span><span class="op" id="2499719">*</span><span class="builtintype" id="2499720">uint32</span><span class="op" id="2499726">)</span><span class="op" id="2499727">(</span><span class="ident" id="2499728"><a href="/gostd/syscall/netlink_linux.go.html#2499104">unsafe</a></span><span class="op" id="2499734">.</span><span class="ident" id="2499735">Pointer</span><span class="op" id="2499742">(</span><span class="op" id="2499743">&amp;</span><span class="ident" id="2499744"><a href="/gostd/syscall/netlink_linux.go.html#2499683">b</a></span><span class="op" id="2499745">[</span><span class="num" id="2499746">0</span><span class="op" id="2499747">:</span><span class="num" id="2499748">4</span><span class="op" id="2499749">]</span><span class="op" id="2499750">[</span><span class="num" id="2499751">0</span><span class="op" id="2499752">]</span><span class="op" id="2499753">)</span><span class="op" id="2499754">)</span>&nbsp;<span class="op" id="2499756">=</span>&nbsp;<span class="ident" id="2499758"><a href="/gostd/syscall/netlink_linux.go.html#2499633">rr</a></span><span class="op" id="2499760">.</span><span class="ident" id="2499761"><a href="/gostd/syscall/netlink_linux.go.html#2499591">Header</a></span><span class="op" id="2499767">.</span><span class="ident" id="2499768"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673963">Len</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2499773">*</span><span class="op" id="2499774">(</span><span class="op" id="2499775">*</span><span class="builtintype" id="2499776">uint16</span><span class="op" id="2499782">)</span><span class="op" id="2499783">(</span><span class="ident" id="2499784"><a href="/gostd/syscall/netlink_linux.go.html#2499104">unsafe</a></span><span class="op" id="2499790">.</span><span class="ident" id="2499791">Pointer</span><span class="op" id="2499798">(</span><span class="op" id="2499799">&amp;</span><span class="ident" id="2499800"><a href="/gostd/syscall/netlink_linux.go.html#2499683">b</a></span><span class="op" id="2499801">[</span><span class="num" id="2499802">4</span><span class="op" id="2499803">:</span><span class="num" id="2499804">6</span><span class="op" id="2499805">]</span><span class="op" id="2499806">[</span><span class="num" id="2499807">0</span><span class="op" id="2499808">]</span><span class="op" id="2499809">)</span><span class="op" id="2499810">)</span>&nbsp;<span class="op" id="2499812">=</span>&nbsp;<span class="ident" id="2499814"><a href="/gostd/syscall/netlink_linux.go.html#2499633">rr</a></span><span class="op" id="2499816">.</span><span class="ident" id="2499817"><a href="/gostd/syscall/netlink_linux.go.html#2499591">Header</a></span><span class="op" id="2499823">.</span><span class="ident" id="2499824"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673977">Type</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2499830">*</span><span class="op" id="2499831">(</span><span class="op" id="2499832">*</span><span class="builtintype" id="2499833">uint16</span><span class="op" id="2499839">)</span><span class="op" id="2499840">(</span><span class="ident" id="2499841"><a href="/gostd/syscall/netlink_linux.go.html#2499104">unsafe</a></span><span class="op" id="2499847">.</span><span class="ident" id="2499848">Pointer</span><span class="op" id="2499855">(</span><span class="op" id="2499856">&amp;</span><span class="ident" id="2499857"><a href="/gostd/syscall/netlink_linux.go.html#2499683">b</a></span><span class="op" id="2499858">[</span><span class="num" id="2499859">6</span><span class="op" id="2499860">:</span><span class="num" id="2499861">8</span><span class="op" id="2499862">]</span><span class="op" id="2499863">[</span><span class="num" id="2499864">0</span><span class="op" id="2499865">]</span><span class="op" id="2499866">)</span><span class="op" id="2499867">)</span>&nbsp;<span class="op" id="2499869">=</span>&nbsp;<span class="ident" id="2499871"><a href="/gostd/syscall/netlink_linux.go.html#2499633">rr</a></span><span class="op" id="2499873">.</span><span class="ident" id="2499874"><a href="/gostd/syscall/netlink_linux.go.html#2499591">Header</a></span><span class="op" id="2499880">.</span><span class="ident" id="2499881"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673991">Flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2499888">*</span><span class="op" id="2499889">(</span><span class="op" id="2499890">*</span><span class="builtintype" id="2499891">uint32</span><span class="op" id="2499897">)</span><span class="op" id="2499898">(</span><span class="ident" id="2499899"><a href="/gostd/syscall/netlink_linux.go.html#2499104">unsafe</a></span><span class="op" id="2499905">.</span><span class="ident" id="2499906">Pointer</span><span class="op" id="2499913">(</span><span class="op" id="2499914">&amp;</span><span class="ident" id="2499915"><a href="/gostd/syscall/netlink_linux.go.html#2499683">b</a></span><span class="op" id="2499916">[</span><span class="num" id="2499917">8</span><span class="op" id="2499918">:</span><span class="num" id="2499919">12</span><span class="op" id="2499921">]</span><span class="op" id="2499922">[</span><span class="num" id="2499923">0</span><span class="op" id="2499924">]</span><span class="op" id="2499925">)</span><span class="op" id="2499926">)</span>&nbsp;<span class="op" id="2499928">=</span>&nbsp;<span class="ident" id="2499930"><a href="/gostd/syscall/netlink_linux.go.html#2499633">rr</a></span><span class="op" id="2499932">.</span><span class="ident" id="2499933"><a href="/gostd/syscall/netlink_linux.go.html#2499591">Header</a></span><span class="op" id="2499939">.</span><span class="ident" id="2499940"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674005">Seq</a></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2499945">*</span><span class="op" id="2499946">(</span><span class="op" id="2499947">*</span><span class="builtintype" id="2499948">uint32</span><span class="op" id="2499954">)</span><span class="op" id="2499955">(</span><span class="ident" id="2499956"><a href="/gostd/syscall/netlink_linux.go.html#2499104">unsafe</a></span><span class="op" id="2499962">.</span><span class="ident" id="2499963">Pointer</span><span class="op" id="2499970">(</span><span class="op" id="2499971">&amp;</span><span class="ident" id="2499972"><a href="/gostd/syscall/netlink_linux.go.html#2499683">b</a></span><span class="op" id="2499973">[</span><span class="num" id="2499974">12</span><span class="op" id="2499976">:</span><span class="num" id="2499977">16</span><span class="op" id="2499979">]</span><span class="op" id="2499980">[</span><span class="num" id="2499981">0</span><span class="op" id="2499982">]</span><span class="op" id="2499983">)</span><span class="op" id="2499984">)</span>&nbsp;<span class="op" id="2499986">=</span>&nbsp;<span class="ident" id="2499988"><a href="/gostd/syscall/netlink_linux.go.html#2499633">rr</a></span><span class="op" id="2499990">.</span><span class="ident" id="2499991"><a href="/gostd/syscall/netlink_linux.go.html#2499591">Header</a></span><span class="op" id="2499997">.</span><span class="ident" id="2499998"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674019">Pid</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500003"><a href="/gostd/syscall/netlink_linux.go.html#2499683">b</a></span><span class="op" id="2500004">[</span><span class="num" id="2500005">16</span><span class="op" id="2500007">]</span>&nbsp;<span class="op" id="2500009">=</span>&nbsp;<span class="builtintype" id="2500011">byte</span><span class="op" id="2500015">(</span><span class="ident" id="2500016"><a href="/gostd/syscall/netlink_linux.go.html#2499633">rr</a></span><span class="op" id="2500018">.</span><span class="ident" id="2500019"><a href="/gostd/syscall/netlink_linux.go.html#2499608">Data</a></span><span class="op" id="2500023">.</span><span class="ident" id="2500024"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674114">Family</a></span><span class="op" id="2500030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2500033">return</span>&nbsp;<span class="ident" id="2500040"><a href="/gostd/syscall/netlink_linux.go.html#2499683">b</a></span><br>
<span class="lineno"></span><span class="op" id="2500042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2500045">func</span>&nbsp;<span class="ident" id="2500050">newNetlinkRouteRequest</span><span class="op" id="2500072">(</span><span class="ident" id="2500073">proto</span><span class="op" id="2500078">,</span>&nbsp;<span class="ident" id="2500080">seq</span><span class="op" id="2500083">,</span>&nbsp;<span class="ident" id="2500085">family</span>&nbsp;<span class="builtintype" id="2500092">int</span><span class="op" id="2500095">)</span>&nbsp;<span class="op" id="2500097">[</span><span class="op" id="2500098">]</span><span class="builtintype" id="2500099">byte</span>&nbsp;<span class="op" id="2500104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500107">rr</span>&nbsp;<span class="op" id="2500110">:=</span>&nbsp;<span class="op" id="2500113">&amp;</span><span class="ident" id="2500114"><a href="/gostd/syscall/netlink_linux.go.html#2499561">NetlinkRouteRequest</a></span><span class="op" id="2500133">{</span><span class="op" id="2500134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500137"><a href="/gostd/syscall/netlink_linux.go.html#2500107">rr</a></span><span class="op" id="2500139">.</span><span class="ident" id="2500140"><a href="/gostd/syscall/netlink_linux.go.html#2499591">Header</a></span><span class="op" id="2500146">.</span><span class="ident" id="2500147"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673963">Len</a></span>&nbsp;<span class="op" id="2500151">=</span>&nbsp;<span class="builtintype" id="2500153">uint32</span><span class="op" id="2500159">(</span><span class="ident" id="2500160"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2576209">NLMSG_HDRLEN</a></span>&nbsp;<span class="op" id="2500173">+</span>&nbsp;<span class="ident" id="2500175"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673747">SizeofRtGenmsg</a></span><span class="op" id="2500189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500192"><a href="/gostd/syscall/netlink_linux.go.html#2500107">rr</a></span><span class="op" id="2500194">.</span><span class="ident" id="2500195"><a href="/gostd/syscall/netlink_linux.go.html#2499591">Header</a></span><span class="op" id="2500201">.</span><span class="ident" id="2500202"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673977">Type</a></span>&nbsp;<span class="op" id="2500207">=</span>&nbsp;<span class="builtintype" id="2500209">uint16</span><span class="op" id="2500215">(</span><span class="ident" id="2500216"><a href="/gostd/syscall/netlink_linux.go.html#2500073">proto</a></span><span class="op" id="2500221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500224"><a href="/gostd/syscall/netlink_linux.go.html#2500107">rr</a></span><span class="op" id="2500226">.</span><span class="ident" id="2500227"><a href="/gostd/syscall/netlink_linux.go.html#2499591">Header</a></span><span class="op" id="2500233">.</span><span class="ident" id="2500234"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673991">Flags</a></span>&nbsp;<span class="op" id="2500240">=</span>&nbsp;<span class="ident" id="2500242"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2576537">NLM_F_DUMP</a></span>&nbsp;<span class="op" id="2500253">|</span>&nbsp;<span class="ident" id="2500255"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2576785">NLM_F_REQUEST</a></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500270"><a href="/gostd/syscall/netlink_linux.go.html#2500107">rr</a></span><span class="op" id="2500272">.</span><span class="ident" id="2500273"><a href="/gostd/syscall/netlink_linux.go.html#2499591">Header</a></span><span class="op" id="2500279">.</span><span class="ident" id="2500280"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674005">Seq</a></span>&nbsp;<span class="op" id="2500284">=</span>&nbsp;<span class="builtintype" id="2500286">uint32</span><span class="op" id="2500292">(</span><span class="ident" id="2500293"><a href="/gostd/syscall/netlink_linux.go.html#2500080">seq</a></span><span class="op" id="2500296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500299"><a href="/gostd/syscall/netlink_linux.go.html#2500107">rr</a></span><span class="op" id="2500301">.</span><span class="ident" id="2500302"><a href="/gostd/syscall/netlink_linux.go.html#2499608">Data</a></span><span class="op" id="2500306">.</span><span class="ident" id="2500307"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674114">Family</a></span>&nbsp;<span class="op" id="2500314">=</span>&nbsp;<span class="builtintype" id="2500316">uint8</span><span class="op" id="2500321">(</span><span class="ident" id="2500322"><a href="/gostd/syscall/netlink_linux.go.html#2500085">family</a></span><span class="op" id="2500328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2500331">return</span>&nbsp;<span class="ident" id="2500338"><a href="/gostd/syscall/netlink_linux.go.html#2500107">rr</a></span><span class="op" id="2500340">.</span><span class="ident" id="2500341"><a href="/gostd/syscall/netlink_linux.go.html#2499658">toWireFormat</a></span><span class="op" id="2500353">(</span><span class="op" id="2500354">)</span><br>
<span class="lineno"></span><span class="op" id="2500356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="2500359">//&nbsp;NetlinkRIB&nbsp;returns&nbsp;routing&nbsp;information&nbsp;base,&nbsp;as&nbsp;known&nbsp;as&nbsp;RIB,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2500430">//&nbsp;consists&nbsp;of&nbsp;network&nbsp;facility&nbsp;information,&nbsp;states&nbsp;and&nbsp;parameters.</span><br>
<span class="lineno"></span><span class="keyword" id="2500498">func</span>&nbsp;<span class="ident" id="2500503">NetlinkRIB</span><span class="op" id="2500513">(</span><span class="ident" id="2500514">proto</span><span class="op" id="2500519">,</span>&nbsp;<span class="ident" id="2500521">family</span>&nbsp;<span class="builtintype" id="2500528">int</span><span class="op" id="2500531">)</span>&nbsp;<span class="op" id="2500533">(</span><span class="op" id="2500534">[</span><span class="op" id="2500535">]</span><span class="builtintype" id="2500536">byte</span><span class="op" id="2500540">,</span>&nbsp;<span class="builtintype" id="2500542">error</span><span class="op" id="2500547">)</span>&nbsp;<span class="op" id="2500549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500552">s</span><span class="op" id="2500553">,</span>&nbsp;<span class="ident" id="2500555">err</span>&nbsp;<span class="op" id="2500559">:=</span>&nbsp;<span class="ident" id="2500562"><a href="/gostd/syscall/syscall_unix.go.html#2549902">Socket</a></span><span class="op" id="2500568">(</span><span class="ident" id="2500569"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2551689">AF_NETLINK</a></span><span class="op" id="2500579">,</span>&nbsp;<span class="ident" id="2500581"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2591910">SOCK_RAW</a></span><span class="op" id="2500589">,</span>&nbsp;<span class="ident" id="2500591"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2575682">NETLINK_ROUTE</a></span><span class="op" id="2500604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2500607">if</span>&nbsp;<span class="ident" id="2500610"><a href="/gostd/syscall/netlink_linux.go.html#2500555">err</a></span>&nbsp;<span class="op" id="2500614">!=</span>&nbsp;<span class="builtintype" id="2500617">nil</span>&nbsp;<span class="op" id="2500621">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2500625">return</span>&nbsp;<span class="builtintype" id="2500632">nil</span><span class="op" id="2500635">,</span>&nbsp;<span class="ident" id="2500637"><a href="/gostd/syscall/netlink_linux.go.html#2500555">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2500642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2500645">defer</span>&nbsp;<span class="ident" id="2500651"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2616725">Close</a></span><span class="op" id="2500656">(</span><span class="ident" id="2500657"><a href="/gostd/syscall/netlink_linux.go.html#2500552">s</a></span><span class="op" id="2500658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500661">lsa</span>&nbsp;<span class="op" id="2500665">:=</span>&nbsp;<span class="op" id="2500668">&amp;</span><span class="ident" id="2500669"><a href="/gostd/syscall/syscall_linux.go.html#2519362">SockaddrNetlink</a></span><span class="op" id="2500684">{</span><span class="ident" id="2500685"><a href="/gostd/syscall/syscall_linux.go.html#2519388">Family</a></span><span class="op" id="2500691">:</span>&nbsp;<span class="ident" id="2500693"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2551689">AF_NETLINK</a></span><span class="op" id="2500703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2500706">if</span>&nbsp;<span class="ident" id="2500709">err</span>&nbsp;<span class="op" id="2500713">:=</span>&nbsp;<span class="ident" id="2500716"><a href="/gostd/syscall/syscall_unix.go.html#2547448">Bind</a></span><span class="op" id="2500720">(</span><span class="ident" id="2500721"><a href="/gostd/syscall/netlink_linux.go.html#2500552">s</a></span><span class="op" id="2500722">,</span>&nbsp;<span class="ident" id="2500724"><a href="/gostd/syscall/netlink_linux.go.html#2500661">lsa</a></span><span class="op" id="2500727">)</span><span class="op" id="2500728">;</span>&nbsp;<span class="ident" id="2500730"><a href="/gostd/syscall/netlink_linux.go.html#2500709">err</a></span>&nbsp;<span class="op" id="2500734">!=</span>&nbsp;<span class="builtintype" id="2500737">nil</span>&nbsp;<span class="op" id="2500741">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2500745">return</span>&nbsp;<span class="builtintype" id="2500752">nil</span><span class="op" id="2500755">,</span>&nbsp;<span class="ident" id="2500757"><a href="/gostd/syscall/netlink_linux.go.html#2500709">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2500762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500765">wb</span>&nbsp;<span class="op" id="2500768">:=</span>&nbsp;<span class="ident" id="2500771"><a href="/gostd/syscall/netlink_linux.go.html#2500050">newNetlinkRouteRequest</a></span><span class="op" id="2500793">(</span><span class="ident" id="2500794"><a href="/gostd/syscall/netlink_linux.go.html#2500514">proto</a></span><span class="op" id="2500799">,</span>&nbsp;<span class="num" id="2500801">1</span><span class="op" id="2500802">,</span>&nbsp;<span class="ident" id="2500804"><a href="/gostd/syscall/netlink_linux.go.html#2500521">family</a></span><span class="op" id="2500810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2500813">if</span>&nbsp;<span class="ident" id="2500816">err</span>&nbsp;<span class="op" id="2500820">:=</span>&nbsp;<span class="ident" id="2500823"><a href="/gostd/syscall/syscall_unix.go.html#2548419">Sendto</a></span><span class="op" id="2500829">(</span><span class="ident" id="2500830"><a href="/gostd/syscall/netlink_linux.go.html#2500552">s</a></span><span class="op" id="2500831">,</span>&nbsp;<span class="ident" id="2500833"><a href="/gostd/syscall/netlink_linux.go.html#2500765">wb</a></span><span class="op" id="2500835">,</span>&nbsp;<span class="num" id="2500837">0</span><span class="op" id="2500838">,</span>&nbsp;<span class="ident" id="2500840"><a href="/gostd/syscall/netlink_linux.go.html#2500661">lsa</a></span><span class="op" id="2500843">)</span><span class="op" id="2500844">;</span>&nbsp;<span class="ident" id="2500846"><a href="/gostd/syscall/netlink_linux.go.html#2500816">err</a></span>&nbsp;<span class="op" id="2500850">!=</span>&nbsp;<span class="builtintype" id="2500853">nil</span>&nbsp;<span class="op" id="2500857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2500861">return</span>&nbsp;<span class="builtintype" id="2500868">nil</span><span class="op" id="2500871">,</span>&nbsp;<span class="ident" id="2500873"><a href="/gostd/syscall/netlink_linux.go.html#2500816">err</a></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2500878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2500881">var</span>&nbsp;<span class="ident" id="2500885">tab</span>&nbsp;<span class="op" id="2500889">[</span><span class="op" id="2500890">]</span><span class="builtintype" id="2500891">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500897">rbNew</span>&nbsp;<span class="op" id="2500903">:=</span>&nbsp;<span class="builtinfunc" id="2500906">make</span><span class="op" id="2500910">(</span><span class="op" id="2500911">[</span><span class="op" id="2500912">]</span><span class="builtintype" id="2500913">byte</span><span class="op" id="2500917">,</span>&nbsp;<span class="ident" id="2500919"><a href="/gostd/syscall/syscall_linux_amd64.go.html#2542162">Getpagesize</a></span><span class="op" id="2500930">(</span><span class="op" id="2500931">)</span><span class="op" id="2500932">)</span><br>
<span class="lineno"></span><span class="ident" id="2500934">done</span><span class="op" id="2500938">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2500941">for</span>&nbsp;<span class="op" id="2500945">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500949">rb</span>&nbsp;<span class="op" id="2500952">:=</span>&nbsp;<span class="ident" id="2500955"><a href="/gostd/syscall/netlink_linux.go.html#2500897">rbNew</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2500963">nr</span><span class="op" id="2500965">,</span>&nbsp;<span class="ident" id="2500967">_</span><span class="op" id="2500968">,</span>&nbsp;<span class="ident" id="2500970">err</span>&nbsp;<span class="op" id="2500974">:=</span>&nbsp;<span class="ident" id="2500977"><a href="/gostd/syscall/syscall_unix.go.html#2548121">Recvfrom</a></span><span class="op" id="2500985">(</span><span class="ident" id="2500986"><a href="/gostd/syscall/netlink_linux.go.html#2500552">s</a></span><span class="op" id="2500987">,</span>&nbsp;<span class="ident" id="2500989"><a href="/gostd/syscall/netlink_linux.go.html#2500949">rb</a></span><span class="op" id="2500991">,</span>&nbsp;<span class="num" id="2500993">0</span><span class="op" id="2500994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2500998">if</span>&nbsp;<span class="ident" id="2501001"><a href="/gostd/syscall/netlink_linux.go.html#2500970">err</a></span>&nbsp;<span class="op" id="2501005">!=</span>&nbsp;<span class="builtintype" id="2501008">nil</span>&nbsp;<span class="op" id="2501012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501017">return</span>&nbsp;<span class="builtintype" id="2501024">nil</span><span class="op" id="2501027">,</span>&nbsp;<span class="ident" id="2501029"><a href="/gostd/syscall/netlink_linux.go.html#2500970">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2501035">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501039">if</span>&nbsp;<span class="ident" id="2501042"><a href="/gostd/syscall/netlink_linux.go.html#2500963">nr</a></span>&nbsp;<span class="op" id="2501045">&lt;</span>&nbsp;<span class="ident" id="2501047"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2576209">NLMSG_HDRLEN</a></span>&nbsp;<span class="op" id="2501060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501065">return</span>&nbsp;<span class="builtintype" id="2501072">nil</span><span class="op" id="2501075">,</span>&nbsp;<span class="ident" id="2501077"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2501086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2501090"><a href="/gostd/syscall/netlink_linux.go.html#2500949">rb</a></span>&nbsp;<span class="op" id="2501093">=</span>&nbsp;<span class="ident" id="2501095"><a href="/gostd/syscall/netlink_linux.go.html#2500949">rb</a></span><span class="op" id="2501097">[</span><span class="op" id="2501098">:</span><span class="ident" id="2501099"><a href="/gostd/syscall/netlink_linux.go.html#2500963">nr</a></span><span class="op" id="2501101">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2501105"><a href="/gostd/syscall/netlink_linux.go.html#2500885">tab</a></span>&nbsp;<span class="op" id="2501109">=</span>&nbsp;<span class="builtinfunc" id="2501111">append</span><span class="op" id="2501117">(</span><span class="ident" id="2501118"><a href="/gostd/syscall/netlink_linux.go.html#2500885">tab</a></span><span class="op" id="2501121">,</span>&nbsp;<span class="ident" id="2501123"><a href="/gostd/syscall/netlink_linux.go.html#2500949">rb</a></span><span class="op" id="2501125">...</span><span class="op" id="2501128">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2501132">msgs</span><span class="op" id="2501136">,</span>&nbsp;<span class="ident" id="2501138"><a href="/gostd/syscall/netlink_linux.go.html#2500970">err</a></span>&nbsp;<span class="op" id="2501142">:=</span>&nbsp;<span class="ident" id="2501145"><a href="/gostd/syscall/netlink_linux.go.html#2501883">ParseNetlinkMessage</a></span><span class="op" id="2501164">(</span><span class="ident" id="2501165"><a href="/gostd/syscall/netlink_linux.go.html#2500949">rb</a></span><span class="op" id="2501167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501171">if</span>&nbsp;<span class="ident" id="2501174"><a href="/gostd/syscall/netlink_linux.go.html#2500970">err</a></span>&nbsp;<span class="op" id="2501178">!=</span>&nbsp;<span class="builtintype" id="2501181">nil</span>&nbsp;<span class="op" id="2501185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501190">return</span>&nbsp;<span class="builtintype" id="2501197">nil</span><span class="op" id="2501200">,</span>&nbsp;<span class="ident" id="2501202"><a href="/gostd/syscall/netlink_linux.go.html#2500970">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2501208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501212">for</span>&nbsp;<span class="ident" id="2501216">_</span><span class="op" id="2501217">,</span>&nbsp;<span class="ident" id="2501219">m</span>&nbsp;<span class="op" id="2501221">:=</span>&nbsp;<span class="keyword" id="2501224">range</span>&nbsp;<span class="ident" id="2501230"><a href="/gostd/syscall/netlink_linux.go.html#2501132">msgs</a></span>&nbsp;<span class="op" id="2501235">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2501240">lsa</span><span class="op" id="2501243">,</span>&nbsp;<span class="ident" id="2501245">err</span>&nbsp;<span class="op" id="2501249">:=</span>&nbsp;<span class="ident" id="2501252"><a href="/gostd/syscall/syscall_linux.go.html#2522263">Getsockname</a></span><span class="op" id="2501263">(</span><span class="ident" id="2501264"><a href="/gostd/syscall/netlink_linux.go.html#2500552">s</a></span><span class="op" id="2501265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501270">if</span>&nbsp;<span class="ident" id="2501273"><a href="/gostd/syscall/netlink_linux.go.html#2501245">err</a></span>&nbsp;<span class="op" id="2501277">!=</span>&nbsp;<span class="builtintype" id="2501280">nil</span>&nbsp;<span class="op" id="2501284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501290">return</span>&nbsp;<span class="builtintype" id="2501297">nil</span><span class="op" id="2501300">,</span>&nbsp;<span class="ident" id="2501302"><a href="/gostd/syscall/netlink_linux.go.html#2501245">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2501309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501314">switch</span>&nbsp;<span class="ident" id="2501321">v</span>&nbsp;<span class="op" id="2501323">:=</span>&nbsp;<span class="ident" id="2501326"><a href="/gostd/syscall/netlink_linux.go.html#2501240">lsa</a></span><span class="op" id="2501329">.</span><span class="op" id="2501330">(</span><span class="keyword" id="2501331">type</span><span class="op" id="2501335">)</span>&nbsp;<span class="op" id="2501337">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501342">case</span>&nbsp;<span class="op" id="2501347">*</span><span class="ident" id="2501348"><a href="/gostd/syscall/syscall_linux.go.html#2519362">SockaddrNetlink</a></span><span class="op" id="2501363">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501369">if</span>&nbsp;<span class="ident" id="2501372"><a href="/gostd/syscall/netlink_linux.go.html#2501219">m</a></span><span class="op" id="2501373">.</span><span class="ident" id="2501374"><a href="/gostd/syscall/netlink_linux.go.html#2501713">Header</a></span><span class="op" id="2501380">.</span><span class="ident" id="2501381"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674005">Seq</a></span>&nbsp;<span class="op" id="2501385">!=</span>&nbsp;<span class="num" id="2501388">1</span>&nbsp;<span class="op" id="2501390">||</span>&nbsp;<span class="ident" id="2501393"><a href="/gostd/syscall/netlink_linux.go.html#2501219">m</a></span><span class="op" id="2501394">.</span><span class="ident" id="2501395"><a href="/gostd/syscall/netlink_linux.go.html#2501713">Header</a></span><span class="op" id="2501401">.</span><span class="ident" id="2501402"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674019">Pid</a></span>&nbsp;<span class="op" id="2501406">!=</span>&nbsp;<span class="ident" id="2501409"><a href="/gostd/syscall/netlink_linux.go.html#2501321">v</a></span><span class="op" id="2501410">.</span><span class="ident" id="2501411"><a href="/gostd/syscall/syscall_linux.go.html#2519418">Pid</a></span>&nbsp;<span class="op" id="2501415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501422">return</span>&nbsp;<span class="builtintype" id="2501429">nil</span><span class="op" id="2501432">,</span>&nbsp;<span class="ident" id="2501434"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2501445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501450">default</span><span class="op" id="2501457">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501463">return</span>&nbsp;<span class="builtintype" id="2501470">nil</span><span class="op" id="2501473">,</span>&nbsp;<span class="ident" id="2501475"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2501485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501490">if</span>&nbsp;<span class="ident" id="2501493"><a href="/gostd/syscall/netlink_linux.go.html#2501219">m</a></span><span class="op" id="2501494">.</span><span class="ident" id="2501495"><a href="/gostd/syscall/netlink_linux.go.html#2501713">Header</a></span><span class="op" id="2501501">.</span><span class="ident" id="2501502"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673977">Type</a></span>&nbsp;<span class="op" id="2501507">==</span>&nbsp;<span class="ident" id="2501510"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2576129">NLMSG_DONE</a></span>&nbsp;<span class="op" id="2501521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501527">break</span>&nbsp;<span class="ident" id="2501533"><a href="/gostd/syscall/netlink_linux.go.html#2500934">done</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2501541">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501546">if</span>&nbsp;<span class="ident" id="2501549"><a href="/gostd/syscall/netlink_linux.go.html#2501219">m</a></span><span class="op" id="2501550">.</span><span class="ident" id="2501551"><a href="/gostd/syscall/netlink_linux.go.html#2501713">Header</a></span><span class="op" id="2501557">.</span><span class="ident" id="2501558"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673977">Type</a></span>&nbsp;<span class="op" id="2501563">==</span>&nbsp;<span class="ident" id="2501566"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2576169">NLMSG_ERROR</a></span>&nbsp;<span class="op" id="2501578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501584">return</span>&nbsp;<span class="builtintype" id="2501591">nil</span><span class="op" id="2501594">,</span>&nbsp;<span class="ident" id="2501596"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2501606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2501610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2501613">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501616">return</span>&nbsp;<span class="ident" id="2501623"><a href="/gostd/syscall/netlink_linux.go.html#2500885">tab</a></span><span class="op" id="2501626">,</span>&nbsp;<span class="builtintype" id="2501628">nil</span><br>
<span class="lineno"></span><span class="op" id="2501632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2501635">//&nbsp;NetlinkMessage&nbsp;represents&nbsp;a&nbsp;netlink&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="2501683">type</span>&nbsp;<span class="ident" id="2501688">NetlinkMessage</span>&nbsp;<span class="keyword" id="2501703">struct</span>&nbsp;<span class="op" id="2501710">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2501713">Header</span>&nbsp;<span class="ident" id="2501720"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673944">NlMsghdr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2501730">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2501737">[</span><span class="op" id="2501738">]</span><span class="builtintype" id="2501739">byte</span><br>
<span class="lineno"></span><span class="op" id="2501744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2501747">//&nbsp;ParseNetlinkMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;array&nbsp;of&nbsp;netlink&nbsp;messages&nbsp;and</span><br>
<span class="lineno">115</span><span class="comment" id="2501815">//&nbsp;returns&nbsp;the&nbsp;slice&nbsp;containing&nbsp;the&nbsp;NetlinkMessage&nbsp;structures.</span><br>
<span class="lineno"></span><span class="keyword" id="2501878">func</span>&nbsp;<span class="ident" id="2501883">ParseNetlinkMessage</span><span class="op" id="2501902">(</span><span class="ident" id="2501903">b</span>&nbsp;<span class="op" id="2501905">[</span><span class="op" id="2501906">]</span><span class="builtintype" id="2501907">byte</span><span class="op" id="2501911">)</span>&nbsp;<span class="op" id="2501913">(</span><span class="op" id="2501914">[</span><span class="op" id="2501915">]</span><span class="ident" id="2501916"><a href="/gostd/syscall/netlink_linux.go.html#2501688">NetlinkMessage</a></span><span class="op" id="2501930">,</span>&nbsp;<span class="builtintype" id="2501932">error</span><span class="op" id="2501937">)</span>&nbsp;<span class="op" id="2501939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501942">var</span>&nbsp;<span class="ident" id="2501946">msgs</span>&nbsp;<span class="op" id="2501951">[</span><span class="op" id="2501952">]</span><span class="ident" id="2501953"><a href="/gostd/syscall/netlink_linux.go.html#2501688">NetlinkMessage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2501969">for</span>&nbsp;<span class="builtinfunc" id="2501973">len</span><span class="op" id="2501976">(</span><span class="ident" id="2501977"><a href="/gostd/syscall/netlink_linux.go.html#2501903">b</a></span><span class="op" id="2501978">)</span>&nbsp;<span class="op" id="2501980">&gt;=</span>&nbsp;<span class="ident" id="2501983"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2576209">NLMSG_HDRLEN</a></span>&nbsp;<span class="op" id="2501996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2502000">h</span><span class="op" id="2502001">,</span>&nbsp;<span class="ident" id="2502003">dbuf</span><span class="op" id="2502007">,</span>&nbsp;<span class="ident" id="2502009">dlen</span><span class="op" id="2502013">,</span>&nbsp;<span class="ident" id="2502015">err</span>&nbsp;<span class="op" id="2502019">:=</span>&nbsp;<span class="ident" id="2502022"><a href="/gostd/syscall/netlink_linux.go.html#2502235">netlinkMessageHeaderAndData</a></span><span class="op" id="2502049">(</span><span class="ident" id="2502050"><a href="/gostd/syscall/netlink_linux.go.html#2501903">b</a></span><span class="op" id="2502051">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2502055">if</span>&nbsp;<span class="ident" id="2502058"><a href="/gostd/syscall/netlink_linux.go.html#2502015">err</a></span>&nbsp;<span class="op" id="2502062">!=</span>&nbsp;<span class="builtintype" id="2502065">nil</span>&nbsp;<span class="op" id="2502069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2502074">return</span>&nbsp;<span class="builtintype" id="2502081">nil</span><span class="op" id="2502084">,</span>&nbsp;<span class="ident" id="2502086"><a href="/gostd/syscall/netlink_linux.go.html#2502015">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2502092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2502096">m</span>&nbsp;<span class="op" id="2502098">:=</span>&nbsp;<span class="ident" id="2502101"><a href="/gostd/syscall/netlink_linux.go.html#2501688">NetlinkMessage</a></span><span class="op" id="2502115">{</span><span class="ident" id="2502116"><a href="/gostd/syscall/netlink_linux.go.html#2501713">Header</a></span><span class="op" id="2502122">:</span>&nbsp;<span class="op" id="2502124">*</span><span class="ident" id="2502125"><a href="/gostd/syscall/netlink_linux.go.html#2502000">h</a></span><span class="op" id="2502126">,</span>&nbsp;<span class="ident" id="2502128"><a href="/gostd/syscall/netlink_linux.go.html#2501730">Data</a></span><span class="op" id="2502132">:</span>&nbsp;<span class="ident" id="2502134"><a href="/gostd/syscall/netlink_linux.go.html#2502003">dbuf</a></span><span class="op" id="2502138">[</span><span class="op" id="2502139">:</span><span class="builtintype" id="2502140">int</span><span class="op" id="2502143">(</span><span class="ident" id="2502144"><a href="/gostd/syscall/netlink_linux.go.html#2502000">h</a></span><span class="op" id="2502145">.</span><span class="ident" id="2502146"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673963">Len</a></span><span class="op" id="2502149">)</span><span class="op" id="2502150">-</span><span class="ident" id="2502151"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2576209">NLMSG_HDRLEN</a></span><span class="op" id="2502163">]</span><span class="op" id="2502164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2502168"><a href="/gostd/syscall/netlink_linux.go.html#2501946">msgs</a></span>&nbsp;<span class="op" id="2502173">=</span>&nbsp;<span class="builtinfunc" id="2502175">append</span><span class="op" id="2502181">(</span><span class="ident" id="2502182"><a href="/gostd/syscall/netlink_linux.go.html#2501946">msgs</a></span><span class="op" id="2502186">,</span>&nbsp;<span class="ident" id="2502188"><a href="/gostd/syscall/netlink_linux.go.html#2502096">m</a></span><span class="op" id="2502189">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2502193"><a href="/gostd/syscall/netlink_linux.go.html#2501903">b</a></span>&nbsp;<span class="op" id="2502195">=</span>&nbsp;<span class="ident" id="2502197"><a href="/gostd/syscall/netlink_linux.go.html#2501903">b</a></span><span class="op" id="2502198">[</span><span class="ident" id="2502199"><a href="/gostd/syscall/netlink_linux.go.html#2502009">dlen</a></span><span class="op" id="2502203">:</span><span class="op" id="2502204">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2502207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2502210">return</span>&nbsp;<span class="ident" id="2502217"><a href="/gostd/syscall/netlink_linux.go.html#2501946">msgs</a></span><span class="op" id="2502221">,</span>&nbsp;<span class="builtintype" id="2502223">nil</span><br>
<span class="lineno"></span><span class="op" id="2502227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="2502230">func</span>&nbsp;<span class="ident" id="2502235">netlinkMessageHeaderAndData</span><span class="op" id="2502262">(</span><span class="ident" id="2502263">b</span>&nbsp;<span class="op" id="2502265">[</span><span class="op" id="2502266">]</span><span class="builtintype" id="2502267">byte</span><span class="op" id="2502271">)</span>&nbsp;<span class="op" id="2502273">(</span><span class="op" id="2502274">*</span><span class="ident" id="2502275"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673944">NlMsghdr</a></span><span class="op" id="2502283">,</span>&nbsp;<span class="op" id="2502285">[</span><span class="op" id="2502286">]</span><span class="builtintype" id="2502287">byte</span><span class="op" id="2502291">,</span>&nbsp;<span class="builtintype" id="2502293">int</span><span class="op" id="2502296">,</span>&nbsp;<span class="builtintype" id="2502298">error</span><span class="op" id="2502303">)</span>&nbsp;<span class="op" id="2502305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2502308">h</span>&nbsp;<span class="op" id="2502310">:=</span>&nbsp;<span class="op" id="2502313">(</span><span class="op" id="2502314">*</span><span class="ident" id="2502315"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673944">NlMsghdr</a></span><span class="op" id="2502323">)</span><span class="op" id="2502324">(</span><span class="ident" id="2502325"><a href="/gostd/syscall/netlink_linux.go.html#2499104">unsafe</a></span><span class="op" id="2502331">.</span><span class="ident" id="2502332">Pointer</span><span class="op" id="2502339">(</span><span class="op" id="2502340">&amp;</span><span class="ident" id="2502341"><a href="/gostd/syscall/netlink_linux.go.html#2502263">b</a></span><span class="op" id="2502342">[</span><span class="num" id="2502343">0</span><span class="op" id="2502344">]</span><span class="op" id="2502345">)</span><span class="op" id="2502346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2502349">if</span>&nbsp;<span class="builtintype" id="2502352">int</span><span class="op" id="2502355">(</span><span class="ident" id="2502356"><a href="/gostd/syscall/netlink_linux.go.html#2502308">h</a></span><span class="op" id="2502357">.</span><span class="ident" id="2502358"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673963">Len</a></span><span class="op" id="2502361">)</span>&nbsp;<span class="op" id="2502363">&lt;</span>&nbsp;<span class="ident" id="2502365"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2576209">NLMSG_HDRLEN</a></span>&nbsp;<span class="op" id="2502378">||</span>&nbsp;<span class="builtintype" id="2502381">int</span><span class="op" id="2502384">(</span><span class="ident" id="2502385"><a href="/gostd/syscall/netlink_linux.go.html#2502308">h</a></span><span class="op" id="2502386">.</span><span class="ident" id="2502387"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673963">Len</a></span><span class="op" id="2502390">)</span>&nbsp;<span class="op" id="2502392">&gt;</span>&nbsp;<span class="builtinfunc" id="2502394">len</span><span class="op" id="2502397">(</span><span class="ident" id="2502398"><a href="/gostd/syscall/netlink_linux.go.html#2502263">b</a></span><span class="op" id="2502399">)</span>&nbsp;<span class="op" id="2502401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2502405">return</span>&nbsp;<span class="builtintype" id="2502412">nil</span><span class="op" id="2502415">,</span>&nbsp;<span class="builtintype" id="2502417">nil</span><span class="op" id="2502420">,</span>&nbsp;<span class="num" id="2502422">0</span><span class="op" id="2502423">,</span>&nbsp;<span class="ident" id="2502425"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2502433">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2502436">return</span>&nbsp;<span class="ident" id="2502443"><a href="/gostd/syscall/netlink_linux.go.html#2502308">h</a></span><span class="op" id="2502444">,</span>&nbsp;<span class="ident" id="2502446"><a href="/gostd/syscall/netlink_linux.go.html#2502263">b</a></span><span class="op" id="2502447">[</span><span class="ident" id="2502448"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2576209">NLMSG_HDRLEN</a></span><span class="op" id="2502460">:</span><span class="op" id="2502461">]</span><span class="op" id="2502462">,</span>&nbsp;<span class="ident" id="2502464"><a href="/gostd/syscall/netlink_linux.go.html#2499185">nlmAlignOf</a></span><span class="op" id="2502474">(</span><span class="builtintype" id="2502475">int</span><span class="op" id="2502478">(</span><span class="ident" id="2502479"><a href="/gostd/syscall/netlink_linux.go.html#2502308">h</a></span><span class="op" id="2502480">.</span><span class="ident" id="2502481"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673963">Len</a></span><span class="op" id="2502484">)</span><span class="op" id="2502485">)</span><span class="op" id="2502486">,</span>&nbsp;<span class="builtintype" id="2502488">nil</span><br>
<span class="lineno"></span><span class="op" id="2502492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2502495">//&nbsp;NetlinkRouteAttr&nbsp;represents&nbsp;a&nbsp;netlink&nbsp;route&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="2502553">type</span>&nbsp;<span class="ident" id="2502558">NetlinkRouteAttr</span>&nbsp;<span class="keyword" id="2502575">struct</span>&nbsp;<span class="op" id="2502582">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2502585">Attr</span>&nbsp;&nbsp;<span class="ident" id="2502591"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674185">RtAttr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2502599">Value</span>&nbsp;<span class="op" id="2502605">[</span><span class="op" id="2502606">]</span><span class="builtintype" id="2502607">byte</span><br>
<span class="lineno"></span><span class="op" id="2502612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2502615">//&nbsp;ParseNetlinkRouteAttr&nbsp;parses&nbsp;m&#39;s&nbsp;payload&nbsp;as&nbsp;an&nbsp;array&nbsp;of&nbsp;netlink</span><br>
<span class="lineno">145</span><span class="comment" id="2502682">//&nbsp;route&nbsp;attributes&nbsp;and&nbsp;returns&nbsp;the&nbsp;slice&nbsp;containing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2502739">//&nbsp;NetlinkRouteAttr&nbsp;structures.</span><br>
<span class="lineno"></span><span class="keyword" id="2502771">func</span>&nbsp;<span class="ident" id="2502776">ParseNetlinkRouteAttr</span><span class="op" id="2502797">(</span><span class="ident" id="2502798">m</span>&nbsp;<span class="op" id="2502800">*</span><span class="ident" id="2502801"><a href="/gostd/syscall/netlink_linux.go.html#2501688">NetlinkMessage</a></span><span class="op" id="2502815">)</span>&nbsp;<span class="op" id="2502817">(</span><span class="op" id="2502818">[</span><span class="op" id="2502819">]</span><span class="ident" id="2502820"><a href="/gostd/syscall/netlink_linux.go.html#2502558">NetlinkRouteAttr</a></span><span class="op" id="2502836">,</span>&nbsp;<span class="builtintype" id="2502838">error</span><span class="op" id="2502843">)</span>&nbsp;<span class="op" id="2502845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2502848">var</span>&nbsp;<span class="ident" id="2502852">b</span>&nbsp;<span class="op" id="2502854">[</span><span class="op" id="2502855">]</span><span class="builtintype" id="2502856">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2502862">switch</span>&nbsp;<span class="ident" id="2502869"><a href="/gostd/syscall/netlink_linux.go.html#2502798">m</a></span><span class="op" id="2502870">.</span><span class="ident" id="2502871"><a href="/gostd/syscall/netlink_linux.go.html#2501713">Header</a></span><span class="op" id="2502877">.</span><span class="ident" id="2502878"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673977">Type</a></span>&nbsp;<span class="op" id="2502883">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2502886">case</span>&nbsp;<span class="ident" id="2502891"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2587186">RTM_NEWLINK</a></span><span class="op" id="2502902">,</span>&nbsp;<span class="ident" id="2502904"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2585993">RTM_DELLINK</a></span><span class="op" id="2502915">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2502919"><a href="/gostd/syscall/netlink_linux.go.html#2502852">b</a></span>&nbsp;<span class="op" id="2502921">=</span>&nbsp;<span class="ident" id="2502923"><a href="/gostd/syscall/netlink_linux.go.html#2502798">m</a></span><span class="op" id="2502924">.</span><span class="ident" id="2502925"><a href="/gostd/syscall/netlink_linux.go.html#2501730">Data</a></span><span class="op" id="2502929">[</span><span class="ident" id="2502930"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673828">SizeofIfInfomsg</a></span><span class="op" id="2502945">:</span><span class="op" id="2502946">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2502949">case</span>&nbsp;<span class="ident" id="2502954"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2587104">RTM_NEWADDR</a></span><span class="op" id="2502965">,</span>&nbsp;<span class="ident" id="2502967"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2585911">RTM_DELADDR</a></span><span class="op" id="2502978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2502982"><a href="/gostd/syscall/netlink_linux.go.html#2502852">b</a></span>&nbsp;<span class="op" id="2502984">=</span>&nbsp;<span class="ident" id="2502986"><a href="/gostd/syscall/netlink_linux.go.html#2502798">m</a></span><span class="op" id="2502987">.</span><span class="ident" id="2502988"><a href="/gostd/syscall/netlink_linux.go.html#2501730">Data</a></span><span class="op" id="2502992">[</span><span class="ident" id="2502993"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673856">SizeofIfAddrmsg</a></span><span class="op" id="2503008">:</span><span class="op" id="2503009">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503012">case</span>&nbsp;<span class="ident" id="2503017"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2587432">RTM_NEWROUTE</a></span><span class="op" id="2503029">,</span>&nbsp;<span class="ident" id="2503031"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2586116">RTM_DELROUTE</a></span><span class="op" id="2503043">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2503047"><a href="/gostd/syscall/netlink_linux.go.html#2502852">b</a></span>&nbsp;<span class="op" id="2503049">=</span>&nbsp;<span class="ident" id="2503051"><a href="/gostd/syscall/netlink_linux.go.html#2502798">m</a></span><span class="op" id="2503052">.</span><span class="ident" id="2503053"><a href="/gostd/syscall/netlink_linux.go.html#2501730">Data</a></span><span class="op" id="2503057">[</span><span class="ident" id="2503058"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673883">SizeofRtMsg</a></span><span class="op" id="2503069">:</span><span class="op" id="2503070">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503073">default</span><span class="op" id="2503080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503084">return</span>&nbsp;<span class="builtintype" id="2503091">nil</span><span class="op" id="2503094">,</span>&nbsp;<span class="ident" id="2503096"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2503104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503107">var</span>&nbsp;<span class="ident" id="2503111">attrs</span>&nbsp;<span class="op" id="2503117">[</span><span class="op" id="2503118">]</span><span class="ident" id="2503119"><a href="/gostd/syscall/netlink_linux.go.html#2502558">NetlinkRouteAttr</a></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503137">for</span>&nbsp;<span class="builtinfunc" id="2503141">len</span><span class="op" id="2503144">(</span><span class="ident" id="2503145"><a href="/gostd/syscall/netlink_linux.go.html#2502852">b</a></span><span class="op" id="2503146">)</span>&nbsp;<span class="op" id="2503148">&gt;=</span>&nbsp;<span class="ident" id="2503151"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673801">SizeofRtAttr</a></span>&nbsp;<span class="op" id="2503164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2503168">a</span><span class="op" id="2503169">,</span>&nbsp;<span class="ident" id="2503171">vbuf</span><span class="op" id="2503175">,</span>&nbsp;<span class="ident" id="2503177">alen</span><span class="op" id="2503181">,</span>&nbsp;<span class="ident" id="2503183">err</span>&nbsp;<span class="op" id="2503187">:=</span>&nbsp;<span class="ident" id="2503190"><a href="/gostd/syscall/netlink_linux.go.html#2503406">netlinkRouteAttrAndValue</a></span><span class="op" id="2503214">(</span><span class="ident" id="2503215"><a href="/gostd/syscall/netlink_linux.go.html#2502852">b</a></span><span class="op" id="2503216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503220">if</span>&nbsp;<span class="ident" id="2503223"><a href="/gostd/syscall/netlink_linux.go.html#2503183">err</a></span>&nbsp;<span class="op" id="2503227">!=</span>&nbsp;<span class="builtintype" id="2503230">nil</span>&nbsp;<span class="op" id="2503234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503239">return</span>&nbsp;<span class="builtintype" id="2503246">nil</span><span class="op" id="2503249">,</span>&nbsp;<span class="ident" id="2503251"><a href="/gostd/syscall/netlink_linux.go.html#2503183">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2503257">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2503261">ra</span>&nbsp;<span class="op" id="2503264">:=</span>&nbsp;<span class="ident" id="2503267"><a href="/gostd/syscall/netlink_linux.go.html#2502558">NetlinkRouteAttr</a></span><span class="op" id="2503283">{</span><span class="ident" id="2503284"><a href="/gostd/syscall/netlink_linux.go.html#2502585">Attr</a></span><span class="op" id="2503288">:</span>&nbsp;<span class="op" id="2503290">*</span><span class="ident" id="2503291"><a href="/gostd/syscall/netlink_linux.go.html#2503168">a</a></span><span class="op" id="2503292">,</span>&nbsp;<span class="ident" id="2503294"><a href="/gostd/syscall/netlink_linux.go.html#2502599">Value</a></span><span class="op" id="2503299">:</span>&nbsp;<span class="ident" id="2503301"><a href="/gostd/syscall/netlink_linux.go.html#2503171">vbuf</a></span><span class="op" id="2503305">[</span><span class="op" id="2503306">:</span><span class="builtintype" id="2503307">int</span><span class="op" id="2503310">(</span><span class="ident" id="2503311"><a href="/gostd/syscall/netlink_linux.go.html#2503168">a</a></span><span class="op" id="2503312">.</span><span class="ident" id="2503313"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674202">Len</a></span><span class="op" id="2503316">)</span><span class="op" id="2503317">-</span><span class="ident" id="2503318"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673801">SizeofRtAttr</a></span><span class="op" id="2503330">]</span><span class="op" id="2503331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2503335"><a href="/gostd/syscall/netlink_linux.go.html#2503111">attrs</a></span>&nbsp;<span class="op" id="2503341">=</span>&nbsp;<span class="builtinfunc" id="2503343">append</span><span class="op" id="2503349">(</span><span class="ident" id="2503350"><a href="/gostd/syscall/netlink_linux.go.html#2503111">attrs</a></span><span class="op" id="2503355">,</span>&nbsp;<span class="ident" id="2503357"><a href="/gostd/syscall/netlink_linux.go.html#2503261">ra</a></span><span class="op" id="2503359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2503363"><a href="/gostd/syscall/netlink_linux.go.html#2502852">b</a></span>&nbsp;<span class="op" id="2503365">=</span>&nbsp;<span class="ident" id="2503367"><a href="/gostd/syscall/netlink_linux.go.html#2502852">b</a></span><span class="op" id="2503368">[</span><span class="ident" id="2503369"><a href="/gostd/syscall/netlink_linux.go.html#2503177">alen</a></span><span class="op" id="2503373">:</span><span class="op" id="2503374">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2503377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503380">return</span>&nbsp;<span class="ident" id="2503387"><a href="/gostd/syscall/netlink_linux.go.html#2503111">attrs</a></span><span class="op" id="2503392">,</span>&nbsp;<span class="builtintype" id="2503394">nil</span><br>
<span class="lineno">170</span><span class="op" id="2503398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2503401">func</span>&nbsp;<span class="ident" id="2503406">netlinkRouteAttrAndValue</span><span class="op" id="2503430">(</span><span class="ident" id="2503431">b</span>&nbsp;<span class="op" id="2503433">[</span><span class="op" id="2503434">]</span><span class="builtintype" id="2503435">byte</span><span class="op" id="2503439">)</span>&nbsp;<span class="op" id="2503441">(</span><span class="op" id="2503442">*</span><span class="ident" id="2503443"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674185">RtAttr</a></span><span class="op" id="2503449">,</span>&nbsp;<span class="op" id="2503451">[</span><span class="op" id="2503452">]</span><span class="builtintype" id="2503453">byte</span><span class="op" id="2503457">,</span>&nbsp;<span class="builtintype" id="2503459">int</span><span class="op" id="2503462">,</span>&nbsp;<span class="builtintype" id="2503464">error</span><span class="op" id="2503469">)</span>&nbsp;<span class="op" id="2503471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2503474">a</span>&nbsp;<span class="op" id="2503476">:=</span>&nbsp;<span class="op" id="2503479">(</span><span class="op" id="2503480">*</span><span class="ident" id="2503481"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674185">RtAttr</a></span><span class="op" id="2503487">)</span><span class="op" id="2503488">(</span><span class="ident" id="2503489"><a href="/gostd/syscall/netlink_linux.go.html#2499104">unsafe</a></span><span class="op" id="2503495">.</span><span class="ident" id="2503496">Pointer</span><span class="op" id="2503503">(</span><span class="op" id="2503504">&amp;</span><span class="ident" id="2503505"><a href="/gostd/syscall/netlink_linux.go.html#2503431">b</a></span><span class="op" id="2503506">[</span><span class="num" id="2503507">0</span><span class="op" id="2503508">]</span><span class="op" id="2503509">)</span><span class="op" id="2503510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503513">if</span>&nbsp;<span class="builtintype" id="2503516">int</span><span class="op" id="2503519">(</span><span class="ident" id="2503520"><a href="/gostd/syscall/netlink_linux.go.html#2503474">a</a></span><span class="op" id="2503521">.</span><span class="ident" id="2503522"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674202">Len</a></span><span class="op" id="2503525">)</span>&nbsp;<span class="op" id="2503527">&lt;</span>&nbsp;<span class="ident" id="2503529"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673801">SizeofRtAttr</a></span>&nbsp;<span class="op" id="2503542">||</span>&nbsp;<span class="builtintype" id="2503545">int</span><span class="op" id="2503548">(</span><span class="ident" id="2503549"><a href="/gostd/syscall/netlink_linux.go.html#2503474">a</a></span><span class="op" id="2503550">.</span><span class="ident" id="2503551"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674202">Len</a></span><span class="op" id="2503554">)</span>&nbsp;<span class="op" id="2503556">&gt;</span>&nbsp;<span class="builtinfunc" id="2503558">len</span><span class="op" id="2503561">(</span><span class="ident" id="2503562"><a href="/gostd/syscall/netlink_linux.go.html#2503431">b</a></span><span class="op" id="2503563">)</span>&nbsp;<span class="op" id="2503565">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503569">return</span>&nbsp;<span class="builtintype" id="2503576">nil</span><span class="op" id="2503579">,</span>&nbsp;<span class="builtintype" id="2503581">nil</span><span class="op" id="2503584">,</span>&nbsp;<span class="num" id="2503586">0</span><span class="op" id="2503587">,</span>&nbsp;<span class="ident" id="2503589"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2503597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2503600">return</span>&nbsp;<span class="ident" id="2503607"><a href="/gostd/syscall/netlink_linux.go.html#2503474">a</a></span><span class="op" id="2503608">,</span>&nbsp;<span class="ident" id="2503610"><a href="/gostd/syscall/netlink_linux.go.html#2503431">b</a></span><span class="op" id="2503611">[</span><span class="ident" id="2503612"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2673801">SizeofRtAttr</a></span><span class="op" id="2503624">:</span><span class="op" id="2503625">]</span><span class="op" id="2503626">,</span>&nbsp;<span class="ident" id="2503628"><a href="/gostd/syscall/netlink_linux.go.html#2499359">rtaAlignOf</a></span><span class="op" id="2503638">(</span><span class="builtintype" id="2503639">int</span><span class="op" id="2503642">(</span><span class="ident" id="2503643"><a href="/gostd/syscall/netlink_linux.go.html#2503474">a</a></span><span class="op" id="2503644">.</span><span class="ident" id="2503645"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2674202">Len</a></span><span class="op" id="2503648">)</span><span class="op" id="2503649">)</span><span class="op" id="2503650">,</span>&nbsp;<span class="builtintype" id="2503652">nil</span><br>
<span class="lineno"></span><span class="op" id="2503656">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
