<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2957260">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2957315">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2957369">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2957420">//&nbsp;Parse&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2957437">package</span>&nbsp;<span class="ident" id="2957445">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2957452">import</span>&nbsp;<span class="op" id="2957459">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2957462">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2957471">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2957478">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2957489">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="2957499">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="2957502">var</span>&nbsp;<span class="ident" id="2957506">textFormat</span>&nbsp;<span class="op" id="2957517">=</span>&nbsp;<span class="string" id="2957519">&#34;%s&#34;</span>&nbsp;<span class="comment" id="2957524">//&nbsp;Changed&nbsp;to&nbsp;&#34;%q&#34;&nbsp;in&nbsp;tests&nbsp;for&nbsp;better&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2957580">//&nbsp;A&nbsp;Node&nbsp;is&nbsp;an&nbsp;element&nbsp;in&nbsp;the&nbsp;parse&nbsp;tree.&nbsp;The&nbsp;interface&nbsp;is&nbsp;trivial.</span><br>
<span class="lineno"></span><span class="comment" id="2957649">//&nbsp;The&nbsp;interface&nbsp;contains&nbsp;an&nbsp;unexported&nbsp;method&nbsp;so&nbsp;that&nbsp;only</span><br>
<span class="lineno">20</span><span class="comment" id="2957709">//&nbsp;types&nbsp;local&nbsp;to&nbsp;this&nbsp;package&nbsp;can&nbsp;satisfy&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="2957756">type</span>&nbsp;<span class="ident" id="2957761">Node</span>&nbsp;<span class="keyword" id="2957766">interface</span>&nbsp;<span class="op" id="2957776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2957779">Type</span><span class="op" id="2957783">(</span><span class="op" id="2957784">)</span>&nbsp;<span class="ident" id="2957786">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2957796">String</span><span class="op" id="2957802">(</span><span class="op" id="2957803">)</span>&nbsp;<span class="builtintype" id="2957805">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2957813">//&nbsp;Copy&nbsp;does&nbsp;a&nbsp;deep&nbsp;copy&nbsp;of&nbsp;the&nbsp;Node&nbsp;and&nbsp;all&nbsp;its&nbsp;components.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2957875">//&nbsp;To&nbsp;avoid&nbsp;type&nbsp;assertions,&nbsp;some&nbsp;XxxNodes&nbsp;also&nbsp;have&nbsp;specialized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2957941">//&nbsp;CopyXxx&nbsp;methods&nbsp;that&nbsp;return&nbsp;*XxxNode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2957983">Copy</span><span class="op" id="2957987">(</span><span class="op" id="2957988">)</span>&nbsp;<span class="ident" id="2957990">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2957996">Position</span><span class="op" id="2958004">(</span><span class="op" id="2958005">)</span>&nbsp;<span class="ident" id="2958007">Pos</span>&nbsp;<span class="comment" id="2958011">//&nbsp;byte&nbsp;position&nbsp;of&nbsp;start&nbsp;of&nbsp;node&nbsp;in&nbsp;full&nbsp;original&nbsp;input&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2958076">//&nbsp;tree&nbsp;returns&nbsp;the&nbsp;containing&nbsp;*Tree.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2958115">//&nbsp;It&nbsp;is&nbsp;unexported&nbsp;so&nbsp;all&nbsp;implementations&nbsp;of&nbsp;Node&nbsp;are&nbsp;in&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2958188">tree</span><span class="op" id="2958192">(</span><span class="op" id="2958193">)</span>&nbsp;<span class="op" id="2958195">*</span><span class="ident" id="2958196">Tree</span><br>
<span class="lineno"></span><span class="op" id="2958201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2958204">//&nbsp;NodeType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;parse&nbsp;tree&nbsp;node.</span><br>
<span class="lineno">35</span><span class="keyword" id="2958258">type</span>&nbsp;<span class="ident" id="2958263">NodeType</span>&nbsp;<span class="builtintype" id="2958272">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2958277">//&nbsp;Pos&nbsp;represents&nbsp;a&nbsp;byte&nbsp;position&nbsp;in&nbsp;the&nbsp;original&nbsp;input&nbsp;text&nbsp;from&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2958349">//&nbsp;this&nbsp;template&nbsp;was&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="2958378">type</span>&nbsp;<span class="ident" id="2958383">Pos</span>&nbsp;<span class="builtintype" id="2958387">int</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="2958392">func</span>&nbsp;<span class="op" id="2958397">(</span><span class="ident" id="2958398">p</span>&nbsp;<span class="ident" id="2958400">Pos</span><span class="op" id="2958403">)</span>&nbsp;<span class="ident" id="2958405">Position</span><span class="op" id="2958413">(</span><span class="op" id="2958414">)</span>&nbsp;<span class="ident" id="2958416">Pos</span>&nbsp;<span class="op" id="2958420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2958423">return</span>&nbsp;<span class="ident" id="2958430">p</span><br>
<span class="lineno"></span><span class="op" id="2958432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2958435">//&nbsp;Type&nbsp;returns&nbsp;itself&nbsp;and&nbsp;provides&nbsp;an&nbsp;easy&nbsp;default&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="2958502">//&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;Node.&nbsp;Embedded&nbsp;in&nbsp;all&nbsp;non-trivial&nbsp;Nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="2958565">func</span>&nbsp;<span class="op" id="2958570">(</span><span class="ident" id="2958571">t</span>&nbsp;<span class="ident" id="2958573">NodeType</span><span class="op" id="2958581">)</span>&nbsp;<span class="ident" id="2958583">Type</span><span class="op" id="2958587">(</span><span class="op" id="2958588">)</span>&nbsp;<span class="ident" id="2958590">NodeType</span>&nbsp;<span class="op" id="2958599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2958602">return</span>&nbsp;<span class="ident" id="2958609">t</span><br>
<span class="lineno"></span><span class="op" id="2958611">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="2958614">const</span>&nbsp;<span class="op" id="2958620">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2958623">NodeText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958638">NodeType</span>&nbsp;<span class="op" id="2958647">=</span>&nbsp;<span class="ident" id="2958649">iota</span>&nbsp;<span class="comment" id="2958654">//&nbsp;Plain&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2958670">NodeAction</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2958701">//&nbsp;A&nbsp;non-control&nbsp;action&nbsp;such&nbsp;as&nbsp;a&nbsp;field&nbsp;evaluation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2958754">NodeBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2958785">//&nbsp;A&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2958809">NodeChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2958840">//&nbsp;A&nbsp;sequence&nbsp;of&nbsp;field&nbsp;accesses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2958874">NodeCommand</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2958905">//&nbsp;An&nbsp;element&nbsp;of&nbsp;a&nbsp;pipeline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2958935">NodeDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2958966">//&nbsp;The&nbsp;cursor,&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2958987">nodeElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2959018">//&nbsp;An&nbsp;else&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959057">nodeEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2959088">//&nbsp;An&nbsp;end&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959126">NodeField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2959157">//&nbsp;A&nbsp;field&nbsp;or&nbsp;method&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959185">NodeIdentifier</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2959216">//&nbsp;An&nbsp;identifier;&nbsp;always&nbsp;a&nbsp;function&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959259">NodeIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2959290">//&nbsp;An&nbsp;if&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959308">NodeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2959339">//&nbsp;A&nbsp;list&nbsp;of&nbsp;Nodes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959360">NodeNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2959391">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959420">NodeNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2959451">//&nbsp;A&nbsp;numerical&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959477">NodePipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2959508">//&nbsp;A&nbsp;pipeline&nbsp;of&nbsp;commands.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959536">NodeRange</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2959567">//&nbsp;A&nbsp;range&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959587">NodeString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2959618">//&nbsp;A&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959641">NodeTemplate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2959672">//&nbsp;A&nbsp;template&nbsp;invocation&nbsp;action.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959706">NodeVariable</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2959737">//&nbsp;A&nbsp;$&nbsp;variable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959755">NodeWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2959786">//&nbsp;A&nbsp;with&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="2959804">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2959807">//&nbsp;Nodes.</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2959818">//&nbsp;ListNode&nbsp;holds&nbsp;a&nbsp;sequence&nbsp;of&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="2959857">type</span>&nbsp;<span class="ident" id="2959862">ListNode</span>&nbsp;<span class="keyword" id="2959871">struct</span>&nbsp;<span class="op" id="2959878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959881">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959891">Pos</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959896">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2959902">*</span><span class="ident" id="2959903">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2959909">Nodes</span>&nbsp;<span class="op" id="2959915">[</span><span class="op" id="2959916">]</span><span class="ident" id="2959917">Node</span>&nbsp;<span class="comment" id="2959922">//&nbsp;The&nbsp;element&nbsp;nodes&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="2959961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2959964">func</span>&nbsp;<span class="op" id="2959969">(</span><span class="ident" id="2959970">t</span>&nbsp;<span class="op" id="2959972">*</span><span class="ident" id="2959973">Tree</span><span class="op" id="2959977">)</span>&nbsp;<span class="ident" id="2959979">newList</span><span class="op" id="2959986">(</span><span class="ident" id="2959987">pos</span>&nbsp;<span class="ident" id="2959991">Pos</span><span class="op" id="2959994">)</span>&nbsp;<span class="op" id="2959996">*</span><span class="ident" id="2959997">ListNode</span>&nbsp;<span class="op" id="2960006">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2960009">return</span>&nbsp;<span class="op" id="2960016">&amp;</span><span class="ident" id="2960017">ListNode</span><span class="op" id="2960025">{</span><span class="ident" id="2960026">tr</span><span class="op" id="2960028">:</span>&nbsp;<span class="ident" id="2960030">t</span><span class="op" id="2960031">,</span>&nbsp;<span class="ident" id="2960033">NodeType</span><span class="op" id="2960041">:</span>&nbsp;<span class="ident" id="2960043">NodeList</span><span class="op" id="2960051">,</span>&nbsp;<span class="ident" id="2960053">Pos</span><span class="op" id="2960056">:</span>&nbsp;<span class="ident" id="2960058">pos</span><span class="op" id="2960061">}</span><br>
<span class="lineno"></span><span class="op" id="2960063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2960066">func</span>&nbsp;<span class="op" id="2960071">(</span><span class="ident" id="2960072">l</span>&nbsp;<span class="op" id="2960074">*</span><span class="ident" id="2960075">ListNode</span><span class="op" id="2960083">)</span>&nbsp;<span class="builtinfunc" id="2960085">append</span><span class="op" id="2960091">(</span><span class="ident" id="2960092">n</span>&nbsp;<span class="ident" id="2960094">Node</span><span class="op" id="2960098">)</span>&nbsp;<span class="op" id="2960100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2960103">l</span><span class="op" id="2960104">.</span><span class="ident" id="2960105">Nodes</span>&nbsp;<span class="op" id="2960111">=</span>&nbsp;<span class="builtinfunc" id="2960113">append</span><span class="op" id="2960119">(</span><span class="ident" id="2960120">l</span><span class="op" id="2960121">.</span><span class="ident" id="2960122">Nodes</span><span class="op" id="2960127">,</span>&nbsp;<span class="ident" id="2960129">n</span><span class="op" id="2960130">)</span><br>
<span class="lineno">90</span><span class="op" id="2960132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2960135">func</span>&nbsp;<span class="op" id="2960140">(</span><span class="ident" id="2960141">l</span>&nbsp;<span class="op" id="2960143">*</span><span class="ident" id="2960144">ListNode</span><span class="op" id="2960152">)</span>&nbsp;<span class="ident" id="2960154">tree</span><span class="op" id="2960158">(</span><span class="op" id="2960159">)</span>&nbsp;<span class="op" id="2960161">*</span><span class="ident" id="2960162">Tree</span>&nbsp;<span class="op" id="2960167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2960170">return</span>&nbsp;<span class="ident" id="2960177">l</span><span class="op" id="2960178">.</span><span class="ident" id="2960179">tr</span><br>
<span class="lineno"></span><span class="op" id="2960182">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="2960185">func</span>&nbsp;<span class="op" id="2960190">(</span><span class="ident" id="2960191">l</span>&nbsp;<span class="op" id="2960193">*</span><span class="ident" id="2960194">ListNode</span><span class="op" id="2960202">)</span>&nbsp;<span class="ident" id="2960204">String</span><span class="op" id="2960210">(</span><span class="op" id="2960211">)</span>&nbsp;<span class="builtintype" id="2960213">string</span>&nbsp;<span class="op" id="2960220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2960223">b</span>&nbsp;<span class="op" id="2960225">:=</span>&nbsp;<span class="builtinfunc" id="2960228">new</span><span class="op" id="2960231">(</span><span class="ident" id="2960232">bytes</span><span class="op" id="2960237">.</span><span class="ident" id="2960238">Buffer</span><span class="op" id="2960244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2960247">for</span>&nbsp;<span class="ident" id="2960251">_</span><span class="op" id="2960252">,</span>&nbsp;<span class="ident" id="2960254">n</span>&nbsp;<span class="op" id="2960256">:=</span>&nbsp;<span class="keyword" id="2960259">range</span>&nbsp;<span class="ident" id="2960265">l</span><span class="op" id="2960266">.</span><span class="ident" id="2960267">Nodes</span>&nbsp;<span class="op" id="2960273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2960277">fmt</span><span class="op" id="2960280">.</span><span class="ident" id="2960281">Fprint</span><span class="op" id="2960287">(</span><span class="ident" id="2960288">b</span><span class="op" id="2960289">,</span>&nbsp;<span class="ident" id="2960291">n</span><span class="op" id="2960292">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2960295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2960298">return</span>&nbsp;<span class="ident" id="2960305">b</span><span class="op" id="2960306">.</span><span class="ident" id="2960307">String</span><span class="op" id="2960313">(</span><span class="op" id="2960314">)</span><br>
<span class="lineno"></span><span class="op" id="2960316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2960319">func</span>&nbsp;<span class="op" id="2960324">(</span><span class="ident" id="2960325">l</span>&nbsp;<span class="op" id="2960327">*</span><span class="ident" id="2960328">ListNode</span><span class="op" id="2960336">)</span>&nbsp;<span class="ident" id="2960338">CopyList</span><span class="op" id="2960346">(</span><span class="op" id="2960347">)</span>&nbsp;<span class="op" id="2960349">*</span><span class="ident" id="2960350">ListNode</span>&nbsp;<span class="op" id="2960359">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2960362">if</span>&nbsp;<span class="ident" id="2960365">l</span>&nbsp;<span class="op" id="2960367">==</span>&nbsp;<span class="ident" id="2960370">nil</span>&nbsp;<span class="op" id="2960374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2960378">return</span>&nbsp;<span class="ident" id="2960385">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2960388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2960391">n</span>&nbsp;<span class="op" id="2960393">:=</span>&nbsp;<span class="ident" id="2960396">l</span><span class="op" id="2960397">.</span><span class="ident" id="2960398">tr</span><span class="op" id="2960400">.</span><span class="ident" id="2960401">newList</span><span class="op" id="2960408">(</span><span class="ident" id="2960409">l</span><span class="op" id="2960410">.</span><span class="ident" id="2960411">Pos</span><span class="op" id="2960414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2960417">for</span>&nbsp;<span class="ident" id="2960421">_</span><span class="op" id="2960422">,</span>&nbsp;<span class="ident" id="2960424">elem</span>&nbsp;<span class="op" id="2960429">:=</span>&nbsp;<span class="keyword" id="2960432">range</span>&nbsp;<span class="ident" id="2960438">l</span><span class="op" id="2960439">.</span><span class="ident" id="2960440">Nodes</span>&nbsp;<span class="op" id="2960446">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2960450">n</span><span class="op" id="2960451">.</span><span class="builtinfunc" id="2960452">append</span><span class="op" id="2960458">(</span><span class="ident" id="2960459">elem</span><span class="op" id="2960463">.</span><span class="ident" id="2960464">Copy</span><span class="op" id="2960468">(</span><span class="op" id="2960469">)</span><span class="op" id="2960470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2960473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2960476">return</span>&nbsp;<span class="ident" id="2960483">n</span><br>
<span class="lineno"></span><span class="op" id="2960485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="2960488">func</span>&nbsp;<span class="op" id="2960493">(</span><span class="ident" id="2960494">l</span>&nbsp;<span class="op" id="2960496">*</span><span class="ident" id="2960497">ListNode</span><span class="op" id="2960505">)</span>&nbsp;<span class="ident" id="2960507">Copy</span><span class="op" id="2960511">(</span><span class="op" id="2960512">)</span>&nbsp;<span class="ident" id="2960514">Node</span>&nbsp;<span class="op" id="2960519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2960522">return</span>&nbsp;<span class="ident" id="2960529">l</span><span class="op" id="2960530">.</span><span class="ident" id="2960531">CopyList</span><span class="op" id="2960539">(</span><span class="op" id="2960540">)</span><br>
<span class="lineno"></span><span class="op" id="2960542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2960545">//&nbsp;TextNode&nbsp;holds&nbsp;plain&nbsp;text.</span><br>
<span class="lineno">120</span><span class="keyword" id="2960575">type</span>&nbsp;<span class="ident" id="2960580">TextNode</span>&nbsp;<span class="keyword" id="2960589">struct</span>&nbsp;<span class="op" id="2960596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2960599">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2960609">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2960614">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2960619">*</span><span class="ident" id="2960620">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2960626">Text</span>&nbsp;<span class="op" id="2960631">[</span><span class="op" id="2960632">]</span><span class="builtintype" id="2960633">byte</span>&nbsp;<span class="comment" id="2960638">//&nbsp;The&nbsp;text;&nbsp;may&nbsp;span&nbsp;newlines.</span><br>
<span class="lineno">125</span><span class="op" id="2960670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2960673">func</span>&nbsp;<span class="op" id="2960678">(</span><span class="ident" id="2960679">t</span>&nbsp;<span class="op" id="2960681">*</span><span class="ident" id="2960682">Tree</span><span class="op" id="2960686">)</span>&nbsp;<span class="ident" id="2960688">newText</span><span class="op" id="2960695">(</span><span class="ident" id="2960696">pos</span>&nbsp;<span class="ident" id="2960700">Pos</span><span class="op" id="2960703">,</span>&nbsp;<span class="ident" id="2960705">text</span>&nbsp;<span class="builtintype" id="2960710">string</span><span class="op" id="2960716">)</span>&nbsp;<span class="op" id="2960718">*</span><span class="ident" id="2960719">TextNode</span>&nbsp;<span class="op" id="2960728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2960731">return</span>&nbsp;<span class="op" id="2960738">&amp;</span><span class="ident" id="2960739">TextNode</span><span class="op" id="2960747">{</span><span class="ident" id="2960748">tr</span><span class="op" id="2960750">:</span>&nbsp;<span class="ident" id="2960752">t</span><span class="op" id="2960753">,</span>&nbsp;<span class="ident" id="2960755">NodeType</span><span class="op" id="2960763">:</span>&nbsp;<span class="ident" id="2960765">NodeText</span><span class="op" id="2960773">,</span>&nbsp;<span class="ident" id="2960775">Pos</span><span class="op" id="2960778">:</span>&nbsp;<span class="ident" id="2960780">pos</span><span class="op" id="2960783">,</span>&nbsp;<span class="ident" id="2960785">Text</span><span class="op" id="2960789">:</span>&nbsp;<span class="op" id="2960791">[</span><span class="op" id="2960792">]</span><span class="builtintype" id="2960793">byte</span><span class="op" id="2960797">(</span><span class="ident" id="2960798">text</span><span class="op" id="2960802">)</span><span class="op" id="2960803">}</span><br>
<span class="lineno"></span><span class="op" id="2960805">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="2960808">func</span>&nbsp;<span class="op" id="2960813">(</span><span class="ident" id="2960814">t</span>&nbsp;<span class="op" id="2960816">*</span><span class="ident" id="2960817">TextNode</span><span class="op" id="2960825">)</span>&nbsp;<span class="ident" id="2960827">String</span><span class="op" id="2960833">(</span><span class="op" id="2960834">)</span>&nbsp;<span class="builtintype" id="2960836">string</span>&nbsp;<span class="op" id="2960843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2960846">return</span>&nbsp;<span class="ident" id="2960853">fmt</span><span class="op" id="2960856">.</span><span class="ident" id="2960857">Sprintf</span><span class="op" id="2960864">(</span><span class="ident" id="2960865">textFormat</span><span class="op" id="2960875">,</span>&nbsp;<span class="ident" id="2960877">t</span><span class="op" id="2960878">.</span><span class="ident" id="2960879">Text</span><span class="op" id="2960883">)</span><br>
<span class="lineno"></span><span class="op" id="2960885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="2960888">func</span>&nbsp;<span class="op" id="2960893">(</span><span class="ident" id="2960894">t</span>&nbsp;<span class="op" id="2960896">*</span><span class="ident" id="2960897">TextNode</span><span class="op" id="2960905">)</span>&nbsp;<span class="ident" id="2960907">tree</span><span class="op" id="2960911">(</span><span class="op" id="2960912">)</span>&nbsp;<span class="op" id="2960914">*</span><span class="ident" id="2960915">Tree</span>&nbsp;<span class="op" id="2960920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2960923">return</span>&nbsp;<span class="ident" id="2960930">t</span><span class="op" id="2960931">.</span><span class="ident" id="2960932">tr</span><br>
<span class="lineno"></span><span class="op" id="2960935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2960938">func</span>&nbsp;<span class="op" id="2960943">(</span><span class="ident" id="2960944">t</span>&nbsp;<span class="op" id="2960946">*</span><span class="ident" id="2960947">TextNode</span><span class="op" id="2960955">)</span>&nbsp;<span class="ident" id="2960957">Copy</span><span class="op" id="2960961">(</span><span class="op" id="2960962">)</span>&nbsp;<span class="ident" id="2960964">Node</span>&nbsp;<span class="op" id="2960969">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2960972">return</span>&nbsp;<span class="op" id="2960979">&amp;</span><span class="ident" id="2960980">TextNode</span><span class="op" id="2960988">{</span><span class="ident" id="2960989">tr</span><span class="op" id="2960991">:</span>&nbsp;<span class="ident" id="2960993">t</span><span class="op" id="2960994">.</span><span class="ident" id="2960995">tr</span><span class="op" id="2960997">,</span>&nbsp;<span class="ident" id="2960999">NodeType</span><span class="op" id="2961007">:</span>&nbsp;<span class="ident" id="2961009">NodeText</span><span class="op" id="2961017">,</span>&nbsp;<span class="ident" id="2961019">Pos</span><span class="op" id="2961022">:</span>&nbsp;<span class="ident" id="2961024">t</span><span class="op" id="2961025">.</span><span class="ident" id="2961026">Pos</span><span class="op" id="2961029">,</span>&nbsp;<span class="ident" id="2961031">Text</span><span class="op" id="2961035">:</span>&nbsp;<span class="builtinfunc" id="2961037">append</span><span class="op" id="2961043">(</span><span class="op" id="2961044">[</span><span class="op" id="2961045">]</span><span class="builtintype" id="2961046">byte</span><span class="op" id="2961050">{</span><span class="op" id="2961051">}</span><span class="op" id="2961052">,</span>&nbsp;<span class="ident" id="2961054">t</span><span class="op" id="2961055">.</span><span class="ident" id="2961056">Text</span><span class="op" id="2961060">...</span><span class="op" id="2961063">)</span><span class="op" id="2961064">}</span><br>
<span class="lineno"></span><span class="op" id="2961066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2961069">//&nbsp;PipeNode&nbsp;holds&nbsp;a&nbsp;pipeline&nbsp;with&nbsp;optional&nbsp;declaration</span><br>
<span class="lineno"></span><span class="keyword" id="2961124">type</span>&nbsp;<span class="ident" id="2961129">PipeNode</span>&nbsp;<span class="keyword" id="2961138">struct</span>&nbsp;<span class="op" id="2961145">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2961148">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2961158">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2961163">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2961168">*</span><span class="ident" id="2961169">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2961175">Line</span>&nbsp;<span class="builtintype" id="2961180">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2961196">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2961266">Decl</span>&nbsp;<span class="op" id="2961271">[</span><span class="op" id="2961272">]</span><span class="op" id="2961273">*</span><span class="ident" id="2961274">VariableNode</span>&nbsp;<span class="comment" id="2961287">//&nbsp;Variable&nbsp;declarations&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2961331">Cmds</span>&nbsp;<span class="op" id="2961336">[</span><span class="op" id="2961337">]</span><span class="op" id="2961338">*</span><span class="ident" id="2961339">CommandNode</span>&nbsp;&nbsp;<span class="comment" id="2961352">//&nbsp;The&nbsp;commands&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="2961386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2961389">func</span>&nbsp;<span class="op" id="2961394">(</span><span class="ident" id="2961395">t</span>&nbsp;<span class="op" id="2961397">*</span><span class="ident" id="2961398">Tree</span><span class="op" id="2961402">)</span>&nbsp;<span class="ident" id="2961404">newPipeline</span><span class="op" id="2961415">(</span><span class="ident" id="2961416">pos</span>&nbsp;<span class="ident" id="2961420">Pos</span><span class="op" id="2961423">,</span>&nbsp;<span class="ident" id="2961425">line</span>&nbsp;<span class="builtintype" id="2961430">int</span><span class="op" id="2961433">,</span>&nbsp;<span class="ident" id="2961435">decl</span>&nbsp;<span class="op" id="2961440">[</span><span class="op" id="2961441">]</span><span class="op" id="2961442">*</span><span class="ident" id="2961443">VariableNode</span><span class="op" id="2961455">)</span>&nbsp;<span class="op" id="2961457">*</span><span class="ident" id="2961458">PipeNode</span>&nbsp;<span class="op" id="2961467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2961470">return</span>&nbsp;<span class="op" id="2961477">&amp;</span><span class="ident" id="2961478">PipeNode</span><span class="op" id="2961486">{</span><span class="ident" id="2961487">tr</span><span class="op" id="2961489">:</span>&nbsp;<span class="ident" id="2961491">t</span><span class="op" id="2961492">,</span>&nbsp;<span class="ident" id="2961494">NodeType</span><span class="op" id="2961502">:</span>&nbsp;<span class="ident" id="2961504">NodePipe</span><span class="op" id="2961512">,</span>&nbsp;<span class="ident" id="2961514">Pos</span><span class="op" id="2961517">:</span>&nbsp;<span class="ident" id="2961519">pos</span><span class="op" id="2961522">,</span>&nbsp;<span class="ident" id="2961524">Line</span><span class="op" id="2961528">:</span>&nbsp;<span class="ident" id="2961530">line</span><span class="op" id="2961534">,</span>&nbsp;<span class="ident" id="2961536">Decl</span><span class="op" id="2961540">:</span>&nbsp;<span class="ident" id="2961542">decl</span><span class="op" id="2961546">}</span><br>
<span class="lineno">155</span><span class="op" id="2961548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2961551">func</span>&nbsp;<span class="op" id="2961556">(</span><span class="ident" id="2961557">p</span>&nbsp;<span class="op" id="2961559">*</span><span class="ident" id="2961560">PipeNode</span><span class="op" id="2961568">)</span>&nbsp;<span class="builtinfunc" id="2961570">append</span><span class="op" id="2961576">(</span><span class="ident" id="2961577">command</span>&nbsp;<span class="op" id="2961585">*</span><span class="ident" id="2961586">CommandNode</span><span class="op" id="2961597">)</span>&nbsp;<span class="op" id="2961599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2961602">p</span><span class="op" id="2961603">.</span><span class="ident" id="2961604">Cmds</span>&nbsp;<span class="op" id="2961609">=</span>&nbsp;<span class="builtinfunc" id="2961611">append</span><span class="op" id="2961617">(</span><span class="ident" id="2961618">p</span><span class="op" id="2961619">.</span><span class="ident" id="2961620">Cmds</span><span class="op" id="2961624">,</span>&nbsp;<span class="ident" id="2961626">command</span><span class="op" id="2961633">)</span><br>
<span class="lineno"></span><span class="op" id="2961635">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="2961638">func</span>&nbsp;<span class="op" id="2961643">(</span><span class="ident" id="2961644">p</span>&nbsp;<span class="op" id="2961646">*</span><span class="ident" id="2961647">PipeNode</span><span class="op" id="2961655">)</span>&nbsp;<span class="ident" id="2961657">String</span><span class="op" id="2961663">(</span><span class="op" id="2961664">)</span>&nbsp;<span class="builtintype" id="2961666">string</span>&nbsp;<span class="op" id="2961673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2961676">s</span>&nbsp;<span class="op" id="2961678">:=</span>&nbsp;<span class="string" id="2961681">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2961685">if</span>&nbsp;<span class="builtinfunc" id="2961688">len</span><span class="op" id="2961691">(</span><span class="ident" id="2961692">p</span><span class="op" id="2961693">.</span><span class="ident" id="2961694">Decl</span><span class="op" id="2961698">)</span>&nbsp;<span class="op" id="2961700">&gt;</span>&nbsp;<span class="num" id="2961702">0</span>&nbsp;<span class="op" id="2961704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2961708">for</span>&nbsp;<span class="ident" id="2961712">i</span><span class="op" id="2961713">,</span>&nbsp;<span class="ident" id="2961715">v</span>&nbsp;<span class="op" id="2961717">:=</span>&nbsp;<span class="keyword" id="2961720">range</span>&nbsp;<span class="ident" id="2961726">p</span><span class="op" id="2961727">.</span><span class="ident" id="2961728">Decl</span>&nbsp;<span class="op" id="2961733">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2961738">if</span>&nbsp;<span class="ident" id="2961741">i</span>&nbsp;<span class="op" id="2961743">&gt;</span>&nbsp;<span class="num" id="2961745">0</span>&nbsp;<span class="op" id="2961747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2961753">s</span>&nbsp;<span class="op" id="2961755">+=</span>&nbsp;<span class="string" id="2961758">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2961766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2961771">s</span>&nbsp;<span class="op" id="2961773">+=</span>&nbsp;<span class="ident" id="2961776">v</span><span class="op" id="2961777">.</span><span class="ident" id="2961778">String</span><span class="op" id="2961784">(</span><span class="op" id="2961785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2961789">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2961793">s</span>&nbsp;<span class="op" id="2961795">+=</span>&nbsp;<span class="string" id="2961798">&#34;&nbsp;:=&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2961806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2961809">for</span>&nbsp;<span class="ident" id="2961813">i</span><span class="op" id="2961814">,</span>&nbsp;<span class="ident" id="2961816">c</span>&nbsp;<span class="op" id="2961818">:=</span>&nbsp;<span class="keyword" id="2961821">range</span>&nbsp;<span class="ident" id="2961827">p</span><span class="op" id="2961828">.</span><span class="ident" id="2961829">Cmds</span>&nbsp;<span class="op" id="2961834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2961838">if</span>&nbsp;<span class="ident" id="2961841">i</span>&nbsp;<span class="op" id="2961843">&gt;</span>&nbsp;<span class="num" id="2961845">0</span>&nbsp;<span class="op" id="2961847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2961852">s</span>&nbsp;<span class="op" id="2961854">+=</span>&nbsp;<span class="string" id="2961857">&#34;&nbsp;|&nbsp;&#34;</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2961865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2961869">s</span>&nbsp;<span class="op" id="2961871">+=</span>&nbsp;<span class="ident" id="2961874">c</span><span class="op" id="2961875">.</span><span class="ident" id="2961876">String</span><span class="op" id="2961882">(</span><span class="op" id="2961883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2961886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2961889">return</span>&nbsp;<span class="ident" id="2961896">s</span><br>
<span class="lineno"></span><span class="op" id="2961898">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="2961901">func</span>&nbsp;<span class="op" id="2961906">(</span><span class="ident" id="2961907">p</span>&nbsp;<span class="op" id="2961909">*</span><span class="ident" id="2961910">PipeNode</span><span class="op" id="2961918">)</span>&nbsp;<span class="ident" id="2961920">tree</span><span class="op" id="2961924">(</span><span class="op" id="2961925">)</span>&nbsp;<span class="op" id="2961927">*</span><span class="ident" id="2961928">Tree</span>&nbsp;<span class="op" id="2961933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2961936">return</span>&nbsp;<span class="ident" id="2961943">p</span><span class="op" id="2961944">.</span><span class="ident" id="2961945">tr</span><br>
<span class="lineno"></span><span class="op" id="2961948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="2961951">func</span>&nbsp;<span class="op" id="2961956">(</span><span class="ident" id="2961957">p</span>&nbsp;<span class="op" id="2961959">*</span><span class="ident" id="2961960">PipeNode</span><span class="op" id="2961968">)</span>&nbsp;<span class="ident" id="2961970">CopyPipe</span><span class="op" id="2961978">(</span><span class="op" id="2961979">)</span>&nbsp;<span class="op" id="2961981">*</span><span class="ident" id="2961982">PipeNode</span>&nbsp;<span class="op" id="2961991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2961994">if</span>&nbsp;<span class="ident" id="2961997">p</span>&nbsp;<span class="op" id="2961999">==</span>&nbsp;<span class="ident" id="2962002">nil</span>&nbsp;<span class="op" id="2962006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2962010">return</span>&nbsp;<span class="ident" id="2962017">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2962020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2962023">var</span>&nbsp;<span class="ident" id="2962027">decl</span>&nbsp;<span class="op" id="2962032">[</span><span class="op" id="2962033">]</span><span class="op" id="2962034">*</span><span class="ident" id="2962035">VariableNode</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2962049">for</span>&nbsp;<span class="ident" id="2962053">_</span><span class="op" id="2962054">,</span>&nbsp;<span class="ident" id="2962056">d</span>&nbsp;<span class="op" id="2962058">:=</span>&nbsp;<span class="keyword" id="2962061">range</span>&nbsp;<span class="ident" id="2962067">p</span><span class="op" id="2962068">.</span><span class="ident" id="2962069">Decl</span>&nbsp;<span class="op" id="2962074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2962078">decl</span>&nbsp;<span class="op" id="2962083">=</span>&nbsp;<span class="builtinfunc" id="2962085">append</span><span class="op" id="2962091">(</span><span class="ident" id="2962092">decl</span><span class="op" id="2962096">,</span>&nbsp;<span class="ident" id="2962098">d</span><span class="op" id="2962099">.</span><span class="ident" id="2962100">Copy</span><span class="op" id="2962104">(</span><span class="op" id="2962105">)</span><span class="op" id="2962106">.</span><span class="op" id="2962107">(</span><span class="op" id="2962108">*</span><span class="ident" id="2962109">VariableNode</span><span class="op" id="2962121">)</span><span class="op" id="2962122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2962125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2962128">n</span>&nbsp;<span class="op" id="2962130">:=</span>&nbsp;<span class="ident" id="2962133">p</span><span class="op" id="2962134">.</span><span class="ident" id="2962135">tr</span><span class="op" id="2962137">.</span><span class="ident" id="2962138">newPipeline</span><span class="op" id="2962149">(</span><span class="ident" id="2962150">p</span><span class="op" id="2962151">.</span><span class="ident" id="2962152">Pos</span><span class="op" id="2962155">,</span>&nbsp;<span class="ident" id="2962157">p</span><span class="op" id="2962158">.</span><span class="ident" id="2962159">Line</span><span class="op" id="2962163">,</span>&nbsp;<span class="ident" id="2962165">decl</span><span class="op" id="2962169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2962172">for</span>&nbsp;<span class="ident" id="2962176">_</span><span class="op" id="2962177">,</span>&nbsp;<span class="ident" id="2962179">c</span>&nbsp;<span class="op" id="2962181">:=</span>&nbsp;<span class="keyword" id="2962184">range</span>&nbsp;<span class="ident" id="2962190">p</span><span class="op" id="2962191">.</span><span class="ident" id="2962192">Cmds</span>&nbsp;<span class="op" id="2962197">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2962201">n</span><span class="op" id="2962202">.</span><span class="builtinfunc" id="2962203">append</span><span class="op" id="2962209">(</span><span class="ident" id="2962210">c</span><span class="op" id="2962211">.</span><span class="ident" id="2962212">Copy</span><span class="op" id="2962216">(</span><span class="op" id="2962217">)</span><span class="op" id="2962218">.</span><span class="op" id="2962219">(</span><span class="op" id="2962220">*</span><span class="ident" id="2962221">CommandNode</span><span class="op" id="2962232">)</span><span class="op" id="2962233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2962236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2962239">return</span>&nbsp;<span class="ident" id="2962246">n</span><br>
<span class="lineno"></span><span class="op" id="2962248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="2962251">func</span>&nbsp;<span class="op" id="2962256">(</span><span class="ident" id="2962257">p</span>&nbsp;<span class="op" id="2962259">*</span><span class="ident" id="2962260">PipeNode</span><span class="op" id="2962268">)</span>&nbsp;<span class="ident" id="2962270">Copy</span><span class="op" id="2962274">(</span><span class="op" id="2962275">)</span>&nbsp;<span class="ident" id="2962277">Node</span>&nbsp;<span class="op" id="2962282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2962285">return</span>&nbsp;<span class="ident" id="2962292">p</span><span class="op" id="2962293">.</span><span class="ident" id="2962294">CopyPipe</span><span class="op" id="2962302">(</span><span class="op" id="2962303">)</span><br>
<span class="lineno"></span><span class="op" id="2962305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2962308">//&nbsp;ActionNode&nbsp;holds&nbsp;an&nbsp;action&nbsp;(something&nbsp;bounded&nbsp;by&nbsp;delimiters).</span><br>
<span class="lineno">205</span><span class="comment" id="2962373">//&nbsp;Control&nbsp;actions&nbsp;have&nbsp;their&nbsp;own&nbsp;nodes;&nbsp;ActionNode&nbsp;represents&nbsp;simple</span><br>
<span class="lineno"></span><span class="comment" id="2962443">//&nbsp;ones&nbsp;such&nbsp;as&nbsp;field&nbsp;evaluations&nbsp;and&nbsp;parenthesized&nbsp;pipelines.</span><br>
<span class="lineno"></span><span class="keyword" id="2962506">type</span>&nbsp;<span class="ident" id="2962511">ActionNode</span>&nbsp;<span class="keyword" id="2962522">struct</span>&nbsp;<span class="op" id="2962529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2962532">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2962542">Pos</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2962547">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2962552">*</span><span class="ident" id="2962553">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2962559">Line</span>&nbsp;<span class="builtintype" id="2962564">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2962574">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2962644">Pipe</span>&nbsp;<span class="op" id="2962649">*</span><span class="ident" id="2962650">PipeNode</span>&nbsp;<span class="comment" id="2962659">//&nbsp;The&nbsp;pipeline&nbsp;in&nbsp;the&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="2962690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="2962693">func</span>&nbsp;<span class="op" id="2962698">(</span><span class="ident" id="2962699">t</span>&nbsp;<span class="op" id="2962701">*</span><span class="ident" id="2962702">Tree</span><span class="op" id="2962706">)</span>&nbsp;<span class="ident" id="2962708">newAction</span><span class="op" id="2962717">(</span><span class="ident" id="2962718">pos</span>&nbsp;<span class="ident" id="2962722">Pos</span><span class="op" id="2962725">,</span>&nbsp;<span class="ident" id="2962727">line</span>&nbsp;<span class="builtintype" id="2962732">int</span><span class="op" id="2962735">,</span>&nbsp;<span class="ident" id="2962737">pipe</span>&nbsp;<span class="op" id="2962742">*</span><span class="ident" id="2962743">PipeNode</span><span class="op" id="2962751">)</span>&nbsp;<span class="op" id="2962753">*</span><span class="ident" id="2962754">ActionNode</span>&nbsp;<span class="op" id="2962765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2962768">return</span>&nbsp;<span class="op" id="2962775">&amp;</span><span class="ident" id="2962776">ActionNode</span><span class="op" id="2962786">{</span><span class="ident" id="2962787">tr</span><span class="op" id="2962789">:</span>&nbsp;<span class="ident" id="2962791">t</span><span class="op" id="2962792">,</span>&nbsp;<span class="ident" id="2962794">NodeType</span><span class="op" id="2962802">:</span>&nbsp;<span class="ident" id="2962804">NodeAction</span><span class="op" id="2962814">,</span>&nbsp;<span class="ident" id="2962816">Pos</span><span class="op" id="2962819">:</span>&nbsp;<span class="ident" id="2962821">pos</span><span class="op" id="2962824">,</span>&nbsp;<span class="ident" id="2962826">Line</span><span class="op" id="2962830">:</span>&nbsp;<span class="ident" id="2962832">line</span><span class="op" id="2962836">,</span>&nbsp;<span class="ident" id="2962838">Pipe</span><span class="op" id="2962842">:</span>&nbsp;<span class="ident" id="2962844">pipe</span><span class="op" id="2962848">}</span><br>
<span class="lineno"></span><span class="op" id="2962850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2962853">func</span>&nbsp;<span class="op" id="2962858">(</span><span class="ident" id="2962859">a</span>&nbsp;<span class="op" id="2962861">*</span><span class="ident" id="2962862">ActionNode</span><span class="op" id="2962872">)</span>&nbsp;<span class="ident" id="2962874">String</span><span class="op" id="2962880">(</span><span class="op" id="2962881">)</span>&nbsp;<span class="builtintype" id="2962883">string</span>&nbsp;<span class="op" id="2962890">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2962893">return</span>&nbsp;<span class="ident" id="2962900">fmt</span><span class="op" id="2962903">.</span><span class="ident" id="2962904">Sprintf</span><span class="op" id="2962911">(</span><span class="string" id="2962912">&#34;{{%s}}&#34;</span><span class="op" id="2962920">,</span>&nbsp;<span class="ident" id="2962922">a</span><span class="op" id="2962923">.</span><span class="ident" id="2962924">Pipe</span><span class="op" id="2962928">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="2962931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2962934">func</span>&nbsp;<span class="op" id="2962939">(</span><span class="ident" id="2962940">a</span>&nbsp;<span class="op" id="2962942">*</span><span class="ident" id="2962943">ActionNode</span><span class="op" id="2962953">)</span>&nbsp;<span class="ident" id="2962955">tree</span><span class="op" id="2962959">(</span><span class="op" id="2962960">)</span>&nbsp;<span class="op" id="2962962">*</span><span class="ident" id="2962963">Tree</span>&nbsp;<span class="op" id="2962968">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2962971">return</span>&nbsp;<span class="ident" id="2962978">a</span><span class="op" id="2962979">.</span><span class="ident" id="2962980">tr</span><br>
<span class="lineno"></span><span class="op" id="2962983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2962986">func</span>&nbsp;<span class="op" id="2962991">(</span><span class="ident" id="2962992">a</span>&nbsp;<span class="op" id="2962994">*</span><span class="ident" id="2962995">ActionNode</span><span class="op" id="2963005">)</span>&nbsp;<span class="ident" id="2963007">Copy</span><span class="op" id="2963011">(</span><span class="op" id="2963012">)</span>&nbsp;<span class="ident" id="2963014">Node</span>&nbsp;<span class="op" id="2963019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2963022">return</span>&nbsp;<span class="ident" id="2963029">a</span><span class="op" id="2963030">.</span><span class="ident" id="2963031">tr</span><span class="op" id="2963033">.</span><span class="ident" id="2963034">newAction</span><span class="op" id="2963043">(</span><span class="ident" id="2963044">a</span><span class="op" id="2963045">.</span><span class="ident" id="2963046">Pos</span><span class="op" id="2963049">,</span>&nbsp;<span class="ident" id="2963051">a</span><span class="op" id="2963052">.</span><span class="ident" id="2963053">Line</span><span class="op" id="2963057">,</span>&nbsp;<span class="ident" id="2963059">a</span><span class="op" id="2963060">.</span><span class="ident" id="2963061">Pipe</span><span class="op" id="2963065">.</span><span class="ident" id="2963066">CopyPipe</span><span class="op" id="2963074">(</span><span class="op" id="2963075">)</span><span class="op" id="2963076">)</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="op" id="2963079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2963082">//&nbsp;CommandNode&nbsp;holds&nbsp;a&nbsp;command&nbsp;(a&nbsp;pipeline&nbsp;inside&nbsp;an&nbsp;evaluating&nbsp;action).</span><br>
<span class="lineno"></span><span class="keyword" id="2963155">type</span>&nbsp;<span class="ident" id="2963160">CommandNode</span>&nbsp;<span class="keyword" id="2963172">struct</span>&nbsp;<span class="op" id="2963179">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2963182">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2963192">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2963197">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2963202">*</span><span class="ident" id="2963203">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2963209">Args</span>&nbsp;<span class="op" id="2963214">[</span><span class="op" id="2963215">]</span><span class="ident" id="2963216">Node</span>&nbsp;<span class="comment" id="2963221">//&nbsp;Arguments&nbsp;in&nbsp;lexical&nbsp;order:&nbsp;Identifier,&nbsp;field,&nbsp;or&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="2963284">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="2963287">func</span>&nbsp;<span class="op" id="2963292">(</span><span class="ident" id="2963293">t</span>&nbsp;<span class="op" id="2963295">*</span><span class="ident" id="2963296">Tree</span><span class="op" id="2963300">)</span>&nbsp;<span class="ident" id="2963302">newCommand</span><span class="op" id="2963312">(</span><span class="ident" id="2963313">pos</span>&nbsp;<span class="ident" id="2963317">Pos</span><span class="op" id="2963320">)</span>&nbsp;<span class="op" id="2963322">*</span><span class="ident" id="2963323">CommandNode</span>&nbsp;<span class="op" id="2963335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2963338">return</span>&nbsp;<span class="op" id="2963345">&amp;</span><span class="ident" id="2963346">CommandNode</span><span class="op" id="2963357">{</span><span class="ident" id="2963358">tr</span><span class="op" id="2963360">:</span>&nbsp;<span class="ident" id="2963362">t</span><span class="op" id="2963363">,</span>&nbsp;<span class="ident" id="2963365">NodeType</span><span class="op" id="2963373">:</span>&nbsp;<span class="ident" id="2963375">NodeCommand</span><span class="op" id="2963386">,</span>&nbsp;<span class="ident" id="2963388">Pos</span><span class="op" id="2963391">:</span>&nbsp;<span class="ident" id="2963393">pos</span><span class="op" id="2963396">}</span><br>
<span class="lineno"></span><span class="op" id="2963398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="keyword" id="2963401">func</span>&nbsp;<span class="op" id="2963406">(</span><span class="ident" id="2963407">c</span>&nbsp;<span class="op" id="2963409">*</span><span class="ident" id="2963410">CommandNode</span><span class="op" id="2963421">)</span>&nbsp;<span class="builtinfunc" id="2963423">append</span><span class="op" id="2963429">(</span><span class="ident" id="2963430">arg</span>&nbsp;<span class="ident" id="2963434">Node</span><span class="op" id="2963438">)</span>&nbsp;<span class="op" id="2963440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2963443">c</span><span class="op" id="2963444">.</span><span class="ident" id="2963445">Args</span>&nbsp;<span class="op" id="2963450">=</span>&nbsp;<span class="builtinfunc" id="2963452">append</span><span class="op" id="2963458">(</span><span class="ident" id="2963459">c</span><span class="op" id="2963460">.</span><span class="ident" id="2963461">Args</span><span class="op" id="2963465">,</span>&nbsp;<span class="ident" id="2963467">arg</span><span class="op" id="2963470">)</span><br>
<span class="lineno"></span><span class="op" id="2963472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2963475">func</span>&nbsp;<span class="op" id="2963480">(</span><span class="ident" id="2963481">c</span>&nbsp;<span class="op" id="2963483">*</span><span class="ident" id="2963484">CommandNode</span><span class="op" id="2963495">)</span>&nbsp;<span class="ident" id="2963497">String</span><span class="op" id="2963503">(</span><span class="op" id="2963504">)</span>&nbsp;<span class="builtintype" id="2963506">string</span>&nbsp;<span class="op" id="2963513">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2963516">s</span>&nbsp;<span class="op" id="2963518">:=</span>&nbsp;<span class="string" id="2963521">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2963525">for</span>&nbsp;<span class="ident" id="2963529">i</span><span class="op" id="2963530">,</span>&nbsp;<span class="ident" id="2963532">arg</span>&nbsp;<span class="op" id="2963536">:=</span>&nbsp;<span class="keyword" id="2963539">range</span>&nbsp;<span class="ident" id="2963545">c</span><span class="op" id="2963546">.</span><span class="ident" id="2963547">Args</span>&nbsp;<span class="op" id="2963552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2963556">if</span>&nbsp;<span class="ident" id="2963559">i</span>&nbsp;<span class="op" id="2963561">&gt;</span>&nbsp;<span class="num" id="2963563">0</span>&nbsp;<span class="op" id="2963565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2963570">s</span>&nbsp;<span class="op" id="2963572">+=</span>&nbsp;<span class="string" id="2963575">&#34;&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2963581">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2963585">if</span>&nbsp;<span class="ident" id="2963588">arg</span><span class="op" id="2963591">,</span>&nbsp;<span class="ident" id="2963593">ok</span>&nbsp;<span class="op" id="2963596">:=</span>&nbsp;<span class="ident" id="2963599">arg</span><span class="op" id="2963602">.</span><span class="op" id="2963603">(</span><span class="op" id="2963604">*</span><span class="ident" id="2963605">PipeNode</span><span class="op" id="2963613">)</span><span class="op" id="2963614">;</span>&nbsp;<span class="ident" id="2963616">ok</span>&nbsp;<span class="op" id="2963619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2963624">s</span>&nbsp;<span class="op" id="2963626">+=</span>&nbsp;<span class="string" id="2963629">&#34;(&#34;</span>&nbsp;<span class="op" id="2963633">+</span>&nbsp;<span class="ident" id="2963635">arg</span><span class="op" id="2963638">.</span><span class="ident" id="2963639">String</span><span class="op" id="2963645">(</span><span class="op" id="2963646">)</span>&nbsp;<span class="op" id="2963648">+</span>&nbsp;<span class="string" id="2963650">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2963657">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2963668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2963672">s</span>&nbsp;<span class="op" id="2963674">+=</span>&nbsp;<span class="ident" id="2963677">arg</span><span class="op" id="2963680">.</span><span class="ident" id="2963681">String</span><span class="op" id="2963687">(</span><span class="op" id="2963688">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2963691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2963694">return</span>&nbsp;<span class="ident" id="2963701">s</span><br>
<span class="lineno"></span><span class="op" id="2963703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2963706">func</span>&nbsp;<span class="op" id="2963711">(</span><span class="ident" id="2963712">c</span>&nbsp;<span class="op" id="2963714">*</span><span class="ident" id="2963715">CommandNode</span><span class="op" id="2963726">)</span>&nbsp;<span class="ident" id="2963728">tree</span><span class="op" id="2963732">(</span><span class="op" id="2963733">)</span>&nbsp;<span class="op" id="2963735">*</span><span class="ident" id="2963736">Tree</span>&nbsp;<span class="op" id="2963741">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2963744">return</span>&nbsp;<span class="ident" id="2963751">c</span><span class="op" id="2963752">.</span><span class="ident" id="2963753">tr</span><br>
<span class="lineno"></span><span class="op" id="2963756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2963759">func</span>&nbsp;<span class="op" id="2963764">(</span><span class="ident" id="2963765">c</span>&nbsp;<span class="op" id="2963767">*</span><span class="ident" id="2963768">CommandNode</span><span class="op" id="2963779">)</span>&nbsp;<span class="ident" id="2963781">Copy</span><span class="op" id="2963785">(</span><span class="op" id="2963786">)</span>&nbsp;<span class="ident" id="2963788">Node</span>&nbsp;<span class="op" id="2963793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2963796">if</span>&nbsp;<span class="ident" id="2963799">c</span>&nbsp;<span class="op" id="2963801">==</span>&nbsp;<span class="ident" id="2963804">nil</span>&nbsp;<span class="op" id="2963808">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2963812">return</span>&nbsp;<span class="ident" id="2963819">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2963822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2963825">n</span>&nbsp;<span class="op" id="2963827">:=</span>&nbsp;<span class="ident" id="2963830">c</span><span class="op" id="2963831">.</span><span class="ident" id="2963832">tr</span><span class="op" id="2963834">.</span><span class="ident" id="2963835">newCommand</span><span class="op" id="2963845">(</span><span class="ident" id="2963846">c</span><span class="op" id="2963847">.</span><span class="ident" id="2963848">Pos</span><span class="op" id="2963851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2963854">for</span>&nbsp;<span class="ident" id="2963858">_</span><span class="op" id="2963859">,</span>&nbsp;<span class="ident" id="2963861">c</span>&nbsp;<span class="op" id="2963863">:=</span>&nbsp;<span class="keyword" id="2963866">range</span>&nbsp;<span class="ident" id="2963872">c</span><span class="op" id="2963873">.</span><span class="ident" id="2963874">Args</span>&nbsp;<span class="op" id="2963879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2963883">n</span><span class="op" id="2963884">.</span><span class="builtinfunc" id="2963885">append</span><span class="op" id="2963891">(</span><span class="ident" id="2963892">c</span><span class="op" id="2963893">.</span><span class="ident" id="2963894">Copy</span><span class="op" id="2963898">(</span><span class="op" id="2963899">)</span><span class="op" id="2963900">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2963903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2963906">return</span>&nbsp;<span class="ident" id="2963913">n</span><br>
<span class="lineno"></span><span class="op" id="2963915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2963918">//&nbsp;IdentifierNode&nbsp;holds&nbsp;an&nbsp;identifier.</span><br>
<span class="lineno">280</span><span class="keyword" id="2963957">type</span>&nbsp;<span class="ident" id="2963962">IdentifierNode</span>&nbsp;<span class="keyword" id="2963977">struct</span>&nbsp;<span class="op" id="2963984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2963987">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2963997">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2964002">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2964008">*</span><span class="ident" id="2964009">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2964015">Ident</span>&nbsp;<span class="builtintype" id="2964021">string</span>&nbsp;<span class="comment" id="2964028">//&nbsp;The&nbsp;identifier&#39;s&nbsp;name.</span><br>
<span class="lineno">285</span><span class="op" id="2964054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2964057">//&nbsp;NewIdentifier&nbsp;returns&nbsp;a&nbsp;new&nbsp;IdentifierNode&nbsp;with&nbsp;the&nbsp;given&nbsp;identifier&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="2964135">func</span>&nbsp;<span class="ident" id="2964140">NewIdentifier</span><span class="op" id="2964153">(</span><span class="ident" id="2964154">ident</span>&nbsp;<span class="builtintype" id="2964160">string</span><span class="op" id="2964166">)</span>&nbsp;<span class="op" id="2964168">*</span><span class="ident" id="2964169">IdentifierNode</span>&nbsp;<span class="op" id="2964184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2964187">return</span>&nbsp;<span class="op" id="2964194">&amp;</span><span class="ident" id="2964195">IdentifierNode</span><span class="op" id="2964209">{</span><span class="ident" id="2964210">NodeType</span><span class="op" id="2964218">:</span>&nbsp;<span class="ident" id="2964220">NodeIdentifier</span><span class="op" id="2964234">,</span>&nbsp;<span class="ident" id="2964236">Ident</span><span class="op" id="2964241">:</span>&nbsp;<span class="ident" id="2964243">ident</span><span class="op" id="2964248">}</span><br>
<span class="lineno">290</span><span class="op" id="2964250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2964253">//&nbsp;SetPos&nbsp;sets&nbsp;the&nbsp;position.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="2964349">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="2964377">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno">295</span><span class="keyword" id="2964399">func</span>&nbsp;<span class="op" id="2964404">(</span><span class="ident" id="2964405">i</span>&nbsp;<span class="op" id="2964407">*</span><span class="ident" id="2964408">IdentifierNode</span><span class="op" id="2964422">)</span>&nbsp;<span class="ident" id="2964424">SetPos</span><span class="op" id="2964430">(</span><span class="ident" id="2964431">pos</span>&nbsp;<span class="ident" id="2964435">Pos</span><span class="op" id="2964438">)</span>&nbsp;<span class="op" id="2964440">*</span><span class="ident" id="2964441">IdentifierNode</span>&nbsp;<span class="op" id="2964456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2964459">i</span><span class="op" id="2964460">.</span><span class="ident" id="2964461">Pos</span>&nbsp;<span class="op" id="2964465">=</span>&nbsp;<span class="ident" id="2964467">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2964472">return</span>&nbsp;<span class="ident" id="2964479">i</span><br>
<span class="lineno"></span><span class="op" id="2964481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="2964484">//&nbsp;SetTree&nbsp;sets&nbsp;the&nbsp;parent&nbsp;tree&nbsp;for&nbsp;the&nbsp;node.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="2964597">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="2964625">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno"></span><span class="keyword" id="2964647">func</span>&nbsp;<span class="op" id="2964652">(</span><span class="ident" id="2964653">i</span>&nbsp;<span class="op" id="2964655">*</span><span class="ident" id="2964656">IdentifierNode</span><span class="op" id="2964670">)</span>&nbsp;<span class="ident" id="2964672">SetTree</span><span class="op" id="2964679">(</span><span class="ident" id="2964680">t</span>&nbsp;<span class="op" id="2964682">*</span><span class="ident" id="2964683">Tree</span><span class="op" id="2964687">)</span>&nbsp;<span class="op" id="2964689">*</span><span class="ident" id="2964690">IdentifierNode</span>&nbsp;<span class="op" id="2964705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2964708">i</span><span class="op" id="2964709">.</span><span class="ident" id="2964710">tr</span>&nbsp;<span class="op" id="2964713">=</span>&nbsp;<span class="ident" id="2964715">t</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2964718">return</span>&nbsp;<span class="ident" id="2964725">i</span><br>
<span class="lineno"></span><span class="op" id="2964727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2964730">func</span>&nbsp;<span class="op" id="2964735">(</span><span class="ident" id="2964736">i</span>&nbsp;<span class="op" id="2964738">*</span><span class="ident" id="2964739">IdentifierNode</span><span class="op" id="2964753">)</span>&nbsp;<span class="ident" id="2964755">String</span><span class="op" id="2964761">(</span><span class="op" id="2964762">)</span>&nbsp;<span class="builtintype" id="2964764">string</span>&nbsp;<span class="op" id="2964771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2964774">return</span>&nbsp;<span class="ident" id="2964781">i</span><span class="op" id="2964782">.</span><span class="ident" id="2964783">Ident</span><br>
<span class="lineno">310</span><span class="op" id="2964789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2964792">func</span>&nbsp;<span class="op" id="2964797">(</span><span class="ident" id="2964798">i</span>&nbsp;<span class="op" id="2964800">*</span><span class="ident" id="2964801">IdentifierNode</span><span class="op" id="2964815">)</span>&nbsp;<span class="ident" id="2964817">tree</span><span class="op" id="2964821">(</span><span class="op" id="2964822">)</span>&nbsp;<span class="op" id="2964824">*</span><span class="ident" id="2964825">Tree</span>&nbsp;<span class="op" id="2964830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2964833">return</span>&nbsp;<span class="ident" id="2964840">i</span><span class="op" id="2964841">.</span><span class="ident" id="2964842">tr</span><br>
<span class="lineno"></span><span class="op" id="2964845">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="2964848">func</span>&nbsp;<span class="op" id="2964853">(</span><span class="ident" id="2964854">i</span>&nbsp;<span class="op" id="2964856">*</span><span class="ident" id="2964857">IdentifierNode</span><span class="op" id="2964871">)</span>&nbsp;<span class="ident" id="2964873">Copy</span><span class="op" id="2964877">(</span><span class="op" id="2964878">)</span>&nbsp;<span class="ident" id="2964880">Node</span>&nbsp;<span class="op" id="2964885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2964888">return</span>&nbsp;<span class="ident" id="2964895">NewIdentifier</span><span class="op" id="2964908">(</span><span class="ident" id="2964909">i</span><span class="op" id="2964910">.</span><span class="ident" id="2964911">Ident</span><span class="op" id="2964916">)</span><span class="op" id="2964917">.</span><span class="ident" id="2964918">SetTree</span><span class="op" id="2964925">(</span><span class="ident" id="2964926">i</span><span class="op" id="2964927">.</span><span class="ident" id="2964928">tr</span><span class="op" id="2964930">)</span><span class="op" id="2964931">.</span><span class="ident" id="2964932">SetPos</span><span class="op" id="2964938">(</span><span class="ident" id="2964939">i</span><span class="op" id="2964940">.</span><span class="ident" id="2964941">Pos</span><span class="op" id="2964944">)</span><br>
<span class="lineno"></span><span class="op" id="2964946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="2964949">//&nbsp;VariableNode&nbsp;holds&nbsp;a&nbsp;list&nbsp;of&nbsp;variable&nbsp;names,&nbsp;possibly&nbsp;with&nbsp;chained&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="2965025">//&nbsp;accesses.&nbsp;The&nbsp;dollar&nbsp;sign&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;(first)&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="2965083">type</span>&nbsp;<span class="ident" id="2965088">VariableNode</span>&nbsp;<span class="keyword" id="2965101">struct</span>&nbsp;<span class="op" id="2965108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2965111">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2965121">Pos</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2965126">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2965132">*</span><span class="ident" id="2965133">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2965139">Ident</span>&nbsp;<span class="op" id="2965145">[</span><span class="op" id="2965146">]</span><span class="builtintype" id="2965147">string</span>&nbsp;<span class="comment" id="2965154">//&nbsp;Variable&nbsp;name&nbsp;and&nbsp;fields&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="2965200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2965203">func</span>&nbsp;<span class="op" id="2965208">(</span><span class="ident" id="2965209">t</span>&nbsp;<span class="op" id="2965211">*</span><span class="ident" id="2965212">Tree</span><span class="op" id="2965216">)</span>&nbsp;<span class="ident" id="2965218">newVariable</span><span class="op" id="2965229">(</span><span class="ident" id="2965230">pos</span>&nbsp;<span class="ident" id="2965234">Pos</span><span class="op" id="2965237">,</span>&nbsp;<span class="ident" id="2965239">ident</span>&nbsp;<span class="builtintype" id="2965245">string</span><span class="op" id="2965251">)</span>&nbsp;<span class="op" id="2965253">*</span><span class="ident" id="2965254">VariableNode</span>&nbsp;<span class="op" id="2965267">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2965270">return</span>&nbsp;<span class="op" id="2965277">&amp;</span><span class="ident" id="2965278">VariableNode</span><span class="op" id="2965290">{</span><span class="ident" id="2965291">tr</span><span class="op" id="2965293">:</span>&nbsp;<span class="ident" id="2965295">t</span><span class="op" id="2965296">,</span>&nbsp;<span class="ident" id="2965298">NodeType</span><span class="op" id="2965306">:</span>&nbsp;<span class="ident" id="2965308">NodeVariable</span><span class="op" id="2965320">,</span>&nbsp;<span class="ident" id="2965322">Pos</span><span class="op" id="2965325">:</span>&nbsp;<span class="ident" id="2965327">pos</span><span class="op" id="2965330">,</span>&nbsp;<span class="ident" id="2965332">Ident</span><span class="op" id="2965337">:</span>&nbsp;<span class="ident" id="2965339">strings</span><span class="op" id="2965346">.</span><span class="ident" id="2965347">Split</span><span class="op" id="2965352">(</span><span class="ident" id="2965353">ident</span><span class="op" id="2965358">,</span>&nbsp;<span class="string" id="2965360">&#34;.&#34;</span><span class="op" id="2965363">)</span><span class="op" id="2965364">}</span><br>
<span class="lineno"></span><span class="op" id="2965366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2965369">func</span>&nbsp;<span class="op" id="2965374">(</span><span class="ident" id="2965375">v</span>&nbsp;<span class="op" id="2965377">*</span><span class="ident" id="2965378">VariableNode</span><span class="op" id="2965390">)</span>&nbsp;<span class="ident" id="2965392">String</span><span class="op" id="2965398">(</span><span class="op" id="2965399">)</span>&nbsp;<span class="builtintype" id="2965401">string</span>&nbsp;<span class="op" id="2965408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2965411">s</span>&nbsp;<span class="op" id="2965413">:=</span>&nbsp;<span class="string" id="2965416">&#34;&#34;</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2965420">for</span>&nbsp;<span class="ident" id="2965424">i</span><span class="op" id="2965425">,</span>&nbsp;<span class="ident" id="2965427">id</span>&nbsp;<span class="op" id="2965430">:=</span>&nbsp;<span class="keyword" id="2965433">range</span>&nbsp;<span class="ident" id="2965439">v</span><span class="op" id="2965440">.</span><span class="ident" id="2965441">Ident</span>&nbsp;<span class="op" id="2965447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2965451">if</span>&nbsp;<span class="ident" id="2965454">i</span>&nbsp;<span class="op" id="2965456">&gt;</span>&nbsp;<span class="num" id="2965458">0</span>&nbsp;<span class="op" id="2965460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2965465">s</span>&nbsp;<span class="op" id="2965467">+=</span>&nbsp;<span class="string" id="2965470">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2965476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2965480">s</span>&nbsp;<span class="op" id="2965482">+=</span>&nbsp;<span class="ident" id="2965485">id</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2965489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2965492">return</span>&nbsp;<span class="ident" id="2965499">s</span><br>
<span class="lineno"></span><span class="op" id="2965501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2965504">func</span>&nbsp;<span class="op" id="2965509">(</span><span class="ident" id="2965510">v</span>&nbsp;<span class="op" id="2965512">*</span><span class="ident" id="2965513">VariableNode</span><span class="op" id="2965525">)</span>&nbsp;<span class="ident" id="2965527">tree</span><span class="op" id="2965531">(</span><span class="op" id="2965532">)</span>&nbsp;<span class="op" id="2965534">*</span><span class="ident" id="2965535">Tree</span>&nbsp;<span class="op" id="2965540">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2965543">return</span>&nbsp;<span class="ident" id="2965550">v</span><span class="op" id="2965551">.</span><span class="ident" id="2965552">tr</span><br>
<span class="lineno"></span><span class="op" id="2965555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2965558">func</span>&nbsp;<span class="op" id="2965563">(</span><span class="ident" id="2965564">v</span>&nbsp;<span class="op" id="2965566">*</span><span class="ident" id="2965567">VariableNode</span><span class="op" id="2965579">)</span>&nbsp;<span class="ident" id="2965581">Copy</span><span class="op" id="2965585">(</span><span class="op" id="2965586">)</span>&nbsp;<span class="ident" id="2965588">Node</span>&nbsp;<span class="op" id="2965593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2965596">return</span>&nbsp;<span class="op" id="2965603">&amp;</span><span class="ident" id="2965604">VariableNode</span><span class="op" id="2965616">{</span><span class="ident" id="2965617">tr</span><span class="op" id="2965619">:</span>&nbsp;<span class="ident" id="2965621">v</span><span class="op" id="2965622">.</span><span class="ident" id="2965623">tr</span><span class="op" id="2965625">,</span>&nbsp;<span class="ident" id="2965627">NodeType</span><span class="op" id="2965635">:</span>&nbsp;<span class="ident" id="2965637">NodeVariable</span><span class="op" id="2965649">,</span>&nbsp;<span class="ident" id="2965651">Pos</span><span class="op" id="2965654">:</span>&nbsp;<span class="ident" id="2965656">v</span><span class="op" id="2965657">.</span><span class="ident" id="2965658">Pos</span><span class="op" id="2965661">,</span>&nbsp;<span class="ident" id="2965663">Ident</span><span class="op" id="2965668">:</span>&nbsp;<span class="builtinfunc" id="2965670">append</span><span class="op" id="2965676">(</span><span class="op" id="2965677">[</span><span class="op" id="2965678">]</span><span class="builtintype" id="2965679">string</span><span class="op" id="2965685">{</span><span class="op" id="2965686">}</span><span class="op" id="2965687">,</span>&nbsp;<span class="ident" id="2965689">v</span><span class="op" id="2965690">.</span><span class="ident" id="2965691">Ident</span><span class="op" id="2965696">...</span><span class="op" id="2965699">)</span><span class="op" id="2965700">}</span><br>
<span class="lineno">350</span><span class="op" id="2965702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2965705">//&nbsp;DotNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;.&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="2965750">type</span>&nbsp;<span class="ident" id="2965755">DotNode</span>&nbsp;<span class="keyword" id="2965763">struct</span>&nbsp;<span class="op" id="2965770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2965773">NodeType</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2965783">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2965788">tr</span>&nbsp;<span class="op" id="2965791">*</span><span class="ident" id="2965792">Tree</span><br>
<span class="lineno"></span><span class="op" id="2965797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2965800">func</span>&nbsp;<span class="op" id="2965805">(</span><span class="ident" id="2965806">t</span>&nbsp;<span class="op" id="2965808">*</span><span class="ident" id="2965809">Tree</span><span class="op" id="2965813">)</span>&nbsp;<span class="ident" id="2965815">newDot</span><span class="op" id="2965821">(</span><span class="ident" id="2965822">pos</span>&nbsp;<span class="ident" id="2965826">Pos</span><span class="op" id="2965829">)</span>&nbsp;<span class="op" id="2965831">*</span><span class="ident" id="2965832">DotNode</span>&nbsp;<span class="op" id="2965840">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2965843">return</span>&nbsp;<span class="op" id="2965850">&amp;</span><span class="ident" id="2965851">DotNode</span><span class="op" id="2965858">{</span><span class="ident" id="2965859">tr</span><span class="op" id="2965861">:</span>&nbsp;<span class="ident" id="2965863">t</span><span class="op" id="2965864">,</span>&nbsp;<span class="ident" id="2965866">NodeType</span><span class="op" id="2965874">:</span>&nbsp;<span class="ident" id="2965876">NodeDot</span><span class="op" id="2965883">,</span>&nbsp;<span class="ident" id="2965885">Pos</span><span class="op" id="2965888">:</span>&nbsp;<span class="ident" id="2965890">pos</span><span class="op" id="2965893">}</span><br>
<span class="lineno"></span><span class="op" id="2965895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2965898">func</span>&nbsp;<span class="op" id="2965903">(</span><span class="ident" id="2965904">d</span>&nbsp;<span class="op" id="2965906">*</span><span class="ident" id="2965907">DotNode</span><span class="op" id="2965914">)</span>&nbsp;<span class="ident" id="2965916">Type</span><span class="op" id="2965920">(</span><span class="op" id="2965921">)</span>&nbsp;<span class="ident" id="2965923">NodeType</span>&nbsp;<span class="op" id="2965932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2965935">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2965999">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2966067">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2966091">return</span>&nbsp;<span class="ident" id="2966098">NodeDot</span><br>
<span class="lineno"></span><span class="op" id="2966106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="2966109">func</span>&nbsp;<span class="op" id="2966114">(</span><span class="ident" id="2966115">d</span>&nbsp;<span class="op" id="2966117">*</span><span class="ident" id="2966118">DotNode</span><span class="op" id="2966125">)</span>&nbsp;<span class="ident" id="2966127">String</span><span class="op" id="2966133">(</span><span class="op" id="2966134">)</span>&nbsp;<span class="builtintype" id="2966136">string</span>&nbsp;<span class="op" id="2966143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2966146">return</span>&nbsp;<span class="string" id="2966153">&#34;.&#34;</span><br>
<span class="lineno"></span><span class="op" id="2966157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2966160">func</span>&nbsp;<span class="op" id="2966165">(</span><span class="ident" id="2966166">d</span>&nbsp;<span class="op" id="2966168">*</span><span class="ident" id="2966169">DotNode</span><span class="op" id="2966176">)</span>&nbsp;<span class="ident" id="2966178">tree</span><span class="op" id="2966182">(</span><span class="op" id="2966183">)</span>&nbsp;<span class="op" id="2966185">*</span><span class="ident" id="2966186">Tree</span>&nbsp;<span class="op" id="2966191">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2966194">return</span>&nbsp;<span class="ident" id="2966201">d</span><span class="op" id="2966202">.</span><span class="ident" id="2966203">tr</span><br>
<span class="lineno"></span><span class="op" id="2966206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2966209">func</span>&nbsp;<span class="op" id="2966214">(</span><span class="ident" id="2966215">d</span>&nbsp;<span class="op" id="2966217">*</span><span class="ident" id="2966218">DotNode</span><span class="op" id="2966225">)</span>&nbsp;<span class="ident" id="2966227">Copy</span><span class="op" id="2966231">(</span><span class="op" id="2966232">)</span>&nbsp;<span class="ident" id="2966234">Node</span>&nbsp;<span class="op" id="2966239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2966242">return</span>&nbsp;<span class="ident" id="2966249">d</span><span class="op" id="2966250">.</span><span class="ident" id="2966251">tr</span><span class="op" id="2966253">.</span><span class="ident" id="2966254">newDot</span><span class="op" id="2966260">(</span><span class="ident" id="2966261">d</span><span class="op" id="2966262">.</span><span class="ident" id="2966263">Pos</span><span class="op" id="2966266">)</span><br>
<span class="lineno">380</span><span class="op" id="2966268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2966271">//&nbsp;NilNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;nil&#39;&nbsp;representing&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="2966355">type</span>&nbsp;<span class="ident" id="2966360">NilNode</span>&nbsp;<span class="keyword" id="2966368">struct</span>&nbsp;<span class="op" id="2966375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2966378">NodeType</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2966388">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2966393">tr</span>&nbsp;<span class="op" id="2966396">*</span><span class="ident" id="2966397">Tree</span><br>
<span class="lineno"></span><span class="op" id="2966402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2966405">func</span>&nbsp;<span class="op" id="2966410">(</span><span class="ident" id="2966411">t</span>&nbsp;<span class="op" id="2966413">*</span><span class="ident" id="2966414">Tree</span><span class="op" id="2966418">)</span>&nbsp;<span class="ident" id="2966420">newNil</span><span class="op" id="2966426">(</span><span class="ident" id="2966427">pos</span>&nbsp;<span class="ident" id="2966431">Pos</span><span class="op" id="2966434">)</span>&nbsp;<span class="op" id="2966436">*</span><span class="ident" id="2966437">NilNode</span>&nbsp;<span class="op" id="2966445">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2966448">return</span>&nbsp;<span class="op" id="2966455">&amp;</span><span class="ident" id="2966456">NilNode</span><span class="op" id="2966463">{</span><span class="ident" id="2966464">tr</span><span class="op" id="2966466">:</span>&nbsp;<span class="ident" id="2966468">t</span><span class="op" id="2966469">,</span>&nbsp;<span class="ident" id="2966471">NodeType</span><span class="op" id="2966479">:</span>&nbsp;<span class="ident" id="2966481">NodeNil</span><span class="op" id="2966488">,</span>&nbsp;<span class="ident" id="2966490">Pos</span><span class="op" id="2966493">:</span>&nbsp;<span class="ident" id="2966495">pos</span><span class="op" id="2966498">}</span><br>
<span class="lineno"></span><span class="op" id="2966500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2966503">func</span>&nbsp;<span class="op" id="2966508">(</span><span class="ident" id="2966509">n</span>&nbsp;<span class="op" id="2966511">*</span><span class="ident" id="2966512">NilNode</span><span class="op" id="2966519">)</span>&nbsp;<span class="ident" id="2966521">Type</span><span class="op" id="2966525">(</span><span class="op" id="2966526">)</span>&nbsp;<span class="ident" id="2966528">NodeType</span>&nbsp;<span class="op" id="2966537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2966540">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2966604">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2966672">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2966696">return</span>&nbsp;<span class="ident" id="2966703">NodeNil</span><br>
<span class="lineno"></span><span class="op" id="2966711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="2966714">func</span>&nbsp;<span class="op" id="2966719">(</span><span class="ident" id="2966720">n</span>&nbsp;<span class="op" id="2966722">*</span><span class="ident" id="2966723">NilNode</span><span class="op" id="2966730">)</span>&nbsp;<span class="ident" id="2966732">String</span><span class="op" id="2966738">(</span><span class="op" id="2966739">)</span>&nbsp;<span class="builtintype" id="2966741">string</span>&nbsp;<span class="op" id="2966748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2966751">return</span>&nbsp;<span class="string" id="2966758">&#34;nil&#34;</span><br>
<span class="lineno"></span><span class="op" id="2966764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2966767">func</span>&nbsp;<span class="op" id="2966772">(</span><span class="ident" id="2966773">n</span>&nbsp;<span class="op" id="2966775">*</span><span class="ident" id="2966776">NilNode</span><span class="op" id="2966783">)</span>&nbsp;<span class="ident" id="2966785">tree</span><span class="op" id="2966789">(</span><span class="op" id="2966790">)</span>&nbsp;<span class="op" id="2966792">*</span><span class="ident" id="2966793">Tree</span>&nbsp;<span class="op" id="2966798">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2966801">return</span>&nbsp;<span class="ident" id="2966808">n</span><span class="op" id="2966809">.</span><span class="ident" id="2966810">tr</span><br>
<span class="lineno"></span><span class="op" id="2966813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2966816">func</span>&nbsp;<span class="op" id="2966821">(</span><span class="ident" id="2966822">n</span>&nbsp;<span class="op" id="2966824">*</span><span class="ident" id="2966825">NilNode</span><span class="op" id="2966832">)</span>&nbsp;<span class="ident" id="2966834">Copy</span><span class="op" id="2966838">(</span><span class="op" id="2966839">)</span>&nbsp;<span class="ident" id="2966841">Node</span>&nbsp;<span class="op" id="2966846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2966849">return</span>&nbsp;<span class="ident" id="2966856">n</span><span class="op" id="2966857">.</span><span class="ident" id="2966858">tr</span><span class="op" id="2966860">.</span><span class="ident" id="2966861">newNil</span><span class="op" id="2966867">(</span><span class="ident" id="2966868">n</span><span class="op" id="2966869">.</span><span class="ident" id="2966870">Pos</span><span class="op" id="2966873">)</span><br>
<span class="lineno">410</span><span class="op" id="2966875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2966878">//&nbsp;FieldNode&nbsp;holds&nbsp;a&nbsp;field&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="2966937">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="2966975">//&nbsp;The&nbsp;period&nbsp;is&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">415</span><span class="keyword" id="2967017">type</span>&nbsp;<span class="ident" id="2967022">FieldNode</span>&nbsp;<span class="keyword" id="2967032">struct</span>&nbsp;<span class="op" id="2967039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967042">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967052">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967057">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2967063">*</span><span class="ident" id="2967064">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967070">Ident</span>&nbsp;<span class="op" id="2967076">[</span><span class="op" id="2967077">]</span><span class="builtintype" id="2967078">string</span>&nbsp;<span class="comment" id="2967085">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">420</span><span class="op" id="2967122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2967125">func</span>&nbsp;<span class="op" id="2967130">(</span><span class="ident" id="2967131">t</span>&nbsp;<span class="op" id="2967133">*</span><span class="ident" id="2967134">Tree</span><span class="op" id="2967138">)</span>&nbsp;<span class="ident" id="2967140">newField</span><span class="op" id="2967148">(</span><span class="ident" id="2967149">pos</span>&nbsp;<span class="ident" id="2967153">Pos</span><span class="op" id="2967156">,</span>&nbsp;<span class="ident" id="2967158">ident</span>&nbsp;<span class="builtintype" id="2967164">string</span><span class="op" id="2967170">)</span>&nbsp;<span class="op" id="2967172">*</span><span class="ident" id="2967173">FieldNode</span>&nbsp;<span class="op" id="2967183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2967186">return</span>&nbsp;<span class="op" id="2967193">&amp;</span><span class="ident" id="2967194">FieldNode</span><span class="op" id="2967203">{</span><span class="ident" id="2967204">tr</span><span class="op" id="2967206">:</span>&nbsp;<span class="ident" id="2967208">t</span><span class="op" id="2967209">,</span>&nbsp;<span class="ident" id="2967211">NodeType</span><span class="op" id="2967219">:</span>&nbsp;<span class="ident" id="2967221">NodeField</span><span class="op" id="2967230">,</span>&nbsp;<span class="ident" id="2967232">Pos</span><span class="op" id="2967235">:</span>&nbsp;<span class="ident" id="2967237">pos</span><span class="op" id="2967240">,</span>&nbsp;<span class="ident" id="2967242">Ident</span><span class="op" id="2967247">:</span>&nbsp;<span class="ident" id="2967249">strings</span><span class="op" id="2967256">.</span><span class="ident" id="2967257">Split</span><span class="op" id="2967262">(</span><span class="ident" id="2967263">ident</span><span class="op" id="2967268">[</span><span class="num" id="2967269">1</span><span class="op" id="2967270">:</span><span class="op" id="2967271">]</span><span class="op" id="2967272">,</span>&nbsp;<span class="string" id="2967274">&#34;.&#34;</span><span class="op" id="2967277">)</span><span class="op" id="2967278">}</span>&nbsp;<span class="comment" id="2967280">//&nbsp;[1:]&nbsp;to&nbsp;drop&nbsp;leading&nbsp;period</span><br>
<span class="lineno"></span><span class="op" id="2967311">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="2967314">func</span>&nbsp;<span class="op" id="2967319">(</span><span class="ident" id="2967320">f</span>&nbsp;<span class="op" id="2967322">*</span><span class="ident" id="2967323">FieldNode</span><span class="op" id="2967332">)</span>&nbsp;<span class="ident" id="2967334">String</span><span class="op" id="2967340">(</span><span class="op" id="2967341">)</span>&nbsp;<span class="builtintype" id="2967343">string</span>&nbsp;<span class="op" id="2967350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967353">s</span>&nbsp;<span class="op" id="2967355">:=</span>&nbsp;<span class="string" id="2967358">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2967362">for</span>&nbsp;<span class="ident" id="2967366">_</span><span class="op" id="2967367">,</span>&nbsp;<span class="ident" id="2967369">id</span>&nbsp;<span class="op" id="2967372">:=</span>&nbsp;<span class="keyword" id="2967375">range</span>&nbsp;<span class="ident" id="2967381">f</span><span class="op" id="2967382">.</span><span class="ident" id="2967383">Ident</span>&nbsp;<span class="op" id="2967389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967393">s</span>&nbsp;<span class="op" id="2967395">+=</span>&nbsp;<span class="string" id="2967398">&#34;.&#34;</span>&nbsp;<span class="op" id="2967402">+</span>&nbsp;<span class="ident" id="2967404">id</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2967408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2967411">return</span>&nbsp;<span class="ident" id="2967418">s</span><br>
<span class="lineno"></span><span class="op" id="2967420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2967423">func</span>&nbsp;<span class="op" id="2967428">(</span><span class="ident" id="2967429">f</span>&nbsp;<span class="op" id="2967431">*</span><span class="ident" id="2967432">FieldNode</span><span class="op" id="2967441">)</span>&nbsp;<span class="ident" id="2967443">tree</span><span class="op" id="2967447">(</span><span class="op" id="2967448">)</span>&nbsp;<span class="op" id="2967450">*</span><span class="ident" id="2967451">Tree</span>&nbsp;<span class="op" id="2967456">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2967459">return</span>&nbsp;<span class="ident" id="2967466">f</span><span class="op" id="2967467">.</span><span class="ident" id="2967468">tr</span><br>
<span class="lineno"></span><span class="op" id="2967471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2967474">func</span>&nbsp;<span class="op" id="2967479">(</span><span class="ident" id="2967480">f</span>&nbsp;<span class="op" id="2967482">*</span><span class="ident" id="2967483">FieldNode</span><span class="op" id="2967492">)</span>&nbsp;<span class="ident" id="2967494">Copy</span><span class="op" id="2967498">(</span><span class="op" id="2967499">)</span>&nbsp;<span class="ident" id="2967501">Node</span>&nbsp;<span class="op" id="2967506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2967509">return</span>&nbsp;<span class="op" id="2967516">&amp;</span><span class="ident" id="2967517">FieldNode</span><span class="op" id="2967526">{</span><span class="ident" id="2967527">tr</span><span class="op" id="2967529">:</span>&nbsp;<span class="ident" id="2967531">f</span><span class="op" id="2967532">.</span><span class="ident" id="2967533">tr</span><span class="op" id="2967535">,</span>&nbsp;<span class="ident" id="2967537">NodeType</span><span class="op" id="2967545">:</span>&nbsp;<span class="ident" id="2967547">NodeField</span><span class="op" id="2967556">,</span>&nbsp;<span class="ident" id="2967558">Pos</span><span class="op" id="2967561">:</span>&nbsp;<span class="ident" id="2967563">f</span><span class="op" id="2967564">.</span><span class="ident" id="2967565">Pos</span><span class="op" id="2967568">,</span>&nbsp;<span class="ident" id="2967570">Ident</span><span class="op" id="2967575">:</span>&nbsp;<span class="builtinfunc" id="2967577">append</span><span class="op" id="2967583">(</span><span class="op" id="2967584">[</span><span class="op" id="2967585">]</span><span class="builtintype" id="2967586">string</span><span class="op" id="2967592">{</span><span class="op" id="2967593">}</span><span class="op" id="2967594">,</span>&nbsp;<span class="ident" id="2967596">f</span><span class="op" id="2967597">.</span><span class="ident" id="2967598">Ident</span><span class="op" id="2967603">...</span><span class="op" id="2967606">)</span><span class="op" id="2967607">}</span><br>
<span class="lineno">440</span><span class="op" id="2967609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2967612">//&nbsp;ChainNode&nbsp;holds&nbsp;a&nbsp;term&nbsp;followed&nbsp;by&nbsp;a&nbsp;chain&nbsp;of&nbsp;field&nbsp;accesses&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="2967708">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="2967746">//&nbsp;The&nbsp;periods&nbsp;are&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">445</span><span class="keyword" id="2967790">type</span>&nbsp;<span class="ident" id="2967795">ChainNode</span>&nbsp;<span class="keyword" id="2967805">struct</span>&nbsp;<span class="op" id="2967812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967815">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967825">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967830">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2967836">*</span><span class="ident" id="2967837">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967843">Node</span>&nbsp;&nbsp;<span class="ident" id="2967849">Node</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2967855">Field</span>&nbsp;<span class="op" id="2967861">[</span><span class="op" id="2967862">]</span><span class="builtintype" id="2967863">string</span>&nbsp;<span class="comment" id="2967870">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="2967907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2967910">func</span>&nbsp;<span class="op" id="2967915">(</span><span class="ident" id="2967916">t</span>&nbsp;<span class="op" id="2967918">*</span><span class="ident" id="2967919">Tree</span><span class="op" id="2967923">)</span>&nbsp;<span class="ident" id="2967925">newChain</span><span class="op" id="2967933">(</span><span class="ident" id="2967934">pos</span>&nbsp;<span class="ident" id="2967938">Pos</span><span class="op" id="2967941">,</span>&nbsp;<span class="ident" id="2967943">node</span>&nbsp;<span class="ident" id="2967948">Node</span><span class="op" id="2967952">)</span>&nbsp;<span class="op" id="2967954">*</span><span class="ident" id="2967955">ChainNode</span>&nbsp;<span class="op" id="2967965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2967968">return</span>&nbsp;<span class="op" id="2967975">&amp;</span><span class="ident" id="2967976">ChainNode</span><span class="op" id="2967985">{</span><span class="ident" id="2967986">tr</span><span class="op" id="2967988">:</span>&nbsp;<span class="ident" id="2967990">t</span><span class="op" id="2967991">,</span>&nbsp;<span class="ident" id="2967993">NodeType</span><span class="op" id="2968001">:</span>&nbsp;<span class="ident" id="2968003">NodeChain</span><span class="op" id="2968012">,</span>&nbsp;<span class="ident" id="2968014">Pos</span><span class="op" id="2968017">:</span>&nbsp;<span class="ident" id="2968019">pos</span><span class="op" id="2968022">,</span>&nbsp;<span class="ident" id="2968024">Node</span><span class="op" id="2968028">:</span>&nbsp;<span class="ident" id="2968030">node</span><span class="op" id="2968034">}</span><br>
<span class="lineno">455</span><span class="op" id="2968036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2968039">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;named&nbsp;field&nbsp;(which&nbsp;should&nbsp;start&nbsp;with&nbsp;a&nbsp;period)&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="2968127">func</span>&nbsp;<span class="op" id="2968132">(</span><span class="ident" id="2968133">c</span>&nbsp;<span class="op" id="2968135">*</span><span class="ident" id="2968136">ChainNode</span><span class="op" id="2968145">)</span>&nbsp;<span class="ident" id="2968147">Add</span><span class="op" id="2968150">(</span><span class="ident" id="2968151">field</span>&nbsp;<span class="builtintype" id="2968157">string</span><span class="op" id="2968163">)</span>&nbsp;<span class="op" id="2968165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968168">if</span>&nbsp;<span class="builtinfunc" id="2968171">len</span><span class="op" id="2968174">(</span><span class="ident" id="2968175">field</span><span class="op" id="2968180">)</span>&nbsp;<span class="op" id="2968182">==</span>&nbsp;<span class="num" id="2968185">0</span>&nbsp;<span class="op" id="2968187">||</span>&nbsp;<span class="ident" id="2968190">field</span><span class="op" id="2968195">[</span><span class="num" id="2968196">0</span><span class="op" id="2968197">]</span>&nbsp;<span class="op" id="2968199">!=</span>&nbsp;<span class="string" id="2968202">&#39;.&#39;</span>&nbsp;<span class="op" id="2968206">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2968210">panic</span><span class="op" id="2968215">(</span><span class="string" id="2968216">&#34;no&nbsp;dot&nbsp;in&nbsp;field&#34;</span><span class="op" id="2968233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2968236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968239">field</span>&nbsp;<span class="op" id="2968245">=</span>&nbsp;<span class="ident" id="2968247">field</span><span class="op" id="2968252">[</span><span class="num" id="2968253">1</span><span class="op" id="2968254">:</span><span class="op" id="2968255">]</span>&nbsp;<span class="comment" id="2968257">//&nbsp;Remove&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968281">if</span>&nbsp;<span class="ident" id="2968284">field</span>&nbsp;<span class="op" id="2968290">==</span>&nbsp;<span class="string" id="2968293">&#34;&#34;</span>&nbsp;<span class="op" id="2968296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2968300">panic</span><span class="op" id="2968305">(</span><span class="string" id="2968306">&#34;empty&nbsp;field&#34;</span><span class="op" id="2968319">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2968322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968325">c</span><span class="op" id="2968326">.</span><span class="ident" id="2968327">Field</span>&nbsp;<span class="op" id="2968333">=</span>&nbsp;<span class="builtinfunc" id="2968335">append</span><span class="op" id="2968341">(</span><span class="ident" id="2968342">c</span><span class="op" id="2968343">.</span><span class="ident" id="2968344">Field</span><span class="op" id="2968349">,</span>&nbsp;<span class="ident" id="2968351">field</span><span class="op" id="2968356">)</span><br>
<span class="lineno"></span><span class="op" id="2968358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2968361">func</span>&nbsp;<span class="op" id="2968366">(</span><span class="ident" id="2968367">c</span>&nbsp;<span class="op" id="2968369">*</span><span class="ident" id="2968370">ChainNode</span><span class="op" id="2968379">)</span>&nbsp;<span class="ident" id="2968381">String</span><span class="op" id="2968387">(</span><span class="op" id="2968388">)</span>&nbsp;<span class="builtintype" id="2968390">string</span>&nbsp;<span class="op" id="2968397">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968400">s</span>&nbsp;<span class="op" id="2968402">:=</span>&nbsp;<span class="ident" id="2968405">c</span><span class="op" id="2968406">.</span><span class="ident" id="2968407">Node</span><span class="op" id="2968411">.</span><span class="ident" id="2968412">String</span><span class="op" id="2968418">(</span><span class="op" id="2968419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968422">if</span>&nbsp;<span class="ident" id="2968425">_</span><span class="op" id="2968426">,</span>&nbsp;<span class="ident" id="2968428">ok</span>&nbsp;<span class="op" id="2968431">:=</span>&nbsp;<span class="ident" id="2968434">c</span><span class="op" id="2968435">.</span><span class="ident" id="2968436">Node</span><span class="op" id="2968440">.</span><span class="op" id="2968441">(</span><span class="op" id="2968442">*</span><span class="ident" id="2968443">PipeNode</span><span class="op" id="2968451">)</span><span class="op" id="2968452">;</span>&nbsp;<span class="ident" id="2968454">ok</span>&nbsp;<span class="op" id="2968457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968461">s</span>&nbsp;<span class="op" id="2968463">=</span>&nbsp;<span class="string" id="2968465">&#34;(&#34;</span>&nbsp;<span class="op" id="2968469">+</span>&nbsp;<span class="ident" id="2968471">s</span>&nbsp;<span class="op" id="2968473">+</span>&nbsp;<span class="string" id="2968475">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2968480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968483">for</span>&nbsp;<span class="ident" id="2968487">_</span><span class="op" id="2968488">,</span>&nbsp;<span class="ident" id="2968490">field</span>&nbsp;<span class="op" id="2968496">:=</span>&nbsp;<span class="keyword" id="2968499">range</span>&nbsp;<span class="ident" id="2968505">c</span><span class="op" id="2968506">.</span><span class="ident" id="2968507">Field</span>&nbsp;<span class="op" id="2968513">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968517">s</span>&nbsp;<span class="op" id="2968519">+=</span>&nbsp;<span class="string" id="2968522">&#34;.&#34;</span>&nbsp;<span class="op" id="2968526">+</span>&nbsp;<span class="ident" id="2968528">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2968535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968538">return</span>&nbsp;<span class="ident" id="2968545">s</span><br>
<span class="lineno"></span><span class="op" id="2968547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="2968550">func</span>&nbsp;<span class="op" id="2968555">(</span><span class="ident" id="2968556">c</span>&nbsp;<span class="op" id="2968558">*</span><span class="ident" id="2968559">ChainNode</span><span class="op" id="2968568">)</span>&nbsp;<span class="ident" id="2968570">tree</span><span class="op" id="2968574">(</span><span class="op" id="2968575">)</span>&nbsp;<span class="op" id="2968577">*</span><span class="ident" id="2968578">Tree</span>&nbsp;<span class="op" id="2968583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968586">return</span>&nbsp;<span class="ident" id="2968593">c</span><span class="op" id="2968594">.</span><span class="ident" id="2968595">tr</span><br>
<span class="lineno"></span><span class="op" id="2968598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2968601">func</span>&nbsp;<span class="op" id="2968606">(</span><span class="ident" id="2968607">c</span>&nbsp;<span class="op" id="2968609">*</span><span class="ident" id="2968610">ChainNode</span><span class="op" id="2968619">)</span>&nbsp;<span class="ident" id="2968621">Copy</span><span class="op" id="2968625">(</span><span class="op" id="2968626">)</span>&nbsp;<span class="ident" id="2968628">Node</span>&nbsp;<span class="op" id="2968633">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968636">return</span>&nbsp;<span class="op" id="2968643">&amp;</span><span class="ident" id="2968644">ChainNode</span><span class="op" id="2968653">{</span><span class="ident" id="2968654">tr</span><span class="op" id="2968656">:</span>&nbsp;<span class="ident" id="2968658">c</span><span class="op" id="2968659">.</span><span class="ident" id="2968660">tr</span><span class="op" id="2968662">,</span>&nbsp;<span class="ident" id="2968664">NodeType</span><span class="op" id="2968672">:</span>&nbsp;<span class="ident" id="2968674">NodeChain</span><span class="op" id="2968683">,</span>&nbsp;<span class="ident" id="2968685">Pos</span><span class="op" id="2968688">:</span>&nbsp;<span class="ident" id="2968690">c</span><span class="op" id="2968691">.</span><span class="ident" id="2968692">Pos</span><span class="op" id="2968695">,</span>&nbsp;<span class="ident" id="2968697">Node</span><span class="op" id="2968701">:</span>&nbsp;<span class="ident" id="2968703">c</span><span class="op" id="2968704">.</span><span class="ident" id="2968705">Node</span><span class="op" id="2968709">,</span>&nbsp;<span class="ident" id="2968711">Field</span><span class="op" id="2968716">:</span>&nbsp;<span class="builtinfunc" id="2968718">append</span><span class="op" id="2968724">(</span><span class="op" id="2968725">[</span><span class="op" id="2968726">]</span><span class="builtintype" id="2968727">string</span><span class="op" id="2968733">{</span><span class="op" id="2968734">}</span><span class="op" id="2968735">,</span>&nbsp;<span class="ident" id="2968737">c</span><span class="op" id="2968738">.</span><span class="ident" id="2968739">Field</span><span class="op" id="2968744">...</span><span class="op" id="2968747">)</span><span class="op" id="2968748">}</span><br>
<span class="lineno"></span><span class="op" id="2968750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2968753">//&nbsp;BoolNode&nbsp;holds&nbsp;a&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="2968791">type</span>&nbsp;<span class="ident" id="2968796">BoolNode</span>&nbsp;<span class="keyword" id="2968805">struct</span>&nbsp;<span class="op" id="2968812">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968815">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968825">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968830">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2968835">*</span><span class="ident" id="2968836">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968842">True</span>&nbsp;<span class="builtintype" id="2968847">bool</span>&nbsp;<span class="comment" id="2968852">//&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="2968890">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="2968893">func</span>&nbsp;<span class="op" id="2968898">(</span><span class="ident" id="2968899">t</span>&nbsp;<span class="op" id="2968901">*</span><span class="ident" id="2968902">Tree</span><span class="op" id="2968906">)</span>&nbsp;<span class="ident" id="2968908">newBool</span><span class="op" id="2968915">(</span><span class="ident" id="2968916">pos</span>&nbsp;<span class="ident" id="2968920">Pos</span><span class="op" id="2968923">,</span>&nbsp;<span class="builtintype" id="2968925">true</span>&nbsp;<span class="builtintype" id="2968930">bool</span><span class="op" id="2968934">)</span>&nbsp;<span class="op" id="2968936">*</span><span class="ident" id="2968937">BoolNode</span>&nbsp;<span class="op" id="2968946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2968949">return</span>&nbsp;<span class="op" id="2968956">&amp;</span><span class="ident" id="2968957">BoolNode</span><span class="op" id="2968965">{</span><span class="ident" id="2968966">tr</span><span class="op" id="2968968">:</span>&nbsp;<span class="ident" id="2968970">t</span><span class="op" id="2968971">,</span>&nbsp;<span class="ident" id="2968973">NodeType</span><span class="op" id="2968981">:</span>&nbsp;<span class="ident" id="2968983">NodeBool</span><span class="op" id="2968991">,</span>&nbsp;<span class="ident" id="2968993">Pos</span><span class="op" id="2968996">:</span>&nbsp;<span class="ident" id="2968998">pos</span><span class="op" id="2969001">,</span>&nbsp;<span class="ident" id="2969003">True</span><span class="op" id="2969007">:</span>&nbsp;<span class="builtintype" id="2969009">true</span><span class="op" id="2969013">}</span><br>
<span class="lineno"></span><span class="op" id="2969015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="2969018">func</span>&nbsp;<span class="op" id="2969023">(</span><span class="ident" id="2969024">b</span>&nbsp;<span class="op" id="2969026">*</span><span class="ident" id="2969027">BoolNode</span><span class="op" id="2969035">)</span>&nbsp;<span class="ident" id="2969037">String</span><span class="op" id="2969043">(</span><span class="op" id="2969044">)</span>&nbsp;<span class="builtintype" id="2969046">string</span>&nbsp;<span class="op" id="2969053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2969056">if</span>&nbsp;<span class="ident" id="2969059">b</span><span class="op" id="2969060">.</span><span class="ident" id="2969061">True</span>&nbsp;<span class="op" id="2969066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2969070">return</span>&nbsp;<span class="string" id="2969077">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2969085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2969088">return</span>&nbsp;<span class="string" id="2969095">&#34;false&#34;</span><br>
<span class="lineno">505</span><span class="op" id="2969103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2969106">func</span>&nbsp;<span class="op" id="2969111">(</span><span class="ident" id="2969112">b</span>&nbsp;<span class="op" id="2969114">*</span><span class="ident" id="2969115">BoolNode</span><span class="op" id="2969123">)</span>&nbsp;<span class="ident" id="2969125">tree</span><span class="op" id="2969129">(</span><span class="op" id="2969130">)</span>&nbsp;<span class="op" id="2969132">*</span><span class="ident" id="2969133">Tree</span>&nbsp;<span class="op" id="2969138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2969141">return</span>&nbsp;<span class="ident" id="2969148">b</span><span class="op" id="2969149">.</span><span class="ident" id="2969150">tr</span><br>
<span class="lineno"></span><span class="op" id="2969153">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="2969156">func</span>&nbsp;<span class="op" id="2969161">(</span><span class="ident" id="2969162">b</span>&nbsp;<span class="op" id="2969164">*</span><span class="ident" id="2969165">BoolNode</span><span class="op" id="2969173">)</span>&nbsp;<span class="ident" id="2969175">Copy</span><span class="op" id="2969179">(</span><span class="op" id="2969180">)</span>&nbsp;<span class="ident" id="2969182">Node</span>&nbsp;<span class="op" id="2969187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2969190">return</span>&nbsp;<span class="ident" id="2969197">b</span><span class="op" id="2969198">.</span><span class="ident" id="2969199">tr</span><span class="op" id="2969201">.</span><span class="ident" id="2969202">newBool</span><span class="op" id="2969209">(</span><span class="ident" id="2969210">b</span><span class="op" id="2969211">.</span><span class="ident" id="2969212">Pos</span><span class="op" id="2969215">,</span>&nbsp;<span class="ident" id="2969217">b</span><span class="op" id="2969218">.</span><span class="ident" id="2969219">True</span><span class="op" id="2969223">)</span><br>
<span class="lineno"></span><span class="op" id="2969225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="2969228">//&nbsp;NumberNode&nbsp;holds&nbsp;a&nbsp;number:&nbsp;signed&nbsp;or&nbsp;unsigned&nbsp;integer,&nbsp;float,&nbsp;or&nbsp;complex.</span><br>
<span class="lineno"></span><span class="comment" id="2969305">//&nbsp;The&nbsp;value&nbsp;is&nbsp;parsed&nbsp;and&nbsp;stored&nbsp;under&nbsp;all&nbsp;the&nbsp;types&nbsp;that&nbsp;can&nbsp;represent&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="2969389">//&nbsp;This&nbsp;simulates&nbsp;in&nbsp;a&nbsp;small&nbsp;amount&nbsp;of&nbsp;code&nbsp;the&nbsp;behavior&nbsp;of&nbsp;Go&#39;s&nbsp;ideal&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="2969471">type</span>&nbsp;<span class="ident" id="2969476">NumberNode</span>&nbsp;<span class="keyword" id="2969487">struct</span>&nbsp;<span class="op" id="2969494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969497">NodeType</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969507">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969512">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2969523">*</span><span class="ident" id="2969524">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969530">IsInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2969541">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2969552">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969586">IsUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2969597">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2969608">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;unsigned&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969651">IsFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2969662">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2969673">//&nbsp;Number&nbsp;has&nbsp;a&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969712">IsComplex</span>&nbsp;&nbsp;<span class="builtintype" id="2969723">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2969734">//&nbsp;Number&nbsp;is&nbsp;complex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969757">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2969768">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2969779">//&nbsp;The&nbsp;signed&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969809">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2969820">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2969831">//&nbsp;The&nbsp;unsigned&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969863">Float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2969874">float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2969885">//&nbsp;The&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969915">Complex128</span>&nbsp;<span class="builtintype" id="2969926">complex128</span>&nbsp;<span class="comment" id="2969937">//&nbsp;The&nbsp;complex&nbsp;value.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969960">Text</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2969971">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2969982">//&nbsp;The&nbsp;original&nbsp;textual&nbsp;representation&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="op" id="2970037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2970040">func</span>&nbsp;<span class="op" id="2970045">(</span><span class="ident" id="2970046">t</span>&nbsp;<span class="op" id="2970048">*</span><span class="ident" id="2970049">Tree</span><span class="op" id="2970053">)</span>&nbsp;<span class="ident" id="2970055">newNumber</span><span class="op" id="2970064">(</span><span class="ident" id="2970065">pos</span>&nbsp;<span class="ident" id="2970069">Pos</span><span class="op" id="2970072">,</span>&nbsp;<span class="ident" id="2970074">text</span>&nbsp;<span class="builtintype" id="2970079">string</span><span class="op" id="2970085">,</span>&nbsp;<span class="ident" id="2970087">typ</span>&nbsp;<span class="ident" id="2970091">itemType</span><span class="op" id="2970099">)</span>&nbsp;<span class="op" id="2970101">(</span><span class="op" id="2970102">*</span><span class="ident" id="2970103">NumberNode</span><span class="op" id="2970113">,</span>&nbsp;<span class="builtintype" id="2970115">error</span><span class="op" id="2970120">)</span>&nbsp;<span class="op" id="2970122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970125">n</span>&nbsp;<span class="op" id="2970127">:=</span>&nbsp;<span class="op" id="2970130">&amp;</span><span class="ident" id="2970131">NumberNode</span><span class="op" id="2970141">{</span><span class="ident" id="2970142">tr</span><span class="op" id="2970144">:</span>&nbsp;<span class="ident" id="2970146">t</span><span class="op" id="2970147">,</span>&nbsp;<span class="ident" id="2970149">NodeType</span><span class="op" id="2970157">:</span>&nbsp;<span class="ident" id="2970159">NodeNumber</span><span class="op" id="2970169">,</span>&nbsp;<span class="ident" id="2970171">Pos</span><span class="op" id="2970174">:</span>&nbsp;<span class="ident" id="2970176">pos</span><span class="op" id="2970179">,</span>&nbsp;<span class="ident" id="2970181">Text</span><span class="op" id="2970185">:</span>&nbsp;<span class="ident" id="2970187">text</span><span class="op" id="2970191">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970194">switch</span>&nbsp;<span class="ident" id="2970201">typ</span>&nbsp;<span class="op" id="2970205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970208">case</span>&nbsp;<span class="ident" id="2970213">itemCharConstant</span><span class="op" id="2970229">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2970233">rune</span><span class="op" id="2970237">,</span>&nbsp;<span class="ident" id="2970239">_</span><span class="op" id="2970240">,</span>&nbsp;<span class="ident" id="2970242">tail</span><span class="op" id="2970246">,</span>&nbsp;<span class="ident" id="2970248">err</span>&nbsp;<span class="op" id="2970252">:=</span>&nbsp;<span class="ident" id="2970255">strconv</span><span class="op" id="2970262">.</span><span class="ident" id="2970263">UnquoteChar</span><span class="op" id="2970274">(</span><span class="ident" id="2970275">text</span><span class="op" id="2970279">[</span><span class="num" id="2970280">1</span><span class="op" id="2970281">:</span><span class="op" id="2970282">]</span><span class="op" id="2970283">,</span>&nbsp;<span class="ident" id="2970285">text</span><span class="op" id="2970289">[</span><span class="num" id="2970290">0</span><span class="op" id="2970291">]</span><span class="op" id="2970292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970296">if</span>&nbsp;<span class="ident" id="2970299">err</span>&nbsp;<span class="op" id="2970303">!=</span>&nbsp;<span class="ident" id="2970306">nil</span>&nbsp;<span class="op" id="2970310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970315">return</span>&nbsp;<span class="ident" id="2970322">nil</span><span class="op" id="2970325">,</span>&nbsp;<span class="ident" id="2970327">err</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2970333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970337">if</span>&nbsp;<span class="ident" id="2970340">tail</span>&nbsp;<span class="op" id="2970345">!=</span>&nbsp;<span class="string" id="2970348">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="2970352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970357">return</span>&nbsp;<span class="ident" id="2970364">nil</span><span class="op" id="2970367">,</span>&nbsp;<span class="ident" id="2970369">fmt</span><span class="op" id="2970372">.</span><span class="ident" id="2970373">Errorf</span><span class="op" id="2970379">(</span><span class="string" id="2970380">&#34;malformed&nbsp;character&nbsp;constant:&nbsp;%s&#34;</span><span class="op" id="2970414">,</span>&nbsp;<span class="ident" id="2970416">text</span><span class="op" id="2970420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2970424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970428">n</span><span class="op" id="2970429">.</span><span class="ident" id="2970430">Int64</span>&nbsp;<span class="op" id="2970436">=</span>&nbsp;<span class="ident" id="2970438">int64</span><span class="op" id="2970443">(</span><span class="builtintype" id="2970444">rune</span><span class="op" id="2970448">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970452">n</span><span class="op" id="2970453">.</span><span class="ident" id="2970454">IsInt</span>&nbsp;<span class="op" id="2970460">=</span>&nbsp;<span class="builtintype" id="2970462">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970469">n</span><span class="op" id="2970470">.</span><span class="ident" id="2970471">Uint64</span>&nbsp;<span class="op" id="2970478">=</span>&nbsp;<span class="ident" id="2970480">uint64</span><span class="op" id="2970486">(</span><span class="builtintype" id="2970487">rune</span><span class="op" id="2970491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970495">n</span><span class="op" id="2970496">.</span><span class="ident" id="2970497">IsUint</span>&nbsp;<span class="op" id="2970504">=</span>&nbsp;<span class="builtintype" id="2970506">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970513">n</span><span class="op" id="2970514">.</span><span class="ident" id="2970515">Float64</span>&nbsp;<span class="op" id="2970523">=</span>&nbsp;<span class="builtintype" id="2970525">float64</span><span class="op" id="2970532">(</span><span class="builtintype" id="2970533">rune</span><span class="op" id="2970537">)</span>&nbsp;<span class="comment" id="2970539">//&nbsp;odd&nbsp;but&nbsp;those&nbsp;are&nbsp;the&nbsp;rules.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970573">n</span><span class="op" id="2970574">.</span><span class="ident" id="2970575">IsFloat</span>&nbsp;<span class="op" id="2970583">=</span>&nbsp;<span class="builtintype" id="2970585">true</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970592">return</span>&nbsp;<span class="ident" id="2970599">n</span><span class="op" id="2970600">,</span>&nbsp;<span class="ident" id="2970602">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970607">case</span>&nbsp;<span class="ident" id="2970612">itemComplex</span><span class="op" id="2970623">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2970627">//&nbsp;fmt.Sscan&nbsp;can&nbsp;parse&nbsp;the&nbsp;pair,&nbsp;so&nbsp;let&nbsp;it&nbsp;do&nbsp;the&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970685">if</span>&nbsp;<span class="ident" id="2970688">_</span><span class="op" id="2970689">,</span>&nbsp;<span class="ident" id="2970691">err</span>&nbsp;<span class="op" id="2970695">:=</span>&nbsp;<span class="ident" id="2970698">fmt</span><span class="op" id="2970701">.</span><span class="ident" id="2970702">Sscan</span><span class="op" id="2970707">(</span><span class="ident" id="2970708">text</span><span class="op" id="2970712">,</span>&nbsp;<span class="op" id="2970714">&amp;</span><span class="ident" id="2970715">n</span><span class="op" id="2970716">.</span><span class="ident" id="2970717">Complex128</span><span class="op" id="2970727">)</span><span class="op" id="2970728">;</span>&nbsp;<span class="ident" id="2970730">err</span>&nbsp;<span class="op" id="2970734">!=</span>&nbsp;<span class="ident" id="2970737">nil</span>&nbsp;<span class="op" id="2970741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970746">return</span>&nbsp;<span class="ident" id="2970753">nil</span><span class="op" id="2970756">,</span>&nbsp;<span class="ident" id="2970758">err</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2970764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970768">n</span><span class="op" id="2970769">.</span><span class="ident" id="2970770">IsComplex</span>&nbsp;<span class="op" id="2970780">=</span>&nbsp;<span class="builtintype" id="2970782">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970789">n</span><span class="op" id="2970790">.</span><span class="ident" id="2970791">simplifyComplex</span><span class="op" id="2970806">(</span><span class="op" id="2970807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970811">return</span>&nbsp;<span class="ident" id="2970818">n</span><span class="op" id="2970819">,</span>&nbsp;<span class="ident" id="2970821">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2970826">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2970829">//&nbsp;Imaginary&nbsp;constants&nbsp;can&nbsp;only&nbsp;be&nbsp;complex&nbsp;unless&nbsp;they&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970895">if</span>&nbsp;<span class="builtinfunc" id="2970898">len</span><span class="op" id="2970901">(</span><span class="ident" id="2970902">text</span><span class="op" id="2970906">)</span>&nbsp;<span class="op" id="2970908">&gt;</span>&nbsp;<span class="num" id="2970910">0</span>&nbsp;<span class="op" id="2970912">&amp;&amp;</span>&nbsp;<span class="ident" id="2970915">text</span><span class="op" id="2970919">[</span><span class="builtinfunc" id="2970920">len</span><span class="op" id="2970923">(</span><span class="ident" id="2970924">text</span><span class="op" id="2970928">)</span><span class="op" id="2970929">-</span><span class="num" id="2970930">1</span><span class="op" id="2970931">]</span>&nbsp;<span class="op" id="2970933">==</span>&nbsp;<span class="string" id="2970936">&#39;i&#39;</span>&nbsp;<span class="op" id="2970940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970944">f</span><span class="op" id="2970945">,</span>&nbsp;<span class="ident" id="2970947">err</span>&nbsp;<span class="op" id="2970951">:=</span>&nbsp;<span class="ident" id="2970954">strconv</span><span class="op" id="2970961">.</span><span class="ident" id="2970962">ParseFloat</span><span class="op" id="2970972">(</span><span class="ident" id="2970973">text</span><span class="op" id="2970977">[</span><span class="op" id="2970978">:</span><span class="builtinfunc" id="2970979">len</span><span class="op" id="2970982">(</span><span class="ident" id="2970983">text</span><span class="op" id="2970987">)</span><span class="op" id="2970988">-</span><span class="num" id="2970989">1</span><span class="op" id="2970990">]</span><span class="op" id="2970991">,</span>&nbsp;<span class="num" id="2970993">64</span><span class="op" id="2970995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970999">if</span>&nbsp;<span class="ident" id="2971002">err</span>&nbsp;<span class="op" id="2971006">==</span>&nbsp;<span class="ident" id="2971009">nil</span>&nbsp;<span class="op" id="2971013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971018">n</span><span class="op" id="2971019">.</span><span class="ident" id="2971020">IsComplex</span>&nbsp;<span class="op" id="2971030">=</span>&nbsp;<span class="builtintype" id="2971032">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971040">n</span><span class="op" id="2971041">.</span><span class="ident" id="2971042">Complex128</span>&nbsp;<span class="op" id="2971053">=</span>&nbsp;<span class="builtinfunc" id="2971055">complex</span><span class="op" id="2971062">(</span><span class="num" id="2971063">0</span><span class="op" id="2971064">,</span>&nbsp;<span class="ident" id="2971066">f</span><span class="op" id="2971067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971072">n</span><span class="op" id="2971073">.</span><span class="ident" id="2971074">simplifyComplex</span><span class="op" id="2971089">(</span><span class="op" id="2971090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2971095">return</span>&nbsp;<span class="ident" id="2971102">n</span><span class="op" id="2971103">,</span>&nbsp;<span class="ident" id="2971105">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2971111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2971114">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2971117">//&nbsp;Do&nbsp;integer&nbsp;test&nbsp;first&nbsp;so&nbsp;we&nbsp;get&nbsp;0x123&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971164">u</span><span class="op" id="2971165">,</span>&nbsp;<span class="ident" id="2971167">err</span>&nbsp;<span class="op" id="2971171">:=</span>&nbsp;<span class="ident" id="2971174">strconv</span><span class="op" id="2971181">.</span><span class="ident" id="2971182">ParseUint</span><span class="op" id="2971191">(</span><span class="ident" id="2971192">text</span><span class="op" id="2971196">,</span>&nbsp;<span class="num" id="2971198">0</span><span class="op" id="2971199">,</span>&nbsp;<span class="num" id="2971201">64</span><span class="op" id="2971203">)</span>&nbsp;<span class="comment" id="2971205">//&nbsp;will&nbsp;fail&nbsp;for&nbsp;-0;&nbsp;fixed&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2971240">if</span>&nbsp;<span class="ident" id="2971243">err</span>&nbsp;<span class="op" id="2971247">==</span>&nbsp;<span class="ident" id="2971250">nil</span>&nbsp;<span class="op" id="2971254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971258">n</span><span class="op" id="2971259">.</span><span class="ident" id="2971260">IsUint</span>&nbsp;<span class="op" id="2971267">=</span>&nbsp;<span class="builtintype" id="2971269">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971276">n</span><span class="op" id="2971277">.</span><span class="ident" id="2971278">Uint64</span>&nbsp;<span class="op" id="2971285">=</span>&nbsp;<span class="ident" id="2971287">u</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2971290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971293">i</span><span class="op" id="2971294">,</span>&nbsp;<span class="ident" id="2971296">err</span>&nbsp;<span class="op" id="2971300">:=</span>&nbsp;<span class="ident" id="2971303">strconv</span><span class="op" id="2971310">.</span><span class="ident" id="2971311">ParseInt</span><span class="op" id="2971319">(</span><span class="ident" id="2971320">text</span><span class="op" id="2971324">,</span>&nbsp;<span class="num" id="2971326">0</span><span class="op" id="2971327">,</span>&nbsp;<span class="num" id="2971329">64</span><span class="op" id="2971331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2971334">if</span>&nbsp;<span class="ident" id="2971337">err</span>&nbsp;<span class="op" id="2971341">==</span>&nbsp;<span class="ident" id="2971344">nil</span>&nbsp;<span class="op" id="2971348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971352">n</span><span class="op" id="2971353">.</span><span class="ident" id="2971354">IsInt</span>&nbsp;<span class="op" id="2971360">=</span>&nbsp;<span class="builtintype" id="2971362">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971369">n</span><span class="op" id="2971370">.</span><span class="ident" id="2971371">Int64</span>&nbsp;<span class="op" id="2971377">=</span>&nbsp;<span class="ident" id="2971379">i</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2971383">if</span>&nbsp;<span class="ident" id="2971386">i</span>&nbsp;<span class="op" id="2971388">==</span>&nbsp;<span class="num" id="2971391">0</span>&nbsp;<span class="op" id="2971393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971398">n</span><span class="op" id="2971399">.</span><span class="ident" id="2971400">IsUint</span>&nbsp;<span class="op" id="2971407">=</span>&nbsp;<span class="builtintype" id="2971409">true</span>&nbsp;<span class="comment" id="2971414">//&nbsp;in&nbsp;case&nbsp;of&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971435">n</span><span class="op" id="2971436">.</span><span class="ident" id="2971437">Uint64</span>&nbsp;<span class="op" id="2971444">=</span>&nbsp;<span class="ident" id="2971446">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2971450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2971453">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2971456">//&nbsp;If&nbsp;an&nbsp;integer&nbsp;extraction&nbsp;succeeded,&nbsp;promote&nbsp;the&nbsp;float.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2971515">if</span>&nbsp;<span class="ident" id="2971518">n</span><span class="op" id="2971519">.</span><span class="ident" id="2971520">IsInt</span>&nbsp;<span class="op" id="2971526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971530">n</span><span class="op" id="2971531">.</span><span class="ident" id="2971532">IsFloat</span>&nbsp;<span class="op" id="2971540">=</span>&nbsp;<span class="builtintype" id="2971542">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971549">n</span><span class="op" id="2971550">.</span><span class="ident" id="2971551">Float64</span>&nbsp;<span class="op" id="2971559">=</span>&nbsp;<span class="builtintype" id="2971561">float64</span><span class="op" id="2971568">(</span><span class="ident" id="2971569">n</span><span class="op" id="2971570">.</span><span class="ident" id="2971571">Int64</span><span class="op" id="2971576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2971579">}</span>&nbsp;<span class="keyword" id="2971581">else</span>&nbsp;<span class="keyword" id="2971586">if</span>&nbsp;<span class="ident" id="2971589">n</span><span class="op" id="2971590">.</span><span class="ident" id="2971591">IsUint</span>&nbsp;<span class="op" id="2971598">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971602">n</span><span class="op" id="2971603">.</span><span class="ident" id="2971604">IsFloat</span>&nbsp;<span class="op" id="2971612">=</span>&nbsp;<span class="builtintype" id="2971614">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971621">n</span><span class="op" id="2971622">.</span><span class="ident" id="2971623">Float64</span>&nbsp;<span class="op" id="2971631">=</span>&nbsp;<span class="builtintype" id="2971633">float64</span><span class="op" id="2971640">(</span><span class="ident" id="2971641">n</span><span class="op" id="2971642">.</span><span class="ident" id="2971643">Uint64</span><span class="op" id="2971649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2971652">}</span>&nbsp;<span class="keyword" id="2971654">else</span>&nbsp;<span class="op" id="2971659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971663">f</span><span class="op" id="2971664">,</span>&nbsp;<span class="ident" id="2971666">err</span>&nbsp;<span class="op" id="2971670">:=</span>&nbsp;<span class="ident" id="2971673">strconv</span><span class="op" id="2971680">.</span><span class="ident" id="2971681">ParseFloat</span><span class="op" id="2971691">(</span><span class="ident" id="2971692">text</span><span class="op" id="2971696">,</span>&nbsp;<span class="num" id="2971698">64</span><span class="op" id="2971700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2971704">if</span>&nbsp;<span class="ident" id="2971707">err</span>&nbsp;<span class="op" id="2971711">==</span>&nbsp;<span class="ident" id="2971714">nil</span>&nbsp;<span class="op" id="2971718">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971723">n</span><span class="op" id="2971724">.</span><span class="ident" id="2971725">IsFloat</span>&nbsp;<span class="op" id="2971733">=</span>&nbsp;<span class="builtintype" id="2971735">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971743">n</span><span class="op" id="2971744">.</span><span class="ident" id="2971745">Float64</span>&nbsp;<span class="op" id="2971753">=</span>&nbsp;<span class="ident" id="2971755">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2971760">//&nbsp;If&nbsp;a&nbsp;floating-point&nbsp;extraction&nbsp;succeeded,&nbsp;extract&nbsp;the&nbsp;int&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2971835">if</span>&nbsp;<span class="op" id="2971838">!</span><span class="ident" id="2971839">n</span><span class="op" id="2971840">.</span><span class="ident" id="2971841">IsInt</span>&nbsp;<span class="op" id="2971847">&amp;&amp;</span>&nbsp;<span class="builtintype" id="2971850">float64</span><span class="op" id="2971857">(</span><span class="ident" id="2971858">int64</span><span class="op" id="2971863">(</span><span class="ident" id="2971864">f</span><span class="op" id="2971865">)</span><span class="op" id="2971866">)</span>&nbsp;<span class="op" id="2971868">==</span>&nbsp;<span class="ident" id="2971871">f</span>&nbsp;<span class="op" id="2971873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971879">n</span><span class="op" id="2971880">.</span><span class="ident" id="2971881">IsInt</span>&nbsp;<span class="op" id="2971887">=</span>&nbsp;<span class="builtintype" id="2971889">true</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971898">n</span><span class="op" id="2971899">.</span><span class="ident" id="2971900">Int64</span>&nbsp;<span class="op" id="2971906">=</span>&nbsp;<span class="ident" id="2971908">int64</span><span class="op" id="2971913">(</span><span class="ident" id="2971914">f</span><span class="op" id="2971915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2971920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2971925">if</span>&nbsp;<span class="op" id="2971928">!</span><span class="ident" id="2971929">n</span><span class="op" id="2971930">.</span><span class="ident" id="2971931">IsUint</span>&nbsp;<span class="op" id="2971938">&amp;&amp;</span>&nbsp;<span class="builtintype" id="2971941">float64</span><span class="op" id="2971948">(</span><span class="ident" id="2971949">uint64</span><span class="op" id="2971955">(</span><span class="ident" id="2971956">f</span><span class="op" id="2971957">)</span><span class="op" id="2971958">)</span>&nbsp;<span class="op" id="2971960">==</span>&nbsp;<span class="ident" id="2971963">f</span>&nbsp;<span class="op" id="2971965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971971">n</span><span class="op" id="2971972">.</span><span class="ident" id="2971973">IsUint</span>&nbsp;<span class="op" id="2971980">=</span>&nbsp;<span class="builtintype" id="2971982">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971991">n</span><span class="op" id="2971992">.</span><span class="ident" id="2971993">Uint64</span>&nbsp;<span class="op" id="2972000">=</span>&nbsp;<span class="ident" id="2972002">uint64</span><span class="op" id="2972008">(</span><span class="ident" id="2972009">f</span><span class="op" id="2972010">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2972015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2972019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2972022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2972025">if</span>&nbsp;<span class="op" id="2972028">!</span><span class="ident" id="2972029">n</span><span class="op" id="2972030">.</span><span class="ident" id="2972031">IsInt</span>&nbsp;<span class="op" id="2972037">&amp;&amp;</span>&nbsp;<span class="op" id="2972040">!</span><span class="ident" id="2972041">n</span><span class="op" id="2972042">.</span><span class="ident" id="2972043">IsUint</span>&nbsp;<span class="op" id="2972050">&amp;&amp;</span>&nbsp;<span class="op" id="2972053">!</span><span class="ident" id="2972054">n</span><span class="op" id="2972055">.</span><span class="ident" id="2972056">IsFloat</span>&nbsp;<span class="op" id="2972064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2972068">return</span>&nbsp;<span class="ident" id="2972075">nil</span><span class="op" id="2972078">,</span>&nbsp;<span class="ident" id="2972080">fmt</span><span class="op" id="2972083">.</span><span class="ident" id="2972084">Errorf</span><span class="op" id="2972090">(</span><span class="string" id="2972091">&#34;illegal&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="2972118">,</span>&nbsp;<span class="ident" id="2972120">text</span><span class="op" id="2972124">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2972127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2972130">return</span>&nbsp;<span class="ident" id="2972137">n</span><span class="op" id="2972138">,</span>&nbsp;<span class="ident" id="2972140">nil</span><br>
<span class="lineno"></span><span class="op" id="2972144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2972147">//&nbsp;simplifyComplex&nbsp;pulls&nbsp;out&nbsp;any&nbsp;other&nbsp;types&nbsp;that&nbsp;are&nbsp;represented&nbsp;by&nbsp;the&nbsp;complex&nbsp;number.</span><br>
<span class="lineno">615</span><span class="comment" id="2972236">//&nbsp;These&nbsp;all&nbsp;require&nbsp;that&nbsp;the&nbsp;imaginary&nbsp;part&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword" id="2972290">func</span>&nbsp;<span class="op" id="2972295">(</span><span class="ident" id="2972296">n</span>&nbsp;<span class="op" id="2972298">*</span><span class="ident" id="2972299">NumberNode</span><span class="op" id="2972309">)</span>&nbsp;<span class="ident" id="2972311">simplifyComplex</span><span class="op" id="2972326">(</span><span class="op" id="2972327">)</span>&nbsp;<span class="op" id="2972329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2972332">n</span><span class="op" id="2972333">.</span><span class="ident" id="2972334">IsFloat</span>&nbsp;<span class="op" id="2972342">=</span>&nbsp;<span class="builtinfunc" id="2972344">imag</span><span class="op" id="2972348">(</span><span class="ident" id="2972349">n</span><span class="op" id="2972350">.</span><span class="ident" id="2972351">Complex128</span><span class="op" id="2972361">)</span>&nbsp;<span class="op" id="2972363">==</span>&nbsp;<span class="num" id="2972366">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2972369">if</span>&nbsp;<span class="ident" id="2972372">n</span><span class="op" id="2972373">.</span><span class="ident" id="2972374">IsFloat</span>&nbsp;<span class="op" id="2972382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2972386">n</span><span class="op" id="2972387">.</span><span class="ident" id="2972388">Float64</span>&nbsp;<span class="op" id="2972396">=</span>&nbsp;<span class="builtinfunc" id="2972398">real</span><span class="op" id="2972402">(</span><span class="ident" id="2972403">n</span><span class="op" id="2972404">.</span><span class="ident" id="2972405">Complex128</span><span class="op" id="2972415">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2972419">n</span><span class="op" id="2972420">.</span><span class="ident" id="2972421">IsInt</span>&nbsp;<span class="op" id="2972427">=</span>&nbsp;<span class="builtintype" id="2972429">float64</span><span class="op" id="2972436">(</span><span class="ident" id="2972437">int64</span><span class="op" id="2972442">(</span><span class="ident" id="2972443">n</span><span class="op" id="2972444">.</span><span class="ident" id="2972445">Float64</span><span class="op" id="2972452">)</span><span class="op" id="2972453">)</span>&nbsp;<span class="op" id="2972455">==</span>&nbsp;<span class="ident" id="2972458">n</span><span class="op" id="2972459">.</span><span class="ident" id="2972460">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2972470">if</span>&nbsp;<span class="ident" id="2972473">n</span><span class="op" id="2972474">.</span><span class="ident" id="2972475">IsInt</span>&nbsp;<span class="op" id="2972481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2972486">n</span><span class="op" id="2972487">.</span><span class="ident" id="2972488">Int64</span>&nbsp;<span class="op" id="2972494">=</span>&nbsp;<span class="ident" id="2972496">int64</span><span class="op" id="2972501">(</span><span class="ident" id="2972502">n</span><span class="op" id="2972503">.</span><span class="ident" id="2972504">Float64</span><span class="op" id="2972511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2972515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2972519">n</span><span class="op" id="2972520">.</span><span class="ident" id="2972521">IsUint</span>&nbsp;<span class="op" id="2972528">=</span>&nbsp;<span class="builtintype" id="2972530">float64</span><span class="op" id="2972537">(</span><span class="ident" id="2972538">uint64</span><span class="op" id="2972544">(</span><span class="ident" id="2972545">n</span><span class="op" id="2972546">.</span><span class="ident" id="2972547">Float64</span><span class="op" id="2972554">)</span><span class="op" id="2972555">)</span>&nbsp;<span class="op" id="2972557">==</span>&nbsp;<span class="ident" id="2972560">n</span><span class="op" id="2972561">.</span><span class="ident" id="2972562">Float64</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2972572">if</span>&nbsp;<span class="ident" id="2972575">n</span><span class="op" id="2972576">.</span><span class="ident" id="2972577">IsUint</span>&nbsp;<span class="op" id="2972584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2972589">n</span><span class="op" id="2972590">.</span><span class="ident" id="2972591">Uint64</span>&nbsp;<span class="op" id="2972598">=</span>&nbsp;<span class="ident" id="2972600">uint64</span><span class="op" id="2972606">(</span><span class="ident" id="2972607">n</span><span class="op" id="2972608">.</span><span class="ident" id="2972609">Float64</span><span class="op" id="2972616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2972620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2972623">}</span><br>
<span class="lineno"></span><span class="op" id="2972625">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="2972628">func</span>&nbsp;<span class="op" id="2972633">(</span><span class="ident" id="2972634">n</span>&nbsp;<span class="op" id="2972636">*</span><span class="ident" id="2972637">NumberNode</span><span class="op" id="2972647">)</span>&nbsp;<span class="ident" id="2972649">String</span><span class="op" id="2972655">(</span><span class="op" id="2972656">)</span>&nbsp;<span class="builtintype" id="2972658">string</span>&nbsp;<span class="op" id="2972665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2972668">return</span>&nbsp;<span class="ident" id="2972675">n</span><span class="op" id="2972676">.</span><span class="ident" id="2972677">Text</span><br>
<span class="lineno"></span><span class="op" id="2972682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span><span class="keyword" id="2972685">func</span>&nbsp;<span class="op" id="2972690">(</span><span class="ident" id="2972691">n</span>&nbsp;<span class="op" id="2972693">*</span><span class="ident" id="2972694">NumberNode</span><span class="op" id="2972704">)</span>&nbsp;<span class="ident" id="2972706">tree</span><span class="op" id="2972710">(</span><span class="op" id="2972711">)</span>&nbsp;<span class="op" id="2972713">*</span><span class="ident" id="2972714">Tree</span>&nbsp;<span class="op" id="2972719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2972722">return</span>&nbsp;<span class="ident" id="2972729">n</span><span class="op" id="2972730">.</span><span class="ident" id="2972731">tr</span><br>
<span class="lineno"></span><span class="op" id="2972734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2972737">func</span>&nbsp;<span class="op" id="2972742">(</span><span class="ident" id="2972743">n</span>&nbsp;<span class="op" id="2972745">*</span><span class="ident" id="2972746">NumberNode</span><span class="op" id="2972756">)</span>&nbsp;<span class="ident" id="2972758">Copy</span><span class="op" id="2972762">(</span><span class="op" id="2972763">)</span>&nbsp;<span class="ident" id="2972765">Node</span>&nbsp;<span class="op" id="2972770">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2972773">nn</span>&nbsp;<span class="op" id="2972776">:=</span>&nbsp;<span class="builtinfunc" id="2972779">new</span><span class="op" id="2972782">(</span><span class="ident" id="2972783">NumberNode</span><span class="op" id="2972793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2972796">*</span><span class="ident" id="2972797">nn</span>&nbsp;<span class="op" id="2972800">=</span>&nbsp;<span class="op" id="2972802">*</span><span class="ident" id="2972803">n</span>&nbsp;<span class="comment" id="2972805">//&nbsp;Easy,&nbsp;fast,&nbsp;correct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2972830">return</span>&nbsp;<span class="ident" id="2972837">nn</span><br>
<span class="lineno"></span><span class="op" id="2972840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span><span class="comment" id="2972843">//&nbsp;StringNode&nbsp;holds&nbsp;a&nbsp;string&nbsp;constant.&nbsp;The&nbsp;value&nbsp;has&nbsp;been&nbsp;&#34;unquoted&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="2972913">type</span>&nbsp;<span class="ident" id="2972918">StringNode</span>&nbsp;<span class="keyword" id="2972929">struct</span>&nbsp;<span class="op" id="2972936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2972939">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2972949">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2972954">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2972961">*</span><span class="ident" id="2972962">Tree</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2972968">Quoted</span>&nbsp;<span class="builtintype" id="2972975">string</span>&nbsp;<span class="comment" id="2972982">//&nbsp;The&nbsp;original&nbsp;text&nbsp;of&nbsp;the&nbsp;string,&nbsp;with&nbsp;quotes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973032">Text</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2973039">string</span>&nbsp;<span class="comment" id="2973046">//&nbsp;The&nbsp;string,&nbsp;after&nbsp;quote&nbsp;processing.</span><br>
<span class="lineno"></span><span class="op" id="2973085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2973088">func</span>&nbsp;<span class="op" id="2973093">(</span><span class="ident" id="2973094">t</span>&nbsp;<span class="op" id="2973096">*</span><span class="ident" id="2973097">Tree</span><span class="op" id="2973101">)</span>&nbsp;<span class="ident" id="2973103">newString</span><span class="op" id="2973112">(</span><span class="ident" id="2973113">pos</span>&nbsp;<span class="ident" id="2973117">Pos</span><span class="op" id="2973120">,</span>&nbsp;<span class="ident" id="2973122">orig</span><span class="op" id="2973126">,</span>&nbsp;<span class="ident" id="2973128">text</span>&nbsp;<span class="builtintype" id="2973133">string</span><span class="op" id="2973139">)</span>&nbsp;<span class="op" id="2973141">*</span><span class="ident" id="2973142">StringNode</span>&nbsp;<span class="op" id="2973153">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2973156">return</span>&nbsp;<span class="op" id="2973163">&amp;</span><span class="ident" id="2973164">StringNode</span><span class="op" id="2973174">{</span><span class="ident" id="2973175">tr</span><span class="op" id="2973177">:</span>&nbsp;<span class="ident" id="2973179">t</span><span class="op" id="2973180">,</span>&nbsp;<span class="ident" id="2973182">NodeType</span><span class="op" id="2973190">:</span>&nbsp;<span class="ident" id="2973192">NodeString</span><span class="op" id="2973202">,</span>&nbsp;<span class="ident" id="2973204">Pos</span><span class="op" id="2973207">:</span>&nbsp;<span class="ident" id="2973209">pos</span><span class="op" id="2973212">,</span>&nbsp;<span class="ident" id="2973214">Quoted</span><span class="op" id="2973220">:</span>&nbsp;<span class="ident" id="2973222">orig</span><span class="op" id="2973226">,</span>&nbsp;<span class="ident" id="2973228">Text</span><span class="op" id="2973232">:</span>&nbsp;<span class="ident" id="2973234">text</span><span class="op" id="2973238">}</span><br>
<span class="lineno"></span><span class="op" id="2973240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2973243">func</span>&nbsp;<span class="op" id="2973248">(</span><span class="ident" id="2973249">s</span>&nbsp;<span class="op" id="2973251">*</span><span class="ident" id="2973252">StringNode</span><span class="op" id="2973262">)</span>&nbsp;<span class="ident" id="2973264">String</span><span class="op" id="2973270">(</span><span class="op" id="2973271">)</span>&nbsp;<span class="builtintype" id="2973273">string</span>&nbsp;<span class="op" id="2973280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2973283">return</span>&nbsp;<span class="ident" id="2973290">s</span><span class="op" id="2973291">.</span><span class="ident" id="2973292">Quoted</span><br>
<span class="lineno">660</span><span class="op" id="2973299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2973302">func</span>&nbsp;<span class="op" id="2973307">(</span><span class="ident" id="2973308">s</span>&nbsp;<span class="op" id="2973310">*</span><span class="ident" id="2973311">StringNode</span><span class="op" id="2973321">)</span>&nbsp;<span class="ident" id="2973323">tree</span><span class="op" id="2973327">(</span><span class="op" id="2973328">)</span>&nbsp;<span class="op" id="2973330">*</span><span class="ident" id="2973331">Tree</span>&nbsp;<span class="op" id="2973336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2973339">return</span>&nbsp;<span class="ident" id="2973346">s</span><span class="op" id="2973347">.</span><span class="ident" id="2973348">tr</span><br>
<span class="lineno"></span><span class="op" id="2973351">}</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span><span class="keyword" id="2973354">func</span>&nbsp;<span class="op" id="2973359">(</span><span class="ident" id="2973360">s</span>&nbsp;<span class="op" id="2973362">*</span><span class="ident" id="2973363">StringNode</span><span class="op" id="2973373">)</span>&nbsp;<span class="ident" id="2973375">Copy</span><span class="op" id="2973379">(</span><span class="op" id="2973380">)</span>&nbsp;<span class="ident" id="2973382">Node</span>&nbsp;<span class="op" id="2973387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2973390">return</span>&nbsp;<span class="ident" id="2973397">s</span><span class="op" id="2973398">.</span><span class="ident" id="2973399">tr</span><span class="op" id="2973401">.</span><span class="ident" id="2973402">newString</span><span class="op" id="2973411">(</span><span class="ident" id="2973412">s</span><span class="op" id="2973413">.</span><span class="ident" id="2973414">Pos</span><span class="op" id="2973417">,</span>&nbsp;<span class="ident" id="2973419">s</span><span class="op" id="2973420">.</span><span class="ident" id="2973421">Quoted</span><span class="op" id="2973427">,</span>&nbsp;<span class="ident" id="2973429">s</span><span class="op" id="2973430">.</span><span class="ident" id="2973431">Text</span><span class="op" id="2973435">)</span><br>
<span class="lineno"></span><span class="op" id="2973437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="2973440">//&nbsp;endNode&nbsp;represents&nbsp;an&nbsp;{{end}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="comment" id="2973481">//&nbsp;It&nbsp;does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span><span class="keyword" id="2973528">type</span>&nbsp;<span class="ident" id="2973533">endNode</span>&nbsp;<span class="keyword" id="2973541">struct</span>&nbsp;<span class="op" id="2973548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973551">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973561">Pos</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973566">tr</span>&nbsp;<span class="op" id="2973569">*</span><span class="ident" id="2973570">Tree</span><br>
<span class="lineno"></span><span class="op" id="2973575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2973578">func</span>&nbsp;<span class="op" id="2973583">(</span><span class="ident" id="2973584">t</span>&nbsp;<span class="op" id="2973586">*</span><span class="ident" id="2973587">Tree</span><span class="op" id="2973591">)</span>&nbsp;<span class="ident" id="2973593">newEnd</span><span class="op" id="2973599">(</span><span class="ident" id="2973600">pos</span>&nbsp;<span class="ident" id="2973604">Pos</span><span class="op" id="2973607">)</span>&nbsp;<span class="op" id="2973609">*</span><span class="ident" id="2973610">endNode</span>&nbsp;<span class="op" id="2973618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2973621">return</span>&nbsp;<span class="op" id="2973628">&amp;</span><span class="ident" id="2973629">endNode</span><span class="op" id="2973636">{</span><span class="ident" id="2973637">tr</span><span class="op" id="2973639">:</span>&nbsp;<span class="ident" id="2973641">t</span><span class="op" id="2973642">,</span>&nbsp;<span class="ident" id="2973644">NodeType</span><span class="op" id="2973652">:</span>&nbsp;<span class="ident" id="2973654">nodeEnd</span><span class="op" id="2973661">,</span>&nbsp;<span class="ident" id="2973663">Pos</span><span class="op" id="2973666">:</span>&nbsp;<span class="ident" id="2973668">pos</span><span class="op" id="2973671">}</span><br>
<span class="lineno">680</span><span class="op" id="2973673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2973676">func</span>&nbsp;<span class="op" id="2973681">(</span><span class="ident" id="2973682">e</span>&nbsp;<span class="op" id="2973684">*</span><span class="ident" id="2973685">endNode</span><span class="op" id="2973692">)</span>&nbsp;<span class="ident" id="2973694">String</span><span class="op" id="2973700">(</span><span class="op" id="2973701">)</span>&nbsp;<span class="builtintype" id="2973703">string</span>&nbsp;<span class="op" id="2973710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2973713">return</span>&nbsp;<span class="string" id="2973720">&#34;{{end}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="2973730">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="2973733">func</span>&nbsp;<span class="op" id="2973738">(</span><span class="ident" id="2973739">e</span>&nbsp;<span class="op" id="2973741">*</span><span class="ident" id="2973742">endNode</span><span class="op" id="2973749">)</span>&nbsp;<span class="ident" id="2973751">tree</span><span class="op" id="2973755">(</span><span class="op" id="2973756">)</span>&nbsp;<span class="op" id="2973758">*</span><span class="ident" id="2973759">Tree</span>&nbsp;<span class="op" id="2973764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2973767">return</span>&nbsp;<span class="ident" id="2973774">e</span><span class="op" id="2973775">.</span><span class="ident" id="2973776">tr</span><br>
<span class="lineno"></span><span class="op" id="2973779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="2973782">func</span>&nbsp;<span class="op" id="2973787">(</span><span class="ident" id="2973788">e</span>&nbsp;<span class="op" id="2973790">*</span><span class="ident" id="2973791">endNode</span><span class="op" id="2973798">)</span>&nbsp;<span class="ident" id="2973800">Copy</span><span class="op" id="2973804">(</span><span class="op" id="2973805">)</span>&nbsp;<span class="ident" id="2973807">Node</span>&nbsp;<span class="op" id="2973812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2973815">return</span>&nbsp;<span class="ident" id="2973822">e</span><span class="op" id="2973823">.</span><span class="ident" id="2973824">tr</span><span class="op" id="2973826">.</span><span class="ident" id="2973827">newEnd</span><span class="op" id="2973833">(</span><span class="ident" id="2973834">e</span><span class="op" id="2973835">.</span><span class="ident" id="2973836">Pos</span><span class="op" id="2973839">)</span><br>
<span class="lineno"></span><span class="op" id="2973841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2973844">//&nbsp;elseNode&nbsp;represents&nbsp;an&nbsp;{{else}}&nbsp;action.&nbsp;Does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;tree.</span><br>
<span class="lineno">695</span><span class="keyword" id="2973922">type</span>&nbsp;<span class="ident" id="2973927">elseNode</span>&nbsp;<span class="keyword" id="2973936">struct</span>&nbsp;<span class="op" id="2973943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973946">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973956">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973961">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2973966">*</span><span class="ident" id="2973967">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2973973">Line</span>&nbsp;<span class="builtintype" id="2973978">int</span>&nbsp;<span class="comment" id="2973982">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno">700</span><span class="op" id="2974051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2974054">func</span>&nbsp;<span class="op" id="2974059">(</span><span class="ident" id="2974060">t</span>&nbsp;<span class="op" id="2974062">*</span><span class="ident" id="2974063">Tree</span><span class="op" id="2974067">)</span>&nbsp;<span class="ident" id="2974069">newElse</span><span class="op" id="2974076">(</span><span class="ident" id="2974077">pos</span>&nbsp;<span class="ident" id="2974081">Pos</span><span class="op" id="2974084">,</span>&nbsp;<span class="ident" id="2974086">line</span>&nbsp;<span class="builtintype" id="2974091">int</span><span class="op" id="2974094">)</span>&nbsp;<span class="op" id="2974096">*</span><span class="ident" id="2974097">elseNode</span>&nbsp;<span class="op" id="2974106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2974109">return</span>&nbsp;<span class="op" id="2974116">&amp;</span><span class="ident" id="2974117">elseNode</span><span class="op" id="2974125">{</span><span class="ident" id="2974126">tr</span><span class="op" id="2974128">:</span>&nbsp;<span class="ident" id="2974130">t</span><span class="op" id="2974131">,</span>&nbsp;<span class="ident" id="2974133">NodeType</span><span class="op" id="2974141">:</span>&nbsp;<span class="ident" id="2974143">nodeElse</span><span class="op" id="2974151">,</span>&nbsp;<span class="ident" id="2974153">Pos</span><span class="op" id="2974156">:</span>&nbsp;<span class="ident" id="2974158">pos</span><span class="op" id="2974161">,</span>&nbsp;<span class="ident" id="2974163">Line</span><span class="op" id="2974167">:</span>&nbsp;<span class="ident" id="2974169">line</span><span class="op" id="2974173">}</span><br>
<span class="lineno"></span><span class="op" id="2974175">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="2974178">func</span>&nbsp;<span class="op" id="2974183">(</span><span class="ident" id="2974184">e</span>&nbsp;<span class="op" id="2974186">*</span><span class="ident" id="2974187">elseNode</span><span class="op" id="2974195">)</span>&nbsp;<span class="ident" id="2974197">Type</span><span class="op" id="2974201">(</span><span class="op" id="2974202">)</span>&nbsp;<span class="ident" id="2974204">NodeType</span>&nbsp;<span class="op" id="2974213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2974216">return</span>&nbsp;<span class="ident" id="2974223">nodeElse</span><br>
<span class="lineno"></span><span class="op" id="2974232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="2974235">func</span>&nbsp;<span class="op" id="2974240">(</span><span class="ident" id="2974241">e</span>&nbsp;<span class="op" id="2974243">*</span><span class="ident" id="2974244">elseNode</span><span class="op" id="2974252">)</span>&nbsp;<span class="ident" id="2974254">String</span><span class="op" id="2974260">(</span><span class="op" id="2974261">)</span>&nbsp;<span class="builtintype" id="2974263">string</span>&nbsp;<span class="op" id="2974270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2974273">return</span>&nbsp;<span class="string" id="2974280">&#34;{{else}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="2974291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2974294">func</span>&nbsp;<span class="op" id="2974299">(</span><span class="ident" id="2974300">e</span>&nbsp;<span class="op" id="2974302">*</span><span class="ident" id="2974303">elseNode</span><span class="op" id="2974311">)</span>&nbsp;<span class="ident" id="2974313">tree</span><span class="op" id="2974317">(</span><span class="op" id="2974318">)</span>&nbsp;<span class="op" id="2974320">*</span><span class="ident" id="2974321">Tree</span>&nbsp;<span class="op" id="2974326">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2974329">return</span>&nbsp;<span class="ident" id="2974336">e</span><span class="op" id="2974337">.</span><span class="ident" id="2974338">tr</span><br>
<span class="lineno"></span><span class="op" id="2974341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2974344">func</span>&nbsp;<span class="op" id="2974349">(</span><span class="ident" id="2974350">e</span>&nbsp;<span class="op" id="2974352">*</span><span class="ident" id="2974353">elseNode</span><span class="op" id="2974361">)</span>&nbsp;<span class="ident" id="2974363">Copy</span><span class="op" id="2974367">(</span><span class="op" id="2974368">)</span>&nbsp;<span class="ident" id="2974370">Node</span>&nbsp;<span class="op" id="2974375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2974378">return</span>&nbsp;<span class="ident" id="2974385">e</span><span class="op" id="2974386">.</span><span class="ident" id="2974387">tr</span><span class="op" id="2974389">.</span><span class="ident" id="2974390">newElse</span><span class="op" id="2974397">(</span><span class="ident" id="2974398">e</span><span class="op" id="2974399">.</span><span class="ident" id="2974400">Pos</span><span class="op" id="2974403">,</span>&nbsp;<span class="ident" id="2974405">e</span><span class="op" id="2974406">.</span><span class="ident" id="2974407">Line</span><span class="op" id="2974411">)</span><br>
<span class="lineno">720</span><span class="op" id="2974413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2974416">//&nbsp;BranchNode&nbsp;is&nbsp;the&nbsp;common&nbsp;representation&nbsp;of&nbsp;if,&nbsp;range,&nbsp;and&nbsp;with.</span><br>
<span class="lineno"></span><span class="keyword" id="2974483">type</span>&nbsp;<span class="ident" id="2974488">BranchNode</span>&nbsp;<span class="keyword" id="2974499">struct</span>&nbsp;<span class="op" id="2974506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974509">NodeType</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974519">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974524">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2974533">*</span><span class="ident" id="2974534">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974540">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2974549">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2974559">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974629">Pipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2974638">*</span><span class="ident" id="2974639">PipeNode</span>&nbsp;<span class="comment" id="2974648">//&nbsp;The&nbsp;pipeline&nbsp;to&nbsp;be&nbsp;evaluated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974682">List</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2974691">*</span><span class="ident" id="2974692">ListNode</span>&nbsp;<span class="comment" id="2974701">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;non-empty.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974748">ElseList</span>&nbsp;<span class="op" id="2974757">*</span><span class="ident" id="2974758">ListNode</span>&nbsp;<span class="comment" id="2974767">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;empty&nbsp;(nil&nbsp;if&nbsp;absent).</span><br>
<span class="lineno"></span><span class="op" id="2974825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2974828">func</span>&nbsp;<span class="op" id="2974833">(</span><span class="ident" id="2974834">b</span>&nbsp;<span class="op" id="2974836">*</span><span class="ident" id="2974837">BranchNode</span><span class="op" id="2974847">)</span>&nbsp;<span class="ident" id="2974849">String</span><span class="op" id="2974855">(</span><span class="op" id="2974856">)</span>&nbsp;<span class="builtintype" id="2974858">string</span>&nbsp;<span class="op" id="2974865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974868">name</span>&nbsp;<span class="op" id="2974873">:=</span>&nbsp;<span class="string" id="2974876">&#34;&#34;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2974880">switch</span>&nbsp;<span class="ident" id="2974887">b</span><span class="op" id="2974888">.</span><span class="ident" id="2974889">NodeType</span>&nbsp;<span class="op" id="2974898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2974901">case</span>&nbsp;<span class="ident" id="2974906">NodeIf</span><span class="op" id="2974912">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974916">name</span>&nbsp;<span class="op" id="2974921">=</span>&nbsp;<span class="string" id="2974923">&#34;if&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2974929">case</span>&nbsp;<span class="ident" id="2974934">NodeRange</span><span class="op" id="2974943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974947">name</span>&nbsp;<span class="op" id="2974952">=</span>&nbsp;<span class="string" id="2974954">&#34;range&#34;</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2974963">case</span>&nbsp;<span class="ident" id="2974968">NodeWith</span><span class="op" id="2974976">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974980">name</span>&nbsp;<span class="op" id="2974985">=</span>&nbsp;<span class="string" id="2974987">&#34;with&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2974995">default</span><span class="op" id="2975002">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2975006">panic</span><span class="op" id="2975011">(</span><span class="string" id="2975012">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="2975033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2975036">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975039">if</span>&nbsp;<span class="ident" id="2975042">b</span><span class="op" id="2975043">.</span><span class="ident" id="2975044">ElseList</span>&nbsp;<span class="op" id="2975053">!=</span>&nbsp;<span class="ident" id="2975056">nil</span>&nbsp;<span class="op" id="2975060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975064">return</span>&nbsp;<span class="ident" id="2975071">fmt</span><span class="op" id="2975074">.</span><span class="ident" id="2975075">Sprintf</span><span class="op" id="2975082">(</span><span class="string" id="2975083">&#34;{{%s&nbsp;%s}}%s{{else}}%s{{end}}&#34;</span><span class="op" id="2975113">,</span>&nbsp;<span class="ident" id="2975115">name</span><span class="op" id="2975119">,</span>&nbsp;<span class="ident" id="2975121">b</span><span class="op" id="2975122">.</span><span class="ident" id="2975123">Pipe</span><span class="op" id="2975127">,</span>&nbsp;<span class="ident" id="2975129">b</span><span class="op" id="2975130">.</span><span class="ident" id="2975131">List</span><span class="op" id="2975135">,</span>&nbsp;<span class="ident" id="2975137">b</span><span class="op" id="2975138">.</span><span class="ident" id="2975139">ElseList</span><span class="op" id="2975147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2975150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975153">return</span>&nbsp;<span class="ident" id="2975160">fmt</span><span class="op" id="2975163">.</span><span class="ident" id="2975164">Sprintf</span><span class="op" id="2975171">(</span><span class="string" id="2975172">&#34;{{%s&nbsp;%s}}%s{{end}}&#34;</span><span class="op" id="2975192">,</span>&nbsp;<span class="ident" id="2975194">name</span><span class="op" id="2975198">,</span>&nbsp;<span class="ident" id="2975200">b</span><span class="op" id="2975201">.</span><span class="ident" id="2975202">Pipe</span><span class="op" id="2975206">,</span>&nbsp;<span class="ident" id="2975208">b</span><span class="op" id="2975209">.</span><span class="ident" id="2975210">List</span><span class="op" id="2975214">)</span><br>
<span class="lineno"></span><span class="op" id="2975216">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="keyword" id="2975219">func</span>&nbsp;<span class="op" id="2975224">(</span><span class="ident" id="2975225">b</span>&nbsp;<span class="op" id="2975227">*</span><span class="ident" id="2975228">BranchNode</span><span class="op" id="2975238">)</span>&nbsp;<span class="ident" id="2975240">tree</span><span class="op" id="2975244">(</span><span class="op" id="2975245">)</span>&nbsp;<span class="op" id="2975247">*</span><span class="ident" id="2975248">Tree</span>&nbsp;<span class="op" id="2975253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975256">return</span>&nbsp;<span class="ident" id="2975263">b</span><span class="op" id="2975264">.</span><span class="ident" id="2975265">tr</span><br>
<span class="lineno"></span><span class="op" id="2975268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="keyword" id="2975271">func</span>&nbsp;<span class="op" id="2975276">(</span><span class="ident" id="2975277">b</span>&nbsp;<span class="op" id="2975279">*</span><span class="ident" id="2975280">BranchNode</span><span class="op" id="2975290">)</span>&nbsp;<span class="ident" id="2975292">Copy</span><span class="op" id="2975296">(</span><span class="op" id="2975297">)</span>&nbsp;<span class="ident" id="2975299">Node</span>&nbsp;<span class="op" id="2975304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975307">switch</span>&nbsp;<span class="ident" id="2975314">b</span><span class="op" id="2975315">.</span><span class="ident" id="2975316">NodeType</span>&nbsp;<span class="op" id="2975325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975328">case</span>&nbsp;<span class="ident" id="2975333">NodeIf</span><span class="op" id="2975339">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975343">return</span>&nbsp;<span class="ident" id="2975350">b</span><span class="op" id="2975351">.</span><span class="ident" id="2975352">tr</span><span class="op" id="2975354">.</span><span class="ident" id="2975355">newIf</span><span class="op" id="2975360">(</span><span class="ident" id="2975361">b</span><span class="op" id="2975362">.</span><span class="ident" id="2975363">Pos</span><span class="op" id="2975366">,</span>&nbsp;<span class="ident" id="2975368">b</span><span class="op" id="2975369">.</span><span class="ident" id="2975370">Line</span><span class="op" id="2975374">,</span>&nbsp;<span class="ident" id="2975376">b</span><span class="op" id="2975377">.</span><span class="ident" id="2975378">Pipe</span><span class="op" id="2975382">,</span>&nbsp;<span class="ident" id="2975384">b</span><span class="op" id="2975385">.</span><span class="ident" id="2975386">List</span><span class="op" id="2975390">,</span>&nbsp;<span class="ident" id="2975392">b</span><span class="op" id="2975393">.</span><span class="ident" id="2975394">ElseList</span><span class="op" id="2975402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975405">case</span>&nbsp;<span class="ident" id="2975410">NodeRange</span><span class="op" id="2975419">:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975423">return</span>&nbsp;<span class="ident" id="2975430">b</span><span class="op" id="2975431">.</span><span class="ident" id="2975432">tr</span><span class="op" id="2975434">.</span><span class="ident" id="2975435">newRange</span><span class="op" id="2975443">(</span><span class="ident" id="2975444">b</span><span class="op" id="2975445">.</span><span class="ident" id="2975446">Pos</span><span class="op" id="2975449">,</span>&nbsp;<span class="ident" id="2975451">b</span><span class="op" id="2975452">.</span><span class="ident" id="2975453">Line</span><span class="op" id="2975457">,</span>&nbsp;<span class="ident" id="2975459">b</span><span class="op" id="2975460">.</span><span class="ident" id="2975461">Pipe</span><span class="op" id="2975465">,</span>&nbsp;<span class="ident" id="2975467">b</span><span class="op" id="2975468">.</span><span class="ident" id="2975469">List</span><span class="op" id="2975473">,</span>&nbsp;<span class="ident" id="2975475">b</span><span class="op" id="2975476">.</span><span class="ident" id="2975477">ElseList</span><span class="op" id="2975485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975488">case</span>&nbsp;<span class="ident" id="2975493">NodeWith</span><span class="op" id="2975501">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975505">return</span>&nbsp;<span class="ident" id="2975512">b</span><span class="op" id="2975513">.</span><span class="ident" id="2975514">tr</span><span class="op" id="2975516">.</span><span class="ident" id="2975517">newWith</span><span class="op" id="2975524">(</span><span class="ident" id="2975525">b</span><span class="op" id="2975526">.</span><span class="ident" id="2975527">Pos</span><span class="op" id="2975530">,</span>&nbsp;<span class="ident" id="2975532">b</span><span class="op" id="2975533">.</span><span class="ident" id="2975534">Line</span><span class="op" id="2975538">,</span>&nbsp;<span class="ident" id="2975540">b</span><span class="op" id="2975541">.</span><span class="ident" id="2975542">Pipe</span><span class="op" id="2975546">,</span>&nbsp;<span class="ident" id="2975548">b</span><span class="op" id="2975549">.</span><span class="ident" id="2975550">List</span><span class="op" id="2975554">,</span>&nbsp;<span class="ident" id="2975556">b</span><span class="op" id="2975557">.</span><span class="ident" id="2975558">ElseList</span><span class="op" id="2975566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975569">default</span><span class="op" id="2975576">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2975580">panic</span><span class="op" id="2975585">(</span><span class="string" id="2975586">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="2975607">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2975610">}</span><br>
<span class="lineno"></span><span class="op" id="2975612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2975615">//&nbsp;IfNode&nbsp;represents&nbsp;an&nbsp;{{if}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="2975671">type</span>&nbsp;<span class="ident" id="2975676">IfNode</span>&nbsp;<span class="keyword" id="2975683">struct</span>&nbsp;<span class="op" id="2975690">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975693">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="2975704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2975707">func</span>&nbsp;<span class="op" id="2975712">(</span><span class="ident" id="2975713">t</span>&nbsp;<span class="op" id="2975715">*</span><span class="ident" id="2975716">Tree</span><span class="op" id="2975720">)</span>&nbsp;<span class="ident" id="2975722">newIf</span><span class="op" id="2975727">(</span><span class="ident" id="2975728">pos</span>&nbsp;<span class="ident" id="2975732">Pos</span><span class="op" id="2975735">,</span>&nbsp;<span class="ident" id="2975737">line</span>&nbsp;<span class="builtintype" id="2975742">int</span><span class="op" id="2975745">,</span>&nbsp;<span class="ident" id="2975747">pipe</span>&nbsp;<span class="op" id="2975752">*</span><span class="ident" id="2975753">PipeNode</span><span class="op" id="2975761">,</span>&nbsp;<span class="ident" id="2975763">list</span><span class="op" id="2975767">,</span>&nbsp;<span class="ident" id="2975769">elseList</span>&nbsp;<span class="op" id="2975778">*</span><span class="ident" id="2975779">ListNode</span><span class="op" id="2975787">)</span>&nbsp;<span class="op" id="2975789">*</span><span class="ident" id="2975790">IfNode</span>&nbsp;<span class="op" id="2975797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975800">return</span>&nbsp;<span class="op" id="2975807">&amp;</span><span class="ident" id="2975808">IfNode</span><span class="op" id="2975814">{</span><span class="ident" id="2975815">BranchNode</span><span class="op" id="2975825">{</span><span class="ident" id="2975826">tr</span><span class="op" id="2975828">:</span>&nbsp;<span class="ident" id="2975830">t</span><span class="op" id="2975831">,</span>&nbsp;<span class="ident" id="2975833">NodeType</span><span class="op" id="2975841">:</span>&nbsp;<span class="ident" id="2975843">NodeIf</span><span class="op" id="2975849">,</span>&nbsp;<span class="ident" id="2975851">Pos</span><span class="op" id="2975854">:</span>&nbsp;<span class="ident" id="2975856">pos</span><span class="op" id="2975859">,</span>&nbsp;<span class="ident" id="2975861">Line</span><span class="op" id="2975865">:</span>&nbsp;<span class="ident" id="2975867">line</span><span class="op" id="2975871">,</span>&nbsp;<span class="ident" id="2975873">Pipe</span><span class="op" id="2975877">:</span>&nbsp;<span class="ident" id="2975879">pipe</span><span class="op" id="2975883">,</span>&nbsp;<span class="ident" id="2975885">List</span><span class="op" id="2975889">:</span>&nbsp;<span class="ident" id="2975891">list</span><span class="op" id="2975895">,</span>&nbsp;<span class="ident" id="2975897">ElseList</span><span class="op" id="2975905">:</span>&nbsp;<span class="ident" id="2975907">elseList</span><span class="op" id="2975915">}</span><span class="op" id="2975916">}</span><br>
<span class="lineno">775</span><span class="op" id="2975918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2975921">func</span>&nbsp;<span class="op" id="2975926">(</span><span class="ident" id="2975927">i</span>&nbsp;<span class="op" id="2975929">*</span><span class="ident" id="2975930">IfNode</span><span class="op" id="2975936">)</span>&nbsp;<span class="ident" id="2975938">Copy</span><span class="op" id="2975942">(</span><span class="op" id="2975943">)</span>&nbsp;<span class="ident" id="2975945">Node</span>&nbsp;<span class="op" id="2975950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975953">return</span>&nbsp;<span class="ident" id="2975960">i</span><span class="op" id="2975961">.</span><span class="ident" id="2975962">tr</span><span class="op" id="2975964">.</span><span class="ident" id="2975965">newIf</span><span class="op" id="2975970">(</span><span class="ident" id="2975971">i</span><span class="op" id="2975972">.</span><span class="ident" id="2975973">Pos</span><span class="op" id="2975976">,</span>&nbsp;<span class="ident" id="2975978">i</span><span class="op" id="2975979">.</span><span class="ident" id="2975980">Line</span><span class="op" id="2975984">,</span>&nbsp;<span class="ident" id="2975986">i</span><span class="op" id="2975987">.</span><span class="ident" id="2975988">Pipe</span><span class="op" id="2975992">.</span><span class="ident" id="2975993">CopyPipe</span><span class="op" id="2976001">(</span><span class="op" id="2976002">)</span><span class="op" id="2976003">,</span>&nbsp;<span class="ident" id="2976005">i</span><span class="op" id="2976006">.</span><span class="ident" id="2976007">List</span><span class="op" id="2976011">.</span><span class="ident" id="2976012">CopyList</span><span class="op" id="2976020">(</span><span class="op" id="2976021">)</span><span class="op" id="2976022">,</span>&nbsp;<span class="ident" id="2976024">i</span><span class="op" id="2976025">.</span><span class="ident" id="2976026">ElseList</span><span class="op" id="2976034">.</span><span class="ident" id="2976035">CopyList</span><span class="op" id="2976043">(</span><span class="op" id="2976044">)</span><span class="op" id="2976045">)</span><br>
<span class="lineno"></span><span class="op" id="2976047">}</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span><span class="comment" id="2976050">//&nbsp;RangeNode&nbsp;represents&nbsp;a&nbsp;{{range}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="2976111">type</span>&nbsp;<span class="ident" id="2976116">RangeNode</span>&nbsp;<span class="keyword" id="2976126">struct</span>&nbsp;<span class="op" id="2976133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976136">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="2976147">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="keyword" id="2976150">func</span>&nbsp;<span class="op" id="2976155">(</span><span class="ident" id="2976156">t</span>&nbsp;<span class="op" id="2976158">*</span><span class="ident" id="2976159">Tree</span><span class="op" id="2976163">)</span>&nbsp;<span class="ident" id="2976165">newRange</span><span class="op" id="2976173">(</span><span class="ident" id="2976174">pos</span>&nbsp;<span class="ident" id="2976178">Pos</span><span class="op" id="2976181">,</span>&nbsp;<span class="ident" id="2976183">line</span>&nbsp;<span class="builtintype" id="2976188">int</span><span class="op" id="2976191">,</span>&nbsp;<span class="ident" id="2976193">pipe</span>&nbsp;<span class="op" id="2976198">*</span><span class="ident" id="2976199">PipeNode</span><span class="op" id="2976207">,</span>&nbsp;<span class="ident" id="2976209">list</span><span class="op" id="2976213">,</span>&nbsp;<span class="ident" id="2976215">elseList</span>&nbsp;<span class="op" id="2976224">*</span><span class="ident" id="2976225">ListNode</span><span class="op" id="2976233">)</span>&nbsp;<span class="op" id="2976235">*</span><span class="ident" id="2976236">RangeNode</span>&nbsp;<span class="op" id="2976246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976249">return</span>&nbsp;<span class="op" id="2976256">&amp;</span><span class="ident" id="2976257">RangeNode</span><span class="op" id="2976266">{</span><span class="ident" id="2976267">BranchNode</span><span class="op" id="2976277">{</span><span class="ident" id="2976278">tr</span><span class="op" id="2976280">:</span>&nbsp;<span class="ident" id="2976282">t</span><span class="op" id="2976283">,</span>&nbsp;<span class="ident" id="2976285">NodeType</span><span class="op" id="2976293">:</span>&nbsp;<span class="ident" id="2976295">NodeRange</span><span class="op" id="2976304">,</span>&nbsp;<span class="ident" id="2976306">Pos</span><span class="op" id="2976309">:</span>&nbsp;<span class="ident" id="2976311">pos</span><span class="op" id="2976314">,</span>&nbsp;<span class="ident" id="2976316">Line</span><span class="op" id="2976320">:</span>&nbsp;<span class="ident" id="2976322">line</span><span class="op" id="2976326">,</span>&nbsp;<span class="ident" id="2976328">Pipe</span><span class="op" id="2976332">:</span>&nbsp;<span class="ident" id="2976334">pipe</span><span class="op" id="2976338">,</span>&nbsp;<span class="ident" id="2976340">List</span><span class="op" id="2976344">:</span>&nbsp;<span class="ident" id="2976346">list</span><span class="op" id="2976350">,</span>&nbsp;<span class="ident" id="2976352">ElseList</span><span class="op" id="2976360">:</span>&nbsp;<span class="ident" id="2976362">elseList</span><span class="op" id="2976370">}</span><span class="op" id="2976371">}</span><br>
<span class="lineno"></span><span class="op" id="2976373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span><span class="keyword" id="2976376">func</span>&nbsp;<span class="op" id="2976381">(</span><span class="ident" id="2976382">r</span>&nbsp;<span class="op" id="2976384">*</span><span class="ident" id="2976385">RangeNode</span><span class="op" id="2976394">)</span>&nbsp;<span class="ident" id="2976396">Copy</span><span class="op" id="2976400">(</span><span class="op" id="2976401">)</span>&nbsp;<span class="ident" id="2976403">Node</span>&nbsp;<span class="op" id="2976408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976411">return</span>&nbsp;<span class="ident" id="2976418">r</span><span class="op" id="2976419">.</span><span class="ident" id="2976420">tr</span><span class="op" id="2976422">.</span><span class="ident" id="2976423">newRange</span><span class="op" id="2976431">(</span><span class="ident" id="2976432">r</span><span class="op" id="2976433">.</span><span class="ident" id="2976434">Pos</span><span class="op" id="2976437">,</span>&nbsp;<span class="ident" id="2976439">r</span><span class="op" id="2976440">.</span><span class="ident" id="2976441">Line</span><span class="op" id="2976445">,</span>&nbsp;<span class="ident" id="2976447">r</span><span class="op" id="2976448">.</span><span class="ident" id="2976449">Pipe</span><span class="op" id="2976453">.</span><span class="ident" id="2976454">CopyPipe</span><span class="op" id="2976462">(</span><span class="op" id="2976463">)</span><span class="op" id="2976464">,</span>&nbsp;<span class="ident" id="2976466">r</span><span class="op" id="2976467">.</span><span class="ident" id="2976468">List</span><span class="op" id="2976472">.</span><span class="ident" id="2976473">CopyList</span><span class="op" id="2976481">(</span><span class="op" id="2976482">)</span><span class="op" id="2976483">,</span>&nbsp;<span class="ident" id="2976485">r</span><span class="op" id="2976486">.</span><span class="ident" id="2976487">ElseList</span><span class="op" id="2976495">.</span><span class="ident" id="2976496">CopyList</span><span class="op" id="2976504">(</span><span class="op" id="2976505">)</span><span class="op" id="2976506">)</span><br>
<span class="lineno"></span><span class="op" id="2976508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2976511">//&nbsp;WithNode&nbsp;represents&nbsp;a&nbsp;{{with}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno">795</span><span class="keyword" id="2976570">type</span>&nbsp;<span class="ident" id="2976575">WithNode</span>&nbsp;<span class="keyword" id="2976584">struct</span>&nbsp;<span class="op" id="2976591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976594">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="2976605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2976608">func</span>&nbsp;<span class="op" id="2976613">(</span><span class="ident" id="2976614">t</span>&nbsp;<span class="op" id="2976616">*</span><span class="ident" id="2976617">Tree</span><span class="op" id="2976621">)</span>&nbsp;<span class="ident" id="2976623">newWith</span><span class="op" id="2976630">(</span><span class="ident" id="2976631">pos</span>&nbsp;<span class="ident" id="2976635">Pos</span><span class="op" id="2976638">,</span>&nbsp;<span class="ident" id="2976640">line</span>&nbsp;<span class="builtintype" id="2976645">int</span><span class="op" id="2976648">,</span>&nbsp;<span class="ident" id="2976650">pipe</span>&nbsp;<span class="op" id="2976655">*</span><span class="ident" id="2976656">PipeNode</span><span class="op" id="2976664">,</span>&nbsp;<span class="ident" id="2976666">list</span><span class="op" id="2976670">,</span>&nbsp;<span class="ident" id="2976672">elseList</span>&nbsp;<span class="op" id="2976681">*</span><span class="ident" id="2976682">ListNode</span><span class="op" id="2976690">)</span>&nbsp;<span class="op" id="2976692">*</span><span class="ident" id="2976693">WithNode</span>&nbsp;<span class="op" id="2976702">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976705">return</span>&nbsp;<span class="op" id="2976712">&amp;</span><span class="ident" id="2976713">WithNode</span><span class="op" id="2976721">{</span><span class="ident" id="2976722">BranchNode</span><span class="op" id="2976732">{</span><span class="ident" id="2976733">tr</span><span class="op" id="2976735">:</span>&nbsp;<span class="ident" id="2976737">t</span><span class="op" id="2976738">,</span>&nbsp;<span class="ident" id="2976740">NodeType</span><span class="op" id="2976748">:</span>&nbsp;<span class="ident" id="2976750">NodeWith</span><span class="op" id="2976758">,</span>&nbsp;<span class="ident" id="2976760">Pos</span><span class="op" id="2976763">:</span>&nbsp;<span class="ident" id="2976765">pos</span><span class="op" id="2976768">,</span>&nbsp;<span class="ident" id="2976770">Line</span><span class="op" id="2976774">:</span>&nbsp;<span class="ident" id="2976776">line</span><span class="op" id="2976780">,</span>&nbsp;<span class="ident" id="2976782">Pipe</span><span class="op" id="2976786">:</span>&nbsp;<span class="ident" id="2976788">pipe</span><span class="op" id="2976792">,</span>&nbsp;<span class="ident" id="2976794">List</span><span class="op" id="2976798">:</span>&nbsp;<span class="ident" id="2976800">list</span><span class="op" id="2976804">,</span>&nbsp;<span class="ident" id="2976806">ElseList</span><span class="op" id="2976814">:</span>&nbsp;<span class="ident" id="2976816">elseList</span><span class="op" id="2976824">}</span><span class="op" id="2976825">}</span><br>
<span class="lineno"></span><span class="op" id="2976827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2976830">func</span>&nbsp;<span class="op" id="2976835">(</span><span class="ident" id="2976836">w</span>&nbsp;<span class="op" id="2976838">*</span><span class="ident" id="2976839">WithNode</span><span class="op" id="2976847">)</span>&nbsp;<span class="ident" id="2976849">Copy</span><span class="op" id="2976853">(</span><span class="op" id="2976854">)</span>&nbsp;<span class="ident" id="2976856">Node</span>&nbsp;<span class="op" id="2976861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976864">return</span>&nbsp;<span class="ident" id="2976871">w</span><span class="op" id="2976872">.</span><span class="ident" id="2976873">tr</span><span class="op" id="2976875">.</span><span class="ident" id="2976876">newWith</span><span class="op" id="2976883">(</span><span class="ident" id="2976884">w</span><span class="op" id="2976885">.</span><span class="ident" id="2976886">Pos</span><span class="op" id="2976889">,</span>&nbsp;<span class="ident" id="2976891">w</span><span class="op" id="2976892">.</span><span class="ident" id="2976893">Line</span><span class="op" id="2976897">,</span>&nbsp;<span class="ident" id="2976899">w</span><span class="op" id="2976900">.</span><span class="ident" id="2976901">Pipe</span><span class="op" id="2976905">.</span><span class="ident" id="2976906">CopyPipe</span><span class="op" id="2976914">(</span><span class="op" id="2976915">)</span><span class="op" id="2976916">,</span>&nbsp;<span class="ident" id="2976918">w</span><span class="op" id="2976919">.</span><span class="ident" id="2976920">List</span><span class="op" id="2976924">.</span><span class="ident" id="2976925">CopyList</span><span class="op" id="2976933">(</span><span class="op" id="2976934">)</span><span class="op" id="2976935">,</span>&nbsp;<span class="ident" id="2976937">w</span><span class="op" id="2976938">.</span><span class="ident" id="2976939">ElseList</span><span class="op" id="2976947">.</span><span class="ident" id="2976948">CopyList</span><span class="op" id="2976956">(</span><span class="op" id="2976957">)</span><span class="op" id="2976958">)</span><br>
<span class="lineno">805</span><span class="op" id="2976960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2976963">//&nbsp;TemplateNode&nbsp;represents&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="2977013">type</span>&nbsp;<span class="ident" id="2977018">TemplateNode</span>&nbsp;<span class="keyword" id="2977031">struct</span>&nbsp;<span class="op" id="2977038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977041">NodeType</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977051">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977056">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2977061">*</span><span class="ident" id="2977062">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977068">Line</span>&nbsp;<span class="builtintype" id="2977073">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2977083">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977153">Name</span>&nbsp;<span class="builtintype" id="2977158">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2977168">//&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;template&nbsp;(unquoted).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977209">Pipe</span>&nbsp;<span class="op" id="2977214">*</span><span class="ident" id="2977215">PipeNode</span>&nbsp;<span class="comment" id="2977224">//&nbsp;The&nbsp;command&nbsp;to&nbsp;evaluate&nbsp;as&nbsp;dot&nbsp;for&nbsp;the&nbsp;template.</span><br>
<span class="lineno">815</span><span class="op" id="2977276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2977279">func</span>&nbsp;<span class="op" id="2977284">(</span><span class="ident" id="2977285">t</span>&nbsp;<span class="op" id="2977287">*</span><span class="ident" id="2977288">Tree</span><span class="op" id="2977292">)</span>&nbsp;<span class="ident" id="2977294">newTemplate</span><span class="op" id="2977305">(</span><span class="ident" id="2977306">pos</span>&nbsp;<span class="ident" id="2977310">Pos</span><span class="op" id="2977313">,</span>&nbsp;<span class="ident" id="2977315">line</span>&nbsp;<span class="builtintype" id="2977320">int</span><span class="op" id="2977323">,</span>&nbsp;<span class="ident" id="2977325">name</span>&nbsp;<span class="builtintype" id="2977330">string</span><span class="op" id="2977336">,</span>&nbsp;<span class="ident" id="2977338">pipe</span>&nbsp;<span class="op" id="2977343">*</span><span class="ident" id="2977344">PipeNode</span><span class="op" id="2977352">)</span>&nbsp;<span class="op" id="2977354">*</span><span class="ident" id="2977355">TemplateNode</span>&nbsp;<span class="op" id="2977368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977371">return</span>&nbsp;<span class="op" id="2977378">&amp;</span><span class="ident" id="2977379">TemplateNode</span><span class="op" id="2977391">{</span><span class="ident" id="2977392">tr</span><span class="op" id="2977394">:</span>&nbsp;<span class="ident" id="2977396">t</span><span class="op" id="2977397">,</span>&nbsp;<span class="ident" id="2977399">NodeType</span><span class="op" id="2977407">:</span>&nbsp;<span class="ident" id="2977409">NodeTemplate</span><span class="op" id="2977421">,</span>&nbsp;<span class="ident" id="2977423">Pos</span><span class="op" id="2977426">:</span>&nbsp;<span class="ident" id="2977428">pos</span><span class="op" id="2977431">,</span>&nbsp;<span class="ident" id="2977433">Line</span><span class="op" id="2977437">:</span>&nbsp;<span class="ident" id="2977439">line</span><span class="op" id="2977443">,</span>&nbsp;<span class="ident" id="2977445">Name</span><span class="op" id="2977449">:</span>&nbsp;<span class="ident" id="2977451">name</span><span class="op" id="2977455">,</span>&nbsp;<span class="ident" id="2977457">Pipe</span><span class="op" id="2977461">:</span>&nbsp;<span class="ident" id="2977463">pipe</span><span class="op" id="2977467">}</span><br>
<span class="lineno"></span><span class="op" id="2977469">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="keyword" id="2977472">func</span>&nbsp;<span class="op" id="2977477">(</span><span class="ident" id="2977478">t</span>&nbsp;<span class="op" id="2977480">*</span><span class="ident" id="2977481">TemplateNode</span><span class="op" id="2977493">)</span>&nbsp;<span class="ident" id="2977495">String</span><span class="op" id="2977501">(</span><span class="op" id="2977502">)</span>&nbsp;<span class="builtintype" id="2977504">string</span>&nbsp;<span class="op" id="2977511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977514">if</span>&nbsp;<span class="ident" id="2977517">t</span><span class="op" id="2977518">.</span><span class="ident" id="2977519">Pipe</span>&nbsp;<span class="op" id="2977524">==</span>&nbsp;<span class="ident" id="2977527">nil</span>&nbsp;<span class="op" id="2977531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977535">return</span>&nbsp;<span class="ident" id="2977542">fmt</span><span class="op" id="2977545">.</span><span class="ident" id="2977546">Sprintf</span><span class="op" id="2977553">(</span><span class="string" id="2977554">&#34;{{template&nbsp;%q}}&#34;</span><span class="op" id="2977571">,</span>&nbsp;<span class="ident" id="2977573">t</span><span class="op" id="2977574">.</span><span class="ident" id="2977575">Name</span><span class="op" id="2977579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2977582">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977585">return</span>&nbsp;<span class="ident" id="2977592">fmt</span><span class="op" id="2977595">.</span><span class="ident" id="2977596">Sprintf</span><span class="op" id="2977603">(</span><span class="string" id="2977604">&#34;{{template&nbsp;%q&nbsp;%s}}&#34;</span><span class="op" id="2977624">,</span>&nbsp;<span class="ident" id="2977626">t</span><span class="op" id="2977627">.</span><span class="ident" id="2977628">Name</span><span class="op" id="2977632">,</span>&nbsp;<span class="ident" id="2977634">t</span><span class="op" id="2977635">.</span><span class="ident" id="2977636">Pipe</span><span class="op" id="2977640">)</span><br>
<span class="lineno"></span><span class="op" id="2977642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2977645">func</span>&nbsp;<span class="op" id="2977650">(</span><span class="ident" id="2977651">t</span>&nbsp;<span class="op" id="2977653">*</span><span class="ident" id="2977654">TemplateNode</span><span class="op" id="2977666">)</span>&nbsp;<span class="ident" id="2977668">tree</span><span class="op" id="2977672">(</span><span class="op" id="2977673">)</span>&nbsp;<span class="op" id="2977675">*</span><span class="ident" id="2977676">Tree</span>&nbsp;<span class="op" id="2977681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977684">return</span>&nbsp;<span class="ident" id="2977691">t</span><span class="op" id="2977692">.</span><span class="ident" id="2977693">tr</span><br>
<span class="lineno">830</span><span class="op" id="2977696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2977699">func</span>&nbsp;<span class="op" id="2977704">(</span><span class="ident" id="2977705">t</span>&nbsp;<span class="op" id="2977707">*</span><span class="ident" id="2977708">TemplateNode</span><span class="op" id="2977720">)</span>&nbsp;<span class="ident" id="2977722">Copy</span><span class="op" id="2977726">(</span><span class="op" id="2977727">)</span>&nbsp;<span class="ident" id="2977729">Node</span>&nbsp;<span class="op" id="2977734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977737">return</span>&nbsp;<span class="ident" id="2977744">t</span><span class="op" id="2977745">.</span><span class="ident" id="2977746">tr</span><span class="op" id="2977748">.</span><span class="ident" id="2977749">newTemplate</span><span class="op" id="2977760">(</span><span class="ident" id="2977761">t</span><span class="op" id="2977762">.</span><span class="ident" id="2977763">Pos</span><span class="op" id="2977766">,</span>&nbsp;<span class="ident" id="2977768">t</span><span class="op" id="2977769">.</span><span class="ident" id="2977770">Line</span><span class="op" id="2977774">,</span>&nbsp;<span class="ident" id="2977776">t</span><span class="op" id="2977777">.</span><span class="ident" id="2977778">Name</span><span class="op" id="2977782">,</span>&nbsp;<span class="ident" id="2977784">t</span><span class="op" id="2977785">.</span><span class="ident" id="2977786">Pipe</span><span class="op" id="2977790">.</span><span class="ident" id="2977791">CopyPipe</span><span class="op" id="2977799">(</span><span class="op" id="2977800">)</span><span class="op" id="2977801">)</span><br>
<span class="lineno"></span><span class="op" id="2977803">}</span>
</div>
</body>
</html>
