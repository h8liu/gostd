<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/build</h2>
<ul>
<li><a href="/gostd/go/build/build.go.html">build.go</a></li>
<li><a href="/gostd/go/build/build_test.go.html">build_test.go</a></li>
<li><a href="/gostd/go/build/deps_test.go.html">deps_test.go</a></li>
<li><a href="/gostd/go/build/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/build/read.go.html">read.go</a></li>
<li><a href="/gostd/go/build/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/go/build/syslist.go.html">syslist.go</a></li>
<li><a href="/gostd/go/build/syslist_test.go.html">syslist_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6225565">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6225621">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6225675">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6225726">package</span>&nbsp;<span class="ident" id="6225734">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6225741">import</span>&nbsp;<span class="op" id="6225748">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225751">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225760">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225770">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225777">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225787">&#34;go/doc&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225797">&#34;go/parser&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225810">&#34;go/token&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225822">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225828">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225841">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225848">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6225854">pathpkg</span>&nbsp;<span class="string" id="6225862">&#34;path&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225870">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225887">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225898">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225906">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225917">&#34;strings&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225928">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6225939">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="6225954">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6225957">//&nbsp;A&nbsp;Context&nbsp;specifies&nbsp;the&nbsp;supporting&nbsp;context&nbsp;for&nbsp;a&nbsp;build.</span><br>
<span class="lineno">30</span><span class="keyword" id="6226016">type</span>&nbsp;<span class="ident" id="6226021">Context</span>&nbsp;<span class="keyword" id="6226029">struct</span>&nbsp;<span class="op" id="6226036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226039">GOARCH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6226051">string</span>&nbsp;<span class="comment" id="6226058">//&nbsp;target&nbsp;architecture</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226082">GOOS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6226094">string</span>&nbsp;<span class="comment" id="6226101">//&nbsp;target&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226129">GOROOT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6226141">string</span>&nbsp;<span class="comment" id="6226148">//&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226160">GOPATH</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6226172">string</span>&nbsp;<span class="comment" id="6226179">//&nbsp;Go&nbsp;path</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226191">CgoEnabled</span>&nbsp;&nbsp;<span class="builtintype" id="6226203">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6226210">//&nbsp;whether&nbsp;cgo&nbsp;can&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226238">UseAllFiles</span>&nbsp;<span class="builtintype" id="6226250">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6226257">//&nbsp;use&nbsp;files&nbsp;regardless&nbsp;of&nbsp;+build&nbsp;lines,&nbsp;file&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226310">Compiler</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6226322">string</span>&nbsp;<span class="comment" id="6226329">//&nbsp;compiler&nbsp;to&nbsp;assume&nbsp;when&nbsp;computing&nbsp;target&nbsp;paths</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6226381">//&nbsp;The&nbsp;build&nbsp;and&nbsp;release&nbsp;tags&nbsp;specify&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6226438">//&nbsp;that&nbsp;should&nbsp;be&nbsp;considered&nbsp;satisfied&nbsp;when&nbsp;processing&nbsp;+build&nbsp;lines.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6226508">//&nbsp;Clients&nbsp;creating&nbsp;a&nbsp;new&nbsp;context&nbsp;may&nbsp;customize&nbsp;BuildTags,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6226574">//&nbsp;defaults&nbsp;to&nbsp;empty,&nbsp;but&nbsp;it&nbsp;is&nbsp;usually&nbsp;an&nbsp;error&nbsp;to&nbsp;customize&nbsp;ReleaseTags,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6226650">//&nbsp;which&nbsp;defaults&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;releases&nbsp;the&nbsp;current&nbsp;release&nbsp;is&nbsp;compatible&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6226736">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;BuildTags&nbsp;and&nbsp;ReleaseTags,&nbsp;build&nbsp;constraints</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6226804">//&nbsp;consider&nbsp;the&nbsp;values&nbsp;of&nbsp;GOARCH&nbsp;and&nbsp;GOOS&nbsp;as&nbsp;satisfied&nbsp;tags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226866">BuildTags</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6226878">[</span><span class="op" id="6226879">]</span><span class="builtintype" id="6226880">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226888">ReleaseTags</span>&nbsp;<span class="op" id="6226900">[</span><span class="op" id="6226901">]</span><span class="builtintype" id="6226902">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6226911">//&nbsp;The&nbsp;install&nbsp;suffix&nbsp;specifies&nbsp;a&nbsp;suffix&nbsp;to&nbsp;use&nbsp;in&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;installation</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6226992">//&nbsp;directory.&nbsp;By&nbsp;default&nbsp;it&nbsp;is&nbsp;empty,&nbsp;but&nbsp;custom&nbsp;builds&nbsp;that&nbsp;need&nbsp;to&nbsp;keep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6227067">//&nbsp;their&nbsp;outputs&nbsp;separate&nbsp;can&nbsp;set&nbsp;InstallSuffix&nbsp;to&nbsp;do&nbsp;so.&nbsp;For&nbsp;example,&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6227144">//&nbsp;using&nbsp;the&nbsp;race&nbsp;detector,&nbsp;the&nbsp;go&nbsp;command&nbsp;uses&nbsp;InstallSuffix&nbsp;=&nbsp;&#34;race&#34;,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6227220">//&nbsp;that&nbsp;on&nbsp;a&nbsp;Linux/386&nbsp;system,&nbsp;packages&nbsp;are&nbsp;written&nbsp;to&nbsp;a&nbsp;directory&nbsp;named</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6227294">//&nbsp;&#34;linux_386_race&#34;&nbsp;instead&nbsp;of&nbsp;the&nbsp;usual&nbsp;&#34;linux_386&#34;.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227349">InstallSuffix</span>&nbsp;<span class="builtintype" id="6227363">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6227372">//&nbsp;By&nbsp;default,&nbsp;Import&nbsp;uses&nbsp;the&nbsp;operating&nbsp;system&#39;s&nbsp;file&nbsp;system&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6227441">//&nbsp;to&nbsp;read&nbsp;directories&nbsp;and&nbsp;files.&nbsp;&nbsp;To&nbsp;read&nbsp;from&nbsp;other&nbsp;sources,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6227505">//&nbsp;callers&nbsp;can&nbsp;set&nbsp;the&nbsp;following&nbsp;functions.&nbsp;&nbsp;They&nbsp;all&nbsp;have&nbsp;default</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6227573">//&nbsp;behaviors&nbsp;that&nbsp;use&nbsp;the&nbsp;local&nbsp;file&nbsp;system,&nbsp;so&nbsp;clients&nbsp;need&nbsp;only&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6227644">//&nbsp;the&nbsp;functions&nbsp;whose&nbsp;behaviors&nbsp;they&nbsp;wish&nbsp;to&nbsp;change.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6227700">//&nbsp;JoinPath&nbsp;joins&nbsp;the&nbsp;sequence&nbsp;of&nbsp;path&nbsp;fragments&nbsp;into&nbsp;a&nbsp;single&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6227770">//&nbsp;If&nbsp;JoinPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.Join.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227821">JoinPath</span>&nbsp;<span class="keyword" id="6227830">func</span><span class="op" id="6227834">(</span><span class="ident" id="6227835">elem</span>&nbsp;<span class="op" id="6227840">...</span><span class="builtintype" id="6227843">string</span><span class="op" id="6227849">)</span>&nbsp;<span class="builtintype" id="6227851">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6227860">//&nbsp;SplitPathList&nbsp;splits&nbsp;the&nbsp;path&nbsp;list&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;individual&nbsp;paths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6227933">//&nbsp;If&nbsp;SplitPathList&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6227994">SplitPathList</span>&nbsp;<span class="keyword" id="6228008">func</span><span class="op" id="6228012">(</span><span class="ident" id="6228013">list</span>&nbsp;<span class="builtintype" id="6228018">string</span><span class="op" id="6228024">)</span>&nbsp;<span class="op" id="6228026">[</span><span class="op" id="6228027">]</span><span class="builtintype" id="6228028">string</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228037">//&nbsp;IsAbsPath&nbsp;reports&nbsp;whether&nbsp;path&nbsp;is&nbsp;an&nbsp;absolute&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228093">//&nbsp;If&nbsp;IsAbsPath&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228146">IsAbsPath</span>&nbsp;<span class="keyword" id="6228156">func</span><span class="op" id="6228160">(</span><span class="ident" id="6228161">path</span>&nbsp;<span class="builtintype" id="6228166">string</span><span class="op" id="6228172">)</span>&nbsp;<span class="builtintype" id="6228174">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228181">//&nbsp;IsDir&nbsp;reports&nbsp;whether&nbsp;the&nbsp;path&nbsp;names&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228235">//&nbsp;If&nbsp;IsDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;calls&nbsp;os.Stat&nbsp;and&nbsp;uses&nbsp;the&nbsp;result&#39;s&nbsp;IsDir&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228313">IsDir</span>&nbsp;<span class="keyword" id="6228319">func</span><span class="op" id="6228323">(</span><span class="ident" id="6228324">path</span>&nbsp;<span class="builtintype" id="6228329">string</span><span class="op" id="6228335">)</span>&nbsp;<span class="builtintype" id="6228337">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228344">//&nbsp;HasSubdir&nbsp;reports&nbsp;whether&nbsp;dir&nbsp;is&nbsp;a&nbsp;subdirectory&nbsp;of</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228399">//&nbsp;(perhaps&nbsp;multiple&nbsp;levels&nbsp;below)&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228441">//&nbsp;If&nbsp;so,&nbsp;HasSubdir&nbsp;sets&nbsp;rel&nbsp;to&nbsp;a&nbsp;slash-separated&nbsp;path&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228502">//&nbsp;can&nbsp;be&nbsp;joined&nbsp;to&nbsp;root&nbsp;to&nbsp;produce&nbsp;a&nbsp;path&nbsp;equivalent&nbsp;to&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228565">//&nbsp;If&nbsp;HasSubdir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;an&nbsp;implementation&nbsp;built&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228629">//&nbsp;filepath.EvalSymlinks.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228656">HasSubdir</span>&nbsp;<span class="keyword" id="6228666">func</span><span class="op" id="6228670">(</span><span class="ident" id="6228671">root</span><span class="op" id="6228675">,</span>&nbsp;<span class="ident" id="6228677">dir</span>&nbsp;<span class="builtintype" id="6228681">string</span><span class="op" id="6228687">)</span>&nbsp;<span class="op" id="6228689">(</span><span class="ident" id="6228690">rel</span>&nbsp;<span class="builtintype" id="6228694">string</span><span class="op" id="6228700">,</span>&nbsp;<span class="ident" id="6228702">ok</span>&nbsp;<span class="builtintype" id="6228705">bool</span><span class="op" id="6228709">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228713">//&nbsp;ReadDir&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;os.FileInfo,&nbsp;sorted&nbsp;by&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228773">//&nbsp;describing&nbsp;the&nbsp;content&nbsp;of&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228824">//&nbsp;If&nbsp;ReadDir&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6228875">ReadDir</span>&nbsp;<span class="keyword" id="6228883">func</span><span class="op" id="6228887">(</span><span class="ident" id="6228888">dir</span>&nbsp;<span class="builtintype" id="6228892">string</span><span class="op" id="6228898">)</span>&nbsp;<span class="op" id="6228900">(</span><span class="ident" id="6228901">fi</span>&nbsp;<span class="op" id="6228904">[</span><span class="op" id="6228905">]</span><span class="ident" id="6228906">os</span><span class="op" id="6228908">.</span><span class="ident" id="6228909">FileInfo</span><span class="op" id="6228917">,</span>&nbsp;<span class="ident" id="6228919">err</span>&nbsp;<span class="builtintype" id="6228923">error</span><span class="op" id="6228928">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228932">//&nbsp;OpenFile&nbsp;opens&nbsp;a&nbsp;file&nbsp;(not&nbsp;a&nbsp;directory)&nbsp;for&nbsp;reading.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6228989">//&nbsp;If&nbsp;OpenFile&nbsp;is&nbsp;nil,&nbsp;Import&nbsp;uses&nbsp;os.Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229034">OpenFile</span>&nbsp;<span class="keyword" id="6229043">func</span><span class="op" id="6229047">(</span><span class="ident" id="6229048">path</span>&nbsp;<span class="builtintype" id="6229053">string</span><span class="op" id="6229059">)</span>&nbsp;<span class="op" id="6229061">(</span><span class="ident" id="6229062">r</span>&nbsp;<span class="ident" id="6229064">io</span><span class="op" id="6229066">.</span><span class="ident" id="6229067">ReadCloser</span><span class="op" id="6229077">,</span>&nbsp;<span class="ident" id="6229079">err</span>&nbsp;<span class="builtintype" id="6229083">error</span><span class="op" id="6229088">)</span><br>
<span class="lineno">95</span><span class="op" id="6229090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6229093">//&nbsp;joinPath&nbsp;calls&nbsp;ctxt.JoinPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.Join.</span><br>
<span class="lineno"></span><span class="keyword" id="6229161">func</span>&nbsp;<span class="op" id="6229166">(</span><span class="ident" id="6229167">ctxt</span>&nbsp;<span class="op" id="6229172">*</span><span class="ident" id="6229173">Context</span><span class="op" id="6229180">)</span>&nbsp;<span class="ident" id="6229182">joinPath</span><span class="op" id="6229190">(</span><span class="ident" id="6229191">elem</span>&nbsp;<span class="op" id="6229196">...</span><span class="builtintype" id="6229199">string</span><span class="op" id="6229205">)</span>&nbsp;<span class="builtintype" id="6229207">string</span>&nbsp;<span class="op" id="6229214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229217">if</span>&nbsp;<span class="ident" id="6229220">f</span>&nbsp;<span class="op" id="6229222">:=</span>&nbsp;<span class="ident" id="6229225">ctxt</span><span class="op" id="6229229">.</span><span class="ident" id="6229230">JoinPath</span><span class="op" id="6229238">;</span>&nbsp;<span class="ident" id="6229240">f</span>&nbsp;<span class="op" id="6229242">!=</span>&nbsp;<span class="ident" id="6229245">nil</span>&nbsp;<span class="op" id="6229249">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229253">return</span>&nbsp;<span class="ident" id="6229260">f</span><span class="op" id="6229261">(</span><span class="ident" id="6229262">elem</span><span class="op" id="6229266">...</span><span class="op" id="6229269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6229272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229275">return</span>&nbsp;<span class="ident" id="6229282">filepath</span><span class="op" id="6229290">.</span><span class="ident" id="6229291">Join</span><span class="op" id="6229295">(</span><span class="ident" id="6229296">elem</span><span class="op" id="6229300">...</span><span class="op" id="6229303">)</span><br>
<span class="lineno"></span><span class="op" id="6229305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="6229308">//&nbsp;splitPathList&nbsp;calls&nbsp;ctxt.SplitPathList&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.SplitList.</span><br>
<span class="lineno"></span><span class="keyword" id="6229391">func</span>&nbsp;<span class="op" id="6229396">(</span><span class="ident" id="6229397">ctxt</span>&nbsp;<span class="op" id="6229402">*</span><span class="ident" id="6229403">Context</span><span class="op" id="6229410">)</span>&nbsp;<span class="ident" id="6229412">splitPathList</span><span class="op" id="6229425">(</span><span class="ident" id="6229426">s</span>&nbsp;<span class="builtintype" id="6229428">string</span><span class="op" id="6229434">)</span>&nbsp;<span class="op" id="6229436">[</span><span class="op" id="6229437">]</span><span class="builtintype" id="6229438">string</span>&nbsp;<span class="op" id="6229445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229448">if</span>&nbsp;<span class="ident" id="6229451">f</span>&nbsp;<span class="op" id="6229453">:=</span>&nbsp;<span class="ident" id="6229456">ctxt</span><span class="op" id="6229460">.</span><span class="ident" id="6229461">SplitPathList</span><span class="op" id="6229474">;</span>&nbsp;<span class="ident" id="6229476">f</span>&nbsp;<span class="op" id="6229478">!=</span>&nbsp;<span class="ident" id="6229481">nil</span>&nbsp;<span class="op" id="6229485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229489">return</span>&nbsp;<span class="ident" id="6229496">f</span><span class="op" id="6229497">(</span><span class="ident" id="6229498">s</span><span class="op" id="6229499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6229502">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229505">return</span>&nbsp;<span class="ident" id="6229512">filepath</span><span class="op" id="6229520">.</span><span class="ident" id="6229521">SplitList</span><span class="op" id="6229530">(</span><span class="ident" id="6229531">s</span><span class="op" id="6229532">)</span><br>
<span class="lineno"></span><span class="op" id="6229534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6229537">//&nbsp;isAbsPath&nbsp;calls&nbsp;ctxt.IsAbsSPath&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;filepath.IsAbs.</span><br>
<span class="lineno"></span><span class="keyword" id="6229609">func</span>&nbsp;<span class="op" id="6229614">(</span><span class="ident" id="6229615">ctxt</span>&nbsp;<span class="op" id="6229620">*</span><span class="ident" id="6229621">Context</span><span class="op" id="6229628">)</span>&nbsp;<span class="ident" id="6229630">isAbsPath</span><span class="op" id="6229639">(</span><span class="ident" id="6229640">path</span>&nbsp;<span class="builtintype" id="6229645">string</span><span class="op" id="6229651">)</span>&nbsp;<span class="builtintype" id="6229653">bool</span>&nbsp;<span class="op" id="6229658">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229661">if</span>&nbsp;<span class="ident" id="6229664">f</span>&nbsp;<span class="op" id="6229666">:=</span>&nbsp;<span class="ident" id="6229669">ctxt</span><span class="op" id="6229673">.</span><span class="ident" id="6229674">IsAbsPath</span><span class="op" id="6229683">;</span>&nbsp;<span class="ident" id="6229685">f</span>&nbsp;<span class="op" id="6229687">!=</span>&nbsp;<span class="ident" id="6229690">nil</span>&nbsp;<span class="op" id="6229694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229698">return</span>&nbsp;<span class="ident" id="6229705">f</span><span class="op" id="6229706">(</span><span class="ident" id="6229707">path</span><span class="op" id="6229711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6229714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229717">return</span>&nbsp;<span class="ident" id="6229724">filepath</span><span class="op" id="6229732">.</span><span class="ident" id="6229733">IsAbs</span><span class="op" id="6229738">(</span><span class="ident" id="6229739">path</span><span class="op" id="6229743">)</span><br>
<span class="lineno"></span><span class="op" id="6229745">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="6229748">//&nbsp;isDir&nbsp;calls&nbsp;ctxt.IsDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses&nbsp;os.Stat.</span><br>
<span class="lineno"></span><span class="keyword" id="6229809">func</span>&nbsp;<span class="op" id="6229814">(</span><span class="ident" id="6229815">ctxt</span>&nbsp;<span class="op" id="6229820">*</span><span class="ident" id="6229821">Context</span><span class="op" id="6229828">)</span>&nbsp;<span class="ident" id="6229830">isDir</span><span class="op" id="6229835">(</span><span class="ident" id="6229836">path</span>&nbsp;<span class="builtintype" id="6229841">string</span><span class="op" id="6229847">)</span>&nbsp;<span class="builtintype" id="6229849">bool</span>&nbsp;<span class="op" id="6229854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229857">if</span>&nbsp;<span class="ident" id="6229860">f</span>&nbsp;<span class="op" id="6229862">:=</span>&nbsp;<span class="ident" id="6229865">ctxt</span><span class="op" id="6229869">.</span><span class="ident" id="6229870">IsDir</span><span class="op" id="6229875">;</span>&nbsp;<span class="ident" id="6229877">f</span>&nbsp;<span class="op" id="6229879">!=</span>&nbsp;<span class="ident" id="6229882">nil</span>&nbsp;<span class="op" id="6229886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229890">return</span>&nbsp;<span class="ident" id="6229897">f</span><span class="op" id="6229898">(</span><span class="ident" id="6229899">path</span><span class="op" id="6229903">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6229906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6229909">fi</span><span class="op" id="6229911">,</span>&nbsp;<span class="ident" id="6229913">err</span>&nbsp;<span class="op" id="6229917">:=</span>&nbsp;<span class="ident" id="6229920">os</span><span class="op" id="6229922">.</span><span class="ident" id="6229923">Stat</span><span class="op" id="6229927">(</span><span class="ident" id="6229928">path</span><span class="op" id="6229932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6229935">return</span>&nbsp;<span class="ident" id="6229942">err</span>&nbsp;<span class="op" id="6229946">==</span>&nbsp;<span class="ident" id="6229949">nil</span>&nbsp;<span class="op" id="6229953">&amp;&amp;</span>&nbsp;<span class="ident" id="6229956">fi</span><span class="op" id="6229958">.</span><span class="ident" id="6229959">IsDir</span><span class="op" id="6229964">(</span><span class="op" id="6229965">)</span><br>
<span class="lineno"></span><span class="op" id="6229967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="6229970">//&nbsp;hasSubdir&nbsp;calls&nbsp;ctxt.HasSubdir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="6230030">//&nbsp;the&nbsp;local&nbsp;file&nbsp;system&nbsp;to&nbsp;answer&nbsp;the&nbsp;question.</span><br>
<span class="lineno"></span><span class="keyword" id="6230079">func</span>&nbsp;<span class="op" id="6230084">(</span><span class="ident" id="6230085">ctxt</span>&nbsp;<span class="op" id="6230090">*</span><span class="ident" id="6230091">Context</span><span class="op" id="6230098">)</span>&nbsp;<span class="ident" id="6230100">hasSubdir</span><span class="op" id="6230109">(</span><span class="ident" id="6230110">root</span><span class="op" id="6230114">,</span>&nbsp;<span class="ident" id="6230116">dir</span>&nbsp;<span class="builtintype" id="6230120">string</span><span class="op" id="6230126">)</span>&nbsp;<span class="op" id="6230128">(</span><span class="ident" id="6230129">rel</span>&nbsp;<span class="builtintype" id="6230133">string</span><span class="op" id="6230139">,</span>&nbsp;<span class="ident" id="6230141">ok</span>&nbsp;<span class="builtintype" id="6230144">bool</span><span class="op" id="6230148">)</span>&nbsp;<span class="op" id="6230150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230153">if</span>&nbsp;<span class="ident" id="6230156">f</span>&nbsp;<span class="op" id="6230158">:=</span>&nbsp;<span class="ident" id="6230161">ctxt</span><span class="op" id="6230165">.</span><span class="ident" id="6230166">HasSubdir</span><span class="op" id="6230175">;</span>&nbsp;<span class="ident" id="6230177">f</span>&nbsp;<span class="op" id="6230179">!=</span>&nbsp;<span class="ident" id="6230182">nil</span>&nbsp;<span class="op" id="6230186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230190">return</span>&nbsp;<span class="ident" id="6230197">f</span><span class="op" id="6230198">(</span><span class="ident" id="6230199">root</span><span class="op" id="6230203">,</span>&nbsp;<span class="ident" id="6230205">dir</span><span class="op" id="6230208">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230215">//&nbsp;Try&nbsp;using&nbsp;paths&nbsp;we&nbsp;received.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230248">if</span>&nbsp;<span class="ident" id="6230251">rel</span><span class="op" id="6230254">,</span>&nbsp;<span class="ident" id="6230256">ok</span>&nbsp;<span class="op" id="6230259">=</span>&nbsp;<span class="ident" id="6230261">hasSubdir</span><span class="op" id="6230270">(</span><span class="ident" id="6230271">root</span><span class="op" id="6230275">,</span>&nbsp;<span class="ident" id="6230277">dir</span><span class="op" id="6230280">)</span><span class="op" id="6230281">;</span>&nbsp;<span class="ident" id="6230283">ok</span>&nbsp;<span class="op" id="6230286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230290">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230302">//&nbsp;Try&nbsp;expanding&nbsp;symlinks&nbsp;and&nbsp;comparing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230343">//&nbsp;expanded&nbsp;against&nbsp;unexpanded&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6230379">//&nbsp;expanded&nbsp;against&nbsp;expanded.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230410">rootSym</span><span class="op" id="6230417">,</span>&nbsp;<span class="ident" id="6230419">_</span>&nbsp;<span class="op" id="6230421">:=</span>&nbsp;<span class="ident" id="6230424">filepath</span><span class="op" id="6230432">.</span><span class="ident" id="6230433">EvalSymlinks</span><span class="op" id="6230445">(</span><span class="ident" id="6230446">root</span><span class="op" id="6230450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230453">dirSym</span><span class="op" id="6230459">,</span>&nbsp;<span class="ident" id="6230461">_</span>&nbsp;<span class="op" id="6230463">:=</span>&nbsp;<span class="ident" id="6230466">filepath</span><span class="op" id="6230474">.</span><span class="ident" id="6230475">EvalSymlinks</span><span class="op" id="6230487">(</span><span class="ident" id="6230488">dir</span><span class="op" id="6230491">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230495">if</span>&nbsp;<span class="ident" id="6230498">rel</span><span class="op" id="6230501">,</span>&nbsp;<span class="ident" id="6230503">ok</span>&nbsp;<span class="op" id="6230506">=</span>&nbsp;<span class="ident" id="6230508">hasSubdir</span><span class="op" id="6230517">(</span><span class="ident" id="6230518">rootSym</span><span class="op" id="6230525">,</span>&nbsp;<span class="ident" id="6230527">dir</span><span class="op" id="6230530">)</span><span class="op" id="6230531">;</span>&nbsp;<span class="ident" id="6230533">ok</span>&nbsp;<span class="op" id="6230536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230540">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230551">if</span>&nbsp;<span class="ident" id="6230554">rel</span><span class="op" id="6230557">,</span>&nbsp;<span class="ident" id="6230559">ok</span>&nbsp;<span class="op" id="6230562">=</span>&nbsp;<span class="ident" id="6230564">hasSubdir</span><span class="op" id="6230573">(</span><span class="ident" id="6230574">root</span><span class="op" id="6230578">,</span>&nbsp;<span class="ident" id="6230580">dirSym</span><span class="op" id="6230586">)</span><span class="op" id="6230587">;</span>&nbsp;<span class="ident" id="6230589">ok</span>&nbsp;<span class="op" id="6230592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230596">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230607">return</span>&nbsp;<span class="ident" id="6230614">hasSubdir</span><span class="op" id="6230623">(</span><span class="ident" id="6230624">rootSym</span><span class="op" id="6230631">,</span>&nbsp;<span class="ident" id="6230633">dirSym</span><span class="op" id="6230639">)</span><br>
<span class="lineno">155</span><span class="op" id="6230641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6230644">func</span>&nbsp;<span class="ident" id="6230649">hasSubdir</span><span class="op" id="6230658">(</span><span class="ident" id="6230659">root</span><span class="op" id="6230663">,</span>&nbsp;<span class="ident" id="6230665">dir</span>&nbsp;<span class="builtintype" id="6230669">string</span><span class="op" id="6230675">)</span>&nbsp;<span class="op" id="6230677">(</span><span class="ident" id="6230678">rel</span>&nbsp;<span class="builtintype" id="6230682">string</span><span class="op" id="6230688">,</span>&nbsp;<span class="ident" id="6230690">ok</span>&nbsp;<span class="builtintype" id="6230693">bool</span><span class="op" id="6230697">)</span>&nbsp;<span class="op" id="6230699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230702">const</span>&nbsp;<span class="ident" id="6230708">sep</span>&nbsp;<span class="op" id="6230712">=</span>&nbsp;<span class="builtintype" id="6230714">string</span><span class="op" id="6230720">(</span><span class="ident" id="6230721">filepath</span><span class="op" id="6230729">.</span><span class="ident" id="6230730">Separator</span><span class="op" id="6230739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230742">root</span>&nbsp;<span class="op" id="6230747">=</span>&nbsp;<span class="ident" id="6230749">filepath</span><span class="op" id="6230757">.</span><span class="ident" id="6230758">Clean</span><span class="op" id="6230763">(</span><span class="ident" id="6230764">root</span><span class="op" id="6230768">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230771">if</span>&nbsp;<span class="op" id="6230774">!</span><span class="ident" id="6230775">strings</span><span class="op" id="6230782">.</span><span class="ident" id="6230783">HasSuffix</span><span class="op" id="6230792">(</span><span class="ident" id="6230793">root</span><span class="op" id="6230797">,</span>&nbsp;<span class="ident" id="6230799">sep</span><span class="op" id="6230802">)</span>&nbsp;<span class="op" id="6230804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230808">root</span>&nbsp;<span class="op" id="6230813">+=</span>&nbsp;<span class="ident" id="6230816">sep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6230824">dir</span>&nbsp;<span class="op" id="6230828">=</span>&nbsp;<span class="ident" id="6230830">filepath</span><span class="op" id="6230838">.</span><span class="ident" id="6230839">Clean</span><span class="op" id="6230844">(</span><span class="ident" id="6230845">dir</span><span class="op" id="6230848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230851">if</span>&nbsp;<span class="op" id="6230854">!</span><span class="ident" id="6230855">strings</span><span class="op" id="6230862">.</span><span class="ident" id="6230863">HasPrefix</span><span class="op" id="6230872">(</span><span class="ident" id="6230873">dir</span><span class="op" id="6230876">,</span>&nbsp;<span class="ident" id="6230878">root</span><span class="op" id="6230882">)</span>&nbsp;<span class="op" id="6230884">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230888">return</span>&nbsp;<span class="string" id="6230895">&#34;&#34;</span><span class="op" id="6230897">,</span>&nbsp;<span class="builtintype" id="6230899">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6230906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6230909">return</span>&nbsp;<span class="ident" id="6230916">filepath</span><span class="op" id="6230924">.</span><span class="ident" id="6230925">ToSlash</span><span class="op" id="6230932">(</span><span class="ident" id="6230933">dir</span><span class="op" id="6230936">[</span><span class="builtinfunc" id="6230937">len</span><span class="op" id="6230940">(</span><span class="ident" id="6230941">root</span><span class="op" id="6230945">)</span><span class="op" id="6230946">:</span><span class="op" id="6230947">]</span><span class="op" id="6230948">)</span><span class="op" id="6230949">,</span>&nbsp;<span class="builtintype" id="6230951">true</span><br>
<span class="lineno"></span><span class="op" id="6230956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="comment" id="6230959">//&nbsp;readDir&nbsp;calls&nbsp;ctxt.ReadDir&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;ioutil.ReadDir.</span><br>
<span class="lineno"></span><span class="keyword" id="6231026">func</span>&nbsp;<span class="op" id="6231031">(</span><span class="ident" id="6231032">ctxt</span>&nbsp;<span class="op" id="6231037">*</span><span class="ident" id="6231038">Context</span><span class="op" id="6231045">)</span>&nbsp;<span class="ident" id="6231047">readDir</span><span class="op" id="6231054">(</span><span class="ident" id="6231055">path</span>&nbsp;<span class="builtintype" id="6231060">string</span><span class="op" id="6231066">)</span>&nbsp;<span class="op" id="6231068">(</span><span class="op" id="6231069">[</span><span class="op" id="6231070">]</span><span class="ident" id="6231071">os</span><span class="op" id="6231073">.</span><span class="ident" id="6231074">FileInfo</span><span class="op" id="6231082">,</span>&nbsp;<span class="builtintype" id="6231084">error</span><span class="op" id="6231089">)</span>&nbsp;<span class="op" id="6231091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6231094">if</span>&nbsp;<span class="ident" id="6231097">f</span>&nbsp;<span class="op" id="6231099">:=</span>&nbsp;<span class="ident" id="6231102">ctxt</span><span class="op" id="6231106">.</span><span class="ident" id="6231107">ReadDir</span><span class="op" id="6231114">;</span>&nbsp;<span class="ident" id="6231116">f</span>&nbsp;<span class="op" id="6231118">!=</span>&nbsp;<span class="ident" id="6231121">nil</span>&nbsp;<span class="op" id="6231125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6231129">return</span>&nbsp;<span class="ident" id="6231136">f</span><span class="op" id="6231137">(</span><span class="ident" id="6231138">path</span><span class="op" id="6231142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6231145">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6231148">return</span>&nbsp;<span class="ident" id="6231155">ioutil</span><span class="op" id="6231161">.</span><span class="ident" id="6231162">ReadDir</span><span class="op" id="6231169">(</span><span class="ident" id="6231170">path</span><span class="op" id="6231174">)</span><br>
<span class="lineno"></span><span class="op" id="6231176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6231179">//&nbsp;openFile&nbsp;calls&nbsp;ctxt.OpenFile&nbsp;(if&nbsp;not&nbsp;nil)&nbsp;or&nbsp;else&nbsp;os.Open.</span><br>
<span class="lineno"></span><span class="keyword" id="6231241">func</span>&nbsp;<span class="op" id="6231246">(</span><span class="ident" id="6231247">ctxt</span>&nbsp;<span class="op" id="6231252">*</span><span class="ident" id="6231253">Context</span><span class="op" id="6231260">)</span>&nbsp;<span class="ident" id="6231262">openFile</span><span class="op" id="6231270">(</span><span class="ident" id="6231271">path</span>&nbsp;<span class="builtintype" id="6231276">string</span><span class="op" id="6231282">)</span>&nbsp;<span class="op" id="6231284">(</span><span class="ident" id="6231285">io</span><span class="op" id="6231287">.</span><span class="ident" id="6231288">ReadCloser</span><span class="op" id="6231298">,</span>&nbsp;<span class="builtintype" id="6231300">error</span><span class="op" id="6231305">)</span>&nbsp;<span class="op" id="6231307">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6231310">if</span>&nbsp;<span class="ident" id="6231313">fn</span>&nbsp;<span class="op" id="6231316">:=</span>&nbsp;<span class="ident" id="6231319">ctxt</span><span class="op" id="6231323">.</span><span class="ident" id="6231324">OpenFile</span><span class="op" id="6231332">;</span>&nbsp;<span class="ident" id="6231334">fn</span>&nbsp;<span class="op" id="6231337">!=</span>&nbsp;<span class="ident" id="6231340">nil</span>&nbsp;<span class="op" id="6231344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6231348">return</span>&nbsp;<span class="ident" id="6231355">fn</span><span class="op" id="6231357">(</span><span class="ident" id="6231358">path</span><span class="op" id="6231362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6231365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6231369">f</span><span class="op" id="6231370">,</span>&nbsp;<span class="ident" id="6231372">err</span>&nbsp;<span class="op" id="6231376">:=</span>&nbsp;<span class="ident" id="6231379">os</span><span class="op" id="6231381">.</span><span class="ident" id="6231382">Open</span><span class="op" id="6231386">(</span><span class="ident" id="6231387">path</span><span class="op" id="6231391">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6231394">if</span>&nbsp;<span class="ident" id="6231397">err</span>&nbsp;<span class="op" id="6231401">!=</span>&nbsp;<span class="ident" id="6231404">nil</span>&nbsp;<span class="op" id="6231408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6231412">return</span>&nbsp;<span class="ident" id="6231419">nil</span><span class="op" id="6231422">,</span>&nbsp;<span class="ident" id="6231424">err</span>&nbsp;<span class="comment" id="6231428">//&nbsp;nil&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6231446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6231449">return</span>&nbsp;<span class="ident" id="6231456">f</span><span class="op" id="6231457">,</span>&nbsp;<span class="ident" id="6231459">nil</span><br>
<span class="lineno"></span><span class="op" id="6231463">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="6231466">//&nbsp;isFile&nbsp;determines&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;file&nbsp;by&nbsp;trying&nbsp;to&nbsp;open&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6231532">//&nbsp;It&nbsp;reuses&nbsp;openFile&nbsp;instead&nbsp;of&nbsp;adding&nbsp;another&nbsp;function&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6231596">//&nbsp;list&nbsp;in&nbsp;Context.</span><br>
<span class="lineno"></span><span class="keyword" id="6231616">func</span>&nbsp;<span class="op" id="6231621">(</span><span class="ident" id="6231622">ctxt</span>&nbsp;<span class="op" id="6231627">*</span><span class="ident" id="6231628">Context</span><span class="op" id="6231635">)</span>&nbsp;<span class="ident" id="6231637">isFile</span><span class="op" id="6231643">(</span><span class="ident" id="6231644">path</span>&nbsp;<span class="builtintype" id="6231649">string</span><span class="op" id="6231655">)</span>&nbsp;<span class="builtintype" id="6231657">bool</span>&nbsp;<span class="op" id="6231662">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6231665">f</span><span class="op" id="6231666">,</span>&nbsp;<span class="ident" id="6231668">err</span>&nbsp;<span class="op" id="6231672">:=</span>&nbsp;<span class="ident" id="6231675">ctxt</span><span class="op" id="6231679">.</span><span class="ident" id="6231680">openFile</span><span class="op" id="6231688">(</span><span class="ident" id="6231689">path</span><span class="op" id="6231693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6231696">if</span>&nbsp;<span class="ident" id="6231699">err</span>&nbsp;<span class="op" id="6231703">!=</span>&nbsp;<span class="ident" id="6231706">nil</span>&nbsp;<span class="op" id="6231710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6231714">return</span>&nbsp;<span class="builtintype" id="6231721">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6231728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6231731">f</span><span class="op" id="6231732">.</span><span class="ident" id="6231733">Close</span><span class="op" id="6231738">(</span><span class="op" id="6231739">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6231742">return</span>&nbsp;<span class="builtintype" id="6231749">true</span><br>
<span class="lineno"></span><span class="op" id="6231754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6231757">//&nbsp;gopath&nbsp;returns&nbsp;the&nbsp;list&nbsp;of&nbsp;Go&nbsp;path&nbsp;directories.</span><br>
<span class="lineno"></span><span class="keyword" id="6231808">func</span>&nbsp;<span class="op" id="6231813">(</span><span class="ident" id="6231814">ctxt</span>&nbsp;<span class="op" id="6231819">*</span><span class="ident" id="6231820">Context</span><span class="op" id="6231827">)</span>&nbsp;<span class="ident" id="6231829">gopath</span><span class="op" id="6231835">(</span><span class="op" id="6231836">)</span>&nbsp;<span class="op" id="6231838">[</span><span class="op" id="6231839">]</span><span class="builtintype" id="6231840">string</span>&nbsp;<span class="op" id="6231847">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6231850">var</span>&nbsp;<span class="ident" id="6231854">all</span>&nbsp;<span class="op" id="6231858">[</span><span class="op" id="6231859">]</span><span class="builtintype" id="6231860">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6231868">for</span>&nbsp;<span class="ident" id="6231872">_</span><span class="op" id="6231873">,</span>&nbsp;<span class="ident" id="6231875">p</span>&nbsp;<span class="op" id="6231877">:=</span>&nbsp;<span class="keyword" id="6231880">range</span>&nbsp;<span class="ident" id="6231886">ctxt</span><span class="op" id="6231890">.</span><span class="ident" id="6231891">splitPathList</span><span class="op" id="6231904">(</span><span class="ident" id="6231905">ctxt</span><span class="op" id="6231909">.</span><span class="ident" id="6231910">GOPATH</span><span class="op" id="6231916">)</span>&nbsp;<span class="op" id="6231918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6231922">if</span>&nbsp;<span class="ident" id="6231925">p</span>&nbsp;<span class="op" id="6231927">==</span>&nbsp;<span class="string" id="6231930">&#34;&#34;</span>&nbsp;<span class="op" id="6231933">||</span>&nbsp;<span class="ident" id="6231936">p</span>&nbsp;<span class="op" id="6231938">==</span>&nbsp;<span class="ident" id="6231941">ctxt</span><span class="op" id="6231945">.</span><span class="ident" id="6231946">GOROOT</span>&nbsp;<span class="op" id="6231953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6231958">//&nbsp;Empty&nbsp;paths&nbsp;are&nbsp;uninteresting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6231995">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;the&nbsp;GOROOT,&nbsp;ignore&nbsp;it.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232039">//&nbsp;People&nbsp;sometimes&nbsp;set&nbsp;GOPATH=$GOROOT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232082">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this&nbsp;common&nbsp;mistake.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6232132">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6232143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6232147">if</span>&nbsp;<span class="ident" id="6232150">strings</span><span class="op" id="6232157">.</span><span class="ident" id="6232158">HasPrefix</span><span class="op" id="6232167">(</span><span class="ident" id="6232168">p</span><span class="op" id="6232169">,</span>&nbsp;<span class="string" id="6232171">&#34;~&#34;</span><span class="op" id="6232174">)</span>&nbsp;<span class="op" id="6232176">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232181">//&nbsp;Path&nbsp;segments&nbsp;starting&nbsp;with&nbsp;~&nbsp;on&nbsp;Unix&nbsp;are&nbsp;almost&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232243">//&nbsp;users&nbsp;who&nbsp;have&nbsp;incorrectly&nbsp;quoted&nbsp;~&nbsp;while&nbsp;setting&nbsp;GOPATH,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232307">//&nbsp;preventing&nbsp;it&nbsp;from&nbsp;expanding&nbsp;to&nbsp;$HOME.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232352">//&nbsp;The&nbsp;situation&nbsp;is&nbsp;made&nbsp;more&nbsp;confusing&nbsp;by&nbsp;the&nbsp;fact&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232412">//&nbsp;bash&nbsp;allows&nbsp;quoted&nbsp;~&nbsp;in&nbsp;$PATH&nbsp;(most&nbsp;shells&nbsp;do&nbsp;not).</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232470">//&nbsp;Do&nbsp;not&nbsp;get&nbsp;confused&nbsp;by&nbsp;this,&nbsp;and&nbsp;do&nbsp;not&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232537">//&nbsp;It&nbsp;does&nbsp;not&nbsp;exist,&nbsp;and&nbsp;printing&nbsp;errors&nbsp;about&nbsp;it&nbsp;confuses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232600">//&nbsp;those&nbsp;users&nbsp;even&nbsp;more,&nbsp;because&nbsp;they&nbsp;think&nbsp;&#34;sure&nbsp;~&nbsp;exists!&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232666">//&nbsp;The&nbsp;go&nbsp;command&nbsp;diagnoses&nbsp;this&nbsp;situation&nbsp;and&nbsp;prints&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232725">//&nbsp;useful&nbsp;error.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232745">//&nbsp;On&nbsp;Windows,&nbsp;~&nbsp;is&nbsp;used&nbsp;in&nbsp;short&nbsp;names,&nbsp;such&nbsp;as&nbsp;c:\progra~1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6232809">//&nbsp;for&nbsp;c:\program&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6232837">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6232848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6232852">all</span>&nbsp;<span class="op" id="6232856">=</span>&nbsp;<span class="builtinfunc" id="6232858">append</span><span class="op" id="6232864">(</span><span class="ident" id="6232865">all</span><span class="op" id="6232868">,</span>&nbsp;<span class="ident" id="6232870">p</span><span class="op" id="6232871">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6232874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6232877">return</span>&nbsp;<span class="ident" id="6232884">all</span><br>
<span class="lineno"></span><span class="op" id="6232888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6232891">//&nbsp;SrcDirs&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;package&nbsp;source&nbsp;root&nbsp;directories.</span><br>
<span class="lineno">235</span><span class="comment" id="6232953">//&nbsp;It&nbsp;draws&nbsp;from&nbsp;the&nbsp;current&nbsp;Go&nbsp;root&nbsp;and&nbsp;Go&nbsp;path&nbsp;but&nbsp;omits&nbsp;directories</span><br>
<span class="lineno"></span><span class="comment" id="6233024">//&nbsp;that&nbsp;do&nbsp;not&nbsp;exist.</span><br>
<span class="lineno"></span><span class="keyword" id="6233046">func</span>&nbsp;<span class="op" id="6233051">(</span><span class="ident" id="6233052">ctxt</span>&nbsp;<span class="op" id="6233057">*</span><span class="ident" id="6233058">Context</span><span class="op" id="6233065">)</span>&nbsp;<span class="ident" id="6233067">SrcDirs</span><span class="op" id="6233074">(</span><span class="op" id="6233075">)</span>&nbsp;<span class="op" id="6233077">[</span><span class="op" id="6233078">]</span><span class="builtintype" id="6233079">string</span>&nbsp;<span class="op" id="6233086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233089">var</span>&nbsp;<span class="ident" id="6233093">all</span>&nbsp;<span class="op" id="6233097">[</span><span class="op" id="6233098">]</span><span class="builtintype" id="6233099">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233107">if</span>&nbsp;<span class="ident" id="6233110">ctxt</span><span class="op" id="6233114">.</span><span class="ident" id="6233115">GOROOT</span>&nbsp;<span class="op" id="6233122">!=</span>&nbsp;<span class="string" id="6233125">&#34;&#34;</span>&nbsp;<span class="op" id="6233128">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233132">dir</span>&nbsp;<span class="op" id="6233136">:=</span>&nbsp;<span class="ident" id="6233139">ctxt</span><span class="op" id="6233143">.</span><span class="ident" id="6233144">joinPath</span><span class="op" id="6233152">(</span><span class="ident" id="6233153">ctxt</span><span class="op" id="6233157">.</span><span class="ident" id="6233158">GOROOT</span><span class="op" id="6233164">,</span>&nbsp;<span class="string" id="6233166">&#34;src&#34;</span><span class="op" id="6233171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233175">if</span>&nbsp;<span class="ident" id="6233178">ctxt</span><span class="op" id="6233182">.</span><span class="ident" id="6233183">isDir</span><span class="op" id="6233188">(</span><span class="ident" id="6233189">dir</span><span class="op" id="6233192">)</span>&nbsp;<span class="op" id="6233194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233199">all</span>&nbsp;<span class="op" id="6233203">=</span>&nbsp;<span class="builtinfunc" id="6233205">append</span><span class="op" id="6233211">(</span><span class="ident" id="6233212">all</span><span class="op" id="6233215">,</span>&nbsp;<span class="ident" id="6233217">dir</span><span class="op" id="6233220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6233224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6233227">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233230">for</span>&nbsp;<span class="ident" id="6233234">_</span><span class="op" id="6233235">,</span>&nbsp;<span class="ident" id="6233237">p</span>&nbsp;<span class="op" id="6233239">:=</span>&nbsp;<span class="keyword" id="6233242">range</span>&nbsp;<span class="ident" id="6233248">ctxt</span><span class="op" id="6233252">.</span><span class="ident" id="6233253">gopath</span><span class="op" id="6233259">(</span><span class="op" id="6233260">)</span>&nbsp;<span class="op" id="6233262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233266">dir</span>&nbsp;<span class="op" id="6233270">:=</span>&nbsp;<span class="ident" id="6233273">ctxt</span><span class="op" id="6233277">.</span><span class="ident" id="6233278">joinPath</span><span class="op" id="6233286">(</span><span class="ident" id="6233287">p</span><span class="op" id="6233288">,</span>&nbsp;<span class="string" id="6233290">&#34;src&#34;</span><span class="op" id="6233295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233299">if</span>&nbsp;<span class="ident" id="6233302">ctxt</span><span class="op" id="6233306">.</span><span class="ident" id="6233307">isDir</span><span class="op" id="6233312">(</span><span class="ident" id="6233313">dir</span><span class="op" id="6233316">)</span>&nbsp;<span class="op" id="6233318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6233323">all</span>&nbsp;<span class="op" id="6233327">=</span>&nbsp;<span class="builtinfunc" id="6233329">append</span><span class="op" id="6233335">(</span><span class="ident" id="6233336">all</span><span class="op" id="6233339">,</span>&nbsp;<span class="ident" id="6233341">dir</span><span class="op" id="6233344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6233348">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6233351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6233354">return</span>&nbsp;<span class="ident" id="6233361">all</span><br>
<span class="lineno"></span><span class="op" id="6233365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6233368">//&nbsp;Default&nbsp;is&nbsp;the&nbsp;default&nbsp;Context&nbsp;for&nbsp;builds.</span><br>
<span class="lineno">255</span><span class="comment" id="6233414">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;GOARCH,&nbsp;GOOS,&nbsp;GOROOT,&nbsp;and&nbsp;GOPATH&nbsp;environment&nbsp;variables</span><br>
<span class="lineno"></span><span class="comment" id="6233484">//&nbsp;if&nbsp;set,&nbsp;or&nbsp;else&nbsp;the&nbsp;compiled&nbsp;code&#39;s&nbsp;GOARCH,&nbsp;GOOS,&nbsp;and&nbsp;GOROOT.</span><br>
<span class="lineno"></span><span class="keyword" id="6233549">var</span>&nbsp;<span class="ident" id="6233553">Default</span>&nbsp;<span class="ident" id="6233561">Context</span>&nbsp;<span class="op" id="6233569">=</span>&nbsp;<span class="ident" id="6233571">defaultContext</span><span class="op" id="6233585">(</span><span class="op" id="6233586">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6233589">var</span>&nbsp;<span class="ident" id="6233593">cgoEnabled</span>&nbsp;<span class="op" id="6233604">=</span>&nbsp;<span class="keyword" id="6233606">map</span><span class="op" id="6233609">[</span><span class="builtintype" id="6233610">string</span><span class="op" id="6233616">]</span><span class="builtintype" id="6233617">bool</span><span class="op" id="6233621">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233624">&#34;darwin/386&#34;</span><span class="op" id="6233636">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6233643">true</span><span class="op" id="6233647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233650">&#34;darwin/amd64&#34;</span><span class="op" id="6233664">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6233669">true</span><span class="op" id="6233673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233676">&#34;dragonfly/386&#34;</span><span class="op" id="6233691">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6233695">true</span><span class="op" id="6233699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233702">&#34;dragonfly/amd64&#34;</span><span class="op" id="6233719">:</span>&nbsp;<span class="builtintype" id="6233721">true</span><span class="op" id="6233725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233728">&#34;freebsd/386&#34;</span><span class="op" id="6233741">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6233747">true</span><span class="op" id="6233751">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233754">&#34;freebsd/amd64&#34;</span><span class="op" id="6233769">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6233773">true</span><span class="op" id="6233777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233780">&#34;freebsd/arm&#34;</span><span class="op" id="6233793">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6233799">true</span><span class="op" id="6233803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233806">&#34;linux/386&#34;</span><span class="op" id="6233817">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6233825">true</span><span class="op" id="6233829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233832">&#34;linux/amd64&#34;</span><span class="op" id="6233845">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6233851">true</span><span class="op" id="6233855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233858">&#34;linux/arm&#34;</span><span class="op" id="6233869">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6233877">true</span><span class="op" id="6233881">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233884">&#34;android/386&#34;</span><span class="op" id="6233897">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6233903">true</span><span class="op" id="6233907">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233910">&#34;android/amd64&#34;</span><span class="op" id="6233925">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6233929">true</span><span class="op" id="6233933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233936">&#34;android/arm&#34;</span><span class="op" id="6233949">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6233955">true</span><span class="op" id="6233959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233962">&#34;netbsd/386&#34;</span><span class="op" id="6233974">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6233981">true</span><span class="op" id="6233985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6233988">&#34;netbsd/amd64&#34;</span><span class="op" id="6234002">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6234007">true</span><span class="op" id="6234011">,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6234014">&#34;netbsd/arm&#34;</span><span class="op" id="6234026">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6234033">true</span><span class="op" id="6234037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6234040">&#34;openbsd/386&#34;</span><span class="op" id="6234053">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6234059">true</span><span class="op" id="6234063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6234066">&#34;openbsd/amd64&#34;</span><span class="op" id="6234081">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6234085">true</span><span class="op" id="6234089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6234092">&#34;windows/386&#34;</span><span class="op" id="6234105">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6234111">true</span><span class="op" id="6234115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6234118">&#34;windows/amd64&#34;</span><span class="op" id="6234133">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6234137">true</span><span class="op" id="6234141">,</span><br>
<span class="lineno">280</span><span class="op" id="6234143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6234146">func</span>&nbsp;<span class="ident" id="6234151">defaultContext</span><span class="op" id="6234165">(</span><span class="op" id="6234166">)</span>&nbsp;<span class="ident" id="6234168">Context</span>&nbsp;<span class="op" id="6234176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234179">var</span>&nbsp;<span class="ident" id="6234183">c</span>&nbsp;<span class="ident" id="6234185">Context</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234195">c</span><span class="op" id="6234196">.</span><span class="ident" id="6234197">GOARCH</span>&nbsp;<span class="op" id="6234204">=</span>&nbsp;<span class="ident" id="6234206">envOr</span><span class="op" id="6234211">(</span><span class="string" id="6234212">&#34;GOARCH&#34;</span><span class="op" id="6234220">,</span>&nbsp;<span class="ident" id="6234222">runtime</span><span class="op" id="6234229">.</span><span class="ident" id="6234230">GOARCH</span><span class="op" id="6234236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234239">c</span><span class="op" id="6234240">.</span><span class="ident" id="6234241">GOOS</span>&nbsp;<span class="op" id="6234246">=</span>&nbsp;<span class="ident" id="6234248">envOr</span><span class="op" id="6234253">(</span><span class="string" id="6234254">&#34;GOOS&#34;</span><span class="op" id="6234260">,</span>&nbsp;<span class="ident" id="6234262">runtime</span><span class="op" id="6234269">.</span><span class="ident" id="6234270">GOOS</span><span class="op" id="6234274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234277">c</span><span class="op" id="6234278">.</span><span class="ident" id="6234279">GOROOT</span>&nbsp;<span class="op" id="6234286">=</span>&nbsp;<span class="ident" id="6234288">runtime</span><span class="op" id="6234295">.</span><span class="ident" id="6234296">GOROOT</span><span class="op" id="6234302">(</span><span class="op" id="6234303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234306">c</span><span class="op" id="6234307">.</span><span class="ident" id="6234308">GOPATH</span>&nbsp;<span class="op" id="6234315">=</span>&nbsp;<span class="ident" id="6234317">envOr</span><span class="op" id="6234322">(</span><span class="string" id="6234323">&#34;GOPATH&#34;</span><span class="op" id="6234331">,</span>&nbsp;<span class="string" id="6234333">&#34;&#34;</span><span class="op" id="6234335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234338">c</span><span class="op" id="6234339">.</span><span class="ident" id="6234340">Compiler</span>&nbsp;<span class="op" id="6234349">=</span>&nbsp;<span class="ident" id="6234351">runtime</span><span class="op" id="6234358">.</span><span class="ident" id="6234359">Compiler</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6234370">//&nbsp;Each&nbsp;major&nbsp;Go&nbsp;release&nbsp;in&nbsp;the&nbsp;Go&nbsp;1.x&nbsp;series&nbsp;should&nbsp;add&nbsp;a&nbsp;tag&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6234440">//&nbsp;Old&nbsp;tags&nbsp;should&nbsp;not&nbsp;be&nbsp;removed.&nbsp;That&nbsp;is,&nbsp;the&nbsp;go1.x&nbsp;tag&nbsp;is&nbsp;present</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6234510">//&nbsp;in&nbsp;all&nbsp;releases&nbsp;&gt;=&nbsp;Go&nbsp;1.x.&nbsp;Code&nbsp;that&nbsp;requires&nbsp;Go&nbsp;1.x&nbsp;or&nbsp;later&nbsp;should</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6234583">//&nbsp;say&nbsp;&#34;+build&nbsp;go1.x&#34;,&nbsp;and&nbsp;code&nbsp;that&nbsp;should&nbsp;only&nbsp;be&nbsp;built&nbsp;before&nbsp;Go&nbsp;1.x</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6234656">//&nbsp;(perhaps&nbsp;it&nbsp;is&nbsp;the&nbsp;stub&nbsp;to&nbsp;use&nbsp;in&nbsp;that&nbsp;case)&nbsp;should&nbsp;say&nbsp;&#34;+build&nbsp;!go1.x&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6234733">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6234737">//&nbsp;When&nbsp;we&nbsp;reach&nbsp;Go&nbsp;1.5&nbsp;the&nbsp;line&nbsp;will&nbsp;read</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6234781">//&nbsp;&nbsp;&nbsp;&nbspc.ReleaseTags&nbsp;=&nbsp;[]string{&#34;go1.1&#34;,&nbsp;&#34;go1.2&#34;,&nbsp;&#34;go1.3&#34;,&nbsp;&#34;go1.4&#34;,&nbsp;&#34;go1.5&#34;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6234855">//&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234870">c</span><span class="op" id="6234871">.</span><span class="ident" id="6234872">ReleaseTags</span>&nbsp;<span class="op" id="6234884">=</span>&nbsp;<span class="op" id="6234886">[</span><span class="op" id="6234887">]</span><span class="builtintype" id="6234888">string</span><span class="op" id="6234894">{</span><span class="string" id="6234895">&#34;go1.1&#34;</span><span class="op" id="6234902">,</span>&nbsp;<span class="string" id="6234904">&#34;go1.2&#34;</span><span class="op" id="6234911">,</span>&nbsp;<span class="string" id="6234913">&#34;go1.3&#34;</span><span class="op" id="6234920">,</span>&nbsp;<span class="string" id="6234922">&#34;go1.4&#34;</span><span class="op" id="6234929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234933">switch</span>&nbsp;<span class="ident" id="6234940">os</span><span class="op" id="6234942">.</span><span class="ident" id="6234943">Getenv</span><span class="op" id="6234949">(</span><span class="string" id="6234950">&#34;CGO_ENABLED&#34;</span><span class="op" id="6234963">)</span>&nbsp;<span class="op" id="6234965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6234968">case</span>&nbsp;<span class="string" id="6234973">&#34;1&#34;</span><span class="op" id="6234976">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6234980">c</span><span class="op" id="6234981">.</span><span class="ident" id="6234982">CgoEnabled</span>&nbsp;<span class="op" id="6234993">=</span>&nbsp;<span class="builtintype" id="6234995">true</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235001">case</span>&nbsp;<span class="string" id="6235006">&#34;0&#34;</span><span class="op" id="6235009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235013">c</span><span class="op" id="6235014">.</span><span class="ident" id="6235015">CgoEnabled</span>&nbsp;<span class="op" id="6235026">=</span>&nbsp;<span class="builtintype" id="6235028">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235035">default</span><span class="op" id="6235042">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6235046">//&nbsp;cgo&nbsp;must&nbsp;be&nbsp;explicitly&nbsp;enabled&nbsp;for&nbsp;cross&nbsp;compilation&nbsp;builds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235111">if</span>&nbsp;<span class="ident" id="6235114">runtime</span><span class="op" id="6235121">.</span><span class="ident" id="6235122">GOARCH</span>&nbsp;<span class="op" id="6235129">==</span>&nbsp;<span class="ident" id="6235132">c</span><span class="op" id="6235133">.</span><span class="ident" id="6235134">GOARCH</span>&nbsp;<span class="op" id="6235141">&amp;&amp;</span>&nbsp;<span class="ident" id="6235144">runtime</span><span class="op" id="6235151">.</span><span class="ident" id="6235152">GOOS</span>&nbsp;<span class="op" id="6235157">==</span>&nbsp;<span class="ident" id="6235160">c</span><span class="op" id="6235161">.</span><span class="ident" id="6235162">GOOS</span>&nbsp;<span class="op" id="6235167">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235172">c</span><span class="op" id="6235173">.</span><span class="ident" id="6235174">CgoEnabled</span>&nbsp;<span class="op" id="6235185">=</span>&nbsp;<span class="ident" id="6235187">cgoEnabled</span><span class="op" id="6235197">[</span><span class="ident" id="6235198">c</span><span class="op" id="6235199">.</span><span class="ident" id="6235200">GOOS</span><span class="op" id="6235204">+</span><span class="string" id="6235205">&#34;/&#34;</span><span class="op" id="6235208">+</span><span class="ident" id="6235209">c</span><span class="op" id="6235210">.</span><span class="ident" id="6235211">GOARCH</span><span class="op" id="6235217">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235222">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6235230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235234">c</span><span class="op" id="6235235">.</span><span class="ident" id="6235236">CgoEnabled</span>&nbsp;<span class="op" id="6235247">=</span>&nbsp;<span class="builtintype" id="6235249">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6235256">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235260">return</span>&nbsp;<span class="ident" id="6235267">c</span><br>
<span class="lineno"></span><span class="op" id="6235269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6235272">func</span>&nbsp;<span class="ident" id="6235277">envOr</span><span class="op" id="6235282">(</span><span class="ident" id="6235283">name</span><span class="op" id="6235287">,</span>&nbsp;<span class="ident" id="6235289">def</span>&nbsp;<span class="builtintype" id="6235293">string</span><span class="op" id="6235299">)</span>&nbsp;<span class="builtintype" id="6235301">string</span>&nbsp;<span class="op" id="6235308">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235311">s</span>&nbsp;<span class="op" id="6235313">:=</span>&nbsp;<span class="ident" id="6235316">os</span><span class="op" id="6235318">.</span><span class="ident" id="6235319">Getenv</span><span class="op" id="6235325">(</span><span class="ident" id="6235326">name</span><span class="op" id="6235330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235333">if</span>&nbsp;<span class="ident" id="6235336">s</span>&nbsp;<span class="op" id="6235338">==</span>&nbsp;<span class="string" id="6235341">&#34;&#34;</span>&nbsp;<span class="op" id="6235344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235348">return</span>&nbsp;<span class="ident" id="6235355">def</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6235360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6235363">return</span>&nbsp;<span class="ident" id="6235370">s</span><br>
<span class="lineno">325</span><span class="op" id="6235372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6235375">//&nbsp;An&nbsp;ImportMode&nbsp;controls&nbsp;the&nbsp;behavior&nbsp;of&nbsp;the&nbsp;Import&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="6235436">type</span>&nbsp;<span class="ident" id="6235441">ImportMode</span>&nbsp;<span class="builtintype" id="6235452">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="6235458">const</span>&nbsp;<span class="op" id="6235464">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6235467">//&nbsp;If&nbsp;FindOnly&nbsp;is&nbsp;set,&nbsp;Import&nbsp;stops&nbsp;after&nbsp;locating&nbsp;the&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6235533">//&nbsp;that&nbsp;should&nbsp;contain&nbsp;the&nbsp;sources&nbsp;for&nbsp;a&nbsp;package.&nbsp;&nbsp;It&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6235597">//&nbsp;read&nbsp;any&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235634">FindOnly</span>&nbsp;<span class="ident" id="6235643">ImportMode</span>&nbsp;<span class="op" id="6235654">=</span>&nbsp;<span class="num" id="6235656">1</span>&nbsp;<span class="op" id="6235658">&lt;&lt;</span>&nbsp;<span class="ident" id="6235661">iota</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6235668">//&nbsp;If&nbsp;AllowBinary&nbsp;is&nbsp;set,&nbsp;Import&nbsp;can&nbsp;be&nbsp;satisfied&nbsp;by&nbsp;a&nbsp;compiled</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6235733">//&nbsp;package&nbsp;object&nbsp;without&nbsp;corresponding&nbsp;sources.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6235783">AllowBinary</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6235797">//&nbsp;If&nbsp;ImportComment&nbsp;is&nbsp;set,&nbsp;parse&nbsp;import&nbsp;comments&nbsp;on&nbsp;package&nbsp;statements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6235871">//&nbsp;Import&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;finds&nbsp;a&nbsp;comment&nbsp;it&nbsp;cannot&nbsp;understand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6235942">//&nbsp;or&nbsp;finds&nbsp;conflicting&nbsp;comments&nbsp;in&nbsp;multiple&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6236002">//&nbsp;See&nbsp;golang.org/s/go14customimport&nbsp;for&nbsp;more&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236062">ImportComment</span><br>
<span class="lineno">345</span><span class="op" id="6236076">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6236079">//&nbsp;A&nbsp;Package&nbsp;describes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in&nbsp;a&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="6236139">type</span>&nbsp;<span class="ident" id="6236144">Package</span>&nbsp;<span class="keyword" id="6236152">struct</span>&nbsp;<span class="op" id="6236159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236162">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6236176">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6236185">//&nbsp;directory&nbsp;containing&nbsp;package&nbsp;sources</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236226">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6236240">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6236249">//&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236266">ImportComment</span>&nbsp;<span class="builtintype" id="6236280">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6236289">//&nbsp;path&nbsp;in&nbsp;import&nbsp;comment&nbsp;on&nbsp;package&nbsp;statement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236337">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6236351">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6236360">//&nbsp;documentation&nbsp;synopsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236387">ImportPath</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6236401">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6236410">//&nbsp;import&nbsp;path&nbsp;of&nbsp;package&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236453">Root</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6236467">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6236476">//&nbsp;root&nbsp;of&nbsp;Go&nbsp;tree&nbsp;where&nbsp;this&nbsp;package&nbsp;lives</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236521">SrcRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6236535">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6236544">//&nbsp;package&nbsp;source&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236594">PkgRoot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6236608">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6236617">//&nbsp;package&nbsp;install&nbsp;root&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236668">BinDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6236682">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6236691">//&nbsp;command&nbsp;install&nbsp;directory&nbsp;(&#34;&#34;&nbsp;if&nbsp;unknown)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236737">Goroot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6236751">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6236760">//&nbsp;package&nbsp;found&nbsp;in&nbsp;Go&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236789">PkgObj</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6236803">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6236812">//&nbsp;installed&nbsp;.a&nbsp;file</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236834">AllTags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6236848">[</span><span class="op" id="6236849">]</span><span class="builtintype" id="6236850">string</span>&nbsp;<span class="comment" id="6236857">//&nbsp;tags&nbsp;that&nbsp;can&nbsp;influence&nbsp;file&nbsp;selection&nbsp;in&nbsp;this&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6236918">ConflictDir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6236932">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6236941">//&nbsp;this&nbsp;directory&nbsp;shadows&nbsp;Dir&nbsp;in&nbsp;$GOPATH</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6236984">//&nbsp;Source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237001">GoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6237016">[</span><span class="op" id="6237017">]</span><span class="builtintype" id="6237018">string</span>&nbsp;<span class="comment" id="6237025">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;(excluding&nbsp;CgoFiles,&nbsp;TestGoFiles,&nbsp;XTestGoFiles)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237094">CgoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6237109">[</span><span class="op" id="6237110">]</span><span class="builtintype" id="6237111">string</span>&nbsp;<span class="comment" id="6237118">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;that&nbsp;import&nbsp;&#34;C&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237155">IgnoredGoFiles</span>&nbsp;<span class="op" id="6237170">[</span><span class="op" id="6237171">]</span><span class="builtintype" id="6237172">string</span>&nbsp;<span class="comment" id="6237179">//&nbsp;.go&nbsp;source&nbsp;files&nbsp;ignored&nbsp;for&nbsp;this&nbsp;build</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237223">CFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6237238">[</span><span class="op" id="6237239">]</span><span class="builtintype" id="6237240">string</span>&nbsp;<span class="comment" id="6237247">//&nbsp;.c&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237267">CXXFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6237282">[</span><span class="op" id="6237283">]</span><span class="builtintype" id="6237284">string</span>&nbsp;<span class="comment" id="6237291">//&nbsp;.cc,&nbsp;.cpp&nbsp;and&nbsp;.cxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237327">MFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6237342">[</span><span class="op" id="6237343">]</span><span class="builtintype" id="6237344">string</span>&nbsp;<span class="comment" id="6237351">//&nbsp;.m&nbsp;(Objective-C)&nbsp;source&nbsp;files</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237385">HFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6237400">[</span><span class="op" id="6237401">]</span><span class="builtintype" id="6237402">string</span>&nbsp;<span class="comment" id="6237409">//&nbsp;.h,&nbsp;.hh,&nbsp;.hpp&nbsp;and&nbsp;.hxx&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237449">SFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6237464">[</span><span class="op" id="6237465">]</span><span class="builtintype" id="6237466">string</span>&nbsp;<span class="comment" id="6237473">//&nbsp;.s&nbsp;source&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237493">SwigFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6237508">[</span><span class="op" id="6237509">]</span><span class="builtintype" id="6237510">string</span>&nbsp;<span class="comment" id="6237517">//&nbsp;.swig&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237533">SwigCXXFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6237548">[</span><span class="op" id="6237549">]</span><span class="builtintype" id="6237550">string</span>&nbsp;<span class="comment" id="6237557">//&nbsp;.swigcxx&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237576">SysoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6237591">[</span><span class="op" id="6237592">]</span><span class="builtintype" id="6237593">string</span>&nbsp;<span class="comment" id="6237600">//&nbsp;.syso&nbsp;system&nbsp;object&nbsp;files&nbsp;to&nbsp;add&nbsp;to&nbsp;archive</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6237649">//&nbsp;Cgo&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237668">CgoCFLAGS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6237681">[</span><span class="op" id="6237682">]</span><span class="builtintype" id="6237683">string</span>&nbsp;<span class="comment" id="6237690">//&nbsp;Cgo&nbsp;CFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237716">CgoCPPFLAGS</span>&nbsp;&nbsp;<span class="op" id="6237729">[</span><span class="op" id="6237730">]</span><span class="builtintype" id="6237731">string</span>&nbsp;<span class="comment" id="6237738">//&nbsp;Cgo&nbsp;CPPFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237766">CgoCXXFLAGS</span>&nbsp;&nbsp;<span class="op" id="6237779">[</span><span class="op" id="6237780">]</span><span class="builtintype" id="6237781">string</span>&nbsp;<span class="comment" id="6237788">//&nbsp;Cgo&nbsp;CXXFLAGS&nbsp;directives</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237816">CgoLDFLAGS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6237829">[</span><span class="op" id="6237830">]</span><span class="builtintype" id="6237831">string</span>&nbsp;<span class="comment" id="6237838">//&nbsp;Cgo&nbsp;LDFLAGS&nbsp;directives</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237865">CgoPkgConfig</span>&nbsp;<span class="op" id="6237878">[</span><span class="op" id="6237879">]</span><span class="builtintype" id="6237880">string</span>&nbsp;<span class="comment" id="6237887">//&nbsp;Cgo&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6237918">//&nbsp;Dependency&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6237945">Imports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6237955">[</span><span class="op" id="6237956">]</span><span class="builtintype" id="6237957">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6237983">//&nbsp;imports&nbsp;from&nbsp;GoFiles,&nbsp;CgoFiles</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238018">ImportPos</span>&nbsp;<span class="keyword" id="6238028">map</span><span class="op" id="6238031">[</span><span class="builtintype" id="6238032">string</span><span class="op" id="6238038">]</span><span class="op" id="6238039">[</span><span class="op" id="6238040">]</span><span class="ident" id="6238041">token</span><span class="op" id="6238046">.</span><span class="ident" id="6238047">Position</span>&nbsp;<span class="comment" id="6238056">//&nbsp;line&nbsp;information&nbsp;for&nbsp;Imports</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6238090">//&nbsp;Test&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238111">TestGoFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6238126">[</span><span class="op" id="6238127">]</span><span class="builtintype" id="6238128">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6238154">//&nbsp;_test.go&nbsp;files&nbsp;in&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238184">TestImports</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6238199">[</span><span class="op" id="6238200">]</span><span class="builtintype" id="6238201">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6238227">//&nbsp;imports&nbsp;from&nbsp;TestGoFiles</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238256">TestImportPos</span>&nbsp;&nbsp;<span class="keyword" id="6238271">map</span><span class="op" id="6238274">[</span><span class="builtintype" id="6238275">string</span><span class="op" id="6238281">]</span><span class="op" id="6238282">[</span><span class="op" id="6238283">]</span><span class="ident" id="6238284">token</span><span class="op" id="6238289">.</span><span class="ident" id="6238290">Position</span>&nbsp;<span class="comment" id="6238299">//&nbsp;line&nbsp;information&nbsp;for&nbsp;TestImports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238336">XTestGoFiles</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6238351">[</span><span class="op" id="6238352">]</span><span class="builtintype" id="6238353">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6238379">//&nbsp;_test.go&nbsp;files&nbsp;outside&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238414">XTestImports</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6238429">[</span><span class="op" id="6238430">]</span><span class="builtintype" id="6238431">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6238457">//&nbsp;imports&nbsp;from&nbsp;XTestGoFiles</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6238487">XTestImportPos</span>&nbsp;<span class="keyword" id="6238502">map</span><span class="op" id="6238505">[</span><span class="builtintype" id="6238506">string</span><span class="op" id="6238512">]</span><span class="op" id="6238513">[</span><span class="op" id="6238514">]</span><span class="ident" id="6238515">token</span><span class="op" id="6238520">.</span><span class="ident" id="6238521">Position</span>&nbsp;<span class="comment" id="6238530">//&nbsp;line&nbsp;information&nbsp;for&nbsp;XTestImports</span><br>
<span class="lineno"></span><span class="op" id="6238567">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="6238570">//&nbsp;IsCommand&nbsp;reports&nbsp;whether&nbsp;the&nbsp;package&nbsp;is&nbsp;considered&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6238627">//&nbsp;command&nbsp;to&nbsp;be&nbsp;installed&nbsp;(not&nbsp;just&nbsp;a&nbsp;library).</span><br>
<span class="lineno"></span><span class="comment" id="6238676">//&nbsp;Packages&nbsp;named&nbsp;&#34;main&#34;&nbsp;are&nbsp;treated&nbsp;as&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="6238726">func</span>&nbsp;<span class="op" id="6238731">(</span><span class="ident" id="6238732">p</span>&nbsp;<span class="op" id="6238734">*</span><span class="ident" id="6238735">Package</span><span class="op" id="6238742">)</span>&nbsp;<span class="ident" id="6238744">IsCommand</span><span class="op" id="6238753">(</span><span class="op" id="6238754">)</span>&nbsp;<span class="builtintype" id="6238756">bool</span>&nbsp;<span class="op" id="6238761">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238764">return</span>&nbsp;<span class="ident" id="6238771">p</span><span class="op" id="6238772">.</span><span class="ident" id="6238773">Name</span>&nbsp;<span class="op" id="6238778">==</span>&nbsp;<span class="string" id="6238781">&#34;main&#34;</span><br>
<span class="lineno"></span><span class="op" id="6238788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6238791">//&nbsp;ImportDir&nbsp;is&nbsp;like&nbsp;Import&nbsp;but&nbsp;processes&nbsp;the&nbsp;Go&nbsp;package&nbsp;found&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6238857">//&nbsp;the&nbsp;named&nbsp;directory.</span><br>
<span class="lineno">405</span><span class="keyword" id="6238881">func</span>&nbsp;<span class="op" id="6238886">(</span><span class="ident" id="6238887">ctxt</span>&nbsp;<span class="op" id="6238892">*</span><span class="ident" id="6238893">Context</span><span class="op" id="6238900">)</span>&nbsp;<span class="ident" id="6238902">ImportDir</span><span class="op" id="6238911">(</span><span class="ident" id="6238912">dir</span>&nbsp;<span class="builtintype" id="6238916">string</span><span class="op" id="6238922">,</span>&nbsp;<span class="ident" id="6238924">mode</span>&nbsp;<span class="ident" id="6238929">ImportMode</span><span class="op" id="6238939">)</span>&nbsp;<span class="op" id="6238941">(</span><span class="op" id="6238942">*</span><span class="ident" id="6238943">Package</span><span class="op" id="6238950">,</span>&nbsp;<span class="builtintype" id="6238952">error</span><span class="op" id="6238957">)</span>&nbsp;<span class="op" id="6238959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6238962">return</span>&nbsp;<span class="ident" id="6238969">ctxt</span><span class="op" id="6238973">.</span><span class="ident" id="6238974">Import</span><span class="op" id="6238980">(</span><span class="string" id="6238981">&#34;.&#34;</span><span class="op" id="6238984">,</span>&nbsp;<span class="ident" id="6238986">dir</span><span class="op" id="6238989">,</span>&nbsp;<span class="ident" id="6238991">mode</span><span class="op" id="6238995">)</span><br>
<span class="lineno"></span><span class="op" id="6238997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6239000">//&nbsp;NoGoError&nbsp;is&nbsp;the&nbsp;error&nbsp;used&nbsp;by&nbsp;Import&nbsp;to&nbsp;describe&nbsp;a&nbsp;directory</span><br>
<span class="lineno">410</span><span class="comment" id="6239065">//&nbsp;containing&nbsp;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files.&nbsp;(It&nbsp;may&nbsp;still&nbsp;contain</span><br>
<span class="lineno"></span><span class="comment" id="6239131">//&nbsp;test&nbsp;files,&nbsp;files&nbsp;hidden&nbsp;by&nbsp;build&nbsp;tags,&nbsp;and&nbsp;so&nbsp;on.)</span><br>
<span class="lineno"></span><span class="keyword" id="6239186">type</span>&nbsp;<span class="ident" id="6239191">NoGoError</span>&nbsp;<span class="keyword" id="6239201">struct</span>&nbsp;<span class="op" id="6239208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239211">Dir</span>&nbsp;<span class="builtintype" id="6239215">string</span><br>
<span class="lineno"></span><span class="op" id="6239222">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="6239225">func</span>&nbsp;<span class="op" id="6239230">(</span><span class="ident" id="6239231">e</span>&nbsp;<span class="op" id="6239233">*</span><span class="ident" id="6239234">NoGoError</span><span class="op" id="6239243">)</span>&nbsp;<span class="ident" id="6239245">Error</span><span class="op" id="6239250">(</span><span class="op" id="6239251">)</span>&nbsp;<span class="builtintype" id="6239253">string</span>&nbsp;<span class="op" id="6239260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239263">return</span>&nbsp;<span class="string" id="6239270">&#34;no&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="6239305">+</span>&nbsp;<span class="ident" id="6239307">e</span><span class="op" id="6239308">.</span><span class="ident" id="6239309">Dir</span><br>
<span class="lineno"></span><span class="op" id="6239313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="6239316">//&nbsp;MultiplePackageError&nbsp;describes&nbsp;a&nbsp;directory&nbsp;containing</span><br>
<span class="lineno"></span><span class="comment" id="6239373">//&nbsp;multiple&nbsp;buildable&nbsp;Go&nbsp;source&nbsp;files&nbsp;for&nbsp;multiple&nbsp;packages.</span><br>
<span class="lineno"></span><span class="keyword" id="6239434">type</span>&nbsp;<span class="ident" id="6239439">MultiplePackageError</span>&nbsp;<span class="keyword" id="6239460">struct</span>&nbsp;<span class="op" id="6239467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239470">Dir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6239479">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6239488">//&nbsp;directory&nbsp;containing&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239519">Packages</span>&nbsp;<span class="op" id="6239528">[</span><span class="op" id="6239529">]</span><span class="builtintype" id="6239530">string</span>&nbsp;<span class="comment" id="6239537">//&nbsp;package&nbsp;names&nbsp;found</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239561">Files</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6239570">[</span><span class="op" id="6239571">]</span><span class="builtintype" id="6239572">string</span>&nbsp;<span class="comment" id="6239579">//&nbsp;corresponding&nbsp;files:&nbsp;Files[i]&nbsp;declares&nbsp;package&nbsp;Packages[i]</span><br>
<span class="lineno"></span><span class="op" id="6239641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6239644">func</span>&nbsp;<span class="op" id="6239649">(</span><span class="ident" id="6239650">e</span>&nbsp;<span class="op" id="6239652">*</span><span class="ident" id="6239653">MultiplePackageError</span><span class="op" id="6239673">)</span>&nbsp;<span class="ident" id="6239675">Error</span><span class="op" id="6239680">(</span><span class="op" id="6239681">)</span>&nbsp;<span class="builtintype" id="6239683">string</span>&nbsp;<span class="op" id="6239690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6239693">//&nbsp;Error&nbsp;string&nbsp;limited&nbsp;to&nbsp;two&nbsp;entries&nbsp;for&nbsp;compatibility.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239752">return</span>&nbsp;<span class="ident" id="6239759">fmt</span><span class="op" id="6239762">.</span><span class="ident" id="6239763">Sprintf</span><span class="op" id="6239770">(</span><span class="string" id="6239771">&#34;found&nbsp;packages&nbsp;%s&nbsp;(%s)&nbsp;and&nbsp;%s&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="6239813">,</span>&nbsp;<span class="ident" id="6239815">e</span><span class="op" id="6239816">.</span><span class="ident" id="6239817">Packages</span><span class="op" id="6239825">[</span><span class="num" id="6239826">0</span><span class="op" id="6239827">]</span><span class="op" id="6239828">,</span>&nbsp;<span class="ident" id="6239830">e</span><span class="op" id="6239831">.</span><span class="ident" id="6239832">Files</span><span class="op" id="6239837">[</span><span class="num" id="6239838">0</span><span class="op" id="6239839">]</span><span class="op" id="6239840">,</span>&nbsp;<span class="ident" id="6239842">e</span><span class="op" id="6239843">.</span><span class="ident" id="6239844">Packages</span><span class="op" id="6239852">[</span><span class="num" id="6239853">1</span><span class="op" id="6239854">]</span><span class="op" id="6239855">,</span>&nbsp;<span class="ident" id="6239857">e</span><span class="op" id="6239858">.</span><span class="ident" id="6239859">Files</span><span class="op" id="6239864">[</span><span class="num" id="6239865">1</span><span class="op" id="6239866">]</span><span class="op" id="6239867">,</span>&nbsp;<span class="ident" id="6239869">e</span><span class="op" id="6239870">.</span><span class="ident" id="6239871">Dir</span><span class="op" id="6239874">)</span><br>
<span class="lineno"></span><span class="op" id="6239876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6239879">func</span>&nbsp;<span class="ident" id="6239884">nameExt</span><span class="op" id="6239891">(</span><span class="ident" id="6239892">name</span>&nbsp;<span class="builtintype" id="6239897">string</span><span class="op" id="6239903">)</span>&nbsp;<span class="builtintype" id="6239905">string</span>&nbsp;<span class="op" id="6239912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6239915">i</span>&nbsp;<span class="op" id="6239917">:=</span>&nbsp;<span class="ident" id="6239920">strings</span><span class="op" id="6239927">.</span><span class="ident" id="6239928">LastIndex</span><span class="op" id="6239937">(</span><span class="ident" id="6239938">name</span><span class="op" id="6239942">,</span>&nbsp;<span class="string" id="6239944">&#34;.&#34;</span><span class="op" id="6239947">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239950">if</span>&nbsp;<span class="ident" id="6239953">i</span>&nbsp;<span class="op" id="6239955">&lt;</span>&nbsp;<span class="num" id="6239957">0</span>&nbsp;<span class="op" id="6239959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239963">return</span>&nbsp;<span class="string" id="6239970">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6239974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6239977">return</span>&nbsp;<span class="ident" id="6239984">name</span><span class="op" id="6239988">[</span><span class="ident" id="6239989">i</span><span class="op" id="6239990">:</span><span class="op" id="6239991">]</span><br>
<span class="lineno"></span><span class="op" id="6239993">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="6239996">//&nbsp;Import&nbsp;returns&nbsp;details&nbsp;about&nbsp;the&nbsp;Go&nbsp;package&nbsp;named&nbsp;by&nbsp;the&nbsp;import&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="6240069">//&nbsp;interpreting&nbsp;local&nbsp;import&nbsp;paths&nbsp;relative&nbsp;to&nbsp;the&nbsp;srcDir&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="6240138">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;a&nbsp;local&nbsp;import&nbsp;path&nbsp;naming&nbsp;a&nbsp;package&nbsp;that&nbsp;can&nbsp;be&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="6240214">//&nbsp;using&nbsp;a&nbsp;standard&nbsp;import&nbsp;path,&nbsp;the&nbsp;returned&nbsp;package&nbsp;will&nbsp;set&nbsp;p.ImportPath</span><br>
<span class="lineno">445</span><span class="comment" id="6240290">//&nbsp;to&nbsp;that&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="6240307">//</span><br>
<span class="lineno"></span><span class="comment" id="6240310">//&nbsp;In&nbsp;the&nbsp;directory&nbsp;containing&nbsp;the&nbsp;package,&nbsp;.go,&nbsp;.c,&nbsp;.h,&nbsp;and&nbsp;.s&nbsp;files&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="6240384">//&nbsp;considered&nbsp;part&nbsp;of&nbsp;the&nbsp;package&nbsp;except&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="6240430">//</span><br>
<span class="lineno">450</span><span class="comment" id="6240433">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;.go&nbsp;files&nbsp;in&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span><span class="comment" id="6240473">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;starting&nbsp;with&nbsp;_&nbsp;or&nbsp;.&nbsp;(likely&nbsp;editor&nbsp;temporary&nbsp;files)</span><br>
<span class="lineno"></span><span class="comment" id="6240537">//&nbsp;&nbsp;&nbsp;&nbsp-&nbsp;files&nbsp;with&nbsp;build&nbsp;constraints&nbsp;not&nbsp;satisfied&nbsp;by&nbsp;the&nbsp;context</span><br>
<span class="lineno"></span><span class="comment" id="6240600">//</span><br>
<span class="lineno"></span><span class="comment" id="6240603">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;Import&nbsp;returns&nbsp;a&nbsp;non-nil&nbsp;error&nbsp;and&nbsp;a&nbsp;non-nil</span><br>
<span class="lineno">455</span><span class="comment" id="6240671">//&nbsp;*Package&nbsp;containing&nbsp;partial&nbsp;information.</span><br>
<span class="lineno"></span><span class="comment" id="6240715">//</span><br>
<span class="lineno"></span><span class="keyword" id="6240718">func</span>&nbsp;<span class="op" id="6240723">(</span><span class="ident" id="6240724">ctxt</span>&nbsp;<span class="op" id="6240729">*</span><span class="ident" id="6240730">Context</span><span class="op" id="6240737">)</span>&nbsp;<span class="ident" id="6240739">Import</span><span class="op" id="6240745">(</span><span class="ident" id="6240746">path</span>&nbsp;<span class="builtintype" id="6240751">string</span><span class="op" id="6240757">,</span>&nbsp;<span class="ident" id="6240759">srcDir</span>&nbsp;<span class="builtintype" id="6240766">string</span><span class="op" id="6240772">,</span>&nbsp;<span class="ident" id="6240774">mode</span>&nbsp;<span class="ident" id="6240779">ImportMode</span><span class="op" id="6240789">)</span>&nbsp;<span class="op" id="6240791">(</span><span class="op" id="6240792">*</span><span class="ident" id="6240793">Package</span><span class="op" id="6240800">,</span>&nbsp;<span class="builtintype" id="6240802">error</span><span class="op" id="6240807">)</span>&nbsp;<span class="op" id="6240809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240812">p</span>&nbsp;<span class="op" id="6240814">:=</span>&nbsp;<span class="op" id="6240817">&amp;</span><span class="ident" id="6240818">Package</span><span class="op" id="6240825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6240829">ImportPath</span><span class="op" id="6240839">:</span>&nbsp;<span class="ident" id="6240841">path</span><span class="op" id="6240845">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240851">if</span>&nbsp;<span class="ident" id="6240854">path</span>&nbsp;<span class="op" id="6240859">==</span>&nbsp;<span class="string" id="6240862">&#34;&#34;</span>&nbsp;<span class="op" id="6240865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240869">return</span>&nbsp;<span class="ident" id="6240876">p</span><span class="op" id="6240877">,</span>&nbsp;<span class="ident" id="6240879">fmt</span><span class="op" id="6240882">.</span><span class="ident" id="6240883">Errorf</span><span class="op" id="6240889">(</span><span class="string" id="6240890">&#34;import&nbsp;%q:&nbsp;invalid&nbsp;import&nbsp;path&#34;</span><span class="op" id="6240922">,</span>&nbsp;<span class="ident" id="6240924">path</span><span class="op" id="6240928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6240931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240935">var</span>&nbsp;<span class="ident" id="6240939">pkga</span>&nbsp;<span class="builtintype" id="6240944">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240952">var</span>&nbsp;<span class="ident" id="6240956">pkgerr</span>&nbsp;<span class="builtintype" id="6240963">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240970">switch</span>&nbsp;<span class="ident" id="6240977">ctxt</span><span class="op" id="6240981">.</span><span class="ident" id="6240982">Compiler</span>&nbsp;<span class="op" id="6240991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6240994">case</span>&nbsp;<span class="string" id="6240999">&#34;gccgo&#34;</span><span class="op" id="6241006">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241010">dir</span><span class="op" id="6241013">,</span>&nbsp;<span class="ident" id="6241015">elem</span>&nbsp;<span class="op" id="6241020">:=</span>&nbsp;<span class="ident" id="6241023">pathpkg</span><span class="op" id="6241030">.</span><span class="ident" id="6241031">Split</span><span class="op" id="6241036">(</span><span class="ident" id="6241037">p</span><span class="op" id="6241038">.</span><span class="ident" id="6241039">ImportPath</span><span class="op" id="6241049">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241053">pkga</span>&nbsp;<span class="op" id="6241058">=</span>&nbsp;<span class="string" id="6241060">&#34;pkg/gccgo_&#34;</span>&nbsp;<span class="op" id="6241073">+</span>&nbsp;<span class="ident" id="6241075">ctxt</span><span class="op" id="6241079">.</span><span class="ident" id="6241080">GOOS</span>&nbsp;<span class="op" id="6241085">+</span>&nbsp;<span class="string" id="6241087">&#34;_&#34;</span>&nbsp;<span class="op" id="6241091">+</span>&nbsp;<span class="ident" id="6241093">ctxt</span><span class="op" id="6241097">.</span><span class="ident" id="6241098">GOARCH</span>&nbsp;<span class="op" id="6241105">+</span>&nbsp;<span class="string" id="6241107">&#34;/&#34;</span>&nbsp;<span class="op" id="6241111">+</span>&nbsp;<span class="ident" id="6241113">dir</span>&nbsp;<span class="op" id="6241117">+</span>&nbsp;<span class="string" id="6241119">&#34;lib&#34;</span>&nbsp;<span class="op" id="6241125">+</span>&nbsp;<span class="ident" id="6241127">elem</span>&nbsp;<span class="op" id="6241132">+</span>&nbsp;<span class="string" id="6241134">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241140">case</span>&nbsp;<span class="string" id="6241145">&#34;gc&#34;</span><span class="op" id="6241149">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241153">suffix</span>&nbsp;<span class="op" id="6241160">:=</span>&nbsp;<span class="string" id="6241163">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241168">if</span>&nbsp;<span class="ident" id="6241171">ctxt</span><span class="op" id="6241175">.</span><span class="ident" id="6241176">InstallSuffix</span>&nbsp;<span class="op" id="6241190">!=</span>&nbsp;<span class="string" id="6241193">&#34;&#34;</span>&nbsp;<span class="op" id="6241196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241201">suffix</span>&nbsp;<span class="op" id="6241208">=</span>&nbsp;<span class="string" id="6241210">&#34;_&#34;</span>&nbsp;<span class="op" id="6241214">+</span>&nbsp;<span class="ident" id="6241216">ctxt</span><span class="op" id="6241220">.</span><span class="ident" id="6241221">InstallSuffix</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241241">pkga</span>&nbsp;<span class="op" id="6241246">=</span>&nbsp;<span class="string" id="6241248">&#34;pkg/&#34;</span>&nbsp;<span class="op" id="6241255">+</span>&nbsp;<span class="ident" id="6241257">ctxt</span><span class="op" id="6241261">.</span><span class="ident" id="6241262">GOOS</span>&nbsp;<span class="op" id="6241267">+</span>&nbsp;<span class="string" id="6241269">&#34;_&#34;</span>&nbsp;<span class="op" id="6241273">+</span>&nbsp;<span class="ident" id="6241275">ctxt</span><span class="op" id="6241279">.</span><span class="ident" id="6241280">GOARCH</span>&nbsp;<span class="op" id="6241287">+</span>&nbsp;<span class="ident" id="6241289">suffix</span>&nbsp;<span class="op" id="6241296">+</span>&nbsp;<span class="string" id="6241298">&#34;/&#34;</span>&nbsp;<span class="op" id="6241302">+</span>&nbsp;<span class="ident" id="6241304">p</span><span class="op" id="6241305">.</span><span class="ident" id="6241306">ImportPath</span>&nbsp;<span class="op" id="6241317">+</span>&nbsp;<span class="string" id="6241319">&#34;.a&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241325">default</span><span class="op" id="6241332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6241336">//&nbsp;Save&nbsp;error&nbsp;for&nbsp;end&nbsp;of&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241373">pkgerr</span>&nbsp;<span class="op" id="6241380">=</span>&nbsp;<span class="ident" id="6241382">fmt</span><span class="op" id="6241385">.</span><span class="ident" id="6241386">Errorf</span><span class="op" id="6241392">(</span><span class="string" id="6241393">&#34;import&nbsp;%q:&nbsp;unknown&nbsp;compiler&nbsp;%q&#34;</span><span class="op" id="6241425">,</span>&nbsp;<span class="ident" id="6241427">path</span><span class="op" id="6241431">,</span>&nbsp;<span class="ident" id="6241433">ctxt</span><span class="op" id="6241437">.</span><span class="ident" id="6241438">Compiler</span><span class="op" id="6241446">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241453">binaryOnly</span>&nbsp;<span class="op" id="6241464">:=</span>&nbsp;<span class="builtintype" id="6241467">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241474">if</span>&nbsp;<span class="ident" id="6241477">IsLocalImport</span><span class="op" id="6241490">(</span><span class="ident" id="6241491">path</span><span class="op" id="6241495">)</span>&nbsp;<span class="op" id="6241497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241501">pkga</span>&nbsp;<span class="op" id="6241506">=</span>&nbsp;<span class="string" id="6241508">&#34;&#34;</span>&nbsp;<span class="comment" id="6241511">//&nbsp;local&nbsp;imports&nbsp;have&nbsp;no&nbsp;installed&nbsp;path</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241553">if</span>&nbsp;<span class="ident" id="6241556">srcDir</span>&nbsp;<span class="op" id="6241563">==</span>&nbsp;<span class="string" id="6241566">&#34;&#34;</span>&nbsp;<span class="op" id="6241569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241574">return</span>&nbsp;<span class="ident" id="6241581">p</span><span class="op" id="6241582">,</span>&nbsp;<span class="ident" id="6241584">fmt</span><span class="op" id="6241587">.</span><span class="ident" id="6241588">Errorf</span><span class="op" id="6241594">(</span><span class="string" id="6241595">&#34;import&nbsp;%q:&nbsp;import&nbsp;relative&nbsp;to&nbsp;unknown&nbsp;directory&#34;</span><span class="op" id="6241644">,</span>&nbsp;<span class="ident" id="6241646">path</span><span class="op" id="6241650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241658">if</span>&nbsp;<span class="op" id="6241661">!</span><span class="ident" id="6241662">ctxt</span><span class="op" id="6241666">.</span><span class="ident" id="6241667">isAbsPath</span><span class="op" id="6241676">(</span><span class="ident" id="6241677">path</span><span class="op" id="6241681">)</span>&nbsp;<span class="op" id="6241683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241688">p</span><span class="op" id="6241689">.</span><span class="ident" id="6241690">Dir</span>&nbsp;<span class="op" id="6241694">=</span>&nbsp;<span class="ident" id="6241696">ctxt</span><span class="op" id="6241700">.</span><span class="ident" id="6241701">joinPath</span><span class="op" id="6241709">(</span><span class="ident" id="6241710">srcDir</span><span class="op" id="6241716">,</span>&nbsp;<span class="ident" id="6241718">path</span><span class="op" id="6241722">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6241730">//&nbsp;Determine&nbsp;canonical&nbsp;import&nbsp;path,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241776">if</span>&nbsp;<span class="ident" id="6241779">ctxt</span><span class="op" id="6241783">.</span><span class="ident" id="6241784">GOROOT</span>&nbsp;<span class="op" id="6241791">!=</span>&nbsp;<span class="string" id="6241794">&#34;&#34;</span>&nbsp;<span class="op" id="6241797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241802">root</span>&nbsp;<span class="op" id="6241807">:=</span>&nbsp;<span class="ident" id="6241810">ctxt</span><span class="op" id="6241814">.</span><span class="ident" id="6241815">joinPath</span><span class="op" id="6241823">(</span><span class="ident" id="6241824">ctxt</span><span class="op" id="6241828">.</span><span class="ident" id="6241829">GOROOT</span><span class="op" id="6241835">,</span>&nbsp;<span class="string" id="6241837">&#34;src&#34;</span><span class="op" id="6241842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241847">if</span>&nbsp;<span class="ident" id="6241850">sub</span><span class="op" id="6241853">,</span>&nbsp;<span class="ident" id="6241855">ok</span>&nbsp;<span class="op" id="6241858">:=</span>&nbsp;<span class="ident" id="6241861">ctxt</span><span class="op" id="6241865">.</span><span class="ident" id="6241866">hasSubdir</span><span class="op" id="6241875">(</span><span class="ident" id="6241876">root</span><span class="op" id="6241880">,</span>&nbsp;<span class="ident" id="6241882">p</span><span class="op" id="6241883">.</span><span class="ident" id="6241884">Dir</span><span class="op" id="6241887">)</span><span class="op" id="6241888">;</span>&nbsp;<span class="ident" id="6241890">ok</span>&nbsp;<span class="op" id="6241893">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241899">p</span><span class="op" id="6241900">.</span><span class="ident" id="6241901">Goroot</span>&nbsp;<span class="op" id="6241908">=</span>&nbsp;<span class="builtintype" id="6241910">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241919">p</span><span class="op" id="6241920">.</span><span class="ident" id="6241921">ImportPath</span>&nbsp;<span class="op" id="6241932">=</span>&nbsp;<span class="ident" id="6241934">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241942">p</span><span class="op" id="6241943">.</span><span class="ident" id="6241944">Root</span>&nbsp;<span class="op" id="6241949">=</span>&nbsp;<span class="ident" id="6241951">ctxt</span><span class="op" id="6241955">.</span><span class="ident" id="6241956">GOROOT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6241967">goto</span>&nbsp;<span class="ident" id="6241972">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241981">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6241985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6241989">all</span>&nbsp;<span class="op" id="6241993">:=</span>&nbsp;<span class="ident" id="6241996">ctxt</span><span class="op" id="6242000">.</span><span class="ident" id="6242001">gopath</span><span class="op" id="6242007">(</span><span class="op" id="6242008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242012">for</span>&nbsp;<span class="ident" id="6242016">i</span><span class="op" id="6242017">,</span>&nbsp;<span class="ident" id="6242019">root</span>&nbsp;<span class="op" id="6242024">:=</span>&nbsp;<span class="keyword" id="6242027">range</span>&nbsp;<span class="ident" id="6242033">all</span>&nbsp;<span class="op" id="6242037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242042">rootsrc</span>&nbsp;<span class="op" id="6242050">:=</span>&nbsp;<span class="ident" id="6242053">ctxt</span><span class="op" id="6242057">.</span><span class="ident" id="6242058">joinPath</span><span class="op" id="6242066">(</span><span class="ident" id="6242067">root</span><span class="op" id="6242071">,</span>&nbsp;<span class="string" id="6242073">&#34;src&#34;</span><span class="op" id="6242078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242083">if</span>&nbsp;<span class="ident" id="6242086">sub</span><span class="op" id="6242089">,</span>&nbsp;<span class="ident" id="6242091">ok</span>&nbsp;<span class="op" id="6242094">:=</span>&nbsp;<span class="ident" id="6242097">ctxt</span><span class="op" id="6242101">.</span><span class="ident" id="6242102">hasSubdir</span><span class="op" id="6242111">(</span><span class="ident" id="6242112">rootsrc</span><span class="op" id="6242119">,</span>&nbsp;<span class="ident" id="6242121">p</span><span class="op" id="6242122">.</span><span class="ident" id="6242123">Dir</span><span class="op" id="6242126">)</span><span class="op" id="6242127">;</span>&nbsp;<span class="ident" id="6242129">ok</span>&nbsp;<span class="op" id="6242132">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242138">//&nbsp;We&nbsp;found&nbsp;a&nbsp;potential&nbsp;import&nbsp;path&nbsp;for&nbsp;dir,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242187">//&nbsp;but&nbsp;check&nbsp;that&nbsp;using&nbsp;it&nbsp;wouldn&#39;t&nbsp;find&nbsp;something</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242242">//&nbsp;else&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242261">if</span>&nbsp;<span class="ident" id="6242264">ctxt</span><span class="op" id="6242268">.</span><span class="ident" id="6242269">GOROOT</span>&nbsp;<span class="op" id="6242276">!=</span>&nbsp;<span class="string" id="6242279">&#34;&#34;</span>&nbsp;<span class="op" id="6242282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242289">if</span>&nbsp;<span class="ident" id="6242292">dir</span>&nbsp;<span class="op" id="6242296">:=</span>&nbsp;<span class="ident" id="6242299">ctxt</span><span class="op" id="6242303">.</span><span class="ident" id="6242304">joinPath</span><span class="op" id="6242312">(</span><span class="ident" id="6242313">ctxt</span><span class="op" id="6242317">.</span><span class="ident" id="6242318">GOROOT</span><span class="op" id="6242324">,</span>&nbsp;<span class="string" id="6242326">&#34;src&#34;</span><span class="op" id="6242331">,</span>&nbsp;<span class="ident" id="6242333">sub</span><span class="op" id="6242336">)</span><span class="op" id="6242337">;</span>&nbsp;<span class="ident" id="6242339">ctxt</span><span class="op" id="6242343">.</span><span class="ident" id="6242344">isDir</span><span class="op" id="6242349">(</span><span class="ident" id="6242350">dir</span><span class="op" id="6242353">)</span>&nbsp;<span class="op" id="6242355">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242363">p</span><span class="op" id="6242364">.</span><span class="ident" id="6242365">ConflictDir</span>&nbsp;<span class="op" id="6242377">=</span>&nbsp;<span class="ident" id="6242379">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242389">goto</span>&nbsp;<span class="ident" id="6242394">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242417">for</span>&nbsp;<span class="ident" id="6242421">_</span><span class="op" id="6242422">,</span>&nbsp;<span class="ident" id="6242424">earlyRoot</span>&nbsp;<span class="op" id="6242434">:=</span>&nbsp;<span class="keyword" id="6242437">range</span>&nbsp;<span class="ident" id="6242443">all</span><span class="op" id="6242446">[</span><span class="op" id="6242447">:</span><span class="ident" id="6242448">i</span><span class="op" id="6242449">]</span>&nbsp;<span class="op" id="6242451">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242458">if</span>&nbsp;<span class="ident" id="6242461">dir</span>&nbsp;<span class="op" id="6242465">:=</span>&nbsp;<span class="ident" id="6242468">ctxt</span><span class="op" id="6242472">.</span><span class="ident" id="6242473">joinPath</span><span class="op" id="6242481">(</span><span class="ident" id="6242482">earlyRoot</span><span class="op" id="6242491">,</span>&nbsp;<span class="string" id="6242493">&#34;src&#34;</span><span class="op" id="6242498">,</span>&nbsp;<span class="ident" id="6242500">sub</span><span class="op" id="6242503">)</span><span class="op" id="6242504">;</span>&nbsp;<span class="ident" id="6242506">ctxt</span><span class="op" id="6242510">.</span><span class="ident" id="6242511">isDir</span><span class="op" id="6242516">(</span><span class="ident" id="6242517">dir</span><span class="op" id="6242520">)</span>&nbsp;<span class="op" id="6242522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242530">p</span><span class="op" id="6242531">.</span><span class="ident" id="6242532">ConflictDir</span>&nbsp;<span class="op" id="6242544">=</span>&nbsp;<span class="ident" id="6242546">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242556">goto</span>&nbsp;<span class="ident" id="6242561">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242578">}</span><br>
<span class="lineno">520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242585">//&nbsp;sub&nbsp;would&nbsp;not&nbsp;name&nbsp;some&nbsp;other&nbsp;directory&nbsp;instead&nbsp;of&nbsp;this&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242653">//&nbsp;Record&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242671">p</span><span class="op" id="6242672">.</span><span class="ident" id="6242673">ImportPath</span>&nbsp;<span class="op" id="6242684">=</span>&nbsp;<span class="ident" id="6242686">sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6242694">p</span><span class="op" id="6242695">.</span><span class="ident" id="6242696">Root</span>&nbsp;<span class="op" id="6242701">=</span>&nbsp;<span class="ident" id="6242703">root</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242712">goto</span>&nbsp;<span class="ident" id="6242717">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242734">//&nbsp;It&#39;s&nbsp;okay&nbsp;that&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;a&nbsp;root&nbsp;containing&nbsp;dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242792">//&nbsp;Keep&nbsp;going&nbsp;with&nbsp;the&nbsp;information&nbsp;we&nbsp;have.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242837">}</span>&nbsp;<span class="keyword" id="6242839">else</span>&nbsp;<span class="op" id="6242844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242848">if</span>&nbsp;<span class="ident" id="6242851">strings</span><span class="op" id="6242858">.</span><span class="ident" id="6242859">HasPrefix</span><span class="op" id="6242868">(</span><span class="ident" id="6242869">path</span><span class="op" id="6242873">,</span>&nbsp;<span class="string" id="6242875">&#34;/&#34;</span><span class="op" id="6242878">)</span>&nbsp;<span class="op" id="6242880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6242885">return</span>&nbsp;<span class="ident" id="6242892">p</span><span class="op" id="6242893">,</span>&nbsp;<span class="ident" id="6242895">fmt</span><span class="op" id="6242898">.</span><span class="ident" id="6242899">Errorf</span><span class="op" id="6242905">(</span><span class="string" id="6242906">&#34;import&nbsp;%q:&nbsp;cannot&nbsp;import&nbsp;absolute&nbsp;path&#34;</span><span class="op" id="6242946">,</span>&nbsp;<span class="ident" id="6242948">path</span><span class="op" id="6242952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6242956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6242961">//&nbsp;tried&nbsp;records&nbsp;the&nbsp;location&nbsp;of&nbsp;unsuccessful&nbsp;package&nbsp;lookups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243025">var</span>&nbsp;<span class="ident" id="6243029">tried</span>&nbsp;<span class="keyword" id="6243035">struct</span>&nbsp;<span class="op" id="6243042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243047">goroot</span>&nbsp;<span class="builtintype" id="6243054">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243064">gopath</span>&nbsp;<span class="op" id="6243071">[</span><span class="op" id="6243072">]</span><span class="builtintype" id="6243073">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243082">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6243087">//&nbsp;Determine&nbsp;directory&nbsp;from&nbsp;import&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243130">if</span>&nbsp;<span class="ident" id="6243133">ctxt</span><span class="op" id="6243137">.</span><span class="ident" id="6243138">GOROOT</span>&nbsp;<span class="op" id="6243145">!=</span>&nbsp;<span class="string" id="6243148">&#34;&#34;</span>&nbsp;<span class="op" id="6243151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243156">dir</span>&nbsp;<span class="op" id="6243160">:=</span>&nbsp;<span class="ident" id="6243163">ctxt</span><span class="op" id="6243167">.</span><span class="ident" id="6243168">joinPath</span><span class="op" id="6243176">(</span><span class="ident" id="6243177">ctxt</span><span class="op" id="6243181">.</span><span class="ident" id="6243182">GOROOT</span><span class="op" id="6243188">,</span>&nbsp;<span class="string" id="6243190">&#34;src&#34;</span><span class="op" id="6243195">,</span>&nbsp;<span class="ident" id="6243197">path</span><span class="op" id="6243201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243206">isDir</span>&nbsp;<span class="op" id="6243212">:=</span>&nbsp;<span class="ident" id="6243215">ctxt</span><span class="op" id="6243219">.</span><span class="ident" id="6243220">isDir</span><span class="op" id="6243225">(</span><span class="ident" id="6243226">dir</span><span class="op" id="6243229">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243234">binaryOnly</span>&nbsp;<span class="op" id="6243245">=</span>&nbsp;<span class="op" id="6243247">!</span><span class="ident" id="6243248">isDir</span>&nbsp;<span class="op" id="6243254">&amp;&amp;</span>&nbsp;<span class="ident" id="6243257">mode</span><span class="op" id="6243261">&amp;</span><span class="ident" id="6243262">AllowBinary</span>&nbsp;<span class="op" id="6243274">!=</span>&nbsp;<span class="num" id="6243277">0</span>&nbsp;<span class="op" id="6243279">&amp;&amp;</span>&nbsp;<span class="ident" id="6243282">pkga</span>&nbsp;<span class="op" id="6243287">!=</span>&nbsp;<span class="string" id="6243290">&#34;&#34;</span>&nbsp;<span class="op" id="6243293">&amp;&amp;</span>&nbsp;<span class="ident" id="6243296">ctxt</span><span class="op" id="6243300">.</span><span class="ident" id="6243301">isFile</span><span class="op" id="6243307">(</span><span class="ident" id="6243308">ctxt</span><span class="op" id="6243312">.</span><span class="ident" id="6243313">joinPath</span><span class="op" id="6243321">(</span><span class="ident" id="6243322">ctxt</span><span class="op" id="6243326">.</span><span class="ident" id="6243327">GOROOT</span><span class="op" id="6243333">,</span>&nbsp;<span class="ident" id="6243335">pkga</span><span class="op" id="6243339">)</span><span class="op" id="6243340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243345">if</span>&nbsp;<span class="ident" id="6243348">isDir</span>&nbsp;<span class="op" id="6243354">||</span>&nbsp;<span class="ident" id="6243357">binaryOnly</span>&nbsp;<span class="op" id="6243368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243374">p</span><span class="op" id="6243375">.</span><span class="ident" id="6243376">Dir</span>&nbsp;<span class="op" id="6243380">=</span>&nbsp;<span class="ident" id="6243382">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243390">p</span><span class="op" id="6243391">.</span><span class="ident" id="6243392">Goroot</span>&nbsp;<span class="op" id="6243399">=</span>&nbsp;<span class="builtintype" id="6243401">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243410">p</span><span class="op" id="6243411">.</span><span class="ident" id="6243412">Root</span>&nbsp;<span class="op" id="6243417">=</span>&nbsp;<span class="ident" id="6243419">ctxt</span><span class="op" id="6243423">.</span><span class="ident" id="6243424">GOROOT</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243435">goto</span>&nbsp;<span class="ident" id="6243440">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243454">tried</span><span class="op" id="6243459">.</span><span class="ident" id="6243460">goroot</span>&nbsp;<span class="op" id="6243467">=</span>&nbsp;<span class="ident" id="6243469">dir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243479">for</span>&nbsp;<span class="ident" id="6243483">_</span><span class="op" id="6243484">,</span>&nbsp;<span class="ident" id="6243486">root</span>&nbsp;<span class="op" id="6243491">:=</span>&nbsp;<span class="keyword" id="6243494">range</span>&nbsp;<span class="ident" id="6243500">ctxt</span><span class="op" id="6243504">.</span><span class="ident" id="6243505">gopath</span><span class="op" id="6243511">(</span><span class="op" id="6243512">)</span>&nbsp;<span class="op" id="6243514">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243519">dir</span>&nbsp;<span class="op" id="6243523">:=</span>&nbsp;<span class="ident" id="6243526">ctxt</span><span class="op" id="6243530">.</span><span class="ident" id="6243531">joinPath</span><span class="op" id="6243539">(</span><span class="ident" id="6243540">root</span><span class="op" id="6243544">,</span>&nbsp;<span class="string" id="6243546">&#34;src&#34;</span><span class="op" id="6243551">,</span>&nbsp;<span class="ident" id="6243553">path</span><span class="op" id="6243557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243562">isDir</span>&nbsp;<span class="op" id="6243568">:=</span>&nbsp;<span class="ident" id="6243571">ctxt</span><span class="op" id="6243575">.</span><span class="ident" id="6243576">isDir</span><span class="op" id="6243581">(</span><span class="ident" id="6243582">dir</span><span class="op" id="6243585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243590">binaryOnly</span>&nbsp;<span class="op" id="6243601">=</span>&nbsp;<span class="op" id="6243603">!</span><span class="ident" id="6243604">isDir</span>&nbsp;<span class="op" id="6243610">&amp;&amp;</span>&nbsp;<span class="ident" id="6243613">mode</span><span class="op" id="6243617">&amp;</span><span class="ident" id="6243618">AllowBinary</span>&nbsp;<span class="op" id="6243630">!=</span>&nbsp;<span class="num" id="6243633">0</span>&nbsp;<span class="op" id="6243635">&amp;&amp;</span>&nbsp;<span class="ident" id="6243638">pkga</span>&nbsp;<span class="op" id="6243643">!=</span>&nbsp;<span class="string" id="6243646">&#34;&#34;</span>&nbsp;<span class="op" id="6243649">&amp;&amp;</span>&nbsp;<span class="ident" id="6243652">ctxt</span><span class="op" id="6243656">.</span><span class="ident" id="6243657">isFile</span><span class="op" id="6243663">(</span><span class="ident" id="6243664">ctxt</span><span class="op" id="6243668">.</span><span class="ident" id="6243669">joinPath</span><span class="op" id="6243677">(</span><span class="ident" id="6243678">root</span><span class="op" id="6243682">,</span>&nbsp;<span class="ident" id="6243684">pkga</span><span class="op" id="6243688">)</span><span class="op" id="6243689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243694">if</span>&nbsp;<span class="ident" id="6243697">isDir</span>&nbsp;<span class="op" id="6243703">||</span>&nbsp;<span class="ident" id="6243706">binaryOnly</span>&nbsp;<span class="op" id="6243717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243723">p</span><span class="op" id="6243724">.</span><span class="ident" id="6243725">Dir</span>&nbsp;<span class="op" id="6243729">=</span>&nbsp;<span class="ident" id="6243731">dir</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243739">p</span><span class="op" id="6243740">.</span><span class="ident" id="6243741">Root</span>&nbsp;<span class="op" id="6243746">=</span>&nbsp;<span class="ident" id="6243748">root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243757">goto</span>&nbsp;<span class="ident" id="6243762">Found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243776">tried</span><span class="op" id="6243781">.</span><span class="ident" id="6243782">gopath</span>&nbsp;<span class="op" id="6243789">=</span>&nbsp;<span class="builtinfunc" id="6243791">append</span><span class="op" id="6243797">(</span><span class="ident" id="6243798">tried</span><span class="op" id="6243803">.</span><span class="ident" id="6243804">gopath</span><span class="op" id="6243810">,</span>&nbsp;<span class="ident" id="6243812">dir</span><span class="op" id="6243815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243819">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6243824">//&nbsp;package&nbsp;was&nbsp;not&nbsp;found</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243851">var</span>&nbsp;<span class="ident" id="6243855">paths</span>&nbsp;<span class="op" id="6243861">[</span><span class="op" id="6243862">]</span><span class="builtintype" id="6243863">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6243872">if</span>&nbsp;<span class="ident" id="6243875">tried</span><span class="op" id="6243880">.</span><span class="ident" id="6243881">goroot</span>&nbsp;<span class="op" id="6243888">!=</span>&nbsp;<span class="string" id="6243891">&#34;&#34;</span>&nbsp;<span class="op" id="6243894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243899">paths</span>&nbsp;<span class="op" id="6243905">=</span>&nbsp;<span class="builtinfunc" id="6243907">append</span><span class="op" id="6243913">(</span><span class="ident" id="6243914">paths</span><span class="op" id="6243919">,</span>&nbsp;<span class="ident" id="6243921">fmt</span><span class="op" id="6243924">.</span><span class="ident" id="6243925">Sprintf</span><span class="op" id="6243932">(</span><span class="string" id="6243933">&#34;\t%s&nbsp;(from&nbsp;$GOROOT)&#34;</span><span class="op" id="6243954">,</span>&nbsp;<span class="ident" id="6243956">tried</span><span class="op" id="6243961">.</span><span class="ident" id="6243962">goroot</span><span class="op" id="6243968">)</span><span class="op" id="6243969">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6243973">}</span>&nbsp;<span class="keyword" id="6243975">else</span>&nbsp;<span class="op" id="6243980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6243985">paths</span>&nbsp;<span class="op" id="6243991">=</span>&nbsp;<span class="builtinfunc" id="6243993">append</span><span class="op" id="6243999">(</span><span class="ident" id="6244000">paths</span><span class="op" id="6244005">,</span>&nbsp;<span class="string" id="6244007">&#34;\t($GOROOT&nbsp;not&nbsp;set)&#34;</span><span class="op" id="6244028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244036">var</span>&nbsp;<span class="ident" id="6244040">i</span>&nbsp;<span class="builtintype" id="6244042">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244048">var</span>&nbsp;<span class="ident" id="6244052">format</span>&nbsp;<span class="op" id="6244059">=</span>&nbsp;<span class="string" id="6244061">&#34;\t%s&nbsp;(from&nbsp;$GOPATH)&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244085">for</span>&nbsp;<span class="op" id="6244089">;</span>&nbsp;<span class="ident" id="6244091">i</span>&nbsp;<span class="op" id="6244093">&lt;</span>&nbsp;<span class="builtinfunc" id="6244095">len</span><span class="op" id="6244098">(</span><span class="ident" id="6244099">tried</span><span class="op" id="6244104">.</span><span class="ident" id="6244105">gopath</span><span class="op" id="6244111">)</span><span class="op" id="6244112">;</span>&nbsp;<span class="ident" id="6244114">i</span><span class="op" id="6244115">++</span>&nbsp;<span class="op" id="6244118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244123">if</span>&nbsp;<span class="ident" id="6244126">i</span>&nbsp;<span class="op" id="6244128">&gt;</span>&nbsp;<span class="num" id="6244130">0</span>&nbsp;<span class="op" id="6244132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244138">format</span>&nbsp;<span class="op" id="6244145">=</span>&nbsp;<span class="string" id="6244147">&#34;\t%s&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244162">paths</span>&nbsp;<span class="op" id="6244168">=</span>&nbsp;<span class="builtinfunc" id="6244170">append</span><span class="op" id="6244176">(</span><span class="ident" id="6244177">paths</span><span class="op" id="6244182">,</span>&nbsp;<span class="ident" id="6244184">fmt</span><span class="op" id="6244187">.</span><span class="ident" id="6244188">Sprintf</span><span class="op" id="6244195">(</span><span class="ident" id="6244196">format</span><span class="op" id="6244202">,</span>&nbsp;<span class="ident" id="6244204">tried</span><span class="op" id="6244209">.</span><span class="ident" id="6244210">gopath</span><span class="op" id="6244216">[</span><span class="ident" id="6244217">i</span><span class="op" id="6244218">]</span><span class="op" id="6244219">)</span><span class="op" id="6244220">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244228">if</span>&nbsp;<span class="ident" id="6244231">i</span>&nbsp;<span class="op" id="6244233">==</span>&nbsp;<span class="num" id="6244236">0</span>&nbsp;<span class="op" id="6244238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244243">paths</span>&nbsp;<span class="op" id="6244249">=</span>&nbsp;<span class="builtinfunc" id="6244251">append</span><span class="op" id="6244257">(</span><span class="ident" id="6244258">paths</span><span class="op" id="6244263">,</span>&nbsp;<span class="string" id="6244265">&#34;\t($GOPATH&nbsp;not&nbsp;set)&#34;</span><span class="op" id="6244286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244294">return</span>&nbsp;<span class="ident" id="6244301">p</span><span class="op" id="6244302">,</span>&nbsp;<span class="ident" id="6244304">fmt</span><span class="op" id="6244307">.</span><span class="ident" id="6244308">Errorf</span><span class="op" id="6244314">(</span><span class="string" id="6244315">&#34;cannot&nbsp;find&nbsp;package&nbsp;%q&nbsp;in&nbsp;any&nbsp;of:\n%s&#34;</span><span class="op" id="6244354">,</span>&nbsp;<span class="ident" id="6244356">path</span><span class="op" id="6244360">,</span>&nbsp;<span class="ident" id="6244362">strings</span><span class="op" id="6244369">.</span><span class="ident" id="6244370">Join</span><span class="op" id="6244374">(</span><span class="ident" id="6244375">paths</span><span class="op" id="6244380">,</span>&nbsp;<span class="string" id="6244382">&#34;\n&#34;</span><span class="op" id="6244386">)</span><span class="op" id="6244387">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="6244393">Found</span><span class="op" id="6244398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244401">if</span>&nbsp;<span class="ident" id="6244404">p</span><span class="op" id="6244405">.</span><span class="ident" id="6244406">Root</span>&nbsp;<span class="op" id="6244411">!=</span>&nbsp;<span class="string" id="6244414">&#34;&#34;</span>&nbsp;<span class="op" id="6244417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244421">p</span><span class="op" id="6244422">.</span><span class="ident" id="6244423">SrcRoot</span>&nbsp;<span class="op" id="6244431">=</span>&nbsp;<span class="ident" id="6244433">ctxt</span><span class="op" id="6244437">.</span><span class="ident" id="6244438">joinPath</span><span class="op" id="6244446">(</span><span class="ident" id="6244447">p</span><span class="op" id="6244448">.</span><span class="ident" id="6244449">Root</span><span class="op" id="6244453">,</span>&nbsp;<span class="string" id="6244455">&#34;src&#34;</span><span class="op" id="6244460">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244464">p</span><span class="op" id="6244465">.</span><span class="ident" id="6244466">PkgRoot</span>&nbsp;<span class="op" id="6244474">=</span>&nbsp;<span class="ident" id="6244476">ctxt</span><span class="op" id="6244480">.</span><span class="ident" id="6244481">joinPath</span><span class="op" id="6244489">(</span><span class="ident" id="6244490">p</span><span class="op" id="6244491">.</span><span class="ident" id="6244492">Root</span><span class="op" id="6244496">,</span>&nbsp;<span class="string" id="6244498">&#34;pkg&#34;</span><span class="op" id="6244503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244507">p</span><span class="op" id="6244508">.</span><span class="ident" id="6244509">BinDir</span>&nbsp;<span class="op" id="6244516">=</span>&nbsp;<span class="ident" id="6244518">ctxt</span><span class="op" id="6244522">.</span><span class="ident" id="6244523">joinPath</span><span class="op" id="6244531">(</span><span class="ident" id="6244532">p</span><span class="op" id="6244533">.</span><span class="ident" id="6244534">Root</span><span class="op" id="6244538">,</span>&nbsp;<span class="string" id="6244540">&#34;bin&#34;</span><span class="op" id="6244545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244549">if</span>&nbsp;<span class="ident" id="6244552">pkga</span>&nbsp;<span class="op" id="6244557">!=</span>&nbsp;<span class="string" id="6244560">&#34;&#34;</span>&nbsp;<span class="op" id="6244563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244568">p</span><span class="op" id="6244569">.</span><span class="ident" id="6244570">PkgObj</span>&nbsp;<span class="op" id="6244577">=</span>&nbsp;<span class="ident" id="6244579">ctxt</span><span class="op" id="6244583">.</span><span class="ident" id="6244584">joinPath</span><span class="op" id="6244592">(</span><span class="ident" id="6244593">p</span><span class="op" id="6244594">.</span><span class="ident" id="6244595">Root</span><span class="op" id="6244599">,</span>&nbsp;<span class="ident" id="6244601">pkga</span><span class="op" id="6244605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244609">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244616">if</span>&nbsp;<span class="ident" id="6244619">mode</span><span class="op" id="6244623">&amp;</span><span class="ident" id="6244624">FindOnly</span>&nbsp;<span class="op" id="6244633">!=</span>&nbsp;<span class="num" id="6244636">0</span>&nbsp;<span class="op" id="6244638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244642">return</span>&nbsp;<span class="ident" id="6244649">p</span><span class="op" id="6244650">,</span>&nbsp;<span class="ident" id="6244652">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244660">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244663">if</span>&nbsp;<span class="ident" id="6244666">binaryOnly</span>&nbsp;<span class="op" id="6244677">&amp;&amp;</span>&nbsp;<span class="op" id="6244680">(</span><span class="ident" id="6244681">mode</span><span class="op" id="6244685">&amp;</span><span class="ident" id="6244686">AllowBinary</span><span class="op" id="6244697">)</span>&nbsp;<span class="op" id="6244699">!=</span>&nbsp;<span class="num" id="6244702">0</span>&nbsp;<span class="op" id="6244704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244708">return</span>&nbsp;<span class="ident" id="6244715">p</span><span class="op" id="6244716">,</span>&nbsp;<span class="ident" id="6244718">pkgerr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244730">dirs</span><span class="op" id="6244734">,</span>&nbsp;<span class="ident" id="6244736">err</span>&nbsp;<span class="op" id="6244740">:=</span>&nbsp;<span class="ident" id="6244743">ctxt</span><span class="op" id="6244747">.</span><span class="ident" id="6244748">readDir</span><span class="op" id="6244755">(</span><span class="ident" id="6244756">p</span><span class="op" id="6244757">.</span><span class="ident" id="6244758">Dir</span><span class="op" id="6244761">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244764">if</span>&nbsp;<span class="ident" id="6244767">err</span>&nbsp;<span class="op" id="6244771">!=</span>&nbsp;<span class="ident" id="6244774">nil</span>&nbsp;<span class="op" id="6244778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244782">return</span>&nbsp;<span class="ident" id="6244789">p</span><span class="op" id="6244790">,</span>&nbsp;<span class="ident" id="6244792">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6244797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244801">var</span>&nbsp;<span class="ident" id="6244805">Sfiles</span>&nbsp;<span class="op" id="6244812">[</span><span class="op" id="6244813">]</span><span class="builtintype" id="6244814">string</span>&nbsp;<span class="comment" id="6244821">//&nbsp;files&nbsp;with&nbsp;&#34;.S&#34;&nbsp;(capital&nbsp;S)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6244853">var</span>&nbsp;<span class="ident" id="6244857">firstFile</span><span class="op" id="6244866">,</span>&nbsp;<span class="ident" id="6244868">firstCommentFile</span>&nbsp;<span class="builtintype" id="6244885">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244893">imported</span>&nbsp;<span class="op" id="6244902">:=</span>&nbsp;<span class="builtinfunc" id="6244905">make</span><span class="op" id="6244909">(</span><span class="keyword" id="6244910">map</span><span class="op" id="6244913">[</span><span class="builtintype" id="6244914">string</span><span class="op" id="6244920">]</span><span class="op" id="6244921">[</span><span class="op" id="6244922">]</span><span class="ident" id="6244923">token</span><span class="op" id="6244928">.</span><span class="ident" id="6244929">Position</span><span class="op" id="6244937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244940">testImported</span>&nbsp;<span class="op" id="6244953">:=</span>&nbsp;<span class="builtinfunc" id="6244956">make</span><span class="op" id="6244960">(</span><span class="keyword" id="6244961">map</span><span class="op" id="6244964">[</span><span class="builtintype" id="6244965">string</span><span class="op" id="6244971">]</span><span class="op" id="6244972">[</span><span class="op" id="6244973">]</span><span class="ident" id="6244974">token</span><span class="op" id="6244979">.</span><span class="ident" id="6244980">Position</span><span class="op" id="6244988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6244991">xTestImported</span>&nbsp;<span class="op" id="6245005">:=</span>&nbsp;<span class="builtinfunc" id="6245008">make</span><span class="op" id="6245012">(</span><span class="keyword" id="6245013">map</span><span class="op" id="6245016">[</span><span class="builtintype" id="6245017">string</span><span class="op" id="6245023">]</span><span class="op" id="6245024">[</span><span class="op" id="6245025">]</span><span class="ident" id="6245026">token</span><span class="op" id="6245031">.</span><span class="ident" id="6245032">Position</span><span class="op" id="6245040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245043">allTags</span>&nbsp;<span class="op" id="6245051">:=</span>&nbsp;<span class="builtinfunc" id="6245054">make</span><span class="op" id="6245058">(</span><span class="keyword" id="6245059">map</span><span class="op" id="6245062">[</span><span class="builtintype" id="6245063">string</span><span class="op" id="6245069">]</span><span class="builtintype" id="6245070">bool</span><span class="op" id="6245074">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245077">fset</span>&nbsp;<span class="op" id="6245082">:=</span>&nbsp;<span class="ident" id="6245085">token</span><span class="op" id="6245090">.</span><span class="ident" id="6245091">NewFileSet</span><span class="op" id="6245101">(</span><span class="op" id="6245102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245105">for</span>&nbsp;<span class="ident" id="6245109">_</span><span class="op" id="6245110">,</span>&nbsp;<span class="ident" id="6245112">d</span>&nbsp;<span class="op" id="6245114">:=</span>&nbsp;<span class="keyword" id="6245117">range</span>&nbsp;<span class="ident" id="6245123">dirs</span>&nbsp;<span class="op" id="6245128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245132">if</span>&nbsp;<span class="ident" id="6245135">d</span><span class="op" id="6245136">.</span><span class="ident" id="6245137">IsDir</span><span class="op" id="6245142">(</span><span class="op" id="6245143">)</span>&nbsp;<span class="op" id="6245145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245150">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245161">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245166">name</span>&nbsp;<span class="op" id="6245171">:=</span>&nbsp;<span class="ident" id="6245174">d</span><span class="op" id="6245175">.</span><span class="ident" id="6245176">Name</span><span class="op" id="6245180">(</span><span class="op" id="6245181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245185">ext</span>&nbsp;<span class="op" id="6245189">:=</span>&nbsp;<span class="ident" id="6245192">nameExt</span><span class="op" id="6245199">(</span><span class="ident" id="6245200">name</span><span class="op" id="6245204">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245209">match</span><span class="op" id="6245214">,</span>&nbsp;<span class="ident" id="6245216">data</span><span class="op" id="6245220">,</span>&nbsp;<span class="ident" id="6245222">filename</span><span class="op" id="6245230">,</span>&nbsp;<span class="ident" id="6245232">err</span>&nbsp;<span class="op" id="6245236">:=</span>&nbsp;<span class="ident" id="6245239">ctxt</span><span class="op" id="6245243">.</span><span class="ident" id="6245244">matchFile</span><span class="op" id="6245253">(</span><span class="ident" id="6245254">p</span><span class="op" id="6245255">.</span><span class="ident" id="6245256">Dir</span><span class="op" id="6245259">,</span>&nbsp;<span class="ident" id="6245261">name</span><span class="op" id="6245265">,</span>&nbsp;<span class="builtintype" id="6245267">true</span><span class="op" id="6245271">,</span>&nbsp;<span class="ident" id="6245273">allTags</span><span class="op" id="6245280">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245284">if</span>&nbsp;<span class="ident" id="6245287">err</span>&nbsp;<span class="op" id="6245291">!=</span>&nbsp;<span class="ident" id="6245294">nil</span>&nbsp;<span class="op" id="6245298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245303">return</span>&nbsp;<span class="ident" id="6245310">p</span><span class="op" id="6245311">,</span>&nbsp;<span class="ident" id="6245313">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245323">if</span>&nbsp;<span class="op" id="6245326">!</span><span class="ident" id="6245327">match</span>&nbsp;<span class="op" id="6245333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245338">if</span>&nbsp;<span class="ident" id="6245341">ext</span>&nbsp;<span class="op" id="6245345">==</span>&nbsp;<span class="string" id="6245348">&#34;.go&#34;</span>&nbsp;<span class="op" id="6245354">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245360">p</span><span class="op" id="6245361">.</span><span class="ident" id="6245362">IgnoredGoFiles</span>&nbsp;<span class="op" id="6245377">=</span>&nbsp;<span class="builtinfunc" id="6245379">append</span><span class="op" id="6245385">(</span><span class="ident" id="6245386">p</span><span class="op" id="6245387">.</span><span class="ident" id="6245388">IgnoredGoFiles</span><span class="op" id="6245402">,</span>&nbsp;<span class="ident" id="6245404">name</span><span class="op" id="6245408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245418">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6245429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6245434">//&nbsp;Going&nbsp;to&nbsp;save&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;non-Go&nbsp;files,&nbsp;can&nbsp;stop&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245497">switch</span>&nbsp;<span class="ident" id="6245504">ext</span>&nbsp;<span class="op" id="6245508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245512">case</span>&nbsp;<span class="string" id="6245517">&#34;.c&#34;</span><span class="op" id="6245521">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245526">p</span><span class="op" id="6245527">.</span><span class="ident" id="6245528">CFiles</span>&nbsp;<span class="op" id="6245535">=</span>&nbsp;<span class="builtinfunc" id="6245537">append</span><span class="op" id="6245543">(</span><span class="ident" id="6245544">p</span><span class="op" id="6245545">.</span><span class="ident" id="6245546">CFiles</span><span class="op" id="6245552">,</span>&nbsp;<span class="ident" id="6245554">name</span><span class="op" id="6245558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245563">continue</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245574">case</span>&nbsp;<span class="string" id="6245579">&#34;.cc&#34;</span><span class="op" id="6245584">,</span>&nbsp;<span class="string" id="6245586">&#34;.cpp&#34;</span><span class="op" id="6245592">,</span>&nbsp;<span class="string" id="6245594">&#34;.cxx&#34;</span><span class="op" id="6245600">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245605">p</span><span class="op" id="6245606">.</span><span class="ident" id="6245607">CXXFiles</span>&nbsp;<span class="op" id="6245616">=</span>&nbsp;<span class="builtinfunc" id="6245618">append</span><span class="op" id="6245624">(</span><span class="ident" id="6245625">p</span><span class="op" id="6245626">.</span><span class="ident" id="6245627">CXXFiles</span><span class="op" id="6245635">,</span>&nbsp;<span class="ident" id="6245637">name</span><span class="op" id="6245641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245646">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245657">case</span>&nbsp;<span class="string" id="6245662">&#34;.m&#34;</span><span class="op" id="6245666">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245671">p</span><span class="op" id="6245672">.</span><span class="ident" id="6245673">MFiles</span>&nbsp;<span class="op" id="6245680">=</span>&nbsp;<span class="builtinfunc" id="6245682">append</span><span class="op" id="6245688">(</span><span class="ident" id="6245689">p</span><span class="op" id="6245690">.</span><span class="ident" id="6245691">MFiles</span><span class="op" id="6245697">,</span>&nbsp;<span class="ident" id="6245699">name</span><span class="op" id="6245703">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245708">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245719">case</span>&nbsp;<span class="string" id="6245724">&#34;.h&#34;</span><span class="op" id="6245728">,</span>&nbsp;<span class="string" id="6245730">&#34;.hh&#34;</span><span class="op" id="6245735">,</span>&nbsp;<span class="string" id="6245737">&#34;.hpp&#34;</span><span class="op" id="6245743">,</span>&nbsp;<span class="string" id="6245745">&#34;.hxx&#34;</span><span class="op" id="6245751">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245756">p</span><span class="op" id="6245757">.</span><span class="ident" id="6245758">HFiles</span>&nbsp;<span class="op" id="6245765">=</span>&nbsp;<span class="builtinfunc" id="6245767">append</span><span class="op" id="6245773">(</span><span class="ident" id="6245774">p</span><span class="op" id="6245775">.</span><span class="ident" id="6245776">HFiles</span><span class="op" id="6245782">,</span>&nbsp;<span class="ident" id="6245784">name</span><span class="op" id="6245788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245793">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245804">case</span>&nbsp;<span class="string" id="6245809">&#34;.s&#34;</span><span class="op" id="6245813">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245818">p</span><span class="op" id="6245819">.</span><span class="ident" id="6245820">SFiles</span>&nbsp;<span class="op" id="6245827">=</span>&nbsp;<span class="builtinfunc" id="6245829">append</span><span class="op" id="6245835">(</span><span class="ident" id="6245836">p</span><span class="op" id="6245837">.</span><span class="ident" id="6245838">SFiles</span><span class="op" id="6245844">,</span>&nbsp;<span class="ident" id="6245846">name</span><span class="op" id="6245850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245855">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245866">case</span>&nbsp;<span class="string" id="6245871">&#34;.S&#34;</span><span class="op" id="6245875">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245880">Sfiles</span>&nbsp;<span class="op" id="6245887">=</span>&nbsp;<span class="builtinfunc" id="6245889">append</span><span class="op" id="6245895">(</span><span class="ident" id="6245896">Sfiles</span><span class="op" id="6245902">,</span>&nbsp;<span class="ident" id="6245904">name</span><span class="op" id="6245908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245913">continue</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245924">case</span>&nbsp;<span class="string" id="6245929">&#34;.swig&#34;</span><span class="op" id="6245936">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6245941">p</span><span class="op" id="6245942">.</span><span class="ident" id="6245943">SwigFiles</span>&nbsp;<span class="op" id="6245953">=</span>&nbsp;<span class="builtinfunc" id="6245955">append</span><span class="op" id="6245961">(</span><span class="ident" id="6245962">p</span><span class="op" id="6245963">.</span><span class="ident" id="6245964">SwigFiles</span><span class="op" id="6245973">,</span>&nbsp;<span class="ident" id="6245975">name</span><span class="op" id="6245979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245984">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6245995">case</span>&nbsp;<span class="string" id="6246000">&#34;.swigcxx&#34;</span><span class="op" id="6246010">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246015">p</span><span class="op" id="6246016">.</span><span class="ident" id="6246017">SwigCXXFiles</span>&nbsp;<span class="op" id="6246030">=</span>&nbsp;<span class="builtinfunc" id="6246032">append</span><span class="op" id="6246038">(</span><span class="ident" id="6246039">p</span><span class="op" id="6246040">.</span><span class="ident" id="6246041">SwigCXXFiles</span><span class="op" id="6246053">,</span>&nbsp;<span class="ident" id="6246055">name</span><span class="op" id="6246059">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246064">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246075">case</span>&nbsp;<span class="string" id="6246080">&#34;.syso&#34;</span><span class="op" id="6246087">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6246092">//&nbsp;binary&nbsp;objects&nbsp;to&nbsp;add&nbsp;to&nbsp;package&nbsp;archive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6246139">//&nbsp;Likely&nbsp;of&nbsp;the&nbsp;form&nbsp;foo_windows.syso,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6246186">//&nbsp;the&nbsp;name&nbsp;was&nbsp;vetted&nbsp;above&nbsp;with&nbsp;goodOSArchFile.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246239">p</span><span class="op" id="6246240">.</span><span class="ident" id="6246241">SysoFiles</span>&nbsp;<span class="op" id="6246251">=</span>&nbsp;<span class="builtinfunc" id="6246253">append</span><span class="op" id="6246259">(</span><span class="ident" id="6246260">p</span><span class="op" id="6246261">.</span><span class="ident" id="6246262">SysoFiles</span><span class="op" id="6246271">,</span>&nbsp;<span class="ident" id="6246273">name</span><span class="op" id="6246277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246282">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6246293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246298">pf</span><span class="op" id="6246300">,</span>&nbsp;<span class="ident" id="6246302">err</span>&nbsp;<span class="op" id="6246306">:=</span>&nbsp;<span class="ident" id="6246309">parser</span><span class="op" id="6246315">.</span><span class="ident" id="6246316">ParseFile</span><span class="op" id="6246325">(</span><span class="ident" id="6246326">fset</span><span class="op" id="6246330">,</span>&nbsp;<span class="ident" id="6246332">filename</span><span class="op" id="6246340">,</span>&nbsp;<span class="ident" id="6246342">data</span><span class="op" id="6246346">,</span>&nbsp;<span class="ident" id="6246348">parser</span><span class="op" id="6246354">.</span><span class="ident" id="6246355">ImportsOnly</span><span class="op" id="6246366">|</span><span class="ident" id="6246367">parser</span><span class="op" id="6246373">.</span><span class="ident" id="6246374">ParseComments</span><span class="op" id="6246387">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246391">if</span>&nbsp;<span class="ident" id="6246394">err</span>&nbsp;<span class="op" id="6246398">!=</span>&nbsp;<span class="ident" id="6246401">nil</span>&nbsp;<span class="op" id="6246405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246410">return</span>&nbsp;<span class="ident" id="6246417">p</span><span class="op" id="6246418">,</span>&nbsp;<span class="ident" id="6246420">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6246426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246431">pkg</span>&nbsp;<span class="op" id="6246435">:=</span>&nbsp;<span class="ident" id="6246438">pf</span><span class="op" id="6246440">.</span><span class="ident" id="6246441">Name</span><span class="op" id="6246445">.</span><span class="ident" id="6246446">Name</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246453">if</span>&nbsp;<span class="ident" id="6246456">pkg</span>&nbsp;<span class="op" id="6246460">==</span>&nbsp;<span class="string" id="6246463">&#34;documentation&#34;</span>&nbsp;<span class="op" id="6246479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246484">p</span><span class="op" id="6246485">.</span><span class="ident" id="6246486">IgnoredGoFiles</span>&nbsp;<span class="op" id="6246501">=</span>&nbsp;<span class="builtinfunc" id="6246503">append</span><span class="op" id="6246509">(</span><span class="ident" id="6246510">p</span><span class="op" id="6246511">.</span><span class="ident" id="6246512">IgnoredGoFiles</span><span class="op" id="6246526">,</span>&nbsp;<span class="ident" id="6246528">name</span><span class="op" id="6246532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246537">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6246548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246553">isTest</span>&nbsp;<span class="op" id="6246560">:=</span>&nbsp;<span class="ident" id="6246563">strings</span><span class="op" id="6246570">.</span><span class="ident" id="6246571">HasSuffix</span><span class="op" id="6246580">(</span><span class="ident" id="6246581">name</span><span class="op" id="6246585">,</span>&nbsp;<span class="string" id="6246587">&#34;_test.go&#34;</span><span class="op" id="6246597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246601">isXTest</span>&nbsp;<span class="op" id="6246609">:=</span>&nbsp;<span class="builtintype" id="6246612">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246620">if</span>&nbsp;<span class="ident" id="6246623">isTest</span>&nbsp;<span class="op" id="6246630">&amp;&amp;</span>&nbsp;<span class="ident" id="6246633">strings</span><span class="op" id="6246640">.</span><span class="ident" id="6246641">HasSuffix</span><span class="op" id="6246650">(</span><span class="ident" id="6246651">pkg</span><span class="op" id="6246654">,</span>&nbsp;<span class="string" id="6246656">&#34;_test&#34;</span><span class="op" id="6246663">)</span>&nbsp;<span class="op" id="6246665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246670">isXTest</span>&nbsp;<span class="op" id="6246678">=</span>&nbsp;<span class="builtintype" id="6246680">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246688">pkg</span>&nbsp;<span class="op" id="6246692">=</span>&nbsp;<span class="ident" id="6246694">pkg</span><span class="op" id="6246697">[</span><span class="op" id="6246698">:</span><span class="builtinfunc" id="6246699">len</span><span class="op" id="6246702">(</span><span class="ident" id="6246703">pkg</span><span class="op" id="6246706">)</span><span class="op" id="6246707">-</span><span class="builtinfunc" id="6246708">len</span><span class="op" id="6246711">(</span><span class="string" id="6246712">&#34;_test&#34;</span><span class="op" id="6246719">)</span><span class="op" id="6246720">]</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6246724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246729">if</span>&nbsp;<span class="ident" id="6246732">p</span><span class="op" id="6246733">.</span><span class="ident" id="6246734">Name</span>&nbsp;<span class="op" id="6246739">==</span>&nbsp;<span class="string" id="6246742">&#34;&#34;</span>&nbsp;<span class="op" id="6246745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246750">p</span><span class="op" id="6246751">.</span><span class="ident" id="6246752">Name</span>&nbsp;<span class="op" id="6246757">=</span>&nbsp;<span class="ident" id="6246759">pkg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246766">firstFile</span>&nbsp;<span class="op" id="6246776">=</span>&nbsp;<span class="ident" id="6246778">name</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6246785">}</span>&nbsp;<span class="keyword" id="6246787">else</span>&nbsp;<span class="keyword" id="6246792">if</span>&nbsp;<span class="ident" id="6246795">pkg</span>&nbsp;<span class="op" id="6246799">!=</span>&nbsp;<span class="ident" id="6246802">p</span><span class="op" id="6246803">.</span><span class="ident" id="6246804">Name</span>&nbsp;<span class="op" id="6246809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246814">return</span>&nbsp;<span class="ident" id="6246821">p</span><span class="op" id="6246822">,</span>&nbsp;<span class="op" id="6246824">&amp;</span><span class="ident" id="6246825">MultiplePackageError</span><span class="op" id="6246845">{</span><span class="ident" id="6246846">p</span><span class="op" id="6246847">.</span><span class="ident" id="6246848">Dir</span><span class="op" id="6246851">,</span>&nbsp;<span class="op" id="6246853">[</span><span class="op" id="6246854">]</span><span class="builtintype" id="6246855">string</span><span class="op" id="6246861">{</span><span class="ident" id="6246862">firstFile</span><span class="op" id="6246871">,</span>&nbsp;<span class="ident" id="6246873">name</span><span class="op" id="6246877">}</span><span class="op" id="6246878">,</span>&nbsp;<span class="op" id="6246880">[</span><span class="op" id="6246881">]</span><span class="builtintype" id="6246882">string</span><span class="op" id="6246888">{</span><span class="ident" id="6246889">p</span><span class="op" id="6246890">.</span><span class="ident" id="6246891">Name</span><span class="op" id="6246895">,</span>&nbsp;<span class="ident" id="6246897">pkg</span><span class="op" id="6246900">}</span><span class="op" id="6246901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6246905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246909">if</span>&nbsp;<span class="ident" id="6246912">pf</span><span class="op" id="6246914">.</span><span class="ident" id="6246915">Doc</span>&nbsp;<span class="op" id="6246919">!=</span>&nbsp;<span class="ident" id="6246922">nil</span>&nbsp;<span class="op" id="6246926">&amp;&amp;</span>&nbsp;<span class="ident" id="6246929">p</span><span class="op" id="6246930">.</span><span class="ident" id="6246931">Doc</span>&nbsp;<span class="op" id="6246935">==</span>&nbsp;<span class="string" id="6246938">&#34;&#34;</span>&nbsp;<span class="op" id="6246941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6246946">p</span><span class="op" id="6246947">.</span><span class="ident" id="6246948">Doc</span>&nbsp;<span class="op" id="6246952">=</span>&nbsp;<span class="ident" id="6246954">doc</span><span class="op" id="6246957">.</span><span class="ident" id="6246958">Synopsis</span><span class="op" id="6246966">(</span><span class="ident" id="6246967">pf</span><span class="op" id="6246969">.</span><span class="ident" id="6246970">Doc</span><span class="op" id="6246973">.</span><span class="ident" id="6246974">Text</span><span class="op" id="6246978">(</span><span class="op" id="6246979">)</span><span class="op" id="6246980">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6246984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6246989">if</span>&nbsp;<span class="ident" id="6246992">mode</span><span class="op" id="6246996">&amp;</span><span class="ident" id="6246997">ImportComment</span>&nbsp;<span class="op" id="6247011">!=</span>&nbsp;<span class="num" id="6247014">0</span>&nbsp;<span class="op" id="6247016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247021">qcom</span><span class="op" id="6247025">,</span>&nbsp;<span class="ident" id="6247027">line</span>&nbsp;<span class="op" id="6247032">:=</span>&nbsp;<span class="ident" id="6247035">findImportComment</span><span class="op" id="6247052">(</span><span class="ident" id="6247053">data</span><span class="op" id="6247057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247062">if</span>&nbsp;<span class="ident" id="6247065">line</span>&nbsp;<span class="op" id="6247070">!=</span>&nbsp;<span class="num" id="6247073">0</span>&nbsp;<span class="op" id="6247075">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247081">com</span><span class="op" id="6247084">,</span>&nbsp;<span class="ident" id="6247086">err</span>&nbsp;<span class="op" id="6247090">:=</span>&nbsp;<span class="ident" id="6247093">strconv</span><span class="op" id="6247100">.</span><span class="ident" id="6247101">Unquote</span><span class="op" id="6247108">(</span><span class="ident" id="6247109">qcom</span><span class="op" id="6247113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247119">if</span>&nbsp;<span class="ident" id="6247122">err</span>&nbsp;<span class="op" id="6247126">!=</span>&nbsp;<span class="ident" id="6247129">nil</span>&nbsp;<span class="op" id="6247133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247140">return</span>&nbsp;<span class="ident" id="6247147">p</span><span class="op" id="6247148">,</span>&nbsp;<span class="ident" id="6247150">fmt</span><span class="op" id="6247153">.</span><span class="ident" id="6247154">Errorf</span><span class="op" id="6247160">(</span><span class="string" id="6247161">&#34;%s:%d:&nbsp;cannot&nbsp;parse&nbsp;import&nbsp;comment&#34;</span><span class="op" id="6247197">,</span>&nbsp;<span class="ident" id="6247199">filename</span><span class="op" id="6247207">,</span>&nbsp;<span class="ident" id="6247209">line</span><span class="op" id="6247213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247225">if</span>&nbsp;<span class="ident" id="6247228">p</span><span class="op" id="6247229">.</span><span class="ident" id="6247230">ImportComment</span>&nbsp;<span class="op" id="6247244">==</span>&nbsp;<span class="string" id="6247247">&#34;&#34;</span>&nbsp;<span class="op" id="6247250">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247257">p</span><span class="op" id="6247258">.</span><span class="ident" id="6247259">ImportComment</span>&nbsp;<span class="op" id="6247273">=</span>&nbsp;<span class="ident" id="6247275">com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247284">firstCommentFile</span>&nbsp;<span class="op" id="6247301">=</span>&nbsp;<span class="ident" id="6247303">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247312">}</span>&nbsp;<span class="keyword" id="6247314">else</span>&nbsp;<span class="keyword" id="6247319">if</span>&nbsp;<span class="ident" id="6247322">p</span><span class="op" id="6247323">.</span><span class="ident" id="6247324">ImportComment</span>&nbsp;<span class="op" id="6247338">!=</span>&nbsp;<span class="ident" id="6247341">com</span>&nbsp;<span class="op" id="6247345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247352">return</span>&nbsp;<span class="ident" id="6247359">p</span><span class="op" id="6247360">,</span>&nbsp;<span class="ident" id="6247362">fmt</span><span class="op" id="6247365">.</span><span class="ident" id="6247366">Errorf</span><span class="op" id="6247372">(</span><span class="string" id="6247373">&#34;found&nbsp;import&nbsp;comments&nbsp;%q&nbsp;(%s)&nbsp;and&nbsp;%q&nbsp;(%s)&nbsp;in&nbsp;%s&#34;</span><span class="op" id="6247422">,</span>&nbsp;<span class="ident" id="6247424">p</span><span class="op" id="6247425">.</span><span class="ident" id="6247426">ImportComment</span><span class="op" id="6247439">,</span>&nbsp;<span class="ident" id="6247441">firstCommentFile</span><span class="op" id="6247457">,</span>&nbsp;<span class="ident" id="6247459">com</span><span class="op" id="6247462">,</span>&nbsp;<span class="ident" id="6247464">name</span><span class="op" id="6247468">,</span>&nbsp;<span class="ident" id="6247470">p</span><span class="op" id="6247471">.</span><span class="ident" id="6247472">Dir</span><span class="op" id="6247475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247481">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6247495">//&nbsp;Record&nbsp;imports&nbsp;and&nbsp;information&nbsp;about&nbsp;cgo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247542">isCgo</span>&nbsp;<span class="op" id="6247548">:=</span>&nbsp;<span class="builtintype" id="6247551">false</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247559">for</span>&nbsp;<span class="ident" id="6247563">_</span><span class="op" id="6247564">,</span>&nbsp;<span class="ident" id="6247566">decl</span>&nbsp;<span class="op" id="6247571">:=</span>&nbsp;<span class="keyword" id="6247574">range</span>&nbsp;<span class="ident" id="6247580">pf</span><span class="op" id="6247582">.</span><span class="ident" id="6247583">Decls</span>&nbsp;<span class="op" id="6247589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247594">d</span><span class="op" id="6247595">,</span>&nbsp;<span class="ident" id="6247597">ok</span>&nbsp;<span class="op" id="6247600">:=</span>&nbsp;<span class="ident" id="6247603">decl</span><span class="op" id="6247607">.</span><span class="op" id="6247608">(</span><span class="op" id="6247609">*</span><span class="ident" id="6247610">ast</span><span class="op" id="6247613">.</span><span class="ident" id="6247614">GenDecl</span><span class="op" id="6247621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247626">if</span>&nbsp;<span class="op" id="6247629">!</span><span class="ident" id="6247630">ok</span>&nbsp;<span class="op" id="6247633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247639">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247651">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247656">for</span>&nbsp;<span class="ident" id="6247660">_</span><span class="op" id="6247661">,</span>&nbsp;<span class="ident" id="6247663">dspec</span>&nbsp;<span class="op" id="6247669">:=</span>&nbsp;<span class="keyword" id="6247672">range</span>&nbsp;<span class="ident" id="6247678">d</span><span class="op" id="6247679">.</span><span class="ident" id="6247680">Specs</span>&nbsp;<span class="op" id="6247686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247692">spec</span><span class="op" id="6247696">,</span>&nbsp;<span class="ident" id="6247698">ok</span>&nbsp;<span class="op" id="6247701">:=</span>&nbsp;<span class="ident" id="6247704">dspec</span><span class="op" id="6247709">.</span><span class="op" id="6247710">(</span><span class="op" id="6247711">*</span><span class="ident" id="6247712">ast</span><span class="op" id="6247715">.</span><span class="ident" id="6247716">ImportSpec</span><span class="op" id="6247726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247732">if</span>&nbsp;<span class="op" id="6247735">!</span><span class="ident" id="6247736">ok</span>&nbsp;<span class="op" id="6247739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247746">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247759">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247765">quoted</span>&nbsp;<span class="op" id="6247772">:=</span>&nbsp;<span class="ident" id="6247775">spec</span><span class="op" id="6247779">.</span><span class="ident" id="6247780">Path</span><span class="op" id="6247784">.</span><span class="ident" id="6247785">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247795">path</span><span class="op" id="6247799">,</span>&nbsp;<span class="ident" id="6247801">err</span>&nbsp;<span class="op" id="6247805">:=</span>&nbsp;<span class="ident" id="6247808">strconv</span><span class="op" id="6247815">.</span><span class="ident" id="6247816">Unquote</span><span class="op" id="6247823">(</span><span class="ident" id="6247824">quoted</span><span class="op" id="6247830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247836">if</span>&nbsp;<span class="ident" id="6247839">err</span>&nbsp;<span class="op" id="6247843">!=</span>&nbsp;<span class="ident" id="6247846">nil</span>&nbsp;<span class="op" id="6247850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247857">log</span><span class="op" id="6247860">.</span><span class="ident" id="6247861">Panicf</span><span class="op" id="6247867">(</span><span class="string" id="6247868">&#34;%s:&nbsp;parser&nbsp;returned&nbsp;invalid&nbsp;quoted&nbsp;string:&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="6247917">,</span>&nbsp;<span class="ident" id="6247919">filename</span><span class="op" id="6247927">,</span>&nbsp;<span class="ident" id="6247929">quoted</span><span class="op" id="6247935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6247941">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6247947">if</span>&nbsp;<span class="ident" id="6247950">isXTest</span>&nbsp;<span class="op" id="6247958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6247965">xTestImported</span><span class="op" id="6247978">[</span><span class="ident" id="6247979">path</span><span class="op" id="6247983">]</span>&nbsp;<span class="op" id="6247985">=</span>&nbsp;<span class="builtinfunc" id="6247987">append</span><span class="op" id="6247993">(</span><span class="ident" id="6247994">xTestImported</span><span class="op" id="6248007">[</span><span class="ident" id="6248008">path</span><span class="op" id="6248012">]</span><span class="op" id="6248013">,</span>&nbsp;<span class="ident" id="6248015">fset</span><span class="op" id="6248019">.</span><span class="ident" id="6248020">Position</span><span class="op" id="6248028">(</span><span class="ident" id="6248029">spec</span><span class="op" id="6248033">.</span><span class="ident" id="6248034">Pos</span><span class="op" id="6248037">(</span><span class="op" id="6248038">)</span><span class="op" id="6248039">)</span><span class="op" id="6248040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248046">}</span>&nbsp;<span class="keyword" id="6248048">else</span>&nbsp;<span class="keyword" id="6248053">if</span>&nbsp;<span class="ident" id="6248056">isTest</span>&nbsp;<span class="op" id="6248063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248070">testImported</span><span class="op" id="6248082">[</span><span class="ident" id="6248083">path</span><span class="op" id="6248087">]</span>&nbsp;<span class="op" id="6248089">=</span>&nbsp;<span class="builtinfunc" id="6248091">append</span><span class="op" id="6248097">(</span><span class="ident" id="6248098">testImported</span><span class="op" id="6248110">[</span><span class="ident" id="6248111">path</span><span class="op" id="6248115">]</span><span class="op" id="6248116">,</span>&nbsp;<span class="ident" id="6248118">fset</span><span class="op" id="6248122">.</span><span class="ident" id="6248123">Position</span><span class="op" id="6248131">(</span><span class="ident" id="6248132">spec</span><span class="op" id="6248136">.</span><span class="ident" id="6248137">Pos</span><span class="op" id="6248140">(</span><span class="op" id="6248141">)</span><span class="op" id="6248142">)</span><span class="op" id="6248143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248149">}</span>&nbsp;<span class="keyword" id="6248151">else</span>&nbsp;<span class="op" id="6248156">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248163">imported</span><span class="op" id="6248171">[</span><span class="ident" id="6248172">path</span><span class="op" id="6248176">]</span>&nbsp;<span class="op" id="6248178">=</span>&nbsp;<span class="builtinfunc" id="6248180">append</span><span class="op" id="6248186">(</span><span class="ident" id="6248187">imported</span><span class="op" id="6248195">[</span><span class="ident" id="6248196">path</span><span class="op" id="6248200">]</span><span class="op" id="6248201">,</span>&nbsp;<span class="ident" id="6248203">fset</span><span class="op" id="6248207">.</span><span class="ident" id="6248208">Position</span><span class="op" id="6248216">(</span><span class="ident" id="6248217">spec</span><span class="op" id="6248221">.</span><span class="ident" id="6248222">Pos</span><span class="op" id="6248225">(</span><span class="op" id="6248226">)</span><span class="op" id="6248227">)</span><span class="op" id="6248228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248240">if</span>&nbsp;<span class="ident" id="6248243">path</span>&nbsp;<span class="op" id="6248248">==</span>&nbsp;<span class="string" id="6248251">&#34;C&#34;</span>&nbsp;<span class="op" id="6248255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248262">if</span>&nbsp;<span class="ident" id="6248265">isTest</span>&nbsp;<span class="op" id="6248272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248280">return</span>&nbsp;<span class="ident" id="6248287">p</span><span class="op" id="6248288">,</span>&nbsp;<span class="ident" id="6248290">fmt</span><span class="op" id="6248293">.</span><span class="ident" id="6248294">Errorf</span><span class="op" id="6248300">(</span><span class="string" id="6248301">&#34;use&nbsp;of&nbsp;cgo&nbsp;in&nbsp;test&nbsp;%s&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6248338">,</span>&nbsp;<span class="ident" id="6248340">filename</span><span class="op" id="6248348">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248362">cg</span>&nbsp;<span class="op" id="6248365">:=</span>&nbsp;<span class="ident" id="6248368">spec</span><span class="op" id="6248372">.</span><span class="ident" id="6248373">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248382">if</span>&nbsp;<span class="ident" id="6248385">cg</span>&nbsp;<span class="op" id="6248388">==</span>&nbsp;<span class="ident" id="6248391">nil</span>&nbsp;<span class="op" id="6248395">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6248398">len</span><span class="op" id="6248401">(</span><span class="ident" id="6248402">d</span><span class="op" id="6248403">.</span><span class="ident" id="6248404">Specs</span><span class="op" id="6248409">)</span>&nbsp;<span class="op" id="6248411">==</span>&nbsp;<span class="num" id="6248414">1</span>&nbsp;<span class="op" id="6248416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248424">cg</span>&nbsp;<span class="op" id="6248427">=</span>&nbsp;<span class="ident" id="6248429">d</span><span class="op" id="6248430">.</span><span class="ident" id="6248431">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248440">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248447">if</span>&nbsp;<span class="ident" id="6248450">cg</span>&nbsp;<span class="op" id="6248453">!=</span>&nbsp;<span class="ident" id="6248456">nil</span>&nbsp;<span class="op" id="6248460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248468">if</span>&nbsp;<span class="ident" id="6248471">err</span>&nbsp;<span class="op" id="6248475">:=</span>&nbsp;<span class="ident" id="6248478">ctxt</span><span class="op" id="6248482">.</span><span class="ident" id="6248483">saveCgo</span><span class="op" id="6248490">(</span><span class="ident" id="6248491">filename</span><span class="op" id="6248499">,</span>&nbsp;<span class="ident" id="6248501">p</span><span class="op" id="6248502">,</span>&nbsp;<span class="ident" id="6248504">cg</span><span class="op" id="6248506">)</span><span class="op" id="6248507">;</span>&nbsp;<span class="ident" id="6248509">err</span>&nbsp;<span class="op" id="6248513">!=</span>&nbsp;<span class="ident" id="6248516">nil</span>&nbsp;<span class="op" id="6248520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248529">return</span>&nbsp;<span class="ident" id="6248536">p</span><span class="op" id="6248537">,</span>&nbsp;<span class="ident" id="6248539">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248556">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248563">isCgo</span>&nbsp;<span class="op" id="6248569">=</span>&nbsp;<span class="builtintype" id="6248571">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248593">if</span>&nbsp;<span class="ident" id="6248596">isCgo</span>&nbsp;<span class="op" id="6248602">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248607">allTags</span><span class="op" id="6248614">[</span><span class="string" id="6248615">&#34;cgo&#34;</span><span class="op" id="6248620">]</span>&nbsp;<span class="op" id="6248622">=</span>&nbsp;<span class="builtintype" id="6248624">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248632">if</span>&nbsp;<span class="ident" id="6248635">ctxt</span><span class="op" id="6248639">.</span><span class="ident" id="6248640">CgoEnabled</span>&nbsp;<span class="op" id="6248651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248657">p</span><span class="op" id="6248658">.</span><span class="ident" id="6248659">CgoFiles</span>&nbsp;<span class="op" id="6248668">=</span>&nbsp;<span class="builtinfunc" id="6248670">append</span><span class="op" id="6248676">(</span><span class="ident" id="6248677">p</span><span class="op" id="6248678">.</span><span class="ident" id="6248679">CgoFiles</span><span class="op" id="6248687">,</span>&nbsp;<span class="ident" id="6248689">name</span><span class="op" id="6248693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248698">}</span>&nbsp;<span class="keyword" id="6248700">else</span>&nbsp;<span class="op" id="6248705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248711">p</span><span class="op" id="6248712">.</span><span class="ident" id="6248713">IgnoredGoFiles</span>&nbsp;<span class="op" id="6248728">=</span>&nbsp;<span class="builtinfunc" id="6248730">append</span><span class="op" id="6248736">(</span><span class="ident" id="6248737">p</span><span class="op" id="6248738">.</span><span class="ident" id="6248739">IgnoredGoFiles</span><span class="op" id="6248753">,</span>&nbsp;<span class="ident" id="6248755">name</span><span class="op" id="6248759">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248768">}</span>&nbsp;<span class="keyword" id="6248770">else</span>&nbsp;<span class="keyword" id="6248775">if</span>&nbsp;<span class="ident" id="6248778">isXTest</span>&nbsp;<span class="op" id="6248786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248791">p</span><span class="op" id="6248792">.</span><span class="ident" id="6248793">XTestGoFiles</span>&nbsp;<span class="op" id="6248806">=</span>&nbsp;<span class="builtinfunc" id="6248808">append</span><span class="op" id="6248814">(</span><span class="ident" id="6248815">p</span><span class="op" id="6248816">.</span><span class="ident" id="6248817">XTestGoFiles</span><span class="op" id="6248829">,</span>&nbsp;<span class="ident" id="6248831">name</span><span class="op" id="6248835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248839">}</span>&nbsp;<span class="keyword" id="6248841">else</span>&nbsp;<span class="keyword" id="6248846">if</span>&nbsp;<span class="ident" id="6248849">isTest</span>&nbsp;<span class="op" id="6248856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248861">p</span><span class="op" id="6248862">.</span><span class="ident" id="6248863">TestGoFiles</span>&nbsp;<span class="op" id="6248875">=</span>&nbsp;<span class="builtinfunc" id="6248877">append</span><span class="op" id="6248883">(</span><span class="ident" id="6248884">p</span><span class="op" id="6248885">.</span><span class="ident" id="6248886">TestGoFiles</span><span class="op" id="6248897">,</span>&nbsp;<span class="ident" id="6248899">name</span><span class="op" id="6248903">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248907">}</span>&nbsp;<span class="keyword" id="6248909">else</span>&nbsp;<span class="op" id="6248914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6248919">p</span><span class="op" id="6248920">.</span><span class="ident" id="6248921">GoFiles</span>&nbsp;<span class="op" id="6248929">=</span>&nbsp;<span class="builtinfunc" id="6248931">append</span><span class="op" id="6248937">(</span><span class="ident" id="6248938">p</span><span class="op" id="6248939">.</span><span class="ident" id="6248940">GoFiles</span><span class="op" id="6248947">,</span>&nbsp;<span class="ident" id="6248949">name</span><span class="op" id="6248953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6248960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6248963">if</span>&nbsp;<span class="builtinfunc" id="6248966">len</span><span class="op" id="6248969">(</span><span class="ident" id="6248970">p</span><span class="op" id="6248971">.</span><span class="ident" id="6248972">GoFiles</span><span class="op" id="6248979">)</span><span class="op" id="6248980">+</span><span class="builtinfunc" id="6248981">len</span><span class="op" id="6248984">(</span><span class="ident" id="6248985">p</span><span class="op" id="6248986">.</span><span class="ident" id="6248987">CgoFiles</span><span class="op" id="6248995">)</span><span class="op" id="6248996">+</span><span class="builtinfunc" id="6248997">len</span><span class="op" id="6249000">(</span><span class="ident" id="6249001">p</span><span class="op" id="6249002">.</span><span class="ident" id="6249003">TestGoFiles</span><span class="op" id="6249014">)</span><span class="op" id="6249015">+</span><span class="builtinfunc" id="6249016">len</span><span class="op" id="6249019">(</span><span class="ident" id="6249020">p</span><span class="op" id="6249021">.</span><span class="ident" id="6249022">XTestGoFiles</span><span class="op" id="6249034">)</span>&nbsp;<span class="op" id="6249036">==</span>&nbsp;<span class="num" id="6249039">0</span>&nbsp;<span class="op" id="6249041">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6249045">return</span>&nbsp;<span class="ident" id="6249052">p</span><span class="op" id="6249053">,</span>&nbsp;<span class="op" id="6249055">&amp;</span><span class="ident" id="6249056">NoGoError</span><span class="op" id="6249065">{</span><span class="ident" id="6249066">p</span><span class="op" id="6249067">.</span><span class="ident" id="6249068">Dir</span><span class="op" id="6249071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6249074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6249078">for</span>&nbsp;<span class="ident" id="6249082">tag</span>&nbsp;<span class="op" id="6249086">:=</span>&nbsp;<span class="keyword" id="6249089">range</span>&nbsp;<span class="ident" id="6249095">allTags</span>&nbsp;<span class="op" id="6249103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249107">p</span><span class="op" id="6249108">.</span><span class="ident" id="6249109">AllTags</span>&nbsp;<span class="op" id="6249117">=</span>&nbsp;<span class="builtinfunc" id="6249119">append</span><span class="op" id="6249125">(</span><span class="ident" id="6249126">p</span><span class="op" id="6249127">.</span><span class="ident" id="6249128">AllTags</span><span class="op" id="6249135">,</span>&nbsp;<span class="ident" id="6249137">tag</span><span class="op" id="6249140">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6249143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249146">sort</span><span class="op" id="6249150">.</span><span class="ident" id="6249151">Strings</span><span class="op" id="6249158">(</span><span class="ident" id="6249159">p</span><span class="op" id="6249160">.</span><span class="ident" id="6249161">AllTags</span><span class="op" id="6249168">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249172">p</span><span class="op" id="6249173">.</span><span class="ident" id="6249174">Imports</span><span class="op" id="6249181">,</span>&nbsp;<span class="ident" id="6249183">p</span><span class="op" id="6249184">.</span><span class="ident" id="6249185">ImportPos</span>&nbsp;<span class="op" id="6249195">=</span>&nbsp;<span class="ident" id="6249197">cleanImports</span><span class="op" id="6249209">(</span><span class="ident" id="6249210">imported</span><span class="op" id="6249218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249221">p</span><span class="op" id="6249222">.</span><span class="ident" id="6249223">TestImports</span><span class="op" id="6249234">,</span>&nbsp;<span class="ident" id="6249236">p</span><span class="op" id="6249237">.</span><span class="ident" id="6249238">TestImportPos</span>&nbsp;<span class="op" id="6249252">=</span>&nbsp;<span class="ident" id="6249254">cleanImports</span><span class="op" id="6249266">(</span><span class="ident" id="6249267">testImported</span><span class="op" id="6249279">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249282">p</span><span class="op" id="6249283">.</span><span class="ident" id="6249284">XTestImports</span><span class="op" id="6249296">,</span>&nbsp;<span class="ident" id="6249298">p</span><span class="op" id="6249299">.</span><span class="ident" id="6249300">XTestImportPos</span>&nbsp;<span class="op" id="6249315">=</span>&nbsp;<span class="ident" id="6249317">cleanImports</span><span class="op" id="6249329">(</span><span class="ident" id="6249330">xTestImported</span><span class="op" id="6249343">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6249347">//&nbsp;add&nbsp;the&nbsp;.S&nbsp;files&nbsp;only&nbsp;if&nbsp;we&nbsp;are&nbsp;using&nbsp;cgo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6249393">//&nbsp;(which&nbsp;means&nbsp;gcc&nbsp;will&nbsp;compile&nbsp;them).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6249434">//&nbsp;The&nbsp;standard&nbsp;assemblers&nbsp;expect&nbsp;.s&nbsp;files.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6249479">if</span>&nbsp;<span class="builtinfunc" id="6249482">len</span><span class="op" id="6249485">(</span><span class="ident" id="6249486">p</span><span class="op" id="6249487">.</span><span class="ident" id="6249488">CgoFiles</span><span class="op" id="6249496">)</span>&nbsp;<span class="op" id="6249498">&gt;</span>&nbsp;<span class="num" id="6249500">0</span>&nbsp;<span class="op" id="6249502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249506">p</span><span class="op" id="6249507">.</span><span class="ident" id="6249508">SFiles</span>&nbsp;<span class="op" id="6249515">=</span>&nbsp;<span class="builtinfunc" id="6249517">append</span><span class="op" id="6249523">(</span><span class="ident" id="6249524">p</span><span class="op" id="6249525">.</span><span class="ident" id="6249526">SFiles</span><span class="op" id="6249532">,</span>&nbsp;<span class="ident" id="6249534">Sfiles</span><span class="op" id="6249540">...</span><span class="op" id="6249543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249547">sort</span><span class="op" id="6249551">.</span><span class="ident" id="6249552">Strings</span><span class="op" id="6249559">(</span><span class="ident" id="6249560">p</span><span class="op" id="6249561">.</span><span class="ident" id="6249562">SFiles</span><span class="op" id="6249568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6249571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6249575">return</span>&nbsp;<span class="ident" id="6249582">p</span><span class="op" id="6249583">,</span>&nbsp;<span class="ident" id="6249585">pkgerr</span><br>
<span class="lineno"></span><span class="op" id="6249592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6249595">func</span>&nbsp;<span class="ident" id="6249600">findImportComment</span><span class="op" id="6249617">(</span><span class="ident" id="6249618">data</span>&nbsp;<span class="op" id="6249623">[</span><span class="op" id="6249624">]</span><span class="builtintype" id="6249625">byte</span><span class="op" id="6249629">)</span>&nbsp;<span class="op" id="6249631">(</span><span class="ident" id="6249632">s</span>&nbsp;<span class="builtintype" id="6249634">string</span><span class="op" id="6249640">,</span>&nbsp;<span class="ident" id="6249642">line</span>&nbsp;<span class="builtintype" id="6249647">int</span><span class="op" id="6249650">)</span>&nbsp;<span class="op" id="6249652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6249655">//&nbsp;expect&nbsp;keyword&nbsp;package</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249682">word</span><span class="op" id="6249686">,</span>&nbsp;<span class="ident" id="6249688">data</span>&nbsp;<span class="op" id="6249693">:=</span>&nbsp;<span class="ident" id="6249696">parseWord</span><span class="op" id="6249705">(</span><span class="ident" id="6249706">data</span><span class="op" id="6249710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6249713">if</span>&nbsp;<span class="builtintype" id="6249716">string</span><span class="op" id="6249722">(</span><span class="ident" id="6249723">word</span><span class="op" id="6249727">)</span>&nbsp;<span class="op" id="6249729">!=</span>&nbsp;<span class="string" id="6249732">&#34;package&#34;</span>&nbsp;<span class="op" id="6249742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6249746">return</span>&nbsp;<span class="string" id="6249753">&#34;&#34;</span><span class="op" id="6249755">,</span>&nbsp;<span class="num" id="6249757">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6249760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6249764">//&nbsp;expect&nbsp;package&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249788">_</span><span class="op" id="6249789">,</span>&nbsp;<span class="ident" id="6249791">data</span>&nbsp;<span class="op" id="6249796">=</span>&nbsp;<span class="ident" id="6249798">parseWord</span><span class="op" id="6249807">(</span><span class="ident" id="6249808">data</span><span class="op" id="6249812">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6249816">//&nbsp;now&nbsp;ready&nbsp;for&nbsp;import&nbsp;comment,&nbsp;a&nbsp;//&nbsp;or&nbsp;/*&nbsp;*/&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6249872">//&nbsp;beginning&nbsp;and&nbsp;ending&nbsp;on&nbsp;the&nbsp;current&nbsp;line.</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6249918">for</span>&nbsp;<span class="builtinfunc" id="6249922">len</span><span class="op" id="6249925">(</span><span class="ident" id="6249926">data</span><span class="op" id="6249930">)</span>&nbsp;<span class="op" id="6249932">&gt;</span>&nbsp;<span class="num" id="6249934">0</span>&nbsp;<span class="op" id="6249936">&amp;&amp;</span>&nbsp;<span class="op" id="6249939">(</span><span class="ident" id="6249940">data</span><span class="op" id="6249944">[</span><span class="num" id="6249945">0</span><span class="op" id="6249946">]</span>&nbsp;<span class="op" id="6249948">==</span>&nbsp;<span class="string" id="6249951">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6249955">||</span>&nbsp;<span class="ident" id="6249958">data</span><span class="op" id="6249962">[</span><span class="num" id="6249963">0</span><span class="op" id="6249964">]</span>&nbsp;<span class="op" id="6249966">==</span>&nbsp;<span class="string" id="6249969">&#39;\t&#39;</span>&nbsp;<span class="op" id="6249974">||</span>&nbsp;<span class="ident" id="6249977">data</span><span class="op" id="6249981">[</span><span class="num" id="6249982">0</span><span class="op" id="6249983">]</span>&nbsp;<span class="op" id="6249985">==</span>&nbsp;<span class="string" id="6249988">&#39;\r&#39;</span><span class="op" id="6249992">)</span>&nbsp;<span class="op" id="6249994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6249998">data</span>&nbsp;<span class="op" id="6250003">=</span>&nbsp;<span class="ident" id="6250005">data</span><span class="op" id="6250009">[</span><span class="num" id="6250010">1</span><span class="op" id="6250011">:</span><span class="op" id="6250012">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6250015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250019">var</span>&nbsp;<span class="ident" id="6250023">comment</span>&nbsp;<span class="op" id="6250031">[</span><span class="op" id="6250032">]</span><span class="builtintype" id="6250033">byte</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250039">switch</span>&nbsp;<span class="op" id="6250046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250049">case</span>&nbsp;<span class="ident" id="6250054">bytes</span><span class="op" id="6250059">.</span><span class="ident" id="6250060">HasPrefix</span><span class="op" id="6250069">(</span><span class="ident" id="6250070">data</span><span class="op" id="6250074">,</span>&nbsp;<span class="ident" id="6250076">slashSlash</span><span class="op" id="6250086">)</span><span class="op" id="6250087">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250091">i</span>&nbsp;<span class="op" id="6250093">:=</span>&nbsp;<span class="ident" id="6250096">bytes</span><span class="op" id="6250101">.</span><span class="ident" id="6250102">Index</span><span class="op" id="6250107">(</span><span class="ident" id="6250108">data</span><span class="op" id="6250112">,</span>&nbsp;<span class="ident" id="6250114">newline</span><span class="op" id="6250121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250125">if</span>&nbsp;<span class="ident" id="6250128">i</span>&nbsp;<span class="op" id="6250130">&lt;</span>&nbsp;<span class="num" id="6250132">0</span>&nbsp;<span class="op" id="6250134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250139">i</span>&nbsp;<span class="op" id="6250141">=</span>&nbsp;<span class="builtinfunc" id="6250143">len</span><span class="op" id="6250146">(</span><span class="ident" id="6250147">data</span><span class="op" id="6250151">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6250155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250159">comment</span>&nbsp;<span class="op" id="6250167">=</span>&nbsp;<span class="ident" id="6250169">data</span><span class="op" id="6250173">[</span><span class="num" id="6250174">2</span><span class="op" id="6250175">:</span><span class="ident" id="6250176">i</span><span class="op" id="6250177">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250180">case</span>&nbsp;<span class="ident" id="6250185">bytes</span><span class="op" id="6250190">.</span><span class="ident" id="6250191">HasPrefix</span><span class="op" id="6250200">(</span><span class="ident" id="6250201">data</span><span class="op" id="6250205">,</span>&nbsp;<span class="ident" id="6250207">slashStar</span><span class="op" id="6250216">)</span><span class="op" id="6250217">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250221">data</span>&nbsp;<span class="op" id="6250226">=</span>&nbsp;<span class="ident" id="6250228">data</span><span class="op" id="6250232">[</span><span class="num" id="6250233">2</span><span class="op" id="6250234">:</span><span class="op" id="6250235">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250239">i</span>&nbsp;<span class="op" id="6250241">:=</span>&nbsp;<span class="ident" id="6250244">bytes</span><span class="op" id="6250249">.</span><span class="ident" id="6250250">Index</span><span class="op" id="6250255">(</span><span class="ident" id="6250256">data</span><span class="op" id="6250260">,</span>&nbsp;<span class="ident" id="6250262">starSlash</span><span class="op" id="6250271">)</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250275">if</span>&nbsp;<span class="ident" id="6250278">i</span>&nbsp;<span class="op" id="6250280">&lt;</span>&nbsp;<span class="num" id="6250282">0</span>&nbsp;<span class="op" id="6250284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6250289">//&nbsp;malformed&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250313">return</span>&nbsp;<span class="string" id="6250320">&#34;&#34;</span><span class="op" id="6250322">,</span>&nbsp;<span class="num" id="6250324">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6250328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250332">comment</span>&nbsp;<span class="op" id="6250340">=</span>&nbsp;<span class="ident" id="6250342">data</span><span class="op" id="6250346">[</span><span class="op" id="6250347">:</span><span class="ident" id="6250348">i</span><span class="op" id="6250349">]</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250353">if</span>&nbsp;<span class="ident" id="6250356">bytes</span><span class="op" id="6250361">.</span><span class="ident" id="6250362">Contains</span><span class="op" id="6250370">(</span><span class="ident" id="6250371">comment</span><span class="op" id="6250378">,</span>&nbsp;<span class="ident" id="6250380">newline</span><span class="op" id="6250387">)</span>&nbsp;<span class="op" id="6250389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250394">return</span>&nbsp;<span class="string" id="6250401">&#34;&#34;</span><span class="op" id="6250403">,</span>&nbsp;<span class="num" id="6250405">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6250409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6250412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250415">comment</span>&nbsp;<span class="op" id="6250423">=</span>&nbsp;<span class="ident" id="6250425">bytes</span><span class="op" id="6250430">.</span><span class="ident" id="6250431">TrimSpace</span><span class="op" id="6250440">(</span><span class="ident" id="6250441">comment</span><span class="op" id="6250448">)</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6250452">//&nbsp;split&nbsp;comment&nbsp;into&nbsp;`import`,&nbsp;`&#34;pkg&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250493">word</span><span class="op" id="6250497">,</span>&nbsp;<span class="ident" id="6250499">arg</span>&nbsp;<span class="op" id="6250503">:=</span>&nbsp;<span class="ident" id="6250506">parseWord</span><span class="op" id="6250515">(</span><span class="ident" id="6250516">comment</span><span class="op" id="6250523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250526">if</span>&nbsp;<span class="builtintype" id="6250529">string</span><span class="op" id="6250535">(</span><span class="ident" id="6250536">word</span><span class="op" id="6250540">)</span>&nbsp;<span class="op" id="6250542">!=</span>&nbsp;<span class="string" id="6250545">&#34;import&#34;</span>&nbsp;<span class="op" id="6250554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250558">return</span>&nbsp;<span class="string" id="6250565">&#34;&#34;</span><span class="op" id="6250567">,</span>&nbsp;<span class="num" id="6250569">0</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6250572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250576">line</span>&nbsp;<span class="op" id="6250581">=</span>&nbsp;<span class="num" id="6250583">1</span>&nbsp;<span class="op" id="6250585">+</span>&nbsp;<span class="ident" id="6250587">bytes</span><span class="op" id="6250592">.</span><span class="ident" id="6250593">Count</span><span class="op" id="6250598">(</span><span class="ident" id="6250599">data</span><span class="op" id="6250603">[</span><span class="op" id="6250604">:</span><span class="builtinfunc" id="6250605">cap</span><span class="op" id="6250608">(</span><span class="ident" id="6250609">data</span><span class="op" id="6250613">)</span><span class="op" id="6250614">-</span><span class="builtinfunc" id="6250615">cap</span><span class="op" id="6250618">(</span><span class="ident" id="6250619">arg</span><span class="op" id="6250622">)</span><span class="op" id="6250623">]</span><span class="op" id="6250624">,</span>&nbsp;<span class="ident" id="6250626">newline</span><span class="op" id="6250633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250636">return</span>&nbsp;<span class="ident" id="6250643">strings</span><span class="op" id="6250650">.</span><span class="ident" id="6250651">TrimSpace</span><span class="op" id="6250660">(</span><span class="builtintype" id="6250661">string</span><span class="op" id="6250667">(</span><span class="ident" id="6250668">arg</span><span class="op" id="6250671">)</span><span class="op" id="6250672">)</span><span class="op" id="6250673">,</span>&nbsp;<span class="ident" id="6250675">line</span><br>
<span class="lineno"></span><span class="op" id="6250680">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="keyword" id="6250683">var</span>&nbsp;<span class="op" id="6250687">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250690">slashSlash</span>&nbsp;<span class="op" id="6250701">=</span>&nbsp;<span class="op" id="6250703">[</span><span class="op" id="6250704">]</span><span class="builtintype" id="6250705">byte</span><span class="op" id="6250709">(</span><span class="string" id="6250710">&#34;//&#34;</span><span class="op" id="6250714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250717">slashStar</span>&nbsp;&nbsp;<span class="op" id="6250728">=</span>&nbsp;<span class="op" id="6250730">[</span><span class="op" id="6250731">]</span><span class="builtintype" id="6250732">byte</span><span class="op" id="6250736">(</span><span class="string" id="6250737">&#34;/*&#34;</span><span class="op" id="6250741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250744">starSlash</span>&nbsp;&nbsp;<span class="op" id="6250755">=</span>&nbsp;<span class="op" id="6250757">[</span><span class="op" id="6250758">]</span><span class="builtintype" id="6250759">byte</span><span class="op" id="6250763">(</span><span class="string" id="6250764">&#34;*/&#34;</span><span class="op" id="6250768">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250771">newline</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6250782">=</span>&nbsp;<span class="op" id="6250784">[</span><span class="op" id="6250785">]</span><span class="builtintype" id="6250786">byte</span><span class="op" id="6250790">(</span><span class="string" id="6250791">&#34;\n&#34;</span><span class="op" id="6250795">)</span><br>
<span class="lineno"></span><span class="op" id="6250797">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6250800">//&nbsp;skipSpaceOrComment&nbsp;returns&nbsp;data&nbsp;with&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;removed.</span><br>
<span class="lineno"></span><span class="keyword" id="6250880">func</span>&nbsp;<span class="ident" id="6250885">skipSpaceOrComment</span><span class="op" id="6250903">(</span><span class="ident" id="6250904">data</span>&nbsp;<span class="op" id="6250909">[</span><span class="op" id="6250910">]</span><span class="builtintype" id="6250911">byte</span><span class="op" id="6250915">)</span>&nbsp;<span class="op" id="6250917">[</span><span class="op" id="6250918">]</span><span class="builtintype" id="6250919">byte</span>&nbsp;<span class="op" id="6250924">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250927">for</span>&nbsp;<span class="builtinfunc" id="6250931">len</span><span class="op" id="6250934">(</span><span class="ident" id="6250935">data</span><span class="op" id="6250939">)</span>&nbsp;<span class="op" id="6250941">&gt;</span>&nbsp;<span class="num" id="6250943">0</span>&nbsp;<span class="op" id="6250945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250949">switch</span>&nbsp;<span class="ident" id="6250956">data</span><span class="op" id="6250960">[</span><span class="num" id="6250961">0</span><span class="op" id="6250962">]</span>&nbsp;<span class="op" id="6250964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6250968">case</span>&nbsp;<span class="string" id="6250973">&#39;&nbsp;&#39;</span><span class="op" id="6250976">,</span>&nbsp;<span class="string" id="6250978">&#39;\t&#39;</span><span class="op" id="6250982">,</span>&nbsp;<span class="string" id="6250984">&#39;\r&#39;</span><span class="op" id="6250988">,</span>&nbsp;<span class="string" id="6250990">&#39;\n&#39;</span><span class="op" id="6250994">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6250999">data</span>&nbsp;<span class="op" id="6251004">=</span>&nbsp;<span class="ident" id="6251006">data</span><span class="op" id="6251010">[</span><span class="num" id="6251011">1</span><span class="op" id="6251012">:</span><span class="op" id="6251013">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251018">continue</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251029">case</span>&nbsp;<span class="string" id="6251034">&#39;/&#39;</span><span class="op" id="6251037">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251042">if</span>&nbsp;<span class="ident" id="6251045">bytes</span><span class="op" id="6251050">.</span><span class="ident" id="6251051">HasPrefix</span><span class="op" id="6251060">(</span><span class="ident" id="6251061">data</span><span class="op" id="6251065">,</span>&nbsp;<span class="ident" id="6251067">slashSlash</span><span class="op" id="6251077">)</span>&nbsp;<span class="op" id="6251079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251085">i</span>&nbsp;<span class="op" id="6251087">:=</span>&nbsp;<span class="ident" id="6251090">bytes</span><span class="op" id="6251095">.</span><span class="ident" id="6251096">Index</span><span class="op" id="6251101">(</span><span class="ident" id="6251102">data</span><span class="op" id="6251106">,</span>&nbsp;<span class="ident" id="6251108">newline</span><span class="op" id="6251115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251121">if</span>&nbsp;<span class="ident" id="6251124">i</span>&nbsp;<span class="op" id="6251126">&lt;</span>&nbsp;<span class="num" id="6251128">0</span>&nbsp;<span class="op" id="6251130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251137">return</span>&nbsp;<span class="ident" id="6251144">nil</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251158">data</span>&nbsp;<span class="op" id="6251163">=</span>&nbsp;<span class="ident" id="6251165">data</span><span class="op" id="6251169">[</span><span class="ident" id="6251170">i</span><span class="op" id="6251171">+</span><span class="num" id="6251172">1</span><span class="op" id="6251173">:</span><span class="op" id="6251174">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251180">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251197">if</span>&nbsp;<span class="ident" id="6251200">bytes</span><span class="op" id="6251205">.</span><span class="ident" id="6251206">HasPrefix</span><span class="op" id="6251215">(</span><span class="ident" id="6251216">data</span><span class="op" id="6251220">,</span>&nbsp;<span class="ident" id="6251222">slashStar</span><span class="op" id="6251231">)</span>&nbsp;<span class="op" id="6251233">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251239">data</span>&nbsp;<span class="op" id="6251244">=</span>&nbsp;<span class="ident" id="6251246">data</span><span class="op" id="6251250">[</span><span class="num" id="6251251">2</span><span class="op" id="6251252">:</span><span class="op" id="6251253">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251259">i</span>&nbsp;<span class="op" id="6251261">:=</span>&nbsp;<span class="ident" id="6251264">bytes</span><span class="op" id="6251269">.</span><span class="ident" id="6251270">Index</span><span class="op" id="6251275">(</span><span class="ident" id="6251276">data</span><span class="op" id="6251280">,</span>&nbsp;<span class="ident" id="6251282">starSlash</span><span class="op" id="6251291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251297">if</span>&nbsp;<span class="ident" id="6251300">i</span>&nbsp;<span class="op" id="6251302">&lt;</span>&nbsp;<span class="num" id="6251304">0</span>&nbsp;<span class="op" id="6251306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251313">return</span>&nbsp;<span class="ident" id="6251320">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251328">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251334">data</span>&nbsp;<span class="op" id="6251339">=</span>&nbsp;<span class="ident" id="6251341">data</span><span class="op" id="6251345">[</span><span class="ident" id="6251346">i</span><span class="op" id="6251347">+</span><span class="num" id="6251348">2</span><span class="op" id="6251349">:</span><span class="op" id="6251350">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251356">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251376">break</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251386">return</span>&nbsp;<span class="ident" id="6251393">data</span><br>
<span class="lineno"></span><span class="op" id="6251398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6251401">//&nbsp;parseWord&nbsp;skips&nbsp;any&nbsp;leading&nbsp;spaces&nbsp;or&nbsp;comments&nbsp;in&nbsp;data</span><br>
<span class="lineno">880</span><span class="comment" id="6251459">//&nbsp;and&nbsp;then&nbsp;parses&nbsp;the&nbsp;beginning&nbsp;of&nbsp;data&nbsp;as&nbsp;an&nbsp;identifier&nbsp;or&nbsp;keyword,</span><br>
<span class="lineno"></span><span class="comment" id="6251529">//&nbsp;returning&nbsp;that&nbsp;word&nbsp;and&nbsp;what&nbsp;remains&nbsp;after&nbsp;the&nbsp;word.</span><br>
<span class="lineno"></span><span class="keyword" id="6251585">func</span>&nbsp;<span class="ident" id="6251590">parseWord</span><span class="op" id="6251599">(</span><span class="ident" id="6251600">data</span>&nbsp;<span class="op" id="6251605">[</span><span class="op" id="6251606">]</span><span class="builtintype" id="6251607">byte</span><span class="op" id="6251611">)</span>&nbsp;<span class="op" id="6251613">(</span><span class="ident" id="6251614">word</span><span class="op" id="6251618">,</span>&nbsp;<span class="ident" id="6251620">rest</span>&nbsp;<span class="op" id="6251625">[</span><span class="op" id="6251626">]</span><span class="builtintype" id="6251627">byte</span><span class="op" id="6251631">)</span>&nbsp;<span class="op" id="6251633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251636">data</span>&nbsp;<span class="op" id="6251641">=</span>&nbsp;<span class="ident" id="6251643">skipSpaceOrComment</span><span class="op" id="6251661">(</span><span class="ident" id="6251662">data</span><span class="op" id="6251666">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6251670">//&nbsp;Parse&nbsp;past&nbsp;leading&nbsp;word&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251710">rest</span>&nbsp;<span class="op" id="6251715">=</span>&nbsp;<span class="ident" id="6251717">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251723">for</span>&nbsp;<span class="op" id="6251727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251731">r</span><span class="op" id="6251732">,</span>&nbsp;<span class="ident" id="6251734">size</span>&nbsp;<span class="op" id="6251739">:=</span>&nbsp;<span class="ident" id="6251742">utf8</span><span class="op" id="6251746">.</span><span class="ident" id="6251747">DecodeRune</span><span class="op" id="6251757">(</span><span class="ident" id="6251758">rest</span><span class="op" id="6251762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251766">if</span>&nbsp;<span class="ident" id="6251769">unicode</span><span class="op" id="6251776">.</span><span class="ident" id="6251777">IsLetter</span><span class="op" id="6251785">(</span><span class="ident" id="6251786">r</span><span class="op" id="6251787">)</span>&nbsp;<span class="op" id="6251789">||</span>&nbsp;<span class="string" id="6251792">&#39;0&#39;</span>&nbsp;<span class="op" id="6251796">&lt;=</span>&nbsp;<span class="ident" id="6251799">r</span>&nbsp;<span class="op" id="6251801">&amp;&amp;</span>&nbsp;<span class="ident" id="6251804">r</span>&nbsp;<span class="op" id="6251806">&lt;=</span>&nbsp;<span class="string" id="6251809">&#39;9&#39;</span>&nbsp;<span class="op" id="6251813">||</span>&nbsp;<span class="ident" id="6251816">r</span>&nbsp;<span class="op" id="6251818">==</span>&nbsp;<span class="string" id="6251821">&#39;_&#39;</span>&nbsp;<span class="op" id="6251825">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251830">rest</span>&nbsp;<span class="op" id="6251835">=</span>&nbsp;<span class="ident" id="6251837">rest</span><span class="op" id="6251841">[</span><span class="ident" id="6251842">size</span><span class="op" id="6251846">:</span><span class="op" id="6251847">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251852">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251867">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251874">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6251878">word</span>&nbsp;<span class="op" id="6251883">=</span>&nbsp;<span class="ident" id="6251885">data</span><span class="op" id="6251889">[</span><span class="op" id="6251890">:</span><span class="builtinfunc" id="6251891">len</span><span class="op" id="6251894">(</span><span class="ident" id="6251895">data</span><span class="op" id="6251899">)</span><span class="op" id="6251900">-</span><span class="builtinfunc" id="6251901">len</span><span class="op" id="6251904">(</span><span class="ident" id="6251905">rest</span><span class="op" id="6251909">)</span><span class="op" id="6251910">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251913">if</span>&nbsp;<span class="builtinfunc" id="6251916">len</span><span class="op" id="6251919">(</span><span class="ident" id="6251920">word</span><span class="op" id="6251924">)</span>&nbsp;<span class="op" id="6251926">==</span>&nbsp;<span class="num" id="6251929">0</span>&nbsp;<span class="op" id="6251931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251935">return</span>&nbsp;<span class="ident" id="6251942">nil</span><span class="op" id="6251945">,</span>&nbsp;<span class="ident" id="6251947">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6251952">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6251956">return</span>&nbsp;<span class="ident" id="6251963">word</span><span class="op" id="6251967">,</span>&nbsp;<span class="ident" id="6251969">rest</span><br>
<span class="lineno"></span><span class="op" id="6251974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6251977">//&nbsp;MatchFile&nbsp;reports&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno">905</span><span class="comment" id="6252058">//&nbsp;matches&nbsp;the&nbsp;context&nbsp;and&nbsp;would&nbsp;be&nbsp;included&nbsp;in&nbsp;a&nbsp;Package&nbsp;created&nbsp;by&nbsp;ImportDir</span><br>
<span class="lineno"></span><span class="comment" id="6252137">//&nbsp;of&nbsp;that&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="6252159">//</span><br>
<span class="lineno"></span><span class="comment" id="6252162">//&nbsp;MatchFile&nbsp;considers&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;file&nbsp;and&nbsp;may&nbsp;use&nbsp;ctxt.OpenFile&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6252235">//&nbsp;read&nbsp;some&nbsp;or&nbsp;all&nbsp;of&nbsp;the&nbsp;file&#39;s&nbsp;content.</span><br>
<span class="lineno">910</span><span class="keyword" id="6252278">func</span>&nbsp;<span class="op" id="6252283">(</span><span class="ident" id="6252284">ctxt</span>&nbsp;<span class="op" id="6252289">*</span><span class="ident" id="6252290">Context</span><span class="op" id="6252297">)</span>&nbsp;<span class="ident" id="6252299">MatchFile</span><span class="op" id="6252308">(</span><span class="ident" id="6252309">dir</span><span class="op" id="6252312">,</span>&nbsp;<span class="ident" id="6252314">name</span>&nbsp;<span class="builtintype" id="6252319">string</span><span class="op" id="6252325">)</span>&nbsp;<span class="op" id="6252327">(</span><span class="ident" id="6252328">match</span>&nbsp;<span class="builtintype" id="6252334">bool</span><span class="op" id="6252338">,</span>&nbsp;<span class="ident" id="6252340">err</span>&nbsp;<span class="builtintype" id="6252344">error</span><span class="op" id="6252349">)</span>&nbsp;<span class="op" id="6252351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6252354">match</span><span class="op" id="6252359">,</span>&nbsp;<span class="ident" id="6252361">_</span><span class="op" id="6252362">,</span>&nbsp;<span class="ident" id="6252364">_</span><span class="op" id="6252365">,</span>&nbsp;<span class="ident" id="6252367">err</span>&nbsp;<span class="op" id="6252371">=</span>&nbsp;<span class="ident" id="6252373">ctxt</span><span class="op" id="6252377">.</span><span class="ident" id="6252378">matchFile</span><span class="op" id="6252387">(</span><span class="ident" id="6252388">dir</span><span class="op" id="6252391">,</span>&nbsp;<span class="ident" id="6252393">name</span><span class="op" id="6252397">,</span>&nbsp;<span class="builtintype" id="6252399">false</span><span class="op" id="6252404">,</span>&nbsp;<span class="ident" id="6252406">nil</span><span class="op" id="6252409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6252412">return</span><br>
<span class="lineno"></span><span class="op" id="6252419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">915</span><span class="comment" id="6252422">//&nbsp;matchFile&nbsp;determines&nbsp;whether&nbsp;the&nbsp;file&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;given&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="6252506">//&nbsp;should&nbsp;be&nbsp;included&nbsp;in&nbsp;the&nbsp;package&nbsp;being&nbsp;constructed.</span><br>
<span class="lineno"></span><span class="comment" id="6252562">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;data&nbsp;read&nbsp;from&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="6252605">//&nbsp;If&nbsp;returnImports&nbsp;is&nbsp;true&nbsp;and&nbsp;name&nbsp;denotes&nbsp;a&nbsp;Go&nbsp;program,&nbsp;matchFile&nbsp;reads</span><br>
<span class="lineno"></span><span class="comment" id="6252680">//&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;imports&nbsp;(and&nbsp;returns&nbsp;that&nbsp;data)&nbsp;even&nbsp;though&nbsp;it&nbsp;only</span><br>
<span class="lineno">920</span><span class="comment" id="6252756">//&nbsp;considers&nbsp;text&nbsp;until&nbsp;the&nbsp;first&nbsp;non-comment.</span><br>
<span class="lineno"></span><span class="comment" id="6252803">//&nbsp;If&nbsp;allTags&nbsp;is&nbsp;non-nil,&nbsp;matchFile&nbsp;records&nbsp;any&nbsp;encountered&nbsp;build&nbsp;tag</span><br>
<span class="lineno"></span><span class="comment" id="6252873">//&nbsp;by&nbsp;setting&nbsp;allTags[tag]&nbsp;=&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="6252908">func</span>&nbsp;<span class="op" id="6252913">(</span><span class="ident" id="6252914">ctxt</span>&nbsp;<span class="op" id="6252919">*</span><span class="ident" id="6252920">Context</span><span class="op" id="6252927">)</span>&nbsp;<span class="ident" id="6252929">matchFile</span><span class="op" id="6252938">(</span><span class="ident" id="6252939">dir</span><span class="op" id="6252942">,</span>&nbsp;<span class="ident" id="6252944">name</span>&nbsp;<span class="builtintype" id="6252949">string</span><span class="op" id="6252955">,</span>&nbsp;<span class="ident" id="6252957">returnImports</span>&nbsp;<span class="builtintype" id="6252971">bool</span><span class="op" id="6252975">,</span>&nbsp;<span class="ident" id="6252977">allTags</span>&nbsp;<span class="keyword" id="6252985">map</span><span class="op" id="6252988">[</span><span class="builtintype" id="6252989">string</span><span class="op" id="6252995">]</span><span class="builtintype" id="6252996">bool</span><span class="op" id="6253000">)</span>&nbsp;<span class="op" id="6253002">(</span><span class="ident" id="6253003">match</span>&nbsp;<span class="builtintype" id="6253009">bool</span><span class="op" id="6253013">,</span>&nbsp;<span class="ident" id="6253015">data</span>&nbsp;<span class="op" id="6253020">[</span><span class="op" id="6253021">]</span><span class="builtintype" id="6253022">byte</span><span class="op" id="6253026">,</span>&nbsp;<span class="ident" id="6253028">filename</span>&nbsp;<span class="builtintype" id="6253037">string</span><span class="op" id="6253043">,</span>&nbsp;<span class="ident" id="6253045">err</span>&nbsp;<span class="builtintype" id="6253049">error</span><span class="op" id="6253054">)</span>&nbsp;<span class="op" id="6253056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253059">if</span>&nbsp;<span class="ident" id="6253062">strings</span><span class="op" id="6253069">.</span><span class="ident" id="6253070">HasPrefix</span><span class="op" id="6253079">(</span><span class="ident" id="6253080">name</span><span class="op" id="6253084">,</span>&nbsp;<span class="string" id="6253086">&#34;_&#34;</span><span class="op" id="6253089">)</span>&nbsp;<span class="op" id="6253091">||</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253096">strings</span><span class="op" id="6253103">.</span><span class="ident" id="6253104">HasPrefix</span><span class="op" id="6253113">(</span><span class="ident" id="6253114">name</span><span class="op" id="6253118">,</span>&nbsp;<span class="string" id="6253120">&#34;.&#34;</span><span class="op" id="6253123">)</span>&nbsp;<span class="op" id="6253125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253129">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253141">i</span>&nbsp;<span class="op" id="6253143">:=</span>&nbsp;<span class="ident" id="6253146">strings</span><span class="op" id="6253153">.</span><span class="ident" id="6253154">LastIndex</span><span class="op" id="6253163">(</span><span class="ident" id="6253164">name</span><span class="op" id="6253168">,</span>&nbsp;<span class="string" id="6253170">&#34;.&#34;</span><span class="op" id="6253173">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253176">if</span>&nbsp;<span class="ident" id="6253179">i</span>&nbsp;<span class="op" id="6253181">&lt;</span>&nbsp;<span class="num" id="6253183">0</span>&nbsp;<span class="op" id="6253185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253189">i</span>&nbsp;<span class="op" id="6253191">=</span>&nbsp;<span class="builtinfunc" id="6253193">len</span><span class="op" id="6253196">(</span><span class="ident" id="6253197">name</span><span class="op" id="6253201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253207">ext</span>&nbsp;<span class="op" id="6253211">:=</span>&nbsp;<span class="ident" id="6253214">name</span><span class="op" id="6253218">[</span><span class="ident" id="6253219">i</span><span class="op" id="6253220">:</span><span class="op" id="6253221">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253225">if</span>&nbsp;<span class="op" id="6253228">!</span><span class="ident" id="6253229">ctxt</span><span class="op" id="6253233">.</span><span class="ident" id="6253234">goodOSArchFile</span><span class="op" id="6253248">(</span><span class="ident" id="6253249">name</span><span class="op" id="6253253">,</span>&nbsp;<span class="ident" id="6253255">allTags</span><span class="op" id="6253262">)</span>&nbsp;<span class="op" id="6253264">&amp;&amp;</span>&nbsp;<span class="op" id="6253267">!</span><span class="ident" id="6253268">ctxt</span><span class="op" id="6253272">.</span><span class="ident" id="6253273">UseAllFiles</span>&nbsp;<span class="op" id="6253285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253289">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253301">switch</span>&nbsp;<span class="ident" id="6253308">ext</span>&nbsp;<span class="op" id="6253312">{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253315">case</span>&nbsp;<span class="string" id="6253320">&#34;.go&#34;</span><span class="op" id="6253325">,</span>&nbsp;<span class="string" id="6253327">&#34;.c&#34;</span><span class="op" id="6253331">,</span>&nbsp;<span class="string" id="6253333">&#34;.cc&#34;</span><span class="op" id="6253338">,</span>&nbsp;<span class="string" id="6253340">&#34;.cxx&#34;</span><span class="op" id="6253346">,</span>&nbsp;<span class="string" id="6253348">&#34;.cpp&#34;</span><span class="op" id="6253354">,</span>&nbsp;<span class="string" id="6253356">&#34;.m&#34;</span><span class="op" id="6253360">,</span>&nbsp;<span class="string" id="6253362">&#34;.s&#34;</span><span class="op" id="6253366">,</span>&nbsp;<span class="string" id="6253368">&#34;.h&#34;</span><span class="op" id="6253372">,</span>&nbsp;<span class="string" id="6253374">&#34;.hh&#34;</span><span class="op" id="6253379">,</span>&nbsp;<span class="string" id="6253381">&#34;.hpp&#34;</span><span class="op" id="6253387">,</span>&nbsp;<span class="string" id="6253389">&#34;.hxx&#34;</span><span class="op" id="6253395">,</span>&nbsp;<span class="string" id="6253397">&#34;.S&#34;</span><span class="op" id="6253401">,</span>&nbsp;<span class="string" id="6253403">&#34;.swig&#34;</span><span class="op" id="6253410">,</span>&nbsp;<span class="string" id="6253412">&#34;.swigcxx&#34;</span><span class="op" id="6253422">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6253426">//&nbsp;tentatively&nbsp;okay&nbsp;-&nbsp;read&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253467">case</span>&nbsp;<span class="string" id="6253472">&#34;.syso&#34;</span><span class="op" id="6253479">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6253483">//&nbsp;binary,&nbsp;no&nbsp;reading</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253507">match</span>&nbsp;<span class="op" id="6253513">=</span>&nbsp;<span class="builtintype" id="6253515">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253522">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253530">default</span><span class="op" id="6253537">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6253541">//&nbsp;skip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253551">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253559">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253563">filename</span>&nbsp;<span class="op" id="6253572">=</span>&nbsp;<span class="ident" id="6253574">ctxt</span><span class="op" id="6253578">.</span><span class="ident" id="6253579">joinPath</span><span class="op" id="6253587">(</span><span class="ident" id="6253588">dir</span><span class="op" id="6253591">,</span>&nbsp;<span class="ident" id="6253593">name</span><span class="op" id="6253597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253600">f</span><span class="op" id="6253601">,</span>&nbsp;<span class="ident" id="6253603">err</span>&nbsp;<span class="op" id="6253607">:=</span>&nbsp;<span class="ident" id="6253610">ctxt</span><span class="op" id="6253614">.</span><span class="ident" id="6253615">openFile</span><span class="op" id="6253623">(</span><span class="ident" id="6253624">filename</span><span class="op" id="6253632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253635">if</span>&nbsp;<span class="ident" id="6253638">err</span>&nbsp;<span class="op" id="6253642">!=</span>&nbsp;<span class="ident" id="6253645">nil</span>&nbsp;<span class="op" id="6253649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253653">return</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253665">if</span>&nbsp;<span class="ident" id="6253668">strings</span><span class="op" id="6253675">.</span><span class="ident" id="6253676">HasSuffix</span><span class="op" id="6253685">(</span><span class="ident" id="6253686">filename</span><span class="op" id="6253694">,</span>&nbsp;<span class="string" id="6253696">&#34;.go&#34;</span><span class="op" id="6253701">)</span>&nbsp;<span class="op" id="6253703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253707">data</span><span class="op" id="6253711">,</span>&nbsp;<span class="ident" id="6253713">err</span>&nbsp;<span class="op" id="6253717">=</span>&nbsp;<span class="ident" id="6253719">readImports</span><span class="op" id="6253730">(</span><span class="ident" id="6253731">f</span><span class="op" id="6253732">,</span>&nbsp;<span class="builtintype" id="6253734">false</span><span class="op" id="6253739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253742">}</span>&nbsp;<span class="keyword" id="6253744">else</span>&nbsp;<span class="op" id="6253749">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253753">data</span><span class="op" id="6253757">,</span>&nbsp;<span class="ident" id="6253759">err</span>&nbsp;<span class="op" id="6253763">=</span>&nbsp;<span class="ident" id="6253765">readComments</span><span class="op" id="6253777">(</span><span class="ident" id="6253778">f</span><span class="op" id="6253779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253785">f</span><span class="op" id="6253786">.</span><span class="ident" id="6253787">Close</span><span class="op" id="6253792">(</span><span class="op" id="6253793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253796">if</span>&nbsp;<span class="ident" id="6253799">err</span>&nbsp;<span class="op" id="6253803">!=</span>&nbsp;<span class="ident" id="6253806">nil</span>&nbsp;<span class="op" id="6253810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6253814">err</span>&nbsp;<span class="op" id="6253818">=</span>&nbsp;<span class="ident" id="6253820">fmt</span><span class="op" id="6253823">.</span><span class="ident" id="6253824">Errorf</span><span class="op" id="6253830">(</span><span class="string" id="6253831">&#34;read&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="6253844">,</span>&nbsp;<span class="ident" id="6253846">filename</span><span class="op" id="6253854">,</span>&nbsp;<span class="ident" id="6253856">err</span><span class="op" id="6253859">)</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253863">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6253871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6253875">//&nbsp;Look&nbsp;for&nbsp;+build&nbsp;comments&nbsp;to&nbsp;accept&nbsp;or&nbsp;reject&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253934">if</span>&nbsp;<span class="op" id="6253937">!</span><span class="ident" id="6253938">ctxt</span><span class="op" id="6253942">.</span><span class="ident" id="6253943">shouldBuild</span><span class="op" id="6253954">(</span><span class="ident" id="6253955">data</span><span class="op" id="6253959">,</span>&nbsp;<span class="ident" id="6253961">allTags</span><span class="op" id="6253968">)</span>&nbsp;<span class="op" id="6253970">&amp;&amp;</span>&nbsp;<span class="op" id="6253973">!</span><span class="ident" id="6253974">ctxt</span><span class="op" id="6253978">.</span><span class="ident" id="6253979">UseAllFiles</span>&nbsp;<span class="op" id="6253991">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6253995">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254007">match</span>&nbsp;<span class="op" id="6254013">=</span>&nbsp;<span class="builtintype" id="6254015">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254021">return</span><br>
<span class="lineno">975</span><span class="op" id="6254028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6254031">func</span>&nbsp;<span class="ident" id="6254036">cleanImports</span><span class="op" id="6254048">(</span><span class="ident" id="6254049">m</span>&nbsp;<span class="keyword" id="6254051">map</span><span class="op" id="6254054">[</span><span class="builtintype" id="6254055">string</span><span class="op" id="6254061">]</span><span class="op" id="6254062">[</span><span class="op" id="6254063">]</span><span class="ident" id="6254064">token</span><span class="op" id="6254069">.</span><span class="ident" id="6254070">Position</span><span class="op" id="6254078">)</span>&nbsp;<span class="op" id="6254080">(</span><span class="op" id="6254081">[</span><span class="op" id="6254082">]</span><span class="builtintype" id="6254083">string</span><span class="op" id="6254089">,</span>&nbsp;<span class="keyword" id="6254091">map</span><span class="op" id="6254094">[</span><span class="builtintype" id="6254095">string</span><span class="op" id="6254101">]</span><span class="op" id="6254102">[</span><span class="op" id="6254103">]</span><span class="ident" id="6254104">token</span><span class="op" id="6254109">.</span><span class="ident" id="6254110">Position</span><span class="op" id="6254118">)</span>&nbsp;<span class="op" id="6254120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254123">all</span>&nbsp;<span class="op" id="6254127">:=</span>&nbsp;<span class="builtinfunc" id="6254130">make</span><span class="op" id="6254134">(</span><span class="op" id="6254135">[</span><span class="op" id="6254136">]</span><span class="builtintype" id="6254137">string</span><span class="op" id="6254143">,</span>&nbsp;<span class="num" id="6254145">0</span><span class="op" id="6254146">,</span>&nbsp;<span class="builtinfunc" id="6254148">len</span><span class="op" id="6254151">(</span><span class="ident" id="6254152">m</span><span class="op" id="6254153">)</span><span class="op" id="6254154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254157">for</span>&nbsp;<span class="ident" id="6254161">path</span>&nbsp;<span class="op" id="6254166">:=</span>&nbsp;<span class="keyword" id="6254169">range</span>&nbsp;<span class="ident" id="6254175">m</span>&nbsp;<span class="op" id="6254177">{</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254181">all</span>&nbsp;<span class="op" id="6254185">=</span>&nbsp;<span class="builtinfunc" id="6254187">append</span><span class="op" id="6254193">(</span><span class="ident" id="6254194">all</span><span class="op" id="6254197">,</span>&nbsp;<span class="ident" id="6254199">path</span><span class="op" id="6254203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6254206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6254209">sort</span><span class="op" id="6254213">.</span><span class="ident" id="6254214">Strings</span><span class="op" id="6254221">(</span><span class="ident" id="6254222">all</span><span class="op" id="6254225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254228">return</span>&nbsp;<span class="ident" id="6254235">all</span><span class="op" id="6254238">,</span>&nbsp;<span class="ident" id="6254240">m</span><br>
<span class="lineno"></span><span class="op" id="6254242">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="6254245">//&nbsp;Import&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.Import.</span><br>
<span class="lineno"></span><span class="keyword" id="6254288">func</span>&nbsp;<span class="ident" id="6254293">Import</span><span class="op" id="6254299">(</span><span class="ident" id="6254300">path</span><span class="op" id="6254304">,</span>&nbsp;<span class="ident" id="6254306">srcDir</span>&nbsp;<span class="builtintype" id="6254313">string</span><span class="op" id="6254319">,</span>&nbsp;<span class="ident" id="6254321">mode</span>&nbsp;<span class="ident" id="6254326">ImportMode</span><span class="op" id="6254336">)</span>&nbsp;<span class="op" id="6254338">(</span><span class="op" id="6254339">*</span><span class="ident" id="6254340">Package</span><span class="op" id="6254347">,</span>&nbsp;<span class="builtintype" id="6254349">error</span><span class="op" id="6254354">)</span>&nbsp;<span class="op" id="6254356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254359">return</span>&nbsp;<span class="ident" id="6254366">Default</span><span class="op" id="6254373">.</span><span class="ident" id="6254374">Import</span><span class="op" id="6254380">(</span><span class="ident" id="6254381">path</span><span class="op" id="6254385">,</span>&nbsp;<span class="ident" id="6254387">srcDir</span><span class="op" id="6254393">,</span>&nbsp;<span class="ident" id="6254395">mode</span><span class="op" id="6254399">)</span><br>
<span class="lineno"></span><span class="op" id="6254401">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span><span class="comment" id="6254404">//&nbsp;ImportDir&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;Default.ImportDir.</span><br>
<span class="lineno"></span><span class="keyword" id="6254453">func</span>&nbsp;<span class="ident" id="6254458">ImportDir</span><span class="op" id="6254467">(</span><span class="ident" id="6254468">dir</span>&nbsp;<span class="builtintype" id="6254472">string</span><span class="op" id="6254478">,</span>&nbsp;<span class="ident" id="6254480">mode</span>&nbsp;<span class="ident" id="6254485">ImportMode</span><span class="op" id="6254495">)</span>&nbsp;<span class="op" id="6254497">(</span><span class="op" id="6254498">*</span><span class="ident" id="6254499">Package</span><span class="op" id="6254506">,</span>&nbsp;<span class="builtintype" id="6254508">error</span><span class="op" id="6254513">)</span>&nbsp;<span class="op" id="6254515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6254518">return</span>&nbsp;<span class="ident" id="6254525">Default</span><span class="op" id="6254532">.</span><span class="ident" id="6254533">ImportDir</span><span class="op" id="6254542">(</span><span class="ident" id="6254543">dir</span><span class="op" id="6254546">,</span>&nbsp;<span class="ident" id="6254548">mode</span><span class="op" id="6254552">)</span><br>
<span class="lineno"></span><span class="op" id="6254554">}</span><br>
<span class="lineno">995</span><br>
<span class="lineno"></span><span class="keyword" id="6254557">var</span>&nbsp;<span class="ident" id="6254561">slashslash</span>&nbsp;<span class="op" id="6254572">=</span>&nbsp;<span class="op" id="6254574">[</span><span class="op" id="6254575">]</span><span class="builtintype" id="6254576">byte</span><span class="op" id="6254580">(</span><span class="string" id="6254581">&#34;//&#34;</span><span class="op" id="6254585">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6254588">//&nbsp;shouldBuild&nbsp;reports&nbsp;whether&nbsp;it&nbsp;is&nbsp;okay&nbsp;to&nbsp;use&nbsp;this&nbsp;file,</span><br>
<span class="lineno"></span><span class="comment" id="6254648">//&nbsp;The&nbsp;rule&nbsp;is&nbsp;that&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments</span><br>
<span class="lineno">1000</span><span class="comment" id="6254709">//&nbsp;and&nbsp;blank&nbsp;lines,&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="6254768">//&nbsp;(to&nbsp;avoid&nbsp;including&nbsp;a&nbsp;Go&nbsp;package&nbsp;clause&nbsp;doc&nbsp;comment),</span><br>
<span class="lineno"></span><span class="comment" id="6254825">//&nbsp;lines&nbsp;beginning&nbsp;with&nbsp;&#39;//&nbsp;+build&#39;&nbsp;are&nbsp;taken&nbsp;as&nbsp;build&nbsp;directives.</span><br>
<span class="lineno"></span><span class="comment" id="6254892">//</span><br>
<span class="lineno"></span><span class="comment" id="6254895">//&nbsp;The&nbsp;file&nbsp;is&nbsp;accepted&nbsp;only&nbsp;if&nbsp;each&nbsp;such&nbsp;line&nbsp;lists&nbsp;something</span><br>
<span class="lineno">1005</span><span class="comment" id="6254958">//&nbsp;matching&nbsp;the&nbsp;file.&nbsp;&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span><span class="comment" id="6254994">//</span><br>
<span class="lineno"></span><span class="comment" id="6254997">//&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;+build&nbsp;windows&nbsp;linux</span><br>
<span class="lineno"></span><span class="comment" id="6255024">//</span><br>
<span class="lineno"></span><span class="comment" id="6255027">//&nbsp;marks&nbsp;the&nbsp;file&nbsp;as&nbsp;applicable&nbsp;only&nbsp;on&nbsp;Windows&nbsp;and&nbsp;Linux.</span><br>
<span class="lineno">1010</span><span class="comment" id="6255086">//</span><br>
<span class="lineno"></span><span class="keyword" id="6255089">func</span>&nbsp;<span class="op" id="6255094">(</span><span class="ident" id="6255095">ctxt</span>&nbsp;<span class="op" id="6255100">*</span><span class="ident" id="6255101">Context</span><span class="op" id="6255108">)</span>&nbsp;<span class="ident" id="6255110">shouldBuild</span><span class="op" id="6255121">(</span><span class="ident" id="6255122">content</span>&nbsp;<span class="op" id="6255130">[</span><span class="op" id="6255131">]</span><span class="builtintype" id="6255132">byte</span><span class="op" id="6255136">,</span>&nbsp;<span class="ident" id="6255138">allTags</span>&nbsp;<span class="keyword" id="6255146">map</span><span class="op" id="6255149">[</span><span class="builtintype" id="6255150">string</span><span class="op" id="6255156">]</span><span class="builtintype" id="6255157">bool</span><span class="op" id="6255161">)</span>&nbsp;<span class="builtintype" id="6255163">bool</span>&nbsp;<span class="op" id="6255168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6255171">//&nbsp;Pass&nbsp;1.&nbsp;Identify&nbsp;leading&nbsp;run&nbsp;of&nbsp;//&nbsp;comments&nbsp;and&nbsp;blank&nbsp;lines,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6255236">//&nbsp;which&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;blank&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255280">end</span>&nbsp;<span class="op" id="6255284">:=</span>&nbsp;<span class="num" id="6255287">0</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255290">p</span>&nbsp;<span class="op" id="6255292">:=</span>&nbsp;<span class="ident" id="6255295">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255304">for</span>&nbsp;<span class="builtinfunc" id="6255308">len</span><span class="op" id="6255311">(</span><span class="ident" id="6255312">p</span><span class="op" id="6255313">)</span>&nbsp;<span class="op" id="6255315">&gt;</span>&nbsp;<span class="num" id="6255317">0</span>&nbsp;<span class="op" id="6255319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255323">line</span>&nbsp;<span class="op" id="6255328">:=</span>&nbsp;<span class="ident" id="6255331">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255335">if</span>&nbsp;<span class="ident" id="6255338">i</span>&nbsp;<span class="op" id="6255340">:=</span>&nbsp;<span class="ident" id="6255343">bytes</span><span class="op" id="6255348">.</span><span class="ident" id="6255349">IndexByte</span><span class="op" id="6255358">(</span><span class="ident" id="6255359">line</span><span class="op" id="6255363">,</span>&nbsp;<span class="string" id="6255365">&#39;\n&#39;</span><span class="op" id="6255369">)</span><span class="op" id="6255370">;</span>&nbsp;<span class="ident" id="6255372">i</span>&nbsp;<span class="op" id="6255374">&gt;=</span>&nbsp;<span class="num" id="6255377">0</span>&nbsp;<span class="op" id="6255379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255384">line</span><span class="op" id="6255388">,</span>&nbsp;<span class="ident" id="6255390">p</span>&nbsp;<span class="op" id="6255392">=</span>&nbsp;<span class="ident" id="6255394">line</span><span class="op" id="6255398">[</span><span class="op" id="6255399">:</span><span class="ident" id="6255400">i</span><span class="op" id="6255401">]</span><span class="op" id="6255402">,</span>&nbsp;<span class="ident" id="6255404">p</span><span class="op" id="6255405">[</span><span class="ident" id="6255406">i</span><span class="op" id="6255407">+</span><span class="num" id="6255408">1</span><span class="op" id="6255409">:</span><span class="op" id="6255410">]</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255414">}</span>&nbsp;<span class="keyword" id="6255416">else</span>&nbsp;<span class="op" id="6255421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255426">p</span>&nbsp;<span class="op" id="6255428">=</span>&nbsp;<span class="ident" id="6255430">p</span><span class="op" id="6255431">[</span><span class="builtinfunc" id="6255432">len</span><span class="op" id="6255435">(</span><span class="ident" id="6255436">p</span><span class="op" id="6255437">)</span><span class="op" id="6255438">:</span><span class="op" id="6255439">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255447">line</span>&nbsp;<span class="op" id="6255452">=</span>&nbsp;<span class="ident" id="6255454">bytes</span><span class="op" id="6255459">.</span><span class="ident" id="6255460">TrimSpace</span><span class="op" id="6255469">(</span><span class="ident" id="6255470">line</span><span class="op" id="6255474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255478">if</span>&nbsp;<span class="builtinfunc" id="6255481">len</span><span class="op" id="6255484">(</span><span class="ident" id="6255485">line</span><span class="op" id="6255489">)</span>&nbsp;<span class="op" id="6255491">==</span>&nbsp;<span class="num" id="6255494">0</span>&nbsp;<span class="op" id="6255496">{</span>&nbsp;<span class="comment" id="6255498">//&nbsp;Blank&nbsp;line</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255515">end</span>&nbsp;<span class="op" id="6255519">=</span>&nbsp;<span class="builtinfunc" id="6255521">len</span><span class="op" id="6255524">(</span><span class="ident" id="6255525">content</span><span class="op" id="6255532">)</span>&nbsp;<span class="op" id="6255534">-</span>&nbsp;<span class="builtinfunc" id="6255536">len</span><span class="op" id="6255539">(</span><span class="ident" id="6255540">p</span><span class="op" id="6255541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255546">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255561">if</span>&nbsp;<span class="op" id="6255564">!</span><span class="ident" id="6255565">bytes</span><span class="op" id="6255570">.</span><span class="ident" id="6255571">HasPrefix</span><span class="op" id="6255580">(</span><span class="ident" id="6255581">line</span><span class="op" id="6255585">,</span>&nbsp;<span class="ident" id="6255587">slashslash</span><span class="op" id="6255597">)</span>&nbsp;<span class="op" id="6255599">{</span>&nbsp;<span class="comment" id="6255601">//&nbsp;Not&nbsp;comment&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255624">break</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255638">content</span>&nbsp;<span class="op" id="6255646">=</span>&nbsp;<span class="ident" id="6255648">content</span><span class="op" id="6255655">[</span><span class="op" id="6255656">:</span><span class="ident" id="6255657">end</span><span class="op" id="6255660">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6255664">//&nbsp;Pass&nbsp;2.&nbsp;&nbsp;Process&nbsp;each&nbsp;line&nbsp;in&nbsp;the&nbsp;run.</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255707">p</span>&nbsp;<span class="op" id="6255709">=</span>&nbsp;<span class="ident" id="6255711">content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255720">allok</span>&nbsp;<span class="op" id="6255726">:=</span>&nbsp;<span class="builtintype" id="6255729">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255735">for</span>&nbsp;<span class="builtinfunc" id="6255739">len</span><span class="op" id="6255742">(</span><span class="ident" id="6255743">p</span><span class="op" id="6255744">)</span>&nbsp;<span class="op" id="6255746">&gt;</span>&nbsp;<span class="num" id="6255748">0</span>&nbsp;<span class="op" id="6255750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255754">line</span>&nbsp;<span class="op" id="6255759">:=</span>&nbsp;<span class="ident" id="6255762">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255766">if</span>&nbsp;<span class="ident" id="6255769">i</span>&nbsp;<span class="op" id="6255771">:=</span>&nbsp;<span class="ident" id="6255774">bytes</span><span class="op" id="6255779">.</span><span class="ident" id="6255780">IndexByte</span><span class="op" id="6255789">(</span><span class="ident" id="6255790">line</span><span class="op" id="6255794">,</span>&nbsp;<span class="string" id="6255796">&#39;\n&#39;</span><span class="op" id="6255800">)</span><span class="op" id="6255801">;</span>&nbsp;<span class="ident" id="6255803">i</span>&nbsp;<span class="op" id="6255805">&gt;=</span>&nbsp;<span class="num" id="6255808">0</span>&nbsp;<span class="op" id="6255810">{</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255815">line</span><span class="op" id="6255819">,</span>&nbsp;<span class="ident" id="6255821">p</span>&nbsp;<span class="op" id="6255823">=</span>&nbsp;<span class="ident" id="6255825">line</span><span class="op" id="6255829">[</span><span class="op" id="6255830">:</span><span class="ident" id="6255831">i</span><span class="op" id="6255832">]</span><span class="op" id="6255833">,</span>&nbsp;<span class="ident" id="6255835">p</span><span class="op" id="6255836">[</span><span class="ident" id="6255837">i</span><span class="op" id="6255838">+</span><span class="num" id="6255839">1</span><span class="op" id="6255840">:</span><span class="op" id="6255841">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255845">}</span>&nbsp;<span class="keyword" id="6255847">else</span>&nbsp;<span class="op" id="6255852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255857">p</span>&nbsp;<span class="op" id="6255859">=</span>&nbsp;<span class="ident" id="6255861">p</span><span class="op" id="6255862">[</span><span class="builtinfunc" id="6255863">len</span><span class="op" id="6255866">(</span><span class="ident" id="6255867">p</span><span class="op" id="6255868">)</span><span class="op" id="6255869">:</span><span class="op" id="6255870">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6255874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255878">line</span>&nbsp;<span class="op" id="6255883">=</span>&nbsp;<span class="ident" id="6255885">bytes</span><span class="op" id="6255890">.</span><span class="ident" id="6255891">TrimSpace</span><span class="op" id="6255900">(</span><span class="ident" id="6255901">line</span><span class="op" id="6255905">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6255909">if</span>&nbsp;<span class="ident" id="6255912">bytes</span><span class="op" id="6255917">.</span><span class="ident" id="6255918">HasPrefix</span><span class="op" id="6255927">(</span><span class="ident" id="6255928">line</span><span class="op" id="6255932">,</span>&nbsp;<span class="ident" id="6255934">slashslash</span><span class="op" id="6255944">)</span>&nbsp;<span class="op" id="6255946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6255951">line</span>&nbsp;<span class="op" id="6255956">=</span>&nbsp;<span class="ident" id="6255958">bytes</span><span class="op" id="6255963">.</span><span class="ident" id="6255964">TrimSpace</span><span class="op" id="6255973">(</span><span class="ident" id="6255974">line</span><span class="op" id="6255978">[</span><span class="builtinfunc" id="6255979">len</span><span class="op" id="6255982">(</span><span class="ident" id="6255983">slashslash</span><span class="op" id="6255993">)</span><span class="op" id="6255994">:</span><span class="op" id="6255995">]</span><span class="op" id="6255996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256001">if</span>&nbsp;<span class="builtinfunc" id="6256004">len</span><span class="op" id="6256007">(</span><span class="ident" id="6256008">line</span><span class="op" id="6256012">)</span>&nbsp;<span class="op" id="6256014">&gt;</span>&nbsp;<span class="num" id="6256016">0</span>&nbsp;<span class="op" id="6256018">&amp;&amp;</span>&nbsp;<span class="ident" id="6256021">line</span><span class="op" id="6256025">[</span><span class="num" id="6256026">0</span><span class="op" id="6256027">]</span>&nbsp;<span class="op" id="6256029">==</span>&nbsp;<span class="string" id="6256032">&#39;+&#39;</span>&nbsp;<span class="op" id="6256036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6256042">//&nbsp;Looks&nbsp;like&nbsp;a&nbsp;comment&nbsp;+line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256077">f</span>&nbsp;<span class="op" id="6256079">:=</span>&nbsp;<span class="ident" id="6256082">strings</span><span class="op" id="6256089">.</span><span class="ident" id="6256090">Fields</span><span class="op" id="6256096">(</span><span class="builtintype" id="6256097">string</span><span class="op" id="6256103">(</span><span class="ident" id="6256104">line</span><span class="op" id="6256108">)</span><span class="op" id="6256109">)</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256115">if</span>&nbsp;<span class="ident" id="6256118">f</span><span class="op" id="6256119">[</span><span class="num" id="6256120">0</span><span class="op" id="6256121">]</span>&nbsp;<span class="op" id="6256123">==</span>&nbsp;<span class="string" id="6256126">&#34;+build&#34;</span>&nbsp;<span class="op" id="6256135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256142">ok</span>&nbsp;<span class="op" id="6256145">:=</span>&nbsp;<span class="builtintype" id="6256148">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256159">for</span>&nbsp;<span class="ident" id="6256163">_</span><span class="op" id="6256164">,</span>&nbsp;<span class="ident" id="6256166">tok</span>&nbsp;<span class="op" id="6256170">:=</span>&nbsp;<span class="keyword" id="6256173">range</span>&nbsp;<span class="ident" id="6256179">f</span><span class="op" id="6256180">[</span><span class="num" id="6256181">1</span><span class="op" id="6256182">:</span><span class="op" id="6256183">]</span>&nbsp;<span class="op" id="6256185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256193">if</span>&nbsp;<span class="ident" id="6256196">ctxt</span><span class="op" id="6256200">.</span><span class="ident" id="6256201">match</span><span class="op" id="6256206">(</span><span class="ident" id="6256207">tok</span><span class="op" id="6256210">,</span>&nbsp;<span class="ident" id="6256212">allTags</span><span class="op" id="6256219">)</span>&nbsp;<span class="op" id="6256221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256230">ok</span>&nbsp;<span class="op" id="6256233">=</span>&nbsp;<span class="builtintype" id="6256235">true</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256260">if</span>&nbsp;<span class="op" id="6256263">!</span><span class="ident" id="6256264">ok</span>&nbsp;<span class="op" id="6256267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256275">allok</span>&nbsp;<span class="op" id="6256281">=</span>&nbsp;<span class="builtintype" id="6256283">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256294">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6256312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256316">return</span>&nbsp;<span class="ident" id="6256323">allok</span><br>
<span class="lineno"></span><span class="op" id="6256329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6256332">//&nbsp;saveCgo&nbsp;saves&nbsp;the&nbsp;information&nbsp;from&nbsp;the&nbsp;#cgo&nbsp;lines&nbsp;in&nbsp;the&nbsp;import&nbsp;&#34;C&#34;&nbsp;comment.</span><br>
<span class="lineno"></span><span class="comment" id="6256412">//&nbsp;These&nbsp;lines&nbsp;set&nbsp;CFLAGS,&nbsp;CPPFLAGS,&nbsp;CXXFLAGS&nbsp;and&nbsp;LDFLAGS&nbsp;and&nbsp;pkg-config&nbsp;directives</span><br>
<span class="lineno">1070</span><span class="comment" id="6256496">//&nbsp;that&nbsp;affect&nbsp;the&nbsp;way&nbsp;cgo&#39;s&nbsp;C&nbsp;code&nbsp;is&nbsp;built.</span><br>
<span class="lineno"></span><span class="comment" id="6256542">//</span><br>
<span class="lineno"></span><span class="comment" id="6256545">//&nbsp;TODO(rsc):&nbsp;This&nbsp;duplicates&nbsp;code&nbsp;in&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="comment" id="6256588">//&nbsp;Once&nbsp;the&nbsp;dust&nbsp;settles,&nbsp;remove&nbsp;this&nbsp;code&nbsp;from&nbsp;cgo.</span><br>
<span class="lineno"></span><span class="keyword" id="6256641">func</span>&nbsp;<span class="op" id="6256646">(</span><span class="ident" id="6256647">ctxt</span>&nbsp;<span class="op" id="6256652">*</span><span class="ident" id="6256653">Context</span><span class="op" id="6256660">)</span>&nbsp;<span class="ident" id="6256662">saveCgo</span><span class="op" id="6256669">(</span><span class="ident" id="6256670">filename</span>&nbsp;<span class="builtintype" id="6256679">string</span><span class="op" id="6256685">,</span>&nbsp;<span class="ident" id="6256687">di</span>&nbsp;<span class="op" id="6256690">*</span><span class="ident" id="6256691">Package</span><span class="op" id="6256698">,</span>&nbsp;<span class="ident" id="6256700">cg</span>&nbsp;<span class="op" id="6256703">*</span><span class="ident" id="6256704">ast</span><span class="op" id="6256707">.</span><span class="ident" id="6256708">CommentGroup</span><span class="op" id="6256720">)</span>&nbsp;<span class="builtintype" id="6256722">error</span>&nbsp;<span class="op" id="6256728">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256731">text</span>&nbsp;<span class="op" id="6256736">:=</span>&nbsp;<span class="ident" id="6256739">cg</span><span class="op" id="6256741">.</span><span class="ident" id="6256742">Text</span><span class="op" id="6256746">(</span><span class="op" id="6256747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256750">for</span>&nbsp;<span class="ident" id="6256754">_</span><span class="op" id="6256755">,</span>&nbsp;<span class="ident" id="6256757">line</span>&nbsp;<span class="op" id="6256762">:=</span>&nbsp;<span class="keyword" id="6256765">range</span>&nbsp;<span class="ident" id="6256771">strings</span><span class="op" id="6256778">.</span><span class="ident" id="6256779">Split</span><span class="op" id="6256784">(</span><span class="ident" id="6256785">text</span><span class="op" id="6256789">,</span>&nbsp;<span class="string" id="6256791">&#34;\n&#34;</span><span class="op" id="6256795">)</span>&nbsp;<span class="op" id="6256797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256801">orig</span>&nbsp;<span class="op" id="6256806">:=</span>&nbsp;<span class="ident" id="6256809">line</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6256817">//&nbsp;Line&nbsp;is</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6256830">//&nbsp;&nbsp;&nbsp;&nbsp#cgo&nbsp;[GOOS/GOARCH...]&nbsp;LDFLAGS:&nbsp;stuff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6256872">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6256877">line</span>&nbsp;<span class="op" id="6256882">=</span>&nbsp;<span class="ident" id="6256884">strings</span><span class="op" id="6256891">.</span><span class="ident" id="6256892">TrimSpace</span><span class="op" id="6256901">(</span><span class="ident" id="6256902">line</span><span class="op" id="6256906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256910">if</span>&nbsp;<span class="builtinfunc" id="6256913">len</span><span class="op" id="6256916">(</span><span class="ident" id="6256917">line</span><span class="op" id="6256921">)</span>&nbsp;<span class="op" id="6256923">&lt;</span>&nbsp;<span class="num" id="6256925">5</span>&nbsp;<span class="op" id="6256927">||</span>&nbsp;<span class="ident" id="6256930">line</span><span class="op" id="6256934">[</span><span class="op" id="6256935">:</span><span class="num" id="6256936">4</span><span class="op" id="6256937">]</span>&nbsp;<span class="op" id="6256939">!=</span>&nbsp;<span class="string" id="6256942">&#34;#cgo&#34;</span>&nbsp;<span class="op" id="6256949">||</span>&nbsp;<span class="op" id="6256952">(</span><span class="ident" id="6256953">line</span><span class="op" id="6256957">[</span><span class="num" id="6256958">4</span><span class="op" id="6256959">]</span>&nbsp;<span class="op" id="6256961">!=</span>&nbsp;<span class="string" id="6256964">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6256968">&amp;&amp;</span>&nbsp;<span class="ident" id="6256971">line</span><span class="op" id="6256975">[</span><span class="num" id="6256976">4</span><span class="op" id="6256977">]</span>&nbsp;<span class="op" id="6256979">!=</span>&nbsp;<span class="string" id="6256982">&#39;\t&#39;</span><span class="op" id="6256986">)</span>&nbsp;<span class="op" id="6256988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6256993">continue</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6257009">//&nbsp;Split&nbsp;at&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257030">line</span>&nbsp;<span class="op" id="6257035">=</span>&nbsp;<span class="ident" id="6257037">strings</span><span class="op" id="6257044">.</span><span class="ident" id="6257045">TrimSpace</span><span class="op" id="6257054">(</span><span class="ident" id="6257055">line</span><span class="op" id="6257059">[</span><span class="num" id="6257060">4</span><span class="op" id="6257061">:</span><span class="op" id="6257062">]</span><span class="op" id="6257063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257067">i</span>&nbsp;<span class="op" id="6257069">:=</span>&nbsp;<span class="ident" id="6257072">strings</span><span class="op" id="6257079">.</span><span class="ident" id="6257080">Index</span><span class="op" id="6257085">(</span><span class="ident" id="6257086">line</span><span class="op" id="6257090">,</span>&nbsp;<span class="string" id="6257092">&#34;:&#34;</span><span class="op" id="6257095">)</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257099">if</span>&nbsp;<span class="ident" id="6257102">i</span>&nbsp;<span class="op" id="6257104">&lt;</span>&nbsp;<span class="num" id="6257106">0</span>&nbsp;<span class="op" id="6257108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257113">return</span>&nbsp;<span class="ident" id="6257120">fmt</span><span class="op" id="6257123">.</span><span class="ident" id="6257124">Errorf</span><span class="op" id="6257130">(</span><span class="string" id="6257131">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6257158">,</span>&nbsp;<span class="ident" id="6257160">filename</span><span class="op" id="6257168">,</span>&nbsp;<span class="ident" id="6257170">orig</span><span class="op" id="6257174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257182">line</span><span class="op" id="6257186">,</span>&nbsp;<span class="ident" id="6257188">argstr</span>&nbsp;<span class="op" id="6257195">:=</span>&nbsp;<span class="ident" id="6257198">line</span><span class="op" id="6257202">[</span><span class="op" id="6257203">:</span><span class="ident" id="6257204">i</span><span class="op" id="6257205">]</span><span class="op" id="6257206">,</span>&nbsp;<span class="ident" id="6257208">line</span><span class="op" id="6257212">[</span><span class="ident" id="6257213">i</span><span class="op" id="6257214">+</span><span class="num" id="6257215">1</span><span class="op" id="6257216">:</span><span class="op" id="6257217">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6257222">//&nbsp;Parse&nbsp;GOOS/GOARCH&nbsp;stuff.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257252">f</span>&nbsp;<span class="op" id="6257254">:=</span>&nbsp;<span class="ident" id="6257257">strings</span><span class="op" id="6257264">.</span><span class="ident" id="6257265">Fields</span><span class="op" id="6257271">(</span><span class="ident" id="6257272">line</span><span class="op" id="6257276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257280">if</span>&nbsp;<span class="builtinfunc" id="6257283">len</span><span class="op" id="6257286">(</span><span class="ident" id="6257287">f</span><span class="op" id="6257288">)</span>&nbsp;<span class="op" id="6257290">&lt;</span>&nbsp;<span class="num" id="6257292">1</span>&nbsp;<span class="op" id="6257294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257299">return</span>&nbsp;<span class="ident" id="6257306">fmt</span><span class="op" id="6257309">.</span><span class="ident" id="6257310">Errorf</span><span class="op" id="6257316">(</span><span class="string" id="6257317">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6257344">,</span>&nbsp;<span class="ident" id="6257346">filename</span><span class="op" id="6257354">,</span>&nbsp;<span class="ident" id="6257356">orig</span><span class="op" id="6257360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257364">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257369">cond</span><span class="op" id="6257373">,</span>&nbsp;<span class="ident" id="6257375">verb</span>&nbsp;<span class="op" id="6257380">:=</span>&nbsp;<span class="ident" id="6257383">f</span><span class="op" id="6257384">[</span><span class="op" id="6257385">:</span><span class="builtinfunc" id="6257386">len</span><span class="op" id="6257389">(</span><span class="ident" id="6257390">f</span><span class="op" id="6257391">)</span><span class="op" id="6257392">-</span><span class="num" id="6257393">1</span><span class="op" id="6257394">]</span><span class="op" id="6257395">,</span>&nbsp;<span class="ident" id="6257397">f</span><span class="op" id="6257398">[</span><span class="builtinfunc" id="6257399">len</span><span class="op" id="6257402">(</span><span class="ident" id="6257403">f</span><span class="op" id="6257404">)</span><span class="op" id="6257405">-</span><span class="num" id="6257406">1</span><span class="op" id="6257407">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257411">if</span>&nbsp;<span class="builtinfunc" id="6257414">len</span><span class="op" id="6257417">(</span><span class="ident" id="6257418">cond</span><span class="op" id="6257422">)</span>&nbsp;<span class="op" id="6257424">&gt;</span>&nbsp;<span class="num" id="6257426">0</span>&nbsp;<span class="op" id="6257428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257433">ok</span>&nbsp;<span class="op" id="6257436">:=</span>&nbsp;<span class="builtintype" id="6257439">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257448">for</span>&nbsp;<span class="ident" id="6257452">_</span><span class="op" id="6257453">,</span>&nbsp;<span class="ident" id="6257455">c</span>&nbsp;<span class="op" id="6257457">:=</span>&nbsp;<span class="keyword" id="6257460">range</span>&nbsp;<span class="ident" id="6257466">cond</span>&nbsp;<span class="op" id="6257471">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257477">if</span>&nbsp;<span class="ident" id="6257480">ctxt</span><span class="op" id="6257484">.</span><span class="ident" id="6257485">match</span><span class="op" id="6257490">(</span><span class="ident" id="6257491">c</span><span class="op" id="6257492">,</span>&nbsp;<span class="ident" id="6257494">nil</span><span class="op" id="6257497">)</span>&nbsp;<span class="op" id="6257499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257506">ok</span>&nbsp;<span class="op" id="6257509">=</span>&nbsp;<span class="builtintype" id="6257511">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257521">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257536">}</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257541">if</span>&nbsp;<span class="op" id="6257544">!</span><span class="ident" id="6257545">ok</span>&nbsp;<span class="op" id="6257548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257554">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257575">args</span><span class="op" id="6257579">,</span>&nbsp;<span class="ident" id="6257581">err</span>&nbsp;<span class="op" id="6257585">:=</span>&nbsp;<span class="ident" id="6257588">splitQuoted</span><span class="op" id="6257599">(</span><span class="ident" id="6257600">argstr</span><span class="op" id="6257606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257610">if</span>&nbsp;<span class="ident" id="6257613">err</span>&nbsp;<span class="op" id="6257617">!=</span>&nbsp;<span class="ident" id="6257620">nil</span>&nbsp;<span class="op" id="6257624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257629">return</span>&nbsp;<span class="ident" id="6257636">fmt</span><span class="op" id="6257639">.</span><span class="ident" id="6257640">Errorf</span><span class="op" id="6257646">(</span><span class="string" id="6257647">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;line:&nbsp;%s&#34;</span><span class="op" id="6257674">,</span>&nbsp;<span class="ident" id="6257676">filename</span><span class="op" id="6257684">,</span>&nbsp;<span class="ident" id="6257686">orig</span><span class="op" id="6257690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257698">for</span>&nbsp;<span class="ident" id="6257702">_</span><span class="op" id="6257703">,</span>&nbsp;<span class="ident" id="6257705">arg</span>&nbsp;<span class="op" id="6257709">:=</span>&nbsp;<span class="keyword" id="6257712">range</span>&nbsp;<span class="ident" id="6257718">args</span>&nbsp;<span class="op" id="6257723">{</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257728">if</span>&nbsp;<span class="op" id="6257731">!</span><span class="ident" id="6257732">safeCgoName</span><span class="op" id="6257743">(</span><span class="ident" id="6257744">arg</span><span class="op" id="6257747">)</span>&nbsp;<span class="op" id="6257749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257755">return</span>&nbsp;<span class="ident" id="6257762">fmt</span><span class="op" id="6257765">.</span><span class="ident" id="6257766">Errorf</span><span class="op" id="6257772">(</span><span class="string" id="6257773">&#34;%s:&nbsp;malformed&nbsp;#cgo&nbsp;argument:&nbsp;%s&#34;</span><span class="op" id="6257806">,</span>&nbsp;<span class="ident" id="6257808">filename</span><span class="op" id="6257816">,</span>&nbsp;<span class="ident" id="6257818">arg</span><span class="op" id="6257821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6257830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257835">switch</span>&nbsp;<span class="ident" id="6257842">verb</span>&nbsp;<span class="op" id="6257847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257851">case</span>&nbsp;<span class="string" id="6257856">&#34;CFLAGS&#34;</span><span class="op" id="6257864">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257869">di</span><span class="op" id="6257871">.</span><span class="ident" id="6257872">CgoCFLAGS</span>&nbsp;<span class="op" id="6257882">=</span>&nbsp;<span class="builtinfunc" id="6257884">append</span><span class="op" id="6257890">(</span><span class="ident" id="6257891">di</span><span class="op" id="6257893">.</span><span class="ident" id="6257894">CgoCFLAGS</span><span class="op" id="6257903">,</span>&nbsp;<span class="ident" id="6257905">args</span><span class="op" id="6257909">...</span><span class="op" id="6257912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257916">case</span>&nbsp;<span class="string" id="6257921">&#34;CPPFLAGS&#34;</span><span class="op" id="6257931">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6257936">di</span><span class="op" id="6257938">.</span><span class="ident" id="6257939">CgoCPPFLAGS</span>&nbsp;<span class="op" id="6257951">=</span>&nbsp;<span class="builtinfunc" id="6257953">append</span><span class="op" id="6257959">(</span><span class="ident" id="6257960">di</span><span class="op" id="6257962">.</span><span class="ident" id="6257963">CgoCPPFLAGS</span><span class="op" id="6257974">,</span>&nbsp;<span class="ident" id="6257976">args</span><span class="op" id="6257980">...</span><span class="op" id="6257983">)</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6257987">case</span>&nbsp;<span class="string" id="6257992">&#34;CXXFLAGS&#34;</span><span class="op" id="6258002">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6258007">di</span><span class="op" id="6258009">.</span><span class="ident" id="6258010">CgoCXXFLAGS</span>&nbsp;<span class="op" id="6258022">=</span>&nbsp;<span class="builtinfunc" id="6258024">append</span><span class="op" id="6258030">(</span><span class="ident" id="6258031">di</span><span class="op" id="6258033">.</span><span class="ident" id="6258034">CgoCXXFLAGS</span><span class="op" id="6258045">,</span>&nbsp;<span class="ident" id="6258047">args</span><span class="op" id="6258051">...</span><span class="op" id="6258054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258058">case</span>&nbsp;<span class="string" id="6258063">&#34;LDFLAGS&#34;</span><span class="op" id="6258072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6258077">di</span><span class="op" id="6258079">.</span><span class="ident" id="6258080">CgoLDFLAGS</span>&nbsp;<span class="op" id="6258091">=</span>&nbsp;<span class="builtinfunc" id="6258093">append</span><span class="op" id="6258099">(</span><span class="ident" id="6258100">di</span><span class="op" id="6258102">.</span><span class="ident" id="6258103">CgoLDFLAGS</span><span class="op" id="6258113">,</span>&nbsp;<span class="ident" id="6258115">args</span><span class="op" id="6258119">...</span><span class="op" id="6258122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258126">case</span>&nbsp;<span class="string" id="6258131">&#34;pkg-config&#34;</span><span class="op" id="6258143">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6258148">di</span><span class="op" id="6258150">.</span><span class="ident" id="6258151">CgoPkgConfig</span>&nbsp;<span class="op" id="6258164">=</span>&nbsp;<span class="builtinfunc" id="6258166">append</span><span class="op" id="6258172">(</span><span class="ident" id="6258173">di</span><span class="op" id="6258175">.</span><span class="ident" id="6258176">CgoPkgConfig</span><span class="op" id="6258188">,</span>&nbsp;<span class="ident" id="6258190">args</span><span class="op" id="6258194">...</span><span class="op" id="6258197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258201">default</span><span class="op" id="6258208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258213">return</span>&nbsp;<span class="ident" id="6258220">fmt</span><span class="op" id="6258223">.</span><span class="ident" id="6258224">Errorf</span><span class="op" id="6258230">(</span><span class="string" id="6258231">&#34;%s:&nbsp;invalid&nbsp;#cgo&nbsp;verb:&nbsp;%s&#34;</span><span class="op" id="6258258">,</span>&nbsp;<span class="ident" id="6258260">filename</span><span class="op" id="6258268">,</span>&nbsp;<span class="ident" id="6258270">orig</span><span class="op" id="6258274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6258278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6258281">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258284">return</span>&nbsp;<span class="ident" id="6258291">nil</span><br>
<span class="lineno"></span><span class="op" id="6258295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6258298">//&nbsp;NOTE:&nbsp;$&nbsp;is&nbsp;not&nbsp;safe&nbsp;for&nbsp;the&nbsp;shell,&nbsp;but&nbsp;it&nbsp;is&nbsp;allowed&nbsp;here&nbsp;because&nbsp;of&nbsp;linker&nbsp;options&nbsp;like&nbsp;-Wl,$ORIGIN.</span><br>
<span class="lineno"></span><span class="comment" id="6258403">//&nbsp;We&nbsp;never&nbsp;pass&nbsp;these&nbsp;arguments&nbsp;to&nbsp;a&nbsp;shell&nbsp;(just&nbsp;to&nbsp;programs&nbsp;we&nbsp;construct&nbsp;argv&nbsp;for),&nbsp;so&nbsp;this&nbsp;should&nbsp;be&nbsp;okay.</span><br>
<span class="lineno">1145</span><span class="comment" id="6258513">//&nbsp;See&nbsp;golang.org/issue/6038.</span><br>
<span class="lineno"></span><span class="keyword" id="6258543">var</span>&nbsp;<span class="ident" id="6258547">safeBytes</span>&nbsp;<span class="op" id="6258557">=</span>&nbsp;<span class="op" id="6258559">[</span><span class="op" id="6258560">]</span><span class="builtintype" id="6258561">byte</span><span class="op" id="6258565">(</span><span class="string" id="6258566">&#34;+-.,/0123456789=ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz:$&#34;</span><span class="op" id="6258639">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6258642">func</span>&nbsp;<span class="ident" id="6258647">safeCgoName</span><span class="op" id="6258658">(</span><span class="ident" id="6258659">s</span>&nbsp;<span class="builtintype" id="6258661">string</span><span class="op" id="6258667">)</span>&nbsp;<span class="builtintype" id="6258669">bool</span>&nbsp;<span class="op" id="6258674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258677">if</span>&nbsp;<span class="ident" id="6258680">s</span>&nbsp;<span class="op" id="6258682">==</span>&nbsp;<span class="string" id="6258685">&#34;&#34;</span>&nbsp;<span class="op" id="6258688">{</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258692">return</span>&nbsp;<span class="builtintype" id="6258699">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6258706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258709">for</span>&nbsp;<span class="ident" id="6258713">i</span>&nbsp;<span class="op" id="6258715">:=</span>&nbsp;<span class="num" id="6258718">0</span><span class="op" id="6258719">;</span>&nbsp;<span class="ident" id="6258721">i</span>&nbsp;<span class="op" id="6258723">&lt;</span>&nbsp;<span class="builtinfunc" id="6258725">len</span><span class="op" id="6258728">(</span><span class="ident" id="6258729">s</span><span class="op" id="6258730">)</span><span class="op" id="6258731">;</span>&nbsp;<span class="ident" id="6258733">i</span><span class="op" id="6258734">++</span>&nbsp;<span class="op" id="6258737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258741">if</span>&nbsp;<span class="ident" id="6258744">c</span>&nbsp;<span class="op" id="6258746">:=</span>&nbsp;<span class="ident" id="6258749">s</span><span class="op" id="6258750">[</span><span class="ident" id="6258751">i</span><span class="op" id="6258752">]</span><span class="op" id="6258753">;</span>&nbsp;<span class="ident" id="6258755">c</span>&nbsp;<span class="op" id="6258757">&lt;</span>&nbsp;<span class="num" id="6258759">0x80</span>&nbsp;<span class="op" id="6258764">&amp;&amp;</span>&nbsp;<span class="ident" id="6258767">bytes</span><span class="op" id="6258772">.</span><span class="ident" id="6258773">IndexByte</span><span class="op" id="6258782">(</span><span class="ident" id="6258783">safeBytes</span><span class="op" id="6258792">,</span>&nbsp;<span class="ident" id="6258794">c</span><span class="op" id="6258795">)</span>&nbsp;<span class="op" id="6258797">&lt;</span>&nbsp;<span class="num" id="6258799">0</span>&nbsp;<span class="op" id="6258801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258806">return</span>&nbsp;<span class="builtintype" id="6258813">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6258821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6258824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6258827">return</span>&nbsp;<span class="builtintype" id="6258834">true</span><br>
<span class="lineno"></span><span class="op" id="6258839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1160</span><span class="comment" id="6258842">//&nbsp;splitQuoted&nbsp;splits&nbsp;the&nbsp;string&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive</span><br>
<span class="lineno"></span><span class="comment" id="6258925">//&nbsp;white&nbsp;space&nbsp;characters&nbsp;while&nbsp;taking&nbsp;into&nbsp;account&nbsp;quotes&nbsp;and&nbsp;escaping,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6259002">//&nbsp;returns&nbsp;an&nbsp;array&nbsp;of&nbsp;substrings&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="comment" id="6259090">//&nbsp;Single&nbsp;quotes&nbsp;and&nbsp;double&nbsp;quotes&nbsp;are&nbsp;recognized&nbsp;to&nbsp;prevent&nbsp;splitting&nbsp;within&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6259172">//&nbsp;quoted&nbsp;region,&nbsp;and&nbsp;are&nbsp;removed&nbsp;from&nbsp;the&nbsp;resulting&nbsp;substrings.&nbsp;If&nbsp;a&nbsp;quote&nbsp;in&nbsp;s</span><br>
<span class="lineno">1165</span><span class="comment" id="6259253">//&nbsp;isn&#39;t&nbsp;closed&nbsp;err&nbsp;will&nbsp;be&nbsp;set&nbsp;and&nbsp;r&nbsp;will&nbsp;have&nbsp;the&nbsp;unclosed&nbsp;argument&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6259330">//&nbsp;last&nbsp;element.&nbsp;&nbsp;The&nbsp;backslash&nbsp;is&nbsp;used&nbsp;for&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="comment" id="6259384">//</span><br>
<span class="lineno"></span><span class="comment" id="6259387">//&nbsp;For&nbsp;example,&nbsp;the&nbsp;following&nbsp;string:</span><br>
<span class="lineno"></span><span class="comment" id="6259425">//</span><br>
<span class="lineno">1170</span><span class="comment" id="6259428">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;b:&#34;c&nbsp;d&#34;&nbsp;&#39;e&#39;&#39;f&#39;&nbsp;&nbsp;&#34;g\&#34;&#34;</span><br>
<span class="lineno"></span><span class="comment" id="6259459">//</span><br>
<span class="lineno"></span><span class="comment" id="6259462">//&nbsp;Would&nbsp;be&nbsp;parsed&nbsp;as:</span><br>
<span class="lineno"></span><span class="comment" id="6259485">//</span><br>
<span class="lineno"></span><span class="comment" id="6259488">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]string{&#34;a&#34;,&nbsp;&#34;b:c&nbsp;d&#34;,&nbsp;&#34;ef&#34;,&nbsp;`g&#34;`}</span><br>
<span class="lineno">1175</span><span class="comment" id="6259530">//</span><br>
<span class="lineno"></span><span class="keyword" id="6259533">func</span>&nbsp;<span class="ident" id="6259538">splitQuoted</span><span class="op" id="6259549">(</span><span class="ident" id="6259550">s</span>&nbsp;<span class="builtintype" id="6259552">string</span><span class="op" id="6259558">)</span>&nbsp;<span class="op" id="6259560">(</span><span class="ident" id="6259561">r</span>&nbsp;<span class="op" id="6259563">[</span><span class="op" id="6259564">]</span><span class="builtintype" id="6259565">string</span><span class="op" id="6259571">,</span>&nbsp;<span class="ident" id="6259573">err</span>&nbsp;<span class="builtintype" id="6259577">error</span><span class="op" id="6259582">)</span>&nbsp;<span class="op" id="6259584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259587">var</span>&nbsp;<span class="ident" id="6259591">args</span>&nbsp;<span class="op" id="6259596">[</span><span class="op" id="6259597">]</span><span class="builtintype" id="6259598">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259606">arg</span>&nbsp;<span class="op" id="6259610">:=</span>&nbsp;<span class="builtinfunc" id="6259613">make</span><span class="op" id="6259617">(</span><span class="op" id="6259618">[</span><span class="op" id="6259619">]</span><span class="builtintype" id="6259620">rune</span><span class="op" id="6259624">,</span>&nbsp;<span class="builtinfunc" id="6259626">len</span><span class="op" id="6259629">(</span><span class="ident" id="6259630">s</span><span class="op" id="6259631">)</span><span class="op" id="6259632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259635">escaped</span>&nbsp;<span class="op" id="6259643">:=</span>&nbsp;<span class="builtintype" id="6259646">false</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259653">quoted</span>&nbsp;<span class="op" id="6259660">:=</span>&nbsp;<span class="builtintype" id="6259663">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259670">quote</span>&nbsp;<span class="op" id="6259676">:=</span>&nbsp;<span class="string" id="6259679">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259687">i</span>&nbsp;<span class="op" id="6259689">:=</span>&nbsp;<span class="num" id="6259692">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259695">for</span>&nbsp;<span class="ident" id="6259699">_</span><span class="op" id="6259700">,</span>&nbsp;<span class="builtintype" id="6259702">rune</span>&nbsp;<span class="op" id="6259707">:=</span>&nbsp;<span class="keyword" id="6259710">range</span>&nbsp;<span class="ident" id="6259716">s</span>&nbsp;<span class="op" id="6259718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259722">switch</span>&nbsp;<span class="op" id="6259729">{</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259733">case</span>&nbsp;<span class="ident" id="6259738">escaped</span><span class="op" id="6259745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259750">escaped</span>&nbsp;<span class="op" id="6259758">=</span>&nbsp;<span class="builtintype" id="6259760">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259768">case</span>&nbsp;<span class="builtintype" id="6259773">rune</span>&nbsp;<span class="op" id="6259778">==</span>&nbsp;<span class="string" id="6259781">&#39;\\&#39;</span><span class="op" id="6259785">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259790">escaped</span>&nbsp;<span class="op" id="6259798">=</span>&nbsp;<span class="builtintype" id="6259800">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259808">continue</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259819">case</span>&nbsp;<span class="ident" id="6259824">quote</span>&nbsp;<span class="op" id="6259830">!=</span>&nbsp;<span class="string" id="6259833">&#39;\x00&#39;</span><span class="op" id="6259839">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259844">if</span>&nbsp;<span class="builtintype" id="6259847">rune</span>&nbsp;<span class="op" id="6259852">==</span>&nbsp;<span class="ident" id="6259855">quote</span>&nbsp;<span class="op" id="6259861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259867">quote</span>&nbsp;<span class="op" id="6259873">=</span>&nbsp;<span class="string" id="6259875">&#39;\x00&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259886">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6259898">}</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259902">case</span>&nbsp;<span class="builtintype" id="6259907">rune</span>&nbsp;<span class="op" id="6259912">==</span>&nbsp;<span class="string" id="6259915">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6259919">||</span>&nbsp;<span class="builtintype" id="6259922">rune</span>&nbsp;<span class="op" id="6259927">==</span>&nbsp;<span class="string" id="6259930">&#39;\&#39;&#39;</span><span class="op" id="6259934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259939">quoted</span>&nbsp;<span class="op" id="6259946">=</span>&nbsp;<span class="builtintype" id="6259948">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6259956">quote</span>&nbsp;<span class="op" id="6259962">=</span>&nbsp;<span class="builtintype" id="6259964">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259972">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6259983">case</span>&nbsp;<span class="ident" id="6259988">unicode</span><span class="op" id="6259995">.</span><span class="ident" id="6259996">IsSpace</span><span class="op" id="6260003">(</span><span class="builtintype" id="6260004">rune</span><span class="op" id="6260008">)</span><span class="op" id="6260009">:</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260014">if</span>&nbsp;<span class="ident" id="6260017">quoted</span>&nbsp;<span class="op" id="6260024">||</span>&nbsp;<span class="ident" id="6260027">i</span>&nbsp;<span class="op" id="6260029">&gt;</span>&nbsp;<span class="num" id="6260031">0</span>&nbsp;<span class="op" id="6260033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260039">quoted</span>&nbsp;<span class="op" id="6260046">=</span>&nbsp;<span class="builtintype" id="6260048">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260058">args</span>&nbsp;<span class="op" id="6260063">=</span>&nbsp;<span class="builtinfunc" id="6260065">append</span><span class="op" id="6260071">(</span><span class="ident" id="6260072">args</span><span class="op" id="6260076">,</span>&nbsp;<span class="builtintype" id="6260078">string</span><span class="op" id="6260084">(</span><span class="ident" id="6260085">arg</span><span class="op" id="6260088">[</span><span class="op" id="6260089">:</span><span class="ident" id="6260090">i</span><span class="op" id="6260091">]</span><span class="op" id="6260092">)</span><span class="op" id="6260093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260099">i</span>&nbsp;<span class="op" id="6260101">=</span>&nbsp;<span class="num" id="6260103">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260108">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260113">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260128">arg</span><span class="op" id="6260131">[</span><span class="ident" id="6260132">i</span><span class="op" id="6260133">]</span>&nbsp;<span class="op" id="6260135">=</span>&nbsp;<span class="builtintype" id="6260137">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260144">i</span><span class="op" id="6260145">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260149">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260152">if</span>&nbsp;<span class="ident" id="6260155">quoted</span>&nbsp;<span class="op" id="6260162">||</span>&nbsp;<span class="ident" id="6260165">i</span>&nbsp;<span class="op" id="6260167">&gt;</span>&nbsp;<span class="num" id="6260169">0</span>&nbsp;<span class="op" id="6260171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260175">args</span>&nbsp;<span class="op" id="6260180">=</span>&nbsp;<span class="builtinfunc" id="6260182">append</span><span class="op" id="6260188">(</span><span class="ident" id="6260189">args</span><span class="op" id="6260193">,</span>&nbsp;<span class="builtintype" id="6260195">string</span><span class="op" id="6260201">(</span><span class="ident" id="6260202">arg</span><span class="op" id="6260205">[</span><span class="op" id="6260206">:</span><span class="ident" id="6260207">i</span><span class="op" id="6260208">]</span><span class="op" id="6260209">)</span><span class="op" id="6260210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260216">if</span>&nbsp;<span class="ident" id="6260219">quote</span>&nbsp;<span class="op" id="6260225">!=</span>&nbsp;<span class="num" id="6260228">0</span>&nbsp;<span class="op" id="6260230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260234">err</span>&nbsp;<span class="op" id="6260238">=</span>&nbsp;<span class="ident" id="6260240">errors</span><span class="op" id="6260246">.</span><span class="ident" id="6260247">New</span><span class="op" id="6260250">(</span><span class="string" id="6260251">&#34;unclosed&nbsp;quote&#34;</span><span class="op" id="6260267">)</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260270">}</span>&nbsp;<span class="keyword" id="6260272">else</span>&nbsp;<span class="keyword" id="6260277">if</span>&nbsp;<span class="ident" id="6260280">escaped</span>&nbsp;<span class="op" id="6260288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260292">err</span>&nbsp;<span class="op" id="6260296">=</span>&nbsp;<span class="ident" id="6260298">errors</span><span class="op" id="6260304">.</span><span class="ident" id="6260305">New</span><span class="op" id="6260308">(</span><span class="string" id="6260309">&#34;unfinished&nbsp;escaping&#34;</span><span class="op" id="6260330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260336">return</span>&nbsp;<span class="ident" id="6260343">args</span><span class="op" id="6260347">,</span>&nbsp;<span class="ident" id="6260349">err</span><br>
<span class="lineno"></span><span class="op" id="6260353">}</span><br>
<span class="lineno">1220</span><br>
<span class="lineno"></span><span class="comment" id="6260356">//&nbsp;match&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;name&nbsp;is&nbsp;one&nbsp;of:</span><br>
<span class="lineno"></span><span class="comment" id="6260401">//</span><br>
<span class="lineno"></span><span class="comment" id="6260404">//&nbsp;&nbsp;&nbsp;&nbsp$GOOS</span><br>
<span class="lineno"></span><span class="comment" id="6260413">//&nbsp;&nbsp;&nbsp;&nbsp$GOARCH</span><br>
<span class="lineno">1225</span><span class="comment" id="6260424">//&nbsp;&nbsp;&nbsp;&nbspcgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;enabled)</span><br>
<span class="lineno"></span><span class="comment" id="6260451">//&nbsp;&nbsp;&nbsp;&nbsp!cgo&nbsp;(if&nbsp;cgo&nbsp;is&nbsp;disabled)</span><br>
<span class="lineno"></span><span class="comment" id="6260480">//&nbsp;&nbsp;&nbsp;&nbspctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="6260497">//&nbsp;&nbsp;&nbsp;&nbsp!ctxt.Compiler</span><br>
<span class="lineno"></span><span class="comment" id="6260515">//&nbsp;&nbsp;&nbsp;&nbsptag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno">1230</span><span class="comment" id="6260579">//&nbsp;&nbsp;&nbsp;&nbsp!tag&nbsp;(if&nbsp;tag&nbsp;is&nbsp;not&nbsp;listed&nbsp;in&nbsp;ctxt.BuildTags&nbsp;or&nbsp;ctxt.ReleaseTags)</span><br>
<span class="lineno"></span><span class="comment" id="6260648">//&nbsp;&nbsp;&nbsp;&nbspa&nbsp;comma-separated&nbsp;list&nbsp;of&nbsp;any&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="6260690">//</span><br>
<span class="lineno"></span><span class="keyword" id="6260693">func</span>&nbsp;<span class="op" id="6260698">(</span><span class="ident" id="6260699">ctxt</span>&nbsp;<span class="op" id="6260704">*</span><span class="ident" id="6260705">Context</span><span class="op" id="6260712">)</span>&nbsp;<span class="ident" id="6260714">match</span><span class="op" id="6260719">(</span><span class="ident" id="6260720">name</span>&nbsp;<span class="builtintype" id="6260725">string</span><span class="op" id="6260731">,</span>&nbsp;<span class="ident" id="6260733">allTags</span>&nbsp;<span class="keyword" id="6260741">map</span><span class="op" id="6260744">[</span><span class="builtintype" id="6260745">string</span><span class="op" id="6260751">]</span><span class="builtintype" id="6260752">bool</span><span class="op" id="6260756">)</span>&nbsp;<span class="builtintype" id="6260758">bool</span>&nbsp;<span class="op" id="6260763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260766">if</span>&nbsp;<span class="ident" id="6260769">name</span>&nbsp;<span class="op" id="6260774">==</span>&nbsp;<span class="string" id="6260777">&#34;&#34;</span>&nbsp;<span class="op" id="6260780">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260784">if</span>&nbsp;<span class="ident" id="6260787">allTags</span>&nbsp;<span class="op" id="6260795">!=</span>&nbsp;<span class="ident" id="6260798">nil</span>&nbsp;<span class="op" id="6260802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260807">allTags</span><span class="op" id="6260814">[</span><span class="ident" id="6260815">name</span><span class="op" id="6260819">]</span>&nbsp;<span class="op" id="6260821">=</span>&nbsp;<span class="builtintype" id="6260823">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260834">return</span>&nbsp;<span class="builtintype" id="6260841">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6260848">}</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6260851">if</span>&nbsp;<span class="ident" id="6260854">i</span>&nbsp;<span class="op" id="6260856">:=</span>&nbsp;<span class="ident" id="6260859">strings</span><span class="op" id="6260866">.</span><span class="ident" id="6260867">Index</span><span class="op" id="6260872">(</span><span class="ident" id="6260873">name</span><span class="op" id="6260877">,</span>&nbsp;<span class="string" id="6260879">&#34;,&#34;</span><span class="op" id="6260882">)</span><span class="op" id="6260883">;</span>&nbsp;<span class="ident" id="6260885">i</span>&nbsp;<span class="op" id="6260887">&gt;=</span>&nbsp;<span class="num" id="6260890">0</span>&nbsp;<span class="op" id="6260892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6260896">//&nbsp;comma-separated&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260922">ok1</span>&nbsp;<span class="op" id="6260926">:=</span>&nbsp;<span class="ident" id="6260929">ctxt</span><span class="op" id="6260933">.</span><span class="ident" id="6260934">match</span><span class="op" id="6260939">(</span><span class="ident" id="6260940">name</span><span class="op" id="6260944">[</span><span class="op" id="6260945">:</span><span class="ident" id="6260946">i</span><span class="op" id="6260947">]</span><span class="op" id="6260948">,</span>&nbsp;<span class="ident" id="6260950">allTags</span><span class="op" id="6260957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6260961">ok2</span>&nbsp;<span class="op" id="6260965">:=</span>&nbsp;<span class="ident" id="6260968">ctxt</span><span class="op" id="6260972">.</span><span class="ident" id="6260973">match</span><span class="op" id="6260978">(</span><span class="ident" id="6260979">name</span><span class="op" id="6260983">[</span><span class="ident" id="6260984">i</span><span class="op" id="6260985">+</span><span class="num" id="6260986">1</span><span class="op" id="6260987">:</span><span class="op" id="6260988">]</span><span class="op" id="6260989">,</span>&nbsp;<span class="ident" id="6260991">allTags</span><span class="op" id="6260998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261002">return</span>&nbsp;<span class="ident" id="6261009">ok1</span>&nbsp;<span class="op" id="6261013">&amp;&amp;</span>&nbsp;<span class="ident" id="6261016">ok2</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261024">if</span>&nbsp;<span class="ident" id="6261027">strings</span><span class="op" id="6261034">.</span><span class="ident" id="6261035">HasPrefix</span><span class="op" id="6261044">(</span><span class="ident" id="6261045">name</span><span class="op" id="6261049">,</span>&nbsp;<span class="string" id="6261051">&#34;!!&#34;</span><span class="op" id="6261055">)</span>&nbsp;<span class="op" id="6261057">{</span>&nbsp;<span class="comment" id="6261059">//&nbsp;bad&nbsp;syntax,&nbsp;reject&nbsp;always</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261090">return</span>&nbsp;<span class="builtintype" id="6261097">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261107">if</span>&nbsp;<span class="ident" id="6261110">strings</span><span class="op" id="6261117">.</span><span class="ident" id="6261118">HasPrefix</span><span class="op" id="6261127">(</span><span class="ident" id="6261128">name</span><span class="op" id="6261132">,</span>&nbsp;<span class="string" id="6261134">&#34;!&#34;</span><span class="op" id="6261137">)</span>&nbsp;<span class="op" id="6261139">{</span>&nbsp;<span class="comment" id="6261141">//&nbsp;negation</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261155">return</span>&nbsp;<span class="builtinfunc" id="6261162">len</span><span class="op" id="6261165">(</span><span class="ident" id="6261166">name</span><span class="op" id="6261170">)</span>&nbsp;<span class="op" id="6261172">&gt;</span>&nbsp;<span class="num" id="6261174">1</span>&nbsp;<span class="op" id="6261176">&amp;&amp;</span>&nbsp;<span class="op" id="6261179">!</span><span class="ident" id="6261180">ctxt</span><span class="op" id="6261184">.</span><span class="ident" id="6261185">match</span><span class="op" id="6261190">(</span><span class="ident" id="6261191">name</span><span class="op" id="6261195">[</span><span class="num" id="6261196">1</span><span class="op" id="6261197">:</span><span class="op" id="6261198">]</span><span class="op" id="6261199">,</span>&nbsp;<span class="ident" id="6261201">allTags</span><span class="op" id="6261208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261215">if</span>&nbsp;<span class="ident" id="6261218">allTags</span>&nbsp;<span class="op" id="6261226">!=</span>&nbsp;<span class="ident" id="6261229">nil</span>&nbsp;<span class="op" id="6261233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6261237">allTags</span><span class="op" id="6261244">[</span><span class="ident" id="6261245">name</span><span class="op" id="6261249">]</span>&nbsp;<span class="op" id="6261251">=</span>&nbsp;<span class="builtintype" id="6261253">true</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6261263">//&nbsp;Tags&nbsp;must&nbsp;be&nbsp;letters,&nbsp;digits,&nbsp;underscores&nbsp;or&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6261318">//&nbsp;Unlike&nbsp;in&nbsp;Go&nbsp;identifiers,&nbsp;all&nbsp;digits&nbsp;are&nbsp;fine&nbsp;(e.g.,&nbsp;&#34;386&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261383">for</span>&nbsp;<span class="ident" id="6261387">_</span><span class="op" id="6261388">,</span>&nbsp;<span class="ident" id="6261390">c</span>&nbsp;<span class="op" id="6261392">:=</span>&nbsp;<span class="keyword" id="6261395">range</span>&nbsp;<span class="ident" id="6261401">name</span>&nbsp;<span class="op" id="6261406">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261410">if</span>&nbsp;<span class="op" id="6261413">!</span><span class="ident" id="6261414">unicode</span><span class="op" id="6261421">.</span><span class="ident" id="6261422">IsLetter</span><span class="op" id="6261430">(</span><span class="ident" id="6261431">c</span><span class="op" id="6261432">)</span>&nbsp;<span class="op" id="6261434">&amp;&amp;</span>&nbsp;<span class="op" id="6261437">!</span><span class="ident" id="6261438">unicode</span><span class="op" id="6261445">.</span><span class="ident" id="6261446">IsDigit</span><span class="op" id="6261453">(</span><span class="ident" id="6261454">c</span><span class="op" id="6261455">)</span>&nbsp;<span class="op" id="6261457">&amp;&amp;</span>&nbsp;<span class="ident" id="6261460">c</span>&nbsp;<span class="op" id="6261462">!=</span>&nbsp;<span class="string" id="6261465">&#39;_&#39;</span>&nbsp;<span class="op" id="6261469">&amp;&amp;</span>&nbsp;<span class="ident" id="6261472">c</span>&nbsp;<span class="op" id="6261474">!=</span>&nbsp;<span class="string" id="6261477">&#39;.&#39;</span>&nbsp;<span class="op" id="6261481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261486">return</span>&nbsp;<span class="builtintype" id="6261493">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6261508">//&nbsp;special&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261525">if</span>&nbsp;<span class="ident" id="6261528">ctxt</span><span class="op" id="6261532">.</span><span class="ident" id="6261533">CgoEnabled</span>&nbsp;<span class="op" id="6261544">&amp;&amp;</span>&nbsp;<span class="ident" id="6261547">name</span>&nbsp;<span class="op" id="6261552">==</span>&nbsp;<span class="string" id="6261555">&#34;cgo&#34;</span>&nbsp;<span class="op" id="6261561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261565">return</span>&nbsp;<span class="builtintype" id="6261572">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261581">if</span>&nbsp;<span class="ident" id="6261584">name</span>&nbsp;<span class="op" id="6261589">==</span>&nbsp;<span class="ident" id="6261592">ctxt</span><span class="op" id="6261596">.</span><span class="ident" id="6261597">GOOS</span>&nbsp;<span class="op" id="6261602">||</span>&nbsp;<span class="ident" id="6261605">name</span>&nbsp;<span class="op" id="6261610">==</span>&nbsp;<span class="ident" id="6261613">ctxt</span><span class="op" id="6261617">.</span><span class="ident" id="6261618">GOARCH</span>&nbsp;<span class="op" id="6261625">||</span>&nbsp;<span class="ident" id="6261628">name</span>&nbsp;<span class="op" id="6261633">==</span>&nbsp;<span class="ident" id="6261636">ctxt</span><span class="op" id="6261640">.</span><span class="ident" id="6261641">Compiler</span>&nbsp;<span class="op" id="6261650">{</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261654">return</span>&nbsp;<span class="builtintype" id="6261661">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261670">if</span>&nbsp;<span class="ident" id="6261673">ctxt</span><span class="op" id="6261677">.</span><span class="ident" id="6261678">GOOS</span>&nbsp;<span class="op" id="6261683">==</span>&nbsp;<span class="string" id="6261686">&#34;android&#34;</span>&nbsp;<span class="op" id="6261696">&amp;&amp;</span>&nbsp;<span class="ident" id="6261699">name</span>&nbsp;<span class="op" id="6261704">==</span>&nbsp;<span class="string" id="6261707">&#34;linux&#34;</span>&nbsp;<span class="op" id="6261715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261719">return</span>&nbsp;<span class="builtintype" id="6261726">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261732">}</span><br>
<span class="lineno">1275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6261736">//&nbsp;other&nbsp;tags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261751">for</span>&nbsp;<span class="ident" id="6261755">_</span><span class="op" id="6261756">,</span>&nbsp;<span class="ident" id="6261758">tag</span>&nbsp;<span class="op" id="6261762">:=</span>&nbsp;<span class="keyword" id="6261765">range</span>&nbsp;<span class="ident" id="6261771">ctxt</span><span class="op" id="6261775">.</span><span class="ident" id="6261776">BuildTags</span>&nbsp;<span class="op" id="6261786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261790">if</span>&nbsp;<span class="ident" id="6261793">tag</span>&nbsp;<span class="op" id="6261797">==</span>&nbsp;<span class="ident" id="6261800">name</span>&nbsp;<span class="op" id="6261805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261810">return</span>&nbsp;<span class="builtintype" id="6261817">true</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261830">for</span>&nbsp;<span class="ident" id="6261834">_</span><span class="op" id="6261835">,</span>&nbsp;<span class="ident" id="6261837">tag</span>&nbsp;<span class="op" id="6261841">:=</span>&nbsp;<span class="keyword" id="6261844">range</span>&nbsp;<span class="ident" id="6261850">ctxt</span><span class="op" id="6261854">.</span><span class="ident" id="6261855">ReleaseTags</span>&nbsp;<span class="op" id="6261867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261871">if</span>&nbsp;<span class="ident" id="6261874">tag</span>&nbsp;<span class="op" id="6261878">==</span>&nbsp;<span class="ident" id="6261881">name</span>&nbsp;<span class="op" id="6261886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261891">return</span>&nbsp;<span class="builtintype" id="6261898">true</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6261908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6261912">return</span>&nbsp;<span class="builtintype" id="6261919">false</span><br>
<span class="lineno"></span><span class="op" id="6261925">}</span><br>
<span class="lineno">1290</span><br>
<span class="lineno"></span><span class="comment" id="6261928">//&nbsp;goodOSArchFile&nbsp;returns&nbsp;false&nbsp;if&nbsp;the&nbsp;name&nbsp;contains&nbsp;a&nbsp;$GOOS&nbsp;or&nbsp;$GOARCH</span><br>
<span class="lineno"></span><span class="comment" id="6262000">//&nbsp;suffix&nbsp;which&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;current&nbsp;system.</span><br>
<span class="lineno"></span><span class="comment" id="6262051">//&nbsp;The&nbsp;recognized&nbsp;name&nbsp;formats&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="6262087">//</span><br>
<span class="lineno">1295</span><span class="comment" id="6262090">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS).*</span><br>
<span class="lineno"></span><span class="comment" id="6262112">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="6262136">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH).*</span><br>
<span class="lineno"></span><span class="comment" id="6262168">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="6262195">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOARCH)_test.*</span><br>
<span class="lineno">1300</span><span class="comment" id="6262224">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name_$(GOOS)_$(GOARCH)_test.*</span><br>
<span class="lineno"></span><span class="comment" id="6262261">//</span><br>
<span class="lineno"></span><span class="comment" id="6262264">//&nbsp;An&nbsp;exception:&nbsp;if&nbsp;GOOS=android,&nbsp;then&nbsp;files&nbsp;with&nbsp;GOOS=linux&nbsp;are&nbsp;also&nbsp;matched.</span><br>
<span class="lineno"></span><span class="keyword" id="6262343">func</span>&nbsp;<span class="op" id="6262348">(</span><span class="ident" id="6262349">ctxt</span>&nbsp;<span class="op" id="6262354">*</span><span class="ident" id="6262355">Context</span><span class="op" id="6262362">)</span>&nbsp;<span class="ident" id="6262364">goodOSArchFile</span><span class="op" id="6262378">(</span><span class="ident" id="6262379">name</span>&nbsp;<span class="builtintype" id="6262384">string</span><span class="op" id="6262390">,</span>&nbsp;<span class="ident" id="6262392">allTags</span>&nbsp;<span class="keyword" id="6262400">map</span><span class="op" id="6262403">[</span><span class="builtintype" id="6262404">string</span><span class="op" id="6262410">]</span><span class="builtintype" id="6262411">bool</span><span class="op" id="6262415">)</span>&nbsp;<span class="builtintype" id="6262417">bool</span>&nbsp;<span class="op" id="6262422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6262425">if</span>&nbsp;<span class="ident" id="6262428">dot</span>&nbsp;<span class="op" id="6262432">:=</span>&nbsp;<span class="ident" id="6262435">strings</span><span class="op" id="6262442">.</span><span class="ident" id="6262443">Index</span><span class="op" id="6262448">(</span><span class="ident" id="6262449">name</span><span class="op" id="6262453">,</span>&nbsp;<span class="string" id="6262455">&#34;.&#34;</span><span class="op" id="6262458">)</span><span class="op" id="6262459">;</span>&nbsp;<span class="ident" id="6262461">dot</span>&nbsp;<span class="op" id="6262465">!=</span>&nbsp;<span class="op" id="6262468">-</span><span class="num" id="6262469">1</span>&nbsp;<span class="op" id="6262471">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6262475">name</span>&nbsp;<span class="op" id="6262480">=</span>&nbsp;<span class="ident" id="6262482">name</span><span class="op" id="6262486">[</span><span class="op" id="6262487">:</span><span class="ident" id="6262488">dot</span><span class="op" id="6262491">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6262494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6262498">//&nbsp;Before&nbsp;Go&nbsp;1.4,&nbsp;a&nbsp;file&nbsp;called&nbsp;&#34;linux.go&#34;&nbsp;would&nbsp;be&nbsp;equivalent&nbsp;to&nbsp;having&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6262574">//&nbsp;build&nbsp;tag&nbsp;&#34;linux&#34;&nbsp;in&nbsp;that&nbsp;file.&nbsp;For&nbsp;Go&nbsp;1.4&nbsp;and&nbsp;beyond,&nbsp;we&nbsp;require&nbsp;this</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6262649">//&nbsp;auto-tagging&nbsp;to&nbsp;apply&nbsp;only&nbsp;to&nbsp;files&nbsp;with&nbsp;a&nbsp;non-empty&nbsp;prefix,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6262717">//&nbsp;&#34;foo_linux.go&#34;&nbsp;is&nbsp;tagged&nbsp;but&nbsp;&#34;linux.go&#34;&nbsp;is&nbsp;not.&nbsp;This&nbsp;allows&nbsp;new&nbsp;operating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6262795">//&nbsp;sytems,&nbsp;such&nbsp;as&nbsp;android,&nbsp;to&nbsp;arrive&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;code&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6262870">//&nbsp;innocuous&nbsp;source&nbsp;code&nbsp;in&nbsp;&#34;android.go&#34;.&nbsp;The&nbsp;easiest&nbsp;fix:&nbsp;cut&nbsp;everything</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6262945">//&nbsp;in&nbsp;the&nbsp;name&nbsp;before&nbsp;the&nbsp;initial&nbsp;_.</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6262983">i</span>&nbsp;<span class="op" id="6262985">:=</span>&nbsp;<span class="ident" id="6262988">strings</span><span class="op" id="6262995">.</span><span class="ident" id="6262996">Index</span><span class="op" id="6263001">(</span><span class="ident" id="6263002">name</span><span class="op" id="6263006">,</span>&nbsp;<span class="string" id="6263008">&#34;_&#34;</span><span class="op" id="6263011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263014">if</span>&nbsp;<span class="ident" id="6263017">i</span>&nbsp;<span class="op" id="6263019">&lt;</span>&nbsp;<span class="num" id="6263021">0</span>&nbsp;<span class="op" id="6263023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263027">return</span>&nbsp;<span class="builtintype" id="6263034">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263043">name</span>&nbsp;<span class="op" id="6263048">=</span>&nbsp;<span class="ident" id="6263050">name</span><span class="op" id="6263054">[</span><span class="ident" id="6263055">i</span><span class="op" id="6263056">:</span><span class="op" id="6263057">]</span>&nbsp;<span class="comment" id="6263059">//&nbsp;ignore&nbsp;everything&nbsp;before&nbsp;first&nbsp;_</span><br>
<span class="lineno">1320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263097">l</span>&nbsp;<span class="op" id="6263099">:=</span>&nbsp;<span class="ident" id="6263102">strings</span><span class="op" id="6263109">.</span><span class="ident" id="6263110">Split</span><span class="op" id="6263115">(</span><span class="ident" id="6263116">name</span><span class="op" id="6263120">,</span>&nbsp;<span class="string" id="6263122">&#34;_&#34;</span><span class="op" id="6263125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263128">if</span>&nbsp;<span class="ident" id="6263131">n</span>&nbsp;<span class="op" id="6263133">:=</span>&nbsp;<span class="builtinfunc" id="6263136">len</span><span class="op" id="6263139">(</span><span class="ident" id="6263140">l</span><span class="op" id="6263141">)</span><span class="op" id="6263142">;</span>&nbsp;<span class="ident" id="6263144">n</span>&nbsp;<span class="op" id="6263146">&gt;</span>&nbsp;<span class="num" id="6263148">0</span>&nbsp;<span class="op" id="6263150">&amp;&amp;</span>&nbsp;<span class="ident" id="6263153">l</span><span class="op" id="6263154">[</span><span class="ident" id="6263155">n</span><span class="op" id="6263156">-</span><span class="num" id="6263157">1</span><span class="op" id="6263158">]</span>&nbsp;<span class="op" id="6263160">==</span>&nbsp;<span class="string" id="6263163">&#34;test&#34;</span>&nbsp;<span class="op" id="6263170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263174">l</span>&nbsp;<span class="op" id="6263176">=</span>&nbsp;<span class="ident" id="6263178">l</span><span class="op" id="6263179">[</span><span class="op" id="6263180">:</span><span class="ident" id="6263181">n</span><span class="op" id="6263182">-</span><span class="num" id="6263183">1</span><span class="op" id="6263184">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263187">}</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263190">n</span>&nbsp;<span class="op" id="6263192">:=</span>&nbsp;<span class="builtinfunc" id="6263195">len</span><span class="op" id="6263198">(</span><span class="ident" id="6263199">l</span><span class="op" id="6263200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263203">if</span>&nbsp;<span class="ident" id="6263206">n</span>&nbsp;<span class="op" id="6263208">&gt;=</span>&nbsp;<span class="num" id="6263211">2</span>&nbsp;<span class="op" id="6263213">&amp;&amp;</span>&nbsp;<span class="ident" id="6263216">knownOS</span><span class="op" id="6263223">[</span><span class="ident" id="6263224">l</span><span class="op" id="6263225">[</span><span class="ident" id="6263226">n</span><span class="op" id="6263227">-</span><span class="num" id="6263228">2</span><span class="op" id="6263229">]</span><span class="op" id="6263230">]</span>&nbsp;<span class="op" id="6263232">&amp;&amp;</span>&nbsp;<span class="ident" id="6263235">knownArch</span><span class="op" id="6263244">[</span><span class="ident" id="6263245">l</span><span class="op" id="6263246">[</span><span class="ident" id="6263247">n</span><span class="op" id="6263248">-</span><span class="num" id="6263249">1</span><span class="op" id="6263250">]</span><span class="op" id="6263251">]</span>&nbsp;<span class="op" id="6263253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263257">if</span>&nbsp;<span class="ident" id="6263260">allTags</span>&nbsp;<span class="op" id="6263268">!=</span>&nbsp;<span class="ident" id="6263271">nil</span>&nbsp;<span class="op" id="6263275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263280">allTags</span><span class="op" id="6263287">[</span><span class="ident" id="6263288">l</span><span class="op" id="6263289">[</span><span class="ident" id="6263290">n</span><span class="op" id="6263291">-</span><span class="num" id="6263292">2</span><span class="op" id="6263293">]</span><span class="op" id="6263294">]</span>&nbsp;<span class="op" id="6263296">=</span>&nbsp;<span class="builtintype" id="6263298">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263306">allTags</span><span class="op" id="6263313">[</span><span class="ident" id="6263314">l</span><span class="op" id="6263315">[</span><span class="ident" id="6263316">n</span><span class="op" id="6263317">-</span><span class="num" id="6263318">1</span><span class="op" id="6263319">]</span><span class="op" id="6263320">]</span>&nbsp;<span class="op" id="6263322">=</span>&nbsp;<span class="builtintype" id="6263324">true</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263335">if</span>&nbsp;<span class="ident" id="6263338">l</span><span class="op" id="6263339">[</span><span class="ident" id="6263340">n</span><span class="op" id="6263341">-</span><span class="num" id="6263342">1</span><span class="op" id="6263343">]</span>&nbsp;<span class="op" id="6263345">!=</span>&nbsp;<span class="ident" id="6263348">ctxt</span><span class="op" id="6263352">.</span><span class="ident" id="6263353">GOARCH</span>&nbsp;<span class="op" id="6263360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263365">return</span>&nbsp;<span class="builtintype" id="6263372">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263384">if</span>&nbsp;<span class="ident" id="6263387">ctxt</span><span class="op" id="6263391">.</span><span class="ident" id="6263392">GOOS</span>&nbsp;<span class="op" id="6263397">==</span>&nbsp;<span class="string" id="6263400">&#34;android&#34;</span>&nbsp;<span class="op" id="6263410">&amp;&amp;</span>&nbsp;<span class="ident" id="6263413">l</span><span class="op" id="6263414">[</span><span class="ident" id="6263415">n</span><span class="op" id="6263416">-</span><span class="num" id="6263417">2</span><span class="op" id="6263418">]</span>&nbsp;<span class="op" id="6263420">==</span>&nbsp;<span class="string" id="6263423">&#34;linux&#34;</span>&nbsp;<span class="op" id="6263431">{</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263436">return</span>&nbsp;<span class="builtintype" id="6263443">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263454">return</span>&nbsp;<span class="ident" id="6263461">l</span><span class="op" id="6263462">[</span><span class="ident" id="6263463">n</span><span class="op" id="6263464">-</span><span class="num" id="6263465">2</span><span class="op" id="6263466">]</span>&nbsp;<span class="op" id="6263468">==</span>&nbsp;<span class="ident" id="6263471">ctxt</span><span class="op" id="6263475">.</span><span class="ident" id="6263476">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263485">if</span>&nbsp;<span class="ident" id="6263488">n</span>&nbsp;<span class="op" id="6263490">&gt;=</span>&nbsp;<span class="num" id="6263493">1</span>&nbsp;<span class="op" id="6263495">&amp;&amp;</span>&nbsp;<span class="ident" id="6263498">knownOS</span><span class="op" id="6263505">[</span><span class="ident" id="6263506">l</span><span class="op" id="6263507">[</span><span class="ident" id="6263508">n</span><span class="op" id="6263509">-</span><span class="num" id="6263510">1</span><span class="op" id="6263511">]</span><span class="op" id="6263512">]</span>&nbsp;<span class="op" id="6263514">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263518">if</span>&nbsp;<span class="ident" id="6263521">allTags</span>&nbsp;<span class="op" id="6263529">!=</span>&nbsp;<span class="ident" id="6263532">nil</span>&nbsp;<span class="op" id="6263536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263541">allTags</span><span class="op" id="6263548">[</span><span class="ident" id="6263549">l</span><span class="op" id="6263550">[</span><span class="ident" id="6263551">n</span><span class="op" id="6263552">-</span><span class="num" id="6263553">1</span><span class="op" id="6263554">]</span><span class="op" id="6263555">]</span>&nbsp;<span class="op" id="6263557">=</span>&nbsp;<span class="builtintype" id="6263559">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263570">if</span>&nbsp;<span class="ident" id="6263573">ctxt</span><span class="op" id="6263577">.</span><span class="ident" id="6263578">GOOS</span>&nbsp;<span class="op" id="6263583">==</span>&nbsp;<span class="string" id="6263586">&#34;android&#34;</span>&nbsp;<span class="op" id="6263596">&amp;&amp;</span>&nbsp;<span class="ident" id="6263599">l</span><span class="op" id="6263600">[</span><span class="ident" id="6263601">n</span><span class="op" id="6263602">-</span><span class="num" id="6263603">1</span><span class="op" id="6263604">]</span>&nbsp;<span class="op" id="6263606">==</span>&nbsp;<span class="string" id="6263609">&#34;linux&#34;</span>&nbsp;<span class="op" id="6263617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263622">return</span>&nbsp;<span class="builtintype" id="6263629">true</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263640">return</span>&nbsp;<span class="ident" id="6263647">l</span><span class="op" id="6263648">[</span><span class="ident" id="6263649">n</span><span class="op" id="6263650">-</span><span class="num" id="6263651">1</span><span class="op" id="6263652">]</span>&nbsp;<span class="op" id="6263654">==</span>&nbsp;<span class="ident" id="6263657">ctxt</span><span class="op" id="6263661">.</span><span class="ident" id="6263662">GOOS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263671">if</span>&nbsp;<span class="ident" id="6263674">n</span>&nbsp;<span class="op" id="6263676">&gt;=</span>&nbsp;<span class="num" id="6263679">1</span>&nbsp;<span class="op" id="6263681">&amp;&amp;</span>&nbsp;<span class="ident" id="6263684">knownArch</span><span class="op" id="6263693">[</span><span class="ident" id="6263694">l</span><span class="op" id="6263695">[</span><span class="ident" id="6263696">n</span><span class="op" id="6263697">-</span><span class="num" id="6263698">1</span><span class="op" id="6263699">]</span><span class="op" id="6263700">]</span>&nbsp;<span class="op" id="6263702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263706">if</span>&nbsp;<span class="ident" id="6263709">allTags</span>&nbsp;<span class="op" id="6263717">!=</span>&nbsp;<span class="ident" id="6263720">nil</span>&nbsp;<span class="op" id="6263724">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263729">allTags</span><span class="op" id="6263736">[</span><span class="ident" id="6263737">l</span><span class="op" id="6263738">[</span><span class="ident" id="6263739">n</span><span class="op" id="6263740">-</span><span class="num" id="6263741">1</span><span class="op" id="6263742">]</span><span class="op" id="6263743">]</span>&nbsp;<span class="op" id="6263745">=</span>&nbsp;<span class="builtintype" id="6263747">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263758">return</span>&nbsp;<span class="ident" id="6263765">l</span><span class="op" id="6263766">[</span><span class="ident" id="6263767">n</span><span class="op" id="6263768">-</span><span class="num" id="6263769">1</span><span class="op" id="6263770">]</span>&nbsp;<span class="op" id="6263772">==</span>&nbsp;<span class="ident" id="6263775">ctxt</span><span class="op" id="6263779">.</span><span class="ident" id="6263780">GOARCH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263791">return</span>&nbsp;<span class="builtintype" id="6263798">true</span><br>
<span class="lineno">1355</span><span class="op" id="6263803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6263806">var</span>&nbsp;<span class="ident" id="6263810">knownOS</span>&nbsp;<span class="op" id="6263818">=</span>&nbsp;<span class="builtinfunc" id="6263820">make</span><span class="op" id="6263824">(</span><span class="keyword" id="6263825">map</span><span class="op" id="6263828">[</span><span class="builtintype" id="6263829">string</span><span class="op" id="6263835">]</span><span class="builtintype" id="6263836">bool</span><span class="op" id="6263840">)</span><br>
<span class="lineno"></span><span class="keyword" id="6263842">var</span>&nbsp;<span class="ident" id="6263846">knownArch</span>&nbsp;<span class="op" id="6263856">=</span>&nbsp;<span class="builtinfunc" id="6263858">make</span><span class="op" id="6263862">(</span><span class="keyword" id="6263863">map</span><span class="op" id="6263866">[</span><span class="builtintype" id="6263867">string</span><span class="op" id="6263873">]</span><span class="builtintype" id="6263874">bool</span><span class="op" id="6263878">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span><span class="keyword" id="6263881">func</span>&nbsp;<span class="ident" id="6263886">init</span><span class="op" id="6263890">(</span><span class="op" id="6263891">)</span>&nbsp;<span class="op" id="6263893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263896">for</span>&nbsp;<span class="ident" id="6263900">_</span><span class="op" id="6263901">,</span>&nbsp;<span class="ident" id="6263903">v</span>&nbsp;<span class="op" id="6263905">:=</span>&nbsp;<span class="keyword" id="6263908">range</span>&nbsp;<span class="ident" id="6263914">strings</span><span class="op" id="6263921">.</span><span class="ident" id="6263922">Fields</span><span class="op" id="6263928">(</span><span class="ident" id="6263929">goosList</span><span class="op" id="6263937">)</span>&nbsp;<span class="op" id="6263939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6263943">knownOS</span><span class="op" id="6263950">[</span><span class="ident" id="6263951">v</span><span class="op" id="6263952">]</span>&nbsp;<span class="op" id="6263954">=</span>&nbsp;<span class="builtintype" id="6263956">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6263962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6263965">for</span>&nbsp;<span class="ident" id="6263969">_</span><span class="op" id="6263970">,</span>&nbsp;<span class="ident" id="6263972">v</span>&nbsp;<span class="op" id="6263974">:=</span>&nbsp;<span class="keyword" id="6263977">range</span>&nbsp;<span class="ident" id="6263983">strings</span><span class="op" id="6263990">.</span><span class="ident" id="6263991">Fields</span><span class="op" id="6263997">(</span><span class="ident" id="6263998">goarchList</span><span class="op" id="6264008">)</span>&nbsp;<span class="op" id="6264010">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6264014">knownArch</span><span class="op" id="6264023">[</span><span class="ident" id="6264024">v</span><span class="op" id="6264025">]</span>&nbsp;<span class="op" id="6264027">=</span>&nbsp;<span class="builtintype" id="6264029">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6264035">}</span><br>
<span class="lineno"></span><span class="op" id="6264037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6264040">//&nbsp;ToolDir&nbsp;is&nbsp;the&nbsp;directory&nbsp;containing&nbsp;build&nbsp;tools.</span><br>
<span class="lineno">1370</span><span class="keyword" id="6264092">var</span>&nbsp;<span class="ident" id="6264096">ToolDir</span>&nbsp;<span class="op" id="6264104">=</span>&nbsp;<span class="ident" id="6264106">filepath</span><span class="op" id="6264114">.</span><span class="ident" id="6264115">Join</span><span class="op" id="6264119">(</span><span class="ident" id="6264120">runtime</span><span class="op" id="6264127">.</span><span class="ident" id="6264128">GOROOT</span><span class="op" id="6264134">(</span><span class="op" id="6264135">)</span><span class="op" id="6264136">,</span>&nbsp;<span class="string" id="6264138">&#34;pkg/tool/&#34;</span><span class="op" id="6264149">+</span><span class="ident" id="6264150">runtime</span><span class="op" id="6264157">.</span><span class="ident" id="6264158">GOOS</span><span class="op" id="6264162">+</span><span class="string" id="6264163">&#34;_&#34;</span><span class="op" id="6264166">+</span><span class="ident" id="6264167">runtime</span><span class="op" id="6264174">.</span><span class="ident" id="6264175">GOARCH</span><span class="op" id="6264181">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6264184">//&nbsp;IsLocalImport&nbsp;reports&nbsp;whether&nbsp;the&nbsp;import&nbsp;path&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="6264236">//&nbsp;a&nbsp;local&nbsp;import&nbsp;path,&nbsp;like&nbsp;&#34;.&#34;,&nbsp;&#34;..&#34;,&nbsp;&#34;./foo&#34;,&nbsp;or&nbsp;&#34;../foo&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="6264298">func</span>&nbsp;<span class="ident" id="6264303">IsLocalImport</span><span class="op" id="6264316">(</span><span class="ident" id="6264317">path</span>&nbsp;<span class="builtintype" id="6264322">string</span><span class="op" id="6264328">)</span>&nbsp;<span class="builtintype" id="6264330">bool</span>&nbsp;<span class="op" id="6264335">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264338">return</span>&nbsp;<span class="ident" id="6264345">path</span>&nbsp;<span class="op" id="6264350">==</span>&nbsp;<span class="string" id="6264353">&#34;.&#34;</span>&nbsp;<span class="op" id="6264357">||</span>&nbsp;<span class="ident" id="6264360">path</span>&nbsp;<span class="op" id="6264365">==</span>&nbsp;<span class="string" id="6264368">&#34;..&#34;</span>&nbsp;<span class="op" id="6264373">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6264378">strings</span><span class="op" id="6264385">.</span><span class="ident" id="6264386">HasPrefix</span><span class="op" id="6264395">(</span><span class="ident" id="6264396">path</span><span class="op" id="6264400">,</span>&nbsp;<span class="string" id="6264402">&#34;./&#34;</span><span class="op" id="6264406">)</span>&nbsp;<span class="op" id="6264408">||</span>&nbsp;<span class="ident" id="6264411">strings</span><span class="op" id="6264418">.</span><span class="ident" id="6264419">HasPrefix</span><span class="op" id="6264428">(</span><span class="ident" id="6264429">path</span><span class="op" id="6264433">,</span>&nbsp;<span class="string" id="6264435">&#34;../&#34;</span><span class="op" id="6264440">)</span><br>
<span class="lineno"></span><span class="op" id="6264442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6264445">//&nbsp;ArchChar&nbsp;returns&nbsp;the&nbsp;architecture&nbsp;character&nbsp;for&nbsp;the&nbsp;given&nbsp;goarch.</span><br>
<span class="lineno">1380</span><span class="comment" id="6264514">//&nbsp;For&nbsp;example,&nbsp;ArchChar(&#34;amd64&#34;)&nbsp;returns&nbsp;&#34;6&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="6264561">func</span>&nbsp;<span class="ident" id="6264566">ArchChar</span><span class="op" id="6264574">(</span><span class="ident" id="6264575">goarch</span>&nbsp;<span class="builtintype" id="6264582">string</span><span class="op" id="6264588">)</span>&nbsp;<span class="op" id="6264590">(</span><span class="builtintype" id="6264591">string</span><span class="op" id="6264597">,</span>&nbsp;<span class="builtintype" id="6264599">error</span><span class="op" id="6264604">)</span>&nbsp;<span class="op" id="6264606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264609">switch</span>&nbsp;<span class="ident" id="6264616">goarch</span>&nbsp;<span class="op" id="6264623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264626">case</span>&nbsp;<span class="string" id="6264631">&#34;386&#34;</span><span class="op" id="6264636">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264640">return</span>&nbsp;<span class="string" id="6264647">&#34;8&#34;</span><span class="op" id="6264650">,</span>&nbsp;<span class="ident" id="6264652">nil</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264657">case</span>&nbsp;<span class="string" id="6264662">&#34;amd64&#34;</span><span class="op" id="6264669">,</span>&nbsp;<span class="string" id="6264671">&#34;amd64p32&#34;</span><span class="op" id="6264681">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264685">return</span>&nbsp;<span class="string" id="6264692">&#34;6&#34;</span><span class="op" id="6264695">,</span>&nbsp;<span class="ident" id="6264697">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264702">case</span>&nbsp;<span class="string" id="6264707">&#34;arm&#34;</span><span class="op" id="6264712">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264716">return</span>&nbsp;<span class="string" id="6264723">&#34;5&#34;</span><span class="op" id="6264726">,</span>&nbsp;<span class="ident" id="6264728">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6264733">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6264736">return</span>&nbsp;<span class="string" id="6264743">&#34;&#34;</span><span class="op" id="6264745">,</span>&nbsp;<span class="ident" id="6264747">errors</span><span class="op" id="6264753">.</span><span class="ident" id="6264754">New</span><span class="op" id="6264757">(</span><span class="string" id="6264758">&#34;unsupported&nbsp;GOARCH&nbsp;&#34;</span>&nbsp;<span class="op" id="6264780">+</span>&nbsp;<span class="ident" id="6264782">goarch</span><span class="op" id="6264788">)</span><br>
<span class="lineno"></span><span class="op" id="6264790">}</span>
</div>
</body>
</html>
