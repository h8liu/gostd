<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html" class="current">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2505117">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2505172">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2505226">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2505277">package</span>&nbsp;<span class="ident" id="2505285">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2505289">import</span>&nbsp;<span class="op" id="2505296">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2505299">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2505310">&#34;time&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2505317">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2505320">func</span>&nbsp;<span class="ident" id="2505325">sameFile</span><span class="op" id="2505333">(</span><span class="ident" id="2505334">fs1</span><span class="op" id="2505337">,</span>&nbsp;<span class="ident" id="2505339">fs2</span>&nbsp;<span class="op" id="2505343">*</span><span class="ident" id="2505344">fileStat</span><span class="op" id="2505352">)</span>&nbsp;<span class="builtintype" id="2505354">bool</span>&nbsp;<span class="op" id="2505359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505362">stat1</span>&nbsp;<span class="op" id="2505368">:=</span>&nbsp;<span class="ident" id="2505371">fs1</span><span class="op" id="2505374">.</span><span class="ident" id="2505375">sys</span><span class="op" id="2505378">.</span><span class="op" id="2505379">(</span><span class="op" id="2505380">*</span><span class="ident" id="2505381">syscall</span><span class="op" id="2505388">.</span><span class="ident" id="2505389">Stat_t</span><span class="op" id="2505395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505398">stat2</span>&nbsp;<span class="op" id="2505404">:=</span>&nbsp;<span class="ident" id="2505407">fs2</span><span class="op" id="2505410">.</span><span class="ident" id="2505411">sys</span><span class="op" id="2505414">.</span><span class="op" id="2505415">(</span><span class="op" id="2505416">*</span><span class="ident" id="2505417">syscall</span><span class="op" id="2505424">.</span><span class="ident" id="2505425">Stat_t</span><span class="op" id="2505431">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505434">return</span>&nbsp;<span class="ident" id="2505441">stat1</span><span class="op" id="2505446">.</span><span class="ident" id="2505447">Dev</span>&nbsp;<span class="op" id="2505451">==</span>&nbsp;<span class="ident" id="2505454">stat2</span><span class="op" id="2505459">.</span><span class="ident" id="2505460">Dev</span>&nbsp;<span class="op" id="2505464">&amp;&amp;</span>&nbsp;<span class="ident" id="2505467">stat1</span><span class="op" id="2505472">.</span><span class="ident" id="2505473">Ino</span>&nbsp;<span class="op" id="2505477">==</span>&nbsp;<span class="ident" id="2505480">stat2</span><span class="op" id="2505485">.</span><span class="ident" id="2505486">Ino</span><br>
<span class="lineno"></span><span class="op" id="2505490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2505493">func</span>&nbsp;<span class="ident" id="2505498">fileInfoFromStat</span><span class="op" id="2505514">(</span><span class="ident" id="2505515">st</span>&nbsp;<span class="op" id="2505518">*</span><span class="ident" id="2505519">syscall</span><span class="op" id="2505526">.</span><span class="ident" id="2505527">Stat_t</span><span class="op" id="2505533">,</span>&nbsp;<span class="ident" id="2505535">name</span>&nbsp;<span class="builtintype" id="2505540">string</span><span class="op" id="2505546">)</span>&nbsp;<span class="ident" id="2505548">FileInfo</span>&nbsp;<span class="op" id="2505557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505560">fs</span>&nbsp;<span class="op" id="2505563">:=</span>&nbsp;<span class="op" id="2505566">&amp;</span><span class="ident" id="2505567">fileStat</span><span class="op" id="2505575">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505579">name</span><span class="op" id="2505583">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505588">basename</span><span class="op" id="2505596">(</span><span class="ident" id="2505597">name</span><span class="op" id="2505601">)</span><span class="op" id="2505602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505606">size</span><span class="op" id="2505610">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2505615">int64</span><span class="op" id="2505620">(</span><span class="ident" id="2505621">st</span><span class="op" id="2505623">.</span><span class="ident" id="2505624">Size</span><span class="op" id="2505628">)</span><span class="op" id="2505629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505633">modTime</span><span class="op" id="2505640">:</span>&nbsp;<span class="ident" id="2505642">timespecToTime</span><span class="op" id="2505656">(</span><span class="ident" id="2505657">st</span><span class="op" id="2505659">.</span><span class="ident" id="2505660">Mtim</span><span class="op" id="2505664">)</span><span class="op" id="2505665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505669">sys</span><span class="op" id="2505672">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505678">st</span><span class="op" id="2505680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2505683">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505686">fs</span><span class="op" id="2505688">.</span><span class="ident" id="2505689">mode</span>&nbsp;<span class="op" id="2505694">=</span>&nbsp;<span class="ident" id="2505696">FileMode</span><span class="op" id="2505704">(</span><span class="ident" id="2505705">st</span><span class="op" id="2505707">.</span><span class="ident" id="2505708">Mode</span>&nbsp;<span class="op" id="2505713">&amp;</span>&nbsp;<span class="num" id="2505715">0777</span><span class="op" id="2505719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505722">switch</span>&nbsp;<span class="ident" id="2505729">st</span><span class="op" id="2505731">.</span><span class="ident" id="2505732">Mode</span>&nbsp;<span class="op" id="2505737">&amp;</span>&nbsp;<span class="ident" id="2505739">syscall</span><span class="op" id="2505746">.</span><span class="ident" id="2505747">S_IFMT</span>&nbsp;<span class="op" id="2505754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505757">case</span>&nbsp;<span class="ident" id="2505762">syscall</span><span class="op" id="2505769">.</span><span class="ident" id="2505770">S_IFBLK</span><span class="op" id="2505777">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505781">fs</span><span class="op" id="2505783">.</span><span class="ident" id="2505784">mode</span>&nbsp;<span class="op" id="2505789">|=</span>&nbsp;<span class="ident" id="2505792">ModeDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505804">case</span>&nbsp;<span class="ident" id="2505809">syscall</span><span class="op" id="2505816">.</span><span class="ident" id="2505817">S_IFCHR</span><span class="op" id="2505824">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505828">fs</span><span class="op" id="2505830">.</span><span class="ident" id="2505831">mode</span>&nbsp;<span class="op" id="2505836">|=</span>&nbsp;<span class="ident" id="2505839">ModeDevice</span>&nbsp;<span class="op" id="2505850">|</span>&nbsp;<span class="ident" id="2505852">ModeCharDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505868">case</span>&nbsp;<span class="ident" id="2505873">syscall</span><span class="op" id="2505880">.</span><span class="ident" id="2505881">S_IFDIR</span><span class="op" id="2505888">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505892">fs</span><span class="op" id="2505894">.</span><span class="ident" id="2505895">mode</span>&nbsp;<span class="op" id="2505900">|=</span>&nbsp;<span class="ident" id="2505903">ModeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505912">case</span>&nbsp;<span class="ident" id="2505917">syscall</span><span class="op" id="2505924">.</span><span class="ident" id="2505925">S_IFIFO</span><span class="op" id="2505932">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505936">fs</span><span class="op" id="2505938">.</span><span class="ident" id="2505939">mode</span>&nbsp;<span class="op" id="2505944">|=</span>&nbsp;<span class="ident" id="2505947">ModeNamedPipe</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505962">case</span>&nbsp;<span class="ident" id="2505967">syscall</span><span class="op" id="2505974">.</span><span class="ident" id="2505975">S_IFLNK</span><span class="op" id="2505982">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505986">fs</span><span class="op" id="2505988">.</span><span class="ident" id="2505989">mode</span>&nbsp;<span class="op" id="2505994">|=</span>&nbsp;<span class="ident" id="2505997">ModeSymlink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506010">case</span>&nbsp;<span class="ident" id="2506015">syscall</span><span class="op" id="2506022">.</span><span class="ident" id="2506023">S_IFREG</span><span class="op" id="2506030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2506034">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506052">case</span>&nbsp;<span class="ident" id="2506057">syscall</span><span class="op" id="2506064">.</span><span class="ident" id="2506065">S_IFSOCK</span><span class="op" id="2506073">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506077">fs</span><span class="op" id="2506079">.</span><span class="ident" id="2506080">mode</span>&nbsp;<span class="op" id="2506085">|=</span>&nbsp;<span class="ident" id="2506088">ModeSocket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506103">if</span>&nbsp;<span class="ident" id="2506106">st</span><span class="op" id="2506108">.</span><span class="ident" id="2506109">Mode</span><span class="op" id="2506113">&amp;</span><span class="ident" id="2506114">syscall</span><span class="op" id="2506121">.</span><span class="ident" id="2506122">S_ISGID</span>&nbsp;<span class="op" id="2506130">!=</span>&nbsp;<span class="num" id="2506133">0</span>&nbsp;<span class="op" id="2506135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506139">fs</span><span class="op" id="2506141">.</span><span class="ident" id="2506142">mode</span>&nbsp;<span class="op" id="2506147">|=</span>&nbsp;<span class="ident" id="2506150">ModeSetgid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506162">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506165">if</span>&nbsp;<span class="ident" id="2506168">st</span><span class="op" id="2506170">.</span><span class="ident" id="2506171">Mode</span><span class="op" id="2506175">&amp;</span><span class="ident" id="2506176">syscall</span><span class="op" id="2506183">.</span><span class="ident" id="2506184">S_ISUID</span>&nbsp;<span class="op" id="2506192">!=</span>&nbsp;<span class="num" id="2506195">0</span>&nbsp;<span class="op" id="2506197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506201">fs</span><span class="op" id="2506203">.</span><span class="ident" id="2506204">mode</span>&nbsp;<span class="op" id="2506209">|=</span>&nbsp;<span class="ident" id="2506212">ModeSetuid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506227">if</span>&nbsp;<span class="ident" id="2506230">st</span><span class="op" id="2506232">.</span><span class="ident" id="2506233">Mode</span><span class="op" id="2506237">&amp;</span><span class="ident" id="2506238">syscall</span><span class="op" id="2506245">.</span><span class="ident" id="2506246">S_ISVTX</span>&nbsp;<span class="op" id="2506254">!=</span>&nbsp;<span class="num" id="2506257">0</span>&nbsp;<span class="op" id="2506259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506263">fs</span><span class="op" id="2506265">.</span><span class="ident" id="2506266">mode</span>&nbsp;<span class="op" id="2506271">|=</span>&nbsp;<span class="ident" id="2506274">ModeSticky</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506289">return</span>&nbsp;<span class="ident" id="2506296">fs</span><br>
<span class="lineno"></span><span class="op" id="2506299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2506302">func</span>&nbsp;<span class="ident" id="2506307">timespecToTime</span><span class="op" id="2506321">(</span><span class="ident" id="2506322">ts</span>&nbsp;<span class="ident" id="2506325">syscall</span><span class="op" id="2506332">.</span><span class="ident" id="2506333">Timespec</span><span class="op" id="2506341">)</span>&nbsp;<span class="ident" id="2506343">time</span><span class="op" id="2506347">.</span><span class="ident" id="2506348">Time</span>&nbsp;<span class="op" id="2506353">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506356">return</span>&nbsp;<span class="ident" id="2506363">time</span><span class="op" id="2506367">.</span><span class="ident" id="2506368">Unix</span><span class="op" id="2506372">(</span><span class="builtintype" id="2506373">int64</span><span class="op" id="2506378">(</span><span class="ident" id="2506379">ts</span><span class="op" id="2506381">.</span><span class="ident" id="2506382">Sec</span><span class="op" id="2506385">)</span><span class="op" id="2506386">,</span>&nbsp;<span class="builtintype" id="2506388">int64</span><span class="op" id="2506393">(</span><span class="ident" id="2506394">ts</span><span class="op" id="2506396">.</span><span class="ident" id="2506397">Nsec</span><span class="op" id="2506401">)</span><span class="op" id="2506402">)</span><br>
<span class="lineno"></span><span class="op" id="2506404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2506407">//&nbsp;For&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="2506423">func</span>&nbsp;<span class="ident" id="2506428">atime</span><span class="op" id="2506433">(</span><span class="ident" id="2506434">fi</span>&nbsp;<span class="ident" id="2506437">FileInfo</span><span class="op" id="2506445">)</span>&nbsp;<span class="ident" id="2506447">time</span><span class="op" id="2506451">.</span><span class="ident" id="2506452">Time</span>&nbsp;<span class="op" id="2506457">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506460">return</span>&nbsp;<span class="ident" id="2506467">timespecToTime</span><span class="op" id="2506481">(</span><span class="ident" id="2506482">fi</span><span class="op" id="2506484">.</span><span class="ident" id="2506485">Sys</span><span class="op" id="2506488">(</span><span class="op" id="2506489">)</span><span class="op" id="2506490">.</span><span class="op" id="2506491">(</span><span class="op" id="2506492">*</span><span class="ident" id="2506493">syscall</span><span class="op" id="2506500">.</span><span class="ident" id="2506501">Stat_t</span><span class="op" id="2506507">)</span><span class="op" id="2506508">.</span><span class="ident" id="2506509">Atim</span><span class="op" id="2506513">)</span><br>
<span class="lineno"></span><span class="op" id="2506515">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
