<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8017298">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8017354">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8017408">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8017459">package</span>&nbsp;<span class="ident" id="8017467">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8017473">import</span>&nbsp;<span class="op" id="8017480">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8017483">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8017492">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8017505">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8017512">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8017523">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8017534">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8017544">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="8017547">//&nbsp;Test&nbsp;values&nbsp;for&nbsp;the&nbsp;stream&nbsp;test.</span><br>
<span class="lineno"></span><span class="comment" id="8017583">//&nbsp;One&nbsp;of&nbsp;each&nbsp;JSON&nbsp;kind.</span><br>
<span class="lineno"></span><span class="keyword" id="8017609">var</span>&nbsp;<span class="ident" id="8017613">streamTest</span>&nbsp;<span class="op" id="8017624">=</span>&nbsp;<span class="op" id="8017626">[</span><span class="op" id="8017627">]</span><span class="keyword" id="8017628">interface</span><span class="op" id="8017637">{</span><span class="op" id="8017638">}</span><span class="op" id="8017639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8017642">0.1</span><span class="op" id="8017645">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8017648">&#34;hello&#34;</span><span class="op" id="8017655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017658">nil</span><span class="op" id="8017661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017664">true</span><span class="op" id="8017668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8017671">false</span><span class="op" id="8017676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8017679">[</span><span class="op" id="8017680">]</span><span class="keyword" id="8017681">interface</span><span class="op" id="8017690">{</span><span class="op" id="8017691">}</span><span class="op" id="8017692">{</span><span class="string" id="8017693">&#34;a&#34;</span><span class="op" id="8017696">,</span>&nbsp;<span class="string" id="8017698">&#34;b&#34;</span><span class="op" id="8017701">,</span>&nbsp;<span class="string" id="8017703">&#34;c&#34;</span><span class="op" id="8017706">}</span><span class="op" id="8017707">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017710">map</span><span class="op" id="8017713">[</span><span class="builtintype" id="8017714">string</span><span class="op" id="8017720">]</span><span class="keyword" id="8017721">interface</span><span class="op" id="8017730">{</span><span class="op" id="8017731">}</span><span class="op" id="8017732">{</span><span class="string" id="8017733">&#34;K&#34;</span><span class="op" id="8017738">:</span>&nbsp;<span class="string" id="8017740">&#34;Kelvin&#34;</span><span class="op" id="8017748">,</span>&nbsp;<span class="string" id="8017750">&#34;ß&#34;</span><span class="op" id="8017754">:</span>&nbsp;<span class="string" id="8017756">&#34;long&nbsp;s&#34;</span><span class="op" id="8017764">}</span><span class="op" id="8017765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8017768">3.14</span><span class="op" id="8017772">,</span>&nbsp;<span class="comment" id="8017774">//&nbsp;another&nbsp;value&nbsp;to&nbsp;make&nbsp;sure&nbsp;something&nbsp;can&nbsp;follow&nbsp;map</span><br>
<span class="lineno"></span><span class="op" id="8017829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8017832">var</span>&nbsp;<span class="ident" id="8017836">streamEncoded</span>&nbsp;<span class="op" id="8017850">=</span>&nbsp;<span class="string" id="8017852">`0.1<br>
<span class="lineno">30</span>&#34;hello&#34;<br>
<span class="lineno"></span>null<br>
<span class="lineno"></span>true<br>
<span class="lineno"></span>false<br>
<span class="lineno"></span>[&#34;a&#34;,&#34;b&#34;,&#34;c&#34;]<br>
<span class="lineno">35</span>{&#34;ß&#34;:&#34;long&nbsp;s&#34;,&#34;K&#34;:&#34;Kelvin&#34;}<br>
<span class="lineno"></span>3.14<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8017934">func</span>&nbsp;<span class="ident" id="8017939">TestEncoder</span><span class="op" id="8017950">(</span><span class="ident" id="8017951">t</span>&nbsp;<span class="op" id="8017953">*</span><span class="ident" id="8017954"><a href="/encoding/json/stream_test.go.html#8017534">testing</a></span><span class="op" id="8017961">.</span><span class="ident" id="8017962">T</span><span class="op" id="8017963">)</span>&nbsp;<span class="op" id="8017965">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8017968">for</span>&nbsp;<span class="ident" id="8017972">i</span>&nbsp;<span class="op" id="8017974">:=</span>&nbsp;<span class="num" id="8017977">0</span><span class="op" id="8017978">;</span>&nbsp;<span class="ident" id="8017980"><a href="/encoding/json/stream_test.go.html#8017972">i</a></span>&nbsp;<span class="op" id="8017982">&lt;=</span>&nbsp;<span class="builtinfunc" id="8017985">len</span><span class="op" id="8017988">(</span><span class="ident" id="8017989"><a href="/encoding/json/stream_test.go.html#8017613">streamTest</a></span><span class="op" id="8017999">)</span><span class="op" id="8018000">;</span>&nbsp;<span class="ident" id="8018002"><a href="/encoding/json/stream_test.go.html#8017972">i</a></span><span class="op" id="8018003">++</span>&nbsp;<span class="op" id="8018006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018010">var</span>&nbsp;<span class="ident" id="8018014">buf</span>&nbsp;<span class="ident" id="8018018"><a href="/encoding/json/stream_test.go.html#8017483">bytes</a></span><span class="op" id="8018023">.</span><span class="ident" id="8018024">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018033">enc</span>&nbsp;<span class="op" id="8018037">:=</span>&nbsp;<span class="ident" id="8018040"><a href="/encoding/json/stream.go.html#3718810">NewEncoder</a></span><span class="op" id="8018050">(</span><span class="op" id="8018051">&amp;</span><span class="ident" id="8018052"><a href="/encoding/json/stream_test.go.html#8018014">buf</a></span><span class="op" id="8018055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018059">for</span>&nbsp;<span class="ident" id="8018063">j</span><span class="op" id="8018064">,</span>&nbsp;<span class="ident" id="8018066">v</span>&nbsp;<span class="op" id="8018068">:=</span>&nbsp;<span class="keyword" id="8018071">range</span>&nbsp;<span class="ident" id="8018077"><a href="/encoding/json/stream_test.go.html#8017613">streamTest</a></span><span class="op" id="8018087">[</span><span class="num" id="8018088">0</span><span class="op" id="8018089">:</span><span class="ident" id="8018090"><a href="/encoding/json/stream_test.go.html#8017972">i</a></span><span class="op" id="8018091">]</span>&nbsp;<span class="op" id="8018093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018098">if</span>&nbsp;<span class="ident" id="8018101">err</span>&nbsp;<span class="op" id="8018105">:=</span>&nbsp;<span class="ident" id="8018108"><a href="/encoding/json/stream_test.go.html#8018033">enc</a></span><span class="op" id="8018111">.</span><span class="ident" id="8018112">Encode</span><span class="op" id="8018118">(</span><span class="ident" id="8018119"><a href="/encoding/json/stream_test.go.html#8018066">v</a></span><span class="op" id="8018120">)</span><span class="op" id="8018121">;</span>&nbsp;<span class="ident" id="8018123"><a href="/encoding/json/stream_test.go.html#8018101">err</a></span>&nbsp;<span class="op" id="8018127">!=</span>&nbsp;<span class="ident" id="8018130">nil</span>&nbsp;<span class="op" id="8018134">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018140"><a href="/encoding/json/stream_test.go.html#8017951">t</a></span><span class="op" id="8018141">.</span><span class="ident" id="8018142">Fatalf</span><span class="op" id="8018148">(</span><span class="string" id="8018149">&#34;encode&nbsp;#%d:&nbsp;%v&#34;</span><span class="op" id="8018165">,</span>&nbsp;<span class="ident" id="8018167"><a href="/encoding/json/stream_test.go.html#8018063">j</a></span><span class="op" id="8018168">,</span>&nbsp;<span class="ident" id="8018170"><a href="/encoding/json/stream_test.go.html#8018101">err</a></span><span class="op" id="8018173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018186">if</span>&nbsp;<span class="ident" id="8018189">have</span><span class="op" id="8018193">,</span>&nbsp;<span class="ident" id="8018195">want</span>&nbsp;<span class="op" id="8018200">:=</span>&nbsp;<span class="ident" id="8018203"><a href="/encoding/json/stream_test.go.html#8018014">buf</a></span><span class="op" id="8018206">.</span><span class="ident" id="8018207">String</span><span class="op" id="8018213">(</span><span class="op" id="8018214">)</span><span class="op" id="8018215">,</span>&nbsp;<span class="ident" id="8018217"><a href="/encoding/json/stream_test.go.html#8019680">nlines</a></span><span class="op" id="8018223">(</span><span class="ident" id="8018224"><a href="/encoding/json/stream_test.go.html#8017836">streamEncoded</a></span><span class="op" id="8018237">,</span>&nbsp;<span class="ident" id="8018239"><a href="/encoding/json/stream_test.go.html#8017972">i</a></span><span class="op" id="8018240">)</span><span class="op" id="8018241">;</span>&nbsp;<span class="ident" id="8018243"><a href="/encoding/json/stream_test.go.html#8018189">have</a></span>&nbsp;<span class="op" id="8018248">!=</span>&nbsp;<span class="ident" id="8018251"><a href="/encoding/json/stream_test.go.html#8018195">want</a></span>&nbsp;<span class="op" id="8018256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018261"><a href="/encoding/json/stream_test.go.html#8017951">t</a></span><span class="op" id="8018262">.</span><span class="ident" id="8018263">Errorf</span><span class="op" id="8018269">(</span><span class="string" id="8018270">&#34;encoding&nbsp;%d&nbsp;items:&nbsp;mismatch&#34;</span><span class="op" id="8018299">,</span>&nbsp;<span class="ident" id="8018301"><a href="/encoding/json/stream_test.go.html#8017972">i</a></span><span class="op" id="8018302">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018307"><a href="/encoding/json/scanner_test.go.html#8015655">diff</a></span><span class="op" id="8018311">(</span><span class="ident" id="8018312"><a href="/encoding/json/stream_test.go.html#8017951">t</a></span><span class="op" id="8018313">,</span>&nbsp;<span class="op" id="8018315">[</span><span class="op" id="8018316">]</span><span class="builtintype" id="8018317">byte</span><span class="op" id="8018321">(</span><span class="ident" id="8018322"><a href="/encoding/json/stream_test.go.html#8018189">have</a></span><span class="op" id="8018326">)</span><span class="op" id="8018327">,</span>&nbsp;<span class="op" id="8018329">[</span><span class="op" id="8018330">]</span><span class="builtintype" id="8018331">byte</span><span class="op" id="8018335">(</span><span class="ident" id="8018336"><a href="/encoding/json/stream_test.go.html#8018195">want</a></span><span class="op" id="8018340">)</span><span class="op" id="8018341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018346">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018357">}</span><br>
<span class="lineno"></span><span class="op" id="8018359">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="8018362">func</span>&nbsp;<span class="ident" id="8018367">TestDecoder</span><span class="op" id="8018378">(</span><span class="ident" id="8018379">t</span>&nbsp;<span class="op" id="8018381">*</span><span class="ident" id="8018382"><a href="/encoding/json/stream_test.go.html#8017534">testing</a></span><span class="op" id="8018389">.</span><span class="ident" id="8018390">T</span><span class="op" id="8018391">)</span>&nbsp;<span class="op" id="8018393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018396">for</span>&nbsp;<span class="ident" id="8018400">i</span>&nbsp;<span class="op" id="8018402">:=</span>&nbsp;<span class="num" id="8018405">0</span><span class="op" id="8018406">;</span>&nbsp;<span class="ident" id="8018408"><a href="/encoding/json/stream_test.go.html#8018400">i</a></span>&nbsp;<span class="op" id="8018410">&lt;=</span>&nbsp;<span class="builtinfunc" id="8018413">len</span><span class="op" id="8018416">(</span><span class="ident" id="8018417"><a href="/encoding/json/stream_test.go.html#8017613">streamTest</a></span><span class="op" id="8018427">)</span><span class="op" id="8018428">;</span>&nbsp;<span class="ident" id="8018430"><a href="/encoding/json/stream_test.go.html#8018400">i</a></span><span class="op" id="8018431">++</span>&nbsp;<span class="op" id="8018434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8018438">//&nbsp;Use&nbsp;stream&nbsp;without&nbsp;newlines&nbsp;as&nbsp;input,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8018481">//&nbsp;just&nbsp;to&nbsp;stress&nbsp;the&nbsp;decoder&nbsp;even&nbsp;more.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8018524">//&nbsp;Our&nbsp;test&nbsp;input&nbsp;does&nbsp;not&nbsp;include&nbsp;back-to-back&nbsp;numbers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8018583">//&nbsp;Otherwise&nbsp;stripping&nbsp;the&nbsp;newlines&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8018627">//&nbsp;merge&nbsp;two&nbsp;adjacent&nbsp;JSON&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018664">var</span>&nbsp;<span class="ident" id="8018668">buf</span>&nbsp;<span class="ident" id="8018672"><a href="/encoding/json/stream_test.go.html#8017483">bytes</a></span><span class="op" id="8018677">.</span><span class="ident" id="8018678">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018687">for</span>&nbsp;<span class="ident" id="8018691">_</span><span class="op" id="8018692">,</span>&nbsp;<span class="ident" id="8018694">c</span>&nbsp;<span class="op" id="8018696">:=</span>&nbsp;<span class="keyword" id="8018699">range</span>&nbsp;<span class="ident" id="8018705"><a href="/encoding/json/stream_test.go.html#8019680">nlines</a></span><span class="op" id="8018711">(</span><span class="ident" id="8018712"><a href="/encoding/json/stream_test.go.html#8017836">streamEncoded</a></span><span class="op" id="8018725">,</span>&nbsp;<span class="ident" id="8018727"><a href="/encoding/json/stream_test.go.html#8018400">i</a></span><span class="op" id="8018728">)</span>&nbsp;<span class="op" id="8018730">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018735">if</span>&nbsp;<span class="ident" id="8018738"><a href="/encoding/json/stream_test.go.html#8018694">c</a></span>&nbsp;<span class="op" id="8018740">!=</span>&nbsp;<span class="string" id="8018743">&#39;\n&#39;</span>&nbsp;<span class="op" id="8018748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018754"><a href="/encoding/json/stream_test.go.html#8018668">buf</a></span><span class="op" id="8018757">.</span><span class="ident" id="8018758">WriteRune</span><span class="op" id="8018767">(</span><span class="ident" id="8018768"><a href="/encoding/json/stream_test.go.html#8018694">c</a></span><span class="op" id="8018769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018782">out</span>&nbsp;<span class="op" id="8018786">:=</span>&nbsp;<span class="builtinfunc" id="8018789">make</span><span class="op" id="8018793">(</span><span class="op" id="8018794">[</span><span class="op" id="8018795">]</span><span class="keyword" id="8018796">interface</span><span class="op" id="8018805">{</span><span class="op" id="8018806">}</span><span class="op" id="8018807">,</span>&nbsp;<span class="ident" id="8018809"><a href="/encoding/json/stream_test.go.html#8018400">i</a></span><span class="op" id="8018810">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018814">dec</span>&nbsp;<span class="op" id="8018818">:=</span>&nbsp;<span class="ident" id="8018821"><a href="/encoding/json/stream.go.html#3715917">NewDecoder</a></span><span class="op" id="8018831">(</span><span class="op" id="8018832">&amp;</span><span class="ident" id="8018833"><a href="/encoding/json/stream_test.go.html#8018668">buf</a></span><span class="op" id="8018836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018840">for</span>&nbsp;<span class="ident" id="8018844">j</span>&nbsp;<span class="op" id="8018846">:=</span>&nbsp;<span class="keyword" id="8018849">range</span>&nbsp;<span class="ident" id="8018855"><a href="/encoding/json/stream_test.go.html#8018782">out</a></span>&nbsp;<span class="op" id="8018859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018864">if</span>&nbsp;<span class="ident" id="8018867">err</span>&nbsp;<span class="op" id="8018871">:=</span>&nbsp;<span class="ident" id="8018874"><a href="/encoding/json/stream_test.go.html#8018814">dec</a></span><span class="op" id="8018877">.</span><span class="ident" id="8018878">Decode</span><span class="op" id="8018884">(</span><span class="op" id="8018885">&amp;</span><span class="ident" id="8018886"><a href="/encoding/json/stream_test.go.html#8018782">out</a></span><span class="op" id="8018889">[</span><span class="ident" id="8018890"><a href="/encoding/json/stream_test.go.html#8018844">j</a></span><span class="op" id="8018891">]</span><span class="op" id="8018892">)</span><span class="op" id="8018893">;</span>&nbsp;<span class="ident" id="8018895"><a href="/encoding/json/stream_test.go.html#8018867">err</a></span>&nbsp;<span class="op" id="8018899">!=</span>&nbsp;<span class="ident" id="8018902">nil</span>&nbsp;<span class="op" id="8018906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8018912"><a href="/encoding/json/stream_test.go.html#8018379">t</a></span><span class="op" id="8018913">.</span><span class="ident" id="8018914">Fatalf</span><span class="op" id="8018920">(</span><span class="string" id="8018921">&#34;decode&nbsp;#%d/%d:&nbsp;%v&#34;</span><span class="op" id="8018940">,</span>&nbsp;<span class="ident" id="8018942"><a href="/encoding/json/stream_test.go.html#8018844">j</a></span><span class="op" id="8018943">,</span>&nbsp;<span class="ident" id="8018945"><a href="/encoding/json/stream_test.go.html#8018400">i</a></span><span class="op" id="8018946">,</span>&nbsp;<span class="ident" id="8018948"><a href="/encoding/json/stream_test.go.html#8018867">err</a></span><span class="op" id="8018951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018956">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8018960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8018964">if</span>&nbsp;<span class="op" id="8018967">!</span><span class="ident" id="8018968"><a href="/encoding/json/stream_test.go.html#8017512">reflect</a></span><span class="op" id="8018975">.</span><span class="ident" id="8018976">DeepEqual</span><span class="op" id="8018985">(</span><span class="ident" id="8018986"><a href="/encoding/json/stream_test.go.html#8018782">out</a></span><span class="op" id="8018989">,</span>&nbsp;<span class="ident" id="8018991"><a href="/encoding/json/stream_test.go.html#8017613">streamTest</a></span><span class="op" id="8019001">[</span><span class="num" id="8019002">0</span><span class="op" id="8019003">:</span><span class="ident" id="8019004"><a href="/encoding/json/stream_test.go.html#8018400">i</a></span><span class="op" id="8019005">]</span><span class="op" id="8019006">)</span>&nbsp;<span class="op" id="8019008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019013"><a href="/encoding/json/stream_test.go.html#8018379">t</a></span><span class="op" id="8019014">.</span><span class="ident" id="8019015">Errorf</span><span class="op" id="8019021">(</span><span class="string" id="8019022">&#34;decoding&nbsp;%d&nbsp;items:&nbsp;mismatch&#34;</span><span class="op" id="8019051">,</span>&nbsp;<span class="ident" id="8019053"><a href="/encoding/json/stream_test.go.html#8018400">i</a></span><span class="op" id="8019054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019059">for</span>&nbsp;<span class="ident" id="8019063">j</span>&nbsp;<span class="op" id="8019065">:=</span>&nbsp;<span class="keyword" id="8019068">range</span>&nbsp;<span class="ident" id="8019074"><a href="/encoding/json/stream_test.go.html#8018782">out</a></span>&nbsp;<span class="op" id="8019078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019084">if</span>&nbsp;<span class="op" id="8019087">!</span><span class="ident" id="8019088"><a href="/encoding/json/stream_test.go.html#8017512">reflect</a></span><span class="op" id="8019095">.</span><span class="ident" id="8019096">DeepEqual</span><span class="op" id="8019105">(</span><span class="ident" id="8019106"><a href="/encoding/json/stream_test.go.html#8018782">out</a></span><span class="op" id="8019109">[</span><span class="ident" id="8019110"><a href="/encoding/json/stream_test.go.html#8019063">j</a></span><span class="op" id="8019111">]</span><span class="op" id="8019112">,</span>&nbsp;<span class="ident" id="8019114"><a href="/encoding/json/stream_test.go.html#8017613">streamTest</a></span><span class="op" id="8019124">[</span><span class="ident" id="8019125"><a href="/encoding/json/stream_test.go.html#8019063">j</a></span><span class="op" id="8019126">]</span><span class="op" id="8019127">)</span>&nbsp;<span class="op" id="8019129">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019136"><a href="/encoding/json/stream_test.go.html#8018379">t</a></span><span class="op" id="8019137">.</span><span class="ident" id="8019138">Errorf</span><span class="op" id="8019144">(</span><span class="string" id="8019145">&#34;#%d:&nbsp;have&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8019167">,</span>&nbsp;<span class="ident" id="8019169"><a href="/encoding/json/stream_test.go.html#8019063">j</a></span><span class="op" id="8019170">,</span>&nbsp;<span class="ident" id="8019172"><a href="/encoding/json/stream_test.go.html#8018782">out</a></span><span class="op" id="8019175">[</span><span class="ident" id="8019176"><a href="/encoding/json/stream_test.go.html#8019063">j</a></span><span class="op" id="8019177">]</span><span class="op" id="8019178">,</span>&nbsp;<span class="ident" id="8019180"><a href="/encoding/json/stream_test.go.html#8017613">streamTest</a></span><span class="op" id="8019190">[</span><span class="ident" id="8019191"><a href="/encoding/json/stream_test.go.html#8019063">j</a></span><span class="op" id="8019192">]</span><span class="op" id="8019193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019209">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019217">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019220">}</span><br>
<span class="lineno"></span><span class="op" id="8019222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8019225">func</span>&nbsp;<span class="ident" id="8019230">TestDecoderBuffered</span><span class="op" id="8019249">(</span><span class="ident" id="8019250">t</span>&nbsp;<span class="op" id="8019252">*</span><span class="ident" id="8019253"><a href="/encoding/json/stream_test.go.html#8017534">testing</a></span><span class="op" id="8019260">.</span><span class="ident" id="8019261">T</span><span class="op" id="8019262">)</span>&nbsp;<span class="op" id="8019264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019267">r</span>&nbsp;<span class="op" id="8019269">:=</span>&nbsp;<span class="ident" id="8019272"><a href="/encoding/json/stream_test.go.html#8017523">strings</a></span><span class="op" id="8019279">.</span><span class="ident" id="8019280">NewReader</span><span class="op" id="8019289">(</span><span class="string" id="8019290">`{&#34;Name&#34;:&nbsp;&#34;Gopher&#34;}&nbsp;extra&nbsp;`</span><span class="op" id="8019317">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019320">var</span>&nbsp;<span class="ident" id="8019324">m</span>&nbsp;<span class="keyword" id="8019326">struct</span>&nbsp;<span class="op" id="8019333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019337">Name</span>&nbsp;<span class="builtintype" id="8019342">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019353">d</span>&nbsp;<span class="op" id="8019355">:=</span>&nbsp;<span class="ident" id="8019358"><a href="/encoding/json/stream.go.html#3715917">NewDecoder</a></span><span class="op" id="8019368">(</span><span class="ident" id="8019369"><a href="/encoding/json/stream_test.go.html#8019267">r</a></span><span class="op" id="8019370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019373">err</span>&nbsp;<span class="op" id="8019377">:=</span>&nbsp;<span class="ident" id="8019380"><a href="/encoding/json/stream_test.go.html#8019353">d</a></span><span class="op" id="8019381">.</span><span class="ident" id="8019382">Decode</span><span class="op" id="8019388">(</span><span class="op" id="8019389">&amp;</span><span class="ident" id="8019390"><a href="/encoding/json/stream_test.go.html#8019324">m</a></span><span class="op" id="8019391">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019394">if</span>&nbsp;<span class="ident" id="8019397"><a href="/encoding/json/stream_test.go.html#8019373">err</a></span>&nbsp;<span class="op" id="8019401">!=</span>&nbsp;<span class="ident" id="8019404">nil</span>&nbsp;<span class="op" id="8019408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019412"><a href="/encoding/json/stream_test.go.html#8019250">t</a></span><span class="op" id="8019413">.</span><span class="ident" id="8019414">Fatal</span><span class="op" id="8019419">(</span><span class="ident" id="8019420"><a href="/encoding/json/stream_test.go.html#8019373">err</a></span><span class="op" id="8019423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019429">if</span>&nbsp;<span class="ident" id="8019432"><a href="/encoding/json/stream_test.go.html#8019324">m</a></span><span class="op" id="8019433">.</span><span class="ident" id="8019434">Name</span>&nbsp;<span class="op" id="8019439">!=</span>&nbsp;<span class="string" id="8019442">&#34;Gopher&#34;</span>&nbsp;<span class="op" id="8019451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019455"><a href="/encoding/json/stream_test.go.html#8019250">t</a></span><span class="op" id="8019456">.</span><span class="ident" id="8019457">Errorf</span><span class="op" id="8019463">(</span><span class="string" id="8019464">&#34;Name&nbsp;=&nbsp;%q;&nbsp;want&nbsp;Gopher&#34;</span><span class="op" id="8019488">,</span>&nbsp;<span class="ident" id="8019490"><a href="/encoding/json/stream_test.go.html#8019324">m</a></span><span class="op" id="8019491">.</span><span class="ident" id="8019492">Name</span><span class="op" id="8019496">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019502">rest</span><span class="op" id="8019506">,</span>&nbsp;<span class="ident" id="8019508"><a href="/encoding/json/stream_test.go.html#8019373">err</a></span>&nbsp;<span class="op" id="8019512">:=</span>&nbsp;<span class="ident" id="8019515"><a href="/encoding/json/stream_test.go.html#8017492">ioutil</a></span><span class="op" id="8019521">.</span><span class="ident" id="8019522">ReadAll</span><span class="op" id="8019529">(</span><span class="ident" id="8019530"><a href="/encoding/json/stream_test.go.html#8019353">d</a></span><span class="op" id="8019531">.</span><span class="ident" id="8019532">Buffered</span><span class="op" id="8019540">(</span><span class="op" id="8019541">)</span><span class="op" id="8019542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019545">if</span>&nbsp;<span class="ident" id="8019548"><a href="/encoding/json/stream_test.go.html#8019373">err</a></span>&nbsp;<span class="op" id="8019552">!=</span>&nbsp;<span class="ident" id="8019555">nil</span>&nbsp;<span class="op" id="8019559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019563"><a href="/encoding/json/stream_test.go.html#8019250">t</a></span><span class="op" id="8019564">.</span><span class="ident" id="8019565">Fatal</span><span class="op" id="8019570">(</span><span class="ident" id="8019571"><a href="/encoding/json/stream_test.go.html#8019373">err</a></span><span class="op" id="8019574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019577">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019580">if</span>&nbsp;<span class="ident" id="8019583">g</span><span class="op" id="8019584">,</span>&nbsp;<span class="ident" id="8019586">w</span>&nbsp;<span class="op" id="8019588">:=</span>&nbsp;<span class="builtintype" id="8019591">string</span><span class="op" id="8019597">(</span><span class="ident" id="8019598"><a href="/encoding/json/stream_test.go.html#8019502">rest</a></span><span class="op" id="8019602">)</span><span class="op" id="8019603">,</span>&nbsp;<span class="string" id="8019605">&#34;&nbsp;extra&nbsp;&#34;</span><span class="op" id="8019614">;</span>&nbsp;<span class="ident" id="8019616"><a href="/encoding/json/stream_test.go.html#8019583">g</a></span>&nbsp;<span class="op" id="8019618">!=</span>&nbsp;<span class="ident" id="8019621"><a href="/encoding/json/stream_test.go.html#8019586">w</a></span>&nbsp;<span class="op" id="8019623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019627"><a href="/encoding/json/stream_test.go.html#8019250">t</a></span><span class="op" id="8019628">.</span><span class="ident" id="8019629">Errorf</span><span class="op" id="8019635">(</span><span class="string" id="8019636">&#34;Remaining&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8019661">,</span>&nbsp;<span class="ident" id="8019663"><a href="/encoding/json/stream_test.go.html#8019583">g</a></span><span class="op" id="8019664">,</span>&nbsp;<span class="ident" id="8019666"><a href="/encoding/json/stream_test.go.html#8019586">w</a></span><span class="op" id="8019667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019670">}</span><br>
<span class="lineno"></span><span class="op" id="8019672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="8019675">func</span>&nbsp;<span class="ident" id="8019680">nlines</span><span class="op" id="8019686">(</span><span class="ident" id="8019687">s</span>&nbsp;<span class="builtintype" id="8019689">string</span><span class="op" id="8019695">,</span>&nbsp;<span class="ident" id="8019697">n</span>&nbsp;<span class="builtintype" id="8019699">int</span><span class="op" id="8019702">)</span>&nbsp;<span class="builtintype" id="8019704">string</span>&nbsp;<span class="op" id="8019711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019714">if</span>&nbsp;<span class="ident" id="8019717"><a href="/encoding/json/stream_test.go.html#8019697">n</a></span>&nbsp;<span class="op" id="8019719">&lt;=</span>&nbsp;<span class="num" id="8019722">0</span>&nbsp;<span class="op" id="8019724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019728">return</span>&nbsp;<span class="string" id="8019735">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019742">for</span>&nbsp;<span class="ident" id="8019746">i</span><span class="op" id="8019747">,</span>&nbsp;<span class="ident" id="8019749">c</span>&nbsp;<span class="op" id="8019751">:=</span>&nbsp;<span class="keyword" id="8019754">range</span>&nbsp;<span class="ident" id="8019760"><a href="/encoding/json/stream_test.go.html#8019687">s</a></span>&nbsp;<span class="op" id="8019762">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019766">if</span>&nbsp;<span class="ident" id="8019769"><a href="/encoding/json/stream_test.go.html#8019749">c</a></span>&nbsp;<span class="op" id="8019771">==</span>&nbsp;<span class="string" id="8019774">&#39;\n&#39;</span>&nbsp;<span class="op" id="8019779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019784">if</span>&nbsp;<span class="ident" id="8019787"><a href="/encoding/json/stream_test.go.html#8019697">n</a></span><span class="op" id="8019788">--</span><span class="op" id="8019790">;</span>&nbsp;<span class="ident" id="8019792"><a href="/encoding/json/stream_test.go.html#8019697">n</a></span>&nbsp;<span class="op" id="8019794">==</span>&nbsp;<span class="num" id="8019797">0</span>&nbsp;<span class="op" id="8019799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019805">return</span>&nbsp;<span class="ident" id="8019812"><a href="/encoding/json/stream_test.go.html#8019687">s</a></span><span class="op" id="8019813">[</span><span class="num" id="8019814">0</span>&nbsp;<span class="op" id="8019816">:</span>&nbsp;<span class="ident" id="8019818"><a href="/encoding/json/stream_test.go.html#8019746">i</a></span><span class="op" id="8019819">+</span><span class="num" id="8019820">1</span><span class="op" id="8019821">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019830">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019836">return</span>&nbsp;<span class="ident" id="8019843"><a href="/encoding/json/stream_test.go.html#8019687">s</a></span><br>
<span class="lineno"></span><span class="op" id="8019845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8019848">func</span>&nbsp;<span class="ident" id="8019853">TestRawMessage</span><span class="op" id="8019867">(</span><span class="ident" id="8019868">t</span>&nbsp;<span class="op" id="8019870">*</span><span class="ident" id="8019871"><a href="/encoding/json/stream_test.go.html#8017534">testing</a></span><span class="op" id="8019878">.</span><span class="ident" id="8019879">T</span><span class="op" id="8019880">)</span>&nbsp;<span class="op" id="8019882">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8019885">//&nbsp;TODO(rsc):&nbsp;Should&nbsp;not&nbsp;need&nbsp;the&nbsp;*&nbsp;in&nbsp;*RawMessage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8019937">var</span>&nbsp;<span class="ident" id="8019941">data</span>&nbsp;<span class="keyword" id="8019946">struct</span>&nbsp;<span class="op" id="8019953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019957">X</span>&nbsp;&nbsp;<span class="builtintype" id="8019960">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019970">Id</span>&nbsp;<span class="op" id="8019973">*</span><span class="ident" id="8019974"><a href="/encoding/json/stream.go.html#3719769">RawMessage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8019987">Y</span>&nbsp;&nbsp;<span class="builtintype" id="8019990">float32</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8019999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020002">const</span>&nbsp;<span class="ident" id="8020008">raw</span>&nbsp;<span class="op" id="8020012">=</span>&nbsp;<span class="string" id="8020014">`[&#34;\u0056&#34;,null]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020033">const</span>&nbsp;<span class="ident" id="8020039">msg</span>&nbsp;<span class="op" id="8020043">=</span>&nbsp;<span class="string" id="8020045">`{&#34;X&#34;:0.1,&#34;Id&#34;:[&#34;\u0056&#34;,null],&#34;Y&#34;:0.2}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020087">err</span>&nbsp;<span class="op" id="8020091">:=</span>&nbsp;<span class="ident" id="8020094"><a href="/encoding/json/decode.go.html#3636951">Unmarshal</a></span><span class="op" id="8020103">(</span><span class="op" id="8020104">[</span><span class="op" id="8020105">]</span><span class="builtintype" id="8020106">byte</span><span class="op" id="8020110">(</span><span class="ident" id="8020111"><a href="/encoding/json/stream_test.go.html#8020039">msg</a></span><span class="op" id="8020114">)</span><span class="op" id="8020115">,</span>&nbsp;<span class="op" id="8020117">&amp;</span><span class="ident" id="8020118"><a href="/encoding/json/stream_test.go.html#8019941">data</a></span><span class="op" id="8020122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020125">if</span>&nbsp;<span class="ident" id="8020128"><a href="/encoding/json/stream_test.go.html#8020087">err</a></span>&nbsp;<span class="op" id="8020132">!=</span>&nbsp;<span class="ident" id="8020135">nil</span>&nbsp;<span class="op" id="8020139">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020143"><a href="/encoding/json/stream_test.go.html#8019868">t</a></span><span class="op" id="8020144">.</span><span class="ident" id="8020145">Fatalf</span><span class="op" id="8020151">(</span><span class="string" id="8020152">&#34;Unmarshal:&nbsp;%v&#34;</span><span class="op" id="8020167">,</span>&nbsp;<span class="ident" id="8020169"><a href="/encoding/json/stream_test.go.html#8020087">err</a></span><span class="op" id="8020172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020178">if</span>&nbsp;<span class="builtintype" id="8020181">string</span><span class="op" id="8020187">(</span><span class="op" id="8020188">[</span><span class="op" id="8020189">]</span><span class="builtintype" id="8020190">byte</span><span class="op" id="8020194">(</span><span class="op" id="8020195">*</span><span class="ident" id="8020196"><a href="/encoding/json/stream_test.go.html#8019941">data</a></span><span class="op" id="8020200">.</span><span class="ident" id="8020201">Id</span><span class="op" id="8020203">)</span><span class="op" id="8020204">)</span>&nbsp;<span class="op" id="8020206">!=</span>&nbsp;<span class="ident" id="8020209"><a href="/encoding/json/stream_test.go.html#8020008">raw</a></span>&nbsp;<span class="op" id="8020213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020217"><a href="/encoding/json/stream_test.go.html#8019868">t</a></span><span class="op" id="8020218">.</span><span class="ident" id="8020219">Fatalf</span><span class="op" id="8020225">(</span><span class="string" id="8020226">&#34;Raw&nbsp;mismatch:&nbsp;have&nbsp;%#q&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="8020259">,</span>&nbsp;<span class="op" id="8020261">[</span><span class="op" id="8020262">]</span><span class="builtintype" id="8020263">byte</span><span class="op" id="8020267">(</span><span class="op" id="8020268">*</span><span class="ident" id="8020269"><a href="/encoding/json/stream_test.go.html#8019941">data</a></span><span class="op" id="8020273">.</span><span class="ident" id="8020274">Id</span><span class="op" id="8020276">)</span><span class="op" id="8020277">,</span>&nbsp;<span class="ident" id="8020279"><a href="/encoding/json/stream_test.go.html#8020008">raw</a></span><span class="op" id="8020282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020285">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020288">b</span><span class="op" id="8020289">,</span>&nbsp;<span class="ident" id="8020291"><a href="/encoding/json/stream_test.go.html#8020087">err</a></span>&nbsp;<span class="op" id="8020295">:=</span>&nbsp;<span class="ident" id="8020298"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="8020305">(</span><span class="op" id="8020306">&amp;</span><span class="ident" id="8020307"><a href="/encoding/json/stream_test.go.html#8019941">data</a></span><span class="op" id="8020311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020314">if</span>&nbsp;<span class="ident" id="8020317"><a href="/encoding/json/stream_test.go.html#8020087">err</a></span>&nbsp;<span class="op" id="8020321">!=</span>&nbsp;<span class="ident" id="8020324">nil</span>&nbsp;<span class="op" id="8020328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020332"><a href="/encoding/json/stream_test.go.html#8019868">t</a></span><span class="op" id="8020333">.</span><span class="ident" id="8020334">Fatalf</span><span class="op" id="8020340">(</span><span class="string" id="8020341">&#34;Marshal:&nbsp;%v&#34;</span><span class="op" id="8020354">,</span>&nbsp;<span class="ident" id="8020356"><a href="/encoding/json/stream_test.go.html#8020087">err</a></span><span class="op" id="8020359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020365">if</span>&nbsp;<span class="builtintype" id="8020368">string</span><span class="op" id="8020374">(</span><span class="ident" id="8020375"><a href="/encoding/json/stream_test.go.html#8020288">b</a></span><span class="op" id="8020376">)</span>&nbsp;<span class="op" id="8020378">!=</span>&nbsp;<span class="ident" id="8020381"><a href="/encoding/json/stream_test.go.html#8020039">msg</a></span>&nbsp;<span class="op" id="8020385">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020389"><a href="/encoding/json/stream_test.go.html#8019868">t</a></span><span class="op" id="8020390">.</span><span class="ident" id="8020391">Fatalf</span><span class="op" id="8020397">(</span><span class="string" id="8020398">&#34;Marshal:&nbsp;have&nbsp;%#q&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="8020426">,</span>&nbsp;<span class="ident" id="8020428"><a href="/encoding/json/stream_test.go.html#8020288">b</a></span><span class="op" id="8020429">,</span>&nbsp;<span class="ident" id="8020431"><a href="/encoding/json/stream_test.go.html#8020039">msg</a></span><span class="op" id="8020434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020437">}</span><br>
<span class="lineno"></span><span class="op" id="8020439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8020442">func</span>&nbsp;<span class="ident" id="8020447">TestNullRawMessage</span><span class="op" id="8020465">(</span><span class="ident" id="8020466">t</span>&nbsp;<span class="op" id="8020468">*</span><span class="ident" id="8020469"><a href="/encoding/json/stream_test.go.html#8017534">testing</a></span><span class="op" id="8020476">.</span><span class="ident" id="8020477">T</span><span class="op" id="8020478">)</span>&nbsp;<span class="op" id="8020480">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8020483">//&nbsp;TODO(rsc):&nbsp;Should&nbsp;not&nbsp;need&nbsp;the&nbsp;*&nbsp;in&nbsp;*RawMessage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020535">var</span>&nbsp;<span class="ident" id="8020539">data</span>&nbsp;<span class="keyword" id="8020544">struct</span>&nbsp;<span class="op" id="8020551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020555">X</span>&nbsp;&nbsp;<span class="builtintype" id="8020558">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020568">Id</span>&nbsp;<span class="op" id="8020571">*</span><span class="ident" id="8020572"><a href="/encoding/json/stream.go.html#3719769">RawMessage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020585">Y</span>&nbsp;&nbsp;<span class="builtintype" id="8020588">float32</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020600"><a href="/encoding/json/stream_test.go.html#8020539">data</a></span><span class="op" id="8020604">.</span><span class="ident" id="8020605">Id</span>&nbsp;<span class="op" id="8020608">=</span>&nbsp;<span class="builtinfunc" id="8020610">new</span><span class="op" id="8020613">(</span><span class="ident" id="8020614"><a href="/encoding/json/stream.go.html#3719769">RawMessage</a></span><span class="op" id="8020624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020627">const</span>&nbsp;<span class="ident" id="8020633">msg</span>&nbsp;<span class="op" id="8020637">=</span>&nbsp;<span class="string" id="8020639">`{&#34;X&#34;:0.1,&#34;Id&#34;:null,&#34;Y&#34;:0.2}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020670">err</span>&nbsp;<span class="op" id="8020674">:=</span>&nbsp;<span class="ident" id="8020677"><a href="/encoding/json/decode.go.html#3636951">Unmarshal</a></span><span class="op" id="8020686">(</span><span class="op" id="8020687">[</span><span class="op" id="8020688">]</span><span class="builtintype" id="8020689">byte</span><span class="op" id="8020693">(</span><span class="ident" id="8020694"><a href="/encoding/json/stream_test.go.html#8020633">msg</a></span><span class="op" id="8020697">)</span><span class="op" id="8020698">,</span>&nbsp;<span class="op" id="8020700">&amp;</span><span class="ident" id="8020701"><a href="/encoding/json/stream_test.go.html#8020539">data</a></span><span class="op" id="8020705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020708">if</span>&nbsp;<span class="ident" id="8020711"><a href="/encoding/json/stream_test.go.html#8020670">err</a></span>&nbsp;<span class="op" id="8020715">!=</span>&nbsp;<span class="ident" id="8020718">nil</span>&nbsp;<span class="op" id="8020722">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020726"><a href="/encoding/json/stream_test.go.html#8020466">t</a></span><span class="op" id="8020727">.</span><span class="ident" id="8020728">Fatalf</span><span class="op" id="8020734">(</span><span class="string" id="8020735">&#34;Unmarshal:&nbsp;%v&#34;</span><span class="op" id="8020750">,</span>&nbsp;<span class="ident" id="8020752"><a href="/encoding/json/stream_test.go.html#8020670">err</a></span><span class="op" id="8020755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020761">if</span>&nbsp;<span class="ident" id="8020764"><a href="/encoding/json/stream_test.go.html#8020539">data</a></span><span class="op" id="8020768">.</span><span class="ident" id="8020769">Id</span>&nbsp;<span class="op" id="8020772">!=</span>&nbsp;<span class="ident" id="8020775">nil</span>&nbsp;<span class="op" id="8020779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020783"><a href="/encoding/json/stream_test.go.html#8020466">t</a></span><span class="op" id="8020784">.</span><span class="ident" id="8020785">Fatalf</span><span class="op" id="8020791">(</span><span class="string" id="8020792">&#34;Raw&nbsp;mismatch:&nbsp;have&nbsp;non-nil,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="8020830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020833">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020836">b</span><span class="op" id="8020837">,</span>&nbsp;<span class="ident" id="8020839"><a href="/encoding/json/stream_test.go.html#8020670">err</a></span>&nbsp;<span class="op" id="8020843">:=</span>&nbsp;<span class="ident" id="8020846"><a href="/encoding/json/encode.go.html#3666502">Marshal</a></span><span class="op" id="8020853">(</span><span class="op" id="8020854">&amp;</span><span class="ident" id="8020855"><a href="/encoding/json/stream_test.go.html#8020539">data</a></span><span class="op" id="8020859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020862">if</span>&nbsp;<span class="ident" id="8020865"><a href="/encoding/json/stream_test.go.html#8020670">err</a></span>&nbsp;<span class="op" id="8020869">!=</span>&nbsp;<span class="ident" id="8020872">nil</span>&nbsp;<span class="op" id="8020876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020880"><a href="/encoding/json/stream_test.go.html#8020466">t</a></span><span class="op" id="8020881">.</span><span class="ident" id="8020882">Fatalf</span><span class="op" id="8020888">(</span><span class="string" id="8020889">&#34;Marshal:&nbsp;%v&#34;</span><span class="op" id="8020902">,</span>&nbsp;<span class="ident" id="8020904"><a href="/encoding/json/stream_test.go.html#8020670">err</a></span><span class="op" id="8020907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8020913">if</span>&nbsp;<span class="builtintype" id="8020916">string</span><span class="op" id="8020922">(</span><span class="ident" id="8020923"><a href="/encoding/json/stream_test.go.html#8020836">b</a></span><span class="op" id="8020924">)</span>&nbsp;<span class="op" id="8020926">!=</span>&nbsp;<span class="ident" id="8020929"><a href="/encoding/json/stream_test.go.html#8020633">msg</a></span>&nbsp;<span class="op" id="8020933">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8020937"><a href="/encoding/json/stream_test.go.html#8020466">t</a></span><span class="op" id="8020938">.</span><span class="ident" id="8020939">Fatalf</span><span class="op" id="8020945">(</span><span class="string" id="8020946">&#34;Marshal:&nbsp;have&nbsp;%#q&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="8020974">,</span>&nbsp;<span class="ident" id="8020976"><a href="/encoding/json/stream_test.go.html#8020836">b</a></span><span class="op" id="8020977">,</span>&nbsp;<span class="ident" id="8020979"><a href="/encoding/json/stream_test.go.html#8020633">msg</a></span><span class="op" id="8020982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8020985">}</span><br>
<span class="lineno"></span><span class="op" id="8020987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8020990">var</span>&nbsp;<span class="ident" id="8020994">blockingTests</span>&nbsp;<span class="op" id="8021008">=</span>&nbsp;<span class="op" id="8021010">[</span><span class="op" id="8021011">]</span><span class="builtintype" id="8021012">string</span><span class="op" id="8021018">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021021">`{&#34;x&#34;:&nbsp;1}`</span><span class="op" id="8021031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8021034">`[1,&nbsp;2,&nbsp;3]`</span><span class="op" id="8021045">,</span><br>
<span class="lineno"></span><span class="op" id="8021047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8021050">func</span>&nbsp;<span class="ident" id="8021055">TestBlocking</span><span class="op" id="8021067">(</span><span class="ident" id="8021068">t</span>&nbsp;<span class="op" id="8021070">*</span><span class="ident" id="8021071"><a href="/encoding/json/stream_test.go.html#8017534">testing</a></span><span class="op" id="8021078">.</span><span class="ident" id="8021079">T</span><span class="op" id="8021080">)</span>&nbsp;<span class="op" id="8021082">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021085">for</span>&nbsp;<span class="ident" id="8021089">_</span><span class="op" id="8021090">,</span>&nbsp;<span class="ident" id="8021092">enc</span>&nbsp;<span class="op" id="8021096">:=</span>&nbsp;<span class="keyword" id="8021099">range</span>&nbsp;<span class="ident" id="8021105"><a href="/encoding/json/stream_test.go.html#8020994">blockingTests</a></span>&nbsp;<span class="op" id="8021119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021123">r</span><span class="op" id="8021124">,</span>&nbsp;<span class="ident" id="8021126">w</span>&nbsp;<span class="op" id="8021128">:=</span>&nbsp;<span class="ident" id="8021131"><a href="/encoding/json/stream_test.go.html#8017505">net</a></span><span class="op" id="8021134">.</span><span class="ident" id="8021135">Pipe</span><span class="op" id="8021139">(</span><span class="op" id="8021140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021144">go</span>&nbsp;<span class="ident" id="8021147"><a href="/encoding/json/stream_test.go.html#8021126">w</a></span><span class="op" id="8021148">.</span><span class="ident" id="8021149">Write</span><span class="op" id="8021154">(</span><span class="op" id="8021155">[</span><span class="op" id="8021156">]</span><span class="builtintype" id="8021157">byte</span><span class="op" id="8021161">(</span><span class="ident" id="8021162"><a href="/encoding/json/stream_test.go.html#8021092">enc</a></span><span class="op" id="8021165">)</span><span class="op" id="8021166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021170">var</span>&nbsp;<span class="ident" id="8021174">val</span>&nbsp;<span class="keyword" id="8021178">interface</span><span class="op" id="8021187">{</span><span class="op" id="8021188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8021193">//&nbsp;If&nbsp;Decode&nbsp;reads&nbsp;beyond&nbsp;what&nbsp;w.Write&nbsp;writes&nbsp;above,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8021248">//&nbsp;it&nbsp;will&nbsp;block,&nbsp;and&nbsp;the&nbsp;test&nbsp;will&nbsp;deadlock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021296">if</span>&nbsp;<span class="ident" id="8021299">err</span>&nbsp;<span class="op" id="8021303">:=</span>&nbsp;<span class="ident" id="8021306"><a href="/encoding/json/stream.go.html#3715917">NewDecoder</a></span><span class="op" id="8021316">(</span><span class="ident" id="8021317"><a href="/encoding/json/stream_test.go.html#8021123">r</a></span><span class="op" id="8021318">)</span><span class="op" id="8021319">.</span><span class="ident" id="8021320">Decode</span><span class="op" id="8021326">(</span><span class="op" id="8021327">&amp;</span><span class="ident" id="8021328"><a href="/encoding/json/stream_test.go.html#8021174">val</a></span><span class="op" id="8021331">)</span><span class="op" id="8021332">;</span>&nbsp;<span class="ident" id="8021334"><a href="/encoding/json/stream_test.go.html#8021299">err</a></span>&nbsp;<span class="op" id="8021338">!=</span>&nbsp;<span class="ident" id="8021341">nil</span>&nbsp;<span class="op" id="8021345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021350"><a href="/encoding/json/stream_test.go.html#8021068">t</a></span><span class="op" id="8021351">.</span><span class="ident" id="8021352">Errorf</span><span class="op" id="8021358">(</span><span class="string" id="8021359">&#34;decoding&nbsp;%s:&nbsp;%v&#34;</span><span class="op" id="8021376">,</span>&nbsp;<span class="ident" id="8021378"><a href="/encoding/json/stream_test.go.html#8021092">enc</a></span><span class="op" id="8021381">,</span>&nbsp;<span class="ident" id="8021383"><a href="/encoding/json/stream_test.go.html#8021299">err</a></span><span class="op" id="8021386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021390">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021394"><a href="/encoding/json/stream_test.go.html#8021123">r</a></span><span class="op" id="8021395">.</span><span class="ident" id="8021396">Close</span><span class="op" id="8021401">(</span><span class="op" id="8021402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021406"><a href="/encoding/json/stream_test.go.html#8021126">w</a></span><span class="op" id="8021407">.</span><span class="ident" id="8021408">Close</span><span class="op" id="8021413">(</span><span class="op" id="8021414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021417">}</span><br>
<span class="lineno"></span><span class="op" id="8021419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="keyword" id="8021422">func</span>&nbsp;<span class="ident" id="8021427">BenchmarkEncoderEncode</span><span class="op" id="8021449">(</span><span class="ident" id="8021450">b</span>&nbsp;<span class="op" id="8021452">*</span><span class="ident" id="8021453"><a href="/encoding/json/stream_test.go.html#8017534">testing</a></span><span class="op" id="8021460">.</span><span class="ident" id="8021461">B</span><span class="op" id="8021462">)</span>&nbsp;<span class="op" id="8021464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021467"><a href="/encoding/json/stream_test.go.html#8021450">b</a></span><span class="op" id="8021468">.</span><span class="ident" id="8021469">ReportAllocs</span><span class="op" id="8021481">(</span><span class="op" id="8021482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021485">type</span>&nbsp;<span class="ident" id="8021490">T</span>&nbsp;<span class="keyword" id="8021492">struct</span>&nbsp;<span class="op" id="8021499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021503">X</span><span class="op" id="8021504">,</span>&nbsp;<span class="ident" id="8021506">Y</span>&nbsp;<span class="builtintype" id="8021508">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021516">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021519">v</span>&nbsp;<span class="op" id="8021521">:=</span>&nbsp;<span class="op" id="8021524">&amp;</span><span class="ident" id="8021525"><a href="/encoding/json/stream_test.go.html#8021490">T</a></span><span class="op" id="8021526">{</span><span class="string" id="8021527">&#34;foo&#34;</span><span class="op" id="8021532">,</span>&nbsp;<span class="string" id="8021534">&#34;bar&#34;</span><span class="op" id="8021539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021542">for</span>&nbsp;<span class="ident" id="8021546">i</span>&nbsp;<span class="op" id="8021548">:=</span>&nbsp;<span class="num" id="8021551">0</span><span class="op" id="8021552">;</span>&nbsp;<span class="ident" id="8021554"><a href="/encoding/json/stream_test.go.html#8021546">i</a></span>&nbsp;<span class="op" id="8021556">&lt;</span>&nbsp;<span class="ident" id="8021558"><a href="/encoding/json/stream_test.go.html#8021450">b</a></span><span class="op" id="8021559">.</span><span class="ident" id="8021560">N</span><span class="op" id="8021561">;</span>&nbsp;<span class="ident" id="8021563"><a href="/encoding/json/stream_test.go.html#8021546">i</a></span><span class="op" id="8021564">++</span>&nbsp;<span class="op" id="8021567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8021571">if</span>&nbsp;<span class="ident" id="8021574">err</span>&nbsp;<span class="op" id="8021578">:=</span>&nbsp;<span class="ident" id="8021581"><a href="/encoding/json/stream.go.html#3718810">NewEncoder</a></span><span class="op" id="8021591">(</span><span class="ident" id="8021592"><a href="/encoding/json/stream_test.go.html#8017492">ioutil</a></span><span class="op" id="8021598">.</span><span class="ident" id="8021599">Discard</span><span class="op" id="8021606">)</span><span class="op" id="8021607">.</span><span class="ident" id="8021608">Encode</span><span class="op" id="8021614">(</span><span class="ident" id="8021615"><a href="/encoding/json/stream_test.go.html#8021519">v</a></span><span class="op" id="8021616">)</span><span class="op" id="8021617">;</span>&nbsp;<span class="ident" id="8021619"><a href="/encoding/json/stream_test.go.html#8021574">err</a></span>&nbsp;<span class="op" id="8021623">!=</span>&nbsp;<span class="ident" id="8021626">nil</span>&nbsp;<span class="op" id="8021630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8021635"><a href="/encoding/json/stream_test.go.html#8021450">b</a></span><span class="op" id="8021636">.</span><span class="ident" id="8021637">Fatal</span><span class="op" id="8021642">(</span><span class="ident" id="8021643"><a href="/encoding/json/stream_test.go.html#8021574">err</a></span><span class="op" id="8021646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021650">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8021653">}</span><br>
<span class="lineno"></span><span class="op" id="8021655">}</span>
</div>
</body>
</html>
