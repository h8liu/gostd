<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/exec</h2>
<ul>
<li><a href="/gostd/os/exec/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/exec/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/os/exec/lp_test.go.html">lp_test.go</a></li>
<li><a href="/gostd/os/exec/lp_unix.go.html">lp_unix.go</a></li>
<li><a href="/gostd/os/exec/lp_unix_test.go.html">lp_unix_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4838451">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4838506">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4838560">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4838611">//&nbsp;Package&nbsp;exec&nbsp;runs&nbsp;external&nbsp;commands.&nbsp;It&nbsp;wraps&nbsp;os.StartProcess&nbsp;to&nbsp;make&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4838687">//&nbsp;easier&nbsp;to&nbsp;remap&nbsp;stdin&nbsp;and&nbsp;stdout,&nbsp;connect&nbsp;I/O&nbsp;with&nbsp;pipes,&nbsp;and&nbsp;do&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="4838761">//&nbsp;adjustments.</span><br>
<span class="lineno"></span><span class="keyword" id="4838777">package</span>&nbsp;<span class="ident" id="4838785">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4838791">import</span>&nbsp;<span class="op" id="4838798">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4838801">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4838810">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4838820">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4838826">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4838832">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4838849">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4838860">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4838871">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4838882">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4838890">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="4838900">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4838903">//&nbsp;Error&nbsp;records&nbsp;the&nbsp;name&nbsp;of&nbsp;a&nbsp;binary&nbsp;that&nbsp;failed&nbsp;to&nbsp;be&nbsp;executed</span><br>
<span class="lineno"></span><span class="comment" id="4838968">//&nbsp;and&nbsp;the&nbsp;reason&nbsp;it&nbsp;failed.</span><br>
<span class="lineno">25</span><span class="keyword" id="4838997">type</span>&nbsp;<span class="ident" id="4839002">Error</span>&nbsp;<span class="keyword" id="4839008">struct</span>&nbsp;<span class="op" id="4839015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839018">Name</span>&nbsp;<span class="builtintype" id="4839023">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839031">Err</span>&nbsp;&nbsp;<span class="builtintype" id="4839036">error</span><br>
<span class="lineno"></span><span class="op" id="4839042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="4839045">func</span>&nbsp;<span class="op" id="4839050">(</span><span class="ident" id="4839051">e</span>&nbsp;<span class="op" id="4839053">*</span><span class="ident" id="4839054">Error</span><span class="op" id="4839059">)</span>&nbsp;<span class="ident" id="4839061">Error</span><span class="op" id="4839066">(</span><span class="op" id="4839067">)</span>&nbsp;<span class="builtintype" id="4839069">string</span>&nbsp;<span class="op" id="4839076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4839079">return</span>&nbsp;<span class="string" id="4839086">&#34;exec:&nbsp;&#34;</span>&nbsp;<span class="op" id="4839095">+</span>&nbsp;<span class="ident" id="4839097">strconv</span><span class="op" id="4839104">.</span><span class="ident" id="4839105">Quote</span><span class="op" id="4839110">(</span><span class="ident" id="4839111">e</span><span class="op" id="4839112">.</span><span class="ident" id="4839113">Name</span><span class="op" id="4839117">)</span>&nbsp;<span class="op" id="4839119">+</span>&nbsp;<span class="string" id="4839121">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="4839126">+</span>&nbsp;<span class="ident" id="4839128">e</span><span class="op" id="4839129">.</span><span class="ident" id="4839130">Err</span><span class="op" id="4839133">.</span><span class="ident" id="4839134">Error</span><span class="op" id="4839139">(</span><span class="op" id="4839140">)</span><br>
<span class="lineno"></span><span class="op" id="4839142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4839145">//&nbsp;Cmd&nbsp;represents&nbsp;an&nbsp;external&nbsp;command&nbsp;being&nbsp;prepared&nbsp;or&nbsp;run.</span><br>
<span class="lineno">35</span><span class="keyword" id="4839206">type</span>&nbsp;<span class="ident" id="4839211">Cmd</span>&nbsp;<span class="keyword" id="4839215">struct</span>&nbsp;<span class="op" id="4839222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839225">//&nbsp;Path&nbsp;is&nbsp;the&nbsp;path&nbsp;of&nbsp;the&nbsp;command&nbsp;to&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839269">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839273">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;field&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;to&nbsp;a&nbsp;non-zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839331">//&nbsp;value.&nbsp;If&nbsp;Path&nbsp;is&nbsp;relative,&nbsp;it&nbsp;is&nbsp;evaluated&nbsp;relative</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839388">//&nbsp;to&nbsp;Dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839400">Path</span>&nbsp;<span class="builtintype" id="4839405">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839414">//&nbsp;Args&nbsp;holds&nbsp;command&nbsp;line&nbsp;arguments,&nbsp;including&nbsp;the&nbsp;command&nbsp;as&nbsp;Args[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839487">//&nbsp;If&nbsp;the&nbsp;Args&nbsp;field&nbsp;is&nbsp;empty&nbsp;or&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;{Path}.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839543">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839547">//&nbsp;In&nbsp;typical&nbsp;use,&nbsp;both&nbsp;Path&nbsp;and&nbsp;Args&nbsp;are&nbsp;set&nbsp;by&nbsp;calling&nbsp;Command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839614">Args</span>&nbsp;<span class="op" id="4839619">[</span><span class="op" id="4839620">]</span><span class="builtintype" id="4839621">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839630">//&nbsp;Env&nbsp;specifies&nbsp;the&nbsp;environment&nbsp;of&nbsp;the&nbsp;process.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839680">//&nbsp;If&nbsp;Env&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;the&nbsp;current&nbsp;process&#39;s&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839743">Env</span>&nbsp;<span class="op" id="4839747">[</span><span class="op" id="4839748">]</span><span class="builtintype" id="4839749">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839758">//&nbsp;Dir&nbsp;specifies&nbsp;the&nbsp;working&nbsp;directory&nbsp;of&nbsp;the&nbsp;command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839814">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;Run&nbsp;runs&nbsp;the&nbsp;command&nbsp;in&nbsp;the</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839874">//&nbsp;calling&nbsp;process&#39;s&nbsp;current&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4839915">Dir</span>&nbsp;<span class="builtintype" id="4839919">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839928">//&nbsp;Stdin&nbsp;specifies&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4839978">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;nil,&nbsp;the&nbsp;process&nbsp;reads&nbsp;from&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840052">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;an&nbsp;*os.File,&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input&nbsp;is&nbsp;connected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840123">//&nbsp;directly&nbsp;to&nbsp;that&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840150">//&nbsp;Otherwise,&nbsp;during&nbsp;the&nbsp;execution&nbsp;of&nbsp;the&nbsp;command&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840212">//&nbsp;goroutine&nbsp;reads&nbsp;from&nbsp;Stdin&nbsp;and&nbsp;delivers&nbsp;that&nbsp;data&nbsp;to&nbsp;the&nbsp;command</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840281">//&nbsp;over&nbsp;a&nbsp;pipe.&nbsp;In&nbsp;this&nbsp;case,&nbsp;Wait&nbsp;does&nbsp;not&nbsp;complete&nbsp;until&nbsp;the&nbsp;goroutine</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840355">//&nbsp;stops&nbsp;copying,&nbsp;either&nbsp;because&nbsp;it&nbsp;has&nbsp;reached&nbsp;the&nbsp;end&nbsp;of&nbsp;Stdin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840421">//&nbsp;(EOF&nbsp;or&nbsp;a&nbsp;read&nbsp;error)&nbsp;or&nbsp;because&nbsp;writing&nbsp;to&nbsp;the&nbsp;pipe&nbsp;returned&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840497">Stdin</span>&nbsp;<span class="ident" id="4840503">io</span><span class="op" id="4840505">.</span><span class="ident" id="4840506">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840515">//&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;specify&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;output&nbsp;and&nbsp;error.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840586">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840590">//&nbsp;If&nbsp;either&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;connects&nbsp;the&nbsp;corresponding&nbsp;file&nbsp;descriptor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840659">//&nbsp;to&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840696">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840700">//&nbsp;If&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;are&nbsp;the&nbsp;same&nbsp;writer,&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840758">//&nbsp;goroutine&nbsp;at&nbsp;a&nbsp;time&nbsp;will&nbsp;call&nbsp;Write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840799">Stdout</span>&nbsp;<span class="ident" id="4840806">io</span><span class="op" id="4840808">.</span><span class="ident" id="4840809">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4840817">Stderr</span>&nbsp;<span class="ident" id="4840824">io</span><span class="op" id="4840826">.</span><span class="ident" id="4840827">Writer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840836">//&nbsp;ExtraFiles&nbsp;specifies&nbsp;additional&nbsp;open&nbsp;files&nbsp;to&nbsp;be&nbsp;inherited&nbsp;by&nbsp;the</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840906">//&nbsp;new&nbsp;process.&nbsp;It&nbsp;does&nbsp;not&nbsp;include&nbsp;standard&nbsp;input,&nbsp;standard&nbsp;output,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4840979">//&nbsp;standard&nbsp;error.&nbsp;If&nbsp;non-nil,&nbsp;entry&nbsp;i&nbsp;becomes&nbsp;file&nbsp;descriptor&nbsp;3+i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841048">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841052">//&nbsp;BUG:&nbsp;on&nbsp;OS&nbsp;X&nbsp;10.6,&nbsp;child&nbsp;processes&nbsp;may&nbsp;sometimes&nbsp;inherit&nbsp;unwanted&nbsp;fds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841127">//&nbsp;http://golang.org/issue/2603</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841160">ExtraFiles</span>&nbsp;<span class="op" id="4841171">[</span><span class="op" id="4841172">]</span><span class="op" id="4841173">*</span><span class="ident" id="4841174">os</span><span class="op" id="4841176">.</span><span class="ident" id="4841177">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841184">//&nbsp;SysProcAttr&nbsp;holds&nbsp;optional,&nbsp;operating&nbsp;system-specific&nbsp;attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841254">//&nbsp;Run&nbsp;passes&nbsp;it&nbsp;to&nbsp;os.StartProcess&nbsp;as&nbsp;the&nbsp;os.ProcAttr&#39;s&nbsp;Sys&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841323">SysProcAttr</span>&nbsp;<span class="op" id="4841335">*</span><span class="ident" id="4841336">syscall</span><span class="op" id="4841343">.</span><span class="ident" id="4841344">SysProcAttr</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841358">//&nbsp;Process&nbsp;is&nbsp;the&nbsp;underlying&nbsp;process,&nbsp;once&nbsp;started.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841411">Process</span>&nbsp;<span class="op" id="4841419">*</span><span class="ident" id="4841420">os</span><span class="op" id="4841422">.</span><span class="ident" id="4841423">Process</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841433">//&nbsp;ProcessState&nbsp;contains&nbsp;information&nbsp;about&nbsp;an&nbsp;exited&nbsp;process,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4841496">//&nbsp;available&nbsp;after&nbsp;a&nbsp;call&nbsp;to&nbsp;Wait&nbsp;or&nbsp;Run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841539">ProcessState</span>&nbsp;<span class="op" id="4841552">*</span><span class="ident" id="4841553">os</span><span class="op" id="4841555">.</span><span class="ident" id="4841556">ProcessState</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841571">lookPathErr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4841587">error</span>&nbsp;<span class="comment" id="4841593">//&nbsp;LookPath&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841621">finished</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4841637">bool</span>&nbsp;&nbsp;<span class="comment" id="4841643">//&nbsp;when&nbsp;Wait&nbsp;was&nbsp;called</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841668">childFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4841684">[</span><span class="op" id="4841685">]</span><span class="op" id="4841686">*</span><span class="ident" id="4841687">os</span><span class="op" id="4841689">.</span><span class="ident" id="4841690">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841696">closeAfterStart</span>&nbsp;<span class="op" id="4841712">[</span><span class="op" id="4841713">]</span><span class="ident" id="4841714">io</span><span class="op" id="4841716">.</span><span class="ident" id="4841717">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841725">closeAfterWait</span>&nbsp;&nbsp;<span class="op" id="4841741">[</span><span class="op" id="4841742">]</span><span class="ident" id="4841743">io</span><span class="op" id="4841745">.</span><span class="ident" id="4841746">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841754">goroutine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4841770">[</span><span class="op" id="4841771">]</span><span class="keyword" id="4841772">func</span><span class="op" id="4841776">(</span><span class="op" id="4841777">)</span>&nbsp;<span class="builtintype" id="4841779">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4841786">errch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4841802">chan</span>&nbsp;<span class="builtintype" id="4841807">error</span>&nbsp;<span class="comment" id="4841813">//&nbsp;one&nbsp;send&nbsp;per&nbsp;goroutine</span><br>
<span class="lineno">105</span><span class="op" id="4841839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4841842">//&nbsp;Command&nbsp;returns&nbsp;the&nbsp;Cmd&nbsp;struct&nbsp;to&nbsp;execute&nbsp;the&nbsp;named&nbsp;program&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4841910">//&nbsp;the&nbsp;given&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="4841934">//</span><br>
<span class="lineno">110</span><span class="comment" id="4841937">//&nbsp;It&nbsp;sets&nbsp;only&nbsp;the&nbsp;Path&nbsp;and&nbsp;Args&nbsp;in&nbsp;the&nbsp;returned&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="4841998">//</span><br>
<span class="lineno"></span><span class="comment" id="4842001">//&nbsp;If&nbsp;name&nbsp;contains&nbsp;no&nbsp;path&nbsp;separators,&nbsp;Command&nbsp;uses&nbsp;LookPath&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4842066">//&nbsp;resolve&nbsp;the&nbsp;path&nbsp;to&nbsp;a&nbsp;complete&nbsp;name&nbsp;if&nbsp;possible.&nbsp;Otherwise&nbsp;it&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="4842136">//&nbsp;name&nbsp;directly.</span><br>
<span class="lineno">115</span><span class="comment" id="4842154">//</span><br>
<span class="lineno"></span><span class="comment" id="4842157">//&nbsp;The&nbsp;returned&nbsp;Cmd&#39;s&nbsp;Args&nbsp;field&nbsp;is&nbsp;constructed&nbsp;from&nbsp;the&nbsp;command&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="4842227">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;elements&nbsp;of&nbsp;arg,&nbsp;so&nbsp;arg&nbsp;should&nbsp;not&nbsp;include&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4842293">//&nbsp;command&nbsp;name&nbsp;itself.&nbsp;For&nbsp;example,&nbsp;Command(&#34;echo&#34;,&nbsp;&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="keyword" id="4842355">func</span>&nbsp;<span class="ident" id="4842360">Command</span><span class="op" id="4842367">(</span><span class="ident" id="4842368">name</span>&nbsp;<span class="builtintype" id="4842373">string</span><span class="op" id="4842379">,</span>&nbsp;<span class="ident" id="4842381">arg</span>&nbsp;<span class="op" id="4842385">...</span><span class="builtintype" id="4842388">string</span><span class="op" id="4842394">)</span>&nbsp;<span class="op" id="4842396">*</span><span class="ident" id="4842397">Cmd</span>&nbsp;<span class="op" id="4842401">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842404">cmd</span>&nbsp;<span class="op" id="4842408">:=</span>&nbsp;<span class="op" id="4842411">&amp;</span><span class="ident" id="4842412">Cmd</span><span class="op" id="4842415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842419">Path</span><span class="op" id="4842423">:</span>&nbsp;<span class="ident" id="4842425">name</span><span class="op" id="4842429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842433">Args</span><span class="op" id="4842437">:</span>&nbsp;<span class="builtinfunc" id="4842439">append</span><span class="op" id="4842445">(</span><span class="op" id="4842446">[</span><span class="op" id="4842447">]</span><span class="builtintype" id="4842448">string</span><span class="op" id="4842454">{</span><span class="ident" id="4842455">name</span><span class="op" id="4842459">}</span><span class="op" id="4842460">,</span>&nbsp;<span class="ident" id="4842462">arg</span><span class="op" id="4842465">...</span><span class="op" id="4842468">)</span><span class="op" id="4842469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842475">if</span>&nbsp;<span class="ident" id="4842478">filepath</span><span class="op" id="4842486">.</span><span class="ident" id="4842487">Base</span><span class="op" id="4842491">(</span><span class="ident" id="4842492">name</span><span class="op" id="4842496">)</span>&nbsp;<span class="op" id="4842498">==</span>&nbsp;<span class="ident" id="4842501">name</span>&nbsp;<span class="op" id="4842506">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842510">if</span>&nbsp;<span class="ident" id="4842513">lp</span><span class="op" id="4842515">,</span>&nbsp;<span class="ident" id="4842517">err</span>&nbsp;<span class="op" id="4842521">:=</span>&nbsp;<span class="ident" id="4842524">LookPath</span><span class="op" id="4842532">(</span><span class="ident" id="4842533">name</span><span class="op" id="4842537">)</span><span class="op" id="4842538">;</span>&nbsp;<span class="ident" id="4842540">err</span>&nbsp;<span class="op" id="4842544">!=</span>&nbsp;<span class="ident" id="4842547">nil</span>&nbsp;<span class="op" id="4842551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842556">cmd</span><span class="op" id="4842559">.</span><span class="ident" id="4842560">lookPathErr</span>&nbsp;<span class="op" id="4842572">=</span>&nbsp;<span class="ident" id="4842574">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842580">}</span>&nbsp;<span class="keyword" id="4842582">else</span>&nbsp;<span class="op" id="4842587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4842592">cmd</span><span class="op" id="4842595">.</span><span class="ident" id="4842596">Path</span>&nbsp;<span class="op" id="4842601">=</span>&nbsp;<span class="ident" id="4842603">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842608">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842614">return</span>&nbsp;<span class="ident" id="4842621">cmd</span><br>
<span class="lineno"></span><span class="op" id="4842625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4842628">//&nbsp;interfaceEqual&nbsp;protects&nbsp;against&nbsp;panics&nbsp;from&nbsp;doing&nbsp;equality&nbsp;tests&nbsp;on</span><br>
<span class="lineno">135</span><span class="comment" id="4842699">//&nbsp;two&nbsp;interfaces&nbsp;with&nbsp;non-comparable&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="4842755">func</span>&nbsp;<span class="ident" id="4842760">interfaceEqual</span><span class="op" id="4842774">(</span><span class="ident" id="4842775">a</span><span class="op" id="4842776">,</span>&nbsp;<span class="ident" id="4842778">b</span>&nbsp;<span class="keyword" id="4842780">interface</span><span class="op" id="4842789">{</span><span class="op" id="4842790">}</span><span class="op" id="4842791">)</span>&nbsp;<span class="builtintype" id="4842793">bool</span>&nbsp;<span class="op" id="4842798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842801">defer</span>&nbsp;<span class="keyword" id="4842807">func</span><span class="op" id="4842811">(</span><span class="op" id="4842812">)</span>&nbsp;<span class="op" id="4842814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4842818">recover</span><span class="op" id="4842825">(</span><span class="op" id="4842826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842829">}</span><span class="op" id="4842830">(</span><span class="op" id="4842831">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842834">return</span>&nbsp;<span class="ident" id="4842841">a</span>&nbsp;<span class="op" id="4842843">==</span>&nbsp;<span class="ident" id="4842846">b</span><br>
<span class="lineno"></span><span class="op" id="4842848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4842851">func</span>&nbsp;<span class="op" id="4842856">(</span><span class="ident" id="4842857">c</span>&nbsp;<span class="op" id="4842859">*</span><span class="ident" id="4842860">Cmd</span><span class="op" id="4842863">)</span>&nbsp;<span class="ident" id="4842865">envv</span><span class="op" id="4842869">(</span><span class="op" id="4842870">)</span>&nbsp;<span class="op" id="4842872">[</span><span class="op" id="4842873">]</span><span class="builtintype" id="4842874">string</span>&nbsp;<span class="op" id="4842881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842884">if</span>&nbsp;<span class="ident" id="4842887">c</span><span class="op" id="4842888">.</span><span class="ident" id="4842889">Env</span>&nbsp;<span class="op" id="4842893">!=</span>&nbsp;<span class="ident" id="4842896">nil</span>&nbsp;<span class="op" id="4842900">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842904">return</span>&nbsp;<span class="ident" id="4842911">c</span><span class="op" id="4842912">.</span><span class="ident" id="4842913">Env</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4842918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842921">return</span>&nbsp;<span class="ident" id="4842928">os</span><span class="op" id="4842930">.</span><span class="ident" id="4842931">Environ</span><span class="op" id="4842938">(</span><span class="op" id="4842939">)</span><br>
<span class="lineno"></span><span class="op" id="4842941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="4842944">func</span>&nbsp;<span class="op" id="4842949">(</span><span class="ident" id="4842950">c</span>&nbsp;<span class="op" id="4842952">*</span><span class="ident" id="4842953">Cmd</span><span class="op" id="4842956">)</span>&nbsp;<span class="ident" id="4842958">argv</span><span class="op" id="4842962">(</span><span class="op" id="4842963">)</span>&nbsp;<span class="op" id="4842965">[</span><span class="op" id="4842966">]</span><span class="builtintype" id="4842967">string</span>&nbsp;<span class="op" id="4842974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4842977">if</span>&nbsp;<span class="builtinfunc" id="4842980">len</span><span class="op" id="4842983">(</span><span class="ident" id="4842984">c</span><span class="op" id="4842985">.</span><span class="ident" id="4842986">Args</span><span class="op" id="4842990">)</span>&nbsp;<span class="op" id="4842992">&gt;</span>&nbsp;<span class="num" id="4842994">0</span>&nbsp;<span class="op" id="4842996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843000">return</span>&nbsp;<span class="ident" id="4843007">c</span><span class="op" id="4843008">.</span><span class="ident" id="4843009">Args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843018">return</span>&nbsp;<span class="op" id="4843025">[</span><span class="op" id="4843026">]</span><span class="builtintype" id="4843027">string</span><span class="op" id="4843033">{</span><span class="ident" id="4843034">c</span><span class="op" id="4843035">.</span><span class="ident" id="4843036">Path</span><span class="op" id="4843040">}</span><br>
<span class="lineno">155</span><span class="op" id="4843042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4843045">func</span>&nbsp;<span class="op" id="4843050">(</span><span class="ident" id="4843051">c</span>&nbsp;<span class="op" id="4843053">*</span><span class="ident" id="4843054">Cmd</span><span class="op" id="4843057">)</span>&nbsp;<span class="ident" id="4843059">stdin</span><span class="op" id="4843064">(</span><span class="op" id="4843065">)</span>&nbsp;<span class="op" id="4843067">(</span><span class="ident" id="4843068">f</span>&nbsp;<span class="op" id="4843070">*</span><span class="ident" id="4843071">os</span><span class="op" id="4843073">.</span><span class="ident" id="4843074">File</span><span class="op" id="4843078">,</span>&nbsp;<span class="ident" id="4843080">err</span>&nbsp;<span class="builtintype" id="4843084">error</span><span class="op" id="4843089">)</span>&nbsp;<span class="op" id="4843091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843094">if</span>&nbsp;<span class="ident" id="4843097">c</span><span class="op" id="4843098">.</span><span class="ident" id="4843099">Stdin</span>&nbsp;<span class="op" id="4843105">==</span>&nbsp;<span class="ident" id="4843108">nil</span>&nbsp;<span class="op" id="4843112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843116">f</span><span class="op" id="4843117">,</span>&nbsp;<span class="ident" id="4843119">err</span>&nbsp;<span class="op" id="4843123">=</span>&nbsp;<span class="ident" id="4843125">os</span><span class="op" id="4843127">.</span><span class="ident" id="4843128">Open</span><span class="op" id="4843132">(</span><span class="ident" id="4843133">os</span><span class="op" id="4843135">.</span><span class="ident" id="4843136">DevNull</span><span class="op" id="4843143">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843147">if</span>&nbsp;<span class="ident" id="4843150">err</span>&nbsp;<span class="op" id="4843154">!=</span>&nbsp;<span class="ident" id="4843157">nil</span>&nbsp;<span class="op" id="4843161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843166">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843179">c</span><span class="op" id="4843180">.</span><span class="ident" id="4843181">closeAfterStart</span>&nbsp;<span class="op" id="4843197">=</span>&nbsp;<span class="builtinfunc" id="4843199">append</span><span class="op" id="4843205">(</span><span class="ident" id="4843206">c</span><span class="op" id="4843207">.</span><span class="ident" id="4843208">closeAfterStart</span><span class="op" id="4843223">,</span>&nbsp;<span class="ident" id="4843225">f</span><span class="op" id="4843226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843230">return</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843242">if</span>&nbsp;<span class="ident" id="4843245">f</span><span class="op" id="4843246">,</span>&nbsp;<span class="ident" id="4843248">ok</span>&nbsp;<span class="op" id="4843251">:=</span>&nbsp;<span class="ident" id="4843254">c</span><span class="op" id="4843255">.</span><span class="ident" id="4843256">Stdin</span><span class="op" id="4843261">.</span><span class="op" id="4843262">(</span><span class="op" id="4843263">*</span><span class="ident" id="4843264">os</span><span class="op" id="4843266">.</span><span class="ident" id="4843267">File</span><span class="op" id="4843271">)</span><span class="op" id="4843272">;</span>&nbsp;<span class="ident" id="4843274">ok</span>&nbsp;<span class="op" id="4843277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843281">return</span>&nbsp;<span class="ident" id="4843288">f</span><span class="op" id="4843289">,</span>&nbsp;<span class="ident" id="4843291">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843296">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843300">pr</span><span class="op" id="4843302">,</span>&nbsp;<span class="ident" id="4843304">pw</span><span class="op" id="4843306">,</span>&nbsp;<span class="ident" id="4843308">err</span>&nbsp;<span class="op" id="4843312">:=</span>&nbsp;<span class="ident" id="4843315">os</span><span class="op" id="4843317">.</span><span class="ident" id="4843318">Pipe</span><span class="op" id="4843322">(</span><span class="op" id="4843323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843326">if</span>&nbsp;<span class="ident" id="4843329">err</span>&nbsp;<span class="op" id="4843333">!=</span>&nbsp;<span class="ident" id="4843336">nil</span>&nbsp;<span class="op" id="4843340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843344">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843352">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843356">c</span><span class="op" id="4843357">.</span><span class="ident" id="4843358">closeAfterStart</span>&nbsp;<span class="op" id="4843374">=</span>&nbsp;<span class="builtinfunc" id="4843376">append</span><span class="op" id="4843382">(</span><span class="ident" id="4843383">c</span><span class="op" id="4843384">.</span><span class="ident" id="4843385">closeAfterStart</span><span class="op" id="4843400">,</span>&nbsp;<span class="ident" id="4843402">pr</span><span class="op" id="4843404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843407">c</span><span class="op" id="4843408">.</span><span class="ident" id="4843409">closeAfterWait</span>&nbsp;<span class="op" id="4843424">=</span>&nbsp;<span class="builtinfunc" id="4843426">append</span><span class="op" id="4843432">(</span><span class="ident" id="4843433">c</span><span class="op" id="4843434">.</span><span class="ident" id="4843435">closeAfterWait</span><span class="op" id="4843449">,</span>&nbsp;<span class="ident" id="4843451">pw</span><span class="op" id="4843453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843456">c</span><span class="op" id="4843457">.</span><span class="ident" id="4843458">goroutine</span>&nbsp;<span class="op" id="4843468">=</span>&nbsp;<span class="builtinfunc" id="4843470">append</span><span class="op" id="4843476">(</span><span class="ident" id="4843477">c</span><span class="op" id="4843478">.</span><span class="ident" id="4843479">goroutine</span><span class="op" id="4843488">,</span>&nbsp;<span class="keyword" id="4843490">func</span><span class="op" id="4843494">(</span><span class="op" id="4843495">)</span>&nbsp;<span class="builtintype" id="4843497">error</span>&nbsp;<span class="op" id="4843503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843507">_</span><span class="op" id="4843508">,</span>&nbsp;<span class="ident" id="4843510">err</span>&nbsp;<span class="op" id="4843514">:=</span>&nbsp;<span class="ident" id="4843517">io</span><span class="op" id="4843519">.</span><span class="ident" id="4843520">Copy</span><span class="op" id="4843524">(</span><span class="ident" id="4843525">pw</span><span class="op" id="4843527">,</span>&nbsp;<span class="ident" id="4843529">c</span><span class="op" id="4843530">.</span><span class="ident" id="4843531">Stdin</span><span class="op" id="4843536">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843540">if</span>&nbsp;<span class="ident" id="4843543">err1</span>&nbsp;<span class="op" id="4843548">:=</span>&nbsp;<span class="ident" id="4843551">pw</span><span class="op" id="4843553">.</span><span class="ident" id="4843554">Close</span><span class="op" id="4843559">(</span><span class="op" id="4843560">)</span><span class="op" id="4843561">;</span>&nbsp;<span class="ident" id="4843563">err</span>&nbsp;<span class="op" id="4843567">==</span>&nbsp;<span class="ident" id="4843570">nil</span>&nbsp;<span class="op" id="4843574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843579">err</span>&nbsp;<span class="op" id="4843583">=</span>&nbsp;<span class="ident" id="4843585">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843596">return</span>&nbsp;<span class="ident" id="4843603">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843608">}</span><span class="op" id="4843609">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843612">return</span>&nbsp;<span class="ident" id="4843619">pr</span><span class="op" id="4843621">,</span>&nbsp;<span class="ident" id="4843623">nil</span><br>
<span class="lineno"></span><span class="op" id="4843627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4843630">func</span>&nbsp;<span class="op" id="4843635">(</span><span class="ident" id="4843636">c</span>&nbsp;<span class="op" id="4843638">*</span><span class="ident" id="4843639">Cmd</span><span class="op" id="4843642">)</span>&nbsp;<span class="ident" id="4843644">stdout</span><span class="op" id="4843650">(</span><span class="op" id="4843651">)</span>&nbsp;<span class="op" id="4843653">(</span><span class="ident" id="4843654">f</span>&nbsp;<span class="op" id="4843656">*</span><span class="ident" id="4843657">os</span><span class="op" id="4843659">.</span><span class="ident" id="4843660">File</span><span class="op" id="4843664">,</span>&nbsp;<span class="ident" id="4843666">err</span>&nbsp;<span class="builtintype" id="4843670">error</span><span class="op" id="4843675">)</span>&nbsp;<span class="op" id="4843677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843680">return</span>&nbsp;<span class="ident" id="4843687">c</span><span class="op" id="4843688">.</span><span class="ident" id="4843689">writerDescriptor</span><span class="op" id="4843705">(</span><span class="ident" id="4843706">c</span><span class="op" id="4843707">.</span><span class="ident" id="4843708">Stdout</span><span class="op" id="4843714">)</span><br>
<span class="lineno">190</span><span class="op" id="4843716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4843719">func</span>&nbsp;<span class="op" id="4843724">(</span><span class="ident" id="4843725">c</span>&nbsp;<span class="op" id="4843727">*</span><span class="ident" id="4843728">Cmd</span><span class="op" id="4843731">)</span>&nbsp;<span class="ident" id="4843733">stderr</span><span class="op" id="4843739">(</span><span class="op" id="4843740">)</span>&nbsp;<span class="op" id="4843742">(</span><span class="ident" id="4843743">f</span>&nbsp;<span class="op" id="4843745">*</span><span class="ident" id="4843746">os</span><span class="op" id="4843748">.</span><span class="ident" id="4843749">File</span><span class="op" id="4843753">,</span>&nbsp;<span class="ident" id="4843755">err</span>&nbsp;<span class="builtintype" id="4843759">error</span><span class="op" id="4843764">)</span>&nbsp;<span class="op" id="4843766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843769">if</span>&nbsp;<span class="ident" id="4843772">c</span><span class="op" id="4843773">.</span><span class="ident" id="4843774">Stderr</span>&nbsp;<span class="op" id="4843781">!=</span>&nbsp;<span class="ident" id="4843784">nil</span>&nbsp;<span class="op" id="4843788">&amp;&amp;</span>&nbsp;<span class="ident" id="4843791">interfaceEqual</span><span class="op" id="4843805">(</span><span class="ident" id="4843806">c</span><span class="op" id="4843807">.</span><span class="ident" id="4843808">Stderr</span><span class="op" id="4843814">,</span>&nbsp;<span class="ident" id="4843816">c</span><span class="op" id="4843817">.</span><span class="ident" id="4843818">Stdout</span><span class="op" id="4843824">)</span>&nbsp;<span class="op" id="4843826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843830">return</span>&nbsp;<span class="ident" id="4843837">c</span><span class="op" id="4843838">.</span><span class="ident" id="4843839">childFiles</span><span class="op" id="4843849">[</span><span class="num" id="4843850">1</span><span class="op" id="4843851">]</span><span class="op" id="4843852">,</span>&nbsp;<span class="ident" id="4843854">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4843859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843862">return</span>&nbsp;<span class="ident" id="4843869">c</span><span class="op" id="4843870">.</span><span class="ident" id="4843871">writerDescriptor</span><span class="op" id="4843887">(</span><span class="ident" id="4843888">c</span><span class="op" id="4843889">.</span><span class="ident" id="4843890">Stderr</span><span class="op" id="4843896">)</span><br>
<span class="lineno"></span><span class="op" id="4843898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4843901">func</span>&nbsp;<span class="op" id="4843906">(</span><span class="ident" id="4843907">c</span>&nbsp;<span class="op" id="4843909">*</span><span class="ident" id="4843910">Cmd</span><span class="op" id="4843913">)</span>&nbsp;<span class="ident" id="4843915">writerDescriptor</span><span class="op" id="4843931">(</span><span class="ident" id="4843932">w</span>&nbsp;<span class="ident" id="4843934">io</span><span class="op" id="4843936">.</span><span class="ident" id="4843937">Writer</span><span class="op" id="4843943">)</span>&nbsp;<span class="op" id="4843945">(</span><span class="ident" id="4843946">f</span>&nbsp;<span class="op" id="4843948">*</span><span class="ident" id="4843949">os</span><span class="op" id="4843951">.</span><span class="ident" id="4843952">File</span><span class="op" id="4843956">,</span>&nbsp;<span class="ident" id="4843958">err</span>&nbsp;<span class="builtintype" id="4843962">error</span><span class="op" id="4843967">)</span>&nbsp;<span class="op" id="4843969">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4843972">if</span>&nbsp;<span class="ident" id="4843975">w</span>&nbsp;<span class="op" id="4843977">==</span>&nbsp;<span class="ident" id="4843980">nil</span>&nbsp;<span class="op" id="4843984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4843988">f</span><span class="op" id="4843989">,</span>&nbsp;<span class="ident" id="4843991">err</span>&nbsp;<span class="op" id="4843995">=</span>&nbsp;<span class="ident" id="4843997">os</span><span class="op" id="4843999">.</span><span class="ident" id="4844000">OpenFile</span><span class="op" id="4844008">(</span><span class="ident" id="4844009">os</span><span class="op" id="4844011">.</span><span class="ident" id="4844012">DevNull</span><span class="op" id="4844019">,</span>&nbsp;<span class="ident" id="4844021">os</span><span class="op" id="4844023">.</span><span class="ident" id="4844024">O_WRONLY</span><span class="op" id="4844032">,</span>&nbsp;<span class="num" id="4844034">0</span><span class="op" id="4844035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844039">if</span>&nbsp;<span class="ident" id="4844042">err</span>&nbsp;<span class="op" id="4844046">!=</span>&nbsp;<span class="ident" id="4844049">nil</span>&nbsp;<span class="op" id="4844053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844058">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844067">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844071">c</span><span class="op" id="4844072">.</span><span class="ident" id="4844073">closeAfterStart</span>&nbsp;<span class="op" id="4844089">=</span>&nbsp;<span class="builtinfunc" id="4844091">append</span><span class="op" id="4844097">(</span><span class="ident" id="4844098">c</span><span class="op" id="4844099">.</span><span class="ident" id="4844100">closeAfterStart</span><span class="op" id="4844115">,</span>&nbsp;<span class="ident" id="4844117">f</span><span class="op" id="4844118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844122">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844134">if</span>&nbsp;<span class="ident" id="4844137">f</span><span class="op" id="4844138">,</span>&nbsp;<span class="ident" id="4844140">ok</span>&nbsp;<span class="op" id="4844143">:=</span>&nbsp;<span class="ident" id="4844146">w</span><span class="op" id="4844147">.</span><span class="op" id="4844148">(</span><span class="op" id="4844149">*</span><span class="ident" id="4844150">os</span><span class="op" id="4844152">.</span><span class="ident" id="4844153">File</span><span class="op" id="4844157">)</span><span class="op" id="4844158">;</span>&nbsp;<span class="ident" id="4844160">ok</span>&nbsp;<span class="op" id="4844163">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844167">return</span>&nbsp;<span class="ident" id="4844174">f</span><span class="op" id="4844175">,</span>&nbsp;<span class="ident" id="4844177">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844186">pr</span><span class="op" id="4844188">,</span>&nbsp;<span class="ident" id="4844190">pw</span><span class="op" id="4844192">,</span>&nbsp;<span class="ident" id="4844194">err</span>&nbsp;<span class="op" id="4844198">:=</span>&nbsp;<span class="ident" id="4844201">os</span><span class="op" id="4844203">.</span><span class="ident" id="4844204">Pipe</span><span class="op" id="4844208">(</span><span class="op" id="4844209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844212">if</span>&nbsp;<span class="ident" id="4844215">err</span>&nbsp;<span class="op" id="4844219">!=</span>&nbsp;<span class="ident" id="4844222">nil</span>&nbsp;<span class="op" id="4844226">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844230">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844242">c</span><span class="op" id="4844243">.</span><span class="ident" id="4844244">closeAfterStart</span>&nbsp;<span class="op" id="4844260">=</span>&nbsp;<span class="builtinfunc" id="4844262">append</span><span class="op" id="4844268">(</span><span class="ident" id="4844269">c</span><span class="op" id="4844270">.</span><span class="ident" id="4844271">closeAfterStart</span><span class="op" id="4844286">,</span>&nbsp;<span class="ident" id="4844288">pw</span><span class="op" id="4844290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844293">c</span><span class="op" id="4844294">.</span><span class="ident" id="4844295">closeAfterWait</span>&nbsp;<span class="op" id="4844310">=</span>&nbsp;<span class="builtinfunc" id="4844312">append</span><span class="op" id="4844318">(</span><span class="ident" id="4844319">c</span><span class="op" id="4844320">.</span><span class="ident" id="4844321">closeAfterWait</span><span class="op" id="4844335">,</span>&nbsp;<span class="ident" id="4844337">pr</span><span class="op" id="4844339">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844342">c</span><span class="op" id="4844343">.</span><span class="ident" id="4844344">goroutine</span>&nbsp;<span class="op" id="4844354">=</span>&nbsp;<span class="builtinfunc" id="4844356">append</span><span class="op" id="4844362">(</span><span class="ident" id="4844363">c</span><span class="op" id="4844364">.</span><span class="ident" id="4844365">goroutine</span><span class="op" id="4844374">,</span>&nbsp;<span class="keyword" id="4844376">func</span><span class="op" id="4844380">(</span><span class="op" id="4844381">)</span>&nbsp;<span class="builtintype" id="4844383">error</span>&nbsp;<span class="op" id="4844389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844393">_</span><span class="op" id="4844394">,</span>&nbsp;<span class="ident" id="4844396">err</span>&nbsp;<span class="op" id="4844400">:=</span>&nbsp;<span class="ident" id="4844403">io</span><span class="op" id="4844405">.</span><span class="ident" id="4844406">Copy</span><span class="op" id="4844410">(</span><span class="ident" id="4844411">w</span><span class="op" id="4844412">,</span>&nbsp;<span class="ident" id="4844414">pr</span><span class="op" id="4844416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844420">return</span>&nbsp;<span class="ident" id="4844427">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844432">}</span><span class="op" id="4844433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844436">return</span>&nbsp;<span class="ident" id="4844443">pw</span><span class="op" id="4844445">,</span>&nbsp;<span class="ident" id="4844447">nil</span><br>
<span class="lineno">225</span><span class="op" id="4844451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4844454">func</span>&nbsp;<span class="op" id="4844459">(</span><span class="ident" id="4844460">c</span>&nbsp;<span class="op" id="4844462">*</span><span class="ident" id="4844463">Cmd</span><span class="op" id="4844466">)</span>&nbsp;<span class="ident" id="4844468">closeDescriptors</span><span class="op" id="4844484">(</span><span class="ident" id="4844485">closers</span>&nbsp;<span class="op" id="4844493">[</span><span class="op" id="4844494">]</span><span class="ident" id="4844495">io</span><span class="op" id="4844497">.</span><span class="ident" id="4844498">Closer</span><span class="op" id="4844504">)</span>&nbsp;<span class="op" id="4844506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844509">for</span>&nbsp;<span class="ident" id="4844513">_</span><span class="op" id="4844514">,</span>&nbsp;<span class="ident" id="4844516">fd</span>&nbsp;<span class="op" id="4844519">:=</span>&nbsp;<span class="keyword" id="4844522">range</span>&nbsp;<span class="ident" id="4844528">closers</span>&nbsp;<span class="op" id="4844536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4844540">fd</span><span class="op" id="4844542">.</span><span class="ident" id="4844543">Close</span><span class="op" id="4844548">(</span><span class="op" id="4844549">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4844552">}</span><br>
<span class="lineno"></span><span class="op" id="4844554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4844557">//&nbsp;Run&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;and&nbsp;waits&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="4844623">//</span><br>
<span class="lineno">235</span><span class="comment" id="4844626">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="4844692">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="4844757">//&nbsp;status.</span><br>
<span class="lineno"></span><span class="comment" id="4844768">//</span><br>
<span class="lineno"></span><span class="comment" id="4844771">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno">240</span><span class="comment" id="4844840">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4844897">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="keyword" id="4844927">func</span>&nbsp;<span class="op" id="4844932">(</span><span class="ident" id="4844933">c</span>&nbsp;<span class="op" id="4844935">*</span><span class="ident" id="4844936">Cmd</span><span class="op" id="4844939">)</span>&nbsp;<span class="ident" id="4844941">Run</span><span class="op" id="4844944">(</span><span class="op" id="4844945">)</span>&nbsp;<span class="builtintype" id="4844947">error</span>&nbsp;<span class="op" id="4844953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844956">if</span>&nbsp;<span class="ident" id="4844959">err</span>&nbsp;<span class="op" id="4844963">:=</span>&nbsp;<span class="ident" id="4844966">c</span><span class="op" id="4844967">.</span><span class="ident" id="4844968">Start</span><span class="op" id="4844973">(</span><span class="op" id="4844974">)</span><span class="op" id="4844975">;</span>&nbsp;<span class="ident" id="4844977">err</span>&nbsp;<span class="op" id="4844981">!=</span>&nbsp;<span class="ident" id="4844984">nil</span>&nbsp;<span class="op" id="4844988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4844992">return</span>&nbsp;<span class="ident" id="4844999">err</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845007">return</span>&nbsp;<span class="ident" id="4845014">c</span><span class="op" id="4845015">.</span><span class="ident" id="4845016">Wait</span><span class="op" id="4845020">(</span><span class="op" id="4845021">)</span><br>
<span class="lineno"></span><span class="op" id="4845023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4845026">//&nbsp;lookExtensions&nbsp;finds&nbsp;windows&nbsp;executable&nbsp;by&nbsp;its&nbsp;dir&nbsp;and&nbsp;path.</span><br>
<span class="lineno">250</span><span class="comment" id="4845090">//&nbsp;It&nbsp;uses&nbsp;LookPath&nbsp;to&nbsp;try&nbsp;appropriate&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="comment" id="4845141">//&nbsp;lookExtensions&nbsp;does&nbsp;not&nbsp;search&nbsp;PATH,&nbsp;instead&nbsp;it&nbsp;converts&nbsp;`prog`&nbsp;into&nbsp;`.\prog`.</span><br>
<span class="lineno"></span><span class="keyword" id="4845223">func</span>&nbsp;<span class="ident" id="4845228">lookExtensions</span><span class="op" id="4845242">(</span><span class="ident" id="4845243">path</span><span class="op" id="4845247">,</span>&nbsp;<span class="ident" id="4845249">dir</span>&nbsp;<span class="builtintype" id="4845253">string</span><span class="op" id="4845259">)</span>&nbsp;<span class="op" id="4845261">(</span><span class="builtintype" id="4845262">string</span><span class="op" id="4845268">,</span>&nbsp;<span class="builtintype" id="4845270">error</span><span class="op" id="4845275">)</span>&nbsp;<span class="op" id="4845277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845280">if</span>&nbsp;<span class="ident" id="4845283">filepath</span><span class="op" id="4845291">.</span><span class="ident" id="4845292">Base</span><span class="op" id="4845296">(</span><span class="ident" id="4845297">path</span><span class="op" id="4845301">)</span>&nbsp;<span class="op" id="4845303">==</span>&nbsp;<span class="ident" id="4845306">path</span>&nbsp;<span class="op" id="4845311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845315">path</span>&nbsp;<span class="op" id="4845320">=</span>&nbsp;<span class="ident" id="4845322">filepath</span><span class="op" id="4845330">.</span><span class="ident" id="4845331">Join</span><span class="op" id="4845335">(</span><span class="string" id="4845336">&#34;.&#34;</span><span class="op" id="4845339">,</span>&nbsp;<span class="ident" id="4845341">path</span><span class="op" id="4845345">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845351">if</span>&nbsp;<span class="ident" id="4845354">dir</span>&nbsp;<span class="op" id="4845358">==</span>&nbsp;<span class="string" id="4845361">&#34;&#34;</span>&nbsp;<span class="op" id="4845364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845368">return</span>&nbsp;<span class="ident" id="4845375">LookPath</span><span class="op" id="4845383">(</span><span class="ident" id="4845384">path</span><span class="op" id="4845388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845394">if</span>&nbsp;<span class="ident" id="4845397">filepath</span><span class="op" id="4845405">.</span><span class="ident" id="4845406">VolumeName</span><span class="op" id="4845416">(</span><span class="ident" id="4845417">path</span><span class="op" id="4845421">)</span>&nbsp;<span class="op" id="4845423">!=</span>&nbsp;<span class="string" id="4845426">&#34;&#34;</span>&nbsp;<span class="op" id="4845429">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845433">return</span>&nbsp;<span class="ident" id="4845440">LookPath</span><span class="op" id="4845448">(</span><span class="ident" id="4845449">path</span><span class="op" id="4845453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845459">if</span>&nbsp;<span class="builtinfunc" id="4845462">len</span><span class="op" id="4845465">(</span><span class="ident" id="4845466">path</span><span class="op" id="4845470">)</span>&nbsp;<span class="op" id="4845472">&gt;</span>&nbsp;<span class="num" id="4845474">1</span>&nbsp;<span class="op" id="4845476">&amp;&amp;</span>&nbsp;<span class="ident" id="4845479">os</span><span class="op" id="4845481">.</span><span class="ident" id="4845482">IsPathSeparator</span><span class="op" id="4845497">(</span><span class="ident" id="4845498">path</span><span class="op" id="4845502">[</span><span class="num" id="4845503">0</span><span class="op" id="4845504">]</span><span class="op" id="4845505">)</span>&nbsp;<span class="op" id="4845507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845511">return</span>&nbsp;<span class="ident" id="4845518">LookPath</span><span class="op" id="4845526">(</span><span class="ident" id="4845527">path</span><span class="op" id="4845531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845534">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845537">dirandpath</span>&nbsp;<span class="op" id="4845548">:=</span>&nbsp;<span class="ident" id="4845551">filepath</span><span class="op" id="4845559">.</span><span class="ident" id="4845560">Join</span><span class="op" id="4845564">(</span><span class="ident" id="4845565">dir</span><span class="op" id="4845568">,</span>&nbsp;<span class="ident" id="4845570">path</span><span class="op" id="4845574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4845577">//&nbsp;We&nbsp;assume&nbsp;that&nbsp;LookPath&nbsp;will&nbsp;only&nbsp;add&nbsp;file&nbsp;extension.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845635">lp</span><span class="op" id="4845637">,</span>&nbsp;<span class="ident" id="4845639">err</span>&nbsp;<span class="op" id="4845643">:=</span>&nbsp;<span class="ident" id="4845646">LookPath</span><span class="op" id="4845654">(</span><span class="ident" id="4845655">dirandpath</span><span class="op" id="4845665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845668">if</span>&nbsp;<span class="ident" id="4845671">err</span>&nbsp;<span class="op" id="4845675">!=</span>&nbsp;<span class="ident" id="4845678">nil</span>&nbsp;<span class="op" id="4845682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845686">return</span>&nbsp;<span class="string" id="4845693">&#34;&#34;</span><span class="op" id="4845695">,</span>&nbsp;<span class="ident" id="4845697">err</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4845702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4845705">ext</span>&nbsp;<span class="op" id="4845709">:=</span>&nbsp;<span class="ident" id="4845712">strings</span><span class="op" id="4845719">.</span><span class="ident" id="4845720">TrimPrefix</span><span class="op" id="4845730">(</span><span class="ident" id="4845731">lp</span><span class="op" id="4845733">,</span>&nbsp;<span class="ident" id="4845735">dirandpath</span><span class="op" id="4845745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845748">return</span>&nbsp;<span class="ident" id="4845755">path</span>&nbsp;<span class="op" id="4845760">+</span>&nbsp;<span class="ident" id="4845762">ext</span><span class="op" id="4845765">,</span>&nbsp;<span class="ident" id="4845767">nil</span><br>
<span class="lineno"></span><span class="op" id="4845771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4845774">//&nbsp;Start&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;but&nbsp;does&nbsp;not&nbsp;wait&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="4845850">//</span><br>
<span class="lineno"></span><span class="comment" id="4845853">//&nbsp;The&nbsp;Wait&nbsp;method&nbsp;will&nbsp;return&nbsp;the&nbsp;exit&nbsp;code&nbsp;and&nbsp;release&nbsp;associated&nbsp;resources</span><br>
<span class="lineno"></span><span class="comment" id="4845931">//&nbsp;once&nbsp;the&nbsp;command&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="4845958">func</span>&nbsp;<span class="op" id="4845963">(</span><span class="ident" id="4845964">c</span>&nbsp;<span class="op" id="4845966">*</span><span class="ident" id="4845967">Cmd</span><span class="op" id="4845970">)</span>&nbsp;<span class="ident" id="4845972">Start</span><span class="op" id="4845977">(</span><span class="op" id="4845978">)</span>&nbsp;<span class="builtintype" id="4845980">error</span>&nbsp;<span class="op" id="4845986">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4845989">if</span>&nbsp;<span class="ident" id="4845992">c</span><span class="op" id="4845993">.</span><span class="ident" id="4845994">lookPathErr</span>&nbsp;<span class="op" id="4846006">!=</span>&nbsp;<span class="ident" id="4846009">nil</span>&nbsp;<span class="op" id="4846013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846017">c</span><span class="op" id="4846018">.</span><span class="ident" id="4846019">closeDescriptors</span><span class="op" id="4846035">(</span><span class="ident" id="4846036">c</span><span class="op" id="4846037">.</span><span class="ident" id="4846038">closeAfterStart</span><span class="op" id="4846053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846057">c</span><span class="op" id="4846058">.</span><span class="ident" id="4846059">closeDescriptors</span><span class="op" id="4846075">(</span><span class="ident" id="4846076">c</span><span class="op" id="4846077">.</span><span class="ident" id="4846078">closeAfterWait</span><span class="op" id="4846092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846096">return</span>&nbsp;<span class="ident" id="4846103">c</span><span class="op" id="4846104">.</span><span class="ident" id="4846105">lookPathErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846118">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846121">if</span>&nbsp;<span class="ident" id="4846124">runtime</span><span class="op" id="4846131">.</span><span class="ident" id="4846132">GOOS</span>&nbsp;<span class="op" id="4846137">==</span>&nbsp;<span class="string" id="4846140">&#34;windows&#34;</span>&nbsp;<span class="op" id="4846150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846154">lp</span><span class="op" id="4846156">,</span>&nbsp;<span class="ident" id="4846158">err</span>&nbsp;<span class="op" id="4846162">:=</span>&nbsp;<span class="ident" id="4846165">lookExtensions</span><span class="op" id="4846179">(</span><span class="ident" id="4846180">c</span><span class="op" id="4846181">.</span><span class="ident" id="4846182">Path</span><span class="op" id="4846186">,</span>&nbsp;<span class="ident" id="4846188">c</span><span class="op" id="4846189">.</span><span class="ident" id="4846190">Dir</span><span class="op" id="4846193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846197">if</span>&nbsp;<span class="ident" id="4846200">err</span>&nbsp;<span class="op" id="4846204">!=</span>&nbsp;<span class="ident" id="4846207">nil</span>&nbsp;<span class="op" id="4846211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846216">c</span><span class="op" id="4846217">.</span><span class="ident" id="4846218">closeDescriptors</span><span class="op" id="4846234">(</span><span class="ident" id="4846235">c</span><span class="op" id="4846236">.</span><span class="ident" id="4846237">closeAfterStart</span><span class="op" id="4846252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846257">c</span><span class="op" id="4846258">.</span><span class="ident" id="4846259">closeDescriptors</span><span class="op" id="4846275">(</span><span class="ident" id="4846276">c</span><span class="op" id="4846277">.</span><span class="ident" id="4846278">closeAfterWait</span><span class="op" id="4846292">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846297">return</span>&nbsp;<span class="ident" id="4846304">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846314">c</span><span class="op" id="4846315">.</span><span class="ident" id="4846316">Path</span>&nbsp;<span class="op" id="4846321">=</span>&nbsp;<span class="ident" id="4846323">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846330">if</span>&nbsp;<span class="ident" id="4846333">c</span><span class="op" id="4846334">.</span><span class="ident" id="4846335">Process</span>&nbsp;<span class="op" id="4846343">!=</span>&nbsp;<span class="ident" id="4846346">nil</span>&nbsp;<span class="op" id="4846350">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846354">return</span>&nbsp;<span class="ident" id="4846361">errors</span><span class="op" id="4846367">.</span><span class="ident" id="4846368">New</span><span class="op" id="4846371">(</span><span class="string" id="4846372">&#34;exec:&nbsp;already&nbsp;started&#34;</span><span class="op" id="4846395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846402">type</span>&nbsp;<span class="ident" id="4846407">F</span>&nbsp;<span class="keyword" id="4846409">func</span><span class="op" id="4846413">(</span><span class="op" id="4846414">*</span><span class="ident" id="4846415">Cmd</span><span class="op" id="4846418">)</span>&nbsp;<span class="op" id="4846420">(</span><span class="op" id="4846421">*</span><span class="ident" id="4846422">os</span><span class="op" id="4846424">.</span><span class="ident" id="4846425">File</span><span class="op" id="4846429">,</span>&nbsp;<span class="builtintype" id="4846431">error</span><span class="op" id="4846436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846439">for</span>&nbsp;<span class="ident" id="4846443">_</span><span class="op" id="4846444">,</span>&nbsp;<span class="ident" id="4846446">setupFd</span>&nbsp;<span class="op" id="4846454">:=</span>&nbsp;<span class="keyword" id="4846457">range</span>&nbsp;<span class="op" id="4846463">[</span><span class="op" id="4846464">]</span><span class="ident" id="4846465">F</span><span class="op" id="4846466">{</span><span class="op" id="4846467">(</span><span class="op" id="4846468">*</span><span class="ident" id="4846469">Cmd</span><span class="op" id="4846472">)</span><span class="op" id="4846473">.</span><span class="ident" id="4846474">stdin</span><span class="op" id="4846479">,</span>&nbsp;<span class="op" id="4846481">(</span><span class="op" id="4846482">*</span><span class="ident" id="4846483">Cmd</span><span class="op" id="4846486">)</span><span class="op" id="4846487">.</span><span class="ident" id="4846488">stdout</span><span class="op" id="4846494">,</span>&nbsp;<span class="op" id="4846496">(</span><span class="op" id="4846497">*</span><span class="ident" id="4846498">Cmd</span><span class="op" id="4846501">)</span><span class="op" id="4846502">.</span><span class="ident" id="4846503">stderr</span><span class="op" id="4846509">}</span>&nbsp;<span class="op" id="4846511">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846515">fd</span><span class="op" id="4846517">,</span>&nbsp;<span class="ident" id="4846519">err</span>&nbsp;<span class="op" id="4846523">:=</span>&nbsp;<span class="ident" id="4846526">setupFd</span><span class="op" id="4846533">(</span><span class="ident" id="4846534">c</span><span class="op" id="4846535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846539">if</span>&nbsp;<span class="ident" id="4846542">err</span>&nbsp;<span class="op" id="4846546">!=</span>&nbsp;<span class="ident" id="4846549">nil</span>&nbsp;<span class="op" id="4846553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846558">c</span><span class="op" id="4846559">.</span><span class="ident" id="4846560">closeDescriptors</span><span class="op" id="4846576">(</span><span class="ident" id="4846577">c</span><span class="op" id="4846578">.</span><span class="ident" id="4846579">closeAfterStart</span><span class="op" id="4846594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846599">c</span><span class="op" id="4846600">.</span><span class="ident" id="4846601">closeDescriptors</span><span class="op" id="4846617">(</span><span class="ident" id="4846618">c</span><span class="op" id="4846619">.</span><span class="ident" id="4846620">closeAfterWait</span><span class="op" id="4846634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846639">return</span>&nbsp;<span class="ident" id="4846646">err</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846656">c</span><span class="op" id="4846657">.</span><span class="ident" id="4846658">childFiles</span>&nbsp;<span class="op" id="4846669">=</span>&nbsp;<span class="builtinfunc" id="4846671">append</span><span class="op" id="4846677">(</span><span class="ident" id="4846678">c</span><span class="op" id="4846679">.</span><span class="ident" id="4846680">childFiles</span><span class="op" id="4846690">,</span>&nbsp;<span class="ident" id="4846692">fd</span><span class="op" id="4846694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846700">c</span><span class="op" id="4846701">.</span><span class="ident" id="4846702">childFiles</span>&nbsp;<span class="op" id="4846713">=</span>&nbsp;<span class="builtinfunc" id="4846715">append</span><span class="op" id="4846721">(</span><span class="ident" id="4846722">c</span><span class="op" id="4846723">.</span><span class="ident" id="4846724">childFiles</span><span class="op" id="4846734">,</span>&nbsp;<span class="ident" id="4846736">c</span><span class="op" id="4846737">.</span><span class="ident" id="4846738">ExtraFiles</span><span class="op" id="4846748">...</span><span class="op" id="4846751">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846755">var</span>&nbsp;<span class="ident" id="4846759">err</span>&nbsp;<span class="builtintype" id="4846763">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846770">c</span><span class="op" id="4846771">.</span><span class="ident" id="4846772">Process</span><span class="op" id="4846779">,</span>&nbsp;<span class="ident" id="4846781">err</span>&nbsp;<span class="op" id="4846785">=</span>&nbsp;<span class="ident" id="4846787">os</span><span class="op" id="4846789">.</span><span class="ident" id="4846790">StartProcess</span><span class="op" id="4846802">(</span><span class="ident" id="4846803">c</span><span class="op" id="4846804">.</span><span class="ident" id="4846805">Path</span><span class="op" id="4846809">,</span>&nbsp;<span class="ident" id="4846811">c</span><span class="op" id="4846812">.</span><span class="ident" id="4846813">argv</span><span class="op" id="4846817">(</span><span class="op" id="4846818">)</span><span class="op" id="4846819">,</span>&nbsp;<span class="op" id="4846821">&amp;</span><span class="ident" id="4846822">os</span><span class="op" id="4846824">.</span><span class="ident" id="4846825">ProcAttr</span><span class="op" id="4846833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846837">Dir</span><span class="op" id="4846840">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4846844">c</span><span class="op" id="4846845">.</span><span class="ident" id="4846846">Dir</span><span class="op" id="4846849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846853">Files</span><span class="op" id="4846858">:</span>&nbsp;<span class="ident" id="4846860">c</span><span class="op" id="4846861">.</span><span class="ident" id="4846862">childFiles</span><span class="op" id="4846872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846876">Env</span><span class="op" id="4846879">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4846883">c</span><span class="op" id="4846884">.</span><span class="ident" id="4846885">envv</span><span class="op" id="4846889">(</span><span class="op" id="4846890">)</span><span class="op" id="4846891">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846895">Sys</span><span class="op" id="4846898">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4846902">c</span><span class="op" id="4846903">.</span><span class="ident" id="4846904">SysProcAttr</span><span class="op" id="4846915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4846918">}</span><span class="op" id="4846919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4846922">if</span>&nbsp;<span class="ident" id="4846925">err</span>&nbsp;<span class="op" id="4846929">!=</span>&nbsp;<span class="ident" id="4846932">nil</span>&nbsp;<span class="op" id="4846936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846940">c</span><span class="op" id="4846941">.</span><span class="ident" id="4846942">closeDescriptors</span><span class="op" id="4846958">(</span><span class="ident" id="4846959">c</span><span class="op" id="4846960">.</span><span class="ident" id="4846961">closeAfterStart</span><span class="op" id="4846976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4846980">c</span><span class="op" id="4846981">.</span><span class="ident" id="4846982">closeDescriptors</span><span class="op" id="4846998">(</span><span class="ident" id="4846999">c</span><span class="op" id="4847000">.</span><span class="ident" id="4847001">closeAfterWait</span><span class="op" id="4847015">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847019">return</span>&nbsp;<span class="ident" id="4847026">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847035">c</span><span class="op" id="4847036">.</span><span class="ident" id="4847037">closeDescriptors</span><span class="op" id="4847053">(</span><span class="ident" id="4847054">c</span><span class="op" id="4847055">.</span><span class="ident" id="4847056">closeAfterStart</span><span class="op" id="4847071">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847075">c</span><span class="op" id="4847076">.</span><span class="ident" id="4847077">errch</span>&nbsp;<span class="op" id="4847083">=</span>&nbsp;<span class="builtinfunc" id="4847085">make</span><span class="op" id="4847089">(</span><span class="keyword" id="4847090">chan</span>&nbsp;<span class="builtintype" id="4847095">error</span><span class="op" id="4847100">,</span>&nbsp;<span class="builtinfunc" id="4847102">len</span><span class="op" id="4847105">(</span><span class="ident" id="4847106">c</span><span class="op" id="4847107">.</span><span class="ident" id="4847108">goroutine</span><span class="op" id="4847117">)</span><span class="op" id="4847118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847121">for</span>&nbsp;<span class="ident" id="4847125">_</span><span class="op" id="4847126">,</span>&nbsp;<span class="ident" id="4847128">fn</span>&nbsp;<span class="op" id="4847131">:=</span>&nbsp;<span class="keyword" id="4847134">range</span>&nbsp;<span class="ident" id="4847140">c</span><span class="op" id="4847141">.</span><span class="ident" id="4847142">goroutine</span>&nbsp;<span class="op" id="4847152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847156">go</span>&nbsp;<span class="keyword" id="4847159">func</span><span class="op" id="4847163">(</span><span class="ident" id="4847164">fn</span>&nbsp;<span class="keyword" id="4847167">func</span><span class="op" id="4847171">(</span><span class="op" id="4847172">)</span>&nbsp;<span class="builtintype" id="4847174">error</span><span class="op" id="4847179">)</span>&nbsp;<span class="op" id="4847181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4847186">c</span><span class="op" id="4847187">.</span><span class="ident" id="4847188">errch</span>&nbsp;<span class="op" id="4847194">&lt;-</span>&nbsp;<span class="ident" id="4847197">fn</span><span class="op" id="4847199">(</span><span class="op" id="4847200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847204">}</span><span class="op" id="4847205">(</span><span class="ident" id="4847206">fn</span><span class="op" id="4847208">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847215">return</span>&nbsp;<span class="ident" id="4847222">nil</span><br>
<span class="lineno"></span><span class="op" id="4847226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="comment" id="4847229">//&nbsp;An&nbsp;ExitError&nbsp;reports&nbsp;an&nbsp;unsuccessful&nbsp;exit&nbsp;by&nbsp;a&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="4847288">type</span>&nbsp;<span class="ident" id="4847293">ExitError</span>&nbsp;<span class="keyword" id="4847303">struct</span>&nbsp;<span class="op" id="4847310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847313">*</span><span class="ident" id="4847314">os</span><span class="op" id="4847316">.</span><span class="ident" id="4847317">ProcessState</span><br>
<span class="lineno"></span><span class="op" id="4847330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="keyword" id="4847333">func</span>&nbsp;<span class="op" id="4847338">(</span><span class="ident" id="4847339">e</span>&nbsp;<span class="op" id="4847341">*</span><span class="ident" id="4847342">ExitError</span><span class="op" id="4847351">)</span>&nbsp;<span class="ident" id="4847353">Error</span><span class="op" id="4847358">(</span><span class="op" id="4847359">)</span>&nbsp;<span class="builtintype" id="4847361">string</span>&nbsp;<span class="op" id="4847368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847371">return</span>&nbsp;<span class="ident" id="4847378">e</span><span class="op" id="4847379">.</span><span class="ident" id="4847380">ProcessState</span><span class="op" id="4847392">.</span><span class="ident" id="4847393">String</span><span class="op" id="4847399">(</span><span class="op" id="4847400">)</span><br>
<span class="lineno"></span><span class="op" id="4847402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4847405">//&nbsp;Wait&nbsp;waits&nbsp;for&nbsp;the&nbsp;command&nbsp;to&nbsp;exit.</span><br>
<span class="lineno">345</span><span class="comment" id="4847444">//&nbsp;It&nbsp;must&nbsp;have&nbsp;been&nbsp;started&nbsp;by&nbsp;Start.</span><br>
<span class="lineno"></span><span class="comment" id="4847483">//</span><br>
<span class="lineno"></span><span class="comment" id="4847486">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="4847552">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="4847617">//&nbsp;status.</span><br>
<span class="lineno">350</span><span class="comment" id="4847628">//</span><br>
<span class="lineno"></span><span class="comment" id="4847631">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4847700">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4847757">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="comment" id="4847787">//</span><br>
<span class="lineno">355</span><span class="comment" id="4847790">//&nbsp;Wait&nbsp;releases&nbsp;any&nbsp;resources&nbsp;associated&nbsp;with&nbsp;the&nbsp;Cmd.</span><br>
<span class="lineno"></span><span class="keyword" id="4847846">func</span>&nbsp;<span class="op" id="4847851">(</span><span class="ident" id="4847852">c</span>&nbsp;<span class="op" id="4847854">*</span><span class="ident" id="4847855">Cmd</span><span class="op" id="4847858">)</span>&nbsp;<span class="ident" id="4847860">Wait</span><span class="op" id="4847864">(</span><span class="op" id="4847865">)</span>&nbsp;<span class="builtintype" id="4847867">error</span>&nbsp;<span class="op" id="4847873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847876">if</span>&nbsp;<span class="ident" id="4847879">c</span><span class="op" id="4847880">.</span><span class="ident" id="4847881">Process</span>&nbsp;<span class="op" id="4847889">==</span>&nbsp;<span class="ident" id="4847892">nil</span>&nbsp;<span class="op" id="4847896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847900">return</span>&nbsp;<span class="ident" id="4847907">errors</span><span class="op" id="4847913">.</span><span class="ident" id="4847914">New</span><span class="op" id="4847917">(</span><span class="string" id="4847918">&#34;exec:&nbsp;not&nbsp;started&#34;</span><span class="op" id="4847937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4847940">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847943">if</span>&nbsp;<span class="ident" id="4847946">c</span><span class="op" id="4847947">.</span><span class="ident" id="4847948">finished</span>&nbsp;<span class="op" id="4847957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4847961">return</span>&nbsp;<span class="ident" id="4847968">errors</span><span class="op" id="4847974">.</span><span class="ident" id="4847975">New</span><span class="op" id="4847978">(</span><span class="string" id="4847979">&#34;exec:&nbsp;Wait&nbsp;was&nbsp;already&nbsp;called&#34;</span><span class="op" id="4848010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4848013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848016">c</span><span class="op" id="4848017">.</span><span class="ident" id="4848018">finished</span>&nbsp;<span class="op" id="4848027">=</span>&nbsp;<span class="builtintype" id="4848029">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848035">state</span><span class="op" id="4848040">,</span>&nbsp;<span class="ident" id="4848042">err</span>&nbsp;<span class="op" id="4848046">:=</span>&nbsp;<span class="ident" id="4848049">c</span><span class="op" id="4848050">.</span><span class="ident" id="4848051">Process</span><span class="op" id="4848058">.</span><span class="ident" id="4848059">Wait</span><span class="op" id="4848063">(</span><span class="op" id="4848064">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848067">c</span><span class="op" id="4848068">.</span><span class="ident" id="4848069">ProcessState</span>&nbsp;<span class="op" id="4848082">=</span>&nbsp;<span class="ident" id="4848084">state</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848092">var</span>&nbsp;<span class="ident" id="4848096">copyError</span>&nbsp;<span class="builtintype" id="4848106">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848113">for</span>&nbsp;<span class="keyword" id="4848117">range</span>&nbsp;<span class="ident" id="4848123">c</span><span class="op" id="4848124">.</span><span class="ident" id="4848125">goroutine</span>&nbsp;<span class="op" id="4848135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848139">if</span>&nbsp;<span class="ident" id="4848142">err</span>&nbsp;<span class="op" id="4848146">:=</span>&nbsp;<span class="op" id="4848149">&lt;-</span><span class="ident" id="4848151">c</span><span class="op" id="4848152">.</span><span class="ident" id="4848153">errch</span><span class="op" id="4848158">;</span>&nbsp;<span class="ident" id="4848160">err</span>&nbsp;<span class="op" id="4848164">!=</span>&nbsp;<span class="ident" id="4848167">nil</span>&nbsp;<span class="op" id="4848171">&amp;&amp;</span>&nbsp;<span class="ident" id="4848174">copyError</span>&nbsp;<span class="op" id="4848184">==</span>&nbsp;<span class="ident" id="4848187">nil</span>&nbsp;<span class="op" id="4848191">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848196">copyError</span>&nbsp;<span class="op" id="4848206">=</span>&nbsp;<span class="ident" id="4848208">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4848214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4848217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848221">c</span><span class="op" id="4848222">.</span><span class="ident" id="4848223">closeDescriptors</span><span class="op" id="4848239">(</span><span class="ident" id="4848240">c</span><span class="op" id="4848241">.</span><span class="ident" id="4848242">closeAfterWait</span><span class="op" id="4848256">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848260">if</span>&nbsp;<span class="ident" id="4848263">err</span>&nbsp;<span class="op" id="4848267">!=</span>&nbsp;<span class="ident" id="4848270">nil</span>&nbsp;<span class="op" id="4848274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848278">return</span>&nbsp;<span class="ident" id="4848285">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4848290">}</span>&nbsp;<span class="keyword" id="4848292">else</span>&nbsp;<span class="keyword" id="4848297">if</span>&nbsp;<span class="op" id="4848300">!</span><span class="ident" id="4848301">state</span><span class="op" id="4848306">.</span><span class="ident" id="4848307">Success</span><span class="op" id="4848314">(</span><span class="op" id="4848315">)</span>&nbsp;<span class="op" id="4848317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848321">return</span>&nbsp;<span class="op" id="4848328">&amp;</span><span class="ident" id="4848329">ExitError</span><span class="op" id="4848338">{</span><span class="ident" id="4848339">state</span><span class="op" id="4848344">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4848347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848351">return</span>&nbsp;<span class="ident" id="4848358">copyError</span><br>
<span class="lineno"></span><span class="op" id="4848368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="4848371">//&nbsp;Output&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;standard&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="4848431">func</span>&nbsp;<span class="op" id="4848436">(</span><span class="ident" id="4848437">c</span>&nbsp;<span class="op" id="4848439">*</span><span class="ident" id="4848440">Cmd</span><span class="op" id="4848443">)</span>&nbsp;<span class="ident" id="4848445">Output</span><span class="op" id="4848451">(</span><span class="op" id="4848452">)</span>&nbsp;<span class="op" id="4848454">(</span><span class="op" id="4848455">[</span><span class="op" id="4848456">]</span><span class="builtintype" id="4848457">byte</span><span class="op" id="4848461">,</span>&nbsp;<span class="builtintype" id="4848463">error</span><span class="op" id="4848468">)</span>&nbsp;<span class="op" id="4848470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848473">if</span>&nbsp;<span class="ident" id="4848476">c</span><span class="op" id="4848477">.</span><span class="ident" id="4848478">Stdout</span>&nbsp;<span class="op" id="4848485">!=</span>&nbsp;<span class="ident" id="4848488">nil</span>&nbsp;<span class="op" id="4848492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848496">return</span>&nbsp;<span class="ident" id="4848503">nil</span><span class="op" id="4848506">,</span>&nbsp;<span class="ident" id="4848508">errors</span><span class="op" id="4848514">.</span><span class="ident" id="4848515">New</span><span class="op" id="4848518">(</span><span class="string" id="4848519">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="4848545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4848548">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848551">var</span>&nbsp;<span class="ident" id="4848555">b</span>&nbsp;<span class="ident" id="4848557">bytes</span><span class="op" id="4848562">.</span><span class="ident" id="4848563">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848571">c</span><span class="op" id="4848572">.</span><span class="ident" id="4848573">Stdout</span>&nbsp;<span class="op" id="4848580">=</span>&nbsp;<span class="op" id="4848582">&amp;</span><span class="ident" id="4848583">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848586">err</span>&nbsp;<span class="op" id="4848590">:=</span>&nbsp;<span class="ident" id="4848593">c</span><span class="op" id="4848594">.</span><span class="ident" id="4848595">Run</span><span class="op" id="4848598">(</span><span class="op" id="4848599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848602">return</span>&nbsp;<span class="ident" id="4848609">b</span><span class="op" id="4848610">.</span><span class="ident" id="4848611">Bytes</span><span class="op" id="4848616">(</span><span class="op" id="4848617">)</span><span class="op" id="4848618">,</span>&nbsp;<span class="ident" id="4848620">err</span><br>
<span class="lineno"></span><span class="op" id="4848624">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="4848627">//&nbsp;CombinedOutput&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;combined&nbsp;standard</span><br>
<span class="lineno"></span><span class="comment" id="4848696">//&nbsp;output&nbsp;and&nbsp;standard&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4848726">func</span>&nbsp;<span class="op" id="4848731">(</span><span class="ident" id="4848732">c</span>&nbsp;<span class="op" id="4848734">*</span><span class="ident" id="4848735">Cmd</span><span class="op" id="4848738">)</span>&nbsp;<span class="ident" id="4848740">CombinedOutput</span><span class="op" id="4848754">(</span><span class="op" id="4848755">)</span>&nbsp;<span class="op" id="4848757">(</span><span class="op" id="4848758">[</span><span class="op" id="4848759">]</span><span class="builtintype" id="4848760">byte</span><span class="op" id="4848764">,</span>&nbsp;<span class="builtintype" id="4848766">error</span><span class="op" id="4848771">)</span>&nbsp;<span class="op" id="4848773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848776">if</span>&nbsp;<span class="ident" id="4848779">c</span><span class="op" id="4848780">.</span><span class="ident" id="4848781">Stdout</span>&nbsp;<span class="op" id="4848788">!=</span>&nbsp;<span class="ident" id="4848791">nil</span>&nbsp;<span class="op" id="4848795">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848799">return</span>&nbsp;<span class="ident" id="4848806">nil</span><span class="op" id="4848809">,</span>&nbsp;<span class="ident" id="4848811">errors</span><span class="op" id="4848817">.</span><span class="ident" id="4848818">New</span><span class="op" id="4848821">(</span><span class="string" id="4848822">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="4848848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4848851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848854">if</span>&nbsp;<span class="ident" id="4848857">c</span><span class="op" id="4848858">.</span><span class="ident" id="4848859">Stderr</span>&nbsp;<span class="op" id="4848866">!=</span>&nbsp;<span class="ident" id="4848869">nil</span>&nbsp;<span class="op" id="4848873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848877">return</span>&nbsp;<span class="ident" id="4848884">nil</span><span class="op" id="4848887">,</span>&nbsp;<span class="ident" id="4848889">errors</span><span class="op" id="4848895">.</span><span class="ident" id="4848896">New</span><span class="op" id="4848899">(</span><span class="string" id="4848900">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="4848926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4848929">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848932">var</span>&nbsp;<span class="ident" id="4848936">b</span>&nbsp;<span class="ident" id="4848938">bytes</span><span class="op" id="4848943">.</span><span class="ident" id="4848944">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848952">c</span><span class="op" id="4848953">.</span><span class="ident" id="4848954">Stdout</span>&nbsp;<span class="op" id="4848961">=</span>&nbsp;<span class="op" id="4848963">&amp;</span><span class="ident" id="4848964">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848967">c</span><span class="op" id="4848968">.</span><span class="ident" id="4848969">Stderr</span>&nbsp;<span class="op" id="4848976">=</span>&nbsp;<span class="op" id="4848978">&amp;</span><span class="ident" id="4848979">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4848982">err</span>&nbsp;<span class="op" id="4848986">:=</span>&nbsp;<span class="ident" id="4848989">c</span><span class="op" id="4848990">.</span><span class="ident" id="4848991">Run</span><span class="op" id="4848994">(</span><span class="op" id="4848995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4848998">return</span>&nbsp;<span class="ident" id="4849005">b</span><span class="op" id="4849006">.</span><span class="ident" id="4849007">Bytes</span><span class="op" id="4849012">(</span><span class="op" id="4849013">)</span><span class="op" id="4849014">,</span>&nbsp;<span class="ident" id="4849016">err</span><br>
<span class="lineno">410</span><span class="op" id="4849020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4849023">//&nbsp;StdinPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4849091">//&nbsp;standard&nbsp;input&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="4849134">//&nbsp;The&nbsp;pipe&nbsp;will&nbsp;be&nbsp;closed&nbsp;automatically&nbsp;after&nbsp;Wait&nbsp;sees&nbsp;the&nbsp;command&nbsp;exit.</span><br>
<span class="lineno">415</span><span class="comment" id="4849209">//&nbsp;A&nbsp;caller&nbsp;need&nbsp;only&nbsp;call&nbsp;Close&nbsp;to&nbsp;force&nbsp;the&nbsp;pipe&nbsp;to&nbsp;close&nbsp;sooner.</span><br>
<span class="lineno"></span><span class="comment" id="4849277">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;command&nbsp;being&nbsp;run&nbsp;will&nbsp;not&nbsp;exit&nbsp;until&nbsp;standard&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="4849353">//&nbsp;is&nbsp;closed,&nbsp;the&nbsp;caller&nbsp;must&nbsp;close&nbsp;the&nbsp;pipe.</span><br>
<span class="lineno"></span><span class="keyword" id="4849399">func</span>&nbsp;<span class="op" id="4849404">(</span><span class="ident" id="4849405">c</span>&nbsp;<span class="op" id="4849407">*</span><span class="ident" id="4849408">Cmd</span><span class="op" id="4849411">)</span>&nbsp;<span class="ident" id="4849413">StdinPipe</span><span class="op" id="4849422">(</span><span class="op" id="4849423">)</span>&nbsp;<span class="op" id="4849425">(</span><span class="ident" id="4849426">io</span><span class="op" id="4849428">.</span><span class="ident" id="4849429">WriteCloser</span><span class="op" id="4849440">,</span>&nbsp;<span class="builtintype" id="4849442">error</span><span class="op" id="4849447">)</span>&nbsp;<span class="op" id="4849449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849452">if</span>&nbsp;<span class="ident" id="4849455">c</span><span class="op" id="4849456">.</span><span class="ident" id="4849457">Stdin</span>&nbsp;<span class="op" id="4849463">!=</span>&nbsp;<span class="ident" id="4849466">nil</span>&nbsp;<span class="op" id="4849470">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849474">return</span>&nbsp;<span class="ident" id="4849481">nil</span><span class="op" id="4849484">,</span>&nbsp;<span class="ident" id="4849486">errors</span><span class="op" id="4849492">.</span><span class="ident" id="4849493">New</span><span class="op" id="4849496">(</span><span class="string" id="4849497">&#34;exec:&nbsp;Stdin&nbsp;already&nbsp;set&#34;</span><span class="op" id="4849522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4849525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849528">if</span>&nbsp;<span class="ident" id="4849531">c</span><span class="op" id="4849532">.</span><span class="ident" id="4849533">Process</span>&nbsp;<span class="op" id="4849541">!=</span>&nbsp;<span class="ident" id="4849544">nil</span>&nbsp;<span class="op" id="4849548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849552">return</span>&nbsp;<span class="ident" id="4849559">nil</span><span class="op" id="4849562">,</span>&nbsp;<span class="ident" id="4849564">errors</span><span class="op" id="4849570">.</span><span class="ident" id="4849571">New</span><span class="op" id="4849574">(</span><span class="string" id="4849575">&#34;exec:&nbsp;StdinPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="4849614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4849617">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849620">pr</span><span class="op" id="4849622">,</span>&nbsp;<span class="ident" id="4849624">pw</span><span class="op" id="4849626">,</span>&nbsp;<span class="ident" id="4849628">err</span>&nbsp;<span class="op" id="4849632">:=</span>&nbsp;<span class="ident" id="4849635">os</span><span class="op" id="4849637">.</span><span class="ident" id="4849638">Pipe</span><span class="op" id="4849642">(</span><span class="op" id="4849643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849646">if</span>&nbsp;<span class="ident" id="4849649">err</span>&nbsp;<span class="op" id="4849653">!=</span>&nbsp;<span class="ident" id="4849656">nil</span>&nbsp;<span class="op" id="4849660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849664">return</span>&nbsp;<span class="ident" id="4849671">nil</span><span class="op" id="4849674">,</span>&nbsp;<span class="ident" id="4849676">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4849681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849684">c</span><span class="op" id="4849685">.</span><span class="ident" id="4849686">Stdin</span>&nbsp;<span class="op" id="4849692">=</span>&nbsp;<span class="ident" id="4849694">pr</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849698">c</span><span class="op" id="4849699">.</span><span class="ident" id="4849700">closeAfterStart</span>&nbsp;<span class="op" id="4849716">=</span>&nbsp;<span class="builtinfunc" id="4849718">append</span><span class="op" id="4849724">(</span><span class="ident" id="4849725">c</span><span class="op" id="4849726">.</span><span class="ident" id="4849727">closeAfterStart</span><span class="op" id="4849742">,</span>&nbsp;<span class="ident" id="4849744">pr</span><span class="op" id="4849746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849749">wc</span>&nbsp;<span class="op" id="4849752">:=</span>&nbsp;<span class="op" id="4849755">&amp;</span><span class="ident" id="4849756">closeOnce</span><span class="op" id="4849765">{</span><span class="ident" id="4849766">File</span><span class="op" id="4849770">:</span>&nbsp;<span class="ident" id="4849772">pw</span><span class="op" id="4849774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849777">c</span><span class="op" id="4849778">.</span><span class="ident" id="4849779">closeAfterWait</span>&nbsp;<span class="op" id="4849794">=</span>&nbsp;<span class="builtinfunc" id="4849796">append</span><span class="op" id="4849802">(</span><span class="ident" id="4849803">c</span><span class="op" id="4849804">.</span><span class="ident" id="4849805">closeAfterWait</span><span class="op" id="4849819">,</span>&nbsp;<span class="ident" id="4849821">wc</span><span class="op" id="4849823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849826">return</span>&nbsp;<span class="ident" id="4849833">wc</span><span class="op" id="4849835">,</span>&nbsp;<span class="ident" id="4849837">nil</span><br>
<span class="lineno"></span><span class="op" id="4849841">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="4849844">type</span>&nbsp;<span class="ident" id="4849849">closeOnce</span>&nbsp;<span class="keyword" id="4849859">struct</span>&nbsp;<span class="op" id="4849866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4849869">*</span><span class="ident" id="4849870">os</span><span class="op" id="4849872">.</span><span class="ident" id="4849873">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849880">once</span>&nbsp;<span class="ident" id="4849885">sync</span><span class="op" id="4849889">.</span><span class="ident" id="4849890">Once</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849896">err</span>&nbsp;&nbsp;<span class="builtintype" id="4849901">error</span><br>
<span class="lineno"></span><span class="op" id="4849907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4849910">func</span>&nbsp;<span class="op" id="4849915">(</span><span class="ident" id="4849916">c</span>&nbsp;<span class="op" id="4849918">*</span><span class="ident" id="4849919">closeOnce</span><span class="op" id="4849928">)</span>&nbsp;<span class="ident" id="4849930">Close</span><span class="op" id="4849935">(</span><span class="op" id="4849936">)</span>&nbsp;<span class="builtintype" id="4849938">error</span>&nbsp;<span class="op" id="4849944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4849947">c</span><span class="op" id="4849948">.</span><span class="ident" id="4849949">once</span><span class="op" id="4849953">.</span><span class="ident" id="4849954">Do</span><span class="op" id="4849956">(</span><span class="ident" id="4849957">c</span><span class="op" id="4849958">.</span><span class="builtinfunc" id="4849959">close</span><span class="op" id="4849964">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4849967">return</span>&nbsp;<span class="ident" id="4849974">c</span><span class="op" id="4849975">.</span><span class="ident" id="4849976">err</span><br>
<span class="lineno"></span><span class="op" id="4849980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4849983">func</span>&nbsp;<span class="op" id="4849988">(</span><span class="ident" id="4849989">c</span>&nbsp;<span class="op" id="4849991">*</span><span class="ident" id="4849992">closeOnce</span><span class="op" id="4850001">)</span>&nbsp;<span class="builtinfunc" id="4850003">close</span><span class="op" id="4850008">(</span><span class="op" id="4850009">)</span>&nbsp;<span class="op" id="4850011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850014">c</span><span class="op" id="4850015">.</span><span class="ident" id="4850016">err</span>&nbsp;<span class="op" id="4850020">=</span>&nbsp;<span class="ident" id="4850022">c</span><span class="op" id="4850023">.</span><span class="ident" id="4850024">File</span><span class="op" id="4850028">.</span><span class="ident" id="4850029">Close</span><span class="op" id="4850034">(</span><span class="op" id="4850035">)</span><br>
<span class="lineno">450</span><span class="op" id="4850037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4850040">//&nbsp;StdoutPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4850109">//&nbsp;standard&nbsp;output&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="4850153">//</span><br>
<span class="lineno">455</span><span class="comment" id="4850156">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="4850231">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4850302">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="4850381">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Run&nbsp;when&nbsp;using&nbsp;StdoutPipe.</span><br>
<span class="lineno"></span><span class="comment" id="4850456">//&nbsp;See&nbsp;the&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">460</span><span class="keyword" id="4850496">func</span>&nbsp;<span class="op" id="4850501">(</span><span class="ident" id="4850502">c</span>&nbsp;<span class="op" id="4850504">*</span><span class="ident" id="4850505">Cmd</span><span class="op" id="4850508">)</span>&nbsp;<span class="ident" id="4850510">StdoutPipe</span><span class="op" id="4850520">(</span><span class="op" id="4850521">)</span>&nbsp;<span class="op" id="4850523">(</span><span class="ident" id="4850524">io</span><span class="op" id="4850526">.</span><span class="ident" id="4850527">ReadCloser</span><span class="op" id="4850537">,</span>&nbsp;<span class="builtintype" id="4850539">error</span><span class="op" id="4850544">)</span>&nbsp;<span class="op" id="4850546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850549">if</span>&nbsp;<span class="ident" id="4850552">c</span><span class="op" id="4850553">.</span><span class="ident" id="4850554">Stdout</span>&nbsp;<span class="op" id="4850561">!=</span>&nbsp;<span class="ident" id="4850564">nil</span>&nbsp;<span class="op" id="4850568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850572">return</span>&nbsp;<span class="ident" id="4850579">nil</span><span class="op" id="4850582">,</span>&nbsp;<span class="ident" id="4850584">errors</span><span class="op" id="4850590">.</span><span class="ident" id="4850591">New</span><span class="op" id="4850594">(</span><span class="string" id="4850595">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="4850621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4850624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850627">if</span>&nbsp;<span class="ident" id="4850630">c</span><span class="op" id="4850631">.</span><span class="ident" id="4850632">Process</span>&nbsp;<span class="op" id="4850640">!=</span>&nbsp;<span class="ident" id="4850643">nil</span>&nbsp;<span class="op" id="4850647">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850651">return</span>&nbsp;<span class="ident" id="4850658">nil</span><span class="op" id="4850661">,</span>&nbsp;<span class="ident" id="4850663">errors</span><span class="op" id="4850669">.</span><span class="ident" id="4850670">New</span><span class="op" id="4850673">(</span><span class="string" id="4850674">&#34;exec:&nbsp;StdoutPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="4850714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4850717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850720">pr</span><span class="op" id="4850722">,</span>&nbsp;<span class="ident" id="4850724">pw</span><span class="op" id="4850726">,</span>&nbsp;<span class="ident" id="4850728">err</span>&nbsp;<span class="op" id="4850732">:=</span>&nbsp;<span class="ident" id="4850735">os</span><span class="op" id="4850737">.</span><span class="ident" id="4850738">Pipe</span><span class="op" id="4850742">(</span><span class="op" id="4850743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850746">if</span>&nbsp;<span class="ident" id="4850749">err</span>&nbsp;<span class="op" id="4850753">!=</span>&nbsp;<span class="ident" id="4850756">nil</span>&nbsp;<span class="op" id="4850760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850764">return</span>&nbsp;<span class="ident" id="4850771">nil</span><span class="op" id="4850774">,</span>&nbsp;<span class="ident" id="4850776">err</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4850781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850784">c</span><span class="op" id="4850785">.</span><span class="ident" id="4850786">Stdout</span>&nbsp;<span class="op" id="4850793">=</span>&nbsp;<span class="ident" id="4850795">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850799">c</span><span class="op" id="4850800">.</span><span class="ident" id="4850801">closeAfterStart</span>&nbsp;<span class="op" id="4850817">=</span>&nbsp;<span class="builtinfunc" id="4850819">append</span><span class="op" id="4850825">(</span><span class="ident" id="4850826">c</span><span class="op" id="4850827">.</span><span class="ident" id="4850828">closeAfterStart</span><span class="op" id="4850843">,</span>&nbsp;<span class="ident" id="4850845">pw</span><span class="op" id="4850847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4850850">c</span><span class="op" id="4850851">.</span><span class="ident" id="4850852">closeAfterWait</span>&nbsp;<span class="op" id="4850867">=</span>&nbsp;<span class="builtinfunc" id="4850869">append</span><span class="op" id="4850875">(</span><span class="ident" id="4850876">c</span><span class="op" id="4850877">.</span><span class="ident" id="4850878">closeAfterWait</span><span class="op" id="4850892">,</span>&nbsp;<span class="ident" id="4850894">pr</span><span class="op" id="4850896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4850899">return</span>&nbsp;<span class="ident" id="4850906">pr</span><span class="op" id="4850908">,</span>&nbsp;<span class="ident" id="4850910">nil</span><br>
<span class="lineno">475</span><span class="op" id="4850914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4850917">//&nbsp;StderrPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4850986">//&nbsp;standard&nbsp;error&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="4851029">//</span><br>
<span class="lineno">480</span><span class="comment" id="4851032">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="4851107">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4851178">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="4851257">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;use&nbsp;Run&nbsp;when&nbsp;using&nbsp;StderrPipe.</span><br>
<span class="lineno"></span><span class="comment" id="4851331">//&nbsp;See&nbsp;the&nbsp;StdoutPipe&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">485</span><span class="keyword" id="4851382">func</span>&nbsp;<span class="op" id="4851387">(</span><span class="ident" id="4851388">c</span>&nbsp;<span class="op" id="4851390">*</span><span class="ident" id="4851391">Cmd</span><span class="op" id="4851394">)</span>&nbsp;<span class="ident" id="4851396">StderrPipe</span><span class="op" id="4851406">(</span><span class="op" id="4851407">)</span>&nbsp;<span class="op" id="4851409">(</span><span class="ident" id="4851410">io</span><span class="op" id="4851412">.</span><span class="ident" id="4851413">ReadCloser</span><span class="op" id="4851423">,</span>&nbsp;<span class="builtintype" id="4851425">error</span><span class="op" id="4851430">)</span>&nbsp;<span class="op" id="4851432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851435">if</span>&nbsp;<span class="ident" id="4851438">c</span><span class="op" id="4851439">.</span><span class="ident" id="4851440">Stderr</span>&nbsp;<span class="op" id="4851447">!=</span>&nbsp;<span class="ident" id="4851450">nil</span>&nbsp;<span class="op" id="4851454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851458">return</span>&nbsp;<span class="ident" id="4851465">nil</span><span class="op" id="4851468">,</span>&nbsp;<span class="ident" id="4851470">errors</span><span class="op" id="4851476">.</span><span class="ident" id="4851477">New</span><span class="op" id="4851480">(</span><span class="string" id="4851481">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="4851507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851513">if</span>&nbsp;<span class="ident" id="4851516">c</span><span class="op" id="4851517">.</span><span class="ident" id="4851518">Process</span>&nbsp;<span class="op" id="4851526">!=</span>&nbsp;<span class="ident" id="4851529">nil</span>&nbsp;<span class="op" id="4851533">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851537">return</span>&nbsp;<span class="ident" id="4851544">nil</span><span class="op" id="4851547">,</span>&nbsp;<span class="ident" id="4851549">errors</span><span class="op" id="4851555">.</span><span class="ident" id="4851556">New</span><span class="op" id="4851559">(</span><span class="string" id="4851560">&#34;exec:&nbsp;StderrPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="4851600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851606">pr</span><span class="op" id="4851608">,</span>&nbsp;<span class="ident" id="4851610">pw</span><span class="op" id="4851612">,</span>&nbsp;<span class="ident" id="4851614">err</span>&nbsp;<span class="op" id="4851618">:=</span>&nbsp;<span class="ident" id="4851621">os</span><span class="op" id="4851623">.</span><span class="ident" id="4851624">Pipe</span><span class="op" id="4851628">(</span><span class="op" id="4851629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851632">if</span>&nbsp;<span class="ident" id="4851635">err</span>&nbsp;<span class="op" id="4851639">!=</span>&nbsp;<span class="ident" id="4851642">nil</span>&nbsp;<span class="op" id="4851646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851650">return</span>&nbsp;<span class="ident" id="4851657">nil</span><span class="op" id="4851660">,</span>&nbsp;<span class="ident" id="4851662">err</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4851667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851670">c</span><span class="op" id="4851671">.</span><span class="ident" id="4851672">Stderr</span>&nbsp;<span class="op" id="4851679">=</span>&nbsp;<span class="ident" id="4851681">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851685">c</span><span class="op" id="4851686">.</span><span class="ident" id="4851687">closeAfterStart</span>&nbsp;<span class="op" id="4851703">=</span>&nbsp;<span class="builtinfunc" id="4851705">append</span><span class="op" id="4851711">(</span><span class="ident" id="4851712">c</span><span class="op" id="4851713">.</span><span class="ident" id="4851714">closeAfterStart</span><span class="op" id="4851729">,</span>&nbsp;<span class="ident" id="4851731">pw</span><span class="op" id="4851733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4851736">c</span><span class="op" id="4851737">.</span><span class="ident" id="4851738">closeAfterWait</span>&nbsp;<span class="op" id="4851753">=</span>&nbsp;<span class="builtinfunc" id="4851755">append</span><span class="op" id="4851761">(</span><span class="ident" id="4851762">c</span><span class="op" id="4851763">.</span><span class="ident" id="4851764">closeAfterWait</span><span class="op" id="4851778">,</span>&nbsp;<span class="ident" id="4851780">pr</span><span class="op" id="4851782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4851785">return</span>&nbsp;<span class="ident" id="4851792">pr</span><span class="op" id="4851794">,</span>&nbsp;<span class="ident" id="4851796">nil</span><br>
<span class="lineno">500</span><span class="op" id="4851800">}</span>
</div>
</body>
</html>
