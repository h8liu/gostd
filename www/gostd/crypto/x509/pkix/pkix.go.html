<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509/pkix</h2>
<ul>
<li><a href="/gostd/crypto/x509/pkix/pkix.go.html" class="current">pkix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4651553">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4651608">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4651662">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4651713">//&nbsp;Package&nbsp;pkix&nbsp;contains&nbsp;shared,&nbsp;low&nbsp;level&nbsp;structures&nbsp;used&nbsp;for&nbsp;ASN.1&nbsp;parsing</span><br>
<span class="lineno"></span><span class="comment" id="4651790">//&nbsp;and&nbsp;serialization&nbsp;of&nbsp;X.509&nbsp;certificates,&nbsp;CRL&nbsp;and&nbsp;OCSP.</span><br>
<span class="lineno"></span><span class="keyword" id="4651848">package</span>&nbsp;<span class="ident" id="4651856">pkix</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4651862">import</span>&nbsp;<span class="op" id="4651869">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4651872">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4651889">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4651901">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4651908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4651911">//&nbsp;AlgorithmIdentifier&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4651991">//&nbsp;5280,&nbsp;section&nbsp;4.1.1.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4652017">type</span>&nbsp;<span class="ident" id="4652022">AlgorithmIdentifier</span>&nbsp;<span class="keyword" id="4652042">struct</span>&nbsp;<span class="op" id="4652049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652052">Algorithm</span>&nbsp;&nbsp;<span class="ident" id="4652063">asn1</span><span class="op" id="4652067">.</span><span class="ident" id="4652068">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652086">Parameters</span>&nbsp;<span class="ident" id="4652097">asn1</span><span class="op" id="4652101">.</span><span class="ident" id="4652102">RawValue</span>&nbsp;<span class="string" id="4652111">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">20</span><span class="op" id="4652129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4652132">type</span>&nbsp;<span class="ident" id="4652137">RDNSequence</span>&nbsp;<span class="op" id="4652149">[</span><span class="op" id="4652150">]</span><span class="ident" id="4652151">RelativeDistinguishedNameSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4652181">type</span>&nbsp;<span class="ident" id="4652186">RelativeDistinguishedNameSET</span>&nbsp;<span class="op" id="4652215">[</span><span class="op" id="4652216">]</span><span class="ident" id="4652217">AttributeTypeAndValue</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4652240">//&nbsp;AttributeTypeAndValue&nbsp;mirrors&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4652313">//&nbsp;http://tools.ietf.org/html/rfc5280#section-4.1.2.4</span><br>
<span class="lineno"></span><span class="keyword" id="4652367">type</span>&nbsp;<span class="ident" id="4652372">AttributeTypeAndValue</span>&nbsp;<span class="keyword" id="4652394">struct</span>&nbsp;<span class="op" id="4652401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652404">Type</span>&nbsp;&nbsp;<span class="ident" id="4652410">asn1</span><span class="op" id="4652414">.</span><span class="ident" id="4652415">ObjectIdentifier</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652433">Value</span>&nbsp;<span class="keyword" id="4652439">interface</span><span class="op" id="4652448">{</span><span class="op" id="4652449">}</span><br>
<span class="lineno"></span><span class="op" id="4652451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4652454">//&nbsp;AttributeTypeAndValueSET&nbsp;represents&nbsp;a&nbsp;set&nbsp;of&nbsp;ASN.1&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4652521">//&nbsp;AttributeTypeAndValue&nbsp;sequences&nbsp;from&nbsp;RFC&nbsp;2986&nbsp;(PKCS&nbsp;#10).</span><br>
<span class="lineno">35</span><span class="keyword" id="4652582">type</span>&nbsp;<span class="ident" id="4652587">AttributeTypeAndValueSET</span>&nbsp;<span class="keyword" id="4652612">struct</span>&nbsp;<span class="op" id="4652619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652622">Type</span>&nbsp;&nbsp;<span class="ident" id="4652628">asn1</span><span class="op" id="4652632">.</span><span class="ident" id="4652633">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652651">Value</span>&nbsp;<span class="op" id="4652657">[</span><span class="op" id="4652658">]</span><span class="op" id="4652659">[</span><span class="op" id="4652660">]</span><span class="ident" id="4652661">AttributeTypeAndValue</span>&nbsp;<span class="string" id="4652683">`asn1:&#34;set&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4652696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4652699">//&nbsp;Extension&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4652769">//&nbsp;5280,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4652791">type</span>&nbsp;<span class="ident" id="4652796">Extension</span>&nbsp;<span class="keyword" id="4652806">struct</span>&nbsp;<span class="op" id="4652813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652816">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652825">asn1</span><span class="op" id="4652829">.</span><span class="ident" id="4652830">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652848">Critical</span>&nbsp;<span class="builtintype" id="4652857">bool</span>&nbsp;<span class="string" id="4652862">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4652881">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4652890">[</span><span class="op" id="4652891">]</span><span class="builtintype" id="4652892">byte</span><br>
<span class="lineno"></span><span class="op" id="4652897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4652900">//&nbsp;Name&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;distinguished&nbsp;name.&nbsp;This&nbsp;only&nbsp;includes&nbsp;the&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="4652978">//&nbsp;elements&nbsp;of&nbsp;a&nbsp;DN.&nbsp;&nbsp;Additional&nbsp;elements&nbsp;in&nbsp;the&nbsp;name&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">50</span><span class="keyword" id="4653045">type</span>&nbsp;<span class="ident" id="4653050">Name</span>&nbsp;<span class="keyword" id="4653055">struct</span>&nbsp;<span class="op" id="4653062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653065">Country</span><span class="op" id="4653072">,</span>&nbsp;<span class="ident" id="4653074">Organization</span><span class="op" id="4653086">,</span>&nbsp;<span class="ident" id="4653088">OrganizationalUnit</span>&nbsp;<span class="op" id="4653107">[</span><span class="op" id="4653108">]</span><span class="builtintype" id="4653109">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653117">Locality</span><span class="op" id="4653125">,</span>&nbsp;<span class="ident" id="4653127">Province</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4653159">[</span><span class="op" id="4653160">]</span><span class="builtintype" id="4653161">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653169">StreetAddress</span><span class="op" id="4653182">,</span>&nbsp;<span class="ident" id="4653184">PostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4653211">[</span><span class="op" id="4653212">]</span><span class="builtintype" id="4653213">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653221">SerialNumber</span><span class="op" id="4653233">,</span>&nbsp;<span class="ident" id="4653235">CommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4653263">string</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653272">Names</span>&nbsp;<span class="op" id="4653278">[</span><span class="op" id="4653279">]</span><span class="ident" id="4653280">AttributeTypeAndValue</span><br>
<span class="lineno"></span><span class="op" id="4653302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4653305">func</span>&nbsp;<span class="op" id="4653310">(</span><span class="ident" id="4653311">n</span>&nbsp;<span class="op" id="4653313">*</span><span class="ident" id="4653314">Name</span><span class="op" id="4653318">)</span>&nbsp;<span class="ident" id="4653320">FillFromRDNSequence</span><span class="op" id="4653339">(</span><span class="ident" id="4653340">rdns</span>&nbsp;<span class="op" id="4653345">*</span><span class="ident" id="4653346">RDNSequence</span><span class="op" id="4653357">)</span>&nbsp;<span class="op" id="4653359">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653362">for</span>&nbsp;<span class="ident" id="4653366">_</span><span class="op" id="4653367">,</span>&nbsp;<span class="ident" id="4653369">rdn</span>&nbsp;<span class="op" id="4653373">:=</span>&nbsp;<span class="keyword" id="4653376">range</span>&nbsp;<span class="op" id="4653382">*</span><span class="ident" id="4653383">rdns</span>&nbsp;<span class="op" id="4653388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653392">if</span>&nbsp;<span class="builtinfunc" id="4653395">len</span><span class="op" id="4653398">(</span><span class="ident" id="4653399">rdn</span><span class="op" id="4653402">)</span>&nbsp;<span class="op" id="4653404">==</span>&nbsp;<span class="num" id="4653407">0</span>&nbsp;<span class="op" id="4653409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653414">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4653425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653429">atv</span>&nbsp;<span class="op" id="4653433">:=</span>&nbsp;<span class="ident" id="4653436">rdn</span><span class="op" id="4653439">[</span><span class="num" id="4653440">0</span><span class="op" id="4653441">]</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653445">n</span><span class="op" id="4653446">.</span><span class="ident" id="4653447">Names</span>&nbsp;<span class="op" id="4653453">=</span>&nbsp;<span class="builtinfunc" id="4653455">append</span><span class="op" id="4653461">(</span><span class="ident" id="4653462">n</span><span class="op" id="4653463">.</span><span class="ident" id="4653464">Names</span><span class="op" id="4653469">,</span>&nbsp;<span class="ident" id="4653471">atv</span><span class="op" id="4653474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653478">value</span><span class="op" id="4653483">,</span>&nbsp;<span class="ident" id="4653485">ok</span>&nbsp;<span class="op" id="4653488">:=</span>&nbsp;<span class="ident" id="4653491">atv</span><span class="op" id="4653494">.</span><span class="ident" id="4653495">Value</span><span class="op" id="4653500">.</span><span class="op" id="4653501">(</span><span class="builtintype" id="4653502">string</span><span class="op" id="4653508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653512">if</span>&nbsp;<span class="op" id="4653515">!</span><span class="ident" id="4653516">ok</span>&nbsp;<span class="op" id="4653519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653524">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4653535">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653540">t</span>&nbsp;<span class="op" id="4653542">:=</span>&nbsp;<span class="ident" id="4653545">atv</span><span class="op" id="4653548">.</span><span class="ident" id="4653549">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653556">if</span>&nbsp;<span class="builtinfunc" id="4653559">len</span><span class="op" id="4653562">(</span><span class="ident" id="4653563">t</span><span class="op" id="4653564">)</span>&nbsp;<span class="op" id="4653566">==</span>&nbsp;<span class="num" id="4653569">4</span>&nbsp;<span class="op" id="4653571">&amp;&amp;</span>&nbsp;<span class="ident" id="4653574">t</span><span class="op" id="4653575">[</span><span class="num" id="4653576">0</span><span class="op" id="4653577">]</span>&nbsp;<span class="op" id="4653579">==</span>&nbsp;<span class="num" id="4653582">2</span>&nbsp;<span class="op" id="4653584">&amp;&amp;</span>&nbsp;<span class="ident" id="4653587">t</span><span class="op" id="4653588">[</span><span class="num" id="4653589">1</span><span class="op" id="4653590">]</span>&nbsp;<span class="op" id="4653592">==</span>&nbsp;<span class="num" id="4653595">5</span>&nbsp;<span class="op" id="4653597">&amp;&amp;</span>&nbsp;<span class="ident" id="4653600">t</span><span class="op" id="4653601">[</span><span class="num" id="4653602">2</span><span class="op" id="4653603">]</span>&nbsp;<span class="op" id="4653605">==</span>&nbsp;<span class="num" id="4653608">4</span>&nbsp;<span class="op" id="4653610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653615">switch</span>&nbsp;<span class="ident" id="4653622">t</span><span class="op" id="4653623">[</span><span class="num" id="4653624">3</span><span class="op" id="4653625">]</span>&nbsp;<span class="op" id="4653627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653632">case</span>&nbsp;<span class="num" id="4653637">3</span><span class="op" id="4653638">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653644">n</span><span class="op" id="4653645">.</span><span class="ident" id="4653646">CommonName</span>&nbsp;<span class="op" id="4653657">=</span>&nbsp;<span class="ident" id="4653659">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653668">case</span>&nbsp;<span class="num" id="4653673">5</span><span class="op" id="4653674">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653680">n</span><span class="op" id="4653681">.</span><span class="ident" id="4653682">SerialNumber</span>&nbsp;<span class="op" id="4653695">=</span>&nbsp;<span class="ident" id="4653697">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653706">case</span>&nbsp;<span class="num" id="4653711">6</span><span class="op" id="4653712">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653718">n</span><span class="op" id="4653719">.</span><span class="ident" id="4653720">Country</span>&nbsp;<span class="op" id="4653728">=</span>&nbsp;<span class="builtinfunc" id="4653730">append</span><span class="op" id="4653736">(</span><span class="ident" id="4653737">n</span><span class="op" id="4653738">.</span><span class="ident" id="4653739">Country</span><span class="op" id="4653746">,</span>&nbsp;<span class="ident" id="4653748">value</span><span class="op" id="4653753">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653758">case</span>&nbsp;<span class="num" id="4653763">7</span><span class="op" id="4653764">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653770">n</span><span class="op" id="4653771">.</span><span class="ident" id="4653772">Locality</span>&nbsp;<span class="op" id="4653781">=</span>&nbsp;<span class="builtinfunc" id="4653783">append</span><span class="op" id="4653789">(</span><span class="ident" id="4653790">n</span><span class="op" id="4653791">.</span><span class="ident" id="4653792">Locality</span><span class="op" id="4653800">,</span>&nbsp;<span class="ident" id="4653802">value</span><span class="op" id="4653807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653812">case</span>&nbsp;<span class="num" id="4653817">8</span><span class="op" id="4653818">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653824">n</span><span class="op" id="4653825">.</span><span class="ident" id="4653826">Province</span>&nbsp;<span class="op" id="4653835">=</span>&nbsp;<span class="builtinfunc" id="4653837">append</span><span class="op" id="4653843">(</span><span class="ident" id="4653844">n</span><span class="op" id="4653845">.</span><span class="ident" id="4653846">Province</span><span class="op" id="4653854">,</span>&nbsp;<span class="ident" id="4653856">value</span><span class="op" id="4653861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653866">case</span>&nbsp;<span class="num" id="4653871">9</span><span class="op" id="4653872">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653878">n</span><span class="op" id="4653879">.</span><span class="ident" id="4653880">StreetAddress</span>&nbsp;<span class="op" id="4653894">=</span>&nbsp;<span class="builtinfunc" id="4653896">append</span><span class="op" id="4653902">(</span><span class="ident" id="4653903">n</span><span class="op" id="4653904">.</span><span class="ident" id="4653905">StreetAddress</span><span class="op" id="4653918">,</span>&nbsp;<span class="ident" id="4653920">value</span><span class="op" id="4653925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653930">case</span>&nbsp;<span class="num" id="4653935">10</span><span class="op" id="4653937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4653943">n</span><span class="op" id="4653944">.</span><span class="ident" id="4653945">Organization</span>&nbsp;<span class="op" id="4653958">=</span>&nbsp;<span class="builtinfunc" id="4653960">append</span><span class="op" id="4653966">(</span><span class="ident" id="4653967">n</span><span class="op" id="4653968">.</span><span class="ident" id="4653969">Organization</span><span class="op" id="4653981">,</span>&nbsp;<span class="ident" id="4653983">value</span><span class="op" id="4653988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4653993">case</span>&nbsp;<span class="num" id="4653998">11</span><span class="op" id="4654000">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654006">n</span><span class="op" id="4654007">.</span><span class="ident" id="4654008">OrganizationalUnit</span>&nbsp;<span class="op" id="4654027">=</span>&nbsp;<span class="builtinfunc" id="4654029">append</span><span class="op" id="4654035">(</span><span class="ident" id="4654036">n</span><span class="op" id="4654037">.</span><span class="ident" id="4654038">OrganizationalUnit</span><span class="op" id="4654056">,</span>&nbsp;<span class="ident" id="4654058">value</span><span class="op" id="4654063">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4654068">case</span>&nbsp;<span class="num" id="4654073">17</span><span class="op" id="4654075">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654081">n</span><span class="op" id="4654082">.</span><span class="ident" id="4654083">PostalCode</span>&nbsp;<span class="op" id="4654094">=</span>&nbsp;<span class="builtinfunc" id="4654096">append</span><span class="op" id="4654102">(</span><span class="ident" id="4654103">n</span><span class="op" id="4654104">.</span><span class="ident" id="4654105">PostalCode</span><span class="op" id="4654115">,</span>&nbsp;<span class="ident" id="4654117">value</span><span class="op" id="4654122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654134">}</span><br>
<span class="lineno">95</span><span class="op" id="4654136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4654139">var</span>&nbsp;<span class="op" id="4654143">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654146">oidCountry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654168">=</span>&nbsp;<span class="op" id="4654170">[</span><span class="op" id="4654171">]</span><span class="builtintype" id="4654172">int</span><span class="op" id="4654175">{</span><span class="num" id="4654176">2</span><span class="op" id="4654177">,</span>&nbsp;<span class="num" id="4654179">5</span><span class="op" id="4654180">,</span>&nbsp;<span class="num" id="4654182">4</span><span class="op" id="4654183">,</span>&nbsp;<span class="num" id="4654185">6</span><span class="op" id="4654186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654189">oidOrganization</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654211">=</span>&nbsp;<span class="op" id="4654213">[</span><span class="op" id="4654214">]</span><span class="builtintype" id="4654215">int</span><span class="op" id="4654218">{</span><span class="num" id="4654219">2</span><span class="op" id="4654220">,</span>&nbsp;<span class="num" id="4654222">5</span><span class="op" id="4654223">,</span>&nbsp;<span class="num" id="4654225">4</span><span class="op" id="4654226">,</span>&nbsp;<span class="num" id="4654228">10</span><span class="op" id="4654230">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654233">oidOrganizationalUnit</span>&nbsp;<span class="op" id="4654255">=</span>&nbsp;<span class="op" id="4654257">[</span><span class="op" id="4654258">]</span><span class="builtintype" id="4654259">int</span><span class="op" id="4654262">{</span><span class="num" id="4654263">2</span><span class="op" id="4654264">,</span>&nbsp;<span class="num" id="4654266">5</span><span class="op" id="4654267">,</span>&nbsp;<span class="num" id="4654269">4</span><span class="op" id="4654270">,</span>&nbsp;<span class="num" id="4654272">11</span><span class="op" id="4654274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654277">oidCommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654299">=</span>&nbsp;<span class="op" id="4654301">[</span><span class="op" id="4654302">]</span><span class="builtintype" id="4654303">int</span><span class="op" id="4654306">{</span><span class="num" id="4654307">2</span><span class="op" id="4654308">,</span>&nbsp;<span class="num" id="4654310">5</span><span class="op" id="4654311">,</span>&nbsp;<span class="num" id="4654313">4</span><span class="op" id="4654314">,</span>&nbsp;<span class="num" id="4654316">3</span><span class="op" id="4654317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654320">oidSerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654342">=</span>&nbsp;<span class="op" id="4654344">[</span><span class="op" id="4654345">]</span><span class="builtintype" id="4654346">int</span><span class="op" id="4654349">{</span><span class="num" id="4654350">2</span><span class="op" id="4654351">,</span>&nbsp;<span class="num" id="4654353">5</span><span class="op" id="4654354">,</span>&nbsp;<span class="num" id="4654356">4</span><span class="op" id="4654357">,</span>&nbsp;<span class="num" id="4654359">5</span><span class="op" id="4654360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654363">oidLocality</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654385">=</span>&nbsp;<span class="op" id="4654387">[</span><span class="op" id="4654388">]</span><span class="builtintype" id="4654389">int</span><span class="op" id="4654392">{</span><span class="num" id="4654393">2</span><span class="op" id="4654394">,</span>&nbsp;<span class="num" id="4654396">5</span><span class="op" id="4654397">,</span>&nbsp;<span class="num" id="4654399">4</span><span class="op" id="4654400">,</span>&nbsp;<span class="num" id="4654402">7</span><span class="op" id="4654403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654406">oidProvince</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654428">=</span>&nbsp;<span class="op" id="4654430">[</span><span class="op" id="4654431">]</span><span class="builtintype" id="4654432">int</span><span class="op" id="4654435">{</span><span class="num" id="4654436">2</span><span class="op" id="4654437">,</span>&nbsp;<span class="num" id="4654439">5</span><span class="op" id="4654440">,</span>&nbsp;<span class="num" id="4654442">4</span><span class="op" id="4654443">,</span>&nbsp;<span class="num" id="4654445">8</span><span class="op" id="4654446">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654449">oidStreetAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654471">=</span>&nbsp;<span class="op" id="4654473">[</span><span class="op" id="4654474">]</span><span class="builtintype" id="4654475">int</span><span class="op" id="4654478">{</span><span class="num" id="4654479">2</span><span class="op" id="4654480">,</span>&nbsp;<span class="num" id="4654482">5</span><span class="op" id="4654483">,</span>&nbsp;<span class="num" id="4654485">4</span><span class="op" id="4654486">,</span>&nbsp;<span class="num" id="4654488">9</span><span class="op" id="4654489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654492">oidPostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654514">=</span>&nbsp;<span class="op" id="4654516">[</span><span class="op" id="4654517">]</span><span class="builtintype" id="4654518">int</span><span class="op" id="4654521">{</span><span class="num" id="4654522">2</span><span class="op" id="4654523">,</span>&nbsp;<span class="num" id="4654525">5</span><span class="op" id="4654526">,</span>&nbsp;<span class="num" id="4654528">4</span><span class="op" id="4654529">,</span>&nbsp;<span class="num" id="4654531">17</span><span class="op" id="4654533">}</span><br>
<span class="lineno"></span><span class="op" id="4654535">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4654538">//&nbsp;appendRDNs&nbsp;appends&nbsp;a&nbsp;relativeDistinguishedNameSET&nbsp;to&nbsp;the&nbsp;given&nbsp;RDNSequence</span><br>
<span class="lineno">110</span><span class="comment" id="4654616">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.&nbsp;The&nbsp;relativeDistinguishedNameSET&nbsp;contains&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4654691">//&nbsp;attributeTypeAndValue&nbsp;for&nbsp;each&nbsp;of&nbsp;the&nbsp;given&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;5280,&nbsp;A.1,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4654769">//&nbsp;search&nbsp;for&nbsp;AttributeTypeAndValue.</span><br>
<span class="lineno"></span><span class="keyword" id="4654806">func</span>&nbsp;<span class="ident" id="4654811">appendRDNs</span><span class="op" id="4654821">(</span><span class="ident" id="4654822">in</span>&nbsp;<span class="ident" id="4654825">RDNSequence</span><span class="op" id="4654836">,</span>&nbsp;<span class="ident" id="4654838">values</span>&nbsp;<span class="op" id="4654845">[</span><span class="op" id="4654846">]</span><span class="builtintype" id="4654847">string</span><span class="op" id="4654853">,</span>&nbsp;<span class="ident" id="4654855">oid</span>&nbsp;<span class="ident" id="4654859">asn1</span><span class="op" id="4654863">.</span><span class="ident" id="4654864">ObjectIdentifier</span><span class="op" id="4654880">)</span>&nbsp;<span class="ident" id="4654882">RDNSequence</span>&nbsp;<span class="op" id="4654894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4654897">if</span>&nbsp;<span class="builtinfunc" id="4654900">len</span><span class="op" id="4654903">(</span><span class="ident" id="4654904">values</span><span class="op" id="4654910">)</span>&nbsp;<span class="op" id="4654912">==</span>&nbsp;<span class="num" id="4654915">0</span>&nbsp;<span class="op" id="4654917">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4654921">return</span>&nbsp;<span class="ident" id="4654928">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4654932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4654936">s</span>&nbsp;<span class="op" id="4654938">:=</span>&nbsp;<span class="builtinfunc" id="4654941">make</span><span class="op" id="4654945">(</span><span class="op" id="4654946">[</span><span class="op" id="4654947">]</span><span class="ident" id="4654948">AttributeTypeAndValue</span><span class="op" id="4654969">,</span>&nbsp;<span class="builtinfunc" id="4654971">len</span><span class="op" id="4654974">(</span><span class="ident" id="4654975">values</span><span class="op" id="4654981">)</span><span class="op" id="4654982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4654985">for</span>&nbsp;<span class="ident" id="4654989">i</span><span class="op" id="4654990">,</span>&nbsp;<span class="ident" id="4654992">value</span>&nbsp;<span class="op" id="4654998">:=</span>&nbsp;<span class="keyword" id="4655001">range</span>&nbsp;<span class="ident" id="4655007">values</span>&nbsp;<span class="op" id="4655014">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655018">s</span><span class="op" id="4655019">[</span><span class="ident" id="4655020">i</span><span class="op" id="4655021">]</span><span class="op" id="4655022">.</span><span class="ident" id="4655023">Type</span>&nbsp;<span class="op" id="4655028">=</span>&nbsp;<span class="ident" id="4655030">oid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655036">s</span><span class="op" id="4655037">[</span><span class="ident" id="4655038">i</span><span class="op" id="4655039">]</span><span class="op" id="4655040">.</span><span class="ident" id="4655041">Value</span>&nbsp;<span class="op" id="4655047">=</span>&nbsp;<span class="ident" id="4655049">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4655056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655060">return</span>&nbsp;<span class="builtinfunc" id="4655067">append</span><span class="op" id="4655073">(</span><span class="ident" id="4655074">in</span><span class="op" id="4655076">,</span>&nbsp;<span class="ident" id="4655078">s</span><span class="op" id="4655079">)</span><br>
<span class="lineno">125</span><span class="op" id="4655081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4655084">func</span>&nbsp;<span class="op" id="4655089">(</span><span class="ident" id="4655090">n</span>&nbsp;<span class="ident" id="4655092">Name</span><span class="op" id="4655096">)</span>&nbsp;<span class="ident" id="4655098">ToRDNSequence</span><span class="op" id="4655111">(</span><span class="op" id="4655112">)</span>&nbsp;<span class="op" id="4655114">(</span><span class="ident" id="4655115">ret</span>&nbsp;<span class="ident" id="4655119">RDNSequence</span><span class="op" id="4655130">)</span>&nbsp;<span class="op" id="4655132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655135">ret</span>&nbsp;<span class="op" id="4655139">=</span>&nbsp;<span class="ident" id="4655141">appendRDNs</span><span class="op" id="4655151">(</span><span class="ident" id="4655152">ret</span><span class="op" id="4655155">,</span>&nbsp;<span class="ident" id="4655157">n</span><span class="op" id="4655158">.</span><span class="ident" id="4655159">Country</span><span class="op" id="4655166">,</span>&nbsp;<span class="ident" id="4655168">oidCountry</span><span class="op" id="4655178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655181">ret</span>&nbsp;<span class="op" id="4655185">=</span>&nbsp;<span class="ident" id="4655187">appendRDNs</span><span class="op" id="4655197">(</span><span class="ident" id="4655198">ret</span><span class="op" id="4655201">,</span>&nbsp;<span class="ident" id="4655203">n</span><span class="op" id="4655204">.</span><span class="ident" id="4655205">Organization</span><span class="op" id="4655217">,</span>&nbsp;<span class="ident" id="4655219">oidOrganization</span><span class="op" id="4655234">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655237">ret</span>&nbsp;<span class="op" id="4655241">=</span>&nbsp;<span class="ident" id="4655243">appendRDNs</span><span class="op" id="4655253">(</span><span class="ident" id="4655254">ret</span><span class="op" id="4655257">,</span>&nbsp;<span class="ident" id="4655259">n</span><span class="op" id="4655260">.</span><span class="ident" id="4655261">OrganizationalUnit</span><span class="op" id="4655279">,</span>&nbsp;<span class="ident" id="4655281">oidOrganizationalUnit</span><span class="op" id="4655302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655305">ret</span>&nbsp;<span class="op" id="4655309">=</span>&nbsp;<span class="ident" id="4655311">appendRDNs</span><span class="op" id="4655321">(</span><span class="ident" id="4655322">ret</span><span class="op" id="4655325">,</span>&nbsp;<span class="ident" id="4655327">n</span><span class="op" id="4655328">.</span><span class="ident" id="4655329">Locality</span><span class="op" id="4655337">,</span>&nbsp;<span class="ident" id="4655339">oidLocality</span><span class="op" id="4655350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655353">ret</span>&nbsp;<span class="op" id="4655357">=</span>&nbsp;<span class="ident" id="4655359">appendRDNs</span><span class="op" id="4655369">(</span><span class="ident" id="4655370">ret</span><span class="op" id="4655373">,</span>&nbsp;<span class="ident" id="4655375">n</span><span class="op" id="4655376">.</span><span class="ident" id="4655377">Province</span><span class="op" id="4655385">,</span>&nbsp;<span class="ident" id="4655387">oidProvince</span><span class="op" id="4655398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655401">ret</span>&nbsp;<span class="op" id="4655405">=</span>&nbsp;<span class="ident" id="4655407">appendRDNs</span><span class="op" id="4655417">(</span><span class="ident" id="4655418">ret</span><span class="op" id="4655421">,</span>&nbsp;<span class="ident" id="4655423">n</span><span class="op" id="4655424">.</span><span class="ident" id="4655425">StreetAddress</span><span class="op" id="4655438">,</span>&nbsp;<span class="ident" id="4655440">oidStreetAddress</span><span class="op" id="4655456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655459">ret</span>&nbsp;<span class="op" id="4655463">=</span>&nbsp;<span class="ident" id="4655465">appendRDNs</span><span class="op" id="4655475">(</span><span class="ident" id="4655476">ret</span><span class="op" id="4655479">,</span>&nbsp;<span class="ident" id="4655481">n</span><span class="op" id="4655482">.</span><span class="ident" id="4655483">PostalCode</span><span class="op" id="4655493">,</span>&nbsp;<span class="ident" id="4655495">oidPostalCode</span><span class="op" id="4655508">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655511">if</span>&nbsp;<span class="builtinfunc" id="4655514">len</span><span class="op" id="4655517">(</span><span class="ident" id="4655518">n</span><span class="op" id="4655519">.</span><span class="ident" id="4655520">CommonName</span><span class="op" id="4655530">)</span>&nbsp;<span class="op" id="4655532">&gt;</span>&nbsp;<span class="num" id="4655534">0</span>&nbsp;<span class="op" id="4655536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655540">ret</span>&nbsp;<span class="op" id="4655544">=</span>&nbsp;<span class="ident" id="4655546">appendRDNs</span><span class="op" id="4655556">(</span><span class="ident" id="4655557">ret</span><span class="op" id="4655560">,</span>&nbsp;<span class="op" id="4655562">[</span><span class="op" id="4655563">]</span><span class="builtintype" id="4655564">string</span><span class="op" id="4655570">{</span><span class="ident" id="4655571">n</span><span class="op" id="4655572">.</span><span class="ident" id="4655573">CommonName</span><span class="op" id="4655583">}</span><span class="op" id="4655584">,</span>&nbsp;<span class="ident" id="4655586">oidCommonName</span><span class="op" id="4655599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4655602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655605">if</span>&nbsp;<span class="builtinfunc" id="4655608">len</span><span class="op" id="4655611">(</span><span class="ident" id="4655612">n</span><span class="op" id="4655613">.</span><span class="ident" id="4655614">SerialNumber</span><span class="op" id="4655626">)</span>&nbsp;<span class="op" id="4655628">&gt;</span>&nbsp;<span class="num" id="4655630">0</span>&nbsp;<span class="op" id="4655632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655636">ret</span>&nbsp;<span class="op" id="4655640">=</span>&nbsp;<span class="ident" id="4655642">appendRDNs</span><span class="op" id="4655652">(</span><span class="ident" id="4655653">ret</span><span class="op" id="4655656">,</span>&nbsp;<span class="op" id="4655658">[</span><span class="op" id="4655659">]</span><span class="builtintype" id="4655660">string</span><span class="op" id="4655666">{</span><span class="ident" id="4655667">n</span><span class="op" id="4655668">.</span><span class="ident" id="4655669">SerialNumber</span><span class="op" id="4655681">}</span><span class="op" id="4655682">,</span>&nbsp;<span class="ident" id="4655684">oidSerialNumber</span><span class="op" id="4655699">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4655702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4655706">return</span>&nbsp;<span class="ident" id="4655713">ret</span><br>
<span class="lineno"></span><span class="op" id="4655717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="4655720">//&nbsp;CertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4655796">//&nbsp;5280,&nbsp;section&nbsp;5.1.&nbsp;Use&nbsp;Certificate.CheckCRLSignature&nbsp;to&nbsp;verify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4655866">//&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="4655880">type</span>&nbsp;<span class="ident" id="4655885">CertificateList</span>&nbsp;<span class="keyword" id="4655901">struct</span>&nbsp;<span class="op" id="4655908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655911">TBSCertList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655930">TBSCertificateList</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655950">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4655969">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4655990">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656009">asn1</span><span class="op" id="4656013">.</span><span class="ident" id="4656014">BitString</span><br>
<span class="lineno"></span><span class="op" id="4656024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4656027">//&nbsp;HasExpired&nbsp;reports&nbsp;whether&nbsp;now&nbsp;is&nbsp;past&nbsp;the&nbsp;expiry&nbsp;time&nbsp;of&nbsp;certList.</span><br>
<span class="lineno">155</span><span class="keyword" id="4656098">func</span>&nbsp;<span class="op" id="4656103">(</span><span class="ident" id="4656104">certList</span>&nbsp;<span class="op" id="4656113">*</span><span class="ident" id="4656114">CertificateList</span><span class="op" id="4656129">)</span>&nbsp;<span class="ident" id="4656131">HasExpired</span><span class="op" id="4656141">(</span><span class="ident" id="4656142">now</span>&nbsp;<span class="ident" id="4656146">time</span><span class="op" id="4656150">.</span><span class="ident" id="4656151">Time</span><span class="op" id="4656155">)</span>&nbsp;<span class="builtintype" id="4656157">bool</span>&nbsp;<span class="op" id="4656162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4656165">return</span>&nbsp;<span class="ident" id="4656172">now</span><span class="op" id="4656175">.</span><span class="ident" id="4656176">After</span><span class="op" id="4656181">(</span><span class="ident" id="4656182">certList</span><span class="op" id="4656190">.</span><span class="ident" id="4656191">TBSCertList</span><span class="op" id="4656202">.</span><span class="ident" id="4656203">NextUpdate</span><span class="op" id="4656213">)</span><br>
<span class="lineno"></span><span class="op" id="4656215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4656218">//&nbsp;TBSCertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno">160</span><span class="comment" id="4656297">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4656319">type</span>&nbsp;<span class="ident" id="4656324">TBSCertificateList</span>&nbsp;<span class="keyword" id="4656343">struct</span>&nbsp;<span class="op" id="4656350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656353">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656373">asn1</span><span class="op" id="4656377">.</span><span class="ident" id="4656378">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656390">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4656410">int</span>&nbsp;<span class="string" id="4656414">`asn1:&#34;optional,default:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656443">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656463">AlgorithmIdentifier</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656484">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656504">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656517">ThisUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656537">time</span><span class="op" id="4656541">.</span><span class="ident" id="4656542">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656548">NextUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656568">time</span><span class="op" id="4656572">.</span><span class="ident" id="4656573">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4656589">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656608">RevokedCertificates</span>&nbsp;<span class="op" id="4656628">[</span><span class="op" id="4656629">]</span><span class="ident" id="4656630">RevokedCertificate</span>&nbsp;<span class="string" id="4656649">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656668">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4656688">[</span><span class="op" id="4656689">]</span><span class="ident" id="4656690">Extension</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4656709">`asn1:&#34;tag:0,optional,explicit&#34;`</span><br>
<span class="lineno">170</span><span class="op" id="4656742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4656745">//&nbsp;RevokedCertificate&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4656824">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4656846">type</span>&nbsp;<span class="ident" id="4656851">RevokedCertificate</span>&nbsp;<span class="keyword" id="4656870">struct</span>&nbsp;<span class="op" id="4656877">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656880">SerialNumber</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4656895">*</span><span class="ident" id="4656896">big</span><span class="op" id="4656899">.</span><span class="ident" id="4656900">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656905">RevocationTime</span>&nbsp;<span class="ident" id="4656920">time</span><span class="op" id="4656924">.</span><span class="ident" id="4656925">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4656931">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4656946">[</span><span class="op" id="4656947">]</span><span class="ident" id="4656948">Extension</span>&nbsp;<span class="string" id="4656958">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4656976">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
