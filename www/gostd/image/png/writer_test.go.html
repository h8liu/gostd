<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/png</h2>
<ul>
<li><a href="/gostd/image/png/paeth.go.html">paeth.go</a></li>
<li><a href="/gostd/image/png/paeth_test.go.html">paeth_test.go</a></li>
<li><a href="/gostd/image/png/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/png/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/png/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/png/writer_test.go.html" class="current">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6500683">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6500738">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6500792">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6500843">package</span>&nbsp;<span class="ident" id="6500851">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6500856">import</span>&nbsp;<span class="op" id="6500863">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6500866">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6500875">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6500882">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6500891">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6500906">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6500919">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6500929">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6500932">func</span>&nbsp;<span class="ident" id="6500937">diff</span><span class="op" id="6500941">(</span><span class="ident" id="6500942">m0</span><span class="op" id="6500944">,</span>&nbsp;<span class="ident" id="6500946">m1</span>&nbsp;<span class="ident" id="6500949">image</span><span class="op" id="6500954">.</span><span class="ident" id="6500955">Image</span><span class="op" id="6500960">)</span>&nbsp;<span class="builtintype" id="6500962">error</span>&nbsp;<span class="op" id="6500968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6500971">b0</span><span class="op" id="6500973">,</span>&nbsp;<span class="ident" id="6500975">b1</span>&nbsp;<span class="op" id="6500978">:=</span>&nbsp;<span class="ident" id="6500981">m0</span><span class="op" id="6500983">.</span><span class="ident" id="6500984">Bounds</span><span class="op" id="6500990">(</span><span class="op" id="6500991">)</span><span class="op" id="6500992">,</span>&nbsp;<span class="ident" id="6500994">m1</span><span class="op" id="6500996">.</span><span class="ident" id="6500997">Bounds</span><span class="op" id="6501003">(</span><span class="op" id="6501004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501007">if</span>&nbsp;<span class="op" id="6501010">!</span><span class="ident" id="6501011">b0</span><span class="op" id="6501013">.</span><span class="ident" id="6501014">Size</span><span class="op" id="6501018">(</span><span class="op" id="6501019">)</span><span class="op" id="6501020">.</span><span class="ident" id="6501021">Eq</span><span class="op" id="6501023">(</span><span class="ident" id="6501024">b1</span><span class="op" id="6501026">.</span><span class="ident" id="6501027">Size</span><span class="op" id="6501031">(</span><span class="op" id="6501032">)</span><span class="op" id="6501033">)</span>&nbsp;<span class="op" id="6501035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501039">return</span>&nbsp;<span class="ident" id="6501046">fmt</span><span class="op" id="6501049">.</span><span class="ident" id="6501050">Errorf</span><span class="op" id="6501056">(</span><span class="string" id="6501057">&#34;dimensions&nbsp;differ:&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="6501086">,</span>&nbsp;<span class="ident" id="6501088">b0</span><span class="op" id="6501090">,</span>&nbsp;<span class="ident" id="6501092">b1</span><span class="op" id="6501094">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501100">dx</span>&nbsp;<span class="op" id="6501103">:=</span>&nbsp;<span class="ident" id="6501106">b1</span><span class="op" id="6501108">.</span><span class="ident" id="6501109">Min</span><span class="op" id="6501112">.</span><span class="ident" id="6501113">X</span>&nbsp;<span class="op" id="6501115">-</span>&nbsp;<span class="ident" id="6501117">b0</span><span class="op" id="6501119">.</span><span class="ident" id="6501120">Min</span><span class="op" id="6501123">.</span><span class="ident" id="6501124">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501127">dy</span>&nbsp;<span class="op" id="6501130">:=</span>&nbsp;<span class="ident" id="6501133">b1</span><span class="op" id="6501135">.</span><span class="ident" id="6501136">Min</span><span class="op" id="6501139">.</span><span class="ident" id="6501140">Y</span>&nbsp;<span class="op" id="6501142">-</span>&nbsp;<span class="ident" id="6501144">b0</span><span class="op" id="6501146">.</span><span class="ident" id="6501147">Min</span><span class="op" id="6501150">.</span><span class="ident" id="6501151">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501154">for</span>&nbsp;<span class="ident" id="6501158">y</span>&nbsp;<span class="op" id="6501160">:=</span>&nbsp;<span class="ident" id="6501163">b0</span><span class="op" id="6501165">.</span><span class="ident" id="6501166">Min</span><span class="op" id="6501169">.</span><span class="ident" id="6501170">Y</span><span class="op" id="6501171">;</span>&nbsp;<span class="ident" id="6501173">y</span>&nbsp;<span class="op" id="6501175">&lt;</span>&nbsp;<span class="ident" id="6501177">b0</span><span class="op" id="6501179">.</span><span class="ident" id="6501180">Max</span><span class="op" id="6501183">.</span><span class="ident" id="6501184">Y</span><span class="op" id="6501185">;</span>&nbsp;<span class="ident" id="6501187">y</span><span class="op" id="6501188">++</span>&nbsp;<span class="op" id="6501191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501195">for</span>&nbsp;<span class="ident" id="6501199">x</span>&nbsp;<span class="op" id="6501201">:=</span>&nbsp;<span class="ident" id="6501204">b0</span><span class="op" id="6501206">.</span><span class="ident" id="6501207">Min</span><span class="op" id="6501210">.</span><span class="ident" id="6501211">X</span><span class="op" id="6501212">;</span>&nbsp;<span class="ident" id="6501214">x</span>&nbsp;<span class="op" id="6501216">&lt;</span>&nbsp;<span class="ident" id="6501218">b0</span><span class="op" id="6501220">.</span><span class="ident" id="6501221">Max</span><span class="op" id="6501224">.</span><span class="ident" id="6501225">X</span><span class="op" id="6501226">;</span>&nbsp;<span class="ident" id="6501228">x</span><span class="op" id="6501229">++</span>&nbsp;<span class="op" id="6501232">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501237">c0</span>&nbsp;<span class="op" id="6501240">:=</span>&nbsp;<span class="ident" id="6501243">m0</span><span class="op" id="6501245">.</span><span class="ident" id="6501246">At</span><span class="op" id="6501248">(</span><span class="ident" id="6501249">x</span><span class="op" id="6501250">,</span>&nbsp;<span class="ident" id="6501252">y</span><span class="op" id="6501253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501258">c1</span>&nbsp;<span class="op" id="6501261">:=</span>&nbsp;<span class="ident" id="6501264">m1</span><span class="op" id="6501266">.</span><span class="ident" id="6501267">At</span><span class="op" id="6501269">(</span><span class="ident" id="6501270">x</span><span class="op" id="6501271">+</span><span class="ident" id="6501272">dx</span><span class="op" id="6501274">,</span>&nbsp;<span class="ident" id="6501276">y</span><span class="op" id="6501277">+</span><span class="ident" id="6501278">dy</span><span class="op" id="6501280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501285">r0</span><span class="op" id="6501287">,</span>&nbsp;<span class="ident" id="6501289">g0</span><span class="op" id="6501291">,</span>&nbsp;<span class="ident" id="6501293">b0</span><span class="op" id="6501295">,</span>&nbsp;<span class="ident" id="6501297">a0</span>&nbsp;<span class="op" id="6501300">:=</span>&nbsp;<span class="ident" id="6501303">c0</span><span class="op" id="6501305">.</span><span class="ident" id="6501306">RGBA</span><span class="op" id="6501310">(</span><span class="op" id="6501311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501316">r1</span><span class="op" id="6501318">,</span>&nbsp;<span class="ident" id="6501320">g1</span><span class="op" id="6501322">,</span>&nbsp;<span class="ident" id="6501324">b1</span><span class="op" id="6501326">,</span>&nbsp;<span class="ident" id="6501328">a1</span>&nbsp;<span class="op" id="6501331">:=</span>&nbsp;<span class="ident" id="6501334">c1</span><span class="op" id="6501336">.</span><span class="ident" id="6501337">RGBA</span><span class="op" id="6501341">(</span><span class="op" id="6501342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501347">if</span>&nbsp;<span class="ident" id="6501350">r0</span>&nbsp;<span class="op" id="6501353">!=</span>&nbsp;<span class="ident" id="6501356">r1</span>&nbsp;<span class="op" id="6501359">||</span>&nbsp;<span class="ident" id="6501362">g0</span>&nbsp;<span class="op" id="6501365">!=</span>&nbsp;<span class="ident" id="6501368">g1</span>&nbsp;<span class="op" id="6501371">||</span>&nbsp;<span class="ident" id="6501374">b0</span>&nbsp;<span class="op" id="6501377">!=</span>&nbsp;<span class="ident" id="6501380">b1</span>&nbsp;<span class="op" id="6501383">||</span>&nbsp;<span class="ident" id="6501386">a0</span>&nbsp;<span class="op" id="6501389">!=</span>&nbsp;<span class="ident" id="6501392">a1</span>&nbsp;<span class="op" id="6501395">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501401">return</span>&nbsp;<span class="ident" id="6501408">fmt</span><span class="op" id="6501411">.</span><span class="ident" id="6501412">Errorf</span><span class="op" id="6501418">(</span><span class="string" id="6501419">&#34;colors&nbsp;differ&nbsp;at&nbsp;(%d,&nbsp;%d):&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="6501456">,</span>&nbsp;<span class="ident" id="6501458">x</span><span class="op" id="6501459">,</span>&nbsp;<span class="ident" id="6501461">y</span><span class="op" id="6501462">,</span>&nbsp;<span class="ident" id="6501464">c0</span><span class="op" id="6501466">,</span>&nbsp;<span class="ident" id="6501468">c1</span><span class="op" id="6501470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501485">return</span>&nbsp;<span class="ident" id="6501492">nil</span><br>
<span class="lineno">35</span><span class="op" id="6501496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6501499">func</span>&nbsp;<span class="ident" id="6501504">encodeDecode</span><span class="op" id="6501516">(</span><span class="ident" id="6501517">m</span>&nbsp;<span class="ident" id="6501519">image</span><span class="op" id="6501524">.</span><span class="ident" id="6501525">Image</span><span class="op" id="6501530">)</span>&nbsp;<span class="op" id="6501532">(</span><span class="ident" id="6501533">image</span><span class="op" id="6501538">.</span><span class="ident" id="6501539">Image</span><span class="op" id="6501544">,</span>&nbsp;<span class="builtintype" id="6501546">error</span><span class="op" id="6501551">)</span>&nbsp;<span class="op" id="6501553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501556">var</span>&nbsp;<span class="ident" id="6501560">b</span>&nbsp;<span class="ident" id="6501562">bytes</span><span class="op" id="6501567">.</span><span class="ident" id="6501568">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501576">err</span>&nbsp;<span class="op" id="6501580">:=</span>&nbsp;<span class="ident" id="6501583">Encode</span><span class="op" id="6501589">(</span><span class="op" id="6501590">&amp;</span><span class="ident" id="6501591">b</span><span class="op" id="6501592">,</span>&nbsp;<span class="ident" id="6501594">m</span><span class="op" id="6501595">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501598">if</span>&nbsp;<span class="ident" id="6501601">err</span>&nbsp;<span class="op" id="6501605">!=</span>&nbsp;<span class="ident" id="6501608">nil</span>&nbsp;<span class="op" id="6501612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501616">return</span>&nbsp;<span class="ident" id="6501623">nil</span><span class="op" id="6501626">,</span>&nbsp;<span class="ident" id="6501628">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501636">return</span>&nbsp;<span class="ident" id="6501643">Decode</span><span class="op" id="6501649">(</span><span class="op" id="6501650">&amp;</span><span class="ident" id="6501651">b</span><span class="op" id="6501652">)</span><br>
<span class="lineno"></span><span class="op" id="6501654">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6501657">func</span>&nbsp;<span class="ident" id="6501662">TestWriter</span><span class="op" id="6501672">(</span><span class="ident" id="6501673">t</span>&nbsp;<span class="op" id="6501675">*</span><span class="ident" id="6501676">testing</span><span class="op" id="6501683">.</span><span class="ident" id="6501684">T</span><span class="op" id="6501685">)</span>&nbsp;<span class="op" id="6501687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6501690">//&nbsp;The&nbsp;filenames&nbsp;variable&nbsp;is&nbsp;declared&nbsp;in&nbsp;reader_test.go.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501748">names</span>&nbsp;<span class="op" id="6501754">:=</span>&nbsp;<span class="ident" id="6501757">filenames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501768">if</span>&nbsp;<span class="ident" id="6501771">testing</span><span class="op" id="6501778">.</span><span class="ident" id="6501779">Short</span><span class="op" id="6501784">(</span><span class="op" id="6501785">)</span>&nbsp;<span class="op" id="6501787">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501791">names</span>&nbsp;<span class="op" id="6501797">=</span>&nbsp;<span class="ident" id="6501799">filenamesShort</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501818">for</span>&nbsp;<span class="ident" id="6501822">_</span><span class="op" id="6501823">,</span>&nbsp;<span class="ident" id="6501825">fn</span>&nbsp;<span class="op" id="6501828">:=</span>&nbsp;<span class="keyword" id="6501831">range</span>&nbsp;<span class="ident" id="6501837">names</span>&nbsp;<span class="op" id="6501843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501847">qfn</span>&nbsp;<span class="op" id="6501851">:=</span>&nbsp;<span class="string" id="6501854">&#34;testdata/pngsuite/&#34;</span>&nbsp;<span class="op" id="6501875">+</span>&nbsp;<span class="ident" id="6501877">fn</span>&nbsp;<span class="op" id="6501880">+</span>&nbsp;<span class="string" id="6501882">&#34;.png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6501891">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501912">m0</span><span class="op" id="6501914">,</span>&nbsp;<span class="ident" id="6501916">err</span>&nbsp;<span class="op" id="6501920">:=</span>&nbsp;<span class="ident" id="6501923">readPNG</span><span class="op" id="6501930">(</span><span class="ident" id="6501931">qfn</span><span class="op" id="6501934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501938">if</span>&nbsp;<span class="ident" id="6501941">err</span>&nbsp;<span class="op" id="6501945">!=</span>&nbsp;<span class="ident" id="6501948">nil</span>&nbsp;<span class="op" id="6501952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501957">t</span><span class="op" id="6501958">.</span><span class="ident" id="6501959">Error</span><span class="op" id="6501964">(</span><span class="ident" id="6501965">fn</span><span class="op" id="6501967">,</span>&nbsp;<span class="ident" id="6501969">err</span><span class="op" id="6501972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501977">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501988">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6501992">//&nbsp;Read&nbsp;the&nbsp;image&nbsp;again,&nbsp;encode&nbsp;it,&nbsp;and&nbsp;decode&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502045">m1</span><span class="op" id="6502047">,</span>&nbsp;<span class="ident" id="6502049">err</span>&nbsp;<span class="op" id="6502053">:=</span>&nbsp;<span class="ident" id="6502056">readPNG</span><span class="op" id="6502063">(</span><span class="ident" id="6502064">qfn</span><span class="op" id="6502067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502071">if</span>&nbsp;<span class="ident" id="6502074">err</span>&nbsp;<span class="op" id="6502078">!=</span>&nbsp;<span class="ident" id="6502081">nil</span>&nbsp;<span class="op" id="6502085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502090">t</span><span class="op" id="6502091">.</span><span class="ident" id="6502092">Error</span><span class="op" id="6502097">(</span><span class="ident" id="6502098">fn</span><span class="op" id="6502100">,</span>&nbsp;<span class="ident" id="6502102">err</span><span class="op" id="6502105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502110">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502123">m2</span><span class="op" id="6502125">,</span>&nbsp;<span class="ident" id="6502127">err</span>&nbsp;<span class="op" id="6502131">:=</span>&nbsp;<span class="ident" id="6502134">encodeDecode</span><span class="op" id="6502146">(</span><span class="ident" id="6502147">m1</span><span class="op" id="6502149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502153">if</span>&nbsp;<span class="ident" id="6502156">err</span>&nbsp;<span class="op" id="6502160">!=</span>&nbsp;<span class="ident" id="6502163">nil</span>&nbsp;<span class="op" id="6502167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502172">t</span><span class="op" id="6502173">.</span><span class="ident" id="6502174">Error</span><span class="op" id="6502179">(</span><span class="ident" id="6502180">fn</span><span class="op" id="6502182">,</span>&nbsp;<span class="ident" id="6502184">err</span><span class="op" id="6502187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502192">return</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6502205">//&nbsp;Compare&nbsp;the&nbsp;two.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502227">err</span>&nbsp;<span class="op" id="6502231">=</span>&nbsp;<span class="ident" id="6502233">diff</span><span class="op" id="6502237">(</span><span class="ident" id="6502238">m0</span><span class="op" id="6502240">,</span>&nbsp;<span class="ident" id="6502242">m2</span><span class="op" id="6502244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502248">if</span>&nbsp;<span class="ident" id="6502251">err</span>&nbsp;<span class="op" id="6502255">!=</span>&nbsp;<span class="ident" id="6502258">nil</span>&nbsp;<span class="op" id="6502262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502267">t</span><span class="op" id="6502268">.</span><span class="ident" id="6502269">Error</span><span class="op" id="6502274">(</span><span class="ident" id="6502275">fn</span><span class="op" id="6502277">,</span>&nbsp;<span class="ident" id="6502279">err</span><span class="op" id="6502282">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502287">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502301">}</span><br>
<span class="lineno"></span><span class="op" id="6502303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="6502306">func</span>&nbsp;<span class="ident" id="6502311">TestWriterLevels</span><span class="op" id="6502327">(</span><span class="ident" id="6502328">t</span>&nbsp;<span class="op" id="6502330">*</span><span class="ident" id="6502331">testing</span><span class="op" id="6502338">.</span><span class="ident" id="6502339">T</span><span class="op" id="6502340">)</span>&nbsp;<span class="op" id="6502342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502345">m</span>&nbsp;<span class="op" id="6502347">:=</span>&nbsp;<span class="ident" id="6502350">image</span><span class="op" id="6502355">.</span><span class="ident" id="6502356">NewNRGBA</span><span class="op" id="6502364">(</span><span class="ident" id="6502365">image</span><span class="op" id="6502370">.</span><span class="ident" id="6502371">Rect</span><span class="op" id="6502375">(</span><span class="num" id="6502376">0</span><span class="op" id="6502377">,</span>&nbsp;<span class="num" id="6502379">0</span><span class="op" id="6502380">,</span>&nbsp;<span class="num" id="6502382">100</span><span class="op" id="6502385">,</span>&nbsp;<span class="num" id="6502387">100</span><span class="op" id="6502390">)</span><span class="op" id="6502391">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502395">var</span>&nbsp;<span class="ident" id="6502399">b1</span><span class="op" id="6502401">,</span>&nbsp;<span class="ident" id="6502403">b2</span>&nbsp;<span class="ident" id="6502406">bytes</span><span class="op" id="6502411">.</span><span class="ident" id="6502412">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502420">if</span>&nbsp;<span class="ident" id="6502423">err</span>&nbsp;<span class="op" id="6502427">:=</span>&nbsp;<span class="op" id="6502430">(</span><span class="op" id="6502431">&amp;</span><span class="ident" id="6502432">Encoder</span><span class="op" id="6502439">{</span><span class="op" id="6502440">}</span><span class="op" id="6502441">)</span><span class="op" id="6502442">.</span><span class="ident" id="6502443">Encode</span><span class="op" id="6502449">(</span><span class="op" id="6502450">&amp;</span><span class="ident" id="6502451">b1</span><span class="op" id="6502453">,</span>&nbsp;<span class="ident" id="6502455">m</span><span class="op" id="6502456">)</span><span class="op" id="6502457">;</span>&nbsp;<span class="ident" id="6502459">err</span>&nbsp;<span class="op" id="6502463">!=</span>&nbsp;<span class="ident" id="6502466">nil</span>&nbsp;<span class="op" id="6502470">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502474">t</span><span class="op" id="6502475">.</span><span class="ident" id="6502476">Fatal</span><span class="op" id="6502481">(</span><span class="ident" id="6502482">err</span><span class="op" id="6502485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502491">noenc</span>&nbsp;<span class="op" id="6502497">:=</span>&nbsp;<span class="op" id="6502500">&amp;</span><span class="ident" id="6502501">Encoder</span><span class="op" id="6502508">{</span><span class="ident" id="6502509">CompressionLevel</span><span class="op" id="6502525">:</span>&nbsp;<span class="ident" id="6502527">NoCompression</span><span class="op" id="6502540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502543">if</span>&nbsp;<span class="ident" id="6502546">err</span>&nbsp;<span class="op" id="6502550">:=</span>&nbsp;<span class="ident" id="6502553">noenc</span><span class="op" id="6502558">.</span><span class="ident" id="6502559">Encode</span><span class="op" id="6502565">(</span><span class="op" id="6502566">&amp;</span><span class="ident" id="6502567">b2</span><span class="op" id="6502569">,</span>&nbsp;<span class="ident" id="6502571">m</span><span class="op" id="6502572">)</span><span class="op" id="6502573">;</span>&nbsp;<span class="ident" id="6502575">err</span>&nbsp;<span class="op" id="6502579">!=</span>&nbsp;<span class="ident" id="6502582">nil</span>&nbsp;<span class="op" id="6502586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502590">t</span><span class="op" id="6502591">.</span><span class="ident" id="6502592">Fatal</span><span class="op" id="6502597">(</span><span class="ident" id="6502598">err</span><span class="op" id="6502601">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502608">if</span>&nbsp;<span class="ident" id="6502611">b2</span><span class="op" id="6502613">.</span><span class="ident" id="6502614">Len</span><span class="op" id="6502617">(</span><span class="op" id="6502618">)</span>&nbsp;<span class="op" id="6502620">&lt;=</span>&nbsp;<span class="ident" id="6502623">b1</span><span class="op" id="6502625">.</span><span class="ident" id="6502626">Len</span><span class="op" id="6502629">(</span><span class="op" id="6502630">)</span>&nbsp;<span class="op" id="6502632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502636">t</span><span class="op" id="6502637">.</span><span class="ident" id="6502638">Error</span><span class="op" id="6502643">(</span><span class="string" id="6502644">&#34;DefaultCompression&nbsp;encoding&nbsp;was&nbsp;larger&nbsp;than&nbsp;NoCompression&nbsp;encoding&#34;</span><span class="op" id="6502712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502715">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502718">if</span>&nbsp;<span class="ident" id="6502721">_</span><span class="op" id="6502722">,</span>&nbsp;<span class="ident" id="6502724">err</span>&nbsp;<span class="op" id="6502728">:=</span>&nbsp;<span class="ident" id="6502731">Decode</span><span class="op" id="6502737">(</span><span class="op" id="6502738">&amp;</span><span class="ident" id="6502739">b1</span><span class="op" id="6502741">)</span><span class="op" id="6502742">;</span>&nbsp;<span class="ident" id="6502744">err</span>&nbsp;<span class="op" id="6502748">!=</span>&nbsp;<span class="ident" id="6502751">nil</span>&nbsp;<span class="op" id="6502755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502759">t</span><span class="op" id="6502760">.</span><span class="ident" id="6502761">Error</span><span class="op" id="6502766">(</span><span class="string" id="6502767">&#34;cannot&nbsp;decode&nbsp;DefaultCompression&#34;</span><span class="op" id="6502801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502807">if</span>&nbsp;<span class="ident" id="6502810">_</span><span class="op" id="6502811">,</span>&nbsp;<span class="ident" id="6502813">err</span>&nbsp;<span class="op" id="6502817">:=</span>&nbsp;<span class="ident" id="6502820">Decode</span><span class="op" id="6502826">(</span><span class="op" id="6502827">&amp;</span><span class="ident" id="6502828">b2</span><span class="op" id="6502830">)</span><span class="op" id="6502831">;</span>&nbsp;<span class="ident" id="6502833">err</span>&nbsp;<span class="op" id="6502837">!=</span>&nbsp;<span class="ident" id="6502840">nil</span>&nbsp;<span class="op" id="6502844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502848">t</span><span class="op" id="6502849">.</span><span class="ident" id="6502850">Error</span><span class="op" id="6502855">(</span><span class="string" id="6502856">&#34;cannot&nbsp;decode&nbsp;NoCompression&#34;</span><span class="op" id="6502885">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502888">}</span><br>
<span class="lineno"></span><span class="op" id="6502890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6502893">func</span>&nbsp;<span class="ident" id="6502898">TestSubImage</span><span class="op" id="6502910">(</span><span class="ident" id="6502911">t</span>&nbsp;<span class="op" id="6502913">*</span><span class="ident" id="6502914">testing</span><span class="op" id="6502921">.</span><span class="ident" id="6502922">T</span><span class="op" id="6502923">)</span>&nbsp;<span class="op" id="6502925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502928">m0</span>&nbsp;<span class="op" id="6502931">:=</span>&nbsp;<span class="ident" id="6502934">image</span><span class="op" id="6502939">.</span><span class="ident" id="6502940">NewRGBA</span><span class="op" id="6502947">(</span><span class="ident" id="6502948">image</span><span class="op" id="6502953">.</span><span class="ident" id="6502954">Rect</span><span class="op" id="6502958">(</span><span class="num" id="6502959">0</span><span class="op" id="6502960">,</span>&nbsp;<span class="num" id="6502962">0</span><span class="op" id="6502963">,</span>&nbsp;<span class="num" id="6502965">256</span><span class="op" id="6502968">,</span>&nbsp;<span class="num" id="6502970">256</span><span class="op" id="6502973">)</span><span class="op" id="6502974">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502977">for</span>&nbsp;<span class="ident" id="6502981">y</span>&nbsp;<span class="op" id="6502983">:=</span>&nbsp;<span class="num" id="6502986">0</span><span class="op" id="6502987">;</span>&nbsp;<span class="ident" id="6502989">y</span>&nbsp;<span class="op" id="6502991">&lt;</span>&nbsp;<span class="num" id="6502993">256</span><span class="op" id="6502996">;</span>&nbsp;<span class="ident" id="6502998">y</span><span class="op" id="6502999">++</span>&nbsp;<span class="op" id="6503002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503006">for</span>&nbsp;<span class="ident" id="6503010">x</span>&nbsp;<span class="op" id="6503012">:=</span>&nbsp;<span class="num" id="6503015">0</span><span class="op" id="6503016">;</span>&nbsp;<span class="ident" id="6503018">x</span>&nbsp;<span class="op" id="6503020">&lt;</span>&nbsp;<span class="num" id="6503022">256</span><span class="op" id="6503025">;</span>&nbsp;<span class="ident" id="6503027">x</span><span class="op" id="6503028">++</span>&nbsp;<span class="op" id="6503031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503036">m0</span><span class="op" id="6503038">.</span><span class="ident" id="6503039">Set</span><span class="op" id="6503042">(</span><span class="ident" id="6503043">x</span><span class="op" id="6503044">,</span>&nbsp;<span class="ident" id="6503046">y</span><span class="op" id="6503047">,</span>&nbsp;<span class="ident" id="6503049">color</span><span class="op" id="6503054">.</span><span class="ident" id="6503055">RGBA</span><span class="op" id="6503059">{</span><span class="builtintype" id="6503060">uint8</span><span class="op" id="6503065">(</span><span class="ident" id="6503066">x</span><span class="op" id="6503067">)</span><span class="op" id="6503068">,</span>&nbsp;<span class="builtintype" id="6503070">uint8</span><span class="op" id="6503075">(</span><span class="ident" id="6503076">y</span><span class="op" id="6503077">)</span><span class="op" id="6503078">,</span>&nbsp;<span class="num" id="6503080">0</span><span class="op" id="6503081">,</span>&nbsp;<span class="num" id="6503083">255</span><span class="op" id="6503086">}</span><span class="op" id="6503087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503094">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503097">m0</span>&nbsp;<span class="op" id="6503100">=</span>&nbsp;<span class="ident" id="6503102">m0</span><span class="op" id="6503104">.</span><span class="ident" id="6503105">SubImage</span><span class="op" id="6503113">(</span><span class="ident" id="6503114">image</span><span class="op" id="6503119">.</span><span class="ident" id="6503120">Rect</span><span class="op" id="6503124">(</span><span class="num" id="6503125">50</span><span class="op" id="6503127">,</span>&nbsp;<span class="num" id="6503129">30</span><span class="op" id="6503131">,</span>&nbsp;<span class="num" id="6503133">250</span><span class="op" id="6503136">,</span>&nbsp;<span class="num" id="6503138">130</span><span class="op" id="6503141">)</span><span class="op" id="6503142">)</span><span class="op" id="6503143">.</span><span class="op" id="6503144">(</span><span class="op" id="6503145">*</span><span class="ident" id="6503146">image</span><span class="op" id="6503151">.</span><span class="ident" id="6503152">RGBA</span><span class="op" id="6503156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503159">m1</span><span class="op" id="6503161">,</span>&nbsp;<span class="ident" id="6503163">err</span>&nbsp;<span class="op" id="6503167">:=</span>&nbsp;<span class="ident" id="6503170">encodeDecode</span><span class="op" id="6503182">(</span><span class="ident" id="6503183">m0</span><span class="op" id="6503185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503188">if</span>&nbsp;<span class="ident" id="6503191">err</span>&nbsp;<span class="op" id="6503195">!=</span>&nbsp;<span class="ident" id="6503198">nil</span>&nbsp;<span class="op" id="6503202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503206">t</span><span class="op" id="6503207">.</span><span class="ident" id="6503208">Error</span><span class="op" id="6503213">(</span><span class="ident" id="6503214">err</span><span class="op" id="6503217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503221">return</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503232">err</span>&nbsp;<span class="op" id="6503236">=</span>&nbsp;<span class="ident" id="6503238">diff</span><span class="op" id="6503242">(</span><span class="ident" id="6503243">m0</span><span class="op" id="6503245">,</span>&nbsp;<span class="ident" id="6503247">m1</span><span class="op" id="6503249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503252">if</span>&nbsp;<span class="ident" id="6503255">err</span>&nbsp;<span class="op" id="6503259">!=</span>&nbsp;<span class="ident" id="6503262">nil</span>&nbsp;<span class="op" id="6503266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503270">t</span><span class="op" id="6503271">.</span><span class="ident" id="6503272">Error</span><span class="op" id="6503277">(</span><span class="ident" id="6503278">err</span><span class="op" id="6503281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503285">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503293">}</span><br>
<span class="lineno"></span><span class="op" id="6503295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6503298">func</span>&nbsp;<span class="ident" id="6503303">BenchmarkEncodeGray</span><span class="op" id="6503322">(</span><span class="ident" id="6503323">b</span>&nbsp;<span class="op" id="6503325">*</span><span class="ident" id="6503326">testing</span><span class="op" id="6503333">.</span><span class="ident" id="6503334">B</span><span class="op" id="6503335">)</span>&nbsp;<span class="op" id="6503337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503340">b</span><span class="op" id="6503341">.</span><span class="ident" id="6503342">StopTimer</span><span class="op" id="6503351">(</span><span class="op" id="6503352">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503355">img</span>&nbsp;<span class="op" id="6503359">:=</span>&nbsp;<span class="ident" id="6503362">image</span><span class="op" id="6503367">.</span><span class="ident" id="6503368">NewGray</span><span class="op" id="6503375">(</span><span class="ident" id="6503376">image</span><span class="op" id="6503381">.</span><span class="ident" id="6503382">Rect</span><span class="op" id="6503386">(</span><span class="num" id="6503387">0</span><span class="op" id="6503388">,</span>&nbsp;<span class="num" id="6503390">0</span><span class="op" id="6503391">,</span>&nbsp;<span class="num" id="6503393">640</span><span class="op" id="6503396">,</span>&nbsp;<span class="num" id="6503398">480</span><span class="op" id="6503401">)</span><span class="op" id="6503402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503405">b</span><span class="op" id="6503406">.</span><span class="ident" id="6503407">SetBytes</span><span class="op" id="6503415">(</span><span class="num" id="6503416">640</span>&nbsp;<span class="op" id="6503420">*</span>&nbsp;<span class="num" id="6503422">480</span>&nbsp;<span class="op" id="6503426">*</span>&nbsp;<span class="num" id="6503428">1</span><span class="op" id="6503429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503432">b</span><span class="op" id="6503433">.</span><span class="ident" id="6503434">StartTimer</span><span class="op" id="6503444">(</span><span class="op" id="6503445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503448">for</span>&nbsp;<span class="ident" id="6503452">i</span>&nbsp;<span class="op" id="6503454">:=</span>&nbsp;<span class="num" id="6503457">0</span><span class="op" id="6503458">;</span>&nbsp;<span class="ident" id="6503460">i</span>&nbsp;<span class="op" id="6503462">&lt;</span>&nbsp;<span class="ident" id="6503464">b</span><span class="op" id="6503465">.</span><span class="ident" id="6503466">N</span><span class="op" id="6503467">;</span>&nbsp;<span class="ident" id="6503469">i</span><span class="op" id="6503470">++</span>&nbsp;<span class="op" id="6503473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503477">Encode</span><span class="op" id="6503483">(</span><span class="ident" id="6503484">ioutil</span><span class="op" id="6503490">.</span><span class="ident" id="6503491">Discard</span><span class="op" id="6503498">,</span>&nbsp;<span class="ident" id="6503500">img</span><span class="op" id="6503503">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503506">}</span><br>
<span class="lineno"></span><span class="op" id="6503508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6503511">func</span>&nbsp;<span class="ident" id="6503516">BenchmarkEncodeNRGBOpaque</span><span class="op" id="6503541">(</span><span class="ident" id="6503542">b</span>&nbsp;<span class="op" id="6503544">*</span><span class="ident" id="6503545">testing</span><span class="op" id="6503552">.</span><span class="ident" id="6503553">B</span><span class="op" id="6503554">)</span>&nbsp;<span class="op" id="6503556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503559">b</span><span class="op" id="6503560">.</span><span class="ident" id="6503561">StopTimer</span><span class="op" id="6503570">(</span><span class="op" id="6503571">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503574">img</span>&nbsp;<span class="op" id="6503578">:=</span>&nbsp;<span class="ident" id="6503581">image</span><span class="op" id="6503586">.</span><span class="ident" id="6503587">NewNRGBA</span><span class="op" id="6503595">(</span><span class="ident" id="6503596">image</span><span class="op" id="6503601">.</span><span class="ident" id="6503602">Rect</span><span class="op" id="6503606">(</span><span class="num" id="6503607">0</span><span class="op" id="6503608">,</span>&nbsp;<span class="num" id="6503610">0</span><span class="op" id="6503611">,</span>&nbsp;<span class="num" id="6503613">640</span><span class="op" id="6503616">,</span>&nbsp;<span class="num" id="6503618">480</span><span class="op" id="6503621">)</span><span class="op" id="6503622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6503625">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503680">bo</span>&nbsp;<span class="op" id="6503683">:=</span>&nbsp;<span class="ident" id="6503686">img</span><span class="op" id="6503689">.</span><span class="ident" id="6503690">Bounds</span><span class="op" id="6503696">(</span><span class="op" id="6503697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503700">for</span>&nbsp;<span class="ident" id="6503704">y</span>&nbsp;<span class="op" id="6503706">:=</span>&nbsp;<span class="ident" id="6503709">bo</span><span class="op" id="6503711">.</span><span class="ident" id="6503712">Min</span><span class="op" id="6503715">.</span><span class="ident" id="6503716">Y</span><span class="op" id="6503717">;</span>&nbsp;<span class="ident" id="6503719">y</span>&nbsp;<span class="op" id="6503721">&lt;</span>&nbsp;<span class="ident" id="6503723">bo</span><span class="op" id="6503725">.</span><span class="ident" id="6503726">Max</span><span class="op" id="6503729">.</span><span class="ident" id="6503730">Y</span><span class="op" id="6503731">;</span>&nbsp;<span class="ident" id="6503733">y</span><span class="op" id="6503734">++</span>&nbsp;<span class="op" id="6503737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503741">for</span>&nbsp;<span class="ident" id="6503745">x</span>&nbsp;<span class="op" id="6503747">:=</span>&nbsp;<span class="ident" id="6503750">bo</span><span class="op" id="6503752">.</span><span class="ident" id="6503753">Min</span><span class="op" id="6503756">.</span><span class="ident" id="6503757">X</span><span class="op" id="6503758">;</span>&nbsp;<span class="ident" id="6503760">x</span>&nbsp;<span class="op" id="6503762">&lt;</span>&nbsp;<span class="ident" id="6503764">bo</span><span class="op" id="6503766">.</span><span class="ident" id="6503767">Max</span><span class="op" id="6503770">.</span><span class="ident" id="6503771">X</span><span class="op" id="6503772">;</span>&nbsp;<span class="ident" id="6503774">x</span><span class="op" id="6503775">++</span>&nbsp;<span class="op" id="6503778">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503783">img</span><span class="op" id="6503786">.</span><span class="ident" id="6503787">Set</span><span class="op" id="6503790">(</span><span class="ident" id="6503791">x</span><span class="op" id="6503792">,</span>&nbsp;<span class="ident" id="6503794">y</span><span class="op" id="6503795">,</span>&nbsp;<span class="ident" id="6503797">color</span><span class="op" id="6503802">.</span><span class="ident" id="6503803">NRGBA</span><span class="op" id="6503808">{</span><span class="num" id="6503809">0</span><span class="op" id="6503810">,</span>&nbsp;<span class="num" id="6503812">0</span><span class="op" id="6503813">,</span>&nbsp;<span class="num" id="6503815">0</span><span class="op" id="6503816">,</span>&nbsp;<span class="num" id="6503818">255</span><span class="op" id="6503821">}</span><span class="op" id="6503822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503832">if</span>&nbsp;<span class="op" id="6503835">!</span><span class="ident" id="6503836">img</span><span class="op" id="6503839">.</span><span class="ident" id="6503840">Opaque</span><span class="op" id="6503846">(</span><span class="op" id="6503847">)</span>&nbsp;<span class="op" id="6503849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503853">b</span><span class="op" id="6503854">.</span><span class="ident" id="6503855">Fatal</span><span class="op" id="6503860">(</span><span class="string" id="6503861">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="6503890">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503896">b</span><span class="op" id="6503897">.</span><span class="ident" id="6503898">SetBytes</span><span class="op" id="6503906">(</span><span class="num" id="6503907">640</span>&nbsp;<span class="op" id="6503911">*</span>&nbsp;<span class="num" id="6503913">480</span>&nbsp;<span class="op" id="6503917">*</span>&nbsp;<span class="num" id="6503919">4</span><span class="op" id="6503920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503923">b</span><span class="op" id="6503924">.</span><span class="ident" id="6503925">StartTimer</span><span class="op" id="6503935">(</span><span class="op" id="6503936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503939">for</span>&nbsp;<span class="ident" id="6503943">i</span>&nbsp;<span class="op" id="6503945">:=</span>&nbsp;<span class="num" id="6503948">0</span><span class="op" id="6503949">;</span>&nbsp;<span class="ident" id="6503951">i</span>&nbsp;<span class="op" id="6503953">&lt;</span>&nbsp;<span class="ident" id="6503955">b</span><span class="op" id="6503956">.</span><span class="ident" id="6503957">N</span><span class="op" id="6503958">;</span>&nbsp;<span class="ident" id="6503960">i</span><span class="op" id="6503961">++</span>&nbsp;<span class="op" id="6503964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503968">Encode</span><span class="op" id="6503974">(</span><span class="ident" id="6503975">ioutil</span><span class="op" id="6503981">.</span><span class="ident" id="6503982">Discard</span><span class="op" id="6503989">,</span>&nbsp;<span class="ident" id="6503991">img</span><span class="op" id="6503994">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503997">}</span><br>
<span class="lineno"></span><span class="op" id="6503999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6504002">func</span>&nbsp;<span class="ident" id="6504007">BenchmarkEncodeNRGBA</span><span class="op" id="6504027">(</span><span class="ident" id="6504028">b</span>&nbsp;<span class="op" id="6504030">*</span><span class="ident" id="6504031">testing</span><span class="op" id="6504038">.</span><span class="ident" id="6504039">B</span><span class="op" id="6504040">)</span>&nbsp;<span class="op" id="6504042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504045">b</span><span class="op" id="6504046">.</span><span class="ident" id="6504047">StopTimer</span><span class="op" id="6504056">(</span><span class="op" id="6504057">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504060">img</span>&nbsp;<span class="op" id="6504064">:=</span>&nbsp;<span class="ident" id="6504067">image</span><span class="op" id="6504072">.</span><span class="ident" id="6504073">NewNRGBA</span><span class="op" id="6504081">(</span><span class="ident" id="6504082">image</span><span class="op" id="6504087">.</span><span class="ident" id="6504088">Rect</span><span class="op" id="6504092">(</span><span class="num" id="6504093">0</span><span class="op" id="6504094">,</span>&nbsp;<span class="num" id="6504096">0</span><span class="op" id="6504097">,</span>&nbsp;<span class="num" id="6504099">640</span><span class="op" id="6504102">,</span>&nbsp;<span class="num" id="6504104">480</span><span class="op" id="6504107">)</span><span class="op" id="6504108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6504111">if</span>&nbsp;<span class="ident" id="6504114">img</span><span class="op" id="6504117">.</span><span class="ident" id="6504118">Opaque</span><span class="op" id="6504124">(</span><span class="op" id="6504125">)</span>&nbsp;<span class="op" id="6504127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504131">b</span><span class="op" id="6504132">.</span><span class="ident" id="6504133">Fatal</span><span class="op" id="6504138">(</span><span class="string" id="6504139">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="6504172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6504175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504178">b</span><span class="op" id="6504179">.</span><span class="ident" id="6504180">SetBytes</span><span class="op" id="6504188">(</span><span class="num" id="6504189">640</span>&nbsp;<span class="op" id="6504193">*</span>&nbsp;<span class="num" id="6504195">480</span>&nbsp;<span class="op" id="6504199">*</span>&nbsp;<span class="num" id="6504201">4</span><span class="op" id="6504202">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504205">b</span><span class="op" id="6504206">.</span><span class="ident" id="6504207">StartTimer</span><span class="op" id="6504217">(</span><span class="op" id="6504218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6504221">for</span>&nbsp;<span class="ident" id="6504225">i</span>&nbsp;<span class="op" id="6504227">:=</span>&nbsp;<span class="num" id="6504230">0</span><span class="op" id="6504231">;</span>&nbsp;<span class="ident" id="6504233">i</span>&nbsp;<span class="op" id="6504235">&lt;</span>&nbsp;<span class="ident" id="6504237">b</span><span class="op" id="6504238">.</span><span class="ident" id="6504239">N</span><span class="op" id="6504240">;</span>&nbsp;<span class="ident" id="6504242">i</span><span class="op" id="6504243">++</span>&nbsp;<span class="op" id="6504246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504250">Encode</span><span class="op" id="6504256">(</span><span class="ident" id="6504257">ioutil</span><span class="op" id="6504263">.</span><span class="ident" id="6504264">Discard</span><span class="op" id="6504271">,</span>&nbsp;<span class="ident" id="6504273">img</span><span class="op" id="6504276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6504279">}</span><br>
<span class="lineno"></span><span class="op" id="6504281">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="6504284">func</span>&nbsp;<span class="ident" id="6504289">BenchmarkEncodePaletted</span><span class="op" id="6504312">(</span><span class="ident" id="6504313">b</span>&nbsp;<span class="op" id="6504315">*</span><span class="ident" id="6504316">testing</span><span class="op" id="6504323">.</span><span class="ident" id="6504324">B</span><span class="op" id="6504325">)</span>&nbsp;<span class="op" id="6504327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504330">b</span><span class="op" id="6504331">.</span><span class="ident" id="6504332">StopTimer</span><span class="op" id="6504341">(</span><span class="op" id="6504342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504345">img</span>&nbsp;<span class="op" id="6504349">:=</span>&nbsp;<span class="ident" id="6504352">image</span><span class="op" id="6504357">.</span><span class="ident" id="6504358">NewPaletted</span><span class="op" id="6504369">(</span><span class="ident" id="6504370">image</span><span class="op" id="6504375">.</span><span class="ident" id="6504376">Rect</span><span class="op" id="6504380">(</span><span class="num" id="6504381">0</span><span class="op" id="6504382">,</span>&nbsp;<span class="num" id="6504384">0</span><span class="op" id="6504385">,</span>&nbsp;<span class="num" id="6504387">640</span><span class="op" id="6504390">,</span>&nbsp;<span class="num" id="6504392">480</span><span class="op" id="6504395">)</span><span class="op" id="6504396">,</span>&nbsp;<span class="ident" id="6504398">color</span><span class="op" id="6504403">.</span><span class="ident" id="6504404">Palette</span><span class="op" id="6504411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504415">color</span><span class="op" id="6504420">.</span><span class="ident" id="6504421">RGBA</span><span class="op" id="6504425">{</span><span class="num" id="6504426">0</span><span class="op" id="6504427">,</span>&nbsp;<span class="num" id="6504429">0</span><span class="op" id="6504430">,</span>&nbsp;<span class="num" id="6504432">0</span><span class="op" id="6504433">,</span>&nbsp;<span class="num" id="6504435">255</span><span class="op" id="6504438">}</span><span class="op" id="6504439">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504443">color</span><span class="op" id="6504448">.</span><span class="ident" id="6504449">RGBA</span><span class="op" id="6504453">{</span><span class="num" id="6504454">255</span><span class="op" id="6504457">,</span>&nbsp;<span class="num" id="6504459">255</span><span class="op" id="6504462">,</span>&nbsp;<span class="num" id="6504464">255</span><span class="op" id="6504467">,</span>&nbsp;<span class="num" id="6504469">255</span><span class="op" id="6504472">}</span><span class="op" id="6504473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6504476">}</span><span class="op" id="6504477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504480">b</span><span class="op" id="6504481">.</span><span class="ident" id="6504482">SetBytes</span><span class="op" id="6504490">(</span><span class="num" id="6504491">640</span>&nbsp;<span class="op" id="6504495">*</span>&nbsp;<span class="num" id="6504497">480</span>&nbsp;<span class="op" id="6504501">*</span>&nbsp;<span class="num" id="6504503">1</span><span class="op" id="6504504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504507">b</span><span class="op" id="6504508">.</span><span class="ident" id="6504509">StartTimer</span><span class="op" id="6504519">(</span><span class="op" id="6504520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6504523">for</span>&nbsp;<span class="ident" id="6504527">i</span>&nbsp;<span class="op" id="6504529">:=</span>&nbsp;<span class="num" id="6504532">0</span><span class="op" id="6504533">;</span>&nbsp;<span class="ident" id="6504535">i</span>&nbsp;<span class="op" id="6504537">&lt;</span>&nbsp;<span class="ident" id="6504539">b</span><span class="op" id="6504540">.</span><span class="ident" id="6504541">N</span><span class="op" id="6504542">;</span>&nbsp;<span class="ident" id="6504544">i</span><span class="op" id="6504545">++</span>&nbsp;<span class="op" id="6504548">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504552">Encode</span><span class="op" id="6504558">(</span><span class="ident" id="6504559">ioutil</span><span class="op" id="6504565">.</span><span class="ident" id="6504566">Discard</span><span class="op" id="6504573">,</span>&nbsp;<span class="ident" id="6504575">img</span><span class="op" id="6504578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6504581">}</span><br>
<span class="lineno"></span><span class="op" id="6504583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6504586">func</span>&nbsp;<span class="ident" id="6504591">BenchmarkEncodeRGBOpaque</span><span class="op" id="6504615">(</span><span class="ident" id="6504616">b</span>&nbsp;<span class="op" id="6504618">*</span><span class="ident" id="6504619">testing</span><span class="op" id="6504626">.</span><span class="ident" id="6504627">B</span><span class="op" id="6504628">)</span>&nbsp;<span class="op" id="6504630">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504633">b</span><span class="op" id="6504634">.</span><span class="ident" id="6504635">StopTimer</span><span class="op" id="6504644">(</span><span class="op" id="6504645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504648">img</span>&nbsp;<span class="op" id="6504652">:=</span>&nbsp;<span class="ident" id="6504655">image</span><span class="op" id="6504660">.</span><span class="ident" id="6504661">NewRGBA</span><span class="op" id="6504668">(</span><span class="ident" id="6504669">image</span><span class="op" id="6504674">.</span><span class="ident" id="6504675">Rect</span><span class="op" id="6504679">(</span><span class="num" id="6504680">0</span><span class="op" id="6504681">,</span>&nbsp;<span class="num" id="6504683">0</span><span class="op" id="6504684">,</span>&nbsp;<span class="num" id="6504686">640</span><span class="op" id="6504689">,</span>&nbsp;<span class="num" id="6504691">480</span><span class="op" id="6504694">)</span><span class="op" id="6504695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6504698">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504753">bo</span>&nbsp;<span class="op" id="6504756">:=</span>&nbsp;<span class="ident" id="6504759">img</span><span class="op" id="6504762">.</span><span class="ident" id="6504763">Bounds</span><span class="op" id="6504769">(</span><span class="op" id="6504770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6504773">for</span>&nbsp;<span class="ident" id="6504777">y</span>&nbsp;<span class="op" id="6504779">:=</span>&nbsp;<span class="ident" id="6504782">bo</span><span class="op" id="6504784">.</span><span class="ident" id="6504785">Min</span><span class="op" id="6504788">.</span><span class="ident" id="6504789">Y</span><span class="op" id="6504790">;</span>&nbsp;<span class="ident" id="6504792">y</span>&nbsp;<span class="op" id="6504794">&lt;</span>&nbsp;<span class="ident" id="6504796">bo</span><span class="op" id="6504798">.</span><span class="ident" id="6504799">Max</span><span class="op" id="6504802">.</span><span class="ident" id="6504803">Y</span><span class="op" id="6504804">;</span>&nbsp;<span class="ident" id="6504806">y</span><span class="op" id="6504807">++</span>&nbsp;<span class="op" id="6504810">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6504814">for</span>&nbsp;<span class="ident" id="6504818">x</span>&nbsp;<span class="op" id="6504820">:=</span>&nbsp;<span class="ident" id="6504823">bo</span><span class="op" id="6504825">.</span><span class="ident" id="6504826">Min</span><span class="op" id="6504829">.</span><span class="ident" id="6504830">X</span><span class="op" id="6504831">;</span>&nbsp;<span class="ident" id="6504833">x</span>&nbsp;<span class="op" id="6504835">&lt;</span>&nbsp;<span class="ident" id="6504837">bo</span><span class="op" id="6504839">.</span><span class="ident" id="6504840">Max</span><span class="op" id="6504843">.</span><span class="ident" id="6504844">X</span><span class="op" id="6504845">;</span>&nbsp;<span class="ident" id="6504847">x</span><span class="op" id="6504848">++</span>&nbsp;<span class="op" id="6504851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504856">img</span><span class="op" id="6504859">.</span><span class="ident" id="6504860">Set</span><span class="op" id="6504863">(</span><span class="ident" id="6504864">x</span><span class="op" id="6504865">,</span>&nbsp;<span class="ident" id="6504867">y</span><span class="op" id="6504868">,</span>&nbsp;<span class="ident" id="6504870">color</span><span class="op" id="6504875">.</span><span class="ident" id="6504876">RGBA</span><span class="op" id="6504880">{</span><span class="num" id="6504881">0</span><span class="op" id="6504882">,</span>&nbsp;<span class="num" id="6504884">0</span><span class="op" id="6504885">,</span>&nbsp;<span class="num" id="6504887">0</span><span class="op" id="6504888">,</span>&nbsp;<span class="num" id="6504890">255</span><span class="op" id="6504893">}</span><span class="op" id="6504894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6504898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6504901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6504904">if</span>&nbsp;<span class="op" id="6504907">!</span><span class="ident" id="6504908">img</span><span class="op" id="6504911">.</span><span class="ident" id="6504912">Opaque</span><span class="op" id="6504918">(</span><span class="op" id="6504919">)</span>&nbsp;<span class="op" id="6504921">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504925">b</span><span class="op" id="6504926">.</span><span class="ident" id="6504927">Fatal</span><span class="op" id="6504932">(</span><span class="string" id="6504933">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="6504962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6504965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504968">b</span><span class="op" id="6504969">.</span><span class="ident" id="6504970">SetBytes</span><span class="op" id="6504978">(</span><span class="num" id="6504979">640</span>&nbsp;<span class="op" id="6504983">*</span>&nbsp;<span class="num" id="6504985">480</span>&nbsp;<span class="op" id="6504989">*</span>&nbsp;<span class="num" id="6504991">4</span><span class="op" id="6504992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504995">b</span><span class="op" id="6504996">.</span><span class="ident" id="6504997">StartTimer</span><span class="op" id="6505007">(</span><span class="op" id="6505008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6505011">for</span>&nbsp;<span class="ident" id="6505015">i</span>&nbsp;<span class="op" id="6505017">:=</span>&nbsp;<span class="num" id="6505020">0</span><span class="op" id="6505021">;</span>&nbsp;<span class="ident" id="6505023">i</span>&nbsp;<span class="op" id="6505025">&lt;</span>&nbsp;<span class="ident" id="6505027">b</span><span class="op" id="6505028">.</span><span class="ident" id="6505029">N</span><span class="op" id="6505030">;</span>&nbsp;<span class="ident" id="6505032">i</span><span class="op" id="6505033">++</span>&nbsp;<span class="op" id="6505036">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6505040">Encode</span><span class="op" id="6505046">(</span><span class="ident" id="6505047">ioutil</span><span class="op" id="6505053">.</span><span class="ident" id="6505054">Discard</span><span class="op" id="6505061">,</span>&nbsp;<span class="ident" id="6505063">img</span><span class="op" id="6505066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6505069">}</span><br>
<span class="lineno"></span><span class="op" id="6505071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6505074">func</span>&nbsp;<span class="ident" id="6505079">BenchmarkEncodeRGBA</span><span class="op" id="6505098">(</span><span class="ident" id="6505099">b</span>&nbsp;<span class="op" id="6505101">*</span><span class="ident" id="6505102">testing</span><span class="op" id="6505109">.</span><span class="ident" id="6505110">B</span><span class="op" id="6505111">)</span>&nbsp;<span class="op" id="6505113">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6505116">b</span><span class="op" id="6505117">.</span><span class="ident" id="6505118">StopTimer</span><span class="op" id="6505127">(</span><span class="op" id="6505128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6505131">img</span>&nbsp;<span class="op" id="6505135">:=</span>&nbsp;<span class="ident" id="6505138">image</span><span class="op" id="6505143">.</span><span class="ident" id="6505144">NewRGBA</span><span class="op" id="6505151">(</span><span class="ident" id="6505152">image</span><span class="op" id="6505157">.</span><span class="ident" id="6505158">Rect</span><span class="op" id="6505162">(</span><span class="num" id="6505163">0</span><span class="op" id="6505164">,</span>&nbsp;<span class="num" id="6505166">0</span><span class="op" id="6505167">,</span>&nbsp;<span class="num" id="6505169">640</span><span class="op" id="6505172">,</span>&nbsp;<span class="num" id="6505174">480</span><span class="op" id="6505177">)</span><span class="op" id="6505178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6505181">if</span>&nbsp;<span class="ident" id="6505184">img</span><span class="op" id="6505187">.</span><span class="ident" id="6505188">Opaque</span><span class="op" id="6505194">(</span><span class="op" id="6505195">)</span>&nbsp;<span class="op" id="6505197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6505201">b</span><span class="op" id="6505202">.</span><span class="ident" id="6505203">Fatal</span><span class="op" id="6505208">(</span><span class="string" id="6505209">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="6505242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6505245">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6505248">b</span><span class="op" id="6505249">.</span><span class="ident" id="6505250">SetBytes</span><span class="op" id="6505258">(</span><span class="num" id="6505259">640</span>&nbsp;<span class="op" id="6505263">*</span>&nbsp;<span class="num" id="6505265">480</span>&nbsp;<span class="op" id="6505269">*</span>&nbsp;<span class="num" id="6505271">4</span><span class="op" id="6505272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6505275">b</span><span class="op" id="6505276">.</span><span class="ident" id="6505277">StartTimer</span><span class="op" id="6505287">(</span><span class="op" id="6505288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6505291">for</span>&nbsp;<span class="ident" id="6505295">i</span>&nbsp;<span class="op" id="6505297">:=</span>&nbsp;<span class="num" id="6505300">0</span><span class="op" id="6505301">;</span>&nbsp;<span class="ident" id="6505303">i</span>&nbsp;<span class="op" id="6505305">&lt;</span>&nbsp;<span class="ident" id="6505307">b</span><span class="op" id="6505308">.</span><span class="ident" id="6505309">N</span><span class="op" id="6505310">;</span>&nbsp;<span class="ident" id="6505312">i</span><span class="op" id="6505313">++</span>&nbsp;<span class="op" id="6505316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6505320">Encode</span><span class="op" id="6505326">(</span><span class="ident" id="6505327">ioutil</span><span class="op" id="6505333">.</span><span class="ident" id="6505334">Discard</span><span class="op" id="6505341">,</span>&nbsp;<span class="ident" id="6505343">img</span><span class="op" id="6505346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6505349">}</span><br>
<span class="lineno">210</span><span class="op" id="6505351">}</span>
</div>
</body>
</html>
