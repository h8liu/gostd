<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html" class="current">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5649229">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5649285">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5649339">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5649390">package</span>&nbsp;<span class="ident" id="5649398">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5649405">import</span>&nbsp;<span class="op" id="5649412">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5649415">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5649426">&#34;sort&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5649434">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="5649441">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5649444">//&nbsp;GCStats&nbsp;collect&nbsp;information&nbsp;about&nbsp;recent&nbsp;garbage&nbsp;collections.</span><br>
<span class="lineno"></span><span class="keyword" id="5649509">type</span>&nbsp;<span class="ident" id="5649514">GCStats</span>&nbsp;<span class="keyword" id="5649522">struct</span>&nbsp;<span class="op" id="5649529">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649532">LastGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649547">time</span><span class="op" id="5649551">.</span><span class="ident" id="5649552">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5649563">//&nbsp;time&nbsp;of&nbsp;last&nbsp;collection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649591">NumGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649606">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5649622">//&nbsp;number&nbsp;of&nbsp;garbage&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649656">PauseTotal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649671">time</span><span class="op" id="5649675">.</span><span class="ident" id="5649676">Duration</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5649687">//&nbsp;total&nbsp;pause&nbsp;for&nbsp;all&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649723">Pause</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5649738">[</span><span class="op" id="5649739">]</span><span class="ident" id="5649740">time</span><span class="op" id="5649744">.</span><span class="ident" id="5649745">Duration</span>&nbsp;<span class="comment" id="5649754">//&nbsp;pause&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649791">PauseEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5649806">[</span><span class="op" id="5649807">]</span><span class="ident" id="5649808">time</span><span class="op" id="5649812">.</span><span class="ident" id="5649813">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5649822">//&nbsp;pause&nbsp;end&nbsp;times&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649869">PauseQuantiles</span>&nbsp;<span class="op" id="5649884">[</span><span class="op" id="5649885">]</span><span class="ident" id="5649886">time</span><span class="op" id="5649890">.</span><span class="ident" id="5649891">Duration</span><br>
<span class="lineno"></span><span class="op" id="5649900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5649903">//&nbsp;ReadGCStats&nbsp;reads&nbsp;statistics&nbsp;about&nbsp;garbage&nbsp;collection&nbsp;into&nbsp;stats.</span><br>
<span class="lineno"></span><span class="comment" id="5649972">//&nbsp;The&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;pause&nbsp;history&nbsp;is&nbsp;system-dependent;</span><br>
<span class="lineno">25</span><span class="comment" id="5650039">//&nbsp;stats.Pause&nbsp;slice&nbsp;will&nbsp;be&nbsp;reused&nbsp;if&nbsp;large&nbsp;enough,&nbsp;reallocated&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="5650115">//&nbsp;ReadGCStats&nbsp;may&nbsp;use&nbsp;the&nbsp;full&nbsp;capacity&nbsp;of&nbsp;the&nbsp;stats.Pause&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="5650182">//&nbsp;If&nbsp;stats.PauseQuantiles&nbsp;is&nbsp;non-empty,&nbsp;ReadGCStats&nbsp;fills&nbsp;it&nbsp;with&nbsp;quantiles</span><br>
<span class="lineno"></span><span class="comment" id="5650259">//&nbsp;summarizing&nbsp;the&nbsp;distribution&nbsp;of&nbsp;pause&nbsp;time.&nbsp;For&nbsp;example,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="5650322">//&nbsp;len(stats.PauseQuantiles)&nbsp;is&nbsp;5,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with&nbsp;the&nbsp;minimum,</span><br>
<span class="lineno">30</span><span class="comment" id="5650393">//&nbsp;25%,&nbsp;50%,&nbsp;75%,&nbsp;and&nbsp;maximum&nbsp;pause&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="5650436">func</span>&nbsp;<span class="ident" id="5650441">ReadGCStats</span><span class="op" id="5650452">(</span><span class="ident" id="5650453">stats</span>&nbsp;<span class="op" id="5650459">*</span><span class="ident" id="5650460">GCStats</span><span class="op" id="5650467">)</span>&nbsp;<span class="op" id="5650469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5650472">//&nbsp;Create&nbsp;a&nbsp;buffer&nbsp;with&nbsp;space&nbsp;for&nbsp;at&nbsp;least&nbsp;two&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5650534">//&nbsp;pause&nbsp;history&nbsp;tracked&nbsp;by&nbsp;the&nbsp;runtime.&nbsp;One&nbsp;will&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5650597">//&nbsp;to&nbsp;the&nbsp;caller&nbsp;and&nbsp;the&nbsp;other&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;transfer&nbsp;buffer</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5650661">//&nbsp;for&nbsp;end&nbsp;times&nbsp;history&nbsp;and&nbsp;as&nbsp;a&nbsp;temporary&nbsp;buffer&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5650717">//&nbsp;computing&nbsp;quantiles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5650742">const</span>&nbsp;<span class="ident" id="5650748">maxPause</span>&nbsp;<span class="op" id="5650757">=</span>&nbsp;<span class="builtinfunc" id="5650759">len</span><span class="op" id="5650762">(</span><span class="op" id="5650763">(</span><span class="op" id="5650764">(</span><span class="op" id="5650765">*</span><span class="ident" id="5650766">runtime</span><span class="op" id="5650773">.</span><span class="ident" id="5650774">MemStats</span><span class="op" id="5650782">)</span><span class="op" id="5650783">(</span><span class="ident" id="5650784">nil</span><span class="op" id="5650787">)</span><span class="op" id="5650788">)</span><span class="op" id="5650789">.</span><span class="ident" id="5650790">PauseNs</span><span class="op" id="5650797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5650800">if</span>&nbsp;<span class="builtinfunc" id="5650803">cap</span><span class="op" id="5650806">(</span><span class="ident" id="5650807">stats</span><span class="op" id="5650812">.</span><span class="ident" id="5650813">Pause</span><span class="op" id="5650818">)</span>&nbsp;<span class="op" id="5650820">&lt;</span>&nbsp;<span class="num" id="5650822">2</span><span class="op" id="5650823">*</span><span class="ident" id="5650824">maxPause</span><span class="op" id="5650832">+</span><span class="num" id="5650833">3</span>&nbsp;<span class="op" id="5650835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5650839">stats</span><span class="op" id="5650844">.</span><span class="ident" id="5650845">Pause</span>&nbsp;<span class="op" id="5650851">=</span>&nbsp;<span class="builtinfunc" id="5650853">make</span><span class="op" id="5650857">(</span><span class="op" id="5650858">[</span><span class="op" id="5650859">]</span><span class="ident" id="5650860">time</span><span class="op" id="5650864">.</span><span class="ident" id="5650865">Duration</span><span class="op" id="5650873">,</span>&nbsp;<span class="num" id="5650875">2</span><span class="op" id="5650876">*</span><span class="ident" id="5650877">maxPause</span><span class="op" id="5650885">+</span><span class="num" id="5650886">3</span><span class="op" id="5650887">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5650890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5650894">//&nbsp;readGCStats&nbsp;fills&nbsp;in&nbsp;the&nbsp;pause&nbsp;and&nbsp;end&nbsp;times&nbsp;histories&nbsp;(up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5650960">//&nbsp;maxPause&nbsp;entries)&nbsp;and&nbsp;then&nbsp;three&nbsp;more:&nbsp;Unix&nbsp;ns&nbsp;time&nbsp;of&nbsp;last&nbsp;GC,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5651028">//&nbsp;number&nbsp;of&nbsp;GC,&nbsp;and&nbsp;total&nbsp;pause&nbsp;time&nbsp;in&nbsp;nanoseconds.&nbsp;Here&nbsp;we</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5651091">//&nbsp;depend&nbsp;on&nbsp;the&nbsp;fact&nbsp;that&nbsp;time.Duration&#39;s&nbsp;native&nbsp;unit&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5651150">//&nbsp;nanoseconds,&nbsp;so&nbsp;the&nbsp;pauses&nbsp;and&nbsp;the&nbsp;total&nbsp;pause&nbsp;time&nbsp;do&nbsp;not&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5651218">//&nbsp;any&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651238">readGCStats</span><span class="op" id="5651249">(</span><span class="op" id="5651250">&amp;</span><span class="ident" id="5651251">stats</span><span class="op" id="5651256">.</span><span class="ident" id="5651257">Pause</span><span class="op" id="5651262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651265">n</span>&nbsp;<span class="op" id="5651267">:=</span>&nbsp;<span class="builtinfunc" id="5651270">len</span><span class="op" id="5651273">(</span><span class="ident" id="5651274">stats</span><span class="op" id="5651279">.</span><span class="ident" id="5651280">Pause</span><span class="op" id="5651285">)</span>&nbsp;<span class="op" id="5651287">-</span>&nbsp;<span class="num" id="5651289">3</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651292">stats</span><span class="op" id="5651297">.</span><span class="ident" id="5651298">LastGC</span>&nbsp;<span class="op" id="5651305">=</span>&nbsp;<span class="ident" id="5651307">time</span><span class="op" id="5651311">.</span><span class="ident" id="5651312">Unix</span><span class="op" id="5651316">(</span><span class="num" id="5651317">0</span><span class="op" id="5651318">,</span>&nbsp;<span class="ident" id="5651320">int64</span><span class="op" id="5651325">(</span><span class="ident" id="5651326">stats</span><span class="op" id="5651331">.</span><span class="ident" id="5651332">Pause</span><span class="op" id="5651337">[</span><span class="ident" id="5651338">n</span><span class="op" id="5651339">]</span><span class="op" id="5651340">)</span><span class="op" id="5651341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651344">stats</span><span class="op" id="5651349">.</span><span class="ident" id="5651350">NumGC</span>&nbsp;<span class="op" id="5651356">=</span>&nbsp;<span class="ident" id="5651358">int64</span><span class="op" id="5651363">(</span><span class="ident" id="5651364">stats</span><span class="op" id="5651369">.</span><span class="ident" id="5651370">Pause</span><span class="op" id="5651375">[</span><span class="ident" id="5651376">n</span><span class="op" id="5651377">+</span><span class="num" id="5651378">1</span><span class="op" id="5651379">]</span><span class="op" id="5651380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651383">stats</span><span class="op" id="5651388">.</span><span class="ident" id="5651389">PauseTotal</span>&nbsp;<span class="op" id="5651400">=</span>&nbsp;<span class="ident" id="5651402">stats</span><span class="op" id="5651407">.</span><span class="ident" id="5651408">Pause</span><span class="op" id="5651413">[</span><span class="ident" id="5651414">n</span><span class="op" id="5651415">+</span><span class="num" id="5651416">2</span><span class="op" id="5651417">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651420">n</span>&nbsp;<span class="op" id="5651422">/=</span>&nbsp;<span class="num" id="5651425">2</span>&nbsp;<span class="comment" id="5651427">//&nbsp;buffer&nbsp;holds&nbsp;pauses&nbsp;and&nbsp;end&nbsp;times</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651465">stats</span><span class="op" id="5651470">.</span><span class="ident" id="5651471">Pause</span>&nbsp;<span class="op" id="5651477">=</span>&nbsp;<span class="ident" id="5651479">stats</span><span class="op" id="5651484">.</span><span class="ident" id="5651485">Pause</span><span class="op" id="5651490">[</span><span class="op" id="5651491">:</span><span class="ident" id="5651492">n</span><span class="op" id="5651493">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651497">if</span>&nbsp;<span class="builtinfunc" id="5651500">cap</span><span class="op" id="5651503">(</span><span class="ident" id="5651504">stats</span><span class="op" id="5651509">.</span><span class="ident" id="5651510">PauseEnd</span><span class="op" id="5651518">)</span>&nbsp;<span class="op" id="5651520">&lt;</span>&nbsp;<span class="ident" id="5651522">maxPause</span>&nbsp;<span class="op" id="5651531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651535">stats</span><span class="op" id="5651540">.</span><span class="ident" id="5651541">PauseEnd</span>&nbsp;<span class="op" id="5651550">=</span>&nbsp;<span class="builtinfunc" id="5651552">make</span><span class="op" id="5651556">(</span><span class="op" id="5651557">[</span><span class="op" id="5651558">]</span><span class="ident" id="5651559">time</span><span class="op" id="5651563">.</span><span class="ident" id="5651564">Time</span><span class="op" id="5651568">,</span>&nbsp;<span class="num" id="5651570">0</span><span class="op" id="5651571">,</span>&nbsp;<span class="ident" id="5651573">maxPause</span><span class="op" id="5651581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5651584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651587">stats</span><span class="op" id="5651592">.</span><span class="ident" id="5651593">PauseEnd</span>&nbsp;<span class="op" id="5651602">=</span>&nbsp;<span class="ident" id="5651604">stats</span><span class="op" id="5651609">.</span><span class="ident" id="5651610">PauseEnd</span><span class="op" id="5651618">[</span><span class="op" id="5651619">:</span><span class="num" id="5651620">0</span><span class="op" id="5651621">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651624">for</span>&nbsp;<span class="ident" id="5651628">_</span><span class="op" id="5651629">,</span>&nbsp;<span class="ident" id="5651631">ns</span>&nbsp;<span class="op" id="5651634">:=</span>&nbsp;<span class="keyword" id="5651637">range</span>&nbsp;<span class="ident" id="5651643">stats</span><span class="op" id="5651648">.</span><span class="ident" id="5651649">Pause</span><span class="op" id="5651654">[</span><span class="ident" id="5651655">n</span>&nbsp;<span class="op" id="5651657">:</span>&nbsp;<span class="ident" id="5651659">n</span><span class="op" id="5651660">+</span><span class="ident" id="5651661">n</span><span class="op" id="5651662">]</span>&nbsp;<span class="op" id="5651664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651668">stats</span><span class="op" id="5651673">.</span><span class="ident" id="5651674">PauseEnd</span>&nbsp;<span class="op" id="5651683">=</span>&nbsp;<span class="builtinfunc" id="5651685">append</span><span class="op" id="5651691">(</span><span class="ident" id="5651692">stats</span><span class="op" id="5651697">.</span><span class="ident" id="5651698">PauseEnd</span><span class="op" id="5651706">,</span>&nbsp;<span class="ident" id="5651708">time</span><span class="op" id="5651712">.</span><span class="ident" id="5651713">Unix</span><span class="op" id="5651717">(</span><span class="num" id="5651718">0</span><span class="op" id="5651719">,</span>&nbsp;<span class="ident" id="5651721">int64</span><span class="op" id="5651726">(</span><span class="ident" id="5651727">ns</span><span class="op" id="5651729">)</span><span class="op" id="5651730">)</span><span class="op" id="5651731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5651734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651738">if</span>&nbsp;<span class="builtinfunc" id="5651741">len</span><span class="op" id="5651744">(</span><span class="ident" id="5651745">stats</span><span class="op" id="5651750">.</span><span class="ident" id="5651751">PauseQuantiles</span><span class="op" id="5651765">)</span>&nbsp;<span class="op" id="5651767">&gt;</span>&nbsp;<span class="num" id="5651769">0</span>&nbsp;<span class="op" id="5651771">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651775">if</span>&nbsp;<span class="ident" id="5651778">n</span>&nbsp;<span class="op" id="5651780">==</span>&nbsp;<span class="num" id="5651783">0</span>&nbsp;<span class="op" id="5651785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651790">for</span>&nbsp;<span class="ident" id="5651794">i</span>&nbsp;<span class="op" id="5651796">:=</span>&nbsp;<span class="keyword" id="5651799">range</span>&nbsp;<span class="ident" id="5651805">stats</span><span class="op" id="5651810">.</span><span class="ident" id="5651811">PauseQuantiles</span>&nbsp;<span class="op" id="5651826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651832">stats</span><span class="op" id="5651837">.</span><span class="ident" id="5651838">PauseQuantiles</span><span class="op" id="5651852">[</span><span class="ident" id="5651853">i</span><span class="op" id="5651854">]</span>&nbsp;<span class="op" id="5651856">=</span>&nbsp;<span class="num" id="5651858">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5651863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5651867">}</span>&nbsp;<span class="keyword" id="5651869">else</span>&nbsp;<span class="op" id="5651874">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5651879">//&nbsp;There&#39;s&nbsp;room&nbsp;for&nbsp;a&nbsp;second&nbsp;copy&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;stats.Pause.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5651944">//&nbsp;See&nbsp;the&nbsp;allocation&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651997">sorted</span>&nbsp;<span class="op" id="5652004">:=</span>&nbsp;<span class="ident" id="5652007">stats</span><span class="op" id="5652012">.</span><span class="ident" id="5652013">Pause</span><span class="op" id="5652018">[</span><span class="ident" id="5652019">n</span>&nbsp;<span class="op" id="5652021">:</span>&nbsp;<span class="ident" id="5652023">n</span><span class="op" id="5652024">+</span><span class="ident" id="5652025">n</span><span class="op" id="5652026">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5652031">copy</span><span class="op" id="5652035">(</span><span class="ident" id="5652036">sorted</span><span class="op" id="5652042">,</span>&nbsp;<span class="ident" id="5652044">stats</span><span class="op" id="5652049">.</span><span class="ident" id="5652050">Pause</span><span class="op" id="5652055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652060">sort</span><span class="op" id="5652064">.</span><span class="ident" id="5652065">Sort</span><span class="op" id="5652069">(</span><span class="ident" id="5652070">byDuration</span><span class="op" id="5652080">(</span><span class="ident" id="5652081">sorted</span><span class="op" id="5652087">)</span><span class="op" id="5652088">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652093">nq</span>&nbsp;<span class="op" id="5652096">:=</span>&nbsp;<span class="builtinfunc" id="5652099">len</span><span class="op" id="5652102">(</span><span class="ident" id="5652103">stats</span><span class="op" id="5652108">.</span><span class="ident" id="5652109">PauseQuantiles</span><span class="op" id="5652123">)</span>&nbsp;<span class="op" id="5652125">-</span>&nbsp;<span class="num" id="5652127">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5652132">for</span>&nbsp;<span class="ident" id="5652136">i</span>&nbsp;<span class="op" id="5652138">:=</span>&nbsp;<span class="num" id="5652141">0</span><span class="op" id="5652142">;</span>&nbsp;<span class="ident" id="5652144">i</span>&nbsp;<span class="op" id="5652146">&lt;</span>&nbsp;<span class="ident" id="5652148">nq</span><span class="op" id="5652150">;</span>&nbsp;<span class="ident" id="5652152">i</span><span class="op" id="5652153">++</span>&nbsp;<span class="op" id="5652156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652162">stats</span><span class="op" id="5652167">.</span><span class="ident" id="5652168">PauseQuantiles</span><span class="op" id="5652182">[</span><span class="ident" id="5652183">i</span><span class="op" id="5652184">]</span>&nbsp;<span class="op" id="5652186">=</span>&nbsp;<span class="ident" id="5652188">sorted</span><span class="op" id="5652194">[</span><span class="builtinfunc" id="5652195">len</span><span class="op" id="5652198">(</span><span class="ident" id="5652199">sorted</span><span class="op" id="5652205">)</span><span class="op" id="5652206">*</span><span class="ident" id="5652207">i</span><span class="op" id="5652208">/</span><span class="ident" id="5652209">nq</span><span class="op" id="5652211">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5652216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652221">stats</span><span class="op" id="5652226">.</span><span class="ident" id="5652227">PauseQuantiles</span><span class="op" id="5652241">[</span><span class="ident" id="5652242">nq</span><span class="op" id="5652244">]</span>&nbsp;<span class="op" id="5652246">=</span>&nbsp;<span class="ident" id="5652248">sorted</span><span class="op" id="5652254">[</span><span class="builtinfunc" id="5652255">len</span><span class="op" id="5652258">(</span><span class="ident" id="5652259">sorted</span><span class="op" id="5652265">)</span><span class="op" id="5652266">-</span><span class="num" id="5652267">1</span><span class="op" id="5652268">]</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5652272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5652275">}</span><br>
<span class="lineno"></span><span class="op" id="5652277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5652280">type</span>&nbsp;<span class="ident" id="5652285">byDuration</span>&nbsp;<span class="op" id="5652296">[</span><span class="op" id="5652297">]</span><span class="ident" id="5652298">time</span><span class="op" id="5652302">.</span><span class="ident" id="5652303">Duration</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="5652313">func</span>&nbsp;<span class="op" id="5652318">(</span><span class="ident" id="5652319">x</span>&nbsp;<span class="ident" id="5652321">byDuration</span><span class="op" id="5652331">)</span>&nbsp;<span class="ident" id="5652333">Len</span><span class="op" id="5652336">(</span><span class="op" id="5652337">)</span>&nbsp;<span class="builtintype" id="5652339">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5652353">{</span>&nbsp;<span class="keyword" id="5652355">return</span>&nbsp;<span class="builtinfunc" id="5652362">len</span><span class="op" id="5652365">(</span><span class="ident" id="5652366">x</span><span class="op" id="5652367">)</span>&nbsp;<span class="op" id="5652369">}</span><br>
<span class="lineno"></span><span class="keyword" id="5652371">func</span>&nbsp;<span class="op" id="5652376">(</span><span class="ident" id="5652377">x</span>&nbsp;<span class="ident" id="5652379">byDuration</span><span class="op" id="5652389">)</span>&nbsp;<span class="ident" id="5652391">Swap</span><span class="op" id="5652395">(</span><span class="ident" id="5652396">i</span><span class="op" id="5652397">,</span>&nbsp;<span class="ident" id="5652399">j</span>&nbsp;<span class="builtintype" id="5652401">int</span><span class="op" id="5652404">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5652411">{</span>&nbsp;<span class="ident" id="5652413">x</span><span class="op" id="5652414">[</span><span class="ident" id="5652415">i</span><span class="op" id="5652416">]</span><span class="op" id="5652417">,</span>&nbsp;<span class="ident" id="5652419">x</span><span class="op" id="5652420">[</span><span class="ident" id="5652421">j</span><span class="op" id="5652422">]</span>&nbsp;<span class="op" id="5652424">=</span>&nbsp;<span class="ident" id="5652426">x</span><span class="op" id="5652427">[</span><span class="ident" id="5652428">j</span><span class="op" id="5652429">]</span><span class="op" id="5652430">,</span>&nbsp;<span class="ident" id="5652432">x</span><span class="op" id="5652433">[</span><span class="ident" id="5652434">i</span><span class="op" id="5652435">]</span>&nbsp;<span class="op" id="5652437">}</span><br>
<span class="lineno"></span><span class="keyword" id="5652439">func</span>&nbsp;<span class="op" id="5652444">(</span><span class="ident" id="5652445">x</span>&nbsp;<span class="ident" id="5652447">byDuration</span><span class="op" id="5652457">)</span>&nbsp;<span class="ident" id="5652459">Less</span><span class="op" id="5652463">(</span><span class="ident" id="5652464">i</span><span class="op" id="5652465">,</span>&nbsp;<span class="ident" id="5652467">j</span>&nbsp;<span class="builtintype" id="5652469">int</span><span class="op" id="5652472">)</span>&nbsp;<span class="builtintype" id="5652474">bool</span>&nbsp;<span class="op" id="5652479">{</span>&nbsp;<span class="keyword" id="5652481">return</span>&nbsp;<span class="ident" id="5652488">x</span><span class="op" id="5652489">[</span><span class="ident" id="5652490">i</span><span class="op" id="5652491">]</span>&nbsp;<span class="op" id="5652493">&lt;</span>&nbsp;<span class="ident" id="5652495">x</span><span class="op" id="5652496">[</span><span class="ident" id="5652497">j</span><span class="op" id="5652498">]</span>&nbsp;<span class="op" id="5652500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="5652503">//&nbsp;SetGCPercent&nbsp;sets&nbsp;the&nbsp;garbage&nbsp;collection&nbsp;target&nbsp;percentage:</span><br>
<span class="lineno"></span><span class="comment" id="5652566">//&nbsp;a&nbsp;collection&nbsp;is&nbsp;triggered&nbsp;when&nbsp;the&nbsp;ratio&nbsp;of&nbsp;freshly&nbsp;allocated&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="5652636">//&nbsp;to&nbsp;live&nbsp;data&nbsp;remaining&nbsp;after&nbsp;the&nbsp;previous&nbsp;collection&nbsp;reaches&nbsp;this&nbsp;percentage.</span><br>
<span class="lineno"></span><span class="comment" id="5652717">//&nbsp;SetGCPercent&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5652763">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;GOGC&nbsp;environment&nbsp;variable</span><br>
<span class="lineno">95</span><span class="comment" id="5652832">//&nbsp;at&nbsp;startup,&nbsp;or&nbsp;100&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="5652882">//&nbsp;A&nbsp;negative&nbsp;percentage&nbsp;disables&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span><span class="keyword" id="5652936">func</span>&nbsp;<span class="ident" id="5652941">SetGCPercent</span><span class="op" id="5652953">(</span><span class="ident" id="5652954">percent</span>&nbsp;<span class="builtintype" id="5652962">int</span><span class="op" id="5652965">)</span>&nbsp;<span class="builtintype" id="5652967">int</span>&nbsp;<span class="op" id="5652971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652974">old</span>&nbsp;<span class="op" id="5652978">:=</span>&nbsp;<span class="ident" id="5652981">setGCPercent</span><span class="op" id="5652993">(</span><span class="builtintype" id="5652994">int32</span><span class="op" id="5652999">(</span><span class="ident" id="5653000">percent</span><span class="op" id="5653007">)</span><span class="op" id="5653008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653011">runtime</span><span class="op" id="5653018">.</span><span class="ident" id="5653019">GC</span><span class="op" id="5653021">(</span><span class="op" id="5653022">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5653025">return</span>&nbsp;<span class="builtintype" id="5653032">int</span><span class="op" id="5653035">(</span><span class="ident" id="5653036">old</span><span class="op" id="5653039">)</span><br>
<span class="lineno"></span><span class="op" id="5653041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5653044">//&nbsp;FreeOSMemory&nbsp;forces&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;followed&nbsp;by&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5653103">//&nbsp;attempt&nbsp;to&nbsp;return&nbsp;as&nbsp;much&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system</span><br>
<span class="lineno">105</span><span class="comment" id="5653163">//&nbsp;as&nbsp;possible.&nbsp;(Even&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;called,&nbsp;the&nbsp;runtime&nbsp;gradually</span><br>
<span class="lineno"></span><span class="comment" id="5653230">//&nbsp;returns&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system&nbsp;in&nbsp;a&nbsp;background&nbsp;task.)</span><br>
<span class="lineno"></span><span class="keyword" id="5653295">func</span>&nbsp;<span class="ident" id="5653300">FreeOSMemory</span><span class="op" id="5653312">(</span><span class="op" id="5653313">)</span>&nbsp;<span class="op" id="5653315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5653318">freeOSMemory</span><span class="op" id="5653330">(</span><span class="op" id="5653331">)</span><br>
<span class="lineno"></span><span class="op" id="5653333">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5653336">//&nbsp;SetMaxStack&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;amount&nbsp;of&nbsp;memory&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5653390">//&nbsp;can&nbsp;be&nbsp;used&nbsp;by&nbsp;a&nbsp;single&nbsp;goroutine&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5653434">//&nbsp;If&nbsp;any&nbsp;goroutine&nbsp;exceeds&nbsp;this&nbsp;limit&nbsp;while&nbsp;growing&nbsp;its&nbsp;stack,</span><br>
<span class="lineno"></span><span class="comment" id="5653498">//&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno">115</span><span class="comment" id="5653522">//&nbsp;SetMaxStack&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5653567">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;1&nbsp;GB&nbsp;on&nbsp;64-bit&nbsp;systems,&nbsp;250&nbsp;MB&nbsp;on&nbsp;32-bit&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="5653643">//</span><br>
<span class="lineno"></span><span class="comment" id="5653646">//&nbsp;SetMaxStack&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5653710">//&nbsp;goroutines&nbsp;that&nbsp;enter&nbsp;an&nbsp;infinite&nbsp;recursion.&nbsp;It&nbsp;only&nbsp;limits&nbsp;future</span><br>
<span class="lineno">120</span><span class="comment" id="5653780">//&nbsp;stack&nbsp;growth.</span><br>
<span class="lineno"></span><span class="keyword" id="5653797">func</span>&nbsp;<span class="ident" id="5653802">SetMaxStack</span><span class="op" id="5653813">(</span><span class="ident" id="5653814">bytes</span>&nbsp;<span class="builtintype" id="5653820">int</span><span class="op" id="5653823">)</span>&nbsp;<span class="builtintype" id="5653825">int</span>&nbsp;<span class="op" id="5653829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5653832">return</span>&nbsp;<span class="ident" id="5653839">setMaxStack</span><span class="op" id="5653850">(</span><span class="ident" id="5653851">bytes</span><span class="op" id="5653856">)</span><br>
<span class="lineno"></span><span class="op" id="5653858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5653861">//&nbsp;SetMaxThreads&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span><span class="comment" id="5653922">//&nbsp;threads&nbsp;that&nbsp;the&nbsp;Go&nbsp;program&nbsp;can&nbsp;use.&nbsp;If&nbsp;it&nbsp;attempts&nbsp;to&nbsp;use&nbsp;more&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="5653994">//&nbsp;this&nbsp;many,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="comment" id="5654029">//&nbsp;SetMaxThreads&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5654076">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;10,000&nbsp;threads.</span><br>
<span class="lineno">130</span><span class="comment" id="5654118">//</span><br>
<span class="lineno"></span><span class="comment" id="5654121">//&nbsp;The&nbsp;limit&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;operating&nbsp;system&nbsp;threads,&nbsp;not&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="5654198">//&nbsp;of&nbsp;goroutines.&nbsp;A&nbsp;Go&nbsp;program&nbsp;creates&nbsp;a&nbsp;new&nbsp;thread&nbsp;only&nbsp;when&nbsp;a&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="5654272">//&nbsp;is&nbsp;ready&nbsp;to&nbsp;run&nbsp;but&nbsp;all&nbsp;the&nbsp;existing&nbsp;threads&nbsp;are&nbsp;blocked&nbsp;in&nbsp;system&nbsp;calls,&nbsp;cgo&nbsp;calls,</span><br>
<span class="lineno"></span><span class="comment" id="5654360">//&nbsp;or&nbsp;are&nbsp;locked&nbsp;to&nbsp;other&nbsp;goroutines&nbsp;due&nbsp;to&nbsp;use&nbsp;of&nbsp;runtime.LockOSThread.</span><br>
<span class="lineno">135</span><span class="comment" id="5654433">//</span><br>
<span class="lineno"></span><span class="comment" id="5654436">//&nbsp;SetMaxThreads&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5654502">//&nbsp;programs&nbsp;that&nbsp;create&nbsp;an&nbsp;unbounded&nbsp;number&nbsp;of&nbsp;threads.&nbsp;The&nbsp;idea&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5654570">//&nbsp;to&nbsp;take&nbsp;down&nbsp;the&nbsp;program&nbsp;before&nbsp;it&nbsp;takes&nbsp;down&nbsp;the&nbsp;operating&nbsp;system.</span><br>
<span class="lineno"></span><span class="keyword" id="5654641">func</span>&nbsp;<span class="ident" id="5654646">SetMaxThreads</span><span class="op" id="5654659">(</span><span class="ident" id="5654660">threads</span>&nbsp;<span class="builtintype" id="5654668">int</span><span class="op" id="5654671">)</span>&nbsp;<span class="builtintype" id="5654673">int</span>&nbsp;<span class="op" id="5654677">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5654680">return</span>&nbsp;<span class="ident" id="5654687">setMaxThreads</span><span class="op" id="5654700">(</span><span class="ident" id="5654701">threads</span><span class="op" id="5654708">)</span><br>
<span class="lineno"></span><span class="op" id="5654710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5654713">//&nbsp;SetPanicOnFault&nbsp;controls&nbsp;the&nbsp;runtime&#39;s&nbsp;behavior&nbsp;when&nbsp;a&nbsp;program&nbsp;faults</span><br>
<span class="lineno"></span><span class="comment" id="5654786">//&nbsp;at&nbsp;an&nbsp;unexpected&nbsp;(non-nil)&nbsp;address.&nbsp;Such&nbsp;faults&nbsp;are&nbsp;typically&nbsp;caused&nbsp;by</span><br>
<span class="lineno">145</span><span class="comment" id="5654861">//&nbsp;bugs&nbsp;such&nbsp;as&nbsp;runtime&nbsp;memory&nbsp;corruption,&nbsp;so&nbsp;the&nbsp;default&nbsp;response&nbsp;is&nbsp;to&nbsp;crash</span><br>
<span class="lineno"></span><span class="comment" id="5654940">//&nbsp;the&nbsp;program.&nbsp;Programs&nbsp;working&nbsp;with&nbsp;memory-mapped&nbsp;files&nbsp;or&nbsp;unsafe</span><br>
<span class="lineno"></span><span class="comment" id="5655008">//&nbsp;manipulation&nbsp;of&nbsp;memory&nbsp;may&nbsp;cause&nbsp;faults&nbsp;at&nbsp;non-nil&nbsp;addresses&nbsp;in&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="5655080">//&nbsp;dramatic&nbsp;situations;&nbsp;SetPanicOnFault&nbsp;allows&nbsp;such&nbsp;programs&nbsp;to&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="5655152">//&nbsp;that&nbsp;the&nbsp;runtime&nbsp;trigger&nbsp;only&nbsp;a&nbsp;panic,&nbsp;not&nbsp;a&nbsp;crash.</span><br>
<span class="lineno">150</span><span class="comment" id="5655207">//&nbsp;SetPanicOnFault&nbsp;applies&nbsp;only&nbsp;to&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span><span class="comment" id="5655265">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="keyword" id="5655301">func</span>&nbsp;<span class="ident" id="5655306">SetPanicOnFault</span><span class="op" id="5655321">(</span><span class="ident" id="5655322">enabled</span>&nbsp;<span class="builtintype" id="5655330">bool</span><span class="op" id="5655334">)</span>&nbsp;<span class="builtintype" id="5655336">bool</span>&nbsp;<span class="op" id="5655341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5655344">return</span>&nbsp;<span class="ident" id="5655351">setPanicOnFault</span><span class="op" id="5655366">(</span><span class="ident" id="5655367">enabled</span><span class="op" id="5655374">)</span><br>
<span class="lineno"></span><span class="op" id="5655376">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5655379">//&nbsp;WriteHeapDump&nbsp;writes&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;heap&nbsp;and&nbsp;the&nbsp;objects&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5655448">//&nbsp;it&nbsp;to&nbsp;the&nbsp;given&nbsp;file&nbsp;descriptor.</span><br>
<span class="lineno"></span><span class="comment" id="5655484">//&nbsp;The&nbsp;heap&nbsp;dump&nbsp;format&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://golang.org/s/go13heapdump.</span><br>
<span class="lineno"></span><span class="keyword" id="5655556">func</span>&nbsp;<span class="ident" id="5655561">WriteHeapDump</span><span class="op" id="5655574">(</span><span class="ident" id="5655575">fd</span>&nbsp;<span class="builtintype" id="5655578">uintptr</span><span class="op" id="5655585">)</span>
</div>
</body>
</html>
