<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html" class="current">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4505203">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4505258">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4505312">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4505363">package</span>&nbsp;<span class="ident" id="4505371">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4505377">import</span>&nbsp;<span class="op" id="4505384">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4505387">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4505401">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4505418">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4505428">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4505439">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4505442">//&nbsp;pkcs1PrivateKey&nbsp;is&nbsp;a&nbsp;structure&nbsp;which&nbsp;mirrors&nbsp;the&nbsp;PKCS#1&nbsp;ASN.1&nbsp;for&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno">15</span><span class="keyword" id="4505531">type</span>&nbsp;<span class="ident" id="4505536">pkcs1PrivateKey</span>&nbsp;<span class="keyword" id="4505552">struct</span>&nbsp;<span class="op" id="4505559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505562">Version</span>&nbsp;<span class="builtintype" id="4505570">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505575">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505583">*</span><span class="ident" id="4505584">big</span><span class="op" id="4505587">.</span><span class="ident" id="4505588">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505593">E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4505601">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505606">D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505614">*</span><span class="ident" id="4505615">big</span><span class="op" id="4505618">.</span><span class="ident" id="4505619">Int</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505624">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505632">*</span><span class="ident" id="4505633">big</span><span class="op" id="4505636">.</span><span class="ident" id="4505637">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505642">Q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505650">*</span><span class="ident" id="4505651">big</span><span class="op" id="4505654">.</span><span class="ident" id="4505655">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4505660">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values,&nbsp;if&nbsp;present,&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505733">Dp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4505738">*</span><span class="ident" id="4505739">big</span><span class="op" id="4505742">.</span><span class="ident" id="4505743">Int</span>&nbsp;<span class="string" id="4505747">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505766">Dq</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4505771">*</span><span class="ident" id="4505772">big</span><span class="op" id="4505775">.</span><span class="ident" id="4505776">Int</span>&nbsp;<span class="string" id="4505780">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505799">Qinv</span>&nbsp;<span class="op" id="4505804">*</span><span class="ident" id="4505805">big</span><span class="op" id="4505808">.</span><span class="ident" id="4505809">Int</span>&nbsp;<span class="string" id="4505813">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505833">AdditionalPrimes</span>&nbsp;<span class="op" id="4505850">[</span><span class="op" id="4505851">]</span><span class="ident" id="4505852">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="string" id="4505876">`asn1:&#34;optional,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4505904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="4505907">type</span>&nbsp;<span class="ident" id="4505912">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="keyword" id="4505936">struct</span>&nbsp;<span class="op" id="4505943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505946">Prime</span>&nbsp;<span class="op" id="4505952">*</span><span class="ident" id="4505953">big</span><span class="op" id="4505956">.</span><span class="ident" id="4505957">Int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4505963">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506023">Exp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4506029">*</span><span class="ident" id="4506030">big</span><span class="op" id="4506033">.</span><span class="ident" id="4506034">Int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506039">Coeff</span>&nbsp;<span class="op" id="4506045">*</span><span class="ident" id="4506046">big</span><span class="op" id="4506049">.</span><span class="ident" id="4506050">Int</span><br>
<span class="lineno"></span><span class="op" id="4506054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4506057">//&nbsp;ParsePKCS1PrivateKey&nbsp;returns&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key&nbsp;from&nbsp;its&nbsp;ASN.1&nbsp;PKCS#1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4506148">func</span>&nbsp;<span class="ident" id="4506153">ParsePKCS1PrivateKey</span><span class="op" id="4506173">(</span><span class="ident" id="4506174">der</span>&nbsp;<span class="op" id="4506178">[</span><span class="op" id="4506179">]</span><span class="builtintype" id="4506180">byte</span><span class="op" id="4506184">)</span>&nbsp;<span class="op" id="4506186">(</span><span class="ident" id="4506187">key</span>&nbsp;<span class="op" id="4506191">*</span><span class="ident" id="4506192">rsa</span><span class="op" id="4506195">.</span><span class="ident" id="4506196">PrivateKey</span><span class="op" id="4506206">,</span>&nbsp;<span class="ident" id="4506208">err</span>&nbsp;<span class="builtintype" id="4506212">error</span><span class="op" id="4506217">)</span>&nbsp;<span class="op" id="4506219">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506222">var</span>&nbsp;<span class="ident" id="4506226">priv</span>&nbsp;<span class="ident" id="4506231">pkcs1PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506248">rest</span><span class="op" id="4506252">,</span>&nbsp;<span class="ident" id="4506254">err</span>&nbsp;<span class="op" id="4506258">:=</span>&nbsp;<span class="ident" id="4506261">asn1</span><span class="op" id="4506265">.</span><span class="ident" id="4506266">Unmarshal</span><span class="op" id="4506275">(</span><span class="ident" id="4506276">der</span><span class="op" id="4506279">,</span>&nbsp;<span class="op" id="4506281">&amp;</span><span class="ident" id="4506282">priv</span><span class="op" id="4506286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506289">if</span>&nbsp;<span class="builtinfunc" id="4506292">len</span><span class="op" id="4506295">(</span><span class="ident" id="4506296">rest</span><span class="op" id="4506300">)</span>&nbsp;<span class="op" id="4506302">&gt;</span>&nbsp;<span class="num" id="4506304">0</span>&nbsp;<span class="op" id="4506306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506310">err</span>&nbsp;<span class="op" id="4506314">=</span>&nbsp;<span class="ident" id="4506316">asn1</span><span class="op" id="4506320">.</span><span class="ident" id="4506321">SyntaxError</span><span class="op" id="4506332">{</span><span class="ident" id="4506333">Msg</span><span class="op" id="4506336">:</span>&nbsp;<span class="string" id="4506338">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4506353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506357">return</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4506365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506368">if</span>&nbsp;<span class="ident" id="4506371">err</span>&nbsp;<span class="op" id="4506375">!=</span>&nbsp;<span class="builtintype" id="4506378">nil</span>&nbsp;<span class="op" id="4506382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506386">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4506394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506398">if</span>&nbsp;<span class="ident" id="4506401">priv</span><span class="op" id="4506405">.</span><span class="ident" id="4506406">Version</span>&nbsp;<span class="op" id="4506414">&gt;</span>&nbsp;<span class="num" id="4506416">1</span>&nbsp;<span class="op" id="4506418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506422">return</span>&nbsp;<span class="builtintype" id="4506429">nil</span><span class="op" id="4506432">,</span>&nbsp;<span class="ident" id="4506434">errors</span><span class="op" id="4506440">.</span><span class="ident" id="4506441">New</span><span class="op" id="4506444">(</span><span class="string" id="4506445">&#34;x509:&nbsp;unsupported&nbsp;private&nbsp;key&nbsp;version&#34;</span><span class="op" id="4506484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4506487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506491">if</span>&nbsp;<span class="ident" id="4506494">priv</span><span class="op" id="4506498">.</span><span class="ident" id="4506499">N</span><span class="op" id="4506500">.</span><span class="ident" id="4506501">Sign</span><span class="op" id="4506505">(</span><span class="op" id="4506506">)</span>&nbsp;<span class="op" id="4506508">&lt;=</span>&nbsp;<span class="num" id="4506511">0</span>&nbsp;<span class="op" id="4506513">||</span>&nbsp;<span class="ident" id="4506516">priv</span><span class="op" id="4506520">.</span><span class="ident" id="4506521">D</span><span class="op" id="4506522">.</span><span class="ident" id="4506523">Sign</span><span class="op" id="4506527">(</span><span class="op" id="4506528">)</span>&nbsp;<span class="op" id="4506530">&lt;=</span>&nbsp;<span class="num" id="4506533">0</span>&nbsp;<span class="op" id="4506535">||</span>&nbsp;<span class="ident" id="4506538">priv</span><span class="op" id="4506542">.</span><span class="ident" id="4506543">P</span><span class="op" id="4506544">.</span><span class="ident" id="4506545">Sign</span><span class="op" id="4506549">(</span><span class="op" id="4506550">)</span>&nbsp;<span class="op" id="4506552">&lt;=</span>&nbsp;<span class="num" id="4506555">0</span>&nbsp;<span class="op" id="4506557">||</span>&nbsp;<span class="ident" id="4506560">priv</span><span class="op" id="4506564">.</span><span class="ident" id="4506565">Q</span><span class="op" id="4506566">.</span><span class="ident" id="4506567">Sign</span><span class="op" id="4506571">(</span><span class="op" id="4506572">)</span>&nbsp;<span class="op" id="4506574">&lt;=</span>&nbsp;<span class="num" id="4506577">0</span>&nbsp;<span class="op" id="4506579">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506583">return</span>&nbsp;<span class="builtintype" id="4506590">nil</span><span class="op" id="4506593">,</span>&nbsp;<span class="ident" id="4506595">errors</span><span class="op" id="4506601">.</span><span class="ident" id="4506602">New</span><span class="op" id="4506605">(</span><span class="string" id="4506606">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;value&#34;</span><span class="op" id="4506657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4506660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506664">key</span>&nbsp;<span class="op" id="4506668">=</span>&nbsp;<span class="builtinfunc" id="4506670">new</span><span class="op" id="4506673">(</span><span class="ident" id="4506674">rsa</span><span class="op" id="4506677">.</span><span class="ident" id="4506678">PrivateKey</span><span class="op" id="4506688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506691">key</span><span class="op" id="4506694">.</span><span class="ident" id="4506695">PublicKey</span>&nbsp;<span class="op" id="4506705">=</span>&nbsp;<span class="ident" id="4506707">rsa</span><span class="op" id="4506710">.</span><span class="ident" id="4506711">PublicKey</span><span class="op" id="4506720">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506724">E</span><span class="op" id="4506725">:</span>&nbsp;<span class="ident" id="4506727">priv</span><span class="op" id="4506731">.</span><span class="ident" id="4506732">E</span><span class="op" id="4506733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506737">N</span><span class="op" id="4506738">:</span>&nbsp;<span class="ident" id="4506740">priv</span><span class="op" id="4506744">.</span><span class="ident" id="4506745">N</span><span class="op" id="4506746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4506749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506753">key</span><span class="op" id="4506756">.</span><span class="ident" id="4506757">D</span>&nbsp;<span class="op" id="4506759">=</span>&nbsp;<span class="ident" id="4506761">priv</span><span class="op" id="4506765">.</span><span class="ident" id="4506766">D</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506769">key</span><span class="op" id="4506772">.</span><span class="ident" id="4506773">Primes</span>&nbsp;<span class="op" id="4506780">=</span>&nbsp;<span class="builtinfunc" id="4506782">make</span><span class="op" id="4506786">(</span><span class="op" id="4506787">[</span><span class="op" id="4506788">]</span><span class="op" id="4506789">*</span><span class="ident" id="4506790">big</span><span class="op" id="4506793">.</span><span class="ident" id="4506794">Int</span><span class="op" id="4506797">,</span>&nbsp;<span class="num" id="4506799">2</span><span class="op" id="4506800">+</span><span class="builtinfunc" id="4506801">len</span><span class="op" id="4506804">(</span><span class="ident" id="4506805">priv</span><span class="op" id="4506809">.</span><span class="ident" id="4506810">AdditionalPrimes</span><span class="op" id="4506826">)</span><span class="op" id="4506827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506830">key</span><span class="op" id="4506833">.</span><span class="ident" id="4506834">Primes</span><span class="op" id="4506840">[</span><span class="num" id="4506841">0</span><span class="op" id="4506842">]</span>&nbsp;<span class="op" id="4506844">=</span>&nbsp;<span class="ident" id="4506846">priv</span><span class="op" id="4506850">.</span><span class="ident" id="4506851">P</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506854">key</span><span class="op" id="4506857">.</span><span class="ident" id="4506858">Primes</span><span class="op" id="4506864">[</span><span class="num" id="4506865">1</span><span class="op" id="4506866">]</span>&nbsp;<span class="op" id="4506868">=</span>&nbsp;<span class="ident" id="4506870">priv</span><span class="op" id="4506874">.</span><span class="ident" id="4506875">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506878">for</span>&nbsp;<span class="ident" id="4506882">i</span><span class="op" id="4506883">,</span>&nbsp;<span class="ident" id="4506885">a</span>&nbsp;<span class="op" id="4506887">:=</span>&nbsp;<span class="keyword" id="4506890">range</span>&nbsp;<span class="ident" id="4506896">priv</span><span class="op" id="4506900">.</span><span class="ident" id="4506901">AdditionalPrimes</span>&nbsp;<span class="op" id="4506918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506922">if</span>&nbsp;<span class="ident" id="4506925">a</span><span class="op" id="4506926">.</span><span class="ident" id="4506927">Prime</span><span class="op" id="4506932">.</span><span class="ident" id="4506933">Sign</span><span class="op" id="4506937">(</span><span class="op" id="4506938">)</span>&nbsp;<span class="op" id="4506940">&lt;=</span>&nbsp;<span class="num" id="4506943">0</span>&nbsp;<span class="op" id="4506945">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506950">return</span>&nbsp;<span class="builtintype" id="4506957">nil</span><span class="op" id="4506960">,</span>&nbsp;<span class="ident" id="4506962">errors</span><span class="op" id="4506968">.</span><span class="ident" id="4506969">New</span><span class="op" id="4506972">(</span><span class="string" id="4506973">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;prime&#34;</span><span class="op" id="4507024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507032">key</span><span class="op" id="4507035">.</span><span class="ident" id="4507036">Primes</span><span class="op" id="4507042">[</span><span class="ident" id="4507043">i</span><span class="op" id="4507044">+</span><span class="num" id="4507045">2</span><span class="op" id="4507046">]</span>&nbsp;<span class="op" id="4507048">=</span>&nbsp;<span class="ident" id="4507050">a</span><span class="op" id="4507051">.</span><span class="ident" id="4507052">Prime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4507060">//&nbsp;We&nbsp;ignore&nbsp;the&nbsp;other&nbsp;two&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4507123">//&nbsp;them&nbsp;as&nbsp;needed.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507147">err</span>&nbsp;<span class="op" id="4507151">=</span>&nbsp;<span class="ident" id="4507153">key</span><span class="op" id="4507156">.</span><span class="ident" id="4507157">Validate</span><span class="op" id="4507165">(</span><span class="op" id="4507166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507169">if</span>&nbsp;<span class="ident" id="4507172">err</span>&nbsp;<span class="op" id="4507176">!=</span>&nbsp;<span class="builtintype" id="4507179">nil</span>&nbsp;<span class="op" id="4507183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507187">return</span>&nbsp;<span class="builtintype" id="4507194">nil</span><span class="op" id="4507197">,</span>&nbsp;<span class="ident" id="4507199">err</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507207">key</span><span class="op" id="4507210">.</span><span class="ident" id="4507211">Precompute</span><span class="op" id="4507221">(</span><span class="op" id="4507222">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507226">return</span><br>
<span class="lineno"></span><span class="op" id="4507233">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="4507236">//&nbsp;MarshalPKCS1PrivateKey&nbsp;converts&nbsp;a&nbsp;private&nbsp;key&nbsp;to&nbsp;ASN.1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4507312">func</span>&nbsp;<span class="ident" id="4507317">MarshalPKCS1PrivateKey</span><span class="op" id="4507339">(</span><span class="ident" id="4507340">key</span>&nbsp;<span class="op" id="4507344">*</span><span class="ident" id="4507345">rsa</span><span class="op" id="4507348">.</span><span class="ident" id="4507349">PrivateKey</span><span class="op" id="4507359">)</span>&nbsp;<span class="op" id="4507361">[</span><span class="op" id="4507362">]</span><span class="builtintype" id="4507363">byte</span>&nbsp;<span class="op" id="4507368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507371">key</span><span class="op" id="4507374">.</span><span class="ident" id="4507375">Precompute</span><span class="op" id="4507385">(</span><span class="op" id="4507386">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507390">version</span>&nbsp;<span class="op" id="4507398">:=</span>&nbsp;<span class="num" id="4507401">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507404">if</span>&nbsp;<span class="builtinfunc" id="4507407">len</span><span class="op" id="4507410">(</span><span class="ident" id="4507411">key</span><span class="op" id="4507414">.</span><span class="ident" id="4507415">Primes</span><span class="op" id="4507421">)</span>&nbsp;<span class="op" id="4507423">&gt;</span>&nbsp;<span class="num" id="4507425">2</span>&nbsp;<span class="op" id="4507427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507431">version</span>&nbsp;<span class="op" id="4507439">=</span>&nbsp;<span class="num" id="4507441">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507448">priv</span>&nbsp;<span class="op" id="4507453">:=</span>&nbsp;<span class="ident" id="4507456">pkcs1PrivateKey</span><span class="op" id="4507471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507475">Version</span><span class="op" id="4507482">:</span>&nbsp;<span class="ident" id="4507484">version</span><span class="op" id="4507491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507495">N</span><span class="op" id="4507496">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507504">key</span><span class="op" id="4507507">.</span><span class="ident" id="4507508">N</span><span class="op" id="4507509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507513">E</span><span class="op" id="4507514">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507522">key</span><span class="op" id="4507525">.</span><span class="ident" id="4507526">PublicKey</span><span class="op" id="4507535">.</span><span class="ident" id="4507536">E</span><span class="op" id="4507537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507541">D</span><span class="op" id="4507542">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507550">key</span><span class="op" id="4507553">.</span><span class="ident" id="4507554">D</span><span class="op" id="4507555">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507559">P</span><span class="op" id="4507560">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507568">key</span><span class="op" id="4507571">.</span><span class="ident" id="4507572">Primes</span><span class="op" id="4507578">[</span><span class="num" id="4507579">0</span><span class="op" id="4507580">]</span><span class="op" id="4507581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507585">Q</span><span class="op" id="4507586">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507594">key</span><span class="op" id="4507597">.</span><span class="ident" id="4507598">Primes</span><span class="op" id="4507604">[</span><span class="num" id="4507605">1</span><span class="op" id="4507606">]</span><span class="op" id="4507607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507611">Dp</span><span class="op" id="4507613">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507620">key</span><span class="op" id="4507623">.</span><span class="ident" id="4507624">Precomputed</span><span class="op" id="4507635">.</span><span class="ident" id="4507636">Dp</span><span class="op" id="4507638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507642">Dq</span><span class="op" id="4507644">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507651">key</span><span class="op" id="4507654">.</span><span class="ident" id="4507655">Precomputed</span><span class="op" id="4507666">.</span><span class="ident" id="4507667">Dq</span><span class="op" id="4507669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507673">Qinv</span><span class="op" id="4507677">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507682">key</span><span class="op" id="4507685">.</span><span class="ident" id="4507686">Precomputed</span><span class="op" id="4507697">.</span><span class="ident" id="4507698">Qinv</span><span class="op" id="4507702">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507709">priv</span><span class="op" id="4507713">.</span><span class="ident" id="4507714">AdditionalPrimes</span>&nbsp;<span class="op" id="4507731">=</span>&nbsp;<span class="builtinfunc" id="4507733">make</span><span class="op" id="4507737">(</span><span class="op" id="4507738">[</span><span class="op" id="4507739">]</span><span class="ident" id="4507740">pkcs1AdditionalRSAPrime</span><span class="op" id="4507763">,</span>&nbsp;<span class="builtinfunc" id="4507765">len</span><span class="op" id="4507768">(</span><span class="ident" id="4507769">key</span><span class="op" id="4507772">.</span><span class="ident" id="4507773">Precomputed</span><span class="op" id="4507784">.</span><span class="ident" id="4507785">CRTValues</span><span class="op" id="4507794">)</span><span class="op" id="4507795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507798">for</span>&nbsp;<span class="ident" id="4507802">i</span><span class="op" id="4507803">,</span>&nbsp;<span class="ident" id="4507805">values</span>&nbsp;<span class="op" id="4507812">:=</span>&nbsp;<span class="keyword" id="4507815">range</span>&nbsp;<span class="ident" id="4507821">key</span><span class="op" id="4507824">.</span><span class="ident" id="4507825">Precomputed</span><span class="op" id="4507836">.</span><span class="ident" id="4507837">CRTValues</span>&nbsp;<span class="op" id="4507847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507851">priv</span><span class="op" id="4507855">.</span><span class="ident" id="4507856">AdditionalPrimes</span><span class="op" id="4507872">[</span><span class="ident" id="4507873">i</span><span class="op" id="4507874">]</span><span class="op" id="4507875">.</span><span class="ident" id="4507876">Prime</span>&nbsp;<span class="op" id="4507882">=</span>&nbsp;<span class="ident" id="4507884">key</span><span class="op" id="4507887">.</span><span class="ident" id="4507888">Primes</span><span class="op" id="4507894">[</span><span class="num" id="4507895">2</span><span class="op" id="4507896">+</span><span class="ident" id="4507897">i</span><span class="op" id="4507898">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507902">priv</span><span class="op" id="4507906">.</span><span class="ident" id="4507907">AdditionalPrimes</span><span class="op" id="4507923">[</span><span class="ident" id="4507924">i</span><span class="op" id="4507925">]</span><span class="op" id="4507926">.</span><span class="ident" id="4507927">Exp</span>&nbsp;<span class="op" id="4507931">=</span>&nbsp;<span class="ident" id="4507933">values</span><span class="op" id="4507939">.</span><span class="ident" id="4507940">Exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507946">priv</span><span class="op" id="4507950">.</span><span class="ident" id="4507951">AdditionalPrimes</span><span class="op" id="4507967">[</span><span class="ident" id="4507968">i</span><span class="op" id="4507969">]</span><span class="op" id="4507970">.</span><span class="ident" id="4507971">Coeff</span>&nbsp;<span class="op" id="4507977">=</span>&nbsp;<span class="ident" id="4507979">values</span><span class="op" id="4507985">.</span><span class="ident" id="4507986">Coeff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507997">b</span><span class="op" id="4507998">,</span>&nbsp;<span class="ident" id="4508000">_</span>&nbsp;<span class="op" id="4508002">:=</span>&nbsp;<span class="ident" id="4508005">asn1</span><span class="op" id="4508009">.</span><span class="ident" id="4508010">Marshal</span><span class="op" id="4508017">(</span><span class="ident" id="4508018">priv</span><span class="op" id="4508022">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508025">return</span>&nbsp;<span class="ident" id="4508032">b</span><br>
<span class="lineno"></span><span class="op" id="4508034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4508037">//&nbsp;rsaPublicKey&nbsp;reflects&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;a&nbsp;PKCS#1&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4508106">type</span>&nbsp;<span class="ident" id="4508111">rsaPublicKey</span>&nbsp;<span class="keyword" id="4508124">struct</span>&nbsp;<span class="op" id="4508131">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508134">N</span>&nbsp;<span class="op" id="4508136">*</span><span class="ident" id="4508137">big</span><span class="op" id="4508140">.</span><span class="ident" id="4508141">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508146">E</span>&nbsp;<span class="builtintype" id="4508148">int</span><br>
<span class="lineno"></span><span class="op" id="4508152">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
