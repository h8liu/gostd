<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html" class="current">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2069860">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2069915">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2069969">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2070020">package</span>&nbsp;<span class="ident" id="2070028">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2070034">//&nbsp;Exp&nbsp;returns&nbsp;e**x,&nbsp;the&nbsp;base-e&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2070084">//</span><br>
<span class="lineno"></span><span class="comment" id="2070087">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">10</span><span class="comment" id="2070109">//&nbsp;&nbsp;&nbsp;&nbsp;Exp(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2070129">//&nbsp;&nbsp;&nbsp;&nbsp;Exp(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2070147">//&nbsp;Very&nbsp;large&nbsp;values&nbsp;overflow&nbsp;to&nbsp;0&nbsp;or&nbsp;+Inf.</span><br>
<span class="lineno"></span><span class="comment" id="2070191">//&nbsp;Very&nbsp;small&nbsp;values&nbsp;underflow&nbsp;to&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="2070228">func</span>&nbsp;<span class="ident" id="2070233">Exp</span><span class="op" id="2070236">(</span><span class="ident" id="2070237">x</span>&nbsp;<span class="builtintype" id="2070239">float64</span><span class="op" id="2070246">)</span>&nbsp;<span class="builtintype" id="2070248">float64</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2070257">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2070317">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_exp.c</span><br>
<span class="lineno"></span><span class="comment" id="2070375">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2070434">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">20</span><span class="comment" id="2070464">//</span><br>
<span class="lineno"></span><span class="comment" id="2070467">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2070523">//&nbsp;Copyright&nbsp;(C)&nbsp;2004&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2070592">//</span><br>
<span class="lineno"></span><span class="comment" id="2070595">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno">25</span><span class="comment" id="2070651">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2070708">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2070725">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2070781">//</span><br>
<span class="lineno"></span><span class="comment" id="2070784">//</span><br>
<span class="lineno">30</span><span class="comment" id="2070787">//&nbsp;exp(x)</span><br>
<span class="lineno"></span><span class="comment" id="2070797">//&nbsp;Returns&nbsp;the&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2070830">//</span><br>
<span class="lineno"></span><span class="comment" id="2070833">//&nbsp;Method</span><br>
<span class="lineno"></span><span class="comment" id="2070843">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;reduction:</span><br>
<span class="lineno">35</span><span class="comment" id="2070871">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce&nbsp;x&nbsp;to&nbsp;an&nbsp;r&nbsp;so&nbsp;that&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2&nbsp;~&nbsp;0.34658.</span><br>
<span class="lineno"></span><span class="comment" id="2070930">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Given&nbsp;x,&nbsp;find&nbsp;r&nbsp;and&nbsp;integer&nbsp;k&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2070978">//</span><br>
<span class="lineno"></span><span class="comment" id="2070981">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;r,&nbsp;&nbsp;|r|&nbsp;&lt;=&nbsp;0.5*ln2.</span><br>
<span class="lineno"></span><span class="comment" id="2071030">//</span><br>
<span class="lineno">40</span><span class="comment" id="2071033">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;r&nbsp;will&nbsp;be&nbsp;represented&nbsp;as&nbsp;r&nbsp;=&nbsp;hi-lo&nbsp;for&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="2071092">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accuracy.</span><br>
<span class="lineno"></span><span class="comment" id="2071110">//</span><br>
<span class="lineno"></span><span class="comment" id="2071113">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;exp(r)&nbsp;by&nbsp;a&nbsp;special&nbsp;rational&nbsp;function&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="2071179">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;interval&nbsp;[0,0.34658]:</span><br>
<span class="lineno">45</span><span class="comment" id="2071213">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write</span><br>
<span class="lineno"></span><span class="comment" id="2071227">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(r**2)&nbsp;=&nbsp;r*(exp(r)+1)/(exp(r)-1)&nbsp;=&nbsp;2&nbsp;+&nbsp;r*r/6&nbsp;-&nbsp;r**4/360&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2071302">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Remes&nbsp;algorithm&nbsp;on&nbsp;[0,0.34658]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="2071370">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;5&nbsp;to&nbsp;approximate&nbsp;R.&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2071439">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-59.&nbsp;In</span><br>
<span class="lineno">50</span><span class="comment" id="2071505">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="2071526">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;2.0&nbsp;+&nbsp;P1*z&nbsp;+&nbsp;P2*z**2&nbsp;+&nbsp;P3*z**3&nbsp;+&nbsp;P4*z**4&nbsp;+&nbsp;P5*z**5</span><br>
<span class="lineno"></span><span class="comment" id="2071596">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(where&nbsp;z=r*r,&nbsp;and&nbsp;the&nbsp;values&nbsp;of&nbsp;P1&nbsp;to&nbsp;P5&nbsp;are&nbsp;listed&nbsp;below)</span><br>
<span class="lineno"></span><span class="comment" id="2071663">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2071675">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-59</span><br>
<span class="lineno">55</span><span class="comment" id="2071727">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2.0+P1*z+...+P5*z&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2071776">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="2071820">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;computation&nbsp;of&nbsp;exp(r)&nbsp;thus&nbsp;becomes</span><br>
<span class="lineno"></span><span class="comment" id="2071867">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2*r</span><br>
<span class="lineno"></span><span class="comment" id="2071902">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(r)&nbsp;=&nbsp;1&nbsp;+&nbsp;-------</span><br>
<span class="lineno">60</span><span class="comment" id="2071939">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;-&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="2071975">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r*R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2072018">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;+&nbsp;r&nbsp;+&nbsp;-----------&nbsp;(for&nbsp;better&nbsp;accuracy)</span><br>
<span class="lineno"></span><span class="comment" id="2072085">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;-&nbsp;R1(r)</span><br>
<span class="lineno"></span><span class="comment" id="2072129">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno">65</span><span class="comment" id="2072143">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2072201">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(r)&nbsp;=&nbsp;r&nbsp;-&nbsp;(P1*r&nbsp;&nbsp;+&nbsp;P2*r&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;P5*r&nbsp;&nbsp;&nbsp;).</span><br>
<span class="lineno"></span><span class="comment" id="2072262">//</span><br>
<span class="lineno"></span><span class="comment" id="2072265">//&nbsp;&nbsp;&nbsp;3.&nbsp;Scale&nbsp;back&nbsp;to&nbsp;obtain&nbsp;exp(x):</span><br>
<span class="lineno"></span><span class="comment" id="2072302">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;step&nbsp;1,&nbsp;we&nbsp;have</span><br>
<span class="lineno">70</span><span class="comment" id="2072331">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(x)&nbsp;=&nbsp;2**k&nbsp;*&nbsp;exp(r)</span><br>
<span class="lineno"></span><span class="comment" id="2072365">//</span><br>
<span class="lineno"></span><span class="comment" id="2072368">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="2072386">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(INF)&nbsp;is&nbsp;INF,&nbsp;exp(NaN)&nbsp;is&nbsp;NaN;</span><br>
<span class="lineno"></span><span class="comment" id="2072428">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-INF)&nbsp;is&nbsp;0,&nbsp;and</span><br>
<span class="lineno">75</span><span class="comment" id="2072456">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;finite&nbsp;argument,&nbsp;only&nbsp;exp(0)=1&nbsp;is&nbsp;exact.</span><br>
<span class="lineno"></span><span class="comment" id="2072509">//</span><br>
<span class="lineno"></span><span class="comment" id="2072512">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="2072525">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2072595">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">80</span><span class="comment" id="2072635">//</span><br>
<span class="lineno"></span><span class="comment" id="2072638">//&nbsp;Misc.&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2072653">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;IEEE&nbsp;double</span><br>
<span class="lineno"></span><span class="comment" id="2072677">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;7.09782712893383973096e+02&nbsp;then&nbsp;exp(x)&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="2072745">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-7.45133219101941108420e+02&nbsp;then&nbsp;exp(x)&nbsp;underflow</span><br>
<span class="lineno">85</span><span class="comment" id="2072814">//</span><br>
<span class="lineno"></span><span class="comment" id="2072817">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="2072831">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="2072897">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2072961">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">90</span><span class="comment" id="2073027">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2073072">func</span>&nbsp;<span class="ident" id="2073077">exp</span><span class="op" id="2073080">(</span><span class="ident" id="2073081">x</span>&nbsp;<span class="builtintype" id="2073083">float64</span><span class="op" id="2073090">)</span>&nbsp;<span class="builtintype" id="2073092">float64</span>&nbsp;<span class="op" id="2073100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073103">const</span>&nbsp;<span class="op" id="2073109">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073113">Ln2Hi</span>&nbsp;<span class="op" id="2073119">=</span>&nbsp;<span class="num" id="2073121">6.93147180369123816490e-01</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073150">Ln2Lo</span>&nbsp;<span class="op" id="2073156">=</span>&nbsp;<span class="num" id="2073158">1.90821492927058770002e-10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073187">Log2e</span>&nbsp;<span class="op" id="2073193">=</span>&nbsp;<span class="num" id="2073195">1.44269504088896338700e+00</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073225">Overflow</span>&nbsp;&nbsp;<span class="op" id="2073235">=</span>&nbsp;<span class="num" id="2073237">7.09782712893383973096e+02</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073266">Underflow</span>&nbsp;<span class="op" id="2073276">=</span>&nbsp;<span class="op" id="2073278">-</span><span class="num" id="2073279">7.45133219101941108420e+02</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073308">NearZero</span>&nbsp;&nbsp;<span class="op" id="2073318">=</span>&nbsp;<span class="num" id="2073320">1.0</span>&nbsp;<span class="op" id="2073324">/</span>&nbsp;<span class="op" id="2073326">(</span><span class="num" id="2073327">1</span>&nbsp;<span class="op" id="2073329">&lt;&lt;</span>&nbsp;<span class="num" id="2073332">28</span><span class="op" id="2073334">)</span>&nbsp;<span class="comment" id="2073336">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073347">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073351">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073369">switch</span>&nbsp;<span class="op" id="2073376">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073379">case</span>&nbsp;<span class="ident" id="2073384">IsNaN</span><span class="op" id="2073389">(</span><span class="ident" id="2073390">x</span><span class="op" id="2073391">)</span>&nbsp;<span class="op" id="2073393">||</span>&nbsp;<span class="ident" id="2073396">IsInf</span><span class="op" id="2073401">(</span><span class="ident" id="2073402">x</span><span class="op" id="2073403">,</span>&nbsp;<span class="num" id="2073405">1</span><span class="op" id="2073406">)</span><span class="op" id="2073407">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073411">return</span>&nbsp;<span class="ident" id="2073418">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073421">case</span>&nbsp;<span class="ident" id="2073426">IsInf</span><span class="op" id="2073431">(</span><span class="ident" id="2073432">x</span><span class="op" id="2073433">,</span>&nbsp;<span class="op" id="2073435">-</span><span class="num" id="2073436">1</span><span class="op" id="2073437">)</span><span class="op" id="2073438">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073442">return</span>&nbsp;<span class="num" id="2073449">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073452">case</span>&nbsp;<span class="ident" id="2073457">x</span>&nbsp;<span class="op" id="2073459">&gt;</span>&nbsp;<span class="ident" id="2073461">Overflow</span><span class="op" id="2073469">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073473">return</span>&nbsp;<span class="ident" id="2073480">Inf</span><span class="op" id="2073483">(</span><span class="num" id="2073484">1</span><span class="op" id="2073485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073488">case</span>&nbsp;<span class="ident" id="2073493">x</span>&nbsp;<span class="op" id="2073495">&lt;</span>&nbsp;<span class="ident" id="2073497">Underflow</span><span class="op" id="2073506">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073510">return</span>&nbsp;<span class="num" id="2073517">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073520">case</span>&nbsp;<span class="op" id="2073525">-</span><span class="ident" id="2073526">NearZero</span>&nbsp;<span class="op" id="2073535">&lt;</span>&nbsp;<span class="ident" id="2073537">x</span>&nbsp;<span class="op" id="2073539">&amp;&amp;</span>&nbsp;<span class="ident" id="2073542">x</span>&nbsp;<span class="op" id="2073544">&lt;</span>&nbsp;<span class="ident" id="2073546">NearZero</span><span class="op" id="2073554">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073558">return</span>&nbsp;<span class="num" id="2073565">1</span>&nbsp;<span class="op" id="2073567">+</span>&nbsp;<span class="ident" id="2073569">x</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073576">//&nbsp;reduce;&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073633">var</span>&nbsp;<span class="ident" id="2073637">k</span>&nbsp;<span class="builtintype" id="2073639">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073644">switch</span>&nbsp;<span class="op" id="2073651">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073654">case</span>&nbsp;<span class="ident" id="2073659">x</span>&nbsp;<span class="op" id="2073661">&lt;</span>&nbsp;<span class="num" id="2073663">0</span><span class="op" id="2073664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073668">k</span>&nbsp;<span class="op" id="2073670">=</span>&nbsp;<span class="builtintype" id="2073672">int</span><span class="op" id="2073675">(</span><span class="ident" id="2073676">Log2e</span><span class="op" id="2073681">*</span><span class="ident" id="2073682">x</span>&nbsp;<span class="op" id="2073684">-</span>&nbsp;<span class="num" id="2073686">0.5</span><span class="op" id="2073689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073692">case</span>&nbsp;<span class="ident" id="2073697">x</span>&nbsp;<span class="op" id="2073699">&gt;</span>&nbsp;<span class="num" id="2073701">0</span><span class="op" id="2073702">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073706">k</span>&nbsp;<span class="op" id="2073708">=</span>&nbsp;<span class="builtintype" id="2073710">int</span><span class="op" id="2073713">(</span><span class="ident" id="2073714">Log2e</span><span class="op" id="2073719">*</span><span class="ident" id="2073720">x</span>&nbsp;<span class="op" id="2073722">+</span>&nbsp;<span class="num" id="2073724">0.5</span><span class="op" id="2073727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2073730">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073733">hi</span>&nbsp;<span class="op" id="2073736">:=</span>&nbsp;<span class="ident" id="2073739">x</span>&nbsp;<span class="op" id="2073741">-</span>&nbsp;<span class="builtintype" id="2073743">float64</span><span class="op" id="2073750">(</span><span class="ident" id="2073751">k</span><span class="op" id="2073752">)</span><span class="op" id="2073753">*</span><span class="ident" id="2073754">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073761">lo</span>&nbsp;<span class="op" id="2073764">:=</span>&nbsp;<span class="builtintype" id="2073767">float64</span><span class="op" id="2073774">(</span><span class="ident" id="2073775">k</span><span class="op" id="2073776">)</span>&nbsp;<span class="op" id="2073778">*</span>&nbsp;<span class="ident" id="2073780">Ln2Lo</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2073788">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073800">return</span>&nbsp;<span class="ident" id="2073807">expmulti</span><span class="op" id="2073815">(</span><span class="ident" id="2073816">hi</span><span class="op" id="2073818">,</span>&nbsp;<span class="ident" id="2073820">lo</span><span class="op" id="2073822">,</span>&nbsp;<span class="ident" id="2073824">k</span><span class="op" id="2073825">)</span><br>
<span class="lineno">130</span><span class="op" id="2073827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2073830">//&nbsp;Exp2&nbsp;returns&nbsp;2**x,&nbsp;the&nbsp;base-2&nbsp;exponential&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2073881">//</span><br>
<span class="lineno"></span><span class="comment" id="2073884">//&nbsp;Special&nbsp;cases&nbsp;are&nbsp;the&nbsp;same&nbsp;as&nbsp;Exp.</span><br>
<span class="lineno">135</span><span class="keyword" id="2073922">func</span>&nbsp;<span class="ident" id="2073927">Exp2</span><span class="op" id="2073931">(</span><span class="ident" id="2073932">x</span>&nbsp;<span class="builtintype" id="2073934">float64</span><span class="op" id="2073941">)</span>&nbsp;<span class="builtintype" id="2073943">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2073952">func</span>&nbsp;<span class="ident" id="2073957">exp2</span><span class="op" id="2073961">(</span><span class="ident" id="2073962">x</span>&nbsp;<span class="builtintype" id="2073964">float64</span><span class="op" id="2073971">)</span>&nbsp;<span class="builtintype" id="2073973">float64</span>&nbsp;<span class="op" id="2073981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2073984">const</span>&nbsp;<span class="op" id="2073990">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2073994">Ln2Hi</span>&nbsp;<span class="op" id="2074000">=</span>&nbsp;<span class="num" id="2074002">6.93147180369123816490e-01</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074031">Ln2Lo</span>&nbsp;<span class="op" id="2074037">=</span>&nbsp;<span class="num" id="2074039">1.90821492927058770002e-10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074069">Overflow</span>&nbsp;&nbsp;<span class="op" id="2074079">=</span>&nbsp;<span class="num" id="2074081">1.0239999999999999e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074106">Underflow</span>&nbsp;<span class="op" id="2074116">=</span>&nbsp;<span class="op" id="2074118">-</span><span class="num" id="2074119">1.0740e+03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074131">)</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2074135">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074153">switch</span>&nbsp;<span class="op" id="2074160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074163">case</span>&nbsp;<span class="ident" id="2074168">IsNaN</span><span class="op" id="2074173">(</span><span class="ident" id="2074174">x</span><span class="op" id="2074175">)</span>&nbsp;<span class="op" id="2074177">||</span>&nbsp;<span class="ident" id="2074180">IsInf</span><span class="op" id="2074185">(</span><span class="ident" id="2074186">x</span><span class="op" id="2074187">,</span>&nbsp;<span class="num" id="2074189">1</span><span class="op" id="2074190">)</span><span class="op" id="2074191">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074195">return</span>&nbsp;<span class="ident" id="2074202">x</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074205">case</span>&nbsp;<span class="ident" id="2074210">IsInf</span><span class="op" id="2074215">(</span><span class="ident" id="2074216">x</span><span class="op" id="2074217">,</span>&nbsp;<span class="op" id="2074219">-</span><span class="num" id="2074220">1</span><span class="op" id="2074221">)</span><span class="op" id="2074222">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074226">return</span>&nbsp;<span class="num" id="2074233">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074236">case</span>&nbsp;<span class="ident" id="2074241">x</span>&nbsp;<span class="op" id="2074243">&gt;</span>&nbsp;<span class="ident" id="2074245">Overflow</span><span class="op" id="2074253">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074257">return</span>&nbsp;<span class="ident" id="2074264">Inf</span><span class="op" id="2074267">(</span><span class="num" id="2074268">1</span><span class="op" id="2074269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074272">case</span>&nbsp;<span class="ident" id="2074277">x</span>&nbsp;<span class="op" id="2074279">&lt;</span>&nbsp;<span class="ident" id="2074281">Underflow</span><span class="op" id="2074290">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074294">return</span>&nbsp;<span class="num" id="2074301">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2074308">//&nbsp;argument&nbsp;reduction;&nbsp;x&nbsp;=&nbsp;r×lg(e)&nbsp;+&nbsp;k&nbsp;with&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2074371">//&nbsp;computed&nbsp;as&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;for&nbsp;extra&nbsp;precision.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074420">var</span>&nbsp;<span class="ident" id="2074424">k</span>&nbsp;<span class="builtintype" id="2074426">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074431">switch</span>&nbsp;<span class="op" id="2074438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074441">case</span>&nbsp;<span class="ident" id="2074446">x</span>&nbsp;<span class="op" id="2074448">&gt;</span>&nbsp;<span class="num" id="2074450">0</span><span class="op" id="2074451">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074455">k</span>&nbsp;<span class="op" id="2074457">=</span>&nbsp;<span class="builtintype" id="2074459">int</span><span class="op" id="2074462">(</span><span class="ident" id="2074463">x</span>&nbsp;<span class="op" id="2074465">+</span>&nbsp;<span class="num" id="2074467">0.5</span><span class="op" id="2074470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074473">case</span>&nbsp;<span class="ident" id="2074478">x</span>&nbsp;<span class="op" id="2074480">&lt;</span>&nbsp;<span class="num" id="2074482">0</span><span class="op" id="2074483">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074487">k</span>&nbsp;<span class="op" id="2074489">=</span>&nbsp;<span class="builtintype" id="2074491">int</span><span class="op" id="2074494">(</span><span class="ident" id="2074495">x</span>&nbsp;<span class="op" id="2074497">-</span>&nbsp;<span class="num" id="2074499">0.5</span><span class="op" id="2074502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2074505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074508">t</span>&nbsp;<span class="op" id="2074510">:=</span>&nbsp;<span class="ident" id="2074513">x</span>&nbsp;<span class="op" id="2074515">-</span>&nbsp;<span class="builtintype" id="2074517">float64</span><span class="op" id="2074524">(</span><span class="ident" id="2074525">k</span><span class="op" id="2074526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074529">hi</span>&nbsp;<span class="op" id="2074532">:=</span>&nbsp;<span class="ident" id="2074535">t</span>&nbsp;<span class="op" id="2074537">*</span>&nbsp;<span class="ident" id="2074539">Ln2Hi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074546">lo</span>&nbsp;<span class="op" id="2074549">:=</span>&nbsp;<span class="op" id="2074552">-</span><span class="ident" id="2074553">t</span>&nbsp;<span class="op" id="2074555">*</span>&nbsp;<span class="ident" id="2074557">Ln2Lo</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2074565">//&nbsp;compute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074577">return</span>&nbsp;<span class="ident" id="2074584">expmulti</span><span class="op" id="2074592">(</span><span class="ident" id="2074593">hi</span><span class="op" id="2074595">,</span>&nbsp;<span class="ident" id="2074597">lo</span><span class="op" id="2074599">,</span>&nbsp;<span class="ident" id="2074601">k</span><span class="op" id="2074602">)</span><br>
<span class="lineno"></span><span class="op" id="2074604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="2074607">//&nbsp;exp1&nbsp;returns&nbsp;e**r&nbsp;×&nbsp;2**k&nbsp;where&nbsp;r&nbsp;=&nbsp;hi&nbsp;-&nbsp;lo&nbsp;and&nbsp;|r|&nbsp;≤&nbsp;ln(2)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="2074675">func</span>&nbsp;<span class="ident" id="2074680">expmulti</span><span class="op" id="2074688">(</span><span class="ident" id="2074689">hi</span><span class="op" id="2074691">,</span>&nbsp;<span class="ident" id="2074693">lo</span>&nbsp;<span class="builtintype" id="2074696">float64</span><span class="op" id="2074703">,</span>&nbsp;<span class="ident" id="2074705">k</span>&nbsp;<span class="builtintype" id="2074707">int</span><span class="op" id="2074710">)</span>&nbsp;<span class="builtintype" id="2074712">float64</span>&nbsp;<span class="op" id="2074720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2074723">const</span>&nbsp;<span class="op" id="2074729">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074733">P1</span>&nbsp;<span class="op" id="2074736">=</span>&nbsp;<span class="num" id="2074738">1.66666666666666019037e-01</span>&nbsp;&nbsp;<span class="comment" id="2074766">/*&nbsp;0x3FC55555;&nbsp;0x5555553E&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074797">P2</span>&nbsp;<span class="op" id="2074800">=</span>&nbsp;<span class="op" id="2074802">-</span><span class="num" id="2074803">2.77777777770155933842e-03</span>&nbsp;<span class="comment" id="2074830">/*&nbsp;0xBF66C16C;&nbsp;0x16BEBD93&nbsp;*/</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074861">P3</span>&nbsp;<span class="op" id="2074864">=</span>&nbsp;<span class="num" id="2074866">6.61375632143793436117e-05</span>&nbsp;&nbsp;<span class="comment" id="2074894">/*&nbsp;0x3F11566A;&nbsp;0xAF25DE2C&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074925">P4</span>&nbsp;<span class="op" id="2074928">=</span>&nbsp;<span class="op" id="2074930">-</span><span class="num" id="2074931">1.65339022054652515390e-06</span>&nbsp;<span class="comment" id="2074958">/*&nbsp;0xBEBBBD41;&nbsp;0xC5D26BF1&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2074989">P5</span>&nbsp;<span class="op" id="2074992">=</span>&nbsp;<span class="num" id="2074994">4.13813679705723846039e-08</span>&nbsp;&nbsp;<span class="comment" id="2075022">/*&nbsp;0x3E663769;&nbsp;0x72BEA4D0&nbsp;*/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2075052">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075056">r</span>&nbsp;<span class="op" id="2075058">:=</span>&nbsp;<span class="ident" id="2075061">hi</span>&nbsp;<span class="op" id="2075064">-</span>&nbsp;<span class="ident" id="2075066">lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075070">t</span>&nbsp;<span class="op" id="2075072">:=</span>&nbsp;<span class="ident" id="2075075">r</span>&nbsp;<span class="op" id="2075077">*</span>&nbsp;<span class="ident" id="2075079">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075082">c</span>&nbsp;<span class="op" id="2075084">:=</span>&nbsp;<span class="ident" id="2075087">r</span>&nbsp;<span class="op" id="2075089">-</span>&nbsp;<span class="ident" id="2075091">t</span><span class="op" id="2075092">*</span><span class="op" id="2075093">(</span><span class="ident" id="2075094">P1</span><span class="op" id="2075096">+</span><span class="ident" id="2075097">t</span><span class="op" id="2075098">*</span><span class="op" id="2075099">(</span><span class="ident" id="2075100">P2</span><span class="op" id="2075102">+</span><span class="ident" id="2075103">t</span><span class="op" id="2075104">*</span><span class="op" id="2075105">(</span><span class="ident" id="2075106">P3</span><span class="op" id="2075108">+</span><span class="ident" id="2075109">t</span><span class="op" id="2075110">*</span><span class="op" id="2075111">(</span><span class="ident" id="2075112">P4</span><span class="op" id="2075114">+</span><span class="ident" id="2075115">t</span><span class="op" id="2075116">*</span><span class="ident" id="2075117">P5</span><span class="op" id="2075119">)</span><span class="op" id="2075120">)</span><span class="op" id="2075121">)</span><span class="op" id="2075122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2075125">y</span>&nbsp;<span class="op" id="2075127">:=</span>&nbsp;<span class="num" id="2075130">1</span>&nbsp;<span class="op" id="2075132">-</span>&nbsp;<span class="op" id="2075134">(</span><span class="op" id="2075135">(</span><span class="ident" id="2075136">lo</span>&nbsp;<span class="op" id="2075139">-</span>&nbsp;<span class="op" id="2075141">(</span><span class="ident" id="2075142">r</span><span class="op" id="2075143">*</span><span class="ident" id="2075144">c</span><span class="op" id="2075145">)</span><span class="op" id="2075146">/</span><span class="op" id="2075147">(</span><span class="num" id="2075148">2</span><span class="op" id="2075149">-</span><span class="ident" id="2075150">c</span><span class="op" id="2075151">)</span><span class="op" id="2075152">)</span>&nbsp;<span class="op" id="2075154">-</span>&nbsp;<span class="ident" id="2075156">hi</span><span class="op" id="2075158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2075161">//&nbsp;TODO(rsc):&nbsp;make&nbsp;sure&nbsp;Ldexp&nbsp;can&nbsp;handle&nbsp;boundary&nbsp;k</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2075214">return</span>&nbsp;<span class="ident" id="2075221">Ldexp</span><span class="op" id="2075226">(</span><span class="ident" id="2075227">y</span><span class="op" id="2075228">,</span>&nbsp;<span class="ident" id="2075230">k</span><span class="op" id="2075231">)</span><br>
<span class="lineno"></span><span class="op" id="2075233">}</span>
</div>
</body>
</html>
