<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5203127">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5203182">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5203236">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5203287">package</span>&nbsp;<span class="ident" id="5203295">tar</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5203300">//&nbsp;TODO(dsymonds):</span><br>
<span class="lineno"></span><span class="comment" id="5203319">//&nbsp;&nbsp;&nbsp;-&nbsp;pax&nbsp;extensions</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5203342">import</span>&nbsp;<span class="op" id="5203349">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5203352">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5203361">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5203371">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5203377">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5203390">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5203396">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5203407">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5203418">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="5203425">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5203428">var</span>&nbsp;<span class="op" id="5203432">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203435">ErrHeader</span>&nbsp;<span class="op" id="5203445">=</span>&nbsp;<span class="ident" id="5203447"><a href="/archive/tar/reader.go.html#5203361">errors</a></span><span class="op" id="5203453">.</span><span class="ident" id="5203454">New</span><span class="op" id="5203457">(</span><span class="string" id="5203458">&#34;archive/tar:&nbsp;invalid&nbsp;tar&nbsp;header&#34;</span><span class="op" id="5203491">)</span><br>
<span class="lineno"></span><span class="op" id="5203493">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="5203496">const</span>&nbsp;<span class="ident" id="5203502">maxNanoSecondIntSize</span>&nbsp;<span class="op" id="5203523">=</span>&nbsp;<span class="num" id="5203525">9</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5203528">//&nbsp;A&nbsp;Reader&nbsp;provides&nbsp;sequential&nbsp;access&nbsp;to&nbsp;the&nbsp;contents&nbsp;of&nbsp;a&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="comment" id="5203601">//&nbsp;A&nbsp;tar&nbsp;archive&nbsp;consists&nbsp;of&nbsp;a&nbsp;sequence&nbsp;of&nbsp;files.</span><br>
<span class="lineno"></span><span class="comment" id="5203651">//&nbsp;The&nbsp;Next&nbsp;method&nbsp;advances&nbsp;to&nbsp;the&nbsp;next&nbsp;file&nbsp;in&nbsp;the&nbsp;archive&nbsp;(including&nbsp;the&nbsp;first),</span><br>
<span class="lineno">30</span><span class="comment" id="5203734">//&nbsp;and&nbsp;then&nbsp;it&nbsp;can&nbsp;be&nbsp;treated&nbsp;as&nbsp;an&nbsp;io.Reader&nbsp;to&nbsp;access&nbsp;the&nbsp;file&#39;s&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="5203807">type</span>&nbsp;<span class="ident" id="5203812">Reader</span>&nbsp;<span class="keyword" id="5203819">struct</span>&nbsp;<span class="op" id="5203826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203829">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5203837"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5203839">.</span><span class="ident" id="5203840">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203848">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5203856">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203863">pad</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5203871">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5203887">//&nbsp;amount&nbsp;of&nbsp;padding&nbsp;(ignored)&nbsp;after&nbsp;current&nbsp;file&nbsp;entry</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5203944">curr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5203952"><a href="/archive/tar/reader.go.html#5204200">numBytesReader</a></span>&nbsp;&nbsp;<span class="comment" id="5203968">//&nbsp;reader&nbsp;for&nbsp;current&nbsp;file&nbsp;entry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204002">hdrBuff</span>&nbsp;<span class="op" id="5204010">[</span><span class="ident" id="5204011"><a href="/archive/tar/common.go.html#5195939">blockSize</a></span><span class="op" id="5204020">]</span><span class="builtintype" id="5204021">byte</span>&nbsp;<span class="comment" id="5204026">//&nbsp;buffer&nbsp;to&nbsp;use&nbsp;in&nbsp;readHeader</span><br>
<span class="lineno"></span><span class="op" id="5204057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5204060">//&nbsp;A&nbsp;numBytesReader&nbsp;is&nbsp;an&nbsp;io.Reader&nbsp;with&nbsp;a&nbsp;numBytes&nbsp;method,&nbsp;returning&nbsp;the&nbsp;number</span><br>
<span class="lineno">40</span><span class="comment" id="5204141">//&nbsp;of&nbsp;bytes&nbsp;remaining&nbsp;in&nbsp;the&nbsp;underlying&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="5204195">type</span>&nbsp;<span class="ident" id="5204200">numBytesReader</span>&nbsp;<span class="keyword" id="5204215">interface</span>&nbsp;<span class="op" id="5204225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204228"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5204230">.</span><span class="ident" id="5204231">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204239">numBytes</span><span class="op" id="5204247">(</span><span class="op" id="5204248">)</span>&nbsp;<span class="ident" id="5204250">int64</span><br>
<span class="lineno"></span><span class="op" id="5204256">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5204259">//&nbsp;A&nbsp;regFileReader&nbsp;is&nbsp;a&nbsp;numBytesReader&nbsp;for&nbsp;reading&nbsp;file&nbsp;data&nbsp;from&nbsp;a&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="keyword" id="5204340">type</span>&nbsp;<span class="ident" id="5204345">regFileReader</span>&nbsp;<span class="keyword" id="5204359">struct</span>&nbsp;<span class="op" id="5204366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204369">r</span>&nbsp;&nbsp;<span class="ident" id="5204372"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5204374">.</span><span class="ident" id="5204375">Reader</span>&nbsp;<span class="comment" id="5204382">//&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204404">nb</span>&nbsp;<span class="ident" id="5204407">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5204417">//&nbsp;number&nbsp;of&nbsp;unread&nbsp;bytes&nbsp;for&nbsp;current&nbsp;file&nbsp;entry</span><br>
<span class="lineno">50</span><span class="op" id="5204466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5204469">//&nbsp;A&nbsp;sparseFileReader&nbsp;is&nbsp;a&nbsp;numBytesReader&nbsp;for&nbsp;reading&nbsp;sparse&nbsp;file&nbsp;data&nbsp;from&nbsp;a&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="keyword" id="5204560">type</span>&nbsp;<span class="ident" id="5204565">sparseFileReader</span>&nbsp;<span class="keyword" id="5204582">struct</span>&nbsp;<span class="op" id="5204589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204592">rfr</span>&nbsp;<span class="op" id="5204596">*</span><span class="ident" id="5204597"><a href="/archive/tar/reader.go.html#5204345">regFileReader</a></span>&nbsp;<span class="comment" id="5204611">//&nbsp;reads&nbsp;the&nbsp;sparse-encoded&nbsp;file&nbsp;data</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204650">sp</span>&nbsp;&nbsp;<span class="op" id="5204654">[</span><span class="op" id="5204655">]</span><span class="ident" id="5204656"><a href="/archive/tar/reader.go.html#5217817">sparseEntry</a></span>&nbsp;&nbsp;<span class="comment" id="5204669">//&nbsp;the&nbsp;sparse&nbsp;map&nbsp;for&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204701">pos</span>&nbsp;<span class="ident" id="5204705">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5204720">//&nbsp;keeps&nbsp;track&nbsp;of&nbsp;file&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204753">tot</span>&nbsp;<span class="ident" id="5204757">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5204772">//&nbsp;total&nbsp;size&nbsp;of&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span><span class="op" id="5204798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="5204801">//&nbsp;Keywords&nbsp;for&nbsp;GNU&nbsp;sparse&nbsp;files&nbsp;in&nbsp;a&nbsp;PAX&nbsp;extended&nbsp;header</span><br>
<span class="lineno"></span><span class="keyword" id="5204859">const</span>&nbsp;<span class="op" id="5204865">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204868">paxGNUSparseNumBlocks</span>&nbsp;<span class="op" id="5204890">=</span>&nbsp;<span class="string" id="5204892">&#34;GNU.sparse.numblocks&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204916">paxGNUSparseOffset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5204938">=</span>&nbsp;<span class="string" id="5204940">&#34;GNU.sparse.offset&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5204961">paxGNUSparseNumBytes</span>&nbsp;&nbsp;<span class="op" id="5204983">=</span>&nbsp;<span class="string" id="5204985">&#34;GNU.sparse.numbytes&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205008">paxGNUSparseMap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5205030">=</span>&nbsp;<span class="string" id="5205032">&#34;GNU.sparse.map&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205050">paxGNUSparseName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5205072">=</span>&nbsp;<span class="string" id="5205074">&#34;GNU.sparse.name&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205093">paxGNUSparseMajor</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5205115">=</span>&nbsp;<span class="string" id="5205117">&#34;GNU.sparse.major&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205137">paxGNUSparseMinor</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5205159">=</span>&nbsp;<span class="string" id="5205161">&#34;GNU.sparse.minor&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205181">paxGNUSparseSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5205203">=</span>&nbsp;<span class="string" id="5205205">&#34;GNU.sparse.size&#34;</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205224">paxGNUSparseRealSize</span>&nbsp;&nbsp;<span class="op" id="5205246">=</span>&nbsp;<span class="string" id="5205248">&#34;GNU.sparse.realsize&#34;</span><br>
<span class="lineno"></span><span class="op" id="5205270">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5205273">//&nbsp;Keywords&nbsp;for&nbsp;old&nbsp;GNU&nbsp;sparse&nbsp;headers</span><br>
<span class="lineno"></span><span class="keyword" id="5205312">const</span>&nbsp;<span class="op" id="5205318">(</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205321">oldGNUSparseMainHeaderOffset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5205364">=</span>&nbsp;<span class="num" id="5205366">386</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205371">oldGNUSparseMainHeaderIsExtendedOffset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5205414">=</span>&nbsp;<span class="num" id="5205416">482</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205421">oldGNUSparseMainHeaderNumEntries</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5205464">=</span>&nbsp;<span class="num" id="5205466">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205469">oldGNUSparseExtendedHeaderIsExtendedOffset</span>&nbsp;<span class="op" id="5205512">=</span>&nbsp;<span class="num" id="5205514">504</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205519">oldGNUSparseExtendedHeaderNumEntries</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5205562">=</span>&nbsp;<span class="num" id="5205564">21</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205568">oldGNUSparseOffsetSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5205611">=</span>&nbsp;<span class="num" id="5205613">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205617">oldGNUSparseNumBytesSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5205660">=</span>&nbsp;<span class="num" id="5205662">12</span><br>
<span class="lineno"></span><span class="op" id="5205665">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5205668">//&nbsp;NewReader&nbsp;creates&nbsp;a&nbsp;new&nbsp;Reader&nbsp;reading&nbsp;from&nbsp;r.</span><br>
<span class="lineno">85</span><span class="keyword" id="5205718">func</span>&nbsp;<span class="ident" id="5205723">NewReader</span><span class="op" id="5205732">(</span><span class="ident" id="5205733">r</span>&nbsp;<span class="ident" id="5205735"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5205737">.</span><span class="ident" id="5205738">Reader</span><span class="op" id="5205744">)</span>&nbsp;<span class="op" id="5205746">*</span><span class="ident" id="5205747"><a href="/archive/tar/reader.go.html#5203812">Reader</a></span>&nbsp;<span class="op" id="5205754">{</span>&nbsp;<span class="keyword" id="5205756">return</span>&nbsp;<span class="op" id="5205763">&amp;</span><span class="ident" id="5205764"><a href="/archive/tar/reader.go.html#5203812">Reader</a></span><span class="op" id="5205770">{</span><span class="ident" id="5205771">r</span><span class="op" id="5205772">:</span>&nbsp;<span class="ident" id="5205774"><a href="/archive/tar/reader.go.html#5205733">r</a></span><span class="op" id="5205775">}</span>&nbsp;<span class="op" id="5205777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5205780">//&nbsp;Next&nbsp;advances&nbsp;to&nbsp;the&nbsp;next&nbsp;entry&nbsp;in&nbsp;the&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="keyword" id="5205835">func</span>&nbsp;<span class="op" id="5205840">(</span><span class="ident" id="5205841">tr</span>&nbsp;<span class="op" id="5205844">*</span><span class="ident" id="5205845"><a href="/archive/tar/reader.go.html#5203812">Reader</a></span><span class="op" id="5205851">)</span>&nbsp;<span class="ident" id="5205853">Next</span><span class="op" id="5205857">(</span><span class="op" id="5205858">)</span>&nbsp;<span class="op" id="5205860">(</span><span class="op" id="5205861">*</span><span class="ident" id="5205862"><a href="/archive/tar/common.go.html#5196742">Header</a></span><span class="op" id="5205868">,</span>&nbsp;<span class="builtintype" id="5205870">error</span><span class="op" id="5205875">)</span>&nbsp;<span class="op" id="5205877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5205880">var</span>&nbsp;<span class="ident" id="5205884">hdr</span>&nbsp;<span class="op" id="5205888">*</span><span class="ident" id="5205889"><a href="/archive/tar/common.go.html#5196742">Header</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5205897">if</span>&nbsp;<span class="ident" id="5205900"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5205902">.</span><span class="ident" id="5205903">err</span>&nbsp;<span class="op" id="5205907">==</span>&nbsp;<span class="ident" id="5205910">nil</span>&nbsp;<span class="op" id="5205914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205918"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5205920">.</span><span class="ident" id="5205921">skipUnread</span><span class="op" id="5205931">(</span><span class="op" id="5205932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5205935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5205938">if</span>&nbsp;<span class="ident" id="5205941"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5205943">.</span><span class="ident" id="5205944">err</span>&nbsp;<span class="op" id="5205948">!=</span>&nbsp;<span class="ident" id="5205951">nil</span>&nbsp;<span class="op" id="5205955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5205959">return</span>&nbsp;<span class="ident" id="5205966"><a href="/archive/tar/reader.go.html#5205884">hdr</a></span><span class="op" id="5205969">,</span>&nbsp;<span class="ident" id="5205971"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5205973">.</span><span class="ident" id="5205974">err</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5205979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5205982"><a href="/archive/tar/reader.go.html#5205884">hdr</a></span>&nbsp;<span class="op" id="5205986">=</span>&nbsp;<span class="ident" id="5205988"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5205990">.</span><span class="ident" id="5205991">readHeader</span><span class="op" id="5206001">(</span><span class="op" id="5206002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206005">if</span>&nbsp;<span class="ident" id="5206008"><a href="/archive/tar/reader.go.html#5205884">hdr</a></span>&nbsp;<span class="op" id="5206012">==</span>&nbsp;<span class="ident" id="5206015">nil</span>&nbsp;<span class="op" id="5206019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206023">return</span>&nbsp;<span class="ident" id="5206030"><a href="/archive/tar/reader.go.html#5205884">hdr</a></span><span class="op" id="5206033">,</span>&nbsp;<span class="ident" id="5206035"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5206037">.</span><span class="ident" id="5206038">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5206043">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5206046">//&nbsp;Check&nbsp;for&nbsp;PAX/GNU&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206076">switch</span>&nbsp;<span class="ident" id="5206083"><a href="/archive/tar/reader.go.html#5205884">hdr</a></span><span class="op" id="5206086">.</span><span class="ident" id="5206087">Typeflag</span>&nbsp;<span class="op" id="5206096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206099">case</span>&nbsp;<span class="ident" id="5206104"><a href="/archive/tar/common.go.html#5196365">TypeXHeader</a></span><span class="op" id="5206115">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5206119">//&nbsp;&nbsp;PAX&nbsp;extended&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206145">headers</span><span class="op" id="5206152">,</span>&nbsp;<span class="ident" id="5206154">err</span>&nbsp;<span class="op" id="5206158">:=</span>&nbsp;<span class="ident" id="5206161"><a href="/archive/tar/reader.go.html#5211638">parsePAX</a></span><span class="op" id="5206169">(</span><span class="ident" id="5206170"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5206172">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206176">if</span>&nbsp;<span class="ident" id="5206179"><a href="/archive/tar/reader.go.html#5206154">err</a></span>&nbsp;<span class="op" id="5206183">!=</span>&nbsp;<span class="ident" id="5206186">nil</span>&nbsp;<span class="op" id="5206190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206195">return</span>&nbsp;<span class="ident" id="5206202">nil</span><span class="op" id="5206205">,</span>&nbsp;<span class="ident" id="5206207"><a href="/archive/tar/reader.go.html#5206154">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5206213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5206217">//&nbsp;We&nbsp;actually&nbsp;read&nbsp;the&nbsp;whole&nbsp;file,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5206255">//&nbsp;but&nbsp;this&nbsp;skips&nbsp;alignment&nbsp;padding</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206293"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5206295">.</span><span class="ident" id="5206296">skipUnread</span><span class="op" id="5206306">(</span><span class="op" id="5206307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206311"><a href="/archive/tar/reader.go.html#5205884">hdr</a></span>&nbsp;<span class="op" id="5206315">=</span>&nbsp;<span class="ident" id="5206317"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5206319">.</span><span class="ident" id="5206320">readHeader</span><span class="op" id="5206330">(</span><span class="op" id="5206331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206335"><a href="/archive/tar/reader.go.html#5209386">mergePAX</a></span><span class="op" id="5206343">(</span><span class="ident" id="5206344"><a href="/archive/tar/reader.go.html#5205884">hdr</a></span><span class="op" id="5206347">,</span>&nbsp;<span class="ident" id="5206349"><a href="/archive/tar/reader.go.html#5206145">headers</a></span><span class="op" id="5206356">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5206361">//&nbsp;Check&nbsp;for&nbsp;a&nbsp;PAX&nbsp;format&nbsp;sparse&nbsp;file</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206401">sp</span><span class="op" id="5206403">,</span>&nbsp;<span class="ident" id="5206405"><a href="/archive/tar/reader.go.html#5206154">err</a></span>&nbsp;<span class="op" id="5206409">:=</span>&nbsp;<span class="ident" id="5206412"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5206414">.</span><span class="ident" id="5206415">checkForGNUSparsePAXHeaders</span><span class="op" id="5206442">(</span><span class="ident" id="5206443"><a href="/archive/tar/reader.go.html#5205884">hdr</a></span><span class="op" id="5206446">,</span>&nbsp;<span class="ident" id="5206448"><a href="/archive/tar/reader.go.html#5206145">headers</a></span><span class="op" id="5206455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206459">if</span>&nbsp;<span class="ident" id="5206462"><a href="/archive/tar/reader.go.html#5206154">err</a></span>&nbsp;<span class="op" id="5206466">!=</span>&nbsp;<span class="ident" id="5206469">nil</span>&nbsp;<span class="op" id="5206473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206478"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5206480">.</span><span class="ident" id="5206481">err</span>&nbsp;<span class="op" id="5206485">=</span>&nbsp;<span class="ident" id="5206487"><a href="/archive/tar/reader.go.html#5206154">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206494">return</span>&nbsp;<span class="ident" id="5206501">nil</span><span class="op" id="5206504">,</span>&nbsp;<span class="ident" id="5206506"><a href="/archive/tar/reader.go.html#5206154">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5206512">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206516">if</span>&nbsp;<span class="ident" id="5206519"><a href="/archive/tar/reader.go.html#5206401">sp</a></span>&nbsp;<span class="op" id="5206522">!=</span>&nbsp;<span class="ident" id="5206525">nil</span>&nbsp;<span class="op" id="5206529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5206534">//&nbsp;Current&nbsp;file&nbsp;is&nbsp;a&nbsp;PAX&nbsp;format&nbsp;GNU&nbsp;sparse&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5206586">//&nbsp;Set&nbsp;the&nbsp;current&nbsp;file&nbsp;reader&nbsp;to&nbsp;a&nbsp;sparse&nbsp;file&nbsp;reader.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206645"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5206647">.</span><span class="ident" id="5206648">curr</span>&nbsp;<span class="op" id="5206653">=</span>&nbsp;<span class="op" id="5206655">&amp;</span><span class="ident" id="5206656"><a href="/archive/tar/reader.go.html#5204565">sparseFileReader</a></span><span class="op" id="5206672">{</span><span class="ident" id="5206673">rfr</span><span class="op" id="5206676">:</span>&nbsp;<span class="ident" id="5206678"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5206680">.</span><span class="ident" id="5206681">curr</span><span class="op" id="5206685">.</span><span class="op" id="5206686">(</span><span class="op" id="5206687">*</span><span class="ident" id="5206688"><a href="/archive/tar/reader.go.html#5204345">regFileReader</a></span><span class="op" id="5206701">)</span><span class="op" id="5206702">,</span>&nbsp;<span class="ident" id="5206704">sp</span><span class="op" id="5206706">:</span>&nbsp;<span class="ident" id="5206708"><a href="/archive/tar/reader.go.html#5206401">sp</a></span><span class="op" id="5206710">,</span>&nbsp;<span class="ident" id="5206712">tot</span><span class="op" id="5206715">:</span>&nbsp;<span class="ident" id="5206717"><a href="/archive/tar/reader.go.html#5205884">hdr</a></span><span class="op" id="5206720">.</span><span class="ident" id="5206721">Size</span><span class="op" id="5206725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5206729">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206733">return</span>&nbsp;<span class="ident" id="5206740"><a href="/archive/tar/reader.go.html#5205884">hdr</a></span><span class="op" id="5206743">,</span>&nbsp;<span class="ident" id="5206745">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206750">case</span>&nbsp;<span class="ident" id="5206755"><a href="/archive/tar/common.go.html#5196466">TypeGNULongName</a></span><span class="op" id="5206770">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5206774">//&nbsp;We&nbsp;have&nbsp;a&nbsp;GNU&nbsp;long&nbsp;name&nbsp;header.&nbsp;Its&nbsp;contents&nbsp;are&nbsp;the&nbsp;real&nbsp;file&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206848">realname</span><span class="op" id="5206856">,</span>&nbsp;<span class="ident" id="5206858">err</span>&nbsp;<span class="op" id="5206862">:=</span>&nbsp;<span class="ident" id="5206865"><a href="/archive/tar/reader.go.html#5203377">ioutil</a></span><span class="op" id="5206871">.</span><span class="ident" id="5206872">ReadAll</span><span class="op" id="5206879">(</span><span class="ident" id="5206880"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5206882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206886">if</span>&nbsp;<span class="ident" id="5206889"><a href="/archive/tar/reader.go.html#5206858">err</a></span>&nbsp;<span class="op" id="5206893">!=</span>&nbsp;<span class="ident" id="5206896">nil</span>&nbsp;<span class="op" id="5206900">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206905">return</span>&nbsp;<span class="ident" id="5206912">nil</span><span class="op" id="5206915">,</span>&nbsp;<span class="ident" id="5206917"><a href="/archive/tar/reader.go.html#5206858">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5206923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206927">hdr</span><span class="op" id="5206930">,</span>&nbsp;<span class="ident" id="5206932"><a href="/archive/tar/reader.go.html#5206858">err</a></span>&nbsp;<span class="op" id="5206936">:=</span>&nbsp;<span class="ident" id="5206939"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5206941">.</span><span class="ident" id="5206942">Next</span><span class="op" id="5206946">(</span><span class="op" id="5206947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5206951"><a href="/archive/tar/reader.go.html#5206927">hdr</a></span><span class="op" id="5206954">.</span><span class="ident" id="5206955">Name</span>&nbsp;<span class="op" id="5206960">=</span>&nbsp;<span class="ident" id="5206962"><a href="/archive/tar/reader.go.html#5213495">cString</a></span><span class="op" id="5206969">(</span><span class="ident" id="5206970"><a href="/archive/tar/reader.go.html#5206848">realname</a></span><span class="op" id="5206978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206982">return</span>&nbsp;<span class="ident" id="5206989"><a href="/archive/tar/reader.go.html#5206927">hdr</a></span><span class="op" id="5206992">,</span>&nbsp;<span class="ident" id="5206994"><a href="/archive/tar/reader.go.html#5206858">err</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5206999">case</span>&nbsp;<span class="ident" id="5207004"><a href="/archive/tar/common.go.html#5196523">TypeGNULongLink</a></span><span class="op" id="5207019">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5207023">//&nbsp;We&nbsp;have&nbsp;a&nbsp;GNU&nbsp;long&nbsp;link&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5207060">realname</span><span class="op" id="5207068">,</span>&nbsp;<span class="ident" id="5207070">err</span>&nbsp;<span class="op" id="5207074">:=</span>&nbsp;<span class="ident" id="5207077"><a href="/archive/tar/reader.go.html#5203377">ioutil</a></span><span class="op" id="5207083">.</span><span class="ident" id="5207084">ReadAll</span><span class="op" id="5207091">(</span><span class="ident" id="5207092"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5207094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207098">if</span>&nbsp;<span class="ident" id="5207101"><a href="/archive/tar/reader.go.html#5207070">err</a></span>&nbsp;<span class="op" id="5207105">!=</span>&nbsp;<span class="ident" id="5207108">nil</span>&nbsp;<span class="op" id="5207112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207117">return</span>&nbsp;<span class="ident" id="5207124">nil</span><span class="op" id="5207127">,</span>&nbsp;<span class="ident" id="5207129"><a href="/archive/tar/reader.go.html#5207070">err</a></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5207135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5207139">hdr</span><span class="op" id="5207142">,</span>&nbsp;<span class="ident" id="5207144"><a href="/archive/tar/reader.go.html#5207070">err</a></span>&nbsp;<span class="op" id="5207148">:=</span>&nbsp;<span class="ident" id="5207151"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5207153">.</span><span class="ident" id="5207154">Next</span><span class="op" id="5207158">(</span><span class="op" id="5207159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5207163"><a href="/archive/tar/reader.go.html#5207139">hdr</a></span><span class="op" id="5207166">.</span><span class="ident" id="5207167">Linkname</span>&nbsp;<span class="op" id="5207176">=</span>&nbsp;<span class="ident" id="5207178"><a href="/archive/tar/reader.go.html#5213495">cString</a></span><span class="op" id="5207185">(</span><span class="ident" id="5207186"><a href="/archive/tar/reader.go.html#5207060">realname</a></span><span class="op" id="5207194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207198">return</span>&nbsp;<span class="ident" id="5207205"><a href="/archive/tar/reader.go.html#5207139">hdr</a></span><span class="op" id="5207208">,</span>&nbsp;<span class="ident" id="5207210"><a href="/archive/tar/reader.go.html#5207070">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5207215">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207218">return</span>&nbsp;<span class="ident" id="5207225"><a href="/archive/tar/reader.go.html#5205884">hdr</a></span><span class="op" id="5207228">,</span>&nbsp;<span class="ident" id="5207230"><a href="/archive/tar/reader.go.html#5205841">tr</a></span><span class="op" id="5207232">.</span><span class="ident" id="5207233">err</span><br>
<span class="lineno"></span><span class="op" id="5207237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5207240">//&nbsp;checkForGNUSparsePAXHeaders&nbsp;checks&nbsp;the&nbsp;PAX&nbsp;headers&nbsp;for&nbsp;GNU&nbsp;sparse&nbsp;headers.&nbsp;If&nbsp;they&nbsp;are&nbsp;found,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5207342">//&nbsp;this&nbsp;function&nbsp;reads&nbsp;the&nbsp;sparse&nbsp;map&nbsp;and&nbsp;returns&nbsp;it.&nbsp;Unknown&nbsp;sparse&nbsp;formats&nbsp;are&nbsp;ignored,&nbsp;causing&nbsp;the&nbsp;file&nbsp;to</span><br>
<span class="lineno">150</span><span class="comment" id="5207452">//&nbsp;be&nbsp;treated&nbsp;as&nbsp;a&nbsp;regular&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5207485">func</span>&nbsp;<span class="op" id="5207490">(</span><span class="ident" id="5207491">tr</span>&nbsp;<span class="op" id="5207494">*</span><span class="ident" id="5207495"><a href="/archive/tar/reader.go.html#5203812">Reader</a></span><span class="op" id="5207501">)</span>&nbsp;<span class="ident" id="5207503">checkForGNUSparsePAXHeaders</span><span class="op" id="5207530">(</span><span class="ident" id="5207531">hdr</span>&nbsp;<span class="op" id="5207535">*</span><span class="ident" id="5207536"><a href="/archive/tar/common.go.html#5196742">Header</a></span><span class="op" id="5207542">,</span>&nbsp;<span class="ident" id="5207544">headers</span>&nbsp;<span class="keyword" id="5207552">map</span><span class="op" id="5207555">[</span><span class="builtintype" id="5207556">string</span><span class="op" id="5207562">]</span><span class="builtintype" id="5207563">string</span><span class="op" id="5207569">)</span>&nbsp;<span class="op" id="5207571">(</span><span class="op" id="5207572">[</span><span class="op" id="5207573">]</span><span class="ident" id="5207574"><a href="/archive/tar/reader.go.html#5217817">sparseEntry</a></span><span class="op" id="5207585">,</span>&nbsp;<span class="builtintype" id="5207587">error</span><span class="op" id="5207592">)</span>&nbsp;<span class="op" id="5207594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5207597">var</span>&nbsp;<span class="ident" id="5207601">sparseFormat</span>&nbsp;<span class="builtintype" id="5207614">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5207623">//&nbsp;Check&nbsp;for&nbsp;sparse&nbsp;format&nbsp;indicators</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5207662">major</span><span class="op" id="5207667">,</span>&nbsp;<span class="ident" id="5207669">majorOk</span>&nbsp;<span class="op" id="5207677">:=</span>&nbsp;<span class="ident" id="5207680"><a href="/archive/tar/reader.go.html#5207544">headers</a></span><span class="op" id="5207687">[</span><span class="ident" id="5207688"><a href="/archive/tar/reader.go.html#5205093">paxGNUSparseMajor</a></span><span class="op" id="5207705">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5207708">minor</span><span class="op" id="5207713">,</span>&nbsp;<span class="ident" id="5207715">minorOk</span>&nbsp;<span class="op" id="5207723">:=</span>&nbsp;<span class="ident" id="5207726"><a href="/archive/tar/reader.go.html#5207544">headers</a></span><span class="op" id="5207733">[</span><span class="ident" id="5207734"><a href="/archive/tar/reader.go.html#5205137">paxGNUSparseMinor</a></span><span class="op" id="5207751">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5207754">sparseName</span><span class="op" id="5207764">,</span>&nbsp;<span class="ident" id="5207766">sparseNameOk</span>&nbsp;<span class="op" id="5207779">:=</span>&nbsp;<span class="ident" id="5207782"><a href="/archive/tar/reader.go.html#5207544">headers</a></span><span class="op" id="5207789">[</span><span class="ident" id="5207790"><a href="/archive/tar/reader.go.html#5205050">paxGNUSparseName</a></span><span class="op" id="5207806">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5207809">_</span><span class="op" id="5207810">,</span>&nbsp;<span class="ident" id="5207812">sparseMapOk</span>&nbsp;<span class="op" id="5207824">:=</span>&nbsp;<span class="ident" id="5207827"><a href="/archive/tar/reader.go.html#5207544">headers</a></span><span class="op" id="5207834">[</span><span class="ident" id="5207835"><a href="/archive/tar/reader.go.html#5205008">paxGNUSparseMap</a></span><span class="op" id="5207850">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5207853">sparseSize</span><span class="op" id="5207863">,</span>&nbsp;<span class="ident" id="5207865">sparseSizeOk</span>&nbsp;<span class="op" id="5207878">:=</span>&nbsp;<span class="ident" id="5207881"><a href="/archive/tar/reader.go.html#5207544">headers</a></span><span class="op" id="5207888">[</span><span class="ident" id="5207889"><a href="/archive/tar/reader.go.html#5205181">paxGNUSparseSize</a></span><span class="op" id="5207905">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5207908">sparseRealSize</span><span class="op" id="5207922">,</span>&nbsp;<span class="ident" id="5207924">sparseRealSizeOk</span>&nbsp;<span class="op" id="5207941">:=</span>&nbsp;<span class="ident" id="5207944"><a href="/archive/tar/reader.go.html#5207544">headers</a></span><span class="op" id="5207951">[</span><span class="ident" id="5207952"><a href="/archive/tar/reader.go.html#5205224">paxGNUSparseRealSize</a></span><span class="op" id="5207972">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5207976">//&nbsp;Identify&nbsp;which,&nbsp;if&nbsp;any,&nbsp;sparse&nbsp;format&nbsp;applies&nbsp;from&nbsp;which&nbsp;PAX&nbsp;headers&nbsp;are&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208057">if</span>&nbsp;<span class="ident" id="5208060"><a href="/archive/tar/reader.go.html#5207669">majorOk</a></span>&nbsp;<span class="op" id="5208068">&amp;&amp;</span>&nbsp;<span class="ident" id="5208071"><a href="/archive/tar/reader.go.html#5207715">minorOk</a></span>&nbsp;<span class="op" id="5208079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208083"><a href="/archive/tar/reader.go.html#5207601">sparseFormat</a></span>&nbsp;<span class="op" id="5208096">=</span>&nbsp;<span class="ident" id="5208098"><a href="/archive/tar/reader.go.html#5207662">major</a></span>&nbsp;<span class="op" id="5208104">+</span>&nbsp;<span class="string" id="5208106">&#34;.&#34;</span>&nbsp;<span class="op" id="5208110">+</span>&nbsp;<span class="ident" id="5208112"><a href="/archive/tar/reader.go.html#5207708">minor</a></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208119">}</span>&nbsp;<span class="keyword" id="5208121">else</span>&nbsp;<span class="keyword" id="5208126">if</span>&nbsp;<span class="ident" id="5208129"><a href="/archive/tar/reader.go.html#5207766">sparseNameOk</a></span>&nbsp;<span class="op" id="5208142">&amp;&amp;</span>&nbsp;<span class="ident" id="5208145"><a href="/archive/tar/reader.go.html#5207812">sparseMapOk</a></span>&nbsp;<span class="op" id="5208157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208161"><a href="/archive/tar/reader.go.html#5207601">sparseFormat</a></span>&nbsp;<span class="op" id="5208174">=</span>&nbsp;<span class="string" id="5208176">&#34;0.1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208183">}</span>&nbsp;<span class="keyword" id="5208185">else</span>&nbsp;<span class="keyword" id="5208190">if</span>&nbsp;<span class="ident" id="5208193"><a href="/archive/tar/reader.go.html#5207865">sparseSizeOk</a></span>&nbsp;<span class="op" id="5208206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208210"><a href="/archive/tar/reader.go.html#5207601">sparseFormat</a></span>&nbsp;<span class="op" id="5208223">=</span>&nbsp;<span class="string" id="5208225">&#34;0.0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208232">}</span>&nbsp;<span class="keyword" id="5208234">else</span>&nbsp;<span class="op" id="5208239">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5208243">//&nbsp;Not&nbsp;a&nbsp;PAX&nbsp;format&nbsp;GNU&nbsp;sparse&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208282">return</span>&nbsp;<span class="ident" id="5208289">nil</span><span class="op" id="5208292">,</span>&nbsp;<span class="ident" id="5208294">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5208303">//&nbsp;Check&nbsp;for&nbsp;unknown&nbsp;sparse&nbsp;format</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208339">if</span>&nbsp;<span class="ident" id="5208342"><a href="/archive/tar/reader.go.html#5207601">sparseFormat</a></span>&nbsp;<span class="op" id="5208355">!=</span>&nbsp;<span class="string" id="5208358">&#34;0.0&#34;</span>&nbsp;<span class="op" id="5208364">&amp;&amp;</span>&nbsp;<span class="ident" id="5208367"><a href="/archive/tar/reader.go.html#5207601">sparseFormat</a></span>&nbsp;<span class="op" id="5208380">!=</span>&nbsp;<span class="string" id="5208383">&#34;0.1&#34;</span>&nbsp;<span class="op" id="5208389">&amp;&amp;</span>&nbsp;<span class="ident" id="5208392"><a href="/archive/tar/reader.go.html#5207601">sparseFormat</a></span>&nbsp;<span class="op" id="5208405">!=</span>&nbsp;<span class="string" id="5208408">&#34;1.0&#34;</span>&nbsp;<span class="op" id="5208414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208418">return</span>&nbsp;<span class="ident" id="5208425">nil</span><span class="op" id="5208428">,</span>&nbsp;<span class="ident" id="5208430">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5208439">//&nbsp;Update&nbsp;hdr&nbsp;from&nbsp;GNU&nbsp;sparse&nbsp;PAX&nbsp;headers</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208482">if</span>&nbsp;<span class="ident" id="5208485"><a href="/archive/tar/reader.go.html#5207766">sparseNameOk</a></span>&nbsp;<span class="op" id="5208498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208502"><a href="/archive/tar/reader.go.html#5207531">hdr</a></span><span class="op" id="5208505">.</span><span class="ident" id="5208506">Name</span>&nbsp;<span class="op" id="5208511">=</span>&nbsp;<span class="ident" id="5208513"><a href="/archive/tar/reader.go.html#5207754">sparseName</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208528">if</span>&nbsp;<span class="ident" id="5208531"><a href="/archive/tar/reader.go.html#5207865">sparseSizeOk</a></span>&nbsp;<span class="op" id="5208544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208548">realSize</span><span class="op" id="5208556">,</span>&nbsp;<span class="ident" id="5208558">err</span>&nbsp;<span class="op" id="5208562">:=</span>&nbsp;<span class="ident" id="5208565"><a href="/archive/tar/reader.go.html#5203396">strconv</a></span><span class="op" id="5208572">.</span><span class="ident" id="5208573">ParseInt</span><span class="op" id="5208581">(</span><span class="ident" id="5208582"><a href="/archive/tar/reader.go.html#5207853">sparseSize</a></span><span class="op" id="5208592">,</span>&nbsp;<span class="num" id="5208594">10</span><span class="op" id="5208596">,</span>&nbsp;<span class="num" id="5208598">0</span><span class="op" id="5208599">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208603">if</span>&nbsp;<span class="ident" id="5208606"><a href="/archive/tar/reader.go.html#5208558">err</a></span>&nbsp;<span class="op" id="5208610">!=</span>&nbsp;<span class="ident" id="5208613">nil</span>&nbsp;<span class="op" id="5208617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208622">return</span>&nbsp;<span class="ident" id="5208629">nil</span><span class="op" id="5208632">,</span>&nbsp;<span class="ident" id="5208634"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208650"><a href="/archive/tar/reader.go.html#5207531">hdr</a></span><span class="op" id="5208653">.</span><span class="ident" id="5208654">Size</span>&nbsp;<span class="op" id="5208659">=</span>&nbsp;<span class="ident" id="5208661"><a href="/archive/tar/reader.go.html#5208548">realSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208671">}</span>&nbsp;<span class="keyword" id="5208673">else</span>&nbsp;<span class="keyword" id="5208678">if</span>&nbsp;<span class="ident" id="5208681"><a href="/archive/tar/reader.go.html#5207924">sparseRealSizeOk</a></span>&nbsp;<span class="op" id="5208698">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208702">realSize</span><span class="op" id="5208710">,</span>&nbsp;<span class="ident" id="5208712">err</span>&nbsp;<span class="op" id="5208716">:=</span>&nbsp;<span class="ident" id="5208719"><a href="/archive/tar/reader.go.html#5203396">strconv</a></span><span class="op" id="5208726">.</span><span class="ident" id="5208727">ParseInt</span><span class="op" id="5208735">(</span><span class="ident" id="5208736"><a href="/archive/tar/reader.go.html#5207908">sparseRealSize</a></span><span class="op" id="5208750">,</span>&nbsp;<span class="num" id="5208752">10</span><span class="op" id="5208754">,</span>&nbsp;<span class="num" id="5208756">0</span><span class="op" id="5208757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208761">if</span>&nbsp;<span class="ident" id="5208764"><a href="/archive/tar/reader.go.html#5208712">err</a></span>&nbsp;<span class="op" id="5208768">!=</span>&nbsp;<span class="ident" id="5208771">nil</span>&nbsp;<span class="op" id="5208775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208780">return</span>&nbsp;<span class="ident" id="5208787">nil</span><span class="op" id="5208790">,</span>&nbsp;<span class="ident" id="5208792"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208808"><a href="/archive/tar/reader.go.html#5207531">hdr</a></span><span class="op" id="5208811">.</span><span class="ident" id="5208812">Size</span>&nbsp;<span class="op" id="5208817">=</span>&nbsp;<span class="ident" id="5208819"><a href="/archive/tar/reader.go.html#5208702">realSize</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5208829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5208833">//&nbsp;Set&nbsp;up&nbsp;the&nbsp;sparse&nbsp;map,&nbsp;according&nbsp;to&nbsp;the&nbsp;particular&nbsp;sparse&nbsp;format&nbsp;in&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208909">var</span>&nbsp;<span class="ident" id="5208913">sp</span>&nbsp;<span class="op" id="5208916">[</span><span class="op" id="5208917">]</span><span class="ident" id="5208918"><a href="/archive/tar/reader.go.html#5217817">sparseEntry</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208931">var</span>&nbsp;<span class="ident" id="5208935">err</span>&nbsp;<span class="builtintype" id="5208939">error</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208946">switch</span>&nbsp;<span class="ident" id="5208953"><a href="/archive/tar/reader.go.html#5207601">sparseFormat</a></span>&nbsp;<span class="op" id="5208966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5208969">case</span>&nbsp;<span class="string" id="5208974">&#34;0.0&#34;</span><span class="op" id="5208979">,</span>&nbsp;<span class="string" id="5208981">&#34;0.1&#34;</span><span class="op" id="5208986">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5208990"><a href="/archive/tar/reader.go.html#5208913">sp</a></span><span class="op" id="5208992">,</span>&nbsp;<span class="ident" id="5208994"><a href="/archive/tar/reader.go.html#5208935">err</a></span>&nbsp;<span class="op" id="5208998">=</span>&nbsp;<span class="ident" id="5209000"><a href="/archive/tar/reader.go.html#5222036">readGNUSparseMap0x1</a></span><span class="op" id="5209019">(</span><span class="ident" id="5209020"><a href="/archive/tar/reader.go.html#5207544">headers</a></span><span class="op" id="5209027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209030">case</span>&nbsp;<span class="string" id="5209035">&#34;1.0&#34;</span><span class="op" id="5209040">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209044"><a href="/archive/tar/reader.go.html#5208913">sp</a></span><span class="op" id="5209046">,</span>&nbsp;<span class="ident" id="5209048"><a href="/archive/tar/reader.go.html#5208935">err</a></span>&nbsp;<span class="op" id="5209052">=</span>&nbsp;<span class="ident" id="5209054"><a href="/archive/tar/reader.go.html#5219783">readGNUSparseMap1x0</a></span><span class="op" id="5209073">(</span><span class="ident" id="5209074"><a href="/archive/tar/reader.go.html#5207491">tr</a></span><span class="op" id="5209076">.</span><span class="ident" id="5209077">curr</span><span class="op" id="5209081">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5209084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209087">return</span>&nbsp;<span class="ident" id="5209094"><a href="/archive/tar/reader.go.html#5208913">sp</a></span><span class="op" id="5209096">,</span>&nbsp;<span class="ident" id="5209098"><a href="/archive/tar/reader.go.html#5208935">err</a></span><br>
<span class="lineno"></span><span class="op" id="5209102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5209105">//&nbsp;mergePAX&nbsp;merges&nbsp;well&nbsp;known&nbsp;headers&nbsp;according&nbsp;to&nbsp;PAX&nbsp;standard.</span><br>
<span class="lineno">210</span><span class="comment" id="5209170">//&nbsp;In&nbsp;general&nbsp;headers&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;as&nbsp;those&nbsp;found</span><br>
<span class="lineno"></span><span class="comment" id="5209226">//&nbsp;in&nbsp;the&nbsp;header&nbsp;struct&nbsp;overwrite&nbsp;those&nbsp;found&nbsp;in&nbsp;the&nbsp;header</span><br>
<span class="lineno"></span><span class="comment" id="5209286">//&nbsp;struct&nbsp;with&nbsp;higher&nbsp;precision&nbsp;or&nbsp;longer&nbsp;values.&nbsp;Esp.&nbsp;useful</span><br>
<span class="lineno"></span><span class="comment" id="5209348">//&nbsp;for&nbsp;name&nbsp;and&nbsp;linkname&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="5209381">func</span>&nbsp;<span class="ident" id="5209386">mergePAX</span><span class="op" id="5209394">(</span><span class="ident" id="5209395">hdr</span>&nbsp;<span class="op" id="5209399">*</span><span class="ident" id="5209400"><a href="/archive/tar/common.go.html#5196742">Header</a></span><span class="op" id="5209406">,</span>&nbsp;<span class="ident" id="5209408">headers</span>&nbsp;<span class="keyword" id="5209416">map</span><span class="op" id="5209419">[</span><span class="builtintype" id="5209420">string</span><span class="op" id="5209426">]</span><span class="builtintype" id="5209427">string</span><span class="op" id="5209433">)</span>&nbsp;<span class="builtintype" id="5209435">error</span>&nbsp;<span class="op" id="5209441">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209444">for</span>&nbsp;<span class="ident" id="5209448">k</span><span class="op" id="5209449">,</span>&nbsp;<span class="ident" id="5209451">v</span>&nbsp;<span class="op" id="5209453">:=</span>&nbsp;<span class="keyword" id="5209456">range</span>&nbsp;<span class="ident" id="5209462"><a href="/archive/tar/reader.go.html#5209408">headers</a></span>&nbsp;<span class="op" id="5209470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209474">switch</span>&nbsp;<span class="ident" id="5209481"><a href="/archive/tar/reader.go.html#5209448">k</a></span>&nbsp;<span class="op" id="5209483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209487">case</span>&nbsp;<span class="ident" id="5209492"><a href="/archive/tar/common.go.html#5200505">paxPath</a></span><span class="op" id="5209499">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209504"><a href="/archive/tar/reader.go.html#5209395">hdr</a></span><span class="op" id="5209507">.</span><span class="ident" id="5209508">Name</span>&nbsp;<span class="op" id="5209513">=</span>&nbsp;<span class="ident" id="5209515"><a href="/archive/tar/reader.go.html#5209451">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209519">case</span>&nbsp;<span class="ident" id="5209524"><a href="/archive/tar/common.go.html#5200456">paxLinkpath</a></span><span class="op" id="5209535">:</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209540"><a href="/archive/tar/reader.go.html#5209395">hdr</a></span><span class="op" id="5209543">.</span><span class="ident" id="5209544">Linkname</span>&nbsp;<span class="op" id="5209553">=</span>&nbsp;<span class="ident" id="5209555"><a href="/archive/tar/reader.go.html#5209451">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209559">case</span>&nbsp;<span class="ident" id="5209564"><a href="/archive/tar/common.go.html#5200433">paxGname</a></span><span class="op" id="5209572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209577"><a href="/archive/tar/reader.go.html#5209395">hdr</a></span><span class="op" id="5209580">.</span><span class="ident" id="5209581">Gname</span>&nbsp;<span class="op" id="5209587">=</span>&nbsp;<span class="ident" id="5209589"><a href="/archive/tar/reader.go.html#5209451">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209593">case</span>&nbsp;<span class="ident" id="5209598"><a href="/archive/tar/common.go.html#5200570">paxUname</a></span><span class="op" id="5209606">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209611"><a href="/archive/tar/reader.go.html#5209395">hdr</a></span><span class="op" id="5209614">.</span><span class="ident" id="5209615">Uname</span>&nbsp;<span class="op" id="5209621">=</span>&nbsp;<span class="ident" id="5209623"><a href="/archive/tar/reader.go.html#5209451">v</a></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209627">case</span>&nbsp;<span class="ident" id="5209632"><a href="/archive/tar/common.go.html#5200549">paxUid</a></span><span class="op" id="5209638">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209643">uid</span><span class="op" id="5209646">,</span>&nbsp;<span class="ident" id="5209648">err</span>&nbsp;<span class="op" id="5209652">:=</span>&nbsp;<span class="ident" id="5209655"><a href="/archive/tar/reader.go.html#5203396">strconv</a></span><span class="op" id="5209662">.</span><span class="ident" id="5209663">ParseInt</span><span class="op" id="5209671">(</span><span class="ident" id="5209672"><a href="/archive/tar/reader.go.html#5209451">v</a></span><span class="op" id="5209673">,</span>&nbsp;<span class="num" id="5209675">10</span><span class="op" id="5209677">,</span>&nbsp;<span class="num" id="5209679">0</span><span class="op" id="5209680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209685">if</span>&nbsp;<span class="ident" id="5209688"><a href="/archive/tar/reader.go.html#5209648">err</a></span>&nbsp;<span class="op" id="5209692">!=</span>&nbsp;<span class="ident" id="5209695">nil</span>&nbsp;<span class="op" id="5209699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209705">return</span>&nbsp;<span class="ident" id="5209712"><a href="/archive/tar/reader.go.html#5209648">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5209719">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209724"><a href="/archive/tar/reader.go.html#5209395">hdr</a></span><span class="op" id="5209727">.</span><span class="ident" id="5209728">Uid</span>&nbsp;<span class="op" id="5209732">=</span>&nbsp;<span class="builtintype" id="5209734">int</span><span class="op" id="5209737">(</span><span class="ident" id="5209738"><a href="/archive/tar/reader.go.html#5209643">uid</a></span><span class="op" id="5209741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209745">case</span>&nbsp;<span class="ident" id="5209750"><a href="/archive/tar/common.go.html#5200412">paxGid</a></span><span class="op" id="5209756">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209761">gid</span><span class="op" id="5209764">,</span>&nbsp;<span class="ident" id="5209766">err</span>&nbsp;<span class="op" id="5209770">:=</span>&nbsp;<span class="ident" id="5209773"><a href="/archive/tar/reader.go.html#5203396">strconv</a></span><span class="op" id="5209780">.</span><span class="ident" id="5209781">ParseInt</span><span class="op" id="5209789">(</span><span class="ident" id="5209790"><a href="/archive/tar/reader.go.html#5209451">v</a></span><span class="op" id="5209791">,</span>&nbsp;<span class="num" id="5209793">10</span><span class="op" id="5209795">,</span>&nbsp;<span class="num" id="5209797">0</span><span class="op" id="5209798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209803">if</span>&nbsp;<span class="ident" id="5209806"><a href="/archive/tar/reader.go.html#5209766">err</a></span>&nbsp;<span class="op" id="5209810">!=</span>&nbsp;<span class="ident" id="5209813">nil</span>&nbsp;<span class="op" id="5209817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209823">return</span>&nbsp;<span class="ident" id="5209830"><a href="/archive/tar/reader.go.html#5209766">err</a></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5209837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209842"><a href="/archive/tar/reader.go.html#5209395">hdr</a></span><span class="op" id="5209845">.</span><span class="ident" id="5209846">Gid</span>&nbsp;<span class="op" id="5209850">=</span>&nbsp;<span class="builtintype" id="5209852">int</span><span class="op" id="5209855">(</span><span class="ident" id="5209856"><a href="/archive/tar/reader.go.html#5209761">gid</a></span><span class="op" id="5209859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209863">case</span>&nbsp;<span class="ident" id="5209868"><a href="/archive/tar/common.go.html#5200263">paxAtime</a></span><span class="op" id="5209876">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209881">t</span><span class="op" id="5209882">,</span>&nbsp;<span class="ident" id="5209884">err</span>&nbsp;<span class="op" id="5209888">:=</span>&nbsp;<span class="ident" id="5209891"><a href="/archive/tar/reader.go.html#5210589">parsePAXTime</a></span><span class="op" id="5209903">(</span><span class="ident" id="5209904"><a href="/archive/tar/reader.go.html#5209451">v</a></span><span class="op" id="5209905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209910">if</span>&nbsp;<span class="ident" id="5209913"><a href="/archive/tar/reader.go.html#5209884">err</a></span>&nbsp;<span class="op" id="5209917">!=</span>&nbsp;<span class="ident" id="5209920">nil</span>&nbsp;<span class="op" id="5209924">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209930">return</span>&nbsp;<span class="ident" id="5209937"><a href="/archive/tar/reader.go.html#5209884">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5209944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209949"><a href="/archive/tar/reader.go.html#5209395">hdr</a></span><span class="op" id="5209952">.</span><span class="ident" id="5209953">AccessTime</span>&nbsp;<span class="op" id="5209964">=</span>&nbsp;<span class="ident" id="5209966"><a href="/archive/tar/reader.go.html#5209881">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5209970">case</span>&nbsp;<span class="ident" id="5209975"><a href="/archive/tar/common.go.html#5200482">paxMtime</a></span><span class="op" id="5209983">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5209988">t</span><span class="op" id="5209989">,</span>&nbsp;<span class="ident" id="5209991">err</span>&nbsp;<span class="op" id="5209995">:=</span>&nbsp;<span class="ident" id="5209998"><a href="/archive/tar/reader.go.html#5210589">parsePAXTime</a></span><span class="op" id="5210010">(</span><span class="ident" id="5210011"><a href="/archive/tar/reader.go.html#5209451">v</a></span><span class="op" id="5210012">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210017">if</span>&nbsp;<span class="ident" id="5210020"><a href="/archive/tar/reader.go.html#5209991">err</a></span>&nbsp;<span class="op" id="5210024">!=</span>&nbsp;<span class="ident" id="5210027">nil</span>&nbsp;<span class="op" id="5210031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210037">return</span>&nbsp;<span class="ident" id="5210044"><a href="/archive/tar/reader.go.html#5209991">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210056"><a href="/archive/tar/reader.go.html#5209395">hdr</a></span><span class="op" id="5210059">.</span><span class="ident" id="5210060">ModTime</span>&nbsp;<span class="op" id="5210068">=</span>&nbsp;<span class="ident" id="5210070"><a href="/archive/tar/reader.go.html#5209988">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210074">case</span>&nbsp;<span class="ident" id="5210079"><a href="/archive/tar/common.go.html#5200336">paxCtime</a></span><span class="op" id="5210087">:</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210092">t</span><span class="op" id="5210093">,</span>&nbsp;<span class="ident" id="5210095">err</span>&nbsp;<span class="op" id="5210099">:=</span>&nbsp;<span class="ident" id="5210102"><a href="/archive/tar/reader.go.html#5210589">parsePAXTime</a></span><span class="op" id="5210114">(</span><span class="ident" id="5210115"><a href="/archive/tar/reader.go.html#5209451">v</a></span><span class="op" id="5210116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210121">if</span>&nbsp;<span class="ident" id="5210124"><a href="/archive/tar/reader.go.html#5210095">err</a></span>&nbsp;<span class="op" id="5210128">!=</span>&nbsp;<span class="ident" id="5210131">nil</span>&nbsp;<span class="op" id="5210135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210141">return</span>&nbsp;<span class="ident" id="5210148"><a href="/archive/tar/reader.go.html#5210095">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210160"><a href="/archive/tar/reader.go.html#5209395">hdr</a></span><span class="op" id="5210163">.</span><span class="ident" id="5210164">ChangeTime</span>&nbsp;<span class="op" id="5210175">=</span>&nbsp;<span class="ident" id="5210177"><a href="/archive/tar/reader.go.html#5210092">t</a></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210181">case</span>&nbsp;<span class="ident" id="5210186"><a href="/archive/tar/common.go.html#5200527">paxSize</a></span><span class="op" id="5210193">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210198">size</span><span class="op" id="5210202">,</span>&nbsp;<span class="ident" id="5210204">err</span>&nbsp;<span class="op" id="5210208">:=</span>&nbsp;<span class="ident" id="5210211"><a href="/archive/tar/reader.go.html#5203396">strconv</a></span><span class="op" id="5210218">.</span><span class="ident" id="5210219">ParseInt</span><span class="op" id="5210227">(</span><span class="ident" id="5210228"><a href="/archive/tar/reader.go.html#5209451">v</a></span><span class="op" id="5210229">,</span>&nbsp;<span class="num" id="5210231">10</span><span class="op" id="5210233">,</span>&nbsp;<span class="num" id="5210235">0</span><span class="op" id="5210236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210241">if</span>&nbsp;<span class="ident" id="5210244"><a href="/archive/tar/reader.go.html#5210204">err</a></span>&nbsp;<span class="op" id="5210248">!=</span>&nbsp;<span class="ident" id="5210251">nil</span>&nbsp;<span class="op" id="5210255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210261">return</span>&nbsp;<span class="ident" id="5210268"><a href="/archive/tar/reader.go.html#5210204">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210275">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210280"><a href="/archive/tar/reader.go.html#5209395">hdr</a></span><span class="op" id="5210283">.</span><span class="ident" id="5210284">Size</span>&nbsp;<span class="op" id="5210289">=</span>&nbsp;<span class="ident" id="5210291">int64</span><span class="op" id="5210296">(</span><span class="ident" id="5210297"><a href="/archive/tar/reader.go.html#5210198">size</a></span><span class="op" id="5210301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210305">default</span><span class="op" id="5210312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210317">if</span>&nbsp;<span class="ident" id="5210320"><a href="/archive/tar/reader.go.html#5203407">strings</a></span><span class="op" id="5210327">.</span><span class="ident" id="5210328">HasPrefix</span><span class="op" id="5210337">(</span><span class="ident" id="5210338"><a href="/archive/tar/reader.go.html#5209448">k</a></span><span class="op" id="5210339">,</span>&nbsp;<span class="ident" id="5210341"><a href="/archive/tar/common.go.html#5200593">paxXattr</a></span><span class="op" id="5210349">)</span>&nbsp;<span class="op" id="5210351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210357">if</span>&nbsp;<span class="ident" id="5210360"><a href="/archive/tar/reader.go.html#5209395">hdr</a></span><span class="op" id="5210363">.</span><span class="ident" id="5210364">Xattrs</span>&nbsp;<span class="op" id="5210371">==</span>&nbsp;<span class="ident" id="5210374">nil</span>&nbsp;<span class="op" id="5210378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210385"><a href="/archive/tar/reader.go.html#5209395">hdr</a></span><span class="op" id="5210388">.</span><span class="ident" id="5210389">Xattrs</span>&nbsp;<span class="op" id="5210396">=</span>&nbsp;<span class="builtinfunc" id="5210398">make</span><span class="op" id="5210402">(</span><span class="keyword" id="5210403">map</span><span class="op" id="5210406">[</span><span class="builtintype" id="5210407">string</span><span class="op" id="5210413">]</span><span class="builtintype" id="5210414">string</span><span class="op" id="5210420">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210432"><a href="/archive/tar/reader.go.html#5209395">hdr</a></span><span class="op" id="5210435">.</span><span class="ident" id="5210436">Xattrs</span><span class="op" id="5210442">[</span><span class="ident" id="5210443"><a href="/archive/tar/reader.go.html#5209448">k</a></span><span class="op" id="5210444">[</span><span class="builtinfunc" id="5210445">len</span><span class="op" id="5210448">(</span><span class="ident" id="5210449"><a href="/archive/tar/common.go.html#5200593">paxXattr</a></span><span class="op" id="5210457">)</span><span class="op" id="5210458">:</span><span class="op" id="5210459">]</span><span class="op" id="5210460">]</span>&nbsp;<span class="op" id="5210462">=</span>&nbsp;<span class="ident" id="5210464"><a href="/archive/tar/reader.go.html#5209451">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210476">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210479">return</span>&nbsp;<span class="ident" id="5210486">nil</span><br>
<span class="lineno"></span><span class="op" id="5210490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5210493">//&nbsp;parsePAXTime&nbsp;takes&nbsp;a&nbsp;string&nbsp;of&nbsp;the&nbsp;form&nbsp;%d.%d&nbsp;as&nbsp;described&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5210558">//&nbsp;the&nbsp;PAX&nbsp;specification.</span><br>
<span class="lineno">275</span><span class="keyword" id="5210584">func</span>&nbsp;<span class="ident" id="5210589">parsePAXTime</span><span class="op" id="5210601">(</span><span class="ident" id="5210602">t</span>&nbsp;<span class="builtintype" id="5210604">string</span><span class="op" id="5210610">)</span>&nbsp;<span class="op" id="5210612">(</span><span class="ident" id="5210613"><a href="/archive/tar/reader.go.html#5203418">time</a></span><span class="op" id="5210617">.</span><span class="ident" id="5210618">Time</span><span class="op" id="5210622">,</span>&nbsp;<span class="builtintype" id="5210624">error</span><span class="op" id="5210629">)</span>&nbsp;<span class="op" id="5210631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210634">buf</span>&nbsp;<span class="op" id="5210638">:=</span>&nbsp;<span class="op" id="5210641">[</span><span class="op" id="5210642">]</span><span class="builtintype" id="5210643">byte</span><span class="op" id="5210647">(</span><span class="ident" id="5210648"><a href="/archive/tar/reader.go.html#5210602">t</a></span><span class="op" id="5210649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210652">pos</span>&nbsp;<span class="op" id="5210656">:=</span>&nbsp;<span class="ident" id="5210659"><a href="/archive/tar/reader.go.html#5203352">bytes</a></span><span class="op" id="5210664">.</span><span class="ident" id="5210665">IndexByte</span><span class="op" id="5210674">(</span><span class="ident" id="5210675"><a href="/archive/tar/reader.go.html#5210634">buf</a></span><span class="op" id="5210678">,</span>&nbsp;<span class="string" id="5210680">&#39;.&#39;</span><span class="op" id="5210683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210686">var</span>&nbsp;<span class="ident" id="5210690">seconds</span><span class="op" id="5210697">,</span>&nbsp;<span class="ident" id="5210699">nanoseconds</span>&nbsp;<span class="ident" id="5210711">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210718">var</span>&nbsp;<span class="ident" id="5210722">err</span>&nbsp;<span class="builtintype" id="5210726">error</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210733">if</span>&nbsp;<span class="ident" id="5210736"><a href="/archive/tar/reader.go.html#5210652">pos</a></span>&nbsp;<span class="op" id="5210740">==</span>&nbsp;<span class="op" id="5210743">-</span><span class="num" id="5210744">1</span>&nbsp;<span class="op" id="5210746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210750"><a href="/archive/tar/reader.go.html#5210690">seconds</a></span><span class="op" id="5210757">,</span>&nbsp;<span class="ident" id="5210759"><a href="/archive/tar/reader.go.html#5210722">err</a></span>&nbsp;<span class="op" id="5210763">=</span>&nbsp;<span class="ident" id="5210765"><a href="/archive/tar/reader.go.html#5203396">strconv</a></span><span class="op" id="5210772">.</span><span class="ident" id="5210773">ParseInt</span><span class="op" id="5210781">(</span><span class="ident" id="5210782"><a href="/archive/tar/reader.go.html#5210602">t</a></span><span class="op" id="5210783">,</span>&nbsp;<span class="num" id="5210785">10</span><span class="op" id="5210787">,</span>&nbsp;<span class="num" id="5210789">0</span><span class="op" id="5210790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210794">if</span>&nbsp;<span class="ident" id="5210797"><a href="/archive/tar/reader.go.html#5210722">err</a></span>&nbsp;<span class="op" id="5210801">!=</span>&nbsp;<span class="ident" id="5210804">nil</span>&nbsp;<span class="op" id="5210808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210813">return</span>&nbsp;<span class="ident" id="5210820"><a href="/archive/tar/reader.go.html#5203418">time</a></span><span class="op" id="5210824">.</span><span class="ident" id="5210825">Time</span><span class="op" id="5210829">{</span><span class="op" id="5210830">}</span><span class="op" id="5210831">,</span>&nbsp;<span class="ident" id="5210833"><a href="/archive/tar/reader.go.html#5210722">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210839">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210842">}</span>&nbsp;<span class="keyword" id="5210844">else</span>&nbsp;<span class="op" id="5210849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210853"><a href="/archive/tar/reader.go.html#5210690">seconds</a></span><span class="op" id="5210860">,</span>&nbsp;<span class="ident" id="5210862"><a href="/archive/tar/reader.go.html#5210722">err</a></span>&nbsp;<span class="op" id="5210866">=</span>&nbsp;<span class="ident" id="5210868"><a href="/archive/tar/reader.go.html#5203396">strconv</a></span><span class="op" id="5210875">.</span><span class="ident" id="5210876">ParseInt</span><span class="op" id="5210884">(</span><span class="builtintype" id="5210885">string</span><span class="op" id="5210891">(</span><span class="ident" id="5210892"><a href="/archive/tar/reader.go.html#5210634">buf</a></span><span class="op" id="5210895">[</span><span class="op" id="5210896">:</span><span class="ident" id="5210897"><a href="/archive/tar/reader.go.html#5210652">pos</a></span><span class="op" id="5210900">]</span><span class="op" id="5210901">)</span><span class="op" id="5210902">,</span>&nbsp;<span class="num" id="5210904">10</span><span class="op" id="5210906">,</span>&nbsp;<span class="num" id="5210908">0</span><span class="op" id="5210909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210913">if</span>&nbsp;<span class="ident" id="5210916"><a href="/archive/tar/reader.go.html#5210722">err</a></span>&nbsp;<span class="op" id="5210920">!=</span>&nbsp;<span class="ident" id="5210923">nil</span>&nbsp;<span class="op" id="5210927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5210932">return</span>&nbsp;<span class="ident" id="5210939"><a href="/archive/tar/reader.go.html#5203418">time</a></span><span class="op" id="5210943">.</span><span class="ident" id="5210944">Time</span><span class="op" id="5210948">{</span><span class="op" id="5210949">}</span><span class="op" id="5210950">,</span>&nbsp;<span class="ident" id="5210952"><a href="/archive/tar/reader.go.html#5210722">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5210958">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5210962">nano_buf</span>&nbsp;<span class="op" id="5210971">:=</span>&nbsp;<span class="builtintype" id="5210974">string</span><span class="op" id="5210980">(</span><span class="ident" id="5210981"><a href="/archive/tar/reader.go.html#5210634">buf</a></span><span class="op" id="5210984">[</span><span class="ident" id="5210985"><a href="/archive/tar/reader.go.html#5210652">pos</a></span><span class="op" id="5210988">+</span><span class="num" id="5210989">1</span><span class="op" id="5210990">:</span><span class="op" id="5210991">]</span><span class="op" id="5210992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5210996">//&nbsp;Pad&nbsp;as&nbsp;needed&nbsp;before&nbsp;converting&nbsp;to&nbsp;a&nbsp;decimal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211047">//&nbsp;For&nbsp;example&nbsp;.030&nbsp;-&gt;&nbsp;.030000000&nbsp;-&gt;&nbsp;30000000&nbsp;nanoseconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211107">if</span>&nbsp;<span class="builtinfunc" id="5211110">len</span><span class="op" id="5211113">(</span><span class="ident" id="5211114"><a href="/archive/tar/reader.go.html#5210962">nano_buf</a></span><span class="op" id="5211122">)</span>&nbsp;<span class="op" id="5211124">&lt;</span>&nbsp;<span class="ident" id="5211126"><a href="/archive/tar/reader.go.html#5203502">maxNanoSecondIntSize</a></span>&nbsp;<span class="op" id="5211147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211152">//&nbsp;Right&nbsp;pad</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211168"><a href="/archive/tar/reader.go.html#5210962">nano_buf</a></span>&nbsp;<span class="op" id="5211177">+=</span>&nbsp;<span class="ident" id="5211180"><a href="/archive/tar/reader.go.html#5203407">strings</a></span><span class="op" id="5211187">.</span><span class="ident" id="5211188">Repeat</span><span class="op" id="5211194">(</span><span class="string" id="5211195">&#34;0&#34;</span><span class="op" id="5211198">,</span>&nbsp;<span class="ident" id="5211200"><a href="/archive/tar/reader.go.html#5203502">maxNanoSecondIntSize</a></span><span class="op" id="5211220">-</span><span class="builtinfunc" id="5211221">len</span><span class="op" id="5211224">(</span><span class="ident" id="5211225"><a href="/archive/tar/reader.go.html#5210962">nano_buf</a></span><span class="op" id="5211233">)</span><span class="op" id="5211234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5211238">}</span>&nbsp;<span class="keyword" id="5211240">else</span>&nbsp;<span class="keyword" id="5211245">if</span>&nbsp;<span class="builtinfunc" id="5211248">len</span><span class="op" id="5211251">(</span><span class="ident" id="5211252"><a href="/archive/tar/reader.go.html#5210962">nano_buf</a></span><span class="op" id="5211260">)</span>&nbsp;<span class="op" id="5211262">&gt;</span>&nbsp;<span class="ident" id="5211264"><a href="/archive/tar/reader.go.html#5203502">maxNanoSecondIntSize</a></span>&nbsp;<span class="op" id="5211285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211290">//&nbsp;Right&nbsp;truncate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211311"><a href="/archive/tar/reader.go.html#5210962">nano_buf</a></span>&nbsp;<span class="op" id="5211320">=</span>&nbsp;<span class="ident" id="5211322"><a href="/archive/tar/reader.go.html#5210962">nano_buf</a></span><span class="op" id="5211330">[</span><span class="op" id="5211331">:</span><span class="ident" id="5211332"><a href="/archive/tar/reader.go.html#5203502">maxNanoSecondIntSize</a></span><span class="op" id="5211352">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5211356">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211360"><a href="/archive/tar/reader.go.html#5210699">nanoseconds</a></span><span class="op" id="5211371">,</span>&nbsp;<span class="ident" id="5211373"><a href="/archive/tar/reader.go.html#5210722">err</a></span>&nbsp;<span class="op" id="5211377">=</span>&nbsp;<span class="ident" id="5211379"><a href="/archive/tar/reader.go.html#5203396">strconv</a></span><span class="op" id="5211386">.</span><span class="ident" id="5211387">ParseInt</span><span class="op" id="5211395">(</span><span class="builtintype" id="5211396">string</span><span class="op" id="5211402">(</span><span class="ident" id="5211403"><a href="/archive/tar/reader.go.html#5210962">nano_buf</a></span><span class="op" id="5211411">)</span><span class="op" id="5211412">,</span>&nbsp;<span class="num" id="5211414">10</span><span class="op" id="5211416">,</span>&nbsp;<span class="num" id="5211418">0</span><span class="op" id="5211419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211423">if</span>&nbsp;<span class="ident" id="5211426"><a href="/archive/tar/reader.go.html#5210722">err</a></span>&nbsp;<span class="op" id="5211430">!=</span>&nbsp;<span class="ident" id="5211433">nil</span>&nbsp;<span class="op" id="5211437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211442">return</span>&nbsp;<span class="ident" id="5211449"><a href="/archive/tar/reader.go.html#5203418">time</a></span><span class="op" id="5211453">.</span><span class="ident" id="5211454">Time</span><span class="op" id="5211458">{</span><span class="op" id="5211459">}</span><span class="op" id="5211460">,</span>&nbsp;<span class="ident" id="5211462"><a href="/archive/tar/reader.go.html#5210722">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5211468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5211471">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211474">ts</span>&nbsp;<span class="op" id="5211477">:=</span>&nbsp;<span class="ident" id="5211480"><a href="/archive/tar/reader.go.html#5203418">time</a></span><span class="op" id="5211484">.</span><span class="ident" id="5211485">Unix</span><span class="op" id="5211489">(</span><span class="ident" id="5211490"><a href="/archive/tar/reader.go.html#5210690">seconds</a></span><span class="op" id="5211497">,</span>&nbsp;<span class="ident" id="5211499"><a href="/archive/tar/reader.go.html#5210699">nanoseconds</a></span><span class="op" id="5211510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211513">return</span>&nbsp;<span class="ident" id="5211520"><a href="/archive/tar/reader.go.html#5211474">ts</a></span><span class="op" id="5211522">,</span>&nbsp;<span class="ident" id="5211524">nil</span><br>
<span class="lineno"></span><span class="op" id="5211528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5211531">//&nbsp;parsePAX&nbsp;parses&nbsp;PAX&nbsp;headers.</span><br>
<span class="lineno">310</span><span class="comment" id="5211563">//&nbsp;If&nbsp;an&nbsp;extended&nbsp;header&nbsp;(type&nbsp;&#39;x&#39;)&nbsp;is&nbsp;invalid,&nbsp;ErrHeader&nbsp;is&nbsp;returned</span><br>
<span class="lineno"></span><span class="keyword" id="5211633">func</span>&nbsp;<span class="ident" id="5211638">parsePAX</span><span class="op" id="5211646">(</span><span class="ident" id="5211647">r</span>&nbsp;<span class="ident" id="5211649"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5211651">.</span><span class="ident" id="5211652">Reader</span><span class="op" id="5211658">)</span>&nbsp;<span class="op" id="5211660">(</span><span class="keyword" id="5211661">map</span><span class="op" id="5211664">[</span><span class="builtintype" id="5211665">string</span><span class="op" id="5211671">]</span><span class="builtintype" id="5211672">string</span><span class="op" id="5211678">,</span>&nbsp;<span class="builtintype" id="5211680">error</span><span class="op" id="5211685">)</span>&nbsp;<span class="op" id="5211687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211690">buf</span><span class="op" id="5211693">,</span>&nbsp;<span class="ident" id="5211695">err</span>&nbsp;<span class="op" id="5211699">:=</span>&nbsp;<span class="ident" id="5211702"><a href="/archive/tar/reader.go.html#5203377">ioutil</a></span><span class="op" id="5211708">.</span><span class="ident" id="5211709">ReadAll</span><span class="op" id="5211716">(</span><span class="ident" id="5211717"><a href="/archive/tar/reader.go.html#5211647">r</a></span><span class="op" id="5211718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211721">if</span>&nbsp;<span class="ident" id="5211724"><a href="/archive/tar/reader.go.html#5211695">err</a></span>&nbsp;<span class="op" id="5211728">!=</span>&nbsp;<span class="ident" id="5211731">nil</span>&nbsp;<span class="op" id="5211735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211739">return</span>&nbsp;<span class="ident" id="5211746">nil</span><span class="op" id="5211749">,</span>&nbsp;<span class="ident" id="5211751"><a href="/archive/tar/reader.go.html#5211695">err</a></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5211756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211760">//&nbsp;For&nbsp;GNU&nbsp;PAX&nbsp;sparse&nbsp;format&nbsp;0.0&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211803">//&nbsp;This&nbsp;function&nbsp;transforms&nbsp;the&nbsp;sparse&nbsp;format&nbsp;0.0&nbsp;headers&nbsp;into&nbsp;sparse&nbsp;format&nbsp;0.1&nbsp;headers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5211894">var</span>&nbsp;<span class="ident" id="5211898">sparseMap</span>&nbsp;<span class="ident" id="5211908"><a href="/archive/tar/reader.go.html#5203352">bytes</a></span><span class="op" id="5211913">.</span><span class="ident" id="5211914">Buffer</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5211923">headers</span>&nbsp;<span class="op" id="5211931">:=</span>&nbsp;<span class="builtinfunc" id="5211934">make</span><span class="op" id="5211938">(</span><span class="keyword" id="5211939">map</span><span class="op" id="5211942">[</span><span class="builtintype" id="5211943">string</span><span class="op" id="5211949">]</span><span class="builtintype" id="5211950">string</span><span class="op" id="5211956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211959">//&nbsp;Each&nbsp;record&nbsp;is&nbsp;constructed&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5211993">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;%d&nbsp;%s=%s\n&#34;,&nbsp;length,&nbsp;keyword,&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212038">for</span>&nbsp;<span class="builtinfunc" id="5212042">len</span><span class="op" id="5212045">(</span><span class="ident" id="5212046"><a href="/archive/tar/reader.go.html#5211690">buf</a></span><span class="op" id="5212049">)</span>&nbsp;<span class="op" id="5212051">&gt;</span>&nbsp;<span class="num" id="5212053">0</span>&nbsp;<span class="op" id="5212055">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212059">//&nbsp;or&nbsp;the&nbsp;header&nbsp;was&nbsp;empty&nbsp;to&nbsp;start&nbsp;with.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212103">var</span>&nbsp;<span class="ident" id="5212107">sp</span>&nbsp;<span class="builtintype" id="5212110">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212116">//&nbsp;The&nbsp;size&nbsp;field&nbsp;ends&nbsp;at&nbsp;the&nbsp;first&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212161"><a href="/archive/tar/reader.go.html#5212107">sp</a></span>&nbsp;<span class="op" id="5212164">=</span>&nbsp;<span class="ident" id="5212166"><a href="/archive/tar/reader.go.html#5203352">bytes</a></span><span class="op" id="5212171">.</span><span class="ident" id="5212172">IndexByte</span><span class="op" id="5212181">(</span><span class="ident" id="5212182"><a href="/archive/tar/reader.go.html#5211690">buf</a></span><span class="op" id="5212185">,</span>&nbsp;<span class="string" id="5212187">&#39;&nbsp;&#39;</span><span class="op" id="5212190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212194">if</span>&nbsp;<span class="ident" id="5212197"><a href="/archive/tar/reader.go.html#5212107">sp</a></span>&nbsp;<span class="op" id="5212200">==</span>&nbsp;<span class="op" id="5212203">-</span><span class="num" id="5212204">1</span>&nbsp;<span class="op" id="5212206">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212211">return</span>&nbsp;<span class="ident" id="5212218">nil</span><span class="op" id="5212221">,</span>&nbsp;<span class="ident" id="5212223"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5212235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212239">//&nbsp;Parse&nbsp;the&nbsp;first&nbsp;token&nbsp;as&nbsp;a&nbsp;decimal&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212288">n</span><span class="op" id="5212289">,</span>&nbsp;<span class="ident" id="5212291">err</span>&nbsp;<span class="op" id="5212295">:=</span>&nbsp;<span class="ident" id="5212298"><a href="/archive/tar/reader.go.html#5203396">strconv</a></span><span class="op" id="5212305">.</span><span class="ident" id="5212306">ParseInt</span><span class="op" id="5212314">(</span><span class="builtintype" id="5212315">string</span><span class="op" id="5212321">(</span><span class="ident" id="5212322"><a href="/archive/tar/reader.go.html#5211690">buf</a></span><span class="op" id="5212325">[</span><span class="op" id="5212326">:</span><span class="ident" id="5212327"><a href="/archive/tar/reader.go.html#5212107">sp</a></span><span class="op" id="5212329">]</span><span class="op" id="5212330">)</span><span class="op" id="5212331">,</span>&nbsp;<span class="num" id="5212333">10</span><span class="op" id="5212335">,</span>&nbsp;<span class="num" id="5212337">0</span><span class="op" id="5212338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212342">if</span>&nbsp;<span class="ident" id="5212345"><a href="/archive/tar/reader.go.html#5212291">err</a></span>&nbsp;<span class="op" id="5212349">!=</span>&nbsp;<span class="ident" id="5212352">nil</span>&nbsp;<span class="op" id="5212356">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212361">return</span>&nbsp;<span class="ident" id="5212368">nil</span><span class="op" id="5212371">,</span>&nbsp;<span class="ident" id="5212373"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5212385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212389">//&nbsp;Extract&nbsp;everything&nbsp;between&nbsp;the&nbsp;decimal&nbsp;and&nbsp;the&nbsp;n&nbsp;-1&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212453">//&nbsp;beginning&nbsp;to&nbsp;eat&nbsp;the&nbsp;&#39;&nbsp;&#39;,&nbsp;-1&nbsp;on&nbsp;the&nbsp;end&nbsp;to&nbsp;skip&nbsp;the&nbsp;newline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212519">var</span>&nbsp;<span class="ident" id="5212523">record</span>&nbsp;<span class="op" id="5212530">[</span><span class="op" id="5212531">]</span><span class="builtintype" id="5212532">byte</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212539"><a href="/archive/tar/reader.go.html#5212523">record</a></span><span class="op" id="5212545">,</span>&nbsp;<span class="ident" id="5212547"><a href="/archive/tar/reader.go.html#5211690">buf</a></span>&nbsp;<span class="op" id="5212551">=</span>&nbsp;<span class="ident" id="5212553"><a href="/archive/tar/reader.go.html#5211690">buf</a></span><span class="op" id="5212556">[</span><span class="ident" id="5212557"><a href="/archive/tar/reader.go.html#5212107">sp</a></span><span class="op" id="5212559">+</span><span class="num" id="5212560">1</span><span class="op" id="5212561">:</span><span class="ident" id="5212562"><a href="/archive/tar/reader.go.html#5212288">n</a></span><span class="op" id="5212563">-</span><span class="num" id="5212564">1</span><span class="op" id="5212565">]</span><span class="op" id="5212566">,</span>&nbsp;<span class="ident" id="5212568"><a href="/archive/tar/reader.go.html#5211690">buf</a></span><span class="op" id="5212571">[</span><span class="ident" id="5212572"><a href="/archive/tar/reader.go.html#5212288">n</a></span><span class="op" id="5212573">:</span><span class="op" id="5212574">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212578">//&nbsp;The&nbsp;first&nbsp;equals&nbsp;is&nbsp;guaranteed&nbsp;to&nbsp;mark&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212642">//&nbsp;Everything&nbsp;else&nbsp;is&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212673">eq</span>&nbsp;<span class="op" id="5212676">:=</span>&nbsp;<span class="ident" id="5212679"><a href="/archive/tar/reader.go.html#5203352">bytes</a></span><span class="op" id="5212684">.</span><span class="ident" id="5212685">IndexByte</span><span class="op" id="5212694">(</span><span class="ident" id="5212695"><a href="/archive/tar/reader.go.html#5212523">record</a></span><span class="op" id="5212701">,</span>&nbsp;<span class="string" id="5212703">&#39;=&#39;</span><span class="op" id="5212706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212710">if</span>&nbsp;<span class="ident" id="5212713"><a href="/archive/tar/reader.go.html#5212673">eq</a></span>&nbsp;<span class="op" id="5212716">==</span>&nbsp;<span class="op" id="5212719">-</span><span class="num" id="5212720">1</span>&nbsp;<span class="op" id="5212722">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212727">return</span>&nbsp;<span class="ident" id="5212734">nil</span><span class="op" id="5212737">,</span>&nbsp;<span class="ident" id="5212739"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5212751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212755">key</span><span class="op" id="5212758">,</span>&nbsp;<span class="ident" id="5212760">value</span>&nbsp;<span class="op" id="5212766">:=</span>&nbsp;<span class="ident" id="5212769"><a href="/archive/tar/reader.go.html#5212523">record</a></span><span class="op" id="5212775">[</span><span class="op" id="5212776">:</span><span class="ident" id="5212777"><a href="/archive/tar/reader.go.html#5212673">eq</a></span><span class="op" id="5212779">]</span><span class="op" id="5212780">,</span>&nbsp;<span class="ident" id="5212782"><a href="/archive/tar/reader.go.html#5212523">record</a></span><span class="op" id="5212788">[</span><span class="ident" id="5212789"><a href="/archive/tar/reader.go.html#5212673">eq</a></span><span class="op" id="5212791">+</span><span class="num" id="5212792">1</span><span class="op" id="5212793">:</span><span class="op" id="5212794">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212799">keyStr</span>&nbsp;<span class="op" id="5212806">:=</span>&nbsp;<span class="builtintype" id="5212809">string</span><span class="op" id="5212815">(</span><span class="ident" id="5212816"><a href="/archive/tar/reader.go.html#5212755">key</a></span><span class="op" id="5212819">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5212823">if</span>&nbsp;<span class="ident" id="5212826"><a href="/archive/tar/reader.go.html#5212799">keyStr</a></span>&nbsp;<span class="op" id="5212833">==</span>&nbsp;<span class="ident" id="5212836"><a href="/archive/tar/reader.go.html#5204916">paxGNUSparseOffset</a></span>&nbsp;<span class="op" id="5212855">||</span>&nbsp;<span class="ident" id="5212858"><a href="/archive/tar/reader.go.html#5212799">keyStr</a></span>&nbsp;<span class="op" id="5212865">==</span>&nbsp;<span class="ident" id="5212868"><a href="/archive/tar/reader.go.html#5204961">paxGNUSparseNumBytes</a></span>&nbsp;<span class="op" id="5212889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5212894">//&nbsp;GNU&nbsp;sparse&nbsp;format&nbsp;0.0&nbsp;special&nbsp;key.&nbsp;Write&nbsp;to&nbsp;sparseMap&nbsp;instead&nbsp;of&nbsp;using&nbsp;the&nbsp;headers&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5212988"><a href="/archive/tar/reader.go.html#5211898">sparseMap</a></span><span class="op" id="5212997">.</span><span class="ident" id="5212998">Write</span><span class="op" id="5213003">(</span><span class="ident" id="5213004"><a href="/archive/tar/reader.go.html#5212760">value</a></span><span class="op" id="5213009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213014"><a href="/archive/tar/reader.go.html#5211898">sparseMap</a></span><span class="op" id="5213023">.</span><span class="ident" id="5213024">Write</span><span class="op" id="5213029">(</span><span class="op" id="5213030">[</span><span class="op" id="5213031">]</span><span class="builtintype" id="5213032">byte</span><span class="op" id="5213036">{</span><span class="string" id="5213037">&#39;,&#39;</span><span class="op" id="5213040">}</span><span class="op" id="5213041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213045">}</span>&nbsp;<span class="keyword" id="5213047">else</span>&nbsp;<span class="op" id="5213052">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5213057">//&nbsp;Normal&nbsp;key.&nbsp;Set&nbsp;the&nbsp;value&nbsp;in&nbsp;the&nbsp;headers&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213109"><a href="/archive/tar/reader.go.html#5211923">headers</a></span><span class="op" id="5213116">[</span><span class="ident" id="5213117"><a href="/archive/tar/reader.go.html#5212799">keyStr</a></span><span class="op" id="5213123">]</span>&nbsp;<span class="op" id="5213125">=</span>&nbsp;<span class="builtintype" id="5213127">string</span><span class="op" id="5213133">(</span><span class="ident" id="5213134"><a href="/archive/tar/reader.go.html#5212760">value</a></span><span class="op" id="5213139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213149">if</span>&nbsp;<span class="ident" id="5213152"><a href="/archive/tar/reader.go.html#5211898">sparseMap</a></span><span class="op" id="5213161">.</span><span class="ident" id="5213162">Len</span><span class="op" id="5213165">(</span><span class="op" id="5213166">)</span>&nbsp;<span class="op" id="5213168">!=</span>&nbsp;<span class="num" id="5213171">0</span>&nbsp;<span class="op" id="5213173">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5213177">//&nbsp;Add&nbsp;sparse&nbsp;info&nbsp;to&nbsp;headers,&nbsp;chopping&nbsp;off&nbsp;the&nbsp;extra&nbsp;comma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213239"><a href="/archive/tar/reader.go.html#5211898">sparseMap</a></span><span class="op" id="5213248">.</span><span class="ident" id="5213249">Truncate</span><span class="op" id="5213257">(</span><span class="ident" id="5213258"><a href="/archive/tar/reader.go.html#5211898">sparseMap</a></span><span class="op" id="5213267">.</span><span class="ident" id="5213268">Len</span><span class="op" id="5213271">(</span><span class="op" id="5213272">)</span>&nbsp;<span class="op" id="5213274">-</span>&nbsp;<span class="num" id="5213276">1</span><span class="op" id="5213277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213281"><a href="/archive/tar/reader.go.html#5211923">headers</a></span><span class="op" id="5213288">[</span><span class="ident" id="5213289"><a href="/archive/tar/reader.go.html#5205008">paxGNUSparseMap</a></span><span class="op" id="5213304">]</span>&nbsp;<span class="op" id="5213306">=</span>&nbsp;<span class="ident" id="5213308"><a href="/archive/tar/reader.go.html#5211898">sparseMap</a></span><span class="op" id="5213317">.</span><span class="ident" id="5213318">String</span><span class="op" id="5213324">(</span><span class="op" id="5213325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213331">return</span>&nbsp;<span class="ident" id="5213338"><a href="/archive/tar/reader.go.html#5211923">headers</a></span><span class="op" id="5213345">,</span>&nbsp;<span class="ident" id="5213347">nil</span><br>
<span class="lineno">365</span><span class="op" id="5213351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5213354">//&nbsp;cString&nbsp;parses&nbsp;bytes&nbsp;as&nbsp;a&nbsp;NUL-terminated&nbsp;C-style&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="5213414">//&nbsp;If&nbsp;a&nbsp;NUL&nbsp;byte&nbsp;is&nbsp;not&nbsp;found&nbsp;then&nbsp;the&nbsp;whole&nbsp;slice&nbsp;is&nbsp;returned&nbsp;as&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5213490">func</span>&nbsp;<span class="ident" id="5213495">cString</span><span class="op" id="5213502">(</span><span class="ident" id="5213503">b</span>&nbsp;<span class="op" id="5213505">[</span><span class="op" id="5213506">]</span><span class="builtintype" id="5213507">byte</span><span class="op" id="5213511">)</span>&nbsp;<span class="builtintype" id="5213513">string</span>&nbsp;<span class="op" id="5213520">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213523">n</span>&nbsp;<span class="op" id="5213525">:=</span>&nbsp;<span class="num" id="5213528">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213531">for</span>&nbsp;<span class="ident" id="5213535"><a href="/archive/tar/reader.go.html#5213523">n</a></span>&nbsp;<span class="op" id="5213537">&lt;</span>&nbsp;<span class="builtinfunc" id="5213539">len</span><span class="op" id="5213542">(</span><span class="ident" id="5213543"><a href="/archive/tar/reader.go.html#5213503">b</a></span><span class="op" id="5213544">)</span>&nbsp;<span class="op" id="5213546">&amp;&amp;</span>&nbsp;<span class="ident" id="5213549"><a href="/archive/tar/reader.go.html#5213503">b</a></span><span class="op" id="5213550">[</span><span class="ident" id="5213551"><a href="/archive/tar/reader.go.html#5213523">n</a></span><span class="op" id="5213552">]</span>&nbsp;<span class="op" id="5213554">!=</span>&nbsp;<span class="num" id="5213557">0</span>&nbsp;<span class="op" id="5213559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213563"><a href="/archive/tar/reader.go.html#5213523">n</a></span><span class="op" id="5213564">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213571">return</span>&nbsp;<span class="builtintype" id="5213578">string</span><span class="op" id="5213584">(</span><span class="ident" id="5213585"><a href="/archive/tar/reader.go.html#5213503">b</a></span><span class="op" id="5213586">[</span><span class="num" id="5213587">0</span><span class="op" id="5213588">:</span><span class="ident" id="5213589"><a href="/archive/tar/reader.go.html#5213523">n</a></span><span class="op" id="5213590">]</span><span class="op" id="5213591">)</span><br>
<span class="lineno">375</span><span class="op" id="5213593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5213596">func</span>&nbsp;<span class="op" id="5213601">(</span><span class="ident" id="5213602">tr</span>&nbsp;<span class="op" id="5213605">*</span><span class="ident" id="5213606"><a href="/archive/tar/reader.go.html#5203812">Reader</a></span><span class="op" id="5213612">)</span>&nbsp;<span class="ident" id="5213614">octal</span><span class="op" id="5213619">(</span><span class="ident" id="5213620">b</span>&nbsp;<span class="op" id="5213622">[</span><span class="op" id="5213623">]</span><span class="builtintype" id="5213624">byte</span><span class="op" id="5213628">)</span>&nbsp;<span class="ident" id="5213630">int64</span>&nbsp;<span class="op" id="5213636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5213639">//&nbsp;Check&nbsp;for&nbsp;binary&nbsp;format&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213674">if</span>&nbsp;<span class="builtinfunc" id="5213677">len</span><span class="op" id="5213680">(</span><span class="ident" id="5213681"><a href="/archive/tar/reader.go.html#5213620">b</a></span><span class="op" id="5213682">)</span>&nbsp;<span class="op" id="5213684">&gt;</span>&nbsp;<span class="num" id="5213686">0</span>&nbsp;<span class="op" id="5213688">&amp;&amp;</span>&nbsp;<span class="ident" id="5213691"><a href="/archive/tar/reader.go.html#5213620">b</a></span><span class="op" id="5213692">[</span><span class="num" id="5213693">0</span><span class="op" id="5213694">]</span><span class="op" id="5213695">&amp;</span><span class="num" id="5213696">0x80</span>&nbsp;<span class="op" id="5213701">!=</span>&nbsp;<span class="num" id="5213704">0</span>&nbsp;<span class="op" id="5213706">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213710">var</span>&nbsp;<span class="ident" id="5213714">x</span>&nbsp;<span class="ident" id="5213716">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213724">for</span>&nbsp;<span class="ident" id="5213728">i</span><span class="op" id="5213729">,</span>&nbsp;<span class="ident" id="5213731">c</span>&nbsp;<span class="op" id="5213733">:=</span>&nbsp;<span class="keyword" id="5213736">range</span>&nbsp;<span class="ident" id="5213742"><a href="/archive/tar/reader.go.html#5213620">b</a></span>&nbsp;<span class="op" id="5213744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213749">if</span>&nbsp;<span class="ident" id="5213752"><a href="/archive/tar/reader.go.html#5213728">i</a></span>&nbsp;<span class="op" id="5213754">==</span>&nbsp;<span class="num" id="5213757">0</span>&nbsp;<span class="op" id="5213759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213765"><a href="/archive/tar/reader.go.html#5213731">c</a></span>&nbsp;<span class="op" id="5213767">&amp;=</span>&nbsp;<span class="num" id="5213770">0x7f</span>&nbsp;<span class="comment" id="5213775">//&nbsp;ignore&nbsp;signal&nbsp;bit&nbsp;in&nbsp;first&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213813">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5213818"><a href="/archive/tar/reader.go.html#5213714">x</a></span>&nbsp;<span class="op" id="5213820">=</span>&nbsp;<span class="ident" id="5213822"><a href="/archive/tar/reader.go.html#5213714">x</a></span><span class="op" id="5213823">&lt;&lt;</span><span class="num" id="5213825">8</span>&nbsp;<span class="op" id="5213827">|</span>&nbsp;<span class="ident" id="5213829">int64</span><span class="op" id="5213834">(</span><span class="ident" id="5213835"><a href="/archive/tar/reader.go.html#5213731">c</a></span><span class="op" id="5213836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5213844">return</span>&nbsp;<span class="ident" id="5213851"><a href="/archive/tar/reader.go.html#5213714">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5213854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5213858">//&nbsp;Because&nbsp;unused&nbsp;fields&nbsp;are&nbsp;filled&nbsp;with&nbsp;NULs,&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5213914">//&nbsp;to&nbsp;skip&nbsp;leading&nbsp;NULs.&nbsp;Fields&nbsp;may&nbsp;also&nbsp;be&nbsp;padded&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5213971">//&nbsp;spaces&nbsp;or&nbsp;NULs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5213991">//&nbsp;So&nbsp;we&nbsp;remove&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;NULs&nbsp;and&nbsp;spaces&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5214048">//&nbsp;be&nbsp;sure.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214061"><a href="/archive/tar/reader.go.html#5213620">b</a></span>&nbsp;<span class="op" id="5214063">=</span>&nbsp;<span class="ident" id="5214065"><a href="/archive/tar/reader.go.html#5203352">bytes</a></span><span class="op" id="5214070">.</span><span class="ident" id="5214071">Trim</span><span class="op" id="5214075">(</span><span class="ident" id="5214076"><a href="/archive/tar/reader.go.html#5213620">b</a></span><span class="op" id="5214077">,</span>&nbsp;<span class="string" id="5214079">&#34;&nbsp;\x00&#34;</span><span class="op" id="5214086">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214090">if</span>&nbsp;<span class="builtinfunc" id="5214093">len</span><span class="op" id="5214096">(</span><span class="ident" id="5214097"><a href="/archive/tar/reader.go.html#5213620">b</a></span><span class="op" id="5214098">)</span>&nbsp;<span class="op" id="5214100">==</span>&nbsp;<span class="num" id="5214103">0</span>&nbsp;<span class="op" id="5214105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214109">return</span>&nbsp;<span class="num" id="5214116">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214119">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214122">x</span><span class="op" id="5214123">,</span>&nbsp;<span class="ident" id="5214125">err</span>&nbsp;<span class="op" id="5214129">:=</span>&nbsp;<span class="ident" id="5214132"><a href="/archive/tar/reader.go.html#5203396">strconv</a></span><span class="op" id="5214139">.</span><span class="ident" id="5214140">ParseUint</span><span class="op" id="5214149">(</span><span class="ident" id="5214150"><a href="/archive/tar/reader.go.html#5213495">cString</a></span><span class="op" id="5214157">(</span><span class="ident" id="5214158"><a href="/archive/tar/reader.go.html#5213620">b</a></span><span class="op" id="5214159">)</span><span class="op" id="5214160">,</span>&nbsp;<span class="num" id="5214162">8</span><span class="op" id="5214163">,</span>&nbsp;<span class="num" id="5214165">64</span><span class="op" id="5214167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214170">if</span>&nbsp;<span class="ident" id="5214173"><a href="/archive/tar/reader.go.html#5214125">err</a></span>&nbsp;<span class="op" id="5214177">!=</span>&nbsp;<span class="ident" id="5214180">nil</span>&nbsp;<span class="op" id="5214184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214188"><a href="/archive/tar/reader.go.html#5213602">tr</a></span><span class="op" id="5214190">.</span><span class="ident" id="5214191">err</span>&nbsp;<span class="op" id="5214195">=</span>&nbsp;<span class="ident" id="5214197"><a href="/archive/tar/reader.go.html#5214125">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214205">return</span>&nbsp;<span class="ident" id="5214212">int64</span><span class="op" id="5214217">(</span><span class="ident" id="5214218"><a href="/archive/tar/reader.go.html#5214122">x</a></span><span class="op" id="5214219">)</span><br>
<span class="lineno">405</span><span class="op" id="5214221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5214224">//&nbsp;skipUnread&nbsp;skips&nbsp;any&nbsp;unread&nbsp;bytes&nbsp;in&nbsp;the&nbsp;existing&nbsp;file&nbsp;entry,&nbsp;as&nbsp;well&nbsp;as&nbsp;any&nbsp;alignment&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="5214323">func</span>&nbsp;<span class="op" id="5214328">(</span><span class="ident" id="5214329">tr</span>&nbsp;<span class="op" id="5214332">*</span><span class="ident" id="5214333"><a href="/archive/tar/reader.go.html#5203812">Reader</a></span><span class="op" id="5214339">)</span>&nbsp;<span class="ident" id="5214341">skipUnread</span><span class="op" id="5214351">(</span><span class="op" id="5214352">)</span>&nbsp;<span class="op" id="5214354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214357">nr</span>&nbsp;<span class="op" id="5214360">:=</span>&nbsp;<span class="ident" id="5214363"><a href="/archive/tar/reader.go.html#5214329">tr</a></span><span class="op" id="5214365">.</span><span class="ident" id="5214366">numBytes</span><span class="op" id="5214374">(</span><span class="op" id="5214375">)</span>&nbsp;<span class="op" id="5214377">+</span>&nbsp;<span class="ident" id="5214379"><a href="/archive/tar/reader.go.html#5214329">tr</a></span><span class="op" id="5214381">.</span><span class="ident" id="5214382">pad</span>&nbsp;<span class="comment" id="5214386">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;skip</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214414"><a href="/archive/tar/reader.go.html#5214329">tr</a></span><span class="op" id="5214416">.</span><span class="ident" id="5214417">curr</span><span class="op" id="5214421">,</span>&nbsp;<span class="ident" id="5214423"><a href="/archive/tar/reader.go.html#5214329">tr</a></span><span class="op" id="5214425">.</span><span class="ident" id="5214426">pad</span>&nbsp;<span class="op" id="5214430">=</span>&nbsp;<span class="ident" id="5214432">nil</span><span class="op" id="5214435">,</span>&nbsp;<span class="num" id="5214437">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214440">if</span>&nbsp;<span class="ident" id="5214443">sr</span><span class="op" id="5214445">,</span>&nbsp;<span class="ident" id="5214447">ok</span>&nbsp;<span class="op" id="5214450">:=</span>&nbsp;<span class="ident" id="5214453"><a href="/archive/tar/reader.go.html#5214329">tr</a></span><span class="op" id="5214455">.</span><span class="ident" id="5214456">r</span><span class="op" id="5214457">.</span><span class="op" id="5214458">(</span><span class="ident" id="5214459"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5214461">.</span><span class="ident" id="5214462">Seeker</span><span class="op" id="5214468">)</span><span class="op" id="5214469">;</span>&nbsp;<span class="ident" id="5214471"><a href="/archive/tar/reader.go.html#5214447">ok</a></span>&nbsp;<span class="op" id="5214474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214478">if</span>&nbsp;<span class="ident" id="5214481">_</span><span class="op" id="5214482">,</span>&nbsp;<span class="ident" id="5214484">err</span>&nbsp;<span class="op" id="5214488">:=</span>&nbsp;<span class="ident" id="5214491"><a href="/archive/tar/reader.go.html#5214443">sr</a></span><span class="op" id="5214493">.</span><span class="ident" id="5214494">Seek</span><span class="op" id="5214498">(</span><span class="ident" id="5214499"><a href="/archive/tar/reader.go.html#5214357">nr</a></span><span class="op" id="5214501">,</span>&nbsp;<span class="ident" id="5214503"><a href="/archive/tar/reader.go.html#5203390">os</a></span><span class="op" id="5214505">.</span><span class="ident" id="5214506">SEEK_CUR</span><span class="op" id="5214514">)</span><span class="op" id="5214515">;</span>&nbsp;<span class="ident" id="5214517"><a href="/archive/tar/reader.go.html#5214484">err</a></span>&nbsp;<span class="op" id="5214521">==</span>&nbsp;<span class="ident" id="5214524">nil</span>&nbsp;<span class="op" id="5214528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214533">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214542">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214548">_</span><span class="op" id="5214549">,</span>&nbsp;<span class="ident" id="5214551"><a href="/archive/tar/reader.go.html#5214329">tr</a></span><span class="op" id="5214553">.</span><span class="ident" id="5214554">err</span>&nbsp;<span class="op" id="5214558">=</span>&nbsp;<span class="ident" id="5214560"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5214562">.</span><span class="ident" id="5214563">CopyN</span><span class="op" id="5214568">(</span><span class="ident" id="5214569"><a href="/archive/tar/reader.go.html#5203377">ioutil</a></span><span class="op" id="5214575">.</span><span class="ident" id="5214576">Discard</span><span class="op" id="5214583">,</span>&nbsp;<span class="ident" id="5214585"><a href="/archive/tar/reader.go.html#5214329">tr</a></span><span class="op" id="5214587">.</span><span class="ident" id="5214588">r</span><span class="op" id="5214589">,</span>&nbsp;<span class="ident" id="5214591"><a href="/archive/tar/reader.go.html#5214357">nr</a></span><span class="op" id="5214593">)</span><br>
<span class="lineno"></span><span class="op" id="5214595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5214598">func</span>&nbsp;<span class="op" id="5214603">(</span><span class="ident" id="5214604">tr</span>&nbsp;<span class="op" id="5214607">*</span><span class="ident" id="5214608"><a href="/archive/tar/reader.go.html#5203812">Reader</a></span><span class="op" id="5214614">)</span>&nbsp;<span class="ident" id="5214616">verifyChecksum</span><span class="op" id="5214630">(</span><span class="ident" id="5214631">header</span>&nbsp;<span class="op" id="5214638">[</span><span class="op" id="5214639">]</span><span class="builtintype" id="5214640">byte</span><span class="op" id="5214644">)</span>&nbsp;<span class="builtintype" id="5214646">bool</span>&nbsp;<span class="op" id="5214651">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214654">if</span>&nbsp;<span class="ident" id="5214657"><a href="/archive/tar/reader.go.html#5214604">tr</a></span><span class="op" id="5214659">.</span><span class="ident" id="5214660">err</span>&nbsp;<span class="op" id="5214664">!=</span>&nbsp;<span class="ident" id="5214667">nil</span>&nbsp;<span class="op" id="5214671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214675">return</span>&nbsp;<span class="ident" id="5214682">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214693">given</span>&nbsp;<span class="op" id="5214699">:=</span>&nbsp;<span class="ident" id="5214702"><a href="/archive/tar/reader.go.html#5214604">tr</a></span><span class="op" id="5214704">.</span><span class="ident" id="5214705">octal</span><span class="op" id="5214710">(</span><span class="ident" id="5214711"><a href="/archive/tar/reader.go.html#5214631">header</a></span><span class="op" id="5214717">[</span><span class="num" id="5214718">148</span><span class="op" id="5214721">:</span><span class="num" id="5214722">156</span><span class="op" id="5214725">]</span><span class="op" id="5214726">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214729">unsigned</span><span class="op" id="5214737">,</span>&nbsp;<span class="ident" id="5214739">signed</span>&nbsp;<span class="op" id="5214746">:=</span>&nbsp;<span class="ident" id="5214749"><a href="/archive/tar/common.go.html#5202380">checksum</a></span><span class="op" id="5214757">(</span><span class="ident" id="5214758"><a href="/archive/tar/reader.go.html#5214631">header</a></span><span class="op" id="5214764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214767">return</span>&nbsp;<span class="ident" id="5214774"><a href="/archive/tar/reader.go.html#5214693">given</a></span>&nbsp;<span class="op" id="5214780">==</span>&nbsp;<span class="ident" id="5214783"><a href="/archive/tar/reader.go.html#5214729">unsigned</a></span>&nbsp;<span class="op" id="5214792">||</span>&nbsp;<span class="ident" id="5214795"><a href="/archive/tar/reader.go.html#5214693">given</a></span>&nbsp;<span class="op" id="5214801">==</span>&nbsp;<span class="ident" id="5214804"><a href="/archive/tar/reader.go.html#5214739">signed</a></span><br>
<span class="lineno"></span><span class="op" id="5214811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5214814">func</span>&nbsp;<span class="op" id="5214819">(</span><span class="ident" id="5214820">tr</span>&nbsp;<span class="op" id="5214823">*</span><span class="ident" id="5214824"><a href="/archive/tar/reader.go.html#5203812">Reader</a></span><span class="op" id="5214830">)</span>&nbsp;<span class="ident" id="5214832">readHeader</span><span class="op" id="5214842">(</span><span class="op" id="5214843">)</span>&nbsp;<span class="op" id="5214845">*</span><span class="ident" id="5214846"><a href="/archive/tar/common.go.html#5196742">Header</a></span>&nbsp;<span class="op" id="5214853">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5214856">header</span>&nbsp;<span class="op" id="5214863">:=</span>&nbsp;<span class="ident" id="5214866"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5214868">.</span><span class="ident" id="5214869">hdrBuff</span><span class="op" id="5214876">[</span><span class="op" id="5214877">:</span><span class="op" id="5214878">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5214881">copy</span><span class="op" id="5214885">(</span><span class="ident" id="5214886"><a href="/archive/tar/reader.go.html#5214856">header</a></span><span class="op" id="5214892">,</span>&nbsp;<span class="ident" id="5214894"><a href="/archive/tar/common.go.html#5202212">zeroBlock</a></span><span class="op" id="5214903">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214907">if</span>&nbsp;<span class="ident" id="5214910">_</span><span class="op" id="5214911">,</span>&nbsp;<span class="ident" id="5214913"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5214915">.</span><span class="ident" id="5214916">err</span>&nbsp;<span class="op" id="5214920">=</span>&nbsp;<span class="ident" id="5214922"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5214924">.</span><span class="ident" id="5214925">ReadFull</span><span class="op" id="5214933">(</span><span class="ident" id="5214934"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5214936">.</span><span class="ident" id="5214937">r</span><span class="op" id="5214938">,</span>&nbsp;<span class="ident" id="5214940"><a href="/archive/tar/reader.go.html#5214856">header</a></span><span class="op" id="5214946">)</span><span class="op" id="5214947">;</span>&nbsp;<span class="ident" id="5214949"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5214951">.</span><span class="ident" id="5214952">err</span>&nbsp;<span class="op" id="5214956">!=</span>&nbsp;<span class="ident" id="5214959">nil</span>&nbsp;<span class="op" id="5214963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5214967">return</span>&nbsp;<span class="ident" id="5214974">nil</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5214979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5214983">//&nbsp;Two&nbsp;blocks&nbsp;of&nbsp;zero&nbsp;bytes&nbsp;marks&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;archive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215042">if</span>&nbsp;<span class="ident" id="5215045"><a href="/archive/tar/reader.go.html#5203352">bytes</a></span><span class="op" id="5215050">.</span><span class="ident" id="5215051">Equal</span><span class="op" id="5215056">(</span><span class="ident" id="5215057"><a href="/archive/tar/reader.go.html#5214856">header</a></span><span class="op" id="5215063">,</span>&nbsp;<span class="ident" id="5215065"><a href="/archive/tar/common.go.html#5202212">zeroBlock</a></span><span class="op" id="5215074">[</span><span class="num" id="5215075">0</span><span class="op" id="5215076">:</span><span class="ident" id="5215077"><a href="/archive/tar/common.go.html#5195939">blockSize</a></span><span class="op" id="5215086">]</span><span class="op" id="5215087">)</span>&nbsp;<span class="op" id="5215089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215093">if</span>&nbsp;<span class="ident" id="5215096">_</span><span class="op" id="5215097">,</span>&nbsp;<span class="ident" id="5215099"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5215101">.</span><span class="ident" id="5215102">err</span>&nbsp;<span class="op" id="5215106">=</span>&nbsp;<span class="ident" id="5215108"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5215110">.</span><span class="ident" id="5215111">ReadFull</span><span class="op" id="5215119">(</span><span class="ident" id="5215120"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5215122">.</span><span class="ident" id="5215123">r</span><span class="op" id="5215124">,</span>&nbsp;<span class="ident" id="5215126"><a href="/archive/tar/reader.go.html#5214856">header</a></span><span class="op" id="5215132">)</span><span class="op" id="5215133">;</span>&nbsp;<span class="ident" id="5215135"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5215137">.</span><span class="ident" id="5215138">err</span>&nbsp;<span class="op" id="5215142">!=</span>&nbsp;<span class="ident" id="5215145">nil</span>&nbsp;<span class="op" id="5215149">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215154">return</span>&nbsp;<span class="ident" id="5215161">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215171">if</span>&nbsp;<span class="ident" id="5215174"><a href="/archive/tar/reader.go.html#5203352">bytes</a></span><span class="op" id="5215179">.</span><span class="ident" id="5215180">Equal</span><span class="op" id="5215185">(</span><span class="ident" id="5215186"><a href="/archive/tar/reader.go.html#5214856">header</a></span><span class="op" id="5215192">,</span>&nbsp;<span class="ident" id="5215194"><a href="/archive/tar/common.go.html#5202212">zeroBlock</a></span><span class="op" id="5215203">[</span><span class="num" id="5215204">0</span><span class="op" id="5215205">:</span><span class="ident" id="5215206"><a href="/archive/tar/common.go.html#5195939">blockSize</a></span><span class="op" id="5215215">]</span><span class="op" id="5215216">)</span>&nbsp;<span class="op" id="5215218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215223"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5215225">.</span><span class="ident" id="5215226">err</span>&nbsp;<span class="op" id="5215230">=</span>&nbsp;<span class="ident" id="5215232"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5215234">.</span><span class="ident" id="5215235">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215241">}</span>&nbsp;<span class="keyword" id="5215243">else</span>&nbsp;<span class="op" id="5215248">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215253"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5215255">.</span><span class="ident" id="5215256">err</span>&nbsp;<span class="op" id="5215260">=</span>&nbsp;<span class="ident" id="5215262"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span>&nbsp;<span class="comment" id="5215272">//&nbsp;zero&nbsp;block&nbsp;and&nbsp;then&nbsp;non-zero&nbsp;block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215316">return</span>&nbsp;<span class="ident" id="5215323">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215332">if</span>&nbsp;<span class="op" id="5215335">!</span><span class="ident" id="5215336"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5215338">.</span><span class="ident" id="5215339">verifyChecksum</span><span class="op" id="5215353">(</span><span class="ident" id="5215354"><a href="/archive/tar/reader.go.html#5214856">header</a></span><span class="op" id="5215360">)</span>&nbsp;<span class="op" id="5215362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215366"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5215368">.</span><span class="ident" id="5215369">err</span>&nbsp;<span class="op" id="5215373">=</span>&nbsp;<span class="ident" id="5215375"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5215387">return</span>&nbsp;<span class="ident" id="5215394">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5215399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5215403">//&nbsp;Unpack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215414">hdr</span>&nbsp;<span class="op" id="5215418">:=</span>&nbsp;<span class="builtinfunc" id="5215421">new</span><span class="op" id="5215424">(</span><span class="ident" id="5215425"><a href="/archive/tar/common.go.html#5196742">Header</a></span><span class="op" id="5215431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215434">s</span>&nbsp;<span class="op" id="5215436">:=</span>&nbsp;<span class="ident" id="5215439"><a href="/archive/tar/common.go.html#5202734">slicer</a></span><span class="op" id="5215445">(</span><span class="ident" id="5215446"><a href="/archive/tar/reader.go.html#5214856">header</a></span><span class="op" id="5215452">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215456"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5215459">.</span><span class="ident" id="5215460">Name</span>&nbsp;<span class="op" id="5215465">=</span>&nbsp;<span class="ident" id="5215467"><a href="/archive/tar/reader.go.html#5213495">cString</a></span><span class="op" id="5215474">(</span><span class="ident" id="5215475"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5215476">.</span><span class="ident" id="5215477">next</span><span class="op" id="5215481">(</span><span class="num" id="5215482">100</span><span class="op" id="5215485">)</span><span class="op" id="5215486">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215489"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5215492">.</span><span class="ident" id="5215493">Mode</span>&nbsp;<span class="op" id="5215498">=</span>&nbsp;<span class="ident" id="5215500"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5215502">.</span><span class="ident" id="5215503">octal</span><span class="op" id="5215508">(</span><span class="ident" id="5215509"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5215510">.</span><span class="ident" id="5215511">next</span><span class="op" id="5215515">(</span><span class="num" id="5215516">8</span><span class="op" id="5215517">)</span><span class="op" id="5215518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215521"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5215524">.</span><span class="ident" id="5215525">Uid</span>&nbsp;<span class="op" id="5215529">=</span>&nbsp;<span class="builtintype" id="5215531">int</span><span class="op" id="5215534">(</span><span class="ident" id="5215535"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5215537">.</span><span class="ident" id="5215538">octal</span><span class="op" id="5215543">(</span><span class="ident" id="5215544"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5215545">.</span><span class="ident" id="5215546">next</span><span class="op" id="5215550">(</span><span class="num" id="5215551">8</span><span class="op" id="5215552">)</span><span class="op" id="5215553">)</span><span class="op" id="5215554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215557"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5215560">.</span><span class="ident" id="5215561">Gid</span>&nbsp;<span class="op" id="5215565">=</span>&nbsp;<span class="builtintype" id="5215567">int</span><span class="op" id="5215570">(</span><span class="ident" id="5215571"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5215573">.</span><span class="ident" id="5215574">octal</span><span class="op" id="5215579">(</span><span class="ident" id="5215580"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5215581">.</span><span class="ident" id="5215582">next</span><span class="op" id="5215586">(</span><span class="num" id="5215587">8</span><span class="op" id="5215588">)</span><span class="op" id="5215589">)</span><span class="op" id="5215590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215593"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5215596">.</span><span class="ident" id="5215597">Size</span>&nbsp;<span class="op" id="5215602">=</span>&nbsp;<span class="ident" id="5215604"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5215606">.</span><span class="ident" id="5215607">octal</span><span class="op" id="5215612">(</span><span class="ident" id="5215613"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5215614">.</span><span class="ident" id="5215615">next</span><span class="op" id="5215619">(</span><span class="num" id="5215620">12</span><span class="op" id="5215622">)</span><span class="op" id="5215623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215626"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5215629">.</span><span class="ident" id="5215630">ModTime</span>&nbsp;<span class="op" id="5215638">=</span>&nbsp;<span class="ident" id="5215640"><a href="/archive/tar/reader.go.html#5203418">time</a></span><span class="op" id="5215644">.</span><span class="ident" id="5215645">Unix</span><span class="op" id="5215649">(</span><span class="ident" id="5215650"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5215652">.</span><span class="ident" id="5215653">octal</span><span class="op" id="5215658">(</span><span class="ident" id="5215659"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5215660">.</span><span class="ident" id="5215661">next</span><span class="op" id="5215665">(</span><span class="num" id="5215666">12</span><span class="op" id="5215668">)</span><span class="op" id="5215669">)</span><span class="op" id="5215670">,</span>&nbsp;<span class="num" id="5215672">0</span><span class="op" id="5215673">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215676"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5215677">.</span><span class="ident" id="5215678">next</span><span class="op" id="5215682">(</span><span class="num" id="5215683">8</span><span class="op" id="5215684">)</span>&nbsp;<span class="comment" id="5215686">//&nbsp;chksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215697"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5215700">.</span><span class="ident" id="5215701">Typeflag</span>&nbsp;<span class="op" id="5215710">=</span>&nbsp;<span class="ident" id="5215712"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5215713">.</span><span class="ident" id="5215714">next</span><span class="op" id="5215718">(</span><span class="num" id="5215719">1</span><span class="op" id="5215720">)</span><span class="op" id="5215721">[</span><span class="num" id="5215722">0</span><span class="op" id="5215723">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215726"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5215729">.</span><span class="ident" id="5215730">Linkname</span>&nbsp;<span class="op" id="5215739">=</span>&nbsp;<span class="ident" id="5215741"><a href="/archive/tar/reader.go.html#5213495">cString</a></span><span class="op" id="5215748">(</span><span class="ident" id="5215749"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5215750">.</span><span class="ident" id="5215751">next</span><span class="op" id="5215755">(</span><span class="num" id="5215756">100</span><span class="op" id="5215759">)</span><span class="op" id="5215760">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5215764">//&nbsp;The&nbsp;remainder&nbsp;of&nbsp;the&nbsp;header&nbsp;depends&nbsp;on&nbsp;the&nbsp;value&nbsp;of&nbsp;magic.</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5215827">//&nbsp;The&nbsp;original&nbsp;(v7)&nbsp;version&nbsp;of&nbsp;tar&nbsp;had&nbsp;no&nbsp;explicit&nbsp;magic&nbsp;field,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5215893">//&nbsp;so&nbsp;its&nbsp;magic&nbsp;bytes,&nbsp;like&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;block,&nbsp;are&nbsp;NULs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5215955">magic</span>&nbsp;<span class="op" id="5215961">:=</span>&nbsp;<span class="builtintype" id="5215964">string</span><span class="op" id="5215970">(</span><span class="ident" id="5215971"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5215972">.</span><span class="ident" id="5215973">next</span><span class="op" id="5215977">(</span><span class="num" id="5215978">8</span><span class="op" id="5215979">)</span><span class="op" id="5215980">)</span>&nbsp;<span class="comment" id="5215982">//&nbsp;contains&nbsp;version&nbsp;field&nbsp;as&nbsp;well.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216018">var</span>&nbsp;<span class="ident" id="5216022">format</span>&nbsp;<span class="builtintype" id="5216029">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216037">switch</span>&nbsp;<span class="op" id="5216044">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216047">case</span>&nbsp;<span class="ident" id="5216052"><a href="/archive/tar/reader.go.html#5215955">magic</a></span><span class="op" id="5216057">[</span><span class="op" id="5216058">:</span><span class="num" id="5216059">6</span><span class="op" id="5216060">]</span>&nbsp;<span class="op" id="5216062">==</span>&nbsp;<span class="string" id="5216065">&#34;ustar\x00&#34;</span><span class="op" id="5216076">:</span>&nbsp;<span class="comment" id="5216078">//&nbsp;POSIX&nbsp;tar&nbsp;(1003.1-1988)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216107">if</span>&nbsp;<span class="builtintype" id="5216110">string</span><span class="op" id="5216116">(</span><span class="ident" id="5216117"><a href="/archive/tar/reader.go.html#5214856">header</a></span><span class="op" id="5216123">[</span><span class="num" id="5216124">508</span><span class="op" id="5216127">:</span><span class="num" id="5216128">512</span><span class="op" id="5216131">]</span><span class="op" id="5216132">)</span>&nbsp;<span class="op" id="5216134">==</span>&nbsp;<span class="string" id="5216137">&#34;tar\x00&#34;</span>&nbsp;<span class="op" id="5216147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216152"><a href="/archive/tar/reader.go.html#5216022">format</a></span>&nbsp;<span class="op" id="5216159">=</span>&nbsp;<span class="string" id="5216161">&#34;star&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216170">}</span>&nbsp;<span class="keyword" id="5216172">else</span>&nbsp;<span class="op" id="5216177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216182"><a href="/archive/tar/reader.go.html#5216022">format</a></span>&nbsp;<span class="op" id="5216189">=</span>&nbsp;<span class="string" id="5216191">&#34;posix&#34;</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216204">case</span>&nbsp;<span class="ident" id="5216209"><a href="/archive/tar/reader.go.html#5215955">magic</a></span>&nbsp;<span class="op" id="5216215">==</span>&nbsp;<span class="string" id="5216218">&#34;ustar&nbsp;&nbsp;\x00&#34;</span><span class="op" id="5216231">:</span>&nbsp;<span class="comment" id="5216233">//&nbsp;old&nbsp;GNU&nbsp;tar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216250"><a href="/archive/tar/reader.go.html#5216022">format</a></span>&nbsp;<span class="op" id="5216257">=</span>&nbsp;<span class="string" id="5216259">&#34;gnu&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216270">switch</span>&nbsp;<span class="ident" id="5216277"><a href="/archive/tar/reader.go.html#5216022">format</a></span>&nbsp;<span class="op" id="5216284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216287">case</span>&nbsp;<span class="string" id="5216292">&#34;posix&#34;</span><span class="op" id="5216299">,</span>&nbsp;<span class="string" id="5216301">&#34;gnu&#34;</span><span class="op" id="5216306">,</span>&nbsp;<span class="string" id="5216308">&#34;star&#34;</span><span class="op" id="5216314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216318"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5216321">.</span><span class="ident" id="5216322">Uname</span>&nbsp;<span class="op" id="5216328">=</span>&nbsp;<span class="ident" id="5216330"><a href="/archive/tar/reader.go.html#5213495">cString</a></span><span class="op" id="5216337">(</span><span class="ident" id="5216338"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5216339">.</span><span class="ident" id="5216340">next</span><span class="op" id="5216344">(</span><span class="num" id="5216345">32</span><span class="op" id="5216347">)</span><span class="op" id="5216348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216352"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5216355">.</span><span class="ident" id="5216356">Gname</span>&nbsp;<span class="op" id="5216362">=</span>&nbsp;<span class="ident" id="5216364"><a href="/archive/tar/reader.go.html#5213495">cString</a></span><span class="op" id="5216371">(</span><span class="ident" id="5216372"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5216373">.</span><span class="ident" id="5216374">next</span><span class="op" id="5216378">(</span><span class="num" id="5216379">32</span><span class="op" id="5216381">)</span><span class="op" id="5216382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216386">devmajor</span>&nbsp;<span class="op" id="5216395">:=</span>&nbsp;<span class="ident" id="5216398"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5216399">.</span><span class="ident" id="5216400">next</span><span class="op" id="5216404">(</span><span class="num" id="5216405">8</span><span class="op" id="5216406">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216410">devminor</span>&nbsp;<span class="op" id="5216419">:=</span>&nbsp;<span class="ident" id="5216422"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5216423">.</span><span class="ident" id="5216424">next</span><span class="op" id="5216428">(</span><span class="num" id="5216429">8</span><span class="op" id="5216430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216434">if</span>&nbsp;<span class="ident" id="5216437"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5216440">.</span><span class="ident" id="5216441">Typeflag</span>&nbsp;<span class="op" id="5216450">==</span>&nbsp;<span class="ident" id="5216453"><a href="/archive/tar/common.go.html#5196141">TypeChar</a></span>&nbsp;<span class="op" id="5216462">||</span>&nbsp;<span class="ident" id="5216465"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5216468">.</span><span class="ident" id="5216469">Typeflag</span>&nbsp;<span class="op" id="5216478">==</span>&nbsp;<span class="ident" id="5216481"><a href="/archive/tar/common.go.html#5196194">TypeBlock</a></span>&nbsp;<span class="op" id="5216491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216496"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5216499">.</span><span class="ident" id="5216500">Devmajor</span>&nbsp;<span class="op" id="5216509">=</span>&nbsp;<span class="ident" id="5216511"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5216513">.</span><span class="ident" id="5216514">octal</span><span class="op" id="5216519">(</span><span class="ident" id="5216520"><a href="/archive/tar/reader.go.html#5216386">devmajor</a></span><span class="op" id="5216528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216533"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5216536">.</span><span class="ident" id="5216537">Devminor</span>&nbsp;<span class="op" id="5216546">=</span>&nbsp;<span class="ident" id="5216548"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5216550">.</span><span class="ident" id="5216551">octal</span><span class="op" id="5216556">(</span><span class="ident" id="5216557"><a href="/archive/tar/reader.go.html#5216410">devminor</a></span><span class="op" id="5216565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216569">}</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216573">var</span>&nbsp;<span class="ident" id="5216577">prefix</span>&nbsp;<span class="builtintype" id="5216584">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216593">switch</span>&nbsp;<span class="ident" id="5216600"><a href="/archive/tar/reader.go.html#5216022">format</a></span>&nbsp;<span class="op" id="5216607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216611">case</span>&nbsp;<span class="string" id="5216616">&#34;posix&#34;</span><span class="op" id="5216623">,</span>&nbsp;<span class="string" id="5216625">&#34;gnu&#34;</span><span class="op" id="5216630">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216635"><a href="/archive/tar/reader.go.html#5216577">prefix</a></span>&nbsp;<span class="op" id="5216642">=</span>&nbsp;<span class="ident" id="5216644"><a href="/archive/tar/reader.go.html#5213495">cString</a></span><span class="op" id="5216651">(</span><span class="ident" id="5216652"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5216653">.</span><span class="ident" id="5216654">next</span><span class="op" id="5216658">(</span><span class="num" id="5216659">155</span><span class="op" id="5216662">)</span><span class="op" id="5216663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216667">case</span>&nbsp;<span class="string" id="5216672">&#34;star&#34;</span><span class="op" id="5216678">:</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216683"><a href="/archive/tar/reader.go.html#5216577">prefix</a></span>&nbsp;<span class="op" id="5216690">=</span>&nbsp;<span class="ident" id="5216692"><a href="/archive/tar/reader.go.html#5213495">cString</a></span><span class="op" id="5216699">(</span><span class="ident" id="5216700"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5216701">.</span><span class="ident" id="5216702">next</span><span class="op" id="5216706">(</span><span class="num" id="5216707">131</span><span class="op" id="5216710">)</span><span class="op" id="5216711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216716"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5216719">.</span><span class="ident" id="5216720">AccessTime</span>&nbsp;<span class="op" id="5216731">=</span>&nbsp;<span class="ident" id="5216733"><a href="/archive/tar/reader.go.html#5203418">time</a></span><span class="op" id="5216737">.</span><span class="ident" id="5216738">Unix</span><span class="op" id="5216742">(</span><span class="ident" id="5216743"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5216745">.</span><span class="ident" id="5216746">octal</span><span class="op" id="5216751">(</span><span class="ident" id="5216752"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5216753">.</span><span class="ident" id="5216754">next</span><span class="op" id="5216758">(</span><span class="num" id="5216759">12</span><span class="op" id="5216761">)</span><span class="op" id="5216762">)</span><span class="op" id="5216763">,</span>&nbsp;<span class="num" id="5216765">0</span><span class="op" id="5216766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216771"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5216774">.</span><span class="ident" id="5216775">ChangeTime</span>&nbsp;<span class="op" id="5216786">=</span>&nbsp;<span class="ident" id="5216788"><a href="/archive/tar/reader.go.html#5203418">time</a></span><span class="op" id="5216792">.</span><span class="ident" id="5216793">Unix</span><span class="op" id="5216797">(</span><span class="ident" id="5216798"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5216800">.</span><span class="ident" id="5216801">octal</span><span class="op" id="5216806">(</span><span class="ident" id="5216807"><a href="/archive/tar/reader.go.html#5215434">s</a></span><span class="op" id="5216808">.</span><span class="ident" id="5216809">next</span><span class="op" id="5216813">(</span><span class="num" id="5216814">12</span><span class="op" id="5216816">)</span><span class="op" id="5216817">)</span><span class="op" id="5216818">,</span>&nbsp;<span class="num" id="5216820">0</span><span class="op" id="5216821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216829">if</span>&nbsp;<span class="builtinfunc" id="5216832">len</span><span class="op" id="5216835">(</span><span class="ident" id="5216836"><a href="/archive/tar/reader.go.html#5216577">prefix</a></span><span class="op" id="5216842">)</span>&nbsp;<span class="op" id="5216844">&gt;</span>&nbsp;<span class="num" id="5216846">0</span>&nbsp;<span class="op" id="5216848">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216853"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5216856">.</span><span class="ident" id="5216857">Name</span>&nbsp;<span class="op" id="5216862">=</span>&nbsp;<span class="ident" id="5216864"><a href="/archive/tar/reader.go.html#5216577">prefix</a></span>&nbsp;<span class="op" id="5216871">+</span>&nbsp;<span class="string" id="5216873">&#34;/&#34;</span>&nbsp;<span class="op" id="5216877">+</span>&nbsp;<span class="ident" id="5216879"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5216882">.</span><span class="ident" id="5216883">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216897">if</span>&nbsp;<span class="ident" id="5216900"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5216902">.</span><span class="ident" id="5216903">err</span>&nbsp;<span class="op" id="5216907">!=</span>&nbsp;<span class="ident" id="5216910">nil</span>&nbsp;<span class="op" id="5216914">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5216918"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5216920">.</span><span class="ident" id="5216921">err</span>&nbsp;<span class="op" id="5216925">=</span>&nbsp;<span class="ident" id="5216927"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5216939">return</span>&nbsp;<span class="ident" id="5216946">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5216951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5216955">//&nbsp;Maximum&nbsp;value&nbsp;of&nbsp;hdr.Size&nbsp;is&nbsp;64&nbsp;GB&nbsp;(12&nbsp;octal&nbsp;digits),</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5217013">//&nbsp;so&nbsp;there&#39;s&nbsp;no&nbsp;risk&nbsp;of&nbsp;int64&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217058">nb</span>&nbsp;<span class="op" id="5217061">:=</span>&nbsp;<span class="ident" id="5217064">int64</span><span class="op" id="5217069">(</span><span class="ident" id="5217070"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5217073">.</span><span class="ident" id="5217074">Size</span><span class="op" id="5217078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217081"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5217083">.</span><span class="ident" id="5217084">pad</span>&nbsp;<span class="op" id="5217088">=</span>&nbsp;<span class="op" id="5217090">-</span><span class="ident" id="5217091"><a href="/archive/tar/reader.go.html#5217058">nb</a></span>&nbsp;<span class="op" id="5217094">&amp;</span>&nbsp;<span class="op" id="5217096">(</span><span class="ident" id="5217097"><a href="/archive/tar/common.go.html#5195939">blockSize</a></span>&nbsp;<span class="op" id="5217107">-</span>&nbsp;<span class="num" id="5217109">1</span><span class="op" id="5217110">)</span>&nbsp;<span class="comment" id="5217112">//&nbsp;blockSize&nbsp;is&nbsp;a&nbsp;power&nbsp;of&nbsp;two</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5217145">//&nbsp;Set&nbsp;the&nbsp;current&nbsp;file&nbsp;reader.</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217178"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5217180">.</span><span class="ident" id="5217181">curr</span>&nbsp;<span class="op" id="5217186">=</span>&nbsp;<span class="op" id="5217188">&amp;</span><span class="ident" id="5217189"><a href="/archive/tar/reader.go.html#5204345">regFileReader</a></span><span class="op" id="5217202">{</span><span class="ident" id="5217203">r</span><span class="op" id="5217204">:</span>&nbsp;<span class="ident" id="5217206"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5217208">.</span><span class="ident" id="5217209">r</span><span class="op" id="5217210">,</span>&nbsp;<span class="ident" id="5217212">nb</span><span class="op" id="5217214">:</span>&nbsp;<span class="ident" id="5217216"><a href="/archive/tar/reader.go.html#5217058">nb</a></span><span class="op" id="5217218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5217222">//&nbsp;Check&nbsp;for&nbsp;old&nbsp;GNU&nbsp;sparse&nbsp;format&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217265">if</span>&nbsp;<span class="ident" id="5217268"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5217271">.</span><span class="ident" id="5217272">Typeflag</span>&nbsp;<span class="op" id="5217281">==</span>&nbsp;<span class="ident" id="5217284"><a href="/archive/tar/common.go.html#5196598">TypeGNUSparse</a></span>&nbsp;<span class="op" id="5217298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5217302">//&nbsp;Get&nbsp;the&nbsp;real&nbsp;size&nbsp;of&nbsp;the&nbsp;file.</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217338"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5217341">.</span><span class="ident" id="5217342">Size</span>&nbsp;<span class="op" id="5217347">=</span>&nbsp;<span class="ident" id="5217349"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5217351">.</span><span class="ident" id="5217352">octal</span><span class="op" id="5217357">(</span><span class="ident" id="5217358"><a href="/archive/tar/reader.go.html#5214856">header</a></span><span class="op" id="5217364">[</span><span class="num" id="5217365">483</span><span class="op" id="5217368">:</span><span class="num" id="5217369">495</span><span class="op" id="5217372">]</span><span class="op" id="5217373">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5217378">//&nbsp;Read&nbsp;the&nbsp;sparse&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217404">sp</span>&nbsp;<span class="op" id="5217407">:=</span>&nbsp;<span class="ident" id="5217410"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5217412">.</span><span class="ident" id="5217413">readOldGNUSparseMap</span><span class="op" id="5217432">(</span><span class="ident" id="5217433"><a href="/archive/tar/reader.go.html#5214856">header</a></span><span class="op" id="5217439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217443">if</span>&nbsp;<span class="ident" id="5217446"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5217448">.</span><span class="ident" id="5217449">err</span>&nbsp;<span class="op" id="5217453">!=</span>&nbsp;<span class="ident" id="5217456">nil</span>&nbsp;<span class="op" id="5217460">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217465">return</span>&nbsp;<span class="ident" id="5217472">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5217482">//&nbsp;Current&nbsp;file&nbsp;is&nbsp;a&nbsp;GNU&nbsp;sparse&nbsp;file.&nbsp;Update&nbsp;the&nbsp;current&nbsp;file&nbsp;reader.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217554"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5217556">.</span><span class="ident" id="5217557">curr</span>&nbsp;<span class="op" id="5217562">=</span>&nbsp;<span class="op" id="5217564">&amp;</span><span class="ident" id="5217565"><a href="/archive/tar/reader.go.html#5204565">sparseFileReader</a></span><span class="op" id="5217581">{</span><span class="ident" id="5217582">rfr</span><span class="op" id="5217585">:</span>&nbsp;<span class="ident" id="5217587"><a href="/archive/tar/reader.go.html#5214820">tr</a></span><span class="op" id="5217589">.</span><span class="ident" id="5217590">curr</span><span class="op" id="5217594">.</span><span class="op" id="5217595">(</span><span class="op" id="5217596">*</span><span class="ident" id="5217597"><a href="/archive/tar/reader.go.html#5204345">regFileReader</a></span><span class="op" id="5217610">)</span><span class="op" id="5217611">,</span>&nbsp;<span class="ident" id="5217613">sp</span><span class="op" id="5217615">:</span>&nbsp;<span class="ident" id="5217617"><a href="/archive/tar/reader.go.html#5217404">sp</a></span><span class="op" id="5217619">,</span>&nbsp;<span class="ident" id="5217621">tot</span><span class="op" id="5217624">:</span>&nbsp;<span class="ident" id="5217626"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><span class="op" id="5217629">.</span><span class="ident" id="5217630">Size</span><span class="op" id="5217634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5217637">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5217641">return</span>&nbsp;<span class="ident" id="5217648"><a href="/archive/tar/reader.go.html#5215414">hdr</a></span><br>
<span class="lineno"></span><span class="op" id="5217652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5217655">//&nbsp;A&nbsp;sparseEntry&nbsp;holds&nbsp;a&nbsp;single&nbsp;entry&nbsp;in&nbsp;a&nbsp;sparse&nbsp;file&#39;s&nbsp;sparse&nbsp;map.</span><br>
<span class="lineno">540</span><span class="comment" id="5217724">//&nbsp;A&nbsp;sparse&nbsp;entry&nbsp;indicates&nbsp;the&nbsp;offset&nbsp;and&nbsp;size&nbsp;in&nbsp;a&nbsp;sparse&nbsp;file&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5217794">//&nbsp;block&nbsp;of&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="5217812">type</span>&nbsp;<span class="ident" id="5217817">sparseEntry</span>&nbsp;<span class="keyword" id="5217829">struct</span>&nbsp;<span class="op" id="5217836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217839">offset</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5217848">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5217855">numBytes</span>&nbsp;<span class="ident" id="5217864">int64</span><br>
<span class="lineno">545</span><span class="op" id="5217870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5217873">//&nbsp;readOldGNUSparseMap&nbsp;reads&nbsp;the&nbsp;sparse&nbsp;map&nbsp;as&nbsp;stored&nbsp;in&nbsp;the&nbsp;old&nbsp;GNU&nbsp;sparse&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="5217957">//&nbsp;The&nbsp;sparse&nbsp;map&nbsp;is&nbsp;stored&nbsp;in&nbsp;the&nbsp;tar&nbsp;header&nbsp;if&nbsp;it&#39;s&nbsp;small&nbsp;enough.&nbsp;If&nbsp;it&#39;s&nbsp;larger&nbsp;than&nbsp;four&nbsp;entries,</span><br>
<span class="lineno"></span><span class="comment" id="5218059">//&nbsp;then&nbsp;one&nbsp;or&nbsp;more&nbsp;extension&nbsp;headers&nbsp;are&nbsp;used&nbsp;to&nbsp;store&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;sparse&nbsp;map.</span><br>
<span class="lineno">550</span><span class="keyword" id="5218143">func</span>&nbsp;<span class="op" id="5218148">(</span><span class="ident" id="5218149">tr</span>&nbsp;<span class="op" id="5218152">*</span><span class="ident" id="5218153"><a href="/archive/tar/reader.go.html#5203812">Reader</a></span><span class="op" id="5218159">)</span>&nbsp;<span class="ident" id="5218161">readOldGNUSparseMap</span><span class="op" id="5218180">(</span><span class="ident" id="5218181">header</span>&nbsp;<span class="op" id="5218188">[</span><span class="op" id="5218189">]</span><span class="builtintype" id="5218190">byte</span><span class="op" id="5218194">)</span>&nbsp;<span class="op" id="5218196">[</span><span class="op" id="5218197">]</span><span class="ident" id="5218198"><a href="/archive/tar/reader.go.html#5217817">sparseEntry</a></span>&nbsp;<span class="op" id="5218210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5218213">isExtended</span>&nbsp;<span class="op" id="5218224">:=</span>&nbsp;<span class="ident" id="5218227"><a href="/archive/tar/reader.go.html#5218181">header</a></span><span class="op" id="5218233">[</span><span class="ident" id="5218234"><a href="/archive/tar/reader.go.html#5205371">oldGNUSparseMainHeaderIsExtendedOffset</a></span><span class="op" id="5218272">]</span>&nbsp;<span class="op" id="5218274">!=</span>&nbsp;<span class="num" id="5218277">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5218280">spCap</span>&nbsp;<span class="op" id="5218286">:=</span>&nbsp;<span class="ident" id="5218289"><a href="/archive/tar/reader.go.html#5205421">oldGNUSparseMainHeaderNumEntries</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218323">if</span>&nbsp;<span class="ident" id="5218326"><a href="/archive/tar/reader.go.html#5218213">isExtended</a></span>&nbsp;<span class="op" id="5218337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5218341"><a href="/archive/tar/reader.go.html#5218280">spCap</a></span>&nbsp;<span class="op" id="5218347">+=</span>&nbsp;<span class="ident" id="5218350"><a href="/archive/tar/reader.go.html#5205519">oldGNUSparseExtendedHeaderNumEntries</a></span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5218388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5218391">sp</span>&nbsp;<span class="op" id="5218394">:=</span>&nbsp;<span class="builtinfunc" id="5218397">make</span><span class="op" id="5218401">(</span><span class="op" id="5218402">[</span><span class="op" id="5218403">]</span><span class="ident" id="5218404"><a href="/archive/tar/reader.go.html#5217817">sparseEntry</a></span><span class="op" id="5218415">,</span>&nbsp;<span class="num" id="5218417">0</span><span class="op" id="5218418">,</span>&nbsp;<span class="ident" id="5218420"><a href="/archive/tar/reader.go.html#5218280">spCap</a></span><span class="op" id="5218425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5218428">s</span>&nbsp;<span class="op" id="5218430">:=</span>&nbsp;<span class="ident" id="5218433"><a href="/archive/tar/common.go.html#5202734">slicer</a></span><span class="op" id="5218439">(</span><span class="ident" id="5218440"><a href="/archive/tar/reader.go.html#5218181">header</a></span><span class="op" id="5218446">[</span><span class="ident" id="5218447"><a href="/archive/tar/reader.go.html#5205321">oldGNUSparseMainHeaderOffset</a></span><span class="op" id="5218475">:</span><span class="op" id="5218476">]</span><span class="op" id="5218477">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5218481">//&nbsp;Read&nbsp;the&nbsp;four&nbsp;entries&nbsp;from&nbsp;the&nbsp;main&nbsp;tar&nbsp;header</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218532">for</span>&nbsp;<span class="ident" id="5218536">i</span>&nbsp;<span class="op" id="5218538">:=</span>&nbsp;<span class="num" id="5218541">0</span><span class="op" id="5218542">;</span>&nbsp;<span class="ident" id="5218544"><a href="/archive/tar/reader.go.html#5218536">i</a></span>&nbsp;<span class="op" id="5218546">&lt;</span>&nbsp;<span class="ident" id="5218548"><a href="/archive/tar/reader.go.html#5205421">oldGNUSparseMainHeaderNumEntries</a></span><span class="op" id="5218580">;</span>&nbsp;<span class="ident" id="5218582"><a href="/archive/tar/reader.go.html#5218536">i</a></span><span class="op" id="5218583">++</span>&nbsp;<span class="op" id="5218586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5218590">offset</span>&nbsp;<span class="op" id="5218597">:=</span>&nbsp;<span class="ident" id="5218600"><a href="/archive/tar/reader.go.html#5218149">tr</a></span><span class="op" id="5218602">.</span><span class="ident" id="5218603">octal</span><span class="op" id="5218608">(</span><span class="ident" id="5218609"><a href="/archive/tar/reader.go.html#5218428">s</a></span><span class="op" id="5218610">.</span><span class="ident" id="5218611">next</span><span class="op" id="5218615">(</span><span class="ident" id="5218616"><a href="/archive/tar/reader.go.html#5205568">oldGNUSparseOffsetSize</a></span><span class="op" id="5218638">)</span><span class="op" id="5218639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5218643">numBytes</span>&nbsp;<span class="op" id="5218652">:=</span>&nbsp;<span class="ident" id="5218655"><a href="/archive/tar/reader.go.html#5218149">tr</a></span><span class="op" id="5218657">.</span><span class="ident" id="5218658">octal</span><span class="op" id="5218663">(</span><span class="ident" id="5218664"><a href="/archive/tar/reader.go.html#5218428">s</a></span><span class="op" id="5218665">.</span><span class="ident" id="5218666">next</span><span class="op" id="5218670">(</span><span class="ident" id="5218671"><a href="/archive/tar/reader.go.html#5205617">oldGNUSparseNumBytesSize</a></span><span class="op" id="5218695">)</span><span class="op" id="5218696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218700">if</span>&nbsp;<span class="ident" id="5218703"><a href="/archive/tar/reader.go.html#5218149">tr</a></span><span class="op" id="5218705">.</span><span class="ident" id="5218706">err</span>&nbsp;<span class="op" id="5218710">!=</span>&nbsp;<span class="ident" id="5218713">nil</span>&nbsp;<span class="op" id="5218717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5218722"><a href="/archive/tar/reader.go.html#5218149">tr</a></span><span class="op" id="5218724">.</span><span class="ident" id="5218725">err</span>&nbsp;<span class="op" id="5218729">=</span>&nbsp;<span class="ident" id="5218731"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218744">return</span>&nbsp;<span class="ident" id="5218751">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5218757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218761">if</span>&nbsp;<span class="ident" id="5218764"><a href="/archive/tar/reader.go.html#5218590">offset</a></span>&nbsp;<span class="op" id="5218771">==</span>&nbsp;<span class="num" id="5218774">0</span>&nbsp;<span class="op" id="5218776">&amp;&amp;</span>&nbsp;<span class="ident" id="5218779"><a href="/archive/tar/reader.go.html#5218643">numBytes</a></span>&nbsp;<span class="op" id="5218788">==</span>&nbsp;<span class="num" id="5218791">0</span>&nbsp;<span class="op" id="5218793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218798">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5218806">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5218810"><a href="/archive/tar/reader.go.html#5218391">sp</a></span>&nbsp;<span class="op" id="5218813">=</span>&nbsp;<span class="builtinfunc" id="5218815">append</span><span class="op" id="5218821">(</span><span class="ident" id="5218822"><a href="/archive/tar/reader.go.html#5218391">sp</a></span><span class="op" id="5218824">,</span>&nbsp;<span class="ident" id="5218826"><a href="/archive/tar/reader.go.html#5217817">sparseEntry</a></span><span class="op" id="5218837">{</span><span class="ident" id="5218838">offset</span><span class="op" id="5218844">:</span>&nbsp;<span class="ident" id="5218846"><a href="/archive/tar/reader.go.html#5218590">offset</a></span><span class="op" id="5218852">,</span>&nbsp;<span class="ident" id="5218854">numBytes</span><span class="op" id="5218862">:</span>&nbsp;<span class="ident" id="5218864"><a href="/archive/tar/reader.go.html#5218643">numBytes</a></span><span class="op" id="5218872">}</span><span class="op" id="5218873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5218876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5218880">for</span>&nbsp;<span class="ident" id="5218884"><a href="/archive/tar/reader.go.html#5218213">isExtended</a></span>&nbsp;<span class="op" id="5218895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5218899">//&nbsp;There&nbsp;are&nbsp;more&nbsp;entries.&nbsp;Read&nbsp;an&nbsp;extension&nbsp;header&nbsp;and&nbsp;parse&nbsp;its&nbsp;entries.</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5218976">sparseHeader</span>&nbsp;<span class="op" id="5218989">:=</span>&nbsp;<span class="builtinfunc" id="5218992">make</span><span class="op" id="5218996">(</span><span class="op" id="5218997">[</span><span class="op" id="5218998">]</span><span class="builtintype" id="5218999">byte</span><span class="op" id="5219003">,</span>&nbsp;<span class="ident" id="5219005"><a href="/archive/tar/common.go.html#5195939">blockSize</a></span><span class="op" id="5219014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219018">if</span>&nbsp;<span class="ident" id="5219021">_</span><span class="op" id="5219022">,</span>&nbsp;<span class="ident" id="5219024"><a href="/archive/tar/reader.go.html#5218149">tr</a></span><span class="op" id="5219026">.</span><span class="ident" id="5219027">err</span>&nbsp;<span class="op" id="5219031">=</span>&nbsp;<span class="ident" id="5219033"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5219035">.</span><span class="ident" id="5219036">ReadFull</span><span class="op" id="5219044">(</span><span class="ident" id="5219045"><a href="/archive/tar/reader.go.html#5218149">tr</a></span><span class="op" id="5219047">.</span><span class="ident" id="5219048">r</span><span class="op" id="5219049">,</span>&nbsp;<span class="ident" id="5219051"><a href="/archive/tar/reader.go.html#5218976">sparseHeader</a></span><span class="op" id="5219063">)</span><span class="op" id="5219064">;</span>&nbsp;<span class="ident" id="5219066"><a href="/archive/tar/reader.go.html#5218149">tr</a></span><span class="op" id="5219068">.</span><span class="ident" id="5219069">err</span>&nbsp;<span class="op" id="5219073">!=</span>&nbsp;<span class="ident" id="5219076">nil</span>&nbsp;<span class="op" id="5219080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219085">return</span>&nbsp;<span class="ident" id="5219092">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5219098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219102"><a href="/archive/tar/reader.go.html#5218213">isExtended</a></span>&nbsp;<span class="op" id="5219113">=</span>&nbsp;<span class="ident" id="5219115"><a href="/archive/tar/reader.go.html#5218976">sparseHeader</a></span><span class="op" id="5219127">[</span><span class="ident" id="5219128"><a href="/archive/tar/reader.go.html#5205469">oldGNUSparseExtendedHeaderIsExtendedOffset</a></span><span class="op" id="5219170">]</span>&nbsp;<span class="op" id="5219172">!=</span>&nbsp;<span class="num" id="5219175">0</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219179"><a href="/archive/tar/reader.go.html#5218428">s</a></span>&nbsp;<span class="op" id="5219181">=</span>&nbsp;<span class="ident" id="5219183"><a href="/archive/tar/common.go.html#5202734">slicer</a></span><span class="op" id="5219189">(</span><span class="ident" id="5219190"><a href="/archive/tar/reader.go.html#5218976">sparseHeader</a></span><span class="op" id="5219202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219206">for</span>&nbsp;<span class="ident" id="5219210">i</span>&nbsp;<span class="op" id="5219212">:=</span>&nbsp;<span class="num" id="5219215">0</span><span class="op" id="5219216">;</span>&nbsp;<span class="ident" id="5219218"><a href="/archive/tar/reader.go.html#5219210">i</a></span>&nbsp;<span class="op" id="5219220">&lt;</span>&nbsp;<span class="ident" id="5219222"><a href="/archive/tar/reader.go.html#5205519">oldGNUSparseExtendedHeaderNumEntries</a></span><span class="op" id="5219258">;</span>&nbsp;<span class="ident" id="5219260"><a href="/archive/tar/reader.go.html#5219210">i</a></span><span class="op" id="5219261">++</span>&nbsp;<span class="op" id="5219264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219269">offset</span>&nbsp;<span class="op" id="5219276">:=</span>&nbsp;<span class="ident" id="5219279"><a href="/archive/tar/reader.go.html#5218149">tr</a></span><span class="op" id="5219281">.</span><span class="ident" id="5219282">octal</span><span class="op" id="5219287">(</span><span class="ident" id="5219288"><a href="/archive/tar/reader.go.html#5218428">s</a></span><span class="op" id="5219289">.</span><span class="ident" id="5219290">next</span><span class="op" id="5219294">(</span><span class="ident" id="5219295"><a href="/archive/tar/reader.go.html#5205568">oldGNUSparseOffsetSize</a></span><span class="op" id="5219317">)</span><span class="op" id="5219318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219323">numBytes</span>&nbsp;<span class="op" id="5219332">:=</span>&nbsp;<span class="ident" id="5219335"><a href="/archive/tar/reader.go.html#5218149">tr</a></span><span class="op" id="5219337">.</span><span class="ident" id="5219338">octal</span><span class="op" id="5219343">(</span><span class="ident" id="5219344"><a href="/archive/tar/reader.go.html#5218428">s</a></span><span class="op" id="5219345">.</span><span class="ident" id="5219346">next</span><span class="op" id="5219350">(</span><span class="ident" id="5219351"><a href="/archive/tar/reader.go.html#5205617">oldGNUSparseNumBytesSize</a></span><span class="op" id="5219375">)</span><span class="op" id="5219376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219381">if</span>&nbsp;<span class="ident" id="5219384"><a href="/archive/tar/reader.go.html#5218149">tr</a></span><span class="op" id="5219386">.</span><span class="ident" id="5219387">err</span>&nbsp;<span class="op" id="5219391">!=</span>&nbsp;<span class="ident" id="5219394">nil</span>&nbsp;<span class="op" id="5219398">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219404"><a href="/archive/tar/reader.go.html#5218149">tr</a></span><span class="op" id="5219406">.</span><span class="ident" id="5219407">err</span>&nbsp;<span class="op" id="5219411">=</span>&nbsp;<span class="ident" id="5219413"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219427">return</span>&nbsp;<span class="ident" id="5219434">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5219441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219446">if</span>&nbsp;<span class="ident" id="5219449"><a href="/archive/tar/reader.go.html#5219269">offset</a></span>&nbsp;<span class="op" id="5219456">==</span>&nbsp;<span class="num" id="5219459">0</span>&nbsp;<span class="op" id="5219461">&amp;&amp;</span>&nbsp;<span class="ident" id="5219464"><a href="/archive/tar/reader.go.html#5219323">numBytes</a></span>&nbsp;<span class="op" id="5219473">==</span>&nbsp;<span class="num" id="5219476">0</span>&nbsp;<span class="op" id="5219478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219484">break</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5219493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219498"><a href="/archive/tar/reader.go.html#5218391">sp</a></span>&nbsp;<span class="op" id="5219501">=</span>&nbsp;<span class="builtinfunc" id="5219503">append</span><span class="op" id="5219509">(</span><span class="ident" id="5219510"><a href="/archive/tar/reader.go.html#5218391">sp</a></span><span class="op" id="5219512">,</span>&nbsp;<span class="ident" id="5219514"><a href="/archive/tar/reader.go.html#5217817">sparseEntry</a></span><span class="op" id="5219525">{</span><span class="ident" id="5219526">offset</span><span class="op" id="5219532">:</span>&nbsp;<span class="ident" id="5219534"><a href="/archive/tar/reader.go.html#5219269">offset</a></span><span class="op" id="5219540">,</span>&nbsp;<span class="ident" id="5219542">numBytes</span><span class="op" id="5219550">:</span>&nbsp;<span class="ident" id="5219552"><a href="/archive/tar/reader.go.html#5219323">numBytes</a></span><span class="op" id="5219560">}</span><span class="op" id="5219561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5219565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5219568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5219571">return</span>&nbsp;<span class="ident" id="5219578"><a href="/archive/tar/reader.go.html#5218391">sp</a></span><br>
<span class="lineno">595</span><span class="op" id="5219581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5219584">//&nbsp;readGNUSparseMap1x0&nbsp;reads&nbsp;the&nbsp;sparse&nbsp;map&nbsp;as&nbsp;stored&nbsp;in&nbsp;GNU&#39;s&nbsp;PAX&nbsp;sparse&nbsp;format&nbsp;version&nbsp;1.0.</span><br>
<span class="lineno"></span><span class="comment" id="5219678">//&nbsp;The&nbsp;sparse&nbsp;map&nbsp;is&nbsp;stored&nbsp;just&nbsp;before&nbsp;the&nbsp;file&nbsp;data&nbsp;and&nbsp;padded&nbsp;out&nbsp;to&nbsp;the&nbsp;nearest&nbsp;block&nbsp;boundary.</span><br>
<span class="lineno"></span><span class="keyword" id="5219778">func</span>&nbsp;<span class="ident" id="5219783">readGNUSparseMap1x0</span><span class="op" id="5219802">(</span><span class="ident" id="5219803">r</span>&nbsp;<span class="ident" id="5219805"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5219807">.</span><span class="ident" id="5219808">Reader</span><span class="op" id="5219814">)</span>&nbsp;<span class="op" id="5219816">(</span><span class="op" id="5219817">[</span><span class="op" id="5219818">]</span><span class="ident" id="5219819"><a href="/archive/tar/reader.go.html#5217817">sparseEntry</a></span><span class="op" id="5219830">,</span>&nbsp;<span class="builtintype" id="5219832">error</span><span class="op" id="5219837">)</span>&nbsp;<span class="op" id="5219839">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219842">buf</span>&nbsp;<span class="op" id="5219846">:=</span>&nbsp;<span class="builtinfunc" id="5219849">make</span><span class="op" id="5219853">(</span><span class="op" id="5219854">[</span><span class="op" id="5219855">]</span><span class="builtintype" id="5219856">byte</span><span class="op" id="5219860">,</span>&nbsp;<span class="num" id="5219862">2</span><span class="op" id="5219863">*</span><span class="ident" id="5219864"><a href="/archive/tar/common.go.html#5195939">blockSize</a></span><span class="op" id="5219873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5219876">sparseHeader</span>&nbsp;<span class="op" id="5219889">:=</span>&nbsp;<span class="ident" id="5219892"><a href="/archive/tar/reader.go.html#5219842">buf</a></span><span class="op" id="5219895">[</span><span class="op" id="5219896">:</span><span class="ident" id="5219897"><a href="/archive/tar/common.go.html#5195939">blockSize</a></span><span class="op" id="5219906">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5219910">//&nbsp;readDecimal&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;to&nbsp;read&nbsp;a&nbsp;decimal&nbsp;integer&nbsp;from&nbsp;the&nbsp;sparse&nbsp;map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5219993">//&nbsp;while&nbsp;making&nbsp;sure&nbsp;to&nbsp;read&nbsp;from&nbsp;the&nbsp;file&nbsp;in&nbsp;blocks&nbsp;of&nbsp;size&nbsp;blockSize</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220065">readDecimal</span>&nbsp;<span class="op" id="5220077">:=</span>&nbsp;<span class="keyword" id="5220080">func</span><span class="op" id="5220084">(</span><span class="op" id="5220085">)</span>&nbsp;<span class="op" id="5220087">(</span><span class="ident" id="5220088">int64</span><span class="op" id="5220093">,</span>&nbsp;<span class="builtintype" id="5220095">error</span><span class="op" id="5220100">)</span>&nbsp;<span class="op" id="5220102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5220106">//&nbsp;Look&nbsp;for&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220128">nl</span>&nbsp;<span class="op" id="5220131">:=</span>&nbsp;<span class="ident" id="5220134"><a href="/archive/tar/reader.go.html#5203352">bytes</a></span><span class="op" id="5220139">.</span><span class="ident" id="5220140">IndexByte</span><span class="op" id="5220149">(</span><span class="ident" id="5220150"><a href="/archive/tar/reader.go.html#5219876">sparseHeader</a></span><span class="op" id="5220162">,</span>&nbsp;<span class="string" id="5220164">&#39;\n&#39;</span><span class="op" id="5220168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220172">if</span>&nbsp;<span class="ident" id="5220175"><a href="/archive/tar/reader.go.html#5220128">nl</a></span>&nbsp;<span class="op" id="5220178">==</span>&nbsp;<span class="op" id="5220181">-</span><span class="num" id="5220182">1</span>&nbsp;<span class="op" id="5220184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220189">if</span>&nbsp;<span class="builtinfunc" id="5220192">len</span><span class="op" id="5220195">(</span><span class="ident" id="5220196"><a href="/archive/tar/reader.go.html#5219876">sparseHeader</a></span><span class="op" id="5220208">)</span>&nbsp;<span class="op" id="5220210">&gt;=</span>&nbsp;<span class="ident" id="5220213"><a href="/archive/tar/common.go.html#5195939">blockSize</a></span>&nbsp;<span class="op" id="5220223">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5220229">//&nbsp;This&nbsp;is&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220253">return</span>&nbsp;<span class="num" id="5220260">0</span><span class="op" id="5220261">,</span>&nbsp;<span class="ident" id="5220263"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5220276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220281">oldLen</span>&nbsp;<span class="op" id="5220288">:=</span>&nbsp;<span class="builtinfunc" id="5220291">len</span><span class="op" id="5220294">(</span><span class="ident" id="5220295"><a href="/archive/tar/reader.go.html#5219876">sparseHeader</a></span><span class="op" id="5220307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220312">newLen</span>&nbsp;<span class="op" id="5220319">:=</span>&nbsp;<span class="ident" id="5220322"><a href="/archive/tar/reader.go.html#5220281">oldLen</a></span>&nbsp;<span class="op" id="5220329">+</span>&nbsp;<span class="ident" id="5220331"><a href="/archive/tar/common.go.html#5195939">blockSize</a></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220344">if</span>&nbsp;<span class="builtinfunc" id="5220347">cap</span><span class="op" id="5220350">(</span><span class="ident" id="5220351"><a href="/archive/tar/reader.go.html#5219876">sparseHeader</a></span><span class="op" id="5220363">)</span>&nbsp;<span class="op" id="5220365">&lt;</span>&nbsp;<span class="ident" id="5220367"><a href="/archive/tar/reader.go.html#5220312">newLen</a></span>&nbsp;<span class="op" id="5220374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5220380">//&nbsp;There&#39;s&nbsp;more&nbsp;header,&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;room&nbsp;for&nbsp;the&nbsp;next&nbsp;block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5220452">copy</span><span class="op" id="5220456">(</span><span class="ident" id="5220457"><a href="/archive/tar/reader.go.html#5219842">buf</a></span><span class="op" id="5220460">,</span>&nbsp;<span class="ident" id="5220462"><a href="/archive/tar/reader.go.html#5219876">sparseHeader</a></span><span class="op" id="5220474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220480"><a href="/archive/tar/reader.go.html#5219876">sparseHeader</a></span>&nbsp;<span class="op" id="5220493">=</span>&nbsp;<span class="ident" id="5220495"><a href="/archive/tar/reader.go.html#5219842">buf</a></span><span class="op" id="5220498">[</span><span class="op" id="5220499">:</span><span class="ident" id="5220500"><a href="/archive/tar/reader.go.html#5220312">newLen</a></span><span class="op" id="5220506">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5220511">}</span>&nbsp;<span class="keyword" id="5220513">else</span>&nbsp;<span class="op" id="5220518">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5220524">//&nbsp;There&#39;s&nbsp;more&nbsp;header,&nbsp;and&nbsp;we&nbsp;can&nbsp;just&nbsp;reslice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220576"><a href="/archive/tar/reader.go.html#5219876">sparseHeader</a></span>&nbsp;<span class="op" id="5220589">=</span>&nbsp;<span class="ident" id="5220591"><a href="/archive/tar/reader.go.html#5219876">sparseHeader</a></span><span class="op" id="5220603">[</span><span class="op" id="5220604">:</span><span class="ident" id="5220605"><a href="/archive/tar/reader.go.html#5220312">newLen</a></span><span class="op" id="5220611">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5220616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5220622">//&nbsp;Now&nbsp;that&nbsp;sparseHeader&nbsp;is&nbsp;large&nbsp;enough,&nbsp;read&nbsp;next&nbsp;block</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220683">if</span>&nbsp;<span class="ident" id="5220686">_</span><span class="op" id="5220687">,</span>&nbsp;<span class="ident" id="5220689">err</span>&nbsp;<span class="op" id="5220693">:=</span>&nbsp;<span class="ident" id="5220696"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5220698">.</span><span class="ident" id="5220699">ReadFull</span><span class="op" id="5220707">(</span><span class="ident" id="5220708"><a href="/archive/tar/reader.go.html#5219803">r</a></span><span class="op" id="5220709">,</span>&nbsp;<span class="ident" id="5220711"><a href="/archive/tar/reader.go.html#5219876">sparseHeader</a></span><span class="op" id="5220723">[</span><span class="ident" id="5220724"><a href="/archive/tar/reader.go.html#5220281">oldLen</a></span><span class="op" id="5220730">:</span><span class="ident" id="5220731"><a href="/archive/tar/reader.go.html#5220312">newLen</a></span><span class="op" id="5220737">]</span><span class="op" id="5220738">)</span><span class="op" id="5220739">;</span>&nbsp;<span class="ident" id="5220741"><a href="/archive/tar/reader.go.html#5220689">err</a></span>&nbsp;<span class="op" id="5220745">!=</span>&nbsp;<span class="ident" id="5220748">nil</span>&nbsp;<span class="op" id="5220752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220758">return</span>&nbsp;<span class="num" id="5220765">0</span><span class="op" id="5220766">,</span>&nbsp;<span class="ident" id="5220768"><a href="/archive/tar/reader.go.html#5220689">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5220775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5220781">//&nbsp;Look&nbsp;for&nbsp;a&nbsp;newline&nbsp;in&nbsp;the&nbsp;new&nbsp;data</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220822"><a href="/archive/tar/reader.go.html#5220128">nl</a></span>&nbsp;<span class="op" id="5220825">=</span>&nbsp;<span class="ident" id="5220827"><a href="/archive/tar/reader.go.html#5203352">bytes</a></span><span class="op" id="5220832">.</span><span class="ident" id="5220833">IndexByte</span><span class="op" id="5220842">(</span><span class="ident" id="5220843"><a href="/archive/tar/reader.go.html#5219876">sparseHeader</a></span><span class="op" id="5220855">[</span><span class="ident" id="5220856"><a href="/archive/tar/reader.go.html#5220281">oldLen</a></span><span class="op" id="5220862">:</span><span class="ident" id="5220863"><a href="/archive/tar/reader.go.html#5220312">newLen</a></span><span class="op" id="5220869">]</span><span class="op" id="5220870">,</span>&nbsp;<span class="string" id="5220872">&#39;\n&#39;</span><span class="op" id="5220876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220881">if</span>&nbsp;<span class="ident" id="5220884"><a href="/archive/tar/reader.go.html#5220128">nl</a></span>&nbsp;<span class="op" id="5220887">==</span>&nbsp;<span class="op" id="5220890">-</span><span class="num" id="5220891">1</span>&nbsp;<span class="op" id="5220893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5220899">//&nbsp;This&nbsp;is&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5220923">return</span>&nbsp;<span class="num" id="5220930">0</span><span class="op" id="5220931">,</span>&nbsp;<span class="ident" id="5220933"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5220946">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5220951"><a href="/archive/tar/reader.go.html#5220128">nl</a></span>&nbsp;<span class="op" id="5220954">+=</span>&nbsp;<span class="ident" id="5220957"><a href="/archive/tar/reader.go.html#5220281">oldLen</a></span>&nbsp;<span class="comment" id="5220964">//&nbsp;We&nbsp;want&nbsp;the&nbsp;position&nbsp;from&nbsp;the&nbsp;beginning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5221009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5221013">//&nbsp;Now&nbsp;that&nbsp;we&#39;ve&nbsp;found&nbsp;a&nbsp;newline,&nbsp;read&nbsp;a&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221064">n</span><span class="op" id="5221065">,</span>&nbsp;<span class="ident" id="5221067">err</span>&nbsp;<span class="op" id="5221071">:=</span>&nbsp;<span class="ident" id="5221074"><a href="/archive/tar/reader.go.html#5203396">strconv</a></span><span class="op" id="5221081">.</span><span class="ident" id="5221082">ParseInt</span><span class="op" id="5221090">(</span><span class="builtintype" id="5221091">string</span><span class="op" id="5221097">(</span><span class="ident" id="5221098"><a href="/archive/tar/reader.go.html#5219876">sparseHeader</a></span><span class="op" id="5221110">[</span><span class="op" id="5221111">:</span><span class="ident" id="5221112"><a href="/archive/tar/reader.go.html#5220128">nl</a></span><span class="op" id="5221114">]</span><span class="op" id="5221115">)</span><span class="op" id="5221116">,</span>&nbsp;<span class="num" id="5221118">10</span><span class="op" id="5221120">,</span>&nbsp;<span class="num" id="5221122">0</span><span class="op" id="5221123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221127">if</span>&nbsp;<span class="ident" id="5221130"><a href="/archive/tar/reader.go.html#5221067">err</a></span>&nbsp;<span class="op" id="5221134">!=</span>&nbsp;<span class="ident" id="5221137">nil</span>&nbsp;<span class="op" id="5221141">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221146">return</span>&nbsp;<span class="num" id="5221153">0</span><span class="op" id="5221154">,</span>&nbsp;<span class="ident" id="5221156"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5221168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5221173">//&nbsp;Update&nbsp;sparseHeader&nbsp;to&nbsp;consume&nbsp;this&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221221"><a href="/archive/tar/reader.go.html#5219876">sparseHeader</a></span>&nbsp;<span class="op" id="5221234">=</span>&nbsp;<span class="ident" id="5221236"><a href="/archive/tar/reader.go.html#5219876">sparseHeader</a></span><span class="op" id="5221248">[</span><span class="ident" id="5221249"><a href="/archive/tar/reader.go.html#5220128">nl</a></span><span class="op" id="5221251">+</span><span class="num" id="5221252">1</span><span class="op" id="5221253">:</span><span class="op" id="5221254">]</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221258">return</span>&nbsp;<span class="ident" id="5221265"><a href="/archive/tar/reader.go.html#5221064">n</a></span><span class="op" id="5221266">,</span>&nbsp;<span class="ident" id="5221268">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5221273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5221277">//&nbsp;Read&nbsp;the&nbsp;first&nbsp;block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221302">if</span>&nbsp;<span class="ident" id="5221305">_</span><span class="op" id="5221306">,</span>&nbsp;<span class="ident" id="5221308">err</span>&nbsp;<span class="op" id="5221312">:=</span>&nbsp;<span class="ident" id="5221315"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5221317">.</span><span class="ident" id="5221318">ReadFull</span><span class="op" id="5221326">(</span><span class="ident" id="5221327"><a href="/archive/tar/reader.go.html#5219803">r</a></span><span class="op" id="5221328">,</span>&nbsp;<span class="ident" id="5221330"><a href="/archive/tar/reader.go.html#5219876">sparseHeader</a></span><span class="op" id="5221342">)</span><span class="op" id="5221343">;</span>&nbsp;<span class="ident" id="5221345"><a href="/archive/tar/reader.go.html#5221308">err</a></span>&nbsp;<span class="op" id="5221349">!=</span>&nbsp;<span class="ident" id="5221352">nil</span>&nbsp;<span class="op" id="5221356">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221360">return</span>&nbsp;<span class="ident" id="5221367">nil</span><span class="op" id="5221370">,</span>&nbsp;<span class="ident" id="5221372"><a href="/archive/tar/reader.go.html#5221308">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5221377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5221381">//&nbsp;The&nbsp;first&nbsp;line&nbsp;contains&nbsp;the&nbsp;number&nbsp;of&nbsp;entries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221431">numEntries</span><span class="op" id="5221441">,</span>&nbsp;<span class="ident" id="5221443">err</span>&nbsp;<span class="op" id="5221447">:=</span>&nbsp;<span class="ident" id="5221450"><a href="/archive/tar/reader.go.html#5220065">readDecimal</a></span><span class="op" id="5221461">(</span><span class="op" id="5221462">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221465">if</span>&nbsp;<span class="ident" id="5221468"><a href="/archive/tar/reader.go.html#5221443">err</a></span>&nbsp;<span class="op" id="5221472">!=</span>&nbsp;<span class="ident" id="5221475">nil</span>&nbsp;<span class="op" id="5221479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221483">return</span>&nbsp;<span class="ident" id="5221490">nil</span><span class="op" id="5221493">,</span>&nbsp;<span class="ident" id="5221495"><a href="/archive/tar/reader.go.html#5221443">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5221500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5221504">//&nbsp;Read&nbsp;all&nbsp;the&nbsp;entries</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221529">sp</span>&nbsp;<span class="op" id="5221532">:=</span>&nbsp;<span class="builtinfunc" id="5221535">make</span><span class="op" id="5221539">(</span><span class="op" id="5221540">[</span><span class="op" id="5221541">]</span><span class="ident" id="5221542"><a href="/archive/tar/reader.go.html#5217817">sparseEntry</a></span><span class="op" id="5221553">,</span>&nbsp;<span class="num" id="5221555">0</span><span class="op" id="5221556">,</span>&nbsp;<span class="ident" id="5221558"><a href="/archive/tar/reader.go.html#5221431">numEntries</a></span><span class="op" id="5221568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221571">for</span>&nbsp;<span class="ident" id="5221575">i</span>&nbsp;<span class="op" id="5221577">:=</span>&nbsp;<span class="ident" id="5221580">int64</span><span class="op" id="5221585">(</span><span class="num" id="5221586">0</span><span class="op" id="5221587">)</span><span class="op" id="5221588">;</span>&nbsp;<span class="ident" id="5221590"><a href="/archive/tar/reader.go.html#5221575">i</a></span>&nbsp;<span class="op" id="5221592">&lt;</span>&nbsp;<span class="ident" id="5221594"><a href="/archive/tar/reader.go.html#5221431">numEntries</a></span><span class="op" id="5221604">;</span>&nbsp;<span class="ident" id="5221606"><a href="/archive/tar/reader.go.html#5221575">i</a></span><span class="op" id="5221607">++</span>&nbsp;<span class="op" id="5221610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5221614">//&nbsp;Read&nbsp;the&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221635">offset</span><span class="op" id="5221641">,</span>&nbsp;<span class="ident" id="5221643">err</span>&nbsp;<span class="op" id="5221647">:=</span>&nbsp;<span class="ident" id="5221650"><a href="/archive/tar/reader.go.html#5220065">readDecimal</a></span><span class="op" id="5221661">(</span><span class="op" id="5221662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221666">if</span>&nbsp;<span class="ident" id="5221669"><a href="/archive/tar/reader.go.html#5221643">err</a></span>&nbsp;<span class="op" id="5221673">!=</span>&nbsp;<span class="ident" id="5221676">nil</span>&nbsp;<span class="op" id="5221680">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221685">return</span>&nbsp;<span class="ident" id="5221692">nil</span><span class="op" id="5221695">,</span>&nbsp;<span class="ident" id="5221697"><a href="/archive/tar/reader.go.html#5221643">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5221703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5221707">//&nbsp;Read&nbsp;numBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221726">numBytes</span><span class="op" id="5221734">,</span>&nbsp;<span class="ident" id="5221736"><a href="/archive/tar/reader.go.html#5221643">err</a></span>&nbsp;<span class="op" id="5221740">:=</span>&nbsp;<span class="ident" id="5221743"><a href="/archive/tar/reader.go.html#5220065">readDecimal</a></span><span class="op" id="5221754">(</span><span class="op" id="5221755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221759">if</span>&nbsp;<span class="ident" id="5221762"><a href="/archive/tar/reader.go.html#5221643">err</a></span>&nbsp;<span class="op" id="5221766">!=</span>&nbsp;<span class="ident" id="5221769">nil</span>&nbsp;<span class="op" id="5221773">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221778">return</span>&nbsp;<span class="ident" id="5221785">nil</span><span class="op" id="5221788">,</span>&nbsp;<span class="ident" id="5221790"><a href="/archive/tar/reader.go.html#5221643">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5221796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5221801"><a href="/archive/tar/reader.go.html#5221529">sp</a></span>&nbsp;<span class="op" id="5221804">=</span>&nbsp;<span class="builtinfunc" id="5221806">append</span><span class="op" id="5221812">(</span><span class="ident" id="5221813"><a href="/archive/tar/reader.go.html#5221529">sp</a></span><span class="op" id="5221815">,</span>&nbsp;<span class="ident" id="5221817"><a href="/archive/tar/reader.go.html#5217817">sparseEntry</a></span><span class="op" id="5221828">{</span><span class="ident" id="5221829">offset</span><span class="op" id="5221835">:</span>&nbsp;<span class="ident" id="5221837"><a href="/archive/tar/reader.go.html#5221635">offset</a></span><span class="op" id="5221843">,</span>&nbsp;<span class="ident" id="5221845">numBytes</span><span class="op" id="5221853">:</span>&nbsp;<span class="ident" id="5221855"><a href="/archive/tar/reader.go.html#5221726">numBytes</a></span><span class="op" id="5221863">}</span><span class="op" id="5221864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5221867">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5221871">return</span>&nbsp;<span class="ident" id="5221878"><a href="/archive/tar/reader.go.html#5221529">sp</a></span><span class="op" id="5221880">,</span>&nbsp;<span class="ident" id="5221882">nil</span><br>
<span class="lineno"></span><span class="op" id="5221886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5221889">//&nbsp;readGNUSparseMap0x1&nbsp;reads&nbsp;the&nbsp;sparse&nbsp;map&nbsp;as&nbsp;stored&nbsp;in&nbsp;GNU&#39;s&nbsp;PAX&nbsp;sparse&nbsp;format&nbsp;version&nbsp;0.1.</span><br>
<span class="lineno">680</span><span class="comment" id="5221983">//&nbsp;The&nbsp;sparse&nbsp;map&nbsp;is&nbsp;stored&nbsp;in&nbsp;the&nbsp;PAX&nbsp;headers.</span><br>
<span class="lineno"></span><span class="keyword" id="5222031">func</span>&nbsp;<span class="ident" id="5222036">readGNUSparseMap0x1</span><span class="op" id="5222055">(</span><span class="ident" id="5222056">headers</span>&nbsp;<span class="keyword" id="5222064">map</span><span class="op" id="5222067">[</span><span class="builtintype" id="5222068">string</span><span class="op" id="5222074">]</span><span class="builtintype" id="5222075">string</span><span class="op" id="5222081">)</span>&nbsp;<span class="op" id="5222083">(</span><span class="op" id="5222084">[</span><span class="op" id="5222085">]</span><span class="ident" id="5222086"><a href="/archive/tar/reader.go.html#5217817">sparseEntry</a></span><span class="op" id="5222097">,</span>&nbsp;<span class="builtintype" id="5222099">error</span><span class="op" id="5222104">)</span>&nbsp;<span class="op" id="5222106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5222109">//&nbsp;Get&nbsp;number&nbsp;of&nbsp;entries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5222135">numEntriesStr</span><span class="op" id="5222148">,</span>&nbsp;<span class="ident" id="5222150">ok</span>&nbsp;<span class="op" id="5222153">:=</span>&nbsp;<span class="ident" id="5222156"><a href="/archive/tar/reader.go.html#5222056">headers</a></span><span class="op" id="5222163">[</span><span class="ident" id="5222164"><a href="/archive/tar/reader.go.html#5204868">paxGNUSparseNumBlocks</a></span><span class="op" id="5222185">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222188">if</span>&nbsp;<span class="op" id="5222191">!</span><span class="ident" id="5222192"><a href="/archive/tar/reader.go.html#5222150">ok</a></span>&nbsp;<span class="op" id="5222195">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222199">return</span>&nbsp;<span class="ident" id="5222206">nil</span><span class="op" id="5222209">,</span>&nbsp;<span class="ident" id="5222211"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5222222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5222225">numEntries</span><span class="op" id="5222235">,</span>&nbsp;<span class="ident" id="5222237">err</span>&nbsp;<span class="op" id="5222241">:=</span>&nbsp;<span class="ident" id="5222244"><a href="/archive/tar/reader.go.html#5203396">strconv</a></span><span class="op" id="5222251">.</span><span class="ident" id="5222252">ParseInt</span><span class="op" id="5222260">(</span><span class="ident" id="5222261"><a href="/archive/tar/reader.go.html#5222135">numEntriesStr</a></span><span class="op" id="5222274">,</span>&nbsp;<span class="num" id="5222276">10</span><span class="op" id="5222278">,</span>&nbsp;<span class="num" id="5222280">0</span><span class="op" id="5222281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222284">if</span>&nbsp;<span class="ident" id="5222287"><a href="/archive/tar/reader.go.html#5222237">err</a></span>&nbsp;<span class="op" id="5222291">!=</span>&nbsp;<span class="ident" id="5222294">nil</span>&nbsp;<span class="op" id="5222298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222302">return</span>&nbsp;<span class="ident" id="5222309">nil</span><span class="op" id="5222312">,</span>&nbsp;<span class="ident" id="5222314"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5222325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5222329">sparseMap</span>&nbsp;<span class="op" id="5222339">:=</span>&nbsp;<span class="ident" id="5222342"><a href="/archive/tar/reader.go.html#5203407">strings</a></span><span class="op" id="5222349">.</span><span class="ident" id="5222350">Split</span><span class="op" id="5222355">(</span><span class="ident" id="5222356"><a href="/archive/tar/reader.go.html#5222056">headers</a></span><span class="op" id="5222363">[</span><span class="ident" id="5222364"><a href="/archive/tar/reader.go.html#5205008">paxGNUSparseMap</a></span><span class="op" id="5222379">]</span><span class="op" id="5222380">,</span>&nbsp;<span class="string" id="5222382">&#34;,&#34;</span><span class="op" id="5222385">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5222389">//&nbsp;There&nbsp;should&nbsp;be&nbsp;two&nbsp;numbers&nbsp;in&nbsp;sparseMap&nbsp;for&nbsp;each&nbsp;entry</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222449">if</span>&nbsp;<span class="ident" id="5222452">int64</span><span class="op" id="5222457">(</span><span class="builtinfunc" id="5222458">len</span><span class="op" id="5222461">(</span><span class="ident" id="5222462"><a href="/archive/tar/reader.go.html#5222329">sparseMap</a></span><span class="op" id="5222471">)</span><span class="op" id="5222472">)</span>&nbsp;<span class="op" id="5222474">!=</span>&nbsp;<span class="num" id="5222477">2</span><span class="op" id="5222478">*</span><span class="ident" id="5222479"><a href="/archive/tar/reader.go.html#5222225">numEntries</a></span>&nbsp;<span class="op" id="5222490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222494">return</span>&nbsp;<span class="ident" id="5222501">nil</span><span class="op" id="5222504">,</span>&nbsp;<span class="ident" id="5222506"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5222517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5222521">//&nbsp;Loop&nbsp;through&nbsp;the&nbsp;entries&nbsp;in&nbsp;the&nbsp;sparse&nbsp;map</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5222568">sp</span>&nbsp;<span class="op" id="5222571">:=</span>&nbsp;<span class="builtinfunc" id="5222574">make</span><span class="op" id="5222578">(</span><span class="op" id="5222579">[</span><span class="op" id="5222580">]</span><span class="ident" id="5222581"><a href="/archive/tar/reader.go.html#5217817">sparseEntry</a></span><span class="op" id="5222592">,</span>&nbsp;<span class="num" id="5222594">0</span><span class="op" id="5222595">,</span>&nbsp;<span class="ident" id="5222597"><a href="/archive/tar/reader.go.html#5222225">numEntries</a></span><span class="op" id="5222607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222610">for</span>&nbsp;<span class="ident" id="5222614">i</span>&nbsp;<span class="op" id="5222616">:=</span>&nbsp;<span class="ident" id="5222619">int64</span><span class="op" id="5222624">(</span><span class="num" id="5222625">0</span><span class="op" id="5222626">)</span><span class="op" id="5222627">;</span>&nbsp;<span class="ident" id="5222629"><a href="/archive/tar/reader.go.html#5222614">i</a></span>&nbsp;<span class="op" id="5222631">&lt;</span>&nbsp;<span class="ident" id="5222633"><a href="/archive/tar/reader.go.html#5222225">numEntries</a></span><span class="op" id="5222643">;</span>&nbsp;<span class="ident" id="5222645"><a href="/archive/tar/reader.go.html#5222614">i</a></span><span class="op" id="5222646">++</span>&nbsp;<span class="op" id="5222649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5222653">offset</span><span class="op" id="5222659">,</span>&nbsp;<span class="ident" id="5222661">err</span>&nbsp;<span class="op" id="5222665">:=</span>&nbsp;<span class="ident" id="5222668"><a href="/archive/tar/reader.go.html#5203396">strconv</a></span><span class="op" id="5222675">.</span><span class="ident" id="5222676">ParseInt</span><span class="op" id="5222684">(</span><span class="ident" id="5222685"><a href="/archive/tar/reader.go.html#5222329">sparseMap</a></span><span class="op" id="5222694">[</span><span class="num" id="5222695">2</span><span class="op" id="5222696">*</span><span class="ident" id="5222697"><a href="/archive/tar/reader.go.html#5222614">i</a></span><span class="op" id="5222698">]</span><span class="op" id="5222699">,</span>&nbsp;<span class="num" id="5222701">10</span><span class="op" id="5222703">,</span>&nbsp;<span class="num" id="5222705">0</span><span class="op" id="5222706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222710">if</span>&nbsp;<span class="ident" id="5222713"><a href="/archive/tar/reader.go.html#5222661">err</a></span>&nbsp;<span class="op" id="5222717">!=</span>&nbsp;<span class="ident" id="5222720">nil</span>&nbsp;<span class="op" id="5222724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222729">return</span>&nbsp;<span class="ident" id="5222736">nil</span><span class="op" id="5222739">,</span>&nbsp;<span class="ident" id="5222741"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5222753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5222757">numBytes</span><span class="op" id="5222765">,</span>&nbsp;<span class="ident" id="5222767"><a href="/archive/tar/reader.go.html#5222661">err</a></span>&nbsp;<span class="op" id="5222771">:=</span>&nbsp;<span class="ident" id="5222774"><a href="/archive/tar/reader.go.html#5203396">strconv</a></span><span class="op" id="5222781">.</span><span class="ident" id="5222782">ParseInt</span><span class="op" id="5222790">(</span><span class="ident" id="5222791"><a href="/archive/tar/reader.go.html#5222329">sparseMap</a></span><span class="op" id="5222800">[</span><span class="num" id="5222801">2</span><span class="op" id="5222802">*</span><span class="ident" id="5222803"><a href="/archive/tar/reader.go.html#5222614">i</a></span><span class="op" id="5222804">+</span><span class="num" id="5222805">1</span><span class="op" id="5222806">]</span><span class="op" id="5222807">,</span>&nbsp;<span class="num" id="5222809">10</span><span class="op" id="5222811">,</span>&nbsp;<span class="num" id="5222813">0</span><span class="op" id="5222814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222818">if</span>&nbsp;<span class="ident" id="5222821"><a href="/archive/tar/reader.go.html#5222661">err</a></span>&nbsp;<span class="op" id="5222825">!=</span>&nbsp;<span class="ident" id="5222828">nil</span>&nbsp;<span class="op" id="5222832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222837">return</span>&nbsp;<span class="ident" id="5222844">nil</span><span class="op" id="5222847">,</span>&nbsp;<span class="ident" id="5222849"><a href="/archive/tar/reader.go.html#5203435">ErrHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5222861">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5222865"><a href="/archive/tar/reader.go.html#5222568">sp</a></span>&nbsp;<span class="op" id="5222868">=</span>&nbsp;<span class="builtinfunc" id="5222870">append</span><span class="op" id="5222876">(</span><span class="ident" id="5222877"><a href="/archive/tar/reader.go.html#5222568">sp</a></span><span class="op" id="5222879">,</span>&nbsp;<span class="ident" id="5222881"><a href="/archive/tar/reader.go.html#5217817">sparseEntry</a></span><span class="op" id="5222892">{</span><span class="ident" id="5222893">offset</span><span class="op" id="5222899">:</span>&nbsp;<span class="ident" id="5222901"><a href="/archive/tar/reader.go.html#5222653">offset</a></span><span class="op" id="5222907">,</span>&nbsp;<span class="ident" id="5222909">numBytes</span><span class="op" id="5222917">:</span>&nbsp;<span class="ident" id="5222919"><a href="/archive/tar/reader.go.html#5222757">numBytes</a></span><span class="op" id="5222927">}</span><span class="op" id="5222928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5222931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5222935">return</span>&nbsp;<span class="ident" id="5222942"><a href="/archive/tar/reader.go.html#5222568">sp</a></span><span class="op" id="5222944">,</span>&nbsp;<span class="ident" id="5222946">nil</span><br>
<span class="lineno"></span><span class="op" id="5222950">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="comment" id="5222953">//&nbsp;numBytes&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;left&nbsp;to&nbsp;read&nbsp;in&nbsp;the&nbsp;current&nbsp;file&#39;s&nbsp;entry</span><br>
<span class="lineno"></span><span class="comment" id="5223034">//&nbsp;in&nbsp;the&nbsp;tar&nbsp;archive,&nbsp;or&nbsp;0&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;current&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5223091">func</span>&nbsp;<span class="op" id="5223096">(</span><span class="ident" id="5223097">tr</span>&nbsp;<span class="op" id="5223100">*</span><span class="ident" id="5223101"><a href="/archive/tar/reader.go.html#5203812">Reader</a></span><span class="op" id="5223107">)</span>&nbsp;<span class="ident" id="5223109">numBytes</span><span class="op" id="5223117">(</span><span class="op" id="5223118">)</span>&nbsp;<span class="ident" id="5223120">int64</span>&nbsp;<span class="op" id="5223126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223129">if</span>&nbsp;<span class="ident" id="5223132"><a href="/archive/tar/reader.go.html#5223097">tr</a></span><span class="op" id="5223134">.</span><span class="ident" id="5223135">curr</span>&nbsp;<span class="op" id="5223140">==</span>&nbsp;<span class="ident" id="5223143">nil</span>&nbsp;<span class="op" id="5223147">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5223151">//&nbsp;No&nbsp;current&nbsp;file,&nbsp;so&nbsp;no&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223185">return</span>&nbsp;<span class="num" id="5223192">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5223195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223198">return</span>&nbsp;<span class="ident" id="5223205"><a href="/archive/tar/reader.go.html#5223097">tr</a></span><span class="op" id="5223207">.</span><span class="ident" id="5223208">curr</span><span class="op" id="5223212">.</span><span class="ident" id="5223213">numBytes</span><span class="op" id="5223221">(</span><span class="op" id="5223222">)</span><br>
<span class="lineno"></span><span class="op" id="5223224">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span><span class="comment" id="5223227">//&nbsp;Read&nbsp;reads&nbsp;from&nbsp;the&nbsp;current&nbsp;entry&nbsp;in&nbsp;the&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="comment" id="5223284">//&nbsp;It&nbsp;returns&nbsp;0,&nbsp;io.EOF&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the&nbsp;end&nbsp;of&nbsp;that&nbsp;entry,</span><br>
<span class="lineno"></span><span class="comment" id="5223347">//&nbsp;until&nbsp;Next&nbsp;is&nbsp;called&nbsp;to&nbsp;advance&nbsp;to&nbsp;the&nbsp;next&nbsp;entry.</span><br>
<span class="lineno"></span><span class="keyword" id="5223401">func</span>&nbsp;<span class="op" id="5223406">(</span><span class="ident" id="5223407">tr</span>&nbsp;<span class="op" id="5223410">*</span><span class="ident" id="5223411"><a href="/archive/tar/reader.go.html#5203812">Reader</a></span><span class="op" id="5223417">)</span>&nbsp;<span class="ident" id="5223419">Read</span><span class="op" id="5223423">(</span><span class="ident" id="5223424">b</span>&nbsp;<span class="op" id="5223426">[</span><span class="op" id="5223427">]</span><span class="builtintype" id="5223428">byte</span><span class="op" id="5223432">)</span>&nbsp;<span class="op" id="5223434">(</span><span class="ident" id="5223435">n</span>&nbsp;<span class="builtintype" id="5223437">int</span><span class="op" id="5223440">,</span>&nbsp;<span class="ident" id="5223442">err</span>&nbsp;<span class="builtintype" id="5223446">error</span><span class="op" id="5223451">)</span>&nbsp;<span class="op" id="5223453">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223456">if</span>&nbsp;<span class="ident" id="5223459"><a href="/archive/tar/reader.go.html#5223407">tr</a></span><span class="op" id="5223461">.</span><span class="ident" id="5223462">curr</span>&nbsp;<span class="op" id="5223467">==</span>&nbsp;<span class="ident" id="5223470">nil</span>&nbsp;<span class="op" id="5223474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223478">return</span>&nbsp;<span class="num" id="5223485">0</span><span class="op" id="5223486">,</span>&nbsp;<span class="ident" id="5223488"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5223490">.</span><span class="ident" id="5223491">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5223496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5223499"><a href="/archive/tar/reader.go.html#5223435">n</a></span><span class="op" id="5223500">,</span>&nbsp;<span class="ident" id="5223502"><a href="/archive/tar/reader.go.html#5223442">err</a></span>&nbsp;<span class="op" id="5223506">=</span>&nbsp;<span class="ident" id="5223508"><a href="/archive/tar/reader.go.html#5223407">tr</a></span><span class="op" id="5223510">.</span><span class="ident" id="5223511">curr</span><span class="op" id="5223515">.</span><span class="ident" id="5223516">Read</span><span class="op" id="5223520">(</span><span class="ident" id="5223521"><a href="/archive/tar/reader.go.html#5223424">b</a></span><span class="op" id="5223522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223525">if</span>&nbsp;<span class="ident" id="5223528"><a href="/archive/tar/reader.go.html#5223442">err</a></span>&nbsp;<span class="op" id="5223532">!=</span>&nbsp;<span class="ident" id="5223535">nil</span>&nbsp;<span class="op" id="5223539">&amp;&amp;</span>&nbsp;<span class="ident" id="5223542"><a href="/archive/tar/reader.go.html#5223442">err</a></span>&nbsp;<span class="op" id="5223546">!=</span>&nbsp;<span class="ident" id="5223549"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5223551">.</span><span class="ident" id="5223552">EOF</span>&nbsp;<span class="op" id="5223556">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5223560"><a href="/archive/tar/reader.go.html#5223407">tr</a></span><span class="op" id="5223562">.</span><span class="ident" id="5223563">err</span>&nbsp;<span class="op" id="5223567">=</span>&nbsp;<span class="ident" id="5223569"><a href="/archive/tar/reader.go.html#5223442">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5223574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223577">return</span><br>
<span class="lineno"></span><span class="op" id="5223584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="5223587">func</span>&nbsp;<span class="op" id="5223592">(</span><span class="ident" id="5223593">rfr</span>&nbsp;<span class="op" id="5223597">*</span><span class="ident" id="5223598"><a href="/archive/tar/reader.go.html#5204345">regFileReader</a></span><span class="op" id="5223611">)</span>&nbsp;<span class="ident" id="5223613">Read</span><span class="op" id="5223617">(</span><span class="ident" id="5223618">b</span>&nbsp;<span class="op" id="5223620">[</span><span class="op" id="5223621">]</span><span class="builtintype" id="5223622">byte</span><span class="op" id="5223626">)</span>&nbsp;<span class="op" id="5223628">(</span><span class="ident" id="5223629">n</span>&nbsp;<span class="builtintype" id="5223631">int</span><span class="op" id="5223634">,</span>&nbsp;<span class="ident" id="5223636">err</span>&nbsp;<span class="builtintype" id="5223640">error</span><span class="op" id="5223645">)</span>&nbsp;<span class="op" id="5223647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223650">if</span>&nbsp;<span class="ident" id="5223653"><a href="/archive/tar/reader.go.html#5223593">rfr</a></span><span class="op" id="5223656">.</span><span class="ident" id="5223657">nb</span>&nbsp;<span class="op" id="5223660">==</span>&nbsp;<span class="num" id="5223663">0</span>&nbsp;<span class="op" id="5223665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5223669">//&nbsp;file&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223688">return</span>&nbsp;<span class="num" id="5223695">0</span><span class="op" id="5223696">,</span>&nbsp;<span class="ident" id="5223698"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5223700">.</span><span class="ident" id="5223701">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5223706">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223709">if</span>&nbsp;<span class="ident" id="5223712">int64</span><span class="op" id="5223717">(</span><span class="builtinfunc" id="5223718">len</span><span class="op" id="5223721">(</span><span class="ident" id="5223722"><a href="/archive/tar/reader.go.html#5223618">b</a></span><span class="op" id="5223723">)</span><span class="op" id="5223724">)</span>&nbsp;<span class="op" id="5223726">&gt;</span>&nbsp;<span class="ident" id="5223728"><a href="/archive/tar/reader.go.html#5223593">rfr</a></span><span class="op" id="5223731">.</span><span class="ident" id="5223732">nb</span>&nbsp;<span class="op" id="5223735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5223739"><a href="/archive/tar/reader.go.html#5223618">b</a></span>&nbsp;<span class="op" id="5223741">=</span>&nbsp;<span class="ident" id="5223743"><a href="/archive/tar/reader.go.html#5223618">b</a></span><span class="op" id="5223744">[</span><span class="num" id="5223745">0</span><span class="op" id="5223746">:</span><span class="ident" id="5223747"><a href="/archive/tar/reader.go.html#5223593">rfr</a></span><span class="op" id="5223750">.</span><span class="ident" id="5223751">nb</span><span class="op" id="5223753">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5223756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5223759"><a href="/archive/tar/reader.go.html#5223629">n</a></span><span class="op" id="5223760">,</span>&nbsp;<span class="ident" id="5223762"><a href="/archive/tar/reader.go.html#5223636">err</a></span>&nbsp;<span class="op" id="5223766">=</span>&nbsp;<span class="ident" id="5223768"><a href="/archive/tar/reader.go.html#5223593">rfr</a></span><span class="op" id="5223771">.</span><span class="ident" id="5223772">r</span><span class="op" id="5223773">.</span><span class="ident" id="5223774">Read</span><span class="op" id="5223778">(</span><span class="ident" id="5223779"><a href="/archive/tar/reader.go.html#5223618">b</a></span><span class="op" id="5223780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5223783"><a href="/archive/tar/reader.go.html#5223593">rfr</a></span><span class="op" id="5223786">.</span><span class="ident" id="5223787">nb</span>&nbsp;<span class="op" id="5223790">-=</span>&nbsp;<span class="ident" id="5223793">int64</span><span class="op" id="5223798">(</span><span class="ident" id="5223799"><a href="/archive/tar/reader.go.html#5223629">n</a></span><span class="op" id="5223800">)</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223804">if</span>&nbsp;<span class="ident" id="5223807"><a href="/archive/tar/reader.go.html#5223636">err</a></span>&nbsp;<span class="op" id="5223811">==</span>&nbsp;<span class="ident" id="5223814"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5223816">.</span><span class="ident" id="5223817">EOF</span>&nbsp;<span class="op" id="5223821">&amp;&amp;</span>&nbsp;<span class="ident" id="5223824"><a href="/archive/tar/reader.go.html#5223593">rfr</a></span><span class="op" id="5223827">.</span><span class="ident" id="5223828">nb</span>&nbsp;<span class="op" id="5223831">&gt;</span>&nbsp;<span class="num" id="5223833">0</span>&nbsp;<span class="op" id="5223835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5223839"><a href="/archive/tar/reader.go.html#5223636">err</a></span>&nbsp;<span class="op" id="5223843">=</span>&nbsp;<span class="ident" id="5223845"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5223847">.</span><span class="ident" id="5223848">ErrUnexpectedEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5223866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5223869">return</span><br>
<span class="lineno">755</span><span class="op" id="5223876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5223879">//&nbsp;numBytes&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;left&nbsp;to&nbsp;read&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;data&nbsp;in&nbsp;the&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="keyword" id="5223971">func</span>&nbsp;<span class="op" id="5223976">(</span><span class="ident" id="5223977">rfr</span>&nbsp;<span class="op" id="5223981">*</span><span class="ident" id="5223982"><a href="/archive/tar/reader.go.html#5204345">regFileReader</a></span><span class="op" id="5223995">)</span>&nbsp;<span class="ident" id="5223997">numBytes</span><span class="op" id="5224005">(</span><span class="op" id="5224006">)</span>&nbsp;<span class="ident" id="5224008">int64</span>&nbsp;<span class="op" id="5224014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5224017">return</span>&nbsp;<span class="ident" id="5224024"><a href="/archive/tar/reader.go.html#5223977">rfr</a></span><span class="op" id="5224027">.</span><span class="ident" id="5224028">nb</span><br>
<span class="lineno">760</span><span class="op" id="5224031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5224034">//&nbsp;readHole&nbsp;reads&nbsp;a&nbsp;sparse&nbsp;file&nbsp;hole&nbsp;ending&nbsp;at&nbsp;offset&nbsp;toOffset</span><br>
<span class="lineno"></span><span class="keyword" id="5224097">func</span>&nbsp;<span class="op" id="5224102">(</span><span class="ident" id="5224103">sfr</span>&nbsp;<span class="op" id="5224107">*</span><span class="ident" id="5224108"><a href="/archive/tar/reader.go.html#5204565">sparseFileReader</a></span><span class="op" id="5224124">)</span>&nbsp;<span class="ident" id="5224126">readHole</span><span class="op" id="5224134">(</span><span class="ident" id="5224135">b</span>&nbsp;<span class="op" id="5224137">[</span><span class="op" id="5224138">]</span><span class="builtintype" id="5224139">byte</span><span class="op" id="5224143">,</span>&nbsp;<span class="ident" id="5224145">toOffset</span>&nbsp;<span class="ident" id="5224154">int64</span><span class="op" id="5224159">)</span>&nbsp;<span class="builtintype" id="5224161">int</span>&nbsp;<span class="op" id="5224165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5224168">n64</span>&nbsp;<span class="op" id="5224172">:=</span>&nbsp;<span class="ident" id="5224175"><a href="/archive/tar/reader.go.html#5224145">toOffset</a></span>&nbsp;<span class="op" id="5224184">-</span>&nbsp;<span class="ident" id="5224186"><a href="/archive/tar/reader.go.html#5224103">sfr</a></span><span class="op" id="5224189">.</span><span class="ident" id="5224190">pos</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5224195">if</span>&nbsp;<span class="ident" id="5224198"><a href="/archive/tar/reader.go.html#5224168">n64</a></span>&nbsp;<span class="op" id="5224202">&gt;</span>&nbsp;<span class="ident" id="5224204">int64</span><span class="op" id="5224209">(</span><span class="builtinfunc" id="5224210">len</span><span class="op" id="5224213">(</span><span class="ident" id="5224214"><a href="/archive/tar/reader.go.html#5224135">b</a></span><span class="op" id="5224215">)</span><span class="op" id="5224216">)</span>&nbsp;<span class="op" id="5224218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5224222"><a href="/archive/tar/reader.go.html#5224168">n64</a></span>&nbsp;<span class="op" id="5224226">=</span>&nbsp;<span class="ident" id="5224228">int64</span><span class="op" id="5224233">(</span><span class="builtinfunc" id="5224234">len</span><span class="op" id="5224237">(</span><span class="ident" id="5224238"><a href="/archive/tar/reader.go.html#5224135">b</a></span><span class="op" id="5224239">)</span><span class="op" id="5224240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5224243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5224246">n</span>&nbsp;<span class="op" id="5224248">:=</span>&nbsp;<span class="builtintype" id="5224251">int</span><span class="op" id="5224254">(</span><span class="ident" id="5224255"><a href="/archive/tar/reader.go.html#5224168">n64</a></span><span class="op" id="5224258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5224261">for</span>&nbsp;<span class="ident" id="5224265">i</span>&nbsp;<span class="op" id="5224267">:=</span>&nbsp;<span class="num" id="5224270">0</span><span class="op" id="5224271">;</span>&nbsp;<span class="ident" id="5224273"><a href="/archive/tar/reader.go.html#5224265">i</a></span>&nbsp;<span class="op" id="5224275">&lt;</span>&nbsp;<span class="ident" id="5224277"><a href="/archive/tar/reader.go.html#5224246">n</a></span><span class="op" id="5224278">;</span>&nbsp;<span class="ident" id="5224280"><a href="/archive/tar/reader.go.html#5224265">i</a></span><span class="op" id="5224281">++</span>&nbsp;<span class="op" id="5224284">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5224288"><a href="/archive/tar/reader.go.html#5224135">b</a></span><span class="op" id="5224289">[</span><span class="ident" id="5224290"><a href="/archive/tar/reader.go.html#5224265">i</a></span><span class="op" id="5224291">]</span>&nbsp;<span class="op" id="5224293">=</span>&nbsp;<span class="num" id="5224295">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5224298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5224301"><a href="/archive/tar/reader.go.html#5224103">sfr</a></span><span class="op" id="5224304">.</span><span class="ident" id="5224305">pos</span>&nbsp;<span class="op" id="5224309">+=</span>&nbsp;<span class="ident" id="5224312"><a href="/archive/tar/reader.go.html#5224168">n64</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5224317">return</span>&nbsp;<span class="ident" id="5224324"><a href="/archive/tar/reader.go.html#5224246">n</a></span><br>
<span class="lineno"></span><span class="op" id="5224326">}</span><br>
<span class="lineno">775</span><br>
<span class="lineno"></span><span class="comment" id="5224329">//&nbsp;Read&nbsp;reads&nbsp;the&nbsp;sparse&nbsp;file&nbsp;data&nbsp;in&nbsp;expanded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="5224382">func</span>&nbsp;<span class="op" id="5224387">(</span><span class="ident" id="5224388">sfr</span>&nbsp;<span class="op" id="5224392">*</span><span class="ident" id="5224393"><a href="/archive/tar/reader.go.html#5204565">sparseFileReader</a></span><span class="op" id="5224409">)</span>&nbsp;<span class="ident" id="5224411">Read</span><span class="op" id="5224415">(</span><span class="ident" id="5224416">b</span>&nbsp;<span class="op" id="5224418">[</span><span class="op" id="5224419">]</span><span class="builtintype" id="5224420">byte</span><span class="op" id="5224424">)</span>&nbsp;<span class="op" id="5224426">(</span><span class="ident" id="5224427">n</span>&nbsp;<span class="builtintype" id="5224429">int</span><span class="op" id="5224432">,</span>&nbsp;<span class="ident" id="5224434">err</span>&nbsp;<span class="builtintype" id="5224438">error</span><span class="op" id="5224443">)</span>&nbsp;<span class="op" id="5224445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5224448">if</span>&nbsp;<span class="builtinfunc" id="5224451">len</span><span class="op" id="5224454">(</span><span class="ident" id="5224455"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5224458">.</span><span class="ident" id="5224459">sp</span><span class="op" id="5224461">)</span>&nbsp;<span class="op" id="5224463">==</span>&nbsp;<span class="num" id="5224466">0</span>&nbsp;<span class="op" id="5224468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5224472">//&nbsp;No&nbsp;more&nbsp;data&nbsp;fragments&nbsp;to&nbsp;read&nbsp;from.</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5224514">if</span>&nbsp;<span class="ident" id="5224517"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5224520">.</span><span class="ident" id="5224521">pos</span>&nbsp;<span class="op" id="5224525">&lt;</span>&nbsp;<span class="ident" id="5224527"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5224530">.</span><span class="ident" id="5224531">tot</span>&nbsp;<span class="op" id="5224535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5224540">//&nbsp;We&#39;re&nbsp;in&nbsp;the&nbsp;last&nbsp;hole</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5224569"><a href="/archive/tar/reader.go.html#5224427">n</a></span>&nbsp;<span class="op" id="5224571">=</span>&nbsp;<span class="ident" id="5224573"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5224576">.</span><span class="ident" id="5224577">readHole</span><span class="op" id="5224585">(</span><span class="ident" id="5224586"><a href="/archive/tar/reader.go.html#5224416">b</a></span><span class="op" id="5224587">,</span>&nbsp;<span class="ident" id="5224589"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5224592">.</span><span class="ident" id="5224593">tot</span><span class="op" id="5224596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5224601">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5224610">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5224614">//&nbsp;Otherwise,&nbsp;we&#39;re&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5224659">return</span>&nbsp;<span class="num" id="5224666">0</span><span class="op" id="5224667">,</span>&nbsp;<span class="ident" id="5224669"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5224671">.</span><span class="ident" id="5224672">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5224677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5224680">if</span>&nbsp;<span class="ident" id="5224683"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5224686">.</span><span class="ident" id="5224687">pos</span>&nbsp;<span class="op" id="5224691">&lt;</span>&nbsp;<span class="ident" id="5224693"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5224696">.</span><span class="ident" id="5224697">sp</span><span class="op" id="5224699">[</span><span class="num" id="5224700">0</span><span class="op" id="5224701">]</span><span class="op" id="5224702">.</span><span class="ident" id="5224703">offset</span>&nbsp;<span class="op" id="5224710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5224714">//&nbsp;We&#39;re&nbsp;in&nbsp;a&nbsp;hole</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5224735"><a href="/archive/tar/reader.go.html#5224427">n</a></span>&nbsp;<span class="op" id="5224737">=</span>&nbsp;<span class="ident" id="5224739"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5224742">.</span><span class="ident" id="5224743">readHole</span><span class="op" id="5224751">(</span><span class="ident" id="5224752"><a href="/archive/tar/reader.go.html#5224416">b</a></span><span class="op" id="5224753">,</span>&nbsp;<span class="ident" id="5224755"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5224758">.</span><span class="ident" id="5224759">sp</span><span class="op" id="5224761">[</span><span class="num" id="5224762">0</span><span class="op" id="5224763">]</span><span class="op" id="5224764">.</span><span class="ident" id="5224765">offset</span><span class="op" id="5224771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5224775">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5224783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5224787">//&nbsp;We&#39;re&nbsp;not&nbsp;in&nbsp;a&nbsp;hole,&nbsp;so&nbsp;we&#39;ll&nbsp;read&nbsp;from&nbsp;the&nbsp;next&nbsp;data&nbsp;fragment</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5224854">posInFragment</span>&nbsp;<span class="op" id="5224868">:=</span>&nbsp;<span class="ident" id="5224871"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5224874">.</span><span class="ident" id="5224875">pos</span>&nbsp;<span class="op" id="5224879">-</span>&nbsp;<span class="ident" id="5224881"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5224884">.</span><span class="ident" id="5224885">sp</span><span class="op" id="5224887">[</span><span class="num" id="5224888">0</span><span class="op" id="5224889">]</span><span class="op" id="5224890">.</span><span class="ident" id="5224891">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5224899">bytesLeft</span>&nbsp;<span class="op" id="5224909">:=</span>&nbsp;<span class="ident" id="5224912"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5224915">.</span><span class="ident" id="5224916">sp</span><span class="op" id="5224918">[</span><span class="num" id="5224919">0</span><span class="op" id="5224920">]</span><span class="op" id="5224921">.</span><span class="ident" id="5224922">numBytes</span>&nbsp;<span class="op" id="5224931">-</span>&nbsp;<span class="ident" id="5224933"><a href="/archive/tar/reader.go.html#5224854">posInFragment</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5224948">if</span>&nbsp;<span class="ident" id="5224951">int64</span><span class="op" id="5224956">(</span><span class="builtinfunc" id="5224957">len</span><span class="op" id="5224960">(</span><span class="ident" id="5224961"><a href="/archive/tar/reader.go.html#5224416">b</a></span><span class="op" id="5224962">)</span><span class="op" id="5224963">)</span>&nbsp;<span class="op" id="5224965">&gt;</span>&nbsp;<span class="ident" id="5224967"><a href="/archive/tar/reader.go.html#5224899">bytesLeft</a></span>&nbsp;<span class="op" id="5224977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5224981"><a href="/archive/tar/reader.go.html#5224416">b</a></span>&nbsp;<span class="op" id="5224983">=</span>&nbsp;<span class="ident" id="5224985"><a href="/archive/tar/reader.go.html#5224416">b</a></span><span class="op" id="5224986">[</span><span class="num" id="5224987">0</span><span class="op" id="5224988">:</span><span class="ident" id="5224989"><a href="/archive/tar/reader.go.html#5224899">bytesLeft</a></span><span class="op" id="5224998">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5225001">}</span><br>
<span class="lineno">800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5225005"><a href="/archive/tar/reader.go.html#5224427">n</a></span><span class="op" id="5225006">,</span>&nbsp;<span class="ident" id="5225008"><a href="/archive/tar/reader.go.html#5224434">err</a></span>&nbsp;<span class="op" id="5225012">=</span>&nbsp;<span class="ident" id="5225014"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5225017">.</span><span class="ident" id="5225018">rfr</span><span class="op" id="5225021">.</span><span class="ident" id="5225022">Read</span><span class="op" id="5225026">(</span><span class="ident" id="5225027"><a href="/archive/tar/reader.go.html#5224416">b</a></span><span class="op" id="5225028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5225031"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5225034">.</span><span class="ident" id="5225035">pos</span>&nbsp;<span class="op" id="5225039">+=</span>&nbsp;<span class="ident" id="5225042">int64</span><span class="op" id="5225047">(</span><span class="ident" id="5225048"><a href="/archive/tar/reader.go.html#5224427">n</a></span><span class="op" id="5225049">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5225053">if</span>&nbsp;<span class="ident" id="5225056">int64</span><span class="op" id="5225061">(</span><span class="ident" id="5225062"><a href="/archive/tar/reader.go.html#5224427">n</a></span><span class="op" id="5225063">)</span>&nbsp;<span class="op" id="5225065">==</span>&nbsp;<span class="ident" id="5225068"><a href="/archive/tar/reader.go.html#5224899">bytesLeft</a></span>&nbsp;<span class="op" id="5225078">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5225082">//&nbsp;We&#39;re&nbsp;done&nbsp;with&nbsp;this&nbsp;fragment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5225117"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5225120">.</span><span class="ident" id="5225121">sp</span>&nbsp;<span class="op" id="5225124">=</span>&nbsp;<span class="ident" id="5225126"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5225129">.</span><span class="ident" id="5225130">sp</span><span class="op" id="5225132">[</span><span class="num" id="5225133">1</span><span class="op" id="5225134">:</span><span class="op" id="5225135">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5225138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5225142">if</span>&nbsp;<span class="ident" id="5225145"><a href="/archive/tar/reader.go.html#5224434">err</a></span>&nbsp;<span class="op" id="5225149">==</span>&nbsp;<span class="ident" id="5225152"><a href="/archive/tar/reader.go.html#5203371">io</a></span><span class="op" id="5225154">.</span><span class="ident" id="5225155">EOF</span>&nbsp;<span class="op" id="5225159">&amp;&amp;</span>&nbsp;<span class="ident" id="5225162"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5225165">.</span><span class="ident" id="5225166">pos</span>&nbsp;<span class="op" id="5225170">&lt;</span>&nbsp;<span class="ident" id="5225172"><a href="/archive/tar/reader.go.html#5224388">sfr</a></span><span class="op" id="5225175">.</span><span class="ident" id="5225176">tot</span>&nbsp;<span class="op" id="5225180">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5225184">//&nbsp;We&nbsp;reached&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;last&nbsp;fragment&#39;s&nbsp;data,&nbsp;but&nbsp;there&#39;s&nbsp;a&nbsp;final&nbsp;hole</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5225262"><a href="/archive/tar/reader.go.html#5224434">err</a></span>&nbsp;<span class="op" id="5225266">=</span>&nbsp;<span class="ident" id="5225268">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5225273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5225276">return</span><br>
<span class="lineno"></span><span class="op" id="5225283">}</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="comment" id="5225286">//&nbsp;numBytes&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;left&nbsp;to&nbsp;read&nbsp;in&nbsp;the&nbsp;sparse&nbsp;file&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5225360">//&nbsp;sparse-encoded&nbsp;data&nbsp;in&nbsp;the&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="keyword" id="5225403">func</span>&nbsp;<span class="op" id="5225408">(</span><span class="ident" id="5225409">sfr</span>&nbsp;<span class="op" id="5225413">*</span><span class="ident" id="5225414"><a href="/archive/tar/reader.go.html#5204565">sparseFileReader</a></span><span class="op" id="5225430">)</span>&nbsp;<span class="ident" id="5225432">numBytes</span><span class="op" id="5225440">(</span><span class="op" id="5225441">)</span>&nbsp;<span class="ident" id="5225443">int64</span>&nbsp;<span class="op" id="5225449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5225452">return</span>&nbsp;<span class="ident" id="5225459"><a href="/archive/tar/reader.go.html#5225409">sfr</a></span><span class="op" id="5225462">.</span><span class="ident" id="5225463">rfr</span><span class="op" id="5225466">.</span><span class="ident" id="5225467">nb</span><br>
<span class="lineno">820</span><span class="op" id="5225470">}</span>
</div>
</body>
</html>
