<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4302640">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4302695">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4302749">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4302800">package</span>&nbsp;<span class="ident" id="4302808">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4302814">import</span>&nbsp;<span class="op" id="4302821">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4302824">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4302831">&#34;net&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4302838">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4302849">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4302860">&#34;time&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4302868">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4302883">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4302886">type</span>&nbsp;<span class="ident" id="4302891">InvalidReason</span>&nbsp;<span class="builtintype" id="4302905">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4302910">const</span>&nbsp;<span class="op" id="4302916">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4302919">//&nbsp;NotAuthorizedToSign&nbsp;results&nbsp;when&nbsp;a&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;another</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4302991">//&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303035">NotAuthorizedToSign</span>&nbsp;<span class="ident" id="4303055"><a href="/crypto/x509/verify.go.html#4302891">InvalidReason</a></span>&nbsp;<span class="op" id="4303069">=</span>&nbsp;<span class="ident" id="4303071">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4303077">//&nbsp;Expired&nbsp;results&nbsp;when&nbsp;a&nbsp;certificate&nbsp;has&nbsp;expired,&nbsp;based&nbsp;on&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4303147">//&nbsp;given&nbsp;in&nbsp;the&nbsp;VerifyOptions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303179">Expired</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4303188">//&nbsp;CANotAuthorizedForThisName&nbsp;results&nbsp;when&nbsp;an&nbsp;intermediate&nbsp;or&nbsp;root</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4303256">//&nbsp;certificate&nbsp;has&nbsp;a&nbsp;name&nbsp;constraint&nbsp;which&nbsp;doesn&#39;t&nbsp;include&nbsp;the&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4303325">//&nbsp;being&nbsp;checked.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303344">CANotAuthorizedForThisName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4303372">//&nbsp;TooManyIntermediates&nbsp;results&nbsp;when&nbsp;a&nbsp;path&nbsp;length&nbsp;constraint&nbsp;is</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4303438">//&nbsp;violated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303452">TooManyIntermediates</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4303474">//&nbsp;IncompatibleUsage&nbsp;results&nbsp;when&nbsp;the&nbsp;certificate&#39;s&nbsp;key&nbsp;usage&nbsp;indicates</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4303547">//&nbsp;that&nbsp;it&nbsp;may&nbsp;only&nbsp;be&nbsp;used&nbsp;for&nbsp;a&nbsp;different&nbsp;purpose.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303601">IncompatibleUsage</span><br>
<span class="lineno">35</span><span class="op" id="4303619">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4303622">//&nbsp;CertificateInvalidError&nbsp;results&nbsp;when&nbsp;an&nbsp;odd&nbsp;error&nbsp;occurs.&nbsp;Users&nbsp;of&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="4303697">//&nbsp;library&nbsp;probably&nbsp;want&nbsp;to&nbsp;handle&nbsp;all&nbsp;these&nbsp;errors&nbsp;uniformly.</span><br>
<span class="lineno"></span><span class="keyword" id="4303760">type</span>&nbsp;<span class="ident" id="4303765">CertificateInvalidError</span>&nbsp;<span class="keyword" id="4303789">struct</span>&nbsp;<span class="op" id="4303796">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303799">Cert</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4303806">*</span><span class="ident" id="4303807"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4303820">Reason</span>&nbsp;<span class="ident" id="4303827"><a href="/crypto/x509/verify.go.html#4302891">InvalidReason</a></span><br>
<span class="lineno"></span><span class="op" id="4303841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4303844">func</span>&nbsp;<span class="op" id="4303849">(</span><span class="ident" id="4303850">e</span>&nbsp;<span class="ident" id="4303852"><a href="/crypto/x509/verify.go.html#4303765">CertificateInvalidError</a></span><span class="op" id="4303875">)</span>&nbsp;<span class="ident" id="4303877">Error</span><span class="op" id="4303882">(</span><span class="op" id="4303883">)</span>&nbsp;<span class="builtintype" id="4303885">string</span>&nbsp;<span class="op" id="4303892">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4303895">switch</span>&nbsp;<span class="ident" id="4303902"><a href="/crypto/x509/verify.go.html#4303850">e</a></span><span class="op" id="4303903">.</span><span class="ident" id="4303904">Reason</span>&nbsp;<span class="op" id="4303911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4303914">case</span>&nbsp;<span class="ident" id="4303919"><a href="/crypto/x509/verify.go.html#4303035">NotAuthorizedToSign</a></span><span class="op" id="4303938">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4303942">return</span>&nbsp;<span class="string" id="4303949">&#34;x509:&nbsp;certificate&nbsp;is&nbsp;not&nbsp;authorized&nbsp;to&nbsp;sign&nbsp;other&nbsp;certificates&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304015">case</span>&nbsp;<span class="ident" id="4304020"><a href="/crypto/x509/verify.go.html#4303179">Expired</a></span><span class="op" id="4304027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304031">return</span>&nbsp;<span class="string" id="4304038">&#34;x509:&nbsp;certificate&nbsp;has&nbsp;expired&nbsp;or&nbsp;is&nbsp;not&nbsp;yet&nbsp;valid&#34;</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304091">case</span>&nbsp;<span class="ident" id="4304096"><a href="/crypto/x509/verify.go.html#4303344">CANotAuthorizedForThisName</a></span><span class="op" id="4304122">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304126">return</span>&nbsp;<span class="string" id="4304133">&#34;x509:&nbsp;a&nbsp;root&nbsp;or&nbsp;intermediate&nbsp;certificate&nbsp;is&nbsp;not&nbsp;authorized&nbsp;to&nbsp;sign&nbsp;in&nbsp;this&nbsp;domain&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304218">case</span>&nbsp;<span class="ident" id="4304223"><a href="/crypto/x509/verify.go.html#4303452">TooManyIntermediates</a></span><span class="op" id="4304243">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304247">return</span>&nbsp;<span class="string" id="4304254">&#34;x509:&nbsp;too&nbsp;many&nbsp;intermediates&nbsp;for&nbsp;path&nbsp;length&nbsp;constraint&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304313">case</span>&nbsp;<span class="ident" id="4304318"><a href="/crypto/x509/verify.go.html#4303601">IncompatibleUsage</a></span><span class="op" id="4304335">:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304339">return</span>&nbsp;<span class="string" id="4304346">&#34;x509:&nbsp;certificate&nbsp;specifies&nbsp;an&nbsp;incompatible&nbsp;key&nbsp;usage&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4304403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304406">return</span>&nbsp;<span class="string" id="4304413">&#34;x509:&nbsp;unknown&nbsp;error&#34;</span><br>
<span class="lineno"></span><span class="op" id="4304435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="4304438">//&nbsp;HostnameError&nbsp;results&nbsp;when&nbsp;the&nbsp;set&nbsp;of&nbsp;authorized&nbsp;names&nbsp;doesn&#39;t&nbsp;match&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4304514">//&nbsp;requested&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4304533">type</span>&nbsp;<span class="ident" id="4304538">HostnameError</span>&nbsp;<span class="keyword" id="4304552">struct</span>&nbsp;<span class="op" id="4304559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4304562">Certificate</span>&nbsp;<span class="op" id="4304574">*</span><span class="ident" id="4304575"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4304588">Host</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4304600">string</span><br>
<span class="lineno">65</span><span class="op" id="4304607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4304610">func</span>&nbsp;<span class="op" id="4304615">(</span><span class="ident" id="4304616">h</span>&nbsp;<span class="ident" id="4304618"><a href="/crypto/x509/verify.go.html#4304538">HostnameError</a></span><span class="op" id="4304631">)</span>&nbsp;<span class="ident" id="4304633">Error</span><span class="op" id="4304638">(</span><span class="op" id="4304639">)</span>&nbsp;<span class="builtintype" id="4304641">string</span>&nbsp;<span class="op" id="4304648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4304651">c</span>&nbsp;<span class="op" id="4304653">:=</span>&nbsp;<span class="ident" id="4304656"><a href="/crypto/x509/verify.go.html#4304616">h</a></span><span class="op" id="4304657">.</span><span class="ident" id="4304658">Certificate</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304672">var</span>&nbsp;<span class="ident" id="4304676">valid</span>&nbsp;<span class="builtintype" id="4304682">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304690">if</span>&nbsp;<span class="ident" id="4304693">ip</span>&nbsp;<span class="op" id="4304696">:=</span>&nbsp;<span class="ident" id="4304699"><a href="/crypto/x509/verify.go.html#4302831">net</a></span><span class="op" id="4304702">.</span><span class="ident" id="4304703">ParseIP</span><span class="op" id="4304710">(</span><span class="ident" id="4304711"><a href="/crypto/x509/verify.go.html#4304616">h</a></span><span class="op" id="4304712">.</span><span class="ident" id="4304713">Host</span><span class="op" id="4304717">)</span><span class="op" id="4304718">;</span>&nbsp;<span class="ident" id="4304720"><a href="/crypto/x509/verify.go.html#4304693">ip</a></span>&nbsp;<span class="op" id="4304723">!=</span>&nbsp;<span class="ident" id="4304726">nil</span>&nbsp;<span class="op" id="4304730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4304734">//&nbsp;Trying&nbsp;to&nbsp;validate&nbsp;an&nbsp;IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304764">if</span>&nbsp;<span class="builtinfunc" id="4304767">len</span><span class="op" id="4304770">(</span><span class="ident" id="4304771"><a href="/crypto/x509/verify.go.html#4304651">c</a></span><span class="op" id="4304772">.</span><span class="ident" id="4304773">IPAddresses</span><span class="op" id="4304784">)</span>&nbsp;<span class="op" id="4304786">==</span>&nbsp;<span class="num" id="4304789">0</span>&nbsp;<span class="op" id="4304791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304796">return</span>&nbsp;<span class="string" id="4304803">&#34;x509:&nbsp;cannot&nbsp;validate&nbsp;certificate&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="4304844">+</span>&nbsp;<span class="ident" id="4304846"><a href="/crypto/x509/verify.go.html#4304616">h</a></span><span class="op" id="4304847">.</span><span class="ident" id="4304848">Host</span>&nbsp;<span class="op" id="4304853">+</span>&nbsp;<span class="string" id="4304855">&#34;&nbsp;because&nbsp;it&nbsp;doesn&#39;t&nbsp;contain&nbsp;any&nbsp;IP&nbsp;SANs&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4304899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304903">for</span>&nbsp;<span class="ident" id="4304907">_</span><span class="op" id="4304908">,</span>&nbsp;<span class="ident" id="4304910">san</span>&nbsp;<span class="op" id="4304914">:=</span>&nbsp;<span class="keyword" id="4304917">range</span>&nbsp;<span class="ident" id="4304923"><a href="/crypto/x509/verify.go.html#4304651">c</a></span><span class="op" id="4304924">.</span><span class="ident" id="4304925">IPAddresses</span>&nbsp;<span class="op" id="4304937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4304942">if</span>&nbsp;<span class="builtinfunc" id="4304945">len</span><span class="op" id="4304948">(</span><span class="ident" id="4304949"><a href="/crypto/x509/verify.go.html#4304676">valid</a></span><span class="op" id="4304954">)</span>&nbsp;<span class="op" id="4304956">&gt;</span>&nbsp;<span class="num" id="4304958">0</span>&nbsp;<span class="op" id="4304960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4304966"><a href="/crypto/x509/verify.go.html#4304676">valid</a></span>&nbsp;<span class="op" id="4304972">+=</span>&nbsp;<span class="string" id="4304975">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4304983">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4304988"><a href="/crypto/x509/verify.go.html#4304676">valid</a></span>&nbsp;<span class="op" id="4304994">+=</span>&nbsp;<span class="ident" id="4304997"><a href="/crypto/x509/verify.go.html#4304910">san</a></span><span class="op" id="4305000">.</span><span class="ident" id="4305001">String</span><span class="op" id="4305007">(</span><span class="op" id="4305008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305015">}</span>&nbsp;<span class="keyword" id="4305017">else</span>&nbsp;<span class="op" id="4305022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305026">if</span>&nbsp;<span class="builtinfunc" id="4305029">len</span><span class="op" id="4305032">(</span><span class="ident" id="4305033"><a href="/crypto/x509/verify.go.html#4304651">c</a></span><span class="op" id="4305034">.</span><span class="ident" id="4305035">DNSNames</span><span class="op" id="4305043">)</span>&nbsp;<span class="op" id="4305045">&gt;</span>&nbsp;<span class="num" id="4305047">0</span>&nbsp;<span class="op" id="4305049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305054"><a href="/crypto/x509/verify.go.html#4304676">valid</a></span>&nbsp;<span class="op" id="4305060">=</span>&nbsp;<span class="ident" id="4305062"><a href="/crypto/x509/verify.go.html#4302849">strings</a></span><span class="op" id="4305069">.</span><span class="ident" id="4305070">Join</span><span class="op" id="4305074">(</span><span class="ident" id="4305075"><a href="/crypto/x509/verify.go.html#4304651">c</a></span><span class="op" id="4305076">.</span><span class="ident" id="4305077">DNSNames</span><span class="op" id="4305085">,</span>&nbsp;<span class="string" id="4305087">&#34;,&nbsp;&#34;</span><span class="op" id="4305091">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305095">}</span>&nbsp;<span class="keyword" id="4305097">else</span>&nbsp;<span class="op" id="4305102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305107"><a href="/crypto/x509/verify.go.html#4304676">valid</a></span>&nbsp;<span class="op" id="4305113">=</span>&nbsp;<span class="ident" id="4305115"><a href="/crypto/x509/verify.go.html#4304651">c</a></span><span class="op" id="4305116">.</span><span class="ident" id="4305117">Subject</span><span class="op" id="4305124">.</span><span class="ident" id="4305125">CommonName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305144">return</span>&nbsp;<span class="string" id="4305151">&#34;x509:&nbsp;certificate&nbsp;is&nbsp;valid&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="4305185">+</span>&nbsp;<span class="ident" id="4305187"><a href="/crypto/x509/verify.go.html#4304676">valid</a></span>&nbsp;<span class="op" id="4305193">+</span>&nbsp;<span class="string" id="4305195">&#34;,&nbsp;not&nbsp;&#34;</span>&nbsp;<span class="op" id="4305204">+</span>&nbsp;<span class="ident" id="4305206"><a href="/crypto/x509/verify.go.html#4304616">h</a></span><span class="op" id="4305207">.</span><span class="ident" id="4305208">Host</span><br>
<span class="lineno">90</span><span class="op" id="4305213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4305216">//&nbsp;UnknownAuthorityError&nbsp;results&nbsp;when&nbsp;the&nbsp;certificate&nbsp;issuer&nbsp;is&nbsp;unknown</span><br>
<span class="lineno"></span><span class="keyword" id="4305288">type</span>&nbsp;<span class="ident" id="4305293">UnknownAuthorityError</span>&nbsp;<span class="keyword" id="4305315">struct</span>&nbsp;<span class="op" id="4305322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305325">cert</span>&nbsp;<span class="op" id="4305330">*</span><span class="ident" id="4305331"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4305344">//&nbsp;hintErr&nbsp;contains&nbsp;an&nbsp;error&nbsp;that&nbsp;may&nbsp;be&nbsp;helpful&nbsp;in&nbsp;determining&nbsp;why&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4305416">//&nbsp;authority&nbsp;wasn&#39;t&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305444">hintErr</span>&nbsp;<span class="builtintype" id="4305452">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4305459">//&nbsp;hintCert&nbsp;contains&nbsp;a&nbsp;possible&nbsp;authority&nbsp;certificate&nbsp;that&nbsp;was&nbsp;rejected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4305532">//&nbsp;because&nbsp;of&nbsp;the&nbsp;error&nbsp;in&nbsp;hintErr.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305569">hintCert</span>&nbsp;<span class="op" id="4305578">*</span><span class="ident" id="4305579"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><br>
<span class="lineno"></span><span class="op" id="4305591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4305594">func</span>&nbsp;<span class="op" id="4305599">(</span><span class="ident" id="4305600">e</span>&nbsp;<span class="ident" id="4305602"><a href="/crypto/x509/verify.go.html#4305293">UnknownAuthorityError</a></span><span class="op" id="4305623">)</span>&nbsp;<span class="ident" id="4305625">Error</span><span class="op" id="4305630">(</span><span class="op" id="4305631">)</span>&nbsp;<span class="builtintype" id="4305633">string</span>&nbsp;<span class="op" id="4305640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305643">s</span>&nbsp;<span class="op" id="4305645">:=</span>&nbsp;<span class="string" id="4305648">&#34;x509:&nbsp;certificate&nbsp;signed&nbsp;by&nbsp;unknown&nbsp;authority&#34;</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305697">if</span>&nbsp;<span class="ident" id="4305700"><a href="/crypto/x509/verify.go.html#4305600">e</a></span><span class="op" id="4305701">.</span><span class="ident" id="4305702">hintErr</span>&nbsp;<span class="op" id="4305710">!=</span>&nbsp;<span class="ident" id="4305713">nil</span>&nbsp;<span class="op" id="4305717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305721">certName</span>&nbsp;<span class="op" id="4305730">:=</span>&nbsp;<span class="ident" id="4305733"><a href="/crypto/x509/verify.go.html#4305600">e</a></span><span class="op" id="4305734">.</span><span class="ident" id="4305735">hintCert</span><span class="op" id="4305743">.</span><span class="ident" id="4305744">Subject</span><span class="op" id="4305751">.</span><span class="ident" id="4305752">CommonName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305765">if</span>&nbsp;<span class="builtinfunc" id="4305768">len</span><span class="op" id="4305771">(</span><span class="ident" id="4305772"><a href="/crypto/x509/verify.go.html#4305721">certName</a></span><span class="op" id="4305780">)</span>&nbsp;<span class="op" id="4305782">==</span>&nbsp;<span class="num" id="4305785">0</span>&nbsp;<span class="op" id="4305787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4305792">if</span>&nbsp;<span class="builtinfunc" id="4305795">len</span><span class="op" id="4305798">(</span><span class="ident" id="4305799"><a href="/crypto/x509/verify.go.html#4305600">e</a></span><span class="op" id="4305800">.</span><span class="ident" id="4305801">hintCert</span><span class="op" id="4305809">.</span><span class="ident" id="4305810">Subject</span><span class="op" id="4305817">.</span><span class="ident" id="4305818">Organization</span><span class="op" id="4305830">)</span>&nbsp;<span class="op" id="4305832">&gt;</span>&nbsp;<span class="num" id="4305834">0</span>&nbsp;<span class="op" id="4305836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305842"><a href="/crypto/x509/verify.go.html#4305721">certName</a></span>&nbsp;<span class="op" id="4305851">=</span>&nbsp;<span class="ident" id="4305853"><a href="/crypto/x509/verify.go.html#4305600">e</a></span><span class="op" id="4305854">.</span><span class="ident" id="4305855">hintCert</span><span class="op" id="4305863">.</span><span class="ident" id="4305864">Subject</span><span class="op" id="4305871">.</span><span class="ident" id="4305872">Organization</span><span class="op" id="4305884">[</span><span class="num" id="4305885">0</span><span class="op" id="4305886">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305896"><a href="/crypto/x509/verify.go.html#4305721">certName</a></span>&nbsp;<span class="op" id="4305905">=</span>&nbsp;<span class="string" id="4305907">&#34;serial:&#34;</span>&nbsp;<span class="op" id="4305917">+</span>&nbsp;<span class="ident" id="4305919"><a href="/crypto/x509/verify.go.html#4305600">e</a></span><span class="op" id="4305920">.</span><span class="ident" id="4305921">hintCert</span><span class="op" id="4305929">.</span><span class="ident" id="4305930">SerialNumber</span><span class="op" id="4305942">.</span><span class="ident" id="4305943">String</span><span class="op" id="4305949">(</span><span class="op" id="4305950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4305954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4305958"><a href="/crypto/x509/verify.go.html#4305643">s</a></span>&nbsp;<span class="op" id="4305960">+=</span>&nbsp;<span class="ident" id="4305963"><a href="/crypto/x509/verify.go.html#4302824">fmt</a></span><span class="op" id="4305966">.</span><span class="ident" id="4305967">Sprintf</span><span class="op" id="4305974">(</span><span class="string" id="4305975">&#34;&nbsp;(possibly&nbsp;because&nbsp;of&nbsp;%q&nbsp;while&nbsp;trying&nbsp;to&nbsp;verify&nbsp;candidate&nbsp;authority&nbsp;certificate&nbsp;%q)&#34;</span><span class="op" id="4306060">,</span>&nbsp;<span class="ident" id="4306062"><a href="/crypto/x509/verify.go.html#4305600">e</a></span><span class="op" id="4306063">.</span><span class="ident" id="4306064">hintErr</span><span class="op" id="4306071">,</span>&nbsp;<span class="ident" id="4306073"><a href="/crypto/x509/verify.go.html#4305721">certName</a></span><span class="op" id="4306081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4306084">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4306087">return</span>&nbsp;<span class="ident" id="4306094"><a href="/crypto/x509/verify.go.html#4305643">s</a></span><br>
<span class="lineno"></span><span class="op" id="4306096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4306099">//&nbsp;SystemRootsError&nbsp;results&nbsp;when&nbsp;we&nbsp;fail&nbsp;to&nbsp;load&nbsp;the&nbsp;system&nbsp;root&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4306178">type</span>&nbsp;<span class="ident" id="4306183">SystemRootsError</span>&nbsp;<span class="keyword" id="4306200">struct</span><span class="op" id="4306206">{</span><span class="op" id="4306207">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="4306210">func</span>&nbsp;<span class="op" id="4306215">(</span><span class="ident" id="4306216"><a href="/crypto/x509/verify.go.html#4306183">SystemRootsError</a></span><span class="op" id="4306232">)</span>&nbsp;<span class="ident" id="4306234">Error</span><span class="op" id="4306239">(</span><span class="op" id="4306240">)</span>&nbsp;<span class="builtintype" id="4306242">string</span>&nbsp;<span class="op" id="4306249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4306252">return</span>&nbsp;<span class="string" id="4306259">&#34;x509:&nbsp;failed&nbsp;to&nbsp;load&nbsp;system&nbsp;roots&nbsp;and&nbsp;no&nbsp;roots&nbsp;provided&#34;</span><br>
<span class="lineno"></span><span class="op" id="4306317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4306320">//&nbsp;VerifyOptions&nbsp;contains&nbsp;parameters&nbsp;for&nbsp;Certificate.Verify.&nbsp;It&#39;s&nbsp;a&nbsp;structure</span><br>
<span class="lineno"></span><span class="comment" id="4306398">//&nbsp;because&nbsp;other&nbsp;PKIX&nbsp;verification&nbsp;APIs&nbsp;have&nbsp;ended&nbsp;up&nbsp;needing&nbsp;many&nbsp;options.</span><br>
<span class="lineno"></span><span class="keyword" id="4306474">type</span>&nbsp;<span class="ident" id="4306479">VerifyOptions</span>&nbsp;<span class="keyword" id="4306493">struct</span>&nbsp;<span class="op" id="4306500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306503">DNSName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4306517">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306525">Intermediates</span>&nbsp;<span class="op" id="4306539">*</span><span class="ident" id="4306540"><a href="/crypto/x509/cert_pool.go.html#4284435">CertPool</a></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306550">Roots</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4306564">*</span><span class="ident" id="4306565"><a href="/crypto/x509/cert_pool.go.html#4284435">CertPool</a></span>&nbsp;<span class="comment" id="4306574">//&nbsp;if&nbsp;nil,&nbsp;the&nbsp;system&nbsp;roots&nbsp;are&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306612">CurrentTime</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4306626"><a href="/crypto/x509/verify.go.html#4302860">time</a></span><span class="op" id="4306630">.</span><span class="ident" id="4306631">Time</span>&nbsp;<span class="comment" id="4306636">//&nbsp;if&nbsp;zero,&nbsp;the&nbsp;current&nbsp;time&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4306674">//&nbsp;KeyUsage&nbsp;specifies&nbsp;which&nbsp;Extended&nbsp;Key&nbsp;Usage&nbsp;values&nbsp;are&nbsp;acceptable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4306745">//&nbsp;An&nbsp;empty&nbsp;list&nbsp;means&nbsp;ExtKeyUsageServerAuth.&nbsp;Key&nbsp;usage&nbsp;is&nbsp;considered&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4306818">//&nbsp;constraint&nbsp;down&nbsp;the&nbsp;chain&nbsp;which&nbsp;mirrors&nbsp;Windows&nbsp;CryptoAPI&nbsp;behaviour,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4306891">//&nbsp;but&nbsp;not&nbsp;the&nbsp;spec.&nbsp;To&nbsp;accept&nbsp;any&nbsp;key&nbsp;usage,&nbsp;include&nbsp;ExtKeyUsageAny.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306962">KeyUsages</span>&nbsp;<span class="op" id="4306972">[</span><span class="op" id="4306973">]</span><span class="ident" id="4306974"><a href="/crypto/x509/x509.go.html#4329095">ExtKeyUsage</a></span><br>
<span class="lineno"></span><span class="op" id="4306986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4306989">const</span>&nbsp;<span class="op" id="4306995">(</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4306998">leafCertificate</span>&nbsp;<span class="op" id="4307014">=</span>&nbsp;<span class="ident" id="4307016">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307022">intermediateCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307047">rootCertificate</span><br>
<span class="lineno"></span><span class="op" id="4307063">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="4307066">//&nbsp;isValid&nbsp;performs&nbsp;validity&nbsp;checks&nbsp;on&nbsp;the&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="4307112">func</span>&nbsp;<span class="op" id="4307117">(</span><span class="ident" id="4307118">c</span>&nbsp;<span class="op" id="4307120">*</span><span class="ident" id="4307121"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4307132">)</span>&nbsp;<span class="ident" id="4307134">isValid</span><span class="op" id="4307141">(</span><span class="ident" id="4307142">certType</span>&nbsp;<span class="builtintype" id="4307151">int</span><span class="op" id="4307154">,</span>&nbsp;<span class="ident" id="4307156">currentChain</span>&nbsp;<span class="op" id="4307169">[</span><span class="op" id="4307170">]</span><span class="op" id="4307171">*</span><span class="ident" id="4307172"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4307183">,</span>&nbsp;<span class="ident" id="4307185">opts</span>&nbsp;<span class="op" id="4307190">*</span><span class="ident" id="4307191"><a href="/crypto/x509/verify.go.html#4306479">VerifyOptions</a></span><span class="op" id="4307204">)</span>&nbsp;<span class="builtintype" id="4307206">error</span>&nbsp;<span class="op" id="4307212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307215">now</span>&nbsp;<span class="op" id="4307219">:=</span>&nbsp;<span class="ident" id="4307222"><a href="/crypto/x509/verify.go.html#4307185">opts</a></span><span class="op" id="4307226">.</span><span class="ident" id="4307227">CurrentTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307240">if</span>&nbsp;<span class="ident" id="4307243"><a href="/crypto/x509/verify.go.html#4307215">now</a></span><span class="op" id="4307246">.</span><span class="ident" id="4307247">IsZero</span><span class="op" id="4307253">(</span><span class="op" id="4307254">)</span>&nbsp;<span class="op" id="4307256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307260"><a href="/crypto/x509/verify.go.html#4307215">now</a></span>&nbsp;<span class="op" id="4307264">=</span>&nbsp;<span class="ident" id="4307266"><a href="/crypto/x509/verify.go.html#4302860">time</a></span><span class="op" id="4307270">.</span><span class="ident" id="4307271">Now</span><span class="op" id="4307274">(</span><span class="op" id="4307275">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307281">if</span>&nbsp;<span class="ident" id="4307284"><a href="/crypto/x509/verify.go.html#4307215">now</a></span><span class="op" id="4307287">.</span><span class="ident" id="4307288">Before</span><span class="op" id="4307294">(</span><span class="ident" id="4307295"><a href="/crypto/x509/verify.go.html#4307118">c</a></span><span class="op" id="4307296">.</span><span class="ident" id="4307297">NotBefore</span><span class="op" id="4307306">)</span>&nbsp;<span class="op" id="4307308">||</span>&nbsp;<span class="ident" id="4307311"><a href="/crypto/x509/verify.go.html#4307215">now</a></span><span class="op" id="4307314">.</span><span class="ident" id="4307315">After</span><span class="op" id="4307320">(</span><span class="ident" id="4307321"><a href="/crypto/x509/verify.go.html#4307118">c</a></span><span class="op" id="4307322">.</span><span class="ident" id="4307323">NotAfter</span><span class="op" id="4307331">)</span>&nbsp;<span class="op" id="4307333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307337">return</span>&nbsp;<span class="ident" id="4307344"><a href="/crypto/x509/verify.go.html#4303765">CertificateInvalidError</a></span><span class="op" id="4307367">{</span><span class="ident" id="4307368"><a href="/crypto/x509/verify.go.html#4307118">c</a></span><span class="op" id="4307369">,</span>&nbsp;<span class="ident" id="4307371"><a href="/crypto/x509/verify.go.html#4303179">Expired</a></span><span class="op" id="4307378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307385">if</span>&nbsp;<span class="builtinfunc" id="4307388">len</span><span class="op" id="4307391">(</span><span class="ident" id="4307392"><a href="/crypto/x509/verify.go.html#4307118">c</a></span><span class="op" id="4307393">.</span><span class="ident" id="4307394">PermittedDNSDomains</span><span class="op" id="4307413">)</span>&nbsp;<span class="op" id="4307415">&gt;</span>&nbsp;<span class="num" id="4307417">0</span>&nbsp;<span class="op" id="4307419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307423">ok</span>&nbsp;<span class="op" id="4307426">:=</span>&nbsp;<span class="ident" id="4307429">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307437">for</span>&nbsp;<span class="ident" id="4307441">_</span><span class="op" id="4307442">,</span>&nbsp;<span class="ident" id="4307444">domain</span>&nbsp;<span class="op" id="4307451">:=</span>&nbsp;<span class="keyword" id="4307454">range</span>&nbsp;<span class="ident" id="4307460"><a href="/crypto/x509/verify.go.html#4307118">c</a></span><span class="op" id="4307461">.</span><span class="ident" id="4307462">PermittedDNSDomains</span>&nbsp;<span class="op" id="4307482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307487">if</span>&nbsp;<span class="ident" id="4307490"><a href="/crypto/x509/verify.go.html#4307185">opts</a></span><span class="op" id="4307494">.</span><span class="ident" id="4307495">DNSName</span>&nbsp;<span class="op" id="4307503">==</span>&nbsp;<span class="ident" id="4307506"><a href="/crypto/x509/verify.go.html#4307444">domain</a></span>&nbsp;<span class="op" id="4307513">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307520">(</span><span class="ident" id="4307521"><a href="/crypto/x509/verify.go.html#4302849">strings</a></span><span class="op" id="4307528">.</span><span class="ident" id="4307529">HasSuffix</span><span class="op" id="4307538">(</span><span class="ident" id="4307539"><a href="/crypto/x509/verify.go.html#4307185">opts</a></span><span class="op" id="4307543">.</span><span class="ident" id="4307544">DNSName</span><span class="op" id="4307551">,</span>&nbsp;<span class="ident" id="4307553"><a href="/crypto/x509/verify.go.html#4307444">domain</a></span><span class="op" id="4307559">)</span>&nbsp;<span class="op" id="4307561">&amp;&amp;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4307569">len</span><span class="op" id="4307572">(</span><span class="ident" id="4307573"><a href="/crypto/x509/verify.go.html#4307185">opts</a></span><span class="op" id="4307577">.</span><span class="ident" id="4307578">DNSName</span><span class="op" id="4307585">)</span>&nbsp;<span class="op" id="4307587">&gt;=</span>&nbsp;<span class="num" id="4307590">1</span><span class="op" id="4307591">+</span><span class="builtinfunc" id="4307592">len</span><span class="op" id="4307595">(</span><span class="ident" id="4307596"><a href="/crypto/x509/verify.go.html#4307444">domain</a></span><span class="op" id="4307602">)</span>&nbsp;<span class="op" id="4307604">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307612"><a href="/crypto/x509/verify.go.html#4307185">opts</a></span><span class="op" id="4307616">.</span><span class="ident" id="4307617">DNSName</span><span class="op" id="4307624">[</span><span class="builtinfunc" id="4307625">len</span><span class="op" id="4307628">(</span><span class="ident" id="4307629"><a href="/crypto/x509/verify.go.html#4307185">opts</a></span><span class="op" id="4307633">.</span><span class="ident" id="4307634">DNSName</span><span class="op" id="4307641">)</span><span class="op" id="4307642">-</span><span class="builtinfunc" id="4307643">len</span><span class="op" id="4307646">(</span><span class="ident" id="4307647"><a href="/crypto/x509/verify.go.html#4307444">domain</a></span><span class="op" id="4307653">)</span><span class="op" id="4307654">-</span><span class="num" id="4307655">1</span><span class="op" id="4307656">]</span>&nbsp;<span class="op" id="4307658">==</span>&nbsp;<span class="string" id="4307661">&#39;.&#39;</span><span class="op" id="4307664">)</span>&nbsp;<span class="op" id="4307666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4307672"><a href="/crypto/x509/verify.go.html#4307423">ok</a></span>&nbsp;<span class="op" id="4307675">=</span>&nbsp;<span class="ident" id="4307677">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307686">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307695">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307704">if</span>&nbsp;<span class="op" id="4307707">!</span><span class="ident" id="4307708"><a href="/crypto/x509/verify.go.html#4307423">ok</a></span>&nbsp;<span class="op" id="4307711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4307716">return</span>&nbsp;<span class="ident" id="4307723"><a href="/crypto/x509/verify.go.html#4303765">CertificateInvalidError</a></span><span class="op" id="4307746">{</span><span class="ident" id="4307747"><a href="/crypto/x509/verify.go.html#4307118">c</a></span><span class="op" id="4307748">,</span>&nbsp;<span class="ident" id="4307750"><a href="/crypto/x509/verify.go.html#4303344">CANotAuthorizedForThisName</a></span><span class="op" id="4307776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307780">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4307783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4307787">//&nbsp;KeyUsage&nbsp;status&nbsp;flags&nbsp;are&nbsp;ignored.&nbsp;From&nbsp;Engineering&nbsp;Security,&nbsp;Peter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4307859">//&nbsp;Gutmann:&nbsp;A&nbsp;European&nbsp;government&nbsp;CA&nbsp;marked&nbsp;its&nbsp;signing&nbsp;certificates&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4307932">//&nbsp;being&nbsp;valid&nbsp;for&nbsp;encryption&nbsp;only,&nbsp;but&nbsp;no-one&nbsp;noticed.&nbsp;Another</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4307997">//&nbsp;European&nbsp;CA&nbsp;marked&nbsp;its&nbsp;signature&nbsp;keys&nbsp;as&nbsp;not&nbsp;being&nbsp;valid&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4308062">//&nbsp;signatures.&nbsp;A&nbsp;different&nbsp;CA&nbsp;marked&nbsp;its&nbsp;own&nbsp;trusted&nbsp;root&nbsp;certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4308133">//&nbsp;as&nbsp;being&nbsp;invalid&nbsp;for&nbsp;certificate&nbsp;signing.&nbsp;&nbsp;Another&nbsp;national&nbsp;CA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4308200">//&nbsp;distributed&nbsp;a&nbsp;certificate&nbsp;to&nbsp;be&nbsp;used&nbsp;to&nbsp;encrypt&nbsp;data&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4308265">//&nbsp;country’s&nbsp;tax&nbsp;authority&nbsp;that&nbsp;was&nbsp;marked&nbsp;as&nbsp;only&nbsp;being&nbsp;usable&nbsp;for</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4308336">//&nbsp;digital&nbsp;signatures&nbsp;but&nbsp;not&nbsp;for&nbsp;encryption.&nbsp;Yet&nbsp;another&nbsp;CA&nbsp;reversed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4308407">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;bit&nbsp;flags&nbsp;in&nbsp;the&nbsp;keyUsage&nbsp;due&nbsp;to&nbsp;confusion&nbsp;over</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4308476">//&nbsp;encoding&nbsp;endianness,&nbsp;essentially&nbsp;setting&nbsp;a&nbsp;random&nbsp;keyUsage&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4308542">//&nbsp;certificates&nbsp;that&nbsp;it&nbsp;issued.&nbsp;Another&nbsp;CA&nbsp;created&nbsp;a&nbsp;self-invalidating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4308614">//&nbsp;certificate&nbsp;by&nbsp;adding&nbsp;a&nbsp;certificate&nbsp;policy&nbsp;statement&nbsp;stipulating</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4308683">//&nbsp;that&nbsp;the&nbsp;certificate&nbsp;had&nbsp;to&nbsp;be&nbsp;used&nbsp;strictly&nbsp;as&nbsp;specified&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4308752">//&nbsp;keyUsage,&nbsp;and&nbsp;a&nbsp;keyUsage&nbsp;containing&nbsp;a&nbsp;flag&nbsp;indicating&nbsp;that&nbsp;the&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4308823">//&nbsp;encryption&nbsp;key&nbsp;could&nbsp;only&nbsp;be&nbsp;used&nbsp;for&nbsp;Diffie-Hellman&nbsp;key&nbsp;agreement.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4308896">if</span>&nbsp;<span class="ident" id="4308899"><a href="/crypto/x509/verify.go.html#4307142">certType</a></span>&nbsp;<span class="op" id="4308908">==</span>&nbsp;<span class="ident" id="4308911"><a href="/crypto/x509/verify.go.html#4307022">intermediateCertificate</a></span>&nbsp;<span class="op" id="4308935">&amp;&amp;</span>&nbsp;<span class="op" id="4308938">(</span><span class="op" id="4308939">!</span><span class="ident" id="4308940"><a href="/crypto/x509/verify.go.html#4307118">c</a></span><span class="op" id="4308941">.</span><span class="ident" id="4308942">BasicConstraintsValid</span>&nbsp;<span class="op" id="4308964">||</span>&nbsp;<span class="op" id="4308967">!</span><span class="ident" id="4308968"><a href="/crypto/x509/verify.go.html#4307118">c</a></span><span class="op" id="4308969">.</span><span class="ident" id="4308970">IsCA</span><span class="op" id="4308974">)</span>&nbsp;<span class="op" id="4308976">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4308980">return</span>&nbsp;<span class="ident" id="4308987"><a href="/crypto/x509/verify.go.html#4303765">CertificateInvalidError</a></span><span class="op" id="4309010">{</span><span class="ident" id="4309011"><a href="/crypto/x509/verify.go.html#4307118">c</a></span><span class="op" id="4309012">,</span>&nbsp;<span class="ident" id="4309014"><a href="/crypto/x509/verify.go.html#4303035">NotAuthorizedToSign</a></span><span class="op" id="4309033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4309036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309040">if</span>&nbsp;<span class="ident" id="4309043"><a href="/crypto/x509/verify.go.html#4307118">c</a></span><span class="op" id="4309044">.</span><span class="ident" id="4309045">BasicConstraintsValid</span>&nbsp;<span class="op" id="4309067">&amp;&amp;</span>&nbsp;<span class="ident" id="4309070"><a href="/crypto/x509/verify.go.html#4307118">c</a></span><span class="op" id="4309071">.</span><span class="ident" id="4309072">MaxPathLen</span>&nbsp;<span class="op" id="4309083">&gt;=</span>&nbsp;<span class="num" id="4309086">0</span>&nbsp;<span class="op" id="4309088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4309092">numIntermediates</span>&nbsp;<span class="op" id="4309109">:=</span>&nbsp;<span class="builtinfunc" id="4309112">len</span><span class="op" id="4309115">(</span><span class="ident" id="4309116"><a href="/crypto/x509/verify.go.html#4307156">currentChain</a></span><span class="op" id="4309128">)</span>&nbsp;<span class="op" id="4309130">-</span>&nbsp;<span class="num" id="4309132">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309136">if</span>&nbsp;<span class="ident" id="4309139"><a href="/crypto/x509/verify.go.html#4309092">numIntermediates</a></span>&nbsp;<span class="op" id="4309156">&gt;</span>&nbsp;<span class="ident" id="4309158"><a href="/crypto/x509/verify.go.html#4307118">c</a></span><span class="op" id="4309159">.</span><span class="ident" id="4309160">MaxPathLen</span>&nbsp;<span class="op" id="4309171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309176">return</span>&nbsp;<span class="ident" id="4309183"><a href="/crypto/x509/verify.go.html#4303765">CertificateInvalidError</a></span><span class="op" id="4309206">{</span><span class="ident" id="4309207"><a href="/crypto/x509/verify.go.html#4307118">c</a></span><span class="op" id="4309208">,</span>&nbsp;<span class="ident" id="4309210"><a href="/crypto/x509/verify.go.html#4303452">TooManyIntermediates</a></span><span class="op" id="4309230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4309234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4309237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309241">return</span>&nbsp;<span class="ident" id="4309248">nil</span><br>
<span class="lineno"></span><span class="op" id="4309252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4309255">//&nbsp;Verify&nbsp;attempts&nbsp;to&nbsp;verify&nbsp;c&nbsp;by&nbsp;building&nbsp;one&nbsp;or&nbsp;more&nbsp;chains&nbsp;from&nbsp;c&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4309329">//&nbsp;certificate&nbsp;in&nbsp;opts.Roots,&nbsp;using&nbsp;certificates&nbsp;in&nbsp;opts.Intermediates&nbsp;if</span><br>
<span class="lineno">205</span><span class="comment" id="4309403">//&nbsp;needed.&nbsp;If&nbsp;successful,&nbsp;it&nbsp;returns&nbsp;one&nbsp;or&nbsp;more&nbsp;chains&nbsp;where&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="4309475">//&nbsp;element&nbsp;of&nbsp;the&nbsp;chain&nbsp;is&nbsp;c&nbsp;and&nbsp;the&nbsp;last&nbsp;element&nbsp;is&nbsp;from&nbsp;opts.Roots.</span><br>
<span class="lineno"></span><span class="comment" id="4309545">//</span><br>
<span class="lineno"></span><span class="comment" id="4309548">//&nbsp;If&nbsp;opts.Roots&nbsp;is&nbsp;nil&nbsp;and&nbsp;system&nbsp;roots&nbsp;are&nbsp;unavailable&nbsp;the&nbsp;returned&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="4309624">//&nbsp;will&nbsp;be&nbsp;of&nbsp;type&nbsp;SystemRootsError.</span><br>
<span class="lineno">210</span><span class="comment" id="4309661">//</span><br>
<span class="lineno"></span><span class="comment" id="4309664">//&nbsp;WARNING:&nbsp;this&nbsp;doesn&#39;t&nbsp;do&nbsp;any&nbsp;revocation&nbsp;checking.</span><br>
<span class="lineno"></span><span class="keyword" id="4309717">func</span>&nbsp;<span class="op" id="4309722">(</span><span class="ident" id="4309723">c</span>&nbsp;<span class="op" id="4309725">*</span><span class="ident" id="4309726"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4309737">)</span>&nbsp;<span class="ident" id="4309739">Verify</span><span class="op" id="4309745">(</span><span class="ident" id="4309746">opts</span>&nbsp;<span class="ident" id="4309751"><a href="/crypto/x509/verify.go.html#4306479">VerifyOptions</a></span><span class="op" id="4309764">)</span>&nbsp;<span class="op" id="4309766">(</span><span class="ident" id="4309767">chains</span>&nbsp;<span class="op" id="4309774">[</span><span class="op" id="4309775">]</span><span class="op" id="4309776">[</span><span class="op" id="4309777">]</span><span class="op" id="4309778">*</span><span class="ident" id="4309779"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4309790">,</span>&nbsp;<span class="ident" id="4309792">err</span>&nbsp;<span class="builtintype" id="4309796">error</span><span class="op" id="4309801">)</span>&nbsp;<span class="op" id="4309803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4309806">//&nbsp;Use&nbsp;Windows&#39;s&nbsp;own&nbsp;verification&nbsp;and&nbsp;chain&nbsp;building.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309861">if</span>&nbsp;<span class="ident" id="4309864"><a href="/crypto/x509/verify.go.html#4309746">opts</a></span><span class="op" id="4309868">.</span><span class="ident" id="4309869">Roots</span>&nbsp;<span class="op" id="4309875">==</span>&nbsp;<span class="ident" id="4309878">nil</span>&nbsp;<span class="op" id="4309882">&amp;&amp;</span>&nbsp;<span class="ident" id="4309885"><a href="/crypto/x509/verify.go.html#4302838">runtime</a></span><span class="op" id="4309892">.</span><span class="ident" id="4309893">GOOS</span>&nbsp;<span class="op" id="4309898">==</span>&nbsp;<span class="string" id="4309901">&#34;windows&#34;</span>&nbsp;<span class="op" id="4309911">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309915">return</span>&nbsp;<span class="ident" id="4309922"><a href="/crypto/x509/verify.go.html#4309723">c</a></span><span class="op" id="4309923">.</span><span class="ident" id="4309924">systemVerify</span><span class="op" id="4309936">(</span><span class="op" id="4309937">&amp;</span><span class="ident" id="4309938"><a href="/crypto/x509/verify.go.html#4309746">opts</a></span><span class="op" id="4309942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4309945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4309949">if</span>&nbsp;<span class="ident" id="4309952"><a href="/crypto/x509/verify.go.html#4309746">opts</a></span><span class="op" id="4309956">.</span><span class="ident" id="4309957">Roots</span>&nbsp;<span class="op" id="4309963">==</span>&nbsp;<span class="ident" id="4309966">nil</span>&nbsp;<span class="op" id="4309970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4309974"><a href="/crypto/x509/verify.go.html#4309746">opts</a></span><span class="op" id="4309978">.</span><span class="ident" id="4309979">Roots</span>&nbsp;<span class="op" id="4309985">=</span>&nbsp;<span class="ident" id="4309987"><a href="/crypto/x509/root.go.html#4298142">systemRootsPool</a></span><span class="op" id="4310002">(</span><span class="op" id="4310003">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310007">if</span>&nbsp;<span class="ident" id="4310010"><a href="/crypto/x509/verify.go.html#4309746">opts</a></span><span class="op" id="4310014">.</span><span class="ident" id="4310015">Roots</span>&nbsp;<span class="op" id="4310021">==</span>&nbsp;<span class="ident" id="4310024">nil</span>&nbsp;<span class="op" id="4310028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310033">return</span>&nbsp;<span class="ident" id="4310040">nil</span><span class="op" id="4310043">,</span>&nbsp;<span class="ident" id="4310045"><a href="/crypto/x509/verify.go.html#4306183">SystemRootsError</a></span><span class="op" id="4310061">{</span><span class="op" id="4310062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4310066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4310069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310073"><a href="/crypto/x509/verify.go.html#4309792">err</a></span>&nbsp;<span class="op" id="4310077">=</span>&nbsp;<span class="ident" id="4310079"><a href="/crypto/x509/verify.go.html#4309723">c</a></span><span class="op" id="4310080">.</span><span class="ident" id="4310081">isValid</span><span class="op" id="4310088">(</span><span class="ident" id="4310089"><a href="/crypto/x509/verify.go.html#4306998">leafCertificate</a></span><span class="op" id="4310104">,</span>&nbsp;<span class="ident" id="4310106">nil</span><span class="op" id="4310109">,</span>&nbsp;<span class="op" id="4310111">&amp;</span><span class="ident" id="4310112"><a href="/crypto/x509/verify.go.html#4309746">opts</a></span><span class="op" id="4310116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310119">if</span>&nbsp;<span class="ident" id="4310122"><a href="/crypto/x509/verify.go.html#4309792">err</a></span>&nbsp;<span class="op" id="4310126">!=</span>&nbsp;<span class="ident" id="4310129">nil</span>&nbsp;<span class="op" id="4310133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310137">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4310145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310149">if</span>&nbsp;<span class="builtinfunc" id="4310152">len</span><span class="op" id="4310155">(</span><span class="ident" id="4310156"><a href="/crypto/x509/verify.go.html#4309746">opts</a></span><span class="op" id="4310160">.</span><span class="ident" id="4310161">DNSName</span><span class="op" id="4310168">)</span>&nbsp;<span class="op" id="4310170">&gt;</span>&nbsp;<span class="num" id="4310172">0</span>&nbsp;<span class="op" id="4310174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310178"><a href="/crypto/x509/verify.go.html#4309792">err</a></span>&nbsp;<span class="op" id="4310182">=</span>&nbsp;<span class="ident" id="4310184"><a href="/crypto/x509/verify.go.html#4309723">c</a></span><span class="op" id="4310185">.</span><span class="ident" id="4310186">VerifyHostname</span><span class="op" id="4310200">(</span><span class="ident" id="4310201"><a href="/crypto/x509/verify.go.html#4309746">opts</a></span><span class="op" id="4310205">.</span><span class="ident" id="4310206">DNSName</span><span class="op" id="4310213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310217">if</span>&nbsp;<span class="ident" id="4310220"><a href="/crypto/x509/verify.go.html#4309792">err</a></span>&nbsp;<span class="op" id="4310224">!=</span>&nbsp;<span class="ident" id="4310227">nil</span>&nbsp;<span class="op" id="4310231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310236">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4310245">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4310248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310252">candidateChains</span><span class="op" id="4310267">,</span>&nbsp;<span class="ident" id="4310269"><a href="/crypto/x509/verify.go.html#4309792">err</a></span>&nbsp;<span class="op" id="4310273">:=</span>&nbsp;<span class="ident" id="4310276"><a href="/crypto/x509/verify.go.html#4309723">c</a></span><span class="op" id="4310277">.</span><span class="ident" id="4310278">buildChains</span><span class="op" id="4310289">(</span><span class="builtinfunc" id="4310290">make</span><span class="op" id="4310294">(</span><span class="keyword" id="4310295">map</span><span class="op" id="4310298">[</span><span class="builtintype" id="4310299">int</span><span class="op" id="4310302">]</span><span class="op" id="4310303">[</span><span class="op" id="4310304">]</span><span class="op" id="4310305">[</span><span class="op" id="4310306">]</span><span class="op" id="4310307">*</span><span class="ident" id="4310308"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4310319">)</span><span class="op" id="4310320">,</span>&nbsp;<span class="op" id="4310322">[</span><span class="op" id="4310323">]</span><span class="op" id="4310324">*</span><span class="ident" id="4310325"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4310336">{</span><span class="ident" id="4310337"><a href="/crypto/x509/verify.go.html#4309723">c</a></span><span class="op" id="4310338">}</span><span class="op" id="4310339">,</span>&nbsp;<span class="op" id="4310341">&amp;</span><span class="ident" id="4310342"><a href="/crypto/x509/verify.go.html#4309746">opts</a></span><span class="op" id="4310346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310349">if</span>&nbsp;<span class="ident" id="4310352"><a href="/crypto/x509/verify.go.html#4309792">err</a></span>&nbsp;<span class="op" id="4310356">!=</span>&nbsp;<span class="ident" id="4310359">nil</span>&nbsp;<span class="op" id="4310363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310367">return</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4310375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310379">keyUsages</span>&nbsp;<span class="op" id="4310389">:=</span>&nbsp;<span class="ident" id="4310392"><a href="/crypto/x509/verify.go.html#4309746">opts</a></span><span class="op" id="4310396">.</span><span class="ident" id="4310397">KeyUsages</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310408">if</span>&nbsp;<span class="builtinfunc" id="4310411">len</span><span class="op" id="4310414">(</span><span class="ident" id="4310415"><a href="/crypto/x509/verify.go.html#4310379">keyUsages</a></span><span class="op" id="4310424">)</span>&nbsp;<span class="op" id="4310426">==</span>&nbsp;<span class="num" id="4310429">0</span>&nbsp;<span class="op" id="4310431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310435"><a href="/crypto/x509/verify.go.html#4310379">keyUsages</a></span>&nbsp;<span class="op" id="4310445">=</span>&nbsp;<span class="op" id="4310447">[</span><span class="op" id="4310448">]</span><span class="ident" id="4310449"><a href="/crypto/x509/x509.go.html#4329095">ExtKeyUsage</a></span><span class="op" id="4310460">{</span><span class="ident" id="4310461"><a href="/crypto/x509/x509.go.html#4329156">ExtKeyUsageServerAuth</a></span><span class="op" id="4310482">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4310485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4310489">//&nbsp;If&nbsp;any&nbsp;key&nbsp;usage&nbsp;is&nbsp;acceptable&nbsp;then&nbsp;we&#39;re&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310541">for</span>&nbsp;<span class="ident" id="4310545">_</span><span class="op" id="4310546">,</span>&nbsp;<span class="ident" id="4310548">usage</span>&nbsp;<span class="op" id="4310554">:=</span>&nbsp;<span class="keyword" id="4310557">range</span>&nbsp;<span class="ident" id="4310563"><a href="/crypto/x509/verify.go.html#4310379">keyUsages</a></span>&nbsp;<span class="op" id="4310573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310577">if</span>&nbsp;<span class="ident" id="4310580"><a href="/crypto/x509/verify.go.html#4310548">usage</a></span>&nbsp;<span class="op" id="4310586">==</span>&nbsp;<span class="ident" id="4310589"><a href="/crypto/x509/x509.go.html#4329121">ExtKeyUsageAny</a></span>&nbsp;<span class="op" id="4310604">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310609"><a href="/crypto/x509/verify.go.html#4309767">chains</a></span>&nbsp;<span class="op" id="4310616">=</span>&nbsp;<span class="ident" id="4310618"><a href="/crypto/x509/verify.go.html#4310252">candidateChains</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310637">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4310646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4310649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310653">for</span>&nbsp;<span class="ident" id="4310657">_</span><span class="op" id="4310658">,</span>&nbsp;<span class="ident" id="4310660">candidate</span>&nbsp;<span class="op" id="4310670">:=</span>&nbsp;<span class="keyword" id="4310673">range</span>&nbsp;<span class="ident" id="4310679"><a href="/crypto/x509/verify.go.html#4310252">candidateChains</a></span>&nbsp;<span class="op" id="4310695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310699">if</span>&nbsp;<span class="ident" id="4310702"><a href="/crypto/x509/verify.go.html#4314742">checkChainForKeyUsage</a></span><span class="op" id="4310723">(</span><span class="ident" id="4310724"><a href="/crypto/x509/verify.go.html#4310660">candidate</a></span><span class="op" id="4310733">,</span>&nbsp;<span class="ident" id="4310735"><a href="/crypto/x509/verify.go.html#4310379">keyUsages</a></span><span class="op" id="4310744">)</span>&nbsp;<span class="op" id="4310746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310751"><a href="/crypto/x509/verify.go.html#4309767">chains</a></span>&nbsp;<span class="op" id="4310758">=</span>&nbsp;<span class="builtinfunc" id="4310760">append</span><span class="op" id="4310766">(</span><span class="ident" id="4310767"><a href="/crypto/x509/verify.go.html#4309767">chains</a></span><span class="op" id="4310773">,</span>&nbsp;<span class="ident" id="4310775"><a href="/crypto/x509/verify.go.html#4310660">candidate</a></span><span class="op" id="4310784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4310788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4310791">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310795">if</span>&nbsp;<span class="builtinfunc" id="4310798">len</span><span class="op" id="4310801">(</span><span class="ident" id="4310802"><a href="/crypto/x509/verify.go.html#4309767">chains</a></span><span class="op" id="4310808">)</span>&nbsp;<span class="op" id="4310810">==</span>&nbsp;<span class="num" id="4310813">0</span>&nbsp;<span class="op" id="4310815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310819"><a href="/crypto/x509/verify.go.html#4309792">err</a></span>&nbsp;<span class="op" id="4310823">=</span>&nbsp;<span class="ident" id="4310825"><a href="/crypto/x509/verify.go.html#4303765">CertificateInvalidError</a></span><span class="op" id="4310848">{</span><span class="ident" id="4310849"><a href="/crypto/x509/verify.go.html#4309723">c</a></span><span class="op" id="4310850">,</span>&nbsp;<span class="ident" id="4310852"><a href="/crypto/x509/verify.go.html#4303601">IncompatibleUsage</a></span><span class="op" id="4310869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4310872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4310876">return</span><br>
<span class="lineno"></span><span class="op" id="4310883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4310886">func</span>&nbsp;<span class="ident" id="4310891">appendToFreshChain</span><span class="op" id="4310909">(</span><span class="ident" id="4310910">chain</span>&nbsp;<span class="op" id="4310916">[</span><span class="op" id="4310917">]</span><span class="op" id="4310918">*</span><span class="ident" id="4310919"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4310930">,</span>&nbsp;<span class="ident" id="4310932">cert</span>&nbsp;<span class="op" id="4310937">*</span><span class="ident" id="4310938"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4310949">)</span>&nbsp;<span class="op" id="4310951">[</span><span class="op" id="4310952">]</span><span class="op" id="4310953">*</span><span class="ident" id="4310954"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span>&nbsp;<span class="op" id="4310966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4310969">n</span>&nbsp;<span class="op" id="4310971">:=</span>&nbsp;<span class="builtinfunc" id="4310974">make</span><span class="op" id="4310978">(</span><span class="op" id="4310979">[</span><span class="op" id="4310980">]</span><span class="op" id="4310981">*</span><span class="ident" id="4310982"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4310993">,</span>&nbsp;<span class="builtinfunc" id="4310995">len</span><span class="op" id="4310998">(</span><span class="ident" id="4310999"><a href="/crypto/x509/verify.go.html#4310910">chain</a></span><span class="op" id="4311004">)</span><span class="op" id="4311005">+</span><span class="num" id="4311006">1</span><span class="op" id="4311007">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4311010">copy</span><span class="op" id="4311014">(</span><span class="ident" id="4311015"><a href="/crypto/x509/verify.go.html#4310969">n</a></span><span class="op" id="4311016">,</span>&nbsp;<span class="ident" id="4311018"><a href="/crypto/x509/verify.go.html#4310910">chain</a></span><span class="op" id="4311023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311026"><a href="/crypto/x509/verify.go.html#4310969">n</a></span><span class="op" id="4311027">[</span><span class="builtinfunc" id="4311028">len</span><span class="op" id="4311031">(</span><span class="ident" id="4311032"><a href="/crypto/x509/verify.go.html#4310910">chain</a></span><span class="op" id="4311037">)</span><span class="op" id="4311038">]</span>&nbsp;<span class="op" id="4311040">=</span>&nbsp;<span class="ident" id="4311042"><a href="/crypto/x509/verify.go.html#4310932">cert</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311048">return</span>&nbsp;<span class="ident" id="4311055"><a href="/crypto/x509/verify.go.html#4310969">n</a></span><br>
<span class="lineno"></span><span class="op" id="4311057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="keyword" id="4311060">func</span>&nbsp;<span class="op" id="4311065">(</span><span class="ident" id="4311066">c</span>&nbsp;<span class="op" id="4311068">*</span><span class="ident" id="4311069"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4311080">)</span>&nbsp;<span class="ident" id="4311082">buildChains</span><span class="op" id="4311093">(</span><span class="ident" id="4311094">cache</span>&nbsp;<span class="keyword" id="4311100">map</span><span class="op" id="4311103">[</span><span class="builtintype" id="4311104">int</span><span class="op" id="4311107">]</span><span class="op" id="4311108">[</span><span class="op" id="4311109">]</span><span class="op" id="4311110">[</span><span class="op" id="4311111">]</span><span class="op" id="4311112">*</span><span class="ident" id="4311113"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4311124">,</span>&nbsp;<span class="ident" id="4311126">currentChain</span>&nbsp;<span class="op" id="4311139">[</span><span class="op" id="4311140">]</span><span class="op" id="4311141">*</span><span class="ident" id="4311142"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4311153">,</span>&nbsp;<span class="ident" id="4311155">opts</span>&nbsp;<span class="op" id="4311160">*</span><span class="ident" id="4311161"><a href="/crypto/x509/verify.go.html#4306479">VerifyOptions</a></span><span class="op" id="4311174">)</span>&nbsp;<span class="op" id="4311176">(</span><span class="ident" id="4311177">chains</span>&nbsp;<span class="op" id="4311184">[</span><span class="op" id="4311185">]</span><span class="op" id="4311186">[</span><span class="op" id="4311187">]</span><span class="op" id="4311188">*</span><span class="ident" id="4311189"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4311200">,</span>&nbsp;<span class="ident" id="4311202">err</span>&nbsp;<span class="builtintype" id="4311206">error</span><span class="op" id="4311211">)</span>&nbsp;<span class="op" id="4311213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311216">possibleRoots</span><span class="op" id="4311229">,</span>&nbsp;<span class="ident" id="4311231">failedRoot</span><span class="op" id="4311241">,</span>&nbsp;<span class="ident" id="4311243">rootErr</span>&nbsp;<span class="op" id="4311251">:=</span>&nbsp;<span class="ident" id="4311254"><a href="/crypto/x509/verify.go.html#4311155">opts</a></span><span class="op" id="4311258">.</span><span class="ident" id="4311259">Roots</span><span class="op" id="4311264">.</span><span class="ident" id="4311265">findVerifiedParents</span><span class="op" id="4311284">(</span><span class="ident" id="4311285"><a href="/crypto/x509/verify.go.html#4311066">c</a></span><span class="op" id="4311286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311289">for</span>&nbsp;<span class="ident" id="4311293">_</span><span class="op" id="4311294">,</span>&nbsp;<span class="ident" id="4311296">rootNum</span>&nbsp;<span class="op" id="4311304">:=</span>&nbsp;<span class="keyword" id="4311307">range</span>&nbsp;<span class="ident" id="4311313"><a href="/crypto/x509/verify.go.html#4311216">possibleRoots</a></span>&nbsp;<span class="op" id="4311327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311331">root</span>&nbsp;<span class="op" id="4311336">:=</span>&nbsp;<span class="ident" id="4311339"><a href="/crypto/x509/verify.go.html#4311155">opts</a></span><span class="op" id="4311343">.</span><span class="ident" id="4311344">Roots</span><span class="op" id="4311349">.</span><span class="ident" id="4311350">certs</span><span class="op" id="4311355">[</span><span class="ident" id="4311356"><a href="/crypto/x509/verify.go.html#4311296">rootNum</a></span><span class="op" id="4311363">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311367"><a href="/crypto/x509/verify.go.html#4311202">err</a></span>&nbsp;<span class="op" id="4311371">=</span>&nbsp;<span class="ident" id="4311373"><a href="/crypto/x509/verify.go.html#4311331">root</a></span><span class="op" id="4311377">.</span><span class="ident" id="4311378">isValid</span><span class="op" id="4311385">(</span><span class="ident" id="4311386"><a href="/crypto/x509/verify.go.html#4307047">rootCertificate</a></span><span class="op" id="4311401">,</span>&nbsp;<span class="ident" id="4311403"><a href="/crypto/x509/verify.go.html#4311126">currentChain</a></span><span class="op" id="4311415">,</span>&nbsp;<span class="ident" id="4311417"><a href="/crypto/x509/verify.go.html#4311155">opts</a></span><span class="op" id="4311421">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311425">if</span>&nbsp;<span class="ident" id="4311428"><a href="/crypto/x509/verify.go.html#4311202">err</a></span>&nbsp;<span class="op" id="4311432">!=</span>&nbsp;<span class="ident" id="4311435">nil</span>&nbsp;<span class="op" id="4311439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311444">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4311455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311459"><a href="/crypto/x509/verify.go.html#4311177">chains</a></span>&nbsp;<span class="op" id="4311466">=</span>&nbsp;<span class="builtinfunc" id="4311468">append</span><span class="op" id="4311474">(</span><span class="ident" id="4311475"><a href="/crypto/x509/verify.go.html#4311177">chains</a></span><span class="op" id="4311481">,</span>&nbsp;<span class="ident" id="4311483"><a href="/crypto/x509/verify.go.html#4310891">appendToFreshChain</a></span><span class="op" id="4311501">(</span><span class="ident" id="4311502"><a href="/crypto/x509/verify.go.html#4311126">currentChain</a></span><span class="op" id="4311514">,</span>&nbsp;<span class="ident" id="4311516"><a href="/crypto/x509/verify.go.html#4311331">root</a></span><span class="op" id="4311520">)</span><span class="op" id="4311521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4311524">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311528">possibleIntermediates</span><span class="op" id="4311549">,</span>&nbsp;<span class="ident" id="4311551">failedIntermediate</span><span class="op" id="4311569">,</span>&nbsp;<span class="ident" id="4311571">intermediateErr</span>&nbsp;<span class="op" id="4311587">:=</span>&nbsp;<span class="ident" id="4311590"><a href="/crypto/x509/verify.go.html#4311155">opts</a></span><span class="op" id="4311594">.</span><span class="ident" id="4311595">Intermediates</span><span class="op" id="4311608">.</span><span class="ident" id="4311609">findVerifiedParents</span><span class="op" id="4311628">(</span><span class="ident" id="4311629"><a href="/crypto/x509/verify.go.html#4311066">c</a></span><span class="op" id="4311630">)</span><br>
<span class="lineno"></span><span class="ident" id="4311632">nextIntermediate</span><span class="op" id="4311648">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311651">for</span>&nbsp;<span class="ident" id="4311655">_</span><span class="op" id="4311656">,</span>&nbsp;<span class="ident" id="4311658">intermediateNum</span>&nbsp;<span class="op" id="4311674">:=</span>&nbsp;<span class="keyword" id="4311677">range</span>&nbsp;<span class="ident" id="4311683"><a href="/crypto/x509/verify.go.html#4311528">possibleIntermediates</a></span>&nbsp;<span class="op" id="4311705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311709">intermediate</span>&nbsp;<span class="op" id="4311722">:=</span>&nbsp;<span class="ident" id="4311725"><a href="/crypto/x509/verify.go.html#4311155">opts</a></span><span class="op" id="4311729">.</span><span class="ident" id="4311730">Intermediates</span><span class="op" id="4311743">.</span><span class="ident" id="4311744">certs</span><span class="op" id="4311749">[</span><span class="ident" id="4311750"><a href="/crypto/x509/verify.go.html#4311658">intermediateNum</a></span><span class="op" id="4311765">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311769">for</span>&nbsp;<span class="ident" id="4311773">_</span><span class="op" id="4311774">,</span>&nbsp;<span class="ident" id="4311776">cert</span>&nbsp;<span class="op" id="4311781">:=</span>&nbsp;<span class="keyword" id="4311784">range</span>&nbsp;<span class="ident" id="4311790"><a href="/crypto/x509/verify.go.html#4311126">currentChain</a></span>&nbsp;<span class="op" id="4311803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311808">if</span>&nbsp;<span class="ident" id="4311811"><a href="/crypto/x509/verify.go.html#4311776">cert</a></span>&nbsp;<span class="op" id="4311816">==</span>&nbsp;<span class="ident" id="4311819"><a href="/crypto/x509/verify.go.html#4311709">intermediate</a></span>&nbsp;<span class="op" id="4311832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311838">continue</span>&nbsp;<span class="ident" id="4311847">nextIntermediate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4311867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4311871">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4311875"><a href="/crypto/x509/verify.go.html#4311202">err</a></span>&nbsp;<span class="op" id="4311879">=</span>&nbsp;<span class="ident" id="4311881"><a href="/crypto/x509/verify.go.html#4311709">intermediate</a></span><span class="op" id="4311893">.</span><span class="ident" id="4311894">isValid</span><span class="op" id="4311901">(</span><span class="ident" id="4311902"><a href="/crypto/x509/verify.go.html#4307022">intermediateCertificate</a></span><span class="op" id="4311925">,</span>&nbsp;<span class="ident" id="4311927"><a href="/crypto/x509/verify.go.html#4311126">currentChain</a></span><span class="op" id="4311939">,</span>&nbsp;<span class="ident" id="4311941"><a href="/crypto/x509/verify.go.html#4311155">opts</a></span><span class="op" id="4311945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311949">if</span>&nbsp;<span class="ident" id="4311952"><a href="/crypto/x509/verify.go.html#4311202">err</a></span>&nbsp;<span class="op" id="4311956">!=</span>&nbsp;<span class="ident" id="4311959">nil</span>&nbsp;<span class="op" id="4311963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311968">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4311979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4311983">var</span>&nbsp;<span class="ident" id="4311987">childChains</span>&nbsp;<span class="op" id="4311999">[</span><span class="op" id="4312000">]</span><span class="op" id="4312001">[</span><span class="op" id="4312002">]</span><span class="op" id="4312003">*</span><span class="ident" id="4312004"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4312018"><a href="/crypto/x509/verify.go.html#4311987">childChains</a></span><span class="op" id="4312029">,</span>&nbsp;<span class="ident" id="4312031">ok</span>&nbsp;<span class="op" id="4312034">:=</span>&nbsp;<span class="ident" id="4312037"><a href="/crypto/x509/verify.go.html#4311094">cache</a></span><span class="op" id="4312042">[</span><span class="ident" id="4312043"><a href="/crypto/x509/verify.go.html#4311658">intermediateNum</a></span><span class="op" id="4312058">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312062">if</span>&nbsp;<span class="op" id="4312065">!</span><span class="ident" id="4312066"><a href="/crypto/x509/verify.go.html#4312031">ok</a></span>&nbsp;<span class="op" id="4312069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4312074"><a href="/crypto/x509/verify.go.html#4311987">childChains</a></span><span class="op" id="4312085">,</span>&nbsp;<span class="ident" id="4312087"><a href="/crypto/x509/verify.go.html#4311202">err</a></span>&nbsp;<span class="op" id="4312091">=</span>&nbsp;<span class="ident" id="4312093"><a href="/crypto/x509/verify.go.html#4311709">intermediate</a></span><span class="op" id="4312105">.</span><span class="ident" id="4312106">buildChains</span><span class="op" id="4312117">(</span><span class="ident" id="4312118"><a href="/crypto/x509/verify.go.html#4311094">cache</a></span><span class="op" id="4312123">,</span>&nbsp;<span class="ident" id="4312125"><a href="/crypto/x509/verify.go.html#4310891">appendToFreshChain</a></span><span class="op" id="4312143">(</span><span class="ident" id="4312144"><a href="/crypto/x509/verify.go.html#4311126">currentChain</a></span><span class="op" id="4312156">,</span>&nbsp;<span class="ident" id="4312158"><a href="/crypto/x509/verify.go.html#4311709">intermediate</a></span><span class="op" id="4312170">)</span><span class="op" id="4312171">,</span>&nbsp;<span class="ident" id="4312173"><a href="/crypto/x509/verify.go.html#4311155">opts</a></span><span class="op" id="4312177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4312182"><a href="/crypto/x509/verify.go.html#4311094">cache</a></span><span class="op" id="4312187">[</span><span class="ident" id="4312188"><a href="/crypto/x509/verify.go.html#4311658">intermediateNum</a></span><span class="op" id="4312203">]</span>&nbsp;<span class="op" id="4312205">=</span>&nbsp;<span class="ident" id="4312207"><a href="/crypto/x509/verify.go.html#4311987">childChains</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4312221">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4312225"><a href="/crypto/x509/verify.go.html#4311177">chains</a></span>&nbsp;<span class="op" id="4312232">=</span>&nbsp;<span class="builtinfunc" id="4312234">append</span><span class="op" id="4312240">(</span><span class="ident" id="4312241"><a href="/crypto/x509/verify.go.html#4311177">chains</a></span><span class="op" id="4312247">,</span>&nbsp;<span class="ident" id="4312249"><a href="/crypto/x509/verify.go.html#4311987">childChains</a></span><span class="op" id="4312260">...</span><span class="op" id="4312263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4312266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312270">if</span>&nbsp;<span class="builtinfunc" id="4312273">len</span><span class="op" id="4312276">(</span><span class="ident" id="4312277"><a href="/crypto/x509/verify.go.html#4311177">chains</a></span><span class="op" id="4312283">)</span>&nbsp;<span class="op" id="4312285">&gt;</span>&nbsp;<span class="num" id="4312287">0</span>&nbsp;<span class="op" id="4312289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4312293"><a href="/crypto/x509/verify.go.html#4311202">err</a></span>&nbsp;<span class="op" id="4312297">=</span>&nbsp;<span class="ident" id="4312299">nil</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4312304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312308">if</span>&nbsp;<span class="builtinfunc" id="4312311">len</span><span class="op" id="4312314">(</span><span class="ident" id="4312315"><a href="/crypto/x509/verify.go.html#4311177">chains</a></span><span class="op" id="4312321">)</span>&nbsp;<span class="op" id="4312323">==</span>&nbsp;<span class="num" id="4312326">0</span>&nbsp;<span class="op" id="4312328">&amp;&amp;</span>&nbsp;<span class="ident" id="4312331"><a href="/crypto/x509/verify.go.html#4311202">err</a></span>&nbsp;<span class="op" id="4312335">==</span>&nbsp;<span class="ident" id="4312338">nil</span>&nbsp;<span class="op" id="4312342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4312346">hintErr</span>&nbsp;<span class="op" id="4312354">:=</span>&nbsp;<span class="ident" id="4312357"><a href="/crypto/x509/verify.go.html#4311243">rootErr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4312367">hintCert</span>&nbsp;<span class="op" id="4312376">:=</span>&nbsp;<span class="ident" id="4312379"><a href="/crypto/x509/verify.go.html#4311231">failedRoot</a></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312392">if</span>&nbsp;<span class="ident" id="4312395"><a href="/crypto/x509/verify.go.html#4312346">hintErr</a></span>&nbsp;<span class="op" id="4312403">==</span>&nbsp;<span class="ident" id="4312406">nil</span>&nbsp;<span class="op" id="4312410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4312415"><a href="/crypto/x509/verify.go.html#4312346">hintErr</a></span>&nbsp;<span class="op" id="4312423">=</span>&nbsp;<span class="ident" id="4312425"><a href="/crypto/x509/verify.go.html#4311571">intermediateErr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4312444"><a href="/crypto/x509/verify.go.html#4312367">hintCert</a></span>&nbsp;<span class="op" id="4312453">=</span>&nbsp;<span class="ident" id="4312455"><a href="/crypto/x509/verify.go.html#4311551">failedIntermediate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4312476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4312480"><a href="/crypto/x509/verify.go.html#4311202">err</a></span>&nbsp;<span class="op" id="4312484">=</span>&nbsp;<span class="ident" id="4312486"><a href="/crypto/x509/verify.go.html#4305293">UnknownAuthorityError</a></span><span class="op" id="4312507">{</span><span class="ident" id="4312508"><a href="/crypto/x509/verify.go.html#4311066">c</a></span><span class="op" id="4312509">,</span>&nbsp;<span class="ident" id="4312511"><a href="/crypto/x509/verify.go.html#4312346">hintErr</a></span><span class="op" id="4312518">,</span>&nbsp;<span class="ident" id="4312520"><a href="/crypto/x509/verify.go.html#4312367">hintCert</a></span><span class="op" id="4312528">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4312531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312535">return</span><br>
<span class="lineno"></span><span class="op" id="4312542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="keyword" id="4312545">func</span>&nbsp;<span class="ident" id="4312550">matchHostnames</span><span class="op" id="4312564">(</span><span class="ident" id="4312565">pattern</span><span class="op" id="4312572">,</span>&nbsp;<span class="ident" id="4312574">host</span>&nbsp;<span class="builtintype" id="4312579">string</span><span class="op" id="4312585">)</span>&nbsp;<span class="builtintype" id="4312587">bool</span>&nbsp;<span class="op" id="4312592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312595">if</span>&nbsp;<span class="builtinfunc" id="4312598">len</span><span class="op" id="4312601">(</span><span class="ident" id="4312602"><a href="/crypto/x509/verify.go.html#4312565">pattern</a></span><span class="op" id="4312609">)</span>&nbsp;<span class="op" id="4312611">==</span>&nbsp;<span class="num" id="4312614">0</span>&nbsp;<span class="op" id="4312616">||</span>&nbsp;<span class="builtinfunc" id="4312619">len</span><span class="op" id="4312622">(</span><span class="ident" id="4312623"><a href="/crypto/x509/verify.go.html#4312574">host</a></span><span class="op" id="4312627">)</span>&nbsp;<span class="op" id="4312629">==</span>&nbsp;<span class="num" id="4312632">0</span>&nbsp;<span class="op" id="4312634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312638">return</span>&nbsp;<span class="ident" id="4312645">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4312652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4312656">patternParts</span>&nbsp;<span class="op" id="4312669">:=</span>&nbsp;<span class="ident" id="4312672"><a href="/crypto/x509/verify.go.html#4302849">strings</a></span><span class="op" id="4312679">.</span><span class="ident" id="4312680">Split</span><span class="op" id="4312685">(</span><span class="ident" id="4312686"><a href="/crypto/x509/verify.go.html#4312565">pattern</a></span><span class="op" id="4312693">,</span>&nbsp;<span class="string" id="4312695">&#34;.&#34;</span><span class="op" id="4312698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4312701">hostParts</span>&nbsp;<span class="op" id="4312711">:=</span>&nbsp;<span class="ident" id="4312714"><a href="/crypto/x509/verify.go.html#4302849">strings</a></span><span class="op" id="4312721">.</span><span class="ident" id="4312722">Split</span><span class="op" id="4312727">(</span><span class="ident" id="4312728"><a href="/crypto/x509/verify.go.html#4312574">host</a></span><span class="op" id="4312732">,</span>&nbsp;<span class="string" id="4312734">&#34;.&#34;</span><span class="op" id="4312737">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312741">if</span>&nbsp;<span class="builtinfunc" id="4312744">len</span><span class="op" id="4312747">(</span><span class="ident" id="4312748"><a href="/crypto/x509/verify.go.html#4312656">patternParts</a></span><span class="op" id="4312760">)</span>&nbsp;<span class="op" id="4312762">!=</span>&nbsp;<span class="builtinfunc" id="4312765">len</span><span class="op" id="4312768">(</span><span class="ident" id="4312769"><a href="/crypto/x509/verify.go.html#4312701">hostParts</a></span><span class="op" id="4312778">)</span>&nbsp;<span class="op" id="4312780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312784">return</span>&nbsp;<span class="ident" id="4312791">false</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4312798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312802">for</span>&nbsp;<span class="ident" id="4312806">i</span><span class="op" id="4312807">,</span>&nbsp;<span class="ident" id="4312809">patternPart</span>&nbsp;<span class="op" id="4312821">:=</span>&nbsp;<span class="keyword" id="4312824">range</span>&nbsp;<span class="ident" id="4312830"><a href="/crypto/x509/verify.go.html#4312656">patternParts</a></span>&nbsp;<span class="op" id="4312843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312847">if</span>&nbsp;<span class="ident" id="4312850"><a href="/crypto/x509/verify.go.html#4312809">patternPart</a></span>&nbsp;<span class="op" id="4312862">==</span>&nbsp;<span class="string" id="4312865">&#34;*&#34;</span>&nbsp;<span class="op" id="4312869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312874">continue</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4312885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312889">if</span>&nbsp;<span class="ident" id="4312892"><a href="/crypto/x509/verify.go.html#4312809">patternPart</a></span>&nbsp;<span class="op" id="4312904">!=</span>&nbsp;<span class="ident" id="4312907"><a href="/crypto/x509/verify.go.html#4312701">hostParts</a></span><span class="op" id="4312916">[</span><span class="ident" id="4312917"><a href="/crypto/x509/verify.go.html#4312806">i</a></span><span class="op" id="4312918">]</span>&nbsp;<span class="op" id="4312920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312925">return</span>&nbsp;<span class="ident" id="4312932">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4312940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4312943">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4312947">return</span>&nbsp;<span class="ident" id="4312954">true</span><br>
<span class="lineno"></span><span class="op" id="4312959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4312962">//&nbsp;toLowerCaseASCII&nbsp;returns&nbsp;a&nbsp;lower-case&nbsp;version&nbsp;of&nbsp;in.&nbsp;See&nbsp;RFC&nbsp;6125&nbsp;6.4.1.&nbsp;We&nbsp;use</span><br>
<span class="lineno">350</span><span class="comment" id="4313045">//&nbsp;an&nbsp;explicitly&nbsp;ASCII&nbsp;function&nbsp;to&nbsp;avoid&nbsp;any&nbsp;sharp&nbsp;corners&nbsp;resulting&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4313119">//&nbsp;performing&nbsp;Unicode&nbsp;operations&nbsp;on&nbsp;DNS&nbsp;labels.</span><br>
<span class="lineno"></span><span class="keyword" id="4313167">func</span>&nbsp;<span class="ident" id="4313172">toLowerCaseASCII</span><span class="op" id="4313188">(</span><span class="ident" id="4313189">in</span>&nbsp;<span class="builtintype" id="4313192">string</span><span class="op" id="4313198">)</span>&nbsp;<span class="builtintype" id="4313200">string</span>&nbsp;<span class="op" id="4313207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4313210">//&nbsp;If&nbsp;the&nbsp;string&nbsp;is&nbsp;already&nbsp;lower-case&nbsp;then&nbsp;there&#39;s&nbsp;nothing&nbsp;to&nbsp;do.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313278">isAlreadyLowerCase</span>&nbsp;<span class="op" id="4313297">:=</span>&nbsp;<span class="ident" id="4313300">true</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313306">for</span>&nbsp;<span class="ident" id="4313310">_</span><span class="op" id="4313311">,</span>&nbsp;<span class="ident" id="4313313">c</span>&nbsp;<span class="op" id="4313315">:=</span>&nbsp;<span class="keyword" id="4313318">range</span>&nbsp;<span class="ident" id="4313324"><a href="/crypto/x509/verify.go.html#4313189">in</a></span>&nbsp;<span class="op" id="4313327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313331">if</span>&nbsp;<span class="ident" id="4313334"><a href="/crypto/x509/verify.go.html#4313313">c</a></span>&nbsp;<span class="op" id="4313336">==</span>&nbsp;<span class="ident" id="4313339"><a href="/crypto/x509/verify.go.html#4302868">utf8</a></span><span class="op" id="4313343">.</span><span class="ident" id="4313344">RuneError</span>&nbsp;<span class="op" id="4313354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4313359">//&nbsp;If&nbsp;we&nbsp;get&nbsp;a&nbsp;UTF-8&nbsp;error&nbsp;then&nbsp;there&nbsp;might&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4313409">//&nbsp;upper-case&nbsp;ASCII&nbsp;bytes&nbsp;in&nbsp;the&nbsp;invalid&nbsp;sequence.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313463"><a href="/crypto/x509/verify.go.html#4313278">isAlreadyLowerCase</a></span>&nbsp;<span class="op" id="4313482">=</span>&nbsp;<span class="ident" id="4313484">false</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313493">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4313501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313505">if</span>&nbsp;<span class="string" id="4313508">&#39;A&#39;</span>&nbsp;<span class="op" id="4313512">&lt;=</span>&nbsp;<span class="ident" id="4313515"><a href="/crypto/x509/verify.go.html#4313313">c</a></span>&nbsp;<span class="op" id="4313517">&amp;&amp;</span>&nbsp;<span class="ident" id="4313520"><a href="/crypto/x509/verify.go.html#4313313">c</a></span>&nbsp;<span class="op" id="4313522">&lt;=</span>&nbsp;<span class="string" id="4313525">&#39;Z&#39;</span>&nbsp;<span class="op" id="4313529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313534"><a href="/crypto/x509/verify.go.html#4313278">isAlreadyLowerCase</a></span>&nbsp;<span class="op" id="4313553">=</span>&nbsp;<span class="ident" id="4313555">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313564">break</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4313572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4313575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313579">if</span>&nbsp;<span class="ident" id="4313582"><a href="/crypto/x509/verify.go.html#4313278">isAlreadyLowerCase</a></span>&nbsp;<span class="op" id="4313601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313605">return</span>&nbsp;<span class="ident" id="4313612"><a href="/crypto/x509/verify.go.html#4313189">in</a></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4313616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313620">out</span>&nbsp;<span class="op" id="4313624">:=</span>&nbsp;<span class="op" id="4313627">[</span><span class="op" id="4313628">]</span><span class="builtintype" id="4313629">byte</span><span class="op" id="4313633">(</span><span class="ident" id="4313634"><a href="/crypto/x509/verify.go.html#4313189">in</a></span><span class="op" id="4313636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313639">for</span>&nbsp;<span class="ident" id="4313643">i</span><span class="op" id="4313644">,</span>&nbsp;<span class="ident" id="4313646">c</span>&nbsp;<span class="op" id="4313648">:=</span>&nbsp;<span class="keyword" id="4313651">range</span>&nbsp;<span class="ident" id="4313657"><a href="/crypto/x509/verify.go.html#4313620">out</a></span>&nbsp;<span class="op" id="4313661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313665">if</span>&nbsp;<span class="string" id="4313668">&#39;A&#39;</span>&nbsp;<span class="op" id="4313672">&lt;=</span>&nbsp;<span class="ident" id="4313675"><a href="/crypto/x509/verify.go.html#4313646">c</a></span>&nbsp;<span class="op" id="4313677">&amp;&amp;</span>&nbsp;<span class="ident" id="4313680"><a href="/crypto/x509/verify.go.html#4313646">c</a></span>&nbsp;<span class="op" id="4313682">&lt;=</span>&nbsp;<span class="string" id="4313685">&#39;Z&#39;</span>&nbsp;<span class="op" id="4313689">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313694"><a href="/crypto/x509/verify.go.html#4313620">out</a></span><span class="op" id="4313697">[</span><span class="ident" id="4313698"><a href="/crypto/x509/verify.go.html#4313643">i</a></span><span class="op" id="4313699">]</span>&nbsp;<span class="op" id="4313701">+=</span>&nbsp;<span class="string" id="4313704">&#39;a&#39;</span>&nbsp;<span class="op" id="4313708">-</span>&nbsp;<span class="string" id="4313710">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4313716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4313719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313722">return</span>&nbsp;<span class="builtintype" id="4313729">string</span><span class="op" id="4313735">(</span><span class="ident" id="4313736"><a href="/crypto/x509/verify.go.html#4313620">out</a></span><span class="op" id="4313739">)</span><br>
<span class="lineno"></span><span class="op" id="4313741">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span><span class="comment" id="4313744">//&nbsp;VerifyHostname&nbsp;returns&nbsp;nil&nbsp;if&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;certificate&nbsp;for&nbsp;the&nbsp;named&nbsp;host.</span><br>
<span class="lineno"></span><span class="comment" id="4313822">//&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;an&nbsp;error&nbsp;describing&nbsp;the&nbsp;mismatch.</span><br>
<span class="lineno"></span><span class="keyword" id="4313880">func</span>&nbsp;<span class="op" id="4313885">(</span><span class="ident" id="4313886">c</span>&nbsp;<span class="op" id="4313888">*</span><span class="ident" id="4313889"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4313900">)</span>&nbsp;<span class="ident" id="4313902">VerifyHostname</span><span class="op" id="4313916">(</span><span class="ident" id="4313917">h</span>&nbsp;<span class="builtintype" id="4313919">string</span><span class="op" id="4313925">)</span>&nbsp;<span class="builtintype" id="4313927">error</span>&nbsp;<span class="op" id="4313933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4313936">//&nbsp;IP&nbsp;addresses&nbsp;may&nbsp;be&nbsp;written&nbsp;in&nbsp;[&nbsp;].</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4313976">candidateIP</span>&nbsp;<span class="op" id="4313988">:=</span>&nbsp;<span class="ident" id="4313991"><a href="/crypto/x509/verify.go.html#4313917">h</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4313994">if</span>&nbsp;<span class="builtinfunc" id="4313997">len</span><span class="op" id="4314000">(</span><span class="ident" id="4314001"><a href="/crypto/x509/verify.go.html#4313917">h</a></span><span class="op" id="4314002">)</span>&nbsp;<span class="op" id="4314004">&gt;=</span>&nbsp;<span class="num" id="4314007">3</span>&nbsp;<span class="op" id="4314009">&amp;&amp;</span>&nbsp;<span class="ident" id="4314012"><a href="/crypto/x509/verify.go.html#4313917">h</a></span><span class="op" id="4314013">[</span><span class="num" id="4314014">0</span><span class="op" id="4314015">]</span>&nbsp;<span class="op" id="4314017">==</span>&nbsp;<span class="string" id="4314020">&#39;[&#39;</span>&nbsp;<span class="op" id="4314024">&amp;&amp;</span>&nbsp;<span class="ident" id="4314027"><a href="/crypto/x509/verify.go.html#4313917">h</a></span><span class="op" id="4314028">[</span><span class="builtinfunc" id="4314029">len</span><span class="op" id="4314032">(</span><span class="ident" id="4314033"><a href="/crypto/x509/verify.go.html#4313917">h</a></span><span class="op" id="4314034">)</span><span class="op" id="4314035">-</span><span class="num" id="4314036">1</span><span class="op" id="4314037">]</span>&nbsp;<span class="op" id="4314039">==</span>&nbsp;<span class="string" id="4314042">&#39;]&#39;</span>&nbsp;<span class="op" id="4314046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4314050"><a href="/crypto/x509/verify.go.html#4313976">candidateIP</a></span>&nbsp;<span class="op" id="4314062">=</span>&nbsp;<span class="ident" id="4314064"><a href="/crypto/x509/verify.go.html#4313917">h</a></span><span class="op" id="4314065">[</span><span class="num" id="4314066">1</span>&nbsp;<span class="op" id="4314068">:</span>&nbsp;<span class="builtinfunc" id="4314070">len</span><span class="op" id="4314073">(</span><span class="ident" id="4314074"><a href="/crypto/x509/verify.go.html#4313917">h</a></span><span class="op" id="4314075">)</span><span class="op" id="4314076">-</span><span class="num" id="4314077">1</span><span class="op" id="4314078">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4314081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314084">if</span>&nbsp;<span class="ident" id="4314087">ip</span>&nbsp;<span class="op" id="4314090">:=</span>&nbsp;<span class="ident" id="4314093"><a href="/crypto/x509/verify.go.html#4302831">net</a></span><span class="op" id="4314096">.</span><span class="ident" id="4314097">ParseIP</span><span class="op" id="4314104">(</span><span class="ident" id="4314105"><a href="/crypto/x509/verify.go.html#4313976">candidateIP</a></span><span class="op" id="4314116">)</span><span class="op" id="4314117">;</span>&nbsp;<span class="ident" id="4314119"><a href="/crypto/x509/verify.go.html#4314087">ip</a></span>&nbsp;<span class="op" id="4314122">!=</span>&nbsp;<span class="ident" id="4314125">nil</span>&nbsp;<span class="op" id="4314129">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4314133">//&nbsp;We&nbsp;only&nbsp;match&nbsp;IP&nbsp;addresses&nbsp;against&nbsp;IP&nbsp;SANs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4314182">//&nbsp;https://tools.ietf.org/html/rfc6125#appendix-B.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314236">for</span>&nbsp;<span class="ident" id="4314240">_</span><span class="op" id="4314241">,</span>&nbsp;<span class="ident" id="4314243">candidate</span>&nbsp;<span class="op" id="4314253">:=</span>&nbsp;<span class="keyword" id="4314256">range</span>&nbsp;<span class="ident" id="4314262"><a href="/crypto/x509/verify.go.html#4313886">c</a></span><span class="op" id="4314263">.</span><span class="ident" id="4314264">IPAddresses</span>&nbsp;<span class="op" id="4314276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314281">if</span>&nbsp;<span class="ident" id="4314284"><a href="/crypto/x509/verify.go.html#4314087">ip</a></span><span class="op" id="4314286">.</span><span class="ident" id="4314287">Equal</span><span class="op" id="4314292">(</span><span class="ident" id="4314293"><a href="/crypto/x509/verify.go.html#4314243">candidate</a></span><span class="op" id="4314302">)</span>&nbsp;<span class="op" id="4314304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314310">return</span>&nbsp;<span class="ident" id="4314317">nil</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4314324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4314328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314332">return</span>&nbsp;<span class="ident" id="4314339"><a href="/crypto/x509/verify.go.html#4304538">HostnameError</a></span><span class="op" id="4314352">{</span><span class="ident" id="4314353"><a href="/crypto/x509/verify.go.html#4313886">c</a></span><span class="op" id="4314354">,</span>&nbsp;<span class="ident" id="4314356"><a href="/crypto/x509/verify.go.html#4313976">candidateIP</a></span><span class="op" id="4314367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4314370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4314374">lowered</span>&nbsp;<span class="op" id="4314382">:=</span>&nbsp;<span class="ident" id="4314385"><a href="/crypto/x509/verify.go.html#4313172">toLowerCaseASCII</a></span><span class="op" id="4314401">(</span><span class="ident" id="4314402"><a href="/crypto/x509/verify.go.html#4313917">h</a></span><span class="op" id="4314403">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314407">if</span>&nbsp;<span class="builtinfunc" id="4314410">len</span><span class="op" id="4314413">(</span><span class="ident" id="4314414"><a href="/crypto/x509/verify.go.html#4313886">c</a></span><span class="op" id="4314415">.</span><span class="ident" id="4314416">DNSNames</span><span class="op" id="4314424">)</span>&nbsp;<span class="op" id="4314426">&gt;</span>&nbsp;<span class="num" id="4314428">0</span>&nbsp;<span class="op" id="4314430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314434">for</span>&nbsp;<span class="ident" id="4314438">_</span><span class="op" id="4314439">,</span>&nbsp;<span class="ident" id="4314441">match</span>&nbsp;<span class="op" id="4314447">:=</span>&nbsp;<span class="keyword" id="4314450">range</span>&nbsp;<span class="ident" id="4314456"><a href="/crypto/x509/verify.go.html#4313886">c</a></span><span class="op" id="4314457">.</span><span class="ident" id="4314458">DNSNames</span>&nbsp;<span class="op" id="4314467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314472">if</span>&nbsp;<span class="ident" id="4314475"><a href="/crypto/x509/verify.go.html#4312550">matchHostnames</a></span><span class="op" id="4314489">(</span><span class="ident" id="4314490"><a href="/crypto/x509/verify.go.html#4313172">toLowerCaseASCII</a></span><span class="op" id="4314506">(</span><span class="ident" id="4314507"><a href="/crypto/x509/verify.go.html#4314441">match</a></span><span class="op" id="4314512">)</span><span class="op" id="4314513">,</span>&nbsp;<span class="ident" id="4314515"><a href="/crypto/x509/verify.go.html#4314374">lowered</a></span><span class="op" id="4314522">)</span>&nbsp;<span class="op" id="4314524">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314530">return</span>&nbsp;<span class="ident" id="4314537">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4314544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4314548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4314552">//&nbsp;If&nbsp;Subject&nbsp;Alt&nbsp;Name&nbsp;is&nbsp;given,&nbsp;we&nbsp;ignore&nbsp;the&nbsp;common&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4314613">}</span>&nbsp;<span class="keyword" id="4314615">else</span>&nbsp;<span class="keyword" id="4314620">if</span>&nbsp;<span class="ident" id="4314623"><a href="/crypto/x509/verify.go.html#4312550">matchHostnames</a></span><span class="op" id="4314637">(</span><span class="ident" id="4314638"><a href="/crypto/x509/verify.go.html#4313172">toLowerCaseASCII</a></span><span class="op" id="4314654">(</span><span class="ident" id="4314655"><a href="/crypto/x509/verify.go.html#4313886">c</a></span><span class="op" id="4314656">.</span><span class="ident" id="4314657">Subject</span><span class="op" id="4314664">.</span><span class="ident" id="4314665">CommonName</span><span class="op" id="4314675">)</span><span class="op" id="4314676">,</span>&nbsp;<span class="ident" id="4314678"><a href="/crypto/x509/verify.go.html#4314374">lowered</a></span><span class="op" id="4314685">)</span>&nbsp;<span class="op" id="4314687">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314691">return</span>&nbsp;<span class="ident" id="4314698">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4314703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314707">return</span>&nbsp;<span class="ident" id="4314714"><a href="/crypto/x509/verify.go.html#4304538">HostnameError</a></span><span class="op" id="4314727">{</span><span class="ident" id="4314728"><a href="/crypto/x509/verify.go.html#4313886">c</a></span><span class="op" id="4314729">,</span>&nbsp;<span class="ident" id="4314731"><a href="/crypto/x509/verify.go.html#4313917">h</a></span><span class="op" id="4314732">}</span><br>
<span class="lineno"></span><span class="op" id="4314734">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span><span class="keyword" id="4314737">func</span>&nbsp;<span class="ident" id="4314742">checkChainForKeyUsage</span><span class="op" id="4314763">(</span><span class="ident" id="4314764">chain</span>&nbsp;<span class="op" id="4314770">[</span><span class="op" id="4314771">]</span><span class="op" id="4314772">*</span><span class="ident" id="4314773"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="4314784">,</span>&nbsp;<span class="ident" id="4314786">keyUsages</span>&nbsp;<span class="op" id="4314796">[</span><span class="op" id="4314797">]</span><span class="ident" id="4314798"><a href="/crypto/x509/x509.go.html#4329095">ExtKeyUsage</a></span><span class="op" id="4314809">)</span>&nbsp;<span class="builtintype" id="4314811">bool</span>&nbsp;<span class="op" id="4314816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4314819">usages</span>&nbsp;<span class="op" id="4314826">:=</span>&nbsp;<span class="builtinfunc" id="4314829">make</span><span class="op" id="4314833">(</span><span class="op" id="4314834">[</span><span class="op" id="4314835">]</span><span class="ident" id="4314836"><a href="/crypto/x509/x509.go.html#4329095">ExtKeyUsage</a></span><span class="op" id="4314847">,</span>&nbsp;<span class="builtinfunc" id="4314849">len</span><span class="op" id="4314852">(</span><span class="ident" id="4314853"><a href="/crypto/x509/verify.go.html#4314786">keyUsages</a></span><span class="op" id="4314862">)</span><span class="op" id="4314863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4314866">copy</span><span class="op" id="4314870">(</span><span class="ident" id="4314871"><a href="/crypto/x509/verify.go.html#4314819">usages</a></span><span class="op" id="4314877">,</span>&nbsp;<span class="ident" id="4314879"><a href="/crypto/x509/verify.go.html#4314786">keyUsages</a></span><span class="op" id="4314888">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314892">if</span>&nbsp;<span class="builtinfunc" id="4314895">len</span><span class="op" id="4314898">(</span><span class="ident" id="4314899"><a href="/crypto/x509/verify.go.html#4314764">chain</a></span><span class="op" id="4314904">)</span>&nbsp;<span class="op" id="4314906">==</span>&nbsp;<span class="num" id="4314909">0</span>&nbsp;<span class="op" id="4314911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4314915">return</span>&nbsp;<span class="ident" id="4314922">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4314929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4314933">usagesRemaining</span>&nbsp;<span class="op" id="4314949">:=</span>&nbsp;<span class="builtinfunc" id="4314952">len</span><span class="op" id="4314955">(</span><span class="ident" id="4314956"><a href="/crypto/x509/verify.go.html#4314819">usages</a></span><span class="op" id="4314962">)</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4314966">//&nbsp;We&nbsp;walk&nbsp;down&nbsp;the&nbsp;list&nbsp;and&nbsp;cross&nbsp;out&nbsp;any&nbsp;usages&nbsp;that&nbsp;aren&#39;t&nbsp;supported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4315039">//&nbsp;by&nbsp;each&nbsp;certificate.&nbsp;If&nbsp;we&nbsp;cross&nbsp;out&nbsp;all&nbsp;the&nbsp;usages,&nbsp;then&nbsp;the&nbsp;chain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4315111">//&nbsp;is&nbsp;unacceptable.</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="ident" id="4315132">NextCert</span><span class="op" id="4315140">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315143">for</span>&nbsp;<span class="ident" id="4315147">i</span>&nbsp;<span class="op" id="4315149">:=</span>&nbsp;<span class="builtinfunc" id="4315152">len</span><span class="op" id="4315155">(</span><span class="ident" id="4315156"><a href="/crypto/x509/verify.go.html#4314764">chain</a></span><span class="op" id="4315161">)</span>&nbsp;<span class="op" id="4315163">-</span>&nbsp;<span class="num" id="4315165">1</span><span class="op" id="4315166">;</span>&nbsp;<span class="ident" id="4315168"><a href="/crypto/x509/verify.go.html#4315147">i</a></span>&nbsp;<span class="op" id="4315170">&gt;=</span>&nbsp;<span class="num" id="4315173">0</span><span class="op" id="4315174">;</span>&nbsp;<span class="ident" id="4315176"><a href="/crypto/x509/verify.go.html#4315147">i</a></span><span class="op" id="4315177">--</span>&nbsp;<span class="op" id="4315180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315184">cert</span>&nbsp;<span class="op" id="4315189">:=</span>&nbsp;<span class="ident" id="4315192"><a href="/crypto/x509/verify.go.html#4314764">chain</a></span><span class="op" id="4315197">[</span><span class="ident" id="4315198"><a href="/crypto/x509/verify.go.html#4315147">i</a></span><span class="op" id="4315199">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315203">if</span>&nbsp;<span class="builtinfunc" id="4315206">len</span><span class="op" id="4315209">(</span><span class="ident" id="4315210"><a href="/crypto/x509/verify.go.html#4315184">cert</a></span><span class="op" id="4315214">.</span><span class="ident" id="4315215">ExtKeyUsage</span><span class="op" id="4315226">)</span>&nbsp;<span class="op" id="4315228">==</span>&nbsp;<span class="num" id="4315231">0</span>&nbsp;<span class="op" id="4315233">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4315236">len</span><span class="op" id="4315239">(</span><span class="ident" id="4315240"><a href="/crypto/x509/verify.go.html#4315184">cert</a></span><span class="op" id="4315244">.</span><span class="ident" id="4315245">UnknownExtKeyUsage</span><span class="op" id="4315263">)</span>&nbsp;<span class="op" id="4315265">==</span>&nbsp;<span class="num" id="4315268">0</span>&nbsp;<span class="op" id="4315270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4315275">//&nbsp;The&nbsp;certificate&nbsp;doesn&#39;t&nbsp;have&nbsp;any&nbsp;extended&nbsp;key&nbsp;usage&nbsp;specified.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315344">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4315355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315360">for</span>&nbsp;<span class="ident" id="4315364">_</span><span class="op" id="4315365">,</span>&nbsp;<span class="ident" id="4315367">usage</span>&nbsp;<span class="op" id="4315373">:=</span>&nbsp;<span class="keyword" id="4315376">range</span>&nbsp;<span class="ident" id="4315382"><a href="/crypto/x509/verify.go.html#4315184">cert</a></span><span class="op" id="4315386">.</span><span class="ident" id="4315387">ExtKeyUsage</span>&nbsp;<span class="op" id="4315399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315404">if</span>&nbsp;<span class="ident" id="4315407"><a href="/crypto/x509/verify.go.html#4315367">usage</a></span>&nbsp;<span class="op" id="4315413">==</span>&nbsp;<span class="ident" id="4315416"><a href="/crypto/x509/x509.go.html#4329121">ExtKeyUsageAny</a></span>&nbsp;<span class="op" id="4315431">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4315437">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;explicitly&nbsp;good&nbsp;for&nbsp;any&nbsp;usage.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315494">continue</span>&nbsp;<span class="ident" id="4315503">NextCert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4315515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4315519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315524">const</span>&nbsp;<span class="ident" id="4315530">invalidUsage</span>&nbsp;<span class="ident" id="4315543"><a href="/crypto/x509/x509.go.html#4329095">ExtKeyUsage</a></span>&nbsp;<span class="op" id="4315555">=</span>&nbsp;<span class="op" id="4315557">-</span><span class="num" id="4315558">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315562">NextRequestedUsage</span><span class="op" id="4315580">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315584">for</span>&nbsp;<span class="ident" id="4315588">i</span><span class="op" id="4315589">,</span>&nbsp;<span class="ident" id="4315591">requestedUsage</span>&nbsp;<span class="op" id="4315606">:=</span>&nbsp;<span class="keyword" id="4315609">range</span>&nbsp;<span class="ident" id="4315615"><a href="/crypto/x509/verify.go.html#4314819">usages</a></span>&nbsp;<span class="op" id="4315622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315627">if</span>&nbsp;<span class="ident" id="4315630"><a href="/crypto/x509/verify.go.html#4315591">requestedUsage</a></span>&nbsp;<span class="op" id="4315645">==</span>&nbsp;<span class="ident" id="4315648"><a href="/crypto/x509/verify.go.html#4315530">invalidUsage</a></span>&nbsp;<span class="op" id="4315661">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315667">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4315679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315685">for</span>&nbsp;<span class="ident" id="4315689">_</span><span class="op" id="4315690">,</span>&nbsp;<span class="ident" id="4315692">usage</span>&nbsp;<span class="op" id="4315698">:=</span>&nbsp;<span class="keyword" id="4315701">range</span>&nbsp;<span class="ident" id="4315707"><a href="/crypto/x509/verify.go.html#4315184">cert</a></span><span class="op" id="4315711">.</span><span class="ident" id="4315712">ExtKeyUsage</span>&nbsp;<span class="op" id="4315724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315730">if</span>&nbsp;<span class="ident" id="4315733"><a href="/crypto/x509/verify.go.html#4315591">requestedUsage</a></span>&nbsp;<span class="op" id="4315748">==</span>&nbsp;<span class="ident" id="4315751"><a href="/crypto/x509/verify.go.html#4315692">usage</a></span>&nbsp;<span class="op" id="4315757">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4315764">continue</span>&nbsp;<span class="ident" id="4315773">NextRequestedUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4315796">}</span>&nbsp;<span class="keyword" id="4315798">else</span>&nbsp;<span class="keyword" id="4315803">if</span>&nbsp;<span class="ident" id="4315806"><a href="/crypto/x509/verify.go.html#4315591">requestedUsage</a></span>&nbsp;<span class="op" id="4315821">==</span>&nbsp;<span class="ident" id="4315824"><a href="/crypto/x509/x509.go.html#4329156">ExtKeyUsageServerAuth</a></span>&nbsp;<span class="op" id="4315846">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4315854">(</span><span class="ident" id="4315855"><a href="/crypto/x509/verify.go.html#4315692">usage</a></span>&nbsp;<span class="op" id="4315861">==</span>&nbsp;<span class="ident" id="4315864"><a href="/crypto/x509/x509.go.html#4329415">ExtKeyUsageNetscapeServerGatedCrypto</a></span>&nbsp;<span class="op" id="4315901">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4315910"><a href="/crypto/x509/verify.go.html#4315692">usage</a></span>&nbsp;<span class="op" id="4315916">==</span>&nbsp;<span class="ident" id="4315919"><a href="/crypto/x509/x509.go.html#4329376">ExtKeyUsageMicrosoftServerGatedCrypto</a></span><span class="op" id="4315956">)</span>&nbsp;<span class="op" id="4315958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4315965">//&nbsp;In&nbsp;order&nbsp;to&nbsp;support&nbsp;COMODO</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4316000">//&nbsp;certificate&nbsp;chains,&nbsp;we&nbsp;have&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4316039">//&nbsp;accept&nbsp;Netscape&nbsp;or&nbsp;Microsoft&nbsp;SGC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4316080">//&nbsp;usages&nbsp;as&nbsp;equal&nbsp;to&nbsp;ServerAuth.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4316119">continue</span>&nbsp;<span class="ident" id="4316128">NextRequestedUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316151">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316156">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316162"><a href="/crypto/x509/verify.go.html#4314819">usages</a></span><span class="op" id="4316168">[</span><span class="ident" id="4316169"><a href="/crypto/x509/verify.go.html#4315588">i</a></span><span class="op" id="4316170">]</span>&nbsp;<span class="op" id="4316172">=</span>&nbsp;<span class="ident" id="4316174"><a href="/crypto/x509/verify.go.html#4315530">invalidUsage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4316190"><a href="/crypto/x509/verify.go.html#4314933">usagesRemaining</a></span><span class="op" id="4316205">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4316211">if</span>&nbsp;<span class="ident" id="4316214"><a href="/crypto/x509/verify.go.html#4314933">usagesRemaining</a></span>&nbsp;<span class="op" id="4316230">==</span>&nbsp;<span class="num" id="4316233">0</span>&nbsp;<span class="op" id="4316235">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4316241">return</span>&nbsp;<span class="ident" id="4316248">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4316264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4316268">return</span>&nbsp;<span class="ident" id="4316275">true</span><br>
<span class="lineno"></span><span class="op" id="4316280">}</span>
</div>
</body>
</html>
