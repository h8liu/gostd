<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>log</h2>
<ul>
<li><a href="/gostd/log/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/log/log.go.html">log.go</a></li>
<li><a href="/gostd/log/log_test.go.html">log_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7348401">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7348456">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7348510">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7348561">package</span>&nbsp;<span class="ident" id="7348569">log</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7348574">//&nbsp;These&nbsp;tests&nbsp;are&nbsp;too&nbsp;simple.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7348606">import</span>&nbsp;<span class="op" id="7348613">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7348616">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7348625">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7348631">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7348641">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7348651">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7348654">const</span>&nbsp;<span class="op" id="7348660">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348663">Rdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7348677">=</span>&nbsp;<span class="string" id="7348679">`[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348725">Rtime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7348739">=</span>&nbsp;<span class="string" id="7348741">`[0-9][0-9]:[0-9][0-9]:[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348777">Rmicroseconds</span>&nbsp;<span class="op" id="7348791">=</span>&nbsp;<span class="string" id="7348793">`\.[0-9][0-9][0-9][0-9][0-9][0-9]`</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348829">Rline</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7348843">=</span>&nbsp;<span class="string" id="7348845">`(54|56):`</span>&nbsp;<span class="comment" id="7348856">//&nbsp;must&nbsp;update&nbsp;if&nbsp;the&nbsp;calls&nbsp;to&nbsp;l.Printf&nbsp;/&nbsp;l.Print&nbsp;below&nbsp;move</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348918">Rlongfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7348932">=</span>&nbsp;<span class="string" id="7348934">`.*/[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="7348960">+</span>&nbsp;<span class="ident" id="7348962">Rline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348969">Rshortfile</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7348983">=</span>&nbsp;<span class="string" id="7348985">`[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="7349008">+</span>&nbsp;<span class="ident" id="7349010">Rline</span><br>
<span class="lineno"></span><span class="op" id="7349016">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="7349019">type</span>&nbsp;<span class="ident" id="7349024">tester</span>&nbsp;<span class="keyword" id="7349031">struct</span>&nbsp;<span class="op" id="7349038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349041">flag</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7349049">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349054">prefix</span>&nbsp;&nbsp;<span class="builtintype" id="7349062">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349070">pattern</span>&nbsp;<span class="builtintype" id="7349078">string</span>&nbsp;<span class="comment" id="7349085">//&nbsp;regexp&nbsp;that&nbsp;log&nbsp;output&nbsp;must&nbsp;match;&nbsp;we&nbsp;add&nbsp;^&nbsp;and&nbsp;expected_text$&nbsp;always</span><br>
<span class="lineno"></span><span class="op" id="7349158">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="7349161">var</span>&nbsp;<span class="ident" id="7349165">tests</span>&nbsp;<span class="op" id="7349171">=</span>&nbsp;<span class="op" id="7349173">[</span><span class="op" id="7349174">]</span><span class="ident" id="7349175">tester</span><span class="op" id="7349181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7349184">//&nbsp;individual&nbsp;pieces:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349207">{</span><span class="num" id="7349208">0</span><span class="op" id="7349209">,</span>&nbsp;<span class="string" id="7349211">&#34;&#34;</span><span class="op" id="7349213">,</span>&nbsp;<span class="string" id="7349215">&#34;&#34;</span><span class="op" id="7349217">}</span><span class="op" id="7349218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349221">{</span><span class="num" id="7349222">0</span><span class="op" id="7349223">,</span>&nbsp;<span class="string" id="7349225">&#34;XXX&#34;</span><span class="op" id="7349230">,</span>&nbsp;<span class="string" id="7349232">&#34;XXX&#34;</span><span class="op" id="7349237">}</span><span class="op" id="7349238">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349241">{</span><span class="ident" id="7349242">Ldate</span><span class="op" id="7349247">,</span>&nbsp;<span class="string" id="7349249">&#34;&#34;</span><span class="op" id="7349251">,</span>&nbsp;<span class="ident" id="7349253">Rdate</span>&nbsp;<span class="op" id="7349259">+</span>&nbsp;<span class="string" id="7349261">&#34;&nbsp;&#34;</span><span class="op" id="7349264">}</span><span class="op" id="7349265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349268">{</span><span class="ident" id="7349269">Ltime</span><span class="op" id="7349274">,</span>&nbsp;<span class="string" id="7349276">&#34;&#34;</span><span class="op" id="7349278">,</span>&nbsp;<span class="ident" id="7349280">Rtime</span>&nbsp;<span class="op" id="7349286">+</span>&nbsp;<span class="string" id="7349288">&#34;&nbsp;&#34;</span><span class="op" id="7349291">}</span><span class="op" id="7349292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349295">{</span><span class="ident" id="7349296">Ltime</span>&nbsp;<span class="op" id="7349302">|</span>&nbsp;<span class="ident" id="7349304">Lmicroseconds</span><span class="op" id="7349317">,</span>&nbsp;<span class="string" id="7349319">&#34;&#34;</span><span class="op" id="7349321">,</span>&nbsp;<span class="ident" id="7349323">Rtime</span>&nbsp;<span class="op" id="7349329">+</span>&nbsp;<span class="ident" id="7349331">Rmicroseconds</span>&nbsp;<span class="op" id="7349345">+</span>&nbsp;<span class="string" id="7349347">&#34;&nbsp;&#34;</span><span class="op" id="7349350">}</span><span class="op" id="7349351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349354">{</span><span class="ident" id="7349355">Lmicroseconds</span><span class="op" id="7349368">,</span>&nbsp;<span class="string" id="7349370">&#34;&#34;</span><span class="op" id="7349372">,</span>&nbsp;<span class="ident" id="7349374">Rtime</span>&nbsp;<span class="op" id="7349380">+</span>&nbsp;<span class="ident" id="7349382">Rmicroseconds</span>&nbsp;<span class="op" id="7349396">+</span>&nbsp;<span class="string" id="7349398">&#34;&nbsp;&#34;</span><span class="op" id="7349401">}</span><span class="op" id="7349402">,</span>&nbsp;<span class="comment" id="7349404">//&nbsp;microsec&nbsp;implies&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349430">{</span><span class="ident" id="7349431">Llongfile</span><span class="op" id="7349440">,</span>&nbsp;<span class="string" id="7349442">&#34;&#34;</span><span class="op" id="7349444">,</span>&nbsp;<span class="ident" id="7349446">Rlongfile</span>&nbsp;<span class="op" id="7349456">+</span>&nbsp;<span class="string" id="7349458">&#34;&nbsp;&#34;</span><span class="op" id="7349461">}</span><span class="op" id="7349462">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349465">{</span><span class="ident" id="7349466">Lshortfile</span><span class="op" id="7349476">,</span>&nbsp;<span class="string" id="7349478">&#34;&#34;</span><span class="op" id="7349480">,</span>&nbsp;<span class="ident" id="7349482">Rshortfile</span>&nbsp;<span class="op" id="7349493">+</span>&nbsp;<span class="string" id="7349495">&#34;&nbsp;&#34;</span><span class="op" id="7349498">}</span><span class="op" id="7349499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349502">{</span><span class="ident" id="7349503">Llongfile</span>&nbsp;<span class="op" id="7349513">|</span>&nbsp;<span class="ident" id="7349515">Lshortfile</span><span class="op" id="7349525">,</span>&nbsp;<span class="string" id="7349527">&#34;&#34;</span><span class="op" id="7349529">,</span>&nbsp;<span class="ident" id="7349531">Rshortfile</span>&nbsp;<span class="op" id="7349542">+</span>&nbsp;<span class="string" id="7349544">&#34;&nbsp;&#34;</span><span class="op" id="7349547">}</span><span class="op" id="7349548">,</span>&nbsp;<span class="comment" id="7349550">//&nbsp;shortfile&nbsp;overrides&nbsp;longfile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7349583">//&nbsp;everything&nbsp;at&nbsp;once:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349607">{</span><span class="ident" id="7349608">Ldate</span>&nbsp;<span class="op" id="7349614">|</span>&nbsp;<span class="ident" id="7349616">Ltime</span>&nbsp;<span class="op" id="7349622">|</span>&nbsp;<span class="ident" id="7349624">Lmicroseconds</span>&nbsp;<span class="op" id="7349638">|</span>&nbsp;<span class="ident" id="7349640">Llongfile</span><span class="op" id="7349649">,</span>&nbsp;<span class="string" id="7349651">&#34;XXX&#34;</span><span class="op" id="7349656">,</span>&nbsp;<span class="string" id="7349658">&#34;XXX&#34;</span>&nbsp;<span class="op" id="7349664">+</span>&nbsp;<span class="ident" id="7349666">Rdate</span>&nbsp;<span class="op" id="7349672">+</span>&nbsp;<span class="string" id="7349674">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7349678">+</span>&nbsp;<span class="ident" id="7349680">Rtime</span>&nbsp;<span class="op" id="7349686">+</span>&nbsp;<span class="ident" id="7349688">Rmicroseconds</span>&nbsp;<span class="op" id="7349702">+</span>&nbsp;<span class="string" id="7349704">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7349708">+</span>&nbsp;<span class="ident" id="7349710">Rlongfile</span>&nbsp;<span class="op" id="7349720">+</span>&nbsp;<span class="string" id="7349722">&#34;&nbsp;&#34;</span><span class="op" id="7349725">}</span><span class="op" id="7349726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349729">{</span><span class="ident" id="7349730">Ldate</span>&nbsp;<span class="op" id="7349736">|</span>&nbsp;<span class="ident" id="7349738">Ltime</span>&nbsp;<span class="op" id="7349744">|</span>&nbsp;<span class="ident" id="7349746">Lmicroseconds</span>&nbsp;<span class="op" id="7349760">|</span>&nbsp;<span class="ident" id="7349762">Lshortfile</span><span class="op" id="7349772">,</span>&nbsp;<span class="string" id="7349774">&#34;XXX&#34;</span><span class="op" id="7349779">,</span>&nbsp;<span class="string" id="7349781">&#34;XXX&#34;</span>&nbsp;<span class="op" id="7349787">+</span>&nbsp;<span class="ident" id="7349789">Rdate</span>&nbsp;<span class="op" id="7349795">+</span>&nbsp;<span class="string" id="7349797">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7349801">+</span>&nbsp;<span class="ident" id="7349803">Rtime</span>&nbsp;<span class="op" id="7349809">+</span>&nbsp;<span class="ident" id="7349811">Rmicroseconds</span>&nbsp;<span class="op" id="7349825">+</span>&nbsp;<span class="string" id="7349827">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7349831">+</span>&nbsp;<span class="ident" id="7349833">Rshortfile</span>&nbsp;<span class="op" id="7349844">+</span>&nbsp;<span class="string" id="7349846">&#34;&nbsp;&#34;</span><span class="op" id="7349849">}</span><span class="op" id="7349850">,</span><br>
<span class="lineno">45</span><span class="op" id="7349852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7349855">//&nbsp;Test&nbsp;using&nbsp;Println(&#34;hello&#34;,&nbsp;23,&nbsp;&#34;world&#34;)&nbsp;or&nbsp;using&nbsp;Printf(&#34;hello&nbsp;%d&nbsp;world&#34;,&nbsp;23)</span><br>
<span class="lineno"></span><span class="keyword" id="7349937">func</span>&nbsp;<span class="ident" id="7349942">testPrint</span><span class="op" id="7349951">(</span><span class="ident" id="7349952">t</span>&nbsp;<span class="op" id="7349954">*</span><span class="ident" id="7349955">testing</span><span class="op" id="7349962">.</span><span class="ident" id="7349963">T</span><span class="op" id="7349964">,</span>&nbsp;<span class="ident" id="7349966">flag</span>&nbsp;<span class="builtintype" id="7349971">int</span><span class="op" id="7349974">,</span>&nbsp;<span class="ident" id="7349976">prefix</span>&nbsp;<span class="builtintype" id="7349983">string</span><span class="op" id="7349989">,</span>&nbsp;<span class="ident" id="7349991">pattern</span>&nbsp;<span class="builtintype" id="7349999">string</span><span class="op" id="7350005">,</span>&nbsp;<span class="ident" id="7350007">useFormat</span>&nbsp;<span class="builtintype" id="7350017">bool</span><span class="op" id="7350021">)</span>&nbsp;<span class="op" id="7350023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350026">buf</span>&nbsp;<span class="op" id="7350030">:=</span>&nbsp;<span class="builtinfunc" id="7350033">new</span><span class="op" id="7350036">(</span><span class="ident" id="7350037">bytes</span><span class="op" id="7350042">.</span><span class="ident" id="7350043">Buffer</span><span class="op" id="7350049">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350052">SetOutput</span><span class="op" id="7350061">(</span><span class="ident" id="7350062">buf</span><span class="op" id="7350065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350068">SetFlags</span><span class="op" id="7350076">(</span><span class="ident" id="7350077">flag</span><span class="op" id="7350081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350084">SetPrefix</span><span class="op" id="7350093">(</span><span class="ident" id="7350094">prefix</span><span class="op" id="7350100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350103">if</span>&nbsp;<span class="ident" id="7350106">useFormat</span>&nbsp;<span class="op" id="7350116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350120">Printf</span><span class="op" id="7350126">(</span><span class="string" id="7350127">&#34;hello&nbsp;%d&nbsp;world&#34;</span><span class="op" id="7350143">,</span>&nbsp;<span class="num" id="7350145">23</span><span class="op" id="7350147">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350150">}</span>&nbsp;<span class="keyword" id="7350152">else</span>&nbsp;<span class="op" id="7350157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350161">Println</span><span class="op" id="7350168">(</span><span class="string" id="7350169">&#34;hello&#34;</span><span class="op" id="7350176">,</span>&nbsp;<span class="num" id="7350178">23</span><span class="op" id="7350180">,</span>&nbsp;<span class="string" id="7350182">&#34;world&#34;</span><span class="op" id="7350189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350195">line</span>&nbsp;<span class="op" id="7350200">:=</span>&nbsp;<span class="ident" id="7350203">buf</span><span class="op" id="7350206">.</span><span class="ident" id="7350207">String</span><span class="op" id="7350213">(</span><span class="op" id="7350214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350217">line</span>&nbsp;<span class="op" id="7350222">=</span>&nbsp;<span class="ident" id="7350224">line</span><span class="op" id="7350228">[</span><span class="num" id="7350229">0</span>&nbsp;<span class="op" id="7350231">:</span>&nbsp;<span class="builtinfunc" id="7350233">len</span><span class="op" id="7350236">(</span><span class="ident" id="7350237">line</span><span class="op" id="7350241">)</span><span class="op" id="7350242">-</span><span class="num" id="7350243">1</span><span class="op" id="7350244">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350247">pattern</span>&nbsp;<span class="op" id="7350255">=</span>&nbsp;<span class="string" id="7350257">&#34;^&#34;</span>&nbsp;<span class="op" id="7350261">+</span>&nbsp;<span class="ident" id="7350263">pattern</span>&nbsp;<span class="op" id="7350271">+</span>&nbsp;<span class="string" id="7350273">&#34;hello&nbsp;23&nbsp;world$&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350292">matched</span><span class="op" id="7350299">,</span>&nbsp;<span class="ident" id="7350301">err4</span>&nbsp;<span class="op" id="7350306">:=</span>&nbsp;<span class="ident" id="7350309">regexp</span><span class="op" id="7350315">.</span><span class="ident" id="7350316">MatchString</span><span class="op" id="7350327">(</span><span class="ident" id="7350328">pattern</span><span class="op" id="7350335">,</span>&nbsp;<span class="ident" id="7350337">line</span><span class="op" id="7350341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350344">if</span>&nbsp;<span class="ident" id="7350347">err4</span>&nbsp;<span class="op" id="7350352">!=</span>&nbsp;<span class="ident" id="7350355">nil</span>&nbsp;<span class="op" id="7350359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350363">t</span><span class="op" id="7350364">.</span><span class="ident" id="7350365">Fatal</span><span class="op" id="7350370">(</span><span class="string" id="7350371">&#34;pattern&nbsp;did&nbsp;not&nbsp;compile:&#34;</span><span class="op" id="7350397">,</span>&nbsp;<span class="ident" id="7350399">err4</span><span class="op" id="7350403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350406">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350409">if</span>&nbsp;<span class="op" id="7350412">!</span><span class="ident" id="7350413">matched</span>&nbsp;<span class="op" id="7350421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350425">t</span><span class="op" id="7350426">.</span><span class="ident" id="7350427">Errorf</span><span class="op" id="7350433">(</span><span class="string" id="7350434">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="7350468">,</span>&nbsp;<span class="ident" id="7350470">pattern</span><span class="op" id="7350477">,</span>&nbsp;<span class="ident" id="7350479">line</span><span class="op" id="7350483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350489">SetOutput</span><span class="op" id="7350498">(</span><span class="ident" id="7350499">os</span><span class="op" id="7350501">.</span><span class="ident" id="7350502">Stderr</span><span class="op" id="7350508">)</span><br>
<span class="lineno"></span><span class="op" id="7350510">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7350513">func</span>&nbsp;<span class="ident" id="7350518">TestAll</span><span class="op" id="7350525">(</span><span class="ident" id="7350526">t</span>&nbsp;<span class="op" id="7350528">*</span><span class="ident" id="7350529">testing</span><span class="op" id="7350536">.</span><span class="ident" id="7350537">T</span><span class="op" id="7350538">)</span>&nbsp;<span class="op" id="7350540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350543">for</span>&nbsp;<span class="ident" id="7350547">_</span><span class="op" id="7350548">,</span>&nbsp;<span class="ident" id="7350550">testcase</span>&nbsp;<span class="op" id="7350559">:=</span>&nbsp;<span class="keyword" id="7350562">range</span>&nbsp;<span class="ident" id="7350568">tests</span>&nbsp;<span class="op" id="7350574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350578">testPrint</span><span class="op" id="7350587">(</span><span class="ident" id="7350588">t</span><span class="op" id="7350589">,</span>&nbsp;<span class="ident" id="7350591">testcase</span><span class="op" id="7350599">.</span><span class="ident" id="7350600">flag</span><span class="op" id="7350604">,</span>&nbsp;<span class="ident" id="7350606">testcase</span><span class="op" id="7350614">.</span><span class="ident" id="7350615">prefix</span><span class="op" id="7350621">,</span>&nbsp;<span class="ident" id="7350623">testcase</span><span class="op" id="7350631">.</span><span class="ident" id="7350632">pattern</span><span class="op" id="7350639">,</span>&nbsp;<span class="builtintype" id="7350641">false</span><span class="op" id="7350646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350650">testPrint</span><span class="op" id="7350659">(</span><span class="ident" id="7350660">t</span><span class="op" id="7350661">,</span>&nbsp;<span class="ident" id="7350663">testcase</span><span class="op" id="7350671">.</span><span class="ident" id="7350672">flag</span><span class="op" id="7350676">,</span>&nbsp;<span class="ident" id="7350678">testcase</span><span class="op" id="7350686">.</span><span class="ident" id="7350687">prefix</span><span class="op" id="7350693">,</span>&nbsp;<span class="ident" id="7350695">testcase</span><span class="op" id="7350703">.</span><span class="ident" id="7350704">pattern</span><span class="op" id="7350711">,</span>&nbsp;<span class="builtintype" id="7350713">true</span><span class="op" id="7350717">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350720">}</span><br>
<span class="lineno"></span><span class="op" id="7350722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7350725">func</span>&nbsp;<span class="ident" id="7350730">TestOutput</span><span class="op" id="7350740">(</span><span class="ident" id="7350741">t</span>&nbsp;<span class="op" id="7350743">*</span><span class="ident" id="7350744">testing</span><span class="op" id="7350751">.</span><span class="ident" id="7350752">T</span><span class="op" id="7350753">)</span>&nbsp;<span class="op" id="7350755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350758">const</span>&nbsp;<span class="ident" id="7350764">testString</span>&nbsp;<span class="op" id="7350775">=</span>&nbsp;<span class="string" id="7350777">&#34;test&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350785">var</span>&nbsp;<span class="ident" id="7350789">b</span>&nbsp;<span class="ident" id="7350791">bytes</span><span class="op" id="7350796">.</span><span class="ident" id="7350797">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350805">l</span>&nbsp;<span class="op" id="7350807">:=</span>&nbsp;<span class="ident" id="7350810">New</span><span class="op" id="7350813">(</span><span class="op" id="7350814">&amp;</span><span class="ident" id="7350815">b</span><span class="op" id="7350816">,</span>&nbsp;<span class="string" id="7350818">&#34;&#34;</span><span class="op" id="7350820">,</span>&nbsp;<span class="num" id="7350822">0</span><span class="op" id="7350823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350826">l</span><span class="op" id="7350827">.</span><span class="ident" id="7350828">Println</span><span class="op" id="7350835">(</span><span class="ident" id="7350836">testString</span><span class="op" id="7350846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350849">if</span>&nbsp;<span class="ident" id="7350852">expect</span>&nbsp;<span class="op" id="7350859">:=</span>&nbsp;<span class="ident" id="7350862">testString</span>&nbsp;<span class="op" id="7350873">+</span>&nbsp;<span class="string" id="7350875">&#34;\n&#34;</span><span class="op" id="7350879">;</span>&nbsp;<span class="ident" id="7350881">b</span><span class="op" id="7350882">.</span><span class="ident" id="7350883">String</span><span class="op" id="7350889">(</span><span class="op" id="7350890">)</span>&nbsp;<span class="op" id="7350892">!=</span>&nbsp;<span class="ident" id="7350895">expect</span>&nbsp;<span class="op" id="7350902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350906">t</span><span class="op" id="7350907">.</span><span class="ident" id="7350908">Errorf</span><span class="op" id="7350914">(</span><span class="string" id="7350915">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="7350949">,</span>&nbsp;<span class="ident" id="7350951">expect</span><span class="op" id="7350957">,</span>&nbsp;<span class="ident" id="7350959">b</span><span class="op" id="7350960">.</span><span class="ident" id="7350961">String</span><span class="op" id="7350967">(</span><span class="op" id="7350968">)</span><span class="op" id="7350969">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350972">}</span><br>
<span class="lineno"></span><span class="op" id="7350974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7350977">func</span>&nbsp;<span class="ident" id="7350982">TestFlagAndPrefixSetting</span><span class="op" id="7351006">(</span><span class="ident" id="7351007">t</span>&nbsp;<span class="op" id="7351009">*</span><span class="ident" id="7351010">testing</span><span class="op" id="7351017">.</span><span class="ident" id="7351018">T</span><span class="op" id="7351019">)</span>&nbsp;<span class="op" id="7351021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7351024">var</span>&nbsp;<span class="ident" id="7351028">b</span>&nbsp;<span class="ident" id="7351030">bytes</span><span class="op" id="7351035">.</span><span class="ident" id="7351036">Buffer</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351044">l</span>&nbsp;<span class="op" id="7351046">:=</span>&nbsp;<span class="ident" id="7351049">New</span><span class="op" id="7351052">(</span><span class="op" id="7351053">&amp;</span><span class="ident" id="7351054">b</span><span class="op" id="7351055">,</span>&nbsp;<span class="string" id="7351057">&#34;Test:&#34;</span><span class="op" id="7351064">,</span>&nbsp;<span class="ident" id="7351066">LstdFlags</span><span class="op" id="7351075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351078">f</span>&nbsp;<span class="op" id="7351080">:=</span>&nbsp;<span class="ident" id="7351083">l</span><span class="op" id="7351084">.</span><span class="ident" id="7351085">Flags</span><span class="op" id="7351090">(</span><span class="op" id="7351091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7351094">if</span>&nbsp;<span class="ident" id="7351097">f</span>&nbsp;<span class="op" id="7351099">!=</span>&nbsp;<span class="ident" id="7351102">LstdFlags</span>&nbsp;<span class="op" id="7351112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351116">t</span><span class="op" id="7351117">.</span><span class="ident" id="7351118">Errorf</span><span class="op" id="7351124">(</span><span class="string" id="7351125">&#34;Flags&nbsp;1:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="7351154">,</span>&nbsp;<span class="ident" id="7351156">LstdFlags</span><span class="op" id="7351165">,</span>&nbsp;<span class="ident" id="7351167">f</span><span class="op" id="7351168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7351171">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351174">l</span><span class="op" id="7351175">.</span><span class="ident" id="7351176">SetFlags</span><span class="op" id="7351184">(</span><span class="ident" id="7351185">f</span>&nbsp;<span class="op" id="7351187">|</span>&nbsp;<span class="ident" id="7351189">Lmicroseconds</span><span class="op" id="7351202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351205">f</span>&nbsp;<span class="op" id="7351207">=</span>&nbsp;<span class="ident" id="7351209">l</span><span class="op" id="7351210">.</span><span class="ident" id="7351211">Flags</span><span class="op" id="7351216">(</span><span class="op" id="7351217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7351220">if</span>&nbsp;<span class="ident" id="7351223">f</span>&nbsp;<span class="op" id="7351225">!=</span>&nbsp;<span class="ident" id="7351228">LstdFlags</span><span class="op" id="7351237">|</span><span class="ident" id="7351238">Lmicroseconds</span>&nbsp;<span class="op" id="7351252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351256">t</span><span class="op" id="7351257">.</span><span class="ident" id="7351258">Errorf</span><span class="op" id="7351264">(</span><span class="string" id="7351265">&#34;Flags&nbsp;2:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="7351294">,</span>&nbsp;<span class="ident" id="7351296">LstdFlags</span><span class="op" id="7351305">|</span><span class="ident" id="7351306">Lmicroseconds</span><span class="op" id="7351319">,</span>&nbsp;<span class="ident" id="7351321">f</span><span class="op" id="7351322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7351325">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351328">p</span>&nbsp;<span class="op" id="7351330">:=</span>&nbsp;<span class="ident" id="7351333">l</span><span class="op" id="7351334">.</span><span class="ident" id="7351335">Prefix</span><span class="op" id="7351341">(</span><span class="op" id="7351342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7351345">if</span>&nbsp;<span class="ident" id="7351348">p</span>&nbsp;<span class="op" id="7351350">!=</span>&nbsp;<span class="string" id="7351353">&#34;Test:&#34;</span>&nbsp;<span class="op" id="7351361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351365">t</span><span class="op" id="7351366">.</span><span class="ident" id="7351367">Errorf</span><span class="op" id="7351373">(</span><span class="string" id="7351374">`Prefix:&nbsp;expected&nbsp;&#34;Test:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="7351407">,</span>&nbsp;<span class="ident" id="7351409">p</span><span class="op" id="7351410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7351413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351416">l</span><span class="op" id="7351417">.</span><span class="ident" id="7351418">SetPrefix</span><span class="op" id="7351427">(</span><span class="string" id="7351428">&#34;Reality:&#34;</span><span class="op" id="7351438">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351441">p</span>&nbsp;<span class="op" id="7351443">=</span>&nbsp;<span class="ident" id="7351445">l</span><span class="op" id="7351446">.</span><span class="ident" id="7351447">Prefix</span><span class="op" id="7351453">(</span><span class="op" id="7351454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7351457">if</span>&nbsp;<span class="ident" id="7351460">p</span>&nbsp;<span class="op" id="7351462">!=</span>&nbsp;<span class="string" id="7351465">&#34;Reality:&#34;</span>&nbsp;<span class="op" id="7351476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351480">t</span><span class="op" id="7351481">.</span><span class="ident" id="7351482">Errorf</span><span class="op" id="7351488">(</span><span class="string" id="7351489">`Prefix:&nbsp;expected&nbsp;&#34;Reality:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="7351525">,</span>&nbsp;<span class="ident" id="7351527">p</span><span class="op" id="7351528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7351531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7351534">//&nbsp;Verify&nbsp;a&nbsp;log&nbsp;message&nbsp;looks&nbsp;right,&nbsp;with&nbsp;our&nbsp;prefix&nbsp;and&nbsp;microseconds&nbsp;present.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351614">l</span><span class="op" id="7351615">.</span><span class="ident" id="7351616">Print</span><span class="op" id="7351621">(</span><span class="string" id="7351622">&#34;hello&#34;</span><span class="op" id="7351629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351632">pattern</span>&nbsp;<span class="op" id="7351640">:=</span>&nbsp;<span class="string" id="7351643">&#34;^Reality:&#34;</span>&nbsp;<span class="op" id="7351655">+</span>&nbsp;<span class="ident" id="7351657">Rdate</span>&nbsp;<span class="op" id="7351663">+</span>&nbsp;<span class="string" id="7351665">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7351669">+</span>&nbsp;<span class="ident" id="7351671">Rtime</span>&nbsp;<span class="op" id="7351677">+</span>&nbsp;<span class="ident" id="7351679">Rmicroseconds</span>&nbsp;<span class="op" id="7351693">+</span>&nbsp;<span class="string" id="7351695">&#34;&nbsp;hello\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351707">matched</span><span class="op" id="7351714">,</span>&nbsp;<span class="ident" id="7351716">err</span>&nbsp;<span class="op" id="7351720">:=</span>&nbsp;<span class="ident" id="7351723">regexp</span><span class="op" id="7351729">.</span><span class="ident" id="7351730">Match</span><span class="op" id="7351735">(</span><span class="ident" id="7351736">pattern</span><span class="op" id="7351743">,</span>&nbsp;<span class="ident" id="7351745">b</span><span class="op" id="7351746">.</span><span class="ident" id="7351747">Bytes</span><span class="op" id="7351752">(</span><span class="op" id="7351753">)</span><span class="op" id="7351754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7351757">if</span>&nbsp;<span class="ident" id="7351760">err</span>&nbsp;<span class="op" id="7351764">!=</span>&nbsp;<span class="ident" id="7351767">nil</span>&nbsp;<span class="op" id="7351771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351775">t</span><span class="op" id="7351776">.</span><span class="ident" id="7351777">Fatalf</span><span class="op" id="7351783">(</span><span class="string" id="7351784">&#34;pattern&nbsp;%q&nbsp;did&nbsp;not&nbsp;compile:&nbsp;%s&#34;</span><span class="op" id="7351816">,</span>&nbsp;<span class="ident" id="7351818">pattern</span><span class="op" id="7351825">,</span>&nbsp;<span class="ident" id="7351827">err</span><span class="op" id="7351830">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7351833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7351836">if</span>&nbsp;<span class="op" id="7351839">!</span><span class="ident" id="7351840">matched</span>&nbsp;<span class="op" id="7351848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351852">t</span><span class="op" id="7351853">.</span><span class="ident" id="7351854">Error</span><span class="op" id="7351859">(</span><span class="string" id="7351860">&#34;message&nbsp;did&nbsp;not&nbsp;match&nbsp;pattern&#34;</span><span class="op" id="7351891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7351894">}</span><br>
<span class="lineno"></span><span class="op" id="7351896">}</span>
</div>
</body>
</html>
