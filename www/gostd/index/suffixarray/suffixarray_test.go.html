<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>index/suffixarray</h2>
<ul>
<li><a href="/gostd/index/suffixarray/qsufsort.go.html">qsufsort.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray.go.html">suffixarray.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray_test.go.html" class="current">suffixarray_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6853984">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6854039">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6854093">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6854144">package</span>&nbsp;<span class="ident" id="6854152">suffixarray</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6854165">import</span>&nbsp;<span class="op" id="6854172">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854175">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854184">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854197">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854207">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854215">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854226">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6854236">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6854239">type</span>&nbsp;<span class="ident" id="6854244">testCase</span>&nbsp;<span class="keyword" id="6854253">struct</span>&nbsp;<span class="op" id="6854260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6854263">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6854272">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6854281">//&nbsp;name&nbsp;of&nbsp;test&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6854303">source</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6854312">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6854321">//&nbsp;source&nbsp;to&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6854341">patterns</span>&nbsp;<span class="op" id="6854350">[</span><span class="op" id="6854351">]</span><span class="builtintype" id="6854352">string</span>&nbsp;<span class="comment" id="6854359">//&nbsp;patterns&nbsp;to&nbsp;lookup</span><br>
<span class="lineno">20</span><span class="op" id="6854381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6854384">var</span>&nbsp;<span class="ident" id="6854388">testCases</span>&nbsp;<span class="op" id="6854398">=</span>&nbsp;<span class="op" id="6854400">[</span><span class="op" id="6854401">]</span><span class="ident" id="6854402">testCase</span><span class="op" id="6854410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6854413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854417">&#34;empty&nbsp;string&#34;</span><span class="op" id="6854431">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854435">&#34;&#34;</span><span class="op" id="6854437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6854441">[</span><span class="op" id="6854442">]</span><span class="builtintype" id="6854443">string</span><span class="op" id="6854449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854454">&#34;&#34;</span><span class="op" id="6854456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854461">&#34;foo&#34;</span><span class="op" id="6854466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854471">&#34;(foo)&#34;</span><span class="op" id="6854478">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854483">&#34;.*&#34;</span><span class="op" id="6854487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854492">&#34;a*&#34;</span><span class="op" id="6854496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6854500">}</span><span class="op" id="6854501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6854504">}</span><span class="op" id="6854505">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6854509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854513">&#34;all&nbsp;a&#39;s&#34;</span><span class="op" id="6854522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854526">&#34;aaaaaaaaaa&#34;</span><span class="op" id="6854538">,</span>&nbsp;<span class="comment" id="6854540">//&nbsp;10&nbsp;a&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6854552">[</span><span class="op" id="6854553">]</span><span class="builtintype" id="6854554">string</span><span class="op" id="6854560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854565">&#34;&#34;</span><span class="op" id="6854567">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854572">&#34;a&#34;</span><span class="op" id="6854575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854580">&#34;aa&#34;</span><span class="op" id="6854584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854589">&#34;aaa&#34;</span><span class="op" id="6854594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854599">&#34;aaaa&#34;</span><span class="op" id="6854605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854610">&#34;aaaaa&#34;</span><span class="op" id="6854617">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854622">&#34;aaaaaa&#34;</span><span class="op" id="6854630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854635">&#34;aaaaaaa&#34;</span><span class="op" id="6854644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854649">&#34;aaaaaaaa&#34;</span><span class="op" id="6854659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854664">&#34;aaaaaaaaa&#34;</span><span class="op" id="6854675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854680">&#34;aaaaaaaaaa&#34;</span><span class="op" id="6854692">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854697">&#34;aaaaaaaaaaa&#34;</span><span class="op" id="6854710">,</span>&nbsp;<span class="comment" id="6854712">//&nbsp;11&nbsp;a&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854725">&#34;.&#34;</span><span class="op" id="6854728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854733">&#34;.*&#34;</span><span class="op" id="6854737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854742">&#34;a+&#34;</span><span class="op" id="6854746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854751">&#34;aa+&#34;</span><span class="op" id="6854756">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854761">&#34;aaaa[b]?&#34;</span><span class="op" id="6854771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854776">&#34;aaa*&#34;</span><span class="op" id="6854782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6854786">}</span><span class="op" id="6854787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6854790">}</span><span class="op" id="6854791">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6854795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854799">&#34;abc&#34;</span><span class="op" id="6854804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854808">&#34;abc&#34;</span><span class="op" id="6854813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6854817">[</span><span class="op" id="6854818">]</span><span class="builtintype" id="6854819">string</span><span class="op" id="6854825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854830">&#34;a&#34;</span><span class="op" id="6854833">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854838">&#34;b&#34;</span><span class="op" id="6854841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854846">&#34;c&#34;</span><span class="op" id="6854849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854854">&#34;ab&#34;</span><span class="op" id="6854858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854863">&#34;bc&#34;</span><span class="op" id="6854867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854872">&#34;abc&#34;</span><span class="op" id="6854877">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854882">&#34;a.c&#34;</span><span class="op" id="6854887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854892">&#34;a(b|c)&#34;</span><span class="op" id="6854900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854905">&#34;abc?&#34;</span><span class="op" id="6854911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6854915">}</span><span class="op" id="6854916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6854919">}</span><span class="op" id="6854920">,</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6854924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854928">&#34;barbara*3&#34;</span><span class="op" id="6854939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854943">&#34;barbarabarbarabarbara&#34;</span><span class="op" id="6854966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6854970">[</span><span class="op" id="6854971">]</span><span class="builtintype" id="6854972">string</span><span class="op" id="6854978">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854983">&#34;a&#34;</span><span class="op" id="6854986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6854991">&#34;bar&#34;</span><span class="op" id="6854996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6855001">&#34;rab&#34;</span><span class="op" id="6855006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6855011">&#34;arab&#34;</span><span class="op" id="6855017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6855022">&#34;barbar&#34;</span><span class="op" id="6855030">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6855035">&#34;bara?bar&#34;</span><span class="op" id="6855045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855049">}</span><span class="op" id="6855050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855053">}</span><span class="op" id="6855054">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855058">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6855062">&#34;typing&nbsp;drill&#34;</span><span class="op" id="6855076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6855080">&#34;Now&nbsp;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="6855151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855155">[</span><span class="op" id="6855156">]</span><span class="builtintype" id="6855157">string</span><span class="op" id="6855163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6855168">&#34;Now&#34;</span><span class="op" id="6855173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6855178">&#34;the&nbsp;time&#34;</span><span class="op" id="6855188">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6855193">&#34;to&nbsp;come&nbsp;the&nbsp;aid&#34;</span><span class="op" id="6855210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6855215">&#34;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&#34;</span><span class="op" id="6855273">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6855278">&#34;to&nbsp;(come|the)?&#34;</span><span class="op" id="6855294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855298">}</span><span class="op" id="6855299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855302">}</span><span class="op" id="6855303">,</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6855311">&#34;godoc&nbsp;simulation&#34;</span><span class="op" id="6855329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6855333">&#34;package&nbsp;main\n\nimport(\n&nbsp;&nbsp;&nbsp;&nbsp;\&#34;rand\&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="6855378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855382">[</span><span class="op" id="6855383">]</span><span class="builtintype" id="6855384">string</span><span class="op" id="6855390">{</span><span class="op" id="6855391">}</span><span class="op" id="6855392">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855395">}</span><span class="op" id="6855396">,</span><br>
<span class="lineno"></span><span class="op" id="6855398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6855401">//&nbsp;find&nbsp;all&nbsp;occurrences&nbsp;of&nbsp;s&nbsp;in&nbsp;source;&nbsp;report&nbsp;at&nbsp;most&nbsp;n&nbsp;occurrences</span><br>
<span class="lineno"></span><span class="keyword" id="6855470">func</span>&nbsp;<span class="ident" id="6855475">find</span><span class="op" id="6855479">(</span><span class="ident" id="6855480">src</span><span class="op" id="6855483">,</span>&nbsp;<span class="ident" id="6855485">s</span>&nbsp;<span class="builtintype" id="6855487">string</span><span class="op" id="6855493">,</span>&nbsp;<span class="ident" id="6855495">n</span>&nbsp;<span class="builtintype" id="6855497">int</span><span class="op" id="6855500">)</span>&nbsp;<span class="op" id="6855502">[</span><span class="op" id="6855503">]</span><span class="builtintype" id="6855504">int</span>&nbsp;<span class="op" id="6855508">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6855511">var</span>&nbsp;<span class="ident" id="6855515">res</span>&nbsp;<span class="op" id="6855519">[</span><span class="op" id="6855520">]</span><span class="builtintype" id="6855521">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6855526">if</span>&nbsp;<span class="ident" id="6855529">s</span>&nbsp;<span class="op" id="6855531">!=</span>&nbsp;<span class="string" id="6855534">&#34;&#34;</span>&nbsp;<span class="op" id="6855537">&amp;&amp;</span>&nbsp;<span class="ident" id="6855540">n</span>&nbsp;<span class="op" id="6855542">!=</span>&nbsp;<span class="num" id="6855545">0</span>&nbsp;<span class="op" id="6855547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6855551">//&nbsp;find&nbsp;at&nbsp;most&nbsp;n&nbsp;occurrences&nbsp;of&nbsp;s&nbsp;in&nbsp;src</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6855595">for</span>&nbsp;<span class="ident" id="6855599">i</span>&nbsp;<span class="op" id="6855601">:=</span>&nbsp;<span class="op" id="6855604">-</span><span class="num" id="6855605">1</span><span class="op" id="6855606">;</span>&nbsp;<span class="ident" id="6855608">n</span>&nbsp;<span class="op" id="6855610">&lt;</span>&nbsp;<span class="num" id="6855612">0</span>&nbsp;<span class="op" id="6855614">||</span>&nbsp;<span class="builtinfunc" id="6855617">len</span><span class="op" id="6855620">(</span><span class="ident" id="6855621">res</span><span class="op" id="6855624">)</span>&nbsp;<span class="op" id="6855626">&lt;</span>&nbsp;<span class="ident" id="6855628">n</span><span class="op" id="6855629">;</span>&nbsp;<span class="op" id="6855631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6855636">j</span>&nbsp;<span class="op" id="6855638">:=</span>&nbsp;<span class="ident" id="6855641">strings</span><span class="op" id="6855648">.</span><span class="ident" id="6855649">Index</span><span class="op" id="6855654">(</span><span class="ident" id="6855655">src</span><span class="op" id="6855658">[</span><span class="ident" id="6855659">i</span><span class="op" id="6855660">+</span><span class="num" id="6855661">1</span><span class="op" id="6855662">:</span><span class="op" id="6855663">]</span><span class="op" id="6855664">,</span>&nbsp;<span class="ident" id="6855666">s</span><span class="op" id="6855667">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6855672">if</span>&nbsp;<span class="ident" id="6855675">j</span>&nbsp;<span class="op" id="6855677">&lt;</span>&nbsp;<span class="num" id="6855679">0</span>&nbsp;<span class="op" id="6855681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6855687">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6855701">i</span>&nbsp;<span class="op" id="6855703">+=</span>&nbsp;<span class="ident" id="6855706">j</span>&nbsp;<span class="op" id="6855708">+</span>&nbsp;<span class="num" id="6855710">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6855715">res</span>&nbsp;<span class="op" id="6855719">=</span>&nbsp;<span class="builtinfunc" id="6855721">append</span><span class="op" id="6855727">(</span><span class="ident" id="6855728">res</span><span class="op" id="6855731">,</span>&nbsp;<span class="ident" id="6855733">i</span><span class="op" id="6855734">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6855744">return</span>&nbsp;<span class="ident" id="6855751">res</span><br>
<span class="lineno"></span><span class="op" id="6855755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="6855758">func</span>&nbsp;<span class="ident" id="6855763">testLookup</span><span class="op" id="6855773">(</span><span class="ident" id="6855774">t</span>&nbsp;<span class="op" id="6855776">*</span><span class="ident" id="6855777">testing</span><span class="op" id="6855784">.</span><span class="ident" id="6855785">T</span><span class="op" id="6855786">,</span>&nbsp;<span class="ident" id="6855788">tc</span>&nbsp;<span class="op" id="6855791">*</span><span class="ident" id="6855792">testCase</span><span class="op" id="6855800">,</span>&nbsp;<span class="ident" id="6855802">x</span>&nbsp;<span class="op" id="6855804">*</span><span class="ident" id="6855805">Index</span><span class="op" id="6855810">,</span>&nbsp;<span class="ident" id="6855812">s</span>&nbsp;<span class="builtintype" id="6855814">string</span><span class="op" id="6855820">,</span>&nbsp;<span class="ident" id="6855822">n</span>&nbsp;<span class="builtintype" id="6855824">int</span><span class="op" id="6855827">)</span>&nbsp;<span class="op" id="6855829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6855832">res</span>&nbsp;<span class="op" id="6855836">:=</span>&nbsp;<span class="ident" id="6855839">x</span><span class="op" id="6855840">.</span><span class="ident" id="6855841">Lookup</span><span class="op" id="6855847">(</span><span class="op" id="6855848">[</span><span class="op" id="6855849">]</span><span class="builtintype" id="6855850">byte</span><span class="op" id="6855854">(</span><span class="ident" id="6855855">s</span><span class="op" id="6855856">)</span><span class="op" id="6855857">,</span>&nbsp;<span class="ident" id="6855859">n</span><span class="op" id="6855860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6855863">exp</span>&nbsp;<span class="op" id="6855867">:=</span>&nbsp;<span class="ident" id="6855870">find</span><span class="op" id="6855874">(</span><span class="ident" id="6855875">tc</span><span class="op" id="6855877">.</span><span class="ident" id="6855878">source</span><span class="op" id="6855884">,</span>&nbsp;<span class="ident" id="6855886">s</span><span class="op" id="6855887">,</span>&nbsp;<span class="ident" id="6855889">n</span><span class="op" id="6855890">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6855894">//&nbsp;check&nbsp;that&nbsp;the&nbsp;lengths&nbsp;match</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6855927">if</span>&nbsp;<span class="builtinfunc" id="6855930">len</span><span class="op" id="6855933">(</span><span class="ident" id="6855934">res</span><span class="op" id="6855937">)</span>&nbsp;<span class="op" id="6855939">!=</span>&nbsp;<span class="builtinfunc" id="6855942">len</span><span class="op" id="6855945">(</span><span class="ident" id="6855946">exp</span><span class="op" id="6855949">)</span>&nbsp;<span class="op" id="6855951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6855955">t</span><span class="op" id="6855956">.</span><span class="ident" id="6855957">Errorf</span><span class="op" id="6855963">(</span><span class="string" id="6855964">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;expected&nbsp;%d&nbsp;results;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6856022">,</span>&nbsp;<span class="ident" id="6856024">tc</span><span class="op" id="6856026">.</span><span class="ident" id="6856027">name</span><span class="op" id="6856031">,</span>&nbsp;<span class="ident" id="6856033">s</span><span class="op" id="6856034">,</span>&nbsp;<span class="ident" id="6856036">n</span><span class="op" id="6856037">,</span>&nbsp;<span class="builtinfunc" id="6856039">len</span><span class="op" id="6856042">(</span><span class="ident" id="6856043">exp</span><span class="op" id="6856046">)</span><span class="op" id="6856047">,</span>&nbsp;<span class="builtinfunc" id="6856049">len</span><span class="op" id="6856052">(</span><span class="ident" id="6856053">res</span><span class="op" id="6856056">)</span><span class="op" id="6856057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6856060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6856064">//&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0&nbsp;the&nbsp;number&nbsp;of&nbsp;results&nbsp;is&nbsp;limited&nbsp;---&nbsp;unless&nbsp;n&nbsp;&gt;=&nbsp;all&nbsp;results,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6856140">//&nbsp;we&nbsp;may&nbsp;obtain&nbsp;different&nbsp;positions&nbsp;from&nbsp;the&nbsp;Index&nbsp;and&nbsp;from&nbsp;find&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6856216">//&nbsp;Index&nbsp;may&nbsp;not&nbsp;find&nbsp;the&nbsp;results&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;as&nbsp;find)&nbsp;=&gt;&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6856292">//&nbsp;we&nbsp;cannot&nbsp;simply&nbsp;check&nbsp;that&nbsp;the&nbsp;res&nbsp;and&nbsp;exp&nbsp;lists&nbsp;are&nbsp;equal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6856357">//&nbsp;check&nbsp;that&nbsp;each&nbsp;result&nbsp;is&nbsp;in&nbsp;fact&nbsp;a&nbsp;correct&nbsp;match&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;duplicates</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6856439">sort</span><span class="op" id="6856443">.</span><span class="ident" id="6856444">Ints</span><span class="op" id="6856448">(</span><span class="ident" id="6856449">res</span><span class="op" id="6856452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6856455">for</span>&nbsp;<span class="ident" id="6856459">i</span><span class="op" id="6856460">,</span>&nbsp;<span class="ident" id="6856462">r</span>&nbsp;<span class="op" id="6856464">:=</span>&nbsp;<span class="keyword" id="6856467">range</span>&nbsp;<span class="ident" id="6856473">res</span>&nbsp;<span class="op" id="6856477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6856481">if</span>&nbsp;<span class="ident" id="6856484">r</span>&nbsp;<span class="op" id="6856486">&lt;</span>&nbsp;<span class="num" id="6856488">0</span>&nbsp;<span class="op" id="6856490">||</span>&nbsp;<span class="builtinfunc" id="6856493">len</span><span class="op" id="6856496">(</span><span class="ident" id="6856497">tc</span><span class="op" id="6856499">.</span><span class="ident" id="6856500">source</span><span class="op" id="6856506">)</span>&nbsp;<span class="op" id="6856508">&lt;=</span>&nbsp;<span class="ident" id="6856511">r</span>&nbsp;<span class="op" id="6856513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6856518">t</span><span class="op" id="6856519">.</span><span class="ident" id="6856520">Errorf</span><span class="op" id="6856526">(</span><span class="string" id="6856527">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;index&nbsp;%d&nbsp;out&nbsp;of&nbsp;range&nbsp;[0,&nbsp;%d[&#34;</span><span class="op" id="6856598">,</span>&nbsp;<span class="ident" id="6856600">tc</span><span class="op" id="6856602">.</span><span class="ident" id="6856603">name</span><span class="op" id="6856607">,</span>&nbsp;<span class="ident" id="6856609">s</span><span class="op" id="6856610">,</span>&nbsp;<span class="ident" id="6856612">i</span><span class="op" id="6856613">,</span>&nbsp;<span class="ident" id="6856615">n</span><span class="op" id="6856616">,</span>&nbsp;<span class="ident" id="6856618">r</span><span class="op" id="6856619">,</span>&nbsp;<span class="builtinfunc" id="6856621">len</span><span class="op" id="6856624">(</span><span class="ident" id="6856625">tc</span><span class="op" id="6856627">.</span><span class="ident" id="6856628">source</span><span class="op" id="6856634">)</span><span class="op" id="6856635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6856639">}</span>&nbsp;<span class="keyword" id="6856641">else</span>&nbsp;<span class="keyword" id="6856646">if</span>&nbsp;<span class="op" id="6856649">!</span><span class="ident" id="6856650">strings</span><span class="op" id="6856657">.</span><span class="ident" id="6856658">HasPrefix</span><span class="op" id="6856667">(</span><span class="ident" id="6856668">tc</span><span class="op" id="6856670">.</span><span class="ident" id="6856671">source</span><span class="op" id="6856677">[</span><span class="ident" id="6856678">r</span><span class="op" id="6856679">:</span><span class="op" id="6856680">]</span><span class="op" id="6856681">,</span>&nbsp;<span class="ident" id="6856683">s</span><span class="op" id="6856684">)</span>&nbsp;<span class="op" id="6856686">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6856691">t</span><span class="op" id="6856692">.</span><span class="ident" id="6856693">Errorf</span><span class="op" id="6856699">(</span><span class="string" id="6856700">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;index&nbsp;%d&nbsp;not&nbsp;a&nbsp;match&#34;</span><span class="op" id="6856762">,</span>&nbsp;<span class="ident" id="6856764">tc</span><span class="op" id="6856766">.</span><span class="ident" id="6856767">name</span><span class="op" id="6856771">,</span>&nbsp;<span class="ident" id="6856773">s</span><span class="op" id="6856774">,</span>&nbsp;<span class="ident" id="6856776">i</span><span class="op" id="6856777">,</span>&nbsp;<span class="ident" id="6856779">n</span><span class="op" id="6856780">,</span>&nbsp;<span class="ident" id="6856782">r</span><span class="op" id="6856783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6856787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6856791">if</span>&nbsp;<span class="ident" id="6856794">i</span>&nbsp;<span class="op" id="6856796">&gt;</span>&nbsp;<span class="num" id="6856798">0</span>&nbsp;<span class="op" id="6856800">&amp;&amp;</span>&nbsp;<span class="ident" id="6856803">res</span><span class="op" id="6856806">[</span><span class="ident" id="6856807">i</span><span class="op" id="6856808">-</span><span class="num" id="6856809">1</span><span class="op" id="6856810">]</span>&nbsp;<span class="op" id="6856812">==</span>&nbsp;<span class="ident" id="6856815">r</span>&nbsp;<span class="op" id="6856817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6856822">t</span><span class="op" id="6856823">.</span><span class="ident" id="6856824">Errorf</span><span class="op" id="6856830">(</span><span class="string" id="6856831">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;found&nbsp;duplicate&nbsp;index&nbsp;%d&#34;</span><span class="op" id="6856897">,</span>&nbsp;<span class="ident" id="6856899">tc</span><span class="op" id="6856901">.</span><span class="ident" id="6856902">name</span><span class="op" id="6856906">,</span>&nbsp;<span class="ident" id="6856908">s</span><span class="op" id="6856909">,</span>&nbsp;<span class="ident" id="6856911">i</span><span class="op" id="6856912">,</span>&nbsp;<span class="ident" id="6856914">n</span><span class="op" id="6856915">,</span>&nbsp;<span class="ident" id="6856917">r</span><span class="op" id="6856918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6856922">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6856925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6856929">if</span>&nbsp;<span class="ident" id="6856932">n</span>&nbsp;<span class="op" id="6856934">&lt;</span>&nbsp;<span class="num" id="6856936">0</span>&nbsp;<span class="op" id="6856938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6856942">//&nbsp;all&nbsp;results&nbsp;computed&nbsp;-&nbsp;sorted&nbsp;res&nbsp;and&nbsp;exp&nbsp;must&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6857003">for</span>&nbsp;<span class="ident" id="6857007">i</span><span class="op" id="6857008">,</span>&nbsp;<span class="ident" id="6857010">r</span>&nbsp;<span class="op" id="6857012">:=</span>&nbsp;<span class="keyword" id="6857015">range</span>&nbsp;<span class="ident" id="6857021">res</span>&nbsp;<span class="op" id="6857025">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6857030">e</span>&nbsp;<span class="op" id="6857032">:=</span>&nbsp;<span class="ident" id="6857035">exp</span><span class="op" id="6857038">[</span><span class="ident" id="6857039">i</span><span class="op" id="6857040">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6857045">if</span>&nbsp;<span class="ident" id="6857048">r</span>&nbsp;<span class="op" id="6857050">!=</span>&nbsp;<span class="ident" id="6857053">e</span>&nbsp;<span class="op" id="6857055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6857061">t</span><span class="op" id="6857062">.</span><span class="ident" id="6857063">Errorf</span><span class="op" id="6857069">(</span><span class="string" id="6857070">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d:&nbsp;expected&nbsp;index&nbsp;%d;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6857128">,</span>&nbsp;<span class="ident" id="6857130">tc</span><span class="op" id="6857132">.</span><span class="ident" id="6857133">name</span><span class="op" id="6857137">,</span>&nbsp;<span class="ident" id="6857139">s</span><span class="op" id="6857140">,</span>&nbsp;<span class="ident" id="6857142">i</span><span class="op" id="6857143">,</span>&nbsp;<span class="ident" id="6857145">e</span><span class="op" id="6857146">,</span>&nbsp;<span class="ident" id="6857148">r</span><span class="op" id="6857149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6857154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6857158">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6857161">}</span><br>
<span class="lineno"></span><span class="op" id="6857163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6857166">func</span>&nbsp;<span class="ident" id="6857171">testFindAllIndex</span><span class="op" id="6857187">(</span><span class="ident" id="6857188">t</span>&nbsp;<span class="op" id="6857190">*</span><span class="ident" id="6857191">testing</span><span class="op" id="6857198">.</span><span class="ident" id="6857199">T</span><span class="op" id="6857200">,</span>&nbsp;<span class="ident" id="6857202">tc</span>&nbsp;<span class="op" id="6857205">*</span><span class="ident" id="6857206">testCase</span><span class="op" id="6857214">,</span>&nbsp;<span class="ident" id="6857216">x</span>&nbsp;<span class="op" id="6857218">*</span><span class="ident" id="6857219">Index</span><span class="op" id="6857224">,</span>&nbsp;<span class="ident" id="6857226">rx</span>&nbsp;<span class="op" id="6857229">*</span><span class="ident" id="6857230">regexp</span><span class="op" id="6857236">.</span><span class="ident" id="6857237">Regexp</span><span class="op" id="6857243">,</span>&nbsp;<span class="ident" id="6857245">n</span>&nbsp;<span class="builtintype" id="6857247">int</span><span class="op" id="6857250">)</span>&nbsp;<span class="op" id="6857252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6857255">res</span>&nbsp;<span class="op" id="6857259">:=</span>&nbsp;<span class="ident" id="6857262">x</span><span class="op" id="6857263">.</span><span class="ident" id="6857264">FindAllIndex</span><span class="op" id="6857276">(</span><span class="ident" id="6857277">rx</span><span class="op" id="6857279">,</span>&nbsp;<span class="ident" id="6857281">n</span><span class="op" id="6857282">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6857285">exp</span>&nbsp;<span class="op" id="6857289">:=</span>&nbsp;<span class="ident" id="6857292">rx</span><span class="op" id="6857294">.</span><span class="ident" id="6857295">FindAllStringIndex</span><span class="op" id="6857313">(</span><span class="ident" id="6857314">tc</span><span class="op" id="6857316">.</span><span class="ident" id="6857317">source</span><span class="op" id="6857323">,</span>&nbsp;<span class="ident" id="6857325">n</span><span class="op" id="6857326">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6857330">//&nbsp;check&nbsp;that&nbsp;the&nbsp;lengths&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6857363">if</span>&nbsp;<span class="builtinfunc" id="6857366">len</span><span class="op" id="6857369">(</span><span class="ident" id="6857370">res</span><span class="op" id="6857373">)</span>&nbsp;<span class="op" id="6857375">!=</span>&nbsp;<span class="builtinfunc" id="6857378">len</span><span class="op" id="6857381">(</span><span class="ident" id="6857382">exp</span><span class="op" id="6857385">)</span>&nbsp;<span class="op" id="6857387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6857391">t</span><span class="op" id="6857392">.</span><span class="ident" id="6857393">Errorf</span><span class="op" id="6857399">(</span><span class="string" id="6857400">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;expected&nbsp;%d&nbsp;results;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6857464">,</span>&nbsp;<span class="ident" id="6857466">tc</span><span class="op" id="6857468">.</span><span class="ident" id="6857469">name</span><span class="op" id="6857473">,</span>&nbsp;<span class="ident" id="6857475">rx</span><span class="op" id="6857477">,</span>&nbsp;<span class="ident" id="6857479">n</span><span class="op" id="6857480">,</span>&nbsp;<span class="builtinfunc" id="6857482">len</span><span class="op" id="6857485">(</span><span class="ident" id="6857486">exp</span><span class="op" id="6857489">)</span><span class="op" id="6857490">,</span>&nbsp;<span class="builtinfunc" id="6857492">len</span><span class="op" id="6857495">(</span><span class="ident" id="6857496">res</span><span class="op" id="6857499">)</span><span class="op" id="6857500">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6857503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6857507">//&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0&nbsp;the&nbsp;number&nbsp;of&nbsp;results&nbsp;is&nbsp;limited&nbsp;---&nbsp;unless&nbsp;n&nbsp;&gt;=&nbsp;all&nbsp;results,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6857583">//&nbsp;we&nbsp;may&nbsp;obtain&nbsp;different&nbsp;positions&nbsp;from&nbsp;the&nbsp;Index&nbsp;and&nbsp;from&nbsp;regexp&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6857661">//&nbsp;Index&nbsp;may&nbsp;not&nbsp;find&nbsp;the&nbsp;results&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;as&nbsp;regexp)&nbsp;=&gt;&nbsp;in&nbsp;general</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6857739">//&nbsp;we&nbsp;cannot&nbsp;simply&nbsp;check&nbsp;that&nbsp;the&nbsp;res&nbsp;and&nbsp;exp&nbsp;lists&nbsp;are&nbsp;equal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6857804">//&nbsp;check&nbsp;that&nbsp;each&nbsp;result&nbsp;is&nbsp;in&nbsp;fact&nbsp;a&nbsp;correct&nbsp;match&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;sorted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6857883">for</span>&nbsp;<span class="ident" id="6857887">i</span><span class="op" id="6857888">,</span>&nbsp;<span class="ident" id="6857890">r</span>&nbsp;<span class="op" id="6857892">:=</span>&nbsp;<span class="keyword" id="6857895">range</span>&nbsp;<span class="ident" id="6857901">res</span>&nbsp;<span class="op" id="6857905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6857909">if</span>&nbsp;<span class="ident" id="6857912">r</span><span class="op" id="6857913">[</span><span class="num" id="6857914">0</span><span class="op" id="6857915">]</span>&nbsp;<span class="op" id="6857917">&lt;</span>&nbsp;<span class="num" id="6857919">0</span>&nbsp;<span class="op" id="6857921">||</span>&nbsp;<span class="ident" id="6857924">r</span><span class="op" id="6857925">[</span><span class="num" id="6857926">0</span><span class="op" id="6857927">]</span>&nbsp;<span class="op" id="6857929">&gt;</span>&nbsp;<span class="ident" id="6857931">r</span><span class="op" id="6857932">[</span><span class="num" id="6857933">1</span><span class="op" id="6857934">]</span>&nbsp;<span class="op" id="6857936">||</span>&nbsp;<span class="builtinfunc" id="6857939">len</span><span class="op" id="6857942">(</span><span class="ident" id="6857943">tc</span><span class="op" id="6857945">.</span><span class="ident" id="6857946">source</span><span class="op" id="6857952">)</span>&nbsp;<span class="op" id="6857954">&lt;</span>&nbsp;<span class="ident" id="6857956">r</span><span class="op" id="6857957">[</span><span class="num" id="6857958">1</span><span class="op" id="6857959">]</span>&nbsp;<span class="op" id="6857961">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6857966">t</span><span class="op" id="6857967">.</span><span class="ident" id="6857968">Errorf</span><span class="op" id="6857974">(</span><span class="string" id="6857975">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;==&nbsp;%d):&nbsp;illegal&nbsp;match&nbsp;[%d,&nbsp;%d]&#34;</span><span class="op" id="6858046">,</span>&nbsp;<span class="ident" id="6858048">tc</span><span class="op" id="6858050">.</span><span class="ident" id="6858051">name</span><span class="op" id="6858055">,</span>&nbsp;<span class="ident" id="6858057">rx</span><span class="op" id="6858059">,</span>&nbsp;<span class="ident" id="6858061">i</span><span class="op" id="6858062">,</span>&nbsp;<span class="ident" id="6858064">n</span><span class="op" id="6858065">,</span>&nbsp;<span class="ident" id="6858067">r</span><span class="op" id="6858068">[</span><span class="num" id="6858069">0</span><span class="op" id="6858070">]</span><span class="op" id="6858071">,</span>&nbsp;<span class="ident" id="6858073">r</span><span class="op" id="6858074">[</span><span class="num" id="6858075">1</span><span class="op" id="6858076">]</span><span class="op" id="6858077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6858081">}</span>&nbsp;<span class="keyword" id="6858083">else</span>&nbsp;<span class="keyword" id="6858088">if</span>&nbsp;<span class="op" id="6858091">!</span><span class="ident" id="6858092">rx</span><span class="op" id="6858094">.</span><span class="ident" id="6858095">MatchString</span><span class="op" id="6858106">(</span><span class="ident" id="6858107">tc</span><span class="op" id="6858109">.</span><span class="ident" id="6858110">source</span><span class="op" id="6858116">[</span><span class="ident" id="6858117">r</span><span class="op" id="6858118">[</span><span class="num" id="6858119">0</span><span class="op" id="6858120">]</span><span class="op" id="6858121">:</span><span class="ident" id="6858122">r</span><span class="op" id="6858123">[</span><span class="num" id="6858124">1</span><span class="op" id="6858125">]</span><span class="op" id="6858126">]</span><span class="op" id="6858127">)</span>&nbsp;<span class="op" id="6858129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6858134">t</span><span class="op" id="6858135">.</span><span class="ident" id="6858136">Errorf</span><span class="op" id="6858142">(</span><span class="string" id="6858143">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;[%d,&nbsp;%d]&nbsp;not&nbsp;a&nbsp;match&#34;</span><span class="op" id="6858211">,</span>&nbsp;<span class="ident" id="6858213">tc</span><span class="op" id="6858215">.</span><span class="ident" id="6858216">name</span><span class="op" id="6858220">,</span>&nbsp;<span class="ident" id="6858222">rx</span><span class="op" id="6858224">,</span>&nbsp;<span class="ident" id="6858226">i</span><span class="op" id="6858227">,</span>&nbsp;<span class="ident" id="6858229">n</span><span class="op" id="6858230">,</span>&nbsp;<span class="ident" id="6858232">r</span><span class="op" id="6858233">[</span><span class="num" id="6858234">0</span><span class="op" id="6858235">]</span><span class="op" id="6858236">,</span>&nbsp;<span class="ident" id="6858238">r</span><span class="op" id="6858239">[</span><span class="num" id="6858240">1</span><span class="op" id="6858241">]</span><span class="op" id="6858242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6858246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6858249">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6858253">if</span>&nbsp;<span class="ident" id="6858256">n</span>&nbsp;<span class="op" id="6858258">&lt;</span>&nbsp;<span class="num" id="6858260">0</span>&nbsp;<span class="op" id="6858262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6858266">//&nbsp;all&nbsp;results&nbsp;computed&nbsp;-&nbsp;sorted&nbsp;res&nbsp;and&nbsp;exp&nbsp;must&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6858327">for</span>&nbsp;<span class="ident" id="6858331">i</span><span class="op" id="6858332">,</span>&nbsp;<span class="ident" id="6858334">r</span>&nbsp;<span class="op" id="6858336">:=</span>&nbsp;<span class="keyword" id="6858339">range</span>&nbsp;<span class="ident" id="6858345">res</span>&nbsp;<span class="op" id="6858349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6858354">e</span>&nbsp;<span class="op" id="6858356">:=</span>&nbsp;<span class="ident" id="6858359">exp</span><span class="op" id="6858362">[</span><span class="ident" id="6858363">i</span><span class="op" id="6858364">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6858369">if</span>&nbsp;<span class="ident" id="6858372">r</span><span class="op" id="6858373">[</span><span class="num" id="6858374">0</span><span class="op" id="6858375">]</span>&nbsp;<span class="op" id="6858377">!=</span>&nbsp;<span class="ident" id="6858380">e</span><span class="op" id="6858381">[</span><span class="num" id="6858382">0</span><span class="op" id="6858383">]</span>&nbsp;<span class="op" id="6858385">||</span>&nbsp;<span class="ident" id="6858388">r</span><span class="op" id="6858389">[</span><span class="num" id="6858390">1</span><span class="op" id="6858391">]</span>&nbsp;<span class="op" id="6858393">!=</span>&nbsp;<span class="ident" id="6858396">e</span><span class="op" id="6858397">[</span><span class="num" id="6858398">1</span><span class="op" id="6858399">]</span>&nbsp;<span class="op" id="6858401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6858407">t</span><span class="op" id="6858408">.</span><span class="ident" id="6858409">Errorf</span><span class="op" id="6858415">(</span><span class="string" id="6858416">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d:&nbsp;expected&nbsp;match&nbsp;[%d,&nbsp;%d];&nbsp;got&nbsp;[%d,&nbsp;%d]&#34;</span><span class="op" id="6858492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6858499">tc</span><span class="op" id="6858501">.</span><span class="ident" id="6858502">name</span><span class="op" id="6858506">,</span>&nbsp;<span class="ident" id="6858508">rx</span><span class="op" id="6858510">,</span>&nbsp;<span class="ident" id="6858512">i</span><span class="op" id="6858513">,</span>&nbsp;<span class="ident" id="6858515">e</span><span class="op" id="6858516">[</span><span class="num" id="6858517">0</span><span class="op" id="6858518">]</span><span class="op" id="6858519">,</span>&nbsp;<span class="ident" id="6858521">e</span><span class="op" id="6858522">[</span><span class="num" id="6858523">1</span><span class="op" id="6858524">]</span><span class="op" id="6858525">,</span>&nbsp;<span class="ident" id="6858527">r</span><span class="op" id="6858528">[</span><span class="num" id="6858529">0</span><span class="op" id="6858530">]</span><span class="op" id="6858531">,</span>&nbsp;<span class="ident" id="6858533">r</span><span class="op" id="6858534">[</span><span class="num" id="6858535">1</span><span class="op" id="6858536">]</span><span class="op" id="6858537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6858542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6858546">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6858549">}</span><br>
<span class="lineno"></span><span class="op" id="6858551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6858554">func</span>&nbsp;<span class="ident" id="6858559">testLookups</span><span class="op" id="6858570">(</span><span class="ident" id="6858571">t</span>&nbsp;<span class="op" id="6858573">*</span><span class="ident" id="6858574">testing</span><span class="op" id="6858581">.</span><span class="ident" id="6858582">T</span><span class="op" id="6858583">,</span>&nbsp;<span class="ident" id="6858585">tc</span>&nbsp;<span class="op" id="6858588">*</span><span class="ident" id="6858589">testCase</span><span class="op" id="6858597">,</span>&nbsp;<span class="ident" id="6858599">x</span>&nbsp;<span class="op" id="6858601">*</span><span class="ident" id="6858602">Index</span><span class="op" id="6858607">,</span>&nbsp;<span class="ident" id="6858609">n</span>&nbsp;<span class="builtintype" id="6858611">int</span><span class="op" id="6858614">)</span>&nbsp;<span class="op" id="6858616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6858619">for</span>&nbsp;<span class="ident" id="6858623">_</span><span class="op" id="6858624">,</span>&nbsp;<span class="ident" id="6858626">pat</span>&nbsp;<span class="op" id="6858630">:=</span>&nbsp;<span class="keyword" id="6858633">range</span>&nbsp;<span class="ident" id="6858639">tc</span><span class="op" id="6858641">.</span><span class="ident" id="6858642">patterns</span>&nbsp;<span class="op" id="6858651">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6858655">testLookup</span><span class="op" id="6858665">(</span><span class="ident" id="6858666">t</span><span class="op" id="6858667">,</span>&nbsp;<span class="ident" id="6858669">tc</span><span class="op" id="6858671">,</span>&nbsp;<span class="ident" id="6858673">x</span><span class="op" id="6858674">,</span>&nbsp;<span class="ident" id="6858676">pat</span><span class="op" id="6858679">,</span>&nbsp;<span class="ident" id="6858681">n</span><span class="op" id="6858682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6858686">if</span>&nbsp;<span class="ident" id="6858689">rx</span><span class="op" id="6858691">,</span>&nbsp;<span class="ident" id="6858693">err</span>&nbsp;<span class="op" id="6858697">:=</span>&nbsp;<span class="ident" id="6858700">regexp</span><span class="op" id="6858706">.</span><span class="ident" id="6858707">Compile</span><span class="op" id="6858714">(</span><span class="ident" id="6858715">pat</span><span class="op" id="6858718">)</span><span class="op" id="6858719">;</span>&nbsp;<span class="ident" id="6858721">err</span>&nbsp;<span class="op" id="6858725">==</span>&nbsp;<span class="ident" id="6858728">nil</span>&nbsp;<span class="op" id="6858732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6858737">testFindAllIndex</span><span class="op" id="6858753">(</span><span class="ident" id="6858754">t</span><span class="op" id="6858755">,</span>&nbsp;<span class="ident" id="6858757">tc</span><span class="op" id="6858759">,</span>&nbsp;<span class="ident" id="6858761">x</span><span class="op" id="6858762">,</span>&nbsp;<span class="ident" id="6858764">rx</span><span class="op" id="6858766">,</span>&nbsp;<span class="ident" id="6858768">n</span><span class="op" id="6858769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6858773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6858776">}</span><br>
<span class="lineno">205</span><span class="op" id="6858778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6858781">//&nbsp;index&nbsp;is&nbsp;used&nbsp;to&nbsp;hide&nbsp;the&nbsp;sort.Interface</span><br>
<span class="lineno"></span><span class="keyword" id="6858825">type</span>&nbsp;<span class="ident" id="6858830">index</span>&nbsp;<span class="ident" id="6858836">Index</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="6858843">func</span>&nbsp;<span class="op" id="6858848">(</span><span class="ident" id="6858849">x</span>&nbsp;<span class="op" id="6858851">*</span><span class="ident" id="6858852">index</span><span class="op" id="6858857">)</span>&nbsp;<span class="ident" id="6858859">Len</span><span class="op" id="6858862">(</span><span class="op" id="6858863">)</span>&nbsp;<span class="builtintype" id="6858865">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6858879">{</span>&nbsp;<span class="keyword" id="6858881">return</span>&nbsp;<span class="builtinfunc" id="6858888">len</span><span class="op" id="6858891">(</span><span class="ident" id="6858892">x</span><span class="op" id="6858893">.</span><span class="ident" id="6858894">sa</span><span class="op" id="6858896">)</span>&nbsp;<span class="op" id="6858898">}</span><br>
<span class="lineno"></span><span class="keyword" id="6858900">func</span>&nbsp;<span class="op" id="6858905">(</span><span class="ident" id="6858906">x</span>&nbsp;<span class="op" id="6858908">*</span><span class="ident" id="6858909">index</span><span class="op" id="6858914">)</span>&nbsp;<span class="ident" id="6858916">Less</span><span class="op" id="6858920">(</span><span class="ident" id="6858921">i</span><span class="op" id="6858922">,</span>&nbsp;<span class="ident" id="6858924">j</span>&nbsp;<span class="builtintype" id="6858926">int</span><span class="op" id="6858929">)</span>&nbsp;<span class="builtintype" id="6858931">bool</span>&nbsp;<span class="op" id="6858936">{</span>&nbsp;<span class="keyword" id="6858938">return</span>&nbsp;<span class="ident" id="6858945">bytes</span><span class="op" id="6858950">.</span><span class="ident" id="6858951">Compare</span><span class="op" id="6858958">(</span><span class="ident" id="6858959">x</span><span class="op" id="6858960">.</span><span class="ident" id="6858961">at</span><span class="op" id="6858963">(</span><span class="ident" id="6858964">i</span><span class="op" id="6858965">)</span><span class="op" id="6858966">,</span>&nbsp;<span class="ident" id="6858968">x</span><span class="op" id="6858969">.</span><span class="ident" id="6858970">at</span><span class="op" id="6858972">(</span><span class="ident" id="6858973">j</span><span class="op" id="6858974">)</span><span class="op" id="6858975">)</span>&nbsp;<span class="op" id="6858977">&lt;</span>&nbsp;<span class="num" id="6858979">0</span>&nbsp;<span class="op" id="6858981">}</span><br>
<span class="lineno"></span><span class="keyword" id="6858983">func</span>&nbsp;<span class="op" id="6858988">(</span><span class="ident" id="6858989">x</span>&nbsp;<span class="op" id="6858991">*</span><span class="ident" id="6858992">index</span><span class="op" id="6858997">)</span>&nbsp;<span class="ident" id="6858999">Swap</span><span class="op" id="6859003">(</span><span class="ident" id="6859004">i</span><span class="op" id="6859005">,</span>&nbsp;<span class="ident" id="6859007">j</span>&nbsp;<span class="builtintype" id="6859009">int</span><span class="op" id="6859012">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6859019">{</span>&nbsp;<span class="ident" id="6859021">x</span><span class="op" id="6859022">.</span><span class="ident" id="6859023">sa</span><span class="op" id="6859025">[</span><span class="ident" id="6859026">i</span><span class="op" id="6859027">]</span><span class="op" id="6859028">,</span>&nbsp;<span class="ident" id="6859030">x</span><span class="op" id="6859031">.</span><span class="ident" id="6859032">sa</span><span class="op" id="6859034">[</span><span class="ident" id="6859035">j</span><span class="op" id="6859036">]</span>&nbsp;<span class="op" id="6859038">=</span>&nbsp;<span class="ident" id="6859040">x</span><span class="op" id="6859041">.</span><span class="ident" id="6859042">sa</span><span class="op" id="6859044">[</span><span class="ident" id="6859045">j</span><span class="op" id="6859046">]</span><span class="op" id="6859047">,</span>&nbsp;<span class="ident" id="6859049">x</span><span class="op" id="6859050">.</span><span class="ident" id="6859051">sa</span><span class="op" id="6859053">[</span><span class="ident" id="6859054">i</span><span class="op" id="6859055">]</span>&nbsp;<span class="op" id="6859057">}</span><br>
<span class="lineno"></span><span class="keyword" id="6859059">func</span>&nbsp;<span class="op" id="6859064">(</span><span class="ident" id="6859065">a</span>&nbsp;<span class="op" id="6859067">*</span><span class="ident" id="6859068">index</span><span class="op" id="6859073">)</span>&nbsp;<span class="ident" id="6859075">at</span><span class="op" id="6859077">(</span><span class="ident" id="6859078">i</span>&nbsp;<span class="builtintype" id="6859080">int</span><span class="op" id="6859083">)</span>&nbsp;<span class="op" id="6859085">[</span><span class="op" id="6859086">]</span><span class="builtintype" id="6859087">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6859095">{</span>&nbsp;<span class="keyword" id="6859097">return</span>&nbsp;<span class="ident" id="6859104">a</span><span class="op" id="6859105">.</span><span class="ident" id="6859106">data</span><span class="op" id="6859110">[</span><span class="ident" id="6859111">a</span><span class="op" id="6859112">.</span><span class="ident" id="6859113">sa</span><span class="op" id="6859115">[</span><span class="ident" id="6859116">i</span><span class="op" id="6859117">]</span><span class="op" id="6859118">:</span><span class="op" id="6859119">]</span>&nbsp;<span class="op" id="6859121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="6859124">func</span>&nbsp;<span class="ident" id="6859129">testConstruction</span><span class="op" id="6859145">(</span><span class="ident" id="6859146">t</span>&nbsp;<span class="op" id="6859148">*</span><span class="ident" id="6859149">testing</span><span class="op" id="6859156">.</span><span class="ident" id="6859157">T</span><span class="op" id="6859158">,</span>&nbsp;<span class="ident" id="6859160">tc</span>&nbsp;<span class="op" id="6859163">*</span><span class="ident" id="6859164">testCase</span><span class="op" id="6859172">,</span>&nbsp;<span class="ident" id="6859174">x</span>&nbsp;<span class="op" id="6859176">*</span><span class="ident" id="6859177">Index</span><span class="op" id="6859182">)</span>&nbsp;<span class="op" id="6859184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6859187">if</span>&nbsp;<span class="op" id="6859190">!</span><span class="ident" id="6859191">sort</span><span class="op" id="6859195">.</span><span class="ident" id="6859196">IsSorted</span><span class="op" id="6859204">(</span><span class="op" id="6859205">(</span><span class="op" id="6859206">*</span><span class="ident" id="6859207">index</span><span class="op" id="6859212">)</span><span class="op" id="6859213">(</span><span class="ident" id="6859214">x</span><span class="op" id="6859215">)</span><span class="op" id="6859216">)</span>&nbsp;<span class="op" id="6859218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6859222">t</span><span class="op" id="6859223">.</span><span class="ident" id="6859224">Errorf</span><span class="op" id="6859230">(</span><span class="string" id="6859231">&#34;failed&nbsp;testConstruction&nbsp;%s&#34;</span><span class="op" id="6859259">,</span>&nbsp;<span class="ident" id="6859261">tc</span><span class="op" id="6859263">.</span><span class="ident" id="6859264">name</span><span class="op" id="6859268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6859271">}</span><br>
<span class="lineno"></span><span class="op" id="6859273">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="6859276">func</span>&nbsp;<span class="ident" id="6859281">equal</span><span class="op" id="6859286">(</span><span class="ident" id="6859287">x</span><span class="op" id="6859288">,</span>&nbsp;<span class="ident" id="6859290">y</span>&nbsp;<span class="op" id="6859292">*</span><span class="ident" id="6859293">Index</span><span class="op" id="6859298">)</span>&nbsp;<span class="builtintype" id="6859300">bool</span>&nbsp;<span class="op" id="6859305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6859308">if</span>&nbsp;<span class="op" id="6859311">!</span><span class="ident" id="6859312">bytes</span><span class="op" id="6859317">.</span><span class="ident" id="6859318">Equal</span><span class="op" id="6859323">(</span><span class="ident" id="6859324">x</span><span class="op" id="6859325">.</span><span class="ident" id="6859326">data</span><span class="op" id="6859330">,</span>&nbsp;<span class="ident" id="6859332">y</span><span class="op" id="6859333">.</span><span class="ident" id="6859334">data</span><span class="op" id="6859338">)</span>&nbsp;<span class="op" id="6859340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6859344">return</span>&nbsp;<span class="builtintype" id="6859351">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6859358">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6859361">for</span>&nbsp;<span class="ident" id="6859365">i</span><span class="op" id="6859366">,</span>&nbsp;<span class="ident" id="6859368">j</span>&nbsp;<span class="op" id="6859370">:=</span>&nbsp;<span class="keyword" id="6859373">range</span>&nbsp;<span class="ident" id="6859379">x</span><span class="op" id="6859380">.</span><span class="ident" id="6859381">sa</span>&nbsp;<span class="op" id="6859384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6859388">if</span>&nbsp;<span class="ident" id="6859391">j</span>&nbsp;<span class="op" id="6859393">!=</span>&nbsp;<span class="ident" id="6859396">y</span><span class="op" id="6859397">.</span><span class="ident" id="6859398">sa</span><span class="op" id="6859400">[</span><span class="ident" id="6859401">i</span><span class="op" id="6859402">]</span>&nbsp;<span class="op" id="6859404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6859409">return</span>&nbsp;<span class="builtintype" id="6859416">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6859424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6859427">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6859430">return</span>&nbsp;<span class="builtintype" id="6859437">true</span><br>
<span class="lineno"></span><span class="op" id="6859442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6859445">//&nbsp;returns&nbsp;the&nbsp;serialized&nbsp;index&nbsp;size</span><br>
<span class="lineno"></span><span class="keyword" id="6859482">func</span>&nbsp;<span class="ident" id="6859487">testSaveRestore</span><span class="op" id="6859502">(</span><span class="ident" id="6859503">t</span>&nbsp;<span class="op" id="6859505">*</span><span class="ident" id="6859506">testing</span><span class="op" id="6859513">.</span><span class="ident" id="6859514">T</span><span class="op" id="6859515">,</span>&nbsp;<span class="ident" id="6859517">tc</span>&nbsp;<span class="op" id="6859520">*</span><span class="ident" id="6859521">testCase</span><span class="op" id="6859529">,</span>&nbsp;<span class="ident" id="6859531">x</span>&nbsp;<span class="op" id="6859533">*</span><span class="ident" id="6859534">Index</span><span class="op" id="6859539">)</span>&nbsp;<span class="builtintype" id="6859541">int</span>&nbsp;<span class="op" id="6859545">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6859548">var</span>&nbsp;<span class="ident" id="6859552">buf</span>&nbsp;<span class="ident" id="6859556">bytes</span><span class="op" id="6859561">.</span><span class="ident" id="6859562">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6859570">if</span>&nbsp;<span class="ident" id="6859573">err</span>&nbsp;<span class="op" id="6859577">:=</span>&nbsp;<span class="ident" id="6859580">x</span><span class="op" id="6859581">.</span><span class="ident" id="6859582">Write</span><span class="op" id="6859587">(</span><span class="op" id="6859588">&amp;</span><span class="ident" id="6859589">buf</span><span class="op" id="6859592">)</span><span class="op" id="6859593">;</span>&nbsp;<span class="ident" id="6859595">err</span>&nbsp;<span class="op" id="6859599">!=</span>&nbsp;<span class="ident" id="6859602">nil</span>&nbsp;<span class="op" id="6859606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6859610">t</span><span class="op" id="6859611">.</span><span class="ident" id="6859612">Errorf</span><span class="op" id="6859618">(</span><span class="string" id="6859619">&#34;failed&nbsp;writing&nbsp;index&nbsp;%s&nbsp;(%s)&#34;</span><span class="op" id="6859649">,</span>&nbsp;<span class="ident" id="6859651">tc</span><span class="op" id="6859653">.</span><span class="ident" id="6859654">name</span><span class="op" id="6859658">,</span>&nbsp;<span class="ident" id="6859660">err</span><span class="op" id="6859663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6859666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6859669">size</span>&nbsp;<span class="op" id="6859674">:=</span>&nbsp;<span class="ident" id="6859677">buf</span><span class="op" id="6859680">.</span><span class="ident" id="6859681">Len</span><span class="op" id="6859684">(</span><span class="op" id="6859685">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6859688">var</span>&nbsp;<span class="ident" id="6859692">y</span>&nbsp;<span class="ident" id="6859694">Index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6859701">if</span>&nbsp;<span class="ident" id="6859704">err</span>&nbsp;<span class="op" id="6859708">:=</span>&nbsp;<span class="ident" id="6859711">y</span><span class="op" id="6859712">.</span><span class="ident" id="6859713">Read</span><span class="op" id="6859717">(</span><span class="op" id="6859718">&amp;</span><span class="ident" id="6859719">buf</span><span class="op" id="6859722">)</span><span class="op" id="6859723">;</span>&nbsp;<span class="ident" id="6859725">err</span>&nbsp;<span class="op" id="6859729">!=</span>&nbsp;<span class="ident" id="6859732">nil</span>&nbsp;<span class="op" id="6859736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6859740">t</span><span class="op" id="6859741">.</span><span class="ident" id="6859742">Errorf</span><span class="op" id="6859748">(</span><span class="string" id="6859749">&#34;failed&nbsp;reading&nbsp;index&nbsp;%s&nbsp;(%s)&#34;</span><span class="op" id="6859779">,</span>&nbsp;<span class="ident" id="6859781">tc</span><span class="op" id="6859783">.</span><span class="ident" id="6859784">name</span><span class="op" id="6859788">,</span>&nbsp;<span class="ident" id="6859790">err</span><span class="op" id="6859793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6859796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6859799">if</span>&nbsp;<span class="op" id="6859802">!</span><span class="ident" id="6859803">equal</span><span class="op" id="6859808">(</span><span class="ident" id="6859809">x</span><span class="op" id="6859810">,</span>&nbsp;<span class="op" id="6859812">&amp;</span><span class="ident" id="6859813">y</span><span class="op" id="6859814">)</span>&nbsp;<span class="op" id="6859816">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6859820">t</span><span class="op" id="6859821">.</span><span class="ident" id="6859822">Errorf</span><span class="op" id="6859828">(</span><span class="string" id="6859829">&#34;restored&nbsp;index&nbsp;doesn&#39;t&nbsp;match&nbsp;saved&nbsp;index&nbsp;%s&#34;</span><span class="op" id="6859874">,</span>&nbsp;<span class="ident" id="6859876">tc</span><span class="op" id="6859878">.</span><span class="ident" id="6859879">name</span><span class="op" id="6859883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6859886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6859889">return</span>&nbsp;<span class="ident" id="6859896">size</span><br>
<span class="lineno"></span><span class="op" id="6859901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="6859904">func</span>&nbsp;<span class="ident" id="6859909">TestIndex</span><span class="op" id="6859918">(</span><span class="ident" id="6859919">t</span>&nbsp;<span class="op" id="6859921">*</span><span class="ident" id="6859922">testing</span><span class="op" id="6859929">.</span><span class="ident" id="6859930">T</span><span class="op" id="6859931">)</span>&nbsp;<span class="op" id="6859933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6859936">for</span>&nbsp;<span class="ident" id="6859940">_</span><span class="op" id="6859941">,</span>&nbsp;<span class="ident" id="6859943">tc</span>&nbsp;<span class="op" id="6859946">:=</span>&nbsp;<span class="keyword" id="6859949">range</span>&nbsp;<span class="ident" id="6859955">testCases</span>&nbsp;<span class="op" id="6859965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6859969">x</span>&nbsp;<span class="op" id="6859971">:=</span>&nbsp;<span class="ident" id="6859974">New</span><span class="op" id="6859977">(</span><span class="op" id="6859978">[</span><span class="op" id="6859979">]</span><span class="builtintype" id="6859980">byte</span><span class="op" id="6859984">(</span><span class="ident" id="6859985">tc</span><span class="op" id="6859987">.</span><span class="ident" id="6859988">source</span><span class="op" id="6859994">)</span><span class="op" id="6859995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6859999">testConstruction</span><span class="op" id="6860015">(</span><span class="ident" id="6860016">t</span><span class="op" id="6860017">,</span>&nbsp;<span class="op" id="6860019">&amp;</span><span class="ident" id="6860020">tc</span><span class="op" id="6860022">,</span>&nbsp;<span class="ident" id="6860024">x</span><span class="op" id="6860025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860029">testSaveRestore</span><span class="op" id="6860044">(</span><span class="ident" id="6860045">t</span><span class="op" id="6860046">,</span>&nbsp;<span class="op" id="6860048">&amp;</span><span class="ident" id="6860049">tc</span><span class="op" id="6860051">,</span>&nbsp;<span class="ident" id="6860053">x</span><span class="op" id="6860054">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860058">testLookups</span><span class="op" id="6860069">(</span><span class="ident" id="6860070">t</span><span class="op" id="6860071">,</span>&nbsp;<span class="op" id="6860073">&amp;</span><span class="ident" id="6860074">tc</span><span class="op" id="6860076">,</span>&nbsp;<span class="ident" id="6860078">x</span><span class="op" id="6860079">,</span>&nbsp;<span class="num" id="6860081">0</span><span class="op" id="6860082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860086">testLookups</span><span class="op" id="6860097">(</span><span class="ident" id="6860098">t</span><span class="op" id="6860099">,</span>&nbsp;<span class="op" id="6860101">&amp;</span><span class="ident" id="6860102">tc</span><span class="op" id="6860104">,</span>&nbsp;<span class="ident" id="6860106">x</span><span class="op" id="6860107">,</span>&nbsp;<span class="num" id="6860109">1</span><span class="op" id="6860110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860114">testLookups</span><span class="op" id="6860125">(</span><span class="ident" id="6860126">t</span><span class="op" id="6860127">,</span>&nbsp;<span class="op" id="6860129">&amp;</span><span class="ident" id="6860130">tc</span><span class="op" id="6860132">,</span>&nbsp;<span class="ident" id="6860134">x</span><span class="op" id="6860135">,</span>&nbsp;<span class="num" id="6860137">10</span><span class="op" id="6860139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860143">testLookups</span><span class="op" id="6860154">(</span><span class="ident" id="6860155">t</span><span class="op" id="6860156">,</span>&nbsp;<span class="op" id="6860158">&amp;</span><span class="ident" id="6860159">tc</span><span class="op" id="6860161">,</span>&nbsp;<span class="ident" id="6860163">x</span><span class="op" id="6860164">,</span>&nbsp;<span class="num" id="6860166">2e9</span><span class="op" id="6860169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860173">testLookups</span><span class="op" id="6860184">(</span><span class="ident" id="6860185">t</span><span class="op" id="6860186">,</span>&nbsp;<span class="op" id="6860188">&amp;</span><span class="ident" id="6860189">tc</span><span class="op" id="6860191">,</span>&nbsp;<span class="ident" id="6860193">x</span><span class="op" id="6860194">,</span>&nbsp;<span class="op" id="6860196">-</span><span class="num" id="6860197">1</span><span class="op" id="6860198">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6860201">}</span><br>
<span class="lineno"></span><span class="op" id="6860203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6860206">//&nbsp;Of&nbsp;all&nbsp;possible&nbsp;inputs,&nbsp;the&nbsp;random&nbsp;bytes&nbsp;have&nbsp;the&nbsp;least&nbsp;amount&nbsp;of&nbsp;substring</span><br>
<span class="lineno"></span><span class="comment" id="6860285">//&nbsp;repetition,&nbsp;and&nbsp;the&nbsp;repeated&nbsp;bytes&nbsp;have&nbsp;the&nbsp;most.&nbsp;For&nbsp;most&nbsp;algorithms,</span><br>
<span class="lineno">265</span><span class="comment" id="6860359">//&nbsp;the&nbsp;running&nbsp;time&nbsp;of&nbsp;every&nbsp;input&nbsp;will&nbsp;be&nbsp;between&nbsp;these&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="6860421">func</span>&nbsp;<span class="ident" id="6860426">benchmarkNew</span><span class="op" id="6860438">(</span><span class="ident" id="6860439">b</span>&nbsp;<span class="op" id="6860441">*</span><span class="ident" id="6860442">testing</span><span class="op" id="6860449">.</span><span class="ident" id="6860450">B</span><span class="op" id="6860451">,</span>&nbsp;<span class="ident" id="6860453">random</span>&nbsp;<span class="builtintype" id="6860460">bool</span><span class="op" id="6860464">)</span>&nbsp;<span class="op" id="6860466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860469">b</span><span class="op" id="6860470">.</span><span class="ident" id="6860471">StopTimer</span><span class="op" id="6860480">(</span><span class="op" id="6860481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860484">data</span>&nbsp;<span class="op" id="6860489">:=</span>&nbsp;<span class="builtinfunc" id="6860492">make</span><span class="op" id="6860496">(</span><span class="op" id="6860497">[</span><span class="op" id="6860498">]</span><span class="builtintype" id="6860499">byte</span><span class="op" id="6860503">,</span>&nbsp;<span class="num" id="6860505">1e6</span><span class="op" id="6860508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6860511">if</span>&nbsp;<span class="ident" id="6860514">random</span>&nbsp;<span class="op" id="6860521">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6860525">for</span>&nbsp;<span class="ident" id="6860529">i</span>&nbsp;<span class="op" id="6860531">:=</span>&nbsp;<span class="keyword" id="6860534">range</span>&nbsp;<span class="ident" id="6860540">data</span>&nbsp;<span class="op" id="6860545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860550">data</span><span class="op" id="6860554">[</span><span class="ident" id="6860555">i</span><span class="op" id="6860556">]</span>&nbsp;<span class="op" id="6860558">=</span>&nbsp;<span class="builtintype" id="6860560">byte</span><span class="op" id="6860564">(</span><span class="ident" id="6860565">rand</span><span class="op" id="6860569">.</span><span class="ident" id="6860570">Intn</span><span class="op" id="6860574">(</span><span class="num" id="6860575">256</span><span class="op" id="6860578">)</span><span class="op" id="6860579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6860583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6860586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860589">b</span><span class="op" id="6860590">.</span><span class="ident" id="6860591">StartTimer</span><span class="op" id="6860601">(</span><span class="op" id="6860602">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6860605">for</span>&nbsp;<span class="ident" id="6860609">i</span>&nbsp;<span class="op" id="6860611">:=</span>&nbsp;<span class="num" id="6860614">0</span><span class="op" id="6860615">;</span>&nbsp;<span class="ident" id="6860617">i</span>&nbsp;<span class="op" id="6860619">&lt;</span>&nbsp;<span class="ident" id="6860621">b</span><span class="op" id="6860622">.</span><span class="ident" id="6860623">N</span><span class="op" id="6860624">;</span>&nbsp;<span class="ident" id="6860626">i</span><span class="op" id="6860627">++</span>&nbsp;<span class="op" id="6860630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860634">New</span><span class="op" id="6860637">(</span><span class="ident" id="6860638">data</span><span class="op" id="6860642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6860645">}</span><br>
<span class="lineno"></span><span class="op" id="6860647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="6860650">func</span>&nbsp;<span class="ident" id="6860655">BenchmarkNewIndexRandom</span><span class="op" id="6860678">(</span><span class="ident" id="6860679">b</span>&nbsp;<span class="op" id="6860681">*</span><span class="ident" id="6860682">testing</span><span class="op" id="6860689">.</span><span class="ident" id="6860690">B</span><span class="op" id="6860691">)</span>&nbsp;<span class="op" id="6860693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860696">benchmarkNew</span><span class="op" id="6860708">(</span><span class="ident" id="6860709">b</span><span class="op" id="6860710">,</span>&nbsp;<span class="builtintype" id="6860712">true</span><span class="op" id="6860716">)</span><br>
<span class="lineno"></span><span class="op" id="6860718">}</span><br>
<span class="lineno"></span><span class="keyword" id="6860720">func</span>&nbsp;<span class="ident" id="6860725">BenchmarkNewIndexRepeat</span><span class="op" id="6860748">(</span><span class="ident" id="6860749">b</span>&nbsp;<span class="op" id="6860751">*</span><span class="ident" id="6860752">testing</span><span class="op" id="6860759">.</span><span class="ident" id="6860760">B</span><span class="op" id="6860761">)</span>&nbsp;<span class="op" id="6860763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860766">benchmarkNew</span><span class="op" id="6860778">(</span><span class="ident" id="6860779">b</span><span class="op" id="6860780">,</span>&nbsp;<span class="builtintype" id="6860782">false</span><span class="op" id="6860787">)</span><br>
<span class="lineno">285</span><span class="op" id="6860789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6860792">func</span>&nbsp;<span class="ident" id="6860797">BenchmarkSaveRestore</span><span class="op" id="6860817">(</span><span class="ident" id="6860818">b</span>&nbsp;<span class="op" id="6860820">*</span><span class="ident" id="6860821">testing</span><span class="op" id="6860828">.</span><span class="ident" id="6860829">B</span><span class="op" id="6860830">)</span>&nbsp;<span class="op" id="6860832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860835">b</span><span class="op" id="6860836">.</span><span class="ident" id="6860837">StopTimer</span><span class="op" id="6860846">(</span><span class="op" id="6860847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860850">r</span>&nbsp;<span class="op" id="6860852">:=</span>&nbsp;<span class="ident" id="6860855">rand</span><span class="op" id="6860859">.</span><span class="ident" id="6860860">New</span><span class="op" id="6860863">(</span><span class="ident" id="6860864">rand</span><span class="op" id="6860868">.</span><span class="ident" id="6860869">NewSource</span><span class="op" id="6860878">(</span><span class="num" id="6860879">0x5a77a1</span><span class="op" id="6860887">)</span><span class="op" id="6860888">)</span>&nbsp;<span class="comment" id="6860890">//&nbsp;guarantee&nbsp;always&nbsp;same&nbsp;sequence</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6860925">data</span>&nbsp;<span class="op" id="6860930">:=</span>&nbsp;<span class="builtinfunc" id="6860933">make</span><span class="op" id="6860937">(</span><span class="op" id="6860938">[</span><span class="op" id="6860939">]</span><span class="builtintype" id="6860940">byte</span><span class="op" id="6860944">,</span>&nbsp;<span class="num" id="6860946">1</span><span class="op" id="6860947">&lt;&lt;</span><span class="num" id="6860949">20</span><span class="op" id="6860951">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6860965">//&nbsp;1MB&nbsp;of&nbsp;data&nbsp;to&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6860990">for</span>&nbsp;<span class="ident" id="6860994">i</span>&nbsp;<span class="op" id="6860996">:=</span>&nbsp;<span class="keyword" id="6860999">range</span>&nbsp;<span class="ident" id="6861005">data</span>&nbsp;<span class="op" id="6861010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6861014">data</span><span class="op" id="6861018">[</span><span class="ident" id="6861019">i</span><span class="op" id="6861020">]</span>&nbsp;<span class="op" id="6861022">=</span>&nbsp;<span class="builtintype" id="6861024">byte</span><span class="op" id="6861028">(</span><span class="ident" id="6861029">r</span><span class="op" id="6861030">.</span><span class="ident" id="6861031">Intn</span><span class="op" id="6861035">(</span><span class="num" id="6861036">256</span><span class="op" id="6861039">)</span><span class="op" id="6861040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6861043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6861046">x</span>&nbsp;<span class="op" id="6861048">:=</span>&nbsp;<span class="ident" id="6861051">New</span><span class="op" id="6861054">(</span><span class="ident" id="6861055">data</span><span class="op" id="6861059">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6861062">size</span>&nbsp;<span class="op" id="6861067">:=</span>&nbsp;<span class="ident" id="6861070">testSaveRestore</span><span class="op" id="6861085">(</span><span class="ident" id="6861086">nil</span><span class="op" id="6861089">,</span>&nbsp;<span class="ident" id="6861091">nil</span><span class="op" id="6861094">,</span>&nbsp;<span class="ident" id="6861096">x</span><span class="op" id="6861097">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6861105">//&nbsp;verify&nbsp;correctness</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6861128">buf</span>&nbsp;<span class="op" id="6861132">:=</span>&nbsp;<span class="ident" id="6861135">bytes</span><span class="op" id="6861140">.</span><span class="ident" id="6861141">NewBuffer</span><span class="op" id="6861150">(</span><span class="builtinfunc" id="6861151">make</span><span class="op" id="6861155">(</span><span class="op" id="6861156">[</span><span class="op" id="6861157">]</span><span class="builtintype" id="6861158">byte</span><span class="op" id="6861162">,</span>&nbsp;<span class="ident" id="6861164">size</span><span class="op" id="6861168">)</span><span class="op" id="6861169">)</span>&nbsp;<span class="comment" id="6861171">//&nbsp;avoid&nbsp;growing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6861189">b</span><span class="op" id="6861190">.</span><span class="ident" id="6861191">SetBytes</span><span class="op" id="6861199">(</span><span class="ident" id="6861200">int64</span><span class="op" id="6861205">(</span><span class="ident" id="6861206">size</span><span class="op" id="6861210">)</span><span class="op" id="6861211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6861214">b</span><span class="op" id="6861215">.</span><span class="ident" id="6861216">StartTimer</span><span class="op" id="6861226">(</span><span class="op" id="6861227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6861230">for</span>&nbsp;<span class="ident" id="6861234">i</span>&nbsp;<span class="op" id="6861236">:=</span>&nbsp;<span class="num" id="6861239">0</span><span class="op" id="6861240">;</span>&nbsp;<span class="ident" id="6861242">i</span>&nbsp;<span class="op" id="6861244">&lt;</span>&nbsp;<span class="ident" id="6861246">b</span><span class="op" id="6861247">.</span><span class="ident" id="6861248">N</span><span class="op" id="6861249">;</span>&nbsp;<span class="ident" id="6861251">i</span><span class="op" id="6861252">++</span>&nbsp;<span class="op" id="6861255">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6861259">x</span><span class="op" id="6861260">.</span><span class="ident" id="6861261">Write</span><span class="op" id="6861266">(</span><span class="ident" id="6861267">buf</span><span class="op" id="6861270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6861274">var</span>&nbsp;<span class="ident" id="6861278">y</span>&nbsp;<span class="ident" id="6861280">Index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6861288">y</span><span class="op" id="6861289">.</span><span class="ident" id="6861290">Read</span><span class="op" id="6861294">(</span><span class="ident" id="6861295">buf</span><span class="op" id="6861298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6861301">}</span><br>
<span class="lineno"></span><span class="op" id="6861303">}</span>
</div>
</body>
</html>
