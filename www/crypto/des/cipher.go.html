<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4037487">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4037542">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4037596">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4037647">package</span>&nbsp;<span class="ident" id="4037655">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4037660">import</span>&nbsp;<span class="op" id="4037667">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4037670">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4037687">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4037697">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4037700">//&nbsp;The&nbsp;DES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4037732">const</span>&nbsp;<span class="ident" id="4037738">BlockSize</span>&nbsp;<span class="op" id="4037748">=</span>&nbsp;<span class="num" id="4037750">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4037753">type</span>&nbsp;<span class="ident" id="4037758">KeySizeError</span>&nbsp;<span class="builtintype" id="4037771">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4037776">func</span>&nbsp;<span class="op" id="4037781">(</span><span class="ident" id="4037782">k</span>&nbsp;<span class="ident" id="4037784">KeySizeError</span><span class="op" id="4037796">)</span>&nbsp;<span class="ident" id="4037798">Error</span><span class="op" id="4037803">(</span><span class="op" id="4037804">)</span>&nbsp;<span class="builtintype" id="4037806">string</span>&nbsp;<span class="op" id="4037813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037816">return</span>&nbsp;<span class="string" id="4037823">&#34;crypto/des:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="4037855">+</span>&nbsp;<span class="ident" id="4037857">strconv</span><span class="op" id="4037864">.</span><span class="ident" id="4037865">Itoa</span><span class="op" id="4037869">(</span><span class="builtintype" id="4037870">int</span><span class="op" id="4037873">(</span><span class="ident" id="4037874">k</span><span class="op" id="4037875">)</span><span class="op" id="4037876">)</span><br>
<span class="lineno"></span><span class="op" id="4037878">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="4037881">//&nbsp;desCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;DES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="4037928">type</span>&nbsp;<span class="ident" id="4037933">desCipher</span>&nbsp;<span class="keyword" id="4037943">struct</span>&nbsp;<span class="op" id="4037950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037953">subkeys</span>&nbsp;<span class="op" id="4037961">[</span><span class="num" id="4037962">16</span><span class="op" id="4037964">]</span><span class="ident" id="4037965">uint64</span><br>
<span class="lineno"></span><span class="op" id="4037972">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4037975">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="4038028">func</span>&nbsp;<span class="ident" id="4038033">NewCipher</span><span class="op" id="4038042">(</span><span class="ident" id="4038043">key</span>&nbsp;<span class="op" id="4038047">[</span><span class="op" id="4038048">]</span><span class="builtintype" id="4038049">byte</span><span class="op" id="4038053">)</span>&nbsp;<span class="op" id="4038055">(</span><span class="ident" id="4038056">cipher</span><span class="op" id="4038062">.</span><span class="ident" id="4038063">Block</span><span class="op" id="4038068">,</span>&nbsp;<span class="builtintype" id="4038070">error</span><span class="op" id="4038075">)</span>&nbsp;<span class="op" id="4038077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038080">if</span>&nbsp;<span class="builtinfunc" id="4038083">len</span><span class="op" id="4038086">(</span><span class="ident" id="4038087">key</span><span class="op" id="4038090">)</span>&nbsp;<span class="op" id="4038092">!=</span>&nbsp;<span class="num" id="4038095">8</span>&nbsp;<span class="op" id="4038097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038101">return</span>&nbsp;<span class="ident" id="4038108">nil</span><span class="op" id="4038111">,</span>&nbsp;<span class="ident" id="4038113">KeySizeError</span><span class="op" id="4038125">(</span><span class="builtinfunc" id="4038126">len</span><span class="op" id="4038129">(</span><span class="ident" id="4038130">key</span><span class="op" id="4038133">)</span><span class="op" id="4038134">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4038137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038141">c</span>&nbsp;<span class="op" id="4038143">:=</span>&nbsp;<span class="builtinfunc" id="4038146">new</span><span class="op" id="4038149">(</span><span class="ident" id="4038150">desCipher</span><span class="op" id="4038159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038162">c</span><span class="op" id="4038163">.</span><span class="ident" id="4038164">generateSubkeys</span><span class="op" id="4038179">(</span><span class="ident" id="4038180">key</span><span class="op" id="4038183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038186">return</span>&nbsp;<span class="ident" id="4038193">c</span><span class="op" id="4038194">,</span>&nbsp;<span class="ident" id="4038196">nil</span><br>
<span class="lineno">35</span><span class="op" id="4038200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4038203">func</span>&nbsp;<span class="op" id="4038208">(</span><span class="ident" id="4038209">c</span>&nbsp;<span class="op" id="4038211">*</span><span class="ident" id="4038212">desCipher</span><span class="op" id="4038221">)</span>&nbsp;<span class="ident" id="4038223">BlockSize</span><span class="op" id="4038232">(</span><span class="op" id="4038233">)</span>&nbsp;<span class="builtintype" id="4038235">int</span>&nbsp;<span class="op" id="4038239">{</span>&nbsp;<span class="keyword" id="4038241">return</span>&nbsp;<span class="ident" id="4038248">BlockSize</span>&nbsp;<span class="op" id="4038258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4038261">func</span>&nbsp;<span class="op" id="4038266">(</span><span class="ident" id="4038267">c</span>&nbsp;<span class="op" id="4038269">*</span><span class="ident" id="4038270">desCipher</span><span class="op" id="4038279">)</span>&nbsp;<span class="ident" id="4038281">Encrypt</span><span class="op" id="4038288">(</span><span class="ident" id="4038289">dst</span><span class="op" id="4038292">,</span>&nbsp;<span class="ident" id="4038294">src</span>&nbsp;<span class="op" id="4038298">[</span><span class="op" id="4038299">]</span><span class="builtintype" id="4038300">byte</span><span class="op" id="4038304">)</span>&nbsp;<span class="op" id="4038306">{</span>&nbsp;<span class="ident" id="4038308">encryptBlock</span><span class="op" id="4038320">(</span><span class="ident" id="4038321">c</span><span class="op" id="4038322">.</span><span class="ident" id="4038323">subkeys</span><span class="op" id="4038330">[</span><span class="op" id="4038331">:</span><span class="op" id="4038332">]</span><span class="op" id="4038333">,</span>&nbsp;<span class="ident" id="4038335">dst</span><span class="op" id="4038338">,</span>&nbsp;<span class="ident" id="4038340">src</span><span class="op" id="4038343">)</span>&nbsp;<span class="op" id="4038345">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4038348">func</span>&nbsp;<span class="op" id="4038353">(</span><span class="ident" id="4038354">c</span>&nbsp;<span class="op" id="4038356">*</span><span class="ident" id="4038357">desCipher</span><span class="op" id="4038366">)</span>&nbsp;<span class="ident" id="4038368">Decrypt</span><span class="op" id="4038375">(</span><span class="ident" id="4038376">dst</span><span class="op" id="4038379">,</span>&nbsp;<span class="ident" id="4038381">src</span>&nbsp;<span class="op" id="4038385">[</span><span class="op" id="4038386">]</span><span class="builtintype" id="4038387">byte</span><span class="op" id="4038391">)</span>&nbsp;<span class="op" id="4038393">{</span>&nbsp;<span class="ident" id="4038395">decryptBlock</span><span class="op" id="4038407">(</span><span class="ident" id="4038408">c</span><span class="op" id="4038409">.</span><span class="ident" id="4038410">subkeys</span><span class="op" id="4038417">[</span><span class="op" id="4038418">:</span><span class="op" id="4038419">]</span><span class="op" id="4038420">,</span>&nbsp;<span class="ident" id="4038422">dst</span><span class="op" id="4038425">,</span>&nbsp;<span class="ident" id="4038427">src</span><span class="op" id="4038430">)</span>&nbsp;<span class="op" id="4038432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4038435">//&nbsp;A&nbsp;tripleDESCipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;TripleDES&nbsp;encryption.</span><br>
<span class="lineno"></span><span class="keyword" id="4038496">type</span>&nbsp;<span class="ident" id="4038501">tripleDESCipher</span>&nbsp;<span class="keyword" id="4038517">struct</span>&nbsp;<span class="op" id="4038524">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038527">cipher1</span><span class="op" id="4038534">,</span>&nbsp;<span class="ident" id="4038536">cipher2</span><span class="op" id="4038543">,</span>&nbsp;<span class="ident" id="4038545">cipher3</span>&nbsp;<span class="ident" id="4038553">desCipher</span><br>
<span class="lineno"></span><span class="op" id="4038563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4038566">//&nbsp;NewTripleDESCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="keyword" id="4038628">func</span>&nbsp;<span class="ident" id="4038633">NewTripleDESCipher</span><span class="op" id="4038651">(</span><span class="ident" id="4038652">key</span>&nbsp;<span class="op" id="4038656">[</span><span class="op" id="4038657">]</span><span class="builtintype" id="4038658">byte</span><span class="op" id="4038662">)</span>&nbsp;<span class="op" id="4038664">(</span><span class="ident" id="4038665">cipher</span><span class="op" id="4038671">.</span><span class="ident" id="4038672">Block</span><span class="op" id="4038677">,</span>&nbsp;<span class="builtintype" id="4038679">error</span><span class="op" id="4038684">)</span>&nbsp;<span class="op" id="4038686">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038689">if</span>&nbsp;<span class="builtinfunc" id="4038692">len</span><span class="op" id="4038695">(</span><span class="ident" id="4038696">key</span><span class="op" id="4038699">)</span>&nbsp;<span class="op" id="4038701">!=</span>&nbsp;<span class="num" id="4038704">24</span>&nbsp;<span class="op" id="4038707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038711">return</span>&nbsp;<span class="ident" id="4038718">nil</span><span class="op" id="4038721">,</span>&nbsp;<span class="ident" id="4038723">KeySizeError</span><span class="op" id="4038735">(</span><span class="builtinfunc" id="4038736">len</span><span class="op" id="4038739">(</span><span class="ident" id="4038740">key</span><span class="op" id="4038743">)</span><span class="op" id="4038744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4038747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038751">c</span>&nbsp;<span class="op" id="4038753">:=</span>&nbsp;<span class="builtinfunc" id="4038756">new</span><span class="op" id="4038759">(</span><span class="ident" id="4038760">tripleDESCipher</span><span class="op" id="4038775">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038778">c</span><span class="op" id="4038779">.</span><span class="ident" id="4038780">cipher1</span><span class="op" id="4038787">.</span><span class="ident" id="4038788">generateSubkeys</span><span class="op" id="4038803">(</span><span class="ident" id="4038804">key</span><span class="op" id="4038807">[</span><span class="op" id="4038808">:</span><span class="num" id="4038809">8</span><span class="op" id="4038810">]</span><span class="op" id="4038811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038814">c</span><span class="op" id="4038815">.</span><span class="ident" id="4038816">cipher2</span><span class="op" id="4038823">.</span><span class="ident" id="4038824">generateSubkeys</span><span class="op" id="4038839">(</span><span class="ident" id="4038840">key</span><span class="op" id="4038843">[</span><span class="num" id="4038844">8</span><span class="op" id="4038845">:</span><span class="num" id="4038846">16</span><span class="op" id="4038848">]</span><span class="op" id="4038849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038852">c</span><span class="op" id="4038853">.</span><span class="ident" id="4038854">cipher3</span><span class="op" id="4038861">.</span><span class="ident" id="4038862">generateSubkeys</span><span class="op" id="4038877">(</span><span class="ident" id="4038878">key</span><span class="op" id="4038881">[</span><span class="num" id="4038882">16</span><span class="op" id="4038884">:</span><span class="op" id="4038885">]</span><span class="op" id="4038886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038889">return</span>&nbsp;<span class="ident" id="4038896">c</span><span class="op" id="4038897">,</span>&nbsp;<span class="ident" id="4038899">nil</span><br>
<span class="lineno"></span><span class="op" id="4038903">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="4038906">func</span>&nbsp;<span class="op" id="4038911">(</span><span class="ident" id="4038912">c</span>&nbsp;<span class="op" id="4038914">*</span><span class="ident" id="4038915">tripleDESCipher</span><span class="op" id="4038930">)</span>&nbsp;<span class="ident" id="4038932">BlockSize</span><span class="op" id="4038941">(</span><span class="op" id="4038942">)</span>&nbsp;<span class="builtintype" id="4038944">int</span>&nbsp;<span class="op" id="4038948">{</span>&nbsp;<span class="keyword" id="4038950">return</span>&nbsp;<span class="ident" id="4038957">BlockSize</span>&nbsp;<span class="op" id="4038967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4038970">func</span>&nbsp;<span class="op" id="4038975">(</span><span class="ident" id="4038976">c</span>&nbsp;<span class="op" id="4038978">*</span><span class="ident" id="4038979">tripleDESCipher</span><span class="op" id="4038994">)</span>&nbsp;<span class="ident" id="4038996">Encrypt</span><span class="op" id="4039003">(</span><span class="ident" id="4039004">dst</span><span class="op" id="4039007">,</span>&nbsp;<span class="ident" id="4039009">src</span>&nbsp;<span class="op" id="4039013">[</span><span class="op" id="4039014">]</span><span class="builtintype" id="4039015">byte</span><span class="op" id="4039019">)</span>&nbsp;<span class="op" id="4039021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039024">c</span><span class="op" id="4039025">.</span><span class="ident" id="4039026">cipher1</span><span class="op" id="4039033">.</span><span class="ident" id="4039034">Encrypt</span><span class="op" id="4039041">(</span><span class="ident" id="4039042">dst</span><span class="op" id="4039045">,</span>&nbsp;<span class="ident" id="4039047">src</span><span class="op" id="4039050">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039053">c</span><span class="op" id="4039054">.</span><span class="ident" id="4039055">cipher2</span><span class="op" id="4039062">.</span><span class="ident" id="4039063">Decrypt</span><span class="op" id="4039070">(</span><span class="ident" id="4039071">dst</span><span class="op" id="4039074">,</span>&nbsp;<span class="ident" id="4039076">dst</span><span class="op" id="4039079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039082">c</span><span class="op" id="4039083">.</span><span class="ident" id="4039084">cipher3</span><span class="op" id="4039091">.</span><span class="ident" id="4039092">Encrypt</span><span class="op" id="4039099">(</span><span class="ident" id="4039100">dst</span><span class="op" id="4039103">,</span>&nbsp;<span class="ident" id="4039105">dst</span><span class="op" id="4039108">)</span><br>
<span class="lineno"></span><span class="op" id="4039110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4039113">func</span>&nbsp;<span class="op" id="4039118">(</span><span class="ident" id="4039119">c</span>&nbsp;<span class="op" id="4039121">*</span><span class="ident" id="4039122">tripleDESCipher</span><span class="op" id="4039137">)</span>&nbsp;<span class="ident" id="4039139">Decrypt</span><span class="op" id="4039146">(</span><span class="ident" id="4039147">dst</span><span class="op" id="4039150">,</span>&nbsp;<span class="ident" id="4039152">src</span>&nbsp;<span class="op" id="4039156">[</span><span class="op" id="4039157">]</span><span class="builtintype" id="4039158">byte</span><span class="op" id="4039162">)</span>&nbsp;<span class="op" id="4039164">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039167">c</span><span class="op" id="4039168">.</span><span class="ident" id="4039169">cipher3</span><span class="op" id="4039176">.</span><span class="ident" id="4039177">Decrypt</span><span class="op" id="4039184">(</span><span class="ident" id="4039185">dst</span><span class="op" id="4039188">,</span>&nbsp;<span class="ident" id="4039190">src</span><span class="op" id="4039193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039196">c</span><span class="op" id="4039197">.</span><span class="ident" id="4039198">cipher2</span><span class="op" id="4039205">.</span><span class="ident" id="4039206">Encrypt</span><span class="op" id="4039213">(</span><span class="ident" id="4039214">dst</span><span class="op" id="4039217">,</span>&nbsp;<span class="ident" id="4039219">dst</span><span class="op" id="4039222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039225">c</span><span class="op" id="4039226">.</span><span class="ident" id="4039227">cipher1</span><span class="op" id="4039234">.</span><span class="ident" id="4039235">Decrypt</span><span class="op" id="4039242">(</span><span class="ident" id="4039243">dst</span><span class="op" id="4039246">,</span>&nbsp;<span class="ident" id="4039248">dst</span><span class="op" id="4039251">)</span><br>
<span class="lineno"></span><span class="op" id="4039253">}</span>
</div>
</body>
</html>
