<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html" class="current">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1716094">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1716149">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1716203">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1716254">//&nbsp;Time-related&nbsp;runtime&nbsp;and&nbsp;pieces&nbsp;of&nbsp;package&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1716307">package</span>&nbsp;<span class="ident" id="1716315">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1716324">import</span>&nbsp;<span class="string" id="1716331">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1716341">//&nbsp;Package&nbsp;time&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1716393">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../time/sleep.go:/runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="1716459">//&nbsp;For&nbsp;GOOS=nacl,&nbsp;package&nbsp;syscall&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1716529">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../syscall/net_nacl.go:/runtimeTimer.</span><br>
<span class="lineno">15</span><span class="keyword" id="1716601">type</span>&nbsp;<span class="ident" id="1716606">timer</span>&nbsp;<span class="keyword" id="1716612">struct</span>&nbsp;<span class="op" id="1716619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1716622">i</span>&nbsp;<span class="builtintype" id="1716624">int</span>&nbsp;<span class="comment" id="1716628">//&nbsp;heap&nbsp;index</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1716644">//&nbsp;Timer&nbsp;wakes&nbsp;up&nbsp;at&nbsp;when,&nbsp;and&nbsp;then&nbsp;at&nbsp;when+period,&nbsp;...&nbsp;(period&nbsp;&gt;&nbsp;0&nbsp;only)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1716719">//&nbsp;each&nbsp;time&nbsp;calling&nbsp;f(now,&nbsp;arg)&nbsp;in&nbsp;the&nbsp;timer&nbsp;goroutine,&nbsp;so&nbsp;f&nbsp;must&nbsp;be</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1716790">//&nbsp;a&nbsp;well-behaved&nbsp;function&nbsp;and&nbsp;not&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1716833">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1716840">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1716847">period</span>&nbsp;<span class="ident" id="1716854">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1716861">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1716868">func</span><span class="op" id="1716872">(</span><span class="keyword" id="1716873">interface</span><span class="op" id="1716882">{</span><span class="op" id="1716883">}</span><span class="op" id="1716884">,</span>&nbsp;<span class="builtintype" id="1716886">uintptr</span><span class="op" id="1716893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1716896">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1716903">interface</span><span class="op" id="1716912">{</span><span class="op" id="1716913">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1716916">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1716923">uintptr</span><br>
<span class="lineno"></span><span class="op" id="1716931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1716934">var</span>&nbsp;<span class="ident" id="1716938">timers</span>&nbsp;<span class="keyword" id="1716945">struct</span>&nbsp;<span class="op" id="1716952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1716955">lock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1716968">mutex</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1716975">gp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1716988">*</span><span class="ident" id="1716989">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1716992">created</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1717005">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717011">sleeping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1717024">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717030">rescheduling</span>&nbsp;<span class="builtintype" id="1717043">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717049">waitnote</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717062">note</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717068">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1717081">[</span><span class="op" id="1717082">]</span><span class="op" id="1717083">*</span><span class="ident" id="1717084">timer</span><br>
<span class="lineno"></span><span class="op" id="1717090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1717093">//&nbsp;nacl&nbsp;fake&nbsp;time&nbsp;support&nbsp;-&nbsp;time&nbsp;in&nbsp;nanoseconds&nbsp;since&nbsp;1970</span><br>
<span class="lineno"></span><span class="keyword" id="1717152">var</span>&nbsp;<span class="ident" id="1717156">faketime</span>&nbsp;<span class="ident" id="1717165">int64</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="1717172">//&nbsp;Package&nbsp;time&nbsp;APIs.</span><br>
<span class="lineno"></span><span class="comment" id="1717194">//&nbsp;Godoc&nbsp;uses&nbsp;the&nbsp;comments&nbsp;in&nbsp;package&nbsp;time,&nbsp;not&nbsp;these.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1717250">//&nbsp;time.now&nbsp;is&nbsp;implemented&nbsp;in&nbsp;assembly.</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="1717291">//&nbsp;Sleep&nbsp;puts&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;to&nbsp;sleep&nbsp;for&nbsp;at&nbsp;least&nbsp;ns&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="1717365">func</span>&nbsp;<span class="ident" id="1717370">timeSleep</span><span class="op" id="1717379">(</span><span class="ident" id="1717380">ns</span>&nbsp;<span class="ident" id="1717383">int64</span><span class="op" id="1717388">)</span>&nbsp;<span class="op" id="1717390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1717393">if</span>&nbsp;<span class="ident" id="1717396">ns</span>&nbsp;<span class="op" id="1717399">&lt;=</span>&nbsp;<span class="num" id="1717402">0</span>&nbsp;<span class="op" id="1717404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1717408">return</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1717416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717420">t</span>&nbsp;<span class="op" id="1717422">:=</span>&nbsp;<span class="builtinfunc" id="1717425">new</span><span class="op" id="1717428">(</span><span class="ident" id="1717429">timer</span><span class="op" id="1717434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717437">t</span><span class="op" id="1717438">.</span><span class="ident" id="1717439">when</span>&nbsp;<span class="op" id="1717444">=</span>&nbsp;<span class="ident" id="1717446">nanotime</span><span class="op" id="1717454">(</span><span class="op" id="1717455">)</span>&nbsp;<span class="op" id="1717457">+</span>&nbsp;<span class="ident" id="1717459">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717463">t</span><span class="op" id="1717464">.</span><span class="ident" id="1717465">f</span>&nbsp;<span class="op" id="1717467">=</span>&nbsp;<span class="ident" id="1717469">goroutineReady</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717485">t</span><span class="op" id="1717486">.</span><span class="ident" id="1717487">arg</span>&nbsp;<span class="op" id="1717491">=</span>&nbsp;<span class="ident" id="1717493">getg</span><span class="op" id="1717497">(</span><span class="op" id="1717498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717501">lock</span><span class="op" id="1717505">(</span><span class="op" id="1717506">&amp;</span><span class="ident" id="1717507">timers</span><span class="op" id="1717513">.</span><span class="ident" id="1717514">lock</span><span class="op" id="1717518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717521">addtimerLocked</span><span class="op" id="1717535">(</span><span class="ident" id="1717536">t</span><span class="op" id="1717537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717540">goparkunlock</span><span class="op" id="1717552">(</span><span class="op" id="1717553">&amp;</span><span class="ident" id="1717554">timers</span><span class="op" id="1717560">.</span><span class="ident" id="1717561">lock</span><span class="op" id="1717565">,</span>&nbsp;<span class="string" id="1717567">&#34;sleep&#34;</span><span class="op" id="1717574">)</span><br>
<span class="lineno"></span><span class="op" id="1717576">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="1717579">//&nbsp;startTimer&nbsp;adds&nbsp;t&nbsp;to&nbsp;the&nbsp;timer&nbsp;heap.</span><br>
<span class="lineno"></span><span class="keyword" id="1717619">func</span>&nbsp;<span class="ident" id="1717624">startTimer</span><span class="op" id="1717634">(</span><span class="ident" id="1717635">t</span>&nbsp;<span class="op" id="1717637">*</span><span class="ident" id="1717638">timer</span><span class="op" id="1717643">)</span>&nbsp;<span class="op" id="1717645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1717648">if</span>&nbsp;<span class="ident" id="1717651">raceenabled</span>&nbsp;<span class="op" id="1717663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717667">racerelease</span><span class="op" id="1717678">(</span><span class="ident" id="1717679">unsafe</span><span class="op" id="1717685">.</span><span class="ident" id="1717686">Pointer</span><span class="op" id="1717693">(</span><span class="ident" id="1717694">t</span><span class="op" id="1717695">)</span><span class="op" id="1717696">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1717699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717702">addtimer</span><span class="op" id="1717710">(</span><span class="ident" id="1717711">t</span><span class="op" id="1717712">)</span><br>
<span class="lineno"></span><span class="op" id="1717714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1717717">//&nbsp;stopTimer&nbsp;removes&nbsp;t&nbsp;from&nbsp;the&nbsp;timer&nbsp;heap&nbsp;if&nbsp;it&nbsp;is&nbsp;there.</span><br>
<span class="lineno">70</span><span class="comment" id="1717776">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;t&nbsp;was&nbsp;removed,&nbsp;false&nbsp;if&nbsp;t&nbsp;wasn&#39;t&nbsp;even&nbsp;there.</span><br>
<span class="lineno"></span><span class="keyword" id="1717843">func</span>&nbsp;<span class="ident" id="1717848">stopTimer</span><span class="op" id="1717857">(</span><span class="ident" id="1717858">t</span>&nbsp;<span class="op" id="1717860">*</span><span class="ident" id="1717861">timer</span><span class="op" id="1717866">)</span>&nbsp;<span class="builtintype" id="1717868">bool</span>&nbsp;<span class="op" id="1717873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1717876">return</span>&nbsp;<span class="ident" id="1717883">deltimer</span><span class="op" id="1717891">(</span><span class="ident" id="1717892">t</span><span class="op" id="1717893">)</span><br>
<span class="lineno"></span><span class="op" id="1717895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="1717898">//&nbsp;Go&nbsp;runtime.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1717914">//&nbsp;Ready&nbsp;the&nbsp;goroutine&nbsp;arg.</span><br>
<span class="lineno"></span><span class="keyword" id="1717942">func</span>&nbsp;<span class="ident" id="1717947">goroutineReady</span><span class="op" id="1717961">(</span><span class="ident" id="1717962">arg</span>&nbsp;<span class="keyword" id="1717966">interface</span><span class="op" id="1717975">{</span><span class="op" id="1717976">}</span><span class="op" id="1717977">,</span>&nbsp;<span class="ident" id="1717979">seq</span>&nbsp;<span class="builtintype" id="1717983">uintptr</span><span class="op" id="1717990">)</span>&nbsp;<span class="op" id="1717992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1717995">goready</span><span class="op" id="1718002">(</span><span class="ident" id="1718003">arg</span><span class="op" id="1718006">.</span><span class="op" id="1718007">(</span><span class="op" id="1718008">*</span><span class="ident" id="1718009">g</span><span class="op" id="1718010">)</span><span class="op" id="1718011">)</span><br>
<span class="lineno">80</span><span class="op" id="1718013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1718016">func</span>&nbsp;<span class="ident" id="1718021">addtimer</span><span class="op" id="1718029">(</span><span class="ident" id="1718030">t</span>&nbsp;<span class="op" id="1718032">*</span><span class="ident" id="1718033">timer</span><span class="op" id="1718038">)</span>&nbsp;<span class="op" id="1718040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1718043">lock</span><span class="op" id="1718047">(</span><span class="op" id="1718048">&amp;</span><span class="ident" id="1718049">timers</span><span class="op" id="1718055">.</span><span class="ident" id="1718056">lock</span><span class="op" id="1718060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1718063">addtimerLocked</span><span class="op" id="1718077">(</span><span class="ident" id="1718078">t</span><span class="op" id="1718079">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1718082">unlock</span><span class="op" id="1718088">(</span><span class="op" id="1718089">&amp;</span><span class="ident" id="1718090">timers</span><span class="op" id="1718096">.</span><span class="ident" id="1718097">lock</span><span class="op" id="1718101">)</span><br>
<span class="lineno"></span><span class="op" id="1718103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1718106">//&nbsp;Add&nbsp;a&nbsp;timer&nbsp;to&nbsp;the&nbsp;heap&nbsp;and&nbsp;start&nbsp;or&nbsp;kick&nbsp;the&nbsp;timer&nbsp;proc.</span><br>
<span class="lineno"></span><span class="comment" id="1718167">//&nbsp;If&nbsp;the&nbsp;new&nbsp;timer&nbsp;is&nbsp;earlier&nbsp;than&nbsp;any&nbsp;of&nbsp;the&nbsp;others.</span><br>
<span class="lineno">90</span><span class="comment" id="1718222">//&nbsp;Timers&nbsp;are&nbsp;locked.</span><br>
<span class="lineno"></span><span class="keyword" id="1718244">func</span>&nbsp;<span class="ident" id="1718249">addtimerLocked</span><span class="op" id="1718263">(</span><span class="ident" id="1718264">t</span>&nbsp;<span class="op" id="1718266">*</span><span class="ident" id="1718267">timer</span><span class="op" id="1718272">)</span>&nbsp;<span class="op" id="1718274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1718277">//&nbsp;when&nbsp;must&nbsp;never&nbsp;be&nbsp;negative;&nbsp;otherwise&nbsp;timerproc&nbsp;will&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1718344">//&nbsp;during&nbsp;its&nbsp;delta&nbsp;calculation&nbsp;and&nbsp;never&nbsp;expire&nbsp;other&nbsp;runtime·timers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1718417">if</span>&nbsp;<span class="ident" id="1718420">t</span><span class="op" id="1718421">.</span><span class="ident" id="1718422">when</span>&nbsp;<span class="op" id="1718427">&lt;</span>&nbsp;<span class="num" id="1718429">0</span>&nbsp;<span class="op" id="1718431">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1718435">t</span><span class="op" id="1718436">.</span><span class="ident" id="1718437">when</span>&nbsp;<span class="op" id="1718442">=</span>&nbsp;<span class="num" id="1718444">1</span><span class="op" id="1718445">&lt;&lt;</span><span class="num" id="1718447">63</span>&nbsp;<span class="op" id="1718450">-</span>&nbsp;<span class="num" id="1718452">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1718455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1718458">t</span><span class="op" id="1718459">.</span><span class="ident" id="1718460">i</span>&nbsp;<span class="op" id="1718462">=</span>&nbsp;<span class="builtinfunc" id="1718464">len</span><span class="op" id="1718467">(</span><span class="ident" id="1718468">timers</span><span class="op" id="1718474">.</span><span class="ident" id="1718475">t</span><span class="op" id="1718476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1718479">timers</span><span class="op" id="1718485">.</span><span class="ident" id="1718486">t</span>&nbsp;<span class="op" id="1718488">=</span>&nbsp;<span class="builtinfunc" id="1718490">append</span><span class="op" id="1718496">(</span><span class="ident" id="1718497">timers</span><span class="op" id="1718503">.</span><span class="ident" id="1718504">t</span><span class="op" id="1718505">,</span>&nbsp;<span class="ident" id="1718507">t</span><span class="op" id="1718508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1718511">siftupTimer</span><span class="op" id="1718522">(</span><span class="ident" id="1718523">t</span><span class="op" id="1718524">.</span><span class="ident" id="1718525">i</span><span class="op" id="1718526">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1718529">if</span>&nbsp;<span class="ident" id="1718532">t</span><span class="op" id="1718533">.</span><span class="ident" id="1718534">i</span>&nbsp;<span class="op" id="1718536">==</span>&nbsp;<span class="num" id="1718539">0</span>&nbsp;<span class="op" id="1718541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1718545">//&nbsp;siftup&nbsp;moved&nbsp;to&nbsp;top:&nbsp;new&nbsp;earliest&nbsp;deadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1718594">if</span>&nbsp;<span class="ident" id="1718597">timers</span><span class="op" id="1718603">.</span><span class="ident" id="1718604">sleeping</span>&nbsp;<span class="op" id="1718613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1718618">timers</span><span class="op" id="1718624">.</span><span class="ident" id="1718625">sleeping</span>&nbsp;<span class="op" id="1718634">=</span>&nbsp;<span class="builtintype" id="1718636">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1718645">notewakeup</span><span class="op" id="1718655">(</span><span class="op" id="1718656">&amp;</span><span class="ident" id="1718657">timers</span><span class="op" id="1718663">.</span><span class="ident" id="1718664">waitnote</span><span class="op" id="1718672">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1718676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1718680">if</span>&nbsp;<span class="ident" id="1718683">timers</span><span class="op" id="1718689">.</span><span class="ident" id="1718690">rescheduling</span>&nbsp;<span class="op" id="1718703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1718708">timers</span><span class="op" id="1718714">.</span><span class="ident" id="1718715">rescheduling</span>&nbsp;<span class="op" id="1718728">=</span>&nbsp;<span class="builtintype" id="1718730">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1718739">goready</span><span class="op" id="1718746">(</span><span class="ident" id="1718747">timers</span><span class="op" id="1718753">.</span><span class="ident" id="1718754">gp</span><span class="op" id="1718756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1718760">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1718763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1718766">if</span>&nbsp;<span class="op" id="1718769">!</span><span class="ident" id="1718770">timers</span><span class="op" id="1718776">.</span><span class="ident" id="1718777">created</span>&nbsp;<span class="op" id="1718785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1718789">timers</span><span class="op" id="1718795">.</span><span class="ident" id="1718796">created</span>&nbsp;<span class="op" id="1718804">=</span>&nbsp;<span class="builtintype" id="1718806">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1718813">go</span>&nbsp;<span class="ident" id="1718816">timerproc</span><span class="op" id="1718825">(</span><span class="op" id="1718826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1718829">}</span><br>
<span class="lineno">115</span><span class="op" id="1718831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1718834">//&nbsp;Delete&nbsp;timer&nbsp;t&nbsp;from&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span><span class="comment" id="1718867">//&nbsp;Do&nbsp;not&nbsp;need&nbsp;to&nbsp;update&nbsp;the&nbsp;timerproc:&nbsp;if&nbsp;it&nbsp;wakes&nbsp;up&nbsp;early,&nbsp;no&nbsp;big&nbsp;deal.</span><br>
<span class="lineno"></span><span class="keyword" id="1718942">func</span>&nbsp;<span class="ident" id="1718947">deltimer</span><span class="op" id="1718955">(</span><span class="ident" id="1718956">t</span>&nbsp;<span class="op" id="1718958">*</span><span class="ident" id="1718959">timer</span><span class="op" id="1718964">)</span>&nbsp;<span class="builtintype" id="1718966">bool</span>&nbsp;<span class="op" id="1718971">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1718974">//&nbsp;Dereference&nbsp;t&nbsp;so&nbsp;that&nbsp;any&nbsp;panic&nbsp;happens&nbsp;before&nbsp;the&nbsp;lock&nbsp;is&nbsp;held.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1719043">//&nbsp;Discard&nbsp;result,&nbsp;because&nbsp;t&nbsp;might&nbsp;be&nbsp;moving&nbsp;in&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719102">_</span>&nbsp;<span class="op" id="1719104">=</span>&nbsp;<span class="ident" id="1719106">t</span><span class="op" id="1719107">.</span><span class="ident" id="1719108">i</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719112">lock</span><span class="op" id="1719116">(</span><span class="op" id="1719117">&amp;</span><span class="ident" id="1719118">timers</span><span class="op" id="1719124">.</span><span class="ident" id="1719125">lock</span><span class="op" id="1719129">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1719132">//&nbsp;t&nbsp;may&nbsp;not&nbsp;be&nbsp;registered&nbsp;anymore&nbsp;and&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1719181">//&nbsp;a&nbsp;bogus&nbsp;i&nbsp;(typically&nbsp;0,&nbsp;if&nbsp;generated&nbsp;by&nbsp;Go).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1719230">//&nbsp;Verify&nbsp;it&nbsp;before&nbsp;proceeding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719263">i</span>&nbsp;<span class="op" id="1719265">:=</span>&nbsp;<span class="ident" id="1719268">t</span><span class="op" id="1719269">.</span><span class="ident" id="1719270">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719273">last</span>&nbsp;<span class="op" id="1719278">:=</span>&nbsp;<span class="builtinfunc" id="1719281">len</span><span class="op" id="1719284">(</span><span class="ident" id="1719285">timers</span><span class="op" id="1719291">.</span><span class="ident" id="1719292">t</span><span class="op" id="1719293">)</span>&nbsp;<span class="op" id="1719295">-</span>&nbsp;<span class="num" id="1719297">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1719300">if</span>&nbsp;<span class="ident" id="1719303">i</span>&nbsp;<span class="op" id="1719305">&lt;</span>&nbsp;<span class="num" id="1719307">0</span>&nbsp;<span class="op" id="1719309">||</span>&nbsp;<span class="ident" id="1719312">i</span>&nbsp;<span class="op" id="1719314">&gt;</span>&nbsp;<span class="ident" id="1719316">last</span>&nbsp;<span class="op" id="1719321">||</span>&nbsp;<span class="ident" id="1719324">timers</span><span class="op" id="1719330">.</span><span class="ident" id="1719331">t</span><span class="op" id="1719332">[</span><span class="ident" id="1719333">i</span><span class="op" id="1719334">]</span>&nbsp;<span class="op" id="1719336">!=</span>&nbsp;<span class="ident" id="1719339">t</span>&nbsp;<span class="op" id="1719341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719345">unlock</span><span class="op" id="1719351">(</span><span class="op" id="1719352">&amp;</span><span class="ident" id="1719353">timers</span><span class="op" id="1719359">.</span><span class="ident" id="1719360">lock</span><span class="op" id="1719364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1719368">return</span>&nbsp;<span class="builtintype" id="1719375">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1719382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1719385">if</span>&nbsp;<span class="ident" id="1719388">i</span>&nbsp;<span class="op" id="1719390">!=</span>&nbsp;<span class="ident" id="1719393">last</span>&nbsp;<span class="op" id="1719398">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719402">timers</span><span class="op" id="1719408">.</span><span class="ident" id="1719409">t</span><span class="op" id="1719410">[</span><span class="ident" id="1719411">i</span><span class="op" id="1719412">]</span>&nbsp;<span class="op" id="1719414">=</span>&nbsp;<span class="ident" id="1719416">timers</span><span class="op" id="1719422">.</span><span class="ident" id="1719423">t</span><span class="op" id="1719424">[</span><span class="ident" id="1719425">last</span><span class="op" id="1719429">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719433">timers</span><span class="op" id="1719439">.</span><span class="ident" id="1719440">t</span><span class="op" id="1719441">[</span><span class="ident" id="1719442">i</span><span class="op" id="1719443">]</span><span class="op" id="1719444">.</span><span class="ident" id="1719445">i</span>&nbsp;<span class="op" id="1719447">=</span>&nbsp;<span class="ident" id="1719449">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1719452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719455">timers</span><span class="op" id="1719461">.</span><span class="ident" id="1719462">t</span><span class="op" id="1719463">[</span><span class="ident" id="1719464">last</span><span class="op" id="1719468">]</span>&nbsp;<span class="op" id="1719470">=</span>&nbsp;<span class="builtintype" id="1719472">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719477">timers</span><span class="op" id="1719483">.</span><span class="ident" id="1719484">t</span>&nbsp;<span class="op" id="1719486">=</span>&nbsp;<span class="ident" id="1719488">timers</span><span class="op" id="1719494">.</span><span class="ident" id="1719495">t</span><span class="op" id="1719496">[</span><span class="op" id="1719497">:</span><span class="ident" id="1719498">last</span><span class="op" id="1719502">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1719505">if</span>&nbsp;<span class="ident" id="1719508">i</span>&nbsp;<span class="op" id="1719510">!=</span>&nbsp;<span class="ident" id="1719513">last</span>&nbsp;<span class="op" id="1719518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719522">siftupTimer</span><span class="op" id="1719533">(</span><span class="ident" id="1719534">i</span><span class="op" id="1719535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719539">siftdownTimer</span><span class="op" id="1719552">(</span><span class="ident" id="1719553">i</span><span class="op" id="1719554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1719557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719560">unlock</span><span class="op" id="1719566">(</span><span class="op" id="1719567">&amp;</span><span class="ident" id="1719568">timers</span><span class="op" id="1719574">.</span><span class="ident" id="1719575">lock</span><span class="op" id="1719579">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1719582">return</span>&nbsp;<span class="builtintype" id="1719589">true</span><br>
<span class="lineno"></span><span class="op" id="1719594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1719597">//&nbsp;Timerproc&nbsp;runs&nbsp;the&nbsp;time-driven&nbsp;events.</span><br>
<span class="lineno"></span><span class="comment" id="1719639">//&nbsp;It&nbsp;sleeps&nbsp;until&nbsp;the&nbsp;next&nbsp;event&nbsp;in&nbsp;the&nbsp;timers&nbsp;heap.</span><br>
<span class="lineno">150</span><span class="comment" id="1719693">//&nbsp;If&nbsp;addtimer&nbsp;inserts&nbsp;a&nbsp;new&nbsp;earlier&nbsp;event,&nbsp;addtimer1&nbsp;wakes&nbsp;timerproc&nbsp;early.</span><br>
<span class="lineno"></span><span class="keyword" id="1719770">func</span>&nbsp;<span class="ident" id="1719775">timerproc</span><span class="op" id="1719784">(</span><span class="op" id="1719785">)</span>&nbsp;<span class="op" id="1719787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719790">timers</span><span class="op" id="1719796">.</span><span class="ident" id="1719797">gp</span>&nbsp;<span class="op" id="1719800">=</span>&nbsp;<span class="ident" id="1719802">getg</span><span class="op" id="1719806">(</span><span class="op" id="1719807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719810">timers</span><span class="op" id="1719816">.</span><span class="ident" id="1719817">gp</span><span class="op" id="1719819">.</span><span class="ident" id="1719820">issystem</span>&nbsp;<span class="op" id="1719829">=</span>&nbsp;<span class="builtintype" id="1719831">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1719837">for</span>&nbsp;<span class="op" id="1719841">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719845">lock</span><span class="op" id="1719849">(</span><span class="op" id="1719850">&amp;</span><span class="ident" id="1719851">timers</span><span class="op" id="1719857">.</span><span class="ident" id="1719858">lock</span><span class="op" id="1719862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719866">timers</span><span class="op" id="1719872">.</span><span class="ident" id="1719873">sleeping</span>&nbsp;<span class="op" id="1719882">=</span>&nbsp;<span class="builtintype" id="1719884">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719892">now</span>&nbsp;<span class="op" id="1719896">:=</span>&nbsp;<span class="ident" id="1719899">nanotime</span><span class="op" id="1719907">(</span><span class="op" id="1719908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719912">delta</span>&nbsp;<span class="op" id="1719918">:=</span>&nbsp;<span class="ident" id="1719921">int64</span><span class="op" id="1719926">(</span><span class="op" id="1719927">-</span><span class="num" id="1719928">1</span><span class="op" id="1719929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1719933">for</span>&nbsp;<span class="op" id="1719937">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1719942">if</span>&nbsp;<span class="builtinfunc" id="1719945">len</span><span class="op" id="1719948">(</span><span class="ident" id="1719949">timers</span><span class="op" id="1719955">.</span><span class="ident" id="1719956">t</span><span class="op" id="1719957">)</span>&nbsp;<span class="op" id="1719959">==</span>&nbsp;<span class="num" id="1719962">0</span>&nbsp;<span class="op" id="1719964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719970">delta</span>&nbsp;<span class="op" id="1719976">=</span>&nbsp;<span class="op" id="1719978">-</span><span class="num" id="1719979">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1719985">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1719994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1719999">t</span>&nbsp;<span class="op" id="1720001">:=</span>&nbsp;<span class="ident" id="1720004">timers</span><span class="op" id="1720010">.</span><span class="ident" id="1720011">t</span><span class="op" id="1720012">[</span><span class="num" id="1720013">0</span><span class="op" id="1720014">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720019">delta</span>&nbsp;<span class="op" id="1720025">=</span>&nbsp;<span class="ident" id="1720027">t</span><span class="op" id="1720028">.</span><span class="ident" id="1720029">when</span>&nbsp;<span class="op" id="1720034">-</span>&nbsp;<span class="ident" id="1720036">now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1720043">if</span>&nbsp;<span class="ident" id="1720046">delta</span>&nbsp;<span class="op" id="1720052">&gt;</span>&nbsp;<span class="num" id="1720054">0</span>&nbsp;<span class="op" id="1720056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1720062">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1720071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1720076">if</span>&nbsp;<span class="ident" id="1720079">t</span><span class="op" id="1720080">.</span><span class="ident" id="1720081">period</span>&nbsp;<span class="op" id="1720088">&gt;</span>&nbsp;<span class="num" id="1720090">0</span>&nbsp;<span class="op" id="1720092">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1720098">//&nbsp;leave&nbsp;in&nbsp;heap&nbsp;but&nbsp;adjust&nbsp;next&nbsp;time&nbsp;to&nbsp;fire</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720148">t</span><span class="op" id="1720149">.</span><span class="ident" id="1720150">when</span>&nbsp;<span class="op" id="1720155">+=</span>&nbsp;<span class="ident" id="1720158">t</span><span class="op" id="1720159">.</span><span class="ident" id="1720160">period</span>&nbsp;<span class="op" id="1720167">*</span>&nbsp;<span class="op" id="1720169">(</span><span class="num" id="1720170">1</span>&nbsp;<span class="op" id="1720172">+</span>&nbsp;<span class="op" id="1720174">-</span><span class="ident" id="1720175">delta</span><span class="op" id="1720180">/</span><span class="ident" id="1720181">t</span><span class="op" id="1720182">.</span><span class="ident" id="1720183">period</span><span class="op" id="1720189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720195">siftdownTimer</span><span class="op" id="1720208">(</span><span class="num" id="1720209">0</span><span class="op" id="1720210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1720215">}</span>&nbsp;<span class="keyword" id="1720217">else</span>&nbsp;<span class="op" id="1720222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1720228">//&nbsp;remove&nbsp;from&nbsp;heap</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720252">last</span>&nbsp;<span class="op" id="1720257">:=</span>&nbsp;<span class="builtinfunc" id="1720260">len</span><span class="op" id="1720263">(</span><span class="ident" id="1720264">timers</span><span class="op" id="1720270">.</span><span class="ident" id="1720271">t</span><span class="op" id="1720272">)</span>&nbsp;<span class="op" id="1720274">-</span>&nbsp;<span class="num" id="1720276">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1720282">if</span>&nbsp;<span class="ident" id="1720285">last</span>&nbsp;<span class="op" id="1720290">&gt;</span>&nbsp;<span class="num" id="1720292">0</span>&nbsp;<span class="op" id="1720294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720301">timers</span><span class="op" id="1720307">.</span><span class="ident" id="1720308">t</span><span class="op" id="1720309">[</span><span class="num" id="1720310">0</span><span class="op" id="1720311">]</span>&nbsp;<span class="op" id="1720313">=</span>&nbsp;<span class="ident" id="1720315">timers</span><span class="op" id="1720321">.</span><span class="ident" id="1720322">t</span><span class="op" id="1720323">[</span><span class="ident" id="1720324">last</span><span class="op" id="1720328">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720335">timers</span><span class="op" id="1720341">.</span><span class="ident" id="1720342">t</span><span class="op" id="1720343">[</span><span class="num" id="1720344">0</span><span class="op" id="1720345">]</span><span class="op" id="1720346">.</span><span class="ident" id="1720347">i</span>&nbsp;<span class="op" id="1720349">=</span>&nbsp;<span class="num" id="1720351">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1720357">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720363">timers</span><span class="op" id="1720369">.</span><span class="ident" id="1720370">t</span><span class="op" id="1720371">[</span><span class="ident" id="1720372">last</span><span class="op" id="1720376">]</span>&nbsp;<span class="op" id="1720378">=</span>&nbsp;<span class="builtintype" id="1720380">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720388">timers</span><span class="op" id="1720394">.</span><span class="ident" id="1720395">t</span>&nbsp;<span class="op" id="1720397">=</span>&nbsp;<span class="ident" id="1720399">timers</span><span class="op" id="1720405">.</span><span class="ident" id="1720406">t</span><span class="op" id="1720407">[</span><span class="op" id="1720408">:</span><span class="ident" id="1720409">last</span><span class="op" id="1720413">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1720419">if</span>&nbsp;<span class="ident" id="1720422">last</span>&nbsp;<span class="op" id="1720427">&gt;</span>&nbsp;<span class="num" id="1720429">0</span>&nbsp;<span class="op" id="1720431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720438">siftdownTimer</span><span class="op" id="1720451">(</span><span class="num" id="1720452">0</span><span class="op" id="1720453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1720459">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720465">t</span><span class="op" id="1720466">.</span><span class="ident" id="1720467">i</span>&nbsp;<span class="op" id="1720469">=</span>&nbsp;<span class="op" id="1720471">-</span><span class="num" id="1720472">1</span>&nbsp;<span class="comment" id="1720474">//&nbsp;mark&nbsp;as&nbsp;removed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1720496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720501">f</span>&nbsp;<span class="op" id="1720503">:=</span>&nbsp;<span class="ident" id="1720506">t</span><span class="op" id="1720507">.</span><span class="ident" id="1720508">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720513">arg</span>&nbsp;<span class="op" id="1720517">:=</span>&nbsp;<span class="ident" id="1720520">t</span><span class="op" id="1720521">.</span><span class="ident" id="1720522">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720529">seq</span>&nbsp;<span class="op" id="1720533">:=</span>&nbsp;<span class="ident" id="1720536">t</span><span class="op" id="1720537">.</span><span class="ident" id="1720538">seq</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720545">unlock</span><span class="op" id="1720551">(</span><span class="op" id="1720552">&amp;</span><span class="ident" id="1720553">timers</span><span class="op" id="1720559">.</span><span class="ident" id="1720560">lock</span><span class="op" id="1720564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1720569">if</span>&nbsp;<span class="ident" id="1720572">raceenabled</span>&nbsp;<span class="op" id="1720584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720590">raceacquire</span><span class="op" id="1720601">(</span><span class="ident" id="1720602">unsafe</span><span class="op" id="1720608">.</span><span class="ident" id="1720609">Pointer</span><span class="op" id="1720616">(</span><span class="ident" id="1720617">t</span><span class="op" id="1720618">)</span><span class="op" id="1720619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1720624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720629">f</span><span class="op" id="1720630">(</span><span class="ident" id="1720631">arg</span><span class="op" id="1720634">,</span>&nbsp;<span class="ident" id="1720636">seq</span><span class="op" id="1720639">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720644">lock</span><span class="op" id="1720648">(</span><span class="op" id="1720649">&amp;</span><span class="ident" id="1720650">timers</span><span class="op" id="1720656">.</span><span class="ident" id="1720657">lock</span><span class="op" id="1720661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1720665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1720669">if</span>&nbsp;<span class="ident" id="1720672">delta</span>&nbsp;<span class="op" id="1720678">&lt;</span>&nbsp;<span class="num" id="1720680">0</span>&nbsp;<span class="op" id="1720682">||</span>&nbsp;<span class="ident" id="1720685">faketime</span>&nbsp;<span class="op" id="1720694">&gt;</span>&nbsp;<span class="num" id="1720696">0</span>&nbsp;<span class="op" id="1720698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1720703">//&nbsp;No&nbsp;timers&nbsp;left&nbsp;-&nbsp;put&nbsp;goroutine&nbsp;to&nbsp;sleep.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720750">timers</span><span class="op" id="1720756">.</span><span class="ident" id="1720757">rescheduling</span>&nbsp;<span class="op" id="1720770">=</span>&nbsp;<span class="builtintype" id="1720772">true</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720780">goparkunlock</span><span class="op" id="1720792">(</span><span class="op" id="1720793">&amp;</span><span class="ident" id="1720794">timers</span><span class="op" id="1720800">.</span><span class="ident" id="1720801">lock</span><span class="op" id="1720805">,</span>&nbsp;<span class="string" id="1720807">&#34;timer&nbsp;goroutine&nbsp;(idle)&#34;</span><span class="op" id="1720831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1720836">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1720847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1720851">//&nbsp;At&nbsp;least&nbsp;one&nbsp;timer&nbsp;pending.&nbsp;&nbsp;Sleep&nbsp;until&nbsp;then.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720903">timers</span><span class="op" id="1720909">.</span><span class="ident" id="1720910">sleeping</span>&nbsp;<span class="op" id="1720919">=</span>&nbsp;<span class="builtintype" id="1720921">true</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720928">noteclear</span><span class="op" id="1720937">(</span><span class="op" id="1720938">&amp;</span><span class="ident" id="1720939">timers</span><span class="op" id="1720945">.</span><span class="ident" id="1720946">waitnote</span><span class="op" id="1720954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720958">unlock</span><span class="op" id="1720964">(</span><span class="op" id="1720965">&amp;</span><span class="ident" id="1720966">timers</span><span class="op" id="1720972">.</span><span class="ident" id="1720973">lock</span><span class="op" id="1720977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1720981">notetsleepg</span><span class="op" id="1720992">(</span><span class="op" id="1720993">&amp;</span><span class="ident" id="1720994">timers</span><span class="op" id="1721000">.</span><span class="ident" id="1721001">waitnote</span><span class="op" id="1721009">,</span>&nbsp;<span class="ident" id="1721011">delta</span><span class="op" id="1721016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1721019">}</span><br>
<span class="lineno"></span><span class="op" id="1721021">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="1721024">func</span>&nbsp;<span class="ident" id="1721029">timejump</span><span class="op" id="1721037">(</span><span class="op" id="1721038">)</span>&nbsp;<span class="op" id="1721040">*</span><span class="ident" id="1721041">g</span>&nbsp;<span class="op" id="1721043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721046">if</span>&nbsp;<span class="ident" id="1721049">faketime</span>&nbsp;<span class="op" id="1721058">==</span>&nbsp;<span class="num" id="1721061">0</span>&nbsp;<span class="op" id="1721063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721067">return</span>&nbsp;<span class="builtintype" id="1721074">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1721079">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721083">lock</span><span class="op" id="1721087">(</span><span class="op" id="1721088">&amp;</span><span class="ident" id="1721089">timers</span><span class="op" id="1721095">.</span><span class="ident" id="1721096">lock</span><span class="op" id="1721100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721103">if</span>&nbsp;<span class="op" id="1721106">!</span><span class="ident" id="1721107">timers</span><span class="op" id="1721113">.</span><span class="ident" id="1721114">created</span>&nbsp;<span class="op" id="1721122">||</span>&nbsp;<span class="builtinfunc" id="1721125">len</span><span class="op" id="1721128">(</span><span class="ident" id="1721129">timers</span><span class="op" id="1721135">.</span><span class="ident" id="1721136">t</span><span class="op" id="1721137">)</span>&nbsp;<span class="op" id="1721139">==</span>&nbsp;<span class="num" id="1721142">0</span>&nbsp;<span class="op" id="1721144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721148">unlock</span><span class="op" id="1721154">(</span><span class="op" id="1721155">&amp;</span><span class="ident" id="1721156">timers</span><span class="op" id="1721162">.</span><span class="ident" id="1721163">lock</span><span class="op" id="1721167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721171">return</span>&nbsp;<span class="builtintype" id="1721178">nil</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1721183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721187">var</span>&nbsp;<span class="ident" id="1721191">gp</span>&nbsp;<span class="op" id="1721194">*</span><span class="ident" id="1721195">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721198">if</span>&nbsp;<span class="ident" id="1721201">faketime</span>&nbsp;<span class="op" id="1721210">&lt;</span>&nbsp;<span class="ident" id="1721212">timers</span><span class="op" id="1721218">.</span><span class="ident" id="1721219">t</span><span class="op" id="1721220">[</span><span class="num" id="1721221">0</span><span class="op" id="1721222">]</span><span class="op" id="1721223">.</span><span class="ident" id="1721224">when</span>&nbsp;<span class="op" id="1721229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721233">faketime</span>&nbsp;<span class="op" id="1721242">=</span>&nbsp;<span class="ident" id="1721244">timers</span><span class="op" id="1721250">.</span><span class="ident" id="1721251">t</span><span class="op" id="1721252">[</span><span class="num" id="1721253">0</span><span class="op" id="1721254">]</span><span class="op" id="1721255">.</span><span class="ident" id="1721256">when</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721263">if</span>&nbsp;<span class="ident" id="1721266">timers</span><span class="op" id="1721272">.</span><span class="ident" id="1721273">rescheduling</span>&nbsp;<span class="op" id="1721286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721291">timers</span><span class="op" id="1721297">.</span><span class="ident" id="1721298">rescheduling</span>&nbsp;<span class="op" id="1721311">=</span>&nbsp;<span class="builtintype" id="1721313">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721322">gp</span>&nbsp;<span class="op" id="1721325">=</span>&nbsp;<span class="ident" id="1721327">timers</span><span class="op" id="1721333">.</span><span class="ident" id="1721334">gp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1721339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1721342">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721345">unlock</span><span class="op" id="1721351">(</span><span class="op" id="1721352">&amp;</span><span class="ident" id="1721353">timers</span><span class="op" id="1721359">.</span><span class="ident" id="1721360">lock</span><span class="op" id="1721364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721367">return</span>&nbsp;<span class="ident" id="1721374">gp</span><br>
<span class="lineno"></span><span class="op" id="1721377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1721380">//&nbsp;Heap&nbsp;maintenance&nbsp;algorithms.</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="1721413">func</span>&nbsp;<span class="ident" id="1721418">siftupTimer</span><span class="op" id="1721429">(</span><span class="ident" id="1721430">i</span>&nbsp;<span class="builtintype" id="1721432">int</span><span class="op" id="1721435">)</span>&nbsp;<span class="op" id="1721437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721440">t</span>&nbsp;<span class="op" id="1721442">:=</span>&nbsp;<span class="ident" id="1721445">timers</span><span class="op" id="1721451">.</span><span class="ident" id="1721452">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721455">when</span>&nbsp;<span class="op" id="1721460">:=</span>&nbsp;<span class="ident" id="1721463">t</span><span class="op" id="1721464">[</span><span class="ident" id="1721465">i</span><span class="op" id="1721466">]</span><span class="op" id="1721467">.</span><span class="ident" id="1721468">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721474">tmp</span>&nbsp;<span class="op" id="1721478">:=</span>&nbsp;<span class="ident" id="1721481">t</span><span class="op" id="1721482">[</span><span class="ident" id="1721483">i</span><span class="op" id="1721484">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721487">for</span>&nbsp;<span class="ident" id="1721491">i</span>&nbsp;<span class="op" id="1721493">&gt;</span>&nbsp;<span class="num" id="1721495">0</span>&nbsp;<span class="op" id="1721497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721501">p</span>&nbsp;<span class="op" id="1721503">:=</span>&nbsp;<span class="op" id="1721506">(</span><span class="ident" id="1721507">i</span>&nbsp;<span class="op" id="1721509">-</span>&nbsp;<span class="num" id="1721511">1</span><span class="op" id="1721512">)</span>&nbsp;<span class="op" id="1721514">/</span>&nbsp;<span class="num" id="1721516">4</span>&nbsp;<span class="comment" id="1721518">//&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721530">if</span>&nbsp;<span class="ident" id="1721533">when</span>&nbsp;<span class="op" id="1721538">&gt;=</span>&nbsp;<span class="ident" id="1721541">t</span><span class="op" id="1721542">[</span><span class="ident" id="1721543">p</span><span class="op" id="1721544">]</span><span class="op" id="1721545">.</span><span class="ident" id="1721546">when</span>&nbsp;<span class="op" id="1721551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721556">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1721564">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721568">t</span><span class="op" id="1721569">[</span><span class="ident" id="1721570">i</span><span class="op" id="1721571">]</span>&nbsp;<span class="op" id="1721573">=</span>&nbsp;<span class="ident" id="1721575">t</span><span class="op" id="1721576">[</span><span class="ident" id="1721577">p</span><span class="op" id="1721578">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721582">t</span><span class="op" id="1721583">[</span><span class="ident" id="1721584">i</span><span class="op" id="1721585">]</span><span class="op" id="1721586">.</span><span class="ident" id="1721587">i</span>&nbsp;<span class="op" id="1721589">=</span>&nbsp;<span class="ident" id="1721591">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721595">t</span><span class="op" id="1721596">[</span><span class="ident" id="1721597">p</span><span class="op" id="1721598">]</span>&nbsp;<span class="op" id="1721600">=</span>&nbsp;<span class="ident" id="1721602">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721608">t</span><span class="op" id="1721609">[</span><span class="ident" id="1721610">p</span><span class="op" id="1721611">]</span><span class="op" id="1721612">.</span><span class="ident" id="1721613">i</span>&nbsp;<span class="op" id="1721615">=</span>&nbsp;<span class="ident" id="1721617">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721621">i</span>&nbsp;<span class="op" id="1721623">=</span>&nbsp;<span class="ident" id="1721625">p</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1721628">}</span><br>
<span class="lineno"></span><span class="op" id="1721630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1721633">func</span>&nbsp;<span class="ident" id="1721638">siftdownTimer</span><span class="op" id="1721651">(</span><span class="ident" id="1721652">i</span>&nbsp;<span class="builtintype" id="1721654">int</span><span class="op" id="1721657">)</span>&nbsp;<span class="op" id="1721659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721662">t</span>&nbsp;<span class="op" id="1721664">:=</span>&nbsp;<span class="ident" id="1721667">timers</span><span class="op" id="1721673">.</span><span class="ident" id="1721674">t</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721677">n</span>&nbsp;<span class="op" id="1721679">:=</span>&nbsp;<span class="builtinfunc" id="1721682">len</span><span class="op" id="1721685">(</span><span class="ident" id="1721686">t</span><span class="op" id="1721687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721690">when</span>&nbsp;<span class="op" id="1721695">:=</span>&nbsp;<span class="ident" id="1721698">t</span><span class="op" id="1721699">[</span><span class="ident" id="1721700">i</span><span class="op" id="1721701">]</span><span class="op" id="1721702">.</span><span class="ident" id="1721703">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721709">tmp</span>&nbsp;<span class="op" id="1721713">:=</span>&nbsp;<span class="ident" id="1721716">t</span><span class="op" id="1721717">[</span><span class="ident" id="1721718">i</span><span class="op" id="1721719">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721722">for</span>&nbsp;<span class="op" id="1721726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721730">c</span>&nbsp;<span class="op" id="1721732">:=</span>&nbsp;<span class="ident" id="1721735">i</span><span class="op" id="1721736">*</span><span class="num" id="1721737">4</span>&nbsp;<span class="op" id="1721739">+</span>&nbsp;<span class="num" id="1721741">1</span>&nbsp;<span class="comment" id="1721743">//&nbsp;left&nbsp;child</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721759">c3</span>&nbsp;<span class="op" id="1721762">:=</span>&nbsp;<span class="ident" id="1721765">c</span>&nbsp;<span class="op" id="1721767">+</span>&nbsp;<span class="num" id="1721769">2</span>&nbsp;&nbsp;<span class="comment" id="1721772">//&nbsp;mid&nbsp;child</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721787">if</span>&nbsp;<span class="ident" id="1721790">c</span>&nbsp;<span class="op" id="1721792">&gt;=</span>&nbsp;<span class="ident" id="1721795">n</span>&nbsp;<span class="op" id="1721797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721802">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1721810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721814">w</span>&nbsp;<span class="op" id="1721816">:=</span>&nbsp;<span class="ident" id="1721819">t</span><span class="op" id="1721820">[</span><span class="ident" id="1721821">c</span><span class="op" id="1721822">]</span><span class="op" id="1721823">.</span><span class="ident" id="1721824">when</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721831">if</span>&nbsp;<span class="ident" id="1721834">c</span><span class="op" id="1721835">+</span><span class="num" id="1721836">1</span>&nbsp;<span class="op" id="1721838">&lt;</span>&nbsp;<span class="ident" id="1721840">n</span>&nbsp;<span class="op" id="1721842">&amp;&amp;</span>&nbsp;<span class="ident" id="1721845">t</span><span class="op" id="1721846">[</span><span class="ident" id="1721847">c</span><span class="op" id="1721848">+</span><span class="num" id="1721849">1</span><span class="op" id="1721850">]</span><span class="op" id="1721851">.</span><span class="ident" id="1721852">when</span>&nbsp;<span class="op" id="1721857">&lt;</span>&nbsp;<span class="ident" id="1721859">w</span>&nbsp;<span class="op" id="1721861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721866">w</span>&nbsp;<span class="op" id="1721868">=</span>&nbsp;<span class="ident" id="1721870">t</span><span class="op" id="1721871">[</span><span class="ident" id="1721872">c</span><span class="op" id="1721873">+</span><span class="num" id="1721874">1</span><span class="op" id="1721875">]</span><span class="op" id="1721876">.</span><span class="ident" id="1721877">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721885">c</span><span class="op" id="1721886">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1721891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721895">if</span>&nbsp;<span class="ident" id="1721898">c3</span>&nbsp;<span class="op" id="1721901">&lt;</span>&nbsp;<span class="ident" id="1721903">n</span>&nbsp;<span class="op" id="1721905">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721910">w3</span>&nbsp;<span class="op" id="1721913">:=</span>&nbsp;<span class="ident" id="1721916">t</span><span class="op" id="1721917">[</span><span class="ident" id="1721918">c3</span><span class="op" id="1721920">]</span><span class="op" id="1721921">.</span><span class="ident" id="1721922">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1721930">if</span>&nbsp;<span class="ident" id="1721933">c3</span><span class="op" id="1721935">+</span><span class="num" id="1721936">1</span>&nbsp;<span class="op" id="1721938">&lt;</span>&nbsp;<span class="ident" id="1721940">n</span>&nbsp;<span class="op" id="1721942">&amp;&amp;</span>&nbsp;<span class="ident" id="1721945">t</span><span class="op" id="1721946">[</span><span class="ident" id="1721947">c3</span><span class="op" id="1721949">+</span><span class="num" id="1721950">1</span><span class="op" id="1721951">]</span><span class="op" id="1721952">.</span><span class="ident" id="1721953">when</span>&nbsp;<span class="op" id="1721958">&lt;</span>&nbsp;<span class="ident" id="1721960">w3</span>&nbsp;<span class="op" id="1721963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721969">w3</span>&nbsp;<span class="op" id="1721972">=</span>&nbsp;<span class="ident" id="1721974">t</span><span class="op" id="1721975">[</span><span class="ident" id="1721976">c3</span><span class="op" id="1721978">+</span><span class="num" id="1721979">1</span><span class="op" id="1721980">]</span><span class="op" id="1721981">.</span><span class="ident" id="1721982">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1721991">c3</span><span class="op" id="1721993">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1721999">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1722004">if</span>&nbsp;<span class="ident" id="1722007">w3</span>&nbsp;<span class="op" id="1722010">&lt;</span>&nbsp;<span class="ident" id="1722012">w</span>&nbsp;<span class="op" id="1722014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722020">w</span>&nbsp;<span class="op" id="1722022">=</span>&nbsp;<span class="ident" id="1722024">w3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722031">c</span>&nbsp;<span class="op" id="1722033">=</span>&nbsp;<span class="ident" id="1722035">c3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1722041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1722045">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1722049">if</span>&nbsp;<span class="ident" id="1722052">w</span>&nbsp;<span class="op" id="1722054">&gt;=</span>&nbsp;<span class="ident" id="1722057">when</span>&nbsp;<span class="op" id="1722062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1722067">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1722075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722079">t</span><span class="op" id="1722080">[</span><span class="ident" id="1722081">i</span><span class="op" id="1722082">]</span>&nbsp;<span class="op" id="1722084">=</span>&nbsp;<span class="ident" id="1722086">t</span><span class="op" id="1722087">[</span><span class="ident" id="1722088">c</span><span class="op" id="1722089">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722093">t</span><span class="op" id="1722094">[</span><span class="ident" id="1722095">i</span><span class="op" id="1722096">]</span><span class="op" id="1722097">.</span><span class="ident" id="1722098">i</span>&nbsp;<span class="op" id="1722100">=</span>&nbsp;<span class="ident" id="1722102">i</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722106">t</span><span class="op" id="1722107">[</span><span class="ident" id="1722108">c</span><span class="op" id="1722109">]</span>&nbsp;<span class="op" id="1722111">=</span>&nbsp;<span class="ident" id="1722113">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722119">t</span><span class="op" id="1722120">[</span><span class="ident" id="1722121">c</span><span class="op" id="1722122">]</span><span class="op" id="1722123">.</span><span class="ident" id="1722124">i</span>&nbsp;<span class="op" id="1722126">=</span>&nbsp;<span class="ident" id="1722128">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1722132">i</span>&nbsp;<span class="op" id="1722134">=</span>&nbsp;<span class="ident" id="1722136">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1722139">}</span><br>
<span class="lineno"></span><span class="op" id="1722141">}</span>
</div>
</body>
</html>
