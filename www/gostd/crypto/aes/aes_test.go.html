<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8268506">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8268561">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8268615">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8268666">package</span>&nbsp;<span class="ident" id="8268674">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8268679">import</span>&nbsp;<span class="op" id="8268686">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8268689">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8268699">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="8268702">//&nbsp;See&nbsp;const.go&nbsp;for&nbsp;overview&nbsp;of&nbsp;math&nbsp;here.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8268746">//&nbsp;Test&nbsp;that&nbsp;powx&nbsp;is&nbsp;initialized&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="comment" id="8268790">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;it&nbsp;too.)</span><br>
<span class="lineno">15</span><span class="keyword" id="8268835">func</span>&nbsp;<span class="ident" id="8268840">TestPowx</span><span class="op" id="8268848">(</span><span class="ident" id="8268849">t</span>&nbsp;<span class="op" id="8268851">*</span><span class="ident" id="8268852">testing</span><span class="op" id="8268859">.</span><span class="ident" id="8268860">T</span><span class="op" id="8268861">)</span>&nbsp;<span class="op" id="8268863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8268866">p</span>&nbsp;<span class="op" id="8268868">:=</span>&nbsp;<span class="num" id="8268871">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8268874">for</span>&nbsp;<span class="ident" id="8268878">i</span>&nbsp;<span class="op" id="8268880">:=</span>&nbsp;<span class="num" id="8268883">0</span><span class="op" id="8268884">;</span>&nbsp;<span class="ident" id="8268886">i</span>&nbsp;<span class="op" id="8268888">&lt;</span>&nbsp;<span class="builtinfunc" id="8268890">len</span><span class="op" id="8268893">(</span><span class="ident" id="8268894">powx</span><span class="op" id="8268898">)</span><span class="op" id="8268899">;</span>&nbsp;<span class="ident" id="8268901">i</span><span class="op" id="8268902">++</span>&nbsp;<span class="op" id="8268905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8268909">if</span>&nbsp;<span class="ident" id="8268912">powx</span><span class="op" id="8268916">[</span><span class="ident" id="8268917">i</span><span class="op" id="8268918">]</span>&nbsp;<span class="op" id="8268920">!=</span>&nbsp;<span class="builtintype" id="8268923">byte</span><span class="op" id="8268927">(</span><span class="ident" id="8268928">p</span><span class="op" id="8268929">)</span>&nbsp;<span class="op" id="8268931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8268936">t</span><span class="op" id="8268937">.</span><span class="ident" id="8268938">Errorf</span><span class="op" id="8268944">(</span><span class="string" id="8268945">&#34;powx[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8268971">,</span>&nbsp;<span class="ident" id="8268973">i</span><span class="op" id="8268974">,</span>&nbsp;<span class="ident" id="8268976">powx</span><span class="op" id="8268980">[</span><span class="ident" id="8268981">i</span><span class="op" id="8268982">]</span><span class="op" id="8268983">,</span>&nbsp;<span class="ident" id="8268985">p</span><span class="op" id="8268986">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8268990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8268994">p</span>&nbsp;<span class="op" id="8268996">&lt;&lt;=</span>&nbsp;<span class="num" id="8269000">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269004">if</span>&nbsp;<span class="ident" id="8269007">p</span><span class="op" id="8269008">&amp;</span><span class="num" id="8269009">0x100</span>&nbsp;<span class="op" id="8269015">!=</span>&nbsp;<span class="num" id="8269018">0</span>&nbsp;<span class="op" id="8269020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269025">p</span>&nbsp;<span class="op" id="8269027">^=</span>&nbsp;<span class="ident" id="8269030">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269037">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269040">}</span><br>
<span class="lineno"></span><span class="op" id="8269042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8269045">//&nbsp;Multiply&nbsp;b&nbsp;and&nbsp;c&nbsp;as&nbsp;GF(2)&nbsp;polynomials&nbsp;modulo&nbsp;poly</span><br>
<span class="lineno"></span><span class="keyword" id="8269098">func</span>&nbsp;<span class="ident" id="8269103">mul</span><span class="op" id="8269106">(</span><span class="ident" id="8269107">b</span><span class="op" id="8269108">,</span>&nbsp;<span class="ident" id="8269110">c</span>&nbsp;<span class="builtintype" id="8269112">uint32</span><span class="op" id="8269118">)</span>&nbsp;<span class="builtintype" id="8269120">uint32</span>&nbsp;<span class="op" id="8269127">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269130">i</span>&nbsp;<span class="op" id="8269132">:=</span>&nbsp;<span class="ident" id="8269135">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269138">j</span>&nbsp;<span class="op" id="8269140">:=</span>&nbsp;<span class="ident" id="8269143">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269146">s</span>&nbsp;<span class="op" id="8269148">:=</span>&nbsp;<span class="builtintype" id="8269151">uint32</span><span class="op" id="8269157">(</span><span class="num" id="8269158">0</span><span class="op" id="8269159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269162">for</span>&nbsp;<span class="ident" id="8269166">k</span>&nbsp;<span class="op" id="8269168">:=</span>&nbsp;<span class="builtintype" id="8269171">uint32</span><span class="op" id="8269177">(</span><span class="num" id="8269178">1</span><span class="op" id="8269179">)</span><span class="op" id="8269180">;</span>&nbsp;<span class="ident" id="8269182">k</span>&nbsp;<span class="op" id="8269184">&lt;</span>&nbsp;<span class="num" id="8269186">0x100</span>&nbsp;<span class="op" id="8269192">&amp;&amp;</span>&nbsp;<span class="ident" id="8269195">j</span>&nbsp;<span class="op" id="8269197">!=</span>&nbsp;<span class="num" id="8269200">0</span><span class="op" id="8269201">;</span>&nbsp;<span class="ident" id="8269203">k</span>&nbsp;<span class="op" id="8269205">&lt;&lt;=</span>&nbsp;<span class="num" id="8269209">1</span>&nbsp;<span class="op" id="8269211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8269215">//&nbsp;Invariant:&nbsp;k&nbsp;==&nbsp;1&lt;&lt;n,&nbsp;i&nbsp;==&nbsp;b&nbsp;*&nbsp;x‚Åø</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269257">if</span>&nbsp;<span class="ident" id="8269260">j</span><span class="op" id="8269261">&amp;</span><span class="ident" id="8269262">k</span>&nbsp;<span class="op" id="8269264">!=</span>&nbsp;<span class="num" id="8269267">0</span>&nbsp;<span class="op" id="8269269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8269274">//&nbsp;s&nbsp;+=&nbsp;i&nbsp;in&nbsp;GF(2);&nbsp;xor&nbsp;in&nbsp;binary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269311">s</span>&nbsp;<span class="op" id="8269313">^=</span>&nbsp;<span class="ident" id="8269316">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269321">j</span>&nbsp;<span class="op" id="8269323">^=</span>&nbsp;<span class="ident" id="8269326">k</span>&nbsp;<span class="comment" id="8269328">//&nbsp;turn&nbsp;off&nbsp;bit&nbsp;to&nbsp;end&nbsp;loop&nbsp;early</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8269369">//&nbsp;i&nbsp;*=&nbsp;x&nbsp;in&nbsp;GF(2)&nbsp;modulo&nbsp;the&nbsp;polynomial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269412">i</span>&nbsp;<span class="op" id="8269414">&lt;&lt;=</span>&nbsp;<span class="num" id="8269418">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269422">if</span>&nbsp;<span class="ident" id="8269425">i</span><span class="op" id="8269426">&amp;</span><span class="num" id="8269427">0x100</span>&nbsp;<span class="op" id="8269433">!=</span>&nbsp;<span class="num" id="8269436">0</span>&nbsp;<span class="op" id="8269438">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269443">i</span>&nbsp;<span class="op" id="8269445">^=</span>&nbsp;<span class="ident" id="8269448">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269461">return</span>&nbsp;<span class="ident" id="8269468">s</span><br>
<span class="lineno"></span><span class="op" id="8269470">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="8269473">//&nbsp;Test&nbsp;all&nbsp;mul&nbsp;inputs&nbsp;against&nbsp;bit-by-bit&nbsp;n¬≤&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="8269530">func</span>&nbsp;<span class="ident" id="8269535">TestMul</span><span class="op" id="8269542">(</span><span class="ident" id="8269543">t</span>&nbsp;<span class="op" id="8269545">*</span><span class="ident" id="8269546">testing</span><span class="op" id="8269553">.</span><span class="ident" id="8269554">T</span><span class="op" id="8269555">)</span>&nbsp;<span class="op" id="8269557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269560">for</span>&nbsp;<span class="ident" id="8269564">i</span>&nbsp;<span class="op" id="8269566">:=</span>&nbsp;<span class="builtintype" id="8269569">uint32</span><span class="op" id="8269575">(</span><span class="num" id="8269576">0</span><span class="op" id="8269577">)</span><span class="op" id="8269578">;</span>&nbsp;<span class="ident" id="8269580">i</span>&nbsp;<span class="op" id="8269582">&lt;</span>&nbsp;<span class="num" id="8269584">256</span><span class="op" id="8269587">;</span>&nbsp;<span class="ident" id="8269589">i</span><span class="op" id="8269590">++</span>&nbsp;<span class="op" id="8269593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269597">for</span>&nbsp;<span class="ident" id="8269601">j</span>&nbsp;<span class="op" id="8269603">:=</span>&nbsp;<span class="builtintype" id="8269606">uint32</span><span class="op" id="8269612">(</span><span class="num" id="8269613">0</span><span class="op" id="8269614">)</span><span class="op" id="8269615">;</span>&nbsp;<span class="ident" id="8269617">j</span>&nbsp;<span class="op" id="8269619">&lt;</span>&nbsp;<span class="num" id="8269621">256</span><span class="op" id="8269624">;</span>&nbsp;<span class="ident" id="8269626">j</span><span class="op" id="8269627">++</span>&nbsp;<span class="op" id="8269630">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8269635">//&nbsp;Multiply&nbsp;i,&nbsp;j&nbsp;bit&nbsp;by&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269667">s</span>&nbsp;<span class="op" id="8269669">:=</span>&nbsp;<span class="builtintype" id="8269672">uint8</span><span class="op" id="8269677">(</span><span class="num" id="8269678">0</span><span class="op" id="8269679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269684">for</span>&nbsp;<span class="ident" id="8269688">k</span>&nbsp;<span class="op" id="8269690">:=</span>&nbsp;<span class="builtintype" id="8269693">uint</span><span class="op" id="8269697">(</span><span class="num" id="8269698">0</span><span class="op" id="8269699">)</span><span class="op" id="8269700">;</span>&nbsp;<span class="ident" id="8269702">k</span>&nbsp;<span class="op" id="8269704">&lt;</span>&nbsp;<span class="num" id="8269706">8</span><span class="op" id="8269707">;</span>&nbsp;<span class="ident" id="8269709">k</span><span class="op" id="8269710">++</span>&nbsp;<span class="op" id="8269713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269719">for</span>&nbsp;<span class="ident" id="8269723">l</span>&nbsp;<span class="op" id="8269725">:=</span>&nbsp;<span class="builtintype" id="8269728">uint</span><span class="op" id="8269732">(</span><span class="num" id="8269733">0</span><span class="op" id="8269734">)</span><span class="op" id="8269735">;</span>&nbsp;<span class="ident" id="8269737">l</span>&nbsp;<span class="op" id="8269739">&lt;</span>&nbsp;<span class="num" id="8269741">8</span><span class="op" id="8269742">;</span>&nbsp;<span class="ident" id="8269744">l</span><span class="op" id="8269745">++</span>&nbsp;<span class="op" id="8269748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269755">if</span>&nbsp;<span class="ident" id="8269758">i</span><span class="op" id="8269759">&amp;</span><span class="op" id="8269760">(</span><span class="num" id="8269761">1</span><span class="op" id="8269762">&lt;&lt;</span><span class="ident" id="8269764">k</span><span class="op" id="8269765">)</span>&nbsp;<span class="op" id="8269767">!=</span>&nbsp;<span class="num" id="8269770">0</span>&nbsp;<span class="op" id="8269772">&amp;&amp;</span>&nbsp;<span class="ident" id="8269775">j</span><span class="op" id="8269776">&amp;</span><span class="op" id="8269777">(</span><span class="num" id="8269778">1</span><span class="op" id="8269779">&lt;&lt;</span><span class="ident" id="8269781">l</span><span class="op" id="8269782">)</span>&nbsp;<span class="op" id="8269784">!=</span>&nbsp;<span class="num" id="8269787">0</span>&nbsp;<span class="op" id="8269789">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269797">s</span>&nbsp;<span class="op" id="8269799">^=</span>&nbsp;<span class="ident" id="8269802">powx</span><span class="op" id="8269806">[</span><span class="ident" id="8269807">k</span><span class="op" id="8269808">+</span><span class="ident" id="8269809">l</span><span class="op" id="8269810">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8269833">if</span>&nbsp;<span class="ident" id="8269836">x</span>&nbsp;<span class="op" id="8269838">:=</span>&nbsp;<span class="ident" id="8269841">mul</span><span class="op" id="8269844">(</span><span class="ident" id="8269845">i</span><span class="op" id="8269846">,</span>&nbsp;<span class="ident" id="8269848">j</span><span class="op" id="8269849">)</span><span class="op" id="8269850">;</span>&nbsp;<span class="ident" id="8269852">x</span>&nbsp;<span class="op" id="8269854">!=</span>&nbsp;<span class="builtintype" id="8269857">uint32</span><span class="op" id="8269863">(</span><span class="ident" id="8269864">s</span><span class="op" id="8269865">)</span>&nbsp;<span class="op" id="8269867">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8269873">t</span><span class="op" id="8269874">.</span><span class="ident" id="8269875">Fatalf</span><span class="op" id="8269881">(</span><span class="string" id="8269882">&#34;mul(%#x,&nbsp;%#x)&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8269913">,</span>&nbsp;<span class="ident" id="8269915">i</span><span class="op" id="8269916">,</span>&nbsp;<span class="ident" id="8269918">j</span><span class="op" id="8269919">,</span>&nbsp;<span class="ident" id="8269921">x</span><span class="op" id="8269922">,</span>&nbsp;<span class="ident" id="8269924">s</span><span class="op" id="8269925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8269937">}</span><br>
<span class="lineno"></span><span class="op" id="8269939">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="8269942">//&nbsp;Check&nbsp;that&nbsp;S-boxes&nbsp;are&nbsp;inverses&nbsp;of&nbsp;each&nbsp;other.</span><br>
<span class="lineno"></span><span class="comment" id="8269992">//&nbsp;They&nbsp;have&nbsp;more&nbsp;structure&nbsp;that&nbsp;we&nbsp;could&nbsp;test,</span><br>
<span class="lineno"></span><span class="comment" id="8270040">//&nbsp;but&nbsp;if&nbsp;this&nbsp;sanity&nbsp;check&nbsp;passes,&nbsp;we&#39;ll&nbsp;assume</span><br>
<span class="lineno"></span><span class="comment" id="8270089">//&nbsp;the&nbsp;cut&nbsp;and&nbsp;paste&nbsp;from&nbsp;the&nbsp;FIPS&nbsp;PDF&nbsp;worked.</span><br>
<span class="lineno">75</span><span class="keyword" id="8270136">func</span>&nbsp;<span class="ident" id="8270141">TestSboxes</span><span class="op" id="8270151">(</span><span class="ident" id="8270152">t</span>&nbsp;<span class="op" id="8270154">*</span><span class="ident" id="8270155">testing</span><span class="op" id="8270162">.</span><span class="ident" id="8270163">T</span><span class="op" id="8270164">)</span>&nbsp;<span class="op" id="8270166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270169">for</span>&nbsp;<span class="ident" id="8270173">i</span>&nbsp;<span class="op" id="8270175">:=</span>&nbsp;<span class="num" id="8270178">0</span><span class="op" id="8270179">;</span>&nbsp;<span class="ident" id="8270181">i</span>&nbsp;<span class="op" id="8270183">&lt;</span>&nbsp;<span class="num" id="8270185">256</span><span class="op" id="8270188">;</span>&nbsp;<span class="ident" id="8270190">i</span><span class="op" id="8270191">++</span>&nbsp;<span class="op" id="8270194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270198">if</span>&nbsp;<span class="ident" id="8270201">j</span>&nbsp;<span class="op" id="8270203">:=</span>&nbsp;<span class="ident" id="8270206">sbox0</span><span class="op" id="8270211">[</span><span class="ident" id="8270212">sbox1</span><span class="op" id="8270217">[</span><span class="ident" id="8270218">i</span><span class="op" id="8270219">]</span><span class="op" id="8270220">]</span><span class="op" id="8270221">;</span>&nbsp;<span class="ident" id="8270223">j</span>&nbsp;<span class="op" id="8270225">!=</span>&nbsp;<span class="builtintype" id="8270228">byte</span><span class="op" id="8270232">(</span><span class="ident" id="8270233">i</span><span class="op" id="8270234">)</span>&nbsp;<span class="op" id="8270236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270241">t</span><span class="op" id="8270242">.</span><span class="ident" id="8270243">Errorf</span><span class="op" id="8270249">(</span><span class="string" id="8270250">&#34;sbox0[sbox1[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="8270275">,</span>&nbsp;<span class="ident" id="8270277">i</span><span class="op" id="8270278">,</span>&nbsp;<span class="ident" id="8270280">j</span><span class="op" id="8270281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270285">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270289">if</span>&nbsp;<span class="ident" id="8270292">j</span>&nbsp;<span class="op" id="8270294">:=</span>&nbsp;<span class="ident" id="8270297">sbox1</span><span class="op" id="8270302">[</span><span class="ident" id="8270303">sbox0</span><span class="op" id="8270308">[</span><span class="ident" id="8270309">i</span><span class="op" id="8270310">]</span><span class="op" id="8270311">]</span><span class="op" id="8270312">;</span>&nbsp;<span class="ident" id="8270314">j</span>&nbsp;<span class="op" id="8270316">!=</span>&nbsp;<span class="builtintype" id="8270319">byte</span><span class="op" id="8270323">(</span><span class="ident" id="8270324">i</span><span class="op" id="8270325">)</span>&nbsp;<span class="op" id="8270327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270332">t</span><span class="op" id="8270333">.</span><span class="ident" id="8270334">Errorf</span><span class="op" id="8270340">(</span><span class="string" id="8270341">&#34;sbox1[sbox0[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="8270366">,</span>&nbsp;<span class="ident" id="8270368">i</span><span class="op" id="8270369">,</span>&nbsp;<span class="ident" id="8270371">j</span><span class="op" id="8270372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270379">}</span><br>
<span class="lineno"></span><span class="op" id="8270381">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="8270384">//&nbsp;Test&nbsp;that&nbsp;encryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno"></span><span class="comment" id="8270428">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="8270475">func</span>&nbsp;<span class="ident" id="8270480">TestTe</span><span class="op" id="8270486">(</span><span class="ident" id="8270487">t</span>&nbsp;<span class="op" id="8270489">*</span><span class="ident" id="8270490">testing</span><span class="op" id="8270497">.</span><span class="ident" id="8270498">T</span><span class="op" id="8270499">)</span>&nbsp;<span class="op" id="8270501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270504">for</span>&nbsp;<span class="ident" id="8270508">i</span>&nbsp;<span class="op" id="8270510">:=</span>&nbsp;<span class="num" id="8270513">0</span><span class="op" id="8270514">;</span>&nbsp;<span class="ident" id="8270516">i</span>&nbsp;<span class="op" id="8270518">&lt;</span>&nbsp;<span class="num" id="8270520">256</span><span class="op" id="8270523">;</span>&nbsp;<span class="ident" id="8270525">i</span><span class="op" id="8270526">++</span>&nbsp;<span class="op" id="8270529">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270533">s</span>&nbsp;<span class="op" id="8270535">:=</span>&nbsp;<span class="builtintype" id="8270538">uint32</span><span class="op" id="8270544">(</span><span class="ident" id="8270545">sbox0</span><span class="op" id="8270550">[</span><span class="ident" id="8270551">i</span><span class="op" id="8270552">]</span><span class="op" id="8270553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270557">s2</span>&nbsp;<span class="op" id="8270560">:=</span>&nbsp;<span class="ident" id="8270563">mul</span><span class="op" id="8270566">(</span><span class="ident" id="8270567">s</span><span class="op" id="8270568">,</span>&nbsp;<span class="num" id="8270570">2</span><span class="op" id="8270571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270575">s3</span>&nbsp;<span class="op" id="8270578">:=</span>&nbsp;<span class="ident" id="8270581">mul</span><span class="op" id="8270584">(</span><span class="ident" id="8270585">s</span><span class="op" id="8270586">,</span>&nbsp;<span class="num" id="8270588">3</span><span class="op" id="8270589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270593">w</span>&nbsp;<span class="op" id="8270595">:=</span>&nbsp;<span class="ident" id="8270598">s2</span><span class="op" id="8270600">&lt;&lt;</span><span class="num" id="8270602">24</span>&nbsp;<span class="op" id="8270605">|</span>&nbsp;<span class="ident" id="8270607">s</span><span class="op" id="8270608">&lt;&lt;</span><span class="num" id="8270610">16</span>&nbsp;<span class="op" id="8270613">|</span>&nbsp;<span class="ident" id="8270615">s</span><span class="op" id="8270616">&lt;&lt;</span><span class="num" id="8270618">8</span>&nbsp;<span class="op" id="8270620">|</span>&nbsp;<span class="ident" id="8270622">s3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270627">te</span>&nbsp;<span class="op" id="8270630">:=</span>&nbsp;<span class="op" id="8270633">[</span><span class="op" id="8270634">]</span><span class="op" id="8270635">[</span><span class="num" id="8270636">256</span><span class="op" id="8270639">]</span><span class="builtintype" id="8270640">uint32</span><span class="op" id="8270646">{</span><span class="ident" id="8270647">te0</span><span class="op" id="8270650">,</span>&nbsp;<span class="ident" id="8270652">te1</span><span class="op" id="8270655">,</span>&nbsp;<span class="ident" id="8270657">te2</span><span class="op" id="8270660">,</span>&nbsp;<span class="ident" id="8270662">te3</span><span class="op" id="8270665">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270669">for</span>&nbsp;<span class="ident" id="8270673">j</span>&nbsp;<span class="op" id="8270675">:=</span>&nbsp;<span class="num" id="8270678">0</span><span class="op" id="8270679">;</span>&nbsp;<span class="ident" id="8270681">j</span>&nbsp;<span class="op" id="8270683">&lt;</span>&nbsp;<span class="num" id="8270685">4</span><span class="op" id="8270686">;</span>&nbsp;<span class="ident" id="8270688">j</span><span class="op" id="8270689">++</span>&nbsp;<span class="op" id="8270692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270697">if</span>&nbsp;<span class="ident" id="8270700">x</span>&nbsp;<span class="op" id="8270702">:=</span>&nbsp;<span class="ident" id="8270705">te</span><span class="op" id="8270707">[</span><span class="ident" id="8270708">j</span><span class="op" id="8270709">]</span><span class="op" id="8270710">[</span><span class="ident" id="8270711">i</span><span class="op" id="8270712">]</span><span class="op" id="8270713">;</span>&nbsp;<span class="ident" id="8270715">x</span>&nbsp;<span class="op" id="8270717">!=</span>&nbsp;<span class="ident" id="8270720">w</span>&nbsp;<span class="op" id="8270722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270728">t</span><span class="op" id="8270729">.</span><span class="ident" id="8270730">Fatalf</span><span class="op" id="8270736">(</span><span class="string" id="8270737">&#34;te[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8270765">,</span>&nbsp;<span class="ident" id="8270767">j</span><span class="op" id="8270768">,</span>&nbsp;<span class="ident" id="8270770">i</span><span class="op" id="8270771">,</span>&nbsp;<span class="ident" id="8270773">x</span><span class="op" id="8270774">,</span>&nbsp;<span class="ident" id="8270776">w</span><span class="op" id="8270777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270787">w</span>&nbsp;<span class="op" id="8270789">=</span>&nbsp;<span class="ident" id="8270791">w</span><span class="op" id="8270792">&lt;&lt;</span><span class="num" id="8270794">24</span>&nbsp;<span class="op" id="8270797">|</span>&nbsp;<span class="ident" id="8270799">w</span><span class="op" id="8270800">&gt;&gt;</span><span class="num" id="8270802">8</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8270809">}</span><br>
<span class="lineno"></span><span class="op" id="8270811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8270814">//&nbsp;Test&nbsp;that&nbsp;decryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno">105</span><span class="comment" id="8270858">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="8270905">func</span>&nbsp;<span class="ident" id="8270910">TestTd</span><span class="op" id="8270916">(</span><span class="ident" id="8270917">t</span>&nbsp;<span class="op" id="8270919">*</span><span class="ident" id="8270920">testing</span><span class="op" id="8270927">.</span><span class="ident" id="8270928">T</span><span class="op" id="8270929">)</span>&nbsp;<span class="op" id="8270931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8270934">for</span>&nbsp;<span class="ident" id="8270938">i</span>&nbsp;<span class="op" id="8270940">:=</span>&nbsp;<span class="num" id="8270943">0</span><span class="op" id="8270944">;</span>&nbsp;<span class="ident" id="8270946">i</span>&nbsp;<span class="op" id="8270948">&lt;</span>&nbsp;<span class="num" id="8270950">256</span><span class="op" id="8270953">;</span>&nbsp;<span class="ident" id="8270955">i</span><span class="op" id="8270956">++</span>&nbsp;<span class="op" id="8270959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270963">s</span>&nbsp;<span class="op" id="8270965">:=</span>&nbsp;<span class="builtintype" id="8270968">uint32</span><span class="op" id="8270974">(</span><span class="ident" id="8270975">sbox1</span><span class="op" id="8270980">[</span><span class="ident" id="8270981">i</span><span class="op" id="8270982">]</span><span class="op" id="8270983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8270987">s9</span>&nbsp;<span class="op" id="8270990">:=</span>&nbsp;<span class="ident" id="8270993">mul</span><span class="op" id="8270996">(</span><span class="ident" id="8270997">s</span><span class="op" id="8270998">,</span>&nbsp;<span class="num" id="8271000">0x9</span><span class="op" id="8271003">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271007">sb</span>&nbsp;<span class="op" id="8271010">:=</span>&nbsp;<span class="ident" id="8271013">mul</span><span class="op" id="8271016">(</span><span class="ident" id="8271017">s</span><span class="op" id="8271018">,</span>&nbsp;<span class="num" id="8271020">0xb</span><span class="op" id="8271023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271027">sd</span>&nbsp;<span class="op" id="8271030">:=</span>&nbsp;<span class="ident" id="8271033">mul</span><span class="op" id="8271036">(</span><span class="ident" id="8271037">s</span><span class="op" id="8271038">,</span>&nbsp;<span class="num" id="8271040">0xd</span><span class="op" id="8271043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271047">se</span>&nbsp;<span class="op" id="8271050">:=</span>&nbsp;<span class="ident" id="8271053">mul</span><span class="op" id="8271056">(</span><span class="ident" id="8271057">s</span><span class="op" id="8271058">,</span>&nbsp;<span class="num" id="8271060">0xe</span><span class="op" id="8271063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271067">w</span>&nbsp;<span class="op" id="8271069">:=</span>&nbsp;<span class="ident" id="8271072">se</span><span class="op" id="8271074">&lt;&lt;</span><span class="num" id="8271076">24</span>&nbsp;<span class="op" id="8271079">|</span>&nbsp;<span class="ident" id="8271081">s9</span><span class="op" id="8271083">&lt;&lt;</span><span class="num" id="8271085">16</span>&nbsp;<span class="op" id="8271088">|</span>&nbsp;<span class="ident" id="8271090">sd</span><span class="op" id="8271092">&lt;&lt;</span><span class="num" id="8271094">8</span>&nbsp;<span class="op" id="8271096">|</span>&nbsp;<span class="ident" id="8271098">sb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271103">td</span>&nbsp;<span class="op" id="8271106">:=</span>&nbsp;<span class="op" id="8271109">[</span><span class="op" id="8271110">]</span><span class="op" id="8271111">[</span><span class="num" id="8271112">256</span><span class="op" id="8271115">]</span><span class="builtintype" id="8271116">uint32</span><span class="op" id="8271122">{</span><span class="ident" id="8271123">td0</span><span class="op" id="8271126">,</span>&nbsp;<span class="ident" id="8271128">td1</span><span class="op" id="8271131">,</span>&nbsp;<span class="ident" id="8271133">td2</span><span class="op" id="8271136">,</span>&nbsp;<span class="ident" id="8271138">td3</span><span class="op" id="8271141">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8271145">for</span>&nbsp;<span class="ident" id="8271149">j</span>&nbsp;<span class="op" id="8271151">:=</span>&nbsp;<span class="num" id="8271154">0</span><span class="op" id="8271155">;</span>&nbsp;<span class="ident" id="8271157">j</span>&nbsp;<span class="op" id="8271159">&lt;</span>&nbsp;<span class="num" id="8271161">4</span><span class="op" id="8271162">;</span>&nbsp;<span class="ident" id="8271164">j</span><span class="op" id="8271165">++</span>&nbsp;<span class="op" id="8271168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8271173">if</span>&nbsp;<span class="ident" id="8271176">x</span>&nbsp;<span class="op" id="8271178">:=</span>&nbsp;<span class="ident" id="8271181">td</span><span class="op" id="8271183">[</span><span class="ident" id="8271184">j</span><span class="op" id="8271185">]</span><span class="op" id="8271186">[</span><span class="ident" id="8271187">i</span><span class="op" id="8271188">]</span><span class="op" id="8271189">;</span>&nbsp;<span class="ident" id="8271191">x</span>&nbsp;<span class="op" id="8271193">!=</span>&nbsp;<span class="ident" id="8271196">w</span>&nbsp;<span class="op" id="8271198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271204">t</span><span class="op" id="8271205">.</span><span class="ident" id="8271206">Fatalf</span><span class="op" id="8271212">(</span><span class="string" id="8271213">&#34;td[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8271241">,</span>&nbsp;<span class="ident" id="8271243">j</span><span class="op" id="8271244">,</span>&nbsp;<span class="ident" id="8271246">i</span><span class="op" id="8271247">,</span>&nbsp;<span class="ident" id="8271249">x</span><span class="op" id="8271250">,</span>&nbsp;<span class="ident" id="8271252">w</span><span class="op" id="8271253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271263">w</span>&nbsp;<span class="op" id="8271265">=</span>&nbsp;<span class="ident" id="8271267">w</span><span class="op" id="8271268">&lt;&lt;</span><span class="num" id="8271270">24</span>&nbsp;<span class="op" id="8271273">|</span>&nbsp;<span class="ident" id="8271275">w</span><span class="op" id="8271276">&gt;&gt;</span><span class="num" id="8271278">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271285">}</span><br>
<span class="lineno"></span><span class="op" id="8271287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8271290">//&nbsp;Test&nbsp;vectors&nbsp;are&nbsp;from&nbsp;FIPS&nbsp;197:</span><br>
<span class="lineno">125</span><span class="comment" id="8271325">//&nbsp;&nbsp;&nbsp;&nbsphttp://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8271393">//&nbsp;Appendix&nbsp;A&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Key&nbsp;expansion&nbsp;examples</span><br>
<span class="lineno"></span><span class="keyword" id="8271443">type</span>&nbsp;<span class="ident" id="8271448">KeyTest</span>&nbsp;<span class="keyword" id="8271456">struct</span>&nbsp;<span class="op" id="8271463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271466">key</span>&nbsp;<span class="op" id="8271470">[</span><span class="op" id="8271471">]</span><span class="builtintype" id="8271472">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271478">enc</span>&nbsp;<span class="op" id="8271482">[</span><span class="op" id="8271483">]</span><span class="builtintype" id="8271484">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8271492">dec</span>&nbsp;<span class="op" id="8271496">[</span><span class="op" id="8271497">]</span><span class="builtintype" id="8271498">uint32</span>&nbsp;<span class="comment" id="8271505">//&nbsp;decryption&nbsp;expansion;&nbsp;not&nbsp;in&nbsp;FIPS&nbsp;197,&nbsp;computed&nbsp;from&nbsp;C&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="op" id="8271579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8271582">var</span>&nbsp;<span class="ident" id="8271586">keyTests</span>&nbsp;<span class="op" id="8271595">=</span>&nbsp;<span class="op" id="8271597">[</span><span class="op" id="8271598">]</span><span class="ident" id="8271599">KeyTest</span><span class="op" id="8271606">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8271613">//&nbsp;A.1.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;128-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271658">[</span><span class="op" id="8271659">]</span><span class="builtintype" id="8271660">byte</span><span class="op" id="8271664">{</span><span class="num" id="8271665">0x2b</span><span class="op" id="8271669">,</span>&nbsp;<span class="num" id="8271671">0x7e</span><span class="op" id="8271675">,</span>&nbsp;<span class="num" id="8271677">0x15</span><span class="op" id="8271681">,</span>&nbsp;<span class="num" id="8271683">0x16</span><span class="op" id="8271687">,</span>&nbsp;<span class="num" id="8271689">0x28</span><span class="op" id="8271693">,</span>&nbsp;<span class="num" id="8271695">0xae</span><span class="op" id="8271699">,</span>&nbsp;<span class="num" id="8271701">0xd2</span><span class="op" id="8271705">,</span>&nbsp;<span class="num" id="8271707">0xa6</span><span class="op" id="8271711">,</span>&nbsp;<span class="num" id="8271713">0xab</span><span class="op" id="8271717">,</span>&nbsp;<span class="num" id="8271719">0xf7</span><span class="op" id="8271723">,</span>&nbsp;<span class="num" id="8271725">0x15</span><span class="op" id="8271729">,</span>&nbsp;<span class="num" id="8271731">0x88</span><span class="op" id="8271735">,</span>&nbsp;<span class="num" id="8271737">0x09</span><span class="op" id="8271741">,</span>&nbsp;<span class="num" id="8271743">0xcf</span><span class="op" id="8271747">,</span>&nbsp;<span class="num" id="8271749">0x4f</span><span class="op" id="8271753">,</span>&nbsp;<span class="num" id="8271755">0x3c</span><span class="op" id="8271759">}</span><span class="op" id="8271760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8271764">[</span><span class="op" id="8271765">]</span><span class="builtintype" id="8271766">uint32</span><span class="op" id="8271772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271777">0x2b7e1516</span><span class="op" id="8271787">,</span>&nbsp;<span class="num" id="8271789">0x28aed2a6</span><span class="op" id="8271799">,</span>&nbsp;<span class="num" id="8271801">0xabf71588</span><span class="op" id="8271811">,</span>&nbsp;<span class="num" id="8271813">0x09cf4f3c</span><span class="op" id="8271823">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271828">0xa0fafe17</span><span class="op" id="8271838">,</span>&nbsp;<span class="num" id="8271840">0x88542cb1</span><span class="op" id="8271850">,</span>&nbsp;<span class="num" id="8271852">0x23a33939</span><span class="op" id="8271862">,</span>&nbsp;<span class="num" id="8271864">0x2a6c7605</span><span class="op" id="8271874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271879">0xf2c295f2</span><span class="op" id="8271889">,</span>&nbsp;<span class="num" id="8271891">0x7a96b943</span><span class="op" id="8271901">,</span>&nbsp;<span class="num" id="8271903">0x5935807a</span><span class="op" id="8271913">,</span>&nbsp;<span class="num" id="8271915">0x7359f67f</span><span class="op" id="8271925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271930">0x3d80477d</span><span class="op" id="8271940">,</span>&nbsp;<span class="num" id="8271942">0x4716fe3e</span><span class="op" id="8271952">,</span>&nbsp;<span class="num" id="8271954">0x1e237e44</span><span class="op" id="8271964">,</span>&nbsp;<span class="num" id="8271966">0x6d7a883b</span><span class="op" id="8271976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8271981">0xef44a541</span><span class="op" id="8271991">,</span>&nbsp;<span class="num" id="8271993">0xa8525b7f</span><span class="op" id="8272003">,</span>&nbsp;<span class="num" id="8272005">0xb671253b</span><span class="op" id="8272015">,</span>&nbsp;<span class="num" id="8272017">0xdb0bad00</span><span class="op" id="8272027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272032">0xd4d1c6f8</span><span class="op" id="8272042">,</span>&nbsp;<span class="num" id="8272044">0x7c839d87</span><span class="op" id="8272054">,</span>&nbsp;<span class="num" id="8272056">0xcaf2b8bc</span><span class="op" id="8272066">,</span>&nbsp;<span class="num" id="8272068">0x11f915bc</span><span class="op" id="8272078">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272083">0x6d88a37a</span><span class="op" id="8272093">,</span>&nbsp;<span class="num" id="8272095">0x110b3efd</span><span class="op" id="8272105">,</span>&nbsp;<span class="num" id="8272107">0xdbf98641</span><span class="op" id="8272117">,</span>&nbsp;<span class="num" id="8272119">0xca0093fd</span><span class="op" id="8272129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272134">0x4e54f70e</span><span class="op" id="8272144">,</span>&nbsp;<span class="num" id="8272146">0x5f5fc9f3</span><span class="op" id="8272156">,</span>&nbsp;<span class="num" id="8272158">0x84a64fb2</span><span class="op" id="8272168">,</span>&nbsp;<span class="num" id="8272170">0x4ea6dc4f</span><span class="op" id="8272180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272185">0xead27321</span><span class="op" id="8272195">,</span>&nbsp;<span class="num" id="8272197">0xb58dbad2</span><span class="op" id="8272207">,</span>&nbsp;<span class="num" id="8272209">0x312bf560</span><span class="op" id="8272219">,</span>&nbsp;<span class="num" id="8272221">0x7f8d292f</span><span class="op" id="8272231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272236">0xac7766f3</span><span class="op" id="8272246">,</span>&nbsp;<span class="num" id="8272248">0x19fadc21</span><span class="op" id="8272258">,</span>&nbsp;<span class="num" id="8272260">0x28d12941</span><span class="op" id="8272270">,</span>&nbsp;<span class="num" id="8272272">0x575c006e</span><span class="op" id="8272282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272287">0xd014f9a8</span><span class="op" id="8272297">,</span>&nbsp;<span class="num" id="8272299">0xc9ee2589</span><span class="op" id="8272309">,</span>&nbsp;<span class="num" id="8272311">0xe13f0cc8</span><span class="op" id="8272321">,</span>&nbsp;<span class="num" id="8272323">0xb6630ca6</span><span class="op" id="8272333">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272337">}</span><span class="op" id="8272338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272342">[</span><span class="op" id="8272343">]</span><span class="builtintype" id="8272344">uint32</span><span class="op" id="8272350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272355">0xd014f9a8</span><span class="op" id="8272365">,</span>&nbsp;<span class="num" id="8272367">0xc9ee2589</span><span class="op" id="8272377">,</span>&nbsp;<span class="num" id="8272379">0xe13f0cc8</span><span class="op" id="8272389">,</span>&nbsp;<span class="num" id="8272391">0xb6630ca6</span><span class="op" id="8272401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272406">0xc7b5a63</span><span class="op" id="8272415">,</span>&nbsp;<span class="num" id="8272417">0x1319eafe</span><span class="op" id="8272427">,</span>&nbsp;<span class="num" id="8272429">0xb0398890</span><span class="op" id="8272439">,</span>&nbsp;<span class="num" id="8272441">0x664cfbb4</span><span class="op" id="8272451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272456">0xdf7d925a</span><span class="op" id="8272466">,</span>&nbsp;<span class="num" id="8272468">0x1f62b09d</span><span class="op" id="8272478">,</span>&nbsp;<span class="num" id="8272480">0xa320626e</span><span class="op" id="8272490">,</span>&nbsp;<span class="num" id="8272492">0xd6757324</span><span class="op" id="8272502">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272507">0x12c07647</span><span class="op" id="8272517">,</span>&nbsp;<span class="num" id="8272519">0xc01f22c7</span><span class="op" id="8272529">,</span>&nbsp;<span class="num" id="8272531">0xbc42d2f3</span><span class="op" id="8272541">,</span>&nbsp;<span class="num" id="8272543">0x7555114a</span><span class="op" id="8272553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272558">0x6efcd876</span><span class="op" id="8272568">,</span>&nbsp;<span class="num" id="8272570">0xd2df5480</span><span class="op" id="8272580">,</span>&nbsp;<span class="num" id="8272582">0x7c5df034</span><span class="op" id="8272592">,</span>&nbsp;<span class="num" id="8272594">0xc917c3b9</span><span class="op" id="8272604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272609">0x6ea30afc</span><span class="op" id="8272619">,</span>&nbsp;<span class="num" id="8272621">0xbc238cf6</span><span class="op" id="8272631">,</span>&nbsp;<span class="num" id="8272633">0xae82a4b4</span><span class="op" id="8272643">,</span>&nbsp;<span class="num" id="8272645">0xb54a338d</span><span class="op" id="8272655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272660">0x90884413</span><span class="op" id="8272670">,</span>&nbsp;<span class="num" id="8272672">0xd280860a</span><span class="op" id="8272682">,</span>&nbsp;<span class="num" id="8272684">0x12a12842</span><span class="op" id="8272694">,</span>&nbsp;<span class="num" id="8272696">0x1bc89739</span><span class="op" id="8272706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272711">0x7c1f13f7</span><span class="op" id="8272721">,</span>&nbsp;<span class="num" id="8272723">0x4208c219</span><span class="op" id="8272733">,</span>&nbsp;<span class="num" id="8272735">0xc021ae48</span><span class="op" id="8272745">,</span>&nbsp;<span class="num" id="8272747">0x969bf7b</span><span class="op" id="8272756">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272761">0xcc7505eb</span><span class="op" id="8272771">,</span>&nbsp;<span class="num" id="8272773">0x3e17d1ee</span><span class="op" id="8272783">,</span>&nbsp;<span class="num" id="8272785">0x82296c51</span><span class="op" id="8272795">,</span>&nbsp;<span class="num" id="8272797">0xc9481133</span><span class="op" id="8272807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272812">0x2b3708a7</span><span class="op" id="8272822">,</span>&nbsp;<span class="num" id="8272824">0xf262d405</span><span class="op" id="8272834">,</span>&nbsp;<span class="num" id="8272836">0xbc3ebdbf</span><span class="op" id="8272846">,</span>&nbsp;<span class="num" id="8272848">0x4b617d62</span><span class="op" id="8272858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272863">0x2b7e1516</span><span class="op" id="8272873">,</span>&nbsp;<span class="num" id="8272875">0x28aed2a6</span><span class="op" id="8272885">,</span>&nbsp;<span class="num" id="8272887">0xabf71588</span><span class="op" id="8272897">,</span>&nbsp;<span class="num" id="8272899">0x9cf4f3c</span><span class="op" id="8272908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272912">}</span><span class="op" id="8272913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272916">}</span><span class="op" id="8272917">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8272924">//&nbsp;A.2.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;192-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8272969">[</span><span class="op" id="8272970">]</span><span class="builtintype" id="8272971">byte</span><span class="op" id="8272975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8272980">0x8e</span><span class="op" id="8272984">,</span>&nbsp;<span class="num" id="8272986">0x73</span><span class="op" id="8272990">,</span>&nbsp;<span class="num" id="8272992">0xb0</span><span class="op" id="8272996">,</span>&nbsp;<span class="num" id="8272998">0xf7</span><span class="op" id="8273002">,</span>&nbsp;<span class="num" id="8273004">0xda</span><span class="op" id="8273008">,</span>&nbsp;<span class="num" id="8273010">0x0e</span><span class="op" id="8273014">,</span>&nbsp;<span class="num" id="8273016">0x64</span><span class="op" id="8273020">,</span>&nbsp;<span class="num" id="8273022">0x52</span><span class="op" id="8273026">,</span>&nbsp;<span class="num" id="8273028">0xc8</span><span class="op" id="8273032">,</span>&nbsp;<span class="num" id="8273034">0x10</span><span class="op" id="8273038">,</span>&nbsp;<span class="num" id="8273040">0xf3</span><span class="op" id="8273044">,</span>&nbsp;<span class="num" id="8273046">0x2b</span><span class="op" id="8273050">,</span>&nbsp;<span class="num" id="8273052">0x80</span><span class="op" id="8273056">,</span>&nbsp;<span class="num" id="8273058">0x90</span><span class="op" id="8273062">,</span>&nbsp;<span class="num" id="8273064">0x79</span><span class="op" id="8273068">,</span>&nbsp;<span class="num" id="8273070">0xe5</span><span class="op" id="8273074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273079">0x62</span><span class="op" id="8273083">,</span>&nbsp;<span class="num" id="8273085">0xf8</span><span class="op" id="8273089">,</span>&nbsp;<span class="num" id="8273091">0xea</span><span class="op" id="8273095">,</span>&nbsp;<span class="num" id="8273097">0xd2</span><span class="op" id="8273101">,</span>&nbsp;<span class="num" id="8273103">0x52</span><span class="op" id="8273107">,</span>&nbsp;<span class="num" id="8273109">0x2c</span><span class="op" id="8273113">,</span>&nbsp;<span class="num" id="8273115">0x6b</span><span class="op" id="8273119">,</span>&nbsp;<span class="num" id="8273121">0x7b</span><span class="op" id="8273125">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273129">}</span><span class="op" id="8273130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273134">[</span><span class="op" id="8273135">]</span><span class="builtintype" id="8273136">uint32</span><span class="op" id="8273142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273147">0x8e73b0f7</span><span class="op" id="8273157">,</span>&nbsp;<span class="num" id="8273159">0xda0e6452</span><span class="op" id="8273169">,</span>&nbsp;<span class="num" id="8273171">0xc810f32b</span><span class="op" id="8273181">,</span>&nbsp;<span class="num" id="8273183">0x809079e5</span><span class="op" id="8273193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273198">0x62f8ead2</span><span class="op" id="8273208">,</span>&nbsp;<span class="num" id="8273210">0x522c6b7b</span><span class="op" id="8273220">,</span>&nbsp;<span class="num" id="8273222">0xfe0c91f7</span><span class="op" id="8273232">,</span>&nbsp;<span class="num" id="8273234">0x2402f5a5</span><span class="op" id="8273244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273249">0xec12068e</span><span class="op" id="8273259">,</span>&nbsp;<span class="num" id="8273261">0x6c827f6b</span><span class="op" id="8273271">,</span>&nbsp;<span class="num" id="8273273">0x0e7a95b9</span><span class="op" id="8273283">,</span>&nbsp;<span class="num" id="8273285">0x5c56fec2</span><span class="op" id="8273295">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273300">0x4db7b4bd</span><span class="op" id="8273310">,</span>&nbsp;<span class="num" id="8273312">0x69b54118</span><span class="op" id="8273322">,</span>&nbsp;<span class="num" id="8273324">0x85a74796</span><span class="op" id="8273334">,</span>&nbsp;<span class="num" id="8273336">0xe92538fd</span><span class="op" id="8273346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273351">0xe75fad44</span><span class="op" id="8273361">,</span>&nbsp;<span class="num" id="8273363">0xbb095386</span><span class="op" id="8273373">,</span>&nbsp;<span class="num" id="8273375">0x485af057</span><span class="op" id="8273385">,</span>&nbsp;<span class="num" id="8273387">0x21efb14f</span><span class="op" id="8273397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273402">0xa448f6d9</span><span class="op" id="8273412">,</span>&nbsp;<span class="num" id="8273414">0x4d6dce24</span><span class="op" id="8273424">,</span>&nbsp;<span class="num" id="8273426">0xaa326360</span><span class="op" id="8273436">,</span>&nbsp;<span class="num" id="8273438">0x113b30e6</span><span class="op" id="8273448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273453">0xa25e7ed5</span><span class="op" id="8273463">,</span>&nbsp;<span class="num" id="8273465">0x83b1cf9a</span><span class="op" id="8273475">,</span>&nbsp;<span class="num" id="8273477">0x27f93943</span><span class="op" id="8273487">,</span>&nbsp;<span class="num" id="8273489">0x6a94f767</span><span class="op" id="8273499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273504">0xc0a69407</span><span class="op" id="8273514">,</span>&nbsp;<span class="num" id="8273516">0xd19da4e1</span><span class="op" id="8273526">,</span>&nbsp;<span class="num" id="8273528">0xec1786eb</span><span class="op" id="8273538">,</span>&nbsp;<span class="num" id="8273540">0x6fa64971</span><span class="op" id="8273550">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273555">0x485f7032</span><span class="op" id="8273565">,</span>&nbsp;<span class="num" id="8273567">0x22cb8755</span><span class="op" id="8273577">,</span>&nbsp;<span class="num" id="8273579">0xe26d1352</span><span class="op" id="8273589">,</span>&nbsp;<span class="num" id="8273591">0x33f0b7b3</span><span class="op" id="8273601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273606">0x40beeb28</span><span class="op" id="8273616">,</span>&nbsp;<span class="num" id="8273618">0x2f18a259</span><span class="op" id="8273628">,</span>&nbsp;<span class="num" id="8273630">0x6747d26b</span><span class="op" id="8273640">,</span>&nbsp;<span class="num" id="8273642">0x458c553e</span><span class="op" id="8273652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273657">0xa7e1466c</span><span class="op" id="8273667">,</span>&nbsp;<span class="num" id="8273669">0x9411f1df</span><span class="op" id="8273679">,</span>&nbsp;<span class="num" id="8273681">0x821f750a</span><span class="op" id="8273691">,</span>&nbsp;<span class="num" id="8273693">0xad07d753</span><span class="op" id="8273703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273708">0xca400538</span><span class="op" id="8273718">,</span>&nbsp;<span class="num" id="8273720">0x8fcc5006</span><span class="op" id="8273730">,</span>&nbsp;<span class="num" id="8273732">0x282d166a</span><span class="op" id="8273742">,</span>&nbsp;<span class="num" id="8273744">0xbc3ce7b5</span><span class="op" id="8273754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273759">0xe98ba06f</span><span class="op" id="8273769">,</span>&nbsp;<span class="num" id="8273771">0x448c773c</span><span class="op" id="8273781">,</span>&nbsp;<span class="num" id="8273783">0x8ecc7204</span><span class="op" id="8273793">,</span>&nbsp;<span class="num" id="8273795">0x01002202</span><span class="op" id="8273805">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273809">}</span><span class="op" id="8273810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8273814">nil</span><span class="op" id="8273817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273820">}</span><span class="op" id="8273821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8273828">//&nbsp;A.3.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;256-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8273873">[</span><span class="op" id="8273874">]</span><span class="builtintype" id="8273875">byte</span><span class="op" id="8273879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273884">0x60</span><span class="op" id="8273888">,</span>&nbsp;<span class="num" id="8273890">0x3d</span><span class="op" id="8273894">,</span>&nbsp;<span class="num" id="8273896">0xeb</span><span class="op" id="8273900">,</span>&nbsp;<span class="num" id="8273902">0x10</span><span class="op" id="8273906">,</span>&nbsp;<span class="num" id="8273908">0x15</span><span class="op" id="8273912">,</span>&nbsp;<span class="num" id="8273914">0xca</span><span class="op" id="8273918">,</span>&nbsp;<span class="num" id="8273920">0x71</span><span class="op" id="8273924">,</span>&nbsp;<span class="num" id="8273926">0xbe</span><span class="op" id="8273930">,</span>&nbsp;<span class="num" id="8273932">0x2b</span><span class="op" id="8273936">,</span>&nbsp;<span class="num" id="8273938">0x73</span><span class="op" id="8273942">,</span>&nbsp;<span class="num" id="8273944">0xae</span><span class="op" id="8273948">,</span>&nbsp;<span class="num" id="8273950">0xf0</span><span class="op" id="8273954">,</span>&nbsp;<span class="num" id="8273956">0x85</span><span class="op" id="8273960">,</span>&nbsp;<span class="num" id="8273962">0x7d</span><span class="op" id="8273966">,</span>&nbsp;<span class="num" id="8273968">0x77</span><span class="op" id="8273972">,</span>&nbsp;<span class="num" id="8273974">0x81</span><span class="op" id="8273978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8273983">0x1f</span><span class="op" id="8273987">,</span>&nbsp;<span class="num" id="8273989">0x35</span><span class="op" id="8273993">,</span>&nbsp;<span class="num" id="8273995">0x2c</span><span class="op" id="8273999">,</span>&nbsp;<span class="num" id="8274001">0x07</span><span class="op" id="8274005">,</span>&nbsp;<span class="num" id="8274007">0x3b</span><span class="op" id="8274011">,</span>&nbsp;<span class="num" id="8274013">0x61</span><span class="op" id="8274017">,</span>&nbsp;<span class="num" id="8274019">0x08</span><span class="op" id="8274023">,</span>&nbsp;<span class="num" id="8274025">0xd7</span><span class="op" id="8274029">,</span>&nbsp;<span class="num" id="8274031">0x2d</span><span class="op" id="8274035">,</span>&nbsp;<span class="num" id="8274037">0x98</span><span class="op" id="8274041">,</span>&nbsp;<span class="num" id="8274043">0x10</span><span class="op" id="8274047">,</span>&nbsp;<span class="num" id="8274049">0xa3</span><span class="op" id="8274053">,</span>&nbsp;<span class="num" id="8274055">0x09</span><span class="op" id="8274059">,</span>&nbsp;<span class="num" id="8274061">0x14</span><span class="op" id="8274065">,</span>&nbsp;<span class="num" id="8274067">0xdf</span><span class="op" id="8274071">,</span>&nbsp;<span class="num" id="8274073">0xf4</span><span class="op" id="8274077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8274081">}</span><span class="op" id="8274082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8274086">[</span><span class="op" id="8274087">]</span><span class="builtintype" id="8274088">uint32</span><span class="op" id="8274094">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274099">0x603deb10</span><span class="op" id="8274109">,</span>&nbsp;<span class="num" id="8274111">0x15ca71be</span><span class="op" id="8274121">,</span>&nbsp;<span class="num" id="8274123">0x2b73aef0</span><span class="op" id="8274133">,</span>&nbsp;<span class="num" id="8274135">0x857d7781</span><span class="op" id="8274145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274150">0x1f352c07</span><span class="op" id="8274160">,</span>&nbsp;<span class="num" id="8274162">0x3b6108d7</span><span class="op" id="8274172">,</span>&nbsp;<span class="num" id="8274174">0x2d9810a3</span><span class="op" id="8274184">,</span>&nbsp;<span class="num" id="8274186">0x0914dff4</span><span class="op" id="8274196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274201">0x9ba35411</span><span class="op" id="8274211">,</span>&nbsp;<span class="num" id="8274213">0x8e6925af</span><span class="op" id="8274223">,</span>&nbsp;<span class="num" id="8274225">0xa51a8b5f</span><span class="op" id="8274235">,</span>&nbsp;<span class="num" id="8274237">0x2067fcde</span><span class="op" id="8274247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274252">0xa8b09c1a</span><span class="op" id="8274262">,</span>&nbsp;<span class="num" id="8274264">0x93d194cd</span><span class="op" id="8274274">,</span>&nbsp;<span class="num" id="8274276">0xbe49846e</span><span class="op" id="8274286">,</span>&nbsp;<span class="num" id="8274288">0xb75d5b9a</span><span class="op" id="8274298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274303">0xd59aecb8</span><span class="op" id="8274313">,</span>&nbsp;<span class="num" id="8274315">0x5bf3c917</span><span class="op" id="8274325">,</span>&nbsp;<span class="num" id="8274327">0xfee94248</span><span class="op" id="8274337">,</span>&nbsp;<span class="num" id="8274339">0xde8ebe96</span><span class="op" id="8274349">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274354">0xb5a9328a</span><span class="op" id="8274364">,</span>&nbsp;<span class="num" id="8274366">0x2678a647</span><span class="op" id="8274376">,</span>&nbsp;<span class="num" id="8274378">0x98312229</span><span class="op" id="8274388">,</span>&nbsp;<span class="num" id="8274390">0x2f6c79b3</span><span class="op" id="8274400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274405">0x812c81ad</span><span class="op" id="8274415">,</span>&nbsp;<span class="num" id="8274417">0xdadf48ba</span><span class="op" id="8274427">,</span>&nbsp;<span class="num" id="8274429">0x24360af2</span><span class="op" id="8274439">,</span>&nbsp;<span class="num" id="8274441">0xfab8b464</span><span class="op" id="8274451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274456">0x98c5bfc9</span><span class="op" id="8274466">,</span>&nbsp;<span class="num" id="8274468">0xbebd198e</span><span class="op" id="8274478">,</span>&nbsp;<span class="num" id="8274480">0x268c3ba7</span><span class="op" id="8274490">,</span>&nbsp;<span class="num" id="8274492">0x09e04214</span><span class="op" id="8274502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274507">0x68007bac</span><span class="op" id="8274517">,</span>&nbsp;<span class="num" id="8274519">0xb2df3316</span><span class="op" id="8274529">,</span>&nbsp;<span class="num" id="8274531">0x96e939e4</span><span class="op" id="8274541">,</span>&nbsp;<span class="num" id="8274543">0x6c518d80</span><span class="op" id="8274553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274558">0xc814e204</span><span class="op" id="8274568">,</span>&nbsp;<span class="num" id="8274570">0x76a9fb8a</span><span class="op" id="8274580">,</span>&nbsp;<span class="num" id="8274582">0x5025c02d</span><span class="op" id="8274592">,</span>&nbsp;<span class="num" id="8274594">0x59c58239</span><span class="op" id="8274604">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274609">0xde136967</span><span class="op" id="8274619">,</span>&nbsp;<span class="num" id="8274621">0x6ccc5a71</span><span class="op" id="8274631">,</span>&nbsp;<span class="num" id="8274633">0xfa256395</span><span class="op" id="8274643">,</span>&nbsp;<span class="num" id="8274645">0x9674ee15</span><span class="op" id="8274655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274660">0x5886ca5d</span><span class="op" id="8274670">,</span>&nbsp;<span class="num" id="8274672">0x2e2f31d7</span><span class="op" id="8274682">,</span>&nbsp;<span class="num" id="8274684">0x7e0af1fa</span><span class="op" id="8274694">,</span>&nbsp;<span class="num" id="8274696">0x27cf73c3</span><span class="op" id="8274706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274711">0x749c47ab</span><span class="op" id="8274721">,</span>&nbsp;<span class="num" id="8274723">0x18501dda</span><span class="op" id="8274733">,</span>&nbsp;<span class="num" id="8274735">0xe2757e4f</span><span class="op" id="8274745">,</span>&nbsp;<span class="num" id="8274747">0x7401905a</span><span class="op" id="8274757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274762">0xcafaaae3</span><span class="op" id="8274772">,</span>&nbsp;<span class="num" id="8274774">0xe4d59b34</span><span class="op" id="8274784">,</span>&nbsp;<span class="num" id="8274786">0x9adf6ace</span><span class="op" id="8274796">,</span>&nbsp;<span class="num" id="8274798">0xbd10190d</span><span class="op" id="8274808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8274813">0xfe4890d1</span><span class="op" id="8274823">,</span>&nbsp;<span class="num" id="8274825">0xe6188d0b</span><span class="op" id="8274835">,</span>&nbsp;<span class="num" id="8274837">0x046df344</span><span class="op" id="8274847">,</span>&nbsp;<span class="num" id="8274849">0x706c631e</span><span class="op" id="8274859">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8274863">}</span><span class="op" id="8274864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8274868">nil</span><span class="op" id="8274871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8274874">}</span><span class="op" id="8274875">,</span><br>
<span class="lineno"></span><span class="op" id="8274877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="8274880">//&nbsp;Test&nbsp;key&nbsp;expansion&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8274929">func</span>&nbsp;<span class="ident" id="8274934">TestExpandKey</span><span class="op" id="8274947">(</span><span class="ident" id="8274948">t</span>&nbsp;<span class="op" id="8274950">*</span><span class="ident" id="8274951">testing</span><span class="op" id="8274958">.</span><span class="ident" id="8274959">T</span><span class="op" id="8274960">)</span>&nbsp;<span class="op" id="8274962">{</span><br>
<span class="lineno"></span><span class="ident" id="8274964">L</span><span class="op" id="8274965">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8274968">for</span>&nbsp;<span class="ident" id="8274972">i</span><span class="op" id="8274973">,</span>&nbsp;<span class="ident" id="8274975">tt</span>&nbsp;<span class="op" id="8274978">:=</span>&nbsp;<span class="keyword" id="8274981">range</span>&nbsp;<span class="ident" id="8274987">keyTests</span>&nbsp;<span class="op" id="8274996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275000">enc</span>&nbsp;<span class="op" id="8275004">:=</span>&nbsp;<span class="builtinfunc" id="8275007">make</span><span class="op" id="8275011">(</span><span class="op" id="8275012">[</span><span class="op" id="8275013">]</span><span class="builtintype" id="8275014">uint32</span><span class="op" id="8275020">,</span>&nbsp;<span class="builtinfunc" id="8275022">len</span><span class="op" id="8275025">(</span><span class="ident" id="8275026">tt</span><span class="op" id="8275028">.</span><span class="ident" id="8275029">enc</span><span class="op" id="8275032">)</span><span class="op" id="8275033">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275037">var</span>&nbsp;<span class="ident" id="8275041">dec</span>&nbsp;<span class="op" id="8275045">[</span><span class="op" id="8275046">]</span><span class="builtintype" id="8275047">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275056">if</span>&nbsp;<span class="ident" id="8275059">tt</span><span class="op" id="8275061">.</span><span class="ident" id="8275062">dec</span>&nbsp;<span class="op" id="8275066">!=</span>&nbsp;<span class="ident" id="8275069">nil</span>&nbsp;<span class="op" id="8275073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275078">dec</span>&nbsp;<span class="op" id="8275082">=</span>&nbsp;<span class="builtinfunc" id="8275084">make</span><span class="op" id="8275088">(</span><span class="op" id="8275089">[</span><span class="op" id="8275090">]</span><span class="builtintype" id="8275091">uint32</span><span class="op" id="8275097">,</span>&nbsp;<span class="builtinfunc" id="8275099">len</span><span class="op" id="8275102">(</span><span class="ident" id="8275103">tt</span><span class="op" id="8275105">.</span><span class="ident" id="8275106">dec</span><span class="op" id="8275109">)</span><span class="op" id="8275110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8275118">//&nbsp;This&nbsp;test&nbsp;could&nbsp;only&nbsp;test&nbsp;Go&nbsp;version&nbsp;of&nbsp;expandKey&nbsp;because&nbsp;asm</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8275185">//&nbsp;version&nbsp;might&nbsp;use&nbsp;different&nbsp;memory&nbsp;layout&nbsp;for&nbsp;expanded&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8275250">//&nbsp;This&nbsp;is&nbsp;OK&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;expanded&nbsp;keys&nbsp;to&nbsp;the&nbsp;outside</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275319">expandKeyGo</span><span class="op" id="8275330">(</span><span class="ident" id="8275331">tt</span><span class="op" id="8275333">.</span><span class="ident" id="8275334">key</span><span class="op" id="8275337">,</span>&nbsp;<span class="ident" id="8275339">enc</span><span class="op" id="8275342">,</span>&nbsp;<span class="ident" id="8275344">dec</span><span class="op" id="8275347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275351">for</span>&nbsp;<span class="ident" id="8275355">j</span><span class="op" id="8275356">,</span>&nbsp;<span class="ident" id="8275358">v</span>&nbsp;<span class="op" id="8275360">:=</span>&nbsp;<span class="keyword" id="8275363">range</span>&nbsp;<span class="ident" id="8275369">enc</span>&nbsp;<span class="op" id="8275373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275378">if</span>&nbsp;<span class="ident" id="8275381">v</span>&nbsp;<span class="op" id="8275383">!=</span>&nbsp;<span class="ident" id="8275386">tt</span><span class="op" id="8275388">.</span><span class="ident" id="8275389">enc</span><span class="op" id="8275392">[</span><span class="ident" id="8275393">j</span><span class="op" id="8275394">]</span>&nbsp;<span class="op" id="8275396">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275402">t</span><span class="op" id="8275403">.</span><span class="ident" id="8275404">Errorf</span><span class="op" id="8275410">(</span><span class="string" id="8275411">&#34;key&nbsp;%d:&nbsp;enc[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8275444">,</span>&nbsp;<span class="ident" id="8275446">i</span><span class="op" id="8275447">,</span>&nbsp;<span class="ident" id="8275449">j</span><span class="op" id="8275450">,</span>&nbsp;<span class="ident" id="8275452">v</span><span class="op" id="8275453">,</span>&nbsp;<span class="ident" id="8275455">tt</span><span class="op" id="8275457">.</span><span class="ident" id="8275458">enc</span><span class="op" id="8275461">[</span><span class="ident" id="8275462">j</span><span class="op" id="8275463">]</span><span class="op" id="8275464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275470">continue</span>&nbsp;<span class="ident" id="8275479">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275492">if</span>&nbsp;<span class="ident" id="8275495">dec</span>&nbsp;<span class="op" id="8275499">!=</span>&nbsp;<span class="ident" id="8275502">nil</span>&nbsp;<span class="op" id="8275506">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275511">for</span>&nbsp;<span class="ident" id="8275515">j</span><span class="op" id="8275516">,</span>&nbsp;<span class="ident" id="8275518">v</span>&nbsp;<span class="op" id="8275520">:=</span>&nbsp;<span class="keyword" id="8275523">range</span>&nbsp;<span class="ident" id="8275529">dec</span>&nbsp;<span class="op" id="8275533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275539">if</span>&nbsp;<span class="ident" id="8275542">v</span>&nbsp;<span class="op" id="8275544">!=</span>&nbsp;<span class="ident" id="8275547">tt</span><span class="op" id="8275549">.</span><span class="ident" id="8275550">dec</span><span class="op" id="8275553">[</span><span class="ident" id="8275554">j</span><span class="op" id="8275555">]</span>&nbsp;<span class="op" id="8275557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275564">t</span><span class="op" id="8275565">.</span><span class="ident" id="8275566">Errorf</span><span class="op" id="8275572">(</span><span class="string" id="8275573">&#34;key&nbsp;%d:&nbsp;dec[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8275606">,</span>&nbsp;<span class="ident" id="8275608">i</span><span class="op" id="8275609">,</span>&nbsp;<span class="ident" id="8275611">j</span><span class="op" id="8275612">,</span>&nbsp;<span class="ident" id="8275614">v</span><span class="op" id="8275615">,</span>&nbsp;<span class="ident" id="8275617">tt</span><span class="op" id="8275619">.</span><span class="ident" id="8275620">dec</span><span class="op" id="8275623">[</span><span class="ident" id="8275624">j</span><span class="op" id="8275625">]</span><span class="op" id="8275626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8275633">continue</span>&nbsp;<span class="ident" id="8275642">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275648">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275660">}</span><br>
<span class="lineno"></span><span class="op" id="8275662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="8275665">//&nbsp;Appendix&nbsp;B,&nbsp;C&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Cipher&nbsp;examples,&nbsp;Example&nbsp;vectors.</span><br>
<span class="lineno"></span><span class="keyword" id="8275729">type</span>&nbsp;<span class="ident" id="8275734">CryptTest</span>&nbsp;<span class="keyword" id="8275744">struct</span>&nbsp;<span class="op" id="8275751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275754">key</span>&nbsp;<span class="op" id="8275758">[</span><span class="op" id="8275759">]</span><span class="builtintype" id="8275760">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275766">in</span>&nbsp;&nbsp;<span class="op" id="8275770">[</span><span class="op" id="8275771">]</span><span class="builtintype" id="8275772">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8275778">out</span>&nbsp;<span class="op" id="8275782">[</span><span class="op" id="8275783">]</span><span class="builtintype" id="8275784">byte</span><br>
<span class="lineno">250</span><span class="op" id="8275789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8275792">var</span>&nbsp;<span class="ident" id="8275796">encryptTests</span>&nbsp;<span class="op" id="8275809">=</span>&nbsp;<span class="op" id="8275811">[</span><span class="op" id="8275812">]</span><span class="ident" id="8275813">CryptTest</span><span class="op" id="8275822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8275829">//&nbsp;Appendix&nbsp;B.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275846">[</span><span class="op" id="8275847">]</span><span class="builtintype" id="8275848">byte</span><span class="op" id="8275852">{</span><span class="num" id="8275853">0x2b</span><span class="op" id="8275857">,</span>&nbsp;<span class="num" id="8275859">0x7e</span><span class="op" id="8275863">,</span>&nbsp;<span class="num" id="8275865">0x15</span><span class="op" id="8275869">,</span>&nbsp;<span class="num" id="8275871">0x16</span><span class="op" id="8275875">,</span>&nbsp;<span class="num" id="8275877">0x28</span><span class="op" id="8275881">,</span>&nbsp;<span class="num" id="8275883">0xae</span><span class="op" id="8275887">,</span>&nbsp;<span class="num" id="8275889">0xd2</span><span class="op" id="8275893">,</span>&nbsp;<span class="num" id="8275895">0xa6</span><span class="op" id="8275899">,</span>&nbsp;<span class="num" id="8275901">0xab</span><span class="op" id="8275905">,</span>&nbsp;<span class="num" id="8275907">0xf7</span><span class="op" id="8275911">,</span>&nbsp;<span class="num" id="8275913">0x15</span><span class="op" id="8275917">,</span>&nbsp;<span class="num" id="8275919">0x88</span><span class="op" id="8275923">,</span>&nbsp;<span class="num" id="8275925">0x09</span><span class="op" id="8275929">,</span>&nbsp;<span class="num" id="8275931">0xcf</span><span class="op" id="8275935">,</span>&nbsp;<span class="num" id="8275937">0x4f</span><span class="op" id="8275941">,</span>&nbsp;<span class="num" id="8275943">0x3c</span><span class="op" id="8275947">}</span><span class="op" id="8275948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8275952">[</span><span class="op" id="8275953">]</span><span class="builtintype" id="8275954">byte</span><span class="op" id="8275958">{</span><span class="num" id="8275959">0x32</span><span class="op" id="8275963">,</span>&nbsp;<span class="num" id="8275965">0x43</span><span class="op" id="8275969">,</span>&nbsp;<span class="num" id="8275971">0xf6</span><span class="op" id="8275975">,</span>&nbsp;<span class="num" id="8275977">0xa8</span><span class="op" id="8275981">,</span>&nbsp;<span class="num" id="8275983">0x88</span><span class="op" id="8275987">,</span>&nbsp;<span class="num" id="8275989">0x5a</span><span class="op" id="8275993">,</span>&nbsp;<span class="num" id="8275995">0x30</span><span class="op" id="8275999">,</span>&nbsp;<span class="num" id="8276001">0x8d</span><span class="op" id="8276005">,</span>&nbsp;<span class="num" id="8276007">0x31</span><span class="op" id="8276011">,</span>&nbsp;<span class="num" id="8276013">0x31</span><span class="op" id="8276017">,</span>&nbsp;<span class="num" id="8276019">0x98</span><span class="op" id="8276023">,</span>&nbsp;<span class="num" id="8276025">0xa2</span><span class="op" id="8276029">,</span>&nbsp;<span class="num" id="8276031">0xe0</span><span class="op" id="8276035">,</span>&nbsp;<span class="num" id="8276037">0x37</span><span class="op" id="8276041">,</span>&nbsp;<span class="num" id="8276043">0x07</span><span class="op" id="8276047">,</span>&nbsp;<span class="num" id="8276049">0x34</span><span class="op" id="8276053">}</span><span class="op" id="8276054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276058">[</span><span class="op" id="8276059">]</span><span class="builtintype" id="8276060">byte</span><span class="op" id="8276064">{</span><span class="num" id="8276065">0x39</span><span class="op" id="8276069">,</span>&nbsp;<span class="num" id="8276071">0x25</span><span class="op" id="8276075">,</span>&nbsp;<span class="num" id="8276077">0x84</span><span class="op" id="8276081">,</span>&nbsp;<span class="num" id="8276083">0x1d</span><span class="op" id="8276087">,</span>&nbsp;<span class="num" id="8276089">0x02</span><span class="op" id="8276093">,</span>&nbsp;<span class="num" id="8276095">0xdc</span><span class="op" id="8276099">,</span>&nbsp;<span class="num" id="8276101">0x09</span><span class="op" id="8276105">,</span>&nbsp;<span class="num" id="8276107">0xfb</span><span class="op" id="8276111">,</span>&nbsp;<span class="num" id="8276113">0xdc</span><span class="op" id="8276117">,</span>&nbsp;<span class="num" id="8276119">0x11</span><span class="op" id="8276123">,</span>&nbsp;<span class="num" id="8276125">0x85</span><span class="op" id="8276129">,</span>&nbsp;<span class="num" id="8276131">0x97</span><span class="op" id="8276135">,</span>&nbsp;<span class="num" id="8276137">0x19</span><span class="op" id="8276141">,</span>&nbsp;<span class="num" id="8276143">0x6a</span><span class="op" id="8276147">,</span>&nbsp;<span class="num" id="8276149">0x0b</span><span class="op" id="8276153">,</span>&nbsp;<span class="num" id="8276155">0x32</span><span class="op" id="8276159">}</span><span class="op" id="8276160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276163">}</span><span class="op" id="8276164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276167">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8276171">//&nbsp;Appendix&nbsp;C.1.&nbsp;&nbsp;AES-128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276199">[</span><span class="op" id="8276200">]</span><span class="builtintype" id="8276201">byte</span><span class="op" id="8276205">{</span><span class="num" id="8276206">0x00</span><span class="op" id="8276210">,</span>&nbsp;<span class="num" id="8276212">0x01</span><span class="op" id="8276216">,</span>&nbsp;<span class="num" id="8276218">0x02</span><span class="op" id="8276222">,</span>&nbsp;<span class="num" id="8276224">0x03</span><span class="op" id="8276228">,</span>&nbsp;<span class="num" id="8276230">0x04</span><span class="op" id="8276234">,</span>&nbsp;<span class="num" id="8276236">0x05</span><span class="op" id="8276240">,</span>&nbsp;<span class="num" id="8276242">0x06</span><span class="op" id="8276246">,</span>&nbsp;<span class="num" id="8276248">0x07</span><span class="op" id="8276252">,</span>&nbsp;<span class="num" id="8276254">0x08</span><span class="op" id="8276258">,</span>&nbsp;<span class="num" id="8276260">0x09</span><span class="op" id="8276264">,</span>&nbsp;<span class="num" id="8276266">0x0a</span><span class="op" id="8276270">,</span>&nbsp;<span class="num" id="8276272">0x0b</span><span class="op" id="8276276">,</span>&nbsp;<span class="num" id="8276278">0x0c</span><span class="op" id="8276282">,</span>&nbsp;<span class="num" id="8276284">0x0d</span><span class="op" id="8276288">,</span>&nbsp;<span class="num" id="8276290">0x0e</span><span class="op" id="8276294">,</span>&nbsp;<span class="num" id="8276296">0x0f</span><span class="op" id="8276300">}</span><span class="op" id="8276301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276305">[</span><span class="op" id="8276306">]</span><span class="builtintype" id="8276307">byte</span><span class="op" id="8276311">{</span><span class="num" id="8276312">0x00</span><span class="op" id="8276316">,</span>&nbsp;<span class="num" id="8276318">0x11</span><span class="op" id="8276322">,</span>&nbsp;<span class="num" id="8276324">0x22</span><span class="op" id="8276328">,</span>&nbsp;<span class="num" id="8276330">0x33</span><span class="op" id="8276334">,</span>&nbsp;<span class="num" id="8276336">0x44</span><span class="op" id="8276340">,</span>&nbsp;<span class="num" id="8276342">0x55</span><span class="op" id="8276346">,</span>&nbsp;<span class="num" id="8276348">0x66</span><span class="op" id="8276352">,</span>&nbsp;<span class="num" id="8276354">0x77</span><span class="op" id="8276358">,</span>&nbsp;<span class="num" id="8276360">0x88</span><span class="op" id="8276364">,</span>&nbsp;<span class="num" id="8276366">0x99</span><span class="op" id="8276370">,</span>&nbsp;<span class="num" id="8276372">0xaa</span><span class="op" id="8276376">,</span>&nbsp;<span class="num" id="8276378">0xbb</span><span class="op" id="8276382">,</span>&nbsp;<span class="num" id="8276384">0xcc</span><span class="op" id="8276388">,</span>&nbsp;<span class="num" id="8276390">0xdd</span><span class="op" id="8276394">,</span>&nbsp;<span class="num" id="8276396">0xee</span><span class="op" id="8276400">,</span>&nbsp;<span class="num" id="8276402">0xff</span><span class="op" id="8276406">}</span><span class="op" id="8276407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276411">[</span><span class="op" id="8276412">]</span><span class="builtintype" id="8276413">byte</span><span class="op" id="8276417">{</span><span class="num" id="8276418">0x69</span><span class="op" id="8276422">,</span>&nbsp;<span class="num" id="8276424">0xc4</span><span class="op" id="8276428">,</span>&nbsp;<span class="num" id="8276430">0xe0</span><span class="op" id="8276434">,</span>&nbsp;<span class="num" id="8276436">0xd8</span><span class="op" id="8276440">,</span>&nbsp;<span class="num" id="8276442">0x6a</span><span class="op" id="8276446">,</span>&nbsp;<span class="num" id="8276448">0x7b</span><span class="op" id="8276452">,</span>&nbsp;<span class="num" id="8276454">0x04</span><span class="op" id="8276458">,</span>&nbsp;<span class="num" id="8276460">0x30</span><span class="op" id="8276464">,</span>&nbsp;<span class="num" id="8276466">0xd8</span><span class="op" id="8276470">,</span>&nbsp;<span class="num" id="8276472">0xcd</span><span class="op" id="8276476">,</span>&nbsp;<span class="num" id="8276478">0xb7</span><span class="op" id="8276482">,</span>&nbsp;<span class="num" id="8276484">0x80</span><span class="op" id="8276488">,</span>&nbsp;<span class="num" id="8276490">0x70</span><span class="op" id="8276494">,</span>&nbsp;<span class="num" id="8276496">0xb4</span><span class="op" id="8276500">,</span>&nbsp;<span class="num" id="8276502">0xc5</span><span class="op" id="8276506">,</span>&nbsp;<span class="num" id="8276508">0x5a</span><span class="op" id="8276512">}</span><span class="op" id="8276513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276516">}</span><span class="op" id="8276517">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8276524">//&nbsp;Appendix&nbsp;C.2.&nbsp;&nbsp;AES-192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276552">[</span><span class="op" id="8276553">]</span><span class="builtintype" id="8276554">byte</span><span class="op" id="8276558">{</span><span class="num" id="8276559">0x00</span><span class="op" id="8276563">,</span>&nbsp;<span class="num" id="8276565">0x01</span><span class="op" id="8276569">,</span>&nbsp;<span class="num" id="8276571">0x02</span><span class="op" id="8276575">,</span>&nbsp;<span class="num" id="8276577">0x03</span><span class="op" id="8276581">,</span>&nbsp;<span class="num" id="8276583">0x04</span><span class="op" id="8276587">,</span>&nbsp;<span class="num" id="8276589">0x05</span><span class="op" id="8276593">,</span>&nbsp;<span class="num" id="8276595">0x06</span><span class="op" id="8276599">,</span>&nbsp;<span class="num" id="8276601">0x07</span><span class="op" id="8276605">,</span>&nbsp;<span class="num" id="8276607">0x08</span><span class="op" id="8276611">,</span>&nbsp;<span class="num" id="8276613">0x09</span><span class="op" id="8276617">,</span>&nbsp;<span class="num" id="8276619">0x0a</span><span class="op" id="8276623">,</span>&nbsp;<span class="num" id="8276625">0x0b</span><span class="op" id="8276629">,</span>&nbsp;<span class="num" id="8276631">0x0c</span><span class="op" id="8276635">,</span>&nbsp;<span class="num" id="8276637">0x0d</span><span class="op" id="8276641">,</span>&nbsp;<span class="num" id="8276643">0x0e</span><span class="op" id="8276647">,</span>&nbsp;<span class="num" id="8276649">0x0f</span><span class="op" id="8276653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8276658">0x10</span><span class="op" id="8276662">,</span>&nbsp;<span class="num" id="8276664">0x11</span><span class="op" id="8276668">,</span>&nbsp;<span class="num" id="8276670">0x12</span><span class="op" id="8276674">,</span>&nbsp;<span class="num" id="8276676">0x13</span><span class="op" id="8276680">,</span>&nbsp;<span class="num" id="8276682">0x14</span><span class="op" id="8276686">,</span>&nbsp;<span class="num" id="8276688">0x15</span><span class="op" id="8276692">,</span>&nbsp;<span class="num" id="8276694">0x16</span><span class="op" id="8276698">,</span>&nbsp;<span class="num" id="8276700">0x17</span><span class="op" id="8276704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276708">}</span><span class="op" id="8276709">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276713">[</span><span class="op" id="8276714">]</span><span class="builtintype" id="8276715">byte</span><span class="op" id="8276719">{</span><span class="num" id="8276720">0x00</span><span class="op" id="8276724">,</span>&nbsp;<span class="num" id="8276726">0x11</span><span class="op" id="8276730">,</span>&nbsp;<span class="num" id="8276732">0x22</span><span class="op" id="8276736">,</span>&nbsp;<span class="num" id="8276738">0x33</span><span class="op" id="8276742">,</span>&nbsp;<span class="num" id="8276744">0x44</span><span class="op" id="8276748">,</span>&nbsp;<span class="num" id="8276750">0x55</span><span class="op" id="8276754">,</span>&nbsp;<span class="num" id="8276756">0x66</span><span class="op" id="8276760">,</span>&nbsp;<span class="num" id="8276762">0x77</span><span class="op" id="8276766">,</span>&nbsp;<span class="num" id="8276768">0x88</span><span class="op" id="8276772">,</span>&nbsp;<span class="num" id="8276774">0x99</span><span class="op" id="8276778">,</span>&nbsp;<span class="num" id="8276780">0xaa</span><span class="op" id="8276784">,</span>&nbsp;<span class="num" id="8276786">0xbb</span><span class="op" id="8276790">,</span>&nbsp;<span class="num" id="8276792">0xcc</span><span class="op" id="8276796">,</span>&nbsp;<span class="num" id="8276798">0xdd</span><span class="op" id="8276802">,</span>&nbsp;<span class="num" id="8276804">0xee</span><span class="op" id="8276808">,</span>&nbsp;<span class="num" id="8276810">0xff</span><span class="op" id="8276814">}</span><span class="op" id="8276815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276819">[</span><span class="op" id="8276820">]</span><span class="builtintype" id="8276821">byte</span><span class="op" id="8276825">{</span><span class="num" id="8276826">0xdd</span><span class="op" id="8276830">,</span>&nbsp;<span class="num" id="8276832">0xa9</span><span class="op" id="8276836">,</span>&nbsp;<span class="num" id="8276838">0x7c</span><span class="op" id="8276842">,</span>&nbsp;<span class="num" id="8276844">0xa4</span><span class="op" id="8276848">,</span>&nbsp;<span class="num" id="8276850">0x86</span><span class="op" id="8276854">,</span>&nbsp;<span class="num" id="8276856">0x4c</span><span class="op" id="8276860">,</span>&nbsp;<span class="num" id="8276862">0xdf</span><span class="op" id="8276866">,</span>&nbsp;<span class="num" id="8276868">0xe0</span><span class="op" id="8276872">,</span>&nbsp;<span class="num" id="8276874">0x6e</span><span class="op" id="8276878">,</span>&nbsp;<span class="num" id="8276880">0xaf</span><span class="op" id="8276884">,</span>&nbsp;<span class="num" id="8276886">0x70</span><span class="op" id="8276890">,</span>&nbsp;<span class="num" id="8276892">0xa0</span><span class="op" id="8276896">,</span>&nbsp;<span class="num" id="8276898">0xec</span><span class="op" id="8276902">,</span>&nbsp;<span class="num" id="8276904">0x0d</span><span class="op" id="8276908">,</span>&nbsp;<span class="num" id="8276910">0x71</span><span class="op" id="8276914">,</span>&nbsp;<span class="num" id="8276916">0x91</span><span class="op" id="8276920">}</span><span class="op" id="8276921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276924">}</span><span class="op" id="8276925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8276932">//&nbsp;Appendix&nbsp;C.3.&nbsp;&nbsp;AES-256</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8276960">[</span><span class="op" id="8276961">]</span><span class="builtintype" id="8276962">byte</span><span class="op" id="8276966">{</span><span class="num" id="8276967">0x00</span><span class="op" id="8276971">,</span>&nbsp;<span class="num" id="8276973">0x01</span><span class="op" id="8276977">,</span>&nbsp;<span class="num" id="8276979">0x02</span><span class="op" id="8276983">,</span>&nbsp;<span class="num" id="8276985">0x03</span><span class="op" id="8276989">,</span>&nbsp;<span class="num" id="8276991">0x04</span><span class="op" id="8276995">,</span>&nbsp;<span class="num" id="8276997">0x05</span><span class="op" id="8277001">,</span>&nbsp;<span class="num" id="8277003">0x06</span><span class="op" id="8277007">,</span>&nbsp;<span class="num" id="8277009">0x07</span><span class="op" id="8277013">,</span>&nbsp;<span class="num" id="8277015">0x08</span><span class="op" id="8277019">,</span>&nbsp;<span class="num" id="8277021">0x09</span><span class="op" id="8277025">,</span>&nbsp;<span class="num" id="8277027">0x0a</span><span class="op" id="8277031">,</span>&nbsp;<span class="num" id="8277033">0x0b</span><span class="op" id="8277037">,</span>&nbsp;<span class="num" id="8277039">0x0c</span><span class="op" id="8277043">,</span>&nbsp;<span class="num" id="8277045">0x0d</span><span class="op" id="8277049">,</span>&nbsp;<span class="num" id="8277051">0x0e</span><span class="op" id="8277055">,</span>&nbsp;<span class="num" id="8277057">0x0f</span><span class="op" id="8277061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8277066">0x10</span><span class="op" id="8277070">,</span>&nbsp;<span class="num" id="8277072">0x11</span><span class="op" id="8277076">,</span>&nbsp;<span class="num" id="8277078">0x12</span><span class="op" id="8277082">,</span>&nbsp;<span class="num" id="8277084">0x13</span><span class="op" id="8277088">,</span>&nbsp;<span class="num" id="8277090">0x14</span><span class="op" id="8277094">,</span>&nbsp;<span class="num" id="8277096">0x15</span><span class="op" id="8277100">,</span>&nbsp;<span class="num" id="8277102">0x16</span><span class="op" id="8277106">,</span>&nbsp;<span class="num" id="8277108">0x17</span><span class="op" id="8277112">,</span>&nbsp;<span class="num" id="8277114">0x18</span><span class="op" id="8277118">,</span>&nbsp;<span class="num" id="8277120">0x19</span><span class="op" id="8277124">,</span>&nbsp;<span class="num" id="8277126">0x1a</span><span class="op" id="8277130">,</span>&nbsp;<span class="num" id="8277132">0x1b</span><span class="op" id="8277136">,</span>&nbsp;<span class="num" id="8277138">0x1c</span><span class="op" id="8277142">,</span>&nbsp;<span class="num" id="8277144">0x1d</span><span class="op" id="8277148">,</span>&nbsp;<span class="num" id="8277150">0x1e</span><span class="op" id="8277154">,</span>&nbsp;<span class="num" id="8277156">0x1f</span><span class="op" id="8277160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8277164">}</span><span class="op" id="8277165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8277169">[</span><span class="op" id="8277170">]</span><span class="builtintype" id="8277171">byte</span><span class="op" id="8277175">{</span><span class="num" id="8277176">0x00</span><span class="op" id="8277180">,</span>&nbsp;<span class="num" id="8277182">0x11</span><span class="op" id="8277186">,</span>&nbsp;<span class="num" id="8277188">0x22</span><span class="op" id="8277192">,</span>&nbsp;<span class="num" id="8277194">0x33</span><span class="op" id="8277198">,</span>&nbsp;<span class="num" id="8277200">0x44</span><span class="op" id="8277204">,</span>&nbsp;<span class="num" id="8277206">0x55</span><span class="op" id="8277210">,</span>&nbsp;<span class="num" id="8277212">0x66</span><span class="op" id="8277216">,</span>&nbsp;<span class="num" id="8277218">0x77</span><span class="op" id="8277222">,</span>&nbsp;<span class="num" id="8277224">0x88</span><span class="op" id="8277228">,</span>&nbsp;<span class="num" id="8277230">0x99</span><span class="op" id="8277234">,</span>&nbsp;<span class="num" id="8277236">0xaa</span><span class="op" id="8277240">,</span>&nbsp;<span class="num" id="8277242">0xbb</span><span class="op" id="8277246">,</span>&nbsp;<span class="num" id="8277248">0xcc</span><span class="op" id="8277252">,</span>&nbsp;<span class="num" id="8277254">0xdd</span><span class="op" id="8277258">,</span>&nbsp;<span class="num" id="8277260">0xee</span><span class="op" id="8277264">,</span>&nbsp;<span class="num" id="8277266">0xff</span><span class="op" id="8277270">}</span><span class="op" id="8277271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8277275">[</span><span class="op" id="8277276">]</span><span class="builtintype" id="8277277">byte</span><span class="op" id="8277281">{</span><span class="num" id="8277282">0x8e</span><span class="op" id="8277286">,</span>&nbsp;<span class="num" id="8277288">0xa2</span><span class="op" id="8277292">,</span>&nbsp;<span class="num" id="8277294">0xb7</span><span class="op" id="8277298">,</span>&nbsp;<span class="num" id="8277300">0xca</span><span class="op" id="8277304">,</span>&nbsp;<span class="num" id="8277306">0x51</span><span class="op" id="8277310">,</span>&nbsp;<span class="num" id="8277312">0x67</span><span class="op" id="8277316">,</span>&nbsp;<span class="num" id="8277318">0x45</span><span class="op" id="8277322">,</span>&nbsp;<span class="num" id="8277324">0xbf</span><span class="op" id="8277328">,</span>&nbsp;<span class="num" id="8277330">0xea</span><span class="op" id="8277334">,</span>&nbsp;<span class="num" id="8277336">0xfc</span><span class="op" id="8277340">,</span>&nbsp;<span class="num" id="8277342">0x49</span><span class="op" id="8277346">,</span>&nbsp;<span class="num" id="8277348">0x90</span><span class="op" id="8277352">,</span>&nbsp;<span class="num" id="8277354">0x4b</span><span class="op" id="8277358">,</span>&nbsp;<span class="num" id="8277360">0x49</span><span class="op" id="8277364">,</span>&nbsp;<span class="num" id="8277366">0x60</span><span class="op" id="8277370">,</span>&nbsp;<span class="num" id="8277372">0x89</span><span class="op" id="8277376">}</span><span class="op" id="8277377">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8277380">}</span><span class="op" id="8277381">,</span><br>
<span class="lineno"></span><span class="op" id="8277383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8277386">//&nbsp;Test&nbsp;encryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8277434">func</span>&nbsp;<span class="ident" id="8277439">TestEncryptBlock</span><span class="op" id="8277455">(</span><span class="ident" id="8277456">t</span>&nbsp;<span class="op" id="8277458">*</span><span class="ident" id="8277459">testing</span><span class="op" id="8277466">.</span><span class="ident" id="8277467">T</span><span class="op" id="8277468">)</span>&nbsp;<span class="op" id="8277470">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8277473">for</span>&nbsp;<span class="ident" id="8277477">i</span><span class="op" id="8277478">,</span>&nbsp;<span class="ident" id="8277480">tt</span>&nbsp;<span class="op" id="8277483">:=</span>&nbsp;<span class="keyword" id="8277486">range</span>&nbsp;<span class="ident" id="8277492">encryptTests</span>&nbsp;<span class="op" id="8277505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277509">n</span>&nbsp;<span class="op" id="8277511">:=</span>&nbsp;<span class="builtinfunc" id="8277514">len</span><span class="op" id="8277517">(</span><span class="ident" id="8277518">tt</span><span class="op" id="8277520">.</span><span class="ident" id="8277521">key</span><span class="op" id="8277524">)</span>&nbsp;<span class="op" id="8277526">+</span>&nbsp;<span class="num" id="8277528">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277533">enc</span>&nbsp;<span class="op" id="8277537">:=</span>&nbsp;<span class="builtinfunc" id="8277540">make</span><span class="op" id="8277544">(</span><span class="op" id="8277545">[</span><span class="op" id="8277546">]</span><span class="builtintype" id="8277547">uint32</span><span class="op" id="8277553">,</span>&nbsp;<span class="ident" id="8277555">n</span><span class="op" id="8277556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277560">dec</span>&nbsp;<span class="op" id="8277564">:=</span>&nbsp;<span class="builtinfunc" id="8277567">make</span><span class="op" id="8277571">(</span><span class="op" id="8277572">[</span><span class="op" id="8277573">]</span><span class="builtintype" id="8277574">uint32</span><span class="op" id="8277580">,</span>&nbsp;<span class="ident" id="8277582">n</span><span class="op" id="8277583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277587">expandKey</span><span class="op" id="8277596">(</span><span class="ident" id="8277597">tt</span><span class="op" id="8277599">.</span><span class="ident" id="8277600">key</span><span class="op" id="8277603">,</span>&nbsp;<span class="ident" id="8277605">enc</span><span class="op" id="8277608">,</span>&nbsp;<span class="ident" id="8277610">dec</span><span class="op" id="8277613">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277617">out</span>&nbsp;<span class="op" id="8277621">:=</span>&nbsp;<span class="builtinfunc" id="8277624">make</span><span class="op" id="8277628">(</span><span class="op" id="8277629">[</span><span class="op" id="8277630">]</span><span class="builtintype" id="8277631">byte</span><span class="op" id="8277635">,</span>&nbsp;<span class="builtinfunc" id="8277637">len</span><span class="op" id="8277640">(</span><span class="ident" id="8277641">tt</span><span class="op" id="8277643">.</span><span class="ident" id="8277644">in</span><span class="op" id="8277646">)</span><span class="op" id="8277647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277651">encryptBlock</span><span class="op" id="8277663">(</span><span class="ident" id="8277664">enc</span><span class="op" id="8277667">,</span>&nbsp;<span class="ident" id="8277669">out</span><span class="op" id="8277672">,</span>&nbsp;<span class="ident" id="8277674">tt</span><span class="op" id="8277676">.</span><span class="ident" id="8277677">in</span><span class="op" id="8277679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8277683">for</span>&nbsp;<span class="ident" id="8277687">j</span><span class="op" id="8277688">,</span>&nbsp;<span class="ident" id="8277690">v</span>&nbsp;<span class="op" id="8277692">:=</span>&nbsp;<span class="keyword" id="8277695">range</span>&nbsp;<span class="ident" id="8277701">out</span>&nbsp;<span class="op" id="8277705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8277710">if</span>&nbsp;<span class="ident" id="8277713">v</span>&nbsp;<span class="op" id="8277715">!=</span>&nbsp;<span class="ident" id="8277718">tt</span><span class="op" id="8277720">.</span><span class="ident" id="8277721">out</span><span class="op" id="8277724">[</span><span class="ident" id="8277725">j</span><span class="op" id="8277726">]</span>&nbsp;<span class="op" id="8277728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277734">t</span><span class="op" id="8277735">.</span><span class="ident" id="8277736">Errorf</span><span class="op" id="8277742">(</span><span class="string" id="8277743">&#34;encryptBlock&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8277785">,</span>&nbsp;<span class="ident" id="8277787">i</span><span class="op" id="8277788">,</span>&nbsp;<span class="ident" id="8277790">j</span><span class="op" id="8277791">,</span>&nbsp;<span class="ident" id="8277793">v</span><span class="op" id="8277794">,</span>&nbsp;<span class="ident" id="8277796">tt</span><span class="op" id="8277798">.</span><span class="ident" id="8277799">out</span><span class="op" id="8277802">[</span><span class="ident" id="8277803">j</span><span class="op" id="8277804">]</span><span class="op" id="8277805">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8277811">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8277820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8277824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8277827">}</span><br>
<span class="lineno"></span><span class="op" id="8277829">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="8277832">//&nbsp;Test&nbsp;decryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8277880">func</span>&nbsp;<span class="ident" id="8277885">TestDecryptBlock</span><span class="op" id="8277901">(</span><span class="ident" id="8277902">t</span>&nbsp;<span class="op" id="8277904">*</span><span class="ident" id="8277905">testing</span><span class="op" id="8277912">.</span><span class="ident" id="8277913">T</span><span class="op" id="8277914">)</span>&nbsp;<span class="op" id="8277916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8277919">for</span>&nbsp;<span class="ident" id="8277923">i</span><span class="op" id="8277924">,</span>&nbsp;<span class="ident" id="8277926">tt</span>&nbsp;<span class="op" id="8277929">:=</span>&nbsp;<span class="keyword" id="8277932">range</span>&nbsp;<span class="ident" id="8277938">encryptTests</span>&nbsp;<span class="op" id="8277951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277955">n</span>&nbsp;<span class="op" id="8277957">:=</span>&nbsp;<span class="builtinfunc" id="8277960">len</span><span class="op" id="8277963">(</span><span class="ident" id="8277964">tt</span><span class="op" id="8277966">.</span><span class="ident" id="8277967">key</span><span class="op" id="8277970">)</span>&nbsp;<span class="op" id="8277972">+</span>&nbsp;<span class="num" id="8277974">28</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8277979">enc</span>&nbsp;<span class="op" id="8277983">:=</span>&nbsp;<span class="builtinfunc" id="8277986">make</span><span class="op" id="8277990">(</span><span class="op" id="8277991">[</span><span class="op" id="8277992">]</span><span class="builtintype" id="8277993">uint32</span><span class="op" id="8277999">,</span>&nbsp;<span class="ident" id="8278001">n</span><span class="op" id="8278002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278006">dec</span>&nbsp;<span class="op" id="8278010">:=</span>&nbsp;<span class="builtinfunc" id="8278013">make</span><span class="op" id="8278017">(</span><span class="op" id="8278018">[</span><span class="op" id="8278019">]</span><span class="builtintype" id="8278020">uint32</span><span class="op" id="8278026">,</span>&nbsp;<span class="ident" id="8278028">n</span><span class="op" id="8278029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278033">expandKey</span><span class="op" id="8278042">(</span><span class="ident" id="8278043">tt</span><span class="op" id="8278045">.</span><span class="ident" id="8278046">key</span><span class="op" id="8278049">,</span>&nbsp;<span class="ident" id="8278051">enc</span><span class="op" id="8278054">,</span>&nbsp;<span class="ident" id="8278056">dec</span><span class="op" id="8278059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278063">plain</span>&nbsp;<span class="op" id="8278069">:=</span>&nbsp;<span class="builtinfunc" id="8278072">make</span><span class="op" id="8278076">(</span><span class="op" id="8278077">[</span><span class="op" id="8278078">]</span><span class="builtintype" id="8278079">byte</span><span class="op" id="8278083">,</span>&nbsp;<span class="builtinfunc" id="8278085">len</span><span class="op" id="8278088">(</span><span class="ident" id="8278089">tt</span><span class="op" id="8278091">.</span><span class="ident" id="8278092">in</span><span class="op" id="8278094">)</span><span class="op" id="8278095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278099">decryptBlock</span><span class="op" id="8278111">(</span><span class="ident" id="8278112">dec</span><span class="op" id="8278115">,</span>&nbsp;<span class="ident" id="8278117">plain</span><span class="op" id="8278122">,</span>&nbsp;<span class="ident" id="8278124">tt</span><span class="op" id="8278126">.</span><span class="ident" id="8278127">out</span><span class="op" id="8278130">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278134">for</span>&nbsp;<span class="ident" id="8278138">j</span><span class="op" id="8278139">,</span>&nbsp;<span class="ident" id="8278141">v</span>&nbsp;<span class="op" id="8278143">:=</span>&nbsp;<span class="keyword" id="8278146">range</span>&nbsp;<span class="ident" id="8278152">plain</span>&nbsp;<span class="op" id="8278158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278163">if</span>&nbsp;<span class="ident" id="8278166">v</span>&nbsp;<span class="op" id="8278168">!=</span>&nbsp;<span class="ident" id="8278171">tt</span><span class="op" id="8278173">.</span><span class="ident" id="8278174">in</span><span class="op" id="8278176">[</span><span class="ident" id="8278177">j</span><span class="op" id="8278178">]</span>&nbsp;<span class="op" id="8278180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278186">t</span><span class="op" id="8278187">.</span><span class="ident" id="8278188">Errorf</span><span class="op" id="8278194">(</span><span class="string" id="8278195">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8278239">,</span>&nbsp;<span class="ident" id="8278241">i</span><span class="op" id="8278242">,</span>&nbsp;<span class="ident" id="8278244">j</span><span class="op" id="8278245">,</span>&nbsp;<span class="ident" id="8278247">v</span><span class="op" id="8278248">,</span>&nbsp;<span class="ident" id="8278250">tt</span><span class="op" id="8278252">.</span><span class="ident" id="8278253">in</span><span class="op" id="8278255">[</span><span class="ident" id="8278256">j</span><span class="op" id="8278257">]</span><span class="op" id="8278258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278264">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278273">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278280">}</span><br>
<span class="lineno"></span><span class="op" id="8278282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8278285">//&nbsp;Test&nbsp;Cipher&nbsp;Encrypt&nbsp;method&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno">320</span><span class="keyword" id="8278342">func</span>&nbsp;<span class="ident" id="8278347">TestCipherEncrypt</span><span class="op" id="8278364">(</span><span class="ident" id="8278365">t</span>&nbsp;<span class="op" id="8278367">*</span><span class="ident" id="8278368">testing</span><span class="op" id="8278375">.</span><span class="ident" id="8278376">T</span><span class="op" id="8278377">)</span>&nbsp;<span class="op" id="8278379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278382">for</span>&nbsp;<span class="ident" id="8278386">i</span><span class="op" id="8278387">,</span>&nbsp;<span class="ident" id="8278389">tt</span>&nbsp;<span class="op" id="8278392">:=</span>&nbsp;<span class="keyword" id="8278395">range</span>&nbsp;<span class="ident" id="8278401">encryptTests</span>&nbsp;<span class="op" id="8278414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278418">c</span><span class="op" id="8278419">,</span>&nbsp;<span class="ident" id="8278421">err</span>&nbsp;<span class="op" id="8278425">:=</span>&nbsp;<span class="ident" id="8278428">NewCipher</span><span class="op" id="8278437">(</span><span class="ident" id="8278438">tt</span><span class="op" id="8278440">.</span><span class="ident" id="8278441">key</span><span class="op" id="8278444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278448">if</span>&nbsp;<span class="ident" id="8278451">err</span>&nbsp;<span class="op" id="8278455">!=</span>&nbsp;<span class="ident" id="8278458">nil</span>&nbsp;<span class="op" id="8278462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278467">t</span><span class="op" id="8278468">.</span><span class="ident" id="8278469">Errorf</span><span class="op" id="8278475">(</span><span class="string" id="8278476">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="8278502">,</span>&nbsp;<span class="builtinfunc" id="8278504">len</span><span class="op" id="8278507">(</span><span class="ident" id="8278508">tt</span><span class="op" id="8278510">.</span><span class="ident" id="8278511">key</span><span class="op" id="8278514">)</span><span class="op" id="8278515">,</span>&nbsp;<span class="ident" id="8278517">err</span><span class="op" id="8278520">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278525">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278540">out</span>&nbsp;<span class="op" id="8278544">:=</span>&nbsp;<span class="builtinfunc" id="8278547">make</span><span class="op" id="8278551">(</span><span class="op" id="8278552">[</span><span class="op" id="8278553">]</span><span class="builtintype" id="8278554">byte</span><span class="op" id="8278558">,</span>&nbsp;<span class="builtinfunc" id="8278560">len</span><span class="op" id="8278563">(</span><span class="ident" id="8278564">tt</span><span class="op" id="8278566">.</span><span class="ident" id="8278567">in</span><span class="op" id="8278569">)</span><span class="op" id="8278570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278574">c</span><span class="op" id="8278575">.</span><span class="ident" id="8278576">Encrypt</span><span class="op" id="8278583">(</span><span class="ident" id="8278584">out</span><span class="op" id="8278587">,</span>&nbsp;<span class="ident" id="8278589">tt</span><span class="op" id="8278591">.</span><span class="ident" id="8278592">in</span><span class="op" id="8278594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278598">for</span>&nbsp;<span class="ident" id="8278602">j</span><span class="op" id="8278603">,</span>&nbsp;<span class="ident" id="8278605">v</span>&nbsp;<span class="op" id="8278607">:=</span>&nbsp;<span class="keyword" id="8278610">range</span>&nbsp;<span class="ident" id="8278616">out</span>&nbsp;<span class="op" id="8278620">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278625">if</span>&nbsp;<span class="ident" id="8278628">v</span>&nbsp;<span class="op" id="8278630">!=</span>&nbsp;<span class="ident" id="8278633">tt</span><span class="op" id="8278635">.</span><span class="ident" id="8278636">out</span><span class="op" id="8278639">[</span><span class="ident" id="8278640">j</span><span class="op" id="8278641">]</span>&nbsp;<span class="op" id="8278643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278649">t</span><span class="op" id="8278650">.</span><span class="ident" id="8278651">Errorf</span><span class="op" id="8278657">(</span><span class="string" id="8278658">&#34;Cipher.Encrypt&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8278702">,</span>&nbsp;<span class="ident" id="8278704">i</span><span class="op" id="8278705">,</span>&nbsp;<span class="ident" id="8278707">j</span><span class="op" id="8278708">,</span>&nbsp;<span class="ident" id="8278710">v</span><span class="op" id="8278711">,</span>&nbsp;<span class="ident" id="8278713">tt</span><span class="op" id="8278715">.</span><span class="ident" id="8278716">out</span><span class="op" id="8278719">[</span><span class="ident" id="8278720">j</span><span class="op" id="8278721">]</span><span class="op" id="8278722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278728">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278741">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278744">}</span><br>
<span class="lineno"></span><span class="op" id="8278746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8278749">//&nbsp;Test&nbsp;Cipher&nbsp;Decrypt&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="8278799">func</span>&nbsp;<span class="ident" id="8278804">TestCipherDecrypt</span><span class="op" id="8278821">(</span><span class="ident" id="8278822">t</span>&nbsp;<span class="op" id="8278824">*</span><span class="ident" id="8278825">testing</span><span class="op" id="8278832">.</span><span class="ident" id="8278833">T</span><span class="op" id="8278834">)</span>&nbsp;<span class="op" id="8278836">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278839">for</span>&nbsp;<span class="ident" id="8278843">i</span><span class="op" id="8278844">,</span>&nbsp;<span class="ident" id="8278846">tt</span>&nbsp;<span class="op" id="8278849">:=</span>&nbsp;<span class="keyword" id="8278852">range</span>&nbsp;<span class="ident" id="8278858">encryptTests</span>&nbsp;<span class="op" id="8278871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278875">c</span><span class="op" id="8278876">,</span>&nbsp;<span class="ident" id="8278878">err</span>&nbsp;<span class="op" id="8278882">:=</span>&nbsp;<span class="ident" id="8278885">NewCipher</span><span class="op" id="8278894">(</span><span class="ident" id="8278895">tt</span><span class="op" id="8278897">.</span><span class="ident" id="8278898">key</span><span class="op" id="8278901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278905">if</span>&nbsp;<span class="ident" id="8278908">err</span>&nbsp;<span class="op" id="8278912">!=</span>&nbsp;<span class="ident" id="8278915">nil</span>&nbsp;<span class="op" id="8278919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278924">t</span><span class="op" id="8278925">.</span><span class="ident" id="8278926">Errorf</span><span class="op" id="8278932">(</span><span class="string" id="8278933">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="8278959">,</span>&nbsp;<span class="builtinfunc" id="8278961">len</span><span class="op" id="8278964">(</span><span class="ident" id="8278965">tt</span><span class="op" id="8278967">.</span><span class="ident" id="8278968">key</span><span class="op" id="8278971">)</span><span class="op" id="8278972">,</span>&nbsp;<span class="ident" id="8278974">err</span><span class="op" id="8278977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8278982">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8278993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8278997">plain</span>&nbsp;<span class="op" id="8279003">:=</span>&nbsp;<span class="builtinfunc" id="8279006">make</span><span class="op" id="8279010">(</span><span class="op" id="8279011">[</span><span class="op" id="8279012">]</span><span class="builtintype" id="8279013">byte</span><span class="op" id="8279017">,</span>&nbsp;<span class="builtinfunc" id="8279019">len</span><span class="op" id="8279022">(</span><span class="ident" id="8279023">tt</span><span class="op" id="8279025">.</span><span class="ident" id="8279026">in</span><span class="op" id="8279028">)</span><span class="op" id="8279029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279033">c</span><span class="op" id="8279034">.</span><span class="ident" id="8279035">Decrypt</span><span class="op" id="8279042">(</span><span class="ident" id="8279043">plain</span><span class="op" id="8279048">,</span>&nbsp;<span class="ident" id="8279050">tt</span><span class="op" id="8279052">.</span><span class="ident" id="8279053">out</span><span class="op" id="8279056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8279060">for</span>&nbsp;<span class="ident" id="8279064">j</span><span class="op" id="8279065">,</span>&nbsp;<span class="ident" id="8279067">v</span>&nbsp;<span class="op" id="8279069">:=</span>&nbsp;<span class="keyword" id="8279072">range</span>&nbsp;<span class="ident" id="8279078">plain</span>&nbsp;<span class="op" id="8279084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8279089">if</span>&nbsp;<span class="ident" id="8279092">v</span>&nbsp;<span class="op" id="8279094">!=</span>&nbsp;<span class="ident" id="8279097">tt</span><span class="op" id="8279099">.</span><span class="ident" id="8279100">in</span><span class="op" id="8279102">[</span><span class="ident" id="8279103">j</span><span class="op" id="8279104">]</span>&nbsp;<span class="op" id="8279106">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279112">t</span><span class="op" id="8279113">.</span><span class="ident" id="8279114">Errorf</span><span class="op" id="8279120">(</span><span class="string" id="8279121">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="8279165">,</span>&nbsp;<span class="ident" id="8279167">i</span><span class="op" id="8279168">,</span>&nbsp;<span class="ident" id="8279170">j</span><span class="op" id="8279171">,</span>&nbsp;<span class="ident" id="8279173">v</span><span class="op" id="8279174">,</span>&nbsp;<span class="ident" id="8279176">tt</span><span class="op" id="8279178">.</span><span class="ident" id="8279179">in</span><span class="op" id="8279181">[</span><span class="ident" id="8279182">j</span><span class="op" id="8279183">]</span><span class="op" id="8279184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8279190">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8279199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8279203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8279206">}</span><br>
<span class="lineno">355</span><span class="op" id="8279208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8279211">//&nbsp;Test&nbsp;short&nbsp;input/output.</span><br>
<span class="lineno"></span><span class="comment" id="8279239">//&nbsp;Assembly&nbsp;used&nbsp;to&nbsp;not&nbsp;notice.</span><br>
<span class="lineno"></span><span class="comment" id="8279271">//&nbsp;See&nbsp;issue&nbsp;7928.</span><br>
<span class="lineno">360</span><span class="keyword" id="8279290">func</span>&nbsp;<span class="ident" id="8279295">TestShortBlocks</span><span class="op" id="8279310">(</span><span class="ident" id="8279311">t</span>&nbsp;<span class="op" id="8279313">*</span><span class="ident" id="8279314">testing</span><span class="op" id="8279321">.</span><span class="ident" id="8279322">T</span><span class="op" id="8279323">)</span>&nbsp;<span class="op" id="8279325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279328">bytes</span>&nbsp;<span class="op" id="8279334">:=</span>&nbsp;<span class="keyword" id="8279337">func</span><span class="op" id="8279341">(</span><span class="ident" id="8279342">n</span>&nbsp;<span class="builtintype" id="8279344">int</span><span class="op" id="8279347">)</span>&nbsp;<span class="op" id="8279349">[</span><span class="op" id="8279350">]</span><span class="builtintype" id="8279351">byte</span>&nbsp;<span class="op" id="8279356">{</span>&nbsp;<span class="keyword" id="8279358">return</span>&nbsp;<span class="builtinfunc" id="8279365">make</span><span class="op" id="8279369">(</span><span class="op" id="8279370">[</span><span class="op" id="8279371">]</span><span class="builtintype" id="8279372">byte</span><span class="op" id="8279376">,</span>&nbsp;<span class="ident" id="8279378">n</span><span class="op" id="8279379">)</span>&nbsp;<span class="op" id="8279381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279385">c</span><span class="op" id="8279386">,</span>&nbsp;<span class="ident" id="8279388">_</span>&nbsp;<span class="op" id="8279390">:=</span>&nbsp;<span class="ident" id="8279393">NewCipher</span><span class="op" id="8279402">(</span><span class="ident" id="8279403">bytes</span><span class="op" id="8279408">(</span><span class="num" id="8279409">16</span><span class="op" id="8279411">)</span><span class="op" id="8279412">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279416">mustPanic</span><span class="op" id="8279425">(</span><span class="ident" id="8279426">t</span><span class="op" id="8279427">,</span>&nbsp;<span class="string" id="8279429">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8279463">,</span>&nbsp;<span class="keyword" id="8279465">func</span><span class="op" id="8279469">(</span><span class="op" id="8279470">)</span>&nbsp;<span class="op" id="8279472">{</span>&nbsp;<span class="ident" id="8279474">c</span><span class="op" id="8279475">.</span><span class="ident" id="8279476">Encrypt</span><span class="op" id="8279483">(</span><span class="ident" id="8279484">bytes</span><span class="op" id="8279489">(</span><span class="num" id="8279490">1</span><span class="op" id="8279491">)</span><span class="op" id="8279492">,</span>&nbsp;<span class="ident" id="8279494">bytes</span><span class="op" id="8279499">(</span><span class="num" id="8279500">1</span><span class="op" id="8279501">)</span><span class="op" id="8279502">)</span>&nbsp;<span class="op" id="8279504">}</span><span class="op" id="8279505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279508">mustPanic</span><span class="op" id="8279517">(</span><span class="ident" id="8279518">t</span><span class="op" id="8279519">,</span>&nbsp;<span class="string" id="8279521">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8279555">,</span>&nbsp;<span class="keyword" id="8279557">func</span><span class="op" id="8279561">(</span><span class="op" id="8279562">)</span>&nbsp;<span class="op" id="8279564">{</span>&nbsp;<span class="ident" id="8279566">c</span><span class="op" id="8279567">.</span><span class="ident" id="8279568">Decrypt</span><span class="op" id="8279575">(</span><span class="ident" id="8279576">bytes</span><span class="op" id="8279581">(</span><span class="num" id="8279582">1</span><span class="op" id="8279583">)</span><span class="op" id="8279584">,</span>&nbsp;<span class="ident" id="8279586">bytes</span><span class="op" id="8279591">(</span><span class="num" id="8279592">1</span><span class="op" id="8279593">)</span><span class="op" id="8279594">)</span>&nbsp;<span class="op" id="8279596">}</span><span class="op" id="8279597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279600">mustPanic</span><span class="op" id="8279609">(</span><span class="ident" id="8279610">t</span><span class="op" id="8279611">,</span>&nbsp;<span class="string" id="8279613">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8279647">,</span>&nbsp;<span class="keyword" id="8279649">func</span><span class="op" id="8279653">(</span><span class="op" id="8279654">)</span>&nbsp;<span class="op" id="8279656">{</span>&nbsp;<span class="ident" id="8279658">c</span><span class="op" id="8279659">.</span><span class="ident" id="8279660">Encrypt</span><span class="op" id="8279667">(</span><span class="ident" id="8279668">bytes</span><span class="op" id="8279673">(</span><span class="num" id="8279674">100</span><span class="op" id="8279677">)</span><span class="op" id="8279678">,</span>&nbsp;<span class="ident" id="8279680">bytes</span><span class="op" id="8279685">(</span><span class="num" id="8279686">1</span><span class="op" id="8279687">)</span><span class="op" id="8279688">)</span>&nbsp;<span class="op" id="8279690">}</span><span class="op" id="8279691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279694">mustPanic</span><span class="op" id="8279703">(</span><span class="ident" id="8279704">t</span><span class="op" id="8279705">,</span>&nbsp;<span class="string" id="8279707">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8279741">,</span>&nbsp;<span class="keyword" id="8279743">func</span><span class="op" id="8279747">(</span><span class="op" id="8279748">)</span>&nbsp;<span class="op" id="8279750">{</span>&nbsp;<span class="ident" id="8279752">c</span><span class="op" id="8279753">.</span><span class="ident" id="8279754">Decrypt</span><span class="op" id="8279761">(</span><span class="ident" id="8279762">bytes</span><span class="op" id="8279767">(</span><span class="num" id="8279768">100</span><span class="op" id="8279771">)</span><span class="op" id="8279772">,</span>&nbsp;<span class="ident" id="8279774">bytes</span><span class="op" id="8279779">(</span><span class="num" id="8279780">1</span><span class="op" id="8279781">)</span><span class="op" id="8279782">)</span>&nbsp;<span class="op" id="8279784">}</span><span class="op" id="8279785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279788">mustPanic</span><span class="op" id="8279797">(</span><span class="ident" id="8279798">t</span><span class="op" id="8279799">,</span>&nbsp;<span class="string" id="8279801">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8279836">,</span>&nbsp;<span class="keyword" id="8279838">func</span><span class="op" id="8279842">(</span><span class="op" id="8279843">)</span>&nbsp;<span class="op" id="8279845">{</span>&nbsp;<span class="ident" id="8279847">c</span><span class="op" id="8279848">.</span><span class="ident" id="8279849">Encrypt</span><span class="op" id="8279856">(</span><span class="ident" id="8279857">bytes</span><span class="op" id="8279862">(</span><span class="num" id="8279863">1</span><span class="op" id="8279864">)</span><span class="op" id="8279865">,</span>&nbsp;<span class="ident" id="8279867">bytes</span><span class="op" id="8279872">(</span><span class="num" id="8279873">100</span><span class="op" id="8279876">)</span><span class="op" id="8279877">)</span>&nbsp;<span class="op" id="8279879">}</span><span class="op" id="8279880">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8279883">mustPanic</span><span class="op" id="8279892">(</span><span class="ident" id="8279893">t</span><span class="op" id="8279894">,</span>&nbsp;<span class="string" id="8279896">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="8279931">,</span>&nbsp;<span class="keyword" id="8279933">func</span><span class="op" id="8279937">(</span><span class="op" id="8279938">)</span>&nbsp;<span class="op" id="8279940">{</span>&nbsp;<span class="ident" id="8279942">c</span><span class="op" id="8279943">.</span><span class="ident" id="8279944">Decrypt</span><span class="op" id="8279951">(</span><span class="ident" id="8279952">bytes</span><span class="op" id="8279957">(</span><span class="num" id="8279958">1</span><span class="op" id="8279959">)</span><span class="op" id="8279960">,</span>&nbsp;<span class="ident" id="8279962">bytes</span><span class="op" id="8279967">(</span><span class="num" id="8279968">100</span><span class="op" id="8279971">)</span><span class="op" id="8279972">)</span>&nbsp;<span class="op" id="8279974">}</span><span class="op" id="8279975">)</span><br>
<span class="lineno"></span><span class="op" id="8279977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8279980">func</span>&nbsp;<span class="ident" id="8279985">mustPanic</span><span class="op" id="8279994">(</span><span class="ident" id="8279995">t</span>&nbsp;<span class="op" id="8279997">*</span><span class="ident" id="8279998">testing</span><span class="op" id="8280005">.</span><span class="ident" id="8280006">T</span><span class="op" id="8280007">,</span>&nbsp;<span class="ident" id="8280009">msg</span>&nbsp;<span class="builtintype" id="8280013">string</span><span class="op" id="8280019">,</span>&nbsp;<span class="ident" id="8280021">f</span>&nbsp;<span class="keyword" id="8280023">func</span><span class="op" id="8280027">(</span><span class="op" id="8280028">)</span><span class="op" id="8280029">)</span>&nbsp;<span class="op" id="8280031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8280034">defer</span>&nbsp;<span class="keyword" id="8280040">func</span><span class="op" id="8280044">(</span><span class="op" id="8280045">)</span>&nbsp;<span class="op" id="8280047">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280051">err</span>&nbsp;<span class="op" id="8280055">:=</span>&nbsp;<span class="builtinfunc" id="8280058">recover</span><span class="op" id="8280065">(</span><span class="op" id="8280066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8280070">if</span>&nbsp;<span class="ident" id="8280073">err</span>&nbsp;<span class="op" id="8280077">==</span>&nbsp;<span class="ident" id="8280080">nil</span>&nbsp;<span class="op" id="8280084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280089">t</span><span class="op" id="8280090">.</span><span class="ident" id="8280091">Errorf</span><span class="op" id="8280097">(</span><span class="string" id="8280098">&#34;function&nbsp;did&nbsp;not&nbsp;panic,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="8280133">,</span>&nbsp;<span class="ident" id="8280135">msg</span><span class="op" id="8280138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8280142">}</span>&nbsp;<span class="keyword" id="8280144">else</span>&nbsp;<span class="keyword" id="8280149">if</span>&nbsp;<span class="ident" id="8280152">err</span>&nbsp;<span class="op" id="8280156">!=</span>&nbsp;<span class="ident" id="8280159">msg</span>&nbsp;<span class="op" id="8280163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280168">t</span><span class="op" id="8280169">.</span><span class="ident" id="8280170">Errorf</span><span class="op" id="8280176">(</span><span class="string" id="8280177">&#34;got&nbsp;panic&nbsp;%v,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="8280202">,</span>&nbsp;<span class="ident" id="8280204">err</span><span class="op" id="8280207">,</span>&nbsp;<span class="ident" id="8280209">msg</span><span class="op" id="8280212">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8280216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8280219">}</span><span class="op" id="8280220">(</span><span class="op" id="8280221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280224">f</span><span class="op" id="8280225">(</span><span class="op" id="8280226">)</span><br>
<span class="lineno"></span><span class="op" id="8280228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="8280231">func</span>&nbsp;<span class="ident" id="8280236">BenchmarkEncrypt</span><span class="op" id="8280252">(</span><span class="ident" id="8280253">b</span>&nbsp;<span class="op" id="8280255">*</span><span class="ident" id="8280256">testing</span><span class="op" id="8280263">.</span><span class="ident" id="8280264">B</span><span class="op" id="8280265">)</span>&nbsp;<span class="op" id="8280267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280270">tt</span>&nbsp;<span class="op" id="8280273">:=</span>&nbsp;<span class="ident" id="8280276">encryptTests</span><span class="op" id="8280288">[</span><span class="num" id="8280289">0</span><span class="op" id="8280290">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280293">c</span><span class="op" id="8280294">,</span>&nbsp;<span class="ident" id="8280296">err</span>&nbsp;<span class="op" id="8280300">:=</span>&nbsp;<span class="ident" id="8280303">NewCipher</span><span class="op" id="8280312">(</span><span class="ident" id="8280313">tt</span><span class="op" id="8280315">.</span><span class="ident" id="8280316">key</span><span class="op" id="8280319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8280322">if</span>&nbsp;<span class="ident" id="8280325">err</span>&nbsp;<span class="op" id="8280329">!=</span>&nbsp;<span class="ident" id="8280332">nil</span>&nbsp;<span class="op" id="8280336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280340">b</span><span class="op" id="8280341">.</span><span class="ident" id="8280342">Fatal</span><span class="op" id="8280347">(</span><span class="string" id="8280348">&#34;NewCipher:&#34;</span><span class="op" id="8280360">,</span>&nbsp;<span class="ident" id="8280362">err</span><span class="op" id="8280365">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8280368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280371">out</span>&nbsp;<span class="op" id="8280375">:=</span>&nbsp;<span class="builtinfunc" id="8280378">make</span><span class="op" id="8280382">(</span><span class="op" id="8280383">[</span><span class="op" id="8280384">]</span><span class="builtintype" id="8280385">byte</span><span class="op" id="8280389">,</span>&nbsp;<span class="builtinfunc" id="8280391">len</span><span class="op" id="8280394">(</span><span class="ident" id="8280395">tt</span><span class="op" id="8280397">.</span><span class="ident" id="8280398">in</span><span class="op" id="8280400">)</span><span class="op" id="8280401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280404">b</span><span class="op" id="8280405">.</span><span class="ident" id="8280406">SetBytes</span><span class="op" id="8280414">(</span><span class="ident" id="8280415">int64</span><span class="op" id="8280420">(</span><span class="builtinfunc" id="8280421">len</span><span class="op" id="8280424">(</span><span class="ident" id="8280425">out</span><span class="op" id="8280428">)</span><span class="op" id="8280429">)</span><span class="op" id="8280430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280433">b</span><span class="op" id="8280434">.</span><span class="ident" id="8280435">ResetTimer</span><span class="op" id="8280445">(</span><span class="op" id="8280446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8280449">for</span>&nbsp;<span class="ident" id="8280453">i</span>&nbsp;<span class="op" id="8280455">:=</span>&nbsp;<span class="num" id="8280458">0</span><span class="op" id="8280459">;</span>&nbsp;<span class="ident" id="8280461">i</span>&nbsp;<span class="op" id="8280463">&lt;</span>&nbsp;<span class="ident" id="8280465">b</span><span class="op" id="8280466">.</span><span class="ident" id="8280467">N</span><span class="op" id="8280468">;</span>&nbsp;<span class="ident" id="8280470">i</span><span class="op" id="8280471">++</span>&nbsp;<span class="op" id="8280474">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280478">c</span><span class="op" id="8280479">.</span><span class="ident" id="8280480">Encrypt</span><span class="op" id="8280487">(</span><span class="ident" id="8280488">out</span><span class="op" id="8280491">,</span>&nbsp;<span class="ident" id="8280493">tt</span><span class="op" id="8280495">.</span><span class="ident" id="8280496">in</span><span class="op" id="8280498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8280501">}</span><br>
<span class="lineno"></span><span class="op" id="8280503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8280506">func</span>&nbsp;<span class="ident" id="8280511">BenchmarkDecrypt</span><span class="op" id="8280527">(</span><span class="ident" id="8280528">b</span>&nbsp;<span class="op" id="8280530">*</span><span class="ident" id="8280531">testing</span><span class="op" id="8280538">.</span><span class="ident" id="8280539">B</span><span class="op" id="8280540">)</span>&nbsp;<span class="op" id="8280542">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280545">tt</span>&nbsp;<span class="op" id="8280548">:=</span>&nbsp;<span class="ident" id="8280551">encryptTests</span><span class="op" id="8280563">[</span><span class="num" id="8280564">0</span><span class="op" id="8280565">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280568">c</span><span class="op" id="8280569">,</span>&nbsp;<span class="ident" id="8280571">err</span>&nbsp;<span class="op" id="8280575">:=</span>&nbsp;<span class="ident" id="8280578">NewCipher</span><span class="op" id="8280587">(</span><span class="ident" id="8280588">tt</span><span class="op" id="8280590">.</span><span class="ident" id="8280591">key</span><span class="op" id="8280594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8280597">if</span>&nbsp;<span class="ident" id="8280600">err</span>&nbsp;<span class="op" id="8280604">!=</span>&nbsp;<span class="ident" id="8280607">nil</span>&nbsp;<span class="op" id="8280611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280615">b</span><span class="op" id="8280616">.</span><span class="ident" id="8280617">Fatal</span><span class="op" id="8280622">(</span><span class="string" id="8280623">&#34;NewCipher:&#34;</span><span class="op" id="8280635">,</span>&nbsp;<span class="ident" id="8280637">err</span><span class="op" id="8280640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8280643">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280646">out</span>&nbsp;<span class="op" id="8280650">:=</span>&nbsp;<span class="builtinfunc" id="8280653">make</span><span class="op" id="8280657">(</span><span class="op" id="8280658">[</span><span class="op" id="8280659">]</span><span class="builtintype" id="8280660">byte</span><span class="op" id="8280664">,</span>&nbsp;<span class="builtinfunc" id="8280666">len</span><span class="op" id="8280669">(</span><span class="ident" id="8280670">tt</span><span class="op" id="8280672">.</span><span class="ident" id="8280673">out</span><span class="op" id="8280676">)</span><span class="op" id="8280677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280680">b</span><span class="op" id="8280681">.</span><span class="ident" id="8280682">SetBytes</span><span class="op" id="8280690">(</span><span class="ident" id="8280691">int64</span><span class="op" id="8280696">(</span><span class="builtinfunc" id="8280697">len</span><span class="op" id="8280700">(</span><span class="ident" id="8280701">out</span><span class="op" id="8280704">)</span><span class="op" id="8280705">)</span><span class="op" id="8280706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280709">b</span><span class="op" id="8280710">.</span><span class="ident" id="8280711">ResetTimer</span><span class="op" id="8280721">(</span><span class="op" id="8280722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8280725">for</span>&nbsp;<span class="ident" id="8280729">i</span>&nbsp;<span class="op" id="8280731">:=</span>&nbsp;<span class="num" id="8280734">0</span><span class="op" id="8280735">;</span>&nbsp;<span class="ident" id="8280737">i</span>&nbsp;<span class="op" id="8280739">&lt;</span>&nbsp;<span class="ident" id="8280741">b</span><span class="op" id="8280742">.</span><span class="ident" id="8280743">N</span><span class="op" id="8280744">;</span>&nbsp;<span class="ident" id="8280746">i</span><span class="op" id="8280747">++</span>&nbsp;<span class="op" id="8280750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280754">c</span><span class="op" id="8280755">.</span><span class="ident" id="8280756">Decrypt</span><span class="op" id="8280763">(</span><span class="ident" id="8280764">out</span><span class="op" id="8280767">,</span>&nbsp;<span class="ident" id="8280769">tt</span><span class="op" id="8280771">.</span><span class="ident" id="8280772">out</span><span class="op" id="8280775">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8280778">}</span><br>
<span class="lineno"></span><span class="op" id="8280780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8280783">func</span>&nbsp;<span class="ident" id="8280788">BenchmarkExpand</span><span class="op" id="8280803">(</span><span class="ident" id="8280804">b</span>&nbsp;<span class="op" id="8280806">*</span><span class="ident" id="8280807">testing</span><span class="op" id="8280814">.</span><span class="ident" id="8280815">B</span><span class="op" id="8280816">)</span>&nbsp;<span class="op" id="8280818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280821">tt</span>&nbsp;<span class="op" id="8280824">:=</span>&nbsp;<span class="ident" id="8280827">encryptTests</span><span class="op" id="8280839">[</span><span class="num" id="8280840">0</span><span class="op" id="8280841">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280844">n</span>&nbsp;<span class="op" id="8280846">:=</span>&nbsp;<span class="builtinfunc" id="8280849">len</span><span class="op" id="8280852">(</span><span class="ident" id="8280853">tt</span><span class="op" id="8280855">.</span><span class="ident" id="8280856">key</span><span class="op" id="8280859">)</span>&nbsp;<span class="op" id="8280861">+</span>&nbsp;<span class="num" id="8280863">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280867">c</span>&nbsp;<span class="op" id="8280869">:=</span>&nbsp;<span class="op" id="8280872">&amp;</span><span class="ident" id="8280873">aesCipher</span><span class="op" id="8280882">{</span><span class="builtinfunc" id="8280883">make</span><span class="op" id="8280887">(</span><span class="op" id="8280888">[</span><span class="op" id="8280889">]</span><span class="builtintype" id="8280890">uint32</span><span class="op" id="8280896">,</span>&nbsp;<span class="ident" id="8280898">n</span><span class="op" id="8280899">)</span><span class="op" id="8280900">,</span>&nbsp;<span class="builtinfunc" id="8280902">make</span><span class="op" id="8280906">(</span><span class="op" id="8280907">[</span><span class="op" id="8280908">]</span><span class="builtintype" id="8280909">uint32</span><span class="op" id="8280915">,</span>&nbsp;<span class="ident" id="8280917">n</span><span class="op" id="8280918">)</span><span class="op" id="8280919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280922">b</span><span class="op" id="8280923">.</span><span class="ident" id="8280924">ResetTimer</span><span class="op" id="8280934">(</span><span class="op" id="8280935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8280938">for</span>&nbsp;<span class="ident" id="8280942">i</span>&nbsp;<span class="op" id="8280944">:=</span>&nbsp;<span class="num" id="8280947">0</span><span class="op" id="8280948">;</span>&nbsp;<span class="ident" id="8280950">i</span>&nbsp;<span class="op" id="8280952">&lt;</span>&nbsp;<span class="ident" id="8280954">b</span><span class="op" id="8280955">.</span><span class="ident" id="8280956">N</span><span class="op" id="8280957">;</span>&nbsp;<span class="ident" id="8280959">i</span><span class="op" id="8280960">++</span>&nbsp;<span class="op" id="8280963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8280967">expandKey</span><span class="op" id="8280976">(</span><span class="ident" id="8280977">tt</span><span class="op" id="8280979">.</span><span class="ident" id="8280980">key</span><span class="op" id="8280983">,</span>&nbsp;<span class="ident" id="8280985">c</span><span class="op" id="8280986">.</span><span class="ident" id="8280987">enc</span><span class="op" id="8280990">,</span>&nbsp;<span class="ident" id="8280992">c</span><span class="op" id="8280993">.</span><span class="ident" id="8280994">dec</span><span class="op" id="8280997">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8281000">}</span><br>
<span class="lineno"></span><span class="op" id="8281002">}</span>
</div>
</body>
</html>
