<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7336661">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7336717">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7336771">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7336822">package</span>&nbsp;<span class="ident" id="7336830">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7336836">import</span>&nbsp;<span class="op" id="7336843">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7336846">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7336855">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7336864">&#34;compress/gzip&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7336881">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7336896">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7336903">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7336909">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7336922">&#34;net/http/internal&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7336943">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7336954">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7336965">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7336975">&#34;strings&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7336986">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7336996">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7336999">type</span>&nbsp;<span class="ident" id="7337004">respTest</span>&nbsp;<span class="keyword" id="7337013">struct</span>&nbsp;<span class="op" id="7337020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337023">Raw</span>&nbsp;&nbsp;<span class="builtintype" id="7337028">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337036">Resp</span>&nbsp;<span class="ident" id="7337041">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337051">Body</span>&nbsp;<span class="builtintype" id="7337056">string</span><br>
<span class="lineno"></span><span class="op" id="7337063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7337066">func</span>&nbsp;<span class="ident" id="7337071">dummyReq</span><span class="op" id="7337079">(</span><span class="ident" id="7337080">method</span>&nbsp;<span class="builtintype" id="7337087">string</span><span class="op" id="7337093">)</span>&nbsp;<span class="op" id="7337095">*</span><span class="ident" id="7337096">Request</span>&nbsp;<span class="op" id="7337104">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7337107">return</span>&nbsp;<span class="op" id="7337114">&amp;</span><span class="ident" id="7337115">Request</span><span class="op" id="7337122">{</span><span class="ident" id="7337123">Method</span><span class="op" id="7337129">:</span>&nbsp;<span class="ident" id="7337131">method</span><span class="op" id="7337137">}</span><br>
<span class="lineno"></span><span class="op" id="7337139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7337142">func</span>&nbsp;<span class="ident" id="7337147">dummyReq11</span><span class="op" id="7337157">(</span><span class="ident" id="7337158">method</span>&nbsp;<span class="builtintype" id="7337165">string</span><span class="op" id="7337171">)</span>&nbsp;<span class="op" id="7337173">*</span><span class="ident" id="7337174">Request</span>&nbsp;<span class="op" id="7337182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7337185">return</span>&nbsp;<span class="op" id="7337192">&amp;</span><span class="ident" id="7337193">Request</span><span class="op" id="7337200">{</span><span class="ident" id="7337201">Method</span><span class="op" id="7337207">:</span>&nbsp;<span class="ident" id="7337209">method</span><span class="op" id="7337215">,</span>&nbsp;<span class="ident" id="7337217">Proto</span><span class="op" id="7337222">:</span>&nbsp;<span class="string" id="7337224">&#34;HTTP/1.1&#34;</span><span class="op" id="7337234">,</span>&nbsp;<span class="ident" id="7337236">ProtoMajor</span><span class="op" id="7337246">:</span>&nbsp;<span class="num" id="7337248">1</span><span class="op" id="7337249">,</span>&nbsp;<span class="ident" id="7337251">ProtoMinor</span><span class="op" id="7337261">:</span>&nbsp;<span class="num" id="7337263">1</span><span class="op" id="7337264">}</span><br>
<span class="lineno">35</span><span class="op" id="7337266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7337269">var</span>&nbsp;<span class="ident" id="7337273">respTests</span>&nbsp;<span class="op" id="7337283">=</span>&nbsp;<span class="op" id="7337285">[</span><span class="op" id="7337286">]</span><span class="ident" id="7337287">respTest</span><span class="op" id="7337295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7337298">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7337345">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7337349">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7337371">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7337376">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7337400">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7337405">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7337412">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7337417">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7337430">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337435">Response</span><span class="op" id="7337443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337448">Status</span><span class="op" id="7337454">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337460">&#34;200&nbsp;OK&#34;</span><span class="op" id="7337468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337473">StatusCode</span><span class="op" id="7337483">:</span>&nbsp;<span class="num" id="7337485">200</span><span class="op" id="7337488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337493">Proto</span><span class="op" id="7337498">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337505">&#34;HTTP/1.0&#34;</span><span class="op" id="7337515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337520">ProtoMajor</span><span class="op" id="7337530">:</span>&nbsp;<span class="num" id="7337532">1</span><span class="op" id="7337533">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337538">ProtoMinor</span><span class="op" id="7337548">:</span>&nbsp;<span class="num" id="7337550">0</span><span class="op" id="7337551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337556">Request</span><span class="op" id="7337563">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7337568">dummyReq</span><span class="op" id="7337576">(</span><span class="string" id="7337577">&#34;GET&#34;</span><span class="op" id="7337582">)</span><span class="op" id="7337583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337588">Header</span><span class="op" id="7337594">:</span>&nbsp;<span class="ident" id="7337596">Header</span><span class="op" id="7337602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7337608">&#34;Connection&#34;</span><span class="op" id="7337620">:</span>&nbsp;<span class="op" id="7337622">{</span><span class="string" id="7337623">&#34;close&#34;</span><span class="op" id="7337630">}</span><span class="op" id="7337631">,</span>&nbsp;<span class="comment" id="7337633">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7337658">}</span><span class="op" id="7337659">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337664">Close</span><span class="op" id="7337669">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7337679">true</span><span class="op" id="7337683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337688">ContentLength</span><span class="op" id="7337701">:</span>&nbsp;<span class="op" id="7337703">-</span><span class="num" id="7337704">1</span><span class="op" id="7337705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7337709">}</span><span class="op" id="7337710">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7337715">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7337728">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7337731">}</span><span class="op" id="7337732">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7337736">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;response&nbsp;without&nbsp;Content-Length&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7337794">//&nbsp;Connection&nbsp;headers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7337818">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7337822">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7337844">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7337849">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7337856">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7337861">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7337874">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337879">Response</span><span class="op" id="7337887">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337892">Status</span><span class="op" id="7337898">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337907">&#34;200&nbsp;OK&#34;</span><span class="op" id="7337915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337920">StatusCode</span><span class="op" id="7337930">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7337935">200</span><span class="op" id="7337938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337943">Proto</span><span class="op" id="7337948">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7337958">&#34;HTTP/1.1&#34;</span><span class="op" id="7337968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337973">ProtoMajor</span><span class="op" id="7337983">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7337988">1</span><span class="op" id="7337989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7337994">ProtoMinor</span><span class="op" id="7338004">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7338009">1</span><span class="op" id="7338010">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338015">Header</span><span class="op" id="7338021">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338030">Header</span><span class="op" id="7338036">{</span><span class="op" id="7338037">}</span><span class="op" id="7338038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338043">Request</span><span class="op" id="7338050">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338058">dummyReq</span><span class="op" id="7338066">(</span><span class="string" id="7338067">&#34;GET&#34;</span><span class="op" id="7338072">)</span><span class="op" id="7338073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338078">Close</span><span class="op" id="7338083">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7338093">true</span><span class="op" id="7338097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338102">ContentLength</span><span class="op" id="7338115">:</span>&nbsp;<span class="op" id="7338117">-</span><span class="num" id="7338118">1</span><span class="op" id="7338119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7338123">}</span><span class="op" id="7338124">,</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7338129">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7338142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7338145">}</span><span class="op" id="7338146">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7338150">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;204&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7338210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7338214">&#34;HTTP/1.1&nbsp;204&nbsp;No&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="7338244">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7338249">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7338256">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7338261">&#34;Body&nbsp;should&nbsp;not&nbsp;be&nbsp;read!\n&#34;</span><span class="op" id="7338289">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338294">Response</span><span class="op" id="7338302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338307">Status</span><span class="op" id="7338313">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338322">&#34;204&nbsp;No&nbsp;Content&#34;</span><span class="op" id="7338338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338343">StatusCode</span><span class="op" id="7338353">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7338358">204</span><span class="op" id="7338361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338366">Proto</span><span class="op" id="7338371">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338381">&#34;HTTP/1.1&#34;</span><span class="op" id="7338391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338396">ProtoMajor</span><span class="op" id="7338406">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7338411">1</span><span class="op" id="7338412">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338417">ProtoMinor</span><span class="op" id="7338427">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7338432">1</span><span class="op" id="7338433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338438">Header</span><span class="op" id="7338444">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338453">Header</span><span class="op" id="7338459">{</span><span class="op" id="7338460">}</span><span class="op" id="7338461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338466">Request</span><span class="op" id="7338473">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338481">dummyReq</span><span class="op" id="7338489">(</span><span class="string" id="7338490">&#34;GET&#34;</span><span class="op" id="7338495">)</span><span class="op" id="7338496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338501">Close</span><span class="op" id="7338506">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7338516">false</span><span class="op" id="7338521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338526">ContentLength</span><span class="op" id="7338539">:</span>&nbsp;<span class="num" id="7338541">0</span><span class="op" id="7338542">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7338546">}</span><span class="op" id="7338547">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7338552">&#34;&#34;</span><span class="op" id="7338554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7338557">}</span><span class="op" id="7338558">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7338562">//&nbsp;Unchunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7338606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7338610">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7338632">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7338637">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="7338662">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7338667">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7338691">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7338696">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7338703">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7338708">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7338721">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338726">Response</span><span class="op" id="7338734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338739">Status</span><span class="op" id="7338745">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338751">&#34;200&nbsp;OK&#34;</span><span class="op" id="7338759">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338764">StatusCode</span><span class="op" id="7338774">:</span>&nbsp;<span class="num" id="7338776">200</span><span class="op" id="7338779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338784">Proto</span><span class="op" id="7338789">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7338796">&#34;HTTP/1.0&#34;</span><span class="op" id="7338806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338811">ProtoMajor</span><span class="op" id="7338821">:</span>&nbsp;<span class="num" id="7338823">1</span><span class="op" id="7338824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338829">ProtoMinor</span><span class="op" id="7338839">:</span>&nbsp;<span class="num" id="7338841">0</span><span class="op" id="7338842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338847">Request</span><span class="op" id="7338854">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7338859">dummyReq</span><span class="op" id="7338867">(</span><span class="string" id="7338868">&#34;GET&#34;</span><span class="op" id="7338873">)</span><span class="op" id="7338874">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338879">Header</span><span class="op" id="7338885">:</span>&nbsp;<span class="ident" id="7338887">Header</span><span class="op" id="7338893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7338899">&#34;Connection&#34;</span><span class="op" id="7338911">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7338917">{</span><span class="string" id="7338918">&#34;close&#34;</span><span class="op" id="7338925">}</span><span class="op" id="7338926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7338932">&#34;Content-Length&#34;</span><span class="op" id="7338948">:</span>&nbsp;<span class="op" id="7338950">{</span><span class="string" id="7338951">&#34;10&#34;</span><span class="op" id="7338955">}</span><span class="op" id="7338956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7338961">}</span><span class="op" id="7338962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338967">Close</span><span class="op" id="7338972">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7338982">true</span><span class="op" id="7338986">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7338991">ContentLength</span><span class="op" id="7339004">:</span>&nbsp;<span class="num" id="7339006">10</span><span class="op" id="7339008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339012">}</span><span class="op" id="7339013">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339018">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7339031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339034">}</span><span class="op" id="7339035">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7339039">//&nbsp;Chunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339088">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7339110">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339115">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="7339148">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339153">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7339160">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339165">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="7339174">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339179">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="7339197">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339202">&#34;09\r\n&#34;</span>&nbsp;<span class="op" id="7339211">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339216">&#34;continued\r\n&#34;</span>&nbsp;<span class="op" id="7339232">+</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339237">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="7339245">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339250">&#34;\r\n&#34;</span><span class="op" id="7339256">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339261">Response</span><span class="op" id="7339269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339274">Status</span><span class="op" id="7339280">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339292">&#34;200&nbsp;OK&#34;</span><span class="op" id="7339300">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339305">StatusCode</span><span class="op" id="7339315">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7339323">200</span><span class="op" id="7339326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339331">Proto</span><span class="op" id="7339336">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339349">&#34;HTTP/1.1&#34;</span><span class="op" id="7339359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339364">ProtoMajor</span><span class="op" id="7339374">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7339382">1</span><span class="op" id="7339383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339388">ProtoMinor</span><span class="op" id="7339398">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7339406">1</span><span class="op" id="7339407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339412">Request</span><span class="op" id="7339419">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339430">dummyReq</span><span class="op" id="7339438">(</span><span class="string" id="7339439">&#34;GET&#34;</span><span class="op" id="7339444">)</span><span class="op" id="7339445">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339450">Header</span><span class="op" id="7339456">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339468">Header</span><span class="op" id="7339474">{</span><span class="op" id="7339475">}</span><span class="op" id="7339476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339481">Close</span><span class="op" id="7339486">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7339499">false</span><span class="op" id="7339504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339509">ContentLength</span><span class="op" id="7339522">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7339527">-</span><span class="num" id="7339528">1</span><span class="op" id="7339529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339534">TransferEncoding</span><span class="op" id="7339550">:</span>&nbsp;<span class="op" id="7339552">[</span><span class="op" id="7339553">]</span><span class="builtintype" id="7339554">string</span><span class="op" id="7339560">{</span><span class="string" id="7339561">&#34;chunked&#34;</span><span class="op" id="7339570">}</span><span class="op" id="7339571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339575">}</span><span class="op" id="7339576">,</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339581">&#34;Body&nbsp;here\ncontinued&#34;</span><span class="op" id="7339603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339606">}</span><span class="op" id="7339607">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7339611">//&nbsp;Chunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7339653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339657">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7339679">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339684">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="7339717">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339722">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="7339747">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339752">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7339759">+</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339764">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="7339773">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339778">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="7339796">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339801">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="7339809">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7339814">&#34;\r\n&#34;</span><span class="op" id="7339820">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339825">Response</span><span class="op" id="7339833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339838">Status</span><span class="op" id="7339844">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339856">&#34;200&nbsp;OK&#34;</span><span class="op" id="7339864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339869">StatusCode</span><span class="op" id="7339879">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7339887">200</span><span class="op" id="7339890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339895">Proto</span><span class="op" id="7339900">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7339913">&#34;HTTP/1.1&#34;</span><span class="op" id="7339923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339928">ProtoMajor</span><span class="op" id="7339938">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7339946">1</span><span class="op" id="7339947">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339952">ProtoMinor</span><span class="op" id="7339962">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7339970">1</span><span class="op" id="7339971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7339976">Request</span><span class="op" id="7339983">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7339994">dummyReq</span><span class="op" id="7340002">(</span><span class="string" id="7340003">&#34;GET&#34;</span><span class="op" id="7340008">)</span><span class="op" id="7340009">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340014">Header</span><span class="op" id="7340020">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340032">Header</span><span class="op" id="7340038">{</span><span class="op" id="7340039">}</span><span class="op" id="7340040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340045">Close</span><span class="op" id="7340050">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7340063">false</span><span class="op" id="7340068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340073">ContentLength</span><span class="op" id="7340086">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340091">-</span><span class="num" id="7340092">1</span><span class="op" id="7340093">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340098">TransferEncoding</span><span class="op" id="7340114">:</span>&nbsp;<span class="op" id="7340116">[</span><span class="op" id="7340117">]</span><span class="builtintype" id="7340118">string</span><span class="op" id="7340124">{</span><span class="string" id="7340125">&#34;chunked&#34;</span><span class="op" id="7340134">}</span><span class="op" id="7340135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7340139">}</span><span class="op" id="7340140">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7340145">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7340158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7340161">}</span><span class="op" id="7340162">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7340166">//&nbsp;Chunked&nbsp;response&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7340217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7340221">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7340243">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7340248">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="7340281">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7340286">&#34;\r\n&#34;</span><span class="op" id="7340292">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340297">Response</span><span class="op" id="7340305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340310">Status</span><span class="op" id="7340316">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7340328">&#34;200&nbsp;OK&#34;</span><span class="op" id="7340336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340341">StatusCode</span><span class="op" id="7340351">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7340359">200</span><span class="op" id="7340362">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340367">Proto</span><span class="op" id="7340372">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7340385">&#34;HTTP/1.1&#34;</span><span class="op" id="7340395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340400">ProtoMajor</span><span class="op" id="7340410">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7340418">1</span><span class="op" id="7340419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340424">ProtoMinor</span><span class="op" id="7340434">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7340442">1</span><span class="op" id="7340443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340448">Request</span><span class="op" id="7340455">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340466">dummyReq</span><span class="op" id="7340474">(</span><span class="string" id="7340475">&#34;HEAD&#34;</span><span class="op" id="7340481">)</span><span class="op" id="7340482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340487">Header</span><span class="op" id="7340493">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340505">Header</span><span class="op" id="7340511">{</span><span class="op" id="7340512">}</span><span class="op" id="7340513">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340518">TransferEncoding</span><span class="op" id="7340534">:</span>&nbsp;<span class="op" id="7340536">[</span><span class="op" id="7340537">]</span><span class="builtintype" id="7340538">string</span><span class="op" id="7340544">{</span><span class="string" id="7340545">&#34;chunked&#34;</span><span class="op" id="7340554">}</span><span class="op" id="7340555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340560">Close</span><span class="op" id="7340565">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7340578">false</span><span class="op" id="7340583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340588">ContentLength</span><span class="op" id="7340601">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7340606">-</span><span class="num" id="7340607">1</span><span class="op" id="7340608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7340612">}</span><span class="op" id="7340613">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7340618">&#34;&#34;</span><span class="op" id="7340620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7340623">}</span><span class="op" id="7340624">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7340628">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7340677">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7340681">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7340703">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7340708">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="7340734">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7340739">&#34;\r\n&#34;</span><span class="op" id="7340745">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340750">Response</span><span class="op" id="7340758">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340763">Status</span><span class="op" id="7340769">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7340781">&#34;200&nbsp;OK&#34;</span><span class="op" id="7340789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340794">StatusCode</span><span class="op" id="7340804">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7340812">200</span><span class="op" id="7340815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340820">Proto</span><span class="op" id="7340825">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7340838">&#34;HTTP/1.0&#34;</span><span class="op" id="7340848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340853">ProtoMajor</span><span class="op" id="7340863">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7340871">1</span><span class="op" id="7340872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340877">ProtoMinor</span><span class="op" id="7340887">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7340895">0</span><span class="op" id="7340896">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340901">Request</span><span class="op" id="7340908">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340919">dummyReq</span><span class="op" id="7340927">(</span><span class="string" id="7340928">&#34;HEAD&#34;</span><span class="op" id="7340934">)</span><span class="op" id="7340935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340940">Header</span><span class="op" id="7340946">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7340958">Header</span><span class="op" id="7340964">{</span><span class="string" id="7340965">&#34;Content-Length&#34;</span><span class="op" id="7340981">:</span>&nbsp;<span class="op" id="7340983">{</span><span class="string" id="7340984">&#34;256&#34;</span><span class="op" id="7340989">}</span><span class="op" id="7340990">}</span><span class="op" id="7340991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7340996">TransferEncoding</span><span class="op" id="7341012">:</span>&nbsp;<span class="ident" id="7341014">nil</span><span class="op" id="7341017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341022">Close</span><span class="op" id="7341027">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7341040">true</span><span class="op" id="7341044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341049">ContentLength</span><span class="op" id="7341062">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7341067">256</span><span class="op" id="7341070">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7341074">}</span><span class="op" id="7341075">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7341080">&#34;&#34;</span><span class="op" id="7341082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7341085">}</span><span class="op" id="7341086">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7341090">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request&nbsp;with&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7341153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7341157">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7341179">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7341184">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="7341210">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7341215">&#34;\r\n&#34;</span><span class="op" id="7341221">,</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341226">Response</span><span class="op" id="7341234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341239">Status</span><span class="op" id="7341245">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7341257">&#34;200&nbsp;OK&#34;</span><span class="op" id="7341265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341270">StatusCode</span><span class="op" id="7341280">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7341288">200</span><span class="op" id="7341291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341296">Proto</span><span class="op" id="7341301">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7341314">&#34;HTTP/1.1&#34;</span><span class="op" id="7341324">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341329">ProtoMajor</span><span class="op" id="7341339">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7341347">1</span><span class="op" id="7341348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341353">ProtoMinor</span><span class="op" id="7341363">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7341371">1</span><span class="op" id="7341372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341377">Request</span><span class="op" id="7341384">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341395">dummyReq</span><span class="op" id="7341403">(</span><span class="string" id="7341404">&#34;HEAD&#34;</span><span class="op" id="7341410">)</span><span class="op" id="7341411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341416">Header</span><span class="op" id="7341422">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341434">Header</span><span class="op" id="7341440">{</span><span class="string" id="7341441">&#34;Content-Length&#34;</span><span class="op" id="7341457">:</span>&nbsp;<span class="op" id="7341459">{</span><span class="string" id="7341460">&#34;256&#34;</span><span class="op" id="7341465">}</span><span class="op" id="7341466">}</span><span class="op" id="7341467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341472">TransferEncoding</span><span class="op" id="7341488">:</span>&nbsp;<span class="ident" id="7341490">nil</span><span class="op" id="7341493">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341498">Close</span><span class="op" id="7341503">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7341516">false</span><span class="op" id="7341521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341526">ContentLength</span><span class="op" id="7341539">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7341544">256</span><span class="op" id="7341547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7341551">}</span><span class="op" id="7341552">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7341557">&#34;&#34;</span><span class="op" id="7341559">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7341562">}</span><span class="op" id="7341563">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7341567">//&nbsp;No&nbsp;Content-Length&nbsp;or&nbsp;Chunked&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7341630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7341634">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7341656">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7341661">&#34;\r\n&#34;</span><span class="op" id="7341667">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341672">Response</span><span class="op" id="7341680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341685">Status</span><span class="op" id="7341691">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7341703">&#34;200&nbsp;OK&#34;</span><span class="op" id="7341711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341716">StatusCode</span><span class="op" id="7341726">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7341734">200</span><span class="op" id="7341737">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341742">Proto</span><span class="op" id="7341747">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7341760">&#34;HTTP/1.0&#34;</span><span class="op" id="7341770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341775">ProtoMajor</span><span class="op" id="7341785">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7341793">1</span><span class="op" id="7341794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341799">ProtoMinor</span><span class="op" id="7341809">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7341817">0</span><span class="op" id="7341818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341823">Request</span><span class="op" id="7341830">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341841">dummyReq</span><span class="op" id="7341849">(</span><span class="string" id="7341850">&#34;HEAD&#34;</span><span class="op" id="7341856">)</span><span class="op" id="7341857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341862">Header</span><span class="op" id="7341868">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7341880">Header</span><span class="op" id="7341886">{</span><span class="op" id="7341887">}</span><span class="op" id="7341888">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341893">TransferEncoding</span><span class="op" id="7341909">:</span>&nbsp;<span class="ident" id="7341911">nil</span><span class="op" id="7341914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341919">Close</span><span class="op" id="7341924">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7341937">true</span><span class="op" id="7341941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7341946">ContentLength</span><span class="op" id="7341959">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7341964">-</span><span class="num" id="7341965">1</span><span class="op" id="7341966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7341970">}</span><span class="op" id="7341971">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7341976">&#34;&#34;</span><span class="op" id="7341978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7341981">}</span><span class="op" id="7341982">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7341986">//&nbsp;explicit&nbsp;Content-Length&nbsp;of&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7342020">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7342024">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7342046">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7342051">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7342075">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7342080">&#34;\r\n&#34;</span><span class="op" id="7342086">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342091">Response</span><span class="op" id="7342099">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342104">Status</span><span class="op" id="7342110">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7342116">&#34;200&nbsp;OK&#34;</span><span class="op" id="7342124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342129">StatusCode</span><span class="op" id="7342139">:</span>&nbsp;<span class="num" id="7342141">200</span><span class="op" id="7342144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342149">Proto</span><span class="op" id="7342154">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7342161">&#34;HTTP/1.1&#34;</span><span class="op" id="7342171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342176">ProtoMajor</span><span class="op" id="7342186">:</span>&nbsp;<span class="num" id="7342188">1</span><span class="op" id="7342189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342194">ProtoMinor</span><span class="op" id="7342204">:</span>&nbsp;<span class="num" id="7342206">1</span><span class="op" id="7342207">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342212">Request</span><span class="op" id="7342219">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7342224">dummyReq</span><span class="op" id="7342232">(</span><span class="string" id="7342233">&#34;GET&#34;</span><span class="op" id="7342238">)</span><span class="op" id="7342239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342244">Header</span><span class="op" id="7342250">:</span>&nbsp;<span class="ident" id="7342252">Header</span><span class="op" id="7342258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7342264">&#34;Content-Length&#34;</span><span class="op" id="7342280">:</span>&nbsp;<span class="op" id="7342282">{</span><span class="string" id="7342283">&#34;0&#34;</span><span class="op" id="7342286">}</span><span class="op" id="7342287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7342292">}</span><span class="op" id="7342293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342298">Close</span><span class="op" id="7342303">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7342313">false</span><span class="op" id="7342318">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342323">ContentLength</span><span class="op" id="7342336">:</span>&nbsp;<span class="num" id="7342338">0</span><span class="op" id="7342339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7342343">}</span><span class="op" id="7342344">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7342349">&#34;&#34;</span><span class="op" id="7342351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7342354">}</span><span class="op" id="7342355">,</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7342359">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;but&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7342420">//&nbsp;(permitted&nbsp;by&nbsp;RFC&nbsp;2616)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7342448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7342452">&#34;HTTP/1.0&nbsp;303&nbsp;\r\n\r\n&#34;</span><span class="op" id="7342475">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342479">Response</span><span class="op" id="7342487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342492">Status</span><span class="op" id="7342498">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7342507">&#34;303&nbsp;&#34;</span><span class="op" id="7342513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342518">StatusCode</span><span class="op" id="7342528">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7342533">303</span><span class="op" id="7342536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342541">Proto</span><span class="op" id="7342546">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7342556">&#34;HTTP/1.0&#34;</span><span class="op" id="7342566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342571">ProtoMajor</span><span class="op" id="7342581">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7342586">1</span><span class="op" id="7342587">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342592">ProtoMinor</span><span class="op" id="7342602">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7342607">0</span><span class="op" id="7342608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342613">Request</span><span class="op" id="7342620">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7342628">dummyReq</span><span class="op" id="7342636">(</span><span class="string" id="7342637">&#34;GET&#34;</span><span class="op" id="7342642">)</span><span class="op" id="7342643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342648">Header</span><span class="op" id="7342654">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7342663">Header</span><span class="op" id="7342669">{</span><span class="op" id="7342670">}</span><span class="op" id="7342671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342676">Close</span><span class="op" id="7342681">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7342691">true</span><span class="op" id="7342695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342700">ContentLength</span><span class="op" id="7342713">:</span>&nbsp;<span class="op" id="7342715">-</span><span class="num" id="7342716">1</span><span class="op" id="7342717">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7342721">}</span><span class="op" id="7342722">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7342727">&#34;&#34;</span><span class="op" id="7342729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7342732">}</span><span class="op" id="7342733">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7342737">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;and&nbsp;no&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7342801">//&nbsp;(not&nbsp;permitted&nbsp;by&nbsp;RFC&nbsp;2616,&nbsp;but&nbsp;we&#39;ll&nbsp;accept&nbsp;it&nbsp;anyway)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7342861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7342865">&#34;HTTP/1.0&nbsp;303\r\n\r\n&#34;</span><span class="op" id="7342887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342891">Response</span><span class="op" id="7342899">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342904">Status</span><span class="op" id="7342910">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7342919">&#34;303&nbsp;&#34;</span><span class="op" id="7342925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342930">StatusCode</span><span class="op" id="7342940">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7342945">303</span><span class="op" id="7342948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342953">Proto</span><span class="op" id="7342958">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7342968">&#34;HTTP/1.0&#34;</span><span class="op" id="7342978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7342983">ProtoMajor</span><span class="op" id="7342993">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7342998">1</span><span class="op" id="7342999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343004">ProtoMinor</span><span class="op" id="7343014">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7343019">0</span><span class="op" id="7343020">,</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343025">Request</span><span class="op" id="7343032">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7343040">dummyReq</span><span class="op" id="7343048">(</span><span class="string" id="7343049">&#34;GET&#34;</span><span class="op" id="7343054">)</span><span class="op" id="7343055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343060">Header</span><span class="op" id="7343066">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7343075">Header</span><span class="op" id="7343081">{</span><span class="op" id="7343082">}</span><span class="op" id="7343083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343088">Close</span><span class="op" id="7343093">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7343103">true</span><span class="op" id="7343107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343112">ContentLength</span><span class="op" id="7343125">:</span>&nbsp;<span class="op" id="7343127">-</span><span class="num" id="7343128">1</span><span class="op" id="7343129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7343133">}</span><span class="op" id="7343134">,</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7343139">&#34;&#34;</span><span class="op" id="7343141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7343144">}</span><span class="op" id="7343145">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7343149">//&nbsp;golang.org/issue/4767:&nbsp;don&#39;t&nbsp;special-case&nbsp;multipart/byteranges&nbsp;responses</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7343226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7343230">`HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content<br>
<span class="lineno"></span>Connection:&nbsp;close<br>
<span class="lineno"></span>Content-Type:&nbsp;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef<br>
<span class="lineno"></span><br>
<span class="lineno">340</span>some&nbsp;body`</span><span class="op" id="7343351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343355">Response</span><span class="op" id="7343363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343368">Status</span><span class="op" id="7343374">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7343380">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="7343401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343406">StatusCode</span><span class="op" id="7343416">:</span>&nbsp;<span class="num" id="7343418">206</span><span class="op" id="7343421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343426">Proto</span><span class="op" id="7343431">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7343438">&#34;HTTP/1.1&#34;</span><span class="op" id="7343448">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343453">ProtoMajor</span><span class="op" id="7343463">:</span>&nbsp;<span class="num" id="7343465">1</span><span class="op" id="7343466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343471">ProtoMinor</span><span class="op" id="7343481">:</span>&nbsp;<span class="num" id="7343483">1</span><span class="op" id="7343484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343489">Request</span><span class="op" id="7343496">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7343501">dummyReq</span><span class="op" id="7343509">(</span><span class="string" id="7343510">&#34;GET&#34;</span><span class="op" id="7343515">)</span><span class="op" id="7343516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343521">Header</span><span class="op" id="7343527">:</span>&nbsp;<span class="ident" id="7343529">Header</span><span class="op" id="7343535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7343541">&#34;Content-Type&#34;</span><span class="op" id="7343555">:</span>&nbsp;<span class="op" id="7343557">[</span><span class="op" id="7343558">]</span><span class="builtintype" id="7343559">string</span><span class="op" id="7343565">{</span><span class="string" id="7343566">&#34;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef&#34;</span><span class="op" id="7343615">}</span><span class="op" id="7343616">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7343621">}</span><span class="op" id="7343622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343627">Close</span><span class="op" id="7343632">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7343642">true</span><span class="op" id="7343646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343651">ContentLength</span><span class="op" id="7343664">:</span>&nbsp;<span class="op" id="7343666">-</span><span class="num" id="7343667">1</span><span class="op" id="7343668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7343672">}</span><span class="op" id="7343673">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7343678">&#34;some&nbsp;body&#34;</span><span class="op" id="7343689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7343692">}</span><span class="op" id="7343693">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7343697">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length,&nbsp;Request&nbsp;is&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7343759">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7343763">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7343785">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7343790">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7343814">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7343819">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7343826">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7343831">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7343844">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343849">Response</span><span class="op" id="7343857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343862">Status</span><span class="op" id="7343868">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7343874">&#34;200&nbsp;OK&#34;</span><span class="op" id="7343882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343887">StatusCode</span><span class="op" id="7343897">:</span>&nbsp;<span class="num" id="7343899">200</span><span class="op" id="7343902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343907">Proto</span><span class="op" id="7343912">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7343919">&#34;HTTP/1.0&#34;</span><span class="op" id="7343929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343934">ProtoMajor</span><span class="op" id="7343944">:</span>&nbsp;<span class="num" id="7343946">1</span><span class="op" id="7343947">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343952">ProtoMinor</span><span class="op" id="7343962">:</span>&nbsp;<span class="num" id="7343964">0</span><span class="op" id="7343965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7343970">Header</span><span class="op" id="7343976">:</span>&nbsp;<span class="ident" id="7343978">Header</span><span class="op" id="7343984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7343990">&#34;Connection&#34;</span><span class="op" id="7344002">:</span>&nbsp;<span class="op" id="7344004">{</span><span class="string" id="7344005">&#34;close&#34;</span><span class="op" id="7344012">}</span><span class="op" id="7344013">,</span>&nbsp;<span class="comment" id="7344015">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7344040">}</span><span class="op" id="7344041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7344046">Close</span><span class="op" id="7344051">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7344061">true</span><span class="op" id="7344065">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7344070">ContentLength</span><span class="op" id="7344083">:</span>&nbsp;<span class="op" id="7344085">-</span><span class="num" id="7344086">1</span><span class="op" id="7344087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7344091">}</span><span class="op" id="7344092">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7344097">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7344110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7344113">}</span><span class="op" id="7344114">,</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7344118">//&nbsp;206&nbsp;Partial&nbsp;Content.&nbsp;golang.org/issue/8923</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7344165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7344169">&#34;HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="7344204">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7344209">&#34;Content-Type:&nbsp;text/plain;&nbsp;charset=utf-8\r\n&#34;</span>&nbsp;<span class="op" id="7344255">+</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7344260">&#34;Accept-Ranges:&nbsp;bytes\r\n&#34;</span>&nbsp;<span class="op" id="7344287">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7344292">&#34;Content-Range:&nbsp;bytes&nbsp;0-5/1862\r\n&#34;</span>&nbsp;<span class="op" id="7344328">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7344333">&#34;Content-Length:&nbsp;6\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7344361">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7344366">&#34;foobar&#34;</span><span class="op" id="7344374">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7344379">Response</span><span class="op" id="7344387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7344392">Status</span><span class="op" id="7344398">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7344404">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="7344425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7344430">StatusCode</span><span class="op" id="7344440">:</span>&nbsp;<span class="num" id="7344442">206</span><span class="op" id="7344445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7344450">Proto</span><span class="op" id="7344455">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7344462">&#34;HTTP/1.1&#34;</span><span class="op" id="7344472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7344477">ProtoMajor</span><span class="op" id="7344487">:</span>&nbsp;<span class="num" id="7344489">1</span><span class="op" id="7344490">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7344495">ProtoMinor</span><span class="op" id="7344505">:</span>&nbsp;<span class="num" id="7344507">1</span><span class="op" id="7344508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7344513">Request</span><span class="op" id="7344520">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7344525">dummyReq</span><span class="op" id="7344533">(</span><span class="string" id="7344534">&#34;GET&#34;</span><span class="op" id="7344539">)</span><span class="op" id="7344540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7344545">Header</span><span class="op" id="7344551">:</span>&nbsp;<span class="ident" id="7344553">Header</span><span class="op" id="7344559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7344565">&#34;Accept-Ranges&#34;</span><span class="op" id="7344580">:</span>&nbsp;&nbsp;<span class="op" id="7344583">[</span><span class="op" id="7344584">]</span><span class="builtintype" id="7344585">string</span><span class="op" id="7344591">{</span><span class="string" id="7344592">&#34;bytes&#34;</span><span class="op" id="7344599">}</span><span class="op" id="7344600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7344606">&#34;Content-Length&#34;</span><span class="op" id="7344622">:</span>&nbsp;<span class="op" id="7344624">[</span><span class="op" id="7344625">]</span><span class="builtintype" id="7344626">string</span><span class="op" id="7344632">{</span><span class="string" id="7344633">&#34;6&#34;</span><span class="op" id="7344636">}</span><span class="op" id="7344637">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7344643">&#34;Content-Type&#34;</span><span class="op" id="7344657">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7344661">[</span><span class="op" id="7344662">]</span><span class="builtintype" id="7344663">string</span><span class="op" id="7344669">{</span><span class="string" id="7344670">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="7344697">}</span><span class="op" id="7344698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7344704">&#34;Content-Range&#34;</span><span class="op" id="7344719">:</span>&nbsp;&nbsp;<span class="op" id="7344722">[</span><span class="op" id="7344723">]</span><span class="builtintype" id="7344724">string</span><span class="op" id="7344730">{</span><span class="string" id="7344731">&#34;bytes&nbsp;0-5/1862&#34;</span><span class="op" id="7344747">}</span><span class="op" id="7344748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7344753">}</span><span class="op" id="7344754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7344759">ContentLength</span><span class="op" id="7344772">:</span>&nbsp;<span class="num" id="7344774">6</span><span class="op" id="7344775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7344779">}</span><span class="op" id="7344780">,</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7344785">&#34;foobar&#34;</span><span class="op" id="7344793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7344796">}</span><span class="op" id="7344797">,</span><br>
<span class="lineno"></span><span class="op" id="7344799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="7344802">func</span>&nbsp;<span class="ident" id="7344807">TestReadResponse</span><span class="op" id="7344823">(</span><span class="ident" id="7344824">t</span>&nbsp;<span class="op" id="7344826">*</span><span class="ident" id="7344827">testing</span><span class="op" id="7344834">.</span><span class="ident" id="7344835">T</span><span class="op" id="7344836">)</span>&nbsp;<span class="op" id="7344838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7344841">for</span>&nbsp;<span class="ident" id="7344845">i</span><span class="op" id="7344846">,</span>&nbsp;<span class="ident" id="7344848">tt</span>&nbsp;<span class="op" id="7344851">:=</span>&nbsp;<span class="keyword" id="7344854">range</span>&nbsp;<span class="ident" id="7344860">respTests</span>&nbsp;<span class="op" id="7344870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7344874">resp</span><span class="op" id="7344878">,</span>&nbsp;<span class="ident" id="7344880">err</span>&nbsp;<span class="op" id="7344884">:=</span>&nbsp;<span class="ident" id="7344887">ReadResponse</span><span class="op" id="7344899">(</span><span class="ident" id="7344900">bufio</span><span class="op" id="7344905">.</span><span class="ident" id="7344906">NewReader</span><span class="op" id="7344915">(</span><span class="ident" id="7344916">strings</span><span class="op" id="7344923">.</span><span class="ident" id="7344924">NewReader</span><span class="op" id="7344933">(</span><span class="ident" id="7344934">tt</span><span class="op" id="7344936">.</span><span class="ident" id="7344937">Raw</span><span class="op" id="7344940">)</span><span class="op" id="7344941">)</span><span class="op" id="7344942">,</span>&nbsp;<span class="ident" id="7344944">tt</span><span class="op" id="7344946">.</span><span class="ident" id="7344947">Resp</span><span class="op" id="7344951">.</span><span class="ident" id="7344952">Request</span><span class="op" id="7344959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7344963">if</span>&nbsp;<span class="ident" id="7344966">err</span>&nbsp;<span class="op" id="7344970">!=</span>&nbsp;<span class="ident" id="7344973">nil</span>&nbsp;<span class="op" id="7344977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7344982">t</span><span class="op" id="7344983">.</span><span class="ident" id="7344984">Errorf</span><span class="op" id="7344990">(</span><span class="string" id="7344991">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="7345000">,</span>&nbsp;<span class="ident" id="7345002">i</span><span class="op" id="7345003">,</span>&nbsp;<span class="ident" id="7345005">err</span><span class="op" id="7345008">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7345013">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7345024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7345028">rbody</span>&nbsp;<span class="op" id="7345034">:=</span>&nbsp;<span class="ident" id="7345037">resp</span><span class="op" id="7345041">.</span><span class="ident" id="7345042">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7345049">resp</span><span class="op" id="7345053">.</span><span class="ident" id="7345054">Body</span>&nbsp;<span class="op" id="7345059">=</span>&nbsp;<span class="ident" id="7345061">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7345067">diff</span><span class="op" id="7345071">(</span><span class="ident" id="7345072">t</span><span class="op" id="7345073">,</span>&nbsp;<span class="ident" id="7345075">fmt</span><span class="op" id="7345078">.</span><span class="ident" id="7345079">Sprintf</span><span class="op" id="7345086">(</span><span class="string" id="7345087">&#34;#%d&nbsp;Response&#34;</span><span class="op" id="7345101">,</span>&nbsp;<span class="ident" id="7345103">i</span><span class="op" id="7345104">)</span><span class="op" id="7345105">,</span>&nbsp;<span class="ident" id="7345107">resp</span><span class="op" id="7345111">,</span>&nbsp;<span class="op" id="7345113">&amp;</span><span class="ident" id="7345114">tt</span><span class="op" id="7345116">.</span><span class="ident" id="7345117">Resp</span><span class="op" id="7345121">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7345125">var</span>&nbsp;<span class="ident" id="7345129">bout</span>&nbsp;<span class="ident" id="7345134">bytes</span><span class="op" id="7345139">.</span><span class="ident" id="7345140">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7345149">if</span>&nbsp;<span class="ident" id="7345152">rbody</span>&nbsp;<span class="op" id="7345158">!=</span>&nbsp;<span class="ident" id="7345161">nil</span>&nbsp;<span class="op" id="7345165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7345170">_</span><span class="op" id="7345171">,</span>&nbsp;<span class="ident" id="7345173">err</span>&nbsp;<span class="op" id="7345177">=</span>&nbsp;<span class="ident" id="7345179">io</span><span class="op" id="7345181">.</span><span class="ident" id="7345182">Copy</span><span class="op" id="7345186">(</span><span class="op" id="7345187">&amp;</span><span class="ident" id="7345188">bout</span><span class="op" id="7345192">,</span>&nbsp;<span class="ident" id="7345194">rbody</span><span class="op" id="7345199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7345204">if</span>&nbsp;<span class="ident" id="7345207">err</span>&nbsp;<span class="op" id="7345211">!=</span>&nbsp;<span class="ident" id="7345214">nil</span>&nbsp;<span class="op" id="7345218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7345224">t</span><span class="op" id="7345225">.</span><span class="ident" id="7345226">Errorf</span><span class="op" id="7345232">(</span><span class="string" id="7345233">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="7345242">,</span>&nbsp;<span class="ident" id="7345244">i</span><span class="op" id="7345245">,</span>&nbsp;<span class="ident" id="7345247">err</span><span class="op" id="7345250">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7345256">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7345268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7345273">rbody</span><span class="op" id="7345278">.</span><span class="ident" id="7345279">Close</span><span class="op" id="7345284">(</span><span class="op" id="7345285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7345289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7345293">body</span>&nbsp;<span class="op" id="7345298">:=</span>&nbsp;<span class="ident" id="7345301">bout</span><span class="op" id="7345305">.</span><span class="ident" id="7345306">String</span><span class="op" id="7345312">(</span><span class="op" id="7345313">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7345317">if</span>&nbsp;<span class="ident" id="7345320">body</span>&nbsp;<span class="op" id="7345325">!=</span>&nbsp;<span class="ident" id="7345328">tt</span><span class="op" id="7345330">.</span><span class="ident" id="7345331">Body</span>&nbsp;<span class="op" id="7345336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7345341">t</span><span class="op" id="7345342">.</span><span class="ident" id="7345343">Errorf</span><span class="op" id="7345349">(</span><span class="string" id="7345350">&#34;#%d:&nbsp;Body&nbsp;=&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7345374">,</span>&nbsp;<span class="ident" id="7345376">i</span><span class="op" id="7345377">,</span>&nbsp;<span class="ident" id="7345379">body</span><span class="op" id="7345383">,</span>&nbsp;<span class="ident" id="7345385">tt</span><span class="op" id="7345387">.</span><span class="ident" id="7345388">Body</span><span class="op" id="7345392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7345396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7345399">}</span><br>
<span class="lineno"></span><span class="op" id="7345401">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="7345404">func</span>&nbsp;<span class="ident" id="7345409">TestWriteResponse</span><span class="op" id="7345426">(</span><span class="ident" id="7345427">t</span>&nbsp;<span class="op" id="7345429">*</span><span class="ident" id="7345430">testing</span><span class="op" id="7345437">.</span><span class="ident" id="7345438">T</span><span class="op" id="7345439">)</span>&nbsp;<span class="op" id="7345441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7345444">for</span>&nbsp;<span class="ident" id="7345448">i</span><span class="op" id="7345449">,</span>&nbsp;<span class="ident" id="7345451">tt</span>&nbsp;<span class="op" id="7345454">:=</span>&nbsp;<span class="keyword" id="7345457">range</span>&nbsp;<span class="ident" id="7345463">respTests</span>&nbsp;<span class="op" id="7345473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7345477">resp</span><span class="op" id="7345481">,</span>&nbsp;<span class="ident" id="7345483">err</span>&nbsp;<span class="op" id="7345487">:=</span>&nbsp;<span class="ident" id="7345490">ReadResponse</span><span class="op" id="7345502">(</span><span class="ident" id="7345503">bufio</span><span class="op" id="7345508">.</span><span class="ident" id="7345509">NewReader</span><span class="op" id="7345518">(</span><span class="ident" id="7345519">strings</span><span class="op" id="7345526">.</span><span class="ident" id="7345527">NewReader</span><span class="op" id="7345536">(</span><span class="ident" id="7345537">tt</span><span class="op" id="7345539">.</span><span class="ident" id="7345540">Raw</span><span class="op" id="7345543">)</span><span class="op" id="7345544">)</span><span class="op" id="7345545">,</span>&nbsp;<span class="ident" id="7345547">tt</span><span class="op" id="7345549">.</span><span class="ident" id="7345550">Resp</span><span class="op" id="7345554">.</span><span class="ident" id="7345555">Request</span><span class="op" id="7345562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7345566">if</span>&nbsp;<span class="ident" id="7345569">err</span>&nbsp;<span class="op" id="7345573">!=</span>&nbsp;<span class="ident" id="7345576">nil</span>&nbsp;<span class="op" id="7345580">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7345585">t</span><span class="op" id="7345586">.</span><span class="ident" id="7345587">Errorf</span><span class="op" id="7345593">(</span><span class="string" id="7345594">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="7345603">,</span>&nbsp;<span class="ident" id="7345605">i</span><span class="op" id="7345606">,</span>&nbsp;<span class="ident" id="7345608">err</span><span class="op" id="7345611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7345616">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7345627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7345631">err</span>&nbsp;<span class="op" id="7345635">=</span>&nbsp;<span class="ident" id="7345637">resp</span><span class="op" id="7345641">.</span><span class="ident" id="7345642">Write</span><span class="op" id="7345647">(</span><span class="ident" id="7345648">ioutil</span><span class="op" id="7345654">.</span><span class="ident" id="7345655">Discard</span><span class="op" id="7345662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7345666">if</span>&nbsp;<span class="ident" id="7345669">err</span>&nbsp;<span class="op" id="7345673">!=</span>&nbsp;<span class="ident" id="7345676">nil</span>&nbsp;<span class="op" id="7345680">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7345685">t</span><span class="op" id="7345686">.</span><span class="ident" id="7345687">Errorf</span><span class="op" id="7345693">(</span><span class="string" id="7345694">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="7345703">,</span>&nbsp;<span class="ident" id="7345705">i</span><span class="op" id="7345706">,</span>&nbsp;<span class="ident" id="7345708">err</span><span class="op" id="7345711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7345716">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7345727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7345730">}</span><br>
<span class="lineno"></span><span class="op" id="7345732">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="7345735">var</span>&nbsp;<span class="ident" id="7345739">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="7345770">=</span>&nbsp;<span class="op" id="7345772">[</span><span class="op" id="7345773">]</span><span class="keyword" id="7345774">struct</span>&nbsp;<span class="op" id="7345781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7345784">chunked</span><span class="op" id="7345791">,</span>&nbsp;<span class="ident" id="7345793">compressed</span>&nbsp;<span class="builtintype" id="7345804">bool</span><br>
<span class="lineno"></span><span class="op" id="7345809">}</span><span class="op" id="7345810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7345813">{</span><span class="builtintype" id="7345814">false</span><span class="op" id="7345819">,</span>&nbsp;<span class="builtintype" id="7345821">false</span><span class="op" id="7345826">}</span><span class="op" id="7345827">,</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7345830">{</span><span class="builtintype" id="7345831">true</span><span class="op" id="7345835">,</span>&nbsp;<span class="builtintype" id="7345837">false</span><span class="op" id="7345842">}</span><span class="op" id="7345843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7345846">{</span><span class="builtintype" id="7345847">true</span><span class="op" id="7345851">,</span>&nbsp;<span class="builtintype" id="7345853">true</span><span class="op" id="7345857">}</span><span class="op" id="7345858">,</span><br>
<span class="lineno"></span><span class="op" id="7345860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7345863">//&nbsp;TestReadResponseCloseInMiddle&nbsp;tests&nbsp;that&nbsp;closing&nbsp;a&nbsp;body&nbsp;after</span><br>
<span class="lineno">460</span><span class="comment" id="7345928">//&nbsp;reading&nbsp;only&nbsp;part&nbsp;of&nbsp;its&nbsp;contents&nbsp;advances&nbsp;the&nbsp;read&nbsp;to&nbsp;the&nbsp;end&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="7345997">//&nbsp;the&nbsp;request,&nbsp;right&nbsp;up&nbsp;until&nbsp;the&nbsp;next&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="7346046">func</span>&nbsp;<span class="ident" id="7346051">TestReadResponseCloseInMiddle</span><span class="op" id="7346080">(</span><span class="ident" id="7346081">t</span>&nbsp;<span class="op" id="7346083">*</span><span class="ident" id="7346084">testing</span><span class="op" id="7346091">.</span><span class="ident" id="7346092">T</span><span class="op" id="7346093">)</span>&nbsp;<span class="op" id="7346095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7346098">for</span>&nbsp;<span class="ident" id="7346102">_</span><span class="op" id="7346103">,</span>&nbsp;<span class="ident" id="7346105">test</span>&nbsp;<span class="op" id="7346110">:=</span>&nbsp;<span class="keyword" id="7346113">range</span>&nbsp;<span class="ident" id="7346119">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="7346150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7346154">fatalf</span>&nbsp;<span class="op" id="7346161">:=</span>&nbsp;<span class="keyword" id="7346164">func</span><span class="op" id="7346168">(</span><span class="ident" id="7346169">format</span>&nbsp;<span class="builtintype" id="7346176">string</span><span class="op" id="7346182">,</span>&nbsp;<span class="ident" id="7346184">args</span>&nbsp;<span class="op" id="7346189">...</span><span class="keyword" id="7346192">interface</span><span class="op" id="7346201">{</span><span class="op" id="7346202">}</span><span class="op" id="7346203">)</span>&nbsp;<span class="op" id="7346205">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7346210">args</span>&nbsp;<span class="op" id="7346215">=</span>&nbsp;<span class="builtinfunc" id="7346217">append</span><span class="op" id="7346223">(</span><span class="op" id="7346224">[</span><span class="op" id="7346225">]</span><span class="keyword" id="7346226">interface</span><span class="op" id="7346235">{</span><span class="op" id="7346236">}</span><span class="op" id="7346237">{</span><span class="ident" id="7346238">test</span><span class="op" id="7346242">.</span><span class="ident" id="7346243">chunked</span><span class="op" id="7346250">,</span>&nbsp;<span class="ident" id="7346252">test</span><span class="op" id="7346256">.</span><span class="ident" id="7346257">compressed</span><span class="op" id="7346267">}</span><span class="op" id="7346268">,</span>&nbsp;<span class="ident" id="7346270">args</span><span class="op" id="7346274">...</span><span class="op" id="7346277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7346282">t</span><span class="op" id="7346283">.</span><span class="ident" id="7346284">Fatalf</span><span class="op" id="7346290">(</span><span class="string" id="7346291">&#34;on&nbsp;test&nbsp;chunked=%v,&nbsp;compressed=%v:&nbsp;&#34;</span><span class="op" id="7346328">+</span><span class="ident" id="7346329">format</span><span class="op" id="7346335">,</span>&nbsp;<span class="ident" id="7346337">args</span><span class="op" id="7346341">...</span><span class="op" id="7346344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7346348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7346352">checkErr</span>&nbsp;<span class="op" id="7346361">:=</span>&nbsp;<span class="keyword" id="7346364">func</span><span class="op" id="7346368">(</span><span class="ident" id="7346369">err</span>&nbsp;<span class="builtintype" id="7346373">error</span><span class="op" id="7346378">,</span>&nbsp;<span class="ident" id="7346380">msg</span>&nbsp;<span class="builtintype" id="7346384">string</span><span class="op" id="7346390">)</span>&nbsp;<span class="op" id="7346392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7346397">if</span>&nbsp;<span class="ident" id="7346400">err</span>&nbsp;<span class="op" id="7346404">==</span>&nbsp;<span class="ident" id="7346407">nil</span>&nbsp;<span class="op" id="7346411">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7346417">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7346427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7346432">fatalf</span><span class="op" id="7346438">(</span><span class="ident" id="7346439">msg</span><span class="op" id="7346442">+</span><span class="string" id="7346443">&#34;:&nbsp;%v&#34;</span><span class="op" id="7346449">,</span>&nbsp;<span class="ident" id="7346451">err</span><span class="op" id="7346454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7346458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7346462">var</span>&nbsp;<span class="ident" id="7346466">buf</span>&nbsp;<span class="ident" id="7346470">bytes</span><span class="op" id="7346475">.</span><span class="ident" id="7346476">Buffer</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7346485">buf</span><span class="op" id="7346488">.</span><span class="ident" id="7346489">WriteString</span><span class="op" id="7346500">(</span><span class="string" id="7346501">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span><span class="op" id="7346522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7346526">if</span>&nbsp;<span class="ident" id="7346529">test</span><span class="op" id="7346533">.</span><span class="ident" id="7346534">chunked</span>&nbsp;<span class="op" id="7346542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7346547">buf</span><span class="op" id="7346550">.</span><span class="ident" id="7346551">WriteString</span><span class="op" id="7346562">(</span><span class="string" id="7346563">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span><span class="op" id="7346595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7346599">}</span>&nbsp;<span class="keyword" id="7346601">else</span>&nbsp;<span class="op" id="7346606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7346611">buf</span><span class="op" id="7346614">.</span><span class="ident" id="7346615">WriteString</span><span class="op" id="7346626">(</span><span class="string" id="7346627">&#34;Content-Length:&nbsp;1000000\r\n&#34;</span><span class="op" id="7346656">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7346660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7346664">var</span>&nbsp;<span class="ident" id="7346668">wr</span>&nbsp;<span class="ident" id="7346671">io</span><span class="op" id="7346673">.</span><span class="ident" id="7346674">Writer</span>&nbsp;<span class="op" id="7346681">=</span>&nbsp;<span class="op" id="7346683">&amp;</span><span class="ident" id="7346684">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7346690">if</span>&nbsp;<span class="ident" id="7346693">test</span><span class="op" id="7346697">.</span><span class="ident" id="7346698">chunked</span>&nbsp;<span class="op" id="7346706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7346711">wr</span>&nbsp;<span class="op" id="7346714">=</span>&nbsp;<span class="ident" id="7346716">internal</span><span class="op" id="7346724">.</span><span class="ident" id="7346725">NewChunkedWriter</span><span class="op" id="7346741">(</span><span class="ident" id="7346742">wr</span><span class="op" id="7346744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7346748">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7346752">if</span>&nbsp;<span class="ident" id="7346755">test</span><span class="op" id="7346759">.</span><span class="ident" id="7346760">compressed</span>&nbsp;<span class="op" id="7346771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7346776">buf</span><span class="op" id="7346779">.</span><span class="ident" id="7346780">WriteString</span><span class="op" id="7346791">(</span><span class="string" id="7346792">&#34;Content-Encoding:&nbsp;gzip\r\n&#34;</span><span class="op" id="7346820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7346825">wr</span>&nbsp;<span class="op" id="7346828">=</span>&nbsp;<span class="ident" id="7346830">gzip</span><span class="op" id="7346834">.</span><span class="ident" id="7346835">NewWriter</span><span class="op" id="7346844">(</span><span class="ident" id="7346845">wr</span><span class="op" id="7346847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7346851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7346855">buf</span><span class="op" id="7346858">.</span><span class="ident" id="7346859">WriteString</span><span class="op" id="7346870">(</span><span class="string" id="7346871">&#34;\r\n&#34;</span><span class="op" id="7346877">)</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7346882">chunk</span>&nbsp;<span class="op" id="7346888">:=</span>&nbsp;<span class="ident" id="7346891">bytes</span><span class="op" id="7346896">.</span><span class="ident" id="7346897">Repeat</span><span class="op" id="7346903">(</span><span class="op" id="7346904">[</span><span class="op" id="7346905">]</span><span class="builtintype" id="7346906">byte</span><span class="op" id="7346910">{</span><span class="string" id="7346911">&#39;x&#39;</span><span class="op" id="7346914">}</span><span class="op" id="7346915">,</span>&nbsp;<span class="num" id="7346917">1000</span><span class="op" id="7346921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7346925">for</span>&nbsp;<span class="ident" id="7346929">i</span>&nbsp;<span class="op" id="7346931">:=</span>&nbsp;<span class="num" id="7346934">0</span><span class="op" id="7346935">;</span>&nbsp;<span class="ident" id="7346937">i</span>&nbsp;<span class="op" id="7346939">&lt;</span>&nbsp;<span class="num" id="7346941">1000</span><span class="op" id="7346945">;</span>&nbsp;<span class="ident" id="7346947">i</span><span class="op" id="7346948">++</span>&nbsp;<span class="op" id="7346951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7346956">if</span>&nbsp;<span class="ident" id="7346959">test</span><span class="op" id="7346963">.</span><span class="ident" id="7346964">compressed</span>&nbsp;<span class="op" id="7346975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7346981">//&nbsp;Otherwise&nbsp;this&nbsp;compresses&nbsp;too&nbsp;well.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347024">_</span><span class="op" id="7347025">,</span>&nbsp;<span class="ident" id="7347027">err</span>&nbsp;<span class="op" id="7347031">:=</span>&nbsp;<span class="ident" id="7347034">io</span><span class="op" id="7347036">.</span><span class="ident" id="7347037">ReadFull</span><span class="op" id="7347045">(</span><span class="ident" id="7347046">rand</span><span class="op" id="7347050">.</span><span class="ident" id="7347051">Reader</span><span class="op" id="7347057">,</span>&nbsp;<span class="ident" id="7347059">chunk</span><span class="op" id="7347064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347070">checkErr</span><span class="op" id="7347078">(</span><span class="ident" id="7347079">err</span><span class="op" id="7347082">,</span>&nbsp;<span class="string" id="7347084">&#34;rand.Reader&nbsp;ReadFull&#34;</span><span class="op" id="7347106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7347111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347116">wr</span><span class="op" id="7347118">.</span><span class="ident" id="7347119">Write</span><span class="op" id="7347124">(</span><span class="ident" id="7347125">chunk</span><span class="op" id="7347130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7347134">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7347138">if</span>&nbsp;<span class="ident" id="7347141">test</span><span class="op" id="7347145">.</span><span class="ident" id="7347146">compressed</span>&nbsp;<span class="op" id="7347157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347162">err</span>&nbsp;<span class="op" id="7347166">:=</span>&nbsp;<span class="ident" id="7347169">wr</span><span class="op" id="7347171">.</span><span class="op" id="7347172">(</span><span class="op" id="7347173">*</span><span class="ident" id="7347174">gzip</span><span class="op" id="7347178">.</span><span class="ident" id="7347179">Writer</span><span class="op" id="7347185">)</span><span class="op" id="7347186">.</span><span class="ident" id="7347187">Close</span><span class="op" id="7347192">(</span><span class="op" id="7347193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347198">checkErr</span><span class="op" id="7347206">(</span><span class="ident" id="7347207">err</span><span class="op" id="7347210">,</span>&nbsp;<span class="string" id="7347212">&#34;compressor&nbsp;close&#34;</span><span class="op" id="7347230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7347234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7347238">if</span>&nbsp;<span class="ident" id="7347241">test</span><span class="op" id="7347245">.</span><span class="ident" id="7347246">chunked</span>&nbsp;<span class="op" id="7347254">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347259">buf</span><span class="op" id="7347262">.</span><span class="ident" id="7347263">WriteString</span><span class="op" id="7347274">(</span><span class="string" id="7347275">&#34;0\r\n\r\n&#34;</span><span class="op" id="7347286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7347290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347294">buf</span><span class="op" id="7347297">.</span><span class="ident" id="7347298">WriteString</span><span class="op" id="7347309">(</span><span class="string" id="7347310">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="7347329">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347334">bufr</span>&nbsp;<span class="op" id="7347339">:=</span>&nbsp;<span class="ident" id="7347342">bufio</span><span class="op" id="7347347">.</span><span class="ident" id="7347348">NewReader</span><span class="op" id="7347357">(</span><span class="op" id="7347358">&amp;</span><span class="ident" id="7347359">buf</span><span class="op" id="7347362">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347366">resp</span><span class="op" id="7347370">,</span>&nbsp;<span class="ident" id="7347372">err</span>&nbsp;<span class="op" id="7347376">:=</span>&nbsp;<span class="ident" id="7347379">ReadResponse</span><span class="op" id="7347391">(</span><span class="ident" id="7347392">bufr</span><span class="op" id="7347396">,</span>&nbsp;<span class="ident" id="7347398">dummyReq</span><span class="op" id="7347406">(</span><span class="string" id="7347407">&#34;GET&#34;</span><span class="op" id="7347412">)</span><span class="op" id="7347413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347417">checkErr</span><span class="op" id="7347425">(</span><span class="ident" id="7347426">err</span><span class="op" id="7347429">,</span>&nbsp;<span class="string" id="7347431">&#34;ReadResponse&#34;</span><span class="op" id="7347445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347449">expectedLength</span>&nbsp;<span class="op" id="7347464">:=</span>&nbsp;<span class="ident" id="7347467">int64</span><span class="op" id="7347472">(</span><span class="op" id="7347473">-</span><span class="num" id="7347474">1</span><span class="op" id="7347475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7347479">if</span>&nbsp;<span class="op" id="7347482">!</span><span class="ident" id="7347483">test</span><span class="op" id="7347487">.</span><span class="ident" id="7347488">chunked</span>&nbsp;<span class="op" id="7347496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347501">expectedLength</span>&nbsp;<span class="op" id="7347516">=</span>&nbsp;<span class="num" id="7347518">1000000</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7347528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7347532">if</span>&nbsp;<span class="ident" id="7347535">resp</span><span class="op" id="7347539">.</span><span class="ident" id="7347540">ContentLength</span>&nbsp;<span class="op" id="7347554">!=</span>&nbsp;<span class="ident" id="7347557">expectedLength</span>&nbsp;<span class="op" id="7347572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347577">fatalf</span><span class="op" id="7347583">(</span><span class="string" id="7347584">&#34;expected&nbsp;response&nbsp;length&nbsp;%d,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7347621">,</span>&nbsp;<span class="ident" id="7347623">expectedLength</span><span class="op" id="7347637">,</span>&nbsp;<span class="ident" id="7347639">resp</span><span class="op" id="7347643">.</span><span class="ident" id="7347644">ContentLength</span><span class="op" id="7347657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7347661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7347665">if</span>&nbsp;<span class="ident" id="7347668">resp</span><span class="op" id="7347672">.</span><span class="ident" id="7347673">Body</span>&nbsp;<span class="op" id="7347678">==</span>&nbsp;<span class="ident" id="7347681">nil</span>&nbsp;<span class="op" id="7347685">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347690">fatalf</span><span class="op" id="7347696">(</span><span class="string" id="7347697">&#34;nil&nbsp;body&#34;</span><span class="op" id="7347707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7347711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7347715">if</span>&nbsp;<span class="ident" id="7347718">test</span><span class="op" id="7347722">.</span><span class="ident" id="7347723">compressed</span>&nbsp;<span class="op" id="7347734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347739">gzReader</span><span class="op" id="7347747">,</span>&nbsp;<span class="ident" id="7347749">err</span>&nbsp;<span class="op" id="7347753">:=</span>&nbsp;<span class="ident" id="7347756">gzip</span><span class="op" id="7347760">.</span><span class="ident" id="7347761">NewReader</span><span class="op" id="7347770">(</span><span class="ident" id="7347771">resp</span><span class="op" id="7347775">.</span><span class="ident" id="7347776">Body</span><span class="op" id="7347780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347785">checkErr</span><span class="op" id="7347793">(</span><span class="ident" id="7347794">err</span><span class="op" id="7347797">,</span>&nbsp;<span class="string" id="7347799">&#34;gzip.NewReader&#34;</span><span class="op" id="7347815">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347820">resp</span><span class="op" id="7347824">.</span><span class="ident" id="7347825">Body</span>&nbsp;<span class="op" id="7347830">=</span>&nbsp;<span class="op" id="7347832">&amp;</span><span class="ident" id="7347833">readerAndCloser</span><span class="op" id="7347848">{</span><span class="ident" id="7347849">gzReader</span><span class="op" id="7347857">,</span>&nbsp;<span class="ident" id="7347859">resp</span><span class="op" id="7347863">.</span><span class="ident" id="7347864">Body</span><span class="op" id="7347868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7347872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347877">rbuf</span>&nbsp;<span class="op" id="7347882">:=</span>&nbsp;<span class="builtinfunc" id="7347885">make</span><span class="op" id="7347889">(</span><span class="op" id="7347890">[</span><span class="op" id="7347891">]</span><span class="builtintype" id="7347892">byte</span><span class="op" id="7347896">,</span>&nbsp;<span class="num" id="7347898">2500</span><span class="op" id="7347902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347906">n</span><span class="op" id="7347907">,</span>&nbsp;<span class="ident" id="7347909">err</span>&nbsp;<span class="op" id="7347913">:=</span>&nbsp;<span class="ident" id="7347916">io</span><span class="op" id="7347918">.</span><span class="ident" id="7347919">ReadFull</span><span class="op" id="7347927">(</span><span class="ident" id="7347928">resp</span><span class="op" id="7347932">.</span><span class="ident" id="7347933">Body</span><span class="op" id="7347937">,</span>&nbsp;<span class="ident" id="7347939">rbuf</span><span class="op" id="7347943">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7347947">checkErr</span><span class="op" id="7347955">(</span><span class="ident" id="7347956">err</span><span class="op" id="7347959">,</span>&nbsp;<span class="string" id="7347961">&#34;2500&nbsp;byte&nbsp;ReadFull&#34;</span><span class="op" id="7347981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7347985">if</span>&nbsp;<span class="ident" id="7347988">n</span>&nbsp;<span class="op" id="7347990">!=</span>&nbsp;<span class="num" id="7347993">2500</span>&nbsp;<span class="op" id="7347998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348003">fatalf</span><span class="op" id="7348009">(</span><span class="string" id="7348010">&#34;ReadFull&nbsp;only&nbsp;read&nbsp;%d&nbsp;bytes&#34;</span><span class="op" id="7348039">,</span>&nbsp;<span class="ident" id="7348041">n</span><span class="op" id="7348042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7348046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7348050">if</span>&nbsp;<span class="ident" id="7348053">test</span><span class="op" id="7348057">.</span><span class="ident" id="7348058">compressed</span>&nbsp;<span class="op" id="7348069">==</span>&nbsp;<span class="builtintype" id="7348072">false</span>&nbsp;<span class="op" id="7348078">&amp;&amp;</span>&nbsp;<span class="op" id="7348081">!</span><span class="ident" id="7348082">bytes</span><span class="op" id="7348087">.</span><span class="ident" id="7348088">Equal</span><span class="op" id="7348093">(</span><span class="ident" id="7348094">bytes</span><span class="op" id="7348099">.</span><span class="ident" id="7348100">Repeat</span><span class="op" id="7348106">(</span><span class="op" id="7348107">[</span><span class="op" id="7348108">]</span><span class="builtintype" id="7348109">byte</span><span class="op" id="7348113">{</span><span class="string" id="7348114">&#39;x&#39;</span><span class="op" id="7348117">}</span><span class="op" id="7348118">,</span>&nbsp;<span class="num" id="7348120">2500</span><span class="op" id="7348124">)</span><span class="op" id="7348125">,</span>&nbsp;<span class="ident" id="7348127">rbuf</span><span class="op" id="7348131">)</span>&nbsp;<span class="op" id="7348133">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348138">fatalf</span><span class="op" id="7348144">(</span><span class="string" id="7348145">&#34;ReadFull&nbsp;didn&#39;t&nbsp;read&nbsp;2500&nbsp;&#39;x&#39;;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7348184">,</span>&nbsp;<span class="builtintype" id="7348186">string</span><span class="op" id="7348192">(</span><span class="ident" id="7348193">rbuf</span><span class="op" id="7348197">)</span><span class="op" id="7348198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7348202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348206">resp</span><span class="op" id="7348210">.</span><span class="ident" id="7348211">Body</span><span class="op" id="7348215">.</span><span class="ident" id="7348216">Close</span><span class="op" id="7348221">(</span><span class="op" id="7348222">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348227">rest</span><span class="op" id="7348231">,</span>&nbsp;<span class="ident" id="7348233">err</span>&nbsp;<span class="op" id="7348237">:=</span>&nbsp;<span class="ident" id="7348240">ioutil</span><span class="op" id="7348246">.</span><span class="ident" id="7348247">ReadAll</span><span class="op" id="7348254">(</span><span class="ident" id="7348255">bufr</span><span class="op" id="7348259">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348263">checkErr</span><span class="op" id="7348271">(</span><span class="ident" id="7348272">err</span><span class="op" id="7348275">,</span>&nbsp;<span class="string" id="7348277">&#34;ReadAll&nbsp;on&nbsp;remainder&#34;</span><span class="op" id="7348299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7348303">if</span>&nbsp;<span class="ident" id="7348306">e</span><span class="op" id="7348307">,</span>&nbsp;<span class="ident" id="7348309">g</span>&nbsp;<span class="op" id="7348311">:=</span>&nbsp;<span class="string" id="7348314">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="7348333">,</span>&nbsp;<span class="builtintype" id="7348335">string</span><span class="op" id="7348341">(</span><span class="ident" id="7348342">rest</span><span class="op" id="7348346">)</span><span class="op" id="7348347">;</span>&nbsp;<span class="ident" id="7348349">e</span>&nbsp;<span class="op" id="7348351">!=</span>&nbsp;<span class="ident" id="7348354">g</span>&nbsp;<span class="op" id="7348356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348361">g</span>&nbsp;<span class="op" id="7348363">=</span>&nbsp;<span class="ident" id="7348365">regexp</span><span class="op" id="7348371">.</span><span class="ident" id="7348372">MustCompile</span><span class="op" id="7348383">(</span><span class="string" id="7348384">`(xx+)`</span><span class="op" id="7348391">)</span><span class="op" id="7348392">.</span><span class="ident" id="7348393">ReplaceAllStringFunc</span><span class="op" id="7348413">(</span><span class="ident" id="7348414">g</span><span class="op" id="7348415">,</span>&nbsp;<span class="keyword" id="7348417">func</span><span class="op" id="7348421">(</span><span class="ident" id="7348422">match</span>&nbsp;<span class="builtintype" id="7348428">string</span><span class="op" id="7348434">)</span>&nbsp;<span class="builtintype" id="7348436">string</span>&nbsp;<span class="op" id="7348443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7348449">return</span>&nbsp;<span class="ident" id="7348456">fmt</span><span class="op" id="7348459">.</span><span class="ident" id="7348460">Sprintf</span><span class="op" id="7348467">(</span><span class="string" id="7348468">&#34;x(repeated&nbsp;x%d)&#34;</span><span class="op" id="7348485">,</span>&nbsp;<span class="builtinfunc" id="7348487">len</span><span class="op" id="7348490">(</span><span class="ident" id="7348491">match</span><span class="op" id="7348496">)</span><span class="op" id="7348497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7348502">}</span><span class="op" id="7348503">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348508">fatalf</span><span class="op" id="7348514">(</span><span class="string" id="7348515">&#34;remainder&nbsp;=&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7348544">,</span>&nbsp;<span class="ident" id="7348546">g</span><span class="op" id="7348547">,</span>&nbsp;<span class="ident" id="7348549">e</span><span class="op" id="7348550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7348554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7348557">}</span><br>
<span class="lineno"></span><span class="op" id="7348559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="keyword" id="7348562">func</span>&nbsp;<span class="ident" id="7348567">diff</span><span class="op" id="7348571">(</span><span class="ident" id="7348572">t</span>&nbsp;<span class="op" id="7348574">*</span><span class="ident" id="7348575">testing</span><span class="op" id="7348582">.</span><span class="ident" id="7348583">T</span><span class="op" id="7348584">,</span>&nbsp;<span class="ident" id="7348586">prefix</span>&nbsp;<span class="builtintype" id="7348593">string</span><span class="op" id="7348599">,</span>&nbsp;<span class="ident" id="7348601">have</span><span class="op" id="7348605">,</span>&nbsp;<span class="ident" id="7348607">want</span>&nbsp;<span class="keyword" id="7348612">interface</span><span class="op" id="7348621">{</span><span class="op" id="7348622">}</span><span class="op" id="7348623">)</span>&nbsp;<span class="op" id="7348625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348628">hv</span>&nbsp;<span class="op" id="7348631">:=</span>&nbsp;<span class="ident" id="7348634">reflect</span><span class="op" id="7348641">.</span><span class="ident" id="7348642">ValueOf</span><span class="op" id="7348649">(</span><span class="ident" id="7348650">have</span><span class="op" id="7348654">)</span><span class="op" id="7348655">.</span><span class="ident" id="7348656">Elem</span><span class="op" id="7348660">(</span><span class="op" id="7348661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348664">wv</span>&nbsp;<span class="op" id="7348667">:=</span>&nbsp;<span class="ident" id="7348670">reflect</span><span class="op" id="7348677">.</span><span class="ident" id="7348678">ValueOf</span><span class="op" id="7348685">(</span><span class="ident" id="7348686">want</span><span class="op" id="7348690">)</span><span class="op" id="7348691">.</span><span class="ident" id="7348692">Elem</span><span class="op" id="7348696">(</span><span class="op" id="7348697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7348700">if</span>&nbsp;<span class="ident" id="7348703">hv</span><span class="op" id="7348705">.</span><span class="ident" id="7348706">Type</span><span class="op" id="7348710">(</span><span class="op" id="7348711">)</span>&nbsp;<span class="op" id="7348713">!=</span>&nbsp;<span class="ident" id="7348716">wv</span><span class="op" id="7348718">.</span><span class="ident" id="7348719">Type</span><span class="op" id="7348723">(</span><span class="op" id="7348724">)</span>&nbsp;<span class="op" id="7348726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348730">t</span><span class="op" id="7348731">.</span><span class="ident" id="7348732">Errorf</span><span class="op" id="7348738">(</span><span class="string" id="7348739">&#34;%s:&nbsp;type&nbsp;mismatch&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7348769">,</span>&nbsp;<span class="ident" id="7348771">prefix</span><span class="op" id="7348777">,</span>&nbsp;<span class="ident" id="7348779">hv</span><span class="op" id="7348781">.</span><span class="ident" id="7348782">Type</span><span class="op" id="7348786">(</span><span class="op" id="7348787">)</span><span class="op" id="7348788">,</span>&nbsp;<span class="ident" id="7348790">wv</span><span class="op" id="7348792">.</span><span class="ident" id="7348793">Type</span><span class="op" id="7348797">(</span><span class="op" id="7348798">)</span><span class="op" id="7348799">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7348802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7348805">for</span>&nbsp;<span class="ident" id="7348809">i</span>&nbsp;<span class="op" id="7348811">:=</span>&nbsp;<span class="num" id="7348814">0</span><span class="op" id="7348815">;</span>&nbsp;<span class="ident" id="7348817">i</span>&nbsp;<span class="op" id="7348819">&lt;</span>&nbsp;<span class="ident" id="7348821">hv</span><span class="op" id="7348823">.</span><span class="ident" id="7348824">NumField</span><span class="op" id="7348832">(</span><span class="op" id="7348833">)</span><span class="op" id="7348834">;</span>&nbsp;<span class="ident" id="7348836">i</span><span class="op" id="7348837">++</span>&nbsp;<span class="op" id="7348840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348844">hf</span>&nbsp;<span class="op" id="7348847">:=</span>&nbsp;<span class="ident" id="7348850">hv</span><span class="op" id="7348852">.</span><span class="ident" id="7348853">Field</span><span class="op" id="7348858">(</span><span class="ident" id="7348859">i</span><span class="op" id="7348860">)</span><span class="op" id="7348861">.</span><span class="ident" id="7348862">Interface</span><span class="op" id="7348871">(</span><span class="op" id="7348872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348876">wf</span>&nbsp;<span class="op" id="7348879">:=</span>&nbsp;<span class="ident" id="7348882">wv</span><span class="op" id="7348884">.</span><span class="ident" id="7348885">Field</span><span class="op" id="7348890">(</span><span class="ident" id="7348891">i</span><span class="op" id="7348892">)</span><span class="op" id="7348893">.</span><span class="ident" id="7348894">Interface</span><span class="op" id="7348903">(</span><span class="op" id="7348904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7348908">if</span>&nbsp;<span class="op" id="7348911">!</span><span class="ident" id="7348912">reflect</span><span class="op" id="7348919">.</span><span class="ident" id="7348920">DeepEqual</span><span class="op" id="7348929">(</span><span class="ident" id="7348930">hf</span><span class="op" id="7348932">,</span>&nbsp;<span class="ident" id="7348934">wf</span><span class="op" id="7348936">)</span>&nbsp;<span class="op" id="7348938">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7348943">t</span><span class="op" id="7348944">.</span><span class="ident" id="7348945">Errorf</span><span class="op" id="7348951">(</span><span class="string" id="7348952">&#34;%s:&nbsp;%s&nbsp;=&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7348973">,</span>&nbsp;<span class="ident" id="7348975">prefix</span><span class="op" id="7348981">,</span>&nbsp;<span class="ident" id="7348983">hv</span><span class="op" id="7348985">.</span><span class="ident" id="7348986">Type</span><span class="op" id="7348990">(</span><span class="op" id="7348991">)</span><span class="op" id="7348992">.</span><span class="ident" id="7348993">Field</span><span class="op" id="7348998">(</span><span class="ident" id="7348999">i</span><span class="op" id="7349000">)</span><span class="op" id="7349001">.</span><span class="ident" id="7349002">Name</span><span class="op" id="7349006">,</span>&nbsp;<span class="ident" id="7349008">hf</span><span class="op" id="7349010">,</span>&nbsp;<span class="ident" id="7349012">wf</span><span class="op" id="7349014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349021">}</span><br>
<span class="lineno"></span><span class="op" id="7349023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">565</span><span class="keyword" id="7349026">type</span>&nbsp;<span class="ident" id="7349031">responseLocationTest</span>&nbsp;<span class="keyword" id="7349052">struct</span>&nbsp;<span class="op" id="7349059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349062">location</span>&nbsp;<span class="builtintype" id="7349071">string</span>&nbsp;<span class="comment" id="7349078">//&nbsp;Response&#39;s&nbsp;Location&nbsp;header&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349115">requrl</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7349124">string</span>&nbsp;<span class="comment" id="7349131">//&nbsp;Response.Request.URL&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349162">want</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7349171">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349179">wantErr</span>&nbsp;&nbsp;<span class="builtintype" id="7349188">error</span><br>
<span class="lineno">570</span><span class="op" id="7349194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7349197">var</span>&nbsp;<span class="ident" id="7349201">responseLocationTests</span>&nbsp;<span class="op" id="7349223">=</span>&nbsp;<span class="op" id="7349225">[</span><span class="op" id="7349226">]</span><span class="ident" id="7349227">responseLocationTest</span><span class="op" id="7349247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349250">{</span><span class="string" id="7349251">&#34;/foo&#34;</span><span class="op" id="7349257">,</span>&nbsp;<span class="string" id="7349259">&#34;http://bar.com/baz&#34;</span><span class="op" id="7349279">,</span>&nbsp;<span class="string" id="7349281">&#34;http://bar.com/foo&#34;</span><span class="op" id="7349301">,</span>&nbsp;<span class="ident" id="7349303">nil</span><span class="op" id="7349306">}</span><span class="op" id="7349307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349310">{</span><span class="string" id="7349311">&#34;http://foo.com/&#34;</span><span class="op" id="7349328">,</span>&nbsp;<span class="string" id="7349330">&#34;http://bar.com/baz&#34;</span><span class="op" id="7349350">,</span>&nbsp;<span class="string" id="7349352">&#34;http://foo.com/&#34;</span><span class="op" id="7349369">,</span>&nbsp;<span class="ident" id="7349371">nil</span><span class="op" id="7349374">}</span><span class="op" id="7349375">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349378">{</span><span class="string" id="7349379">&#34;&#34;</span><span class="op" id="7349381">,</span>&nbsp;<span class="string" id="7349383">&#34;http://bar.com/baz&#34;</span><span class="op" id="7349403">,</span>&nbsp;<span class="string" id="7349405">&#34;&#34;</span><span class="op" id="7349407">,</span>&nbsp;<span class="ident" id="7349409">ErrNoLocation</span><span class="op" id="7349422">}</span><span class="op" id="7349423">,</span><br>
<span class="lineno"></span><span class="op" id="7349425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7349428">func</span>&nbsp;<span class="ident" id="7349433">TestLocationResponse</span><span class="op" id="7349453">(</span><span class="ident" id="7349454">t</span>&nbsp;<span class="op" id="7349456">*</span><span class="ident" id="7349457">testing</span><span class="op" id="7349464">.</span><span class="ident" id="7349465">T</span><span class="op" id="7349466">)</span>&nbsp;<span class="op" id="7349468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7349471">for</span>&nbsp;<span class="ident" id="7349475">i</span><span class="op" id="7349476">,</span>&nbsp;<span class="ident" id="7349478">tt</span>&nbsp;<span class="op" id="7349481">:=</span>&nbsp;<span class="keyword" id="7349484">range</span>&nbsp;<span class="ident" id="7349490">responseLocationTests</span>&nbsp;<span class="op" id="7349512">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349516">res</span>&nbsp;<span class="op" id="7349520">:=</span>&nbsp;<span class="builtinfunc" id="7349523">new</span><span class="op" id="7349526">(</span><span class="ident" id="7349527">Response</span><span class="op" id="7349535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349539">res</span><span class="op" id="7349542">.</span><span class="ident" id="7349543">Header</span>&nbsp;<span class="op" id="7349550">=</span>&nbsp;<span class="builtinfunc" id="7349552">make</span><span class="op" id="7349556">(</span><span class="ident" id="7349557">Header</span><span class="op" id="7349563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349567">res</span><span class="op" id="7349570">.</span><span class="ident" id="7349571">Header</span><span class="op" id="7349577">.</span><span class="ident" id="7349578">Set</span><span class="op" id="7349581">(</span><span class="string" id="7349582">&#34;Location&#34;</span><span class="op" id="7349592">,</span>&nbsp;<span class="ident" id="7349594">tt</span><span class="op" id="7349596">.</span><span class="ident" id="7349597">location</span><span class="op" id="7349605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7349609">if</span>&nbsp;<span class="ident" id="7349612">tt</span><span class="op" id="7349614">.</span><span class="ident" id="7349615">requrl</span>&nbsp;<span class="op" id="7349622">!=</span>&nbsp;<span class="string" id="7349625">&#34;&#34;</span>&nbsp;<span class="op" id="7349628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349633">res</span><span class="op" id="7349636">.</span><span class="ident" id="7349637">Request</span>&nbsp;<span class="op" id="7349645">=</span>&nbsp;<span class="op" id="7349647">&amp;</span><span class="ident" id="7349648">Request</span><span class="op" id="7349655">{</span><span class="op" id="7349656">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7349661">var</span>&nbsp;<span class="ident" id="7349665">err</span>&nbsp;<span class="builtintype" id="7349669">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349678">res</span><span class="op" id="7349681">.</span><span class="ident" id="7349682">Request</span><span class="op" id="7349689">.</span><span class="ident" id="7349690">URL</span><span class="op" id="7349693">,</span>&nbsp;<span class="ident" id="7349695">err</span>&nbsp;<span class="op" id="7349699">=</span>&nbsp;<span class="ident" id="7349701">url</span><span class="op" id="7349704">.</span><span class="ident" id="7349705">Parse</span><span class="op" id="7349710">(</span><span class="ident" id="7349711">tt</span><span class="op" id="7349713">.</span><span class="ident" id="7349714">requrl</span><span class="op" id="7349720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7349725">if</span>&nbsp;<span class="ident" id="7349728">err</span>&nbsp;<span class="op" id="7349732">!=</span>&nbsp;<span class="ident" id="7349735">nil</span>&nbsp;<span class="op" id="7349739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349745">t</span><span class="op" id="7349746">.</span><span class="ident" id="7349747">Fatalf</span><span class="op" id="7349753">(</span><span class="string" id="7349754">&#34;bad&nbsp;test&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="7349775">,</span>&nbsp;<span class="ident" id="7349777">tt</span><span class="op" id="7349779">.</span><span class="ident" id="7349780">requrl</span><span class="op" id="7349786">,</span>&nbsp;<span class="ident" id="7349788">err</span><span class="op" id="7349791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349796">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349805">got</span><span class="op" id="7349808">,</span>&nbsp;<span class="ident" id="7349810">err</span>&nbsp;<span class="op" id="7349814">:=</span>&nbsp;<span class="ident" id="7349817">res</span><span class="op" id="7349820">.</span><span class="ident" id="7349821">Location</span><span class="op" id="7349829">(</span><span class="op" id="7349830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7349834">if</span>&nbsp;<span class="ident" id="7349837">tt</span><span class="op" id="7349839">.</span><span class="ident" id="7349840">wantErr</span>&nbsp;<span class="op" id="7349848">!=</span>&nbsp;<span class="ident" id="7349851">nil</span>&nbsp;<span class="op" id="7349855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7349860">if</span>&nbsp;<span class="ident" id="7349863">err</span>&nbsp;<span class="op" id="7349867">==</span>&nbsp;<span class="ident" id="7349870">nil</span>&nbsp;<span class="op" id="7349874">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7349880">t</span><span class="op" id="7349881">.</span><span class="ident" id="7349882">Errorf</span><span class="op" id="7349888">(</span><span class="string" id="7349889">&#34;%d.&nbsp;err=nil;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7349911">,</span>&nbsp;<span class="ident" id="7349913">i</span><span class="op" id="7349914">,</span>&nbsp;<span class="ident" id="7349916">tt</span><span class="op" id="7349918">.</span><span class="ident" id="7349919">wantErr</span><span class="op" id="7349926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7349932">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7349944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7349949">if</span>&nbsp;<span class="ident" id="7349952">g</span><span class="op" id="7349953">,</span>&nbsp;<span class="ident" id="7349955">e</span>&nbsp;<span class="op" id="7349957">:=</span>&nbsp;<span class="ident" id="7349960">err</span><span class="op" id="7349963">.</span><span class="ident" id="7349964">Error</span><span class="op" id="7349969">(</span><span class="op" id="7349970">)</span><span class="op" id="7349971">,</span>&nbsp;<span class="ident" id="7349973">tt</span><span class="op" id="7349975">.</span><span class="ident" id="7349976">wantErr</span><span class="op" id="7349983">.</span><span class="ident" id="7349984">Error</span><span class="op" id="7349989">(</span><span class="op" id="7349990">)</span><span class="op" id="7349991">;</span>&nbsp;<span class="ident" id="7349993">g</span>&nbsp;<span class="op" id="7349995">!=</span>&nbsp;<span class="ident" id="7349998">e</span>&nbsp;<span class="op" id="7350000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350006">t</span><span class="op" id="7350007">.</span><span class="ident" id="7350008">Errorf</span><span class="op" id="7350014">(</span><span class="string" id="7350015">&#34;%d.&nbsp;err=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7350036">,</span>&nbsp;<span class="ident" id="7350038">i</span><span class="op" id="7350039">,</span>&nbsp;<span class="ident" id="7350041">g</span><span class="op" id="7350042">,</span>&nbsp;<span class="ident" id="7350044">e</span><span class="op" id="7350045">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350051">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350068">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350083">if</span>&nbsp;<span class="ident" id="7350086">err</span>&nbsp;<span class="op" id="7350090">!=</span>&nbsp;<span class="ident" id="7350093">nil</span>&nbsp;<span class="op" id="7350097">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350102">t</span><span class="op" id="7350103">.</span><span class="ident" id="7350104">Errorf</span><span class="op" id="7350110">(</span><span class="string" id="7350111">&#34;%d.&nbsp;err=%q&#34;</span><span class="op" id="7350123">,</span>&nbsp;<span class="ident" id="7350125">i</span><span class="op" id="7350126">,</span>&nbsp;<span class="ident" id="7350128">err</span><span class="op" id="7350131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350136">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350151">if</span>&nbsp;<span class="ident" id="7350154">g</span><span class="op" id="7350155">,</span>&nbsp;<span class="ident" id="7350157">e</span>&nbsp;<span class="op" id="7350159">:=</span>&nbsp;<span class="ident" id="7350162">got</span><span class="op" id="7350165">.</span><span class="ident" id="7350166">String</span><span class="op" id="7350172">(</span><span class="op" id="7350173">)</span><span class="op" id="7350174">,</span>&nbsp;<span class="ident" id="7350176">tt</span><span class="op" id="7350178">.</span><span class="ident" id="7350179">want</span><span class="op" id="7350183">;</span>&nbsp;<span class="ident" id="7350185">g</span>&nbsp;<span class="op" id="7350187">!=</span>&nbsp;<span class="ident" id="7350190">e</span>&nbsp;<span class="op" id="7350192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350197">t</span><span class="op" id="7350198">.</span><span class="ident" id="7350199">Errorf</span><span class="op" id="7350205">(</span><span class="string" id="7350206">&#34;%d.&nbsp;Location=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7350232">,</span>&nbsp;<span class="ident" id="7350234">i</span><span class="op" id="7350235">,</span>&nbsp;<span class="ident" id="7350237">g</span><span class="op" id="7350238">,</span>&nbsp;<span class="ident" id="7350240">e</span><span class="op" id="7350241">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350248">}</span><br>
<span class="lineno"></span><span class="op" id="7350250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7350253">func</span>&nbsp;<span class="ident" id="7350258">TestResponseStatusStutter</span><span class="op" id="7350283">(</span><span class="ident" id="7350284">t</span>&nbsp;<span class="op" id="7350286">*</span><span class="ident" id="7350287">testing</span><span class="op" id="7350294">.</span><span class="ident" id="7350295">T</span><span class="op" id="7350296">)</span>&nbsp;<span class="op" id="7350298">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350301">r</span>&nbsp;<span class="op" id="7350303">:=</span>&nbsp;<span class="op" id="7350306">&amp;</span><span class="ident" id="7350307">Response</span><span class="op" id="7350315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350319">Status</span><span class="op" id="7350325">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7350331">&#34;123&nbsp;some&nbsp;status&#34;</span><span class="op" id="7350348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350352">StatusCode</span><span class="op" id="7350362">:</span>&nbsp;<span class="num" id="7350364">123</span><span class="op" id="7350367">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350371">ProtoMajor</span><span class="op" id="7350381">:</span>&nbsp;<span class="num" id="7350383">1</span><span class="op" id="7350384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350388">ProtoMinor</span><span class="op" id="7350398">:</span>&nbsp;<span class="num" id="7350400">3</span><span class="op" id="7350401">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350407">var</span>&nbsp;<span class="ident" id="7350411">buf</span>&nbsp;<span class="ident" id="7350415">bytes</span><span class="op" id="7350420">.</span><span class="ident" id="7350421">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350429">r</span><span class="op" id="7350430">.</span><span class="ident" id="7350431">Write</span><span class="op" id="7350436">(</span><span class="op" id="7350437">&amp;</span><span class="ident" id="7350438">buf</span><span class="op" id="7350441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350444">if</span>&nbsp;<span class="ident" id="7350447">strings</span><span class="op" id="7350454">.</span><span class="ident" id="7350455">Contains</span><span class="op" id="7350463">(</span><span class="ident" id="7350464">buf</span><span class="op" id="7350467">.</span><span class="ident" id="7350468">String</span><span class="op" id="7350474">(</span><span class="op" id="7350475">)</span><span class="op" id="7350476">,</span>&nbsp;<span class="string" id="7350478">&#34;123&nbsp;123&#34;</span><span class="op" id="7350487">)</span>&nbsp;<span class="op" id="7350489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350493">t</span><span class="op" id="7350494">.</span><span class="ident" id="7350495">Errorf</span><span class="op" id="7350501">(</span><span class="string" id="7350502">&#34;stutter&nbsp;in&nbsp;status:&nbsp;%s&#34;</span><span class="op" id="7350525">,</span>&nbsp;<span class="ident" id="7350527">buf</span><span class="op" id="7350530">.</span><span class="ident" id="7350531">String</span><span class="op" id="7350537">(</span><span class="op" id="7350538">)</span><span class="op" id="7350539">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350542">}</span><br>
<span class="lineno"></span><span class="op" id="7350544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7350547">func</span>&nbsp;<span class="ident" id="7350552">TestResponseContentLengthShortBody</span><span class="op" id="7350586">(</span><span class="ident" id="7350587">t</span>&nbsp;<span class="op" id="7350589">*</span><span class="ident" id="7350590">testing</span><span class="op" id="7350597">.</span><span class="ident" id="7350598">T</span><span class="op" id="7350599">)</span>&nbsp;<span class="op" id="7350601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350604">const</span>&nbsp;<span class="ident" id="7350610">shortBody</span>&nbsp;<span class="op" id="7350620">=</span>&nbsp;<span class="string" id="7350622">&#34;Short&nbsp;body,&nbsp;not&nbsp;123&nbsp;bytes.&#34;</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350652">br</span>&nbsp;<span class="op" id="7350655">:=</span>&nbsp;<span class="ident" id="7350658">bufio</span><span class="op" id="7350663">.</span><span class="ident" id="7350664">NewReader</span><span class="op" id="7350673">(</span><span class="ident" id="7350674">strings</span><span class="op" id="7350681">.</span><span class="ident" id="7350682">NewReader</span><span class="op" id="7350691">(</span><span class="string" id="7350692">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7350714">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7350718">&#34;Content-Length:&nbsp;123\r\n&#34;</span>&nbsp;<span class="op" id="7350744">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7350748">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7350755">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350759">shortBody</span><span class="op" id="7350768">)</span><span class="op" id="7350769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350772">res</span><span class="op" id="7350775">,</span>&nbsp;<span class="ident" id="7350777">err</span>&nbsp;<span class="op" id="7350781">:=</span>&nbsp;<span class="ident" id="7350784">ReadResponse</span><span class="op" id="7350796">(</span><span class="ident" id="7350797">br</span><span class="op" id="7350799">,</span>&nbsp;<span class="op" id="7350801">&amp;</span><span class="ident" id="7350802">Request</span><span class="op" id="7350809">{</span><span class="ident" id="7350810">Method</span><span class="op" id="7350816">:</span>&nbsp;<span class="string" id="7350818">&#34;GET&#34;</span><span class="op" id="7350823">}</span><span class="op" id="7350824">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350827">if</span>&nbsp;<span class="ident" id="7350830">err</span>&nbsp;<span class="op" id="7350834">!=</span>&nbsp;<span class="ident" id="7350837">nil</span>&nbsp;<span class="op" id="7350841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350845">t</span><span class="op" id="7350846">.</span><span class="ident" id="7350847">Fatal</span><span class="op" id="7350852">(</span><span class="ident" id="7350853">err</span><span class="op" id="7350856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350862">if</span>&nbsp;<span class="ident" id="7350865">res</span><span class="op" id="7350868">.</span><span class="ident" id="7350869">ContentLength</span>&nbsp;<span class="op" id="7350883">!=</span>&nbsp;<span class="num" id="7350886">123</span>&nbsp;<span class="op" id="7350890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350894">t</span><span class="op" id="7350895">.</span><span class="ident" id="7350896">Fatalf</span><span class="op" id="7350902">(</span><span class="string" id="7350903">&#34;Content-Length&nbsp;=&nbsp;%d;&nbsp;want&nbsp;123&#34;</span><span class="op" id="7350934">,</span>&nbsp;<span class="ident" id="7350936">res</span><span class="op" id="7350939">.</span><span class="ident" id="7350940">ContentLength</span><span class="op" id="7350953">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7350956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7350959">var</span>&nbsp;<span class="ident" id="7350963">buf</span>&nbsp;<span class="ident" id="7350967">bytes</span><span class="op" id="7350972">.</span><span class="ident" id="7350973">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7350981">n</span><span class="op" id="7350982">,</span>&nbsp;<span class="ident" id="7350984">err</span>&nbsp;<span class="op" id="7350988">:=</span>&nbsp;<span class="ident" id="7350991">io</span><span class="op" id="7350993">.</span><span class="ident" id="7350994">Copy</span><span class="op" id="7350998">(</span><span class="op" id="7350999">&amp;</span><span class="ident" id="7351000">buf</span><span class="op" id="7351003">,</span>&nbsp;<span class="ident" id="7351005">res</span><span class="op" id="7351008">.</span><span class="ident" id="7351009">Body</span><span class="op" id="7351013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7351016">if</span>&nbsp;<span class="ident" id="7351019">n</span>&nbsp;<span class="op" id="7351021">!=</span>&nbsp;<span class="ident" id="7351024">int64</span><span class="op" id="7351029">(</span><span class="builtinfunc" id="7351030">len</span><span class="op" id="7351033">(</span><span class="ident" id="7351034">shortBody</span><span class="op" id="7351043">)</span><span class="op" id="7351044">)</span>&nbsp;<span class="op" id="7351046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351050">t</span><span class="op" id="7351051">.</span><span class="ident" id="7351052">Errorf</span><span class="op" id="7351058">(</span><span class="string" id="7351059">&#34;Copied&nbsp;%d&nbsp;bytes;&nbsp;want&nbsp;%d,&nbsp;len(%q)&#34;</span><span class="op" id="7351094">,</span>&nbsp;<span class="ident" id="7351096">n</span><span class="op" id="7351097">,</span>&nbsp;<span class="builtinfunc" id="7351099">len</span><span class="op" id="7351102">(</span><span class="ident" id="7351103">shortBody</span><span class="op" id="7351112">)</span><span class="op" id="7351113">,</span>&nbsp;<span class="ident" id="7351115">shortBody</span><span class="op" id="7351124">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7351127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7351130">if</span>&nbsp;<span class="ident" id="7351133">buf</span><span class="op" id="7351136">.</span><span class="ident" id="7351137">String</span><span class="op" id="7351143">(</span><span class="op" id="7351144">)</span>&nbsp;<span class="op" id="7351146">!=</span>&nbsp;<span class="ident" id="7351149">shortBody</span>&nbsp;<span class="op" id="7351159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351163">t</span><span class="op" id="7351164">.</span><span class="ident" id="7351165">Errorf</span><span class="op" id="7351171">(</span><span class="string" id="7351172">&#34;Read&nbsp;body&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7351195">,</span>&nbsp;<span class="ident" id="7351197">buf</span><span class="op" id="7351200">.</span><span class="ident" id="7351201">String</span><span class="op" id="7351207">(</span><span class="op" id="7351208">)</span><span class="op" id="7351209">,</span>&nbsp;<span class="ident" id="7351211">shortBody</span><span class="op" id="7351220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7351223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7351226">if</span>&nbsp;<span class="ident" id="7351229">err</span>&nbsp;<span class="op" id="7351233">!=</span>&nbsp;<span class="ident" id="7351236">io</span><span class="op" id="7351238">.</span><span class="ident" id="7351239">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="7351256">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351260">t</span><span class="op" id="7351261">.</span><span class="ident" id="7351262">Errorf</span><span class="op" id="7351268">(</span><span class="string" id="7351269">&#34;io.Copy&nbsp;error&nbsp;=&nbsp;%#v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="7351316">,</span>&nbsp;<span class="ident" id="7351318">err</span><span class="op" id="7351321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7351324">}</span><br>
<span class="lineno"></span><span class="op" id="7351326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7351329">func</span>&nbsp;<span class="ident" id="7351334">TestReadResponseUnexpectedEOF</span><span class="op" id="7351363">(</span><span class="ident" id="7351364">t</span>&nbsp;<span class="op" id="7351366">*</span><span class="ident" id="7351367">testing</span><span class="op" id="7351374">.</span><span class="ident" id="7351375">T</span><span class="op" id="7351376">)</span>&nbsp;<span class="op" id="7351378">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351381">br</span>&nbsp;<span class="op" id="7351384">:=</span>&nbsp;<span class="ident" id="7351387">bufio</span><span class="op" id="7351392">.</span><span class="ident" id="7351393">NewReader</span><span class="op" id="7351402">(</span><span class="ident" id="7351403">strings</span><span class="op" id="7351410">.</span><span class="ident" id="7351411">NewReader</span><span class="op" id="7351420">(</span><span class="string" id="7351421">&#34;HTTP/1.1&nbsp;301&nbsp;Moved&nbsp;Permanently\r\n&#34;</span>&nbsp;<span class="op" id="7351458">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7351462">&#34;Location:&nbsp;http://example.com&#34;</span><span class="op" id="7351492">)</span><span class="op" id="7351493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351496">_</span><span class="op" id="7351497">,</span>&nbsp;<span class="ident" id="7351499">err</span>&nbsp;<span class="op" id="7351503">:=</span>&nbsp;<span class="ident" id="7351506">ReadResponse</span><span class="op" id="7351518">(</span><span class="ident" id="7351519">br</span><span class="op" id="7351521">,</span>&nbsp;<span class="ident" id="7351523">nil</span><span class="op" id="7351526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7351529">if</span>&nbsp;<span class="ident" id="7351532">err</span>&nbsp;<span class="op" id="7351536">!=</span>&nbsp;<span class="ident" id="7351539">io</span><span class="op" id="7351541">.</span><span class="ident" id="7351542">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="7351559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351563">t</span><span class="op" id="7351564">.</span><span class="ident" id="7351565">Errorf</span><span class="op" id="7351571">(</span><span class="string" id="7351572">&#34;ReadResponse&nbsp;=&nbsp;%v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="7351617">,</span>&nbsp;<span class="ident" id="7351619">err</span><span class="op" id="7351622">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7351625">}</span><br>
<span class="lineno"></span><span class="op" id="7351627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7351630">func</span>&nbsp;<span class="ident" id="7351635">TestNeedsSniff</span><span class="op" id="7351649">(</span><span class="ident" id="7351650">t</span>&nbsp;<span class="op" id="7351652">*</span><span class="ident" id="7351653">testing</span><span class="op" id="7351660">.</span><span class="ident" id="7351661">T</span><span class="op" id="7351662">)</span>&nbsp;<span class="op" id="7351664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7351667">//&nbsp;needsSniff&nbsp;returns&nbsp;true&nbsp;with&nbsp;an&nbsp;empty&nbsp;response.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351719">r</span>&nbsp;<span class="op" id="7351721">:=</span>&nbsp;<span class="op" id="7351724">&amp;</span><span class="ident" id="7351725">response</span><span class="op" id="7351733">{</span><span class="op" id="7351734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7351737">if</span>&nbsp;<span class="ident" id="7351740">got</span><span class="op" id="7351743">,</span>&nbsp;<span class="ident" id="7351745">want</span>&nbsp;<span class="op" id="7351750">:=</span>&nbsp;<span class="ident" id="7351753">r</span><span class="op" id="7351754">.</span><span class="ident" id="7351755">needsSniff</span><span class="op" id="7351765">(</span><span class="op" id="7351766">)</span><span class="op" id="7351767">,</span>&nbsp;<span class="builtintype" id="7351769">true</span><span class="op" id="7351773">;</span>&nbsp;<span class="ident" id="7351775">got</span>&nbsp;<span class="op" id="7351779">!=</span>&nbsp;<span class="ident" id="7351782">want</span>&nbsp;<span class="op" id="7351787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351791">t</span><span class="op" id="7351792">.</span><span class="ident" id="7351793">Errorf</span><span class="op" id="7351799">(</span><span class="string" id="7351800">&#34;needsSniff&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="7351826">,</span>&nbsp;<span class="ident" id="7351828">got</span><span class="op" id="7351831">,</span>&nbsp;<span class="ident" id="7351833">want</span><span class="op" id="7351837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7351840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7351843">//&nbsp;needsSniff&nbsp;returns&nbsp;false&nbsp;when&nbsp;Content-Type&nbsp;=&nbsp;nil.</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351897">r</span><span class="op" id="7351898">.</span><span class="ident" id="7351899">handlerHeader</span>&nbsp;<span class="op" id="7351913">=</span>&nbsp;<span class="ident" id="7351915">Header</span><span class="op" id="7351921">{</span><span class="string" id="7351922">&#34;Content-Type&#34;</span><span class="op" id="7351936">:</span>&nbsp;<span class="ident" id="7351938">nil</span><span class="op" id="7351941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7351944">if</span>&nbsp;<span class="ident" id="7351947">got</span><span class="op" id="7351950">,</span>&nbsp;<span class="ident" id="7351952">want</span>&nbsp;<span class="op" id="7351957">:=</span>&nbsp;<span class="ident" id="7351960">r</span><span class="op" id="7351961">.</span><span class="ident" id="7351962">needsSniff</span><span class="op" id="7351972">(</span><span class="op" id="7351973">)</span><span class="op" id="7351974">,</span>&nbsp;<span class="builtintype" id="7351976">false</span><span class="op" id="7351981">;</span>&nbsp;<span class="ident" id="7351983">got</span>&nbsp;<span class="op" id="7351987">!=</span>&nbsp;<span class="ident" id="7351990">want</span>&nbsp;<span class="op" id="7351995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7351999">t</span><span class="op" id="7352000">.</span><span class="ident" id="7352001">Errorf</span><span class="op" id="7352007">(</span><span class="string" id="7352008">&#34;needsSniff&nbsp;empty&nbsp;Content-Type&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="7352053">,</span>&nbsp;<span class="ident" id="7352055">got</span><span class="op" id="7352058">,</span>&nbsp;<span class="ident" id="7352060">want</span><span class="op" id="7352064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7352067">}</span><br>
<span class="lineno"></span><span class="op" id="7352069">}</span>
</div>
</body>
</html>
