<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html" class="current">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2505179">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2505235">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2505289">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2505340">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2505405">//&nbsp;Socket&nbsp;control&nbsp;messages</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2505433">package</span>&nbsp;<span class="ident" id="2505441">syscall</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="2505450">import</span>&nbsp;<span class="string" id="2505457">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2505467">//&nbsp;Round&nbsp;the&nbsp;length&nbsp;of&nbsp;a&nbsp;raw&nbsp;sockaddr&nbsp;up&nbsp;to&nbsp;align&nbsp;it&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="2505530">func</span>&nbsp;<span class="ident" id="2505535">cmsgAlignOf</span><span class="op" id="2505546">(</span><span class="ident" id="2505547">salen</span>&nbsp;<span class="builtintype" id="2505553">int</span><span class="op" id="2505556">)</span>&nbsp;<span class="builtintype" id="2505558">int</span>&nbsp;<span class="op" id="2505562">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505565">salign</span>&nbsp;<span class="op" id="2505572">:=</span>&nbsp;<span class="ident" id="2505575"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2666275">sizeofPtr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2505586">//&nbsp;NOTE:&nbsp;It&nbsp;seems&nbsp;like&nbsp;64-bit&nbsp;Darwin&nbsp;and&nbsp;DragonFly&nbsp;BSD&nbsp;kernels</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2505650">//&nbsp;still&nbsp;require&nbsp;32-bit&nbsp;aligned&nbsp;access&nbsp;to&nbsp;network&nbsp;subsystem.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505712">if</span>&nbsp;<span class="ident" id="2505715"><a href="/gostd/syscall/syscall_unix.go.html#2543669">darwin64Bit</a></span>&nbsp;<span class="op" id="2505727">||</span>&nbsp;<span class="ident" id="2505730"><a href="/gostd/syscall/syscall_unix.go.html#2543730">dragonfly64Bit</a></span>&nbsp;<span class="op" id="2505745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2505749"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505565">salign</a></span>&nbsp;<span class="op" id="2505756">=</span>&nbsp;<span class="num" id="2505758">4</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2505761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505764">return</span>&nbsp;<span class="op" id="2505771">(</span><span class="ident" id="2505772"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505547">salen</a></span>&nbsp;<span class="op" id="2505778">+</span>&nbsp;<span class="ident" id="2505780"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505565">salign</a></span>&nbsp;<span class="op" id="2505787">-</span>&nbsp;<span class="num" id="2505789">1</span><span class="op" id="2505790">)</span>&nbsp;<span class="op" id="2505792">&amp;</span>&nbsp;<span class="op" id="2505794">^</span><span class="op" id="2505795">(</span><span class="ident" id="2505796"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505565">salign</a></span>&nbsp;<span class="op" id="2505803">-</span>&nbsp;<span class="num" id="2505805">1</span><span class="op" id="2505806">)</span><br>
<span class="lineno"></span><span class="op" id="2505808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2505811">//&nbsp;CmsgLen&nbsp;returns&nbsp;the&nbsp;value&nbsp;to&nbsp;store&nbsp;in&nbsp;the&nbsp;Len&nbsp;field&nbsp;of&nbsp;the&nbsp;Cmsghdr</span><br>
<span class="lineno">25</span><span class="comment" id="2505881">//&nbsp;structure,&nbsp;taking&nbsp;into&nbsp;account&nbsp;any&nbsp;necessary&nbsp;alignment.</span><br>
<span class="lineno"></span><span class="keyword" id="2505940">func</span>&nbsp;<span class="ident" id="2505945">CmsgLen</span><span class="op" id="2505952">(</span><span class="ident" id="2505953">datalen</span>&nbsp;<span class="builtintype" id="2505961">int</span><span class="op" id="2505964">)</span>&nbsp;<span class="builtintype" id="2505966">int</span>&nbsp;<span class="op" id="2505970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2505973">return</span>&nbsp;<span class="ident" id="2505980"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505535">cmsgAlignOf</a></span><span class="op" id="2505991">(</span><span class="ident" id="2505992"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2671220">SizeofCmsghdr</a></span><span class="op" id="2506005">)</span>&nbsp;<span class="op" id="2506007">+</span>&nbsp;<span class="ident" id="2506009"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505953">datalen</a></span><br>
<span class="lineno"></span><span class="op" id="2506017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="2506020">//&nbsp;CmsgSpace&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;an&nbsp;ancillary&nbsp;element&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2506087">//&nbsp;payload&nbsp;of&nbsp;the&nbsp;passed&nbsp;data&nbsp;length&nbsp;occupies.</span><br>
<span class="lineno"></span><span class="keyword" id="2506134">func</span>&nbsp;<span class="ident" id="2506139">CmsgSpace</span><span class="op" id="2506148">(</span><span class="ident" id="2506149">datalen</span>&nbsp;<span class="builtintype" id="2506157">int</span><span class="op" id="2506160">)</span>&nbsp;<span class="builtintype" id="2506162">int</span>&nbsp;<span class="op" id="2506166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506169">return</span>&nbsp;<span class="ident" id="2506176"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505535">cmsgAlignOf</a></span><span class="op" id="2506187">(</span><span class="ident" id="2506188"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2671220">SizeofCmsghdr</a></span><span class="op" id="2506201">)</span>&nbsp;<span class="op" id="2506203">+</span>&nbsp;<span class="ident" id="2506205"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505535">cmsgAlignOf</a></span><span class="op" id="2506216">(</span><span class="ident" id="2506217"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506149">datalen</a></span><span class="op" id="2506224">)</span><br>
<span class="lineno"></span><span class="op" id="2506226">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="2506229">func</span>&nbsp;<span class="ident" id="2506234">cmsgData</span><span class="op" id="2506242">(</span><span class="ident" id="2506243">h</span>&nbsp;<span class="op" id="2506245">*</span><span class="ident" id="2506246"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2669668">Cmsghdr</a></span><span class="op" id="2506253">)</span>&nbsp;<span class="ident" id="2506255"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505457">unsafe</a></span><span class="op" id="2506261">.</span><span class="ident" id="2506262">Pointer</span>&nbsp;<span class="op" id="2506270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506273">return</span>&nbsp;<span class="ident" id="2506280"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505457">unsafe</a></span><span class="op" id="2506286">.</span><span class="ident" id="2506287">Pointer</span><span class="op" id="2506294">(</span><span class="builtintype" id="2506295">uintptr</span><span class="op" id="2506302">(</span><span class="ident" id="2506303"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505457">unsafe</a></span><span class="op" id="2506309">.</span><span class="ident" id="2506310">Pointer</span><span class="op" id="2506317">(</span><span class="ident" id="2506318"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506243">h</a></span><span class="op" id="2506319">)</span><span class="op" id="2506320">)</span>&nbsp;<span class="op" id="2506322">+</span>&nbsp;<span class="builtintype" id="2506324">uintptr</span><span class="op" id="2506331">(</span><span class="ident" id="2506332"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505535">cmsgAlignOf</a></span><span class="op" id="2506343">(</span><span class="ident" id="2506344"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2671220">SizeofCmsghdr</a></span><span class="op" id="2506357">)</span><span class="op" id="2506358">)</span><span class="op" id="2506359">)</span><br>
<span class="lineno"></span><span class="op" id="2506361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="2506364">//&nbsp;SocketControlMessage&nbsp;represents&nbsp;a&nbsp;socket&nbsp;control&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="2506425">type</span>&nbsp;<span class="ident" id="2506430">SocketControlMessage</span>&nbsp;<span class="keyword" id="2506451">struct</span>&nbsp;<span class="op" id="2506458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506461">Header</span>&nbsp;<span class="ident" id="2506468"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2669668">Cmsghdr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506477">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2506484">[</span><span class="op" id="2506485">]</span><span class="builtintype" id="2506486">byte</span><br>
<span class="lineno"></span><span class="op" id="2506491">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="2506494">//&nbsp;ParseSocketControlMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;array&nbsp;of&nbsp;socket&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="2506562">//&nbsp;messages.</span><br>
<span class="lineno"></span><span class="keyword" id="2506575">func</span>&nbsp;<span class="ident" id="2506580">ParseSocketControlMessage</span><span class="op" id="2506605">(</span><span class="ident" id="2506606">b</span>&nbsp;<span class="op" id="2506608">[</span><span class="op" id="2506609">]</span><span class="builtintype" id="2506610">byte</span><span class="op" id="2506614">)</span>&nbsp;<span class="op" id="2506616">(</span><span class="op" id="2506617">[</span><span class="op" id="2506618">]</span><span class="ident" id="2506619"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506430">SocketControlMessage</a></span><span class="op" id="2506639">,</span>&nbsp;<span class="builtintype" id="2506641">error</span><span class="op" id="2506646">)</span>&nbsp;<span class="op" id="2506648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506651">var</span>&nbsp;<span class="ident" id="2506655">msgs</span>&nbsp;<span class="op" id="2506660">[</span><span class="op" id="2506661">]</span><span class="ident" id="2506662"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506430">SocketControlMessage</a></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506684">i</span>&nbsp;<span class="op" id="2506686">:=</span>&nbsp;<span class="num" id="2506689">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506692">for</span>&nbsp;<span class="ident" id="2506696"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506684">i</a></span><span class="op" id="2506697">+</span><span class="ident" id="2506698"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505945">CmsgLen</a></span><span class="op" id="2506705">(</span><span class="num" id="2506706">0</span><span class="op" id="2506707">)</span>&nbsp;<span class="op" id="2506709">&lt;=</span>&nbsp;<span class="builtinfunc" id="2506712">len</span><span class="op" id="2506715">(</span><span class="ident" id="2506716"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506606">b</a></span><span class="op" id="2506717">)</span>&nbsp;<span class="op" id="2506719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506723">h</span><span class="op" id="2506724">,</span>&nbsp;<span class="ident" id="2506726">dbuf</span><span class="op" id="2506730">,</span>&nbsp;<span class="ident" id="2506732">err</span>&nbsp;<span class="op" id="2506736">:=</span>&nbsp;<span class="ident" id="2506739"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506958">socketControlMessageHeaderAndData</a></span><span class="op" id="2506772">(</span><span class="ident" id="2506773"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506606">b</a></span><span class="op" id="2506774">[</span><span class="ident" id="2506775"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506684">i</a></span><span class="op" id="2506776">:</span><span class="op" id="2506777">]</span><span class="op" id="2506778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506782">if</span>&nbsp;<span class="ident" id="2506785"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506732">err</a></span>&nbsp;<span class="op" id="2506789">!=</span>&nbsp;<span class="builtintype" id="2506792">nil</span>&nbsp;<span class="op" id="2506796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506801">return</span>&nbsp;<span class="builtintype" id="2506808">nil</span><span class="op" id="2506811">,</span>&nbsp;<span class="ident" id="2506813"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506732">err</a></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506823">m</span>&nbsp;<span class="op" id="2506825">:=</span>&nbsp;<span class="ident" id="2506828"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506430">SocketControlMessage</a></span><span class="op" id="2506848">{</span><span class="ident" id="2506849"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506461">Header</a></span><span class="op" id="2506855">:</span>&nbsp;<span class="op" id="2506857">*</span><span class="ident" id="2506858"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506723">h</a></span><span class="op" id="2506859">,</span>&nbsp;<span class="ident" id="2506861"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506477">Data</a></span><span class="op" id="2506865">:</span>&nbsp;<span class="ident" id="2506867"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506726">dbuf</a></span><span class="op" id="2506871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506875"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506655">msgs</a></span>&nbsp;<span class="op" id="2506880">=</span>&nbsp;<span class="builtinfunc" id="2506882">append</span><span class="op" id="2506888">(</span><span class="ident" id="2506889"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506655">msgs</a></span><span class="op" id="2506893">,</span>&nbsp;<span class="ident" id="2506895"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506823">m</a></span><span class="op" id="2506896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2506900"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506684">i</a></span>&nbsp;<span class="op" id="2506902">+=</span>&nbsp;<span class="ident" id="2506905"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505535">cmsgAlignOf</a></span><span class="op" id="2506916">(</span><span class="builtintype" id="2506917">int</span><span class="op" id="2506920">(</span><span class="ident" id="2506921"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506723">h</a></span><span class="op" id="2506922">.</span><span class="ident" id="2506923"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2669686">Len</a></span><span class="op" id="2506926">)</span><span class="op" id="2506927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2506930">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2506933">return</span>&nbsp;<span class="ident" id="2506940"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506655">msgs</a></span><span class="op" id="2506944">,</span>&nbsp;<span class="builtintype" id="2506946">nil</span><br>
<span class="lineno"></span><span class="op" id="2506950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2506953">func</span>&nbsp;<span class="ident" id="2506958">socketControlMessageHeaderAndData</span><span class="op" id="2506991">(</span><span class="ident" id="2506992">b</span>&nbsp;<span class="op" id="2506994">[</span><span class="op" id="2506995">]</span><span class="builtintype" id="2506996">byte</span><span class="op" id="2507000">)</span>&nbsp;<span class="op" id="2507002">(</span><span class="op" id="2507003">*</span><span class="ident" id="2507004"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2669668">Cmsghdr</a></span><span class="op" id="2507011">,</span>&nbsp;<span class="op" id="2507013">[</span><span class="op" id="2507014">]</span><span class="builtintype" id="2507015">byte</span><span class="op" id="2507019">,</span>&nbsp;<span class="builtintype" id="2507021">error</span><span class="op" id="2507026">)</span>&nbsp;<span class="op" id="2507028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2507031">h</span>&nbsp;<span class="op" id="2507033">:=</span>&nbsp;<span class="op" id="2507036">(</span><span class="op" id="2507037">*</span><span class="ident" id="2507038"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2669668">Cmsghdr</a></span><span class="op" id="2507045">)</span><span class="op" id="2507046">(</span><span class="ident" id="2507047"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505457">unsafe</a></span><span class="op" id="2507053">.</span><span class="ident" id="2507054">Pointer</span><span class="op" id="2507061">(</span><span class="op" id="2507062">&amp;</span><span class="ident" id="2507063"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506992">b</a></span><span class="op" id="2507064">[</span><span class="num" id="2507065">0</span><span class="op" id="2507066">]</span><span class="op" id="2507067">)</span><span class="op" id="2507068">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507071">if</span>&nbsp;<span class="ident" id="2507074"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507031">h</a></span><span class="op" id="2507075">.</span><span class="ident" id="2507076"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2669686">Len</a></span>&nbsp;<span class="op" id="2507080">&lt;</span>&nbsp;<span class="ident" id="2507082"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2671220">SizeofCmsghdr</a></span>&nbsp;<span class="op" id="2507096">||</span>&nbsp;<span class="builtintype" id="2507099">int</span><span class="op" id="2507102">(</span><span class="ident" id="2507103"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507031">h</a></span><span class="op" id="2507104">.</span><span class="ident" id="2507105"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2669686">Len</a></span><span class="op" id="2507108">)</span>&nbsp;<span class="op" id="2507110">&gt;</span>&nbsp;<span class="builtinfunc" id="2507112">len</span><span class="op" id="2507115">(</span><span class="ident" id="2507116"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506992">b</a></span><span class="op" id="2507117">)</span>&nbsp;<span class="op" id="2507119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507123">return</span>&nbsp;<span class="builtintype" id="2507130">nil</span><span class="op" id="2507133">,</span>&nbsp;<span class="builtintype" id="2507135">nil</span><span class="op" id="2507138">,</span>&nbsp;<span class="ident" id="2507140"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507151">return</span>&nbsp;<span class="ident" id="2507158"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507031">h</a></span><span class="op" id="2507159">,</span>&nbsp;<span class="ident" id="2507161"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506992">b</a></span><span class="op" id="2507162">[</span><span class="ident" id="2507163"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505535">cmsgAlignOf</a></span><span class="op" id="2507174">(</span><span class="ident" id="2507175"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2671220">SizeofCmsghdr</a></span><span class="op" id="2507188">)</span><span class="op" id="2507189">:</span><span class="ident" id="2507190"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507031">h</a></span><span class="op" id="2507191">.</span><span class="ident" id="2507192"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2669686">Len</a></span><span class="op" id="2507195">]</span><span class="op" id="2507196">,</span>&nbsp;<span class="builtintype" id="2507198">nil</span><br>
<span class="lineno"></span><span class="op" id="2507202">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="2507205">//&nbsp;UnixRights&nbsp;encodes&nbsp;a&nbsp;set&nbsp;of&nbsp;open&nbsp;file&nbsp;descriptors&nbsp;into&nbsp;a&nbsp;socket</span><br>
<span class="lineno"></span><span class="comment" id="2507272">//&nbsp;control&nbsp;message&nbsp;for&nbsp;sending&nbsp;to&nbsp;another&nbsp;process.</span><br>
<span class="lineno"></span><span class="keyword" id="2507323">func</span>&nbsp;<span class="ident" id="2507328">UnixRights</span><span class="op" id="2507338">(</span><span class="ident" id="2507339">fds</span>&nbsp;<span class="op" id="2507343">...</span><span class="builtintype" id="2507346">int</span><span class="op" id="2507349">)</span>&nbsp;<span class="op" id="2507351">[</span><span class="op" id="2507352">]</span><span class="builtintype" id="2507353">byte</span>&nbsp;<span class="op" id="2507358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2507361">datalen</span>&nbsp;<span class="op" id="2507369">:=</span>&nbsp;<span class="builtinfunc" id="2507372">len</span><span class="op" id="2507375">(</span><span class="ident" id="2507376"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507339">fds</a></span><span class="op" id="2507379">)</span>&nbsp;<span class="op" id="2507381">*</span>&nbsp;<span class="num" id="2507383">4</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2507386">b</span>&nbsp;<span class="op" id="2507388">:=</span>&nbsp;<span class="builtinfunc" id="2507391">make</span><span class="op" id="2507395">(</span><span class="op" id="2507396">[</span><span class="op" id="2507397">]</span><span class="builtintype" id="2507398">byte</span><span class="op" id="2507402">,</span>&nbsp;<span class="ident" id="2507404"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506139">CmsgSpace</a></span><span class="op" id="2507413">(</span><span class="ident" id="2507414"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507361">datalen</a></span><span class="op" id="2507421">)</span><span class="op" id="2507422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2507425">h</span>&nbsp;<span class="op" id="2507427">:=</span>&nbsp;<span class="op" id="2507430">(</span><span class="op" id="2507431">*</span><span class="ident" id="2507432"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2669668">Cmsghdr</a></span><span class="op" id="2507439">)</span><span class="op" id="2507440">(</span><span class="ident" id="2507441"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505457">unsafe</a></span><span class="op" id="2507447">.</span><span class="ident" id="2507448">Pointer</span><span class="op" id="2507455">(</span><span class="op" id="2507456">&amp;</span><span class="ident" id="2507457"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507386">b</a></span><span class="op" id="2507458">[</span><span class="num" id="2507459">0</span><span class="op" id="2507460">]</span><span class="op" id="2507461">)</span><span class="op" id="2507462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2507465"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507425">h</a></span><span class="op" id="2507466">.</span><span class="ident" id="2507467"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2669707">Level</a></span>&nbsp;<span class="op" id="2507473">=</span>&nbsp;<span class="ident" id="2507475"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2592443">SOL_SOCKET</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2507487"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507425">h</a></span><span class="op" id="2507488">.</span><span class="ident" id="2507489"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2669727">Type</a></span>&nbsp;<span class="op" id="2507494">=</span>&nbsp;<span class="ident" id="2507496"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2588927">SCM_RIGHTS</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2507508"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507425">h</a></span><span class="op" id="2507509">.</span><span class="ident" id="2507510"><a href="/gostd/syscall/syscall_linux_amd64.go.html#2543281">SetLen</a></span><span class="op" id="2507516">(</span><span class="ident" id="2507517"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505945">CmsgLen</a></span><span class="op" id="2507524">(</span><span class="ident" id="2507525"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507361">datalen</a></span><span class="op" id="2507532">)</span><span class="op" id="2507533">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2507536">data</span>&nbsp;<span class="op" id="2507541">:=</span>&nbsp;<span class="builtintype" id="2507544">uintptr</span><span class="op" id="2507551">(</span><span class="ident" id="2507552"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506234">cmsgData</a></span><span class="op" id="2507560">(</span><span class="ident" id="2507561"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507425">h</a></span><span class="op" id="2507562">)</span><span class="op" id="2507563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507566">for</span>&nbsp;<span class="ident" id="2507570">_</span><span class="op" id="2507571">,</span>&nbsp;<span class="ident" id="2507573">fd</span>&nbsp;<span class="op" id="2507576">:=</span>&nbsp;<span class="keyword" id="2507579">range</span>&nbsp;<span class="ident" id="2507585"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507339">fds</a></span>&nbsp;<span class="op" id="2507589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507593">*</span><span class="op" id="2507594">(</span><span class="op" id="2507595">*</span><span class="builtintype" id="2507596">int32</span><span class="op" id="2507601">)</span><span class="op" id="2507602">(</span><span class="ident" id="2507603"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505457">unsafe</a></span><span class="op" id="2507609">.</span><span class="ident" id="2507610">Pointer</span><span class="op" id="2507617">(</span><span class="ident" id="2507618"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507536">data</a></span><span class="op" id="2507622">)</span><span class="op" id="2507623">)</span>&nbsp;<span class="op" id="2507625">=</span>&nbsp;<span class="builtintype" id="2507627">int32</span><span class="op" id="2507632">(</span><span class="ident" id="2507633"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507573">fd</a></span><span class="op" id="2507635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2507639"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507536">data</a></span>&nbsp;<span class="op" id="2507644">+=</span>&nbsp;<span class="num" id="2507647">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507650">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507653">return</span>&nbsp;<span class="ident" id="2507660"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507386">b</a></span><br>
<span class="lineno"></span><span class="op" id="2507662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2507665">//&nbsp;ParseUnixRights&nbsp;decodes&nbsp;a&nbsp;socket&nbsp;control&nbsp;message&nbsp;that&nbsp;contains&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2507734">//&nbsp;integer&nbsp;array&nbsp;of&nbsp;open&nbsp;file&nbsp;descriptors&nbsp;from&nbsp;another&nbsp;process.</span><br>
<span class="lineno">90</span><span class="keyword" id="2507798">func</span>&nbsp;<span class="ident" id="2507803">ParseUnixRights</span><span class="op" id="2507818">(</span><span class="ident" id="2507819">m</span>&nbsp;<span class="op" id="2507821">*</span><span class="ident" id="2507822"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506430">SocketControlMessage</a></span><span class="op" id="2507842">)</span>&nbsp;<span class="op" id="2507844">(</span><span class="op" id="2507845">[</span><span class="op" id="2507846">]</span><span class="builtintype" id="2507847">int</span><span class="op" id="2507850">,</span>&nbsp;<span class="builtintype" id="2507852">error</span><span class="op" id="2507857">)</span>&nbsp;<span class="op" id="2507859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507862">if</span>&nbsp;<span class="ident" id="2507865"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507819">m</a></span><span class="op" id="2507866">.</span><span class="ident" id="2507867"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506461">Header</a></span><span class="op" id="2507873">.</span><span class="ident" id="2507874"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2669707">Level</a></span>&nbsp;<span class="op" id="2507880">!=</span>&nbsp;<span class="ident" id="2507883"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2592443">SOL_SOCKET</a></span>&nbsp;<span class="op" id="2507894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507898">return</span>&nbsp;<span class="builtintype" id="2507905">nil</span><span class="op" id="2507908">,</span>&nbsp;<span class="ident" id="2507910"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507921">if</span>&nbsp;<span class="ident" id="2507924"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507819">m</a></span><span class="op" id="2507925">.</span><span class="ident" id="2507926"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506461">Header</a></span><span class="op" id="2507932">.</span><span class="ident" id="2507933"><a href="/gostd/syscall/ztypes_linux_amd64.go.html#2669727">Type</a></span>&nbsp;<span class="op" id="2507938">!=</span>&nbsp;<span class="ident" id="2507941"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2588927">SCM_RIGHTS</a></span>&nbsp;<span class="op" id="2507952">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2507956">return</span>&nbsp;<span class="builtintype" id="2507963">nil</span><span class="op" id="2507966">,</span>&nbsp;<span class="ident" id="2507968"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2601331">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2507976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2507979">fds</span>&nbsp;<span class="op" id="2507983">:=</span>&nbsp;<span class="builtinfunc" id="2507986">make</span><span class="op" id="2507990">(</span><span class="op" id="2507991">[</span><span class="op" id="2507992">]</span><span class="builtintype" id="2507993">int</span><span class="op" id="2507996">,</span>&nbsp;<span class="builtinfunc" id="2507998">len</span><span class="op" id="2508001">(</span><span class="ident" id="2508002"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507819">m</a></span><span class="op" id="2508003">.</span><span class="ident" id="2508004"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506477">Data</a></span><span class="op" id="2508008">)</span><span class="op" id="2508009">&gt;&gt;</span><span class="num" id="2508011">2</span><span class="op" id="2508012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2508015">for</span>&nbsp;<span class="ident" id="2508019">i</span><span class="op" id="2508020">,</span>&nbsp;<span class="ident" id="2508022">j</span>&nbsp;<span class="op" id="2508024">:=</span>&nbsp;<span class="num" id="2508027">0</span><span class="op" id="2508028">,</span>&nbsp;<span class="num" id="2508030">0</span><span class="op" id="2508031">;</span>&nbsp;<span class="ident" id="2508033"><a href="/gostd/syscall/sockcmsg_unix.go.html#2508019">i</a></span>&nbsp;<span class="op" id="2508035">&lt;</span>&nbsp;<span class="builtinfunc" id="2508037">len</span><span class="op" id="2508040">(</span><span class="ident" id="2508041"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507819">m</a></span><span class="op" id="2508042">.</span><span class="ident" id="2508043"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506477">Data</a></span><span class="op" id="2508047">)</span><span class="op" id="2508048">;</span>&nbsp;<span class="ident" id="2508050"><a href="/gostd/syscall/sockcmsg_unix.go.html#2508019">i</a></span>&nbsp;<span class="op" id="2508052">+=</span>&nbsp;<span class="num" id="2508055">4</span>&nbsp;<span class="op" id="2508057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2508061"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507979">fds</a></span><span class="op" id="2508064">[</span><span class="ident" id="2508065"><a href="/gostd/syscall/sockcmsg_unix.go.html#2508022">j</a></span><span class="op" id="2508066">]</span>&nbsp;<span class="op" id="2508068">=</span>&nbsp;<span class="builtintype" id="2508070">int</span><span class="op" id="2508073">(</span><span class="op" id="2508074">*</span><span class="op" id="2508075">(</span><span class="op" id="2508076">*</span><span class="builtintype" id="2508077">int32</span><span class="op" id="2508082">)</span><span class="op" id="2508083">(</span><span class="ident" id="2508084"><a href="/gostd/syscall/sockcmsg_unix.go.html#2505457">unsafe</a></span><span class="op" id="2508090">.</span><span class="ident" id="2508091">Pointer</span><span class="op" id="2508098">(</span><span class="op" id="2508099">&amp;</span><span class="ident" id="2508100"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507819">m</a></span><span class="op" id="2508101">.</span><span class="ident" id="2508102"><a href="/gostd/syscall/sockcmsg_unix.go.html#2506477">Data</a></span><span class="op" id="2508106">[</span><span class="ident" id="2508107"><a href="/gostd/syscall/sockcmsg_unix.go.html#2508019">i</a></span><span class="op" id="2508108">]</span><span class="op" id="2508109">)</span><span class="op" id="2508110">)</span><span class="op" id="2508111">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2508115"><a href="/gostd/syscall/sockcmsg_unix.go.html#2508022">j</a></span><span class="op" id="2508116">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2508120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2508123">return</span>&nbsp;<span class="ident" id="2508130"><a href="/gostd/syscall/sockcmsg_unix.go.html#2507979">fds</a></span><span class="op" id="2508133">,</span>&nbsp;<span class="builtintype" id="2508135">nil</span><br>
<span class="lineno"></span><span class="op" id="2508139">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
