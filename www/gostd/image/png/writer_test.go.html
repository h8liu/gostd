<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/png</h2>
<ul>
<li><a href="/gostd/image/png/paeth.go.html">paeth.go</a></li>
<li><a href="/gostd/image/png/paeth_test.go.html">paeth_test.go</a></li>
<li><a href="/gostd/image/png/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/png/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/png/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/png/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7053868">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7053923">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7053977">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7054028">package</span>&nbsp;<span class="ident" id="7054036">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7054041">import</span>&nbsp;<span class="op" id="7054048">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7054051">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7054060">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7054067">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7054076">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7054091">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7054104">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7054114">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7054117">func</span>&nbsp;<span class="ident" id="7054122">diff</span><span class="op" id="7054126">(</span><span class="ident" id="7054127">m0</span><span class="op" id="7054129">,</span>&nbsp;<span class="ident" id="7054131">m1</span>&nbsp;<span class="ident" id="7054134">image</span><span class="op" id="7054139">.</span><span class="ident" id="7054140">Image</span><span class="op" id="7054145">)</span>&nbsp;<span class="builtintype" id="7054147">error</span>&nbsp;<span class="op" id="7054153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054156">b0</span><span class="op" id="7054158">,</span>&nbsp;<span class="ident" id="7054160">b1</span>&nbsp;<span class="op" id="7054163">:=</span>&nbsp;<span class="ident" id="7054166">m0</span><span class="op" id="7054168">.</span><span class="ident" id="7054169">Bounds</span><span class="op" id="7054175">(</span><span class="op" id="7054176">)</span><span class="op" id="7054177">,</span>&nbsp;<span class="ident" id="7054179">m1</span><span class="op" id="7054181">.</span><span class="ident" id="7054182">Bounds</span><span class="op" id="7054188">(</span><span class="op" id="7054189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7054192">if</span>&nbsp;<span class="op" id="7054195">!</span><span class="ident" id="7054196">b0</span><span class="op" id="7054198">.</span><span class="ident" id="7054199">Size</span><span class="op" id="7054203">(</span><span class="op" id="7054204">)</span><span class="op" id="7054205">.</span><span class="ident" id="7054206">Eq</span><span class="op" id="7054208">(</span><span class="ident" id="7054209">b1</span><span class="op" id="7054211">.</span><span class="ident" id="7054212">Size</span><span class="op" id="7054216">(</span><span class="op" id="7054217">)</span><span class="op" id="7054218">)</span>&nbsp;<span class="op" id="7054220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7054224">return</span>&nbsp;<span class="ident" id="7054231">fmt</span><span class="op" id="7054234">.</span><span class="ident" id="7054235">Errorf</span><span class="op" id="7054241">(</span><span class="string" id="7054242">&#34;dimensions&nbsp;differ:&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="7054271">,</span>&nbsp;<span class="ident" id="7054273">b0</span><span class="op" id="7054275">,</span>&nbsp;<span class="ident" id="7054277">b1</span><span class="op" id="7054279">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7054282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054285">dx</span>&nbsp;<span class="op" id="7054288">:=</span>&nbsp;<span class="ident" id="7054291">b1</span><span class="op" id="7054293">.</span><span class="ident" id="7054294">Min</span><span class="op" id="7054297">.</span><span class="ident" id="7054298">X</span>&nbsp;<span class="op" id="7054300">-</span>&nbsp;<span class="ident" id="7054302">b0</span><span class="op" id="7054304">.</span><span class="ident" id="7054305">Min</span><span class="op" id="7054308">.</span><span class="ident" id="7054309">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054312">dy</span>&nbsp;<span class="op" id="7054315">:=</span>&nbsp;<span class="ident" id="7054318">b1</span><span class="op" id="7054320">.</span><span class="ident" id="7054321">Min</span><span class="op" id="7054324">.</span><span class="ident" id="7054325">Y</span>&nbsp;<span class="op" id="7054327">-</span>&nbsp;<span class="ident" id="7054329">b0</span><span class="op" id="7054331">.</span><span class="ident" id="7054332">Min</span><span class="op" id="7054335">.</span><span class="ident" id="7054336">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7054339">for</span>&nbsp;<span class="ident" id="7054343">y</span>&nbsp;<span class="op" id="7054345">:=</span>&nbsp;<span class="ident" id="7054348">b0</span><span class="op" id="7054350">.</span><span class="ident" id="7054351">Min</span><span class="op" id="7054354">.</span><span class="ident" id="7054355">Y</span><span class="op" id="7054356">;</span>&nbsp;<span class="ident" id="7054358">y</span>&nbsp;<span class="op" id="7054360">&lt;</span>&nbsp;<span class="ident" id="7054362">b0</span><span class="op" id="7054364">.</span><span class="ident" id="7054365">Max</span><span class="op" id="7054368">.</span><span class="ident" id="7054369">Y</span><span class="op" id="7054370">;</span>&nbsp;<span class="ident" id="7054372">y</span><span class="op" id="7054373">++</span>&nbsp;<span class="op" id="7054376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7054380">for</span>&nbsp;<span class="ident" id="7054384">x</span>&nbsp;<span class="op" id="7054386">:=</span>&nbsp;<span class="ident" id="7054389">b0</span><span class="op" id="7054391">.</span><span class="ident" id="7054392">Min</span><span class="op" id="7054395">.</span><span class="ident" id="7054396">X</span><span class="op" id="7054397">;</span>&nbsp;<span class="ident" id="7054399">x</span>&nbsp;<span class="op" id="7054401">&lt;</span>&nbsp;<span class="ident" id="7054403">b0</span><span class="op" id="7054405">.</span><span class="ident" id="7054406">Max</span><span class="op" id="7054409">.</span><span class="ident" id="7054410">X</span><span class="op" id="7054411">;</span>&nbsp;<span class="ident" id="7054413">x</span><span class="op" id="7054414">++</span>&nbsp;<span class="op" id="7054417">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054422">c0</span>&nbsp;<span class="op" id="7054425">:=</span>&nbsp;<span class="ident" id="7054428">m0</span><span class="op" id="7054430">.</span><span class="ident" id="7054431">At</span><span class="op" id="7054433">(</span><span class="ident" id="7054434">x</span><span class="op" id="7054435">,</span>&nbsp;<span class="ident" id="7054437">y</span><span class="op" id="7054438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054443">c1</span>&nbsp;<span class="op" id="7054446">:=</span>&nbsp;<span class="ident" id="7054449">m1</span><span class="op" id="7054451">.</span><span class="ident" id="7054452">At</span><span class="op" id="7054454">(</span><span class="ident" id="7054455">x</span><span class="op" id="7054456">+</span><span class="ident" id="7054457">dx</span><span class="op" id="7054459">,</span>&nbsp;<span class="ident" id="7054461">y</span><span class="op" id="7054462">+</span><span class="ident" id="7054463">dy</span><span class="op" id="7054465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054470">r0</span><span class="op" id="7054472">,</span>&nbsp;<span class="ident" id="7054474">g0</span><span class="op" id="7054476">,</span>&nbsp;<span class="ident" id="7054478">b0</span><span class="op" id="7054480">,</span>&nbsp;<span class="ident" id="7054482">a0</span>&nbsp;<span class="op" id="7054485">:=</span>&nbsp;<span class="ident" id="7054488">c0</span><span class="op" id="7054490">.</span><span class="ident" id="7054491">RGBA</span><span class="op" id="7054495">(</span><span class="op" id="7054496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054501">r1</span><span class="op" id="7054503">,</span>&nbsp;<span class="ident" id="7054505">g1</span><span class="op" id="7054507">,</span>&nbsp;<span class="ident" id="7054509">b1</span><span class="op" id="7054511">,</span>&nbsp;<span class="ident" id="7054513">a1</span>&nbsp;<span class="op" id="7054516">:=</span>&nbsp;<span class="ident" id="7054519">c1</span><span class="op" id="7054521">.</span><span class="ident" id="7054522">RGBA</span><span class="op" id="7054526">(</span><span class="op" id="7054527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7054532">if</span>&nbsp;<span class="ident" id="7054535">r0</span>&nbsp;<span class="op" id="7054538">!=</span>&nbsp;<span class="ident" id="7054541">r1</span>&nbsp;<span class="op" id="7054544">||</span>&nbsp;<span class="ident" id="7054547">g0</span>&nbsp;<span class="op" id="7054550">!=</span>&nbsp;<span class="ident" id="7054553">g1</span>&nbsp;<span class="op" id="7054556">||</span>&nbsp;<span class="ident" id="7054559">b0</span>&nbsp;<span class="op" id="7054562">!=</span>&nbsp;<span class="ident" id="7054565">b1</span>&nbsp;<span class="op" id="7054568">||</span>&nbsp;<span class="ident" id="7054571">a0</span>&nbsp;<span class="op" id="7054574">!=</span>&nbsp;<span class="ident" id="7054577">a1</span>&nbsp;<span class="op" id="7054580">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7054586">return</span>&nbsp;<span class="ident" id="7054593">fmt</span><span class="op" id="7054596">.</span><span class="ident" id="7054597">Errorf</span><span class="op" id="7054603">(</span><span class="string" id="7054604">&#34;colors&nbsp;differ&nbsp;at&nbsp;(%d,&nbsp;%d):&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="7054641">,</span>&nbsp;<span class="ident" id="7054643">x</span><span class="op" id="7054644">,</span>&nbsp;<span class="ident" id="7054646">y</span><span class="op" id="7054647">,</span>&nbsp;<span class="ident" id="7054649">c0</span><span class="op" id="7054651">,</span>&nbsp;<span class="ident" id="7054653">c1</span><span class="op" id="7054655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7054660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7054664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7054667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7054670">return</span>&nbsp;<span class="ident" id="7054677">nil</span><br>
<span class="lineno">35</span><span class="op" id="7054681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7054684">func</span>&nbsp;<span class="ident" id="7054689">encodeDecode</span><span class="op" id="7054701">(</span><span class="ident" id="7054702">m</span>&nbsp;<span class="ident" id="7054704">image</span><span class="op" id="7054709">.</span><span class="ident" id="7054710">Image</span><span class="op" id="7054715">)</span>&nbsp;<span class="op" id="7054717">(</span><span class="ident" id="7054718">image</span><span class="op" id="7054723">.</span><span class="ident" id="7054724">Image</span><span class="op" id="7054729">,</span>&nbsp;<span class="builtintype" id="7054731">error</span><span class="op" id="7054736">)</span>&nbsp;<span class="op" id="7054738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7054741">var</span>&nbsp;<span class="ident" id="7054745">b</span>&nbsp;<span class="ident" id="7054747">bytes</span><span class="op" id="7054752">.</span><span class="ident" id="7054753">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054761">err</span>&nbsp;<span class="op" id="7054765">:=</span>&nbsp;<span class="ident" id="7054768">Encode</span><span class="op" id="7054774">(</span><span class="op" id="7054775">&amp;</span><span class="ident" id="7054776">b</span><span class="op" id="7054777">,</span>&nbsp;<span class="ident" id="7054779">m</span><span class="op" id="7054780">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7054783">if</span>&nbsp;<span class="ident" id="7054786">err</span>&nbsp;<span class="op" id="7054790">!=</span>&nbsp;<span class="ident" id="7054793">nil</span>&nbsp;<span class="op" id="7054797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7054801">return</span>&nbsp;<span class="ident" id="7054808">nil</span><span class="op" id="7054811">,</span>&nbsp;<span class="ident" id="7054813">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7054818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7054821">return</span>&nbsp;<span class="ident" id="7054828">Decode</span><span class="op" id="7054834">(</span><span class="op" id="7054835">&amp;</span><span class="ident" id="7054836">b</span><span class="op" id="7054837">)</span><br>
<span class="lineno"></span><span class="op" id="7054839">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7054842">func</span>&nbsp;<span class="ident" id="7054847">TestWriter</span><span class="op" id="7054857">(</span><span class="ident" id="7054858">t</span>&nbsp;<span class="op" id="7054860">*</span><span class="ident" id="7054861">testing</span><span class="op" id="7054868">.</span><span class="ident" id="7054869">T</span><span class="op" id="7054870">)</span>&nbsp;<span class="op" id="7054872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7054875">//&nbsp;The&nbsp;filenames&nbsp;variable&nbsp;is&nbsp;declared&nbsp;in&nbsp;reader_test.go.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054933">names</span>&nbsp;<span class="op" id="7054939">:=</span>&nbsp;<span class="ident" id="7054942">filenames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7054953">if</span>&nbsp;<span class="ident" id="7054956">testing</span><span class="op" id="7054963">.</span><span class="ident" id="7054964">Short</span><span class="op" id="7054969">(</span><span class="op" id="7054970">)</span>&nbsp;<span class="op" id="7054972">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7054976">names</span>&nbsp;<span class="op" id="7054982">=</span>&nbsp;<span class="ident" id="7054984">filenamesShort</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7055000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055003">for</span>&nbsp;<span class="ident" id="7055007">_</span><span class="op" id="7055008">,</span>&nbsp;<span class="ident" id="7055010">fn</span>&nbsp;<span class="op" id="7055013">:=</span>&nbsp;<span class="keyword" id="7055016">range</span>&nbsp;<span class="ident" id="7055022">names</span>&nbsp;<span class="op" id="7055028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055032">qfn</span>&nbsp;<span class="op" id="7055036">:=</span>&nbsp;<span class="string" id="7055039">&#34;testdata/pngsuite/&#34;</span>&nbsp;<span class="op" id="7055060">+</span>&nbsp;<span class="ident" id="7055062">fn</span>&nbsp;<span class="op" id="7055065">+</span>&nbsp;<span class="string" id="7055067">&#34;.png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7055076">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055097">m0</span><span class="op" id="7055099">,</span>&nbsp;<span class="ident" id="7055101">err</span>&nbsp;<span class="op" id="7055105">:=</span>&nbsp;<span class="ident" id="7055108">readPNG</span><span class="op" id="7055115">(</span><span class="ident" id="7055116">qfn</span><span class="op" id="7055119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055123">if</span>&nbsp;<span class="ident" id="7055126">err</span>&nbsp;<span class="op" id="7055130">!=</span>&nbsp;<span class="ident" id="7055133">nil</span>&nbsp;<span class="op" id="7055137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055142">t</span><span class="op" id="7055143">.</span><span class="ident" id="7055144">Error</span><span class="op" id="7055149">(</span><span class="ident" id="7055150">fn</span><span class="op" id="7055152">,</span>&nbsp;<span class="ident" id="7055154">err</span><span class="op" id="7055157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055162">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7055173">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7055177">//&nbsp;Read&nbsp;the&nbsp;image&nbsp;again,&nbsp;encode&nbsp;it,&nbsp;and&nbsp;decode&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055230">m1</span><span class="op" id="7055232">,</span>&nbsp;<span class="ident" id="7055234">err</span>&nbsp;<span class="op" id="7055238">:=</span>&nbsp;<span class="ident" id="7055241">readPNG</span><span class="op" id="7055248">(</span><span class="ident" id="7055249">qfn</span><span class="op" id="7055252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055256">if</span>&nbsp;<span class="ident" id="7055259">err</span>&nbsp;<span class="op" id="7055263">!=</span>&nbsp;<span class="ident" id="7055266">nil</span>&nbsp;<span class="op" id="7055270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055275">t</span><span class="op" id="7055276">.</span><span class="ident" id="7055277">Error</span><span class="op" id="7055282">(</span><span class="ident" id="7055283">fn</span><span class="op" id="7055285">,</span>&nbsp;<span class="ident" id="7055287">err</span><span class="op" id="7055290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055295">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7055304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055308">m2</span><span class="op" id="7055310">,</span>&nbsp;<span class="ident" id="7055312">err</span>&nbsp;<span class="op" id="7055316">:=</span>&nbsp;<span class="ident" id="7055319">encodeDecode</span><span class="op" id="7055331">(</span><span class="ident" id="7055332">m1</span><span class="op" id="7055334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055338">if</span>&nbsp;<span class="ident" id="7055341">err</span>&nbsp;<span class="op" id="7055345">!=</span>&nbsp;<span class="ident" id="7055348">nil</span>&nbsp;<span class="op" id="7055352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055357">t</span><span class="op" id="7055358">.</span><span class="ident" id="7055359">Error</span><span class="op" id="7055364">(</span><span class="ident" id="7055365">fn</span><span class="op" id="7055367">,</span>&nbsp;<span class="ident" id="7055369">err</span><span class="op" id="7055372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055377">return</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7055386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7055390">//&nbsp;Compare&nbsp;the&nbsp;two.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055412">err</span>&nbsp;<span class="op" id="7055416">=</span>&nbsp;<span class="ident" id="7055418">diff</span><span class="op" id="7055422">(</span><span class="ident" id="7055423">m0</span><span class="op" id="7055425">,</span>&nbsp;<span class="ident" id="7055427">m2</span><span class="op" id="7055429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055433">if</span>&nbsp;<span class="ident" id="7055436">err</span>&nbsp;<span class="op" id="7055440">!=</span>&nbsp;<span class="ident" id="7055443">nil</span>&nbsp;<span class="op" id="7055447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055452">t</span><span class="op" id="7055453">.</span><span class="ident" id="7055454">Error</span><span class="op" id="7055459">(</span><span class="ident" id="7055460">fn</span><span class="op" id="7055462">,</span>&nbsp;<span class="ident" id="7055464">err</span><span class="op" id="7055467">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055472">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7055483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7055486">}</span><br>
<span class="lineno"></span><span class="op" id="7055488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="7055491">func</span>&nbsp;<span class="ident" id="7055496">TestWriterLevels</span><span class="op" id="7055512">(</span><span class="ident" id="7055513">t</span>&nbsp;<span class="op" id="7055515">*</span><span class="ident" id="7055516">testing</span><span class="op" id="7055523">.</span><span class="ident" id="7055524">T</span><span class="op" id="7055525">)</span>&nbsp;<span class="op" id="7055527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055530">m</span>&nbsp;<span class="op" id="7055532">:=</span>&nbsp;<span class="ident" id="7055535">image</span><span class="op" id="7055540">.</span><span class="ident" id="7055541">NewNRGBA</span><span class="op" id="7055549">(</span><span class="ident" id="7055550">image</span><span class="op" id="7055555">.</span><span class="ident" id="7055556">Rect</span><span class="op" id="7055560">(</span><span class="num" id="7055561">0</span><span class="op" id="7055562">,</span>&nbsp;<span class="num" id="7055564">0</span><span class="op" id="7055565">,</span>&nbsp;<span class="num" id="7055567">100</span><span class="op" id="7055570">,</span>&nbsp;<span class="num" id="7055572">100</span><span class="op" id="7055575">)</span><span class="op" id="7055576">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055580">var</span>&nbsp;<span class="ident" id="7055584">b1</span><span class="op" id="7055586">,</span>&nbsp;<span class="ident" id="7055588">b2</span>&nbsp;<span class="ident" id="7055591">bytes</span><span class="op" id="7055596">.</span><span class="ident" id="7055597">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055605">if</span>&nbsp;<span class="ident" id="7055608">err</span>&nbsp;<span class="op" id="7055612">:=</span>&nbsp;<span class="op" id="7055615">(</span><span class="op" id="7055616">&amp;</span><span class="ident" id="7055617">Encoder</span><span class="op" id="7055624">{</span><span class="op" id="7055625">}</span><span class="op" id="7055626">)</span><span class="op" id="7055627">.</span><span class="ident" id="7055628">Encode</span><span class="op" id="7055634">(</span><span class="op" id="7055635">&amp;</span><span class="ident" id="7055636">b1</span><span class="op" id="7055638">,</span>&nbsp;<span class="ident" id="7055640">m</span><span class="op" id="7055641">)</span><span class="op" id="7055642">;</span>&nbsp;<span class="ident" id="7055644">err</span>&nbsp;<span class="op" id="7055648">!=</span>&nbsp;<span class="ident" id="7055651">nil</span>&nbsp;<span class="op" id="7055655">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055659">t</span><span class="op" id="7055660">.</span><span class="ident" id="7055661">Fatal</span><span class="op" id="7055666">(</span><span class="ident" id="7055667">err</span><span class="op" id="7055670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7055673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055676">noenc</span>&nbsp;<span class="op" id="7055682">:=</span>&nbsp;<span class="op" id="7055685">&amp;</span><span class="ident" id="7055686">Encoder</span><span class="op" id="7055693">{</span><span class="ident" id="7055694">CompressionLevel</span><span class="op" id="7055710">:</span>&nbsp;<span class="ident" id="7055712">NoCompression</span><span class="op" id="7055725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055728">if</span>&nbsp;<span class="ident" id="7055731">err</span>&nbsp;<span class="op" id="7055735">:=</span>&nbsp;<span class="ident" id="7055738">noenc</span><span class="op" id="7055743">.</span><span class="ident" id="7055744">Encode</span><span class="op" id="7055750">(</span><span class="op" id="7055751">&amp;</span><span class="ident" id="7055752">b2</span><span class="op" id="7055754">,</span>&nbsp;<span class="ident" id="7055756">m</span><span class="op" id="7055757">)</span><span class="op" id="7055758">;</span>&nbsp;<span class="ident" id="7055760">err</span>&nbsp;<span class="op" id="7055764">!=</span>&nbsp;<span class="ident" id="7055767">nil</span>&nbsp;<span class="op" id="7055771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055775">t</span><span class="op" id="7055776">.</span><span class="ident" id="7055777">Fatal</span><span class="op" id="7055782">(</span><span class="ident" id="7055783">err</span><span class="op" id="7055786">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7055789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055793">if</span>&nbsp;<span class="ident" id="7055796">b2</span><span class="op" id="7055798">.</span><span class="ident" id="7055799">Len</span><span class="op" id="7055802">(</span><span class="op" id="7055803">)</span>&nbsp;<span class="op" id="7055805">&lt;=</span>&nbsp;<span class="ident" id="7055808">b1</span><span class="op" id="7055810">.</span><span class="ident" id="7055811">Len</span><span class="op" id="7055814">(</span><span class="op" id="7055815">)</span>&nbsp;<span class="op" id="7055817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055821">t</span><span class="op" id="7055822">.</span><span class="ident" id="7055823">Error</span><span class="op" id="7055828">(</span><span class="string" id="7055829">&#34;DefaultCompression&nbsp;encoding&nbsp;was&nbsp;larger&nbsp;than&nbsp;NoCompression&nbsp;encoding&#34;</span><span class="op" id="7055897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7055900">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055903">if</span>&nbsp;<span class="ident" id="7055906">_</span><span class="op" id="7055907">,</span>&nbsp;<span class="ident" id="7055909">err</span>&nbsp;<span class="op" id="7055913">:=</span>&nbsp;<span class="ident" id="7055916">Decode</span><span class="op" id="7055922">(</span><span class="op" id="7055923">&amp;</span><span class="ident" id="7055924">b1</span><span class="op" id="7055926">)</span><span class="op" id="7055927">;</span>&nbsp;<span class="ident" id="7055929">err</span>&nbsp;<span class="op" id="7055933">!=</span>&nbsp;<span class="ident" id="7055936">nil</span>&nbsp;<span class="op" id="7055940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7055944">t</span><span class="op" id="7055945">.</span><span class="ident" id="7055946">Error</span><span class="op" id="7055951">(</span><span class="string" id="7055952">&#34;cannot&nbsp;decode&nbsp;DefaultCompression&#34;</span><span class="op" id="7055986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7055989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7055992">if</span>&nbsp;<span class="ident" id="7055995">_</span><span class="op" id="7055996">,</span>&nbsp;<span class="ident" id="7055998">err</span>&nbsp;<span class="op" id="7056002">:=</span>&nbsp;<span class="ident" id="7056005">Decode</span><span class="op" id="7056011">(</span><span class="op" id="7056012">&amp;</span><span class="ident" id="7056013">b2</span><span class="op" id="7056015">)</span><span class="op" id="7056016">;</span>&nbsp;<span class="ident" id="7056018">err</span>&nbsp;<span class="op" id="7056022">!=</span>&nbsp;<span class="ident" id="7056025">nil</span>&nbsp;<span class="op" id="7056029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056033">t</span><span class="op" id="7056034">.</span><span class="ident" id="7056035">Error</span><span class="op" id="7056040">(</span><span class="string" id="7056041">&#34;cannot&nbsp;decode&nbsp;NoCompression&#34;</span><span class="op" id="7056070">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7056073">}</span><br>
<span class="lineno"></span><span class="op" id="7056075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7056078">func</span>&nbsp;<span class="ident" id="7056083">TestSubImage</span><span class="op" id="7056095">(</span><span class="ident" id="7056096">t</span>&nbsp;<span class="op" id="7056098">*</span><span class="ident" id="7056099">testing</span><span class="op" id="7056106">.</span><span class="ident" id="7056107">T</span><span class="op" id="7056108">)</span>&nbsp;<span class="op" id="7056110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056113">m0</span>&nbsp;<span class="op" id="7056116">:=</span>&nbsp;<span class="ident" id="7056119">image</span><span class="op" id="7056124">.</span><span class="ident" id="7056125">NewRGBA</span><span class="op" id="7056132">(</span><span class="ident" id="7056133">image</span><span class="op" id="7056138">.</span><span class="ident" id="7056139">Rect</span><span class="op" id="7056143">(</span><span class="num" id="7056144">0</span><span class="op" id="7056145">,</span>&nbsp;<span class="num" id="7056147">0</span><span class="op" id="7056148">,</span>&nbsp;<span class="num" id="7056150">256</span><span class="op" id="7056153">,</span>&nbsp;<span class="num" id="7056155">256</span><span class="op" id="7056158">)</span><span class="op" id="7056159">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7056162">for</span>&nbsp;<span class="ident" id="7056166">y</span>&nbsp;<span class="op" id="7056168">:=</span>&nbsp;<span class="num" id="7056171">0</span><span class="op" id="7056172">;</span>&nbsp;<span class="ident" id="7056174">y</span>&nbsp;<span class="op" id="7056176">&lt;</span>&nbsp;<span class="num" id="7056178">256</span><span class="op" id="7056181">;</span>&nbsp;<span class="ident" id="7056183">y</span><span class="op" id="7056184">++</span>&nbsp;<span class="op" id="7056187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7056191">for</span>&nbsp;<span class="ident" id="7056195">x</span>&nbsp;<span class="op" id="7056197">:=</span>&nbsp;<span class="num" id="7056200">0</span><span class="op" id="7056201">;</span>&nbsp;<span class="ident" id="7056203">x</span>&nbsp;<span class="op" id="7056205">&lt;</span>&nbsp;<span class="num" id="7056207">256</span><span class="op" id="7056210">;</span>&nbsp;<span class="ident" id="7056212">x</span><span class="op" id="7056213">++</span>&nbsp;<span class="op" id="7056216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056221">m0</span><span class="op" id="7056223">.</span><span class="ident" id="7056224">Set</span><span class="op" id="7056227">(</span><span class="ident" id="7056228">x</span><span class="op" id="7056229">,</span>&nbsp;<span class="ident" id="7056231">y</span><span class="op" id="7056232">,</span>&nbsp;<span class="ident" id="7056234">color</span><span class="op" id="7056239">.</span><span class="ident" id="7056240">RGBA</span><span class="op" id="7056244">{</span><span class="builtintype" id="7056245">uint8</span><span class="op" id="7056250">(</span><span class="ident" id="7056251">x</span><span class="op" id="7056252">)</span><span class="op" id="7056253">,</span>&nbsp;<span class="builtintype" id="7056255">uint8</span><span class="op" id="7056260">(</span><span class="ident" id="7056261">y</span><span class="op" id="7056262">)</span><span class="op" id="7056263">,</span>&nbsp;<span class="num" id="7056265">0</span><span class="op" id="7056266">,</span>&nbsp;<span class="num" id="7056268">255</span><span class="op" id="7056271">}</span><span class="op" id="7056272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7056276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7056279">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056282">m0</span>&nbsp;<span class="op" id="7056285">=</span>&nbsp;<span class="ident" id="7056287">m0</span><span class="op" id="7056289">.</span><span class="ident" id="7056290">SubImage</span><span class="op" id="7056298">(</span><span class="ident" id="7056299">image</span><span class="op" id="7056304">.</span><span class="ident" id="7056305">Rect</span><span class="op" id="7056309">(</span><span class="num" id="7056310">50</span><span class="op" id="7056312">,</span>&nbsp;<span class="num" id="7056314">30</span><span class="op" id="7056316">,</span>&nbsp;<span class="num" id="7056318">250</span><span class="op" id="7056321">,</span>&nbsp;<span class="num" id="7056323">130</span><span class="op" id="7056326">)</span><span class="op" id="7056327">)</span><span class="op" id="7056328">.</span><span class="op" id="7056329">(</span><span class="op" id="7056330">*</span><span class="ident" id="7056331">image</span><span class="op" id="7056336">.</span><span class="ident" id="7056337">RGBA</span><span class="op" id="7056341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056344">m1</span><span class="op" id="7056346">,</span>&nbsp;<span class="ident" id="7056348">err</span>&nbsp;<span class="op" id="7056352">:=</span>&nbsp;<span class="ident" id="7056355">encodeDecode</span><span class="op" id="7056367">(</span><span class="ident" id="7056368">m0</span><span class="op" id="7056370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7056373">if</span>&nbsp;<span class="ident" id="7056376">err</span>&nbsp;<span class="op" id="7056380">!=</span>&nbsp;<span class="ident" id="7056383">nil</span>&nbsp;<span class="op" id="7056387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056391">t</span><span class="op" id="7056392">.</span><span class="ident" id="7056393">Error</span><span class="op" id="7056398">(</span><span class="ident" id="7056399">err</span><span class="op" id="7056402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7056406">return</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7056414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056417">err</span>&nbsp;<span class="op" id="7056421">=</span>&nbsp;<span class="ident" id="7056423">diff</span><span class="op" id="7056427">(</span><span class="ident" id="7056428">m0</span><span class="op" id="7056430">,</span>&nbsp;<span class="ident" id="7056432">m1</span><span class="op" id="7056434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7056437">if</span>&nbsp;<span class="ident" id="7056440">err</span>&nbsp;<span class="op" id="7056444">!=</span>&nbsp;<span class="ident" id="7056447">nil</span>&nbsp;<span class="op" id="7056451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056455">t</span><span class="op" id="7056456">.</span><span class="ident" id="7056457">Error</span><span class="op" id="7056462">(</span><span class="ident" id="7056463">err</span><span class="op" id="7056466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7056470">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7056478">}</span><br>
<span class="lineno"></span><span class="op" id="7056480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7056483">func</span>&nbsp;<span class="ident" id="7056488">BenchmarkEncodeGray</span><span class="op" id="7056507">(</span><span class="ident" id="7056508">b</span>&nbsp;<span class="op" id="7056510">*</span><span class="ident" id="7056511">testing</span><span class="op" id="7056518">.</span><span class="ident" id="7056519">B</span><span class="op" id="7056520">)</span>&nbsp;<span class="op" id="7056522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056525">b</span><span class="op" id="7056526">.</span><span class="ident" id="7056527">StopTimer</span><span class="op" id="7056536">(</span><span class="op" id="7056537">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056540">img</span>&nbsp;<span class="op" id="7056544">:=</span>&nbsp;<span class="ident" id="7056547">image</span><span class="op" id="7056552">.</span><span class="ident" id="7056553">NewGray</span><span class="op" id="7056560">(</span><span class="ident" id="7056561">image</span><span class="op" id="7056566">.</span><span class="ident" id="7056567">Rect</span><span class="op" id="7056571">(</span><span class="num" id="7056572">0</span><span class="op" id="7056573">,</span>&nbsp;<span class="num" id="7056575">0</span><span class="op" id="7056576">,</span>&nbsp;<span class="num" id="7056578">640</span><span class="op" id="7056581">,</span>&nbsp;<span class="num" id="7056583">480</span><span class="op" id="7056586">)</span><span class="op" id="7056587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056590">b</span><span class="op" id="7056591">.</span><span class="ident" id="7056592">SetBytes</span><span class="op" id="7056600">(</span><span class="num" id="7056601">640</span>&nbsp;<span class="op" id="7056605">*</span>&nbsp;<span class="num" id="7056607">480</span>&nbsp;<span class="op" id="7056611">*</span>&nbsp;<span class="num" id="7056613">1</span><span class="op" id="7056614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056617">b</span><span class="op" id="7056618">.</span><span class="ident" id="7056619">StartTimer</span><span class="op" id="7056629">(</span><span class="op" id="7056630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7056633">for</span>&nbsp;<span class="ident" id="7056637">i</span>&nbsp;<span class="op" id="7056639">:=</span>&nbsp;<span class="num" id="7056642">0</span><span class="op" id="7056643">;</span>&nbsp;<span class="ident" id="7056645">i</span>&nbsp;<span class="op" id="7056647">&lt;</span>&nbsp;<span class="ident" id="7056649">b</span><span class="op" id="7056650">.</span><span class="ident" id="7056651">N</span><span class="op" id="7056652">;</span>&nbsp;<span class="ident" id="7056654">i</span><span class="op" id="7056655">++</span>&nbsp;<span class="op" id="7056658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056662">Encode</span><span class="op" id="7056668">(</span><span class="ident" id="7056669">ioutil</span><span class="op" id="7056675">.</span><span class="ident" id="7056676">Discard</span><span class="op" id="7056683">,</span>&nbsp;<span class="ident" id="7056685">img</span><span class="op" id="7056688">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7056691">}</span><br>
<span class="lineno"></span><span class="op" id="7056693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7056696">func</span>&nbsp;<span class="ident" id="7056701">BenchmarkEncodeNRGBOpaque</span><span class="op" id="7056726">(</span><span class="ident" id="7056727">b</span>&nbsp;<span class="op" id="7056729">*</span><span class="ident" id="7056730">testing</span><span class="op" id="7056737">.</span><span class="ident" id="7056738">B</span><span class="op" id="7056739">)</span>&nbsp;<span class="op" id="7056741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056744">b</span><span class="op" id="7056745">.</span><span class="ident" id="7056746">StopTimer</span><span class="op" id="7056755">(</span><span class="op" id="7056756">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056759">img</span>&nbsp;<span class="op" id="7056763">:=</span>&nbsp;<span class="ident" id="7056766">image</span><span class="op" id="7056771">.</span><span class="ident" id="7056772">NewNRGBA</span><span class="op" id="7056780">(</span><span class="ident" id="7056781">image</span><span class="op" id="7056786">.</span><span class="ident" id="7056787">Rect</span><span class="op" id="7056791">(</span><span class="num" id="7056792">0</span><span class="op" id="7056793">,</span>&nbsp;<span class="num" id="7056795">0</span><span class="op" id="7056796">,</span>&nbsp;<span class="num" id="7056798">640</span><span class="op" id="7056801">,</span>&nbsp;<span class="num" id="7056803">480</span><span class="op" id="7056806">)</span><span class="op" id="7056807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7056810">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056865">bo</span>&nbsp;<span class="op" id="7056868">:=</span>&nbsp;<span class="ident" id="7056871">img</span><span class="op" id="7056874">.</span><span class="ident" id="7056875">Bounds</span><span class="op" id="7056881">(</span><span class="op" id="7056882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7056885">for</span>&nbsp;<span class="ident" id="7056889">y</span>&nbsp;<span class="op" id="7056891">:=</span>&nbsp;<span class="ident" id="7056894">bo</span><span class="op" id="7056896">.</span><span class="ident" id="7056897">Min</span><span class="op" id="7056900">.</span><span class="ident" id="7056901">Y</span><span class="op" id="7056902">;</span>&nbsp;<span class="ident" id="7056904">y</span>&nbsp;<span class="op" id="7056906">&lt;</span>&nbsp;<span class="ident" id="7056908">bo</span><span class="op" id="7056910">.</span><span class="ident" id="7056911">Max</span><span class="op" id="7056914">.</span><span class="ident" id="7056915">Y</span><span class="op" id="7056916">;</span>&nbsp;<span class="ident" id="7056918">y</span><span class="op" id="7056919">++</span>&nbsp;<span class="op" id="7056922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7056926">for</span>&nbsp;<span class="ident" id="7056930">x</span>&nbsp;<span class="op" id="7056932">:=</span>&nbsp;<span class="ident" id="7056935">bo</span><span class="op" id="7056937">.</span><span class="ident" id="7056938">Min</span><span class="op" id="7056941">.</span><span class="ident" id="7056942">X</span><span class="op" id="7056943">;</span>&nbsp;<span class="ident" id="7056945">x</span>&nbsp;<span class="op" id="7056947">&lt;</span>&nbsp;<span class="ident" id="7056949">bo</span><span class="op" id="7056951">.</span><span class="ident" id="7056952">Max</span><span class="op" id="7056955">.</span><span class="ident" id="7056956">X</span><span class="op" id="7056957">;</span>&nbsp;<span class="ident" id="7056959">x</span><span class="op" id="7056960">++</span>&nbsp;<span class="op" id="7056963">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7056968">img</span><span class="op" id="7056971">.</span><span class="ident" id="7056972">Set</span><span class="op" id="7056975">(</span><span class="ident" id="7056976">x</span><span class="op" id="7056977">,</span>&nbsp;<span class="ident" id="7056979">y</span><span class="op" id="7056980">,</span>&nbsp;<span class="ident" id="7056982">color</span><span class="op" id="7056987">.</span><span class="ident" id="7056988">NRGBA</span><span class="op" id="7056993">{</span><span class="num" id="7056994">0</span><span class="op" id="7056995">,</span>&nbsp;<span class="num" id="7056997">0</span><span class="op" id="7056998">,</span>&nbsp;<span class="num" id="7057000">0</span><span class="op" id="7057001">,</span>&nbsp;<span class="num" id="7057003">255</span><span class="op" id="7057006">}</span><span class="op" id="7057007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7057011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7057014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7057017">if</span>&nbsp;<span class="op" id="7057020">!</span><span class="ident" id="7057021">img</span><span class="op" id="7057024">.</span><span class="ident" id="7057025">Opaque</span><span class="op" id="7057031">(</span><span class="op" id="7057032">)</span>&nbsp;<span class="op" id="7057034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057038">b</span><span class="op" id="7057039">.</span><span class="ident" id="7057040">Fatal</span><span class="op" id="7057045">(</span><span class="string" id="7057046">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="7057075">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7057078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057081">b</span><span class="op" id="7057082">.</span><span class="ident" id="7057083">SetBytes</span><span class="op" id="7057091">(</span><span class="num" id="7057092">640</span>&nbsp;<span class="op" id="7057096">*</span>&nbsp;<span class="num" id="7057098">480</span>&nbsp;<span class="op" id="7057102">*</span>&nbsp;<span class="num" id="7057104">4</span><span class="op" id="7057105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057108">b</span><span class="op" id="7057109">.</span><span class="ident" id="7057110">StartTimer</span><span class="op" id="7057120">(</span><span class="op" id="7057121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7057124">for</span>&nbsp;<span class="ident" id="7057128">i</span>&nbsp;<span class="op" id="7057130">:=</span>&nbsp;<span class="num" id="7057133">0</span><span class="op" id="7057134">;</span>&nbsp;<span class="ident" id="7057136">i</span>&nbsp;<span class="op" id="7057138">&lt;</span>&nbsp;<span class="ident" id="7057140">b</span><span class="op" id="7057141">.</span><span class="ident" id="7057142">N</span><span class="op" id="7057143">;</span>&nbsp;<span class="ident" id="7057145">i</span><span class="op" id="7057146">++</span>&nbsp;<span class="op" id="7057149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057153">Encode</span><span class="op" id="7057159">(</span><span class="ident" id="7057160">ioutil</span><span class="op" id="7057166">.</span><span class="ident" id="7057167">Discard</span><span class="op" id="7057174">,</span>&nbsp;<span class="ident" id="7057176">img</span><span class="op" id="7057179">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7057182">}</span><br>
<span class="lineno"></span><span class="op" id="7057184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7057187">func</span>&nbsp;<span class="ident" id="7057192">BenchmarkEncodeNRGBA</span><span class="op" id="7057212">(</span><span class="ident" id="7057213">b</span>&nbsp;<span class="op" id="7057215">*</span><span class="ident" id="7057216">testing</span><span class="op" id="7057223">.</span><span class="ident" id="7057224">B</span><span class="op" id="7057225">)</span>&nbsp;<span class="op" id="7057227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057230">b</span><span class="op" id="7057231">.</span><span class="ident" id="7057232">StopTimer</span><span class="op" id="7057241">(</span><span class="op" id="7057242">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057245">img</span>&nbsp;<span class="op" id="7057249">:=</span>&nbsp;<span class="ident" id="7057252">image</span><span class="op" id="7057257">.</span><span class="ident" id="7057258">NewNRGBA</span><span class="op" id="7057266">(</span><span class="ident" id="7057267">image</span><span class="op" id="7057272">.</span><span class="ident" id="7057273">Rect</span><span class="op" id="7057277">(</span><span class="num" id="7057278">0</span><span class="op" id="7057279">,</span>&nbsp;<span class="num" id="7057281">0</span><span class="op" id="7057282">,</span>&nbsp;<span class="num" id="7057284">640</span><span class="op" id="7057287">,</span>&nbsp;<span class="num" id="7057289">480</span><span class="op" id="7057292">)</span><span class="op" id="7057293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7057296">if</span>&nbsp;<span class="ident" id="7057299">img</span><span class="op" id="7057302">.</span><span class="ident" id="7057303">Opaque</span><span class="op" id="7057309">(</span><span class="op" id="7057310">)</span>&nbsp;<span class="op" id="7057312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057316">b</span><span class="op" id="7057317">.</span><span class="ident" id="7057318">Fatal</span><span class="op" id="7057323">(</span><span class="string" id="7057324">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="7057357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7057360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057363">b</span><span class="op" id="7057364">.</span><span class="ident" id="7057365">SetBytes</span><span class="op" id="7057373">(</span><span class="num" id="7057374">640</span>&nbsp;<span class="op" id="7057378">*</span>&nbsp;<span class="num" id="7057380">480</span>&nbsp;<span class="op" id="7057384">*</span>&nbsp;<span class="num" id="7057386">4</span><span class="op" id="7057387">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057390">b</span><span class="op" id="7057391">.</span><span class="ident" id="7057392">StartTimer</span><span class="op" id="7057402">(</span><span class="op" id="7057403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7057406">for</span>&nbsp;<span class="ident" id="7057410">i</span>&nbsp;<span class="op" id="7057412">:=</span>&nbsp;<span class="num" id="7057415">0</span><span class="op" id="7057416">;</span>&nbsp;<span class="ident" id="7057418">i</span>&nbsp;<span class="op" id="7057420">&lt;</span>&nbsp;<span class="ident" id="7057422">b</span><span class="op" id="7057423">.</span><span class="ident" id="7057424">N</span><span class="op" id="7057425">;</span>&nbsp;<span class="ident" id="7057427">i</span><span class="op" id="7057428">++</span>&nbsp;<span class="op" id="7057431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057435">Encode</span><span class="op" id="7057441">(</span><span class="ident" id="7057442">ioutil</span><span class="op" id="7057448">.</span><span class="ident" id="7057449">Discard</span><span class="op" id="7057456">,</span>&nbsp;<span class="ident" id="7057458">img</span><span class="op" id="7057461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7057464">}</span><br>
<span class="lineno"></span><span class="op" id="7057466">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="7057469">func</span>&nbsp;<span class="ident" id="7057474">BenchmarkEncodePaletted</span><span class="op" id="7057497">(</span><span class="ident" id="7057498">b</span>&nbsp;<span class="op" id="7057500">*</span><span class="ident" id="7057501">testing</span><span class="op" id="7057508">.</span><span class="ident" id="7057509">B</span><span class="op" id="7057510">)</span>&nbsp;<span class="op" id="7057512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057515">b</span><span class="op" id="7057516">.</span><span class="ident" id="7057517">StopTimer</span><span class="op" id="7057526">(</span><span class="op" id="7057527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057530">img</span>&nbsp;<span class="op" id="7057534">:=</span>&nbsp;<span class="ident" id="7057537">image</span><span class="op" id="7057542">.</span><span class="ident" id="7057543">NewPaletted</span><span class="op" id="7057554">(</span><span class="ident" id="7057555">image</span><span class="op" id="7057560">.</span><span class="ident" id="7057561">Rect</span><span class="op" id="7057565">(</span><span class="num" id="7057566">0</span><span class="op" id="7057567">,</span>&nbsp;<span class="num" id="7057569">0</span><span class="op" id="7057570">,</span>&nbsp;<span class="num" id="7057572">640</span><span class="op" id="7057575">,</span>&nbsp;<span class="num" id="7057577">480</span><span class="op" id="7057580">)</span><span class="op" id="7057581">,</span>&nbsp;<span class="ident" id="7057583">color</span><span class="op" id="7057588">.</span><span class="ident" id="7057589">Palette</span><span class="op" id="7057596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057600">color</span><span class="op" id="7057605">.</span><span class="ident" id="7057606">RGBA</span><span class="op" id="7057610">{</span><span class="num" id="7057611">0</span><span class="op" id="7057612">,</span>&nbsp;<span class="num" id="7057614">0</span><span class="op" id="7057615">,</span>&nbsp;<span class="num" id="7057617">0</span><span class="op" id="7057618">,</span>&nbsp;<span class="num" id="7057620">255</span><span class="op" id="7057623">}</span><span class="op" id="7057624">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057628">color</span><span class="op" id="7057633">.</span><span class="ident" id="7057634">RGBA</span><span class="op" id="7057638">{</span><span class="num" id="7057639">255</span><span class="op" id="7057642">,</span>&nbsp;<span class="num" id="7057644">255</span><span class="op" id="7057647">,</span>&nbsp;<span class="num" id="7057649">255</span><span class="op" id="7057652">,</span>&nbsp;<span class="num" id="7057654">255</span><span class="op" id="7057657">}</span><span class="op" id="7057658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7057661">}</span><span class="op" id="7057662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057665">b</span><span class="op" id="7057666">.</span><span class="ident" id="7057667">SetBytes</span><span class="op" id="7057675">(</span><span class="num" id="7057676">640</span>&nbsp;<span class="op" id="7057680">*</span>&nbsp;<span class="num" id="7057682">480</span>&nbsp;<span class="op" id="7057686">*</span>&nbsp;<span class="num" id="7057688">1</span><span class="op" id="7057689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057692">b</span><span class="op" id="7057693">.</span><span class="ident" id="7057694">StartTimer</span><span class="op" id="7057704">(</span><span class="op" id="7057705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7057708">for</span>&nbsp;<span class="ident" id="7057712">i</span>&nbsp;<span class="op" id="7057714">:=</span>&nbsp;<span class="num" id="7057717">0</span><span class="op" id="7057718">;</span>&nbsp;<span class="ident" id="7057720">i</span>&nbsp;<span class="op" id="7057722">&lt;</span>&nbsp;<span class="ident" id="7057724">b</span><span class="op" id="7057725">.</span><span class="ident" id="7057726">N</span><span class="op" id="7057727">;</span>&nbsp;<span class="ident" id="7057729">i</span><span class="op" id="7057730">++</span>&nbsp;<span class="op" id="7057733">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057737">Encode</span><span class="op" id="7057743">(</span><span class="ident" id="7057744">ioutil</span><span class="op" id="7057750">.</span><span class="ident" id="7057751">Discard</span><span class="op" id="7057758">,</span>&nbsp;<span class="ident" id="7057760">img</span><span class="op" id="7057763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7057766">}</span><br>
<span class="lineno"></span><span class="op" id="7057768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7057771">func</span>&nbsp;<span class="ident" id="7057776">BenchmarkEncodeRGBOpaque</span><span class="op" id="7057800">(</span><span class="ident" id="7057801">b</span>&nbsp;<span class="op" id="7057803">*</span><span class="ident" id="7057804">testing</span><span class="op" id="7057811">.</span><span class="ident" id="7057812">B</span><span class="op" id="7057813">)</span>&nbsp;<span class="op" id="7057815">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057818">b</span><span class="op" id="7057819">.</span><span class="ident" id="7057820">StopTimer</span><span class="op" id="7057829">(</span><span class="op" id="7057830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057833">img</span>&nbsp;<span class="op" id="7057837">:=</span>&nbsp;<span class="ident" id="7057840">image</span><span class="op" id="7057845">.</span><span class="ident" id="7057846">NewRGBA</span><span class="op" id="7057853">(</span><span class="ident" id="7057854">image</span><span class="op" id="7057859">.</span><span class="ident" id="7057860">Rect</span><span class="op" id="7057864">(</span><span class="num" id="7057865">0</span><span class="op" id="7057866">,</span>&nbsp;<span class="num" id="7057868">0</span><span class="op" id="7057869">,</span>&nbsp;<span class="num" id="7057871">640</span><span class="op" id="7057874">,</span>&nbsp;<span class="num" id="7057876">480</span><span class="op" id="7057879">)</span><span class="op" id="7057880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7057883">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7057938">bo</span>&nbsp;<span class="op" id="7057941">:=</span>&nbsp;<span class="ident" id="7057944">img</span><span class="op" id="7057947">.</span><span class="ident" id="7057948">Bounds</span><span class="op" id="7057954">(</span><span class="op" id="7057955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7057958">for</span>&nbsp;<span class="ident" id="7057962">y</span>&nbsp;<span class="op" id="7057964">:=</span>&nbsp;<span class="ident" id="7057967">bo</span><span class="op" id="7057969">.</span><span class="ident" id="7057970">Min</span><span class="op" id="7057973">.</span><span class="ident" id="7057974">Y</span><span class="op" id="7057975">;</span>&nbsp;<span class="ident" id="7057977">y</span>&nbsp;<span class="op" id="7057979">&lt;</span>&nbsp;<span class="ident" id="7057981">bo</span><span class="op" id="7057983">.</span><span class="ident" id="7057984">Max</span><span class="op" id="7057987">.</span><span class="ident" id="7057988">Y</span><span class="op" id="7057989">;</span>&nbsp;<span class="ident" id="7057991">y</span><span class="op" id="7057992">++</span>&nbsp;<span class="op" id="7057995">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7057999">for</span>&nbsp;<span class="ident" id="7058003">x</span>&nbsp;<span class="op" id="7058005">:=</span>&nbsp;<span class="ident" id="7058008">bo</span><span class="op" id="7058010">.</span><span class="ident" id="7058011">Min</span><span class="op" id="7058014">.</span><span class="ident" id="7058015">X</span><span class="op" id="7058016">;</span>&nbsp;<span class="ident" id="7058018">x</span>&nbsp;<span class="op" id="7058020">&lt;</span>&nbsp;<span class="ident" id="7058022">bo</span><span class="op" id="7058024">.</span><span class="ident" id="7058025">Max</span><span class="op" id="7058028">.</span><span class="ident" id="7058029">X</span><span class="op" id="7058030">;</span>&nbsp;<span class="ident" id="7058032">x</span><span class="op" id="7058033">++</span>&nbsp;<span class="op" id="7058036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058041">img</span><span class="op" id="7058044">.</span><span class="ident" id="7058045">Set</span><span class="op" id="7058048">(</span><span class="ident" id="7058049">x</span><span class="op" id="7058050">,</span>&nbsp;<span class="ident" id="7058052">y</span><span class="op" id="7058053">,</span>&nbsp;<span class="ident" id="7058055">color</span><span class="op" id="7058060">.</span><span class="ident" id="7058061">RGBA</span><span class="op" id="7058065">{</span><span class="num" id="7058066">0</span><span class="op" id="7058067">,</span>&nbsp;<span class="num" id="7058069">0</span><span class="op" id="7058070">,</span>&nbsp;<span class="num" id="7058072">0</span><span class="op" id="7058073">,</span>&nbsp;<span class="num" id="7058075">255</span><span class="op" id="7058078">}</span><span class="op" id="7058079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7058083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7058086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7058089">if</span>&nbsp;<span class="op" id="7058092">!</span><span class="ident" id="7058093">img</span><span class="op" id="7058096">.</span><span class="ident" id="7058097">Opaque</span><span class="op" id="7058103">(</span><span class="op" id="7058104">)</span>&nbsp;<span class="op" id="7058106">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058110">b</span><span class="op" id="7058111">.</span><span class="ident" id="7058112">Fatal</span><span class="op" id="7058117">(</span><span class="string" id="7058118">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="7058147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7058150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058153">b</span><span class="op" id="7058154">.</span><span class="ident" id="7058155">SetBytes</span><span class="op" id="7058163">(</span><span class="num" id="7058164">640</span>&nbsp;<span class="op" id="7058168">*</span>&nbsp;<span class="num" id="7058170">480</span>&nbsp;<span class="op" id="7058174">*</span>&nbsp;<span class="num" id="7058176">4</span><span class="op" id="7058177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058180">b</span><span class="op" id="7058181">.</span><span class="ident" id="7058182">StartTimer</span><span class="op" id="7058192">(</span><span class="op" id="7058193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7058196">for</span>&nbsp;<span class="ident" id="7058200">i</span>&nbsp;<span class="op" id="7058202">:=</span>&nbsp;<span class="num" id="7058205">0</span><span class="op" id="7058206">;</span>&nbsp;<span class="ident" id="7058208">i</span>&nbsp;<span class="op" id="7058210">&lt;</span>&nbsp;<span class="ident" id="7058212">b</span><span class="op" id="7058213">.</span><span class="ident" id="7058214">N</span><span class="op" id="7058215">;</span>&nbsp;<span class="ident" id="7058217">i</span><span class="op" id="7058218">++</span>&nbsp;<span class="op" id="7058221">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058225">Encode</span><span class="op" id="7058231">(</span><span class="ident" id="7058232">ioutil</span><span class="op" id="7058238">.</span><span class="ident" id="7058239">Discard</span><span class="op" id="7058246">,</span>&nbsp;<span class="ident" id="7058248">img</span><span class="op" id="7058251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7058254">}</span><br>
<span class="lineno"></span><span class="op" id="7058256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7058259">func</span>&nbsp;<span class="ident" id="7058264">BenchmarkEncodeRGBA</span><span class="op" id="7058283">(</span><span class="ident" id="7058284">b</span>&nbsp;<span class="op" id="7058286">*</span><span class="ident" id="7058287">testing</span><span class="op" id="7058294">.</span><span class="ident" id="7058295">B</span><span class="op" id="7058296">)</span>&nbsp;<span class="op" id="7058298">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058301">b</span><span class="op" id="7058302">.</span><span class="ident" id="7058303">StopTimer</span><span class="op" id="7058312">(</span><span class="op" id="7058313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058316">img</span>&nbsp;<span class="op" id="7058320">:=</span>&nbsp;<span class="ident" id="7058323">image</span><span class="op" id="7058328">.</span><span class="ident" id="7058329">NewRGBA</span><span class="op" id="7058336">(</span><span class="ident" id="7058337">image</span><span class="op" id="7058342">.</span><span class="ident" id="7058343">Rect</span><span class="op" id="7058347">(</span><span class="num" id="7058348">0</span><span class="op" id="7058349">,</span>&nbsp;<span class="num" id="7058351">0</span><span class="op" id="7058352">,</span>&nbsp;<span class="num" id="7058354">640</span><span class="op" id="7058357">,</span>&nbsp;<span class="num" id="7058359">480</span><span class="op" id="7058362">)</span><span class="op" id="7058363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7058366">if</span>&nbsp;<span class="ident" id="7058369">img</span><span class="op" id="7058372">.</span><span class="ident" id="7058373">Opaque</span><span class="op" id="7058379">(</span><span class="op" id="7058380">)</span>&nbsp;<span class="op" id="7058382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058386">b</span><span class="op" id="7058387">.</span><span class="ident" id="7058388">Fatal</span><span class="op" id="7058393">(</span><span class="string" id="7058394">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="7058427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7058430">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058433">b</span><span class="op" id="7058434">.</span><span class="ident" id="7058435">SetBytes</span><span class="op" id="7058443">(</span><span class="num" id="7058444">640</span>&nbsp;<span class="op" id="7058448">*</span>&nbsp;<span class="num" id="7058450">480</span>&nbsp;<span class="op" id="7058454">*</span>&nbsp;<span class="num" id="7058456">4</span><span class="op" id="7058457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058460">b</span><span class="op" id="7058461">.</span><span class="ident" id="7058462">StartTimer</span><span class="op" id="7058472">(</span><span class="op" id="7058473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7058476">for</span>&nbsp;<span class="ident" id="7058480">i</span>&nbsp;<span class="op" id="7058482">:=</span>&nbsp;<span class="num" id="7058485">0</span><span class="op" id="7058486">;</span>&nbsp;<span class="ident" id="7058488">i</span>&nbsp;<span class="op" id="7058490">&lt;</span>&nbsp;<span class="ident" id="7058492">b</span><span class="op" id="7058493">.</span><span class="ident" id="7058494">N</span><span class="op" id="7058495">;</span>&nbsp;<span class="ident" id="7058497">i</span><span class="op" id="7058498">++</span>&nbsp;<span class="op" id="7058501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7058505">Encode</span><span class="op" id="7058511">(</span><span class="ident" id="7058512">ioutil</span><span class="op" id="7058518">.</span><span class="ident" id="7058519">Discard</span><span class="op" id="7058526">,</span>&nbsp;<span class="ident" id="7058528">img</span><span class="op" id="7058531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7058534">}</span><br>
<span class="lineno">210</span><span class="op" id="7058536">}</span>
</div>
</body>
</html>
