<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7820702">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7820757">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7820811">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7820862">package</span>&nbsp;<span class="ident" id="7820870">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7820875">import</span>&nbsp;<span class="op" id="7820882">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820885">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820898">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820909">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820920">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="7820936">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7820939">var</span>&nbsp;<span class="ident" id="7820943">tests</span>&nbsp;<span class="op" id="7820949">=</span>&nbsp;<span class="op" id="7820951">[</span><span class="op" id="7820952">]</span><span class="keyword" id="7820953">interface</span><span class="op" id="7820962">{</span><span class="op" id="7820963">}</span><span class="op" id="7820964">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7820967">&amp;</span><span class="ident" id="7820968">clientHelloMsg</span><span class="op" id="7820982">{</span><span class="op" id="7820983">}</span><span class="op" id="7820984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7820987">&amp;</span><span class="ident" id="7820988">serverHelloMsg</span><span class="op" id="7821002">{</span><span class="op" id="7821003">}</span><span class="op" id="7821004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821007">&amp;</span><span class="ident" id="7821008">finishedMsg</span><span class="op" id="7821019">{</span><span class="op" id="7821020">}</span><span class="op" id="7821021">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821025">&amp;</span><span class="ident" id="7821026">certificateMsg</span><span class="op" id="7821040">{</span><span class="op" id="7821041">}</span><span class="op" id="7821042">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821045">&amp;</span><span class="ident" id="7821046">certificateRequestMsg</span><span class="op" id="7821067">{</span><span class="op" id="7821068">}</span><span class="op" id="7821069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821072">&amp;</span><span class="ident" id="7821073">certificateVerifyMsg</span><span class="op" id="7821093">{</span><span class="op" id="7821094">}</span><span class="op" id="7821095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821098">&amp;</span><span class="ident" id="7821099">certificateStatusMsg</span><span class="op" id="7821119">{</span><span class="op" id="7821120">}</span><span class="op" id="7821121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821124">&amp;</span><span class="ident" id="7821125">clientKeyExchangeMsg</span><span class="op" id="7821145">{</span><span class="op" id="7821146">}</span><span class="op" id="7821147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821150">&amp;</span><span class="ident" id="7821151">nextProtoMsg</span><span class="op" id="7821163">{</span><span class="op" id="7821164">}</span><span class="op" id="7821165">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821168">&amp;</span><span class="ident" id="7821169">newSessionTicketMsg</span><span class="op" id="7821188">{</span><span class="op" id="7821189">}</span><span class="op" id="7821190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821193">&amp;</span><span class="ident" id="7821194">sessionState</span><span class="op" id="7821206">{</span><span class="op" id="7821207">}</span><span class="op" id="7821208">,</span><br>
<span class="lineno"></span><span class="op" id="7821210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7821213">type</span>&nbsp;<span class="ident" id="7821218">testMessage</span>&nbsp;<span class="keyword" id="7821230">interface</span>&nbsp;<span class="op" id="7821240">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821243">marshal</span><span class="op" id="7821250">(</span><span class="op" id="7821251">)</span>&nbsp;<span class="op" id="7821253">[</span><span class="op" id="7821254">]</span><span class="builtintype" id="7821255">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821261">unmarshal</span><span class="op" id="7821270">(</span><span class="op" id="7821271">[</span><span class="op" id="7821272">]</span><span class="builtintype" id="7821273">byte</span><span class="op" id="7821277">)</span>&nbsp;<span class="builtintype" id="7821279">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821285">equal</span><span class="op" id="7821290">(</span><span class="keyword" id="7821291">interface</span><span class="op" id="7821300">{</span><span class="op" id="7821301">}</span><span class="op" id="7821302">)</span>&nbsp;<span class="builtintype" id="7821304">bool</span><br>
<span class="lineno"></span><span class="op" id="7821309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7821312">func</span>&nbsp;<span class="ident" id="7821317">TestMarshalUnmarshal</span><span class="op" id="7821337">(</span><span class="ident" id="7821338">t</span>&nbsp;<span class="op" id="7821340">*</span><span class="ident" id="7821341">testing</span><span class="op" id="7821348">.</span><span class="ident" id="7821349">T</span><span class="op" id="7821350">)</span>&nbsp;<span class="op" id="7821352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821355">rand</span>&nbsp;<span class="op" id="7821360">:=</span>&nbsp;<span class="ident" id="7821363">rand</span><span class="op" id="7821367">.</span><span class="ident" id="7821368">New</span><span class="op" id="7821371">(</span><span class="ident" id="7821372">rand</span><span class="op" id="7821376">.</span><span class="ident" id="7821377">NewSource</span><span class="op" id="7821386">(</span><span class="num" id="7821387">0</span><span class="op" id="7821388">)</span><span class="op" id="7821389">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7821393">for</span>&nbsp;<span class="ident" id="7821397">i</span><span class="op" id="7821398">,</span>&nbsp;<span class="ident" id="7821400">iface</span>&nbsp;<span class="op" id="7821406">:=</span>&nbsp;<span class="keyword" id="7821409">range</span>&nbsp;<span class="ident" id="7821415">tests</span>&nbsp;<span class="op" id="7821421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821425">ty</span>&nbsp;<span class="op" id="7821428">:=</span>&nbsp;<span class="ident" id="7821431">reflect</span><span class="op" id="7821438">.</span><span class="ident" id="7821439">ValueOf</span><span class="op" id="7821446">(</span><span class="ident" id="7821447">iface</span><span class="op" id="7821452">)</span><span class="op" id="7821453">.</span><span class="ident" id="7821454">Type</span><span class="op" id="7821458">(</span><span class="op" id="7821459">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821464">n</span>&nbsp;<span class="op" id="7821466">:=</span>&nbsp;<span class="num" id="7821469">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7821475">if</span>&nbsp;<span class="ident" id="7821478">testing</span><span class="op" id="7821485">.</span><span class="ident" id="7821486">Short</span><span class="op" id="7821491">(</span><span class="op" id="7821492">)</span>&nbsp;<span class="op" id="7821494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821499">n</span>&nbsp;<span class="op" id="7821501">=</span>&nbsp;<span class="num" id="7821503">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821507">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7821511">for</span>&nbsp;<span class="ident" id="7821515">j</span>&nbsp;<span class="op" id="7821517">:=</span>&nbsp;<span class="num" id="7821520">0</span><span class="op" id="7821521">;</span>&nbsp;<span class="ident" id="7821523">j</span>&nbsp;<span class="op" id="7821525">&lt;</span>&nbsp;<span class="ident" id="7821527">n</span><span class="op" id="7821528">;</span>&nbsp;<span class="ident" id="7821530">j</span><span class="op" id="7821531">++</span>&nbsp;<span class="op" id="7821534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821539">v</span><span class="op" id="7821540">,</span>&nbsp;<span class="ident" id="7821542">ok</span>&nbsp;<span class="op" id="7821545">:=</span>&nbsp;<span class="ident" id="7821548">quick</span><span class="op" id="7821553">.</span><span class="ident" id="7821554">Value</span><span class="op" id="7821559">(</span><span class="ident" id="7821560">ty</span><span class="op" id="7821562">,</span>&nbsp;<span class="ident" id="7821564">rand</span><span class="op" id="7821568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7821573">if</span>&nbsp;<span class="op" id="7821576">!</span><span class="ident" id="7821577">ok</span>&nbsp;<span class="op" id="7821580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821586">t</span><span class="op" id="7821587">.</span><span class="ident" id="7821588">Errorf</span><span class="op" id="7821594">(</span><span class="string" id="7821595">&#34;#%d:&nbsp;failed&nbsp;to&nbsp;create&nbsp;value&#34;</span><span class="op" id="7821624">,</span>&nbsp;<span class="ident" id="7821626">i</span><span class="op" id="7821627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7821633">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821648">m1</span>&nbsp;<span class="op" id="7821651">:=</span>&nbsp;<span class="ident" id="7821654">v</span><span class="op" id="7821655">.</span><span class="ident" id="7821656">Interface</span><span class="op" id="7821665">(</span><span class="op" id="7821666">)</span><span class="op" id="7821667">.</span><span class="op" id="7821668">(</span><span class="ident" id="7821669">testMessage</span><span class="op" id="7821680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821685">marshaled</span>&nbsp;<span class="op" id="7821695">:=</span>&nbsp;<span class="ident" id="7821698">m1</span><span class="op" id="7821700">.</span><span class="ident" id="7821701">marshal</span><span class="op" id="7821708">(</span><span class="op" id="7821709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821714">m2</span>&nbsp;<span class="op" id="7821717">:=</span>&nbsp;<span class="ident" id="7821720">iface</span><span class="op" id="7821725">.</span><span class="op" id="7821726">(</span><span class="ident" id="7821727">testMessage</span><span class="op" id="7821738">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7821743">if</span>&nbsp;<span class="op" id="7821746">!</span><span class="ident" id="7821747">m2</span><span class="op" id="7821749">.</span><span class="ident" id="7821750">unmarshal</span><span class="op" id="7821759">(</span><span class="ident" id="7821760">marshaled</span><span class="op" id="7821769">)</span>&nbsp;<span class="op" id="7821771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821777">t</span><span class="op" id="7821778">.</span><span class="ident" id="7821779">Errorf</span><span class="op" id="7821785">(</span><span class="string" id="7821786">&#34;#%d&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;%#v&nbsp;%x&#34;</span><span class="op" id="7821818">,</span>&nbsp;<span class="ident" id="7821820">i</span><span class="op" id="7821821">,</span>&nbsp;<span class="ident" id="7821823">m1</span><span class="op" id="7821825">,</span>&nbsp;<span class="ident" id="7821827">marshaled</span><span class="op" id="7821836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7821842">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821856">m2</span><span class="op" id="7821858">.</span><span class="ident" id="7821859">marshal</span><span class="op" id="7821866">(</span><span class="op" id="7821867">)</span>&nbsp;<span class="comment" id="7821869">//&nbsp;to&nbsp;fill&nbsp;any&nbsp;marshal&nbsp;cache&nbsp;in&nbsp;the&nbsp;message</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7821917">if</span>&nbsp;<span class="op" id="7821920">!</span><span class="ident" id="7821921">m1</span><span class="op" id="7821923">.</span><span class="ident" id="7821924">equal</span><span class="op" id="7821929">(</span><span class="ident" id="7821930">m2</span><span class="op" id="7821932">)</span>&nbsp;<span class="op" id="7821934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821940">t</span><span class="op" id="7821941">.</span><span class="ident" id="7821942">Errorf</span><span class="op" id="7821948">(</span><span class="string" id="7821949">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&nbsp;%x&#34;</span><span class="op" id="7821974">,</span>&nbsp;<span class="ident" id="7821976">i</span><span class="op" id="7821977">,</span>&nbsp;<span class="ident" id="7821979">m2</span><span class="op" id="7821981">,</span>&nbsp;<span class="ident" id="7821983">m1</span><span class="op" id="7821985">,</span>&nbsp;<span class="ident" id="7821987">marshaled</span><span class="op" id="7821996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7822002">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822011">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7822017">if</span>&nbsp;<span class="ident" id="7822020">i</span>&nbsp;<span class="op" id="7822022">&gt;=</span>&nbsp;<span class="num" id="7822025">3</span>&nbsp;<span class="op" id="7822027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7822033">//&nbsp;The&nbsp;first&nbsp;three&nbsp;message&nbsp;types&nbsp;(ClientHello,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7822084">//&nbsp;ServerHello&nbsp;and&nbsp;Finished)&nbsp;are&nbsp;allowed&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7822132">//&nbsp;have&nbsp;parsable&nbsp;prefixes&nbsp;because&nbsp;the&nbsp;extension</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7822184">//&nbsp;data&nbsp;is&nbsp;optional&nbsp;and&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7822230">//&nbsp;Finished&nbsp;varies&nbsp;across&nbsp;versions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7822270">for</span>&nbsp;<span class="ident" id="7822274">j</span>&nbsp;<span class="op" id="7822276">:=</span>&nbsp;<span class="num" id="7822279">0</span><span class="op" id="7822280">;</span>&nbsp;<span class="ident" id="7822282">j</span>&nbsp;<span class="op" id="7822284">&lt;</span>&nbsp;<span class="builtinfunc" id="7822286">len</span><span class="op" id="7822289">(</span><span class="ident" id="7822290">marshaled</span><span class="op" id="7822299">)</span><span class="op" id="7822300">;</span>&nbsp;<span class="ident" id="7822302">j</span><span class="op" id="7822303">++</span>&nbsp;<span class="op" id="7822306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7822313">if</span>&nbsp;<span class="ident" id="7822316">m2</span><span class="op" id="7822318">.</span><span class="ident" id="7822319">unmarshal</span><span class="op" id="7822328">(</span><span class="ident" id="7822329">marshaled</span><span class="op" id="7822338">[</span><span class="num" id="7822339">0</span><span class="op" id="7822340">:</span><span class="ident" id="7822341">j</span><span class="op" id="7822342">]</span><span class="op" id="7822343">)</span>&nbsp;<span class="op" id="7822345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822353">t</span><span class="op" id="7822354">.</span><span class="ident" id="7822355">Errorf</span><span class="op" id="7822361">(</span><span class="string" id="7822362">&#34;#%d&nbsp;unmarshaled&nbsp;a&nbsp;prefix&nbsp;of&nbsp;length&nbsp;%d&nbsp;of&nbsp;%#v&#34;</span><span class="op" id="7822408">,</span>&nbsp;<span class="ident" id="7822410">i</span><span class="op" id="7822411">,</span>&nbsp;<span class="ident" id="7822413">j</span><span class="op" id="7822414">,</span>&nbsp;<span class="ident" id="7822416">m1</span><span class="op" id="7822418">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7822426">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822452">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822455">}</span><br>
<span class="lineno"></span><span class="op" id="7822457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7822460">func</span>&nbsp;<span class="ident" id="7822465">TestFuzz</span><span class="op" id="7822473">(</span><span class="ident" id="7822474">t</span>&nbsp;<span class="op" id="7822476">*</span><span class="ident" id="7822477">testing</span><span class="op" id="7822484">.</span><span class="ident" id="7822485">T</span><span class="op" id="7822486">)</span>&nbsp;<span class="op" id="7822488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822491">rand</span>&nbsp;<span class="op" id="7822496">:=</span>&nbsp;<span class="ident" id="7822499">rand</span><span class="op" id="7822503">.</span><span class="ident" id="7822504">New</span><span class="op" id="7822507">(</span><span class="ident" id="7822508">rand</span><span class="op" id="7822512">.</span><span class="ident" id="7822513">NewSource</span><span class="op" id="7822522">(</span><span class="num" id="7822523">0</span><span class="op" id="7822524">)</span><span class="op" id="7822525">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7822528">for</span>&nbsp;<span class="ident" id="7822532">_</span><span class="op" id="7822533">,</span>&nbsp;<span class="ident" id="7822535">iface</span>&nbsp;<span class="op" id="7822541">:=</span>&nbsp;<span class="keyword" id="7822544">range</span>&nbsp;<span class="ident" id="7822550">tests</span>&nbsp;<span class="op" id="7822556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822560">m</span>&nbsp;<span class="op" id="7822562">:=</span>&nbsp;<span class="ident" id="7822565">iface</span><span class="op" id="7822570">.</span><span class="op" id="7822571">(</span><span class="ident" id="7822572">testMessage</span><span class="op" id="7822583">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7822588">for</span>&nbsp;<span class="ident" id="7822592">j</span>&nbsp;<span class="op" id="7822594">:=</span>&nbsp;<span class="num" id="7822597">0</span><span class="op" id="7822598">;</span>&nbsp;<span class="ident" id="7822600">j</span>&nbsp;<span class="op" id="7822602">&lt;</span>&nbsp;<span class="num" id="7822604">1000</span><span class="op" id="7822608">;</span>&nbsp;<span class="ident" id="7822610">j</span><span class="op" id="7822611">++</span>&nbsp;<span class="op" id="7822614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7822619">len</span>&nbsp;<span class="op" id="7822623">:=</span>&nbsp;<span class="ident" id="7822626">rand</span><span class="op" id="7822630">.</span><span class="ident" id="7822631">Intn</span><span class="op" id="7822635">(</span><span class="num" id="7822636">100</span><span class="op" id="7822639">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822644">bytes</span>&nbsp;<span class="op" id="7822650">:=</span>&nbsp;<span class="ident" id="7822653">randomBytes</span><span class="op" id="7822664">(</span><span class="builtinfunc" id="7822665">len</span><span class="op" id="7822668">,</span>&nbsp;<span class="ident" id="7822670">rand</span><span class="op" id="7822674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7822679">//&nbsp;This&nbsp;just&nbsp;looks&nbsp;for&nbsp;crashes&nbsp;due&nbsp;to&nbsp;bounds&nbsp;errors&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822739">m</span><span class="op" id="7822740">.</span><span class="ident" id="7822741">unmarshal</span><span class="op" id="7822750">(</span><span class="ident" id="7822751">bytes</span><span class="op" id="7822756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822763">}</span><br>
<span class="lineno">95</span><span class="op" id="7822765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7822768">func</span>&nbsp;<span class="ident" id="7822773">randomBytes</span><span class="op" id="7822784">(</span><span class="ident" id="7822785">n</span>&nbsp;<span class="builtintype" id="7822787">int</span><span class="op" id="7822790">,</span>&nbsp;<span class="ident" id="7822792">rand</span>&nbsp;<span class="op" id="7822797">*</span><span class="ident" id="7822798">rand</span><span class="op" id="7822802">.</span><span class="ident" id="7822803">Rand</span><span class="op" id="7822807">)</span>&nbsp;<span class="op" id="7822809">[</span><span class="op" id="7822810">]</span><span class="builtintype" id="7822811">byte</span>&nbsp;<span class="op" id="7822816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822819">r</span>&nbsp;<span class="op" id="7822821">:=</span>&nbsp;<span class="builtinfunc" id="7822824">make</span><span class="op" id="7822828">(</span><span class="op" id="7822829">[</span><span class="op" id="7822830">]</span><span class="builtintype" id="7822831">byte</span><span class="op" id="7822835">,</span>&nbsp;<span class="ident" id="7822837">n</span><span class="op" id="7822838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7822841">for</span>&nbsp;<span class="ident" id="7822845">i</span>&nbsp;<span class="op" id="7822847">:=</span>&nbsp;<span class="num" id="7822850">0</span><span class="op" id="7822851">;</span>&nbsp;<span class="ident" id="7822853">i</span>&nbsp;<span class="op" id="7822855">&lt;</span>&nbsp;<span class="ident" id="7822857">n</span><span class="op" id="7822858">;</span>&nbsp;<span class="ident" id="7822860">i</span><span class="op" id="7822861">++</span>&nbsp;<span class="op" id="7822864">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822868">r</span><span class="op" id="7822869">[</span><span class="ident" id="7822870">i</span><span class="op" id="7822871">]</span>&nbsp;<span class="op" id="7822873">=</span>&nbsp;<span class="builtintype" id="7822875">byte</span><span class="op" id="7822879">(</span><span class="ident" id="7822880">rand</span><span class="op" id="7822884">.</span><span class="ident" id="7822885">Int31</span><span class="op" id="7822890">(</span><span class="op" id="7822891">)</span><span class="op" id="7822892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7822898">return</span>&nbsp;<span class="ident" id="7822905">r</span><br>
<span class="lineno"></span><span class="op" id="7822907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="7822910">func</span>&nbsp;<span class="ident" id="7822915">randomString</span><span class="op" id="7822927">(</span><span class="ident" id="7822928">n</span>&nbsp;<span class="builtintype" id="7822930">int</span><span class="op" id="7822933">,</span>&nbsp;<span class="ident" id="7822935">rand</span>&nbsp;<span class="op" id="7822940">*</span><span class="ident" id="7822941">rand</span><span class="op" id="7822945">.</span><span class="ident" id="7822946">Rand</span><span class="op" id="7822950">)</span>&nbsp;<span class="builtintype" id="7822952">string</span>&nbsp;<span class="op" id="7822959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822962">b</span>&nbsp;<span class="op" id="7822964">:=</span>&nbsp;<span class="ident" id="7822967">randomBytes</span><span class="op" id="7822978">(</span><span class="ident" id="7822979">n</span><span class="op" id="7822980">,</span>&nbsp;<span class="ident" id="7822982">rand</span><span class="op" id="7822986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7822989">return</span>&nbsp;<span class="builtintype" id="7822996">string</span><span class="op" id="7823002">(</span><span class="ident" id="7823003">b</span><span class="op" id="7823004">)</span><br>
<span class="lineno"></span><span class="op" id="7823006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7823009">func</span>&nbsp;<span class="op" id="7823014">(</span><span class="op" id="7823015">*</span><span class="ident" id="7823016">clientHelloMsg</span><span class="op" id="7823030">)</span>&nbsp;<span class="ident" id="7823032">Generate</span><span class="op" id="7823040">(</span><span class="ident" id="7823041">rand</span>&nbsp;<span class="op" id="7823046">*</span><span class="ident" id="7823047">rand</span><span class="op" id="7823051">.</span><span class="ident" id="7823052">Rand</span><span class="op" id="7823056">,</span>&nbsp;<span class="ident" id="7823058">size</span>&nbsp;<span class="builtintype" id="7823063">int</span><span class="op" id="7823066">)</span>&nbsp;<span class="ident" id="7823068">reflect</span><span class="op" id="7823075">.</span><span class="ident" id="7823076">Value</span>&nbsp;<span class="op" id="7823082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823085">m</span>&nbsp;<span class="op" id="7823087">:=</span>&nbsp;<span class="op" id="7823090">&amp;</span><span class="ident" id="7823091">clientHelloMsg</span><span class="op" id="7823105">{</span><span class="op" id="7823106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823109">m</span><span class="op" id="7823110">.</span><span class="ident" id="7823111">vers</span>&nbsp;<span class="op" id="7823116">=</span>&nbsp;<span class="builtintype" id="7823118">uint16</span><span class="op" id="7823124">(</span><span class="ident" id="7823125">rand</span><span class="op" id="7823129">.</span><span class="ident" id="7823130">Intn</span><span class="op" id="7823134">(</span><span class="num" id="7823135">65536</span><span class="op" id="7823140">)</span><span class="op" id="7823141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823144">m</span><span class="op" id="7823145">.</span><span class="ident" id="7823146">random</span>&nbsp;<span class="op" id="7823153">=</span>&nbsp;<span class="ident" id="7823155">randomBytes</span><span class="op" id="7823166">(</span><span class="num" id="7823167">32</span><span class="op" id="7823169">,</span>&nbsp;<span class="ident" id="7823171">rand</span><span class="op" id="7823175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823178">m</span><span class="op" id="7823179">.</span><span class="ident" id="7823180">sessionId</span>&nbsp;<span class="op" id="7823190">=</span>&nbsp;<span class="ident" id="7823192">randomBytes</span><span class="op" id="7823203">(</span><span class="ident" id="7823204">rand</span><span class="op" id="7823208">.</span><span class="ident" id="7823209">Intn</span><span class="op" id="7823213">(</span><span class="num" id="7823214">32</span><span class="op" id="7823216">)</span><span class="op" id="7823217">,</span>&nbsp;<span class="ident" id="7823219">rand</span><span class="op" id="7823223">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823226">m</span><span class="op" id="7823227">.</span><span class="ident" id="7823228">cipherSuites</span>&nbsp;<span class="op" id="7823241">=</span>&nbsp;<span class="builtinfunc" id="7823243">make</span><span class="op" id="7823247">(</span><span class="op" id="7823248">[</span><span class="op" id="7823249">]</span><span class="builtintype" id="7823250">uint16</span><span class="op" id="7823256">,</span>&nbsp;<span class="ident" id="7823258">rand</span><span class="op" id="7823262">.</span><span class="ident" id="7823263">Intn</span><span class="op" id="7823267">(</span><span class="num" id="7823268">63</span><span class="op" id="7823270">)</span><span class="op" id="7823271">+</span><span class="num" id="7823272">1</span><span class="op" id="7823273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7823276">for</span>&nbsp;<span class="ident" id="7823280">i</span>&nbsp;<span class="op" id="7823282">:=</span>&nbsp;<span class="num" id="7823285">0</span><span class="op" id="7823286">;</span>&nbsp;<span class="ident" id="7823288">i</span>&nbsp;<span class="op" id="7823290">&lt;</span>&nbsp;<span class="builtinfunc" id="7823292">len</span><span class="op" id="7823295">(</span><span class="ident" id="7823296">m</span><span class="op" id="7823297">.</span><span class="ident" id="7823298">cipherSuites</span><span class="op" id="7823310">)</span><span class="op" id="7823311">;</span>&nbsp;<span class="ident" id="7823313">i</span><span class="op" id="7823314">++</span>&nbsp;<span class="op" id="7823317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823321">m</span><span class="op" id="7823322">.</span><span class="ident" id="7823323">cipherSuites</span><span class="op" id="7823335">[</span><span class="ident" id="7823336">i</span><span class="op" id="7823337">]</span>&nbsp;<span class="op" id="7823339">=</span>&nbsp;<span class="builtintype" id="7823341">uint16</span><span class="op" id="7823347">(</span><span class="ident" id="7823348">rand</span><span class="op" id="7823352">.</span><span class="ident" id="7823353">Int31</span><span class="op" id="7823358">(</span><span class="op" id="7823359">)</span><span class="op" id="7823360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7823363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823366">m</span><span class="op" id="7823367">.</span><span class="ident" id="7823368">compressionMethods</span>&nbsp;<span class="op" id="7823387">=</span>&nbsp;<span class="ident" id="7823389">randomBytes</span><span class="op" id="7823400">(</span><span class="ident" id="7823401">rand</span><span class="op" id="7823405">.</span><span class="ident" id="7823406">Intn</span><span class="op" id="7823410">(</span><span class="num" id="7823411">63</span><span class="op" id="7823413">)</span><span class="op" id="7823414">+</span><span class="num" id="7823415">1</span><span class="op" id="7823416">,</span>&nbsp;<span class="ident" id="7823418">rand</span><span class="op" id="7823422">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7823425">if</span>&nbsp;<span class="ident" id="7823428">rand</span><span class="op" id="7823432">.</span><span class="ident" id="7823433">Intn</span><span class="op" id="7823437">(</span><span class="num" id="7823438">10</span><span class="op" id="7823440">)</span>&nbsp;<span class="op" id="7823442">&gt;</span>&nbsp;<span class="num" id="7823444">5</span>&nbsp;<span class="op" id="7823446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823450">m</span><span class="op" id="7823451">.</span><span class="ident" id="7823452">nextProtoNeg</span>&nbsp;<span class="op" id="7823465">=</span>&nbsp;<span class="ident" id="7823467">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7823473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7823476">if</span>&nbsp;<span class="ident" id="7823479">rand</span><span class="op" id="7823483">.</span><span class="ident" id="7823484">Intn</span><span class="op" id="7823488">(</span><span class="num" id="7823489">10</span><span class="op" id="7823491">)</span>&nbsp;<span class="op" id="7823493">&gt;</span>&nbsp;<span class="num" id="7823495">5</span>&nbsp;<span class="op" id="7823497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823501">m</span><span class="op" id="7823502">.</span><span class="ident" id="7823503">serverName</span>&nbsp;<span class="op" id="7823514">=</span>&nbsp;<span class="ident" id="7823516">randomString</span><span class="op" id="7823528">(</span><span class="ident" id="7823529">rand</span><span class="op" id="7823533">.</span><span class="ident" id="7823534">Intn</span><span class="op" id="7823538">(</span><span class="num" id="7823539">255</span><span class="op" id="7823542">)</span><span class="op" id="7823543">,</span>&nbsp;<span class="ident" id="7823545">rand</span><span class="op" id="7823549">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7823552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823555">m</span><span class="op" id="7823556">.</span><span class="ident" id="7823557">ocspStapling</span>&nbsp;<span class="op" id="7823570">=</span>&nbsp;<span class="ident" id="7823572">rand</span><span class="op" id="7823576">.</span><span class="ident" id="7823577">Intn</span><span class="op" id="7823581">(</span><span class="num" id="7823582">10</span><span class="op" id="7823584">)</span>&nbsp;<span class="op" id="7823586">&gt;</span>&nbsp;<span class="num" id="7823588">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823591">m</span><span class="op" id="7823592">.</span><span class="ident" id="7823593">supportedPoints</span>&nbsp;<span class="op" id="7823609">=</span>&nbsp;<span class="ident" id="7823611">randomBytes</span><span class="op" id="7823622">(</span><span class="ident" id="7823623">rand</span><span class="op" id="7823627">.</span><span class="ident" id="7823628">Intn</span><span class="op" id="7823632">(</span><span class="num" id="7823633">5</span><span class="op" id="7823634">)</span><span class="op" id="7823635">+</span><span class="num" id="7823636">1</span><span class="op" id="7823637">,</span>&nbsp;<span class="ident" id="7823639">rand</span><span class="op" id="7823643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823646">m</span><span class="op" id="7823647">.</span><span class="ident" id="7823648">supportedCurves</span>&nbsp;<span class="op" id="7823664">=</span>&nbsp;<span class="builtinfunc" id="7823666">make</span><span class="op" id="7823670">(</span><span class="op" id="7823671">[</span><span class="op" id="7823672">]</span><span class="ident" id="7823673">CurveID</span><span class="op" id="7823680">,</span>&nbsp;<span class="ident" id="7823682">rand</span><span class="op" id="7823686">.</span><span class="ident" id="7823687">Intn</span><span class="op" id="7823691">(</span><span class="num" id="7823692">5</span><span class="op" id="7823693">)</span><span class="op" id="7823694">+</span><span class="num" id="7823695">1</span><span class="op" id="7823696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7823699">for</span>&nbsp;<span class="ident" id="7823703">i</span>&nbsp;<span class="op" id="7823705">:=</span>&nbsp;<span class="keyword" id="7823708">range</span>&nbsp;<span class="ident" id="7823714">m</span><span class="op" id="7823715">.</span><span class="ident" id="7823716">supportedCurves</span>&nbsp;<span class="op" id="7823732">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823736">m</span><span class="op" id="7823737">.</span><span class="ident" id="7823738">supportedCurves</span><span class="op" id="7823753">[</span><span class="ident" id="7823754">i</span><span class="op" id="7823755">]</span>&nbsp;<span class="op" id="7823757">=</span>&nbsp;<span class="ident" id="7823759">CurveID</span><span class="op" id="7823766">(</span><span class="ident" id="7823767">rand</span><span class="op" id="7823771">.</span><span class="ident" id="7823772">Intn</span><span class="op" id="7823776">(</span><span class="num" id="7823777">30000</span><span class="op" id="7823782">)</span><span class="op" id="7823783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7823786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7823789">if</span>&nbsp;<span class="ident" id="7823792">rand</span><span class="op" id="7823796">.</span><span class="ident" id="7823797">Intn</span><span class="op" id="7823801">(</span><span class="num" id="7823802">10</span><span class="op" id="7823804">)</span>&nbsp;<span class="op" id="7823806">&gt;</span>&nbsp;<span class="num" id="7823808">5</span>&nbsp;<span class="op" id="7823810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823814">m</span><span class="op" id="7823815">.</span><span class="ident" id="7823816">ticketSupported</span>&nbsp;<span class="op" id="7823832">=</span>&nbsp;<span class="ident" id="7823834">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7823841">if</span>&nbsp;<span class="ident" id="7823844">rand</span><span class="op" id="7823848">.</span><span class="ident" id="7823849">Intn</span><span class="op" id="7823853">(</span><span class="num" id="7823854">10</span><span class="op" id="7823856">)</span>&nbsp;<span class="op" id="7823858">&gt;</span>&nbsp;<span class="num" id="7823860">5</span>&nbsp;<span class="op" id="7823862">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823867">m</span><span class="op" id="7823868">.</span><span class="ident" id="7823869">sessionTicket</span>&nbsp;<span class="op" id="7823883">=</span>&nbsp;<span class="ident" id="7823885">randomBytes</span><span class="op" id="7823896">(</span><span class="ident" id="7823897">rand</span><span class="op" id="7823901">.</span><span class="ident" id="7823902">Intn</span><span class="op" id="7823906">(</span><span class="num" id="7823907">300</span><span class="op" id="7823910">)</span><span class="op" id="7823911">,</span>&nbsp;<span class="ident" id="7823913">rand</span><span class="op" id="7823917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7823921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7823924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7823927">if</span>&nbsp;<span class="ident" id="7823930">rand</span><span class="op" id="7823934">.</span><span class="ident" id="7823935">Intn</span><span class="op" id="7823939">(</span><span class="num" id="7823940">10</span><span class="op" id="7823942">)</span>&nbsp;<span class="op" id="7823944">&gt;</span>&nbsp;<span class="num" id="7823946">5</span>&nbsp;<span class="op" id="7823948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823952">m</span><span class="op" id="7823953">.</span><span class="ident" id="7823954">signatureAndHashes</span>&nbsp;<span class="op" id="7823973">=</span>&nbsp;<span class="ident" id="7823975">supportedSKXSignatureAlgorithms</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7824008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824011">m</span><span class="op" id="7824012">.</span><span class="ident" id="7824013">alpnProtocols</span>&nbsp;<span class="op" id="7824027">=</span>&nbsp;<span class="builtinfunc" id="7824029">make</span><span class="op" id="7824033">(</span><span class="op" id="7824034">[</span><span class="op" id="7824035">]</span><span class="builtintype" id="7824036">string</span><span class="op" id="7824042">,</span>&nbsp;<span class="ident" id="7824044">rand</span><span class="op" id="7824048">.</span><span class="ident" id="7824049">Intn</span><span class="op" id="7824053">(</span><span class="num" id="7824054">5</span><span class="op" id="7824055">)</span><span class="op" id="7824056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7824059">for</span>&nbsp;<span class="ident" id="7824063">i</span>&nbsp;<span class="op" id="7824065">:=</span>&nbsp;<span class="keyword" id="7824068">range</span>&nbsp;<span class="ident" id="7824074">m</span><span class="op" id="7824075">.</span><span class="ident" id="7824076">alpnProtocols</span>&nbsp;<span class="op" id="7824090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824094">m</span><span class="op" id="7824095">.</span><span class="ident" id="7824096">alpnProtocols</span><span class="op" id="7824109">[</span><span class="ident" id="7824110">i</span><span class="op" id="7824111">]</span>&nbsp;<span class="op" id="7824113">=</span>&nbsp;<span class="ident" id="7824115">randomString</span><span class="op" id="7824127">(</span><span class="ident" id="7824128">rand</span><span class="op" id="7824132">.</span><span class="ident" id="7824133">Intn</span><span class="op" id="7824137">(</span><span class="num" id="7824138">20</span><span class="op" id="7824140">)</span><span class="op" id="7824141">+</span><span class="num" id="7824142">1</span><span class="op" id="7824143">,</span>&nbsp;<span class="ident" id="7824145">rand</span><span class="op" id="7824149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7824152">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7824156">return</span>&nbsp;<span class="ident" id="7824163">reflect</span><span class="op" id="7824170">.</span><span class="ident" id="7824171">ValueOf</span><span class="op" id="7824178">(</span><span class="ident" id="7824179">m</span><span class="op" id="7824180">)</span><br>
<span class="lineno"></span><span class="op" id="7824182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7824185">func</span>&nbsp;<span class="op" id="7824190">(</span><span class="op" id="7824191">*</span><span class="ident" id="7824192">serverHelloMsg</span><span class="op" id="7824206">)</span>&nbsp;<span class="ident" id="7824208">Generate</span><span class="op" id="7824216">(</span><span class="ident" id="7824217">rand</span>&nbsp;<span class="op" id="7824222">*</span><span class="ident" id="7824223">rand</span><span class="op" id="7824227">.</span><span class="ident" id="7824228">Rand</span><span class="op" id="7824232">,</span>&nbsp;<span class="ident" id="7824234">size</span>&nbsp;<span class="builtintype" id="7824239">int</span><span class="op" id="7824242">)</span>&nbsp;<span class="ident" id="7824244">reflect</span><span class="op" id="7824251">.</span><span class="ident" id="7824252">Value</span>&nbsp;<span class="op" id="7824258">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824261">m</span>&nbsp;<span class="op" id="7824263">:=</span>&nbsp;<span class="op" id="7824266">&amp;</span><span class="ident" id="7824267">serverHelloMsg</span><span class="op" id="7824281">{</span><span class="op" id="7824282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824285">m</span><span class="op" id="7824286">.</span><span class="ident" id="7824287">vers</span>&nbsp;<span class="op" id="7824292">=</span>&nbsp;<span class="builtintype" id="7824294">uint16</span><span class="op" id="7824300">(</span><span class="ident" id="7824301">rand</span><span class="op" id="7824305">.</span><span class="ident" id="7824306">Intn</span><span class="op" id="7824310">(</span><span class="num" id="7824311">65536</span><span class="op" id="7824316">)</span><span class="op" id="7824317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824320">m</span><span class="op" id="7824321">.</span><span class="ident" id="7824322">random</span>&nbsp;<span class="op" id="7824329">=</span>&nbsp;<span class="ident" id="7824331">randomBytes</span><span class="op" id="7824342">(</span><span class="num" id="7824343">32</span><span class="op" id="7824345">,</span>&nbsp;<span class="ident" id="7824347">rand</span><span class="op" id="7824351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824354">m</span><span class="op" id="7824355">.</span><span class="ident" id="7824356">sessionId</span>&nbsp;<span class="op" id="7824366">=</span>&nbsp;<span class="ident" id="7824368">randomBytes</span><span class="op" id="7824379">(</span><span class="ident" id="7824380">rand</span><span class="op" id="7824384">.</span><span class="ident" id="7824385">Intn</span><span class="op" id="7824389">(</span><span class="num" id="7824390">32</span><span class="op" id="7824392">)</span><span class="op" id="7824393">,</span>&nbsp;<span class="ident" id="7824395">rand</span><span class="op" id="7824399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824402">m</span><span class="op" id="7824403">.</span><span class="ident" id="7824404">cipherSuite</span>&nbsp;<span class="op" id="7824416">=</span>&nbsp;<span class="builtintype" id="7824418">uint16</span><span class="op" id="7824424">(</span><span class="ident" id="7824425">rand</span><span class="op" id="7824429">.</span><span class="ident" id="7824430">Int31</span><span class="op" id="7824435">(</span><span class="op" id="7824436">)</span><span class="op" id="7824437">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824440">m</span><span class="op" id="7824441">.</span><span class="ident" id="7824442">compressionMethod</span>&nbsp;<span class="op" id="7824460">=</span>&nbsp;<span class="builtintype" id="7824462">uint8</span><span class="op" id="7824467">(</span><span class="ident" id="7824468">rand</span><span class="op" id="7824472">.</span><span class="ident" id="7824473">Intn</span><span class="op" id="7824477">(</span><span class="num" id="7824478">256</span><span class="op" id="7824481">)</span><span class="op" id="7824482">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7824486">if</span>&nbsp;<span class="ident" id="7824489">rand</span><span class="op" id="7824493">.</span><span class="ident" id="7824494">Intn</span><span class="op" id="7824498">(</span><span class="num" id="7824499">10</span><span class="op" id="7824501">)</span>&nbsp;<span class="op" id="7824503">&gt;</span>&nbsp;<span class="num" id="7824505">5</span>&nbsp;<span class="op" id="7824507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824511">m</span><span class="op" id="7824512">.</span><span class="ident" id="7824513">nextProtoNeg</span>&nbsp;<span class="op" id="7824526">=</span>&nbsp;<span class="ident" id="7824528">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824536">n</span>&nbsp;<span class="op" id="7824538">:=</span>&nbsp;<span class="ident" id="7824541">rand</span><span class="op" id="7824545">.</span><span class="ident" id="7824546">Intn</span><span class="op" id="7824550">(</span><span class="num" id="7824551">10</span><span class="op" id="7824553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824557">m</span><span class="op" id="7824558">.</span><span class="ident" id="7824559">nextProtos</span>&nbsp;<span class="op" id="7824570">=</span>&nbsp;<span class="builtinfunc" id="7824572">make</span><span class="op" id="7824576">(</span><span class="op" id="7824577">[</span><span class="op" id="7824578">]</span><span class="builtintype" id="7824579">string</span><span class="op" id="7824585">,</span>&nbsp;<span class="ident" id="7824587">n</span><span class="op" id="7824588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7824592">for</span>&nbsp;<span class="ident" id="7824596">i</span>&nbsp;<span class="op" id="7824598">:=</span>&nbsp;<span class="num" id="7824601">0</span><span class="op" id="7824602">;</span>&nbsp;<span class="ident" id="7824604">i</span>&nbsp;<span class="op" id="7824606">&lt;</span>&nbsp;<span class="ident" id="7824608">n</span><span class="op" id="7824609">;</span>&nbsp;<span class="ident" id="7824611">i</span><span class="op" id="7824612">++</span>&nbsp;<span class="op" id="7824615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824620">m</span><span class="op" id="7824621">.</span><span class="ident" id="7824622">nextProtos</span><span class="op" id="7824632">[</span><span class="ident" id="7824633">i</span><span class="op" id="7824634">]</span>&nbsp;<span class="op" id="7824636">=</span>&nbsp;<span class="ident" id="7824638">randomString</span><span class="op" id="7824650">(</span><span class="num" id="7824651">20</span><span class="op" id="7824653">,</span>&nbsp;<span class="ident" id="7824655">rand</span><span class="op" id="7824659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7824663">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7824666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7824670">if</span>&nbsp;<span class="ident" id="7824673">rand</span><span class="op" id="7824677">.</span><span class="ident" id="7824678">Intn</span><span class="op" id="7824682">(</span><span class="num" id="7824683">10</span><span class="op" id="7824685">)</span>&nbsp;<span class="op" id="7824687">&gt;</span>&nbsp;<span class="num" id="7824689">5</span>&nbsp;<span class="op" id="7824691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824695">m</span><span class="op" id="7824696">.</span><span class="ident" id="7824697">ocspStapling</span>&nbsp;<span class="op" id="7824710">=</span>&nbsp;<span class="ident" id="7824712">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7824718">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7824721">if</span>&nbsp;<span class="ident" id="7824724">rand</span><span class="op" id="7824728">.</span><span class="ident" id="7824729">Intn</span><span class="op" id="7824733">(</span><span class="num" id="7824734">10</span><span class="op" id="7824736">)</span>&nbsp;<span class="op" id="7824738">&gt;</span>&nbsp;<span class="num" id="7824740">5</span>&nbsp;<span class="op" id="7824742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824746">m</span><span class="op" id="7824747">.</span><span class="ident" id="7824748">ticketSupported</span>&nbsp;<span class="op" id="7824764">=</span>&nbsp;<span class="ident" id="7824766">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7824772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824775">m</span><span class="op" id="7824776">.</span><span class="ident" id="7824777">alpnProtocol</span>&nbsp;<span class="op" id="7824790">=</span>&nbsp;<span class="ident" id="7824792">randomString</span><span class="op" id="7824804">(</span><span class="ident" id="7824805">rand</span><span class="op" id="7824809">.</span><span class="ident" id="7824810">Intn</span><span class="op" id="7824814">(</span><span class="num" id="7824815">32</span><span class="op" id="7824817">)</span><span class="op" id="7824818">+</span><span class="num" id="7824819">1</span><span class="op" id="7824820">,</span>&nbsp;<span class="ident" id="7824822">rand</span><span class="op" id="7824826">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7824830">return</span>&nbsp;<span class="ident" id="7824837">reflect</span><span class="op" id="7824844">.</span><span class="ident" id="7824845">ValueOf</span><span class="op" id="7824852">(</span><span class="ident" id="7824853">m</span><span class="op" id="7824854">)</span><br>
<span class="lineno"></span><span class="op" id="7824856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7824859">func</span>&nbsp;<span class="op" id="7824864">(</span><span class="op" id="7824865">*</span><span class="ident" id="7824866">certificateMsg</span><span class="op" id="7824880">)</span>&nbsp;<span class="ident" id="7824882">Generate</span><span class="op" id="7824890">(</span><span class="ident" id="7824891">rand</span>&nbsp;<span class="op" id="7824896">*</span><span class="ident" id="7824897">rand</span><span class="op" id="7824901">.</span><span class="ident" id="7824902">Rand</span><span class="op" id="7824906">,</span>&nbsp;<span class="ident" id="7824908">size</span>&nbsp;<span class="builtintype" id="7824913">int</span><span class="op" id="7824916">)</span>&nbsp;<span class="ident" id="7824918">reflect</span><span class="op" id="7824925">.</span><span class="ident" id="7824926">Value</span>&nbsp;<span class="op" id="7824932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824935">m</span>&nbsp;<span class="op" id="7824937">:=</span>&nbsp;<span class="op" id="7824940">&amp;</span><span class="ident" id="7824941">certificateMsg</span><span class="op" id="7824955">{</span><span class="op" id="7824956">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824959">numCerts</span>&nbsp;<span class="op" id="7824968">:=</span>&nbsp;<span class="ident" id="7824971">rand</span><span class="op" id="7824975">.</span><span class="ident" id="7824976">Intn</span><span class="op" id="7824980">(</span><span class="num" id="7824981">20</span><span class="op" id="7824983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824986">m</span><span class="op" id="7824987">.</span><span class="ident" id="7824988">certificates</span>&nbsp;<span class="op" id="7825001">=</span>&nbsp;<span class="builtinfunc" id="7825003">make</span><span class="op" id="7825007">(</span><span class="op" id="7825008">[</span><span class="op" id="7825009">]</span><span class="op" id="7825010">[</span><span class="op" id="7825011">]</span><span class="builtintype" id="7825012">byte</span><span class="op" id="7825016">,</span>&nbsp;<span class="ident" id="7825018">numCerts</span><span class="op" id="7825026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7825029">for</span>&nbsp;<span class="ident" id="7825033">i</span>&nbsp;<span class="op" id="7825035">:=</span>&nbsp;<span class="num" id="7825038">0</span><span class="op" id="7825039">;</span>&nbsp;<span class="ident" id="7825041">i</span>&nbsp;<span class="op" id="7825043">&lt;</span>&nbsp;<span class="ident" id="7825045">numCerts</span><span class="op" id="7825053">;</span>&nbsp;<span class="ident" id="7825055">i</span><span class="op" id="7825056">++</span>&nbsp;<span class="op" id="7825059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825063">m</span><span class="op" id="7825064">.</span><span class="ident" id="7825065">certificates</span><span class="op" id="7825077">[</span><span class="ident" id="7825078">i</span><span class="op" id="7825079">]</span>&nbsp;<span class="op" id="7825081">=</span>&nbsp;<span class="ident" id="7825083">randomBytes</span><span class="op" id="7825094">(</span><span class="ident" id="7825095">rand</span><span class="op" id="7825099">.</span><span class="ident" id="7825100">Intn</span><span class="op" id="7825104">(</span><span class="num" id="7825105">10</span><span class="op" id="7825107">)</span><span class="op" id="7825108">+</span><span class="num" id="7825109">1</span><span class="op" id="7825110">,</span>&nbsp;<span class="ident" id="7825112">rand</span><span class="op" id="7825116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825119">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7825122">return</span>&nbsp;<span class="ident" id="7825129">reflect</span><span class="op" id="7825136">.</span><span class="ident" id="7825137">ValueOf</span><span class="op" id="7825144">(</span><span class="ident" id="7825145">m</span><span class="op" id="7825146">)</span><br>
<span class="lineno"></span><span class="op" id="7825148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7825151">func</span>&nbsp;<span class="op" id="7825156">(</span><span class="op" id="7825157">*</span><span class="ident" id="7825158">certificateRequestMsg</span><span class="op" id="7825179">)</span>&nbsp;<span class="ident" id="7825181">Generate</span><span class="op" id="7825189">(</span><span class="ident" id="7825190">rand</span>&nbsp;<span class="op" id="7825195">*</span><span class="ident" id="7825196">rand</span><span class="op" id="7825200">.</span><span class="ident" id="7825201">Rand</span><span class="op" id="7825205">,</span>&nbsp;<span class="ident" id="7825207">size</span>&nbsp;<span class="builtintype" id="7825212">int</span><span class="op" id="7825215">)</span>&nbsp;<span class="ident" id="7825217">reflect</span><span class="op" id="7825224">.</span><span class="ident" id="7825225">Value</span>&nbsp;<span class="op" id="7825231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825234">m</span>&nbsp;<span class="op" id="7825236">:=</span>&nbsp;<span class="op" id="7825239">&amp;</span><span class="ident" id="7825240">certificateRequestMsg</span><span class="op" id="7825261">{</span><span class="op" id="7825262">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825265">m</span><span class="op" id="7825266">.</span><span class="ident" id="7825267">certificateTypes</span>&nbsp;<span class="op" id="7825284">=</span>&nbsp;<span class="ident" id="7825286">randomBytes</span><span class="op" id="7825297">(</span><span class="ident" id="7825298">rand</span><span class="op" id="7825302">.</span><span class="ident" id="7825303">Intn</span><span class="op" id="7825307">(</span><span class="num" id="7825308">5</span><span class="op" id="7825309">)</span><span class="op" id="7825310">+</span><span class="num" id="7825311">1</span><span class="op" id="7825312">,</span>&nbsp;<span class="ident" id="7825314">rand</span><span class="op" id="7825318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825321">numCAs</span>&nbsp;<span class="op" id="7825328">:=</span>&nbsp;<span class="ident" id="7825331">rand</span><span class="op" id="7825335">.</span><span class="ident" id="7825336">Intn</span><span class="op" id="7825340">(</span><span class="num" id="7825341">100</span><span class="op" id="7825344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825347">m</span><span class="op" id="7825348">.</span><span class="ident" id="7825349">certificateAuthorities</span>&nbsp;<span class="op" id="7825372">=</span>&nbsp;<span class="builtinfunc" id="7825374">make</span><span class="op" id="7825378">(</span><span class="op" id="7825379">[</span><span class="op" id="7825380">]</span><span class="op" id="7825381">[</span><span class="op" id="7825382">]</span><span class="builtintype" id="7825383">byte</span><span class="op" id="7825387">,</span>&nbsp;<span class="ident" id="7825389">numCAs</span><span class="op" id="7825395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7825398">for</span>&nbsp;<span class="ident" id="7825402">i</span>&nbsp;<span class="op" id="7825404">:=</span>&nbsp;<span class="num" id="7825407">0</span><span class="op" id="7825408">;</span>&nbsp;<span class="ident" id="7825410">i</span>&nbsp;<span class="op" id="7825412">&lt;</span>&nbsp;<span class="ident" id="7825414">numCAs</span><span class="op" id="7825420">;</span>&nbsp;<span class="ident" id="7825422">i</span><span class="op" id="7825423">++</span>&nbsp;<span class="op" id="7825426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825430">m</span><span class="op" id="7825431">.</span><span class="ident" id="7825432">certificateAuthorities</span><span class="op" id="7825454">[</span><span class="ident" id="7825455">i</span><span class="op" id="7825456">]</span>&nbsp;<span class="op" id="7825458">=</span>&nbsp;<span class="ident" id="7825460">randomBytes</span><span class="op" id="7825471">(</span><span class="ident" id="7825472">rand</span><span class="op" id="7825476">.</span><span class="ident" id="7825477">Intn</span><span class="op" id="7825481">(</span><span class="num" id="7825482">15</span><span class="op" id="7825484">)</span><span class="op" id="7825485">+</span><span class="num" id="7825486">1</span><span class="op" id="7825487">,</span>&nbsp;<span class="ident" id="7825489">rand</span><span class="op" id="7825493">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7825499">return</span>&nbsp;<span class="ident" id="7825506">reflect</span><span class="op" id="7825513">.</span><span class="ident" id="7825514">ValueOf</span><span class="op" id="7825521">(</span><span class="ident" id="7825522">m</span><span class="op" id="7825523">)</span><br>
<span class="lineno"></span><span class="op" id="7825525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7825528">func</span>&nbsp;<span class="op" id="7825533">(</span><span class="op" id="7825534">*</span><span class="ident" id="7825535">certificateVerifyMsg</span><span class="op" id="7825555">)</span>&nbsp;<span class="ident" id="7825557">Generate</span><span class="op" id="7825565">(</span><span class="ident" id="7825566">rand</span>&nbsp;<span class="op" id="7825571">*</span><span class="ident" id="7825572">rand</span><span class="op" id="7825576">.</span><span class="ident" id="7825577">Rand</span><span class="op" id="7825581">,</span>&nbsp;<span class="ident" id="7825583">size</span>&nbsp;<span class="builtintype" id="7825588">int</span><span class="op" id="7825591">)</span>&nbsp;<span class="ident" id="7825593">reflect</span><span class="op" id="7825600">.</span><span class="ident" id="7825601">Value</span>&nbsp;<span class="op" id="7825607">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825610">m</span>&nbsp;<span class="op" id="7825612">:=</span>&nbsp;<span class="op" id="7825615">&amp;</span><span class="ident" id="7825616">certificateVerifyMsg</span><span class="op" id="7825636">{</span><span class="op" id="7825637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825640">m</span><span class="op" id="7825641">.</span><span class="ident" id="7825642">signature</span>&nbsp;<span class="op" id="7825652">=</span>&nbsp;<span class="ident" id="7825654">randomBytes</span><span class="op" id="7825665">(</span><span class="ident" id="7825666">rand</span><span class="op" id="7825670">.</span><span class="ident" id="7825671">Intn</span><span class="op" id="7825675">(</span><span class="num" id="7825676">15</span><span class="op" id="7825678">)</span><span class="op" id="7825679">+</span><span class="num" id="7825680">1</span><span class="op" id="7825681">,</span>&nbsp;<span class="ident" id="7825683">rand</span><span class="op" id="7825687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7825690">return</span>&nbsp;<span class="ident" id="7825697">reflect</span><span class="op" id="7825704">.</span><span class="ident" id="7825705">ValueOf</span><span class="op" id="7825712">(</span><span class="ident" id="7825713">m</span><span class="op" id="7825714">)</span><br>
<span class="lineno"></span><span class="op" id="7825716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="7825719">func</span>&nbsp;<span class="op" id="7825724">(</span><span class="op" id="7825725">*</span><span class="ident" id="7825726">certificateStatusMsg</span><span class="op" id="7825746">)</span>&nbsp;<span class="ident" id="7825748">Generate</span><span class="op" id="7825756">(</span><span class="ident" id="7825757">rand</span>&nbsp;<span class="op" id="7825762">*</span><span class="ident" id="7825763">rand</span><span class="op" id="7825767">.</span><span class="ident" id="7825768">Rand</span><span class="op" id="7825772">,</span>&nbsp;<span class="ident" id="7825774">size</span>&nbsp;<span class="builtintype" id="7825779">int</span><span class="op" id="7825782">)</span>&nbsp;<span class="ident" id="7825784">reflect</span><span class="op" id="7825791">.</span><span class="ident" id="7825792">Value</span>&nbsp;<span class="op" id="7825798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825801">m</span>&nbsp;<span class="op" id="7825803">:=</span>&nbsp;<span class="op" id="7825806">&amp;</span><span class="ident" id="7825807">certificateStatusMsg</span><span class="op" id="7825827">{</span><span class="op" id="7825828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7825831">if</span>&nbsp;<span class="ident" id="7825834">rand</span><span class="op" id="7825838">.</span><span class="ident" id="7825839">Intn</span><span class="op" id="7825843">(</span><span class="num" id="7825844">10</span><span class="op" id="7825846">)</span>&nbsp;<span class="op" id="7825848">&gt;</span>&nbsp;<span class="num" id="7825850">5</span>&nbsp;<span class="op" id="7825852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825856">m</span><span class="op" id="7825857">.</span><span class="ident" id="7825858">statusType</span>&nbsp;<span class="op" id="7825869">=</span>&nbsp;<span class="ident" id="7825871">statusTypeOCSP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825888">m</span><span class="op" id="7825889">.</span><span class="ident" id="7825890">response</span>&nbsp;<span class="op" id="7825899">=</span>&nbsp;<span class="ident" id="7825901">randomBytes</span><span class="op" id="7825912">(</span><span class="ident" id="7825913">rand</span><span class="op" id="7825917">.</span><span class="ident" id="7825918">Intn</span><span class="op" id="7825922">(</span><span class="num" id="7825923">10</span><span class="op" id="7825925">)</span><span class="op" id="7825926">+</span><span class="num" id="7825927">1</span><span class="op" id="7825928">,</span>&nbsp;<span class="ident" id="7825930">rand</span><span class="op" id="7825934">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825937">}</span>&nbsp;<span class="keyword" id="7825939">else</span>&nbsp;<span class="op" id="7825944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825948">m</span><span class="op" id="7825949">.</span><span class="ident" id="7825950">statusType</span>&nbsp;<span class="op" id="7825961">=</span>&nbsp;<span class="num" id="7825963">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7825970">return</span>&nbsp;<span class="ident" id="7825977">reflect</span><span class="op" id="7825984">.</span><span class="ident" id="7825985">ValueOf</span><span class="op" id="7825992">(</span><span class="ident" id="7825993">m</span><span class="op" id="7825994">)</span><br>
<span class="lineno"></span><span class="op" id="7825996">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="7825999">func</span>&nbsp;<span class="op" id="7826004">(</span><span class="op" id="7826005">*</span><span class="ident" id="7826006">clientKeyExchangeMsg</span><span class="op" id="7826026">)</span>&nbsp;<span class="ident" id="7826028">Generate</span><span class="op" id="7826036">(</span><span class="ident" id="7826037">rand</span>&nbsp;<span class="op" id="7826042">*</span><span class="ident" id="7826043">rand</span><span class="op" id="7826047">.</span><span class="ident" id="7826048">Rand</span><span class="op" id="7826052">,</span>&nbsp;<span class="ident" id="7826054">size</span>&nbsp;<span class="builtintype" id="7826059">int</span><span class="op" id="7826062">)</span>&nbsp;<span class="ident" id="7826064">reflect</span><span class="op" id="7826071">.</span><span class="ident" id="7826072">Value</span>&nbsp;<span class="op" id="7826078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826081">m</span>&nbsp;<span class="op" id="7826083">:=</span>&nbsp;<span class="op" id="7826086">&amp;</span><span class="ident" id="7826087">clientKeyExchangeMsg</span><span class="op" id="7826107">{</span><span class="op" id="7826108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826111">m</span><span class="op" id="7826112">.</span><span class="ident" id="7826113">ciphertext</span>&nbsp;<span class="op" id="7826124">=</span>&nbsp;<span class="ident" id="7826126">randomBytes</span><span class="op" id="7826137">(</span><span class="ident" id="7826138">rand</span><span class="op" id="7826142">.</span><span class="ident" id="7826143">Intn</span><span class="op" id="7826147">(</span><span class="num" id="7826148">1000</span><span class="op" id="7826152">)</span><span class="op" id="7826153">+</span><span class="num" id="7826154">1</span><span class="op" id="7826155">,</span>&nbsp;<span class="ident" id="7826157">rand</span><span class="op" id="7826161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7826164">return</span>&nbsp;<span class="ident" id="7826171">reflect</span><span class="op" id="7826178">.</span><span class="ident" id="7826179">ValueOf</span><span class="op" id="7826186">(</span><span class="ident" id="7826187">m</span><span class="op" id="7826188">)</span><br>
<span class="lineno">220</span><span class="op" id="7826190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7826193">func</span>&nbsp;<span class="op" id="7826198">(</span><span class="op" id="7826199">*</span><span class="ident" id="7826200">finishedMsg</span><span class="op" id="7826211">)</span>&nbsp;<span class="ident" id="7826213">Generate</span><span class="op" id="7826221">(</span><span class="ident" id="7826222">rand</span>&nbsp;<span class="op" id="7826227">*</span><span class="ident" id="7826228">rand</span><span class="op" id="7826232">.</span><span class="ident" id="7826233">Rand</span><span class="op" id="7826237">,</span>&nbsp;<span class="ident" id="7826239">size</span>&nbsp;<span class="builtintype" id="7826244">int</span><span class="op" id="7826247">)</span>&nbsp;<span class="ident" id="7826249">reflect</span><span class="op" id="7826256">.</span><span class="ident" id="7826257">Value</span>&nbsp;<span class="op" id="7826263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826266">m</span>&nbsp;<span class="op" id="7826268">:=</span>&nbsp;<span class="op" id="7826271">&amp;</span><span class="ident" id="7826272">finishedMsg</span><span class="op" id="7826283">{</span><span class="op" id="7826284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826287">m</span><span class="op" id="7826288">.</span><span class="ident" id="7826289">verifyData</span>&nbsp;<span class="op" id="7826300">=</span>&nbsp;<span class="ident" id="7826302">randomBytes</span><span class="op" id="7826313">(</span><span class="num" id="7826314">12</span><span class="op" id="7826316">,</span>&nbsp;<span class="ident" id="7826318">rand</span><span class="op" id="7826322">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7826325">return</span>&nbsp;<span class="ident" id="7826332">reflect</span><span class="op" id="7826339">.</span><span class="ident" id="7826340">ValueOf</span><span class="op" id="7826347">(</span><span class="ident" id="7826348">m</span><span class="op" id="7826349">)</span><br>
<span class="lineno"></span><span class="op" id="7826351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7826354">func</span>&nbsp;<span class="op" id="7826359">(</span><span class="op" id="7826360">*</span><span class="ident" id="7826361">nextProtoMsg</span><span class="op" id="7826373">)</span>&nbsp;<span class="ident" id="7826375">Generate</span><span class="op" id="7826383">(</span><span class="ident" id="7826384">rand</span>&nbsp;<span class="op" id="7826389">*</span><span class="ident" id="7826390">rand</span><span class="op" id="7826394">.</span><span class="ident" id="7826395">Rand</span><span class="op" id="7826399">,</span>&nbsp;<span class="ident" id="7826401">size</span>&nbsp;<span class="builtintype" id="7826406">int</span><span class="op" id="7826409">)</span>&nbsp;<span class="ident" id="7826411">reflect</span><span class="op" id="7826418">.</span><span class="ident" id="7826419">Value</span>&nbsp;<span class="op" id="7826425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826428">m</span>&nbsp;<span class="op" id="7826430">:=</span>&nbsp;<span class="op" id="7826433">&amp;</span><span class="ident" id="7826434">nextProtoMsg</span><span class="op" id="7826446">{</span><span class="op" id="7826447">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826450">m</span><span class="op" id="7826451">.</span><span class="ident" id="7826452">proto</span>&nbsp;<span class="op" id="7826458">=</span>&nbsp;<span class="ident" id="7826460">randomString</span><span class="op" id="7826472">(</span><span class="ident" id="7826473">rand</span><span class="op" id="7826477">.</span><span class="ident" id="7826478">Intn</span><span class="op" id="7826482">(</span><span class="num" id="7826483">255</span><span class="op" id="7826486">)</span><span class="op" id="7826487">,</span>&nbsp;<span class="ident" id="7826489">rand</span><span class="op" id="7826493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7826496">return</span>&nbsp;<span class="ident" id="7826503">reflect</span><span class="op" id="7826510">.</span><span class="ident" id="7826511">ValueOf</span><span class="op" id="7826518">(</span><span class="ident" id="7826519">m</span><span class="op" id="7826520">)</span><br>
<span class="lineno"></span><span class="op" id="7826522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7826525">func</span>&nbsp;<span class="op" id="7826530">(</span><span class="op" id="7826531">*</span><span class="ident" id="7826532">newSessionTicketMsg</span><span class="op" id="7826551">)</span>&nbsp;<span class="ident" id="7826553">Generate</span><span class="op" id="7826561">(</span><span class="ident" id="7826562">rand</span>&nbsp;<span class="op" id="7826567">*</span><span class="ident" id="7826568">rand</span><span class="op" id="7826572">.</span><span class="ident" id="7826573">Rand</span><span class="op" id="7826577">,</span>&nbsp;<span class="ident" id="7826579">size</span>&nbsp;<span class="builtintype" id="7826584">int</span><span class="op" id="7826587">)</span>&nbsp;<span class="ident" id="7826589">reflect</span><span class="op" id="7826596">.</span><span class="ident" id="7826597">Value</span>&nbsp;<span class="op" id="7826603">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826606">m</span>&nbsp;<span class="op" id="7826608">:=</span>&nbsp;<span class="op" id="7826611">&amp;</span><span class="ident" id="7826612">newSessionTicketMsg</span><span class="op" id="7826631">{</span><span class="op" id="7826632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826635">m</span><span class="op" id="7826636">.</span><span class="ident" id="7826637">ticket</span>&nbsp;<span class="op" id="7826644">=</span>&nbsp;<span class="ident" id="7826646">randomBytes</span><span class="op" id="7826657">(</span><span class="ident" id="7826658">rand</span><span class="op" id="7826662">.</span><span class="ident" id="7826663">Intn</span><span class="op" id="7826667">(</span><span class="num" id="7826668">4</span><span class="op" id="7826669">)</span><span class="op" id="7826670">,</span>&nbsp;<span class="ident" id="7826672">rand</span><span class="op" id="7826676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7826679">return</span>&nbsp;<span class="ident" id="7826686">reflect</span><span class="op" id="7826693">.</span><span class="ident" id="7826694">ValueOf</span><span class="op" id="7826701">(</span><span class="ident" id="7826702">m</span><span class="op" id="7826703">)</span><br>
<span class="lineno"></span><span class="op" id="7826705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="7826708">func</span>&nbsp;<span class="op" id="7826713">(</span><span class="op" id="7826714">*</span><span class="ident" id="7826715">sessionState</span><span class="op" id="7826727">)</span>&nbsp;<span class="ident" id="7826729">Generate</span><span class="op" id="7826737">(</span><span class="ident" id="7826738">rand</span>&nbsp;<span class="op" id="7826743">*</span><span class="ident" id="7826744">rand</span><span class="op" id="7826748">.</span><span class="ident" id="7826749">Rand</span><span class="op" id="7826753">,</span>&nbsp;<span class="ident" id="7826755">size</span>&nbsp;<span class="builtintype" id="7826760">int</span><span class="op" id="7826763">)</span>&nbsp;<span class="ident" id="7826765">reflect</span><span class="op" id="7826772">.</span><span class="ident" id="7826773">Value</span>&nbsp;<span class="op" id="7826779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826782">s</span>&nbsp;<span class="op" id="7826784">:=</span>&nbsp;<span class="op" id="7826787">&amp;</span><span class="ident" id="7826788">sessionState</span><span class="op" id="7826800">{</span><span class="op" id="7826801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826804">s</span><span class="op" id="7826805">.</span><span class="ident" id="7826806">vers</span>&nbsp;<span class="op" id="7826811">=</span>&nbsp;<span class="builtintype" id="7826813">uint16</span><span class="op" id="7826819">(</span><span class="ident" id="7826820">rand</span><span class="op" id="7826824">.</span><span class="ident" id="7826825">Intn</span><span class="op" id="7826829">(</span><span class="num" id="7826830">10000</span><span class="op" id="7826835">)</span><span class="op" id="7826836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826839">s</span><span class="op" id="7826840">.</span><span class="ident" id="7826841">cipherSuite</span>&nbsp;<span class="op" id="7826853">=</span>&nbsp;<span class="builtintype" id="7826855">uint16</span><span class="op" id="7826861">(</span><span class="ident" id="7826862">rand</span><span class="op" id="7826866">.</span><span class="ident" id="7826867">Intn</span><span class="op" id="7826871">(</span><span class="num" id="7826872">10000</span><span class="op" id="7826877">)</span><span class="op" id="7826878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826881">s</span><span class="op" id="7826882">.</span><span class="ident" id="7826883">masterSecret</span>&nbsp;<span class="op" id="7826896">=</span>&nbsp;<span class="ident" id="7826898">randomBytes</span><span class="op" id="7826909">(</span><span class="ident" id="7826910">rand</span><span class="op" id="7826914">.</span><span class="ident" id="7826915">Intn</span><span class="op" id="7826919">(</span><span class="num" id="7826920">100</span><span class="op" id="7826923">)</span><span class="op" id="7826924">,</span>&nbsp;<span class="ident" id="7826926">rand</span><span class="op" id="7826930">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826933">numCerts</span>&nbsp;<span class="op" id="7826942">:=</span>&nbsp;<span class="ident" id="7826945">rand</span><span class="op" id="7826949">.</span><span class="ident" id="7826950">Intn</span><span class="op" id="7826954">(</span><span class="num" id="7826955">20</span><span class="op" id="7826957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826960">s</span><span class="op" id="7826961">.</span><span class="ident" id="7826962">certificates</span>&nbsp;<span class="op" id="7826975">=</span>&nbsp;<span class="builtinfunc" id="7826977">make</span><span class="op" id="7826981">(</span><span class="op" id="7826982">[</span><span class="op" id="7826983">]</span><span class="op" id="7826984">[</span><span class="op" id="7826985">]</span><span class="builtintype" id="7826986">byte</span><span class="op" id="7826990">,</span>&nbsp;<span class="ident" id="7826992">numCerts</span><span class="op" id="7827000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827003">for</span>&nbsp;<span class="ident" id="7827007">i</span>&nbsp;<span class="op" id="7827009">:=</span>&nbsp;<span class="num" id="7827012">0</span><span class="op" id="7827013">;</span>&nbsp;<span class="ident" id="7827015">i</span>&nbsp;<span class="op" id="7827017">&lt;</span>&nbsp;<span class="ident" id="7827019">numCerts</span><span class="op" id="7827027">;</span>&nbsp;<span class="ident" id="7827029">i</span><span class="op" id="7827030">++</span>&nbsp;<span class="op" id="7827033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827037">s</span><span class="op" id="7827038">.</span><span class="ident" id="7827039">certificates</span><span class="op" id="7827051">[</span><span class="ident" id="7827052">i</span><span class="op" id="7827053">]</span>&nbsp;<span class="op" id="7827055">=</span>&nbsp;<span class="ident" id="7827057">randomBytes</span><span class="op" id="7827068">(</span><span class="ident" id="7827069">rand</span><span class="op" id="7827073">.</span><span class="ident" id="7827074">Intn</span><span class="op" id="7827078">(</span><span class="num" id="7827079">10</span><span class="op" id="7827081">)</span><span class="op" id="7827082">+</span><span class="num" id="7827083">1</span><span class="op" id="7827084">,</span>&nbsp;<span class="ident" id="7827086">rand</span><span class="op" id="7827090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827093">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827096">return</span>&nbsp;<span class="ident" id="7827103">reflect</span><span class="op" id="7827110">.</span><span class="ident" id="7827111">ValueOf</span><span class="op" id="7827118">(</span><span class="ident" id="7827119">s</span><span class="op" id="7827120">)</span><br>
<span class="lineno"></span><span class="op" id="7827122">}</span>
</div>
</body>
</html>
