<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4551031">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4551086">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4551140">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4551191">package</span>&nbsp;<span class="ident" id="4551199">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4551209">import</span>&nbsp;<span class="op" id="4551216">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4551219">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4551228">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4551235">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4551241">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4551252">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4551263">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4551271">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4551282">&#34;text/template/parse&#34;</span><br>
<span class="lineno"></span><span class="op" id="4551304">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4551307">//&nbsp;state&nbsp;represents&nbsp;the&nbsp;state&nbsp;of&nbsp;an&nbsp;execution.&nbsp;It&#39;s&nbsp;not&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4551375">//&nbsp;template&nbsp;so&nbsp;that&nbsp;multiple&nbsp;executions&nbsp;of&nbsp;the&nbsp;same&nbsp;template</span><br>
<span class="lineno">20</span><span class="comment" id="4551436">//&nbsp;can&nbsp;execute&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="4551464">type</span>&nbsp;<span class="ident" id="4551469">state</span>&nbsp;<span class="keyword" id="4551475">struct</span>&nbsp;<span class="op" id="4551482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4551485">tmpl</span>&nbsp;<span class="op" id="4551490">*</span><span class="ident" id="4551491">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4551501">wr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4551506">io</span><span class="op" id="4551508">.</span><span class="ident" id="4551509">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4551517">node</span>&nbsp;<span class="ident" id="4551522">parse</span><span class="op" id="4551527">.</span><span class="ident" id="4551528">Node</span>&nbsp;<span class="comment" id="4551533">//&nbsp;current&nbsp;node,&nbsp;for&nbsp;errors</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4551562">vars</span>&nbsp;<span class="op" id="4551567">[</span><span class="op" id="4551568">]</span><span class="ident" id="4551569">variable</span>&nbsp;<span class="comment" id="4551578">//&nbsp;push-down&nbsp;stack&nbsp;of&nbsp;variable&nbsp;values.</span><br>
<span class="lineno"></span><span class="op" id="4551617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4551620">//&nbsp;variable&nbsp;holds&nbsp;the&nbsp;dynamic&nbsp;value&nbsp;of&nbsp;a&nbsp;variable&nbsp;such&nbsp;as&nbsp;$,&nbsp;$x&nbsp;etc.</span><br>
<span class="lineno"></span><span class="keyword" id="4551689">type</span>&nbsp;<span class="ident" id="4551694">variable</span>&nbsp;<span class="keyword" id="4551703">struct</span>&nbsp;<span class="op" id="4551710">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4551713">name</span>&nbsp;&nbsp;<span class="builtintype" id="4551719">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4551727">value</span>&nbsp;<span class="ident" id="4551733">reflect</span><span class="op" id="4551740">.</span><span class="ident" id="4551741">Value</span><br>
<span class="lineno"></span><span class="op" id="4551747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4551750">//&nbsp;push&nbsp;pushes&nbsp;a&nbsp;new&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno">35</span><span class="keyword" id="4551794">func</span>&nbsp;<span class="op" id="4551799">(</span><span class="ident" id="4551800">s</span>&nbsp;<span class="op" id="4551802">*</span><span class="ident" id="4551803">state</span><span class="op" id="4551808">)</span>&nbsp;<span class="ident" id="4551810">push</span><span class="op" id="4551814">(</span><span class="ident" id="4551815">name</span>&nbsp;<span class="builtintype" id="4551820">string</span><span class="op" id="4551826">,</span>&nbsp;<span class="ident" id="4551828">value</span>&nbsp;<span class="ident" id="4551834">reflect</span><span class="op" id="4551841">.</span><span class="ident" id="4551842">Value</span><span class="op" id="4551847">)</span>&nbsp;<span class="op" id="4551849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4551852">s</span><span class="op" id="4551853">.</span><span class="ident" id="4551854">vars</span>&nbsp;<span class="op" id="4551859">=</span>&nbsp;<span class="builtinfunc" id="4551861">append</span><span class="op" id="4551867">(</span><span class="ident" id="4551868">s</span><span class="op" id="4551869">.</span><span class="ident" id="4551870">vars</span><span class="op" id="4551874">,</span>&nbsp;<span class="ident" id="4551876">variable</span><span class="op" id="4551884">{</span><span class="ident" id="4551885">name</span><span class="op" id="4551889">,</span>&nbsp;<span class="ident" id="4551891">value</span><span class="op" id="4551896">}</span><span class="op" id="4551897">)</span><br>
<span class="lineno"></span><span class="op" id="4551899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4551902">//&nbsp;mark&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;variable&nbsp;stack.</span><br>
<span class="lineno">40</span><span class="keyword" id="4551952">func</span>&nbsp;<span class="op" id="4551957">(</span><span class="ident" id="4551958">s</span>&nbsp;<span class="op" id="4551960">*</span><span class="ident" id="4551961">state</span><span class="op" id="4551966">)</span>&nbsp;<span class="ident" id="4551968">mark</span><span class="op" id="4551972">(</span><span class="op" id="4551973">)</span>&nbsp;<span class="builtintype" id="4551975">int</span>&nbsp;<span class="op" id="4551979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4551982">return</span>&nbsp;<span class="builtinfunc" id="4551989">len</span><span class="op" id="4551992">(</span><span class="ident" id="4551993">s</span><span class="op" id="4551994">.</span><span class="ident" id="4551995">vars</span><span class="op" id="4551999">)</span><br>
<span class="lineno"></span><span class="op" id="4552001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4552004">//&nbsp;pop&nbsp;pops&nbsp;the&nbsp;variable&nbsp;stack&nbsp;up&nbsp;to&nbsp;the&nbsp;mark.</span><br>
<span class="lineno">45</span><span class="keyword" id="4552051">func</span>&nbsp;<span class="op" id="4552056">(</span><span class="ident" id="4552057">s</span>&nbsp;<span class="op" id="4552059">*</span><span class="ident" id="4552060">state</span><span class="op" id="4552065">)</span>&nbsp;<span class="ident" id="4552067">pop</span><span class="op" id="4552070">(</span><span class="ident" id="4552071">mark</span>&nbsp;<span class="builtintype" id="4552076">int</span><span class="op" id="4552079">)</span>&nbsp;<span class="op" id="4552081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4552084">s</span><span class="op" id="4552085">.</span><span class="ident" id="4552086">vars</span>&nbsp;<span class="op" id="4552091">=</span>&nbsp;<span class="ident" id="4552093">s</span><span class="op" id="4552094">.</span><span class="ident" id="4552095">vars</span><span class="op" id="4552099">[</span><span class="num" id="4552100">0</span><span class="op" id="4552101">:</span><span class="ident" id="4552102">mark</span><span class="op" id="4552106">]</span><br>
<span class="lineno"></span><span class="op" id="4552108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4552111">//&nbsp;setVar&nbsp;overwrites&nbsp;the&nbsp;top-nth&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.&nbsp;Used&nbsp;by&nbsp;range&nbsp;iterations.</span><br>
<span class="lineno">50</span><span class="keyword" id="4552193">func</span>&nbsp;<span class="op" id="4552198">(</span><span class="ident" id="4552199">s</span>&nbsp;<span class="op" id="4552201">*</span><span class="ident" id="4552202">state</span><span class="op" id="4552207">)</span>&nbsp;<span class="ident" id="4552209">setVar</span><span class="op" id="4552215">(</span><span class="ident" id="4552216">n</span>&nbsp;<span class="builtintype" id="4552218">int</span><span class="op" id="4552221">,</span>&nbsp;<span class="ident" id="4552223">value</span>&nbsp;<span class="ident" id="4552229">reflect</span><span class="op" id="4552236">.</span><span class="ident" id="4552237">Value</span><span class="op" id="4552242">)</span>&nbsp;<span class="op" id="4552244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4552247">s</span><span class="op" id="4552248">.</span><span class="ident" id="4552249">vars</span><span class="op" id="4552253">[</span><span class="builtinfunc" id="4552254">len</span><span class="op" id="4552257">(</span><span class="ident" id="4552258">s</span><span class="op" id="4552259">.</span><span class="ident" id="4552260">vars</span><span class="op" id="4552264">)</span><span class="op" id="4552265">-</span><span class="ident" id="4552266">n</span><span class="op" id="4552267">]</span><span class="op" id="4552268">.</span><span class="ident" id="4552269">value</span>&nbsp;<span class="op" id="4552275">=</span>&nbsp;<span class="ident" id="4552277">value</span><br>
<span class="lineno"></span><span class="op" id="4552283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4552286">//&nbsp;varValue&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;named&nbsp;variable.</span><br>
<span class="lineno">55</span><span class="keyword" id="4552339">func</span>&nbsp;<span class="op" id="4552344">(</span><span class="ident" id="4552345">s</span>&nbsp;<span class="op" id="4552347">*</span><span class="ident" id="4552348">state</span><span class="op" id="4552353">)</span>&nbsp;<span class="ident" id="4552355">varValue</span><span class="op" id="4552363">(</span><span class="ident" id="4552364">name</span>&nbsp;<span class="builtintype" id="4552369">string</span><span class="op" id="4552375">)</span>&nbsp;<span class="ident" id="4552377">reflect</span><span class="op" id="4552384">.</span><span class="ident" id="4552385">Value</span>&nbsp;<span class="op" id="4552391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4552394">for</span>&nbsp;<span class="ident" id="4552398">i</span>&nbsp;<span class="op" id="4552400">:=</span>&nbsp;<span class="ident" id="4552403">s</span><span class="op" id="4552404">.</span><span class="ident" id="4552405">mark</span><span class="op" id="4552409">(</span><span class="op" id="4552410">)</span>&nbsp;<span class="op" id="4552412">-</span>&nbsp;<span class="num" id="4552414">1</span><span class="op" id="4552415">;</span>&nbsp;<span class="ident" id="4552417">i</span>&nbsp;<span class="op" id="4552419">&gt;=</span>&nbsp;<span class="num" id="4552422">0</span><span class="op" id="4552423">;</span>&nbsp;<span class="ident" id="4552425">i</span><span class="op" id="4552426">--</span>&nbsp;<span class="op" id="4552429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4552433">if</span>&nbsp;<span class="ident" id="4552436">s</span><span class="op" id="4552437">.</span><span class="ident" id="4552438">vars</span><span class="op" id="4552442">[</span><span class="ident" id="4552443">i</span><span class="op" id="4552444">]</span><span class="op" id="4552445">.</span><span class="ident" id="4552446">name</span>&nbsp;<span class="op" id="4552451">==</span>&nbsp;<span class="ident" id="4552454">name</span>&nbsp;<span class="op" id="4552459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4552464">return</span>&nbsp;<span class="ident" id="4552471">s</span><span class="op" id="4552472">.</span><span class="ident" id="4552473">vars</span><span class="op" id="4552477">[</span><span class="ident" id="4552478">i</span><span class="op" id="4552479">]</span><span class="op" id="4552480">.</span><span class="ident" id="4552481">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4552489">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4552492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4552495">s</span><span class="op" id="4552496">.</span><span class="ident" id="4552497">errorf</span><span class="op" id="4552503">(</span><span class="string" id="4552504">&#34;undefined&nbsp;variable:&nbsp;%s&#34;</span><span class="op" id="4552528">,</span>&nbsp;<span class="ident" id="4552530">name</span><span class="op" id="4552534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4552537">return</span>&nbsp;<span class="ident" id="4552544">zero</span><br>
<span class="lineno"></span><span class="op" id="4552549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="4552552">var</span>&nbsp;<span class="ident" id="4552556">zero</span>&nbsp;<span class="ident" id="4552561">reflect</span><span class="op" id="4552568">.</span><span class="ident" id="4552569">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4552576">//&nbsp;at&nbsp;marks&nbsp;the&nbsp;state&nbsp;to&nbsp;be&nbsp;on&nbsp;node&nbsp;n,&nbsp;for&nbsp;error&nbsp;reporting.</span><br>
<span class="lineno"></span><span class="keyword" id="4552636">func</span>&nbsp;<span class="op" id="4552641">(</span><span class="ident" id="4552642">s</span>&nbsp;<span class="op" id="4552644">*</span><span class="ident" id="4552645">state</span><span class="op" id="4552650">)</span>&nbsp;<span class="ident" id="4552652">at</span><span class="op" id="4552654">(</span><span class="ident" id="4552655">node</span>&nbsp;<span class="ident" id="4552660">parse</span><span class="op" id="4552665">.</span><span class="ident" id="4552666">Node</span><span class="op" id="4552670">)</span>&nbsp;<span class="op" id="4552672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4552675">s</span><span class="op" id="4552676">.</span><span class="ident" id="4552677">node</span>&nbsp;<span class="op" id="4552682">=</span>&nbsp;<span class="ident" id="4552684">node</span><br>
<span class="lineno">70</span><span class="op" id="4552689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4552692">//&nbsp;doublePercent&nbsp;returns&nbsp;the&nbsp;string&nbsp;with&nbsp;%&#39;s&nbsp;replaced&nbsp;by&nbsp;%%,&nbsp;if&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="4552767">//&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;used&nbsp;safely&nbsp;inside&nbsp;a&nbsp;Printf&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4552826">func</span>&nbsp;<span class="ident" id="4552831">doublePercent</span><span class="op" id="4552844">(</span><span class="ident" id="4552845">str</span>&nbsp;<span class="builtintype" id="4552849">string</span><span class="op" id="4552855">)</span>&nbsp;<span class="builtintype" id="4552857">string</span>&nbsp;<span class="op" id="4552864">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4552867">if</span>&nbsp;<span class="ident" id="4552870">strings</span><span class="op" id="4552877">.</span><span class="ident" id="4552878">Contains</span><span class="op" id="4552886">(</span><span class="ident" id="4552887">str</span><span class="op" id="4552890">,</span>&nbsp;<span class="string" id="4552892">&#34;%&#34;</span><span class="op" id="4552895">)</span>&nbsp;<span class="op" id="4552897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4552901">str</span>&nbsp;<span class="op" id="4552905">=</span>&nbsp;<span class="ident" id="4552907">strings</span><span class="op" id="4552914">.</span><span class="ident" id="4552915">Replace</span><span class="op" id="4552922">(</span><span class="ident" id="4552923">str</span><span class="op" id="4552926">,</span>&nbsp;<span class="string" id="4552928">&#34;%&#34;</span><span class="op" id="4552931">,</span>&nbsp;<span class="string" id="4552933">&#34;%%&#34;</span><span class="op" id="4552937">,</span>&nbsp;<span class="op" id="4552939">-</span><span class="num" id="4552940">1</span><span class="op" id="4552941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4552944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4552947">return</span>&nbsp;<span class="ident" id="4552954">str</span><br>
<span class="lineno"></span><span class="op" id="4552958">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4552961">//&nbsp;errorf&nbsp;formats&nbsp;the&nbsp;error&nbsp;and&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="4553016">func</span>&nbsp;<span class="op" id="4553021">(</span><span class="ident" id="4553022">s</span>&nbsp;<span class="op" id="4553024">*</span><span class="ident" id="4553025">state</span><span class="op" id="4553030">)</span>&nbsp;<span class="ident" id="4553032">errorf</span><span class="op" id="4553038">(</span><span class="ident" id="4553039">format</span>&nbsp;<span class="builtintype" id="4553046">string</span><span class="op" id="4553052">,</span>&nbsp;<span class="ident" id="4553054">args</span>&nbsp;<span class="op" id="4553059">...</span><span class="keyword" id="4553062">interface</span><span class="op" id="4553071">{</span><span class="op" id="4553072">}</span><span class="op" id="4553073">)</span>&nbsp;<span class="op" id="4553075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4553078">name</span>&nbsp;<span class="op" id="4553083">:=</span>&nbsp;<span class="ident" id="4553086">doublePercent</span><span class="op" id="4553099">(</span><span class="ident" id="4553100">s</span><span class="op" id="4553101">.</span><span class="ident" id="4553102">tmpl</span><span class="op" id="4553106">.</span><span class="ident" id="4553107">Name</span><span class="op" id="4553111">(</span><span class="op" id="4553112">)</span><span class="op" id="4553113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4553116">if</span>&nbsp;<span class="ident" id="4553119">s</span><span class="op" id="4553120">.</span><span class="ident" id="4553121">node</span>&nbsp;<span class="op" id="4553126">==</span>&nbsp;<span class="ident" id="4553129">nil</span>&nbsp;<span class="op" id="4553133">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4553137">format</span>&nbsp;<span class="op" id="4553144">=</span>&nbsp;<span class="ident" id="4553146">fmt</span><span class="op" id="4553149">.</span><span class="ident" id="4553150">Sprintf</span><span class="op" id="4553157">(</span><span class="string" id="4553158">&#34;template:&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="4553176">,</span>&nbsp;<span class="ident" id="4553178">name</span><span class="op" id="4553182">,</span>&nbsp;<span class="ident" id="4553184">format</span><span class="op" id="4553190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4553193">}</span>&nbsp;<span class="keyword" id="4553195">else</span>&nbsp;<span class="op" id="4553200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4553204">location</span><span class="op" id="4553212">,</span>&nbsp;<span class="ident" id="4553214">context</span>&nbsp;<span class="op" id="4553222">:=</span>&nbsp;<span class="ident" id="4553225">s</span><span class="op" id="4553226">.</span><span class="ident" id="4553227">tmpl</span><span class="op" id="4553231">.</span><span class="ident" id="4553232">ErrorContext</span><span class="op" id="4553244">(</span><span class="ident" id="4553245">s</span><span class="op" id="4553246">.</span><span class="ident" id="4553247">node</span><span class="op" id="4553251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4553255">format</span>&nbsp;<span class="op" id="4553262">=</span>&nbsp;<span class="ident" id="4553264">fmt</span><span class="op" id="4553267">.</span><span class="ident" id="4553268">Sprintf</span><span class="op" id="4553275">(</span><span class="string" id="4553276">&#34;template:&nbsp;%s:&nbsp;executing&nbsp;%q&nbsp;at&nbsp;&lt;%s&gt;:&nbsp;%s&#34;</span><span class="op" id="4553316">,</span>&nbsp;<span class="ident" id="4553318">location</span><span class="op" id="4553326">,</span>&nbsp;<span class="ident" id="4553328">name</span><span class="op" id="4553332">,</span>&nbsp;<span class="ident" id="4553334">doublePercent</span><span class="op" id="4553347">(</span><span class="ident" id="4553348">context</span><span class="op" id="4553355">)</span><span class="op" id="4553356">,</span>&nbsp;<span class="ident" id="4553358">format</span><span class="op" id="4553364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4553367">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4553370">panic</span><span class="op" id="4553375">(</span><span class="ident" id="4553376">fmt</span><span class="op" id="4553379">.</span><span class="ident" id="4553380">Errorf</span><span class="op" id="4553386">(</span><span class="ident" id="4553387">format</span><span class="op" id="4553393">,</span>&nbsp;<span class="ident" id="4553395">args</span><span class="op" id="4553399">...</span><span class="op" id="4553402">)</span><span class="op" id="4553403">)</span><br>
<span class="lineno"></span><span class="op" id="4553405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4553408">//&nbsp;errRecover&nbsp;is&nbsp;the&nbsp;handler&nbsp;that&nbsp;turns&nbsp;panics&nbsp;into&nbsp;returns&nbsp;from&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="comment" id="4553481">//&nbsp;level&nbsp;of&nbsp;Parse.</span><br>
<span class="lineno">95</span><span class="keyword" id="4553500">func</span>&nbsp;<span class="ident" id="4553505">errRecover</span><span class="op" id="4553515">(</span><span class="ident" id="4553516">errp</span>&nbsp;<span class="op" id="4553521">*</span><span class="builtintype" id="4553522">error</span><span class="op" id="4553527">)</span>&nbsp;<span class="op" id="4553529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4553532">e</span>&nbsp;<span class="op" id="4553534">:=</span>&nbsp;<span class="builtinfunc" id="4553537">recover</span><span class="op" id="4553544">(</span><span class="op" id="4553545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4553548">if</span>&nbsp;<span class="ident" id="4553551">e</span>&nbsp;<span class="op" id="4553553">!=</span>&nbsp;<span class="ident" id="4553556">nil</span>&nbsp;<span class="op" id="4553560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4553564">switch</span>&nbsp;<span class="ident" id="4553571">err</span>&nbsp;<span class="op" id="4553575">:=</span>&nbsp;<span class="ident" id="4553578">e</span><span class="op" id="4553579">.</span><span class="op" id="4553580">(</span><span class="keyword" id="4553581">type</span><span class="op" id="4553585">)</span>&nbsp;<span class="op" id="4553587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4553591">case</span>&nbsp;<span class="ident" id="4553596">runtime</span><span class="op" id="4553603">.</span><span class="ident" id="4553604">Error</span><span class="op" id="4553609">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4553614">panic</span><span class="op" id="4553619">(</span><span class="ident" id="4553620">e</span><span class="op" id="4553621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4553625">case</span>&nbsp;<span class="builtintype" id="4553630">error</span><span class="op" id="4553635">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4553640">*</span><span class="ident" id="4553641">errp</span>&nbsp;<span class="op" id="4553646">=</span>&nbsp;<span class="ident" id="4553648">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4553654">default</span><span class="op" id="4553661">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4553666">panic</span><span class="op" id="4553671">(</span><span class="ident" id="4553672">e</span><span class="op" id="4553673">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4553677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4553680">}</span><br>
<span class="lineno"></span><span class="op" id="4553682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4553685">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">110</span><span class="comment" id="4553767">//&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="4553828">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="4553896">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4553969">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4553991">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno">115</span><span class="keyword" id="4554041">func</span>&nbsp;<span class="op" id="4554046">(</span><span class="ident" id="4554047">t</span>&nbsp;<span class="op" id="4554049">*</span><span class="ident" id="4554050">Template</span><span class="op" id="4554058">)</span>&nbsp;<span class="ident" id="4554060">ExecuteTemplate</span><span class="op" id="4554075">(</span><span class="ident" id="4554076">wr</span>&nbsp;<span class="ident" id="4554079">io</span><span class="op" id="4554081">.</span><span class="ident" id="4554082">Writer</span><span class="op" id="4554088">,</span>&nbsp;<span class="ident" id="4554090">name</span>&nbsp;<span class="builtintype" id="4554095">string</span><span class="op" id="4554101">,</span>&nbsp;<span class="ident" id="4554103">data</span>&nbsp;<span class="keyword" id="4554108">interface</span><span class="op" id="4554117">{</span><span class="op" id="4554118">}</span><span class="op" id="4554119">)</span>&nbsp;<span class="builtintype" id="4554121">error</span>&nbsp;<span class="op" id="4554127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4554130">tmpl</span>&nbsp;<span class="op" id="4554135">:=</span>&nbsp;<span class="ident" id="4554138">t</span><span class="op" id="4554139">.</span><span class="ident" id="4554140">tmpl</span><span class="op" id="4554144">[</span><span class="ident" id="4554145">name</span><span class="op" id="4554149">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4554152">if</span>&nbsp;<span class="ident" id="4554155">tmpl</span>&nbsp;<span class="op" id="4554160">==</span>&nbsp;<span class="ident" id="4554163">nil</span>&nbsp;<span class="op" id="4554167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4554171">return</span>&nbsp;<span class="ident" id="4554178">fmt</span><span class="op" id="4554181">.</span><span class="ident" id="4554182">Errorf</span><span class="op" id="4554188">(</span><span class="string" id="4554189">&#34;template:&nbsp;no&nbsp;template&nbsp;%q&nbsp;associated&nbsp;with&nbsp;template&nbsp;%q&#34;</span><span class="op" id="4554243">,</span>&nbsp;<span class="ident" id="4554245">name</span><span class="op" id="4554249">,</span>&nbsp;<span class="ident" id="4554251">t</span><span class="op" id="4554252">.</span><span class="ident" id="4554253">name</span><span class="op" id="4554257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4554260">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4554263">return</span>&nbsp;<span class="ident" id="4554270">tmpl</span><span class="op" id="4554274">.</span><span class="ident" id="4554275">Execute</span><span class="op" id="4554282">(</span><span class="ident" id="4554283">wr</span><span class="op" id="4554285">,</span>&nbsp;<span class="ident" id="4554287">data</span><span class="op" id="4554291">)</span><br>
<span class="lineno"></span><span class="op" id="4554293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4554296">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="4554363">//&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">125</span><span class="comment" id="4554395">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="4554463">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4554536">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4554558">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="4554608">func</span>&nbsp;<span class="op" id="4554613">(</span><span class="ident" id="4554614">t</span>&nbsp;<span class="op" id="4554616">*</span><span class="ident" id="4554617">Template</span><span class="op" id="4554625">)</span>&nbsp;<span class="ident" id="4554627">Execute</span><span class="op" id="4554634">(</span><span class="ident" id="4554635">wr</span>&nbsp;<span class="ident" id="4554638">io</span><span class="op" id="4554640">.</span><span class="ident" id="4554641">Writer</span><span class="op" id="4554647">,</span>&nbsp;<span class="ident" id="4554649">data</span>&nbsp;<span class="keyword" id="4554654">interface</span><span class="op" id="4554663">{</span><span class="op" id="4554664">}</span><span class="op" id="4554665">)</span>&nbsp;<span class="op" id="4554667">(</span><span class="ident" id="4554668">err</span>&nbsp;<span class="builtintype" id="4554672">error</span><span class="op" id="4554677">)</span>&nbsp;<span class="op" id="4554679">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4554682">defer</span>&nbsp;<span class="ident" id="4554688">errRecover</span><span class="op" id="4554698">(</span><span class="op" id="4554699">&amp;</span><span class="ident" id="4554700">err</span><span class="op" id="4554703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4554706">value</span>&nbsp;<span class="op" id="4554712">:=</span>&nbsp;<span class="ident" id="4554715">reflect</span><span class="op" id="4554722">.</span><span class="ident" id="4554723">ValueOf</span><span class="op" id="4554730">(</span><span class="ident" id="4554731">data</span><span class="op" id="4554735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4554738">state</span>&nbsp;<span class="op" id="4554744">:=</span>&nbsp;<span class="op" id="4554747">&amp;</span><span class="ident" id="4554748">state</span><span class="op" id="4554753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4554757">tmpl</span><span class="op" id="4554761">:</span>&nbsp;<span class="ident" id="4554763">t</span><span class="op" id="4554764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4554768">wr</span><span class="op" id="4554770">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4554774">wr</span><span class="op" id="4554776">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4554780">vars</span><span class="op" id="4554784">:</span>&nbsp;<span class="op" id="4554786">[</span><span class="op" id="4554787">]</span><span class="ident" id="4554788">variable</span><span class="op" id="4554796">{</span><span class="op" id="4554797">{</span><span class="string" id="4554798">&#34;$&#34;</span><span class="op" id="4554801">,</span>&nbsp;<span class="ident" id="4554803">value</span><span class="op" id="4554808">}</span><span class="op" id="4554809">}</span><span class="op" id="4554810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4554813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4554816">t</span><span class="op" id="4554817">.</span><span class="ident" id="4554818">init</span><span class="op" id="4554822">(</span><span class="op" id="4554823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4554826">if</span>&nbsp;<span class="ident" id="4554829">t</span><span class="op" id="4554830">.</span><span class="ident" id="4554831">Tree</span>&nbsp;<span class="op" id="4554836">==</span>&nbsp;<span class="ident" id="4554839">nil</span>&nbsp;<span class="op" id="4554843">||</span>&nbsp;<span class="ident" id="4554846">t</span><span class="op" id="4554847">.</span><span class="ident" id="4554848">Root</span>&nbsp;<span class="op" id="4554853">==</span>&nbsp;<span class="ident" id="4554856">nil</span>&nbsp;<span class="op" id="4554860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4554864">var</span>&nbsp;<span class="ident" id="4554868">b</span>&nbsp;<span class="ident" id="4554870">bytes</span><span class="op" id="4554875">.</span><span class="ident" id="4554876">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4554885">for</span>&nbsp;<span class="ident" id="4554889">name</span><span class="op" id="4554893">,</span>&nbsp;<span class="ident" id="4554895">tmpl</span>&nbsp;<span class="op" id="4554900">:=</span>&nbsp;<span class="keyword" id="4554903">range</span>&nbsp;<span class="ident" id="4554909">t</span><span class="op" id="4554910">.</span><span class="ident" id="4554911">tmpl</span>&nbsp;<span class="op" id="4554916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4554921">if</span>&nbsp;<span class="ident" id="4554924">tmpl</span><span class="op" id="4554928">.</span><span class="ident" id="4554929">Tree</span>&nbsp;<span class="op" id="4554934">==</span>&nbsp;<span class="ident" id="4554937">nil</span>&nbsp;<span class="op" id="4554941">||</span>&nbsp;<span class="ident" id="4554944">tmpl</span><span class="op" id="4554948">.</span><span class="ident" id="4554949">Root</span>&nbsp;<span class="op" id="4554954">==</span>&nbsp;<span class="ident" id="4554957">nil</span>&nbsp;<span class="op" id="4554961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4554967">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4554979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4554984">if</span>&nbsp;<span class="ident" id="4554987">b</span><span class="op" id="4554988">.</span><span class="ident" id="4554989">Len</span><span class="op" id="4554992">(</span><span class="op" id="4554993">)</span>&nbsp;<span class="op" id="4554995">&gt;</span>&nbsp;<span class="num" id="4554997">0</span>&nbsp;<span class="op" id="4554999">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4555005">b</span><span class="op" id="4555006">.</span><span class="ident" id="4555007">WriteString</span><span class="op" id="4555018">(</span><span class="string" id="4555019">&#34;,&nbsp;&#34;</span><span class="op" id="4555023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4555028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4555033">fmt</span><span class="op" id="4555036">.</span><span class="ident" id="4555037">Fprintf</span><span class="op" id="4555044">(</span><span class="op" id="4555045">&amp;</span><span class="ident" id="4555046">b</span><span class="op" id="4555047">,</span>&nbsp;<span class="string" id="4555049">&#34;%q&#34;</span><span class="op" id="4555053">,</span>&nbsp;<span class="ident" id="4555055">name</span><span class="op" id="4555059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4555063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4555067">var</span>&nbsp;<span class="ident" id="4555071">s</span>&nbsp;<span class="builtintype" id="4555073">string</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4555082">if</span>&nbsp;<span class="ident" id="4555085">b</span><span class="op" id="4555086">.</span><span class="ident" id="4555087">Len</span><span class="op" id="4555090">(</span><span class="op" id="4555091">)</span>&nbsp;<span class="op" id="4555093">&gt;</span>&nbsp;<span class="num" id="4555095">0</span>&nbsp;<span class="op" id="4555097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4555102">s</span>&nbsp;<span class="op" id="4555104">=</span>&nbsp;<span class="string" id="4555106">&#34;;&nbsp;defined&nbsp;templates&nbsp;are:&nbsp;&#34;</span>&nbsp;<span class="op" id="4555134">+</span>&nbsp;<span class="ident" id="4555136">b</span><span class="op" id="4555137">.</span><span class="ident" id="4555138">String</span><span class="op" id="4555144">(</span><span class="op" id="4555145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4555149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4555153">state</span><span class="op" id="4555158">.</span><span class="ident" id="4555159">errorf</span><span class="op" id="4555165">(</span><span class="string" id="4555166">&#34;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;or&nbsp;empty&nbsp;template%s&#34;</span><span class="op" id="4555207">,</span>&nbsp;<span class="ident" id="4555209">t</span><span class="op" id="4555210">.</span><span class="ident" id="4555211">Name</span><span class="op" id="4555215">(</span><span class="op" id="4555216">)</span><span class="op" id="4555217">,</span>&nbsp;<span class="ident" id="4555219">s</span><span class="op" id="4555220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4555223">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4555226">state</span><span class="op" id="4555231">.</span><span class="ident" id="4555232">walk</span><span class="op" id="4555236">(</span><span class="ident" id="4555237">value</span><span class="op" id="4555242">,</span>&nbsp;<span class="ident" id="4555244">t</span><span class="op" id="4555245">.</span><span class="ident" id="4555246">Root</span><span class="op" id="4555250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4555253">return</span><br>
<span class="lineno"></span><span class="op" id="4555260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4555263">//&nbsp;Walk&nbsp;functions&nbsp;step&nbsp;through&nbsp;the&nbsp;major&nbsp;pieces&nbsp;of&nbsp;the&nbsp;template&nbsp;structure,</span><br>
<span class="lineno">160</span><span class="comment" id="4555338">//&nbsp;generating&nbsp;output&nbsp;as&nbsp;they&nbsp;go.</span><br>
<span class="lineno"></span><span class="keyword" id="4555371">func</span>&nbsp;<span class="op" id="4555376">(</span><span class="ident" id="4555377">s</span>&nbsp;<span class="op" id="4555379">*</span><span class="ident" id="4555380">state</span><span class="op" id="4555385">)</span>&nbsp;<span class="ident" id="4555387">walk</span><span class="op" id="4555391">(</span><span class="ident" id="4555392">dot</span>&nbsp;<span class="ident" id="4555396">reflect</span><span class="op" id="4555403">.</span><span class="ident" id="4555404">Value</span><span class="op" id="4555409">,</span>&nbsp;<span class="ident" id="4555411">node</span>&nbsp;<span class="ident" id="4555416">parse</span><span class="op" id="4555421">.</span><span class="ident" id="4555422">Node</span><span class="op" id="4555426">)</span>&nbsp;<span class="op" id="4555428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4555431">s</span><span class="op" id="4555432">.</span><span class="ident" id="4555433">at</span><span class="op" id="4555435">(</span><span class="ident" id="4555436">node</span><span class="op" id="4555440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4555443">switch</span>&nbsp;<span class="ident" id="4555450">node</span>&nbsp;<span class="op" id="4555455">:=</span>&nbsp;<span class="ident" id="4555458">node</span><span class="op" id="4555462">.</span><span class="op" id="4555463">(</span><span class="keyword" id="4555464">type</span><span class="op" id="4555468">)</span>&nbsp;<span class="op" id="4555470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4555473">case</span>&nbsp;<span class="op" id="4555478">*</span><span class="ident" id="4555479">parse</span><span class="op" id="4555484">.</span><span class="ident" id="4555485">ActionNode</span><span class="op" id="4555495">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4555499">//&nbsp;Do&nbsp;not&nbsp;pop&nbsp;variables&nbsp;so&nbsp;they&nbsp;persist&nbsp;until&nbsp;next&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4555557">//&nbsp;Also,&nbsp;if&nbsp;the&nbsp;action&nbsp;declares&nbsp;variables,&nbsp;don&#39;t&nbsp;print&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4555626">val</span>&nbsp;<span class="op" id="4555630">:=</span>&nbsp;<span class="ident" id="4555633">s</span><span class="op" id="4555634">.</span><span class="ident" id="4555635">evalPipeline</span><span class="op" id="4555647">(</span><span class="ident" id="4555648">dot</span><span class="op" id="4555651">,</span>&nbsp;<span class="ident" id="4555653">node</span><span class="op" id="4555657">.</span><span class="ident" id="4555658">Pipe</span><span class="op" id="4555662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4555666">if</span>&nbsp;<span class="builtinfunc" id="4555669">len</span><span class="op" id="4555672">(</span><span class="ident" id="4555673">node</span><span class="op" id="4555677">.</span><span class="ident" id="4555678">Pipe</span><span class="op" id="4555682">.</span><span class="ident" id="4555683">Decl</span><span class="op" id="4555687">)</span>&nbsp;<span class="op" id="4555689">==</span>&nbsp;<span class="num" id="4555692">0</span>&nbsp;<span class="op" id="4555694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4555699">s</span><span class="op" id="4555700">.</span><span class="ident" id="4555701">printValue</span><span class="op" id="4555711">(</span><span class="ident" id="4555712">node</span><span class="op" id="4555716">,</span>&nbsp;<span class="ident" id="4555718">val</span><span class="op" id="4555721">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4555725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4555728">case</span>&nbsp;<span class="op" id="4555733">*</span><span class="ident" id="4555734">parse</span><span class="op" id="4555739">.</span><span class="ident" id="4555740">IfNode</span><span class="op" id="4555746">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4555750">s</span><span class="op" id="4555751">.</span><span class="ident" id="4555752">walkIfOrWith</span><span class="op" id="4555764">(</span><span class="ident" id="4555765">parse</span><span class="op" id="4555770">.</span><span class="ident" id="4555771">NodeIf</span><span class="op" id="4555777">,</span>&nbsp;<span class="ident" id="4555779">dot</span><span class="op" id="4555782">,</span>&nbsp;<span class="ident" id="4555784">node</span><span class="op" id="4555788">.</span><span class="ident" id="4555789">Pipe</span><span class="op" id="4555793">,</span>&nbsp;<span class="ident" id="4555795">node</span><span class="op" id="4555799">.</span><span class="ident" id="4555800">List</span><span class="op" id="4555804">,</span>&nbsp;<span class="ident" id="4555806">node</span><span class="op" id="4555810">.</span><span class="ident" id="4555811">ElseList</span><span class="op" id="4555819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4555822">case</span>&nbsp;<span class="op" id="4555827">*</span><span class="ident" id="4555828">parse</span><span class="op" id="4555833">.</span><span class="ident" id="4555834">ListNode</span><span class="op" id="4555842">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4555846">for</span>&nbsp;<span class="ident" id="4555850">_</span><span class="op" id="4555851">,</span>&nbsp;<span class="ident" id="4555853">node</span>&nbsp;<span class="op" id="4555858">:=</span>&nbsp;<span class="keyword" id="4555861">range</span>&nbsp;<span class="ident" id="4555867">node</span><span class="op" id="4555871">.</span><span class="ident" id="4555872">Nodes</span>&nbsp;<span class="op" id="4555878">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4555883">s</span><span class="op" id="4555884">.</span><span class="ident" id="4555885">walk</span><span class="op" id="4555889">(</span><span class="ident" id="4555890">dot</span><span class="op" id="4555893">,</span>&nbsp;<span class="ident" id="4555895">node</span><span class="op" id="4555899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4555903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4555906">case</span>&nbsp;<span class="op" id="4555911">*</span><span class="ident" id="4555912">parse</span><span class="op" id="4555917">.</span><span class="ident" id="4555918">RangeNode</span><span class="op" id="4555927">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4555931">s</span><span class="op" id="4555932">.</span><span class="ident" id="4555933">walkRange</span><span class="op" id="4555942">(</span><span class="ident" id="4555943">dot</span><span class="op" id="4555946">,</span>&nbsp;<span class="ident" id="4555948">node</span><span class="op" id="4555952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4555955">case</span>&nbsp;<span class="op" id="4555960">*</span><span class="ident" id="4555961">parse</span><span class="op" id="4555966">.</span><span class="ident" id="4555967">TemplateNode</span><span class="op" id="4555979">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4555983">s</span><span class="op" id="4555984">.</span><span class="ident" id="4555985">walkTemplate</span><span class="op" id="4555997">(</span><span class="ident" id="4555998">dot</span><span class="op" id="4556001">,</span>&nbsp;<span class="ident" id="4556003">node</span><span class="op" id="4556007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4556010">case</span>&nbsp;<span class="op" id="4556015">*</span><span class="ident" id="4556016">parse</span><span class="op" id="4556021">.</span><span class="ident" id="4556022">TextNode</span><span class="op" id="4556030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4556034">if</span>&nbsp;<span class="ident" id="4556037">_</span><span class="op" id="4556038">,</span>&nbsp;<span class="ident" id="4556040">err</span>&nbsp;<span class="op" id="4556044">:=</span>&nbsp;<span class="ident" id="4556047">s</span><span class="op" id="4556048">.</span><span class="ident" id="4556049">wr</span><span class="op" id="4556051">.</span><span class="ident" id="4556052">Write</span><span class="op" id="4556057">(</span><span class="ident" id="4556058">node</span><span class="op" id="4556062">.</span><span class="ident" id="4556063">Text</span><span class="op" id="4556067">)</span><span class="op" id="4556068">;</span>&nbsp;<span class="ident" id="4556070">err</span>&nbsp;<span class="op" id="4556074">!=</span>&nbsp;<span class="ident" id="4556077">nil</span>&nbsp;<span class="op" id="4556081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4556086">s</span><span class="op" id="4556087">.</span><span class="ident" id="4556088">errorf</span><span class="op" id="4556094">(</span><span class="string" id="4556095">&#34;%s&#34;</span><span class="op" id="4556099">,</span>&nbsp;<span class="ident" id="4556101">err</span><span class="op" id="4556104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4556108">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4556111">case</span>&nbsp;<span class="op" id="4556116">*</span><span class="ident" id="4556117">parse</span><span class="op" id="4556122">.</span><span class="ident" id="4556123">WithNode</span><span class="op" id="4556131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4556135">s</span><span class="op" id="4556136">.</span><span class="ident" id="4556137">walkIfOrWith</span><span class="op" id="4556149">(</span><span class="ident" id="4556150">parse</span><span class="op" id="4556155">.</span><span class="ident" id="4556156">NodeWith</span><span class="op" id="4556164">,</span>&nbsp;<span class="ident" id="4556166">dot</span><span class="op" id="4556169">,</span>&nbsp;<span class="ident" id="4556171">node</span><span class="op" id="4556175">.</span><span class="ident" id="4556176">Pipe</span><span class="op" id="4556180">,</span>&nbsp;<span class="ident" id="4556182">node</span><span class="op" id="4556186">.</span><span class="ident" id="4556187">List</span><span class="op" id="4556191">,</span>&nbsp;<span class="ident" id="4556193">node</span><span class="op" id="4556197">.</span><span class="ident" id="4556198">ElseList</span><span class="op" id="4556206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4556209">default</span><span class="op" id="4556216">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4556220">s</span><span class="op" id="4556221">.</span><span class="ident" id="4556222">errorf</span><span class="op" id="4556228">(</span><span class="string" id="4556229">&#34;unknown&nbsp;node:&nbsp;%s&#34;</span><span class="op" id="4556247">,</span>&nbsp;<span class="ident" id="4556249">node</span><span class="op" id="4556253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4556256">}</span><br>
<span class="lineno">190</span><span class="op" id="4556258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4556261">//&nbsp;walkIfOrWith&nbsp;walks&nbsp;an&nbsp;&#39;if&#39;&nbsp;or&nbsp;&#39;with&#39;&nbsp;node.&nbsp;The&nbsp;two&nbsp;control&nbsp;structures</span><br>
<span class="lineno"></span><span class="comment" id="4556334">//&nbsp;are&nbsp;identical&nbsp;in&nbsp;behavior&nbsp;except&nbsp;that&nbsp;&#39;with&#39;&nbsp;sets&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="4556392">func</span>&nbsp;<span class="op" id="4556397">(</span><span class="ident" id="4556398">s</span>&nbsp;<span class="op" id="4556400">*</span><span class="ident" id="4556401">state</span><span class="op" id="4556406">)</span>&nbsp;<span class="ident" id="4556408">walkIfOrWith</span><span class="op" id="4556420">(</span><span class="ident" id="4556421">typ</span>&nbsp;<span class="ident" id="4556425">parse</span><span class="op" id="4556430">.</span><span class="ident" id="4556431">NodeType</span><span class="op" id="4556439">,</span>&nbsp;<span class="ident" id="4556441">dot</span>&nbsp;<span class="ident" id="4556445">reflect</span><span class="op" id="4556452">.</span><span class="ident" id="4556453">Value</span><span class="op" id="4556458">,</span>&nbsp;<span class="ident" id="4556460">pipe</span>&nbsp;<span class="op" id="4556465">*</span><span class="ident" id="4556466">parse</span><span class="op" id="4556471">.</span><span class="ident" id="4556472">PipeNode</span><span class="op" id="4556480">,</span>&nbsp;<span class="ident" id="4556482">list</span><span class="op" id="4556486">,</span>&nbsp;<span class="ident" id="4556488">elseList</span>&nbsp;<span class="op" id="4556497">*</span><span class="ident" id="4556498">parse</span><span class="op" id="4556503">.</span><span class="ident" id="4556504">ListNode</span><span class="op" id="4556512">)</span>&nbsp;<span class="op" id="4556514">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4556517">defer</span>&nbsp;<span class="ident" id="4556523">s</span><span class="op" id="4556524">.</span><span class="ident" id="4556525">pop</span><span class="op" id="4556528">(</span><span class="ident" id="4556529">s</span><span class="op" id="4556530">.</span><span class="ident" id="4556531">mark</span><span class="op" id="4556535">(</span><span class="op" id="4556536">)</span><span class="op" id="4556537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4556540">val</span>&nbsp;<span class="op" id="4556544">:=</span>&nbsp;<span class="ident" id="4556547">s</span><span class="op" id="4556548">.</span><span class="ident" id="4556549">evalPipeline</span><span class="op" id="4556561">(</span><span class="ident" id="4556562">dot</span><span class="op" id="4556565">,</span>&nbsp;<span class="ident" id="4556567">pipe</span><span class="op" id="4556571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4556574">truth</span><span class="op" id="4556579">,</span>&nbsp;<span class="ident" id="4556581">ok</span>&nbsp;<span class="op" id="4556584">:=</span>&nbsp;<span class="ident" id="4556587">isTrue</span><span class="op" id="4556593">(</span><span class="ident" id="4556594">val</span><span class="op" id="4556597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4556600">if</span>&nbsp;<span class="op" id="4556603">!</span><span class="ident" id="4556604">ok</span>&nbsp;<span class="op" id="4556607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4556611">s</span><span class="op" id="4556612">.</span><span class="ident" id="4556613">errorf</span><span class="op" id="4556619">(</span><span class="string" id="4556620">&#34;if/with&nbsp;can&#39;t&nbsp;use&nbsp;%v&#34;</span><span class="op" id="4556642">,</span>&nbsp;<span class="ident" id="4556644">val</span><span class="op" id="4556647">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4556650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4556653">if</span>&nbsp;<span class="ident" id="4556656">truth</span>&nbsp;<span class="op" id="4556662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4556666">if</span>&nbsp;<span class="ident" id="4556669">typ</span>&nbsp;<span class="op" id="4556673">==</span>&nbsp;<span class="ident" id="4556676">parse</span><span class="op" id="4556681">.</span><span class="ident" id="4556682">NodeWith</span>&nbsp;<span class="op" id="4556691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4556696">s</span><span class="op" id="4556697">.</span><span class="ident" id="4556698">walk</span><span class="op" id="4556702">(</span><span class="ident" id="4556703">val</span><span class="op" id="4556706">,</span>&nbsp;<span class="ident" id="4556708">list</span><span class="op" id="4556712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4556716">}</span>&nbsp;<span class="keyword" id="4556718">else</span>&nbsp;<span class="op" id="4556723">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4556728">s</span><span class="op" id="4556729">.</span><span class="ident" id="4556730">walk</span><span class="op" id="4556734">(</span><span class="ident" id="4556735">dot</span><span class="op" id="4556738">,</span>&nbsp;<span class="ident" id="4556740">list</span><span class="op" id="4556744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4556748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4556751">}</span>&nbsp;<span class="keyword" id="4556753">else</span>&nbsp;<span class="keyword" id="4556758">if</span>&nbsp;<span class="ident" id="4556761">elseList</span>&nbsp;<span class="op" id="4556770">!=</span>&nbsp;<span class="ident" id="4556773">nil</span>&nbsp;<span class="op" id="4556777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4556781">s</span><span class="op" id="4556782">.</span><span class="ident" id="4556783">walk</span><span class="op" id="4556787">(</span><span class="ident" id="4556788">dot</span><span class="op" id="4556791">,</span>&nbsp;<span class="ident" id="4556793">elseList</span><span class="op" id="4556801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4556804">}</span><br>
<span class="lineno">210</span><span class="op" id="4556806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4556809">//&nbsp;isTrue&nbsp;reports&nbsp;whether&nbsp;the&nbsp;value&nbsp;is&nbsp;&#39;true&#39;,&nbsp;in&nbsp;the&nbsp;sense&nbsp;of&nbsp;not&nbsp;the&nbsp;zero&nbsp;of&nbsp;its&nbsp;type,</span><br>
<span class="lineno"></span><span class="comment" id="4556898">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;value&nbsp;has&nbsp;a&nbsp;meaningful&nbsp;truth&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4556953">func</span>&nbsp;<span class="ident" id="4556958">isTrue</span><span class="op" id="4556964">(</span><span class="ident" id="4556965">val</span>&nbsp;<span class="ident" id="4556969">reflect</span><span class="op" id="4556976">.</span><span class="ident" id="4556977">Value</span><span class="op" id="4556982">)</span>&nbsp;<span class="op" id="4556984">(</span><span class="ident" id="4556985">truth</span><span class="op" id="4556990">,</span>&nbsp;<span class="ident" id="4556992">ok</span>&nbsp;<span class="builtintype" id="4556995">bool</span><span class="op" id="4556999">)</span>&nbsp;<span class="op" id="4557001">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557004">if</span>&nbsp;<span class="op" id="4557007">!</span><span class="ident" id="4557008">val</span><span class="op" id="4557011">.</span><span class="ident" id="4557012">IsValid</span><span class="op" id="4557019">(</span><span class="op" id="4557020">)</span>&nbsp;<span class="op" id="4557022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4557026">//&nbsp;Something&nbsp;like&nbsp;var&nbsp;x&nbsp;interface{},&nbsp;never&nbsp;set.&nbsp;It&#39;s&nbsp;a&nbsp;form&nbsp;of&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557096">return</span>&nbsp;<span class="builtintype" id="4557103">false</span><span class="op" id="4557108">,</span>&nbsp;<span class="builtintype" id="4557110">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4557116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557119">switch</span>&nbsp;<span class="ident" id="4557126">val</span><span class="op" id="4557129">.</span><span class="ident" id="4557130">Kind</span><span class="op" id="4557134">(</span><span class="op" id="4557135">)</span>&nbsp;<span class="op" id="4557137">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557140">case</span>&nbsp;<span class="ident" id="4557145">reflect</span><span class="op" id="4557152">.</span><span class="ident" id="4557153">Array</span><span class="op" id="4557158">,</span>&nbsp;<span class="ident" id="4557160">reflect</span><span class="op" id="4557167">.</span><span class="ident" id="4557168">Map</span><span class="op" id="4557171">,</span>&nbsp;<span class="ident" id="4557173">reflect</span><span class="op" id="4557180">.</span><span class="ident" id="4557181">Slice</span><span class="op" id="4557186">,</span>&nbsp;<span class="ident" id="4557188">reflect</span><span class="op" id="4557195">.</span><span class="ident" id="4557196">String</span><span class="op" id="4557202">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4557206">truth</span>&nbsp;<span class="op" id="4557212">=</span>&nbsp;<span class="ident" id="4557214">val</span><span class="op" id="4557217">.</span><span class="ident" id="4557218">Len</span><span class="op" id="4557221">(</span><span class="op" id="4557222">)</span>&nbsp;<span class="op" id="4557224">&gt;</span>&nbsp;<span class="num" id="4557226">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557229">case</span>&nbsp;<span class="ident" id="4557234">reflect</span><span class="op" id="4557241">.</span><span class="ident" id="4557242">Bool</span><span class="op" id="4557246">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4557250">truth</span>&nbsp;<span class="op" id="4557256">=</span>&nbsp;<span class="ident" id="4557258">val</span><span class="op" id="4557261">.</span><span class="ident" id="4557262">Bool</span><span class="op" id="4557266">(</span><span class="op" id="4557267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557270">case</span>&nbsp;<span class="ident" id="4557275">reflect</span><span class="op" id="4557282">.</span><span class="ident" id="4557283">Complex64</span><span class="op" id="4557292">,</span>&nbsp;<span class="ident" id="4557294">reflect</span><span class="op" id="4557301">.</span><span class="ident" id="4557302">Complex128</span><span class="op" id="4557312">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4557316">truth</span>&nbsp;<span class="op" id="4557322">=</span>&nbsp;<span class="ident" id="4557324">val</span><span class="op" id="4557327">.</span><span class="ident" id="4557328">Complex</span><span class="op" id="4557335">(</span><span class="op" id="4557336">)</span>&nbsp;<span class="op" id="4557338">!=</span>&nbsp;<span class="num" id="4557341">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557344">case</span>&nbsp;<span class="ident" id="4557349">reflect</span><span class="op" id="4557356">.</span><span class="ident" id="4557357">Chan</span><span class="op" id="4557361">,</span>&nbsp;<span class="ident" id="4557363">reflect</span><span class="op" id="4557370">.</span><span class="ident" id="4557371">Func</span><span class="op" id="4557375">,</span>&nbsp;<span class="ident" id="4557377">reflect</span><span class="op" id="4557384">.</span><span class="ident" id="4557385">Ptr</span><span class="op" id="4557388">,</span>&nbsp;<span class="ident" id="4557390">reflect</span><span class="op" id="4557397">.</span><span class="ident" id="4557398">Interface</span><span class="op" id="4557407">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4557411">truth</span>&nbsp;<span class="op" id="4557417">=</span>&nbsp;<span class="op" id="4557419">!</span><span class="ident" id="4557420">val</span><span class="op" id="4557423">.</span><span class="ident" id="4557424">IsNil</span><span class="op" id="4557429">(</span><span class="op" id="4557430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557433">case</span>&nbsp;<span class="ident" id="4557438">reflect</span><span class="op" id="4557445">.</span><span class="ident" id="4557446">Int</span><span class="op" id="4557449">,</span>&nbsp;<span class="ident" id="4557451">reflect</span><span class="op" id="4557458">.</span><span class="ident" id="4557459">Int8</span><span class="op" id="4557463">,</span>&nbsp;<span class="ident" id="4557465">reflect</span><span class="op" id="4557472">.</span><span class="ident" id="4557473">Int16</span><span class="op" id="4557478">,</span>&nbsp;<span class="ident" id="4557480">reflect</span><span class="op" id="4557487">.</span><span class="ident" id="4557488">Int32</span><span class="op" id="4557493">,</span>&nbsp;<span class="ident" id="4557495">reflect</span><span class="op" id="4557502">.</span><span class="ident" id="4557503">Int64</span><span class="op" id="4557508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4557512">truth</span>&nbsp;<span class="op" id="4557518">=</span>&nbsp;<span class="ident" id="4557520">val</span><span class="op" id="4557523">.</span><span class="ident" id="4557524">Int</span><span class="op" id="4557527">(</span><span class="op" id="4557528">)</span>&nbsp;<span class="op" id="4557530">!=</span>&nbsp;<span class="num" id="4557533">0</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557536">case</span>&nbsp;<span class="ident" id="4557541">reflect</span><span class="op" id="4557548">.</span><span class="ident" id="4557549">Float32</span><span class="op" id="4557556">,</span>&nbsp;<span class="ident" id="4557558">reflect</span><span class="op" id="4557565">.</span><span class="ident" id="4557566">Float64</span><span class="op" id="4557573">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4557577">truth</span>&nbsp;<span class="op" id="4557583">=</span>&nbsp;<span class="ident" id="4557585">val</span><span class="op" id="4557588">.</span><span class="ident" id="4557589">Float</span><span class="op" id="4557594">(</span><span class="op" id="4557595">)</span>&nbsp;<span class="op" id="4557597">!=</span>&nbsp;<span class="num" id="4557600">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557603">case</span>&nbsp;<span class="ident" id="4557608">reflect</span><span class="op" id="4557615">.</span><span class="ident" id="4557616">Uint</span><span class="op" id="4557620">,</span>&nbsp;<span class="ident" id="4557622">reflect</span><span class="op" id="4557629">.</span><span class="ident" id="4557630">Uint8</span><span class="op" id="4557635">,</span>&nbsp;<span class="ident" id="4557637">reflect</span><span class="op" id="4557644">.</span><span class="ident" id="4557645">Uint16</span><span class="op" id="4557651">,</span>&nbsp;<span class="ident" id="4557653">reflect</span><span class="op" id="4557660">.</span><span class="ident" id="4557661">Uint32</span><span class="op" id="4557667">,</span>&nbsp;<span class="ident" id="4557669">reflect</span><span class="op" id="4557676">.</span><span class="ident" id="4557677">Uint64</span><span class="op" id="4557683">,</span>&nbsp;<span class="ident" id="4557685">reflect</span><span class="op" id="4557692">.</span><span class="ident" id="4557693">Uintptr</span><span class="op" id="4557700">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4557704">truth</span>&nbsp;<span class="op" id="4557710">=</span>&nbsp;<span class="ident" id="4557712">val</span><span class="op" id="4557715">.</span><span class="ident" id="4557716">Uint</span><span class="op" id="4557720">(</span><span class="op" id="4557721">)</span>&nbsp;<span class="op" id="4557723">!=</span>&nbsp;<span class="num" id="4557726">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557729">case</span>&nbsp;<span class="ident" id="4557734">reflect</span><span class="op" id="4557741">.</span><span class="ident" id="4557742">Struct</span><span class="op" id="4557748">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4557752">truth</span>&nbsp;<span class="op" id="4557758">=</span>&nbsp;<span class="builtintype" id="4557760">true</span>&nbsp;<span class="comment" id="4557765">//&nbsp;Struct&nbsp;values&nbsp;are&nbsp;always&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557800">default</span><span class="op" id="4557807">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557811">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4557819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557822">return</span>&nbsp;<span class="ident" id="4557829">truth</span><span class="op" id="4557834">,</span>&nbsp;<span class="builtintype" id="4557836">true</span><br>
<span class="lineno">240</span><span class="op" id="4557841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4557844">func</span>&nbsp;<span class="op" id="4557849">(</span><span class="ident" id="4557850">s</span>&nbsp;<span class="op" id="4557852">*</span><span class="ident" id="4557853">state</span><span class="op" id="4557858">)</span>&nbsp;<span class="ident" id="4557860">walkRange</span><span class="op" id="4557869">(</span><span class="ident" id="4557870">dot</span>&nbsp;<span class="ident" id="4557874">reflect</span><span class="op" id="4557881">.</span><span class="ident" id="4557882">Value</span><span class="op" id="4557887">,</span>&nbsp;<span class="ident" id="4557889">r</span>&nbsp;<span class="op" id="4557891">*</span><span class="ident" id="4557892">parse</span><span class="op" id="4557897">.</span><span class="ident" id="4557898">RangeNode</span><span class="op" id="4557907">)</span>&nbsp;<span class="op" id="4557909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4557912">s</span><span class="op" id="4557913">.</span><span class="ident" id="4557914">at</span><span class="op" id="4557916">(</span><span class="ident" id="4557917">r</span><span class="op" id="4557918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4557921">defer</span>&nbsp;<span class="ident" id="4557927">s</span><span class="op" id="4557928">.</span><span class="ident" id="4557929">pop</span><span class="op" id="4557932">(</span><span class="ident" id="4557933">s</span><span class="op" id="4557934">.</span><span class="ident" id="4557935">mark</span><span class="op" id="4557939">(</span><span class="op" id="4557940">)</span><span class="op" id="4557941">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4557944">val</span><span class="op" id="4557947">,</span>&nbsp;<span class="ident" id="4557949">_</span>&nbsp;<span class="op" id="4557951">:=</span>&nbsp;<span class="ident" id="4557954">indirect</span><span class="op" id="4557962">(</span><span class="ident" id="4557963">s</span><span class="op" id="4557964">.</span><span class="ident" id="4557965">evalPipeline</span><span class="op" id="4557977">(</span><span class="ident" id="4557978">dot</span><span class="op" id="4557981">,</span>&nbsp;<span class="ident" id="4557983">r</span><span class="op" id="4557984">.</span><span class="ident" id="4557985">Pipe</span><span class="op" id="4557989">)</span><span class="op" id="4557990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4557993">//&nbsp;mark&nbsp;top&nbsp;of&nbsp;stack&nbsp;before&nbsp;any&nbsp;variables&nbsp;in&nbsp;the&nbsp;body&nbsp;are&nbsp;pushed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4558060">mark</span>&nbsp;<span class="op" id="4558065">:=</span>&nbsp;<span class="ident" id="4558068">s</span><span class="op" id="4558069">.</span><span class="ident" id="4558070">mark</span><span class="op" id="4558074">(</span><span class="op" id="4558075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4558078">oneIteration</span>&nbsp;<span class="op" id="4558091">:=</span>&nbsp;<span class="keyword" id="4558094">func</span><span class="op" id="4558098">(</span><span class="ident" id="4558099">index</span><span class="op" id="4558104">,</span>&nbsp;<span class="ident" id="4558106">elem</span>&nbsp;<span class="ident" id="4558111">reflect</span><span class="op" id="4558118">.</span><span class="ident" id="4558119">Value</span><span class="op" id="4558124">)</span>&nbsp;<span class="op" id="4558126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4558130">//&nbsp;Set&nbsp;top&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;second&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;element.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558203">if</span>&nbsp;<span class="builtinfunc" id="4558206">len</span><span class="op" id="4558209">(</span><span class="ident" id="4558210">r</span><span class="op" id="4558211">.</span><span class="ident" id="4558212">Pipe</span><span class="op" id="4558216">.</span><span class="ident" id="4558217">Decl</span><span class="op" id="4558221">)</span>&nbsp;<span class="op" id="4558223">&gt;</span>&nbsp;<span class="num" id="4558225">0</span>&nbsp;<span class="op" id="4558227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4558232">s</span><span class="op" id="4558233">.</span><span class="ident" id="4558234">setVar</span><span class="op" id="4558240">(</span><span class="num" id="4558241">1</span><span class="op" id="4558242">,</span>&nbsp;<span class="ident" id="4558244">elem</span><span class="op" id="4558248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4558252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4558256">//&nbsp;Set&nbsp;next&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;first&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;index.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558327">if</span>&nbsp;<span class="builtinfunc" id="4558330">len</span><span class="op" id="4558333">(</span><span class="ident" id="4558334">r</span><span class="op" id="4558335">.</span><span class="ident" id="4558336">Pipe</span><span class="op" id="4558340">.</span><span class="ident" id="4558341">Decl</span><span class="op" id="4558345">)</span>&nbsp;<span class="op" id="4558347">&gt;</span>&nbsp;<span class="num" id="4558349">1</span>&nbsp;<span class="op" id="4558351">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4558356">s</span><span class="op" id="4558357">.</span><span class="ident" id="4558358">setVar</span><span class="op" id="4558364">(</span><span class="num" id="4558365">2</span><span class="op" id="4558366">,</span>&nbsp;<span class="ident" id="4558368">index</span><span class="op" id="4558373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4558377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4558381">s</span><span class="op" id="4558382">.</span><span class="ident" id="4558383">walk</span><span class="op" id="4558387">(</span><span class="ident" id="4558388">elem</span><span class="op" id="4558392">,</span>&nbsp;<span class="ident" id="4558394">r</span><span class="op" id="4558395">.</span><span class="ident" id="4558396">List</span><span class="op" id="4558400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4558404">s</span><span class="op" id="4558405">.</span><span class="ident" id="4558406">pop</span><span class="op" id="4558409">(</span><span class="ident" id="4558410">mark</span><span class="op" id="4558414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4558417">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558420">switch</span>&nbsp;<span class="ident" id="4558427">val</span><span class="op" id="4558430">.</span><span class="ident" id="4558431">Kind</span><span class="op" id="4558435">(</span><span class="op" id="4558436">)</span>&nbsp;<span class="op" id="4558438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558441">case</span>&nbsp;<span class="ident" id="4558446">reflect</span><span class="op" id="4558453">.</span><span class="ident" id="4558454">Array</span><span class="op" id="4558459">,</span>&nbsp;<span class="ident" id="4558461">reflect</span><span class="op" id="4558468">.</span><span class="ident" id="4558469">Slice</span><span class="op" id="4558474">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558478">if</span>&nbsp;<span class="ident" id="4558481">val</span><span class="op" id="4558484">.</span><span class="ident" id="4558485">Len</span><span class="op" id="4558488">(</span><span class="op" id="4558489">)</span>&nbsp;<span class="op" id="4558491">==</span>&nbsp;<span class="num" id="4558494">0</span>&nbsp;<span class="op" id="4558496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558501">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4558509">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558513">for</span>&nbsp;<span class="ident" id="4558517">i</span>&nbsp;<span class="op" id="4558519">:=</span>&nbsp;<span class="num" id="4558522">0</span><span class="op" id="4558523">;</span>&nbsp;<span class="ident" id="4558525">i</span>&nbsp;<span class="op" id="4558527">&lt;</span>&nbsp;<span class="ident" id="4558529">val</span><span class="op" id="4558532">.</span><span class="ident" id="4558533">Len</span><span class="op" id="4558536">(</span><span class="op" id="4558537">)</span><span class="op" id="4558538">;</span>&nbsp;<span class="ident" id="4558540">i</span><span class="op" id="4558541">++</span>&nbsp;<span class="op" id="4558544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4558549">oneIteration</span><span class="op" id="4558561">(</span><span class="ident" id="4558562">reflect</span><span class="op" id="4558569">.</span><span class="ident" id="4558570">ValueOf</span><span class="op" id="4558577">(</span><span class="ident" id="4558578">i</span><span class="op" id="4558579">)</span><span class="op" id="4558580">,</span>&nbsp;<span class="ident" id="4558582">val</span><span class="op" id="4558585">.</span><span class="ident" id="4558586">Index</span><span class="op" id="4558591">(</span><span class="ident" id="4558592">i</span><span class="op" id="4558593">)</span><span class="op" id="4558594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4558598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558602">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558610">case</span>&nbsp;<span class="ident" id="4558615">reflect</span><span class="op" id="4558622">.</span><span class="ident" id="4558623">Map</span><span class="op" id="4558626">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558630">if</span>&nbsp;<span class="ident" id="4558633">val</span><span class="op" id="4558636">.</span><span class="ident" id="4558637">Len</span><span class="op" id="4558640">(</span><span class="op" id="4558641">)</span>&nbsp;<span class="op" id="4558643">==</span>&nbsp;<span class="num" id="4558646">0</span>&nbsp;<span class="op" id="4558648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558653">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4558661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558665">for</span>&nbsp;<span class="ident" id="4558669">_</span><span class="op" id="4558670">,</span>&nbsp;<span class="ident" id="4558672">key</span>&nbsp;<span class="op" id="4558676">:=</span>&nbsp;<span class="keyword" id="4558679">range</span>&nbsp;<span class="ident" id="4558685">sortKeys</span><span class="op" id="4558693">(</span><span class="ident" id="4558694">val</span><span class="op" id="4558697">.</span><span class="ident" id="4558698">MapKeys</span><span class="op" id="4558705">(</span><span class="op" id="4558706">)</span><span class="op" id="4558707">)</span>&nbsp;<span class="op" id="4558709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4558714">oneIteration</span><span class="op" id="4558726">(</span><span class="ident" id="4558727">key</span><span class="op" id="4558730">,</span>&nbsp;<span class="ident" id="4558732">val</span><span class="op" id="4558735">.</span><span class="ident" id="4558736">MapIndex</span><span class="op" id="4558744">(</span><span class="ident" id="4558745">key</span><span class="op" id="4558748">)</span><span class="op" id="4558749">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4558753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558757">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558765">case</span>&nbsp;<span class="ident" id="4558770">reflect</span><span class="op" id="4558777">.</span><span class="ident" id="4558778">Chan</span><span class="op" id="4558782">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558786">if</span>&nbsp;<span class="ident" id="4558789">val</span><span class="op" id="4558792">.</span><span class="ident" id="4558793">IsNil</span><span class="op" id="4558798">(</span><span class="op" id="4558799">)</span>&nbsp;<span class="op" id="4558801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558806">break</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4558814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4558818">i</span>&nbsp;<span class="op" id="4558820">:=</span>&nbsp;<span class="num" id="4558823">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558827">for</span>&nbsp;<span class="op" id="4558831">;</span>&nbsp;<span class="op" id="4558833">;</span>&nbsp;<span class="ident" id="4558835">i</span><span class="op" id="4558836">++</span>&nbsp;<span class="op" id="4558839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4558844">elem</span><span class="op" id="4558848">,</span>&nbsp;<span class="ident" id="4558850">ok</span>&nbsp;<span class="op" id="4558853">:=</span>&nbsp;<span class="ident" id="4558856">val</span><span class="op" id="4558859">.</span><span class="ident" id="4558860">Recv</span><span class="op" id="4558864">(</span><span class="op" id="4558865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558870">if</span>&nbsp;<span class="op" id="4558873">!</span><span class="ident" id="4558874">ok</span>&nbsp;<span class="op" id="4558877">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558883">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4558892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4558897">oneIteration</span><span class="op" id="4558909">(</span><span class="ident" id="4558910">reflect</span><span class="op" id="4558917">.</span><span class="ident" id="4558918">ValueOf</span><span class="op" id="4558925">(</span><span class="ident" id="4558926">i</span><span class="op" id="4558927">)</span><span class="op" id="4558928">,</span>&nbsp;<span class="ident" id="4558930">elem</span><span class="op" id="4558934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4558938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558942">if</span>&nbsp;<span class="ident" id="4558945">i</span>&nbsp;<span class="op" id="4558947">==</span>&nbsp;<span class="num" id="4558950">0</span>&nbsp;<span class="op" id="4558952">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558957">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4558965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558969">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4558977">case</span>&nbsp;<span class="ident" id="4558982">reflect</span><span class="op" id="4558989">.</span><span class="ident" id="4558990">Invalid</span><span class="op" id="4558997">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4559001">break</span>&nbsp;<span class="comment" id="4559007">//&nbsp;An&nbsp;invalid&nbsp;value&nbsp;is&nbsp;likely&nbsp;a&nbsp;nil&nbsp;map,&nbsp;etc.&nbsp;and&nbsp;acts&nbsp;like&nbsp;an&nbsp;empty&nbsp;map.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4559082">default</span><span class="op" id="4559089">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4559093">s</span><span class="op" id="4559094">.</span><span class="ident" id="4559095">errorf</span><span class="op" id="4559101">(</span><span class="string" id="4559102">&#34;range&nbsp;can&#39;t&nbsp;iterate&nbsp;over&nbsp;%v&#34;</span><span class="op" id="4559131">,</span>&nbsp;<span class="ident" id="4559133">val</span><span class="op" id="4559136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4559139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4559142">if</span>&nbsp;<span class="ident" id="4559145">r</span><span class="op" id="4559146">.</span><span class="ident" id="4559147">ElseList</span>&nbsp;<span class="op" id="4559156">!=</span>&nbsp;<span class="ident" id="4559159">nil</span>&nbsp;<span class="op" id="4559163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4559167">s</span><span class="op" id="4559168">.</span><span class="ident" id="4559169">walk</span><span class="op" id="4559173">(</span><span class="ident" id="4559174">dot</span><span class="op" id="4559177">,</span>&nbsp;<span class="ident" id="4559179">r</span><span class="op" id="4559180">.</span><span class="ident" id="4559181">ElseList</span><span class="op" id="4559189">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4559192">}</span><br>
<span class="lineno"></span><span class="op" id="4559194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4559197">func</span>&nbsp;<span class="op" id="4559202">(</span><span class="ident" id="4559203">s</span>&nbsp;<span class="op" id="4559205">*</span><span class="ident" id="4559206">state</span><span class="op" id="4559211">)</span>&nbsp;<span class="ident" id="4559213">walkTemplate</span><span class="op" id="4559225">(</span><span class="ident" id="4559226">dot</span>&nbsp;<span class="ident" id="4559230">reflect</span><span class="op" id="4559237">.</span><span class="ident" id="4559238">Value</span><span class="op" id="4559243">,</span>&nbsp;<span class="ident" id="4559245">t</span>&nbsp;<span class="op" id="4559247">*</span><span class="ident" id="4559248">parse</span><span class="op" id="4559253">.</span><span class="ident" id="4559254">TemplateNode</span><span class="op" id="4559266">)</span>&nbsp;<span class="op" id="4559268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4559271">s</span><span class="op" id="4559272">.</span><span class="ident" id="4559273">at</span><span class="op" id="4559275">(</span><span class="ident" id="4559276">t</span><span class="op" id="4559277">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4559280">tmpl</span>&nbsp;<span class="op" id="4559285">:=</span>&nbsp;<span class="ident" id="4559288">s</span><span class="op" id="4559289">.</span><span class="ident" id="4559290">tmpl</span><span class="op" id="4559294">.</span><span class="ident" id="4559295">tmpl</span><span class="op" id="4559299">[</span><span class="ident" id="4559300">t</span><span class="op" id="4559301">.</span><span class="ident" id="4559302">Name</span><span class="op" id="4559306">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4559309">if</span>&nbsp;<span class="ident" id="4559312">tmpl</span>&nbsp;<span class="op" id="4559317">==</span>&nbsp;<span class="ident" id="4559320">nil</span>&nbsp;<span class="op" id="4559324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4559328">s</span><span class="op" id="4559329">.</span><span class="ident" id="4559330">errorf</span><span class="op" id="4559336">(</span><span class="string" id="4559337">&#34;template&nbsp;%q&nbsp;not&nbsp;defined&#34;</span><span class="op" id="4559362">,</span>&nbsp;<span class="ident" id="4559364">t</span><span class="op" id="4559365">.</span><span class="ident" id="4559366">Name</span><span class="op" id="4559370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4559373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4559376">//&nbsp;Variables&nbsp;declared&nbsp;by&nbsp;the&nbsp;pipeline&nbsp;persist.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4559424">dot</span>&nbsp;<span class="op" id="4559428">=</span>&nbsp;<span class="ident" id="4559430">s</span><span class="op" id="4559431">.</span><span class="ident" id="4559432">evalPipeline</span><span class="op" id="4559444">(</span><span class="ident" id="4559445">dot</span><span class="op" id="4559448">,</span>&nbsp;<span class="ident" id="4559450">t</span><span class="op" id="4559451">.</span><span class="ident" id="4559452">Pipe</span><span class="op" id="4559456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4559459">newState</span>&nbsp;<span class="op" id="4559468">:=</span>&nbsp;<span class="op" id="4559471">*</span><span class="ident" id="4559472">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4559475">newState</span><span class="op" id="4559483">.</span><span class="ident" id="4559484">tmpl</span>&nbsp;<span class="op" id="4559489">=</span>&nbsp;<span class="ident" id="4559491">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4559497">//&nbsp;No&nbsp;dynamic&nbsp;scoping:&nbsp;template&nbsp;invocations&nbsp;inherit&nbsp;no&nbsp;variables.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4559564">newState</span><span class="op" id="4559572">.</span><span class="ident" id="4559573">vars</span>&nbsp;<span class="op" id="4559578">=</span>&nbsp;<span class="op" id="4559580">[</span><span class="op" id="4559581">]</span><span class="ident" id="4559582">variable</span><span class="op" id="4559590">{</span><span class="op" id="4559591">{</span><span class="string" id="4559592">&#34;$&#34;</span><span class="op" id="4559595">,</span>&nbsp;<span class="ident" id="4559597">dot</span><span class="op" id="4559600">}</span><span class="op" id="4559601">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4559604">newState</span><span class="op" id="4559612">.</span><span class="ident" id="4559613">walk</span><span class="op" id="4559617">(</span><span class="ident" id="4559618">dot</span><span class="op" id="4559621">,</span>&nbsp;<span class="ident" id="4559623">tmpl</span><span class="op" id="4559627">.</span><span class="ident" id="4559628">Root</span><span class="op" id="4559632">)</span><br>
<span class="lineno"></span><span class="op" id="4559634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4559637">//&nbsp;Eval&nbsp;functions&nbsp;evaluate&nbsp;pipelines,&nbsp;commands,&nbsp;and&nbsp;their&nbsp;elements&nbsp;and&nbsp;extract</span><br>
<span class="lineno"></span><span class="comment" id="4559716">//&nbsp;values&nbsp;from&nbsp;the&nbsp;data&nbsp;structure&nbsp;by&nbsp;examining&nbsp;fields,&nbsp;calling&nbsp;methods,&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">320</span><span class="comment" id="4559799">//&nbsp;The&nbsp;printing&nbsp;of&nbsp;those&nbsp;values&nbsp;happens&nbsp;only&nbsp;through&nbsp;walk&nbsp;functions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4559869">//&nbsp;evalPipeline&nbsp;returns&nbsp;the&nbsp;value&nbsp;acquired&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;pipeline.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4559945">//&nbsp;pipeline&nbsp;has&nbsp;a&nbsp;variable&nbsp;declaration,&nbsp;the&nbsp;variable&nbsp;will&nbsp;be&nbsp;pushed&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4560020">//&nbsp;stack.&nbsp;Callers&nbsp;should&nbsp;therefore&nbsp;pop&nbsp;the&nbsp;stack&nbsp;after&nbsp;they&nbsp;are&nbsp;finished</span><br>
<span class="lineno">325</span><span class="comment" id="4560093">//&nbsp;executing&nbsp;commands&nbsp;depending&nbsp;on&nbsp;the&nbsp;pipeline&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4560148">func</span>&nbsp;<span class="op" id="4560153">(</span><span class="ident" id="4560154">s</span>&nbsp;<span class="op" id="4560156">*</span><span class="ident" id="4560157">state</span><span class="op" id="4560162">)</span>&nbsp;<span class="ident" id="4560164">evalPipeline</span><span class="op" id="4560176">(</span><span class="ident" id="4560177">dot</span>&nbsp;<span class="ident" id="4560181">reflect</span><span class="op" id="4560188">.</span><span class="ident" id="4560189">Value</span><span class="op" id="4560194">,</span>&nbsp;<span class="ident" id="4560196">pipe</span>&nbsp;<span class="op" id="4560201">*</span><span class="ident" id="4560202">parse</span><span class="op" id="4560207">.</span><span class="ident" id="4560208">PipeNode</span><span class="op" id="4560216">)</span>&nbsp;<span class="op" id="4560218">(</span><span class="ident" id="4560219">value</span>&nbsp;<span class="ident" id="4560225">reflect</span><span class="op" id="4560232">.</span><span class="ident" id="4560233">Value</span><span class="op" id="4560238">)</span>&nbsp;<span class="op" id="4560240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4560243">if</span>&nbsp;<span class="ident" id="4560246">pipe</span>&nbsp;<span class="op" id="4560251">==</span>&nbsp;<span class="ident" id="4560254">nil</span>&nbsp;<span class="op" id="4560258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4560262">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4560270">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4560273">s</span><span class="op" id="4560274">.</span><span class="ident" id="4560275">at</span><span class="op" id="4560277">(</span><span class="ident" id="4560278">pipe</span><span class="op" id="4560282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4560285">for</span>&nbsp;<span class="ident" id="4560289">_</span><span class="op" id="4560290">,</span>&nbsp;<span class="ident" id="4560292">cmd</span>&nbsp;<span class="op" id="4560296">:=</span>&nbsp;<span class="keyword" id="4560299">range</span>&nbsp;<span class="ident" id="4560305">pipe</span><span class="op" id="4560309">.</span><span class="ident" id="4560310">Cmds</span>&nbsp;<span class="op" id="4560315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4560319">value</span>&nbsp;<span class="op" id="4560325">=</span>&nbsp;<span class="ident" id="4560327">s</span><span class="op" id="4560328">.</span><span class="ident" id="4560329">evalCommand</span><span class="op" id="4560340">(</span><span class="ident" id="4560341">dot</span><span class="op" id="4560344">,</span>&nbsp;<span class="ident" id="4560346">cmd</span><span class="op" id="4560349">,</span>&nbsp;<span class="ident" id="4560351">value</span><span class="op" id="4560356">)</span>&nbsp;<span class="comment" id="4560358">//&nbsp;previous&nbsp;value&nbsp;is&nbsp;this&nbsp;one&#39;s&nbsp;final&nbsp;arg.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4560403">//&nbsp;If&nbsp;the&nbsp;object&nbsp;has&nbsp;type&nbsp;interface{},&nbsp;dig&nbsp;down&nbsp;one&nbsp;level&nbsp;to&nbsp;the&nbsp;thing&nbsp;inside.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4560484">if</span>&nbsp;<span class="ident" id="4560487">value</span><span class="op" id="4560492">.</span><span class="ident" id="4560493">Kind</span><span class="op" id="4560497">(</span><span class="op" id="4560498">)</span>&nbsp;<span class="op" id="4560500">==</span>&nbsp;<span class="ident" id="4560503">reflect</span><span class="op" id="4560510">.</span><span class="ident" id="4560511">Interface</span>&nbsp;<span class="op" id="4560521">&amp;&amp;</span>&nbsp;<span class="ident" id="4560524">value</span><span class="op" id="4560529">.</span><span class="ident" id="4560530">Type</span><span class="op" id="4560534">(</span><span class="op" id="4560535">)</span><span class="op" id="4560536">.</span><span class="ident" id="4560537">NumMethod</span><span class="op" id="4560546">(</span><span class="op" id="4560547">)</span>&nbsp;<span class="op" id="4560549">==</span>&nbsp;<span class="num" id="4560552">0</span>&nbsp;<span class="op" id="4560554">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4560559">value</span>&nbsp;<span class="op" id="4560565">=</span>&nbsp;<span class="ident" id="4560567">reflect</span><span class="op" id="4560574">.</span><span class="ident" id="4560575">ValueOf</span><span class="op" id="4560582">(</span><span class="ident" id="4560583">value</span><span class="op" id="4560588">.</span><span class="ident" id="4560589">Interface</span><span class="op" id="4560598">(</span><span class="op" id="4560599">)</span><span class="op" id="4560600">)</span>&nbsp;<span class="comment" id="4560602">//&nbsp;lovely!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4560615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4560618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4560621">for</span>&nbsp;<span class="ident" id="4560625">_</span><span class="op" id="4560626">,</span>&nbsp;<span class="ident" id="4560628">variable</span>&nbsp;<span class="op" id="4560637">:=</span>&nbsp;<span class="keyword" id="4560640">range</span>&nbsp;<span class="ident" id="4560646">pipe</span><span class="op" id="4560650">.</span><span class="ident" id="4560651">Decl</span>&nbsp;<span class="op" id="4560656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4560660">s</span><span class="op" id="4560661">.</span><span class="ident" id="4560662">push</span><span class="op" id="4560666">(</span><span class="ident" id="4560667">variable</span><span class="op" id="4560675">.</span><span class="ident" id="4560676">Ident</span><span class="op" id="4560681">[</span><span class="num" id="4560682">0</span><span class="op" id="4560683">]</span><span class="op" id="4560684">,</span>&nbsp;<span class="ident" id="4560686">value</span><span class="op" id="4560691">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4560694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4560697">return</span>&nbsp;<span class="ident" id="4560704">value</span><br>
<span class="lineno"></span><span class="op" id="4560710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4560713">func</span>&nbsp;<span class="op" id="4560718">(</span><span class="ident" id="4560719">s</span>&nbsp;<span class="op" id="4560721">*</span><span class="ident" id="4560722">state</span><span class="op" id="4560727">)</span>&nbsp;<span class="ident" id="4560729">notAFunction</span><span class="op" id="4560741">(</span><span class="ident" id="4560742">args</span>&nbsp;<span class="op" id="4560747">[</span><span class="op" id="4560748">]</span><span class="ident" id="4560749">parse</span><span class="op" id="4560754">.</span><span class="ident" id="4560755">Node</span><span class="op" id="4560759">,</span>&nbsp;<span class="ident" id="4560761">final</span>&nbsp;<span class="ident" id="4560767">reflect</span><span class="op" id="4560774">.</span><span class="ident" id="4560775">Value</span><span class="op" id="4560780">)</span>&nbsp;<span class="op" id="4560782">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4560785">if</span>&nbsp;<span class="builtinfunc" id="4560788">len</span><span class="op" id="4560791">(</span><span class="ident" id="4560792">args</span><span class="op" id="4560796">)</span>&nbsp;<span class="op" id="4560798">&gt;</span>&nbsp;<span class="num" id="4560800">1</span>&nbsp;<span class="op" id="4560802">||</span>&nbsp;<span class="ident" id="4560805">final</span><span class="op" id="4560810">.</span><span class="ident" id="4560811">IsValid</span><span class="op" id="4560818">(</span><span class="op" id="4560819">)</span>&nbsp;<span class="op" id="4560821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4560825">s</span><span class="op" id="4560826">.</span><span class="ident" id="4560827">errorf</span><span class="op" id="4560833">(</span><span class="string" id="4560834">&#34;can&#39;t&nbsp;give&nbsp;argument&nbsp;to&nbsp;non-function&nbsp;%s&#34;</span><span class="op" id="4560874">,</span>&nbsp;<span class="ident" id="4560876">args</span><span class="op" id="4560880">[</span><span class="num" id="4560881">0</span><span class="op" id="4560882">]</span><span class="op" id="4560883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4560886">}</span><br>
<span class="lineno"></span><span class="op" id="4560888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="4560891">func</span>&nbsp;<span class="op" id="4560896">(</span><span class="ident" id="4560897">s</span>&nbsp;<span class="op" id="4560899">*</span><span class="ident" id="4560900">state</span><span class="op" id="4560905">)</span>&nbsp;<span class="ident" id="4560907">evalCommand</span><span class="op" id="4560918">(</span><span class="ident" id="4560919">dot</span>&nbsp;<span class="ident" id="4560923">reflect</span><span class="op" id="4560930">.</span><span class="ident" id="4560931">Value</span><span class="op" id="4560936">,</span>&nbsp;<span class="ident" id="4560938">cmd</span>&nbsp;<span class="op" id="4560942">*</span><span class="ident" id="4560943">parse</span><span class="op" id="4560948">.</span><span class="ident" id="4560949">CommandNode</span><span class="op" id="4560960">,</span>&nbsp;<span class="ident" id="4560962">final</span>&nbsp;<span class="ident" id="4560968">reflect</span><span class="op" id="4560975">.</span><span class="ident" id="4560976">Value</span><span class="op" id="4560981">)</span>&nbsp;<span class="ident" id="4560983">reflect</span><span class="op" id="4560990">.</span><span class="ident" id="4560991">Value</span>&nbsp;<span class="op" id="4560997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4561000">firstWord</span>&nbsp;<span class="op" id="4561010">:=</span>&nbsp;<span class="ident" id="4561013">cmd</span><span class="op" id="4561016">.</span><span class="ident" id="4561017">Args</span><span class="op" id="4561021">[</span><span class="num" id="4561022">0</span><span class="op" id="4561023">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561026">switch</span>&nbsp;<span class="ident" id="4561033">n</span>&nbsp;<span class="op" id="4561035">:=</span>&nbsp;<span class="ident" id="4561038">firstWord</span><span class="op" id="4561047">.</span><span class="op" id="4561048">(</span><span class="keyword" id="4561049">type</span><span class="op" id="4561053">)</span>&nbsp;<span class="op" id="4561055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561058">case</span>&nbsp;<span class="op" id="4561063">*</span><span class="ident" id="4561064">parse</span><span class="op" id="4561069">.</span><span class="ident" id="4561070">FieldNode</span><span class="op" id="4561079">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561083">return</span>&nbsp;<span class="ident" id="4561090">s</span><span class="op" id="4561091">.</span><span class="ident" id="4561092">evalFieldNode</span><span class="op" id="4561105">(</span><span class="ident" id="4561106">dot</span><span class="op" id="4561109">,</span>&nbsp;<span class="ident" id="4561111">n</span><span class="op" id="4561112">,</span>&nbsp;<span class="ident" id="4561114">cmd</span><span class="op" id="4561117">.</span><span class="ident" id="4561118">Args</span><span class="op" id="4561122">,</span>&nbsp;<span class="ident" id="4561124">final</span><span class="op" id="4561129">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561132">case</span>&nbsp;<span class="op" id="4561137">*</span><span class="ident" id="4561138">parse</span><span class="op" id="4561143">.</span><span class="ident" id="4561144">ChainNode</span><span class="op" id="4561153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561157">return</span>&nbsp;<span class="ident" id="4561164">s</span><span class="op" id="4561165">.</span><span class="ident" id="4561166">evalChainNode</span><span class="op" id="4561179">(</span><span class="ident" id="4561180">dot</span><span class="op" id="4561183">,</span>&nbsp;<span class="ident" id="4561185">n</span><span class="op" id="4561186">,</span>&nbsp;<span class="ident" id="4561188">cmd</span><span class="op" id="4561191">.</span><span class="ident" id="4561192">Args</span><span class="op" id="4561196">,</span>&nbsp;<span class="ident" id="4561198">final</span><span class="op" id="4561203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561206">case</span>&nbsp;<span class="op" id="4561211">*</span><span class="ident" id="4561212">parse</span><span class="op" id="4561217">.</span><span class="ident" id="4561218">IdentifierNode</span><span class="op" id="4561232">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4561236">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561261">return</span>&nbsp;<span class="ident" id="4561268">s</span><span class="op" id="4561269">.</span><span class="ident" id="4561270">evalFunction</span><span class="op" id="4561282">(</span><span class="ident" id="4561283">dot</span><span class="op" id="4561286">,</span>&nbsp;<span class="ident" id="4561288">n</span><span class="op" id="4561289">,</span>&nbsp;<span class="ident" id="4561291">cmd</span><span class="op" id="4561294">,</span>&nbsp;<span class="ident" id="4561296">cmd</span><span class="op" id="4561299">.</span><span class="ident" id="4561300">Args</span><span class="op" id="4561304">,</span>&nbsp;<span class="ident" id="4561306">final</span><span class="op" id="4561311">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561314">case</span>&nbsp;<span class="op" id="4561319">*</span><span class="ident" id="4561320">parse</span><span class="op" id="4561325">.</span><span class="ident" id="4561326">PipeNode</span><span class="op" id="4561334">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4561338">//&nbsp;Parenthesized&nbsp;pipeline.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;all&nbsp;inside&nbsp;the&nbsp;pipeline;&nbsp;final&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561428">return</span>&nbsp;<span class="ident" id="4561435">s</span><span class="op" id="4561436">.</span><span class="ident" id="4561437">evalPipeline</span><span class="op" id="4561449">(</span><span class="ident" id="4561450">dot</span><span class="op" id="4561453">,</span>&nbsp;<span class="ident" id="4561455">n</span><span class="op" id="4561456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561459">case</span>&nbsp;<span class="op" id="4561464">*</span><span class="ident" id="4561465">parse</span><span class="op" id="4561470">.</span><span class="ident" id="4561471">VariableNode</span><span class="op" id="4561483">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561487">return</span>&nbsp;<span class="ident" id="4561494">s</span><span class="op" id="4561495">.</span><span class="ident" id="4561496">evalVariableNode</span><span class="op" id="4561512">(</span><span class="ident" id="4561513">dot</span><span class="op" id="4561516">,</span>&nbsp;<span class="ident" id="4561518">n</span><span class="op" id="4561519">,</span>&nbsp;<span class="ident" id="4561521">cmd</span><span class="op" id="4561524">.</span><span class="ident" id="4561525">Args</span><span class="op" id="4561529">,</span>&nbsp;<span class="ident" id="4561531">final</span><span class="op" id="4561536">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4561539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4561542">s</span><span class="op" id="4561543">.</span><span class="ident" id="4561544">at</span><span class="op" id="4561546">(</span><span class="ident" id="4561547">firstWord</span><span class="op" id="4561556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4561559">s</span><span class="op" id="4561560">.</span><span class="ident" id="4561561">notAFunction</span><span class="op" id="4561573">(</span><span class="ident" id="4561574">cmd</span><span class="op" id="4561577">.</span><span class="ident" id="4561578">Args</span><span class="op" id="4561582">,</span>&nbsp;<span class="ident" id="4561584">final</span><span class="op" id="4561589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561592">switch</span>&nbsp;<span class="ident" id="4561599">word</span>&nbsp;<span class="op" id="4561604">:=</span>&nbsp;<span class="ident" id="4561607">firstWord</span><span class="op" id="4561616">.</span><span class="op" id="4561617">(</span><span class="keyword" id="4561618">type</span><span class="op" id="4561622">)</span>&nbsp;<span class="op" id="4561624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561627">case</span>&nbsp;<span class="op" id="4561632">*</span><span class="ident" id="4561633">parse</span><span class="op" id="4561638">.</span><span class="ident" id="4561639">BoolNode</span><span class="op" id="4561647">:</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561651">return</span>&nbsp;<span class="ident" id="4561658">reflect</span><span class="op" id="4561665">.</span><span class="ident" id="4561666">ValueOf</span><span class="op" id="4561673">(</span><span class="ident" id="4561674">word</span><span class="op" id="4561678">.</span><span class="ident" id="4561679">True</span><span class="op" id="4561683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561686">case</span>&nbsp;<span class="op" id="4561691">*</span><span class="ident" id="4561692">parse</span><span class="op" id="4561697">.</span><span class="ident" id="4561698">DotNode</span><span class="op" id="4561705">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561709">return</span>&nbsp;<span class="ident" id="4561716">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561721">case</span>&nbsp;<span class="op" id="4561726">*</span><span class="ident" id="4561727">parse</span><span class="op" id="4561732">.</span><span class="ident" id="4561733">NilNode</span><span class="op" id="4561740">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4561744">s</span><span class="op" id="4561745">.</span><span class="ident" id="4561746">errorf</span><span class="op" id="4561752">(</span><span class="string" id="4561753">&#34;nil&nbsp;is&nbsp;not&nbsp;a&nbsp;command&#34;</span><span class="op" id="4561775">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561778">case</span>&nbsp;<span class="op" id="4561783">*</span><span class="ident" id="4561784">parse</span><span class="op" id="4561789">.</span><span class="ident" id="4561790">NumberNode</span><span class="op" id="4561800">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561804">return</span>&nbsp;<span class="ident" id="4561811">s</span><span class="op" id="4561812">.</span><span class="ident" id="4561813">idealConstant</span><span class="op" id="4561826">(</span><span class="ident" id="4561827">word</span><span class="op" id="4561831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561834">case</span>&nbsp;<span class="op" id="4561839">*</span><span class="ident" id="4561840">parse</span><span class="op" id="4561845">.</span><span class="ident" id="4561846">StringNode</span><span class="op" id="4561856">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4561860">return</span>&nbsp;<span class="ident" id="4561867">reflect</span><span class="op" id="4561874">.</span><span class="ident" id="4561875">ValueOf</span><span class="op" id="4561882">(</span><span class="ident" id="4561883">word</span><span class="op" id="4561887">.</span><span class="ident" id="4561888">Text</span><span class="op" id="4561892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4561895">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4561898">s</span><span class="op" id="4561899">.</span><span class="ident" id="4561900">errorf</span><span class="op" id="4561906">(</span><span class="string" id="4561907">&#34;can&#39;t&nbsp;evaluate&nbsp;command&nbsp;%q&#34;</span><span class="op" id="4561934">,</span>&nbsp;<span class="ident" id="4561936">firstWord</span><span class="op" id="4561945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4561948">panic</span><span class="op" id="4561953">(</span><span class="string" id="4561954">&#34;not&nbsp;reached&#34;</span><span class="op" id="4561967">)</span><br>
<span class="lineno"></span><span class="op" id="4561969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4561972">//&nbsp;idealConstant&nbsp;is&nbsp;called&nbsp;to&nbsp;return&nbsp;the&nbsp;value&nbsp;of&nbsp;a&nbsp;number&nbsp;in&nbsp;a&nbsp;context&nbsp;where</span><br>
<span class="lineno">385</span><span class="comment" id="4562050">//&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;syntax&nbsp;of&nbsp;the&nbsp;number&nbsp;tells&nbsp;us</span><br>
<span class="lineno"></span><span class="comment" id="4562125">//&nbsp;its&nbsp;type,&nbsp;and&nbsp;we&nbsp;use&nbsp;Go&nbsp;rules&nbsp;to&nbsp;resolve.&nbsp;&nbsp;Note&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;thing&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4562202">//&nbsp;a&nbsp;uint&nbsp;ideal&nbsp;constant&nbsp;in&nbsp;this&nbsp;situation&nbsp;-&nbsp;the&nbsp;value&nbsp;must&nbsp;be&nbsp;of&nbsp;int&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4562278">func</span>&nbsp;<span class="op" id="4562283">(</span><span class="ident" id="4562284">s</span>&nbsp;<span class="op" id="4562286">*</span><span class="ident" id="4562287">state</span><span class="op" id="4562292">)</span>&nbsp;<span class="ident" id="4562294">idealConstant</span><span class="op" id="4562307">(</span><span class="ident" id="4562308">constant</span>&nbsp;<span class="op" id="4562317">*</span><span class="ident" id="4562318">parse</span><span class="op" id="4562323">.</span><span class="ident" id="4562324">NumberNode</span><span class="op" id="4562334">)</span>&nbsp;<span class="ident" id="4562336">reflect</span><span class="op" id="4562343">.</span><span class="ident" id="4562344">Value</span>&nbsp;<span class="op" id="4562350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4562353">//&nbsp;These&nbsp;are&nbsp;ideal&nbsp;constants&nbsp;but&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4562410">//&nbsp;and&nbsp;we&nbsp;have&nbsp;no&nbsp;context.&nbsp;&nbsp;(If&nbsp;it&nbsp;was&nbsp;a&nbsp;method&nbsp;argument,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4562469">//&nbsp;we&#39;d&nbsp;know&nbsp;what&nbsp;we&nbsp;need.)&nbsp;The&nbsp;syntax&nbsp;guides&nbsp;us&nbsp;to&nbsp;some&nbsp;extent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4562535">s</span><span class="op" id="4562536">.</span><span class="ident" id="4562537">at</span><span class="op" id="4562539">(</span><span class="ident" id="4562540">constant</span><span class="op" id="4562548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4562551">switch</span>&nbsp;<span class="op" id="4562558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4562561">case</span>&nbsp;<span class="ident" id="4562566">constant</span><span class="op" id="4562574">.</span><span class="ident" id="4562575">IsComplex</span><span class="op" id="4562584">:</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4562588">return</span>&nbsp;<span class="ident" id="4562595">reflect</span><span class="op" id="4562602">.</span><span class="ident" id="4562603">ValueOf</span><span class="op" id="4562610">(</span><span class="ident" id="4562611">constant</span><span class="op" id="4562619">.</span><span class="ident" id="4562620">Complex128</span><span class="op" id="4562630">)</span>&nbsp;<span class="comment" id="4562632">//&nbsp;incontrovertible.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4562654">case</span>&nbsp;<span class="ident" id="4562659">constant</span><span class="op" id="4562667">.</span><span class="ident" id="4562668">IsFloat</span>&nbsp;<span class="op" id="4562676">&amp;&amp;</span>&nbsp;<span class="op" id="4562679">!</span><span class="ident" id="4562680">isHexConstant</span><span class="op" id="4562693">(</span><span class="ident" id="4562694">constant</span><span class="op" id="4562702">.</span><span class="ident" id="4562703">Text</span><span class="op" id="4562707">)</span>&nbsp;<span class="op" id="4562709">&amp;&amp;</span>&nbsp;<span class="ident" id="4562712">strings</span><span class="op" id="4562719">.</span><span class="ident" id="4562720">IndexAny</span><span class="op" id="4562728">(</span><span class="ident" id="4562729">constant</span><span class="op" id="4562737">.</span><span class="ident" id="4562738">Text</span><span class="op" id="4562742">,</span>&nbsp;<span class="string" id="4562744">&#34;.eE&#34;</span><span class="op" id="4562749">)</span>&nbsp;<span class="op" id="4562751">&gt;=</span>&nbsp;<span class="num" id="4562754">0</span><span class="op" id="4562755">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4562759">return</span>&nbsp;<span class="ident" id="4562766">reflect</span><span class="op" id="4562773">.</span><span class="ident" id="4562774">ValueOf</span><span class="op" id="4562781">(</span><span class="ident" id="4562782">constant</span><span class="op" id="4562790">.</span><span class="ident" id="4562791">Float64</span><span class="op" id="4562798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4562801">case</span>&nbsp;<span class="ident" id="4562806">constant</span><span class="op" id="4562814">.</span><span class="ident" id="4562815">IsInt</span><span class="op" id="4562820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4562824">n</span>&nbsp;<span class="op" id="4562826">:=</span>&nbsp;<span class="builtintype" id="4562829">int</span><span class="op" id="4562832">(</span><span class="ident" id="4562833">constant</span><span class="op" id="4562841">.</span><span class="ident" id="4562842">Int64</span><span class="op" id="4562847">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4562851">if</span>&nbsp;<span class="ident" id="4562854">int64</span><span class="op" id="4562859">(</span><span class="ident" id="4562860">n</span><span class="op" id="4562861">)</span>&nbsp;<span class="op" id="4562863">!=</span>&nbsp;<span class="ident" id="4562866">constant</span><span class="op" id="4562874">.</span><span class="ident" id="4562875">Int64</span>&nbsp;<span class="op" id="4562881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4562886">s</span><span class="op" id="4562887">.</span><span class="ident" id="4562888">errorf</span><span class="op" id="4562894">(</span><span class="string" id="4562895">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="4562913">,</span>&nbsp;<span class="ident" id="4562915">constant</span><span class="op" id="4562923">.</span><span class="ident" id="4562924">Text</span><span class="op" id="4562928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4562932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4562936">return</span>&nbsp;<span class="ident" id="4562943">reflect</span><span class="op" id="4562950">.</span><span class="ident" id="4562951">ValueOf</span><span class="op" id="4562958">(</span><span class="ident" id="4562959">n</span><span class="op" id="4562960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4562963">case</span>&nbsp;<span class="ident" id="4562968">constant</span><span class="op" id="4562976">.</span><span class="ident" id="4562977">IsUint</span><span class="op" id="4562983">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4562987">s</span><span class="op" id="4562988">.</span><span class="ident" id="4562989">errorf</span><span class="op" id="4562995">(</span><span class="string" id="4562996">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="4563014">,</span>&nbsp;<span class="ident" id="4563016">constant</span><span class="op" id="4563024">.</span><span class="ident" id="4563025">Text</span><span class="op" id="4563029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4563032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4563035">return</span>&nbsp;<span class="ident" id="4563042">zero</span><br>
<span class="lineno"></span><span class="op" id="4563047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="4563050">func</span>&nbsp;<span class="ident" id="4563055">isHexConstant</span><span class="op" id="4563068">(</span><span class="ident" id="4563069">s</span>&nbsp;<span class="builtintype" id="4563071">string</span><span class="op" id="4563077">)</span>&nbsp;<span class="builtintype" id="4563079">bool</span>&nbsp;<span class="op" id="4563084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4563087">return</span>&nbsp;<span class="builtinfunc" id="4563094">len</span><span class="op" id="4563097">(</span><span class="ident" id="4563098">s</span><span class="op" id="4563099">)</span>&nbsp;<span class="op" id="4563101">&gt;</span>&nbsp;<span class="num" id="4563103">2</span>&nbsp;<span class="op" id="4563105">&amp;&amp;</span>&nbsp;<span class="ident" id="4563108">s</span><span class="op" id="4563109">[</span><span class="num" id="4563110">0</span><span class="op" id="4563111">]</span>&nbsp;<span class="op" id="4563113">==</span>&nbsp;<span class="string" id="4563116">&#39;0&#39;</span>&nbsp;<span class="op" id="4563120">&amp;&amp;</span>&nbsp;<span class="op" id="4563123">(</span><span class="ident" id="4563124">s</span><span class="op" id="4563125">[</span><span class="num" id="4563126">1</span><span class="op" id="4563127">]</span>&nbsp;<span class="op" id="4563129">==</span>&nbsp;<span class="string" id="4563132">&#39;x&#39;</span>&nbsp;<span class="op" id="4563136">||</span>&nbsp;<span class="ident" id="4563139">s</span><span class="op" id="4563140">[</span><span class="num" id="4563141">1</span><span class="op" id="4563142">]</span>&nbsp;<span class="op" id="4563144">==</span>&nbsp;<span class="string" id="4563147">&#39;X&#39;</span><span class="op" id="4563150">)</span><br>
<span class="lineno"></span><span class="op" id="4563152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4563155">func</span>&nbsp;<span class="op" id="4563160">(</span><span class="ident" id="4563161">s</span>&nbsp;<span class="op" id="4563163">*</span><span class="ident" id="4563164">state</span><span class="op" id="4563169">)</span>&nbsp;<span class="ident" id="4563171">evalFieldNode</span><span class="op" id="4563184">(</span><span class="ident" id="4563185">dot</span>&nbsp;<span class="ident" id="4563189">reflect</span><span class="op" id="4563196">.</span><span class="ident" id="4563197">Value</span><span class="op" id="4563202">,</span>&nbsp;<span class="ident" id="4563204">field</span>&nbsp;<span class="op" id="4563210">*</span><span class="ident" id="4563211">parse</span><span class="op" id="4563216">.</span><span class="ident" id="4563217">FieldNode</span><span class="op" id="4563226">,</span>&nbsp;<span class="ident" id="4563228">args</span>&nbsp;<span class="op" id="4563233">[</span><span class="op" id="4563234">]</span><span class="ident" id="4563235">parse</span><span class="op" id="4563240">.</span><span class="ident" id="4563241">Node</span><span class="op" id="4563245">,</span>&nbsp;<span class="ident" id="4563247">final</span>&nbsp;<span class="ident" id="4563253">reflect</span><span class="op" id="4563260">.</span><span class="ident" id="4563261">Value</span><span class="op" id="4563266">)</span>&nbsp;<span class="ident" id="4563268">reflect</span><span class="op" id="4563275">.</span><span class="ident" id="4563276">Value</span>&nbsp;<span class="op" id="4563282">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4563285">s</span><span class="op" id="4563286">.</span><span class="ident" id="4563287">at</span><span class="op" id="4563289">(</span><span class="ident" id="4563290">field</span><span class="op" id="4563295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4563298">return</span>&nbsp;<span class="ident" id="4563305">s</span><span class="op" id="4563306">.</span><span class="ident" id="4563307">evalFieldChain</span><span class="op" id="4563321">(</span><span class="ident" id="4563322">dot</span><span class="op" id="4563325">,</span>&nbsp;<span class="ident" id="4563327">dot</span><span class="op" id="4563330">,</span>&nbsp;<span class="ident" id="4563332">field</span><span class="op" id="4563337">,</span>&nbsp;<span class="ident" id="4563339">field</span><span class="op" id="4563344">.</span><span class="ident" id="4563345">Ident</span><span class="op" id="4563350">,</span>&nbsp;<span class="ident" id="4563352">args</span><span class="op" id="4563356">,</span>&nbsp;<span class="ident" id="4563358">final</span><span class="op" id="4563363">)</span><br>
<span class="lineno"></span><span class="op" id="4563365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4563368">func</span>&nbsp;<span class="op" id="4563373">(</span><span class="ident" id="4563374">s</span>&nbsp;<span class="op" id="4563376">*</span><span class="ident" id="4563377">state</span><span class="op" id="4563382">)</span>&nbsp;<span class="ident" id="4563384">evalChainNode</span><span class="op" id="4563397">(</span><span class="ident" id="4563398">dot</span>&nbsp;<span class="ident" id="4563402">reflect</span><span class="op" id="4563409">.</span><span class="ident" id="4563410">Value</span><span class="op" id="4563415">,</span>&nbsp;<span class="ident" id="4563417">chain</span>&nbsp;<span class="op" id="4563423">*</span><span class="ident" id="4563424">parse</span><span class="op" id="4563429">.</span><span class="ident" id="4563430">ChainNode</span><span class="op" id="4563439">,</span>&nbsp;<span class="ident" id="4563441">args</span>&nbsp;<span class="op" id="4563446">[</span><span class="op" id="4563447">]</span><span class="ident" id="4563448">parse</span><span class="op" id="4563453">.</span><span class="ident" id="4563454">Node</span><span class="op" id="4563458">,</span>&nbsp;<span class="ident" id="4563460">final</span>&nbsp;<span class="ident" id="4563466">reflect</span><span class="op" id="4563473">.</span><span class="ident" id="4563474">Value</span><span class="op" id="4563479">)</span>&nbsp;<span class="ident" id="4563481">reflect</span><span class="op" id="4563488">.</span><span class="ident" id="4563489">Value</span>&nbsp;<span class="op" id="4563495">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4563498">s</span><span class="op" id="4563499">.</span><span class="ident" id="4563500">at</span><span class="op" id="4563502">(</span><span class="ident" id="4563503">chain</span><span class="op" id="4563508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4563511">//&nbsp;(pipe).Field1.Field2&nbsp;has&nbsp;pipe&nbsp;as&nbsp;.Node,&nbsp;fields&nbsp;as&nbsp;.Field.&nbsp;Eval&nbsp;the&nbsp;pipeline,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4563609">pipe</span>&nbsp;<span class="op" id="4563614">:=</span>&nbsp;<span class="ident" id="4563617">s</span><span class="op" id="4563618">.</span><span class="ident" id="4563619">evalArg</span><span class="op" id="4563626">(</span><span class="ident" id="4563627">dot</span><span class="op" id="4563630">,</span>&nbsp;<span class="ident" id="4563632">nil</span><span class="op" id="4563635">,</span>&nbsp;<span class="ident" id="4563637">chain</span><span class="op" id="4563642">.</span><span class="ident" id="4563643">Node</span><span class="op" id="4563647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4563650">if</span>&nbsp;<span class="builtinfunc" id="4563653">len</span><span class="op" id="4563656">(</span><span class="ident" id="4563657">chain</span><span class="op" id="4563662">.</span><span class="ident" id="4563663">Field</span><span class="op" id="4563668">)</span>&nbsp;<span class="op" id="4563670">==</span>&nbsp;<span class="num" id="4563673">0</span>&nbsp;<span class="op" id="4563675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4563679">s</span><span class="op" id="4563680">.</span><span class="ident" id="4563681">errorf</span><span class="op" id="4563687">(</span><span class="string" id="4563688">&#34;internal&nbsp;error:&nbsp;no&nbsp;fields&nbsp;in&nbsp;evalChainNode&#34;</span><span class="op" id="4563732">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4563735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4563738">return</span>&nbsp;<span class="ident" id="4563745">s</span><span class="op" id="4563746">.</span><span class="ident" id="4563747">evalFieldChain</span><span class="op" id="4563761">(</span><span class="ident" id="4563762">dot</span><span class="op" id="4563765">,</span>&nbsp;<span class="ident" id="4563767">pipe</span><span class="op" id="4563771">,</span>&nbsp;<span class="ident" id="4563773">chain</span><span class="op" id="4563778">,</span>&nbsp;<span class="ident" id="4563780">chain</span><span class="op" id="4563785">.</span><span class="ident" id="4563786">Field</span><span class="op" id="4563791">,</span>&nbsp;<span class="ident" id="4563793">args</span><span class="op" id="4563797">,</span>&nbsp;<span class="ident" id="4563799">final</span><span class="op" id="4563804">)</span><br>
<span class="lineno"></span><span class="op" id="4563806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4563809">func</span>&nbsp;<span class="op" id="4563814">(</span><span class="ident" id="4563815">s</span>&nbsp;<span class="op" id="4563817">*</span><span class="ident" id="4563818">state</span><span class="op" id="4563823">)</span>&nbsp;<span class="ident" id="4563825">evalVariableNode</span><span class="op" id="4563841">(</span><span class="ident" id="4563842">dot</span>&nbsp;<span class="ident" id="4563846">reflect</span><span class="op" id="4563853">.</span><span class="ident" id="4563854">Value</span><span class="op" id="4563859">,</span>&nbsp;<span class="ident" id="4563861">variable</span>&nbsp;<span class="op" id="4563870">*</span><span class="ident" id="4563871">parse</span><span class="op" id="4563876">.</span><span class="ident" id="4563877">VariableNode</span><span class="op" id="4563889">,</span>&nbsp;<span class="ident" id="4563891">args</span>&nbsp;<span class="op" id="4563896">[</span><span class="op" id="4563897">]</span><span class="ident" id="4563898">parse</span><span class="op" id="4563903">.</span><span class="ident" id="4563904">Node</span><span class="op" id="4563908">,</span>&nbsp;<span class="ident" id="4563910">final</span>&nbsp;<span class="ident" id="4563916">reflect</span><span class="op" id="4563923">.</span><span class="ident" id="4563924">Value</span><span class="op" id="4563929">)</span>&nbsp;<span class="ident" id="4563931">reflect</span><span class="op" id="4563938">.</span><span class="ident" id="4563939">Value</span>&nbsp;<span class="op" id="4563945">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4563948">//&nbsp;$x.Field&nbsp;has&nbsp;$x&nbsp;as&nbsp;the&nbsp;first&nbsp;ident,&nbsp;Field&nbsp;as&nbsp;the&nbsp;second.&nbsp;Eval&nbsp;the&nbsp;var,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4564040">s</span><span class="op" id="4564041">.</span><span class="ident" id="4564042">at</span><span class="op" id="4564044">(</span><span class="ident" id="4564045">variable</span><span class="op" id="4564053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4564056">value</span>&nbsp;<span class="op" id="4564062">:=</span>&nbsp;<span class="ident" id="4564065">s</span><span class="op" id="4564066">.</span><span class="ident" id="4564067">varValue</span><span class="op" id="4564075">(</span><span class="ident" id="4564076">variable</span><span class="op" id="4564084">.</span><span class="ident" id="4564085">Ident</span><span class="op" id="4564090">[</span><span class="num" id="4564091">0</span><span class="op" id="4564092">]</span><span class="op" id="4564093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4564096">if</span>&nbsp;<span class="builtinfunc" id="4564099">len</span><span class="op" id="4564102">(</span><span class="ident" id="4564103">variable</span><span class="op" id="4564111">.</span><span class="ident" id="4564112">Ident</span><span class="op" id="4564117">)</span>&nbsp;<span class="op" id="4564119">==</span>&nbsp;<span class="num" id="4564122">1</span>&nbsp;<span class="op" id="4564124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4564128">s</span><span class="op" id="4564129">.</span><span class="ident" id="4564130">notAFunction</span><span class="op" id="4564142">(</span><span class="ident" id="4564143">args</span><span class="op" id="4564147">,</span>&nbsp;<span class="ident" id="4564149">final</span><span class="op" id="4564154">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4564158">return</span>&nbsp;<span class="ident" id="4564165">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4564172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4564175">return</span>&nbsp;<span class="ident" id="4564182">s</span><span class="op" id="4564183">.</span><span class="ident" id="4564184">evalFieldChain</span><span class="op" id="4564198">(</span><span class="ident" id="4564199">dot</span><span class="op" id="4564202">,</span>&nbsp;<span class="ident" id="4564204">value</span><span class="op" id="4564209">,</span>&nbsp;<span class="ident" id="4564211">variable</span><span class="op" id="4564219">,</span>&nbsp;<span class="ident" id="4564221">variable</span><span class="op" id="4564229">.</span><span class="ident" id="4564230">Ident</span><span class="op" id="4564235">[</span><span class="num" id="4564236">1</span><span class="op" id="4564237">:</span><span class="op" id="4564238">]</span><span class="op" id="4564239">,</span>&nbsp;<span class="ident" id="4564241">args</span><span class="op" id="4564245">,</span>&nbsp;<span class="ident" id="4564247">final</span><span class="op" id="4564252">)</span><br>
<span class="lineno"></span><span class="op" id="4564254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="4564257">//&nbsp;evalFieldChain&nbsp;evaluates&nbsp;.X.Y.Z&nbsp;possibly&nbsp;followed&nbsp;by&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="4564324">//&nbsp;dot&nbsp;is&nbsp;the&nbsp;environment&nbsp;in&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;arguments,&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="4564388">//&nbsp;receiver&nbsp;is&nbsp;the&nbsp;value&nbsp;being&nbsp;walked&nbsp;along&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="4564443">func</span>&nbsp;<span class="op" id="4564448">(</span><span class="ident" id="4564449">s</span>&nbsp;<span class="op" id="4564451">*</span><span class="ident" id="4564452">state</span><span class="op" id="4564457">)</span>&nbsp;<span class="ident" id="4564459">evalFieldChain</span><span class="op" id="4564473">(</span><span class="ident" id="4564474">dot</span><span class="op" id="4564477">,</span>&nbsp;<span class="ident" id="4564479">receiver</span>&nbsp;<span class="ident" id="4564488">reflect</span><span class="op" id="4564495">.</span><span class="ident" id="4564496">Value</span><span class="op" id="4564501">,</span>&nbsp;<span class="ident" id="4564503">node</span>&nbsp;<span class="ident" id="4564508">parse</span><span class="op" id="4564513">.</span><span class="ident" id="4564514">Node</span><span class="op" id="4564518">,</span>&nbsp;<span class="ident" id="4564520">ident</span>&nbsp;<span class="op" id="4564526">[</span><span class="op" id="4564527">]</span><span class="builtintype" id="4564528">string</span><span class="op" id="4564534">,</span>&nbsp;<span class="ident" id="4564536">args</span>&nbsp;<span class="op" id="4564541">[</span><span class="op" id="4564542">]</span><span class="ident" id="4564543">parse</span><span class="op" id="4564548">.</span><span class="ident" id="4564549">Node</span><span class="op" id="4564553">,</span>&nbsp;<span class="ident" id="4564555">final</span>&nbsp;<span class="ident" id="4564561">reflect</span><span class="op" id="4564568">.</span><span class="ident" id="4564569">Value</span><span class="op" id="4564574">)</span>&nbsp;<span class="ident" id="4564576">reflect</span><span class="op" id="4564583">.</span><span class="ident" id="4564584">Value</span>&nbsp;<span class="op" id="4564590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4564593">n</span>&nbsp;<span class="op" id="4564595">:=</span>&nbsp;<span class="builtinfunc" id="4564598">len</span><span class="op" id="4564601">(</span><span class="ident" id="4564602">ident</span><span class="op" id="4564607">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4564610">for</span>&nbsp;<span class="ident" id="4564614">i</span>&nbsp;<span class="op" id="4564616">:=</span>&nbsp;<span class="num" id="4564619">0</span><span class="op" id="4564620">;</span>&nbsp;<span class="ident" id="4564622">i</span>&nbsp;<span class="op" id="4564624">&lt;</span>&nbsp;<span class="ident" id="4564626">n</span><span class="op" id="4564627">-</span><span class="num" id="4564628">1</span><span class="op" id="4564629">;</span>&nbsp;<span class="ident" id="4564631">i</span><span class="op" id="4564632">++</span>&nbsp;<span class="op" id="4564635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4564639">receiver</span>&nbsp;<span class="op" id="4564648">=</span>&nbsp;<span class="ident" id="4564650">s</span><span class="op" id="4564651">.</span><span class="ident" id="4564652">evalField</span><span class="op" id="4564661">(</span><span class="ident" id="4564662">dot</span><span class="op" id="4564665">,</span>&nbsp;<span class="ident" id="4564667">ident</span><span class="op" id="4564672">[</span><span class="ident" id="4564673">i</span><span class="op" id="4564674">]</span><span class="op" id="4564675">,</span>&nbsp;<span class="ident" id="4564677">node</span><span class="op" id="4564681">,</span>&nbsp;<span class="ident" id="4564683">nil</span><span class="op" id="4564686">,</span>&nbsp;<span class="ident" id="4564688">zero</span><span class="op" id="4564692">,</span>&nbsp;<span class="ident" id="4564694">receiver</span><span class="op" id="4564702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4564705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4564708">//&nbsp;Now&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;it&nbsp;gets&nbsp;the&nbsp;arguments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4564757">return</span>&nbsp;<span class="ident" id="4564764">s</span><span class="op" id="4564765">.</span><span class="ident" id="4564766">evalField</span><span class="op" id="4564775">(</span><span class="ident" id="4564776">dot</span><span class="op" id="4564779">,</span>&nbsp;<span class="ident" id="4564781">ident</span><span class="op" id="4564786">[</span><span class="ident" id="4564787">n</span><span class="op" id="4564788">-</span><span class="num" id="4564789">1</span><span class="op" id="4564790">]</span><span class="op" id="4564791">,</span>&nbsp;<span class="ident" id="4564793">node</span><span class="op" id="4564797">,</span>&nbsp;<span class="ident" id="4564799">args</span><span class="op" id="4564803">,</span>&nbsp;<span class="ident" id="4564805">final</span><span class="op" id="4564810">,</span>&nbsp;<span class="ident" id="4564812">receiver</span><span class="op" id="4564820">)</span><br>
<span class="lineno">450</span><span class="op" id="4564822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4564825">func</span>&nbsp;<span class="op" id="4564830">(</span><span class="ident" id="4564831">s</span>&nbsp;<span class="op" id="4564833">*</span><span class="ident" id="4564834">state</span><span class="op" id="4564839">)</span>&nbsp;<span class="ident" id="4564841">evalFunction</span><span class="op" id="4564853">(</span><span class="ident" id="4564854">dot</span>&nbsp;<span class="ident" id="4564858">reflect</span><span class="op" id="4564865">.</span><span class="ident" id="4564866">Value</span><span class="op" id="4564871">,</span>&nbsp;<span class="ident" id="4564873">node</span>&nbsp;<span class="op" id="4564878">*</span><span class="ident" id="4564879">parse</span><span class="op" id="4564884">.</span><span class="ident" id="4564885">IdentifierNode</span><span class="op" id="4564899">,</span>&nbsp;<span class="ident" id="4564901">cmd</span>&nbsp;<span class="ident" id="4564905">parse</span><span class="op" id="4564910">.</span><span class="ident" id="4564911">Node</span><span class="op" id="4564915">,</span>&nbsp;<span class="ident" id="4564917">args</span>&nbsp;<span class="op" id="4564922">[</span><span class="op" id="4564923">]</span><span class="ident" id="4564924">parse</span><span class="op" id="4564929">.</span><span class="ident" id="4564930">Node</span><span class="op" id="4564934">,</span>&nbsp;<span class="ident" id="4564936">final</span>&nbsp;<span class="ident" id="4564942">reflect</span><span class="op" id="4564949">.</span><span class="ident" id="4564950">Value</span><span class="op" id="4564955">)</span>&nbsp;<span class="ident" id="4564957">reflect</span><span class="op" id="4564964">.</span><span class="ident" id="4564965">Value</span>&nbsp;<span class="op" id="4564971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4564974">s</span><span class="op" id="4564975">.</span><span class="ident" id="4564976">at</span><span class="op" id="4564978">(</span><span class="ident" id="4564979">node</span><span class="op" id="4564983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4564986">name</span>&nbsp;<span class="op" id="4564991">:=</span>&nbsp;<span class="ident" id="4564994">node</span><span class="op" id="4564998">.</span><span class="ident" id="4564999">Ident</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4565006">function</span><span class="op" id="4565014">,</span>&nbsp;<span class="ident" id="4565016">ok</span>&nbsp;<span class="op" id="4565019">:=</span>&nbsp;<span class="ident" id="4565022">findFunction</span><span class="op" id="4565034">(</span><span class="ident" id="4565035">name</span><span class="op" id="4565039">,</span>&nbsp;<span class="ident" id="4565041">s</span><span class="op" id="4565042">.</span><span class="ident" id="4565043">tmpl</span><span class="op" id="4565047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4565050">if</span>&nbsp;<span class="op" id="4565053">!</span><span class="ident" id="4565054">ok</span>&nbsp;<span class="op" id="4565057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4565061">s</span><span class="op" id="4565062">.</span><span class="ident" id="4565063">errorf</span><span class="op" id="4565069">(</span><span class="string" id="4565070">&#34;%q&nbsp;is&nbsp;not&nbsp;a&nbsp;defined&nbsp;function&#34;</span><span class="op" id="4565100">,</span>&nbsp;<span class="ident" id="4565102">name</span><span class="op" id="4565106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4565109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4565112">return</span>&nbsp;<span class="ident" id="4565119">s</span><span class="op" id="4565120">.</span><span class="ident" id="4565121">evalCall</span><span class="op" id="4565129">(</span><span class="ident" id="4565130">dot</span><span class="op" id="4565133">,</span>&nbsp;<span class="ident" id="4565135">function</span><span class="op" id="4565143">,</span>&nbsp;<span class="ident" id="4565145">cmd</span><span class="op" id="4565148">,</span>&nbsp;<span class="ident" id="4565150">name</span><span class="op" id="4565154">,</span>&nbsp;<span class="ident" id="4565156">args</span><span class="op" id="4565160">,</span>&nbsp;<span class="ident" id="4565162">final</span><span class="op" id="4565167">)</span><br>
<span class="lineno">460</span><span class="op" id="4565169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4565172">//&nbsp;evalField&nbsp;evaluates&nbsp;an&nbsp;expression&nbsp;like&nbsp;(.Field)&nbsp;or&nbsp;(.Field&nbsp;arg1&nbsp;arg2).</span><br>
<span class="lineno"></span><span class="comment" id="4565246">//&nbsp;The&nbsp;&#39;final&#39;&nbsp;argument&nbsp;represents&nbsp;the&nbsp;return&nbsp;value&nbsp;from&nbsp;the&nbsp;preceding</span><br>
<span class="lineno"></span><span class="comment" id="4565317">//&nbsp;value&nbsp;of&nbsp;the&nbsp;pipeline,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">465</span><span class="keyword" id="4565351">func</span>&nbsp;<span class="op" id="4565356">(</span><span class="ident" id="4565357">s</span>&nbsp;<span class="op" id="4565359">*</span><span class="ident" id="4565360">state</span><span class="op" id="4565365">)</span>&nbsp;<span class="ident" id="4565367">evalField</span><span class="op" id="4565376">(</span><span class="ident" id="4565377">dot</span>&nbsp;<span class="ident" id="4565381">reflect</span><span class="op" id="4565388">.</span><span class="ident" id="4565389">Value</span><span class="op" id="4565394">,</span>&nbsp;<span class="ident" id="4565396">fieldName</span>&nbsp;<span class="builtintype" id="4565406">string</span><span class="op" id="4565412">,</span>&nbsp;<span class="ident" id="4565414">node</span>&nbsp;<span class="ident" id="4565419">parse</span><span class="op" id="4565424">.</span><span class="ident" id="4565425">Node</span><span class="op" id="4565429">,</span>&nbsp;<span class="ident" id="4565431">args</span>&nbsp;<span class="op" id="4565436">[</span><span class="op" id="4565437">]</span><span class="ident" id="4565438">parse</span><span class="op" id="4565443">.</span><span class="ident" id="4565444">Node</span><span class="op" id="4565448">,</span>&nbsp;<span class="ident" id="4565450">final</span><span class="op" id="4565455">,</span>&nbsp;<span class="ident" id="4565457">receiver</span>&nbsp;<span class="ident" id="4565466">reflect</span><span class="op" id="4565473">.</span><span class="ident" id="4565474">Value</span><span class="op" id="4565479">)</span>&nbsp;<span class="ident" id="4565481">reflect</span><span class="op" id="4565488">.</span><span class="ident" id="4565489">Value</span>&nbsp;<span class="op" id="4565495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4565498">if</span>&nbsp;<span class="op" id="4565501">!</span><span class="ident" id="4565502">receiver</span><span class="op" id="4565510">.</span><span class="ident" id="4565511">IsValid</span><span class="op" id="4565518">(</span><span class="op" id="4565519">)</span>&nbsp;<span class="op" id="4565521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4565525">return</span>&nbsp;<span class="ident" id="4565532">zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4565538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4565541">typ</span>&nbsp;<span class="op" id="4565545">:=</span>&nbsp;<span class="ident" id="4565548">receiver</span><span class="op" id="4565556">.</span><span class="ident" id="4565557">Type</span><span class="op" id="4565561">(</span><span class="op" id="4565562">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4565565">receiver</span><span class="op" id="4565573">,</span>&nbsp;<span class="ident" id="4565575">_</span>&nbsp;<span class="op" id="4565577">=</span>&nbsp;<span class="ident" id="4565579">indirect</span><span class="op" id="4565587">(</span><span class="ident" id="4565588">receiver</span><span class="op" id="4565596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4565599">//&nbsp;Unless&nbsp;it&#39;s&nbsp;an&nbsp;interface,&nbsp;need&nbsp;to&nbsp;get&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;*T&nbsp;to&nbsp;guarantee</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4565676">//&nbsp;we&nbsp;see&nbsp;all&nbsp;methods&nbsp;of&nbsp;T&nbsp;and&nbsp;*T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4565712">ptr</span>&nbsp;<span class="op" id="4565716">:=</span>&nbsp;<span class="ident" id="4565719">receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4565729">if</span>&nbsp;<span class="ident" id="4565732">ptr</span><span class="op" id="4565735">.</span><span class="ident" id="4565736">Kind</span><span class="op" id="4565740">(</span><span class="op" id="4565741">)</span>&nbsp;<span class="op" id="4565743">!=</span>&nbsp;<span class="ident" id="4565746">reflect</span><span class="op" id="4565753">.</span><span class="ident" id="4565754">Interface</span>&nbsp;<span class="op" id="4565764">&amp;&amp;</span>&nbsp;<span class="ident" id="4565767">ptr</span><span class="op" id="4565770">.</span><span class="ident" id="4565771">CanAddr</span><span class="op" id="4565778">(</span><span class="op" id="4565779">)</span>&nbsp;<span class="op" id="4565781">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4565785">ptr</span>&nbsp;<span class="op" id="4565789">=</span>&nbsp;<span class="ident" id="4565791">ptr</span><span class="op" id="4565794">.</span><span class="ident" id="4565795">Addr</span><span class="op" id="4565799">(</span><span class="op" id="4565800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4565803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4565806">if</span>&nbsp;<span class="ident" id="4565809">method</span>&nbsp;<span class="op" id="4565816">:=</span>&nbsp;<span class="ident" id="4565819">ptr</span><span class="op" id="4565822">.</span><span class="ident" id="4565823">MethodByName</span><span class="op" id="4565835">(</span><span class="ident" id="4565836">fieldName</span><span class="op" id="4565845">)</span><span class="op" id="4565846">;</span>&nbsp;<span class="ident" id="4565848">method</span><span class="op" id="4565854">.</span><span class="ident" id="4565855">IsValid</span><span class="op" id="4565862">(</span><span class="op" id="4565863">)</span>&nbsp;<span class="op" id="4565865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4565869">return</span>&nbsp;<span class="ident" id="4565876">s</span><span class="op" id="4565877">.</span><span class="ident" id="4565878">evalCall</span><span class="op" id="4565886">(</span><span class="ident" id="4565887">dot</span><span class="op" id="4565890">,</span>&nbsp;<span class="ident" id="4565892">method</span><span class="op" id="4565898">,</span>&nbsp;<span class="ident" id="4565900">node</span><span class="op" id="4565904">,</span>&nbsp;<span class="ident" id="4565906">fieldName</span><span class="op" id="4565915">,</span>&nbsp;<span class="ident" id="4565917">args</span><span class="op" id="4565921">,</span>&nbsp;<span class="ident" id="4565923">final</span><span class="op" id="4565928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4565931">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4565934">hasArgs</span>&nbsp;<span class="op" id="4565942">:=</span>&nbsp;<span class="builtinfunc" id="4565945">len</span><span class="op" id="4565948">(</span><span class="ident" id="4565949">args</span><span class="op" id="4565953">)</span>&nbsp;<span class="op" id="4565955">&gt;</span>&nbsp;<span class="num" id="4565957">1</span>&nbsp;<span class="op" id="4565959">||</span>&nbsp;<span class="ident" id="4565962">final</span><span class="op" id="4565967">.</span><span class="ident" id="4565968">IsValid</span><span class="op" id="4565975">(</span><span class="op" id="4565976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4565979">//&nbsp;It&#39;s&nbsp;not&nbsp;a&nbsp;method;&nbsp;must&nbsp;be&nbsp;a&nbsp;field&nbsp;of&nbsp;a&nbsp;struct&nbsp;or&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;map.&nbsp;The&nbsp;receiver&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4566084">receiver</span><span class="op" id="4566092">,</span>&nbsp;<span class="ident" id="4566094">isNil</span>&nbsp;<span class="op" id="4566100">:=</span>&nbsp;<span class="ident" id="4566103">indirect</span><span class="op" id="4566111">(</span><span class="ident" id="4566112">receiver</span><span class="op" id="4566120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4566123">if</span>&nbsp;<span class="ident" id="4566126">isNil</span>&nbsp;<span class="op" id="4566132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4566136">s</span><span class="op" id="4566137">.</span><span class="ident" id="4566138">errorf</span><span class="op" id="4566144">(</span><span class="string" id="4566145">&#34;nil&nbsp;pointer&nbsp;evaluating&nbsp;%s.%s&#34;</span><span class="op" id="4566175">,</span>&nbsp;<span class="ident" id="4566177">typ</span><span class="op" id="4566180">,</span>&nbsp;<span class="ident" id="4566182">fieldName</span><span class="op" id="4566191">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4566194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4566197">switch</span>&nbsp;<span class="ident" id="4566204">receiver</span><span class="op" id="4566212">.</span><span class="ident" id="4566213">Kind</span><span class="op" id="4566217">(</span><span class="op" id="4566218">)</span>&nbsp;<span class="op" id="4566220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4566223">case</span>&nbsp;<span class="ident" id="4566228">reflect</span><span class="op" id="4566235">.</span><span class="ident" id="4566236">Struct</span><span class="op" id="4566242">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4566246">tField</span><span class="op" id="4566252">,</span>&nbsp;<span class="ident" id="4566254">ok</span>&nbsp;<span class="op" id="4566257">:=</span>&nbsp;<span class="ident" id="4566260">receiver</span><span class="op" id="4566268">.</span><span class="ident" id="4566269">Type</span><span class="op" id="4566273">(</span><span class="op" id="4566274">)</span><span class="op" id="4566275">.</span><span class="ident" id="4566276">FieldByName</span><span class="op" id="4566287">(</span><span class="ident" id="4566288">fieldName</span><span class="op" id="4566297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4566301">if</span>&nbsp;<span class="ident" id="4566304">ok</span>&nbsp;<span class="op" id="4566307">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4566312">field</span>&nbsp;<span class="op" id="4566318">:=</span>&nbsp;<span class="ident" id="4566321">receiver</span><span class="op" id="4566329">.</span><span class="ident" id="4566330">FieldByIndex</span><span class="op" id="4566342">(</span><span class="ident" id="4566343">tField</span><span class="op" id="4566349">.</span><span class="ident" id="4566350">Index</span><span class="op" id="4566355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4566360">if</span>&nbsp;<span class="ident" id="4566363">tField</span><span class="op" id="4566369">.</span><span class="ident" id="4566370">PkgPath</span>&nbsp;<span class="op" id="4566378">!=</span>&nbsp;<span class="string" id="4566381">&#34;&#34;</span>&nbsp;<span class="op" id="4566384">{</span>&nbsp;<span class="comment" id="4566386">//&nbsp;field&nbsp;is&nbsp;unexported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4566413">s</span><span class="op" id="4566414">.</span><span class="ident" id="4566415">errorf</span><span class="op" id="4566421">(</span><span class="string" id="4566422">&#34;%s&nbsp;is&nbsp;an&nbsp;unexported&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4566467">,</span>&nbsp;<span class="ident" id="4566469">fieldName</span><span class="op" id="4566478">,</span>&nbsp;<span class="ident" id="4566480">typ</span><span class="op" id="4566483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4566488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4566493">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;function,&nbsp;we&nbsp;must&nbsp;call&nbsp;it.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4566536">if</span>&nbsp;<span class="ident" id="4566539">hasArgs</span>&nbsp;<span class="op" id="4566547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4566553">s</span><span class="op" id="4566554">.</span><span class="ident" id="4566555">errorf</span><span class="op" id="4566561">(</span><span class="string" id="4566562">&#34;%s&nbsp;has&nbsp;arguments&nbsp;but&nbsp;cannot&nbsp;be&nbsp;invoked&nbsp;as&nbsp;function&#34;</span><span class="op" id="4566614">,</span>&nbsp;<span class="ident" id="4566616">fieldName</span><span class="op" id="4566625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4566630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4566635">return</span>&nbsp;<span class="ident" id="4566642">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4566650">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4566654">s</span><span class="op" id="4566655">.</span><span class="ident" id="4566656">errorf</span><span class="op" id="4566662">(</span><span class="string" id="4566663">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4566700">,</span>&nbsp;<span class="ident" id="4566702">fieldName</span><span class="op" id="4566711">,</span>&nbsp;<span class="ident" id="4566713">typ</span><span class="op" id="4566716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4566719">case</span>&nbsp;<span class="ident" id="4566724">reflect</span><span class="op" id="4566731">.</span><span class="ident" id="4566732">Map</span><span class="op" id="4566735">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4566739">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;map,&nbsp;attempt&nbsp;to&nbsp;use&nbsp;the&nbsp;field&nbsp;name&nbsp;as&nbsp;a&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4566799">nameVal</span>&nbsp;<span class="op" id="4566807">:=</span>&nbsp;<span class="ident" id="4566810">reflect</span><span class="op" id="4566817">.</span><span class="ident" id="4566818">ValueOf</span><span class="op" id="4566825">(</span><span class="ident" id="4566826">fieldName</span><span class="op" id="4566835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4566839">if</span>&nbsp;<span class="ident" id="4566842">nameVal</span><span class="op" id="4566849">.</span><span class="ident" id="4566850">Type</span><span class="op" id="4566854">(</span><span class="op" id="4566855">)</span><span class="op" id="4566856">.</span><span class="ident" id="4566857">AssignableTo</span><span class="op" id="4566869">(</span><span class="ident" id="4566870">receiver</span><span class="op" id="4566878">.</span><span class="ident" id="4566879">Type</span><span class="op" id="4566883">(</span><span class="op" id="4566884">)</span><span class="op" id="4566885">.</span><span class="ident" id="4566886">Key</span><span class="op" id="4566889">(</span><span class="op" id="4566890">)</span><span class="op" id="4566891">)</span>&nbsp;<span class="op" id="4566893">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4566898">if</span>&nbsp;<span class="ident" id="4566901">hasArgs</span>&nbsp;<span class="op" id="4566909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4566915">s</span><span class="op" id="4566916">.</span><span class="ident" id="4566917">errorf</span><span class="op" id="4566923">(</span><span class="string" id="4566924">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;method&nbsp;but&nbsp;has&nbsp;arguments&#34;</span><span class="op" id="4566962">,</span>&nbsp;<span class="ident" id="4566964">fieldName</span><span class="op" id="4566973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4566978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4566983">return</span>&nbsp;<span class="ident" id="4566990">receiver</span><span class="op" id="4566998">.</span><span class="ident" id="4566999">MapIndex</span><span class="op" id="4567007">(</span><span class="ident" id="4567008">nameVal</span><span class="op" id="4567015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4567019">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4567022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4567025">s</span><span class="op" id="4567026">.</span><span class="ident" id="4567027">errorf</span><span class="op" id="4567033">(</span><span class="string" id="4567034">&#34;can&#39;t&nbsp;evaluate&nbsp;field&nbsp;%s&nbsp;in&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4567070">,</span>&nbsp;<span class="ident" id="4567072">fieldName</span><span class="op" id="4567081">,</span>&nbsp;<span class="ident" id="4567083">typ</span><span class="op" id="4567086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4567089">panic</span><span class="op" id="4567094">(</span><span class="string" id="4567095">&#34;not&nbsp;reached&#34;</span><span class="op" id="4567108">)</span><br>
<span class="lineno"></span><span class="op" id="4567110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="4567113">var</span>&nbsp;<span class="op" id="4567117">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4567120">errorType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4567136">=</span>&nbsp;<span class="ident" id="4567138">reflect</span><span class="op" id="4567145">.</span><span class="ident" id="4567146">TypeOf</span><span class="op" id="4567152">(</span><span class="op" id="4567153">(</span><span class="op" id="4567154">*</span><span class="builtintype" id="4567155">error</span><span class="op" id="4567160">)</span><span class="op" id="4567161">(</span><span class="ident" id="4567162">nil</span><span class="op" id="4567165">)</span><span class="op" id="4567166">)</span><span class="op" id="4567167">.</span><span class="ident" id="4567168">Elem</span><span class="op" id="4567172">(</span><span class="op" id="4567173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4567176">fmtStringerType</span>&nbsp;<span class="op" id="4567192">=</span>&nbsp;<span class="ident" id="4567194">reflect</span><span class="op" id="4567201">.</span><span class="ident" id="4567202">TypeOf</span><span class="op" id="4567208">(</span><span class="op" id="4567209">(</span><span class="op" id="4567210">*</span><span class="ident" id="4567211">fmt</span><span class="op" id="4567214">.</span><span class="ident" id="4567215">Stringer</span><span class="op" id="4567223">)</span><span class="op" id="4567224">(</span><span class="ident" id="4567225">nil</span><span class="op" id="4567228">)</span><span class="op" id="4567229">)</span><span class="op" id="4567230">.</span><span class="ident" id="4567231">Elem</span><span class="op" id="4567235">(</span><span class="op" id="4567236">)</span><br>
<span class="lineno"></span><span class="op" id="4567238">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="comment" id="4567241">//&nbsp;evalCall&nbsp;executes&nbsp;a&nbsp;function&nbsp;or&nbsp;method&nbsp;call.&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;fun&nbsp;already&nbsp;has&nbsp;the&nbsp;receiver&nbsp;bound,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="4567346">//&nbsp;it&nbsp;looks&nbsp;just&nbsp;like&nbsp;a&nbsp;function&nbsp;call.&nbsp;&nbsp;The&nbsp;arg&nbsp;list,&nbsp;if&nbsp;non-nil,&nbsp;includes&nbsp;(in&nbsp;the&nbsp;manner&nbsp;of&nbsp;the&nbsp;shell),&nbsp;arg[0]</span><br>
<span class="lineno"></span><span class="comment" id="4567458">//&nbsp;as&nbsp;the&nbsp;function&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="4567485">func</span>&nbsp;<span class="op" id="4567490">(</span><span class="ident" id="4567491">s</span>&nbsp;<span class="op" id="4567493">*</span><span class="ident" id="4567494">state</span><span class="op" id="4567499">)</span>&nbsp;<span class="ident" id="4567501">evalCall</span><span class="op" id="4567509">(</span><span class="ident" id="4567510">dot</span><span class="op" id="4567513">,</span>&nbsp;<span class="ident" id="4567515">fun</span>&nbsp;<span class="ident" id="4567519">reflect</span><span class="op" id="4567526">.</span><span class="ident" id="4567527">Value</span><span class="op" id="4567532">,</span>&nbsp;<span class="ident" id="4567534">node</span>&nbsp;<span class="ident" id="4567539">parse</span><span class="op" id="4567544">.</span><span class="ident" id="4567545">Node</span><span class="op" id="4567549">,</span>&nbsp;<span class="ident" id="4567551">name</span>&nbsp;<span class="builtintype" id="4567556">string</span><span class="op" id="4567562">,</span>&nbsp;<span class="ident" id="4567564">args</span>&nbsp;<span class="op" id="4567569">[</span><span class="op" id="4567570">]</span><span class="ident" id="4567571">parse</span><span class="op" id="4567576">.</span><span class="ident" id="4567577">Node</span><span class="op" id="4567581">,</span>&nbsp;<span class="ident" id="4567583">final</span>&nbsp;<span class="ident" id="4567589">reflect</span><span class="op" id="4567596">.</span><span class="ident" id="4567597">Value</span><span class="op" id="4567602">)</span>&nbsp;<span class="ident" id="4567604">reflect</span><span class="op" id="4567611">.</span><span class="ident" id="4567612">Value</span>&nbsp;<span class="op" id="4567618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4567621">if</span>&nbsp;<span class="ident" id="4567624">args</span>&nbsp;<span class="op" id="4567629">!=</span>&nbsp;<span class="ident" id="4567632">nil</span>&nbsp;<span class="op" id="4567636">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4567640">args</span>&nbsp;<span class="op" id="4567645">=</span>&nbsp;<span class="ident" id="4567647">args</span><span class="op" id="4567651">[</span><span class="num" id="4567652">1</span><span class="op" id="4567653">:</span><span class="op" id="4567654">]</span>&nbsp;<span class="comment" id="4567656">//&nbsp;Zeroth&nbsp;arg&nbsp;is&nbsp;function&nbsp;name/node;&nbsp;not&nbsp;passed&nbsp;to&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4567718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4567721">typ</span>&nbsp;<span class="op" id="4567725">:=</span>&nbsp;<span class="ident" id="4567728">fun</span><span class="op" id="4567731">.</span><span class="ident" id="4567732">Type</span><span class="op" id="4567736">(</span><span class="op" id="4567737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4567740">numIn</span>&nbsp;<span class="op" id="4567746">:=</span>&nbsp;<span class="builtinfunc" id="4567749">len</span><span class="op" id="4567752">(</span><span class="ident" id="4567753">args</span><span class="op" id="4567757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4567760">if</span>&nbsp;<span class="ident" id="4567763">final</span><span class="op" id="4567768">.</span><span class="ident" id="4567769">IsValid</span><span class="op" id="4567776">(</span><span class="op" id="4567777">)</span>&nbsp;<span class="op" id="4567779">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4567783">numIn</span><span class="op" id="4567788">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4567792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4567795">numFixed</span>&nbsp;<span class="op" id="4567804">:=</span>&nbsp;<span class="builtinfunc" id="4567807">len</span><span class="op" id="4567810">(</span><span class="ident" id="4567811">args</span><span class="op" id="4567815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4567818">if</span>&nbsp;<span class="ident" id="4567821">typ</span><span class="op" id="4567824">.</span><span class="ident" id="4567825">IsVariadic</span><span class="op" id="4567835">(</span><span class="op" id="4567836">)</span>&nbsp;<span class="op" id="4567838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4567842">numFixed</span>&nbsp;<span class="op" id="4567851">=</span>&nbsp;<span class="ident" id="4567853">typ</span><span class="op" id="4567856">.</span><span class="ident" id="4567857">NumIn</span><span class="op" id="4567862">(</span><span class="op" id="4567863">)</span>&nbsp;<span class="op" id="4567865">-</span>&nbsp;<span class="num" id="4567867">1</span>&nbsp;<span class="comment" id="4567869">//&nbsp;last&nbsp;arg&nbsp;is&nbsp;the&nbsp;variadic&nbsp;one.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4567904">if</span>&nbsp;<span class="ident" id="4567907">numIn</span>&nbsp;<span class="op" id="4567913">&lt;</span>&nbsp;<span class="ident" id="4567915">numFixed</span>&nbsp;<span class="op" id="4567924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4567929">s</span><span class="op" id="4567930">.</span><span class="ident" id="4567931">errorf</span><span class="op" id="4567937">(</span><span class="string" id="4567938">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="4567992">,</span>&nbsp;<span class="ident" id="4567994">name</span><span class="op" id="4567998">,</span>&nbsp;<span class="ident" id="4568000">typ</span><span class="op" id="4568003">.</span><span class="ident" id="4568004">NumIn</span><span class="op" id="4568009">(</span><span class="op" id="4568010">)</span><span class="op" id="4568011">-</span><span class="num" id="4568012">1</span><span class="op" id="4568013">,</span>&nbsp;<span class="builtinfunc" id="4568015">len</span><span class="op" id="4568018">(</span><span class="ident" id="4568019">args</span><span class="op" id="4568023">)</span><span class="op" id="4568024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4568028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4568031">}</span>&nbsp;<span class="keyword" id="4568033">else</span>&nbsp;<span class="keyword" id="4568038">if</span>&nbsp;<span class="ident" id="4568041">numIn</span>&nbsp;<span class="op" id="4568047">&lt;</span>&nbsp;<span class="ident" id="4568049">typ</span><span class="op" id="4568052">.</span><span class="ident" id="4568053">NumIn</span><span class="op" id="4568058">(</span><span class="op" id="4568059">)</span><span class="op" id="4568060">-</span><span class="num" id="4568061">1</span>&nbsp;<span class="op" id="4568063">||</span>&nbsp;<span class="op" id="4568066">!</span><span class="ident" id="4568067">typ</span><span class="op" id="4568070">.</span><span class="ident" id="4568071">IsVariadic</span><span class="op" id="4568081">(</span><span class="op" id="4568082">)</span>&nbsp;<span class="op" id="4568084">&amp;&amp;</span>&nbsp;<span class="ident" id="4568087">numIn</span>&nbsp;<span class="op" id="4568093">!=</span>&nbsp;<span class="ident" id="4568096">typ</span><span class="op" id="4568099">.</span><span class="ident" id="4568100">NumIn</span><span class="op" id="4568105">(</span><span class="op" id="4568106">)</span>&nbsp;<span class="op" id="4568108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568112">s</span><span class="op" id="4568113">.</span><span class="ident" id="4568114">errorf</span><span class="op" id="4568120">(</span><span class="string" id="4568121">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="4568166">,</span>&nbsp;<span class="ident" id="4568168">name</span><span class="op" id="4568172">,</span>&nbsp;<span class="ident" id="4568174">typ</span><span class="op" id="4568177">.</span><span class="ident" id="4568178">NumIn</span><span class="op" id="4568183">(</span><span class="op" id="4568184">)</span><span class="op" id="4568185">,</span>&nbsp;<span class="builtinfunc" id="4568187">len</span><span class="op" id="4568190">(</span><span class="ident" id="4568191">args</span><span class="op" id="4568195">)</span><span class="op" id="4568196">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4568199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4568202">if</span>&nbsp;<span class="op" id="4568205">!</span><span class="ident" id="4568206">goodFunc</span><span class="op" id="4568214">(</span><span class="ident" id="4568215">typ</span><span class="op" id="4568218">)</span>&nbsp;<span class="op" id="4568220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4568224">//&nbsp;TODO:&nbsp;This&nbsp;could&nbsp;still&nbsp;be&nbsp;a&nbsp;confusing&nbsp;error;&nbsp;maybe&nbsp;goodFunc&nbsp;should&nbsp;provide&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568310">s</span><span class="op" id="4568311">.</span><span class="ident" id="4568312">errorf</span><span class="op" id="4568318">(</span><span class="string" id="4568319">&#34;can&#39;t&nbsp;call&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="4568366">,</span>&nbsp;<span class="ident" id="4568368">name</span><span class="op" id="4568372">,</span>&nbsp;<span class="ident" id="4568374">typ</span><span class="op" id="4568377">.</span><span class="ident" id="4568378">NumOut</span><span class="op" id="4568384">(</span><span class="op" id="4568385">)</span><span class="op" id="4568386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4568389">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4568392">//&nbsp;Build&nbsp;the&nbsp;arg&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568416">argv</span>&nbsp;<span class="op" id="4568421">:=</span>&nbsp;<span class="builtinfunc" id="4568424">make</span><span class="op" id="4568428">(</span><span class="op" id="4568429">[</span><span class="op" id="4568430">]</span><span class="ident" id="4568431">reflect</span><span class="op" id="4568438">.</span><span class="ident" id="4568439">Value</span><span class="op" id="4568444">,</span>&nbsp;<span class="ident" id="4568446">numIn</span><span class="op" id="4568451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4568454">//&nbsp;Args&nbsp;must&nbsp;be&nbsp;evaluated.&nbsp;Fixed&nbsp;args&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568500">i</span>&nbsp;<span class="op" id="4568502">:=</span>&nbsp;<span class="num" id="4568505">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4568508">for</span>&nbsp;<span class="op" id="4568512">;</span>&nbsp;<span class="ident" id="4568514">i</span>&nbsp;<span class="op" id="4568516">&lt;</span>&nbsp;<span class="ident" id="4568518">numFixed</span>&nbsp;<span class="op" id="4568527">&amp;&amp;</span>&nbsp;<span class="ident" id="4568530">i</span>&nbsp;<span class="op" id="4568532">&lt;</span>&nbsp;<span class="builtinfunc" id="4568534">len</span><span class="op" id="4568537">(</span><span class="ident" id="4568538">args</span><span class="op" id="4568542">)</span><span class="op" id="4568543">;</span>&nbsp;<span class="ident" id="4568545">i</span><span class="op" id="4568546">++</span>&nbsp;<span class="op" id="4568549">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568553">argv</span><span class="op" id="4568557">[</span><span class="ident" id="4568558">i</span><span class="op" id="4568559">]</span>&nbsp;<span class="op" id="4568561">=</span>&nbsp;<span class="ident" id="4568563">s</span><span class="op" id="4568564">.</span><span class="ident" id="4568565">evalArg</span><span class="op" id="4568572">(</span><span class="ident" id="4568573">dot</span><span class="op" id="4568576">,</span>&nbsp;<span class="ident" id="4568578">typ</span><span class="op" id="4568581">.</span><span class="ident" id="4568582">In</span><span class="op" id="4568584">(</span><span class="ident" id="4568585">i</span><span class="op" id="4568586">)</span><span class="op" id="4568587">,</span>&nbsp;<span class="ident" id="4568589">args</span><span class="op" id="4568593">[</span><span class="ident" id="4568594">i</span><span class="op" id="4568595">]</span><span class="op" id="4568596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4568599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4568602">//&nbsp;Now&nbsp;the&nbsp;...&nbsp;args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4568624">if</span>&nbsp;<span class="ident" id="4568627">typ</span><span class="op" id="4568630">.</span><span class="ident" id="4568631">IsVariadic</span><span class="op" id="4568641">(</span><span class="op" id="4568642">)</span>&nbsp;<span class="op" id="4568644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568648">argType</span>&nbsp;<span class="op" id="4568656">:=</span>&nbsp;<span class="ident" id="4568659">typ</span><span class="op" id="4568662">.</span><span class="ident" id="4568663">In</span><span class="op" id="4568665">(</span><span class="ident" id="4568666">typ</span><span class="op" id="4568669">.</span><span class="ident" id="4568670">NumIn</span><span class="op" id="4568675">(</span><span class="op" id="4568676">)</span>&nbsp;<span class="op" id="4568678">-</span>&nbsp;<span class="num" id="4568680">1</span><span class="op" id="4568681">)</span><span class="op" id="4568682">.</span><span class="ident" id="4568683">Elem</span><span class="op" id="4568687">(</span><span class="op" id="4568688">)</span>&nbsp;<span class="comment" id="4568690">//&nbsp;Argument&nbsp;is&nbsp;a&nbsp;slice.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4568716">for</span>&nbsp;<span class="op" id="4568720">;</span>&nbsp;<span class="ident" id="4568722">i</span>&nbsp;<span class="op" id="4568724">&lt;</span>&nbsp;<span class="builtinfunc" id="4568726">len</span><span class="op" id="4568729">(</span><span class="ident" id="4568730">args</span><span class="op" id="4568734">)</span><span class="op" id="4568735">;</span>&nbsp;<span class="ident" id="4568737">i</span><span class="op" id="4568738">++</span>&nbsp;<span class="op" id="4568741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568746">argv</span><span class="op" id="4568750">[</span><span class="ident" id="4568751">i</span><span class="op" id="4568752">]</span>&nbsp;<span class="op" id="4568754">=</span>&nbsp;<span class="ident" id="4568756">s</span><span class="op" id="4568757">.</span><span class="ident" id="4568758">evalArg</span><span class="op" id="4568765">(</span><span class="ident" id="4568766">dot</span><span class="op" id="4568769">,</span>&nbsp;<span class="ident" id="4568771">argType</span><span class="op" id="4568778">,</span>&nbsp;<span class="ident" id="4568780">args</span><span class="op" id="4568784">[</span><span class="ident" id="4568785">i</span><span class="op" id="4568786">]</span><span class="op" id="4568787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4568791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4568794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4568797">//&nbsp;Add&nbsp;final&nbsp;value&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4568831">if</span>&nbsp;<span class="ident" id="4568834">final</span><span class="op" id="4568839">.</span><span class="ident" id="4568840">IsValid</span><span class="op" id="4568847">(</span><span class="op" id="4568848">)</span>&nbsp;<span class="op" id="4568850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568854">t</span>&nbsp;<span class="op" id="4568856">:=</span>&nbsp;<span class="ident" id="4568859">typ</span><span class="op" id="4568862">.</span><span class="ident" id="4568863">In</span><span class="op" id="4568865">(</span><span class="ident" id="4568866">typ</span><span class="op" id="4568869">.</span><span class="ident" id="4568870">NumIn</span><span class="op" id="4568875">(</span><span class="op" id="4568876">)</span>&nbsp;<span class="op" id="4568878">-</span>&nbsp;<span class="num" id="4568880">1</span><span class="op" id="4568881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4568885">if</span>&nbsp;<span class="ident" id="4568888">typ</span><span class="op" id="4568891">.</span><span class="ident" id="4568892">IsVariadic</span><span class="op" id="4568902">(</span><span class="op" id="4568903">)</span>&nbsp;<span class="op" id="4568905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568910">t</span>&nbsp;<span class="op" id="4568912">=</span>&nbsp;<span class="ident" id="4568914">t</span><span class="op" id="4568915">.</span><span class="ident" id="4568916">Elem</span><span class="op" id="4568920">(</span><span class="op" id="4568921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4568925">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568929">argv</span><span class="op" id="4568933">[</span><span class="ident" id="4568934">i</span><span class="op" id="4568935">]</span>&nbsp;<span class="op" id="4568937">=</span>&nbsp;<span class="ident" id="4568939">s</span><span class="op" id="4568940">.</span><span class="ident" id="4568941">validateType</span><span class="op" id="4568953">(</span><span class="ident" id="4568954">final</span><span class="op" id="4568959">,</span>&nbsp;<span class="ident" id="4568961">t</span><span class="op" id="4568962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4568965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568968">result</span>&nbsp;<span class="op" id="4568975">:=</span>&nbsp;<span class="ident" id="4568978">fun</span><span class="op" id="4568981">.</span><span class="ident" id="4568982">Call</span><span class="op" id="4568986">(</span><span class="ident" id="4568987">argv</span><span class="op" id="4568991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4568994">//&nbsp;If&nbsp;we&nbsp;have&nbsp;an&nbsp;error&nbsp;that&nbsp;is&nbsp;not&nbsp;nil,&nbsp;stop&nbsp;execution&nbsp;and&nbsp;return&nbsp;that&nbsp;error&nbsp;to&nbsp;the&nbsp;caller.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569087">if</span>&nbsp;<span class="builtinfunc" id="4569090">len</span><span class="op" id="4569093">(</span><span class="ident" id="4569094">result</span><span class="op" id="4569100">)</span>&nbsp;<span class="op" id="4569102">==</span>&nbsp;<span class="num" id="4569105">2</span>&nbsp;<span class="op" id="4569107">&amp;&amp;</span>&nbsp;<span class="op" id="4569110">!</span><span class="ident" id="4569111">result</span><span class="op" id="4569117">[</span><span class="num" id="4569118">1</span><span class="op" id="4569119">]</span><span class="op" id="4569120">.</span><span class="ident" id="4569121">IsNil</span><span class="op" id="4569126">(</span><span class="op" id="4569127">)</span>&nbsp;<span class="op" id="4569129">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569133">s</span><span class="op" id="4569134">.</span><span class="ident" id="4569135">at</span><span class="op" id="4569137">(</span><span class="ident" id="4569138">node</span><span class="op" id="4569142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569146">s</span><span class="op" id="4569147">.</span><span class="ident" id="4569148">errorf</span><span class="op" id="4569154">(</span><span class="string" id="4569155">&#34;error&nbsp;calling&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="4569177">,</span>&nbsp;<span class="ident" id="4569179">name</span><span class="op" id="4569183">,</span>&nbsp;<span class="ident" id="4569185">result</span><span class="op" id="4569191">[</span><span class="num" id="4569192">1</span><span class="op" id="4569193">]</span><span class="op" id="4569194">.</span><span class="ident" id="4569195">Interface</span><span class="op" id="4569204">(</span><span class="op" id="4569205">)</span><span class="op" id="4569206">.</span><span class="op" id="4569207">(</span><span class="builtintype" id="4569208">error</span><span class="op" id="4569213">)</span><span class="op" id="4569214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4569217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569220">return</span>&nbsp;<span class="ident" id="4569227">result</span><span class="op" id="4569233">[</span><span class="num" id="4569234">0</span><span class="op" id="4569235">]</span><br>
<span class="lineno"></span><span class="op" id="4569237">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="4569240">//&nbsp;canBeNil&nbsp;reports&nbsp;whether&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;can&nbsp;be&nbsp;assigned&nbsp;to&nbsp;the&nbsp;type.&nbsp;See&nbsp;reflect.Zero.</span><br>
<span class="lineno"></span><span class="keyword" id="4569330">func</span>&nbsp;<span class="ident" id="4569335">canBeNil</span><span class="op" id="4569343">(</span><span class="ident" id="4569344">typ</span>&nbsp;<span class="ident" id="4569348">reflect</span><span class="op" id="4569355">.</span><span class="ident" id="4569356">Type</span><span class="op" id="4569360">)</span>&nbsp;<span class="builtintype" id="4569362">bool</span>&nbsp;<span class="op" id="4569367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569370">switch</span>&nbsp;<span class="ident" id="4569377">typ</span><span class="op" id="4569380">.</span><span class="ident" id="4569381">Kind</span><span class="op" id="4569385">(</span><span class="op" id="4569386">)</span>&nbsp;<span class="op" id="4569388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569391">case</span>&nbsp;<span class="ident" id="4569396">reflect</span><span class="op" id="4569403">.</span><span class="ident" id="4569404">Chan</span><span class="op" id="4569408">,</span>&nbsp;<span class="ident" id="4569410">reflect</span><span class="op" id="4569417">.</span><span class="ident" id="4569418">Func</span><span class="op" id="4569422">,</span>&nbsp;<span class="ident" id="4569424">reflect</span><span class="op" id="4569431">.</span><span class="ident" id="4569432">Interface</span><span class="op" id="4569441">,</span>&nbsp;<span class="ident" id="4569443">reflect</span><span class="op" id="4569450">.</span><span class="ident" id="4569451">Map</span><span class="op" id="4569454">,</span>&nbsp;<span class="ident" id="4569456">reflect</span><span class="op" id="4569463">.</span><span class="ident" id="4569464">Ptr</span><span class="op" id="4569467">,</span>&nbsp;<span class="ident" id="4569469">reflect</span><span class="op" id="4569476">.</span><span class="ident" id="4569477">Slice</span><span class="op" id="4569482">:</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569486">return</span>&nbsp;<span class="builtintype" id="4569493">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4569499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569502">return</span>&nbsp;<span class="builtintype" id="4569509">false</span><br>
<span class="lineno"></span><span class="op" id="4569515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="comment" id="4569518">//&nbsp;validateType&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;value&nbsp;is&nbsp;valid&nbsp;and&nbsp;assignable&nbsp;to&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4569597">func</span>&nbsp;<span class="op" id="4569602">(</span><span class="ident" id="4569603">s</span>&nbsp;<span class="op" id="4569605">*</span><span class="ident" id="4569606">state</span><span class="op" id="4569611">)</span>&nbsp;<span class="ident" id="4569613">validateType</span><span class="op" id="4569625">(</span><span class="ident" id="4569626">value</span>&nbsp;<span class="ident" id="4569632">reflect</span><span class="op" id="4569639">.</span><span class="ident" id="4569640">Value</span><span class="op" id="4569645">,</span>&nbsp;<span class="ident" id="4569647">typ</span>&nbsp;<span class="ident" id="4569651">reflect</span><span class="op" id="4569658">.</span><span class="ident" id="4569659">Type</span><span class="op" id="4569663">)</span>&nbsp;<span class="ident" id="4569665">reflect</span><span class="op" id="4569672">.</span><span class="ident" id="4569673">Value</span>&nbsp;<span class="op" id="4569679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569682">if</span>&nbsp;<span class="op" id="4569685">!</span><span class="ident" id="4569686">value</span><span class="op" id="4569691">.</span><span class="ident" id="4569692">IsValid</span><span class="op" id="4569699">(</span><span class="op" id="4569700">)</span>&nbsp;<span class="op" id="4569702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569706">if</span>&nbsp;<span class="ident" id="4569709">typ</span>&nbsp;<span class="op" id="4569713">==</span>&nbsp;<span class="ident" id="4569716">nil</span>&nbsp;<span class="op" id="4569720">||</span>&nbsp;<span class="ident" id="4569723">canBeNil</span><span class="op" id="4569731">(</span><span class="ident" id="4569732">typ</span><span class="op" id="4569735">)</span>&nbsp;<span class="op" id="4569737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4569742">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;interface{}.&nbsp;Accept&nbsp;as&nbsp;a&nbsp;proper&nbsp;nil&nbsp;value.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569806">return</span>&nbsp;<span class="ident" id="4569813">reflect</span><span class="op" id="4569820">.</span><span class="ident" id="4569821">Zero</span><span class="op" id="4569825">(</span><span class="ident" id="4569826">typ</span><span class="op" id="4569829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4569833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569837">s</span><span class="op" id="4569838">.</span><span class="ident" id="4569839">errorf</span><span class="op" id="4569845">(</span><span class="string" id="4569846">&#34;invalid&nbsp;value;&nbsp;expected&nbsp;%s&#34;</span><span class="op" id="4569874">,</span>&nbsp;<span class="ident" id="4569876">typ</span><span class="op" id="4569879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4569882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569885">if</span>&nbsp;<span class="ident" id="4569888">typ</span>&nbsp;<span class="op" id="4569892">!=</span>&nbsp;<span class="ident" id="4569895">nil</span>&nbsp;<span class="op" id="4569899">&amp;&amp;</span>&nbsp;<span class="op" id="4569902">!</span><span class="ident" id="4569903">value</span><span class="op" id="4569908">.</span><span class="ident" id="4569909">Type</span><span class="op" id="4569913">(</span><span class="op" id="4569914">)</span><span class="op" id="4569915">.</span><span class="ident" id="4569916">AssignableTo</span><span class="op" id="4569928">(</span><span class="ident" id="4569929">typ</span><span class="op" id="4569932">)</span>&nbsp;<span class="op" id="4569934">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569938">if</span>&nbsp;<span class="ident" id="4569941">value</span><span class="op" id="4569946">.</span><span class="ident" id="4569947">Kind</span><span class="op" id="4569951">(</span><span class="op" id="4569952">)</span>&nbsp;<span class="op" id="4569954">==</span>&nbsp;<span class="ident" id="4569957">reflect</span><span class="op" id="4569964">.</span><span class="ident" id="4569965">Interface</span>&nbsp;<span class="op" id="4569975">&amp;&amp;</span>&nbsp;<span class="op" id="4569978">!</span><span class="ident" id="4569979">value</span><span class="op" id="4569984">.</span><span class="ident" id="4569985">IsNil</span><span class="op" id="4569990">(</span><span class="op" id="4569991">)</span>&nbsp;<span class="op" id="4569993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569998">value</span>&nbsp;<span class="op" id="4570004">=</span>&nbsp;<span class="ident" id="4570006">value</span><span class="op" id="4570011">.</span><span class="ident" id="4570012">Elem</span><span class="op" id="4570016">(</span><span class="op" id="4570017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570022">if</span>&nbsp;<span class="ident" id="4570025">value</span><span class="op" id="4570030">.</span><span class="ident" id="4570031">Type</span><span class="op" id="4570035">(</span><span class="op" id="4570036">)</span><span class="op" id="4570037">.</span><span class="ident" id="4570038">AssignableTo</span><span class="op" id="4570050">(</span><span class="ident" id="4570051">typ</span><span class="op" id="4570054">)</span>&nbsp;<span class="op" id="4570056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570062">return</span>&nbsp;<span class="ident" id="4570069">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570078">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4570083">//&nbsp;fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4570104">//&nbsp;Does&nbsp;one&nbsp;dereference&nbsp;or&nbsp;indirection&nbsp;work?&nbsp;We&nbsp;could&nbsp;do&nbsp;more,&nbsp;as&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4570175">//&nbsp;do&nbsp;with&nbsp;method&nbsp;receivers,&nbsp;but&nbsp;that&nbsp;gets&nbsp;messy&nbsp;and&nbsp;method&nbsp;receivers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4570247">//&nbsp;are&nbsp;much&nbsp;more&nbsp;constrained,&nbsp;so&nbsp;it&nbsp;makes&nbsp;more&nbsp;sense&nbsp;there&nbsp;than&nbsp;here.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4570319">//&nbsp;Besides,&nbsp;one&nbsp;is&nbsp;almost&nbsp;always&nbsp;all&nbsp;you&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570368">switch</span>&nbsp;<span class="op" id="4570375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570379">case</span>&nbsp;<span class="ident" id="4570384">value</span><span class="op" id="4570389">.</span><span class="ident" id="4570390">Kind</span><span class="op" id="4570394">(</span><span class="op" id="4570395">)</span>&nbsp;<span class="op" id="4570397">==</span>&nbsp;<span class="ident" id="4570400">reflect</span><span class="op" id="4570407">.</span><span class="ident" id="4570408">Ptr</span>&nbsp;<span class="op" id="4570412">&amp;&amp;</span>&nbsp;<span class="ident" id="4570415">value</span><span class="op" id="4570420">.</span><span class="ident" id="4570421">Type</span><span class="op" id="4570425">(</span><span class="op" id="4570426">)</span><span class="op" id="4570427">.</span><span class="ident" id="4570428">Elem</span><span class="op" id="4570432">(</span><span class="op" id="4570433">)</span><span class="op" id="4570434">.</span><span class="ident" id="4570435">AssignableTo</span><span class="op" id="4570447">(</span><span class="ident" id="4570448">typ</span><span class="op" id="4570451">)</span><span class="op" id="4570452">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570457">value</span>&nbsp;<span class="op" id="4570463">=</span>&nbsp;<span class="ident" id="4570465">value</span><span class="op" id="4570470">.</span><span class="ident" id="4570471">Elem</span><span class="op" id="4570475">(</span><span class="op" id="4570476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570481">if</span>&nbsp;<span class="op" id="4570484">!</span><span class="ident" id="4570485">value</span><span class="op" id="4570490">.</span><span class="ident" id="4570491">IsValid</span><span class="op" id="4570498">(</span><span class="op" id="4570499">)</span>&nbsp;<span class="op" id="4570501">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570507">s</span><span class="op" id="4570508">.</span><span class="ident" id="4570509">errorf</span><span class="op" id="4570515">(</span><span class="string" id="4570516">&#34;dereference&nbsp;of&nbsp;nil&nbsp;pointer&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4570555">,</span>&nbsp;<span class="ident" id="4570557">typ</span><span class="op" id="4570560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570569">case</span>&nbsp;<span class="ident" id="4570574">reflect</span><span class="op" id="4570581">.</span><span class="ident" id="4570582">PtrTo</span><span class="op" id="4570587">(</span><span class="ident" id="4570588">value</span><span class="op" id="4570593">.</span><span class="ident" id="4570594">Type</span><span class="op" id="4570598">(</span><span class="op" id="4570599">)</span><span class="op" id="4570600">)</span><span class="op" id="4570601">.</span><span class="ident" id="4570602">AssignableTo</span><span class="op" id="4570614">(</span><span class="ident" id="4570615">typ</span><span class="op" id="4570618">)</span>&nbsp;<span class="op" id="4570620">&amp;&amp;</span>&nbsp;<span class="ident" id="4570623">value</span><span class="op" id="4570628">.</span><span class="ident" id="4570629">CanAddr</span><span class="op" id="4570636">(</span><span class="op" id="4570637">)</span><span class="op" id="4570638">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570643">value</span>&nbsp;<span class="op" id="4570649">=</span>&nbsp;<span class="ident" id="4570651">value</span><span class="op" id="4570656">.</span><span class="ident" id="4570657">Addr</span><span class="op" id="4570661">(</span><span class="op" id="4570662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570666">default</span><span class="op" id="4570673">:</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570678">s</span><span class="op" id="4570679">.</span><span class="ident" id="4570680">errorf</span><span class="op" id="4570686">(</span><span class="string" id="4570687">&#34;wrong&nbsp;type&nbsp;for&nbsp;value;&nbsp;expected&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="4570730">,</span>&nbsp;<span class="ident" id="4570732">typ</span><span class="op" id="4570735">,</span>&nbsp;<span class="ident" id="4570737">value</span><span class="op" id="4570742">.</span><span class="ident" id="4570743">Type</span><span class="op" id="4570747">(</span><span class="op" id="4570748">)</span><span class="op" id="4570749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570759">return</span>&nbsp;<span class="ident" id="4570766">value</span><br>
<span class="lineno"></span><span class="op" id="4570772">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="4570775">func</span>&nbsp;<span class="op" id="4570780">(</span><span class="ident" id="4570781">s</span>&nbsp;<span class="op" id="4570783">*</span><span class="ident" id="4570784">state</span><span class="op" id="4570789">)</span>&nbsp;<span class="ident" id="4570791">evalArg</span><span class="op" id="4570798">(</span><span class="ident" id="4570799">dot</span>&nbsp;<span class="ident" id="4570803">reflect</span><span class="op" id="4570810">.</span><span class="ident" id="4570811">Value</span><span class="op" id="4570816">,</span>&nbsp;<span class="ident" id="4570818">typ</span>&nbsp;<span class="ident" id="4570822">reflect</span><span class="op" id="4570829">.</span><span class="ident" id="4570830">Type</span><span class="op" id="4570834">,</span>&nbsp;<span class="ident" id="4570836">n</span>&nbsp;<span class="ident" id="4570838">parse</span><span class="op" id="4570843">.</span><span class="ident" id="4570844">Node</span><span class="op" id="4570848">)</span>&nbsp;<span class="ident" id="4570850">reflect</span><span class="op" id="4570857">.</span><span class="ident" id="4570858">Value</span>&nbsp;<span class="op" id="4570864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570867">s</span><span class="op" id="4570868">.</span><span class="ident" id="4570869">at</span><span class="op" id="4570871">(</span><span class="ident" id="4570872">n</span><span class="op" id="4570873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570876">switch</span>&nbsp;<span class="ident" id="4570883">arg</span>&nbsp;<span class="op" id="4570887">:=</span>&nbsp;<span class="ident" id="4570890">n</span><span class="op" id="4570891">.</span><span class="op" id="4570892">(</span><span class="keyword" id="4570893">type</span><span class="op" id="4570897">)</span>&nbsp;<span class="op" id="4570899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570902">case</span>&nbsp;<span class="op" id="4570907">*</span><span class="ident" id="4570908">parse</span><span class="op" id="4570913">.</span><span class="ident" id="4570914">DotNode</span><span class="op" id="4570921">:</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570925">return</span>&nbsp;<span class="ident" id="4570932">s</span><span class="op" id="4570933">.</span><span class="ident" id="4570934">validateType</span><span class="op" id="4570946">(</span><span class="ident" id="4570947">dot</span><span class="op" id="4570950">,</span>&nbsp;<span class="ident" id="4570952">typ</span><span class="op" id="4570955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570958">case</span>&nbsp;<span class="op" id="4570963">*</span><span class="ident" id="4570964">parse</span><span class="op" id="4570969">.</span><span class="ident" id="4570970">NilNode</span><span class="op" id="4570977">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570981">if</span>&nbsp;<span class="ident" id="4570984">canBeNil</span><span class="op" id="4570992">(</span><span class="ident" id="4570993">typ</span><span class="op" id="4570996">)</span>&nbsp;<span class="op" id="4570998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571003">return</span>&nbsp;<span class="ident" id="4571010">reflect</span><span class="op" id="4571017">.</span><span class="ident" id="4571018">Zero</span><span class="op" id="4571022">(</span><span class="ident" id="4571023">typ</span><span class="op" id="4571026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4571030">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4571034">s</span><span class="op" id="4571035">.</span><span class="ident" id="4571036">errorf</span><span class="op" id="4571042">(</span><span class="string" id="4571043">&#34;cannot&nbsp;assign&nbsp;nil&nbsp;to&nbsp;%s&#34;</span><span class="op" id="4571068">,</span>&nbsp;<span class="ident" id="4571070">typ</span><span class="op" id="4571073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571076">case</span>&nbsp;<span class="op" id="4571081">*</span><span class="ident" id="4571082">parse</span><span class="op" id="4571087">.</span><span class="ident" id="4571088">FieldNode</span><span class="op" id="4571097">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571101">return</span>&nbsp;<span class="ident" id="4571108">s</span><span class="op" id="4571109">.</span><span class="ident" id="4571110">validateType</span><span class="op" id="4571122">(</span><span class="ident" id="4571123">s</span><span class="op" id="4571124">.</span><span class="ident" id="4571125">evalFieldNode</span><span class="op" id="4571138">(</span><span class="ident" id="4571139">dot</span><span class="op" id="4571142">,</span>&nbsp;<span class="ident" id="4571144">arg</span><span class="op" id="4571147">,</span>&nbsp;<span class="op" id="4571149">[</span><span class="op" id="4571150">]</span><span class="ident" id="4571151">parse</span><span class="op" id="4571156">.</span><span class="ident" id="4571157">Node</span><span class="op" id="4571161">{</span><span class="ident" id="4571162">n</span><span class="op" id="4571163">}</span><span class="op" id="4571164">,</span>&nbsp;<span class="ident" id="4571166">zero</span><span class="op" id="4571170">)</span><span class="op" id="4571171">,</span>&nbsp;<span class="ident" id="4571173">typ</span><span class="op" id="4571176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571179">case</span>&nbsp;<span class="op" id="4571184">*</span><span class="ident" id="4571185">parse</span><span class="op" id="4571190">.</span><span class="ident" id="4571191">VariableNode</span><span class="op" id="4571203">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571207">return</span>&nbsp;<span class="ident" id="4571214">s</span><span class="op" id="4571215">.</span><span class="ident" id="4571216">validateType</span><span class="op" id="4571228">(</span><span class="ident" id="4571229">s</span><span class="op" id="4571230">.</span><span class="ident" id="4571231">evalVariableNode</span><span class="op" id="4571247">(</span><span class="ident" id="4571248">dot</span><span class="op" id="4571251">,</span>&nbsp;<span class="ident" id="4571253">arg</span><span class="op" id="4571256">,</span>&nbsp;<span class="ident" id="4571258">nil</span><span class="op" id="4571261">,</span>&nbsp;<span class="ident" id="4571263">zero</span><span class="op" id="4571267">)</span><span class="op" id="4571268">,</span>&nbsp;<span class="ident" id="4571270">typ</span><span class="op" id="4571273">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571276">case</span>&nbsp;<span class="op" id="4571281">*</span><span class="ident" id="4571282">parse</span><span class="op" id="4571287">.</span><span class="ident" id="4571288">PipeNode</span><span class="op" id="4571296">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571300">return</span>&nbsp;<span class="ident" id="4571307">s</span><span class="op" id="4571308">.</span><span class="ident" id="4571309">validateType</span><span class="op" id="4571321">(</span><span class="ident" id="4571322">s</span><span class="op" id="4571323">.</span><span class="ident" id="4571324">evalPipeline</span><span class="op" id="4571336">(</span><span class="ident" id="4571337">dot</span><span class="op" id="4571340">,</span>&nbsp;<span class="ident" id="4571342">arg</span><span class="op" id="4571345">)</span><span class="op" id="4571346">,</span>&nbsp;<span class="ident" id="4571348">typ</span><span class="op" id="4571351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571354">case</span>&nbsp;<span class="op" id="4571359">*</span><span class="ident" id="4571360">parse</span><span class="op" id="4571365">.</span><span class="ident" id="4571366">IdentifierNode</span><span class="op" id="4571380">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571384">return</span>&nbsp;<span class="ident" id="4571391">s</span><span class="op" id="4571392">.</span><span class="ident" id="4571393">evalFunction</span><span class="op" id="4571405">(</span><span class="ident" id="4571406">dot</span><span class="op" id="4571409">,</span>&nbsp;<span class="ident" id="4571411">arg</span><span class="op" id="4571414">,</span>&nbsp;<span class="ident" id="4571416">arg</span><span class="op" id="4571419">,</span>&nbsp;<span class="ident" id="4571421">nil</span><span class="op" id="4571424">,</span>&nbsp;<span class="ident" id="4571426">zero</span><span class="op" id="4571430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571433">case</span>&nbsp;<span class="op" id="4571438">*</span><span class="ident" id="4571439">parse</span><span class="op" id="4571444">.</span><span class="ident" id="4571445">ChainNode</span><span class="op" id="4571454">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571458">return</span>&nbsp;<span class="ident" id="4571465">s</span><span class="op" id="4571466">.</span><span class="ident" id="4571467">validateType</span><span class="op" id="4571479">(</span><span class="ident" id="4571480">s</span><span class="op" id="4571481">.</span><span class="ident" id="4571482">evalChainNode</span><span class="op" id="4571495">(</span><span class="ident" id="4571496">dot</span><span class="op" id="4571499">,</span>&nbsp;<span class="ident" id="4571501">arg</span><span class="op" id="4571504">,</span>&nbsp;<span class="ident" id="4571506">nil</span><span class="op" id="4571509">,</span>&nbsp;<span class="ident" id="4571511">zero</span><span class="op" id="4571515">)</span><span class="op" id="4571516">,</span>&nbsp;<span class="ident" id="4571518">typ</span><span class="op" id="4571521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4571524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571527">switch</span>&nbsp;<span class="ident" id="4571534">typ</span><span class="op" id="4571537">.</span><span class="ident" id="4571538">Kind</span><span class="op" id="4571542">(</span><span class="op" id="4571543">)</span>&nbsp;<span class="op" id="4571545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571548">case</span>&nbsp;<span class="ident" id="4571553">reflect</span><span class="op" id="4571560">.</span><span class="ident" id="4571561">Bool</span><span class="op" id="4571565">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571569">return</span>&nbsp;<span class="ident" id="4571576">s</span><span class="op" id="4571577">.</span><span class="ident" id="4571578">evalBool</span><span class="op" id="4571586">(</span><span class="ident" id="4571587">typ</span><span class="op" id="4571590">,</span>&nbsp;<span class="ident" id="4571592">n</span><span class="op" id="4571593">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571596">case</span>&nbsp;<span class="ident" id="4571601">reflect</span><span class="op" id="4571608">.</span><span class="ident" id="4571609">Complex64</span><span class="op" id="4571618">,</span>&nbsp;<span class="ident" id="4571620">reflect</span><span class="op" id="4571627">.</span><span class="ident" id="4571628">Complex128</span><span class="op" id="4571638">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571642">return</span>&nbsp;<span class="ident" id="4571649">s</span><span class="op" id="4571650">.</span><span class="ident" id="4571651">evalComplex</span><span class="op" id="4571662">(</span><span class="ident" id="4571663">typ</span><span class="op" id="4571666">,</span>&nbsp;<span class="ident" id="4571668">n</span><span class="op" id="4571669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571672">case</span>&nbsp;<span class="ident" id="4571677">reflect</span><span class="op" id="4571684">.</span><span class="ident" id="4571685">Float32</span><span class="op" id="4571692">,</span>&nbsp;<span class="ident" id="4571694">reflect</span><span class="op" id="4571701">.</span><span class="ident" id="4571702">Float64</span><span class="op" id="4571709">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571713">return</span>&nbsp;<span class="ident" id="4571720">s</span><span class="op" id="4571721">.</span><span class="ident" id="4571722">evalFloat</span><span class="op" id="4571731">(</span><span class="ident" id="4571732">typ</span><span class="op" id="4571735">,</span>&nbsp;<span class="ident" id="4571737">n</span><span class="op" id="4571738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571741">case</span>&nbsp;<span class="ident" id="4571746">reflect</span><span class="op" id="4571753">.</span><span class="ident" id="4571754">Int</span><span class="op" id="4571757">,</span>&nbsp;<span class="ident" id="4571759">reflect</span><span class="op" id="4571766">.</span><span class="ident" id="4571767">Int8</span><span class="op" id="4571771">,</span>&nbsp;<span class="ident" id="4571773">reflect</span><span class="op" id="4571780">.</span><span class="ident" id="4571781">Int16</span><span class="op" id="4571786">,</span>&nbsp;<span class="ident" id="4571788">reflect</span><span class="op" id="4571795">.</span><span class="ident" id="4571796">Int32</span><span class="op" id="4571801">,</span>&nbsp;<span class="ident" id="4571803">reflect</span><span class="op" id="4571810">.</span><span class="ident" id="4571811">Int64</span><span class="op" id="4571816">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571820">return</span>&nbsp;<span class="ident" id="4571827">s</span><span class="op" id="4571828">.</span><span class="ident" id="4571829">evalInteger</span><span class="op" id="4571840">(</span><span class="ident" id="4571841">typ</span><span class="op" id="4571844">,</span>&nbsp;<span class="ident" id="4571846">n</span><span class="op" id="4571847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571850">case</span>&nbsp;<span class="ident" id="4571855">reflect</span><span class="op" id="4571862">.</span><span class="ident" id="4571863">Interface</span><span class="op" id="4571872">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571876">if</span>&nbsp;<span class="ident" id="4571879">typ</span><span class="op" id="4571882">.</span><span class="ident" id="4571883">NumMethod</span><span class="op" id="4571892">(</span><span class="op" id="4571893">)</span>&nbsp;<span class="op" id="4571895">==</span>&nbsp;<span class="num" id="4571898">0</span>&nbsp;<span class="op" id="4571900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571905">return</span>&nbsp;<span class="ident" id="4571912">s</span><span class="op" id="4571913">.</span><span class="ident" id="4571914">evalEmptyInterface</span><span class="op" id="4571932">(</span><span class="ident" id="4571933">dot</span><span class="op" id="4571936">,</span>&nbsp;<span class="ident" id="4571938">n</span><span class="op" id="4571939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4571943">}</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571946">case</span>&nbsp;<span class="ident" id="4571951">reflect</span><span class="op" id="4571958">.</span><span class="ident" id="4571959">String</span><span class="op" id="4571965">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571969">return</span>&nbsp;<span class="ident" id="4571976">s</span><span class="op" id="4571977">.</span><span class="ident" id="4571978">evalString</span><span class="op" id="4571988">(</span><span class="ident" id="4571989">typ</span><span class="op" id="4571992">,</span>&nbsp;<span class="ident" id="4571994">n</span><span class="op" id="4571995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4571998">case</span>&nbsp;<span class="ident" id="4572003">reflect</span><span class="op" id="4572010">.</span><span class="ident" id="4572011">Uint</span><span class="op" id="4572015">,</span>&nbsp;<span class="ident" id="4572017">reflect</span><span class="op" id="4572024">.</span><span class="ident" id="4572025">Uint8</span><span class="op" id="4572030">,</span>&nbsp;<span class="ident" id="4572032">reflect</span><span class="op" id="4572039">.</span><span class="ident" id="4572040">Uint16</span><span class="op" id="4572046">,</span>&nbsp;<span class="ident" id="4572048">reflect</span><span class="op" id="4572055">.</span><span class="ident" id="4572056">Uint32</span><span class="op" id="4572062">,</span>&nbsp;<span class="ident" id="4572064">reflect</span><span class="op" id="4572071">.</span><span class="ident" id="4572072">Uint64</span><span class="op" id="4572078">,</span>&nbsp;<span class="ident" id="4572080">reflect</span><span class="op" id="4572087">.</span><span class="ident" id="4572088">Uintptr</span><span class="op" id="4572095">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4572099">return</span>&nbsp;<span class="ident" id="4572106">s</span><span class="op" id="4572107">.</span><span class="ident" id="4572108">evalUnsignedInteger</span><span class="op" id="4572127">(</span><span class="ident" id="4572128">typ</span><span class="op" id="4572131">,</span>&nbsp;<span class="ident" id="4572133">n</span><span class="op" id="4572134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4572137">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572140">s</span><span class="op" id="4572141">.</span><span class="ident" id="4572142">errorf</span><span class="op" id="4572148">(</span><span class="string" id="4572149">&#34;can&#39;t&nbsp;handle&nbsp;%s&nbsp;for&nbsp;arg&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4572185">,</span>&nbsp;<span class="ident" id="4572187">n</span><span class="op" id="4572188">,</span>&nbsp;<span class="ident" id="4572190">typ</span><span class="op" id="4572193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4572196">panic</span><span class="op" id="4572201">(</span><span class="string" id="4572202">&#34;not&nbsp;reached&#34;</span><span class="op" id="4572215">)</span><br>
<span class="lineno"></span><span class="op" id="4572217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4572220">func</span>&nbsp;<span class="op" id="4572225">(</span><span class="ident" id="4572226">s</span>&nbsp;<span class="op" id="4572228">*</span><span class="ident" id="4572229">state</span><span class="op" id="4572234">)</span>&nbsp;<span class="ident" id="4572236">evalBool</span><span class="op" id="4572244">(</span><span class="ident" id="4572245">typ</span>&nbsp;<span class="ident" id="4572249">reflect</span><span class="op" id="4572256">.</span><span class="ident" id="4572257">Type</span><span class="op" id="4572261">,</span>&nbsp;<span class="ident" id="4572263">n</span>&nbsp;<span class="ident" id="4572265">parse</span><span class="op" id="4572270">.</span><span class="ident" id="4572271">Node</span><span class="op" id="4572275">)</span>&nbsp;<span class="ident" id="4572277">reflect</span><span class="op" id="4572284">.</span><span class="ident" id="4572285">Value</span>&nbsp;<span class="op" id="4572291">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572294">s</span><span class="op" id="4572295">.</span><span class="ident" id="4572296">at</span><span class="op" id="4572298">(</span><span class="ident" id="4572299">n</span><span class="op" id="4572300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4572303">if</span>&nbsp;<span class="ident" id="4572306">n</span><span class="op" id="4572307">,</span>&nbsp;<span class="ident" id="4572309">ok</span>&nbsp;<span class="op" id="4572312">:=</span>&nbsp;<span class="ident" id="4572315">n</span><span class="op" id="4572316">.</span><span class="op" id="4572317">(</span><span class="op" id="4572318">*</span><span class="ident" id="4572319">parse</span><span class="op" id="4572324">.</span><span class="ident" id="4572325">BoolNode</span><span class="op" id="4572333">)</span><span class="op" id="4572334">;</span>&nbsp;<span class="ident" id="4572336">ok</span>&nbsp;<span class="op" id="4572339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572343">value</span>&nbsp;<span class="op" id="4572349">:=</span>&nbsp;<span class="ident" id="4572352">reflect</span><span class="op" id="4572359">.</span><span class="ident" id="4572360">New</span><span class="op" id="4572363">(</span><span class="ident" id="4572364">typ</span><span class="op" id="4572367">)</span><span class="op" id="4572368">.</span><span class="ident" id="4572369">Elem</span><span class="op" id="4572373">(</span><span class="op" id="4572374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572378">value</span><span class="op" id="4572383">.</span><span class="ident" id="4572384">SetBool</span><span class="op" id="4572391">(</span><span class="ident" id="4572392">n</span><span class="op" id="4572393">.</span><span class="ident" id="4572394">True</span><span class="op" id="4572398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4572402">return</span>&nbsp;<span class="ident" id="4572409">value</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4572416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572419">s</span><span class="op" id="4572420">.</span><span class="ident" id="4572421">errorf</span><span class="op" id="4572427">(</span><span class="string" id="4572428">&#34;expected&nbsp;bool;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4572453">,</span>&nbsp;<span class="ident" id="4572455">n</span><span class="op" id="4572456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4572459">panic</span><span class="op" id="4572464">(</span><span class="string" id="4572465">&#34;not&nbsp;reached&#34;</span><span class="op" id="4572478">)</span><br>
<span class="lineno"></span><span class="op" id="4572480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="4572483">func</span>&nbsp;<span class="op" id="4572488">(</span><span class="ident" id="4572489">s</span>&nbsp;<span class="op" id="4572491">*</span><span class="ident" id="4572492">state</span><span class="op" id="4572497">)</span>&nbsp;<span class="ident" id="4572499">evalString</span><span class="op" id="4572509">(</span><span class="ident" id="4572510">typ</span>&nbsp;<span class="ident" id="4572514">reflect</span><span class="op" id="4572521">.</span><span class="ident" id="4572522">Type</span><span class="op" id="4572526">,</span>&nbsp;<span class="ident" id="4572528">n</span>&nbsp;<span class="ident" id="4572530">parse</span><span class="op" id="4572535">.</span><span class="ident" id="4572536">Node</span><span class="op" id="4572540">)</span>&nbsp;<span class="ident" id="4572542">reflect</span><span class="op" id="4572549">.</span><span class="ident" id="4572550">Value</span>&nbsp;<span class="op" id="4572556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572559">s</span><span class="op" id="4572560">.</span><span class="ident" id="4572561">at</span><span class="op" id="4572563">(</span><span class="ident" id="4572564">n</span><span class="op" id="4572565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4572568">if</span>&nbsp;<span class="ident" id="4572571">n</span><span class="op" id="4572572">,</span>&nbsp;<span class="ident" id="4572574">ok</span>&nbsp;<span class="op" id="4572577">:=</span>&nbsp;<span class="ident" id="4572580">n</span><span class="op" id="4572581">.</span><span class="op" id="4572582">(</span><span class="op" id="4572583">*</span><span class="ident" id="4572584">parse</span><span class="op" id="4572589">.</span><span class="ident" id="4572590">StringNode</span><span class="op" id="4572600">)</span><span class="op" id="4572601">;</span>&nbsp;<span class="ident" id="4572603">ok</span>&nbsp;<span class="op" id="4572606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572610">value</span>&nbsp;<span class="op" id="4572616">:=</span>&nbsp;<span class="ident" id="4572619">reflect</span><span class="op" id="4572626">.</span><span class="ident" id="4572627">New</span><span class="op" id="4572630">(</span><span class="ident" id="4572631">typ</span><span class="op" id="4572634">)</span><span class="op" id="4572635">.</span><span class="ident" id="4572636">Elem</span><span class="op" id="4572640">(</span><span class="op" id="4572641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572645">value</span><span class="op" id="4572650">.</span><span class="ident" id="4572651">SetString</span><span class="op" id="4572660">(</span><span class="ident" id="4572661">n</span><span class="op" id="4572662">.</span><span class="ident" id="4572663">Text</span><span class="op" id="4572667">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4572671">return</span>&nbsp;<span class="ident" id="4572678">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4572685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572688">s</span><span class="op" id="4572689">.</span><span class="ident" id="4572690">errorf</span><span class="op" id="4572696">(</span><span class="string" id="4572697">&#34;expected&nbsp;string;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4572724">,</span>&nbsp;<span class="ident" id="4572726">n</span><span class="op" id="4572727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4572730">panic</span><span class="op" id="4572735">(</span><span class="string" id="4572736">&#34;not&nbsp;reached&#34;</span><span class="op" id="4572749">)</span><br>
<span class="lineno"></span><span class="op" id="4572751">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="4572754">func</span>&nbsp;<span class="op" id="4572759">(</span><span class="ident" id="4572760">s</span>&nbsp;<span class="op" id="4572762">*</span><span class="ident" id="4572763">state</span><span class="op" id="4572768">)</span>&nbsp;<span class="ident" id="4572770">evalInteger</span><span class="op" id="4572781">(</span><span class="ident" id="4572782">typ</span>&nbsp;<span class="ident" id="4572786">reflect</span><span class="op" id="4572793">.</span><span class="ident" id="4572794">Type</span><span class="op" id="4572798">,</span>&nbsp;<span class="ident" id="4572800">n</span>&nbsp;<span class="ident" id="4572802">parse</span><span class="op" id="4572807">.</span><span class="ident" id="4572808">Node</span><span class="op" id="4572812">)</span>&nbsp;<span class="ident" id="4572814">reflect</span><span class="op" id="4572821">.</span><span class="ident" id="4572822">Value</span>&nbsp;<span class="op" id="4572828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572831">s</span><span class="op" id="4572832">.</span><span class="ident" id="4572833">at</span><span class="op" id="4572835">(</span><span class="ident" id="4572836">n</span><span class="op" id="4572837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4572840">if</span>&nbsp;<span class="ident" id="4572843">n</span><span class="op" id="4572844">,</span>&nbsp;<span class="ident" id="4572846">ok</span>&nbsp;<span class="op" id="4572849">:=</span>&nbsp;<span class="ident" id="4572852">n</span><span class="op" id="4572853">.</span><span class="op" id="4572854">(</span><span class="op" id="4572855">*</span><span class="ident" id="4572856">parse</span><span class="op" id="4572861">.</span><span class="ident" id="4572862">NumberNode</span><span class="op" id="4572872">)</span><span class="op" id="4572873">;</span>&nbsp;<span class="ident" id="4572875">ok</span>&nbsp;<span class="op" id="4572878">&amp;&amp;</span>&nbsp;<span class="ident" id="4572881">n</span><span class="op" id="4572882">.</span><span class="ident" id="4572883">IsInt</span>&nbsp;<span class="op" id="4572889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572893">value</span>&nbsp;<span class="op" id="4572899">:=</span>&nbsp;<span class="ident" id="4572902">reflect</span><span class="op" id="4572909">.</span><span class="ident" id="4572910">New</span><span class="op" id="4572913">(</span><span class="ident" id="4572914">typ</span><span class="op" id="4572917">)</span><span class="op" id="4572918">.</span><span class="ident" id="4572919">Elem</span><span class="op" id="4572923">(</span><span class="op" id="4572924">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572928">value</span><span class="op" id="4572933">.</span><span class="ident" id="4572934">SetInt</span><span class="op" id="4572940">(</span><span class="ident" id="4572941">n</span><span class="op" id="4572942">.</span><span class="ident" id="4572943">Int64</span><span class="op" id="4572948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4572952">return</span>&nbsp;<span class="ident" id="4572959">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4572966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4572969">s</span><span class="op" id="4572970">.</span><span class="ident" id="4572971">errorf</span><span class="op" id="4572977">(</span><span class="string" id="4572978">&#34;expected&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4573006">,</span>&nbsp;<span class="ident" id="4573008">n</span><span class="op" id="4573009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4573012">panic</span><span class="op" id="4573017">(</span><span class="string" id="4573018">&#34;not&nbsp;reached&#34;</span><span class="op" id="4573031">)</span><br>
<span class="lineno">695</span><span class="op" id="4573033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4573036">func</span>&nbsp;<span class="op" id="4573041">(</span><span class="ident" id="4573042">s</span>&nbsp;<span class="op" id="4573044">*</span><span class="ident" id="4573045">state</span><span class="op" id="4573050">)</span>&nbsp;<span class="ident" id="4573052">evalUnsignedInteger</span><span class="op" id="4573071">(</span><span class="ident" id="4573072">typ</span>&nbsp;<span class="ident" id="4573076">reflect</span><span class="op" id="4573083">.</span><span class="ident" id="4573084">Type</span><span class="op" id="4573088">,</span>&nbsp;<span class="ident" id="4573090">n</span>&nbsp;<span class="ident" id="4573092">parse</span><span class="op" id="4573097">.</span><span class="ident" id="4573098">Node</span><span class="op" id="4573102">)</span>&nbsp;<span class="ident" id="4573104">reflect</span><span class="op" id="4573111">.</span><span class="ident" id="4573112">Value</span>&nbsp;<span class="op" id="4573118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573121">s</span><span class="op" id="4573122">.</span><span class="ident" id="4573123">at</span><span class="op" id="4573125">(</span><span class="ident" id="4573126">n</span><span class="op" id="4573127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573130">if</span>&nbsp;<span class="ident" id="4573133">n</span><span class="op" id="4573134">,</span>&nbsp;<span class="ident" id="4573136">ok</span>&nbsp;<span class="op" id="4573139">:=</span>&nbsp;<span class="ident" id="4573142">n</span><span class="op" id="4573143">.</span><span class="op" id="4573144">(</span><span class="op" id="4573145">*</span><span class="ident" id="4573146">parse</span><span class="op" id="4573151">.</span><span class="ident" id="4573152">NumberNode</span><span class="op" id="4573162">)</span><span class="op" id="4573163">;</span>&nbsp;<span class="ident" id="4573165">ok</span>&nbsp;<span class="op" id="4573168">&amp;&amp;</span>&nbsp;<span class="ident" id="4573171">n</span><span class="op" id="4573172">.</span><span class="ident" id="4573173">IsUint</span>&nbsp;<span class="op" id="4573180">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573184">value</span>&nbsp;<span class="op" id="4573190">:=</span>&nbsp;<span class="ident" id="4573193">reflect</span><span class="op" id="4573200">.</span><span class="ident" id="4573201">New</span><span class="op" id="4573204">(</span><span class="ident" id="4573205">typ</span><span class="op" id="4573208">)</span><span class="op" id="4573209">.</span><span class="ident" id="4573210">Elem</span><span class="op" id="4573214">(</span><span class="op" id="4573215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573219">value</span><span class="op" id="4573224">.</span><span class="ident" id="4573225">SetUint</span><span class="op" id="4573232">(</span><span class="ident" id="4573233">n</span><span class="op" id="4573234">.</span><span class="ident" id="4573235">Uint64</span><span class="op" id="4573241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573245">return</span>&nbsp;<span class="ident" id="4573252">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573262">s</span><span class="op" id="4573263">.</span><span class="ident" id="4573264">errorf</span><span class="op" id="4573270">(</span><span class="string" id="4573271">&#34;expected&nbsp;unsigned&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4573308">,</span>&nbsp;<span class="ident" id="4573310">n</span><span class="op" id="4573311">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4573314">panic</span><span class="op" id="4573319">(</span><span class="string" id="4573320">&#34;not&nbsp;reached&#34;</span><span class="op" id="4573333">)</span><br>
<span class="lineno"></span><span class="op" id="4573335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4573338">func</span>&nbsp;<span class="op" id="4573343">(</span><span class="ident" id="4573344">s</span>&nbsp;<span class="op" id="4573346">*</span><span class="ident" id="4573347">state</span><span class="op" id="4573352">)</span>&nbsp;<span class="ident" id="4573354">evalFloat</span><span class="op" id="4573363">(</span><span class="ident" id="4573364">typ</span>&nbsp;<span class="ident" id="4573368">reflect</span><span class="op" id="4573375">.</span><span class="ident" id="4573376">Type</span><span class="op" id="4573380">,</span>&nbsp;<span class="ident" id="4573382">n</span>&nbsp;<span class="ident" id="4573384">parse</span><span class="op" id="4573389">.</span><span class="ident" id="4573390">Node</span><span class="op" id="4573394">)</span>&nbsp;<span class="ident" id="4573396">reflect</span><span class="op" id="4573403">.</span><span class="ident" id="4573404">Value</span>&nbsp;<span class="op" id="4573410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573413">s</span><span class="op" id="4573414">.</span><span class="ident" id="4573415">at</span><span class="op" id="4573417">(</span><span class="ident" id="4573418">n</span><span class="op" id="4573419">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573422">if</span>&nbsp;<span class="ident" id="4573425">n</span><span class="op" id="4573426">,</span>&nbsp;<span class="ident" id="4573428">ok</span>&nbsp;<span class="op" id="4573431">:=</span>&nbsp;<span class="ident" id="4573434">n</span><span class="op" id="4573435">.</span><span class="op" id="4573436">(</span><span class="op" id="4573437">*</span><span class="ident" id="4573438">parse</span><span class="op" id="4573443">.</span><span class="ident" id="4573444">NumberNode</span><span class="op" id="4573454">)</span><span class="op" id="4573455">;</span>&nbsp;<span class="ident" id="4573457">ok</span>&nbsp;<span class="op" id="4573460">&amp;&amp;</span>&nbsp;<span class="ident" id="4573463">n</span><span class="op" id="4573464">.</span><span class="ident" id="4573465">IsFloat</span>&nbsp;<span class="op" id="4573473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573477">value</span>&nbsp;<span class="op" id="4573483">:=</span>&nbsp;<span class="ident" id="4573486">reflect</span><span class="op" id="4573493">.</span><span class="ident" id="4573494">New</span><span class="op" id="4573497">(</span><span class="ident" id="4573498">typ</span><span class="op" id="4573501">)</span><span class="op" id="4573502">.</span><span class="ident" id="4573503">Elem</span><span class="op" id="4573507">(</span><span class="op" id="4573508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573512">value</span><span class="op" id="4573517">.</span><span class="ident" id="4573518">SetFloat</span><span class="op" id="4573526">(</span><span class="ident" id="4573527">n</span><span class="op" id="4573528">.</span><span class="ident" id="4573529">Float64</span><span class="op" id="4573536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573540">return</span>&nbsp;<span class="ident" id="4573547">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573554">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573557">s</span><span class="op" id="4573558">.</span><span class="ident" id="4573559">errorf</span><span class="op" id="4573565">(</span><span class="string" id="4573566">&#34;expected&nbsp;float;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4573592">,</span>&nbsp;<span class="ident" id="4573594">n</span><span class="op" id="4573595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4573598">panic</span><span class="op" id="4573603">(</span><span class="string" id="4573604">&#34;not&nbsp;reached&#34;</span><span class="op" id="4573617">)</span><br>
<span class="lineno"></span><span class="op" id="4573619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4573622">func</span>&nbsp;<span class="op" id="4573627">(</span><span class="ident" id="4573628">s</span>&nbsp;<span class="op" id="4573630">*</span><span class="ident" id="4573631">state</span><span class="op" id="4573636">)</span>&nbsp;<span class="ident" id="4573638">evalComplex</span><span class="op" id="4573649">(</span><span class="ident" id="4573650">typ</span>&nbsp;<span class="ident" id="4573654">reflect</span><span class="op" id="4573661">.</span><span class="ident" id="4573662">Type</span><span class="op" id="4573666">,</span>&nbsp;<span class="ident" id="4573668">n</span>&nbsp;<span class="ident" id="4573670">parse</span><span class="op" id="4573675">.</span><span class="ident" id="4573676">Node</span><span class="op" id="4573680">)</span>&nbsp;<span class="ident" id="4573682">reflect</span><span class="op" id="4573689">.</span><span class="ident" id="4573690">Value</span>&nbsp;<span class="op" id="4573696">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573699">if</span>&nbsp;<span class="ident" id="4573702">n</span><span class="op" id="4573703">,</span>&nbsp;<span class="ident" id="4573705">ok</span>&nbsp;<span class="op" id="4573708">:=</span>&nbsp;<span class="ident" id="4573711">n</span><span class="op" id="4573712">.</span><span class="op" id="4573713">(</span><span class="op" id="4573714">*</span><span class="ident" id="4573715">parse</span><span class="op" id="4573720">.</span><span class="ident" id="4573721">NumberNode</span><span class="op" id="4573731">)</span><span class="op" id="4573732">;</span>&nbsp;<span class="ident" id="4573734">ok</span>&nbsp;<span class="op" id="4573737">&amp;&amp;</span>&nbsp;<span class="ident" id="4573740">n</span><span class="op" id="4573741">.</span><span class="ident" id="4573742">IsComplex</span>&nbsp;<span class="op" id="4573752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573756">value</span>&nbsp;<span class="op" id="4573762">:=</span>&nbsp;<span class="ident" id="4573765">reflect</span><span class="op" id="4573772">.</span><span class="ident" id="4573773">New</span><span class="op" id="4573776">(</span><span class="ident" id="4573777">typ</span><span class="op" id="4573780">)</span><span class="op" id="4573781">.</span><span class="ident" id="4573782">Elem</span><span class="op" id="4573786">(</span><span class="op" id="4573787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573791">value</span><span class="op" id="4573796">.</span><span class="ident" id="4573797">SetComplex</span><span class="op" id="4573807">(</span><span class="ident" id="4573808">n</span><span class="op" id="4573809">.</span><span class="ident" id="4573810">Complex128</span><span class="op" id="4573820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4573824">return</span>&nbsp;<span class="ident" id="4573831">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4573838">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573841">s</span><span class="op" id="4573842">.</span><span class="ident" id="4573843">errorf</span><span class="op" id="4573849">(</span><span class="string" id="4573850">&#34;expected&nbsp;complex;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4573878">,</span>&nbsp;<span class="ident" id="4573880">n</span><span class="op" id="4573881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4573884">panic</span><span class="op" id="4573889">(</span><span class="string" id="4573890">&#34;not&nbsp;reached&#34;</span><span class="op" id="4573903">)</span><br>
<span class="lineno"></span><span class="op" id="4573905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4573908">func</span>&nbsp;<span class="op" id="4573913">(</span><span class="ident" id="4573914">s</span>&nbsp;<span class="op" id="4573916">*</span><span class="ident" id="4573917">state</span><span class="op" id="4573922">)</span>&nbsp;<span class="ident" id="4573924">evalEmptyInterface</span><span class="op" id="4573942">(</span><span class="ident" id="4573943">dot</span>&nbsp;<span class="ident" id="4573947">reflect</span><span class="op" id="4573954">.</span><span class="ident" id="4573955">Value</span><span class="op" id="4573960">,</span>&nbsp;<span class="ident" id="4573962">n</span>&nbsp;<span class="ident" id="4573964">parse</span><span class="op" id="4573969">.</span><span class="ident" id="4573970">Node</span><span class="op" id="4573974">)</span>&nbsp;<span class="ident" id="4573976">reflect</span><span class="op" id="4573983">.</span><span class="ident" id="4573984">Value</span>&nbsp;<span class="op" id="4573990">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4573993">s</span><span class="op" id="4573994">.</span><span class="ident" id="4573995">at</span><span class="op" id="4573997">(</span><span class="ident" id="4573998">n</span><span class="op" id="4573999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574002">switch</span>&nbsp;<span class="ident" id="4574009">n</span>&nbsp;<span class="op" id="4574011">:=</span>&nbsp;<span class="ident" id="4574014">n</span><span class="op" id="4574015">.</span><span class="op" id="4574016">(</span><span class="keyword" id="4574017">type</span><span class="op" id="4574021">)</span>&nbsp;<span class="op" id="4574023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574026">case</span>&nbsp;<span class="op" id="4574031">*</span><span class="ident" id="4574032">parse</span><span class="op" id="4574037">.</span><span class="ident" id="4574038">BoolNode</span><span class="op" id="4574046">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574050">return</span>&nbsp;<span class="ident" id="4574057">reflect</span><span class="op" id="4574064">.</span><span class="ident" id="4574065">ValueOf</span><span class="op" id="4574072">(</span><span class="ident" id="4574073">n</span><span class="op" id="4574074">.</span><span class="ident" id="4574075">True</span><span class="op" id="4574079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574082">case</span>&nbsp;<span class="op" id="4574087">*</span><span class="ident" id="4574088">parse</span><span class="op" id="4574093">.</span><span class="ident" id="4574094">DotNode</span><span class="op" id="4574101">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574105">return</span>&nbsp;<span class="ident" id="4574112">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574117">case</span>&nbsp;<span class="op" id="4574122">*</span><span class="ident" id="4574123">parse</span><span class="op" id="4574128">.</span><span class="ident" id="4574129">FieldNode</span><span class="op" id="4574138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574142">return</span>&nbsp;<span class="ident" id="4574149">s</span><span class="op" id="4574150">.</span><span class="ident" id="4574151">evalFieldNode</span><span class="op" id="4574164">(</span><span class="ident" id="4574165">dot</span><span class="op" id="4574168">,</span>&nbsp;<span class="ident" id="4574170">n</span><span class="op" id="4574171">,</span>&nbsp;<span class="ident" id="4574173">nil</span><span class="op" id="4574176">,</span>&nbsp;<span class="ident" id="4574178">zero</span><span class="op" id="4574182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574185">case</span>&nbsp;<span class="op" id="4574190">*</span><span class="ident" id="4574191">parse</span><span class="op" id="4574196">.</span><span class="ident" id="4574197">IdentifierNode</span><span class="op" id="4574211">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574215">return</span>&nbsp;<span class="ident" id="4574222">s</span><span class="op" id="4574223">.</span><span class="ident" id="4574224">evalFunction</span><span class="op" id="4574236">(</span><span class="ident" id="4574237">dot</span><span class="op" id="4574240">,</span>&nbsp;<span class="ident" id="4574242">n</span><span class="op" id="4574243">,</span>&nbsp;<span class="ident" id="4574245">n</span><span class="op" id="4574246">,</span>&nbsp;<span class="ident" id="4574248">nil</span><span class="op" id="4574251">,</span>&nbsp;<span class="ident" id="4574253">zero</span><span class="op" id="4574257">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574260">case</span>&nbsp;<span class="op" id="4574265">*</span><span class="ident" id="4574266">parse</span><span class="op" id="4574271">.</span><span class="ident" id="4574272">NilNode</span><span class="op" id="4574279">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4574283">//&nbsp;NilNode&nbsp;is&nbsp;handled&nbsp;in&nbsp;evalArg,&nbsp;the&nbsp;only&nbsp;place&nbsp;that&nbsp;calls&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574351">s</span><span class="op" id="4574352">.</span><span class="ident" id="4574353">errorf</span><span class="op" id="4574359">(</span><span class="string" id="4574360">&#34;evalEmptyInterface:&nbsp;nil&nbsp;(can&#39;t&nbsp;happen)&#34;</span><span class="op" id="4574400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574403">case</span>&nbsp;<span class="op" id="4574408">*</span><span class="ident" id="4574409">parse</span><span class="op" id="4574414">.</span><span class="ident" id="4574415">NumberNode</span><span class="op" id="4574425">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574429">return</span>&nbsp;<span class="ident" id="4574436">s</span><span class="op" id="4574437">.</span><span class="ident" id="4574438">idealConstant</span><span class="op" id="4574451">(</span><span class="ident" id="4574452">n</span><span class="op" id="4574453">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574456">case</span>&nbsp;<span class="op" id="4574461">*</span><span class="ident" id="4574462">parse</span><span class="op" id="4574467">.</span><span class="ident" id="4574468">StringNode</span><span class="op" id="4574478">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574482">return</span>&nbsp;<span class="ident" id="4574489">reflect</span><span class="op" id="4574496">.</span><span class="ident" id="4574497">ValueOf</span><span class="op" id="4574504">(</span><span class="ident" id="4574505">n</span><span class="op" id="4574506">.</span><span class="ident" id="4574507">Text</span><span class="op" id="4574511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574514">case</span>&nbsp;<span class="op" id="4574519">*</span><span class="ident" id="4574520">parse</span><span class="op" id="4574525">.</span><span class="ident" id="4574526">VariableNode</span><span class="op" id="4574538">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574542">return</span>&nbsp;<span class="ident" id="4574549">s</span><span class="op" id="4574550">.</span><span class="ident" id="4574551">evalVariableNode</span><span class="op" id="4574567">(</span><span class="ident" id="4574568">dot</span><span class="op" id="4574571">,</span>&nbsp;<span class="ident" id="4574573">n</span><span class="op" id="4574574">,</span>&nbsp;<span class="ident" id="4574576">nil</span><span class="op" id="4574579">,</span>&nbsp;<span class="ident" id="4574581">zero</span><span class="op" id="4574585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574588">case</span>&nbsp;<span class="op" id="4574593">*</span><span class="ident" id="4574594">parse</span><span class="op" id="4574599">.</span><span class="ident" id="4574600">PipeNode</span><span class="op" id="4574608">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4574612">return</span>&nbsp;<span class="ident" id="4574619">s</span><span class="op" id="4574620">.</span><span class="ident" id="4574621">evalPipeline</span><span class="op" id="4574633">(</span><span class="ident" id="4574634">dot</span><span class="op" id="4574637">,</span>&nbsp;<span class="ident" id="4574639">n</span><span class="op" id="4574640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4574643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4574646">s</span><span class="op" id="4574647">.</span><span class="ident" id="4574648">errorf</span><span class="op" id="4574654">(</span><span class="string" id="4574655">&#34;can&#39;t&nbsp;handle&nbsp;assignment&nbsp;of&nbsp;%s&nbsp;to&nbsp;empty&nbsp;interface&nbsp;argument&#34;</span><span class="op" id="4574714">,</span>&nbsp;<span class="ident" id="4574716">n</span><span class="op" id="4574717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4574720">panic</span><span class="op" id="4574725">(</span><span class="string" id="4574726">&#34;not&nbsp;reached&#34;</span><span class="op" id="4574739">)</span><br>
<span class="lineno"></span><span class="op" id="4574741">}</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="comment" id="4574744">//&nbsp;indirect&nbsp;returns&nbsp;the&nbsp;item&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;indirection,&nbsp;and&nbsp;a&nbsp;bool&nbsp;to&nbsp;indicate&nbsp;if&nbsp;it&#39;s&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="4574836">//&nbsp;We&nbsp;indirect&nbsp;through&nbsp;pointers&nbsp;and&nbsp;empty&nbsp;interfaces&nbsp;(only)&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="4574904">//&nbsp;non-empty&nbsp;interfaces&nbsp;have&nbsp;methods&nbsp;we&nbsp;might&nbsp;need.</span><br>
<span class="lineno"></span><span class="keyword" id="4574956">func</span>&nbsp;<span class="ident" id="4574961">indirect</span><span class="op" id="4574969">(</span><span class="ident" id="4574970">v</span>&nbsp;<span class="ident" id="4574972">reflect</span><span class="op" id="4574979">.</span><span class="ident" id="4574980">Value</span><span class="op" id="4574985">)</span>&nbsp;<span class="op" id="4574987">(</span><span class="ident" id="4574988">rv</span>&nbsp;<span class="ident" id="4574991">reflect</span><span class="op" id="4574998">.</span><span class="ident" id="4574999">Value</span><span class="op" id="4575004">,</span>&nbsp;<span class="ident" id="4575006">isNil</span>&nbsp;<span class="builtintype" id="4575012">bool</span><span class="op" id="4575016">)</span>&nbsp;<span class="op" id="4575018">{</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575021">for</span>&nbsp;<span class="op" id="4575025">;</span>&nbsp;<span class="ident" id="4575027">v</span><span class="op" id="4575028">.</span><span class="ident" id="4575029">Kind</span><span class="op" id="4575033">(</span><span class="op" id="4575034">)</span>&nbsp;<span class="op" id="4575036">==</span>&nbsp;<span class="ident" id="4575039">reflect</span><span class="op" id="4575046">.</span><span class="ident" id="4575047">Ptr</span>&nbsp;<span class="op" id="4575051">||</span>&nbsp;<span class="ident" id="4575054">v</span><span class="op" id="4575055">.</span><span class="ident" id="4575056">Kind</span><span class="op" id="4575060">(</span><span class="op" id="4575061">)</span>&nbsp;<span class="op" id="4575063">==</span>&nbsp;<span class="ident" id="4575066">reflect</span><span class="op" id="4575073">.</span><span class="ident" id="4575074">Interface</span><span class="op" id="4575083">;</span>&nbsp;<span class="ident" id="4575085">v</span>&nbsp;<span class="op" id="4575087">=</span>&nbsp;<span class="ident" id="4575089">v</span><span class="op" id="4575090">.</span><span class="ident" id="4575091">Elem</span><span class="op" id="4575095">(</span><span class="op" id="4575096">)</span>&nbsp;<span class="op" id="4575098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575102">if</span>&nbsp;<span class="ident" id="4575105">v</span><span class="op" id="4575106">.</span><span class="ident" id="4575107">IsNil</span><span class="op" id="4575112">(</span><span class="op" id="4575113">)</span>&nbsp;<span class="op" id="4575115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575120">return</span>&nbsp;<span class="ident" id="4575127">v</span><span class="op" id="4575128">,</span>&nbsp;<span class="builtintype" id="4575130">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4575137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575141">if</span>&nbsp;<span class="ident" id="4575144">v</span><span class="op" id="4575145">.</span><span class="ident" id="4575146">Kind</span><span class="op" id="4575150">(</span><span class="op" id="4575151">)</span>&nbsp;<span class="op" id="4575153">==</span>&nbsp;<span class="ident" id="4575156">reflect</span><span class="op" id="4575163">.</span><span class="ident" id="4575164">Interface</span>&nbsp;<span class="op" id="4575174">&amp;&amp;</span>&nbsp;<span class="ident" id="4575177">v</span><span class="op" id="4575178">.</span><span class="ident" id="4575179">NumMethod</span><span class="op" id="4575188">(</span><span class="op" id="4575189">)</span>&nbsp;<span class="op" id="4575191">&gt;</span>&nbsp;<span class="num" id="4575193">0</span>&nbsp;<span class="op" id="4575195">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575200">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4575208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4575211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575214">return</span>&nbsp;<span class="ident" id="4575221">v</span><span class="op" id="4575222">,</span>&nbsp;<span class="builtintype" id="4575224">false</span><br>
<span class="lineno"></span><span class="op" id="4575230">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="comment" id="4575233">//&nbsp;printValue&nbsp;writes&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of&nbsp;the&nbsp;value&nbsp;to&nbsp;the&nbsp;output&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4575311">//&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4575328">func</span>&nbsp;<span class="op" id="4575333">(</span><span class="ident" id="4575334">s</span>&nbsp;<span class="op" id="4575336">*</span><span class="ident" id="4575337">state</span><span class="op" id="4575342">)</span>&nbsp;<span class="ident" id="4575344">printValue</span><span class="op" id="4575354">(</span><span class="ident" id="4575355">n</span>&nbsp;<span class="ident" id="4575357">parse</span><span class="op" id="4575362">.</span><span class="ident" id="4575363">Node</span><span class="op" id="4575367">,</span>&nbsp;<span class="ident" id="4575369">v</span>&nbsp;<span class="ident" id="4575371">reflect</span><span class="op" id="4575378">.</span><span class="ident" id="4575379">Value</span><span class="op" id="4575384">)</span>&nbsp;<span class="op" id="4575386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575389">s</span><span class="op" id="4575390">.</span><span class="ident" id="4575391">at</span><span class="op" id="4575393">(</span><span class="ident" id="4575394">n</span><span class="op" id="4575395">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575398">iface</span><span class="op" id="4575403">,</span>&nbsp;<span class="ident" id="4575405">ok</span>&nbsp;<span class="op" id="4575408">:=</span>&nbsp;<span class="ident" id="4575411">printableValue</span><span class="op" id="4575425">(</span><span class="ident" id="4575426">v</span><span class="op" id="4575427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575430">if</span>&nbsp;<span class="op" id="4575433">!</span><span class="ident" id="4575434">ok</span>&nbsp;<span class="op" id="4575437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575441">s</span><span class="op" id="4575442">.</span><span class="ident" id="4575443">errorf</span><span class="op" id="4575449">(</span><span class="string" id="4575450">&#34;can&#39;t&nbsp;print&nbsp;%s&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4575477">,</span>&nbsp;<span class="ident" id="4575479">n</span><span class="op" id="4575480">,</span>&nbsp;<span class="ident" id="4575482">v</span><span class="op" id="4575483">.</span><span class="ident" id="4575484">Type</span><span class="op" id="4575488">(</span><span class="op" id="4575489">)</span><span class="op" id="4575490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4575493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575496">fmt</span><span class="op" id="4575499">.</span><span class="ident" id="4575500">Fprint</span><span class="op" id="4575506">(</span><span class="ident" id="4575507">s</span><span class="op" id="4575508">.</span><span class="ident" id="4575509">wr</span><span class="op" id="4575511">,</span>&nbsp;<span class="ident" id="4575513">iface</span><span class="op" id="4575518">)</span><br>
<span class="lineno">780</span><span class="op" id="4575520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4575523">//&nbsp;printableValue&nbsp;returns&nbsp;the,&nbsp;possibly&nbsp;indirected,&nbsp;interface&nbsp;value&nbsp;inside&nbsp;v&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4575605">//&nbsp;is&nbsp;best&nbsp;for&nbsp;a&nbsp;call&nbsp;to&nbsp;formatted&nbsp;printer.</span><br>
<span class="lineno"></span><span class="keyword" id="4575649">func</span>&nbsp;<span class="ident" id="4575654">printableValue</span><span class="op" id="4575668">(</span><span class="ident" id="4575669">v</span>&nbsp;<span class="ident" id="4575671">reflect</span><span class="op" id="4575678">.</span><span class="ident" id="4575679">Value</span><span class="op" id="4575684">)</span>&nbsp;<span class="op" id="4575686">(</span><span class="keyword" id="4575687">interface</span><span class="op" id="4575696">{</span><span class="op" id="4575697">}</span><span class="op" id="4575698">,</span>&nbsp;<span class="builtintype" id="4575700">bool</span><span class="op" id="4575704">)</span>&nbsp;<span class="op" id="4575706">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575709">if</span>&nbsp;<span class="ident" id="4575712">v</span><span class="op" id="4575713">.</span><span class="ident" id="4575714">Kind</span><span class="op" id="4575718">(</span><span class="op" id="4575719">)</span>&nbsp;<span class="op" id="4575721">==</span>&nbsp;<span class="ident" id="4575724">reflect</span><span class="op" id="4575731">.</span><span class="ident" id="4575732">Ptr</span>&nbsp;<span class="op" id="4575736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4575740">v</span><span class="op" id="4575741">,</span>&nbsp;<span class="ident" id="4575743">_</span>&nbsp;<span class="op" id="4575745">=</span>&nbsp;<span class="ident" id="4575747">indirect</span><span class="op" id="4575755">(</span><span class="ident" id="4575756">v</span><span class="op" id="4575757">)</span>&nbsp;<span class="comment" id="4575759">//&nbsp;fmt.Fprint&nbsp;handles&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4575787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575790">if</span>&nbsp;<span class="op" id="4575793">!</span><span class="ident" id="4575794">v</span><span class="op" id="4575795">.</span><span class="ident" id="4575796">IsValid</span><span class="op" id="4575803">(</span><span class="op" id="4575804">)</span>&nbsp;<span class="op" id="4575806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575810">return</span>&nbsp;<span class="string" id="4575817">&#34;&lt;no&nbsp;value&gt;&#34;</span><span class="op" id="4575829">,</span>&nbsp;<span class="builtintype" id="4575831">true</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4575837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575841">if</span>&nbsp;<span class="op" id="4575844">!</span><span class="ident" id="4575845">v</span><span class="op" id="4575846">.</span><span class="ident" id="4575847">Type</span><span class="op" id="4575851">(</span><span class="op" id="4575852">)</span><span class="op" id="4575853">.</span><span class="ident" id="4575854">Implements</span><span class="op" id="4575864">(</span><span class="ident" id="4575865">errorType</span><span class="op" id="4575874">)</span>&nbsp;<span class="op" id="4575876">&amp;&amp;</span>&nbsp;<span class="op" id="4575879">!</span><span class="ident" id="4575880">v</span><span class="op" id="4575881">.</span><span class="ident" id="4575882">Type</span><span class="op" id="4575886">(</span><span class="op" id="4575887">)</span><span class="op" id="4575888">.</span><span class="ident" id="4575889">Implements</span><span class="op" id="4575899">(</span><span class="ident" id="4575900">fmtStringerType</span><span class="op" id="4575915">)</span>&nbsp;<span class="op" id="4575917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4575921">if</span>&nbsp;<span class="ident" id="4575924">v</span><span class="op" id="4575925">.</span><span class="ident" id="4575926">CanAddr</span><span class="op" id="4575933">(</span><span class="op" id="4575934">)</span>&nbsp;<span class="op" id="4575936">&amp;&amp;</span>&nbsp;<span class="op" id="4575939">(</span><span class="ident" id="4575940">reflect</span><span class="op" id="4575947">.</span><span class="ident" id="4575948">PtrTo</span><span class="op" id="4575953">(</span><span class="ident" id="4575954">v</span><span class="op" id="4575955">.</span><span class="ident" id="4575956">Type</span><span class="op" id="4575960">(</span><span class="op" id="4575961">)</span><span class="op" id="4575962">)</span><span class="op" id="4575963">.</span><span class="ident" id="4575964">Implements</span><span class="op" id="4575974">(</span><span class="ident" id="4575975">errorType</span><span class="op" id="4575984">)</span>&nbsp;<span class="op" id="4575986">||</span>&nbsp;<span class="ident" id="4575989">reflect</span><span class="op" id="4575996">.</span><span class="ident" id="4575997">PtrTo</span><span class="op" id="4576002">(</span><span class="ident" id="4576003">v</span><span class="op" id="4576004">.</span><span class="ident" id="4576005">Type</span><span class="op" id="4576009">(</span><span class="op" id="4576010">)</span><span class="op" id="4576011">)</span><span class="op" id="4576012">.</span><span class="ident" id="4576013">Implements</span><span class="op" id="4576023">(</span><span class="ident" id="4576024">fmtStringerType</span><span class="op" id="4576039">)</span><span class="op" id="4576040">)</span>&nbsp;<span class="op" id="4576042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4576047">v</span>&nbsp;<span class="op" id="4576049">=</span>&nbsp;<span class="ident" id="4576051">v</span><span class="op" id="4576052">.</span><span class="ident" id="4576053">Addr</span><span class="op" id="4576057">(</span><span class="op" id="4576058">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4576062">}</span>&nbsp;<span class="keyword" id="4576064">else</span>&nbsp;<span class="op" id="4576069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576074">switch</span>&nbsp;<span class="ident" id="4576081">v</span><span class="op" id="4576082">.</span><span class="ident" id="4576083">Kind</span><span class="op" id="4576087">(</span><span class="op" id="4576088">)</span>&nbsp;<span class="op" id="4576090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576095">case</span>&nbsp;<span class="ident" id="4576100">reflect</span><span class="op" id="4576107">.</span><span class="ident" id="4576108">Chan</span><span class="op" id="4576112">,</span>&nbsp;<span class="ident" id="4576114">reflect</span><span class="op" id="4576121">.</span><span class="ident" id="4576122">Func</span><span class="op" id="4576126">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576132">return</span>&nbsp;<span class="ident" id="4576139">nil</span><span class="op" id="4576142">,</span>&nbsp;<span class="builtintype" id="4576144">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4576153">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4576157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4576160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576163">return</span>&nbsp;<span class="ident" id="4576170">v</span><span class="op" id="4576171">.</span><span class="ident" id="4576172">Interface</span><span class="op" id="4576181">(</span><span class="op" id="4576182">)</span><span class="op" id="4576183">,</span>&nbsp;<span class="builtintype" id="4576185">true</span><br>
<span class="lineno"></span><span class="op" id="4576190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="comment" id="4576193">//&nbsp;Types&nbsp;to&nbsp;help&nbsp;sort&nbsp;the&nbsp;keys&nbsp;in&nbsp;a&nbsp;map&nbsp;for&nbsp;reproducible&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4576259">type</span>&nbsp;<span class="ident" id="4576264">rvs</span>&nbsp;<span class="op" id="4576268">[</span><span class="op" id="4576269">]</span><span class="ident" id="4576270">reflect</span><span class="op" id="4576277">.</span><span class="ident" id="4576278">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4576285">func</span>&nbsp;<span class="op" id="4576290">(</span><span class="ident" id="4576291">x</span>&nbsp;<span class="ident" id="4576293">rvs</span><span class="op" id="4576296">)</span>&nbsp;<span class="ident" id="4576298">Len</span><span class="op" id="4576301">(</span><span class="op" id="4576302">)</span>&nbsp;<span class="builtintype" id="4576304">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576313">{</span>&nbsp;<span class="keyword" id="4576315">return</span>&nbsp;<span class="builtinfunc" id="4576322">len</span><span class="op" id="4576325">(</span><span class="ident" id="4576326">x</span><span class="op" id="4576327">)</span>&nbsp;<span class="op" id="4576329">}</span><br>
<span class="lineno">810</span><span class="keyword" id="4576331">func</span>&nbsp;<span class="op" id="4576336">(</span><span class="ident" id="4576337">x</span>&nbsp;<span class="ident" id="4576339">rvs</span><span class="op" id="4576342">)</span>&nbsp;<span class="ident" id="4576344">Swap</span><span class="op" id="4576348">(</span><span class="ident" id="4576349">i</span><span class="op" id="4576350">,</span>&nbsp;<span class="ident" id="4576352">j</span>&nbsp;<span class="builtintype" id="4576354">int</span><span class="op" id="4576357">)</span>&nbsp;<span class="op" id="4576359">{</span>&nbsp;<span class="ident" id="4576361">x</span><span class="op" id="4576362">[</span><span class="ident" id="4576363">i</span><span class="op" id="4576364">]</span><span class="op" id="4576365">,</span>&nbsp;<span class="ident" id="4576367">x</span><span class="op" id="4576368">[</span><span class="ident" id="4576369">j</span><span class="op" id="4576370">]</span>&nbsp;<span class="op" id="4576372">=</span>&nbsp;<span class="ident" id="4576374">x</span><span class="op" id="4576375">[</span><span class="ident" id="4576376">j</span><span class="op" id="4576377">]</span><span class="op" id="4576378">,</span>&nbsp;<span class="ident" id="4576380">x</span><span class="op" id="4576381">[</span><span class="ident" id="4576382">i</span><span class="op" id="4576383">]</span>&nbsp;<span class="op" id="4576385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4576388">type</span>&nbsp;<span class="ident" id="4576393">rvInts</span>&nbsp;<span class="keyword" id="4576400">struct</span><span class="op" id="4576406">{</span>&nbsp;<span class="ident" id="4576408">rvs</span>&nbsp;<span class="op" id="4576412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4576415">func</span>&nbsp;<span class="op" id="4576420">(</span><span class="ident" id="4576421">x</span>&nbsp;<span class="ident" id="4576423">rvInts</span><span class="op" id="4576429">)</span>&nbsp;<span class="ident" id="4576431">Less</span><span class="op" id="4576435">(</span><span class="ident" id="4576436">i</span><span class="op" id="4576437">,</span>&nbsp;<span class="ident" id="4576439">j</span>&nbsp;<span class="builtintype" id="4576441">int</span><span class="op" id="4576444">)</span>&nbsp;<span class="builtintype" id="4576446">bool</span>&nbsp;<span class="op" id="4576451">{</span>&nbsp;<span class="keyword" id="4576453">return</span>&nbsp;<span class="ident" id="4576460">x</span><span class="op" id="4576461">.</span><span class="ident" id="4576462">rvs</span><span class="op" id="4576465">[</span><span class="ident" id="4576466">i</span><span class="op" id="4576467">]</span><span class="op" id="4576468">.</span><span class="ident" id="4576469">Int</span><span class="op" id="4576472">(</span><span class="op" id="4576473">)</span>&nbsp;<span class="op" id="4576475">&lt;</span>&nbsp;<span class="ident" id="4576477">x</span><span class="op" id="4576478">.</span><span class="ident" id="4576479">rvs</span><span class="op" id="4576482">[</span><span class="ident" id="4576483">j</span><span class="op" id="4576484">]</span><span class="op" id="4576485">.</span><span class="ident" id="4576486">Int</span><span class="op" id="4576489">(</span><span class="op" id="4576490">)</span>&nbsp;<span class="op" id="4576492">}</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="keyword" id="4576495">type</span>&nbsp;<span class="ident" id="4576500">rvUints</span>&nbsp;<span class="keyword" id="4576508">struct</span><span class="op" id="4576514">{</span>&nbsp;<span class="ident" id="4576516">rvs</span>&nbsp;<span class="op" id="4576520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4576523">func</span>&nbsp;<span class="op" id="4576528">(</span><span class="ident" id="4576529">x</span>&nbsp;<span class="ident" id="4576531">rvUints</span><span class="op" id="4576538">)</span>&nbsp;<span class="ident" id="4576540">Less</span><span class="op" id="4576544">(</span><span class="ident" id="4576545">i</span><span class="op" id="4576546">,</span>&nbsp;<span class="ident" id="4576548">j</span>&nbsp;<span class="builtintype" id="4576550">int</span><span class="op" id="4576553">)</span>&nbsp;<span class="builtintype" id="4576555">bool</span>&nbsp;<span class="op" id="4576560">{</span>&nbsp;<span class="keyword" id="4576562">return</span>&nbsp;<span class="ident" id="4576569">x</span><span class="op" id="4576570">.</span><span class="ident" id="4576571">rvs</span><span class="op" id="4576574">[</span><span class="ident" id="4576575">i</span><span class="op" id="4576576">]</span><span class="op" id="4576577">.</span><span class="ident" id="4576578">Uint</span><span class="op" id="4576582">(</span><span class="op" id="4576583">)</span>&nbsp;<span class="op" id="4576585">&lt;</span>&nbsp;<span class="ident" id="4576587">x</span><span class="op" id="4576588">.</span><span class="ident" id="4576589">rvs</span><span class="op" id="4576592">[</span><span class="ident" id="4576593">j</span><span class="op" id="4576594">]</span><span class="op" id="4576595">.</span><span class="ident" id="4576596">Uint</span><span class="op" id="4576600">(</span><span class="op" id="4576601">)</span>&nbsp;<span class="op" id="4576603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span><span class="keyword" id="4576606">type</span>&nbsp;<span class="ident" id="4576611">rvFloats</span>&nbsp;<span class="keyword" id="4576620">struct</span><span class="op" id="4576626">{</span>&nbsp;<span class="ident" id="4576628">rvs</span>&nbsp;<span class="op" id="4576632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4576635">func</span>&nbsp;<span class="op" id="4576640">(</span><span class="ident" id="4576641">x</span>&nbsp;<span class="ident" id="4576643">rvFloats</span><span class="op" id="4576651">)</span>&nbsp;<span class="ident" id="4576653">Less</span><span class="op" id="4576657">(</span><span class="ident" id="4576658">i</span><span class="op" id="4576659">,</span>&nbsp;<span class="ident" id="4576661">j</span>&nbsp;<span class="builtintype" id="4576663">int</span><span class="op" id="4576666">)</span>&nbsp;<span class="builtintype" id="4576668">bool</span>&nbsp;<span class="op" id="4576673">{</span>&nbsp;<span class="keyword" id="4576675">return</span>&nbsp;<span class="ident" id="4576682">x</span><span class="op" id="4576683">.</span><span class="ident" id="4576684">rvs</span><span class="op" id="4576687">[</span><span class="ident" id="4576688">i</span><span class="op" id="4576689">]</span><span class="op" id="4576690">.</span><span class="ident" id="4576691">Float</span><span class="op" id="4576696">(</span><span class="op" id="4576697">)</span>&nbsp;<span class="op" id="4576699">&lt;</span>&nbsp;<span class="ident" id="4576701">x</span><span class="op" id="4576702">.</span><span class="ident" id="4576703">rvs</span><span class="op" id="4576706">[</span><span class="ident" id="4576707">j</span><span class="op" id="4576708">]</span><span class="op" id="4576709">.</span><span class="ident" id="4576710">Float</span><span class="op" id="4576715">(</span><span class="op" id="4576716">)</span>&nbsp;<span class="op" id="4576718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4576721">type</span>&nbsp;<span class="ident" id="4576726">rvStrings</span>&nbsp;<span class="keyword" id="4576736">struct</span><span class="op" id="4576742">{</span>&nbsp;<span class="ident" id="4576744">rvs</span>&nbsp;<span class="op" id="4576748">}</span><br>
<span class="lineno">825</span><br>
<span class="lineno"></span><span class="keyword" id="4576751">func</span>&nbsp;<span class="op" id="4576756">(</span><span class="ident" id="4576757">x</span>&nbsp;<span class="ident" id="4576759">rvStrings</span><span class="op" id="4576768">)</span>&nbsp;<span class="ident" id="4576770">Less</span><span class="op" id="4576774">(</span><span class="ident" id="4576775">i</span><span class="op" id="4576776">,</span>&nbsp;<span class="ident" id="4576778">j</span>&nbsp;<span class="builtintype" id="4576780">int</span><span class="op" id="4576783">)</span>&nbsp;<span class="builtintype" id="4576785">bool</span>&nbsp;<span class="op" id="4576790">{</span>&nbsp;<span class="keyword" id="4576792">return</span>&nbsp;<span class="ident" id="4576799">x</span><span class="op" id="4576800">.</span><span class="ident" id="4576801">rvs</span><span class="op" id="4576804">[</span><span class="ident" id="4576805">i</span><span class="op" id="4576806">]</span><span class="op" id="4576807">.</span><span class="ident" id="4576808">String</span><span class="op" id="4576814">(</span><span class="op" id="4576815">)</span>&nbsp;<span class="op" id="4576817">&lt;</span>&nbsp;<span class="ident" id="4576819">x</span><span class="op" id="4576820">.</span><span class="ident" id="4576821">rvs</span><span class="op" id="4576824">[</span><span class="ident" id="4576825">j</span><span class="op" id="4576826">]</span><span class="op" id="4576827">.</span><span class="ident" id="4576828">String</span><span class="op" id="4576834">(</span><span class="op" id="4576835">)</span>&nbsp;<span class="op" id="4576837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4576840">//&nbsp;sortKeys&nbsp;sorts&nbsp;(if&nbsp;it&nbsp;can)&nbsp;the&nbsp;slice&nbsp;of&nbsp;reflect.Values,&nbsp;which&nbsp;is&nbsp;a&nbsp;slice&nbsp;of&nbsp;map&nbsp;keys.</span><br>
<span class="lineno"></span><span class="keyword" id="4576929">func</span>&nbsp;<span class="ident" id="4576934">sortKeys</span><span class="op" id="4576942">(</span><span class="ident" id="4576943">v</span>&nbsp;<span class="op" id="4576945">[</span><span class="op" id="4576946">]</span><span class="ident" id="4576947">reflect</span><span class="op" id="4576954">.</span><span class="ident" id="4576955">Value</span><span class="op" id="4576960">)</span>&nbsp;<span class="op" id="4576962">[</span><span class="op" id="4576963">]</span><span class="ident" id="4576964">reflect</span><span class="op" id="4576971">.</span><span class="ident" id="4576972">Value</span>&nbsp;<span class="op" id="4576978">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4576981">if</span>&nbsp;<span class="builtinfunc" id="4576984">len</span><span class="op" id="4576987">(</span><span class="ident" id="4576988">v</span><span class="op" id="4576989">)</span>&nbsp;<span class="op" id="4576991">&lt;=</span>&nbsp;<span class="num" id="4576994">1</span>&nbsp;<span class="op" id="4576996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577000">return</span>&nbsp;<span class="ident" id="4577007">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4577010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577013">switch</span>&nbsp;<span class="ident" id="4577020">v</span><span class="op" id="4577021">[</span><span class="num" id="4577022">0</span><span class="op" id="4577023">]</span><span class="op" id="4577024">.</span><span class="ident" id="4577025">Kind</span><span class="op" id="4577029">(</span><span class="op" id="4577030">)</span>&nbsp;<span class="op" id="4577032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577035">case</span>&nbsp;<span class="ident" id="4577040">reflect</span><span class="op" id="4577047">.</span><span class="ident" id="4577048">Float32</span><span class="op" id="4577055">,</span>&nbsp;<span class="ident" id="4577057">reflect</span><span class="op" id="4577064">.</span><span class="ident" id="4577065">Float64</span><span class="op" id="4577072">:</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577076">sort</span><span class="op" id="4577080">.</span><span class="ident" id="4577081">Sort</span><span class="op" id="4577085">(</span><span class="ident" id="4577086">rvFloats</span><span class="op" id="4577094">{</span><span class="ident" id="4577095">v</span><span class="op" id="4577096">}</span><span class="op" id="4577097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577100">case</span>&nbsp;<span class="ident" id="4577105">reflect</span><span class="op" id="4577112">.</span><span class="ident" id="4577113">Int</span><span class="op" id="4577116">,</span>&nbsp;<span class="ident" id="4577118">reflect</span><span class="op" id="4577125">.</span><span class="ident" id="4577126">Int8</span><span class="op" id="4577130">,</span>&nbsp;<span class="ident" id="4577132">reflect</span><span class="op" id="4577139">.</span><span class="ident" id="4577140">Int16</span><span class="op" id="4577145">,</span>&nbsp;<span class="ident" id="4577147">reflect</span><span class="op" id="4577154">.</span><span class="ident" id="4577155">Int32</span><span class="op" id="4577160">,</span>&nbsp;<span class="ident" id="4577162">reflect</span><span class="op" id="4577169">.</span><span class="ident" id="4577170">Int64</span><span class="op" id="4577175">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577179">sort</span><span class="op" id="4577183">.</span><span class="ident" id="4577184">Sort</span><span class="op" id="4577188">(</span><span class="ident" id="4577189">rvInts</span><span class="op" id="4577195">{</span><span class="ident" id="4577196">v</span><span class="op" id="4577197">}</span><span class="op" id="4577198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577201">case</span>&nbsp;<span class="ident" id="4577206">reflect</span><span class="op" id="4577213">.</span><span class="ident" id="4577214">String</span><span class="op" id="4577220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577224">sort</span><span class="op" id="4577228">.</span><span class="ident" id="4577229">Sort</span><span class="op" id="4577233">(</span><span class="ident" id="4577234">rvStrings</span><span class="op" id="4577243">{</span><span class="ident" id="4577244">v</span><span class="op" id="4577245">}</span><span class="op" id="4577246">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577249">case</span>&nbsp;<span class="ident" id="4577254">reflect</span><span class="op" id="4577261">.</span><span class="ident" id="4577262">Uint</span><span class="op" id="4577266">,</span>&nbsp;<span class="ident" id="4577268">reflect</span><span class="op" id="4577275">.</span><span class="ident" id="4577276">Uint8</span><span class="op" id="4577281">,</span>&nbsp;<span class="ident" id="4577283">reflect</span><span class="op" id="4577290">.</span><span class="ident" id="4577291">Uint16</span><span class="op" id="4577297">,</span>&nbsp;<span class="ident" id="4577299">reflect</span><span class="op" id="4577306">.</span><span class="ident" id="4577307">Uint32</span><span class="op" id="4577313">,</span>&nbsp;<span class="ident" id="4577315">reflect</span><span class="op" id="4577322">.</span><span class="ident" id="4577323">Uint64</span><span class="op" id="4577329">,</span>&nbsp;<span class="ident" id="4577331">reflect</span><span class="op" id="4577338">.</span><span class="ident" id="4577339">Uintptr</span><span class="op" id="4577346">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4577350">sort</span><span class="op" id="4577354">.</span><span class="ident" id="4577355">Sort</span><span class="op" id="4577359">(</span><span class="ident" id="4577360">rvUints</span><span class="op" id="4577367">{</span><span class="ident" id="4577368">v</span><span class="op" id="4577369">}</span><span class="op" id="4577370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4577373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4577376">return</span>&nbsp;<span class="ident" id="4577383">v</span><br>
<span class="lineno"></span><span class="op" id="4577385">}</span>
</div>
</body>
</html>
