<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html" class="current">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2387002">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2387058">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2387112">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2387163">//&nbsp;Linux&nbsp;socket&nbsp;filter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2387187">package</span>&nbsp;<span class="ident" id="2387195">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2387204">import</span>&nbsp;<span class="op" id="2387211">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2387214">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2387223">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2387226">func</span>&nbsp;<span class="ident" id="2387231">LsfStmt</span><span class="op" id="2387238">(</span><span class="ident" id="2387239">code</span><span class="op" id="2387243">,</span>&nbsp;<span class="ident" id="2387245">k</span>&nbsp;<span class="builtintype" id="2387247">int</span><span class="op" id="2387250">)</span>&nbsp;<span class="op" id="2387252">*</span><span class="ident" id="2387253">SockFilter</span>&nbsp;<span class="op" id="2387264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387267">return</span>&nbsp;<span class="op" id="2387274">&amp;</span><span class="ident" id="2387275">SockFilter</span><span class="op" id="2387285">{</span><span class="ident" id="2387286">Code</span><span class="op" id="2387290">:</span>&nbsp;<span class="builtintype" id="2387292">uint16</span><span class="op" id="2387298">(</span><span class="ident" id="2387299">code</span><span class="op" id="2387303">)</span><span class="op" id="2387304">,</span>&nbsp;<span class="ident" id="2387306">K</span><span class="op" id="2387307">:</span>&nbsp;<span class="builtintype" id="2387309">uint32</span><span class="op" id="2387315">(</span><span class="ident" id="2387316">k</span><span class="op" id="2387317">)</span><span class="op" id="2387318">}</span><br>
<span class="lineno">15</span><span class="op" id="2387320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2387323">func</span>&nbsp;<span class="ident" id="2387328">LsfJump</span><span class="op" id="2387335">(</span><span class="ident" id="2387336">code</span><span class="op" id="2387340">,</span>&nbsp;<span class="ident" id="2387342">k</span><span class="op" id="2387343">,</span>&nbsp;<span class="ident" id="2387345">jt</span><span class="op" id="2387347">,</span>&nbsp;<span class="ident" id="2387349">jf</span>&nbsp;<span class="builtintype" id="2387352">int</span><span class="op" id="2387355">)</span>&nbsp;<span class="op" id="2387357">*</span><span class="ident" id="2387358">SockFilter</span>&nbsp;<span class="op" id="2387369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387372">return</span>&nbsp;<span class="op" id="2387379">&amp;</span><span class="ident" id="2387380">SockFilter</span><span class="op" id="2387390">{</span><span class="ident" id="2387391">Code</span><span class="op" id="2387395">:</span>&nbsp;<span class="builtintype" id="2387397">uint16</span><span class="op" id="2387403">(</span><span class="ident" id="2387404">code</span><span class="op" id="2387408">)</span><span class="op" id="2387409">,</span>&nbsp;<span class="ident" id="2387411">Jt</span><span class="op" id="2387413">:</span>&nbsp;<span class="builtintype" id="2387415">uint8</span><span class="op" id="2387420">(</span><span class="ident" id="2387421">jt</span><span class="op" id="2387423">)</span><span class="op" id="2387424">,</span>&nbsp;<span class="ident" id="2387426">Jf</span><span class="op" id="2387428">:</span>&nbsp;<span class="builtintype" id="2387430">uint8</span><span class="op" id="2387435">(</span><span class="ident" id="2387436">jf</span><span class="op" id="2387438">)</span><span class="op" id="2387439">,</span>&nbsp;<span class="ident" id="2387441">K</span><span class="op" id="2387442">:</span>&nbsp;<span class="builtintype" id="2387444">uint32</span><span class="op" id="2387450">(</span><span class="ident" id="2387451">k</span><span class="op" id="2387452">)</span><span class="op" id="2387453">}</span><br>
<span class="lineno"></span><span class="op" id="2387455">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2387458">func</span>&nbsp;<span class="ident" id="2387463">LsfSocket</span><span class="op" id="2387472">(</span><span class="ident" id="2387473">ifindex</span><span class="op" id="2387480">,</span>&nbsp;<span class="ident" id="2387482">proto</span>&nbsp;<span class="builtintype" id="2387488">int</span><span class="op" id="2387491">)</span>&nbsp;<span class="op" id="2387493">(</span><span class="builtintype" id="2387494">int</span><span class="op" id="2387497">,</span>&nbsp;<span class="builtintype" id="2387499">error</span><span class="op" id="2387504">)</span>&nbsp;<span class="op" id="2387506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387509">var</span>&nbsp;<span class="ident" id="2387513">lsall</span>&nbsp;<span class="ident" id="2387519">SockaddrLinklayer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387538">s</span><span class="op" id="2387539">,</span>&nbsp;<span class="ident" id="2387541">e</span>&nbsp;<span class="op" id="2387543">:=</span>&nbsp;<span class="ident" id="2387546">Socket</span><span class="op" id="2387552">(</span><span class="ident" id="2387553">AF_PACKET</span><span class="op" id="2387562">,</span>&nbsp;<span class="ident" id="2387564">SOCK_RAW</span><span class="op" id="2387572">,</span>&nbsp;<span class="ident" id="2387574">proto</span><span class="op" id="2387579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387582">if</span>&nbsp;<span class="ident" id="2387585">e</span>&nbsp;<span class="op" id="2387587">!=</span>&nbsp;<span class="ident" id="2387590">nil</span>&nbsp;<span class="op" id="2387594">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387598">return</span>&nbsp;<span class="num" id="2387605">0</span><span class="op" id="2387606">,</span>&nbsp;<span class="ident" id="2387608">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2387611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387614">p</span>&nbsp;<span class="op" id="2387616">:=</span>&nbsp;<span class="op" id="2387619">(</span><span class="op" id="2387620">*</span><span class="op" id="2387621">[</span><span class="num" id="2387622">2</span><span class="op" id="2387623">]</span><span class="builtintype" id="2387624">byte</span><span class="op" id="2387628">)</span><span class="op" id="2387629">(</span><span class="ident" id="2387630">unsafe</span><span class="op" id="2387636">.</span><span class="ident" id="2387637">Pointer</span><span class="op" id="2387644">(</span><span class="op" id="2387645">&amp;</span><span class="ident" id="2387646">lsall</span><span class="op" id="2387651">.</span><span class="ident" id="2387652">Protocol</span><span class="op" id="2387660">)</span><span class="op" id="2387661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387664">p</span><span class="op" id="2387665">[</span><span class="num" id="2387666">0</span><span class="op" id="2387667">]</span>&nbsp;<span class="op" id="2387669">=</span>&nbsp;<span class="builtintype" id="2387671">byte</span><span class="op" id="2387675">(</span><span class="ident" id="2387676">proto</span>&nbsp;<span class="op" id="2387682">&gt;&gt;</span>&nbsp;<span class="num" id="2387685">8</span><span class="op" id="2387686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387689">p</span><span class="op" id="2387690">[</span><span class="num" id="2387691">1</span><span class="op" id="2387692">]</span>&nbsp;<span class="op" id="2387694">=</span>&nbsp;<span class="builtintype" id="2387696">byte</span><span class="op" id="2387700">(</span><span class="ident" id="2387701">proto</span><span class="op" id="2387706">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387709">lsall</span><span class="op" id="2387714">.</span><span class="ident" id="2387715">Ifindex</span>&nbsp;<span class="op" id="2387723">=</span>&nbsp;<span class="ident" id="2387725">ifindex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387734">e</span>&nbsp;<span class="op" id="2387736">=</span>&nbsp;<span class="ident" id="2387738">Bind</span><span class="op" id="2387742">(</span><span class="ident" id="2387743">s</span><span class="op" id="2387744">,</span>&nbsp;<span class="op" id="2387746">&amp;</span><span class="ident" id="2387747">lsall</span><span class="op" id="2387752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387755">if</span>&nbsp;<span class="ident" id="2387758">e</span>&nbsp;<span class="op" id="2387760">!=</span>&nbsp;<span class="ident" id="2387763">nil</span>&nbsp;<span class="op" id="2387767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387771">Close</span><span class="op" id="2387776">(</span><span class="ident" id="2387777">s</span><span class="op" id="2387778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387782">return</span>&nbsp;<span class="num" id="2387789">0</span><span class="op" id="2387790">,</span>&nbsp;<span class="ident" id="2387792">e</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2387795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387798">return</span>&nbsp;<span class="ident" id="2387805">s</span><span class="op" id="2387806">,</span>&nbsp;<span class="ident" id="2387808">nil</span><br>
<span class="lineno"></span><span class="op" id="2387812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2387815">type</span>&nbsp;<span class="ident" id="2387820">iflags</span>&nbsp;<span class="keyword" id="2387827">struct</span>&nbsp;<span class="op" id="2387834">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387837">name</span>&nbsp;&nbsp;<span class="op" id="2387843">[</span><span class="ident" id="2387844">IFNAMSIZ</span><span class="op" id="2387852">]</span><span class="builtintype" id="2387853">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387859">flags</span>&nbsp;<span class="builtintype" id="2387865">uint16</span><br>
<span class="lineno"></span><span class="op" id="2387872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2387875">func</span>&nbsp;<span class="ident" id="2387880">SetLsfPromisc</span><span class="op" id="2387893">(</span><span class="ident" id="2387894">name</span>&nbsp;<span class="builtintype" id="2387899">string</span><span class="op" id="2387905">,</span>&nbsp;<span class="ident" id="2387907">m</span>&nbsp;<span class="builtintype" id="2387909">bool</span><span class="op" id="2387913">)</span>&nbsp;<span class="builtintype" id="2387915">error</span>&nbsp;<span class="op" id="2387921">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387924">s</span><span class="op" id="2387925">,</span>&nbsp;<span class="ident" id="2387927">e</span>&nbsp;<span class="op" id="2387929">:=</span>&nbsp;<span class="ident" id="2387932">Socket</span><span class="op" id="2387938">(</span><span class="ident" id="2387939">AF_INET</span><span class="op" id="2387946">,</span>&nbsp;<span class="ident" id="2387948">SOCK_DGRAM</span><span class="op" id="2387958">,</span>&nbsp;<span class="num" id="2387960">0</span><span class="op" id="2387961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387964">if</span>&nbsp;<span class="ident" id="2387967">e</span>&nbsp;<span class="op" id="2387969">!=</span>&nbsp;<span class="ident" id="2387972">nil</span>&nbsp;<span class="op" id="2387976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387980">return</span>&nbsp;<span class="ident" id="2387987">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2387990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387993">defer</span>&nbsp;<span class="ident" id="2387999">Close</span><span class="op" id="2388004">(</span><span class="ident" id="2388005">s</span><span class="op" id="2388006">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388009">var</span>&nbsp;<span class="ident" id="2388013">ifl</span>&nbsp;<span class="ident" id="2388017">iflags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2388025">copy</span><span class="op" id="2388029">(</span><span class="ident" id="2388030">ifl</span><span class="op" id="2388033">.</span><span class="ident" id="2388034">name</span><span class="op" id="2388038">[</span><span class="op" id="2388039">:</span><span class="op" id="2388040">]</span><span class="op" id="2388041">,</span>&nbsp;<span class="op" id="2388043">[</span><span class="op" id="2388044">]</span><span class="builtintype" id="2388045">byte</span><span class="op" id="2388049">(</span><span class="ident" id="2388050">name</span><span class="op" id="2388054">)</span><span class="op" id="2388055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388058">_</span><span class="op" id="2388059">,</span>&nbsp;<span class="ident" id="2388061">_</span><span class="op" id="2388062">,</span>&nbsp;<span class="ident" id="2388064">ep</span>&nbsp;<span class="op" id="2388067">:=</span>&nbsp;<span class="ident" id="2388070">Syscall</span><span class="op" id="2388077">(</span><span class="ident" id="2388078">SYS_IOCTL</span><span class="op" id="2388087">,</span>&nbsp;<span class="builtintype" id="2388089">uintptr</span><span class="op" id="2388096">(</span><span class="ident" id="2388097">s</span><span class="op" id="2388098">)</span><span class="op" id="2388099">,</span>&nbsp;<span class="ident" id="2388101">SIOCGIFFLAGS</span><span class="op" id="2388113">,</span>&nbsp;<span class="builtintype" id="2388115">uintptr</span><span class="op" id="2388122">(</span><span class="ident" id="2388123">unsafe</span><span class="op" id="2388129">.</span><span class="ident" id="2388130">Pointer</span><span class="op" id="2388137">(</span><span class="op" id="2388138">&amp;</span><span class="ident" id="2388139">ifl</span><span class="op" id="2388142">)</span><span class="op" id="2388143">)</span><span class="op" id="2388144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388147">if</span>&nbsp;<span class="ident" id="2388150">ep</span>&nbsp;<span class="op" id="2388153">!=</span>&nbsp;<span class="num" id="2388156">0</span>&nbsp;<span class="op" id="2388158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388162">return</span>&nbsp;<span class="ident" id="2388169">Errno</span><span class="op" id="2388174">(</span><span class="ident" id="2388175">ep</span><span class="op" id="2388177">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2388180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388183">if</span>&nbsp;<span class="ident" id="2388186">m</span>&nbsp;<span class="op" id="2388188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388192">ifl</span><span class="op" id="2388195">.</span><span class="ident" id="2388196">flags</span>&nbsp;<span class="op" id="2388202">|=</span>&nbsp;<span class="builtintype" id="2388205">uint16</span><span class="op" id="2388211">(</span><span class="ident" id="2388212">IFF_PROMISC</span><span class="op" id="2388223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2388226">}</span>&nbsp;<span class="keyword" id="2388228">else</span>&nbsp;<span class="op" id="2388233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388237">ifl</span><span class="op" id="2388240">.</span><span class="ident" id="2388241">flags</span>&nbsp;<span class="op" id="2388247">&amp;=</span>&nbsp;<span class="op" id="2388250">^</span><span class="builtintype" id="2388251">uint16</span><span class="op" id="2388257">(</span><span class="ident" id="2388258">IFF_PROMISC</span><span class="op" id="2388269">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2388272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388275">_</span><span class="op" id="2388276">,</span>&nbsp;<span class="ident" id="2388278">_</span><span class="op" id="2388279">,</span>&nbsp;<span class="ident" id="2388281">ep</span>&nbsp;<span class="op" id="2388284">=</span>&nbsp;<span class="ident" id="2388286">Syscall</span><span class="op" id="2388293">(</span><span class="ident" id="2388294">SYS_IOCTL</span><span class="op" id="2388303">,</span>&nbsp;<span class="builtintype" id="2388305">uintptr</span><span class="op" id="2388312">(</span><span class="ident" id="2388313">s</span><span class="op" id="2388314">)</span><span class="op" id="2388315">,</span>&nbsp;<span class="ident" id="2388317">SIOCSIFFLAGS</span><span class="op" id="2388329">,</span>&nbsp;<span class="builtintype" id="2388331">uintptr</span><span class="op" id="2388338">(</span><span class="ident" id="2388339">unsafe</span><span class="op" id="2388345">.</span><span class="ident" id="2388346">Pointer</span><span class="op" id="2388353">(</span><span class="op" id="2388354">&amp;</span><span class="ident" id="2388355">ifl</span><span class="op" id="2388358">)</span><span class="op" id="2388359">)</span><span class="op" id="2388360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388363">if</span>&nbsp;<span class="ident" id="2388366">ep</span>&nbsp;<span class="op" id="2388369">!=</span>&nbsp;<span class="num" id="2388372">0</span>&nbsp;<span class="op" id="2388374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388378">return</span>&nbsp;<span class="ident" id="2388385">Errno</span><span class="op" id="2388390">(</span><span class="ident" id="2388391">ep</span><span class="op" id="2388393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2388396">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388399">return</span>&nbsp;<span class="ident" id="2388406">nil</span><br>
<span class="lineno"></span><span class="op" id="2388410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2388413">func</span>&nbsp;<span class="ident" id="2388418">AttachLsf</span><span class="op" id="2388427">(</span><span class="ident" id="2388428">fd</span>&nbsp;<span class="builtintype" id="2388431">int</span><span class="op" id="2388434">,</span>&nbsp;<span class="ident" id="2388436">i</span>&nbsp;<span class="op" id="2388438">[</span><span class="op" id="2388439">]</span><span class="ident" id="2388440">SockFilter</span><span class="op" id="2388450">)</span>&nbsp;<span class="builtintype" id="2388452">error</span>&nbsp;<span class="op" id="2388458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388461">var</span>&nbsp;<span class="ident" id="2388465">p</span>&nbsp;<span class="ident" id="2388467">SockFprog</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388478">p</span><span class="op" id="2388479">.</span><span class="ident" id="2388480">Len</span>&nbsp;<span class="op" id="2388484">=</span>&nbsp;<span class="builtintype" id="2388486">uint16</span><span class="op" id="2388492">(</span><span class="builtinfunc" id="2388493">len</span><span class="op" id="2388496">(</span><span class="ident" id="2388497">i</span><span class="op" id="2388498">)</span><span class="op" id="2388499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388502">p</span><span class="op" id="2388503">.</span><span class="ident" id="2388504">Filter</span>&nbsp;<span class="op" id="2388511">=</span>&nbsp;<span class="op" id="2388513">(</span><span class="op" id="2388514">*</span><span class="ident" id="2388515">SockFilter</span><span class="op" id="2388525">)</span><span class="op" id="2388526">(</span><span class="ident" id="2388527">unsafe</span><span class="op" id="2388533">.</span><span class="ident" id="2388534">Pointer</span><span class="op" id="2388541">(</span><span class="op" id="2388542">&amp;</span><span class="ident" id="2388543">i</span><span class="op" id="2388544">[</span><span class="num" id="2388545">0</span><span class="op" id="2388546">]</span><span class="op" id="2388547">)</span><span class="op" id="2388548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388551">return</span>&nbsp;<span class="ident" id="2388558">setsockopt</span><span class="op" id="2388568">(</span><span class="ident" id="2388569">fd</span><span class="op" id="2388571">,</span>&nbsp;<span class="ident" id="2388573">SOL_SOCKET</span><span class="op" id="2388583">,</span>&nbsp;<span class="ident" id="2388585">SO_ATTACH_FILTER</span><span class="op" id="2388601">,</span>&nbsp;<span class="ident" id="2388603">unsafe</span><span class="op" id="2388609">.</span><span class="ident" id="2388610">Pointer</span><span class="op" id="2388617">(</span><span class="op" id="2388618">&amp;</span><span class="ident" id="2388619">p</span><span class="op" id="2388620">)</span><span class="op" id="2388621">,</span>&nbsp;<span class="ident" id="2388623">unsafe</span><span class="op" id="2388629">.</span><span class="ident" id="2388630">Sizeof</span><span class="op" id="2388636">(</span><span class="ident" id="2388637">p</span><span class="op" id="2388638">)</span><span class="op" id="2388639">)</span><br>
<span class="lineno"></span><span class="op" id="2388641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="2388644">func</span>&nbsp;<span class="ident" id="2388649">DetachLsf</span><span class="op" id="2388658">(</span><span class="ident" id="2388659">fd</span>&nbsp;<span class="builtintype" id="2388662">int</span><span class="op" id="2388665">)</span>&nbsp;<span class="builtintype" id="2388667">error</span>&nbsp;<span class="op" id="2388673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388676">var</span>&nbsp;<span class="ident" id="2388680">dummy</span>&nbsp;<span class="builtintype" id="2388686">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388691">return</span>&nbsp;<span class="ident" id="2388698">setsockopt</span><span class="op" id="2388708">(</span><span class="ident" id="2388709">fd</span><span class="op" id="2388711">,</span>&nbsp;<span class="ident" id="2388713">SOL_SOCKET</span><span class="op" id="2388723">,</span>&nbsp;<span class="ident" id="2388725">SO_DETACH_FILTER</span><span class="op" id="2388741">,</span>&nbsp;<span class="ident" id="2388743">unsafe</span><span class="op" id="2388749">.</span><span class="ident" id="2388750">Pointer</span><span class="op" id="2388757">(</span><span class="op" id="2388758">&amp;</span><span class="ident" id="2388759">dummy</span><span class="op" id="2388764">)</span><span class="op" id="2388765">,</span>&nbsp;<span class="ident" id="2388767">unsafe</span><span class="op" id="2388773">.</span><span class="ident" id="2388774">Sizeof</span><span class="op" id="2388780">(</span><span class="ident" id="2388781">dummy</span><span class="op" id="2388786">)</span><span class="op" id="2388787">)</span><br>
<span class="lineno"></span><span class="op" id="2388789">}</span>
</div>
</body>
</html>
