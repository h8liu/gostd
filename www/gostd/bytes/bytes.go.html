<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>bytes</h2>
<ul>
<li><a href="/gostd/bytes/buffer.go.html">buffer.go</a></li>
<li><a href="/gostd/bytes/buffer_test.go.html">buffer_test.go</a></li>
<li><a href="/gostd/bytes/bytes.go.html">bytes.go</a></li>
<li><a href="/gostd/bytes/bytes_decl.go.html">bytes_decl.go</a></li>
<li><a href="/gostd/bytes/bytes_test.go.html">bytes_test.go</a></li>
<li><a href="/gostd/bytes/compare_test.go.html">compare_test.go</a></li>
<li><a href="/gostd/bytes/equal_test.go.html">equal_test.go</a></li>
<li><a href="/gostd/bytes/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/bytes/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/bytes/reader.go.html">reader.go</a></li>
<li><a href="/gostd/bytes/reader_test.go.html">reader_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1385811">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1385866">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1385920">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1385971">//&nbsp;Package&nbsp;bytes&nbsp;implements&nbsp;functions&nbsp;for&nbsp;the&nbsp;manipulation&nbsp;of&nbsp;byte&nbsp;slices.</span><br>
<span class="lineno"></span><span class="comment" id="1386046">//&nbsp;It&nbsp;is&nbsp;analogous&nbsp;to&nbsp;the&nbsp;facilities&nbsp;of&nbsp;the&nbsp;strings&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="1386107">package</span>&nbsp;<span class="ident" id="1386115">bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1386122">import</span>&nbsp;<span class="op" id="1386129">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1386132">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1386143">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="1386158">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1386161">func</span>&nbsp;<span class="ident" id="1386166">equalPortable</span><span class="op" id="1386179">(</span><span class="ident" id="1386180">a</span><span class="op" id="1386181">,</span>&nbsp;<span class="ident" id="1386183">b</span>&nbsp;<span class="op" id="1386185">[</span><span class="op" id="1386186">]</span><span class="builtintype" id="1386187">byte</span><span class="op" id="1386191">)</span>&nbsp;<span class="builtintype" id="1386193">bool</span>&nbsp;<span class="op" id="1386198">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386201">if</span>&nbsp;<span class="builtinfunc" id="1386204">len</span><span class="op" id="1386207">(</span><span class="ident" id="1386208">a</span><span class="op" id="1386209">)</span>&nbsp;<span class="op" id="1386211">!=</span>&nbsp;<span class="builtinfunc" id="1386214">len</span><span class="op" id="1386217">(</span><span class="ident" id="1386218">b</span><span class="op" id="1386219">)</span>&nbsp;<span class="op" id="1386221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386225">return</span>&nbsp;<span class="builtintype" id="1386232">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1386239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386242">for</span>&nbsp;<span class="ident" id="1386246">i</span><span class="op" id="1386247">,</span>&nbsp;<span class="ident" id="1386249">c</span>&nbsp;<span class="op" id="1386251">:=</span>&nbsp;<span class="keyword" id="1386254">range</span>&nbsp;<span class="ident" id="1386260">a</span>&nbsp;<span class="op" id="1386262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386266">if</span>&nbsp;<span class="ident" id="1386269">c</span>&nbsp;<span class="op" id="1386271">!=</span>&nbsp;<span class="ident" id="1386274">b</span><span class="op" id="1386275">[</span><span class="ident" id="1386276">i</span><span class="op" id="1386277">]</span>&nbsp;<span class="op" id="1386279">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386284">return</span>&nbsp;<span class="builtintype" id="1386291">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1386299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1386302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386305">return</span>&nbsp;<span class="builtintype" id="1386312">true</span><br>
<span class="lineno"></span><span class="op" id="1386317">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="1386320">//&nbsp;explode&nbsp;splits&nbsp;s&nbsp;into&nbsp;a&nbsp;slice&nbsp;of&nbsp;UTF-8&nbsp;sequences,&nbsp;one&nbsp;per&nbsp;Unicode&nbsp;character&nbsp;(still&nbsp;slices&nbsp;of&nbsp;bytes),</span><br>
<span class="lineno"></span><span class="comment" id="1386424">//&nbsp;up&nbsp;to&nbsp;a&nbsp;maximum&nbsp;of&nbsp;n&nbsp;byte&nbsp;slices.&nbsp;Invalid&nbsp;UTF-8&nbsp;sequences&nbsp;are&nbsp;chopped&nbsp;into&nbsp;individual&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="1386520">func</span>&nbsp;<span class="ident" id="1386525">explode</span><span class="op" id="1386532">(</span><span class="ident" id="1386533">s</span>&nbsp;<span class="op" id="1386535">[</span><span class="op" id="1386536">]</span><span class="builtintype" id="1386537">byte</span><span class="op" id="1386541">,</span>&nbsp;<span class="ident" id="1386543">n</span>&nbsp;<span class="builtintype" id="1386545">int</span><span class="op" id="1386548">)</span>&nbsp;<span class="op" id="1386550">[</span><span class="op" id="1386551">]</span><span class="op" id="1386552">[</span><span class="op" id="1386553">]</span><span class="builtintype" id="1386554">byte</span>&nbsp;<span class="op" id="1386559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386562">if</span>&nbsp;<span class="ident" id="1386565">n</span>&nbsp;<span class="op" id="1386567">&lt;=</span>&nbsp;<span class="num" id="1386570">0</span>&nbsp;<span class="op" id="1386572">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1386576">n</span>&nbsp;<span class="op" id="1386578">=</span>&nbsp;<span class="builtinfunc" id="1386580">len</span><span class="op" id="1386583">(</span><span class="ident" id="1386584">s</span><span class="op" id="1386585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1386588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1386591">a</span>&nbsp;<span class="op" id="1386593">:=</span>&nbsp;<span class="builtinfunc" id="1386596">make</span><span class="op" id="1386600">(</span><span class="op" id="1386601">[</span><span class="op" id="1386602">]</span><span class="op" id="1386603">[</span><span class="op" id="1386604">]</span><span class="builtintype" id="1386605">byte</span><span class="op" id="1386609">,</span>&nbsp;<span class="ident" id="1386611">n</span><span class="op" id="1386612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386615">var</span>&nbsp;<span class="ident" id="1386619">size</span>&nbsp;<span class="builtintype" id="1386624">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1386629">na</span>&nbsp;<span class="op" id="1386632">:=</span>&nbsp;<span class="num" id="1386635">0</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386638">for</span>&nbsp;<span class="builtinfunc" id="1386642">len</span><span class="op" id="1386645">(</span><span class="ident" id="1386646">s</span><span class="op" id="1386647">)</span>&nbsp;<span class="op" id="1386649">&gt;</span>&nbsp;<span class="num" id="1386651">0</span>&nbsp;<span class="op" id="1386653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386657">if</span>&nbsp;<span class="ident" id="1386660">na</span><span class="op" id="1386662">+</span><span class="num" id="1386663">1</span>&nbsp;<span class="op" id="1386665">&gt;=</span>&nbsp;<span class="ident" id="1386668">n</span>&nbsp;<span class="op" id="1386670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1386675">a</span><span class="op" id="1386676">[</span><span class="ident" id="1386677">na</span><span class="op" id="1386679">]</span>&nbsp;<span class="op" id="1386681">=</span>&nbsp;<span class="ident" id="1386683">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1386688">na</span><span class="op" id="1386690">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386696">break</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1386704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1386708">_</span><span class="op" id="1386709">,</span>&nbsp;<span class="ident" id="1386711">size</span>&nbsp;<span class="op" id="1386716">=</span>&nbsp;<span class="ident" id="1386718">utf8</span><span class="op" id="1386722">.</span><span class="ident" id="1386723">DecodeRune</span><span class="op" id="1386733">(</span><span class="ident" id="1386734">s</span><span class="op" id="1386735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1386739">a</span><span class="op" id="1386740">[</span><span class="ident" id="1386741">na</span><span class="op" id="1386743">]</span>&nbsp;<span class="op" id="1386745">=</span>&nbsp;<span class="ident" id="1386747">s</span><span class="op" id="1386748">[</span><span class="num" id="1386749">0</span><span class="op" id="1386750">:</span><span class="ident" id="1386751">size</span><span class="op" id="1386755">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1386759">s</span>&nbsp;<span class="op" id="1386761">=</span>&nbsp;<span class="ident" id="1386763">s</span><span class="op" id="1386764">[</span><span class="ident" id="1386765">size</span><span class="op" id="1386769">:</span><span class="op" id="1386770">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1386774">na</span><span class="op" id="1386776">++</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1386780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386783">return</span>&nbsp;<span class="ident" id="1386790">a</span><span class="op" id="1386791">[</span><span class="num" id="1386792">0</span><span class="op" id="1386793">:</span><span class="ident" id="1386794">na</span><span class="op" id="1386796">]</span><br>
<span class="lineno"></span><span class="op" id="1386798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1386801">//&nbsp;Count&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;sep&nbsp;in&nbsp;s.</span><br>
<span class="lineno">50</span><span class="keyword" id="1386870">func</span>&nbsp;<span class="ident" id="1386875">Count</span><span class="op" id="1386880">(</span><span class="ident" id="1386881">s</span><span class="op" id="1386882">,</span>&nbsp;<span class="ident" id="1386884">sep</span>&nbsp;<span class="op" id="1386888">[</span><span class="op" id="1386889">]</span><span class="builtintype" id="1386890">byte</span><span class="op" id="1386894">)</span>&nbsp;<span class="builtintype" id="1386896">int</span>&nbsp;<span class="op" id="1386900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1386903">n</span>&nbsp;<span class="op" id="1386905">:=</span>&nbsp;<span class="builtinfunc" id="1386908">len</span><span class="op" id="1386911">(</span><span class="ident" id="1386912">sep</span><span class="op" id="1386915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386918">if</span>&nbsp;<span class="ident" id="1386921">n</span>&nbsp;<span class="op" id="1386923">==</span>&nbsp;<span class="num" id="1386926">0</span>&nbsp;<span class="op" id="1386928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386932">return</span>&nbsp;<span class="ident" id="1386939">utf8</span><span class="op" id="1386943">.</span><span class="ident" id="1386944">RuneCount</span><span class="op" id="1386953">(</span><span class="ident" id="1386954">s</span><span class="op" id="1386955">)</span>&nbsp;<span class="op" id="1386957">+</span>&nbsp;<span class="num" id="1386959">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1386962">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386965">if</span>&nbsp;<span class="ident" id="1386968">n</span>&nbsp;<span class="op" id="1386970">&gt;</span>&nbsp;<span class="builtinfunc" id="1386972">len</span><span class="op" id="1386975">(</span><span class="ident" id="1386976">s</span><span class="op" id="1386977">)</span>&nbsp;<span class="op" id="1386979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1386983">return</span>&nbsp;<span class="num" id="1386990">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1386993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1386996">count</span>&nbsp;<span class="op" id="1387002">:=</span>&nbsp;<span class="num" id="1387005">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387008">c</span>&nbsp;<span class="op" id="1387010">:=</span>&nbsp;<span class="ident" id="1387013">sep</span><span class="op" id="1387016">[</span><span class="num" id="1387017">0</span><span class="op" id="1387018">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387021">i</span>&nbsp;<span class="op" id="1387023">:=</span>&nbsp;<span class="num" id="1387026">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387029">t</span>&nbsp;<span class="op" id="1387031">:=</span>&nbsp;<span class="ident" id="1387034">s</span><span class="op" id="1387035">[</span><span class="op" id="1387036">:</span><span class="builtinfunc" id="1387037">len</span><span class="op" id="1387040">(</span><span class="ident" id="1387041">s</span><span class="op" id="1387042">)</span><span class="op" id="1387043">-</span><span class="ident" id="1387044">n</span><span class="op" id="1387045">+</span><span class="num" id="1387046">1</span><span class="op" id="1387047">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387050">for</span>&nbsp;<span class="ident" id="1387054">i</span>&nbsp;<span class="op" id="1387056">&lt;</span>&nbsp;<span class="builtinfunc" id="1387058">len</span><span class="op" id="1387061">(</span><span class="ident" id="1387062">t</span><span class="op" id="1387063">)</span>&nbsp;<span class="op" id="1387065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387069">if</span>&nbsp;<span class="ident" id="1387072">t</span><span class="op" id="1387073">[</span><span class="ident" id="1387074">i</span><span class="op" id="1387075">]</span>&nbsp;<span class="op" id="1387077">!=</span>&nbsp;<span class="ident" id="1387080">c</span>&nbsp;<span class="op" id="1387082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387087">o</span>&nbsp;<span class="op" id="1387089">:=</span>&nbsp;<span class="ident" id="1387092">IndexByte</span><span class="op" id="1387101">(</span><span class="ident" id="1387102">t</span><span class="op" id="1387103">[</span><span class="ident" id="1387104">i</span><span class="op" id="1387105">:</span><span class="op" id="1387106">]</span><span class="op" id="1387107">,</span>&nbsp;<span class="ident" id="1387109">c</span><span class="op" id="1387110">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387115">if</span>&nbsp;<span class="ident" id="1387118">o</span>&nbsp;<span class="op" id="1387120">&lt;</span>&nbsp;<span class="num" id="1387122">0</span>&nbsp;<span class="op" id="1387124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387130">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387144">i</span>&nbsp;<span class="op" id="1387146">+=</span>&nbsp;<span class="ident" id="1387149">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387153">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387157">if</span>&nbsp;<span class="ident" id="1387160">n</span>&nbsp;<span class="op" id="1387162">==</span>&nbsp;<span class="num" id="1387165">1</span>&nbsp;<span class="op" id="1387167">||</span>&nbsp;<span class="ident" id="1387170">Equal</span><span class="op" id="1387175">(</span><span class="ident" id="1387176">s</span><span class="op" id="1387177">[</span><span class="ident" id="1387178">i</span><span class="op" id="1387179">:</span><span class="ident" id="1387180">i</span><span class="op" id="1387181">+</span><span class="ident" id="1387182">n</span><span class="op" id="1387183">]</span><span class="op" id="1387184">,</span>&nbsp;<span class="ident" id="1387186">sep</span><span class="op" id="1387189">)</span>&nbsp;<span class="op" id="1387191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387196">count</span><span class="op" id="1387201">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387207">i</span>&nbsp;<span class="op" id="1387209">+=</span>&nbsp;<span class="ident" id="1387212">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387217">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387228">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387232">i</span><span class="op" id="1387233">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387240">return</span>&nbsp;<span class="ident" id="1387247">count</span><br>
<span class="lineno"></span><span class="op" id="1387253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1387256">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;subslice&nbsp;is&nbsp;within&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="1387306">func</span>&nbsp;<span class="ident" id="1387311">Contains</span><span class="op" id="1387319">(</span><span class="ident" id="1387320">b</span><span class="op" id="1387321">,</span>&nbsp;<span class="ident" id="1387323">subslice</span>&nbsp;<span class="op" id="1387332">[</span><span class="op" id="1387333">]</span><span class="builtintype" id="1387334">byte</span><span class="op" id="1387338">)</span>&nbsp;<span class="builtintype" id="1387340">bool</span>&nbsp;<span class="op" id="1387345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387348">return</span>&nbsp;<span class="ident" id="1387355">Index</span><span class="op" id="1387360">(</span><span class="ident" id="1387361">b</span><span class="op" id="1387362">,</span>&nbsp;<span class="ident" id="1387364">subslice</span><span class="op" id="1387372">)</span>&nbsp;<span class="op" id="1387374">!=</span>&nbsp;<span class="op" id="1387377">-</span><span class="num" id="1387378">1</span><br>
<span class="lineno"></span><span class="op" id="1387380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="1387383">//&nbsp;Index&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1387479">func</span>&nbsp;<span class="ident" id="1387484">Index</span><span class="op" id="1387489">(</span><span class="ident" id="1387490">s</span><span class="op" id="1387491">,</span>&nbsp;<span class="ident" id="1387493">sep</span>&nbsp;<span class="op" id="1387497">[</span><span class="op" id="1387498">]</span><span class="builtintype" id="1387499">byte</span><span class="op" id="1387503">)</span>&nbsp;<span class="builtintype" id="1387505">int</span>&nbsp;<span class="op" id="1387509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387512">n</span>&nbsp;<span class="op" id="1387514">:=</span>&nbsp;<span class="builtinfunc" id="1387517">len</span><span class="op" id="1387520">(</span><span class="ident" id="1387521">sep</span><span class="op" id="1387524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387527">if</span>&nbsp;<span class="ident" id="1387530">n</span>&nbsp;<span class="op" id="1387532">==</span>&nbsp;<span class="num" id="1387535">0</span>&nbsp;<span class="op" id="1387537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387541">return</span>&nbsp;<span class="num" id="1387548">0</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387554">if</span>&nbsp;<span class="ident" id="1387557">n</span>&nbsp;<span class="op" id="1387559">&gt;</span>&nbsp;<span class="builtinfunc" id="1387561">len</span><span class="op" id="1387564">(</span><span class="ident" id="1387565">s</span><span class="op" id="1387566">)</span>&nbsp;<span class="op" id="1387568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387572">return</span>&nbsp;<span class="op" id="1387579">-</span><span class="num" id="1387580">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387586">c</span>&nbsp;<span class="op" id="1387588">:=</span>&nbsp;<span class="ident" id="1387591">sep</span><span class="op" id="1387594">[</span><span class="num" id="1387595">0</span><span class="op" id="1387596">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387599">if</span>&nbsp;<span class="ident" id="1387602">n</span>&nbsp;<span class="op" id="1387604">==</span>&nbsp;<span class="num" id="1387607">1</span>&nbsp;<span class="op" id="1387609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387613">return</span>&nbsp;<span class="ident" id="1387620">IndexByte</span><span class="op" id="1387629">(</span><span class="ident" id="1387630">s</span><span class="op" id="1387631">,</span>&nbsp;<span class="ident" id="1387633">c</span><span class="op" id="1387634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387640">i</span>&nbsp;<span class="op" id="1387642">:=</span>&nbsp;<span class="num" id="1387645">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387648">t</span>&nbsp;<span class="op" id="1387650">:=</span>&nbsp;<span class="ident" id="1387653">s</span><span class="op" id="1387654">[</span><span class="op" id="1387655">:</span><span class="builtinfunc" id="1387656">len</span><span class="op" id="1387659">(</span><span class="ident" id="1387660">s</span><span class="op" id="1387661">)</span><span class="op" id="1387662">-</span><span class="ident" id="1387663">n</span><span class="op" id="1387664">+</span><span class="num" id="1387665">1</span><span class="op" id="1387666">]</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387669">for</span>&nbsp;<span class="ident" id="1387673">i</span>&nbsp;<span class="op" id="1387675">&lt;</span>&nbsp;<span class="builtinfunc" id="1387677">len</span><span class="op" id="1387680">(</span><span class="ident" id="1387681">t</span><span class="op" id="1387682">)</span>&nbsp;<span class="op" id="1387684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387688">if</span>&nbsp;<span class="ident" id="1387691">t</span><span class="op" id="1387692">[</span><span class="ident" id="1387693">i</span><span class="op" id="1387694">]</span>&nbsp;<span class="op" id="1387696">!=</span>&nbsp;<span class="ident" id="1387699">c</span>&nbsp;<span class="op" id="1387701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387706">o</span>&nbsp;<span class="op" id="1387708">:=</span>&nbsp;<span class="ident" id="1387711">IndexByte</span><span class="op" id="1387720">(</span><span class="ident" id="1387721">t</span><span class="op" id="1387722">[</span><span class="ident" id="1387723">i</span><span class="op" id="1387724">:</span><span class="op" id="1387725">]</span><span class="op" id="1387726">,</span>&nbsp;<span class="ident" id="1387728">c</span><span class="op" id="1387729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387734">if</span>&nbsp;<span class="ident" id="1387737">o</span>&nbsp;<span class="op" id="1387739">&lt;</span>&nbsp;<span class="num" id="1387741">0</span>&nbsp;<span class="op" id="1387743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387749">break</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387763">i</span>&nbsp;<span class="op" id="1387765">+=</span>&nbsp;<span class="ident" id="1387768">o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387776">if</span>&nbsp;<span class="ident" id="1387779">Equal</span><span class="op" id="1387784">(</span><span class="ident" id="1387785">s</span><span class="op" id="1387786">[</span><span class="ident" id="1387787">i</span><span class="op" id="1387788">:</span><span class="ident" id="1387789">i</span><span class="op" id="1387790">+</span><span class="ident" id="1387791">n</span><span class="op" id="1387792">]</span><span class="op" id="1387793">,</span>&nbsp;<span class="ident" id="1387795">sep</span><span class="op" id="1387798">)</span>&nbsp;<span class="op" id="1387800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387805">return</span>&nbsp;<span class="ident" id="1387812">i</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1387820">i</span><span class="op" id="1387821">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387828">return</span>&nbsp;<span class="op" id="1387835">-</span><span class="num" id="1387836">1</span><br>
<span class="lineno"></span><span class="op" id="1387838">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="1387841">func</span>&nbsp;<span class="ident" id="1387846">indexBytePortable</span><span class="op" id="1387863">(</span><span class="ident" id="1387864">s</span>&nbsp;<span class="op" id="1387866">[</span><span class="op" id="1387867">]</span><span class="builtintype" id="1387868">byte</span><span class="op" id="1387872">,</span>&nbsp;<span class="ident" id="1387874">c</span>&nbsp;<span class="builtintype" id="1387876">byte</span><span class="op" id="1387880">)</span>&nbsp;<span class="builtintype" id="1387882">int</span>&nbsp;<span class="op" id="1387886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387889">for</span>&nbsp;<span class="ident" id="1387893">i</span><span class="op" id="1387894">,</span>&nbsp;<span class="ident" id="1387896">b</span>&nbsp;<span class="op" id="1387898">:=</span>&nbsp;<span class="keyword" id="1387901">range</span>&nbsp;<span class="ident" id="1387907">s</span>&nbsp;<span class="op" id="1387909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387913">if</span>&nbsp;<span class="ident" id="1387916">b</span>&nbsp;<span class="op" id="1387918">==</span>&nbsp;<span class="ident" id="1387921">c</span>&nbsp;<span class="op" id="1387923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387928">return</span>&nbsp;<span class="ident" id="1387935">i</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1387942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1387945">return</span>&nbsp;<span class="op" id="1387952">-</span><span class="num" id="1387953">1</span><br>
<span class="lineno"></span><span class="op" id="1387955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="1387958">//&nbsp;LastIndex&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;instance&nbsp;of&nbsp;sep&nbsp;in&nbsp;s,&nbsp;or&nbsp;-1&nbsp;if&nbsp;sep&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1388057">func</span>&nbsp;<span class="ident" id="1388062">LastIndex</span><span class="op" id="1388071">(</span><span class="ident" id="1388072">s</span><span class="op" id="1388073">,</span>&nbsp;<span class="ident" id="1388075">sep</span>&nbsp;<span class="op" id="1388079">[</span><span class="op" id="1388080">]</span><span class="builtintype" id="1388081">byte</span><span class="op" id="1388085">)</span>&nbsp;<span class="builtintype" id="1388087">int</span>&nbsp;<span class="op" id="1388091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388094">n</span>&nbsp;<span class="op" id="1388096">:=</span>&nbsp;<span class="builtinfunc" id="1388099">len</span><span class="op" id="1388102">(</span><span class="ident" id="1388103">sep</span><span class="op" id="1388106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388109">if</span>&nbsp;<span class="ident" id="1388112">n</span>&nbsp;<span class="op" id="1388114">==</span>&nbsp;<span class="num" id="1388117">0</span>&nbsp;<span class="op" id="1388119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388123">return</span>&nbsp;<span class="builtinfunc" id="1388130">len</span><span class="op" id="1388133">(</span><span class="ident" id="1388134">s</span><span class="op" id="1388135">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1388138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388141">c</span>&nbsp;<span class="op" id="1388143">:=</span>&nbsp;<span class="ident" id="1388146">sep</span><span class="op" id="1388149">[</span><span class="num" id="1388150">0</span><span class="op" id="1388151">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388154">for</span>&nbsp;<span class="ident" id="1388158">i</span>&nbsp;<span class="op" id="1388160">:=</span>&nbsp;<span class="builtinfunc" id="1388163">len</span><span class="op" id="1388166">(</span><span class="ident" id="1388167">s</span><span class="op" id="1388168">)</span>&nbsp;<span class="op" id="1388170">-</span>&nbsp;<span class="ident" id="1388172">n</span><span class="op" id="1388173">;</span>&nbsp;<span class="ident" id="1388175">i</span>&nbsp;<span class="op" id="1388177">&gt;=</span>&nbsp;<span class="num" id="1388180">0</span><span class="op" id="1388181">;</span>&nbsp;<span class="ident" id="1388183">i</span><span class="op" id="1388184">--</span>&nbsp;<span class="op" id="1388187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388191">if</span>&nbsp;<span class="ident" id="1388194">s</span><span class="op" id="1388195">[</span><span class="ident" id="1388196">i</span><span class="op" id="1388197">]</span>&nbsp;<span class="op" id="1388199">==</span>&nbsp;<span class="ident" id="1388202">c</span>&nbsp;<span class="op" id="1388204">&amp;&amp;</span>&nbsp;<span class="op" id="1388207">(</span><span class="ident" id="1388208">n</span>&nbsp;<span class="op" id="1388210">==</span>&nbsp;<span class="num" id="1388213">1</span>&nbsp;<span class="op" id="1388215">||</span>&nbsp;<span class="ident" id="1388218">Equal</span><span class="op" id="1388223">(</span><span class="ident" id="1388224">s</span><span class="op" id="1388225">[</span><span class="ident" id="1388226">i</span><span class="op" id="1388227">:</span><span class="ident" id="1388228">i</span><span class="op" id="1388229">+</span><span class="ident" id="1388230">n</span><span class="op" id="1388231">]</span><span class="op" id="1388232">,</span>&nbsp;<span class="ident" id="1388234">sep</span><span class="op" id="1388237">)</span><span class="op" id="1388238">)</span>&nbsp;<span class="op" id="1388240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388245">return</span>&nbsp;<span class="ident" id="1388252">i</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1388256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1388259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388262">return</span>&nbsp;<span class="op" id="1388269">-</span><span class="num" id="1388270">1</span><br>
<span class="lineno"></span><span class="op" id="1388272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="1388275">//&nbsp;IndexRune&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1388353">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1388430">//&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;rune&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1388476">func</span>&nbsp;<span class="ident" id="1388481">IndexRune</span><span class="op" id="1388490">(</span><span class="ident" id="1388491">s</span>&nbsp;<span class="op" id="1388493">[</span><span class="op" id="1388494">]</span><span class="builtintype" id="1388495">byte</span><span class="op" id="1388499">,</span>&nbsp;<span class="ident" id="1388501">r</span>&nbsp;<span class="builtintype" id="1388503">rune</span><span class="op" id="1388507">)</span>&nbsp;<span class="builtintype" id="1388509">int</span>&nbsp;<span class="op" id="1388513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388516">for</span>&nbsp;<span class="ident" id="1388520">i</span>&nbsp;<span class="op" id="1388522">:=</span>&nbsp;<span class="num" id="1388525">0</span><span class="op" id="1388526">;</span>&nbsp;<span class="ident" id="1388528">i</span>&nbsp;<span class="op" id="1388530">&lt;</span>&nbsp;<span class="builtinfunc" id="1388532">len</span><span class="op" id="1388535">(</span><span class="ident" id="1388536">s</span><span class="op" id="1388537">)</span><span class="op" id="1388538">;</span>&nbsp;<span class="op" id="1388540">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388544">r1</span><span class="op" id="1388546">,</span>&nbsp;<span class="ident" id="1388548">size</span>&nbsp;<span class="op" id="1388553">:=</span>&nbsp;<span class="ident" id="1388556">utf8</span><span class="op" id="1388560">.</span><span class="ident" id="1388561">DecodeRune</span><span class="op" id="1388571">(</span><span class="ident" id="1388572">s</span><span class="op" id="1388573">[</span><span class="ident" id="1388574">i</span><span class="op" id="1388575">:</span><span class="op" id="1388576">]</span><span class="op" id="1388577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388581">if</span>&nbsp;<span class="ident" id="1388584">r</span>&nbsp;<span class="op" id="1388586">==</span>&nbsp;<span class="ident" id="1388589">r1</span>&nbsp;<span class="op" id="1388592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388597">return</span>&nbsp;<span class="ident" id="1388604">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1388608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1388612">i</span>&nbsp;<span class="op" id="1388614">+=</span>&nbsp;<span class="ident" id="1388617">size</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1388623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388626">return</span>&nbsp;<span class="op" id="1388633">-</span><span class="num" id="1388634">1</span><br>
<span class="lineno"></span><span class="op" id="1388636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1388639">//&nbsp;IndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno">155</span><span class="comment" id="1388716">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of&nbsp;the&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1388796">//&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="1388877">//&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="1388897">func</span>&nbsp;<span class="ident" id="1388902">IndexAny</span><span class="op" id="1388910">(</span><span class="ident" id="1388911">s</span>&nbsp;<span class="op" id="1388913">[</span><span class="op" id="1388914">]</span><span class="builtintype" id="1388915">byte</span><span class="op" id="1388919">,</span>&nbsp;<span class="ident" id="1388921">chars</span>&nbsp;<span class="builtintype" id="1388927">string</span><span class="op" id="1388933">)</span>&nbsp;<span class="builtintype" id="1388935">int</span>&nbsp;<span class="op" id="1388939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388942">if</span>&nbsp;<span class="builtinfunc" id="1388945">len</span><span class="op" id="1388948">(</span><span class="ident" id="1388949">chars</span><span class="op" id="1388954">)</span>&nbsp;<span class="op" id="1388956">&gt;</span>&nbsp;<span class="num" id="1388958">0</span>&nbsp;<span class="op" id="1388960">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388964">var</span>&nbsp;<span class="ident" id="1388968">r</span>&nbsp;<span class="builtintype" id="1388970">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388977">var</span>&nbsp;<span class="ident" id="1388981">width</span>&nbsp;<span class="builtintype" id="1388987">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1388993">for</span>&nbsp;<span class="ident" id="1388997">i</span>&nbsp;<span class="op" id="1388999">:=</span>&nbsp;<span class="num" id="1389002">0</span><span class="op" id="1389003">;</span>&nbsp;<span class="ident" id="1389005">i</span>&nbsp;<span class="op" id="1389007">&lt;</span>&nbsp;<span class="builtinfunc" id="1389009">len</span><span class="op" id="1389012">(</span><span class="ident" id="1389013">s</span><span class="op" id="1389014">)</span><span class="op" id="1389015">;</span>&nbsp;<span class="ident" id="1389017">i</span>&nbsp;<span class="op" id="1389019">+=</span>&nbsp;<span class="ident" id="1389022">width</span>&nbsp;<span class="op" id="1389028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1389033">r</span>&nbsp;<span class="op" id="1389035">=</span>&nbsp;<span class="builtintype" id="1389037">rune</span><span class="op" id="1389041">(</span><span class="ident" id="1389042">s</span><span class="op" id="1389043">[</span><span class="ident" id="1389044">i</span><span class="op" id="1389045">]</span><span class="op" id="1389046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389051">if</span>&nbsp;<span class="ident" id="1389054">r</span>&nbsp;<span class="op" id="1389056">&lt;</span>&nbsp;<span class="ident" id="1389058">utf8</span><span class="op" id="1389062">.</span><span class="ident" id="1389063">RuneSelf</span>&nbsp;<span class="op" id="1389072">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1389078">width</span>&nbsp;<span class="op" id="1389084">=</span>&nbsp;<span class="num" id="1389086">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389091">}</span>&nbsp;<span class="keyword" id="1389093">else</span>&nbsp;<span class="op" id="1389098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1389104">r</span><span class="op" id="1389105">,</span>&nbsp;<span class="ident" id="1389107">width</span>&nbsp;<span class="op" id="1389113">=</span>&nbsp;<span class="ident" id="1389115">utf8</span><span class="op" id="1389119">.</span><span class="ident" id="1389120">DecodeRune</span><span class="op" id="1389130">(</span><span class="ident" id="1389131">s</span><span class="op" id="1389132">[</span><span class="ident" id="1389133">i</span><span class="op" id="1389134">:</span><span class="op" id="1389135">]</span><span class="op" id="1389136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389146">for</span>&nbsp;<span class="ident" id="1389150">_</span><span class="op" id="1389151">,</span>&nbsp;<span class="ident" id="1389153">ch</span>&nbsp;<span class="op" id="1389156">:=</span>&nbsp;<span class="keyword" id="1389159">range</span>&nbsp;<span class="ident" id="1389165">chars</span>&nbsp;<span class="op" id="1389171">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389177">if</span>&nbsp;<span class="ident" id="1389180">r</span>&nbsp;<span class="op" id="1389182">==</span>&nbsp;<span class="ident" id="1389185">ch</span>&nbsp;<span class="op" id="1389188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389195">return</span>&nbsp;<span class="ident" id="1389202">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389217">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389223">return</span>&nbsp;<span class="op" id="1389230">-</span><span class="num" id="1389231">1</span><br>
<span class="lineno"></span><span class="op" id="1389233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1389236">//&nbsp;LastIndexAny&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code</span><br>
<span class="lineno">180</span><span class="comment" id="1389309">//&nbsp;points.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;occurrence&nbsp;in&nbsp;s&nbsp;of&nbsp;any&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1389385">//&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;in&nbsp;chars.&nbsp;&nbsp;It&nbsp;returns&nbsp;-1&nbsp;if&nbsp;chars&nbsp;is&nbsp;empty&nbsp;or&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1389461">//&nbsp;there&nbsp;is&nbsp;no&nbsp;code&nbsp;point&nbsp;in&nbsp;common.</span><br>
<span class="lineno"></span><span class="keyword" id="1389498">func</span>&nbsp;<span class="ident" id="1389503">LastIndexAny</span><span class="op" id="1389515">(</span><span class="ident" id="1389516">s</span>&nbsp;<span class="op" id="1389518">[</span><span class="op" id="1389519">]</span><span class="builtintype" id="1389520">byte</span><span class="op" id="1389524">,</span>&nbsp;<span class="ident" id="1389526">chars</span>&nbsp;<span class="builtintype" id="1389532">string</span><span class="op" id="1389538">)</span>&nbsp;<span class="builtintype" id="1389540">int</span>&nbsp;<span class="op" id="1389544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389547">if</span>&nbsp;<span class="builtinfunc" id="1389550">len</span><span class="op" id="1389553">(</span><span class="ident" id="1389554">chars</span><span class="op" id="1389559">)</span>&nbsp;<span class="op" id="1389561">&gt;</span>&nbsp;<span class="num" id="1389563">0</span>&nbsp;<span class="op" id="1389565">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389569">for</span>&nbsp;<span class="ident" id="1389573">i</span>&nbsp;<span class="op" id="1389575">:=</span>&nbsp;<span class="builtinfunc" id="1389578">len</span><span class="op" id="1389581">(</span><span class="ident" id="1389582">s</span><span class="op" id="1389583">)</span><span class="op" id="1389584">;</span>&nbsp;<span class="ident" id="1389586">i</span>&nbsp;<span class="op" id="1389588">&gt;</span>&nbsp;<span class="num" id="1389590">0</span><span class="op" id="1389591">;</span>&nbsp;<span class="op" id="1389593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1389598">r</span><span class="op" id="1389599">,</span>&nbsp;<span class="ident" id="1389601">size</span>&nbsp;<span class="op" id="1389606">:=</span>&nbsp;<span class="ident" id="1389609">utf8</span><span class="op" id="1389613">.</span><span class="ident" id="1389614">DecodeLastRune</span><span class="op" id="1389628">(</span><span class="ident" id="1389629">s</span><span class="op" id="1389630">[</span><span class="num" id="1389631">0</span><span class="op" id="1389632">:</span><span class="ident" id="1389633">i</span><span class="op" id="1389634">]</span><span class="op" id="1389635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1389640">i</span>&nbsp;<span class="op" id="1389642">-=</span>&nbsp;<span class="ident" id="1389645">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389653">for</span>&nbsp;<span class="ident" id="1389657">_</span><span class="op" id="1389658">,</span>&nbsp;<span class="ident" id="1389660">ch</span>&nbsp;<span class="op" id="1389663">:=</span>&nbsp;<span class="keyword" id="1389666">range</span>&nbsp;<span class="ident" id="1389672">chars</span>&nbsp;<span class="op" id="1389678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389684">if</span>&nbsp;<span class="ident" id="1389687">r</span>&nbsp;<span class="op" id="1389689">==</span>&nbsp;<span class="ident" id="1389692">ch</span>&nbsp;<span class="op" id="1389695">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389702">return</span>&nbsp;<span class="ident" id="1389709">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389727">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389730">return</span>&nbsp;<span class="op" id="1389737">-</span><span class="num" id="1389738">1</span><br>
<span class="lineno"></span><span class="op" id="1389740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1389743">//&nbsp;Generic&nbsp;split:&nbsp;splits&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep,</span><br>
<span class="lineno"></span><span class="comment" id="1389796">//&nbsp;including&nbsp;sepSave&nbsp;bytes&nbsp;of&nbsp;sep&nbsp;in&nbsp;the&nbsp;subslices.</span><br>
<span class="lineno">200</span><span class="keyword" id="1389848">func</span>&nbsp;<span class="ident" id="1389853">genSplit</span><span class="op" id="1389861">(</span><span class="ident" id="1389862">s</span><span class="op" id="1389863">,</span>&nbsp;<span class="ident" id="1389865">sep</span>&nbsp;<span class="op" id="1389869">[</span><span class="op" id="1389870">]</span><span class="builtintype" id="1389871">byte</span><span class="op" id="1389875">,</span>&nbsp;<span class="ident" id="1389877">sepSave</span><span class="op" id="1389884">,</span>&nbsp;<span class="ident" id="1389886">n</span>&nbsp;<span class="builtintype" id="1389888">int</span><span class="op" id="1389891">)</span>&nbsp;<span class="op" id="1389893">[</span><span class="op" id="1389894">]</span><span class="op" id="1389895">[</span><span class="op" id="1389896">]</span><span class="builtintype" id="1389897">byte</span>&nbsp;<span class="op" id="1389902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389905">if</span>&nbsp;<span class="ident" id="1389908">n</span>&nbsp;<span class="op" id="1389910">==</span>&nbsp;<span class="num" id="1389913">0</span>&nbsp;<span class="op" id="1389915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389919">return</span>&nbsp;<span class="ident" id="1389926">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389934">if</span>&nbsp;<span class="builtinfunc" id="1389937">len</span><span class="op" id="1389940">(</span><span class="ident" id="1389941">sep</span><span class="op" id="1389944">)</span>&nbsp;<span class="op" id="1389946">==</span>&nbsp;<span class="num" id="1389949">0</span>&nbsp;<span class="op" id="1389951">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389955">return</span>&nbsp;<span class="ident" id="1389962">explode</span><span class="op" id="1389969">(</span><span class="ident" id="1389970">s</span><span class="op" id="1389971">,</span>&nbsp;<span class="ident" id="1389973">n</span><span class="op" id="1389974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1389977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1389980">if</span>&nbsp;<span class="ident" id="1389983">n</span>&nbsp;<span class="op" id="1389985">&lt;</span>&nbsp;<span class="num" id="1389987">0</span>&nbsp;<span class="op" id="1389989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1389993">n</span>&nbsp;<span class="op" id="1389995">=</span>&nbsp;<span class="ident" id="1389997">Count</span><span class="op" id="1390002">(</span><span class="ident" id="1390003">s</span><span class="op" id="1390004">,</span>&nbsp;<span class="ident" id="1390006">sep</span><span class="op" id="1390009">)</span>&nbsp;<span class="op" id="1390011">+</span>&nbsp;<span class="num" id="1390013">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1390016">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1390019">c</span>&nbsp;<span class="op" id="1390021">:=</span>&nbsp;<span class="ident" id="1390024">sep</span><span class="op" id="1390027">[</span><span class="num" id="1390028">0</span><span class="op" id="1390029">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1390032">start</span>&nbsp;<span class="op" id="1390038">:=</span>&nbsp;<span class="num" id="1390041">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1390044">a</span>&nbsp;<span class="op" id="1390046">:=</span>&nbsp;<span class="builtinfunc" id="1390049">make</span><span class="op" id="1390053">(</span><span class="op" id="1390054">[</span><span class="op" id="1390055">]</span><span class="op" id="1390056">[</span><span class="op" id="1390057">]</span><span class="builtintype" id="1390058">byte</span><span class="op" id="1390062">,</span>&nbsp;<span class="ident" id="1390064">n</span><span class="op" id="1390065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1390068">na</span>&nbsp;<span class="op" id="1390071">:=</span>&nbsp;<span class="num" id="1390074">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1390077">for</span>&nbsp;<span class="ident" id="1390081">i</span>&nbsp;<span class="op" id="1390083">:=</span>&nbsp;<span class="num" id="1390086">0</span><span class="op" id="1390087">;</span>&nbsp;<span class="ident" id="1390089">i</span><span class="op" id="1390090">+</span><span class="builtinfunc" id="1390091">len</span><span class="op" id="1390094">(</span><span class="ident" id="1390095">sep</span><span class="op" id="1390098">)</span>&nbsp;<span class="op" id="1390100">&lt;=</span>&nbsp;<span class="builtinfunc" id="1390103">len</span><span class="op" id="1390106">(</span><span class="ident" id="1390107">s</span><span class="op" id="1390108">)</span>&nbsp;<span class="op" id="1390110">&amp;&amp;</span>&nbsp;<span class="ident" id="1390113">na</span><span class="op" id="1390115">+</span><span class="num" id="1390116">1</span>&nbsp;<span class="op" id="1390118">&lt;</span>&nbsp;<span class="ident" id="1390120">n</span><span class="op" id="1390121">;</span>&nbsp;<span class="ident" id="1390123">i</span><span class="op" id="1390124">++</span>&nbsp;<span class="op" id="1390127">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1390131">if</span>&nbsp;<span class="ident" id="1390134">s</span><span class="op" id="1390135">[</span><span class="ident" id="1390136">i</span><span class="op" id="1390137">]</span>&nbsp;<span class="op" id="1390139">==</span>&nbsp;<span class="ident" id="1390142">c</span>&nbsp;<span class="op" id="1390144">&amp;&amp;</span>&nbsp;<span class="op" id="1390147">(</span><span class="builtinfunc" id="1390148">len</span><span class="op" id="1390151">(</span><span class="ident" id="1390152">sep</span><span class="op" id="1390155">)</span>&nbsp;<span class="op" id="1390157">==</span>&nbsp;<span class="num" id="1390160">1</span>&nbsp;<span class="op" id="1390162">||</span>&nbsp;<span class="ident" id="1390165">Equal</span><span class="op" id="1390170">(</span><span class="ident" id="1390171">s</span><span class="op" id="1390172">[</span><span class="ident" id="1390173">i</span><span class="op" id="1390174">:</span><span class="ident" id="1390175">i</span><span class="op" id="1390176">+</span><span class="builtinfunc" id="1390177">len</span><span class="op" id="1390180">(</span><span class="ident" id="1390181">sep</span><span class="op" id="1390184">)</span><span class="op" id="1390185">]</span><span class="op" id="1390186">,</span>&nbsp;<span class="ident" id="1390188">sep</span><span class="op" id="1390191">)</span><span class="op" id="1390192">)</span>&nbsp;<span class="op" id="1390194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1390199">a</span><span class="op" id="1390200">[</span><span class="ident" id="1390201">na</span><span class="op" id="1390203">]</span>&nbsp;<span class="op" id="1390205">=</span>&nbsp;<span class="ident" id="1390207">s</span><span class="op" id="1390208">[</span><span class="ident" id="1390209">start</span>&nbsp;<span class="op" id="1390215">:</span>&nbsp;<span class="ident" id="1390217">i</span><span class="op" id="1390218">+</span><span class="ident" id="1390219">sepSave</span><span class="op" id="1390226">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1390231">na</span><span class="op" id="1390233">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1390239">start</span>&nbsp;<span class="op" id="1390245">=</span>&nbsp;<span class="ident" id="1390247">i</span>&nbsp;<span class="op" id="1390249">+</span>&nbsp;<span class="builtinfunc" id="1390251">len</span><span class="op" id="1390254">(</span><span class="ident" id="1390255">sep</span><span class="op" id="1390258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1390263">i</span>&nbsp;<span class="op" id="1390265">+=</span>&nbsp;<span class="builtinfunc" id="1390268">len</span><span class="op" id="1390271">(</span><span class="ident" id="1390272">sep</span><span class="op" id="1390275">)</span>&nbsp;<span class="op" id="1390277">-</span>&nbsp;<span class="num" id="1390279">1</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1390283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1390286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1390289">a</span><span class="op" id="1390290">[</span><span class="ident" id="1390291">na</span><span class="op" id="1390293">]</span>&nbsp;<span class="op" id="1390295">=</span>&nbsp;<span class="ident" id="1390297">s</span><span class="op" id="1390298">[</span><span class="ident" id="1390299">start</span><span class="op" id="1390304">:</span><span class="op" id="1390305">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1390308">return</span>&nbsp;<span class="ident" id="1390315">a</span><span class="op" id="1390316">[</span><span class="num" id="1390317">0</span>&nbsp;<span class="op" id="1390319">:</span>&nbsp;<span class="ident" id="1390321">na</span><span class="op" id="1390323">+</span><span class="num" id="1390324">1</span><span class="op" id="1390325">]</span><br>
<span class="lineno"></span><span class="op" id="1390327">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="1390330">//&nbsp;SplitN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1390404">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="1390447">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1390508">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno">230</span><span class="comment" id="1390567">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="1390649">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="1390697">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="1390723">func</span>&nbsp;<span class="ident" id="1390728">SplitN</span><span class="op" id="1390734">(</span><span class="ident" id="1390735">s</span><span class="op" id="1390736">,</span>&nbsp;<span class="ident" id="1390738">sep</span>&nbsp;<span class="op" id="1390742">[</span><span class="op" id="1390743">]</span><span class="builtintype" id="1390744">byte</span><span class="op" id="1390748">,</span>&nbsp;<span class="ident" id="1390750">n</span>&nbsp;<span class="builtintype" id="1390752">int</span><span class="op" id="1390755">)</span>&nbsp;<span class="op" id="1390757">[</span><span class="op" id="1390758">]</span><span class="op" id="1390759">[</span><span class="op" id="1390760">]</span><span class="builtintype" id="1390761">byte</span>&nbsp;<span class="op" id="1390766">{</span>&nbsp;<span class="keyword" id="1390768">return</span>&nbsp;<span class="ident" id="1390775">genSplit</span><span class="op" id="1390783">(</span><span class="ident" id="1390784">s</span><span class="op" id="1390785">,</span>&nbsp;<span class="ident" id="1390787">sep</span><span class="op" id="1390790">,</span>&nbsp;<span class="num" id="1390792">0</span><span class="op" id="1390793">,</span>&nbsp;<span class="ident" id="1390795">n</span><span class="op" id="1390796">)</span>&nbsp;<span class="op" id="1390798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="1390801">//&nbsp;SplitAfterN&nbsp;slices&nbsp;s&nbsp;into&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1390871">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="1390910">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfterN&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1390976">//&nbsp;The&nbsp;count&nbsp;determines&nbsp;the&nbsp;number&nbsp;of&nbsp;subslices&nbsp;to&nbsp;return:</span><br>
<span class="lineno"></span><span class="comment" id="1391035">//&nbsp;&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0:&nbsp;at&nbsp;most&nbsp;n&nbsp;subslices;&nbsp;the&nbsp;last&nbsp;subslice&nbsp;will&nbsp;be&nbsp;the&nbsp;unsplit&nbsp;remainder.</span><br>
<span class="lineno">240</span><span class="comment" id="1391117">//&nbsp;&nbsp;&nbsp;n&nbsp;==&nbsp;0:&nbsp;the&nbsp;result&nbsp;is&nbsp;nil&nbsp;(zero&nbsp;subslices)</span><br>
<span class="lineno"></span><span class="comment" id="1391165">//&nbsp;&nbsp;&nbsp;n&nbsp;&lt;&nbsp;0:&nbsp;all&nbsp;subslices</span><br>
<span class="lineno"></span><span class="keyword" id="1391191">func</span>&nbsp;<span class="ident" id="1391196">SplitAfterN</span><span class="op" id="1391207">(</span><span class="ident" id="1391208">s</span><span class="op" id="1391209">,</span>&nbsp;<span class="ident" id="1391211">sep</span>&nbsp;<span class="op" id="1391215">[</span><span class="op" id="1391216">]</span><span class="builtintype" id="1391217">byte</span><span class="op" id="1391221">,</span>&nbsp;<span class="ident" id="1391223">n</span>&nbsp;<span class="builtintype" id="1391225">int</span><span class="op" id="1391228">)</span>&nbsp;<span class="op" id="1391230">[</span><span class="op" id="1391231">]</span><span class="op" id="1391232">[</span><span class="op" id="1391233">]</span><span class="builtintype" id="1391234">byte</span>&nbsp;<span class="op" id="1391239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1391242">return</span>&nbsp;<span class="ident" id="1391249">genSplit</span><span class="op" id="1391257">(</span><span class="ident" id="1391258">s</span><span class="op" id="1391259">,</span>&nbsp;<span class="ident" id="1391261">sep</span><span class="op" id="1391264">,</span>&nbsp;<span class="builtinfunc" id="1391266">len</span><span class="op" id="1391269">(</span><span class="ident" id="1391270">sep</span><span class="op" id="1391273">)</span><span class="op" id="1391274">,</span>&nbsp;<span class="ident" id="1391276">n</span><span class="op" id="1391277">)</span><br>
<span class="lineno"></span><span class="op" id="1391279">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="1391282">//&nbsp;Split&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;separated&nbsp;by&nbsp;sep&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1391359">//&nbsp;the&nbsp;subslices&nbsp;between&nbsp;those&nbsp;separators.</span><br>
<span class="lineno"></span><span class="comment" id="1391402">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;Split&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="1391462">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno">250</span><span class="keyword" id="1391512">func</span>&nbsp;<span class="ident" id="1391517">Split</span><span class="op" id="1391522">(</span><span class="ident" id="1391523">s</span><span class="op" id="1391524">,</span>&nbsp;<span class="ident" id="1391526">sep</span>&nbsp;<span class="op" id="1391530">[</span><span class="op" id="1391531">]</span><span class="builtintype" id="1391532">byte</span><span class="op" id="1391536">)</span>&nbsp;<span class="op" id="1391538">[</span><span class="op" id="1391539">]</span><span class="op" id="1391540">[</span><span class="op" id="1391541">]</span><span class="builtintype" id="1391542">byte</span>&nbsp;<span class="op" id="1391547">{</span>&nbsp;<span class="keyword" id="1391549">return</span>&nbsp;<span class="ident" id="1391556">genSplit</span><span class="op" id="1391564">(</span><span class="ident" id="1391565">s</span><span class="op" id="1391566">,</span>&nbsp;<span class="ident" id="1391568">sep</span><span class="op" id="1391571">,</span>&nbsp;<span class="num" id="1391573">0</span><span class="op" id="1391574">,</span>&nbsp;<span class="op" id="1391576">-</span><span class="num" id="1391577">1</span><span class="op" id="1391578">)</span>&nbsp;<span class="op" id="1391580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1391583">//&nbsp;SplitAfter&nbsp;slices&nbsp;s&nbsp;into&nbsp;all&nbsp;subslices&nbsp;after&nbsp;each&nbsp;instance&nbsp;of&nbsp;sep&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1391656">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;those&nbsp;subslices.</span><br>
<span class="lineno"></span><span class="comment" id="1391695">//&nbsp;If&nbsp;sep&nbsp;is&nbsp;empty,&nbsp;SplitAfter&nbsp;splits&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno">255</span><span class="comment" id="1391760">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;SplitAfterN&nbsp;with&nbsp;a&nbsp;count&nbsp;of&nbsp;-1.</span><br>
<span class="lineno"></span><span class="keyword" id="1391815">func</span>&nbsp;<span class="ident" id="1391820">SplitAfter</span><span class="op" id="1391830">(</span><span class="ident" id="1391831">s</span><span class="op" id="1391832">,</span>&nbsp;<span class="ident" id="1391834">sep</span>&nbsp;<span class="op" id="1391838">[</span><span class="op" id="1391839">]</span><span class="builtintype" id="1391840">byte</span><span class="op" id="1391844">)</span>&nbsp;<span class="op" id="1391846">[</span><span class="op" id="1391847">]</span><span class="op" id="1391848">[</span><span class="op" id="1391849">]</span><span class="builtintype" id="1391850">byte</span>&nbsp;<span class="op" id="1391855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1391858">return</span>&nbsp;<span class="ident" id="1391865">genSplit</span><span class="op" id="1391873">(</span><span class="ident" id="1391874">s</span><span class="op" id="1391875">,</span>&nbsp;<span class="ident" id="1391877">sep</span><span class="op" id="1391880">,</span>&nbsp;<span class="builtinfunc" id="1391882">len</span><span class="op" id="1391885">(</span><span class="ident" id="1391886">sep</span><span class="op" id="1391889">)</span><span class="op" id="1391890">,</span>&nbsp;<span class="op" id="1391892">-</span><span class="num" id="1391893">1</span><span class="op" id="1391894">)</span><br>
<span class="lineno"></span><span class="op" id="1391896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="1391899">//&nbsp;Fields&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;around&nbsp;each&nbsp;instance&nbsp;of&nbsp;one&nbsp;or&nbsp;more&nbsp;consecutive&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span><span class="comment" id="1391988">//&nbsp;characters,&nbsp;returning&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s&nbsp;or&nbsp;an&nbsp;empty&nbsp;list&nbsp;if&nbsp;s&nbsp;contains&nbsp;only&nbsp;white&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="1392088">func</span>&nbsp;<span class="ident" id="1392093">Fields</span><span class="op" id="1392099">(</span><span class="ident" id="1392100">s</span>&nbsp;<span class="op" id="1392102">[</span><span class="op" id="1392103">]</span><span class="builtintype" id="1392104">byte</span><span class="op" id="1392108">)</span>&nbsp;<span class="op" id="1392110">[</span><span class="op" id="1392111">]</span><span class="op" id="1392112">[</span><span class="op" id="1392113">]</span><span class="builtintype" id="1392114">byte</span>&nbsp;<span class="op" id="1392119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1392122">return</span>&nbsp;<span class="ident" id="1392129">FieldsFunc</span><span class="op" id="1392139">(</span><span class="ident" id="1392140">s</span><span class="op" id="1392141">,</span>&nbsp;<span class="ident" id="1392143">unicode</span><span class="op" id="1392150">.</span><span class="ident" id="1392151">IsSpace</span><span class="op" id="1392158">)</span><br>
<span class="lineno"></span><span class="op" id="1392160">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="comment" id="1392163">//&nbsp;FieldsFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1392242">//&nbsp;It&nbsp;splits&nbsp;the&nbsp;slice&nbsp;s&nbsp;at&nbsp;each&nbsp;run&nbsp;of&nbsp;code&nbsp;points&nbsp;c&nbsp;satisfying&nbsp;f(c)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1392316">//&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;subslices&nbsp;of&nbsp;s.&nbsp;&nbsp;If&nbsp;all&nbsp;code&nbsp;points&nbsp;in&nbsp;s&nbsp;satisfy&nbsp;f(c),&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1392396">//&nbsp;len(s)&nbsp;==&nbsp;0,&nbsp;an&nbsp;empty&nbsp;slice&nbsp;is&nbsp;returned.</span><br>
<span class="lineno">270</span><span class="comment" id="1392440">//&nbsp;FieldsFunc&nbsp;makes&nbsp;no&nbsp;guarantees&nbsp;about&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;it&nbsp;calls&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="comment" id="1392514">//&nbsp;If&nbsp;f&nbsp;does&nbsp;not&nbsp;return&nbsp;consistent&nbsp;results&nbsp;for&nbsp;a&nbsp;given&nbsp;c,&nbsp;FieldsFunc&nbsp;may&nbsp;crash.</span><br>
<span class="lineno"></span><span class="keyword" id="1392594">func</span>&nbsp;<span class="ident" id="1392599">FieldsFunc</span><span class="op" id="1392609">(</span><span class="ident" id="1392610">s</span>&nbsp;<span class="op" id="1392612">[</span><span class="op" id="1392613">]</span><span class="builtintype" id="1392614">byte</span><span class="op" id="1392618">,</span>&nbsp;<span class="ident" id="1392620">f</span>&nbsp;<span class="keyword" id="1392622">func</span><span class="op" id="1392626">(</span><span class="builtintype" id="1392627">rune</span><span class="op" id="1392631">)</span>&nbsp;<span class="builtintype" id="1392633">bool</span><span class="op" id="1392637">)</span>&nbsp;<span class="op" id="1392639">[</span><span class="op" id="1392640">]</span><span class="op" id="1392641">[</span><span class="op" id="1392642">]</span><span class="builtintype" id="1392643">byte</span>&nbsp;<span class="op" id="1392648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1392651">n</span>&nbsp;<span class="op" id="1392653">:=</span>&nbsp;<span class="num" id="1392656">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1392659">inField</span>&nbsp;<span class="op" id="1392667">:=</span>&nbsp;<span class="builtintype" id="1392670">false</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1392677">for</span>&nbsp;<span class="ident" id="1392681">i</span>&nbsp;<span class="op" id="1392683">:=</span>&nbsp;<span class="num" id="1392686">0</span><span class="op" id="1392687">;</span>&nbsp;<span class="ident" id="1392689">i</span>&nbsp;<span class="op" id="1392691">&lt;</span>&nbsp;<span class="builtinfunc" id="1392693">len</span><span class="op" id="1392696">(</span><span class="ident" id="1392697">s</span><span class="op" id="1392698">)</span><span class="op" id="1392699">;</span>&nbsp;<span class="op" id="1392701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1392705">r</span><span class="op" id="1392706">,</span>&nbsp;<span class="ident" id="1392708">size</span>&nbsp;<span class="op" id="1392713">:=</span>&nbsp;<span class="ident" id="1392716">utf8</span><span class="op" id="1392720">.</span><span class="ident" id="1392721">DecodeRune</span><span class="op" id="1392731">(</span><span class="ident" id="1392732">s</span><span class="op" id="1392733">[</span><span class="ident" id="1392734">i</span><span class="op" id="1392735">:</span><span class="op" id="1392736">]</span><span class="op" id="1392737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1392741">wasInField</span>&nbsp;<span class="op" id="1392752">:=</span>&nbsp;<span class="ident" id="1392755">inField</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1392765">inField</span>&nbsp;<span class="op" id="1392773">=</span>&nbsp;<span class="op" id="1392775">!</span><span class="ident" id="1392776">f</span><span class="op" id="1392777">(</span><span class="ident" id="1392778">r</span><span class="op" id="1392779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1392783">if</span>&nbsp;<span class="ident" id="1392786">inField</span>&nbsp;<span class="op" id="1392794">&amp;&amp;</span>&nbsp;<span class="op" id="1392797">!</span><span class="ident" id="1392798">wasInField</span>&nbsp;<span class="op" id="1392809">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1392814">n</span><span class="op" id="1392815">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1392820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1392824">i</span>&nbsp;<span class="op" id="1392826">+=</span>&nbsp;<span class="ident" id="1392829">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1392835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1392839">a</span>&nbsp;<span class="op" id="1392841">:=</span>&nbsp;<span class="builtinfunc" id="1392844">make</span><span class="op" id="1392848">(</span><span class="op" id="1392849">[</span><span class="op" id="1392850">]</span><span class="op" id="1392851">[</span><span class="op" id="1392852">]</span><span class="builtintype" id="1392853">byte</span><span class="op" id="1392857">,</span>&nbsp;<span class="ident" id="1392859">n</span><span class="op" id="1392860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1392863">na</span>&nbsp;<span class="op" id="1392866">:=</span>&nbsp;<span class="num" id="1392869">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1392872">fieldStart</span>&nbsp;<span class="op" id="1392883">:=</span>&nbsp;<span class="op" id="1392886">-</span><span class="num" id="1392887">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1392890">for</span>&nbsp;<span class="ident" id="1392894">i</span>&nbsp;<span class="op" id="1392896">:=</span>&nbsp;<span class="num" id="1392899">0</span><span class="op" id="1392900">;</span>&nbsp;<span class="ident" id="1392902">i</span>&nbsp;<span class="op" id="1392904">&lt;=</span>&nbsp;<span class="builtinfunc" id="1392907">len</span><span class="op" id="1392910">(</span><span class="ident" id="1392911">s</span><span class="op" id="1392912">)</span>&nbsp;<span class="op" id="1392914">&amp;&amp;</span>&nbsp;<span class="ident" id="1392917">na</span>&nbsp;<span class="op" id="1392920">&lt;</span>&nbsp;<span class="ident" id="1392922">n</span><span class="op" id="1392923">;</span>&nbsp;<span class="op" id="1392925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1392929">r</span><span class="op" id="1392930">,</span>&nbsp;<span class="ident" id="1392932">size</span>&nbsp;<span class="op" id="1392937">:=</span>&nbsp;<span class="ident" id="1392940">utf8</span><span class="op" id="1392944">.</span><span class="ident" id="1392945">DecodeRune</span><span class="op" id="1392955">(</span><span class="ident" id="1392956">s</span><span class="op" id="1392957">[</span><span class="ident" id="1392958">i</span><span class="op" id="1392959">:</span><span class="op" id="1392960">]</span><span class="op" id="1392961">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1392965">if</span>&nbsp;<span class="ident" id="1392968">fieldStart</span>&nbsp;<span class="op" id="1392979">&lt;</span>&nbsp;<span class="num" id="1392981">0</span>&nbsp;<span class="op" id="1392983">&amp;&amp;</span>&nbsp;<span class="ident" id="1392986">size</span>&nbsp;<span class="op" id="1392991">&gt;</span>&nbsp;<span class="num" id="1392993">0</span>&nbsp;<span class="op" id="1392995">&amp;&amp;</span>&nbsp;<span class="op" id="1392998">!</span><span class="ident" id="1392999">f</span><span class="op" id="1393000">(</span><span class="ident" id="1393001">r</span><span class="op" id="1393002">)</span>&nbsp;<span class="op" id="1393004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1393009">fieldStart</span>&nbsp;<span class="op" id="1393020">=</span>&nbsp;<span class="ident" id="1393022">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1393027">i</span>&nbsp;<span class="op" id="1393029">+=</span>&nbsp;<span class="ident" id="1393032">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1393040">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1393051">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1393055">if</span>&nbsp;<span class="ident" id="1393058">fieldStart</span>&nbsp;<span class="op" id="1393069">&gt;=</span>&nbsp;<span class="num" id="1393072">0</span>&nbsp;<span class="op" id="1393074">&amp;&amp;</span>&nbsp;<span class="op" id="1393077">(</span><span class="ident" id="1393078">size</span>&nbsp;<span class="op" id="1393083">==</span>&nbsp;<span class="num" id="1393086">0</span>&nbsp;<span class="op" id="1393088">||</span>&nbsp;<span class="ident" id="1393091">f</span><span class="op" id="1393092">(</span><span class="ident" id="1393093">r</span><span class="op" id="1393094">)</span><span class="op" id="1393095">)</span>&nbsp;<span class="op" id="1393097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1393102">a</span><span class="op" id="1393103">[</span><span class="ident" id="1393104">na</span><span class="op" id="1393106">]</span>&nbsp;<span class="op" id="1393108">=</span>&nbsp;<span class="ident" id="1393110">s</span><span class="op" id="1393111">[</span><span class="ident" id="1393112">fieldStart</span><span class="op" id="1393122">:</span><span class="ident" id="1393123">i</span><span class="op" id="1393124">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1393129">na</span><span class="op" id="1393131">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1393137">fieldStart</span>&nbsp;<span class="op" id="1393148">=</span>&nbsp;<span class="op" id="1393150">-</span><span class="num" id="1393151">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1393155">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1393159">if</span>&nbsp;<span class="ident" id="1393162">size</span>&nbsp;<span class="op" id="1393167">==</span>&nbsp;<span class="num" id="1393170">0</span>&nbsp;<span class="op" id="1393172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1393177">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1393185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1393189">i</span>&nbsp;<span class="op" id="1393191">+=</span>&nbsp;<span class="ident" id="1393194">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1393200">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1393203">return</span>&nbsp;<span class="ident" id="1393210">a</span><span class="op" id="1393211">[</span><span class="num" id="1393212">0</span><span class="op" id="1393213">:</span><span class="ident" id="1393214">na</span><span class="op" id="1393216">]</span><br>
<span class="lineno"></span><span class="op" id="1393218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1393221">//&nbsp;Join&nbsp;concatenates&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice.&nbsp;The&nbsp;separator</span><br>
<span class="lineno"></span><span class="comment" id="1393302">//&nbsp;sep&nbsp;is&nbsp;placed&nbsp;between&nbsp;elements&nbsp;in&nbsp;the&nbsp;resulting&nbsp;slice.</span><br>
<span class="lineno">310</span><span class="keyword" id="1393360">func</span>&nbsp;<span class="ident" id="1393365">Join</span><span class="op" id="1393369">(</span><span class="ident" id="1393370">s</span>&nbsp;<span class="op" id="1393372">[</span><span class="op" id="1393373">]</span><span class="op" id="1393374">[</span><span class="op" id="1393375">]</span><span class="builtintype" id="1393376">byte</span><span class="op" id="1393380">,</span>&nbsp;<span class="ident" id="1393382">sep</span>&nbsp;<span class="op" id="1393386">[</span><span class="op" id="1393387">]</span><span class="builtintype" id="1393388">byte</span><span class="op" id="1393392">)</span>&nbsp;<span class="op" id="1393394">[</span><span class="op" id="1393395">]</span><span class="builtintype" id="1393396">byte</span>&nbsp;<span class="op" id="1393401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1393404">if</span>&nbsp;<span class="builtinfunc" id="1393407">len</span><span class="op" id="1393410">(</span><span class="ident" id="1393411">s</span><span class="op" id="1393412">)</span>&nbsp;<span class="op" id="1393414">==</span>&nbsp;<span class="num" id="1393417">0</span>&nbsp;<span class="op" id="1393419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1393423">return</span>&nbsp;<span class="op" id="1393430">[</span><span class="op" id="1393431">]</span><span class="builtintype" id="1393432">byte</span><span class="op" id="1393436">{</span><span class="op" id="1393437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1393440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1393443">if</span>&nbsp;<span class="builtinfunc" id="1393446">len</span><span class="op" id="1393449">(</span><span class="ident" id="1393450">s</span><span class="op" id="1393451">)</span>&nbsp;<span class="op" id="1393453">==</span>&nbsp;<span class="num" id="1393456">1</span>&nbsp;<span class="op" id="1393458">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1393462">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1393487">return</span>&nbsp;<span class="builtinfunc" id="1393494">append</span><span class="op" id="1393500">(</span><span class="op" id="1393501">[</span><span class="op" id="1393502">]</span><span class="builtintype" id="1393503">byte</span><span class="op" id="1393507">(</span><span class="ident" id="1393508">nil</span><span class="op" id="1393511">)</span><span class="op" id="1393512">,</span>&nbsp;<span class="ident" id="1393514">s</span><span class="op" id="1393515">[</span><span class="num" id="1393516">0</span><span class="op" id="1393517">]</span><span class="op" id="1393518">...</span><span class="op" id="1393521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1393524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1393527">n</span>&nbsp;<span class="op" id="1393529">:=</span>&nbsp;<span class="builtinfunc" id="1393532">len</span><span class="op" id="1393535">(</span><span class="ident" id="1393536">sep</span><span class="op" id="1393539">)</span>&nbsp;<span class="op" id="1393541">*</span>&nbsp;<span class="op" id="1393543">(</span><span class="builtinfunc" id="1393544">len</span><span class="op" id="1393547">(</span><span class="ident" id="1393548">s</span><span class="op" id="1393549">)</span>&nbsp;<span class="op" id="1393551">-</span>&nbsp;<span class="num" id="1393553">1</span><span class="op" id="1393554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1393557">for</span>&nbsp;<span class="ident" id="1393561">_</span><span class="op" id="1393562">,</span>&nbsp;<span class="ident" id="1393564">v</span>&nbsp;<span class="op" id="1393566">:=</span>&nbsp;<span class="keyword" id="1393569">range</span>&nbsp;<span class="ident" id="1393575">s</span>&nbsp;<span class="op" id="1393577">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1393581">n</span>&nbsp;<span class="op" id="1393583">+=</span>&nbsp;<span class="builtinfunc" id="1393586">len</span><span class="op" id="1393589">(</span><span class="ident" id="1393590">v</span><span class="op" id="1393591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1393594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1393598">b</span>&nbsp;<span class="op" id="1393600">:=</span>&nbsp;<span class="builtinfunc" id="1393603">make</span><span class="op" id="1393607">(</span><span class="op" id="1393608">[</span><span class="op" id="1393609">]</span><span class="builtintype" id="1393610">byte</span><span class="op" id="1393614">,</span>&nbsp;<span class="ident" id="1393616">n</span><span class="op" id="1393617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1393620">bp</span>&nbsp;<span class="op" id="1393623">:=</span>&nbsp;<span class="builtinfunc" id="1393626">copy</span><span class="op" id="1393630">(</span><span class="ident" id="1393631">b</span><span class="op" id="1393632">,</span>&nbsp;<span class="ident" id="1393634">s</span><span class="op" id="1393635">[</span><span class="num" id="1393636">0</span><span class="op" id="1393637">]</span><span class="op" id="1393638">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1393641">for</span>&nbsp;<span class="ident" id="1393645">_</span><span class="op" id="1393646">,</span>&nbsp;<span class="ident" id="1393648">v</span>&nbsp;<span class="op" id="1393650">:=</span>&nbsp;<span class="keyword" id="1393653">range</span>&nbsp;<span class="ident" id="1393659">s</span><span class="op" id="1393660">[</span><span class="num" id="1393661">1</span><span class="op" id="1393662">:</span><span class="op" id="1393663">]</span>&nbsp;<span class="op" id="1393665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1393669">bp</span>&nbsp;<span class="op" id="1393672">+=</span>&nbsp;<span class="builtinfunc" id="1393675">copy</span><span class="op" id="1393679">(</span><span class="ident" id="1393680">b</span><span class="op" id="1393681">[</span><span class="ident" id="1393682">bp</span><span class="op" id="1393684">:</span><span class="op" id="1393685">]</span><span class="op" id="1393686">,</span>&nbsp;<span class="ident" id="1393688">sep</span><span class="op" id="1393691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1393695">bp</span>&nbsp;<span class="op" id="1393698">+=</span>&nbsp;<span class="builtinfunc" id="1393701">copy</span><span class="op" id="1393705">(</span><span class="ident" id="1393706">b</span><span class="op" id="1393707">[</span><span class="ident" id="1393708">bp</span><span class="op" id="1393710">:</span><span class="op" id="1393711">]</span><span class="op" id="1393712">,</span>&nbsp;<span class="ident" id="1393714">v</span><span class="op" id="1393715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1393718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1393721">return</span>&nbsp;<span class="ident" id="1393728">b</span><br>
<span class="lineno">330</span><span class="op" id="1393730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1393733">//&nbsp;HasPrefix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;begins&nbsp;with&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="1393797">func</span>&nbsp;<span class="ident" id="1393802">HasPrefix</span><span class="op" id="1393811">(</span><span class="ident" id="1393812">s</span><span class="op" id="1393813">,</span>&nbsp;<span class="ident" id="1393815">prefix</span>&nbsp;<span class="op" id="1393822">[</span><span class="op" id="1393823">]</span><span class="builtintype" id="1393824">byte</span><span class="op" id="1393828">)</span>&nbsp;<span class="builtintype" id="1393830">bool</span>&nbsp;<span class="op" id="1393835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1393838">return</span>&nbsp;<span class="builtinfunc" id="1393845">len</span><span class="op" id="1393848">(</span><span class="ident" id="1393849">s</span><span class="op" id="1393850">)</span>&nbsp;<span class="op" id="1393852">&gt;=</span>&nbsp;<span class="builtinfunc" id="1393855">len</span><span class="op" id="1393858">(</span><span class="ident" id="1393859">prefix</span><span class="op" id="1393865">)</span>&nbsp;<span class="op" id="1393867">&amp;&amp;</span>&nbsp;<span class="ident" id="1393870">Equal</span><span class="op" id="1393875">(</span><span class="ident" id="1393876">s</span><span class="op" id="1393877">[</span><span class="num" id="1393878">0</span><span class="op" id="1393879">:</span><span class="builtinfunc" id="1393880">len</span><span class="op" id="1393883">(</span><span class="ident" id="1393884">prefix</span><span class="op" id="1393890">)</span><span class="op" id="1393891">]</span><span class="op" id="1393892">,</span>&nbsp;<span class="ident" id="1393894">prefix</span><span class="op" id="1393900">)</span><br>
<span class="lineno">335</span><span class="op" id="1393902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1393905">//&nbsp;HasSuffix&nbsp;tests&nbsp;whether&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;ends&nbsp;with&nbsp;suffix.</span><br>
<span class="lineno"></span><span class="keyword" id="1393967">func</span>&nbsp;<span class="ident" id="1393972">HasSuffix</span><span class="op" id="1393981">(</span><span class="ident" id="1393982">s</span><span class="op" id="1393983">,</span>&nbsp;<span class="ident" id="1393985">suffix</span>&nbsp;<span class="op" id="1393992">[</span><span class="op" id="1393993">]</span><span class="builtintype" id="1393994">byte</span><span class="op" id="1393998">)</span>&nbsp;<span class="builtintype" id="1394000">bool</span>&nbsp;<span class="op" id="1394005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1394008">return</span>&nbsp;<span class="builtinfunc" id="1394015">len</span><span class="op" id="1394018">(</span><span class="ident" id="1394019">s</span><span class="op" id="1394020">)</span>&nbsp;<span class="op" id="1394022">&gt;=</span>&nbsp;<span class="builtinfunc" id="1394025">len</span><span class="op" id="1394028">(</span><span class="ident" id="1394029">suffix</span><span class="op" id="1394035">)</span>&nbsp;<span class="op" id="1394037">&amp;&amp;</span>&nbsp;<span class="ident" id="1394040">Equal</span><span class="op" id="1394045">(</span><span class="ident" id="1394046">s</span><span class="op" id="1394047">[</span><span class="builtinfunc" id="1394048">len</span><span class="op" id="1394051">(</span><span class="ident" id="1394052">s</span><span class="op" id="1394053">)</span><span class="op" id="1394054">-</span><span class="builtinfunc" id="1394055">len</span><span class="op" id="1394058">(</span><span class="ident" id="1394059">suffix</span><span class="op" id="1394065">)</span><span class="op" id="1394066">:</span><span class="op" id="1394067">]</span><span class="op" id="1394068">,</span>&nbsp;<span class="ident" id="1394070">suffix</span><span class="op" id="1394076">)</span><br>
<span class="lineno">340</span><span class="op" id="1394078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1394081">//&nbsp;Map&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;its&nbsp;characters&nbsp;modified</span><br>
<span class="lineno"></span><span class="comment" id="1394156">//&nbsp;according&nbsp;to&nbsp;the&nbsp;mapping&nbsp;function.&nbsp;If&nbsp;mapping&nbsp;returns&nbsp;a&nbsp;negative&nbsp;value,&nbsp;the&nbsp;character&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1394248">//&nbsp;dropped&nbsp;from&nbsp;the&nbsp;string&nbsp;with&nbsp;no&nbsp;replacement.&nbsp;&nbsp;The&nbsp;characters&nbsp;in&nbsp;s&nbsp;and&nbsp;the</span><br>
<span class="lineno">345</span><span class="comment" id="1394325">//&nbsp;output&nbsp;are&nbsp;interpreted&nbsp;as&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="1394389">func</span>&nbsp;<span class="ident" id="1394394">Map</span><span class="op" id="1394397">(</span><span class="ident" id="1394398">mapping</span>&nbsp;<span class="keyword" id="1394406">func</span><span class="op" id="1394410">(</span><span class="ident" id="1394411">r</span>&nbsp;<span class="builtintype" id="1394413">rune</span><span class="op" id="1394417">)</span>&nbsp;<span class="builtintype" id="1394419">rune</span><span class="op" id="1394423">,</span>&nbsp;<span class="ident" id="1394425">s</span>&nbsp;<span class="op" id="1394427">[</span><span class="op" id="1394428">]</span><span class="builtintype" id="1394429">byte</span><span class="op" id="1394433">)</span>&nbsp;<span class="op" id="1394435">[</span><span class="op" id="1394436">]</span><span class="builtintype" id="1394437">byte</span>&nbsp;<span class="op" id="1394442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1394445">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;the&nbsp;slice&nbsp;can&nbsp;grow&nbsp;when&nbsp;mapped,&nbsp;making</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1394507">//&nbsp;things&nbsp;unpleasant.&nbsp;&nbsp;But&nbsp;it&#39;s&nbsp;so&nbsp;rare&nbsp;we&nbsp;barge&nbsp;in&nbsp;assuming&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1394574">//&nbsp;fine.&nbsp;&nbsp;It&nbsp;could&nbsp;also&nbsp;shrink&nbsp;but&nbsp;that&nbsp;falls&nbsp;out&nbsp;naturally.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1394636">maxbytes</span>&nbsp;<span class="op" id="1394645">:=</span>&nbsp;<span class="builtinfunc" id="1394648">len</span><span class="op" id="1394651">(</span><span class="ident" id="1394652">s</span><span class="op" id="1394653">)</span>&nbsp;<span class="comment" id="1394655">//&nbsp;length&nbsp;of&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1394671">nbytes</span>&nbsp;<span class="op" id="1394678">:=</span>&nbsp;<span class="num" id="1394681">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1394690">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;encoded&nbsp;in&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1394723">b</span>&nbsp;<span class="op" id="1394725">:=</span>&nbsp;<span class="builtinfunc" id="1394728">make</span><span class="op" id="1394732">(</span><span class="op" id="1394733">[</span><span class="op" id="1394734">]</span><span class="builtintype" id="1394735">byte</span><span class="op" id="1394739">,</span>&nbsp;<span class="ident" id="1394741">maxbytes</span><span class="op" id="1394749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1394752">for</span>&nbsp;<span class="ident" id="1394756">i</span>&nbsp;<span class="op" id="1394758">:=</span>&nbsp;<span class="num" id="1394761">0</span><span class="op" id="1394762">;</span>&nbsp;<span class="ident" id="1394764">i</span>&nbsp;<span class="op" id="1394766">&lt;</span>&nbsp;<span class="builtinfunc" id="1394768">len</span><span class="op" id="1394771">(</span><span class="ident" id="1394772">s</span><span class="op" id="1394773">)</span><span class="op" id="1394774">;</span>&nbsp;<span class="op" id="1394776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1394780">wid</span>&nbsp;<span class="op" id="1394784">:=</span>&nbsp;<span class="num" id="1394787">1</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1394791">r</span>&nbsp;<span class="op" id="1394793">:=</span>&nbsp;<span class="builtintype" id="1394796">rune</span><span class="op" id="1394800">(</span><span class="ident" id="1394801">s</span><span class="op" id="1394802">[</span><span class="ident" id="1394803">i</span><span class="op" id="1394804">]</span><span class="op" id="1394805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1394809">if</span>&nbsp;<span class="ident" id="1394812">r</span>&nbsp;<span class="op" id="1394814">&gt;=</span>&nbsp;<span class="ident" id="1394817">utf8</span><span class="op" id="1394821">.</span><span class="ident" id="1394822">RuneSelf</span>&nbsp;<span class="op" id="1394831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1394836">r</span><span class="op" id="1394837">,</span>&nbsp;<span class="ident" id="1394839">wid</span>&nbsp;<span class="op" id="1394843">=</span>&nbsp;<span class="ident" id="1394845">utf8</span><span class="op" id="1394849">.</span><span class="ident" id="1394850">DecodeRune</span><span class="op" id="1394860">(</span><span class="ident" id="1394861">s</span><span class="op" id="1394862">[</span><span class="ident" id="1394863">i</span><span class="op" id="1394864">:</span><span class="op" id="1394865">]</span><span class="op" id="1394866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1394870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1394874">r</span>&nbsp;<span class="op" id="1394876">=</span>&nbsp;<span class="ident" id="1394878">mapping</span><span class="op" id="1394885">(</span><span class="ident" id="1394886">r</span><span class="op" id="1394887">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1394891">if</span>&nbsp;<span class="ident" id="1394894">r</span>&nbsp;<span class="op" id="1394896">&gt;=</span>&nbsp;<span class="num" id="1394899">0</span>&nbsp;<span class="op" id="1394901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1394906">rl</span>&nbsp;<span class="op" id="1394909">:=</span>&nbsp;<span class="ident" id="1394912">utf8</span><span class="op" id="1394916">.</span><span class="ident" id="1394917">RuneLen</span><span class="op" id="1394924">(</span><span class="ident" id="1394925">r</span><span class="op" id="1394926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1394931">if</span>&nbsp;<span class="ident" id="1394934">rl</span>&nbsp;<span class="op" id="1394937">&lt;</span>&nbsp;<span class="num" id="1394939">0</span>&nbsp;<span class="op" id="1394941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1394947">rl</span>&nbsp;<span class="op" id="1394950">=</span>&nbsp;<span class="builtinfunc" id="1394952">len</span><span class="op" id="1394955">(</span><span class="builtintype" id="1394956">string</span><span class="op" id="1394962">(</span><span class="ident" id="1394963">utf8</span><span class="op" id="1394967">.</span><span class="ident" id="1394968">RuneError</span><span class="op" id="1394977">)</span><span class="op" id="1394978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1394983">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1394988">if</span>&nbsp;<span class="ident" id="1394991">nbytes</span><span class="op" id="1394997">+</span><span class="ident" id="1394998">rl</span>&nbsp;<span class="op" id="1395001">&gt;</span>&nbsp;<span class="ident" id="1395003">maxbytes</span>&nbsp;<span class="op" id="1395012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1395018">//&nbsp;Grow&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1395042">maxbytes</span>&nbsp;<span class="op" id="1395051">=</span>&nbsp;<span class="ident" id="1395053">maxbytes</span><span class="op" id="1395061">*</span><span class="num" id="1395062">2</span>&nbsp;<span class="op" id="1395064">+</span>&nbsp;<span class="ident" id="1395066">utf8</span><span class="op" id="1395070">.</span><span class="ident" id="1395071">UTFMax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1395082">nb</span>&nbsp;<span class="op" id="1395085">:=</span>&nbsp;<span class="builtinfunc" id="1395088">make</span><span class="op" id="1395092">(</span><span class="op" id="1395093">[</span><span class="op" id="1395094">]</span><span class="builtintype" id="1395095">byte</span><span class="op" id="1395099">,</span>&nbsp;<span class="ident" id="1395101">maxbytes</span><span class="op" id="1395109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1395115">copy</span><span class="op" id="1395119">(</span><span class="ident" id="1395120">nb</span><span class="op" id="1395122">,</span>&nbsp;<span class="ident" id="1395124">b</span><span class="op" id="1395125">[</span><span class="num" id="1395126">0</span><span class="op" id="1395127">:</span><span class="ident" id="1395128">nbytes</span><span class="op" id="1395134">]</span><span class="op" id="1395135">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1395141">b</span>&nbsp;<span class="op" id="1395143">=</span>&nbsp;<span class="ident" id="1395145">nb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1395151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1395156">nbytes</span>&nbsp;<span class="op" id="1395163">+=</span>&nbsp;<span class="ident" id="1395166">utf8</span><span class="op" id="1395170">.</span><span class="ident" id="1395171">EncodeRune</span><span class="op" id="1395181">(</span><span class="ident" id="1395182">b</span><span class="op" id="1395183">[</span><span class="ident" id="1395184">nbytes</span><span class="op" id="1395190">:</span><span class="ident" id="1395191">maxbytes</span><span class="op" id="1395199">]</span><span class="op" id="1395200">,</span>&nbsp;<span class="ident" id="1395202">r</span><span class="op" id="1395203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1395207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1395211">i</span>&nbsp;<span class="op" id="1395213">+=</span>&nbsp;<span class="ident" id="1395216">wid</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1395221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1395224">return</span>&nbsp;<span class="ident" id="1395231">b</span><span class="op" id="1395232">[</span><span class="num" id="1395233">0</span><span class="op" id="1395234">:</span><span class="ident" id="1395235">nbytes</span><span class="op" id="1395241">]</span><br>
<span class="lineno"></span><span class="op" id="1395243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1395246">//&nbsp;Repeat&nbsp;returns&nbsp;a&nbsp;new&nbsp;byte&nbsp;slice&nbsp;consisting&nbsp;of&nbsp;count&nbsp;copies&nbsp;of&nbsp;b.</span><br>
<span class="lineno">380</span><span class="keyword" id="1395314">func</span>&nbsp;<span class="ident" id="1395319">Repeat</span><span class="op" id="1395325">(</span><span class="ident" id="1395326">b</span>&nbsp;<span class="op" id="1395328">[</span><span class="op" id="1395329">]</span><span class="builtintype" id="1395330">byte</span><span class="op" id="1395334">,</span>&nbsp;<span class="ident" id="1395336">count</span>&nbsp;<span class="builtintype" id="1395342">int</span><span class="op" id="1395345">)</span>&nbsp;<span class="op" id="1395347">[</span><span class="op" id="1395348">]</span><span class="builtintype" id="1395349">byte</span>&nbsp;<span class="op" id="1395354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1395357">nb</span>&nbsp;<span class="op" id="1395360">:=</span>&nbsp;<span class="builtinfunc" id="1395363">make</span><span class="op" id="1395367">(</span><span class="op" id="1395368">[</span><span class="op" id="1395369">]</span><span class="builtintype" id="1395370">byte</span><span class="op" id="1395374">,</span>&nbsp;<span class="builtinfunc" id="1395376">len</span><span class="op" id="1395379">(</span><span class="ident" id="1395380">b</span><span class="op" id="1395381">)</span><span class="op" id="1395382">*</span><span class="ident" id="1395383">count</span><span class="op" id="1395388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1395391">bp</span>&nbsp;<span class="op" id="1395394">:=</span>&nbsp;<span class="builtinfunc" id="1395397">copy</span><span class="op" id="1395401">(</span><span class="ident" id="1395402">nb</span><span class="op" id="1395404">,</span>&nbsp;<span class="ident" id="1395406">b</span><span class="op" id="1395407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1395410">for</span>&nbsp;<span class="ident" id="1395414">bp</span>&nbsp;<span class="op" id="1395417">&lt;</span>&nbsp;<span class="builtinfunc" id="1395419">len</span><span class="op" id="1395422">(</span><span class="ident" id="1395423">nb</span><span class="op" id="1395425">)</span>&nbsp;<span class="op" id="1395427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1395431">copy</span><span class="op" id="1395435">(</span><span class="ident" id="1395436">nb</span><span class="op" id="1395438">[</span><span class="ident" id="1395439">bp</span><span class="op" id="1395441">:</span><span class="op" id="1395442">]</span><span class="op" id="1395443">,</span>&nbsp;<span class="ident" id="1395445">nb</span><span class="op" id="1395447">[</span><span class="op" id="1395448">:</span><span class="ident" id="1395449">bp</span><span class="op" id="1395451">]</span><span class="op" id="1395452">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1395456">bp</span>&nbsp;<span class="op" id="1395459">*=</span>&nbsp;<span class="num" id="1395462">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1395465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1395468">return</span>&nbsp;<span class="ident" id="1395475">nb</span><br>
<span class="lineno"></span><span class="op" id="1395478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="1395481">//&nbsp;ToUpper&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1395580">func</span>&nbsp;<span class="ident" id="1395585">ToUpper</span><span class="op" id="1395592">(</span><span class="ident" id="1395593">s</span>&nbsp;<span class="op" id="1395595">[</span><span class="op" id="1395596">]</span><span class="builtintype" id="1395597">byte</span><span class="op" id="1395601">)</span>&nbsp;<span class="op" id="1395603">[</span><span class="op" id="1395604">]</span><span class="builtintype" id="1395605">byte</span>&nbsp;<span class="op" id="1395610">{</span>&nbsp;<span class="keyword" id="1395612">return</span>&nbsp;<span class="ident" id="1395619">Map</span><span class="op" id="1395622">(</span><span class="ident" id="1395623">unicode</span><span class="op" id="1395630">.</span><span class="ident" id="1395631">ToUpper</span><span class="op" id="1395638">,</span>&nbsp;<span class="ident" id="1395640">s</span><span class="op" id="1395641">)</span>&nbsp;<span class="op" id="1395643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1395646">//&nbsp;ToLower&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1395745">func</span>&nbsp;<span class="ident" id="1395750">ToLower</span><span class="op" id="1395757">(</span><span class="ident" id="1395758">s</span>&nbsp;<span class="op" id="1395760">[</span><span class="op" id="1395761">]</span><span class="builtintype" id="1395762">byte</span><span class="op" id="1395766">)</span>&nbsp;<span class="op" id="1395768">[</span><span class="op" id="1395769">]</span><span class="builtintype" id="1395770">byte</span>&nbsp;<span class="op" id="1395775">{</span>&nbsp;<span class="keyword" id="1395777">return</span>&nbsp;<span class="ident" id="1395784">Map</span><span class="op" id="1395787">(</span><span class="ident" id="1395788">unicode</span><span class="op" id="1395795">.</span><span class="ident" id="1395796">ToLower</span><span class="op" id="1395803">,</span>&nbsp;<span class="ident" id="1395805">s</span><span class="op" id="1395806">)</span>&nbsp;<span class="op" id="1395808">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="1395811">//&nbsp;ToTitle&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1395910">func</span>&nbsp;<span class="ident" id="1395915">ToTitle</span><span class="op" id="1395922">(</span><span class="ident" id="1395923">s</span>&nbsp;<span class="op" id="1395925">[</span><span class="op" id="1395926">]</span><span class="builtintype" id="1395927">byte</span><span class="op" id="1395931">)</span>&nbsp;<span class="op" id="1395933">[</span><span class="op" id="1395934">]</span><span class="builtintype" id="1395935">byte</span>&nbsp;<span class="op" id="1395940">{</span>&nbsp;<span class="keyword" id="1395942">return</span>&nbsp;<span class="ident" id="1395949">Map</span><span class="op" id="1395952">(</span><span class="ident" id="1395953">unicode</span><span class="op" id="1395960">.</span><span class="ident" id="1395961">ToTitle</span><span class="op" id="1395968">,</span>&nbsp;<span class="ident" id="1395970">s</span><span class="op" id="1395971">)</span>&nbsp;<span class="op" id="1395973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1395976">//&nbsp;ToUpperSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno">400</span><span class="comment" id="1396070">//&nbsp;upper&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1396130">func</span>&nbsp;<span class="ident" id="1396135">ToUpperSpecial</span><span class="op" id="1396149">(</span><span class="ident" id="1396150">_case</span>&nbsp;<span class="ident" id="1396156">unicode</span><span class="op" id="1396163">.</span><span class="ident" id="1396164">SpecialCase</span><span class="op" id="1396175">,</span>&nbsp;<span class="ident" id="1396177">s</span>&nbsp;<span class="op" id="1396179">[</span><span class="op" id="1396180">]</span><span class="builtintype" id="1396181">byte</span><span class="op" id="1396185">)</span>&nbsp;<span class="op" id="1396187">[</span><span class="op" id="1396188">]</span><span class="builtintype" id="1396189">byte</span>&nbsp;<span class="op" id="1396194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1396197">return</span>&nbsp;<span class="ident" id="1396204">Map</span><span class="op" id="1396207">(</span><span class="keyword" id="1396208">func</span><span class="op" id="1396212">(</span><span class="ident" id="1396213">r</span>&nbsp;<span class="builtintype" id="1396215">rune</span><span class="op" id="1396219">)</span>&nbsp;<span class="builtintype" id="1396221">rune</span>&nbsp;<span class="op" id="1396226">{</span>&nbsp;<span class="keyword" id="1396228">return</span>&nbsp;<span class="ident" id="1396235">_case</span><span class="op" id="1396240">.</span><span class="ident" id="1396241">ToUpper</span><span class="op" id="1396248">(</span><span class="ident" id="1396249">r</span><span class="op" id="1396250">)</span>&nbsp;<span class="op" id="1396252">}</span><span class="op" id="1396253">,</span>&nbsp;<span class="ident" id="1396255">s</span><span class="op" id="1396256">)</span><br>
<span class="lineno"></span><span class="op" id="1396258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="1396261">//&nbsp;ToLowerSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="1396355">//&nbsp;lower&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1396415">func</span>&nbsp;<span class="ident" id="1396420">ToLowerSpecial</span><span class="op" id="1396434">(</span><span class="ident" id="1396435">_case</span>&nbsp;<span class="ident" id="1396441">unicode</span><span class="op" id="1396448">.</span><span class="ident" id="1396449">SpecialCase</span><span class="op" id="1396460">,</span>&nbsp;<span class="ident" id="1396462">s</span>&nbsp;<span class="op" id="1396464">[</span><span class="op" id="1396465">]</span><span class="builtintype" id="1396466">byte</span><span class="op" id="1396470">)</span>&nbsp;<span class="op" id="1396472">[</span><span class="op" id="1396473">]</span><span class="builtintype" id="1396474">byte</span>&nbsp;<span class="op" id="1396479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1396482">return</span>&nbsp;<span class="ident" id="1396489">Map</span><span class="op" id="1396492">(</span><span class="keyword" id="1396493">func</span><span class="op" id="1396497">(</span><span class="ident" id="1396498">r</span>&nbsp;<span class="builtintype" id="1396500">rune</span><span class="op" id="1396504">)</span>&nbsp;<span class="builtintype" id="1396506">rune</span>&nbsp;<span class="op" id="1396511">{</span>&nbsp;<span class="keyword" id="1396513">return</span>&nbsp;<span class="ident" id="1396520">_case</span><span class="op" id="1396525">.</span><span class="ident" id="1396526">ToLower</span><span class="op" id="1396533">(</span><span class="ident" id="1396534">r</span><span class="op" id="1396535">)</span>&nbsp;<span class="op" id="1396537">}</span><span class="op" id="1396538">,</span>&nbsp;<span class="ident" id="1396540">s</span><span class="op" id="1396541">)</span><br>
<span class="lineno"></span><span class="op" id="1396543">}</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="1396546">//&nbsp;ToTitleSpecial&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;mapped&nbsp;to&nbsp;their</span><br>
<span class="lineno"></span><span class="comment" id="1396640">//&nbsp;title&nbsp;case,&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;casing&nbsp;rules.</span><br>
<span class="lineno"></span><span class="keyword" id="1396700">func</span>&nbsp;<span class="ident" id="1396705">ToTitleSpecial</span><span class="op" id="1396719">(</span><span class="ident" id="1396720">_case</span>&nbsp;<span class="ident" id="1396726">unicode</span><span class="op" id="1396733">.</span><span class="ident" id="1396734">SpecialCase</span><span class="op" id="1396745">,</span>&nbsp;<span class="ident" id="1396747">s</span>&nbsp;<span class="op" id="1396749">[</span><span class="op" id="1396750">]</span><span class="builtintype" id="1396751">byte</span><span class="op" id="1396755">)</span>&nbsp;<span class="op" id="1396757">[</span><span class="op" id="1396758">]</span><span class="builtintype" id="1396759">byte</span>&nbsp;<span class="op" id="1396764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1396767">return</span>&nbsp;<span class="ident" id="1396774">Map</span><span class="op" id="1396777">(</span><span class="keyword" id="1396778">func</span><span class="op" id="1396782">(</span><span class="ident" id="1396783">r</span>&nbsp;<span class="builtintype" id="1396785">rune</span><span class="op" id="1396789">)</span>&nbsp;<span class="builtintype" id="1396791">rune</span>&nbsp;<span class="op" id="1396796">{</span>&nbsp;<span class="keyword" id="1396798">return</span>&nbsp;<span class="ident" id="1396805">_case</span><span class="op" id="1396810">.</span><span class="ident" id="1396811">ToTitle</span><span class="op" id="1396818">(</span><span class="ident" id="1396819">r</span><span class="op" id="1396820">)</span>&nbsp;<span class="op" id="1396822">}</span><span class="op" id="1396823">,</span>&nbsp;<span class="ident" id="1396825">s</span><span class="op" id="1396826">)</span><br>
<span class="lineno">415</span><span class="op" id="1396828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1396831">//&nbsp;isSeparator&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;could&nbsp;mark&nbsp;a&nbsp;word&nbsp;boundary.</span><br>
<span class="lineno"></span><span class="comment" id="1396899">//&nbsp;TODO:&nbsp;update&nbsp;when&nbsp;package&nbsp;unicode&nbsp;captures&nbsp;more&nbsp;of&nbsp;the&nbsp;properties.</span><br>
<span class="lineno"></span><span class="keyword" id="1396969">func</span>&nbsp;<span class="ident" id="1396974">isSeparator</span><span class="op" id="1396985">(</span><span class="ident" id="1396986">r</span>&nbsp;<span class="builtintype" id="1396988">rune</span><span class="op" id="1396992">)</span>&nbsp;<span class="builtintype" id="1396994">bool</span>&nbsp;<span class="op" id="1396999">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1397002">//&nbsp;ASCII&nbsp;alphanumerics&nbsp;and&nbsp;underscore&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397060">if</span>&nbsp;<span class="ident" id="1397063">r</span>&nbsp;<span class="op" id="1397065">&lt;=</span>&nbsp;<span class="num" id="1397068">0x7F</span>&nbsp;<span class="op" id="1397073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397077">switch</span>&nbsp;<span class="op" id="1397084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397088">case</span>&nbsp;<span class="string" id="1397093">&#39;0&#39;</span>&nbsp;<span class="op" id="1397097">&lt;=</span>&nbsp;<span class="ident" id="1397100">r</span>&nbsp;<span class="op" id="1397102">&amp;&amp;</span>&nbsp;<span class="ident" id="1397105">r</span>&nbsp;<span class="op" id="1397107">&lt;=</span>&nbsp;<span class="string" id="1397110">&#39;9&#39;</span><span class="op" id="1397113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397118">return</span>&nbsp;<span class="builtintype" id="1397125">false</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397133">case</span>&nbsp;<span class="string" id="1397138">&#39;a&#39;</span>&nbsp;<span class="op" id="1397142">&lt;=</span>&nbsp;<span class="ident" id="1397145">r</span>&nbsp;<span class="op" id="1397147">&amp;&amp;</span>&nbsp;<span class="ident" id="1397150">r</span>&nbsp;<span class="op" id="1397152">&lt;=</span>&nbsp;<span class="string" id="1397155">&#39;z&#39;</span><span class="op" id="1397158">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397163">return</span>&nbsp;<span class="builtintype" id="1397170">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397178">case</span>&nbsp;<span class="string" id="1397183">&#39;A&#39;</span>&nbsp;<span class="op" id="1397187">&lt;=</span>&nbsp;<span class="ident" id="1397190">r</span>&nbsp;<span class="op" id="1397192">&amp;&amp;</span>&nbsp;<span class="ident" id="1397195">r</span>&nbsp;<span class="op" id="1397197">&lt;=</span>&nbsp;<span class="string" id="1397200">&#39;Z&#39;</span><span class="op" id="1397203">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397208">return</span>&nbsp;<span class="builtintype" id="1397215">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397223">case</span>&nbsp;<span class="ident" id="1397228">r</span>&nbsp;<span class="op" id="1397230">==</span>&nbsp;<span class="string" id="1397233">&#39;_&#39;</span><span class="op" id="1397236">:</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397241">return</span>&nbsp;<span class="builtintype" id="1397248">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1397256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397260">return</span>&nbsp;<span class="builtintype" id="1397267">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1397273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1397276">//&nbsp;Letters&nbsp;and&nbsp;digits&nbsp;are&nbsp;not&nbsp;separators</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397318">if</span>&nbsp;<span class="ident" id="1397321">unicode</span><span class="op" id="1397328">.</span><span class="ident" id="1397329">IsLetter</span><span class="op" id="1397337">(</span><span class="ident" id="1397338">r</span><span class="op" id="1397339">)</span>&nbsp;<span class="op" id="1397341">||</span>&nbsp;<span class="ident" id="1397344">unicode</span><span class="op" id="1397351">.</span><span class="ident" id="1397352">IsDigit</span><span class="op" id="1397359">(</span><span class="ident" id="1397360">r</span><span class="op" id="1397361">)</span>&nbsp;<span class="op" id="1397363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397367">return</span>&nbsp;<span class="builtintype" id="1397374">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1397381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1397384">//&nbsp;Otherwise,&nbsp;all&nbsp;we&nbsp;can&nbsp;do&nbsp;for&nbsp;now&nbsp;is&nbsp;treat&nbsp;spaces&nbsp;as&nbsp;separators.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397452">return</span>&nbsp;<span class="ident" id="1397459">unicode</span><span class="op" id="1397466">.</span><span class="ident" id="1397467">IsSpace</span><span class="op" id="1397474">(</span><span class="ident" id="1397475">r</span><span class="op" id="1397476">)</span><br>
<span class="lineno">440</span><span class="op" id="1397478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1397481">//&nbsp;Title&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;s&nbsp;with&nbsp;all&nbsp;Unicode&nbsp;letters&nbsp;that&nbsp;begin&nbsp;words</span><br>
<span class="lineno"></span><span class="comment" id="1397552">//&nbsp;mapped&nbsp;to&nbsp;their&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="comment" id="1397583">//</span><br>
<span class="lineno">445</span><span class="comment" id="1397586">//&nbsp;BUG:&nbsp;The&nbsp;rule&nbsp;Title&nbsp;uses&nbsp;for&nbsp;word&nbsp;boundaries&nbsp;does&nbsp;not&nbsp;handle&nbsp;Unicode&nbsp;punctuation&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="1397680">func</span>&nbsp;<span class="ident" id="1397685">Title</span><span class="op" id="1397690">(</span><span class="ident" id="1397691">s</span>&nbsp;<span class="op" id="1397693">[</span><span class="op" id="1397694">]</span><span class="builtintype" id="1397695">byte</span><span class="op" id="1397699">)</span>&nbsp;<span class="op" id="1397701">[</span><span class="op" id="1397702">]</span><span class="builtintype" id="1397703">byte</span>&nbsp;<span class="op" id="1397708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1397711">//&nbsp;Use&nbsp;a&nbsp;closure&nbsp;here&nbsp;to&nbsp;remember&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1397753">//&nbsp;Hackish&nbsp;but&nbsp;effective.&nbsp;Depends&nbsp;on&nbsp;Map&nbsp;scanning&nbsp;in&nbsp;order&nbsp;and&nbsp;calling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1397825">//&nbsp;the&nbsp;closure&nbsp;once&nbsp;per&nbsp;rune.</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1397856">prev</span>&nbsp;<span class="op" id="1397861">:=</span>&nbsp;<span class="string" id="1397864">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397869">return</span>&nbsp;<span class="ident" id="1397876">Map</span><span class="op" id="1397879">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397883">func</span><span class="op" id="1397887">(</span><span class="ident" id="1397888">r</span>&nbsp;<span class="builtintype" id="1397890">rune</span><span class="op" id="1397894">)</span>&nbsp;<span class="builtintype" id="1397896">rune</span>&nbsp;<span class="op" id="1397901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397906">if</span>&nbsp;<span class="ident" id="1397909">isSeparator</span><span class="op" id="1397920">(</span><span class="ident" id="1397921">prev</span><span class="op" id="1397925">)</span>&nbsp;<span class="op" id="1397927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1397933">prev</span>&nbsp;<span class="op" id="1397938">=</span>&nbsp;<span class="ident" id="1397940">r</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397946">return</span>&nbsp;<span class="ident" id="1397953">unicode</span><span class="op" id="1397960">.</span><span class="ident" id="1397961">ToTitle</span><span class="op" id="1397968">(</span><span class="ident" id="1397969">r</span><span class="op" id="1397970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1397975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1397980">prev</span>&nbsp;<span class="op" id="1397985">=</span>&nbsp;<span class="ident" id="1397987">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1397992">return</span>&nbsp;<span class="ident" id="1397999">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1398003">}</span><span class="op" id="1398004">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1398008">s</span><span class="op" id="1398009">)</span><br>
<span class="lineno"></span><span class="op" id="1398011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1398014">//&nbsp;TrimLeftFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;UTF-8-encoded</span><br>
<span class="lineno"></span><span class="comment" id="1398095">//&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">465</span><span class="keyword" id="1398139">func</span>&nbsp;<span class="ident" id="1398144">TrimLeftFunc</span><span class="op" id="1398156">(</span><span class="ident" id="1398157">s</span>&nbsp;<span class="op" id="1398159">[</span><span class="op" id="1398160">]</span><span class="builtintype" id="1398161">byte</span><span class="op" id="1398165">,</span>&nbsp;<span class="ident" id="1398167">f</span>&nbsp;<span class="keyword" id="1398169">func</span><span class="op" id="1398173">(</span><span class="ident" id="1398174">r</span>&nbsp;<span class="builtintype" id="1398176">rune</span><span class="op" id="1398180">)</span>&nbsp;<span class="builtintype" id="1398182">bool</span><span class="op" id="1398186">)</span>&nbsp;<span class="op" id="1398188">[</span><span class="op" id="1398189">]</span><span class="builtintype" id="1398190">byte</span>&nbsp;<span class="op" id="1398195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1398198">i</span>&nbsp;<span class="op" id="1398200">:=</span>&nbsp;<span class="ident" id="1398203">indexFunc</span><span class="op" id="1398212">(</span><span class="ident" id="1398213">s</span><span class="op" id="1398214">,</span>&nbsp;<span class="ident" id="1398216">f</span><span class="op" id="1398217">,</span>&nbsp;<span class="builtintype" id="1398219">false</span><span class="op" id="1398224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1398227">if</span>&nbsp;<span class="ident" id="1398230">i</span>&nbsp;<span class="op" id="1398232">==</span>&nbsp;<span class="op" id="1398235">-</span><span class="num" id="1398236">1</span>&nbsp;<span class="op" id="1398238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1398242">return</span>&nbsp;<span class="ident" id="1398249">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1398254">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1398257">return</span>&nbsp;<span class="ident" id="1398264">s</span><span class="op" id="1398265">[</span><span class="ident" id="1398266">i</span><span class="op" id="1398267">:</span><span class="op" id="1398268">]</span><br>
<span class="lineno"></span><span class="op" id="1398270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1398273">//&nbsp;TrimRightFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing&nbsp;UTF-8</span><br>
<span class="lineno"></span><span class="comment" id="1398348">//&nbsp;encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno">475</span><span class="keyword" id="1398400">func</span>&nbsp;<span class="ident" id="1398405">TrimRightFunc</span><span class="op" id="1398418">(</span><span class="ident" id="1398419">s</span>&nbsp;<span class="op" id="1398421">[</span><span class="op" id="1398422">]</span><span class="builtintype" id="1398423">byte</span><span class="op" id="1398427">,</span>&nbsp;<span class="ident" id="1398429">f</span>&nbsp;<span class="keyword" id="1398431">func</span><span class="op" id="1398435">(</span><span class="ident" id="1398436">r</span>&nbsp;<span class="builtintype" id="1398438">rune</span><span class="op" id="1398442">)</span>&nbsp;<span class="builtintype" id="1398444">bool</span><span class="op" id="1398448">)</span>&nbsp;<span class="op" id="1398450">[</span><span class="op" id="1398451">]</span><span class="builtintype" id="1398452">byte</span>&nbsp;<span class="op" id="1398457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1398460">i</span>&nbsp;<span class="op" id="1398462">:=</span>&nbsp;<span class="ident" id="1398465">lastIndexFunc</span><span class="op" id="1398478">(</span><span class="ident" id="1398479">s</span><span class="op" id="1398480">,</span>&nbsp;<span class="ident" id="1398482">f</span><span class="op" id="1398483">,</span>&nbsp;<span class="builtintype" id="1398485">false</span><span class="op" id="1398490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1398493">if</span>&nbsp;<span class="ident" id="1398496">i</span>&nbsp;<span class="op" id="1398498">&gt;=</span>&nbsp;<span class="num" id="1398501">0</span>&nbsp;<span class="op" id="1398503">&amp;&amp;</span>&nbsp;<span class="ident" id="1398506">s</span><span class="op" id="1398507">[</span><span class="ident" id="1398508">i</span><span class="op" id="1398509">]</span>&nbsp;<span class="op" id="1398511">&gt;=</span>&nbsp;<span class="ident" id="1398514">utf8</span><span class="op" id="1398518">.</span><span class="ident" id="1398519">RuneSelf</span>&nbsp;<span class="op" id="1398528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1398532">_</span><span class="op" id="1398533">,</span>&nbsp;<span class="ident" id="1398535">wid</span>&nbsp;<span class="op" id="1398539">:=</span>&nbsp;<span class="ident" id="1398542">utf8</span><span class="op" id="1398546">.</span><span class="ident" id="1398547">DecodeRune</span><span class="op" id="1398557">(</span><span class="ident" id="1398558">s</span><span class="op" id="1398559">[</span><span class="ident" id="1398560">i</span><span class="op" id="1398561">:</span><span class="op" id="1398562">]</span><span class="op" id="1398563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1398567">i</span>&nbsp;<span class="op" id="1398569">+=</span>&nbsp;<span class="ident" id="1398572">wid</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1398577">}</span>&nbsp;<span class="keyword" id="1398579">else</span>&nbsp;<span class="op" id="1398584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1398588">i</span><span class="op" id="1398589">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1398593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1398596">return</span>&nbsp;<span class="ident" id="1398603">s</span><span class="op" id="1398604">[</span><span class="num" id="1398605">0</span><span class="op" id="1398606">:</span><span class="ident" id="1398607">i</span><span class="op" id="1398608">]</span><br>
<span class="lineno"></span><span class="op" id="1398610">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="comment" id="1398613">//&nbsp;TrimFunc&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="1398689">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;c&nbsp;that&nbsp;satisfy&nbsp;f(c).</span><br>
<span class="lineno"></span><span class="keyword" id="1398747">func</span>&nbsp;<span class="ident" id="1398752">TrimFunc</span><span class="op" id="1398760">(</span><span class="ident" id="1398761">s</span>&nbsp;<span class="op" id="1398763">[</span><span class="op" id="1398764">]</span><span class="builtintype" id="1398765">byte</span><span class="op" id="1398769">,</span>&nbsp;<span class="ident" id="1398771">f</span>&nbsp;<span class="keyword" id="1398773">func</span><span class="op" id="1398777">(</span><span class="ident" id="1398778">r</span>&nbsp;<span class="builtintype" id="1398780">rune</span><span class="op" id="1398784">)</span>&nbsp;<span class="builtintype" id="1398786">bool</span><span class="op" id="1398790">)</span>&nbsp;<span class="op" id="1398792">[</span><span class="op" id="1398793">]</span><span class="builtintype" id="1398794">byte</span>&nbsp;<span class="op" id="1398799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1398802">return</span>&nbsp;<span class="ident" id="1398809">TrimRightFunc</span><span class="op" id="1398822">(</span><span class="ident" id="1398823">TrimLeftFunc</span><span class="op" id="1398835">(</span><span class="ident" id="1398836">s</span><span class="op" id="1398837">,</span>&nbsp;<span class="ident" id="1398839">f</span><span class="op" id="1398840">)</span><span class="op" id="1398841">,</span>&nbsp;<span class="ident" id="1398843">f</span><span class="op" id="1398844">)</span><br>
<span class="lineno">490</span><span class="op" id="1398846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1398849">//&nbsp;TrimPrefix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;leading&nbsp;prefix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1398917">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;start&nbsp;with&nbsp;prefix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="1398977">func</span>&nbsp;<span class="ident" id="1398982">TrimPrefix</span><span class="op" id="1398992">(</span><span class="ident" id="1398993">s</span><span class="op" id="1398994">,</span>&nbsp;<span class="ident" id="1398996">prefix</span>&nbsp;<span class="op" id="1399003">[</span><span class="op" id="1399004">]</span><span class="builtintype" id="1399005">byte</span><span class="op" id="1399009">)</span>&nbsp;<span class="op" id="1399011">[</span><span class="op" id="1399012">]</span><span class="builtintype" id="1399013">byte</span>&nbsp;<span class="op" id="1399018">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1399021">if</span>&nbsp;<span class="ident" id="1399024">HasPrefix</span><span class="op" id="1399033">(</span><span class="ident" id="1399034">s</span><span class="op" id="1399035">,</span>&nbsp;<span class="ident" id="1399037">prefix</span><span class="op" id="1399043">)</span>&nbsp;<span class="op" id="1399045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1399049">return</span>&nbsp;<span class="ident" id="1399056">s</span><span class="op" id="1399057">[</span><span class="builtinfunc" id="1399058">len</span><span class="op" id="1399061">(</span><span class="ident" id="1399062">prefix</span><span class="op" id="1399068">)</span><span class="op" id="1399069">:</span><span class="op" id="1399070">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1399073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1399076">return</span>&nbsp;<span class="ident" id="1399083">s</span><br>
<span class="lineno"></span><span class="op" id="1399085">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span><span class="comment" id="1399088">//&nbsp;TrimSuffix&nbsp;returns&nbsp;s&nbsp;without&nbsp;the&nbsp;provided&nbsp;trailing&nbsp;suffix&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="1399157">//&nbsp;If&nbsp;s&nbsp;doesn&#39;t&nbsp;end&nbsp;with&nbsp;suffix,&nbsp;s&nbsp;is&nbsp;returned&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="1399215">func</span>&nbsp;<span class="ident" id="1399220">TrimSuffix</span><span class="op" id="1399230">(</span><span class="ident" id="1399231">s</span><span class="op" id="1399232">,</span>&nbsp;<span class="ident" id="1399234">suffix</span>&nbsp;<span class="op" id="1399241">[</span><span class="op" id="1399242">]</span><span class="builtintype" id="1399243">byte</span><span class="op" id="1399247">)</span>&nbsp;<span class="op" id="1399249">[</span><span class="op" id="1399250">]</span><span class="builtintype" id="1399251">byte</span>&nbsp;<span class="op" id="1399256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1399259">if</span>&nbsp;<span class="ident" id="1399262">HasSuffix</span><span class="op" id="1399271">(</span><span class="ident" id="1399272">s</span><span class="op" id="1399273">,</span>&nbsp;<span class="ident" id="1399275">suffix</span><span class="op" id="1399281">)</span>&nbsp;<span class="op" id="1399283">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1399287">return</span>&nbsp;<span class="ident" id="1399294">s</span><span class="op" id="1399295">[</span><span class="op" id="1399296">:</span><span class="builtinfunc" id="1399297">len</span><span class="op" id="1399300">(</span><span class="ident" id="1399301">s</span><span class="op" id="1399302">)</span><span class="op" id="1399303">-</span><span class="builtinfunc" id="1399304">len</span><span class="op" id="1399307">(</span><span class="ident" id="1399308">suffix</span><span class="op" id="1399314">)</span><span class="op" id="1399315">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1399318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1399321">return</span>&nbsp;<span class="ident" id="1399328">s</span><br>
<span class="lineno"></span><span class="op" id="1399330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span><span class="comment" id="1399333">//&nbsp;IndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1399411">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;first&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1399466">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno"></span><span class="keyword" id="1399515">func</span>&nbsp;<span class="ident" id="1399520">IndexFunc</span><span class="op" id="1399529">(</span><span class="ident" id="1399530">s</span>&nbsp;<span class="op" id="1399532">[</span><span class="op" id="1399533">]</span><span class="builtintype" id="1399534">byte</span><span class="op" id="1399538">,</span>&nbsp;<span class="ident" id="1399540">f</span>&nbsp;<span class="keyword" id="1399542">func</span><span class="op" id="1399546">(</span><span class="ident" id="1399547">r</span>&nbsp;<span class="builtintype" id="1399549">rune</span><span class="op" id="1399553">)</span>&nbsp;<span class="builtintype" id="1399555">bool</span><span class="op" id="1399559">)</span>&nbsp;<span class="builtintype" id="1399561">int</span>&nbsp;<span class="op" id="1399565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1399568">return</span>&nbsp;<span class="ident" id="1399575">indexFunc</span><span class="op" id="1399584">(</span><span class="ident" id="1399585">s</span><span class="op" id="1399586">,</span>&nbsp;<span class="ident" id="1399588">f</span><span class="op" id="1399589">,</span>&nbsp;<span class="builtintype" id="1399591">true</span><span class="op" id="1399595">)</span><br>
<span class="lineno">515</span><span class="op" id="1399597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1399600">//&nbsp;LastIndexFunc&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;sequence&nbsp;of&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="1399682">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;byte&nbsp;index&nbsp;in&nbsp;s&nbsp;of&nbsp;the&nbsp;last&nbsp;Unicode</span><br>
<span class="lineno"></span><span class="comment" id="1399736">//&nbsp;code&nbsp;point&nbsp;satisfying&nbsp;f(c),&nbsp;or&nbsp;-1&nbsp;if&nbsp;none&nbsp;do.</span><br>
<span class="lineno">520</span><span class="keyword" id="1399785">func</span>&nbsp;<span class="ident" id="1399790">LastIndexFunc</span><span class="op" id="1399803">(</span><span class="ident" id="1399804">s</span>&nbsp;<span class="op" id="1399806">[</span><span class="op" id="1399807">]</span><span class="builtintype" id="1399808">byte</span><span class="op" id="1399812">,</span>&nbsp;<span class="ident" id="1399814">f</span>&nbsp;<span class="keyword" id="1399816">func</span><span class="op" id="1399820">(</span><span class="ident" id="1399821">r</span>&nbsp;<span class="builtintype" id="1399823">rune</span><span class="op" id="1399827">)</span>&nbsp;<span class="builtintype" id="1399829">bool</span><span class="op" id="1399833">)</span>&nbsp;<span class="builtintype" id="1399835">int</span>&nbsp;<span class="op" id="1399839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1399842">return</span>&nbsp;<span class="ident" id="1399849">lastIndexFunc</span><span class="op" id="1399862">(</span><span class="ident" id="1399863">s</span><span class="op" id="1399864">,</span>&nbsp;<span class="ident" id="1399866">f</span><span class="op" id="1399867">,</span>&nbsp;<span class="builtintype" id="1399869">true</span><span class="op" id="1399873">)</span><br>
<span class="lineno"></span><span class="op" id="1399875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1399878">//&nbsp;indexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;IndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno">525</span><span class="comment" id="1399931">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1399987">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="1400000">func</span>&nbsp;<span class="ident" id="1400005">indexFunc</span><span class="op" id="1400014">(</span><span class="ident" id="1400015">s</span>&nbsp;<span class="op" id="1400017">[</span><span class="op" id="1400018">]</span><span class="builtintype" id="1400019">byte</span><span class="op" id="1400023">,</span>&nbsp;<span class="ident" id="1400025">f</span>&nbsp;<span class="keyword" id="1400027">func</span><span class="op" id="1400031">(</span><span class="ident" id="1400032">r</span>&nbsp;<span class="builtintype" id="1400034">rune</span><span class="op" id="1400038">)</span>&nbsp;<span class="builtintype" id="1400040">bool</span><span class="op" id="1400044">,</span>&nbsp;<span class="ident" id="1400046">truth</span>&nbsp;<span class="builtintype" id="1400052">bool</span><span class="op" id="1400056">)</span>&nbsp;<span class="builtintype" id="1400058">int</span>&nbsp;<span class="op" id="1400062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1400065">start</span>&nbsp;<span class="op" id="1400071">:=</span>&nbsp;<span class="num" id="1400074">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400077">for</span>&nbsp;<span class="ident" id="1400081">start</span>&nbsp;<span class="op" id="1400087">&lt;</span>&nbsp;<span class="builtinfunc" id="1400089">len</span><span class="op" id="1400092">(</span><span class="ident" id="1400093">s</span><span class="op" id="1400094">)</span>&nbsp;<span class="op" id="1400096">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1400100">wid</span>&nbsp;<span class="op" id="1400104">:=</span>&nbsp;<span class="num" id="1400107">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1400111">r</span>&nbsp;<span class="op" id="1400113">:=</span>&nbsp;<span class="builtintype" id="1400116">rune</span><span class="op" id="1400120">(</span><span class="ident" id="1400121">s</span><span class="op" id="1400122">[</span><span class="ident" id="1400123">start</span><span class="op" id="1400128">]</span><span class="op" id="1400129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400133">if</span>&nbsp;<span class="ident" id="1400136">r</span>&nbsp;<span class="op" id="1400138">&gt;=</span>&nbsp;<span class="ident" id="1400141">utf8</span><span class="op" id="1400145">.</span><span class="ident" id="1400146">RuneSelf</span>&nbsp;<span class="op" id="1400155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1400160">r</span><span class="op" id="1400161">,</span>&nbsp;<span class="ident" id="1400163">wid</span>&nbsp;<span class="op" id="1400167">=</span>&nbsp;<span class="ident" id="1400169">utf8</span><span class="op" id="1400173">.</span><span class="ident" id="1400174">DecodeRune</span><span class="op" id="1400184">(</span><span class="ident" id="1400185">s</span><span class="op" id="1400186">[</span><span class="ident" id="1400187">start</span><span class="op" id="1400192">:</span><span class="op" id="1400193">]</span><span class="op" id="1400194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1400198">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400202">if</span>&nbsp;<span class="ident" id="1400205">f</span><span class="op" id="1400206">(</span><span class="ident" id="1400207">r</span><span class="op" id="1400208">)</span>&nbsp;<span class="op" id="1400210">==</span>&nbsp;<span class="ident" id="1400213">truth</span>&nbsp;<span class="op" id="1400219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400224">return</span>&nbsp;<span class="ident" id="1400231">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1400239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1400243">start</span>&nbsp;<span class="op" id="1400249">+=</span>&nbsp;<span class="ident" id="1400252">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1400257">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400260">return</span>&nbsp;<span class="op" id="1400267">-</span><span class="num" id="1400268">1</span><br>
<span class="lineno"></span><span class="op" id="1400270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1400273">//&nbsp;lastIndexFunc&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;LastIndexFunc&nbsp;except&nbsp;that&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1400334">//&nbsp;truth==false,&nbsp;the&nbsp;sense&nbsp;of&nbsp;the&nbsp;predicate&nbsp;function&nbsp;is</span><br>
<span class="lineno">545</span><span class="comment" id="1400390">//&nbsp;inverted.</span><br>
<span class="lineno"></span><span class="keyword" id="1400403">func</span>&nbsp;<span class="ident" id="1400408">lastIndexFunc</span><span class="op" id="1400421">(</span><span class="ident" id="1400422">s</span>&nbsp;<span class="op" id="1400424">[</span><span class="op" id="1400425">]</span><span class="builtintype" id="1400426">byte</span><span class="op" id="1400430">,</span>&nbsp;<span class="ident" id="1400432">f</span>&nbsp;<span class="keyword" id="1400434">func</span><span class="op" id="1400438">(</span><span class="ident" id="1400439">r</span>&nbsp;<span class="builtintype" id="1400441">rune</span><span class="op" id="1400445">)</span>&nbsp;<span class="builtintype" id="1400447">bool</span><span class="op" id="1400451">,</span>&nbsp;<span class="ident" id="1400453">truth</span>&nbsp;<span class="builtintype" id="1400459">bool</span><span class="op" id="1400463">)</span>&nbsp;<span class="builtintype" id="1400465">int</span>&nbsp;<span class="op" id="1400469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400472">for</span>&nbsp;<span class="ident" id="1400476">i</span>&nbsp;<span class="op" id="1400478">:=</span>&nbsp;<span class="builtinfunc" id="1400481">len</span><span class="op" id="1400484">(</span><span class="ident" id="1400485">s</span><span class="op" id="1400486">)</span><span class="op" id="1400487">;</span>&nbsp;<span class="ident" id="1400489">i</span>&nbsp;<span class="op" id="1400491">&gt;</span>&nbsp;<span class="num" id="1400493">0</span><span class="op" id="1400494">;</span>&nbsp;<span class="op" id="1400496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1400500">r</span><span class="op" id="1400501">,</span>&nbsp;<span class="ident" id="1400503">size</span>&nbsp;<span class="op" id="1400508">:=</span>&nbsp;<span class="builtintype" id="1400511">rune</span><span class="op" id="1400515">(</span><span class="ident" id="1400516">s</span><span class="op" id="1400517">[</span><span class="ident" id="1400518">i</span><span class="op" id="1400519">-</span><span class="num" id="1400520">1</span><span class="op" id="1400521">]</span><span class="op" id="1400522">)</span><span class="op" id="1400523">,</span>&nbsp;<span class="num" id="1400525">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400529">if</span>&nbsp;<span class="ident" id="1400532">r</span>&nbsp;<span class="op" id="1400534">&gt;=</span>&nbsp;<span class="ident" id="1400537">utf8</span><span class="op" id="1400541">.</span><span class="ident" id="1400542">RuneSelf</span>&nbsp;<span class="op" id="1400551">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1400556">r</span><span class="op" id="1400557">,</span>&nbsp;<span class="ident" id="1400559">size</span>&nbsp;<span class="op" id="1400564">=</span>&nbsp;<span class="ident" id="1400566">utf8</span><span class="op" id="1400570">.</span><span class="ident" id="1400571">DecodeLastRune</span><span class="op" id="1400585">(</span><span class="ident" id="1400586">s</span><span class="op" id="1400587">[</span><span class="num" id="1400588">0</span><span class="op" id="1400589">:</span><span class="ident" id="1400590">i</span><span class="op" id="1400591">]</span><span class="op" id="1400592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1400596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1400600">i</span>&nbsp;<span class="op" id="1400602">-=</span>&nbsp;<span class="ident" id="1400605">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400612">if</span>&nbsp;<span class="ident" id="1400615">f</span><span class="op" id="1400616">(</span><span class="ident" id="1400617">r</span><span class="op" id="1400618">)</span>&nbsp;<span class="op" id="1400620">==</span>&nbsp;<span class="ident" id="1400623">truth</span>&nbsp;<span class="op" id="1400629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400634">return</span>&nbsp;<span class="ident" id="1400641">i</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1400645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1400648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400651">return</span>&nbsp;<span class="op" id="1400658">-</span><span class="num" id="1400659">1</span><br>
<span class="lineno"></span><span class="op" id="1400661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="1400664">func</span>&nbsp;<span class="ident" id="1400669">makeCutsetFunc</span><span class="op" id="1400683">(</span><span class="ident" id="1400684">cutset</span>&nbsp;<span class="builtintype" id="1400691">string</span><span class="op" id="1400697">)</span>&nbsp;<span class="keyword" id="1400699">func</span><span class="op" id="1400703">(</span><span class="ident" id="1400704">r</span>&nbsp;<span class="builtintype" id="1400706">rune</span><span class="op" id="1400710">)</span>&nbsp;<span class="builtintype" id="1400712">bool</span>&nbsp;<span class="op" id="1400717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400720">return</span>&nbsp;<span class="keyword" id="1400727">func</span><span class="op" id="1400731">(</span><span class="ident" id="1400732">r</span>&nbsp;<span class="builtintype" id="1400734">rune</span><span class="op" id="1400738">)</span>&nbsp;<span class="builtintype" id="1400740">bool</span>&nbsp;<span class="op" id="1400745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400749">for</span>&nbsp;<span class="ident" id="1400753">_</span><span class="op" id="1400754">,</span>&nbsp;<span class="ident" id="1400756">c</span>&nbsp;<span class="op" id="1400758">:=</span>&nbsp;<span class="keyword" id="1400761">range</span>&nbsp;<span class="ident" id="1400767">cutset</span>&nbsp;<span class="op" id="1400774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400779">if</span>&nbsp;<span class="ident" id="1400782">c</span>&nbsp;<span class="op" id="1400784">==</span>&nbsp;<span class="ident" id="1400787">r</span>&nbsp;<span class="op" id="1400789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400795">return</span>&nbsp;<span class="builtintype" id="1400802">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1400810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1400814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1400818">return</span>&nbsp;<span class="builtintype" id="1400825">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1400832">}</span><br>
<span class="lineno"></span><span class="op" id="1400834">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="1400837">//&nbsp;Trim&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1400900">//&nbsp;trailing&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="1400967">func</span>&nbsp;<span class="ident" id="1400972">Trim</span><span class="op" id="1400976">(</span><span class="ident" id="1400977">s</span>&nbsp;<span class="op" id="1400979">[</span><span class="op" id="1400980">]</span><span class="builtintype" id="1400981">byte</span><span class="op" id="1400985">,</span>&nbsp;<span class="ident" id="1400987">cutset</span>&nbsp;<span class="builtintype" id="1400994">string</span><span class="op" id="1401000">)</span>&nbsp;<span class="op" id="1401002">[</span><span class="op" id="1401003">]</span><span class="builtintype" id="1401004">byte</span>&nbsp;<span class="op" id="1401009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1401012">return</span>&nbsp;<span class="ident" id="1401019">TrimFunc</span><span class="op" id="1401027">(</span><span class="ident" id="1401028">s</span><span class="op" id="1401029">,</span>&nbsp;<span class="ident" id="1401031">makeCutsetFunc</span><span class="op" id="1401045">(</span><span class="ident" id="1401046">cutset</span><span class="op" id="1401052">)</span><span class="op" id="1401053">)</span><br>
<span class="lineno">575</span><span class="op" id="1401055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1401058">//&nbsp;TrimLeft&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="1401121">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno"></span><span class="keyword" id="1401179">func</span>&nbsp;<span class="ident" id="1401184">TrimLeft</span><span class="op" id="1401192">(</span><span class="ident" id="1401193">s</span>&nbsp;<span class="op" id="1401195">[</span><span class="op" id="1401196">]</span><span class="builtintype" id="1401197">byte</span><span class="op" id="1401201">,</span>&nbsp;<span class="ident" id="1401203">cutset</span>&nbsp;<span class="builtintype" id="1401210">string</span><span class="op" id="1401216">)</span>&nbsp;<span class="op" id="1401218">[</span><span class="op" id="1401219">]</span><span class="builtintype" id="1401220">byte</span>&nbsp;<span class="op" id="1401225">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1401228">return</span>&nbsp;<span class="ident" id="1401235">TrimLeftFunc</span><span class="op" id="1401247">(</span><span class="ident" id="1401248">s</span><span class="op" id="1401249">,</span>&nbsp;<span class="ident" id="1401251">makeCutsetFunc</span><span class="op" id="1401265">(</span><span class="ident" id="1401266">cutset</span><span class="op" id="1401272">)</span><span class="op" id="1401273">)</span><br>
<span class="lineno"></span><span class="op" id="1401275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1401278">//&nbsp;TrimRight&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="1401343">//&nbsp;UTF-8-encoded&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;that&nbsp;are&nbsp;contained&nbsp;in&nbsp;cutset.</span><br>
<span class="lineno">585</span><span class="keyword" id="1401410">func</span>&nbsp;<span class="ident" id="1401415">TrimRight</span><span class="op" id="1401424">(</span><span class="ident" id="1401425">s</span>&nbsp;<span class="op" id="1401427">[</span><span class="op" id="1401428">]</span><span class="builtintype" id="1401429">byte</span><span class="op" id="1401433">,</span>&nbsp;<span class="ident" id="1401435">cutset</span>&nbsp;<span class="builtintype" id="1401442">string</span><span class="op" id="1401448">)</span>&nbsp;<span class="op" id="1401450">[</span><span class="op" id="1401451">]</span><span class="builtintype" id="1401452">byte</span>&nbsp;<span class="op" id="1401457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1401460">return</span>&nbsp;<span class="ident" id="1401467">TrimRightFunc</span><span class="op" id="1401480">(</span><span class="ident" id="1401481">s</span><span class="op" id="1401482">,</span>&nbsp;<span class="ident" id="1401484">makeCutsetFunc</span><span class="op" id="1401498">(</span><span class="ident" id="1401499">cutset</span><span class="op" id="1401505">)</span><span class="op" id="1401506">)</span><br>
<span class="lineno"></span><span class="op" id="1401508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1401511">//&nbsp;TrimSpace&nbsp;returns&nbsp;a&nbsp;subslice&nbsp;of&nbsp;s&nbsp;by&nbsp;slicing&nbsp;off&nbsp;all&nbsp;leading&nbsp;and</span><br>
<span class="lineno">590</span><span class="comment" id="1401579">//&nbsp;trailing&nbsp;white&nbsp;space,&nbsp;as&nbsp;defined&nbsp;by&nbsp;Unicode.</span><br>
<span class="lineno"></span><span class="keyword" id="1401627">func</span>&nbsp;<span class="ident" id="1401632">TrimSpace</span><span class="op" id="1401641">(</span><span class="ident" id="1401642">s</span>&nbsp;<span class="op" id="1401644">[</span><span class="op" id="1401645">]</span><span class="builtintype" id="1401646">byte</span><span class="op" id="1401650">)</span>&nbsp;<span class="op" id="1401652">[</span><span class="op" id="1401653">]</span><span class="builtintype" id="1401654">byte</span>&nbsp;<span class="op" id="1401659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1401662">return</span>&nbsp;<span class="ident" id="1401669">TrimFunc</span><span class="op" id="1401677">(</span><span class="ident" id="1401678">s</span><span class="op" id="1401679">,</span>&nbsp;<span class="ident" id="1401681">unicode</span><span class="op" id="1401688">.</span><span class="ident" id="1401689">IsSpace</span><span class="op" id="1401696">)</span><br>
<span class="lineno"></span><span class="op" id="1401698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="1401701">//&nbsp;Runes&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;runes&nbsp;(Unicode&nbsp;code&nbsp;points)&nbsp;equivalent&nbsp;to&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="1401774">func</span>&nbsp;<span class="ident" id="1401779">Runes</span><span class="op" id="1401784">(</span><span class="ident" id="1401785">s</span>&nbsp;<span class="op" id="1401787">[</span><span class="op" id="1401788">]</span><span class="builtintype" id="1401789">byte</span><span class="op" id="1401793">)</span>&nbsp;<span class="op" id="1401795">[</span><span class="op" id="1401796">]</span><span class="builtintype" id="1401797">rune</span>&nbsp;<span class="op" id="1401802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1401805">t</span>&nbsp;<span class="op" id="1401807">:=</span>&nbsp;<span class="builtinfunc" id="1401810">make</span><span class="op" id="1401814">(</span><span class="op" id="1401815">[</span><span class="op" id="1401816">]</span><span class="builtintype" id="1401817">rune</span><span class="op" id="1401821">,</span>&nbsp;<span class="ident" id="1401823">utf8</span><span class="op" id="1401827">.</span><span class="ident" id="1401828">RuneCount</span><span class="op" id="1401837">(</span><span class="ident" id="1401838">s</span><span class="op" id="1401839">)</span><span class="op" id="1401840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1401843">i</span>&nbsp;<span class="op" id="1401845">:=</span>&nbsp;<span class="num" id="1401848">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1401851">for</span>&nbsp;<span class="builtinfunc" id="1401855">len</span><span class="op" id="1401858">(</span><span class="ident" id="1401859">s</span><span class="op" id="1401860">)</span>&nbsp;<span class="op" id="1401862">&gt;</span>&nbsp;<span class="num" id="1401864">0</span>&nbsp;<span class="op" id="1401866">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1401870">r</span><span class="op" id="1401871">,</span>&nbsp;<span class="ident" id="1401873">l</span>&nbsp;<span class="op" id="1401875">:=</span>&nbsp;<span class="ident" id="1401878">utf8</span><span class="op" id="1401882">.</span><span class="ident" id="1401883">DecodeRune</span><span class="op" id="1401893">(</span><span class="ident" id="1401894">s</span><span class="op" id="1401895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1401899">t</span><span class="op" id="1401900">[</span><span class="ident" id="1401901">i</span><span class="op" id="1401902">]</span>&nbsp;<span class="op" id="1401904">=</span>&nbsp;<span class="ident" id="1401906">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1401910">i</span><span class="op" id="1401911">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1401916">s</span>&nbsp;<span class="op" id="1401918">=</span>&nbsp;<span class="ident" id="1401920">s</span><span class="op" id="1401921">[</span><span class="ident" id="1401922">l</span><span class="op" id="1401923">:</span><span class="op" id="1401924">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1401927">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1401930">return</span>&nbsp;<span class="ident" id="1401937">t</span><br>
<span class="lineno"></span><span class="op" id="1401939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1401942">//&nbsp;Replace&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;slice&nbsp;s&nbsp;with&nbsp;the&nbsp;first&nbsp;n</span><br>
<span class="lineno"></span><span class="comment" id="1402000">//&nbsp;non-overlapping&nbsp;instances&nbsp;of&nbsp;old&nbsp;replaced&nbsp;by&nbsp;new.</span><br>
<span class="lineno">610</span><span class="comment" id="1402053">//&nbsp;If&nbsp;old&nbsp;is&nbsp;empty,&nbsp;it&nbsp;matches&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="1402114">//&nbsp;and&nbsp;after&nbsp;each&nbsp;UTF-8&nbsp;sequence,&nbsp;yielding&nbsp;up&nbsp;to&nbsp;k+1&nbsp;replacements</span><br>
<span class="lineno"></span><span class="comment" id="1402180">//&nbsp;for&nbsp;a&nbsp;k-rune&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="1402203">//&nbsp;If&nbsp;n&nbsp;&lt;&nbsp;0,&nbsp;there&nbsp;is&nbsp;no&nbsp;limit&nbsp;on&nbsp;the&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span><span class="keyword" id="1402265">func</span>&nbsp;<span class="ident" id="1402270">Replace</span><span class="op" id="1402277">(</span><span class="ident" id="1402278">s</span><span class="op" id="1402279">,</span>&nbsp;<span class="ident" id="1402281">old</span><span class="op" id="1402284">,</span>&nbsp;<span class="builtinfunc" id="1402286">new</span>&nbsp;<span class="op" id="1402290">[</span><span class="op" id="1402291">]</span><span class="builtintype" id="1402292">byte</span><span class="op" id="1402296">,</span>&nbsp;<span class="ident" id="1402298">n</span>&nbsp;<span class="builtintype" id="1402300">int</span><span class="op" id="1402303">)</span>&nbsp;<span class="op" id="1402305">[</span><span class="op" id="1402306">]</span><span class="builtintype" id="1402307">byte</span>&nbsp;<span class="op" id="1402312">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1402315">m</span>&nbsp;<span class="op" id="1402317">:=</span>&nbsp;<span class="num" id="1402320">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1402323">if</span>&nbsp;<span class="ident" id="1402326">n</span>&nbsp;<span class="op" id="1402328">!=</span>&nbsp;<span class="num" id="1402331">0</span>&nbsp;<span class="op" id="1402333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1402337">//&nbsp;Compute&nbsp;number&nbsp;of&nbsp;replacements.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1402374">m</span>&nbsp;<span class="op" id="1402376">=</span>&nbsp;<span class="ident" id="1402378">Count</span><span class="op" id="1402383">(</span><span class="ident" id="1402384">s</span><span class="op" id="1402385">,</span>&nbsp;<span class="ident" id="1402387">old</span><span class="op" id="1402390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1402393">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1402396">if</span>&nbsp;<span class="ident" id="1402399">m</span>&nbsp;<span class="op" id="1402401">==</span>&nbsp;<span class="num" id="1402404">0</span>&nbsp;<span class="op" id="1402406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1402410">//&nbsp;Just&nbsp;return&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1402435">return</span>&nbsp;<span class="builtinfunc" id="1402442">append</span><span class="op" id="1402448">(</span><span class="op" id="1402449">[</span><span class="op" id="1402450">]</span><span class="builtintype" id="1402451">byte</span><span class="op" id="1402455">(</span><span class="ident" id="1402456">nil</span><span class="op" id="1402459">)</span><span class="op" id="1402460">,</span>&nbsp;<span class="ident" id="1402462">s</span><span class="op" id="1402463">...</span><span class="op" id="1402466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1402469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1402472">if</span>&nbsp;<span class="ident" id="1402475">n</span>&nbsp;<span class="op" id="1402477">&lt;</span>&nbsp;<span class="num" id="1402479">0</span>&nbsp;<span class="op" id="1402481">||</span>&nbsp;<span class="ident" id="1402484">m</span>&nbsp;<span class="op" id="1402486">&lt;</span>&nbsp;<span class="ident" id="1402488">n</span>&nbsp;<span class="op" id="1402490">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1402494">n</span>&nbsp;<span class="op" id="1402496">=</span>&nbsp;<span class="ident" id="1402498">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1402501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1402505">//&nbsp;Apply&nbsp;replacements&nbsp;to&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1402539">t</span>&nbsp;<span class="op" id="1402541">:=</span>&nbsp;<span class="builtinfunc" id="1402544">make</span><span class="op" id="1402548">(</span><span class="op" id="1402549">[</span><span class="op" id="1402550">]</span><span class="builtintype" id="1402551">byte</span><span class="op" id="1402555">,</span>&nbsp;<span class="builtinfunc" id="1402557">len</span><span class="op" id="1402560">(</span><span class="ident" id="1402561">s</span><span class="op" id="1402562">)</span><span class="op" id="1402563">+</span><span class="ident" id="1402564">n</span><span class="op" id="1402565">*</span><span class="op" id="1402566">(</span><span class="builtinfunc" id="1402567">len</span><span class="op" id="1402570">(</span><span class="builtinfunc" id="1402571">new</span><span class="op" id="1402574">)</span><span class="op" id="1402575">-</span><span class="builtinfunc" id="1402576">len</span><span class="op" id="1402579">(</span><span class="ident" id="1402580">old</span><span class="op" id="1402583">)</span><span class="op" id="1402584">)</span><span class="op" id="1402585">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1402588">w</span>&nbsp;<span class="op" id="1402590">:=</span>&nbsp;<span class="num" id="1402593">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1402596">start</span>&nbsp;<span class="op" id="1402602">:=</span>&nbsp;<span class="num" id="1402605">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1402608">for</span>&nbsp;<span class="ident" id="1402612">i</span>&nbsp;<span class="op" id="1402614">:=</span>&nbsp;<span class="num" id="1402617">0</span><span class="op" id="1402618">;</span>&nbsp;<span class="ident" id="1402620">i</span>&nbsp;<span class="op" id="1402622">&lt;</span>&nbsp;<span class="ident" id="1402624">n</span><span class="op" id="1402625">;</span>&nbsp;<span class="ident" id="1402627">i</span><span class="op" id="1402628">++</span>&nbsp;<span class="op" id="1402631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1402635">j</span>&nbsp;<span class="op" id="1402637">:=</span>&nbsp;<span class="ident" id="1402640">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1402648">if</span>&nbsp;<span class="builtinfunc" id="1402651">len</span><span class="op" id="1402654">(</span><span class="ident" id="1402655">old</span><span class="op" id="1402658">)</span>&nbsp;<span class="op" id="1402660">==</span>&nbsp;<span class="num" id="1402663">0</span>&nbsp;<span class="op" id="1402665">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1402670">if</span>&nbsp;<span class="ident" id="1402673">i</span>&nbsp;<span class="op" id="1402675">&gt;</span>&nbsp;<span class="num" id="1402677">0</span>&nbsp;<span class="op" id="1402679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1402685">_</span><span class="op" id="1402686">,</span>&nbsp;<span class="ident" id="1402688">wid</span>&nbsp;<span class="op" id="1402692">:=</span>&nbsp;<span class="ident" id="1402695">utf8</span><span class="op" id="1402699">.</span><span class="ident" id="1402700">DecodeRune</span><span class="op" id="1402710">(</span><span class="ident" id="1402711">s</span><span class="op" id="1402712">[</span><span class="ident" id="1402713">start</span><span class="op" id="1402718">:</span><span class="op" id="1402719">]</span><span class="op" id="1402720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1402726">j</span>&nbsp;<span class="op" id="1402728">+=</span>&nbsp;<span class="ident" id="1402731">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1402738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1402742">}</span>&nbsp;<span class="keyword" id="1402744">else</span>&nbsp;<span class="op" id="1402749">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1402754">j</span>&nbsp;<span class="op" id="1402756">+=</span>&nbsp;<span class="ident" id="1402759">Index</span><span class="op" id="1402764">(</span><span class="ident" id="1402765">s</span><span class="op" id="1402766">[</span><span class="ident" id="1402767">start</span><span class="op" id="1402772">:</span><span class="op" id="1402773">]</span><span class="op" id="1402774">,</span>&nbsp;<span class="ident" id="1402776">old</span><span class="op" id="1402779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1402783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1402787">w</span>&nbsp;<span class="op" id="1402789">+=</span>&nbsp;<span class="builtinfunc" id="1402792">copy</span><span class="op" id="1402796">(</span><span class="ident" id="1402797">t</span><span class="op" id="1402798">[</span><span class="ident" id="1402799">w</span><span class="op" id="1402800">:</span><span class="op" id="1402801">]</span><span class="op" id="1402802">,</span>&nbsp;<span class="ident" id="1402804">s</span><span class="op" id="1402805">[</span><span class="ident" id="1402806">start</span><span class="op" id="1402811">:</span><span class="ident" id="1402812">j</span><span class="op" id="1402813">]</span><span class="op" id="1402814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1402818">w</span>&nbsp;<span class="op" id="1402820">+=</span>&nbsp;<span class="builtinfunc" id="1402823">copy</span><span class="op" id="1402827">(</span><span class="ident" id="1402828">t</span><span class="op" id="1402829">[</span><span class="ident" id="1402830">w</span><span class="op" id="1402831">:</span><span class="op" id="1402832">]</span><span class="op" id="1402833">,</span>&nbsp;<span class="builtinfunc" id="1402835">new</span><span class="op" id="1402838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1402842">start</span>&nbsp;<span class="op" id="1402848">=</span>&nbsp;<span class="ident" id="1402850">j</span>&nbsp;<span class="op" id="1402852">+</span>&nbsp;<span class="builtinfunc" id="1402854">len</span><span class="op" id="1402857">(</span><span class="ident" id="1402858">old</span><span class="op" id="1402861">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1402864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1402867">w</span>&nbsp;<span class="op" id="1402869">+=</span>&nbsp;<span class="builtinfunc" id="1402872">copy</span><span class="op" id="1402876">(</span><span class="ident" id="1402877">t</span><span class="op" id="1402878">[</span><span class="ident" id="1402879">w</span><span class="op" id="1402880">:</span><span class="op" id="1402881">]</span><span class="op" id="1402882">,</span>&nbsp;<span class="ident" id="1402884">s</span><span class="op" id="1402885">[</span><span class="ident" id="1402886">start</span><span class="op" id="1402891">:</span><span class="op" id="1402892">]</span><span class="op" id="1402893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1402896">return</span>&nbsp;<span class="ident" id="1402903">t</span><span class="op" id="1402904">[</span><span class="num" id="1402905">0</span><span class="op" id="1402906">:</span><span class="ident" id="1402907">w</span><span class="op" id="1402908">]</span><br>
<span class="lineno"></span><span class="op" id="1402910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="comment" id="1402913">//&nbsp;EqualFold&nbsp;reports&nbsp;whether&nbsp;s&nbsp;and&nbsp;t,&nbsp;interpreted&nbsp;as&nbsp;UTF-8&nbsp;strings,</span><br>
<span class="lineno"></span><span class="comment" id="1402981">//&nbsp;are&nbsp;equal&nbsp;under&nbsp;Unicode&nbsp;case-folding.</span><br>
<span class="lineno"></span><span class="keyword" id="1403022">func</span>&nbsp;<span class="ident" id="1403027">EqualFold</span><span class="op" id="1403036">(</span><span class="ident" id="1403037">s</span><span class="op" id="1403038">,</span>&nbsp;<span class="ident" id="1403040">t</span>&nbsp;<span class="op" id="1403042">[</span><span class="op" id="1403043">]</span><span class="builtintype" id="1403044">byte</span><span class="op" id="1403048">)</span>&nbsp;<span class="builtintype" id="1403050">bool</span>&nbsp;<span class="op" id="1403055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1403058">for</span>&nbsp;<span class="builtinfunc" id="1403062">len</span><span class="op" id="1403065">(</span><span class="ident" id="1403066">s</span><span class="op" id="1403067">)</span>&nbsp;<span class="op" id="1403069">!=</span>&nbsp;<span class="num" id="1403072">0</span>&nbsp;<span class="op" id="1403074">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1403077">len</span><span class="op" id="1403080">(</span><span class="ident" id="1403081">t</span><span class="op" id="1403082">)</span>&nbsp;<span class="op" id="1403084">!=</span>&nbsp;<span class="num" id="1403087">0</span>&nbsp;<span class="op" id="1403089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1403093">//&nbsp;Extract&nbsp;first&nbsp;rune&nbsp;from&nbsp;each.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1403128">var</span>&nbsp;<span class="ident" id="1403132">sr</span><span class="op" id="1403134">,</span>&nbsp;<span class="ident" id="1403136">tr</span>&nbsp;<span class="builtintype" id="1403139">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1403146">if</span>&nbsp;<span class="ident" id="1403149">s</span><span class="op" id="1403150">[</span><span class="num" id="1403151">0</span><span class="op" id="1403152">]</span>&nbsp;<span class="op" id="1403154">&lt;</span>&nbsp;<span class="ident" id="1403156">utf8</span><span class="op" id="1403160">.</span><span class="ident" id="1403161">RuneSelf</span>&nbsp;<span class="op" id="1403170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1403175">sr</span><span class="op" id="1403177">,</span>&nbsp;<span class="ident" id="1403179">s</span>&nbsp;<span class="op" id="1403181">=</span>&nbsp;<span class="builtintype" id="1403183">rune</span><span class="op" id="1403187">(</span><span class="ident" id="1403188">s</span><span class="op" id="1403189">[</span><span class="num" id="1403190">0</span><span class="op" id="1403191">]</span><span class="op" id="1403192">)</span><span class="op" id="1403193">,</span>&nbsp;<span class="ident" id="1403195">s</span><span class="op" id="1403196">[</span><span class="num" id="1403197">1</span><span class="op" id="1403198">:</span><span class="op" id="1403199">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1403203">}</span>&nbsp;<span class="keyword" id="1403205">else</span>&nbsp;<span class="op" id="1403210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1403215">r</span><span class="op" id="1403216">,</span>&nbsp;<span class="ident" id="1403218">size</span>&nbsp;<span class="op" id="1403223">:=</span>&nbsp;<span class="ident" id="1403226">utf8</span><span class="op" id="1403230">.</span><span class="ident" id="1403231">DecodeRune</span><span class="op" id="1403241">(</span><span class="ident" id="1403242">s</span><span class="op" id="1403243">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1403248">sr</span><span class="op" id="1403250">,</span>&nbsp;<span class="ident" id="1403252">s</span>&nbsp;<span class="op" id="1403254">=</span>&nbsp;<span class="ident" id="1403256">r</span><span class="op" id="1403257">,</span>&nbsp;<span class="ident" id="1403259">s</span><span class="op" id="1403260">[</span><span class="ident" id="1403261">size</span><span class="op" id="1403265">:</span><span class="op" id="1403266">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1403270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1403274">if</span>&nbsp;<span class="ident" id="1403277">t</span><span class="op" id="1403278">[</span><span class="num" id="1403279">0</span><span class="op" id="1403280">]</span>&nbsp;<span class="op" id="1403282">&lt;</span>&nbsp;<span class="ident" id="1403284">utf8</span><span class="op" id="1403288">.</span><span class="ident" id="1403289">RuneSelf</span>&nbsp;<span class="op" id="1403298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1403303">tr</span><span class="op" id="1403305">,</span>&nbsp;<span class="ident" id="1403307">t</span>&nbsp;<span class="op" id="1403309">=</span>&nbsp;<span class="builtintype" id="1403311">rune</span><span class="op" id="1403315">(</span><span class="ident" id="1403316">t</span><span class="op" id="1403317">[</span><span class="num" id="1403318">0</span><span class="op" id="1403319">]</span><span class="op" id="1403320">)</span><span class="op" id="1403321">,</span>&nbsp;<span class="ident" id="1403323">t</span><span class="op" id="1403324">[</span><span class="num" id="1403325">1</span><span class="op" id="1403326">:</span><span class="op" id="1403327">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1403331">}</span>&nbsp;<span class="keyword" id="1403333">else</span>&nbsp;<span class="op" id="1403338">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1403343">r</span><span class="op" id="1403344">,</span>&nbsp;<span class="ident" id="1403346">size</span>&nbsp;<span class="op" id="1403351">:=</span>&nbsp;<span class="ident" id="1403354">utf8</span><span class="op" id="1403358">.</span><span class="ident" id="1403359">DecodeRune</span><span class="op" id="1403369">(</span><span class="ident" id="1403370">t</span><span class="op" id="1403371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1403376">tr</span><span class="op" id="1403378">,</span>&nbsp;<span class="ident" id="1403380">t</span>&nbsp;<span class="op" id="1403382">=</span>&nbsp;<span class="ident" id="1403384">r</span><span class="op" id="1403385">,</span>&nbsp;<span class="ident" id="1403387">t</span><span class="op" id="1403388">[</span><span class="ident" id="1403389">size</span><span class="op" id="1403393">:</span><span class="op" id="1403394">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1403398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1403403">//&nbsp;If&nbsp;they&nbsp;match,&nbsp;keep&nbsp;going;&nbsp;if&nbsp;not,&nbsp;return&nbsp;false.</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1403458">//&nbsp;Easy&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1403474">if</span>&nbsp;<span class="ident" id="1403477">tr</span>&nbsp;<span class="op" id="1403480">==</span>&nbsp;<span class="ident" id="1403483">sr</span>&nbsp;<span class="op" id="1403486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1403491">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1403502">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1403507">//&nbsp;Make&nbsp;sr&nbsp;&lt;&nbsp;tr&nbsp;to&nbsp;simplify&nbsp;what&nbsp;follows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1403551">if</span>&nbsp;<span class="ident" id="1403554">tr</span>&nbsp;<span class="op" id="1403557">&lt;</span>&nbsp;<span class="ident" id="1403559">sr</span>&nbsp;<span class="op" id="1403562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1403567">tr</span><span class="op" id="1403569">,</span>&nbsp;<span class="ident" id="1403571">sr</span>&nbsp;<span class="op" id="1403574">=</span>&nbsp;<span class="ident" id="1403576">sr</span><span class="op" id="1403578">,</span>&nbsp;<span class="ident" id="1403580">tr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1403585">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1403589">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;ASCII.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1403616">if</span>&nbsp;<span class="ident" id="1403619">tr</span>&nbsp;<span class="op" id="1403622">&lt;</span>&nbsp;<span class="ident" id="1403624">utf8</span><span class="op" id="1403628">.</span><span class="ident" id="1403629">RuneSelf</span>&nbsp;<span class="op" id="1403638">&amp;&amp;</span>&nbsp;<span class="string" id="1403641">&#39;A&#39;</span>&nbsp;<span class="op" id="1403645">&lt;=</span>&nbsp;<span class="ident" id="1403648">sr</span>&nbsp;<span class="op" id="1403651">&amp;&amp;</span>&nbsp;<span class="ident" id="1403654">sr</span>&nbsp;<span class="op" id="1403657">&lt;=</span>&nbsp;<span class="string" id="1403660">&#39;Z&#39;</span>&nbsp;<span class="op" id="1403664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1403669">//&nbsp;ASCII,&nbsp;and&nbsp;sr&nbsp;is&nbsp;upper&nbsp;case.&nbsp;&nbsp;tr&nbsp;must&nbsp;be&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1403728">if</span>&nbsp;<span class="ident" id="1403731">tr</span>&nbsp;<span class="op" id="1403734">==</span>&nbsp;<span class="ident" id="1403737">sr</span><span class="op" id="1403739">+</span><span class="string" id="1403740">&#39;a&#39;</span><span class="op" id="1403743">-</span><span class="string" id="1403744">&#39;A&#39;</span>&nbsp;<span class="op" id="1403748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1403754">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1403766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1403771">return</span>&nbsp;<span class="builtintype" id="1403778">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1403786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1403791">//&nbsp;General&nbsp;case.&nbsp;&nbsp;SimpleFold(x)&nbsp;returns&nbsp;the&nbsp;next&nbsp;equivalent&nbsp;rune&nbsp;&gt;&nbsp;x</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1403862">//&nbsp;or&nbsp;wraps&nbsp;around&nbsp;to&nbsp;smaller&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1403902">r</span>&nbsp;<span class="op" id="1403904">:=</span>&nbsp;<span class="ident" id="1403907">unicode</span><span class="op" id="1403914">.</span><span class="ident" id="1403915">SimpleFold</span><span class="op" id="1403925">(</span><span class="ident" id="1403926">sr</span><span class="op" id="1403928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1403932">for</span>&nbsp;<span class="ident" id="1403936">r</span>&nbsp;<span class="op" id="1403938">!=</span>&nbsp;<span class="ident" id="1403941">sr</span>&nbsp;<span class="op" id="1403944">&amp;&amp;</span>&nbsp;<span class="ident" id="1403947">r</span>&nbsp;<span class="op" id="1403949">&lt;</span>&nbsp;<span class="ident" id="1403951">tr</span>&nbsp;<span class="op" id="1403954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1403959">r</span>&nbsp;<span class="op" id="1403961">=</span>&nbsp;<span class="ident" id="1403963">unicode</span><span class="op" id="1403970">.</span><span class="ident" id="1403971">SimpleFold</span><span class="op" id="1403981">(</span><span class="ident" id="1403982">r</span><span class="op" id="1403983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1403987">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1403991">if</span>&nbsp;<span class="ident" id="1403994">r</span>&nbsp;<span class="op" id="1403996">==</span>&nbsp;<span class="ident" id="1403999">tr</span>&nbsp;<span class="op" id="1404002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1404007">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1404018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1404022">return</span>&nbsp;<span class="builtintype" id="1404029">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1404036">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1404040">//&nbsp;One&nbsp;string&nbsp;is&nbsp;empty.&nbsp;&nbsp;Are&nbsp;both?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1404076">return</span>&nbsp;<span class="builtinfunc" id="1404083">len</span><span class="op" id="1404086">(</span><span class="ident" id="1404087">s</span><span class="op" id="1404088">)</span>&nbsp;<span class="op" id="1404090">==</span>&nbsp;<span class="builtinfunc" id="1404093">len</span><span class="op" id="1404096">(</span><span class="ident" id="1404097">t</span><span class="op" id="1404098">)</span><br>
<span class="lineno"></span><span class="op" id="1404100">}</span>
</div>
</body>
</html>
