<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3662745">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3662800">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3662854">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3662905">//&nbsp;This&nbsp;Go&nbsp;implementation&nbsp;is&nbsp;derived&nbsp;in&nbsp;part&nbsp;from&nbsp;the&nbsp;reference</span><br>
<span class="lineno"></span><span class="comment" id="3662969">//&nbsp;ANSI&nbsp;C&nbsp;implementation,&nbsp;which&nbsp;carries&nbsp;the&nbsp;following&nbsp;notice:</span><br>
<span class="lineno"></span><span class="comment" id="3663031">//</span><br>
<span class="lineno"></span><span class="comment" id="3663034">//&nbsp;&nbsp;&nbsp;&nbsprijndael-alg-fst.c</span><br>
<span class="lineno"></span><span class="comment" id="3663056">//</span><br>
<span class="lineno">10</span><span class="comment" id="3663059">//&nbsp;&nbsp;&nbsp;&nbsp@version&nbsp;3.0&nbsp;(December&nbsp;2000)</span><br>
<span class="lineno"></span><span class="comment" id="3663091">//</span><br>
<span class="lineno"></span><span class="comment" id="3663094">//&nbsp;&nbsp;&nbsp;&nbspOptimised&nbsp;ANSI&nbsp;C&nbsp;code&nbsp;for&nbsp;the&nbsp;Rijndael&nbsp;cipher&nbsp;(now&nbsp;AES)</span><br>
<span class="lineno"></span><span class="comment" id="3663153">//</span><br>
<span class="lineno"></span><span class="comment" id="3663156">//&nbsp;&nbsp;&nbsp;&nbsp@author&nbsp;Vincent&nbsp;Rijmen&nbsp;&lt;vincent.rijmen@esat.kuleuven.ac.be&gt;</span><br>
<span class="lineno">15</span><span class="comment" id="3663219">//&nbsp;&nbsp;&nbsp;&nbsp@author&nbsp;Antoon&nbsp;Bosselaers&nbsp;&lt;antoon.bosselaers@esat.kuleuven.ac.be&gt;</span><br>
<span class="lineno"></span><span class="comment" id="3663288">//&nbsp;&nbsp;&nbsp;&nbsp@author&nbsp;Paulo&nbsp;Barreto&nbsp;&lt;paulo.barreto@terra.com.br&gt;</span><br>
<span class="lineno"></span><span class="comment" id="3663342">//</span><br>
<span class="lineno"></span><span class="comment" id="3663345">//&nbsp;&nbsp;&nbsp;&nbspThis&nbsp;code&nbsp;is&nbsp;hereby&nbsp;placed&nbsp;in&nbsp;the&nbsp;public&nbsp;domain.</span><br>
<span class="lineno"></span><span class="comment" id="3663397">//</span><br>
<span class="lineno">20</span><span class="comment" id="3663400">//&nbsp;&nbsp;&nbsp;&nbspTHIS&nbsp;SOFTWARE&nbsp;IS&nbsp;PROVIDED&nbsp;BY&nbsp;THE&nbsp;AUTHORS&nbsp;&#39;&#39;AS&nbsp;IS&#39;&#39;&nbsp;AND&nbsp;ANY&nbsp;EXPRESS</span><br>
<span class="lineno"></span><span class="comment" id="3663470">//&nbsp;&nbsp;&nbsp;&nbspOR&nbsp;IMPLIED&nbsp;WARRANTIES,&nbsp;INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;TO,&nbsp;THE&nbsp;IMPLIED</span><br>
<span class="lineno"></span><span class="comment" id="3663539">//&nbsp;&nbsp;&nbsp;&nbspWARRANTIES&nbsp;OF&nbsp;MERCHANTABILITY&nbsp;AND&nbsp;FITNESS&nbsp;FOR&nbsp;A&nbsp;PARTICULAR&nbsp;PURPOSE</span><br>
<span class="lineno"></span><span class="comment" id="3663609">//&nbsp;&nbsp;&nbsp;&nbspARE&nbsp;DISCLAIMED.&nbsp;&nbsp;IN&nbsp;NO&nbsp;EVENT&nbsp;SHALL&nbsp;THE&nbsp;AUTHORS&nbsp;OR&nbsp;CONTRIBUTORS&nbsp;BE</span><br>
<span class="lineno"></span><span class="comment" id="3663678">//&nbsp;&nbsp;&nbsp;&nbspLIABLE&nbsp;FOR&nbsp;ANY&nbsp;DIRECT,&nbsp;INDIRECT,&nbsp;INCIDENTAL,&nbsp;SPECIAL,&nbsp;EXEMPLARY,&nbsp;OR</span><br>
<span class="lineno">25</span><span class="comment" id="3663749">//&nbsp;&nbsp;&nbsp;&nbspCONSEQUENTIAL&nbsp;DAMAGES&nbsp;(INCLUDING,&nbsp;BUT&nbsp;NOT&nbsp;LIMITED&nbsp;TO,&nbsp;PROCUREMENT&nbsp;OF</span><br>
<span class="lineno"></span><span class="comment" id="3663821">//&nbsp;&nbsp;&nbsp;&nbspSUBSTITUTE&nbsp;GOODS&nbsp;OR&nbsp;SERVICES;&nbsp;LOSS&nbsp;OF&nbsp;USE,&nbsp;DATA,&nbsp;OR&nbsp;PROFITS;&nbsp;OR</span><br>
<span class="lineno"></span><span class="comment" id="3663888">//&nbsp;&nbsp;&nbsp;&nbspBUSINESS&nbsp;INTERRUPTION)&nbsp;HOWEVER&nbsp;CAUSED&nbsp;AND&nbsp;ON&nbsp;ANY&nbsp;THEORY&nbsp;OF&nbsp;LIABILITY,</span><br>
<span class="lineno"></span><span class="comment" id="3663961">//&nbsp;&nbsp;&nbsp;&nbspWHETHER&nbsp;IN&nbsp;CONTRACT,&nbsp;STRICT&nbsp;LIABILITY,&nbsp;OR&nbsp;TORT&nbsp;(INCLUDING&nbsp;NEGLIGENCE</span><br>
<span class="lineno"></span><span class="comment" id="3664033">//&nbsp;&nbsp;&nbsp;&nbspOR&nbsp;OTHERWISE)&nbsp;ARISING&nbsp;IN&nbsp;ANY&nbsp;WAY&nbsp;OUT&nbsp;OF&nbsp;THE&nbsp;USE&nbsp;OF&nbsp;THIS&nbsp;SOFTWARE,</span><br>
<span class="lineno">30</span><span class="comment" id="3664102">//&nbsp;&nbsp;&nbsp;&nbspEVEN&nbsp;IF&nbsp;ADVISED&nbsp;OF&nbsp;THE&nbsp;POSSIBILITY&nbsp;OF&nbsp;SUCH&nbsp;DAMAGE.</span><br>
<span class="lineno"></span><span class="comment" id="3664156">//</span><br>
<span class="lineno"></span><span class="comment" id="3664159">//&nbsp;See&nbsp;FIPS&nbsp;197&nbsp;for&nbsp;specification,&nbsp;and&nbsp;see&nbsp;Daemen&nbsp;and&nbsp;Rijmen&#39;s&nbsp;Rijndael&nbsp;submission</span><br>
<span class="lineno"></span><span class="comment" id="3664242">//&nbsp;for&nbsp;implementation&nbsp;details.</span><br>
<span class="lineno"></span><span class="comment" id="3664273">//&nbsp;&nbsp;&nbsp;&nbsphttp://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno">35</span><span class="comment" id="3664340">//&nbsp;&nbsp;&nbsp;&nbsphttp://csrc.nist.gov/archive/aes/rijndael/Rijndael-ammended.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3664408">package</span>&nbsp;<span class="ident" id="3664416">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3664421">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;expanded&nbsp;key&nbsp;xk.</span><br>
<span class="lineno">40</span><span class="keyword" id="3664488">func</span>&nbsp;<span class="ident" id="3664493">encryptBlockGo</span><span class="op" id="3664507">(</span><span class="ident" id="3664508">xk</span>&nbsp;<span class="op" id="3664511">[</span><span class="op" id="3664512">]</span><span class="builtintype" id="3664513">uint32</span><span class="op" id="3664519">,</span>&nbsp;<span class="ident" id="3664521">dst</span><span class="op" id="3664524">,</span>&nbsp;<span class="ident" id="3664526">src</span>&nbsp;<span class="op" id="3664530">[</span><span class="op" id="3664531">]</span><span class="builtintype" id="3664532">byte</span><span class="op" id="3664536">)</span>&nbsp;<span class="op" id="3664538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3664541">var</span>&nbsp;<span class="ident" id="3664545">s0</span><span class="op" id="3664547">,</span>&nbsp;<span class="ident" id="3664549">s1</span><span class="op" id="3664551">,</span>&nbsp;<span class="ident" id="3664553">s2</span><span class="op" id="3664555">,</span>&nbsp;<span class="ident" id="3664557">s3</span><span class="op" id="3664559">,</span>&nbsp;<span class="ident" id="3664561">t0</span><span class="op" id="3664563">,</span>&nbsp;<span class="ident" id="3664565">t1</span><span class="op" id="3664567">,</span>&nbsp;<span class="ident" id="3664569">t2</span><span class="op" id="3664571">,</span>&nbsp;<span class="ident" id="3664573">t3</span>&nbsp;<span class="builtintype" id="3664576">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3664585"><a href="/crypto/aes/block.go.html#3664545">s0</a></span>&nbsp;<span class="op" id="3664588">=</span>&nbsp;<span class="builtintype" id="3664590">uint32</span><span class="op" id="3664596">(</span><span class="ident" id="3664597"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664600">[</span><span class="num" id="3664601">0</span><span class="op" id="3664602">]</span><span class="op" id="3664603">)</span><span class="op" id="3664604">&lt;&lt;</span><span class="num" id="3664606">24</span>&nbsp;<span class="op" id="3664609">|</span>&nbsp;<span class="builtintype" id="3664611">uint32</span><span class="op" id="3664617">(</span><span class="ident" id="3664618"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664621">[</span><span class="num" id="3664622">1</span><span class="op" id="3664623">]</span><span class="op" id="3664624">)</span><span class="op" id="3664625">&lt;&lt;</span><span class="num" id="3664627">16</span>&nbsp;<span class="op" id="3664630">|</span>&nbsp;<span class="builtintype" id="3664632">uint32</span><span class="op" id="3664638">(</span><span class="ident" id="3664639"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664642">[</span><span class="num" id="3664643">2</span><span class="op" id="3664644">]</span><span class="op" id="3664645">)</span><span class="op" id="3664646">&lt;&lt;</span><span class="num" id="3664648">8</span>&nbsp;<span class="op" id="3664650">|</span>&nbsp;<span class="builtintype" id="3664652">uint32</span><span class="op" id="3664658">(</span><span class="ident" id="3664659"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664662">[</span><span class="num" id="3664663">3</span><span class="op" id="3664664">]</span><span class="op" id="3664665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3664668"><a href="/crypto/aes/block.go.html#3664549">s1</a></span>&nbsp;<span class="op" id="3664671">=</span>&nbsp;<span class="builtintype" id="3664673">uint32</span><span class="op" id="3664679">(</span><span class="ident" id="3664680"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664683">[</span><span class="num" id="3664684">4</span><span class="op" id="3664685">]</span><span class="op" id="3664686">)</span><span class="op" id="3664687">&lt;&lt;</span><span class="num" id="3664689">24</span>&nbsp;<span class="op" id="3664692">|</span>&nbsp;<span class="builtintype" id="3664694">uint32</span><span class="op" id="3664700">(</span><span class="ident" id="3664701"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664704">[</span><span class="num" id="3664705">5</span><span class="op" id="3664706">]</span><span class="op" id="3664707">)</span><span class="op" id="3664708">&lt;&lt;</span><span class="num" id="3664710">16</span>&nbsp;<span class="op" id="3664713">|</span>&nbsp;<span class="builtintype" id="3664715">uint32</span><span class="op" id="3664721">(</span><span class="ident" id="3664722"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664725">[</span><span class="num" id="3664726">6</span><span class="op" id="3664727">]</span><span class="op" id="3664728">)</span><span class="op" id="3664729">&lt;&lt;</span><span class="num" id="3664731">8</span>&nbsp;<span class="op" id="3664733">|</span>&nbsp;<span class="builtintype" id="3664735">uint32</span><span class="op" id="3664741">(</span><span class="ident" id="3664742"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664745">[</span><span class="num" id="3664746">7</span><span class="op" id="3664747">]</span><span class="op" id="3664748">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3664751"><a href="/crypto/aes/block.go.html#3664553">s2</a></span>&nbsp;<span class="op" id="3664754">=</span>&nbsp;<span class="builtintype" id="3664756">uint32</span><span class="op" id="3664762">(</span><span class="ident" id="3664763"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664766">[</span><span class="num" id="3664767">8</span><span class="op" id="3664768">]</span><span class="op" id="3664769">)</span><span class="op" id="3664770">&lt;&lt;</span><span class="num" id="3664772">24</span>&nbsp;<span class="op" id="3664775">|</span>&nbsp;<span class="builtintype" id="3664777">uint32</span><span class="op" id="3664783">(</span><span class="ident" id="3664784"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664787">[</span><span class="num" id="3664788">9</span><span class="op" id="3664789">]</span><span class="op" id="3664790">)</span><span class="op" id="3664791">&lt;&lt;</span><span class="num" id="3664793">16</span>&nbsp;<span class="op" id="3664796">|</span>&nbsp;<span class="builtintype" id="3664798">uint32</span><span class="op" id="3664804">(</span><span class="ident" id="3664805"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664808">[</span><span class="num" id="3664809">10</span><span class="op" id="3664811">]</span><span class="op" id="3664812">)</span><span class="op" id="3664813">&lt;&lt;</span><span class="num" id="3664815">8</span>&nbsp;<span class="op" id="3664817">|</span>&nbsp;<span class="builtintype" id="3664819">uint32</span><span class="op" id="3664825">(</span><span class="ident" id="3664826"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664829">[</span><span class="num" id="3664830">11</span><span class="op" id="3664832">]</span><span class="op" id="3664833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3664836"><a href="/crypto/aes/block.go.html#3664557">s3</a></span>&nbsp;<span class="op" id="3664839">=</span>&nbsp;<span class="builtintype" id="3664841">uint32</span><span class="op" id="3664847">(</span><span class="ident" id="3664848"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664851">[</span><span class="num" id="3664852">12</span><span class="op" id="3664854">]</span><span class="op" id="3664855">)</span><span class="op" id="3664856">&lt;&lt;</span><span class="num" id="3664858">24</span>&nbsp;<span class="op" id="3664861">|</span>&nbsp;<span class="builtintype" id="3664863">uint32</span><span class="op" id="3664869">(</span><span class="ident" id="3664870"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664873">[</span><span class="num" id="3664874">13</span><span class="op" id="3664876">]</span><span class="op" id="3664877">)</span><span class="op" id="3664878">&lt;&lt;</span><span class="num" id="3664880">16</span>&nbsp;<span class="op" id="3664883">|</span>&nbsp;<span class="builtintype" id="3664885">uint32</span><span class="op" id="3664891">(</span><span class="ident" id="3664892"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664895">[</span><span class="num" id="3664896">14</span><span class="op" id="3664898">]</span><span class="op" id="3664899">)</span><span class="op" id="3664900">&lt;&lt;</span><span class="num" id="3664902">8</span>&nbsp;<span class="op" id="3664904">|</span>&nbsp;<span class="builtintype" id="3664906">uint32</span><span class="op" id="3664912">(</span><span class="ident" id="3664913"><a href="/crypto/aes/block.go.html#3664526">src</a></span><span class="op" id="3664916">[</span><span class="num" id="3664917">15</span><span class="op" id="3664919">]</span><span class="op" id="3664920">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3664924">//&nbsp;First&nbsp;round&nbsp;just&nbsp;XORs&nbsp;input&nbsp;with&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3664966"><a href="/crypto/aes/block.go.html#3664545">s0</a></span>&nbsp;<span class="op" id="3664969">^=</span>&nbsp;<span class="ident" id="3664972"><a href="/crypto/aes/block.go.html#3664508">xk</a></span><span class="op" id="3664974">[</span><span class="num" id="3664975">0</span><span class="op" id="3664976">]</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3664979"><a href="/crypto/aes/block.go.html#3664549">s1</a></span>&nbsp;<span class="op" id="3664982">^=</span>&nbsp;<span class="ident" id="3664985"><a href="/crypto/aes/block.go.html#3664508">xk</a></span><span class="op" id="3664987">[</span><span class="num" id="3664988">1</span><span class="op" id="3664989">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3664992"><a href="/crypto/aes/block.go.html#3664553">s2</a></span>&nbsp;<span class="op" id="3664995">^=</span>&nbsp;<span class="ident" id="3664998"><a href="/crypto/aes/block.go.html#3664508">xk</a></span><span class="op" id="3665000">[</span><span class="num" id="3665001">2</span><span class="op" id="3665002">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3665005"><a href="/crypto/aes/block.go.html#3664557">s3</a></span>&nbsp;<span class="op" id="3665008">^=</span>&nbsp;<span class="ident" id="3665011"><a href="/crypto/aes/block.go.html#3664508">xk</a></span><span class="op" id="3665013">[</span><span class="num" id="3665014">3</span><span class="op" id="3665015">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3665019">//&nbsp;Middle&nbsp;rounds&nbsp;shuffle&nbsp;using&nbsp;tables.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3665059">//&nbsp;Number&nbsp;of&nbsp;rounds&nbsp;is&nbsp;set&nbsp;by&nbsp;length&nbsp;of&nbsp;expanded&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3665114">nr</span>&nbsp;<span class="op" id="3665117">:=</span>&nbsp;<span class="builtinfunc" id="3665120">len</span><span class="op" id="3665123">(</span><span class="ident" id="3665124"><a href="/crypto/aes/block.go.html#3664508">xk</a></span><span class="op" id="3665126">)</span><span class="op" id="3665127">/</span><span class="num" id="3665128">4</span>&nbsp;<span class="op" id="3665130">-</span>&nbsp;<span class="num" id="3665132">2</span>&nbsp;<span class="comment" id="3665134">//&nbsp;-&nbsp;2:&nbsp;one&nbsp;above,&nbsp;one&nbsp;more&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3665169">k</span>&nbsp;<span class="op" id="3665171">:=</span>&nbsp;<span class="num" id="3665174">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3665177">for</span>&nbsp;<span class="ident" id="3665181">r</span>&nbsp;<span class="op" id="3665183">:=</span>&nbsp;<span class="num" id="3665186">0</span><span class="op" id="3665187">;</span>&nbsp;<span class="ident" id="3665189"><a href="/crypto/aes/block.go.html#3665181">r</a></span>&nbsp;<span class="op" id="3665191">&lt;</span>&nbsp;<span class="ident" id="3665193"><a href="/crypto/aes/block.go.html#3665114">nr</a></span><span class="op" id="3665195">;</span>&nbsp;<span class="ident" id="3665197"><a href="/crypto/aes/block.go.html#3665181">r</a></span><span class="op" id="3665198">++</span>&nbsp;<span class="op" id="3665201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3665205"><a href="/crypto/aes/block.go.html#3664561">t0</a></span>&nbsp;<span class="op" id="3665208">=</span>&nbsp;<span class="ident" id="3665210"><a href="/crypto/aes/block.go.html#3664508">xk</a></span><span class="op" id="3665212">[</span><span class="ident" id="3665213"><a href="/crypto/aes/block.go.html#3665169">k</a></span><span class="op" id="3665214">+</span><span class="num" id="3665215">0</span><span class="op" id="3665216">]</span>&nbsp;<span class="op" id="3665218">^</span>&nbsp;<span class="ident" id="3665220"><a href="/crypto/aes/const.go.html#3676946">te0</a></span><span class="op" id="3665223">[</span><span class="builtintype" id="3665224">uint8</span><span class="op" id="3665229">(</span><span class="ident" id="3665230"><a href="/crypto/aes/block.go.html#3664545">s0</a></span><span class="op" id="3665232">&gt;&gt;</span><span class="num" id="3665234">24</span><span class="op" id="3665236">)</span><span class="op" id="3665237">]</span>&nbsp;<span class="op" id="3665239">^</span>&nbsp;<span class="ident" id="3665241"><a href="/crypto/aes/const.go.html#3680075">te1</a></span><span class="op" id="3665244">[</span><span class="builtintype" id="3665245">uint8</span><span class="op" id="3665250">(</span><span class="ident" id="3665251"><a href="/crypto/aes/block.go.html#3664549">s1</a></span><span class="op" id="3665253">&gt;&gt;</span><span class="num" id="3665255">16</span><span class="op" id="3665257">)</span><span class="op" id="3665258">]</span>&nbsp;<span class="op" id="3665260">^</span>&nbsp;<span class="ident" id="3665262"><a href="/crypto/aes/const.go.html#3683204">te2</a></span><span class="op" id="3665265">[</span><span class="builtintype" id="3665266">uint8</span><span class="op" id="3665271">(</span><span class="ident" id="3665272"><a href="/crypto/aes/block.go.html#3664553">s2</a></span><span class="op" id="3665274">&gt;&gt;</span><span class="num" id="3665276">8</span><span class="op" id="3665277">)</span><span class="op" id="3665278">]</span>&nbsp;<span class="op" id="3665280">^</span>&nbsp;<span class="ident" id="3665282"><a href="/crypto/aes/const.go.html#3686333">te3</a></span><span class="op" id="3665285">[</span><span class="builtintype" id="3665286">uint8</span><span class="op" id="3665291">(</span><span class="ident" id="3665292"><a href="/crypto/aes/block.go.html#3664557">s3</a></span><span class="op" id="3665294">)</span><span class="op" id="3665295">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3665299"><a href="/crypto/aes/block.go.html#3664565">t1</a></span>&nbsp;<span class="op" id="3665302">=</span>&nbsp;<span class="ident" id="3665304"><a href="/crypto/aes/block.go.html#3664508">xk</a></span><span class="op" id="3665306">[</span><span class="ident" id="3665307"><a href="/crypto/aes/block.go.html#3665169">k</a></span><span class="op" id="3665308">+</span><span class="num" id="3665309">1</span><span class="op" id="3665310">]</span>&nbsp;<span class="op" id="3665312">^</span>&nbsp;<span class="ident" id="3665314"><a href="/crypto/aes/const.go.html#3676946">te0</a></span><span class="op" id="3665317">[</span><span class="builtintype" id="3665318">uint8</span><span class="op" id="3665323">(</span><span class="ident" id="3665324"><a href="/crypto/aes/block.go.html#3664549">s1</a></span><span class="op" id="3665326">&gt;&gt;</span><span class="num" id="3665328">24</span><span class="op" id="3665330">)</span><span class="op" id="3665331">]</span>&nbsp;<span class="op" id="3665333">^</span>&nbsp;<span class="ident" id="3665335"><a href="/crypto/aes/const.go.html#3680075">te1</a></span><span class="op" id="3665338">[</span><span class="builtintype" id="3665339">uint8</span><span class="op" id="3665344">(</span><span class="ident" id="3665345"><a href="/crypto/aes/block.go.html#3664553">s2</a></span><span class="op" id="3665347">&gt;&gt;</span><span class="num" id="3665349">16</span><span class="op" id="3665351">)</span><span class="op" id="3665352">]</span>&nbsp;<span class="op" id="3665354">^</span>&nbsp;<span class="ident" id="3665356"><a href="/crypto/aes/const.go.html#3683204">te2</a></span><span class="op" id="3665359">[</span><span class="builtintype" id="3665360">uint8</span><span class="op" id="3665365">(</span><span class="ident" id="3665366"><a href="/crypto/aes/block.go.html#3664557">s3</a></span><span class="op" id="3665368">&gt;&gt;</span><span class="num" id="3665370">8</span><span class="op" id="3665371">)</span><span class="op" id="3665372">]</span>&nbsp;<span class="op" id="3665374">^</span>&nbsp;<span class="ident" id="3665376"><a href="/crypto/aes/const.go.html#3686333">te3</a></span><span class="op" id="3665379">[</span><span class="builtintype" id="3665380">uint8</span><span class="op" id="3665385">(</span><span class="ident" id="3665386"><a href="/crypto/aes/block.go.html#3664545">s0</a></span><span class="op" id="3665388">)</span><span class="op" id="3665389">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3665393"><a href="/crypto/aes/block.go.html#3664569">t2</a></span>&nbsp;<span class="op" id="3665396">=</span>&nbsp;<span class="ident" id="3665398"><a href="/crypto/aes/block.go.html#3664508">xk</a></span><span class="op" id="3665400">[</span><span class="ident" id="3665401"><a href="/crypto/aes/block.go.html#3665169">k</a></span><span class="op" id="3665402">+</span><span class="num" id="3665403">2</span><span class="op" id="3665404">]</span>&nbsp;<span class="op" id="3665406">^</span>&nbsp;<span class="ident" id="3665408"><a href="/crypto/aes/const.go.html#3676946">te0</a></span><span class="op" id="3665411">[</span><span class="builtintype" id="3665412">uint8</span><span class="op" id="3665417">(</span><span class="ident" id="3665418"><a href="/crypto/aes/block.go.html#3664553">s2</a></span><span class="op" id="3665420">&gt;&gt;</span><span class="num" id="3665422">24</span><span class="op" id="3665424">)</span><span class="op" id="3665425">]</span>&nbsp;<span class="op" id="3665427">^</span>&nbsp;<span class="ident" id="3665429"><a href="/crypto/aes/const.go.html#3680075">te1</a></span><span class="op" id="3665432">[</span><span class="builtintype" id="3665433">uint8</span><span class="op" id="3665438">(</span><span class="ident" id="3665439"><a href="/crypto/aes/block.go.html#3664557">s3</a></span><span class="op" id="3665441">&gt;&gt;</span><span class="num" id="3665443">16</span><span class="op" id="3665445">)</span><span class="op" id="3665446">]</span>&nbsp;<span class="op" id="3665448">^</span>&nbsp;<span class="ident" id="3665450"><a href="/crypto/aes/const.go.html#3683204">te2</a></span><span class="op" id="3665453">[</span><span class="builtintype" id="3665454">uint8</span><span class="op" id="3665459">(</span><span class="ident" id="3665460"><a href="/crypto/aes/block.go.html#3664545">s0</a></span><span class="op" id="3665462">&gt;&gt;</span><span class="num" id="3665464">8</span><span class="op" id="3665465">)</span><span class="op" id="3665466">]</span>&nbsp;<span class="op" id="3665468">^</span>&nbsp;<span class="ident" id="3665470"><a href="/crypto/aes/const.go.html#3686333">te3</a></span><span class="op" id="3665473">[</span><span class="builtintype" id="3665474">uint8</span><span class="op" id="3665479">(</span><span class="ident" id="3665480"><a href="/crypto/aes/block.go.html#3664549">s1</a></span><span class="op" id="3665482">)</span><span class="op" id="3665483">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3665487"><a href="/crypto/aes/block.go.html#3664573">t3</a></span>&nbsp;<span class="op" id="3665490">=</span>&nbsp;<span class="ident" id="3665492"><a href="/crypto/aes/block.go.html#3664508">xk</a></span><span class="op" id="3665494">[</span><span class="ident" id="3665495"><a href="/crypto/aes/block.go.html#3665169">k</a></span><span class="op" id="3665496">+</span><span class="num" id="3665497">3</span><span class="op" id="3665498">]</span>&nbsp;<span class="op" id="3665500">^</span>&nbsp;<span class="ident" id="3665502"><a href="/crypto/aes/const.go.html#3676946">te0</a></span><span class="op" id="3665505">[</span><span class="builtintype" id="3665506">uint8</span><span class="op" id="3665511">(</span><span class="ident" id="3665512"><a href="/crypto/aes/block.go.html#3664557">s3</a></span><span class="op" id="3665514">&gt;&gt;</span><span class="num" id="3665516">24</span><span class="op" id="3665518">)</span><span class="op" id="3665519">]</span>&nbsp;<span class="op" id="3665521">^</span>&nbsp;<span class="ident" id="3665523"><a href="/crypto/aes/const.go.html#3680075">te1</a></span><span class="op" id="3665526">[</span><span class="builtintype" id="3665527">uint8</span><span class="op" id="3665532">(</span><span class="ident" id="3665533"><a href="/crypto/aes/block.go.html#3664545">s0</a></span><span class="op" id="3665535">&gt;&gt;</span><span class="num" id="3665537">16</span><span class="op" id="3665539">)</span><span class="op" id="3665540">]</span>&nbsp;<span class="op" id="3665542">^</span>&nbsp;<span class="ident" id="3665544"><a href="/crypto/aes/const.go.html#3683204">te2</a></span><span class="op" id="3665547">[</span><span class="builtintype" id="3665548">uint8</span><span class="op" id="3665553">(</span><span class="ident" id="3665554"><a href="/crypto/aes/block.go.html#3664549">s1</a></span><span class="op" id="3665556">&gt;&gt;</span><span class="num" id="3665558">8</span><span class="op" id="3665559">)</span><span class="op" id="3665560">]</span>&nbsp;<span class="op" id="3665562">^</span>&nbsp;<span class="ident" id="3665564"><a href="/crypto/aes/const.go.html#3686333">te3</a></span><span class="op" id="3665567">[</span><span class="builtintype" id="3665568">uint8</span><span class="op" id="3665573">(</span><span class="ident" id="3665574"><a href="/crypto/aes/block.go.html#3664553">s2</a></span><span class="op" id="3665576">)</span><span class="op" id="3665577">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3665581"><a href="/crypto/aes/block.go.html#3665169">k</a></span>&nbsp;<span class="op" id="3665583">+=</span>&nbsp;<span class="num" id="3665586">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3665590"><a href="/crypto/aes/block.go.html#3664545">s0</a></span><span class="op" id="3665592">,</span>&nbsp;<span class="ident" id="3665594"><a href="/crypto/aes/block.go.html#3664549">s1</a></span><span class="op" id="3665596">,</span>&nbsp;<span class="ident" id="3665598"><a href="/crypto/aes/block.go.html#3664553">s2</a></span><span class="op" id="3665600">,</span>&nbsp;<span class="ident" id="3665602"><a href="/crypto/aes/block.go.html#3664557">s3</a></span>&nbsp;<span class="op" id="3665605">=</span>&nbsp;<span class="ident" id="3665607"><a href="/crypto/aes/block.go.html#3664561">t0</a></span><span class="op" id="3665609">,</span>&nbsp;<span class="ident" id="3665611"><a href="/crypto/aes/block.go.html#3664565">t1</a></span><span class="op" id="3665613">,</span>&nbsp;<span class="ident" id="3665615"><a href="/crypto/aes/block.go.html#3664569">t2</a></span><span class="op" id="3665617">,</span>&nbsp;<span class="ident" id="3665619"><a href="/crypto/aes/block.go.html#3664573">t3</a></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3665623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3665627">//&nbsp;Last&nbsp;round&nbsp;uses&nbsp;s-box&nbsp;directly&nbsp;and&nbsp;XORs&nbsp;to&nbsp;produce&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3665690"><a href="/crypto/aes/block.go.html#3664545">s0</a></span>&nbsp;<span class="op" id="3665693">=</span>&nbsp;<span class="builtintype" id="3665695">uint32</span><span class="op" id="3665701">(</span><span class="ident" id="3665702"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3665707">[</span><span class="ident" id="3665708"><a href="/crypto/aes/block.go.html#3664561">t0</a></span><span class="op" id="3665710">&gt;&gt;</span><span class="num" id="3665712">24</span><span class="op" id="3665714">]</span><span class="op" id="3665715">)</span><span class="op" id="3665716">&lt;&lt;</span><span class="num" id="3665718">24</span>&nbsp;<span class="op" id="3665721">|</span>&nbsp;<span class="builtintype" id="3665723">uint32</span><span class="op" id="3665729">(</span><span class="ident" id="3665730"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3665735">[</span><span class="ident" id="3665736"><a href="/crypto/aes/block.go.html#3664565">t1</a></span><span class="op" id="3665738">&gt;&gt;</span><span class="num" id="3665740">16</span><span class="op" id="3665742">&amp;</span><span class="num" id="3665743">0xff</span><span class="op" id="3665747">]</span><span class="op" id="3665748">)</span><span class="op" id="3665749">&lt;&lt;</span><span class="num" id="3665751">16</span>&nbsp;<span class="op" id="3665754">|</span>&nbsp;<span class="builtintype" id="3665756">uint32</span><span class="op" id="3665762">(</span><span class="ident" id="3665763"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3665768">[</span><span class="ident" id="3665769"><a href="/crypto/aes/block.go.html#3664569">t2</a></span><span class="op" id="3665771">&gt;&gt;</span><span class="num" id="3665773">8</span><span class="op" id="3665774">&amp;</span><span class="num" id="3665775">0xff</span><span class="op" id="3665779">]</span><span class="op" id="3665780">)</span><span class="op" id="3665781">&lt;&lt;</span><span class="num" id="3665783">8</span>&nbsp;<span class="op" id="3665785">|</span>&nbsp;<span class="builtintype" id="3665787">uint32</span><span class="op" id="3665793">(</span><span class="ident" id="3665794"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3665799">[</span><span class="ident" id="3665800"><a href="/crypto/aes/block.go.html#3664573">t3</a></span><span class="op" id="3665802">&amp;</span><span class="num" id="3665803">0xff</span><span class="op" id="3665807">]</span><span class="op" id="3665808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3665811"><a href="/crypto/aes/block.go.html#3664549">s1</a></span>&nbsp;<span class="op" id="3665814">=</span>&nbsp;<span class="builtintype" id="3665816">uint32</span><span class="op" id="3665822">(</span><span class="ident" id="3665823"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3665828">[</span><span class="ident" id="3665829"><a href="/crypto/aes/block.go.html#3664565">t1</a></span><span class="op" id="3665831">&gt;&gt;</span><span class="num" id="3665833">24</span><span class="op" id="3665835">]</span><span class="op" id="3665836">)</span><span class="op" id="3665837">&lt;&lt;</span><span class="num" id="3665839">24</span>&nbsp;<span class="op" id="3665842">|</span>&nbsp;<span class="builtintype" id="3665844">uint32</span><span class="op" id="3665850">(</span><span class="ident" id="3665851"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3665856">[</span><span class="ident" id="3665857"><a href="/crypto/aes/block.go.html#3664569">t2</a></span><span class="op" id="3665859">&gt;&gt;</span><span class="num" id="3665861">16</span><span class="op" id="3665863">&amp;</span><span class="num" id="3665864">0xff</span><span class="op" id="3665868">]</span><span class="op" id="3665869">)</span><span class="op" id="3665870">&lt;&lt;</span><span class="num" id="3665872">16</span>&nbsp;<span class="op" id="3665875">|</span>&nbsp;<span class="builtintype" id="3665877">uint32</span><span class="op" id="3665883">(</span><span class="ident" id="3665884"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3665889">[</span><span class="ident" id="3665890"><a href="/crypto/aes/block.go.html#3664573">t3</a></span><span class="op" id="3665892">&gt;&gt;</span><span class="num" id="3665894">8</span><span class="op" id="3665895">&amp;</span><span class="num" id="3665896">0xff</span><span class="op" id="3665900">]</span><span class="op" id="3665901">)</span><span class="op" id="3665902">&lt;&lt;</span><span class="num" id="3665904">8</span>&nbsp;<span class="op" id="3665906">|</span>&nbsp;<span class="builtintype" id="3665908">uint32</span><span class="op" id="3665914">(</span><span class="ident" id="3665915"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3665920">[</span><span class="ident" id="3665921"><a href="/crypto/aes/block.go.html#3664561">t0</a></span><span class="op" id="3665923">&amp;</span><span class="num" id="3665924">0xff</span><span class="op" id="3665928">]</span><span class="op" id="3665929">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3665932"><a href="/crypto/aes/block.go.html#3664553">s2</a></span>&nbsp;<span class="op" id="3665935">=</span>&nbsp;<span class="builtintype" id="3665937">uint32</span><span class="op" id="3665943">(</span><span class="ident" id="3665944"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3665949">[</span><span class="ident" id="3665950"><a href="/crypto/aes/block.go.html#3664569">t2</a></span><span class="op" id="3665952">&gt;&gt;</span><span class="num" id="3665954">24</span><span class="op" id="3665956">]</span><span class="op" id="3665957">)</span><span class="op" id="3665958">&lt;&lt;</span><span class="num" id="3665960">24</span>&nbsp;<span class="op" id="3665963">|</span>&nbsp;<span class="builtintype" id="3665965">uint32</span><span class="op" id="3665971">(</span><span class="ident" id="3665972"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3665977">[</span><span class="ident" id="3665978"><a href="/crypto/aes/block.go.html#3664573">t3</a></span><span class="op" id="3665980">&gt;&gt;</span><span class="num" id="3665982">16</span><span class="op" id="3665984">&amp;</span><span class="num" id="3665985">0xff</span><span class="op" id="3665989">]</span><span class="op" id="3665990">)</span><span class="op" id="3665991">&lt;&lt;</span><span class="num" id="3665993">16</span>&nbsp;<span class="op" id="3665996">|</span>&nbsp;<span class="builtintype" id="3665998">uint32</span><span class="op" id="3666004">(</span><span class="ident" id="3666005"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3666010">[</span><span class="ident" id="3666011"><a href="/crypto/aes/block.go.html#3664561">t0</a></span><span class="op" id="3666013">&gt;&gt;</span><span class="num" id="3666015">8</span><span class="op" id="3666016">&amp;</span><span class="num" id="3666017">0xff</span><span class="op" id="3666021">]</span><span class="op" id="3666022">)</span><span class="op" id="3666023">&lt;&lt;</span><span class="num" id="3666025">8</span>&nbsp;<span class="op" id="3666027">|</span>&nbsp;<span class="builtintype" id="3666029">uint32</span><span class="op" id="3666035">(</span><span class="ident" id="3666036"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3666041">[</span><span class="ident" id="3666042"><a href="/crypto/aes/block.go.html#3664565">t1</a></span><span class="op" id="3666044">&amp;</span><span class="num" id="3666045">0xff</span><span class="op" id="3666049">]</span><span class="op" id="3666050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666053"><a href="/crypto/aes/block.go.html#3664557">s3</a></span>&nbsp;<span class="op" id="3666056">=</span>&nbsp;<span class="builtintype" id="3666058">uint32</span><span class="op" id="3666064">(</span><span class="ident" id="3666065"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3666070">[</span><span class="ident" id="3666071"><a href="/crypto/aes/block.go.html#3664573">t3</a></span><span class="op" id="3666073">&gt;&gt;</span><span class="num" id="3666075">24</span><span class="op" id="3666077">]</span><span class="op" id="3666078">)</span><span class="op" id="3666079">&lt;&lt;</span><span class="num" id="3666081">24</span>&nbsp;<span class="op" id="3666084">|</span>&nbsp;<span class="builtintype" id="3666086">uint32</span><span class="op" id="3666092">(</span><span class="ident" id="3666093"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3666098">[</span><span class="ident" id="3666099"><a href="/crypto/aes/block.go.html#3664561">t0</a></span><span class="op" id="3666101">&gt;&gt;</span><span class="num" id="3666103">16</span><span class="op" id="3666105">&amp;</span><span class="num" id="3666106">0xff</span><span class="op" id="3666110">]</span><span class="op" id="3666111">)</span><span class="op" id="3666112">&lt;&lt;</span><span class="num" id="3666114">16</span>&nbsp;<span class="op" id="3666117">|</span>&nbsp;<span class="builtintype" id="3666119">uint32</span><span class="op" id="3666125">(</span><span class="ident" id="3666126"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3666131">[</span><span class="ident" id="3666132"><a href="/crypto/aes/block.go.html#3664565">t1</a></span><span class="op" id="3666134">&gt;&gt;</span><span class="num" id="3666136">8</span><span class="op" id="3666137">&amp;</span><span class="num" id="3666138">0xff</span><span class="op" id="3666142">]</span><span class="op" id="3666143">)</span><span class="op" id="3666144">&lt;&lt;</span><span class="num" id="3666146">8</span>&nbsp;<span class="op" id="3666148">|</span>&nbsp;<span class="builtintype" id="3666150">uint32</span><span class="op" id="3666156">(</span><span class="ident" id="3666157"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3666162">[</span><span class="ident" id="3666163"><a href="/crypto/aes/block.go.html#3664569">t2</a></span><span class="op" id="3666165">&amp;</span><span class="num" id="3666166">0xff</span><span class="op" id="3666170">]</span><span class="op" id="3666171">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666175"><a href="/crypto/aes/block.go.html#3664545">s0</a></span>&nbsp;<span class="op" id="3666178">^=</span>&nbsp;<span class="ident" id="3666181"><a href="/crypto/aes/block.go.html#3664508">xk</a></span><span class="op" id="3666183">[</span><span class="ident" id="3666184"><a href="/crypto/aes/block.go.html#3665169">k</a></span><span class="op" id="3666185">+</span><span class="num" id="3666186">0</span><span class="op" id="3666187">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666190"><a href="/crypto/aes/block.go.html#3664549">s1</a></span>&nbsp;<span class="op" id="3666193">^=</span>&nbsp;<span class="ident" id="3666196"><a href="/crypto/aes/block.go.html#3664508">xk</a></span><span class="op" id="3666198">[</span><span class="ident" id="3666199"><a href="/crypto/aes/block.go.html#3665169">k</a></span><span class="op" id="3666200">+</span><span class="num" id="3666201">1</span><span class="op" id="3666202">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666205"><a href="/crypto/aes/block.go.html#3664553">s2</a></span>&nbsp;<span class="op" id="3666208">^=</span>&nbsp;<span class="ident" id="3666211"><a href="/crypto/aes/block.go.html#3664508">xk</a></span><span class="op" id="3666213">[</span><span class="ident" id="3666214"><a href="/crypto/aes/block.go.html#3665169">k</a></span><span class="op" id="3666215">+</span><span class="num" id="3666216">2</span><span class="op" id="3666217">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666220"><a href="/crypto/aes/block.go.html#3664557">s3</a></span>&nbsp;<span class="op" id="3666223">^=</span>&nbsp;<span class="ident" id="3666226"><a href="/crypto/aes/block.go.html#3664508">xk</a></span><span class="op" id="3666228">[</span><span class="ident" id="3666229"><a href="/crypto/aes/block.go.html#3665169">k</a></span><span class="op" id="3666230">+</span><span class="num" id="3666231">3</span><span class="op" id="3666232">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666236"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666239">[</span><span class="num" id="3666240">0</span><span class="op" id="3666241">]</span><span class="op" id="3666242">,</span>&nbsp;<span class="ident" id="3666244"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666247">[</span><span class="num" id="3666248">1</span><span class="op" id="3666249">]</span><span class="op" id="3666250">,</span>&nbsp;<span class="ident" id="3666252"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666255">[</span><span class="num" id="3666256">2</span><span class="op" id="3666257">]</span><span class="op" id="3666258">,</span>&nbsp;<span class="ident" id="3666260"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666263">[</span><span class="num" id="3666264">3</span><span class="op" id="3666265">]</span>&nbsp;<span class="op" id="3666267">=</span>&nbsp;<span class="builtintype" id="3666269">byte</span><span class="op" id="3666273">(</span><span class="ident" id="3666274"><a href="/crypto/aes/block.go.html#3664545">s0</a></span><span class="op" id="3666276">&gt;&gt;</span><span class="num" id="3666278">24</span><span class="op" id="3666280">)</span><span class="op" id="3666281">,</span>&nbsp;<span class="builtintype" id="3666283">byte</span><span class="op" id="3666287">(</span><span class="ident" id="3666288"><a href="/crypto/aes/block.go.html#3664545">s0</a></span><span class="op" id="3666290">&gt;&gt;</span><span class="num" id="3666292">16</span><span class="op" id="3666294">)</span><span class="op" id="3666295">,</span>&nbsp;<span class="builtintype" id="3666297">byte</span><span class="op" id="3666301">(</span><span class="ident" id="3666302"><a href="/crypto/aes/block.go.html#3664545">s0</a></span><span class="op" id="3666304">&gt;&gt;</span><span class="num" id="3666306">8</span><span class="op" id="3666307">)</span><span class="op" id="3666308">,</span>&nbsp;<span class="builtintype" id="3666310">byte</span><span class="op" id="3666314">(</span><span class="ident" id="3666315"><a href="/crypto/aes/block.go.html#3664545">s0</a></span><span class="op" id="3666317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666320"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666323">[</span><span class="num" id="3666324">4</span><span class="op" id="3666325">]</span><span class="op" id="3666326">,</span>&nbsp;<span class="ident" id="3666328"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666331">[</span><span class="num" id="3666332">5</span><span class="op" id="3666333">]</span><span class="op" id="3666334">,</span>&nbsp;<span class="ident" id="3666336"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666339">[</span><span class="num" id="3666340">6</span><span class="op" id="3666341">]</span><span class="op" id="3666342">,</span>&nbsp;<span class="ident" id="3666344"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666347">[</span><span class="num" id="3666348">7</span><span class="op" id="3666349">]</span>&nbsp;<span class="op" id="3666351">=</span>&nbsp;<span class="builtintype" id="3666353">byte</span><span class="op" id="3666357">(</span><span class="ident" id="3666358"><a href="/crypto/aes/block.go.html#3664549">s1</a></span><span class="op" id="3666360">&gt;&gt;</span><span class="num" id="3666362">24</span><span class="op" id="3666364">)</span><span class="op" id="3666365">,</span>&nbsp;<span class="builtintype" id="3666367">byte</span><span class="op" id="3666371">(</span><span class="ident" id="3666372"><a href="/crypto/aes/block.go.html#3664549">s1</a></span><span class="op" id="3666374">&gt;&gt;</span><span class="num" id="3666376">16</span><span class="op" id="3666378">)</span><span class="op" id="3666379">,</span>&nbsp;<span class="builtintype" id="3666381">byte</span><span class="op" id="3666385">(</span><span class="ident" id="3666386"><a href="/crypto/aes/block.go.html#3664549">s1</a></span><span class="op" id="3666388">&gt;&gt;</span><span class="num" id="3666390">8</span><span class="op" id="3666391">)</span><span class="op" id="3666392">,</span>&nbsp;<span class="builtintype" id="3666394">byte</span><span class="op" id="3666398">(</span><span class="ident" id="3666399"><a href="/crypto/aes/block.go.html#3664549">s1</a></span><span class="op" id="3666401">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666404"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666407">[</span><span class="num" id="3666408">8</span><span class="op" id="3666409">]</span><span class="op" id="3666410">,</span>&nbsp;<span class="ident" id="3666412"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666415">[</span><span class="num" id="3666416">9</span><span class="op" id="3666417">]</span><span class="op" id="3666418">,</span>&nbsp;<span class="ident" id="3666420"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666423">[</span><span class="num" id="3666424">10</span><span class="op" id="3666426">]</span><span class="op" id="3666427">,</span>&nbsp;<span class="ident" id="3666429"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666432">[</span><span class="num" id="3666433">11</span><span class="op" id="3666435">]</span>&nbsp;<span class="op" id="3666437">=</span>&nbsp;<span class="builtintype" id="3666439">byte</span><span class="op" id="3666443">(</span><span class="ident" id="3666444"><a href="/crypto/aes/block.go.html#3664553">s2</a></span><span class="op" id="3666446">&gt;&gt;</span><span class="num" id="3666448">24</span><span class="op" id="3666450">)</span><span class="op" id="3666451">,</span>&nbsp;<span class="builtintype" id="3666453">byte</span><span class="op" id="3666457">(</span><span class="ident" id="3666458"><a href="/crypto/aes/block.go.html#3664553">s2</a></span><span class="op" id="3666460">&gt;&gt;</span><span class="num" id="3666462">16</span><span class="op" id="3666464">)</span><span class="op" id="3666465">,</span>&nbsp;<span class="builtintype" id="3666467">byte</span><span class="op" id="3666471">(</span><span class="ident" id="3666472"><a href="/crypto/aes/block.go.html#3664553">s2</a></span><span class="op" id="3666474">&gt;&gt;</span><span class="num" id="3666476">8</span><span class="op" id="3666477">)</span><span class="op" id="3666478">,</span>&nbsp;<span class="builtintype" id="3666480">byte</span><span class="op" id="3666484">(</span><span class="ident" id="3666485"><a href="/crypto/aes/block.go.html#3664553">s2</a></span><span class="op" id="3666487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666490"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666493">[</span><span class="num" id="3666494">12</span><span class="op" id="3666496">]</span><span class="op" id="3666497">,</span>&nbsp;<span class="ident" id="3666499"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666502">[</span><span class="num" id="3666503">13</span><span class="op" id="3666505">]</span><span class="op" id="3666506">,</span>&nbsp;<span class="ident" id="3666508"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666511">[</span><span class="num" id="3666512">14</span><span class="op" id="3666514">]</span><span class="op" id="3666515">,</span>&nbsp;<span class="ident" id="3666517"><a href="/crypto/aes/block.go.html#3664521">dst</a></span><span class="op" id="3666520">[</span><span class="num" id="3666521">15</span><span class="op" id="3666523">]</span>&nbsp;<span class="op" id="3666525">=</span>&nbsp;<span class="builtintype" id="3666527">byte</span><span class="op" id="3666531">(</span><span class="ident" id="3666532"><a href="/crypto/aes/block.go.html#3664557">s3</a></span><span class="op" id="3666534">&gt;&gt;</span><span class="num" id="3666536">24</span><span class="op" id="3666538">)</span><span class="op" id="3666539">,</span>&nbsp;<span class="builtintype" id="3666541">byte</span><span class="op" id="3666545">(</span><span class="ident" id="3666546"><a href="/crypto/aes/block.go.html#3664557">s3</a></span><span class="op" id="3666548">&gt;&gt;</span><span class="num" id="3666550">16</span><span class="op" id="3666552">)</span><span class="op" id="3666553">,</span>&nbsp;<span class="builtintype" id="3666555">byte</span><span class="op" id="3666559">(</span><span class="ident" id="3666560"><a href="/crypto/aes/block.go.html#3664557">s3</a></span><span class="op" id="3666562">&gt;&gt;</span><span class="num" id="3666564">8</span><span class="op" id="3666565">)</span><span class="op" id="3666566">,</span>&nbsp;<span class="builtintype" id="3666568">byte</span><span class="op" id="3666572">(</span><span class="ident" id="3666573"><a href="/crypto/aes/block.go.html#3664557">s3</a></span><span class="op" id="3666575">)</span><br>
<span class="lineno"></span><span class="op" id="3666577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3666580">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;expanded&nbsp;key&nbsp;xk.</span><br>
<span class="lineno">85</span><span class="keyword" id="3666647">func</span>&nbsp;<span class="ident" id="3666652">decryptBlockGo</span><span class="op" id="3666666">(</span><span class="ident" id="3666667">xk</span>&nbsp;<span class="op" id="3666670">[</span><span class="op" id="3666671">]</span><span class="builtintype" id="3666672">uint32</span><span class="op" id="3666678">,</span>&nbsp;<span class="ident" id="3666680">dst</span><span class="op" id="3666683">,</span>&nbsp;<span class="ident" id="3666685">src</span>&nbsp;<span class="op" id="3666689">[</span><span class="op" id="3666690">]</span><span class="builtintype" id="3666691">byte</span><span class="op" id="3666695">)</span>&nbsp;<span class="op" id="3666697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3666700">var</span>&nbsp;<span class="ident" id="3666704">s0</span><span class="op" id="3666706">,</span>&nbsp;<span class="ident" id="3666708">s1</span><span class="op" id="3666710">,</span>&nbsp;<span class="ident" id="3666712">s2</span><span class="op" id="3666714">,</span>&nbsp;<span class="ident" id="3666716">s3</span><span class="op" id="3666718">,</span>&nbsp;<span class="ident" id="3666720">t0</span><span class="op" id="3666722">,</span>&nbsp;<span class="ident" id="3666724">t1</span><span class="op" id="3666726">,</span>&nbsp;<span class="ident" id="3666728">t2</span><span class="op" id="3666730">,</span>&nbsp;<span class="ident" id="3666732">t3</span>&nbsp;<span class="builtintype" id="3666735">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666744"><a href="/crypto/aes/block.go.html#3666704">s0</a></span>&nbsp;<span class="op" id="3666747">=</span>&nbsp;<span class="builtintype" id="3666749">uint32</span><span class="op" id="3666755">(</span><span class="ident" id="3666756"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3666759">[</span><span class="num" id="3666760">0</span><span class="op" id="3666761">]</span><span class="op" id="3666762">)</span><span class="op" id="3666763">&lt;&lt;</span><span class="num" id="3666765">24</span>&nbsp;<span class="op" id="3666768">|</span>&nbsp;<span class="builtintype" id="3666770">uint32</span><span class="op" id="3666776">(</span><span class="ident" id="3666777"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3666780">[</span><span class="num" id="3666781">1</span><span class="op" id="3666782">]</span><span class="op" id="3666783">)</span><span class="op" id="3666784">&lt;&lt;</span><span class="num" id="3666786">16</span>&nbsp;<span class="op" id="3666789">|</span>&nbsp;<span class="builtintype" id="3666791">uint32</span><span class="op" id="3666797">(</span><span class="ident" id="3666798"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3666801">[</span><span class="num" id="3666802">2</span><span class="op" id="3666803">]</span><span class="op" id="3666804">)</span><span class="op" id="3666805">&lt;&lt;</span><span class="num" id="3666807">8</span>&nbsp;<span class="op" id="3666809">|</span>&nbsp;<span class="builtintype" id="3666811">uint32</span><span class="op" id="3666817">(</span><span class="ident" id="3666818"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3666821">[</span><span class="num" id="3666822">3</span><span class="op" id="3666823">]</span><span class="op" id="3666824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666827"><a href="/crypto/aes/block.go.html#3666708">s1</a></span>&nbsp;<span class="op" id="3666830">=</span>&nbsp;<span class="builtintype" id="3666832">uint32</span><span class="op" id="3666838">(</span><span class="ident" id="3666839"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3666842">[</span><span class="num" id="3666843">4</span><span class="op" id="3666844">]</span><span class="op" id="3666845">)</span><span class="op" id="3666846">&lt;&lt;</span><span class="num" id="3666848">24</span>&nbsp;<span class="op" id="3666851">|</span>&nbsp;<span class="builtintype" id="3666853">uint32</span><span class="op" id="3666859">(</span><span class="ident" id="3666860"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3666863">[</span><span class="num" id="3666864">5</span><span class="op" id="3666865">]</span><span class="op" id="3666866">)</span><span class="op" id="3666867">&lt;&lt;</span><span class="num" id="3666869">16</span>&nbsp;<span class="op" id="3666872">|</span>&nbsp;<span class="builtintype" id="3666874">uint32</span><span class="op" id="3666880">(</span><span class="ident" id="3666881"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3666884">[</span><span class="num" id="3666885">6</span><span class="op" id="3666886">]</span><span class="op" id="3666887">)</span><span class="op" id="3666888">&lt;&lt;</span><span class="num" id="3666890">8</span>&nbsp;<span class="op" id="3666892">|</span>&nbsp;<span class="builtintype" id="3666894">uint32</span><span class="op" id="3666900">(</span><span class="ident" id="3666901"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3666904">[</span><span class="num" id="3666905">7</span><span class="op" id="3666906">]</span><span class="op" id="3666907">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666910"><a href="/crypto/aes/block.go.html#3666712">s2</a></span>&nbsp;<span class="op" id="3666913">=</span>&nbsp;<span class="builtintype" id="3666915">uint32</span><span class="op" id="3666921">(</span><span class="ident" id="3666922"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3666925">[</span><span class="num" id="3666926">8</span><span class="op" id="3666927">]</span><span class="op" id="3666928">)</span><span class="op" id="3666929">&lt;&lt;</span><span class="num" id="3666931">24</span>&nbsp;<span class="op" id="3666934">|</span>&nbsp;<span class="builtintype" id="3666936">uint32</span><span class="op" id="3666942">(</span><span class="ident" id="3666943"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3666946">[</span><span class="num" id="3666947">9</span><span class="op" id="3666948">]</span><span class="op" id="3666949">)</span><span class="op" id="3666950">&lt;&lt;</span><span class="num" id="3666952">16</span>&nbsp;<span class="op" id="3666955">|</span>&nbsp;<span class="builtintype" id="3666957">uint32</span><span class="op" id="3666963">(</span><span class="ident" id="3666964"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3666967">[</span><span class="num" id="3666968">10</span><span class="op" id="3666970">]</span><span class="op" id="3666971">)</span><span class="op" id="3666972">&lt;&lt;</span><span class="num" id="3666974">8</span>&nbsp;<span class="op" id="3666976">|</span>&nbsp;<span class="builtintype" id="3666978">uint32</span><span class="op" id="3666984">(</span><span class="ident" id="3666985"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3666988">[</span><span class="num" id="3666989">11</span><span class="op" id="3666991">]</span><span class="op" id="3666992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3666995"><a href="/crypto/aes/block.go.html#3666716">s3</a></span>&nbsp;<span class="op" id="3666998">=</span>&nbsp;<span class="builtintype" id="3667000">uint32</span><span class="op" id="3667006">(</span><span class="ident" id="3667007"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3667010">[</span><span class="num" id="3667011">12</span><span class="op" id="3667013">]</span><span class="op" id="3667014">)</span><span class="op" id="3667015">&lt;&lt;</span><span class="num" id="3667017">24</span>&nbsp;<span class="op" id="3667020">|</span>&nbsp;<span class="builtintype" id="3667022">uint32</span><span class="op" id="3667028">(</span><span class="ident" id="3667029"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3667032">[</span><span class="num" id="3667033">13</span><span class="op" id="3667035">]</span><span class="op" id="3667036">)</span><span class="op" id="3667037">&lt;&lt;</span><span class="num" id="3667039">16</span>&nbsp;<span class="op" id="3667042">|</span>&nbsp;<span class="builtintype" id="3667044">uint32</span><span class="op" id="3667050">(</span><span class="ident" id="3667051"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3667054">[</span><span class="num" id="3667055">14</span><span class="op" id="3667057">]</span><span class="op" id="3667058">)</span><span class="op" id="3667059">&lt;&lt;</span><span class="num" id="3667061">8</span>&nbsp;<span class="op" id="3667063">|</span>&nbsp;<span class="builtintype" id="3667065">uint32</span><span class="op" id="3667071">(</span><span class="ident" id="3667072"><a href="/crypto/aes/block.go.html#3666685">src</a></span><span class="op" id="3667075">[</span><span class="num" id="3667076">15</span><span class="op" id="3667078">]</span><span class="op" id="3667079">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3667083">//&nbsp;First&nbsp;round&nbsp;just&nbsp;XORs&nbsp;input&nbsp;with&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667125"><a href="/crypto/aes/block.go.html#3666704">s0</a></span>&nbsp;<span class="op" id="3667128">^=</span>&nbsp;<span class="ident" id="3667131"><a href="/crypto/aes/block.go.html#3666667">xk</a></span><span class="op" id="3667133">[</span><span class="num" id="3667134">0</span><span class="op" id="3667135">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667138"><a href="/crypto/aes/block.go.html#3666708">s1</a></span>&nbsp;<span class="op" id="3667141">^=</span>&nbsp;<span class="ident" id="3667144"><a href="/crypto/aes/block.go.html#3666667">xk</a></span><span class="op" id="3667146">[</span><span class="num" id="3667147">1</span><span class="op" id="3667148">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667151"><a href="/crypto/aes/block.go.html#3666712">s2</a></span>&nbsp;<span class="op" id="3667154">^=</span>&nbsp;<span class="ident" id="3667157"><a href="/crypto/aes/block.go.html#3666667">xk</a></span><span class="op" id="3667159">[</span><span class="num" id="3667160">2</span><span class="op" id="3667161">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667164"><a href="/crypto/aes/block.go.html#3666716">s3</a></span>&nbsp;<span class="op" id="3667167">^=</span>&nbsp;<span class="ident" id="3667170"><a href="/crypto/aes/block.go.html#3666667">xk</a></span><span class="op" id="3667172">[</span><span class="num" id="3667173">3</span><span class="op" id="3667174">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3667178">//&nbsp;Middle&nbsp;rounds&nbsp;shuffle&nbsp;using&nbsp;tables.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3667218">//&nbsp;Number&nbsp;of&nbsp;rounds&nbsp;is&nbsp;set&nbsp;by&nbsp;length&nbsp;of&nbsp;expanded&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667273">nr</span>&nbsp;<span class="op" id="3667276">:=</span>&nbsp;<span class="builtinfunc" id="3667279">len</span><span class="op" id="3667282">(</span><span class="ident" id="3667283"><a href="/crypto/aes/block.go.html#3666667">xk</a></span><span class="op" id="3667285">)</span><span class="op" id="3667286">/</span><span class="num" id="3667287">4</span>&nbsp;<span class="op" id="3667289">-</span>&nbsp;<span class="num" id="3667291">2</span>&nbsp;<span class="comment" id="3667293">//&nbsp;-&nbsp;2:&nbsp;one&nbsp;above,&nbsp;one&nbsp;more&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667328">k</span>&nbsp;<span class="op" id="3667330">:=</span>&nbsp;<span class="num" id="3667333">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3667336">for</span>&nbsp;<span class="ident" id="3667340">r</span>&nbsp;<span class="op" id="3667342">:=</span>&nbsp;<span class="num" id="3667345">0</span><span class="op" id="3667346">;</span>&nbsp;<span class="ident" id="3667348"><a href="/crypto/aes/block.go.html#3667340">r</a></span>&nbsp;<span class="op" id="3667350">&lt;</span>&nbsp;<span class="ident" id="3667352"><a href="/crypto/aes/block.go.html#3667273">nr</a></span><span class="op" id="3667354">;</span>&nbsp;<span class="ident" id="3667356"><a href="/crypto/aes/block.go.html#3667340">r</a></span><span class="op" id="3667357">++</span>&nbsp;<span class="op" id="3667360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667364"><a href="/crypto/aes/block.go.html#3666720">t0</a></span>&nbsp;<span class="op" id="3667367">=</span>&nbsp;<span class="ident" id="3667369"><a href="/crypto/aes/block.go.html#3666667">xk</a></span><span class="op" id="3667371">[</span><span class="ident" id="3667372"><a href="/crypto/aes/block.go.html#3667328">k</a></span><span class="op" id="3667373">+</span><span class="num" id="3667374">0</span><span class="op" id="3667375">]</span>&nbsp;<span class="op" id="3667377">^</span>&nbsp;<span class="ident" id="3667379"><a href="/crypto/aes/const.go.html#3689562">td0</a></span><span class="op" id="3667382">[</span><span class="builtintype" id="3667383">uint8</span><span class="op" id="3667388">(</span><span class="ident" id="3667389"><a href="/crypto/aes/block.go.html#3666704">s0</a></span><span class="op" id="3667391">&gt;&gt;</span><span class="num" id="3667393">24</span><span class="op" id="3667395">)</span><span class="op" id="3667396">]</span>&nbsp;<span class="op" id="3667398">^</span>&nbsp;<span class="ident" id="3667400"><a href="/crypto/aes/const.go.html#3692691">td1</a></span><span class="op" id="3667403">[</span><span class="builtintype" id="3667404">uint8</span><span class="op" id="3667409">(</span><span class="ident" id="3667410"><a href="/crypto/aes/block.go.html#3666716">s3</a></span><span class="op" id="3667412">&gt;&gt;</span><span class="num" id="3667414">16</span><span class="op" id="3667416">)</span><span class="op" id="3667417">]</span>&nbsp;<span class="op" id="3667419">^</span>&nbsp;<span class="ident" id="3667421"><a href="/crypto/aes/const.go.html#3695820">td2</a></span><span class="op" id="3667424">[</span><span class="builtintype" id="3667425">uint8</span><span class="op" id="3667430">(</span><span class="ident" id="3667431"><a href="/crypto/aes/block.go.html#3666712">s2</a></span><span class="op" id="3667433">&gt;&gt;</span><span class="num" id="3667435">8</span><span class="op" id="3667436">)</span><span class="op" id="3667437">]</span>&nbsp;<span class="op" id="3667439">^</span>&nbsp;<span class="ident" id="3667441"><a href="/crypto/aes/const.go.html#3698949">td3</a></span><span class="op" id="3667444">[</span><span class="builtintype" id="3667445">uint8</span><span class="op" id="3667450">(</span><span class="ident" id="3667451"><a href="/crypto/aes/block.go.html#3666708">s1</a></span><span class="op" id="3667453">)</span><span class="op" id="3667454">]</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667458"><a href="/crypto/aes/block.go.html#3666724">t1</a></span>&nbsp;<span class="op" id="3667461">=</span>&nbsp;<span class="ident" id="3667463"><a href="/crypto/aes/block.go.html#3666667">xk</a></span><span class="op" id="3667465">[</span><span class="ident" id="3667466"><a href="/crypto/aes/block.go.html#3667328">k</a></span><span class="op" id="3667467">+</span><span class="num" id="3667468">1</span><span class="op" id="3667469">]</span>&nbsp;<span class="op" id="3667471">^</span>&nbsp;<span class="ident" id="3667473"><a href="/crypto/aes/const.go.html#3689562">td0</a></span><span class="op" id="3667476">[</span><span class="builtintype" id="3667477">uint8</span><span class="op" id="3667482">(</span><span class="ident" id="3667483"><a href="/crypto/aes/block.go.html#3666708">s1</a></span><span class="op" id="3667485">&gt;&gt;</span><span class="num" id="3667487">24</span><span class="op" id="3667489">)</span><span class="op" id="3667490">]</span>&nbsp;<span class="op" id="3667492">^</span>&nbsp;<span class="ident" id="3667494"><a href="/crypto/aes/const.go.html#3692691">td1</a></span><span class="op" id="3667497">[</span><span class="builtintype" id="3667498">uint8</span><span class="op" id="3667503">(</span><span class="ident" id="3667504"><a href="/crypto/aes/block.go.html#3666704">s0</a></span><span class="op" id="3667506">&gt;&gt;</span><span class="num" id="3667508">16</span><span class="op" id="3667510">)</span><span class="op" id="3667511">]</span>&nbsp;<span class="op" id="3667513">^</span>&nbsp;<span class="ident" id="3667515"><a href="/crypto/aes/const.go.html#3695820">td2</a></span><span class="op" id="3667518">[</span><span class="builtintype" id="3667519">uint8</span><span class="op" id="3667524">(</span><span class="ident" id="3667525"><a href="/crypto/aes/block.go.html#3666716">s3</a></span><span class="op" id="3667527">&gt;&gt;</span><span class="num" id="3667529">8</span><span class="op" id="3667530">)</span><span class="op" id="3667531">]</span>&nbsp;<span class="op" id="3667533">^</span>&nbsp;<span class="ident" id="3667535"><a href="/crypto/aes/const.go.html#3698949">td3</a></span><span class="op" id="3667538">[</span><span class="builtintype" id="3667539">uint8</span><span class="op" id="3667544">(</span><span class="ident" id="3667545"><a href="/crypto/aes/block.go.html#3666712">s2</a></span><span class="op" id="3667547">)</span><span class="op" id="3667548">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667552"><a href="/crypto/aes/block.go.html#3666728">t2</a></span>&nbsp;<span class="op" id="3667555">=</span>&nbsp;<span class="ident" id="3667557"><a href="/crypto/aes/block.go.html#3666667">xk</a></span><span class="op" id="3667559">[</span><span class="ident" id="3667560"><a href="/crypto/aes/block.go.html#3667328">k</a></span><span class="op" id="3667561">+</span><span class="num" id="3667562">2</span><span class="op" id="3667563">]</span>&nbsp;<span class="op" id="3667565">^</span>&nbsp;<span class="ident" id="3667567"><a href="/crypto/aes/const.go.html#3689562">td0</a></span><span class="op" id="3667570">[</span><span class="builtintype" id="3667571">uint8</span><span class="op" id="3667576">(</span><span class="ident" id="3667577"><a href="/crypto/aes/block.go.html#3666712">s2</a></span><span class="op" id="3667579">&gt;&gt;</span><span class="num" id="3667581">24</span><span class="op" id="3667583">)</span><span class="op" id="3667584">]</span>&nbsp;<span class="op" id="3667586">^</span>&nbsp;<span class="ident" id="3667588"><a href="/crypto/aes/const.go.html#3692691">td1</a></span><span class="op" id="3667591">[</span><span class="builtintype" id="3667592">uint8</span><span class="op" id="3667597">(</span><span class="ident" id="3667598"><a href="/crypto/aes/block.go.html#3666708">s1</a></span><span class="op" id="3667600">&gt;&gt;</span><span class="num" id="3667602">16</span><span class="op" id="3667604">)</span><span class="op" id="3667605">]</span>&nbsp;<span class="op" id="3667607">^</span>&nbsp;<span class="ident" id="3667609"><a href="/crypto/aes/const.go.html#3695820">td2</a></span><span class="op" id="3667612">[</span><span class="builtintype" id="3667613">uint8</span><span class="op" id="3667618">(</span><span class="ident" id="3667619"><a href="/crypto/aes/block.go.html#3666704">s0</a></span><span class="op" id="3667621">&gt;&gt;</span><span class="num" id="3667623">8</span><span class="op" id="3667624">)</span><span class="op" id="3667625">]</span>&nbsp;<span class="op" id="3667627">^</span>&nbsp;<span class="ident" id="3667629"><a href="/crypto/aes/const.go.html#3698949">td3</a></span><span class="op" id="3667632">[</span><span class="builtintype" id="3667633">uint8</span><span class="op" id="3667638">(</span><span class="ident" id="3667639"><a href="/crypto/aes/block.go.html#3666716">s3</a></span><span class="op" id="3667641">)</span><span class="op" id="3667642">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667646"><a href="/crypto/aes/block.go.html#3666732">t3</a></span>&nbsp;<span class="op" id="3667649">=</span>&nbsp;<span class="ident" id="3667651"><a href="/crypto/aes/block.go.html#3666667">xk</a></span><span class="op" id="3667653">[</span><span class="ident" id="3667654"><a href="/crypto/aes/block.go.html#3667328">k</a></span><span class="op" id="3667655">+</span><span class="num" id="3667656">3</span><span class="op" id="3667657">]</span>&nbsp;<span class="op" id="3667659">^</span>&nbsp;<span class="ident" id="3667661"><a href="/crypto/aes/const.go.html#3689562">td0</a></span><span class="op" id="3667664">[</span><span class="builtintype" id="3667665">uint8</span><span class="op" id="3667670">(</span><span class="ident" id="3667671"><a href="/crypto/aes/block.go.html#3666716">s3</a></span><span class="op" id="3667673">&gt;&gt;</span><span class="num" id="3667675">24</span><span class="op" id="3667677">)</span><span class="op" id="3667678">]</span>&nbsp;<span class="op" id="3667680">^</span>&nbsp;<span class="ident" id="3667682"><a href="/crypto/aes/const.go.html#3692691">td1</a></span><span class="op" id="3667685">[</span><span class="builtintype" id="3667686">uint8</span><span class="op" id="3667691">(</span><span class="ident" id="3667692"><a href="/crypto/aes/block.go.html#3666712">s2</a></span><span class="op" id="3667694">&gt;&gt;</span><span class="num" id="3667696">16</span><span class="op" id="3667698">)</span><span class="op" id="3667699">]</span>&nbsp;<span class="op" id="3667701">^</span>&nbsp;<span class="ident" id="3667703"><a href="/crypto/aes/const.go.html#3695820">td2</a></span><span class="op" id="3667706">[</span><span class="builtintype" id="3667707">uint8</span><span class="op" id="3667712">(</span><span class="ident" id="3667713"><a href="/crypto/aes/block.go.html#3666708">s1</a></span><span class="op" id="3667715">&gt;&gt;</span><span class="num" id="3667717">8</span><span class="op" id="3667718">)</span><span class="op" id="3667719">]</span>&nbsp;<span class="op" id="3667721">^</span>&nbsp;<span class="ident" id="3667723"><a href="/crypto/aes/const.go.html#3698949">td3</a></span><span class="op" id="3667726">[</span><span class="builtintype" id="3667727">uint8</span><span class="op" id="3667732">(</span><span class="ident" id="3667733"><a href="/crypto/aes/block.go.html#3666704">s0</a></span><span class="op" id="3667735">)</span><span class="op" id="3667736">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667740"><a href="/crypto/aes/block.go.html#3667328">k</a></span>&nbsp;<span class="op" id="3667742">+=</span>&nbsp;<span class="num" id="3667745">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667749"><a href="/crypto/aes/block.go.html#3666704">s0</a></span><span class="op" id="3667751">,</span>&nbsp;<span class="ident" id="3667753"><a href="/crypto/aes/block.go.html#3666708">s1</a></span><span class="op" id="3667755">,</span>&nbsp;<span class="ident" id="3667757"><a href="/crypto/aes/block.go.html#3666712">s2</a></span><span class="op" id="3667759">,</span>&nbsp;<span class="ident" id="3667761"><a href="/crypto/aes/block.go.html#3666716">s3</a></span>&nbsp;<span class="op" id="3667764">=</span>&nbsp;<span class="ident" id="3667766"><a href="/crypto/aes/block.go.html#3666720">t0</a></span><span class="op" id="3667768">,</span>&nbsp;<span class="ident" id="3667770"><a href="/crypto/aes/block.go.html#3666724">t1</a></span><span class="op" id="3667772">,</span>&nbsp;<span class="ident" id="3667774"><a href="/crypto/aes/block.go.html#3666728">t2</a></span><span class="op" id="3667776">,</span>&nbsp;<span class="ident" id="3667778"><a href="/crypto/aes/block.go.html#3666732">t3</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3667782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3667786">//&nbsp;Last&nbsp;round&nbsp;uses&nbsp;s-box&nbsp;directly&nbsp;and&nbsp;XORs&nbsp;to&nbsp;produce&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667849"><a href="/crypto/aes/block.go.html#3666704">s0</a></span>&nbsp;<span class="op" id="3667852">=</span>&nbsp;<span class="builtintype" id="3667854">uint32</span><span class="op" id="3667860">(</span><span class="ident" id="3667861"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3667866">[</span><span class="ident" id="3667867"><a href="/crypto/aes/block.go.html#3666720">t0</a></span><span class="op" id="3667869">&gt;&gt;</span><span class="num" id="3667871">24</span><span class="op" id="3667873">]</span><span class="op" id="3667874">)</span><span class="op" id="3667875">&lt;&lt;</span><span class="num" id="3667877">24</span>&nbsp;<span class="op" id="3667880">|</span>&nbsp;<span class="builtintype" id="3667882">uint32</span><span class="op" id="3667888">(</span><span class="ident" id="3667889"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3667894">[</span><span class="ident" id="3667895"><a href="/crypto/aes/block.go.html#3666732">t3</a></span><span class="op" id="3667897">&gt;&gt;</span><span class="num" id="3667899">16</span><span class="op" id="3667901">&amp;</span><span class="num" id="3667902">0xff</span><span class="op" id="3667906">]</span><span class="op" id="3667907">)</span><span class="op" id="3667908">&lt;&lt;</span><span class="num" id="3667910">16</span>&nbsp;<span class="op" id="3667913">|</span>&nbsp;<span class="builtintype" id="3667915">uint32</span><span class="op" id="3667921">(</span><span class="ident" id="3667922"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3667927">[</span><span class="ident" id="3667928"><a href="/crypto/aes/block.go.html#3666728">t2</a></span><span class="op" id="3667930">&gt;&gt;</span><span class="num" id="3667932">8</span><span class="op" id="3667933">&amp;</span><span class="num" id="3667934">0xff</span><span class="op" id="3667938">]</span><span class="op" id="3667939">)</span><span class="op" id="3667940">&lt;&lt;</span><span class="num" id="3667942">8</span>&nbsp;<span class="op" id="3667944">|</span>&nbsp;<span class="builtintype" id="3667946">uint32</span><span class="op" id="3667952">(</span><span class="ident" id="3667953"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3667958">[</span><span class="ident" id="3667959"><a href="/crypto/aes/block.go.html#3666724">t1</a></span><span class="op" id="3667961">&amp;</span><span class="num" id="3667962">0xff</span><span class="op" id="3667966">]</span><span class="op" id="3667967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3667970"><a href="/crypto/aes/block.go.html#3666708">s1</a></span>&nbsp;<span class="op" id="3667973">=</span>&nbsp;<span class="builtintype" id="3667975">uint32</span><span class="op" id="3667981">(</span><span class="ident" id="3667982"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3667987">[</span><span class="ident" id="3667988"><a href="/crypto/aes/block.go.html#3666724">t1</a></span><span class="op" id="3667990">&gt;&gt;</span><span class="num" id="3667992">24</span><span class="op" id="3667994">]</span><span class="op" id="3667995">)</span><span class="op" id="3667996">&lt;&lt;</span><span class="num" id="3667998">24</span>&nbsp;<span class="op" id="3668001">|</span>&nbsp;<span class="builtintype" id="3668003">uint32</span><span class="op" id="3668009">(</span><span class="ident" id="3668010"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3668015">[</span><span class="ident" id="3668016"><a href="/crypto/aes/block.go.html#3666720">t0</a></span><span class="op" id="3668018">&gt;&gt;</span><span class="num" id="3668020">16</span><span class="op" id="3668022">&amp;</span><span class="num" id="3668023">0xff</span><span class="op" id="3668027">]</span><span class="op" id="3668028">)</span><span class="op" id="3668029">&lt;&lt;</span><span class="num" id="3668031">16</span>&nbsp;<span class="op" id="3668034">|</span>&nbsp;<span class="builtintype" id="3668036">uint32</span><span class="op" id="3668042">(</span><span class="ident" id="3668043"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3668048">[</span><span class="ident" id="3668049"><a href="/crypto/aes/block.go.html#3666732">t3</a></span><span class="op" id="3668051">&gt;&gt;</span><span class="num" id="3668053">8</span><span class="op" id="3668054">&amp;</span><span class="num" id="3668055">0xff</span><span class="op" id="3668059">]</span><span class="op" id="3668060">)</span><span class="op" id="3668061">&lt;&lt;</span><span class="num" id="3668063">8</span>&nbsp;<span class="op" id="3668065">|</span>&nbsp;<span class="builtintype" id="3668067">uint32</span><span class="op" id="3668073">(</span><span class="ident" id="3668074"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3668079">[</span><span class="ident" id="3668080"><a href="/crypto/aes/block.go.html#3666728">t2</a></span><span class="op" id="3668082">&amp;</span><span class="num" id="3668083">0xff</span><span class="op" id="3668087">]</span><span class="op" id="3668088">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668091"><a href="/crypto/aes/block.go.html#3666712">s2</a></span>&nbsp;<span class="op" id="3668094">=</span>&nbsp;<span class="builtintype" id="3668096">uint32</span><span class="op" id="3668102">(</span><span class="ident" id="3668103"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3668108">[</span><span class="ident" id="3668109"><a href="/crypto/aes/block.go.html#3666728">t2</a></span><span class="op" id="3668111">&gt;&gt;</span><span class="num" id="3668113">24</span><span class="op" id="3668115">]</span><span class="op" id="3668116">)</span><span class="op" id="3668117">&lt;&lt;</span><span class="num" id="3668119">24</span>&nbsp;<span class="op" id="3668122">|</span>&nbsp;<span class="builtintype" id="3668124">uint32</span><span class="op" id="3668130">(</span><span class="ident" id="3668131"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3668136">[</span><span class="ident" id="3668137"><a href="/crypto/aes/block.go.html#3666724">t1</a></span><span class="op" id="3668139">&gt;&gt;</span><span class="num" id="3668141">16</span><span class="op" id="3668143">&amp;</span><span class="num" id="3668144">0xff</span><span class="op" id="3668148">]</span><span class="op" id="3668149">)</span><span class="op" id="3668150">&lt;&lt;</span><span class="num" id="3668152">16</span>&nbsp;<span class="op" id="3668155">|</span>&nbsp;<span class="builtintype" id="3668157">uint32</span><span class="op" id="3668163">(</span><span class="ident" id="3668164"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3668169">[</span><span class="ident" id="3668170"><a href="/crypto/aes/block.go.html#3666720">t0</a></span><span class="op" id="3668172">&gt;&gt;</span><span class="num" id="3668174">8</span><span class="op" id="3668175">&amp;</span><span class="num" id="3668176">0xff</span><span class="op" id="3668180">]</span><span class="op" id="3668181">)</span><span class="op" id="3668182">&lt;&lt;</span><span class="num" id="3668184">8</span>&nbsp;<span class="op" id="3668186">|</span>&nbsp;<span class="builtintype" id="3668188">uint32</span><span class="op" id="3668194">(</span><span class="ident" id="3668195"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3668200">[</span><span class="ident" id="3668201"><a href="/crypto/aes/block.go.html#3666732">t3</a></span><span class="op" id="3668203">&amp;</span><span class="num" id="3668204">0xff</span><span class="op" id="3668208">]</span><span class="op" id="3668209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668212"><a href="/crypto/aes/block.go.html#3666716">s3</a></span>&nbsp;<span class="op" id="3668215">=</span>&nbsp;<span class="builtintype" id="3668217">uint32</span><span class="op" id="3668223">(</span><span class="ident" id="3668224"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3668229">[</span><span class="ident" id="3668230"><a href="/crypto/aes/block.go.html#3666732">t3</a></span><span class="op" id="3668232">&gt;&gt;</span><span class="num" id="3668234">24</span><span class="op" id="3668236">]</span><span class="op" id="3668237">)</span><span class="op" id="3668238">&lt;&lt;</span><span class="num" id="3668240">24</span>&nbsp;<span class="op" id="3668243">|</span>&nbsp;<span class="builtintype" id="3668245">uint32</span><span class="op" id="3668251">(</span><span class="ident" id="3668252"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3668257">[</span><span class="ident" id="3668258"><a href="/crypto/aes/block.go.html#3666728">t2</a></span><span class="op" id="3668260">&gt;&gt;</span><span class="num" id="3668262">16</span><span class="op" id="3668264">&amp;</span><span class="num" id="3668265">0xff</span><span class="op" id="3668269">]</span><span class="op" id="3668270">)</span><span class="op" id="3668271">&lt;&lt;</span><span class="num" id="3668273">16</span>&nbsp;<span class="op" id="3668276">|</span>&nbsp;<span class="builtintype" id="3668278">uint32</span><span class="op" id="3668284">(</span><span class="ident" id="3668285"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3668290">[</span><span class="ident" id="3668291"><a href="/crypto/aes/block.go.html#3666724">t1</a></span><span class="op" id="3668293">&gt;&gt;</span><span class="num" id="3668295">8</span><span class="op" id="3668296">&amp;</span><span class="num" id="3668297">0xff</span><span class="op" id="3668301">]</span><span class="op" id="3668302">)</span><span class="op" id="3668303">&lt;&lt;</span><span class="num" id="3668305">8</span>&nbsp;<span class="op" id="3668307">|</span>&nbsp;<span class="builtintype" id="3668309">uint32</span><span class="op" id="3668315">(</span><span class="ident" id="3668316"><a href="/crypto/aes/const.go.html#3675269">sbox1</a></span><span class="op" id="3668321">[</span><span class="ident" id="3668322"><a href="/crypto/aes/block.go.html#3666720">t0</a></span><span class="op" id="3668324">&amp;</span><span class="num" id="3668325">0xff</span><span class="op" id="3668329">]</span><span class="op" id="3668330">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668334"><a href="/crypto/aes/block.go.html#3666704">s0</a></span>&nbsp;<span class="op" id="3668337">^=</span>&nbsp;<span class="ident" id="3668340"><a href="/crypto/aes/block.go.html#3666667">xk</a></span><span class="op" id="3668342">[</span><span class="ident" id="3668343"><a href="/crypto/aes/block.go.html#3667328">k</a></span><span class="op" id="3668344">+</span><span class="num" id="3668345">0</span><span class="op" id="3668346">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668349"><a href="/crypto/aes/block.go.html#3666708">s1</a></span>&nbsp;<span class="op" id="3668352">^=</span>&nbsp;<span class="ident" id="3668355"><a href="/crypto/aes/block.go.html#3666667">xk</a></span><span class="op" id="3668357">[</span><span class="ident" id="3668358"><a href="/crypto/aes/block.go.html#3667328">k</a></span><span class="op" id="3668359">+</span><span class="num" id="3668360">1</span><span class="op" id="3668361">]</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668364"><a href="/crypto/aes/block.go.html#3666712">s2</a></span>&nbsp;<span class="op" id="3668367">^=</span>&nbsp;<span class="ident" id="3668370"><a href="/crypto/aes/block.go.html#3666667">xk</a></span><span class="op" id="3668372">[</span><span class="ident" id="3668373"><a href="/crypto/aes/block.go.html#3667328">k</a></span><span class="op" id="3668374">+</span><span class="num" id="3668375">2</span><span class="op" id="3668376">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668379"><a href="/crypto/aes/block.go.html#3666716">s3</a></span>&nbsp;<span class="op" id="3668382">^=</span>&nbsp;<span class="ident" id="3668385"><a href="/crypto/aes/block.go.html#3666667">xk</a></span><span class="op" id="3668387">[</span><span class="ident" id="3668388"><a href="/crypto/aes/block.go.html#3667328">k</a></span><span class="op" id="3668389">+</span><span class="num" id="3668390">3</span><span class="op" id="3668391">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668395"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668398">[</span><span class="num" id="3668399">0</span><span class="op" id="3668400">]</span><span class="op" id="3668401">,</span>&nbsp;<span class="ident" id="3668403"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668406">[</span><span class="num" id="3668407">1</span><span class="op" id="3668408">]</span><span class="op" id="3668409">,</span>&nbsp;<span class="ident" id="3668411"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668414">[</span><span class="num" id="3668415">2</span><span class="op" id="3668416">]</span><span class="op" id="3668417">,</span>&nbsp;<span class="ident" id="3668419"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668422">[</span><span class="num" id="3668423">3</span><span class="op" id="3668424">]</span>&nbsp;<span class="op" id="3668426">=</span>&nbsp;<span class="builtintype" id="3668428">byte</span><span class="op" id="3668432">(</span><span class="ident" id="3668433"><a href="/crypto/aes/block.go.html#3666704">s0</a></span><span class="op" id="3668435">&gt;&gt;</span><span class="num" id="3668437">24</span><span class="op" id="3668439">)</span><span class="op" id="3668440">,</span>&nbsp;<span class="builtintype" id="3668442">byte</span><span class="op" id="3668446">(</span><span class="ident" id="3668447"><a href="/crypto/aes/block.go.html#3666704">s0</a></span><span class="op" id="3668449">&gt;&gt;</span><span class="num" id="3668451">16</span><span class="op" id="3668453">)</span><span class="op" id="3668454">,</span>&nbsp;<span class="builtintype" id="3668456">byte</span><span class="op" id="3668460">(</span><span class="ident" id="3668461"><a href="/crypto/aes/block.go.html#3666704">s0</a></span><span class="op" id="3668463">&gt;&gt;</span><span class="num" id="3668465">8</span><span class="op" id="3668466">)</span><span class="op" id="3668467">,</span>&nbsp;<span class="builtintype" id="3668469">byte</span><span class="op" id="3668473">(</span><span class="ident" id="3668474"><a href="/crypto/aes/block.go.html#3666704">s0</a></span><span class="op" id="3668476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668479"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668482">[</span><span class="num" id="3668483">4</span><span class="op" id="3668484">]</span><span class="op" id="3668485">,</span>&nbsp;<span class="ident" id="3668487"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668490">[</span><span class="num" id="3668491">5</span><span class="op" id="3668492">]</span><span class="op" id="3668493">,</span>&nbsp;<span class="ident" id="3668495"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668498">[</span><span class="num" id="3668499">6</span><span class="op" id="3668500">]</span><span class="op" id="3668501">,</span>&nbsp;<span class="ident" id="3668503"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668506">[</span><span class="num" id="3668507">7</span><span class="op" id="3668508">]</span>&nbsp;<span class="op" id="3668510">=</span>&nbsp;<span class="builtintype" id="3668512">byte</span><span class="op" id="3668516">(</span><span class="ident" id="3668517"><a href="/crypto/aes/block.go.html#3666708">s1</a></span><span class="op" id="3668519">&gt;&gt;</span><span class="num" id="3668521">24</span><span class="op" id="3668523">)</span><span class="op" id="3668524">,</span>&nbsp;<span class="builtintype" id="3668526">byte</span><span class="op" id="3668530">(</span><span class="ident" id="3668531"><a href="/crypto/aes/block.go.html#3666708">s1</a></span><span class="op" id="3668533">&gt;&gt;</span><span class="num" id="3668535">16</span><span class="op" id="3668537">)</span><span class="op" id="3668538">,</span>&nbsp;<span class="builtintype" id="3668540">byte</span><span class="op" id="3668544">(</span><span class="ident" id="3668545"><a href="/crypto/aes/block.go.html#3666708">s1</a></span><span class="op" id="3668547">&gt;&gt;</span><span class="num" id="3668549">8</span><span class="op" id="3668550">)</span><span class="op" id="3668551">,</span>&nbsp;<span class="builtintype" id="3668553">byte</span><span class="op" id="3668557">(</span><span class="ident" id="3668558"><a href="/crypto/aes/block.go.html#3666708">s1</a></span><span class="op" id="3668560">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668563"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668566">[</span><span class="num" id="3668567">8</span><span class="op" id="3668568">]</span><span class="op" id="3668569">,</span>&nbsp;<span class="ident" id="3668571"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668574">[</span><span class="num" id="3668575">9</span><span class="op" id="3668576">]</span><span class="op" id="3668577">,</span>&nbsp;<span class="ident" id="3668579"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668582">[</span><span class="num" id="3668583">10</span><span class="op" id="3668585">]</span><span class="op" id="3668586">,</span>&nbsp;<span class="ident" id="3668588"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668591">[</span><span class="num" id="3668592">11</span><span class="op" id="3668594">]</span>&nbsp;<span class="op" id="3668596">=</span>&nbsp;<span class="builtintype" id="3668598">byte</span><span class="op" id="3668602">(</span><span class="ident" id="3668603"><a href="/crypto/aes/block.go.html#3666712">s2</a></span><span class="op" id="3668605">&gt;&gt;</span><span class="num" id="3668607">24</span><span class="op" id="3668609">)</span><span class="op" id="3668610">,</span>&nbsp;<span class="builtintype" id="3668612">byte</span><span class="op" id="3668616">(</span><span class="ident" id="3668617"><a href="/crypto/aes/block.go.html#3666712">s2</a></span><span class="op" id="3668619">&gt;&gt;</span><span class="num" id="3668621">16</span><span class="op" id="3668623">)</span><span class="op" id="3668624">,</span>&nbsp;<span class="builtintype" id="3668626">byte</span><span class="op" id="3668630">(</span><span class="ident" id="3668631"><a href="/crypto/aes/block.go.html#3666712">s2</a></span><span class="op" id="3668633">&gt;&gt;</span><span class="num" id="3668635">8</span><span class="op" id="3668636">)</span><span class="op" id="3668637">,</span>&nbsp;<span class="builtintype" id="3668639">byte</span><span class="op" id="3668643">(</span><span class="ident" id="3668644"><a href="/crypto/aes/block.go.html#3666712">s2</a></span><span class="op" id="3668646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3668649"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668652">[</span><span class="num" id="3668653">12</span><span class="op" id="3668655">]</span><span class="op" id="3668656">,</span>&nbsp;<span class="ident" id="3668658"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668661">[</span><span class="num" id="3668662">13</span><span class="op" id="3668664">]</span><span class="op" id="3668665">,</span>&nbsp;<span class="ident" id="3668667"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668670">[</span><span class="num" id="3668671">14</span><span class="op" id="3668673">]</span><span class="op" id="3668674">,</span>&nbsp;<span class="ident" id="3668676"><a href="/crypto/aes/block.go.html#3666680">dst</a></span><span class="op" id="3668679">[</span><span class="num" id="3668680">15</span><span class="op" id="3668682">]</span>&nbsp;<span class="op" id="3668684">=</span>&nbsp;<span class="builtintype" id="3668686">byte</span><span class="op" id="3668690">(</span><span class="ident" id="3668691"><a href="/crypto/aes/block.go.html#3666716">s3</a></span><span class="op" id="3668693">&gt;&gt;</span><span class="num" id="3668695">24</span><span class="op" id="3668697">)</span><span class="op" id="3668698">,</span>&nbsp;<span class="builtintype" id="3668700">byte</span><span class="op" id="3668704">(</span><span class="ident" id="3668705"><a href="/crypto/aes/block.go.html#3666716">s3</a></span><span class="op" id="3668707">&gt;&gt;</span><span class="num" id="3668709">16</span><span class="op" id="3668711">)</span><span class="op" id="3668712">,</span>&nbsp;<span class="builtintype" id="3668714">byte</span><span class="op" id="3668718">(</span><span class="ident" id="3668719"><a href="/crypto/aes/block.go.html#3666716">s3</a></span><span class="op" id="3668721">&gt;&gt;</span><span class="num" id="3668723">8</span><span class="op" id="3668724">)</span><span class="op" id="3668725">,</span>&nbsp;<span class="builtintype" id="3668727">byte</span><span class="op" id="3668731">(</span><span class="ident" id="3668732"><a href="/crypto/aes/block.go.html#3666716">s3</a></span><span class="op" id="3668734">)</span><br>
<span class="lineno"></span><span class="op" id="3668736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3668739">//&nbsp;Apply&nbsp;sbox0&nbsp;to&nbsp;each&nbsp;byte&nbsp;in&nbsp;w.</span><br>
<span class="lineno">130</span><span class="keyword" id="3668773">func</span>&nbsp;<span class="ident" id="3668778">subw</span><span class="op" id="3668782">(</span><span class="ident" id="3668783">w</span>&nbsp;<span class="builtintype" id="3668785">uint32</span><span class="op" id="3668791">)</span>&nbsp;<span class="builtintype" id="3668793">uint32</span>&nbsp;<span class="op" id="3668800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3668803">return</span>&nbsp;<span class="builtintype" id="3668810">uint32</span><span class="op" id="3668816">(</span><span class="ident" id="3668817"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3668822">[</span><span class="ident" id="3668823"><a href="/crypto/aes/block.go.html#3668783">w</a></span><span class="op" id="3668824">&gt;&gt;</span><span class="num" id="3668826">24</span><span class="op" id="3668828">]</span><span class="op" id="3668829">)</span><span class="op" id="3668830">&lt;&lt;</span><span class="num" id="3668832">24</span>&nbsp;<span class="op" id="3668835">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3668839">uint32</span><span class="op" id="3668845">(</span><span class="ident" id="3668846"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3668851">[</span><span class="ident" id="3668852"><a href="/crypto/aes/block.go.html#3668783">w</a></span><span class="op" id="3668853">&gt;&gt;</span><span class="num" id="3668855">16</span><span class="op" id="3668857">&amp;</span><span class="num" id="3668858">0xff</span><span class="op" id="3668862">]</span><span class="op" id="3668863">)</span><span class="op" id="3668864">&lt;&lt;</span><span class="num" id="3668866">16</span>&nbsp;<span class="op" id="3668869">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3668873">uint32</span><span class="op" id="3668879">(</span><span class="ident" id="3668880"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3668885">[</span><span class="ident" id="3668886"><a href="/crypto/aes/block.go.html#3668783">w</a></span><span class="op" id="3668887">&gt;&gt;</span><span class="num" id="3668889">8</span><span class="op" id="3668890">&amp;</span><span class="num" id="3668891">0xff</span><span class="op" id="3668895">]</span><span class="op" id="3668896">)</span><span class="op" id="3668897">&lt;&lt;</span><span class="num" id="3668899">8</span>&nbsp;<span class="op" id="3668901">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3668905">uint32</span><span class="op" id="3668911">(</span><span class="ident" id="3668912"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3668917">[</span><span class="ident" id="3668918"><a href="/crypto/aes/block.go.html#3668783">w</a></span><span class="op" id="3668919">&amp;</span><span class="num" id="3668920">0xff</span><span class="op" id="3668924">]</span><span class="op" id="3668925">)</span><br>
<span class="lineno">135</span><span class="op" id="3668927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3668930">//&nbsp;Rotate</span><br>
<span class="lineno"></span><span class="keyword" id="3668940">func</span>&nbsp;<span class="ident" id="3668945">rotw</span><span class="op" id="3668949">(</span><span class="ident" id="3668950">w</span>&nbsp;<span class="builtintype" id="3668952">uint32</span><span class="op" id="3668958">)</span>&nbsp;<span class="builtintype" id="3668960">uint32</span>&nbsp;<span class="op" id="3668967">{</span>&nbsp;<span class="keyword" id="3668969">return</span>&nbsp;<span class="ident" id="3668976"><a href="/crypto/aes/block.go.html#3668950">w</a></span><span class="op" id="3668977">&lt;&lt;</span><span class="num" id="3668979">8</span>&nbsp;<span class="op" id="3668981">|</span>&nbsp;<span class="ident" id="3668983"><a href="/crypto/aes/block.go.html#3668950">w</a></span><span class="op" id="3668984">&gt;&gt;</span><span class="num" id="3668986">24</span>&nbsp;<span class="op" id="3668989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="3668992">//&nbsp;Key&nbsp;expansion&nbsp;algorithm.&nbsp;&nbsp;See&nbsp;FIPS-197,&nbsp;Figure&nbsp;11.</span><br>
<span class="lineno"></span><span class="comment" id="3669046">//&nbsp;Their&nbsp;rcon[i]&nbsp;is&nbsp;our&nbsp;powx[i-1]&nbsp;&lt;&lt;&nbsp;24.</span><br>
<span class="lineno"></span><span class="keyword" id="3669087">func</span>&nbsp;<span class="ident" id="3669092">expandKeyGo</span><span class="op" id="3669103">(</span><span class="ident" id="3669104">key</span>&nbsp;<span class="op" id="3669108">[</span><span class="op" id="3669109">]</span><span class="builtintype" id="3669110">byte</span><span class="op" id="3669114">,</span>&nbsp;<span class="ident" id="3669116">enc</span><span class="op" id="3669119">,</span>&nbsp;<span class="ident" id="3669121">dec</span>&nbsp;<span class="op" id="3669125">[</span><span class="op" id="3669126">]</span><span class="builtintype" id="3669127">uint32</span><span class="op" id="3669133">)</span>&nbsp;<span class="op" id="3669135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3669138">//&nbsp;Encryption&nbsp;key&nbsp;setup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669164">var</span>&nbsp;<span class="ident" id="3669168">i</span>&nbsp;<span class="builtintype" id="3669170">int</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669175">nk</span>&nbsp;<span class="op" id="3669178">:=</span>&nbsp;<span class="builtinfunc" id="3669181">len</span><span class="op" id="3669184">(</span><span class="ident" id="3669185"><a href="/crypto/aes/block.go.html#3669104">key</a></span><span class="op" id="3669188">)</span>&nbsp;<span class="op" id="3669190">/</span>&nbsp;<span class="num" id="3669192">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669195">for</span>&nbsp;<span class="ident" id="3669199"><a href="/crypto/aes/block.go.html#3669168">i</a></span>&nbsp;<span class="op" id="3669201">=</span>&nbsp;<span class="num" id="3669203">0</span><span class="op" id="3669204">;</span>&nbsp;<span class="ident" id="3669206"><a href="/crypto/aes/block.go.html#3669168">i</a></span>&nbsp;<span class="op" id="3669208">&lt;</span>&nbsp;<span class="ident" id="3669210"><a href="/crypto/aes/block.go.html#3669175">nk</a></span><span class="op" id="3669212">;</span>&nbsp;<span class="ident" id="3669214"><a href="/crypto/aes/block.go.html#3669168">i</a></span><span class="op" id="3669215">++</span>&nbsp;<span class="op" id="3669218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669222"><a href="/crypto/aes/block.go.html#3669116">enc</a></span><span class="op" id="3669225">[</span><span class="ident" id="3669226"><a href="/crypto/aes/block.go.html#3669168">i</a></span><span class="op" id="3669227">]</span>&nbsp;<span class="op" id="3669229">=</span>&nbsp;<span class="builtintype" id="3669231">uint32</span><span class="op" id="3669237">(</span><span class="ident" id="3669238"><a href="/crypto/aes/block.go.html#3669104">key</a></span><span class="op" id="3669241">[</span><span class="num" id="3669242">4</span><span class="op" id="3669243">*</span><span class="ident" id="3669244"><a href="/crypto/aes/block.go.html#3669168">i</a></span><span class="op" id="3669245">]</span><span class="op" id="3669246">)</span><span class="op" id="3669247">&lt;&lt;</span><span class="num" id="3669249">24</span>&nbsp;<span class="op" id="3669252">|</span>&nbsp;<span class="builtintype" id="3669254">uint32</span><span class="op" id="3669260">(</span><span class="ident" id="3669261"><a href="/crypto/aes/block.go.html#3669104">key</a></span><span class="op" id="3669264">[</span><span class="num" id="3669265">4</span><span class="op" id="3669266">*</span><span class="ident" id="3669267"><a href="/crypto/aes/block.go.html#3669168">i</a></span><span class="op" id="3669268">+</span><span class="num" id="3669269">1</span><span class="op" id="3669270">]</span><span class="op" id="3669271">)</span><span class="op" id="3669272">&lt;&lt;</span><span class="num" id="3669274">16</span>&nbsp;<span class="op" id="3669277">|</span>&nbsp;<span class="builtintype" id="3669279">uint32</span><span class="op" id="3669285">(</span><span class="ident" id="3669286"><a href="/crypto/aes/block.go.html#3669104">key</a></span><span class="op" id="3669289">[</span><span class="num" id="3669290">4</span><span class="op" id="3669291">*</span><span class="ident" id="3669292"><a href="/crypto/aes/block.go.html#3669168">i</a></span><span class="op" id="3669293">+</span><span class="num" id="3669294">2</span><span class="op" id="3669295">]</span><span class="op" id="3669296">)</span><span class="op" id="3669297">&lt;&lt;</span><span class="num" id="3669299">8</span>&nbsp;<span class="op" id="3669301">|</span>&nbsp;<span class="builtintype" id="3669303">uint32</span><span class="op" id="3669309">(</span><span class="ident" id="3669310"><a href="/crypto/aes/block.go.html#3669104">key</a></span><span class="op" id="3669313">[</span><span class="num" id="3669314">4</span><span class="op" id="3669315">*</span><span class="ident" id="3669316"><a href="/crypto/aes/block.go.html#3669168">i</a></span><span class="op" id="3669317">+</span><span class="num" id="3669318">3</span><span class="op" id="3669319">]</span><span class="op" id="3669320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3669323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669326">for</span>&nbsp;<span class="op" id="3669330">;</span>&nbsp;<span class="ident" id="3669332"><a href="/crypto/aes/block.go.html#3669168">i</a></span>&nbsp;<span class="op" id="3669334">&lt;</span>&nbsp;<span class="builtinfunc" id="3669336">len</span><span class="op" id="3669339">(</span><span class="ident" id="3669340"><a href="/crypto/aes/block.go.html#3669116">enc</a></span><span class="op" id="3669343">)</span><span class="op" id="3669344">;</span>&nbsp;<span class="ident" id="3669346"><a href="/crypto/aes/block.go.html#3669168">i</a></span><span class="op" id="3669347">++</span>&nbsp;<span class="op" id="3669350">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669354">t</span>&nbsp;<span class="op" id="3669356">:=</span>&nbsp;<span class="ident" id="3669359"><a href="/crypto/aes/block.go.html#3669116">enc</a></span><span class="op" id="3669362">[</span><span class="ident" id="3669363"><a href="/crypto/aes/block.go.html#3669168">i</a></span><span class="op" id="3669364">-</span><span class="num" id="3669365">1</span><span class="op" id="3669366">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669370">if</span>&nbsp;<span class="ident" id="3669373"><a href="/crypto/aes/block.go.html#3669168">i</a></span><span class="op" id="3669374">%</span><span class="ident" id="3669375"><a href="/crypto/aes/block.go.html#3669175">nk</a></span>&nbsp;<span class="op" id="3669378">==</span>&nbsp;<span class="num" id="3669381">0</span>&nbsp;<span class="op" id="3669383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669388"><a href="/crypto/aes/block.go.html#3669354">t</a></span>&nbsp;<span class="op" id="3669390">=</span>&nbsp;<span class="ident" id="3669392"><a href="/crypto/aes/block.go.html#3668778">subw</a></span><span class="op" id="3669396">(</span><span class="ident" id="3669397"><a href="/crypto/aes/block.go.html#3668945">rotw</a></span><span class="op" id="3669401">(</span><span class="ident" id="3669402"><a href="/crypto/aes/block.go.html#3669354">t</a></span><span class="op" id="3669403">)</span><span class="op" id="3669404">)</span>&nbsp;<span class="op" id="3669406">^</span>&nbsp;<span class="op" id="3669408">(</span><span class="builtintype" id="3669409">uint32</span><span class="op" id="3669415">(</span><span class="ident" id="3669416"><a href="/crypto/aes/const.go.html#3673403">powx</a></span><span class="op" id="3669420">[</span><span class="ident" id="3669421"><a href="/crypto/aes/block.go.html#3669168">i</a></span><span class="op" id="3669422">/</span><span class="ident" id="3669423"><a href="/crypto/aes/block.go.html#3669175">nk</a></span><span class="op" id="3669425">-</span><span class="num" id="3669426">1</span><span class="op" id="3669427">]</span><span class="op" id="3669428">)</span>&nbsp;<span class="op" id="3669430">&lt;&lt;</span>&nbsp;<span class="num" id="3669433">24</span><span class="op" id="3669435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3669439">}</span>&nbsp;<span class="keyword" id="3669441">else</span>&nbsp;<span class="keyword" id="3669446">if</span>&nbsp;<span class="ident" id="3669449"><a href="/crypto/aes/block.go.html#3669175">nk</a></span>&nbsp;<span class="op" id="3669452">&gt;</span>&nbsp;<span class="num" id="3669454">6</span>&nbsp;<span class="op" id="3669456">&amp;&amp;</span>&nbsp;<span class="ident" id="3669459"><a href="/crypto/aes/block.go.html#3669168">i</a></span><span class="op" id="3669460">%</span><span class="ident" id="3669461"><a href="/crypto/aes/block.go.html#3669175">nk</a></span>&nbsp;<span class="op" id="3669464">==</span>&nbsp;<span class="num" id="3669467">4</span>&nbsp;<span class="op" id="3669469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669474"><a href="/crypto/aes/block.go.html#3669354">t</a></span>&nbsp;<span class="op" id="3669476">=</span>&nbsp;<span class="ident" id="3669478"><a href="/crypto/aes/block.go.html#3668778">subw</a></span><span class="op" id="3669482">(</span><span class="ident" id="3669483"><a href="/crypto/aes/block.go.html#3669354">t</a></span><span class="op" id="3669484">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3669488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669492"><a href="/crypto/aes/block.go.html#3669116">enc</a></span><span class="op" id="3669495">[</span><span class="ident" id="3669496"><a href="/crypto/aes/block.go.html#3669168">i</a></span><span class="op" id="3669497">]</span>&nbsp;<span class="op" id="3669499">=</span>&nbsp;<span class="ident" id="3669501"><a href="/crypto/aes/block.go.html#3669116">enc</a></span><span class="op" id="3669504">[</span><span class="ident" id="3669505"><a href="/crypto/aes/block.go.html#3669168">i</a></span><span class="op" id="3669506">-</span><span class="ident" id="3669507"><a href="/crypto/aes/block.go.html#3669175">nk</a></span><span class="op" id="3669509">]</span>&nbsp;<span class="op" id="3669511">^</span>&nbsp;<span class="ident" id="3669513"><a href="/crypto/aes/block.go.html#3669354">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3669516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3669520">//&nbsp;Derive&nbsp;decryption&nbsp;key&nbsp;from&nbsp;encryption&nbsp;key.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3669567">//&nbsp;Reverse&nbsp;the&nbsp;4-word&nbsp;round&nbsp;key&nbsp;sets&nbsp;from&nbsp;enc&nbsp;to&nbsp;produce&nbsp;dec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3669630">//&nbsp;All&nbsp;sets&nbsp;but&nbsp;the&nbsp;first&nbsp;and&nbsp;last&nbsp;get&nbsp;the&nbsp;MixColumn&nbsp;transform&nbsp;applied.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669703">if</span>&nbsp;<span class="ident" id="3669706"><a href="/crypto/aes/block.go.html#3669121">dec</a></span>&nbsp;<span class="op" id="3669710">==</span>&nbsp;<span class="ident" id="3669713">nil</span>&nbsp;<span class="op" id="3669717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669721">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3669729">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669732">n</span>&nbsp;<span class="op" id="3669734">:=</span>&nbsp;<span class="builtinfunc" id="3669737">len</span><span class="op" id="3669740">(</span><span class="ident" id="3669741"><a href="/crypto/aes/block.go.html#3669116">enc</a></span><span class="op" id="3669744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669747">for</span>&nbsp;<span class="ident" id="3669751">i</span>&nbsp;<span class="op" id="3669753">:=</span>&nbsp;<span class="num" id="3669756">0</span><span class="op" id="3669757">;</span>&nbsp;<span class="ident" id="3669759"><a href="/crypto/aes/block.go.html#3669751">i</a></span>&nbsp;<span class="op" id="3669761">&lt;</span>&nbsp;<span class="ident" id="3669763"><a href="/crypto/aes/block.go.html#3669732">n</a></span><span class="op" id="3669764">;</span>&nbsp;<span class="ident" id="3669766"><a href="/crypto/aes/block.go.html#3669751">i</a></span>&nbsp;<span class="op" id="3669768">+=</span>&nbsp;<span class="num" id="3669771">4</span>&nbsp;<span class="op" id="3669773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669777">ei</span>&nbsp;<span class="op" id="3669780">:=</span>&nbsp;<span class="ident" id="3669783"><a href="/crypto/aes/block.go.html#3669732">n</a></span>&nbsp;<span class="op" id="3669785">-</span>&nbsp;<span class="ident" id="3669787"><a href="/crypto/aes/block.go.html#3669751">i</a></span>&nbsp;<span class="op" id="3669789">-</span>&nbsp;<span class="num" id="3669791">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669795">for</span>&nbsp;<span class="ident" id="3669799">j</span>&nbsp;<span class="op" id="3669801">:=</span>&nbsp;<span class="num" id="3669804">0</span><span class="op" id="3669805">;</span>&nbsp;<span class="ident" id="3669807"><a href="/crypto/aes/block.go.html#3669799">j</a></span>&nbsp;<span class="op" id="3669809">&lt;</span>&nbsp;<span class="num" id="3669811">4</span><span class="op" id="3669812">;</span>&nbsp;<span class="ident" id="3669814"><a href="/crypto/aes/block.go.html#3669799">j</a></span><span class="op" id="3669815">++</span>&nbsp;<span class="op" id="3669818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669823">x</span>&nbsp;<span class="op" id="3669825">:=</span>&nbsp;<span class="ident" id="3669828"><a href="/crypto/aes/block.go.html#3669116">enc</a></span><span class="op" id="3669831">[</span><span class="ident" id="3669832"><a href="/crypto/aes/block.go.html#3669777">ei</a></span><span class="op" id="3669834">+</span><span class="ident" id="3669835"><a href="/crypto/aes/block.go.html#3669799">j</a></span><span class="op" id="3669836">]</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3669841">if</span>&nbsp;<span class="ident" id="3669844"><a href="/crypto/aes/block.go.html#3669751">i</a></span>&nbsp;<span class="op" id="3669846">&gt;</span>&nbsp;<span class="num" id="3669848">0</span>&nbsp;<span class="op" id="3669850">&amp;&amp;</span>&nbsp;<span class="ident" id="3669853"><a href="/crypto/aes/block.go.html#3669751">i</a></span><span class="op" id="3669854">+</span><span class="num" id="3669855">4</span>&nbsp;<span class="op" id="3669857">&lt;</span>&nbsp;<span class="ident" id="3669859"><a href="/crypto/aes/block.go.html#3669732">n</a></span>&nbsp;<span class="op" id="3669861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669867"><a href="/crypto/aes/block.go.html#3669823">x</a></span>&nbsp;<span class="op" id="3669869">=</span>&nbsp;<span class="ident" id="3669871"><a href="/crypto/aes/const.go.html#3689562">td0</a></span><span class="op" id="3669874">[</span><span class="ident" id="3669875"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3669880">[</span><span class="ident" id="3669881"><a href="/crypto/aes/block.go.html#3669823">x</a></span><span class="op" id="3669882">&gt;&gt;</span><span class="num" id="3669884">24</span><span class="op" id="3669886">]</span><span class="op" id="3669887">]</span>&nbsp;<span class="op" id="3669889">^</span>&nbsp;<span class="ident" id="3669891"><a href="/crypto/aes/const.go.html#3692691">td1</a></span><span class="op" id="3669894">[</span><span class="ident" id="3669895"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3669900">[</span><span class="ident" id="3669901"><a href="/crypto/aes/block.go.html#3669823">x</a></span><span class="op" id="3669902">&gt;&gt;</span><span class="num" id="3669904">16</span><span class="op" id="3669906">&amp;</span><span class="num" id="3669907">0xff</span><span class="op" id="3669911">]</span><span class="op" id="3669912">]</span>&nbsp;<span class="op" id="3669914">^</span>&nbsp;<span class="ident" id="3669916"><a href="/crypto/aes/const.go.html#3695820">td2</a></span><span class="op" id="3669919">[</span><span class="ident" id="3669920"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3669925">[</span><span class="ident" id="3669926"><a href="/crypto/aes/block.go.html#3669823">x</a></span><span class="op" id="3669927">&gt;&gt;</span><span class="num" id="3669929">8</span><span class="op" id="3669930">&amp;</span><span class="num" id="3669931">0xff</span><span class="op" id="3669935">]</span><span class="op" id="3669936">]</span>&nbsp;<span class="op" id="3669938">^</span>&nbsp;<span class="ident" id="3669940"><a href="/crypto/aes/const.go.html#3698949">td3</a></span><span class="op" id="3669943">[</span><span class="ident" id="3669944"><a href="/crypto/aes/const.go.html#3673610">sbox0</a></span><span class="op" id="3669949">[</span><span class="ident" id="3669950"><a href="/crypto/aes/block.go.html#3669823">x</a></span><span class="op" id="3669951">&amp;</span><span class="num" id="3669952">0xff</span><span class="op" id="3669956">]</span><span class="op" id="3669957">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3669962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3669967"><a href="/crypto/aes/block.go.html#3669121">dec</a></span><span class="op" id="3669970">[</span><span class="ident" id="3669971"><a href="/crypto/aes/block.go.html#3669751">i</a></span><span class="op" id="3669972">+</span><span class="ident" id="3669973"><a href="/crypto/aes/block.go.html#3669799">j</a></span><span class="op" id="3669974">]</span>&nbsp;<span class="op" id="3669976">=</span>&nbsp;<span class="ident" id="3669978"><a href="/crypto/aes/block.go.html#3669823">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3669982">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3669985">}</span><br>
<span class="lineno"></span><span class="op" id="3669987">}</span>
</div>
</body>
</html>
