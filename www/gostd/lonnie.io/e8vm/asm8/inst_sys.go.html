<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/asm8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/asm8/bare_func.go.html">bare_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_file.go.html">build_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_func.go.html">build_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_lib.go.html">build_lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_var.go.html">build_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/builder.go.html">builder.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/check_type.go.html">check_type.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_hex.go.html">data_hex.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_nums.go.html">data_nums.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_str.go.html">data_str.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/file.go.html">file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_decl.go.html">func_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_stmt.go.html">func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst.go.html">inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all.go.html">lex_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all_test.go.html">lex_all_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_comment.go.html">lex_comment.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_operand.go.html">lex_operand.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_string.go.html">lex_string.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lib.go.html">lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/package.go.html">package.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_arg.go.html">parse_arg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_file.go.html">parse_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func.go.html">parse_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_stmt.go.html">parse_func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_test.go.html">parse_func_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_inst.go.html">parse_inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_label.go.html">parse_label.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_reg.go.html">parse_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_sym.go.html">parse_sym.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var.go.html">parse_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var_stmt.go.html">parse_var_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parser.go.html">parser.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/single_file.go.html">single_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/stmt_lexer.go.html">stmt_lexer.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_scope.go.html">sym_scope.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_table.go.html">sym_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/symbol.go.html">symbol.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/token.go.html">token.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_decl.go.html">var_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_stmt.go.html">var_stmt.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="4872341">package</span>&nbsp;<span class="ident" id="4872349">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4872355">import</span>&nbsp;<span class="op" id="4872362">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4872365">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno">5</span><span class="op" id="4872387">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4872390">var</span>&nbsp;<span class="op" id="4872394">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4872397">//&nbsp;op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872404">opSysMap</span>&nbsp;<span class="op" id="4872413">=</span>&nbsp;<span class="keyword" id="4872415">map</span><span class="op" id="4872418">[</span><span class="builtintype" id="4872419">string</span><span class="op" id="4872425">]</span><span class="builtintype" id="4872426">uint32</span><span class="op" id="4872432">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4872436">&#34;halt&#34;</span><span class="op" id="4872442">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4872447">64</span><span class="op" id="4872449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4872453">&#34;syscall&#34;</span><span class="op" id="4872462">:</span>&nbsp;<span class="num" id="4872464">65</span><span class="op" id="4872466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4872470">&#34;usermod&#34;</span><span class="op" id="4872479">:</span>&nbsp;<span class="num" id="4872481">66</span><span class="op" id="4872483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4872487">&#34;iret&#34;</span><span class="op" id="4872493">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4872498">68</span><span class="op" id="4872500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872503">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4872507">//&nbsp;op&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872518">opSys1Map</span>&nbsp;<span class="op" id="4872528">=</span>&nbsp;<span class="keyword" id="4872530">map</span><span class="op" id="4872533">[</span><span class="builtintype" id="4872534">string</span><span class="op" id="4872540">]</span><span class="builtintype" id="4872541">uint32</span><span class="op" id="4872547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4872551">&#34;vtable&#34;</span><span class="op" id="4872559">:</span>&nbsp;<span class="num" id="4872561">67</span><span class="op" id="4872563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4872567">&#34;cpuid&#34;</span><span class="op" id="4872574">:</span>&nbsp;&nbsp;<span class="num" id="4872577">69</span><span class="op" id="4872579">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872582">}</span><br>
<span class="lineno"></span><span class="op" id="4872584">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4872587">func</span>&nbsp;<span class="ident" id="4872592">makeInstSys</span><span class="op" id="4872603">(</span><span class="ident" id="4872604">op</span><span class="op" id="4872606">,</span>&nbsp;<span class="ident" id="4872608">reg</span>&nbsp;<span class="builtintype" id="4872612">uint32</span><span class="op" id="4872618">)</span>&nbsp;<span class="op" id="4872620">*</span><span class="ident" id="4872621">inst</span>&nbsp;<span class="op" id="4872626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872629">ret</span>&nbsp;<span class="op" id="4872633">:=</span>&nbsp;<span class="op" id="4872636">(</span><span class="op" id="4872637">(</span><span class="ident" id="4872638">op</span>&nbsp;<span class="op" id="4872641">&amp;</span>&nbsp;<span class="num" id="4872643">0xff</span><span class="op" id="4872647">)</span>&nbsp;<span class="op" id="4872649">&lt;&lt;</span>&nbsp;<span class="num" id="4872652">24</span><span class="op" id="4872654">)</span>&nbsp;<span class="op" id="4872656">|</span>&nbsp;<span class="op" id="4872658">(</span><span class="op" id="4872659">(</span><span class="ident" id="4872660">reg</span>&nbsp;<span class="op" id="4872664">&amp;</span>&nbsp;<span class="num" id="4872666">0x7</span><span class="op" id="4872669">)</span>&nbsp;<span class="op" id="4872671">&lt;&lt;</span>&nbsp;<span class="num" id="4872674">21</span><span class="op" id="4872676">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872679">return</span>&nbsp;<span class="op" id="4872686">&amp;</span><span class="ident" id="4872687">inst</span><span class="op" id="4872691">{</span><span class="ident" id="4872692">inst</span><span class="op" id="4872696">:</span>&nbsp;<span class="ident" id="4872698">ret</span><span class="op" id="4872701">}</span><br>
<span class="lineno"></span><span class="op" id="4872703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4872706">func</span>&nbsp;<span class="ident" id="4872711">parseInstSys</span><span class="op" id="4872723">(</span><span class="ident" id="4872724">p</span>&nbsp;<span class="op" id="4872726">*</span><span class="ident" id="4872727">parser</span><span class="op" id="4872733">,</span>&nbsp;<span class="ident" id="4872735">ops</span>&nbsp;<span class="op" id="4872739">[</span><span class="op" id="4872740">]</span><span class="op" id="4872741">*</span><span class="ident" id="4872742">lex8</span><span class="op" id="4872746">.</span><span class="ident" id="4872747">Token</span><span class="op" id="4872752">)</span>&nbsp;<span class="op" id="4872754">(</span><span class="op" id="4872755">*</span><span class="ident" id="4872756">inst</span><span class="op" id="4872760">,</span>&nbsp;<span class="builtintype" id="4872762">bool</span><span class="op" id="4872766">)</span>&nbsp;<span class="op" id="4872768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872771">op0</span>&nbsp;<span class="op" id="4872775">:=</span>&nbsp;<span class="ident" id="4872778">ops</span><span class="op" id="4872781">[</span><span class="num" id="4872782">0</span><span class="op" id="4872783">]</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872786">opName</span>&nbsp;<span class="op" id="4872793">:=</span>&nbsp;<span class="ident" id="4872796">op0</span><span class="op" id="4872799">.</span><span class="ident" id="4872800">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872805">args</span>&nbsp;<span class="op" id="4872810">:=</span>&nbsp;<span class="ident" id="4872813">ops</span><span class="op" id="4872816">[</span><span class="num" id="4872817">1</span><span class="op" id="4872818">:</span><span class="op" id="4872819">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872822">var</span>&nbsp;<span class="ident" id="4872826">op</span><span class="op" id="4872828">,</span>&nbsp;<span class="ident" id="4872830">reg</span>&nbsp;<span class="builtintype" id="4872834">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872843">argCount</span>&nbsp;<span class="op" id="4872852">:=</span>&nbsp;<span class="keyword" id="4872855">func</span><span class="op" id="4872859">(</span><span class="ident" id="4872860">n</span>&nbsp;<span class="builtintype" id="4872862">int</span><span class="op" id="4872865">)</span>&nbsp;<span class="builtintype" id="4872867">bool</span>&nbsp;<span class="op" id="4872872">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872876">if</span>&nbsp;<span class="op" id="4872879">!</span><span class="ident" id="4872880">argCount</span><span class="op" id="4872888">(</span><span class="ident" id="4872889">p</span><span class="op" id="4872890">,</span>&nbsp;<span class="ident" id="4872892">ops</span><span class="op" id="4872895">,</span>&nbsp;<span class="ident" id="4872897">n</span><span class="op" id="4872898">)</span>&nbsp;<span class="op" id="4872900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872905">return</span>&nbsp;<span class="builtintype" id="4872912">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872925">if</span>&nbsp;<span class="ident" id="4872928">n</span>&nbsp;<span class="op" id="4872930">&gt;=</span>&nbsp;<span class="num" id="4872933">1</span>&nbsp;<span class="op" id="4872935">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872940">reg</span>&nbsp;<span class="op" id="4872944">=</span>&nbsp;<span class="ident" id="4872946">parseReg</span><span class="op" id="4872954">(</span><span class="ident" id="4872955">p</span><span class="op" id="4872956">,</span>&nbsp;<span class="ident" id="4872958">args</span><span class="op" id="4872962">[</span><span class="num" id="4872963">0</span><span class="op" id="4872964">]</span><span class="op" id="4872965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872973">return</span>&nbsp;<span class="builtintype" id="4872980">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872990">var</span>&nbsp;<span class="ident" id="4872994">found</span>&nbsp;<span class="builtintype" id="4873000">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873006">if</span>&nbsp;<span class="ident" id="4873009">op</span><span class="op" id="4873011">,</span>&nbsp;<span class="ident" id="4873013">found</span>&nbsp;<span class="op" id="4873019">=</span>&nbsp;<span class="ident" id="4873021">opSysMap</span><span class="op" id="4873029">[</span><span class="ident" id="4873030">opName</span><span class="op" id="4873036">]</span><span class="op" id="4873037">;</span>&nbsp;<span class="ident" id="4873039">found</span>&nbsp;<span class="op" id="4873045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4873049">//&nbsp;op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873057">argCount</span><span class="op" id="4873065">(</span><span class="num" id="4873066">0</span><span class="op" id="4873067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4873070">}</span>&nbsp;<span class="keyword" id="4873072">else</span>&nbsp;<span class="keyword" id="4873077">if</span>&nbsp;<span class="ident" id="4873080">op</span><span class="op" id="4873082">,</span>&nbsp;<span class="ident" id="4873084">found</span>&nbsp;<span class="op" id="4873090">=</span>&nbsp;<span class="ident" id="4873092">opSys1Map</span><span class="op" id="4873101">[</span><span class="ident" id="4873102">opName</span><span class="op" id="4873108">]</span><span class="op" id="4873109">;</span>&nbsp;<span class="ident" id="4873111">found</span>&nbsp;<span class="op" id="4873117">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4873121">//&nbsp;op&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4873133">argCount</span><span class="op" id="4873141">(</span><span class="num" id="4873142">1</span><span class="op" id="4873143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4873146">}</span>&nbsp;<span class="keyword" id="4873148">else</span>&nbsp;<span class="op" id="4873153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873157">return</span>&nbsp;<span class="ident" id="4873164">nil</span><span class="op" id="4873167">,</span>&nbsp;<span class="builtintype" id="4873169">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4873176">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4873180">return</span>&nbsp;<span class="ident" id="4873187">makeInstSys</span><span class="op" id="4873198">(</span><span class="ident" id="4873199">op</span><span class="op" id="4873201">,</span>&nbsp;<span class="ident" id="4873203">reg</span><span class="op" id="4873206">)</span><span class="op" id="4873207">,</span>&nbsp;<span class="builtintype" id="4873209">true</span><br>
<span class="lineno"></span><span class="op" id="4873214">}</span>
</div>
</body>
</html>
