<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html" class="current">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7296378">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7296434">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7296488">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7296539">package</span>&nbsp;<span class="ident" id="7296547">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7296554">import</span>&nbsp;<span class="op" id="7296561">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7296564">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7296575">&#34;testing&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7296586">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7296593">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7296596">func</span>&nbsp;<span class="ident" id="7296601">TestReadGCStats</span><span class="op" id="7296616">(</span><span class="ident" id="7296617">t</span>&nbsp;<span class="op" id="7296619">*</span><span class="ident" id="7296620"><a href="/gostd/runtime/debug/garbage_test.go.html#7296575">testing</a></span><span class="op" id="7296627">.</span><span class="ident" id="7296628"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7296629">)</span>&nbsp;<span class="op" id="7296631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7296634">defer</span>&nbsp;<span class="ident" id="7296640"><a href="/gostd/runtime/debug/garbage.go.html#5442577">SetGCPercent</a></span><span class="op" id="7296652">(</span><span class="ident" id="7296653"><a href="/gostd/runtime/debug/garbage.go.html#5442577">SetGCPercent</a></span><span class="op" id="7296665">(</span><span class="op" id="7296666">-</span><span class="num" id="7296667">1</span><span class="op" id="7296668">)</span><span class="op" id="7296669">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7296673">var</span>&nbsp;<span class="ident" id="7296677">stats</span>&nbsp;<span class="ident" id="7296683"><a href="/gostd/runtime/debug/garbage.go.html#5439150">GCStats</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7296692">var</span>&nbsp;<span class="ident" id="7296696">mstats</span>&nbsp;<span class="ident" id="7296703"><a href="/gostd/runtime/debug/garbage_test.go.html#7296564">runtime</a></span><span class="op" id="7296710">.</span><span class="ident" id="7296711"><a href="/gostd/runtime/mem.go.html#1613431">MemStats</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7296721">var</span>&nbsp;<span class="ident" id="7296725">min</span><span class="op" id="7296728">,</span>&nbsp;<span class="ident" id="7296730">max</span>&nbsp;<span class="ident" id="7296734"><a href="/gostd/runtime/debug/garbage_test.go.html#7296586">time</a></span><span class="op" id="7296738">.</span><span class="ident" id="7296739"><a href="/gostd/time/time.go.html#2734212">Duration</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7296750">//&nbsp;First&nbsp;ReadGCStats&nbsp;will&nbsp;allocate,&nbsp;second&nbsp;should&nbsp;not,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7296806">//&nbsp;especially&nbsp;if&nbsp;we&nbsp;follow&nbsp;up&nbsp;with&nbsp;an&nbsp;explicit&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7296874"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7296879">.</span><span class="ident" id="7296880"><a href="/gostd/runtime/debug/garbage.go.html#5439505">PauseQuantiles</a></span>&nbsp;<span class="op" id="7296895">=</span>&nbsp;<span class="builtinfunc" id="7296897">make</span><span class="op" id="7296901">(</span><span class="op" id="7296902">[</span><span class="op" id="7296903">]</span><span class="ident" id="7296904"><a href="/gostd/runtime/debug/garbage_test.go.html#7296586">time</a></span><span class="op" id="7296908">.</span><span class="ident" id="7296909"><a href="/gostd/time/time.go.html#2734212">Duration</a></span><span class="op" id="7296917">,</span>&nbsp;<span class="num" id="7296919">10</span><span class="op" id="7296921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7296924"><a href="/gostd/runtime/debug/garbage.go.html#5440077">ReadGCStats</a></span><span class="op" id="7296935">(</span><span class="op" id="7296936">&amp;</span><span class="ident" id="7296937"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7296942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7296945"><a href="/gostd/runtime/debug/garbage_test.go.html#7296564">runtime</a></span><span class="op" id="7296952">.</span><span class="ident" id="7296953"><a href="/gostd/runtime/malloc.go.html#1602269">GC</a></span><span class="op" id="7296955">(</span><span class="op" id="7296956">)</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7296960">//&nbsp;Assume&nbsp;these&nbsp;will&nbsp;return&nbsp;same&nbsp;data:&nbsp;no&nbsp;GC&nbsp;during&nbsp;ReadGCStats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7297026"><a href="/gostd/runtime/debug/garbage.go.html#5440077">ReadGCStats</a></span><span class="op" id="7297037">(</span><span class="op" id="7297038">&amp;</span><span class="ident" id="7297039"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7297044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7297047"><a href="/gostd/runtime/debug/garbage_test.go.html#7296564">runtime</a></span><span class="op" id="7297054">.</span><span class="ident" id="7297055"><a href="/gostd/runtime/mem.go.html#1615506">ReadMemStats</a></span><span class="op" id="7297067">(</span><span class="op" id="7297068">&amp;</span><span class="ident" id="7297069"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297075">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7297079">if</span>&nbsp;<span class="ident" id="7297082"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7297087">.</span><span class="ident" id="7297088"><a href="/gostd/runtime/debug/garbage.go.html#5439227">NumGC</a></span>&nbsp;<span class="op" id="7297094">!=</span>&nbsp;<span class="builtintype" id="7297097">int64</span><span class="op" id="7297102">(</span><span class="ident" id="7297103"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297109">.</span><span class="ident" id="7297110"><a href="/gostd/runtime/mem.go.html#1614976">NumGC</a></span><span class="op" id="7297115">)</span>&nbsp;<span class="op" id="7297117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7297121"><a href="/gostd/runtime/debug/garbage_test.go.html#7296617">t</a></span><span class="op" id="7297122">.</span><span class="ident" id="7297123"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7297129">(</span><span class="string" id="7297130">&#34;stats.NumGC&nbsp;=&nbsp;%d,&nbsp;but&nbsp;mstats.NumGC&nbsp;=&nbsp;%d&#34;</span><span class="op" id="7297171">,</span>&nbsp;<span class="ident" id="7297173"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7297178">.</span><span class="ident" id="7297179"><a href="/gostd/runtime/debug/garbage.go.html#5439227">NumGC</a></span><span class="op" id="7297184">,</span>&nbsp;<span class="ident" id="7297186"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297192">.</span><span class="ident" id="7297193"><a href="/gostd/runtime/mem.go.html#1614976">NumGC</a></span><span class="op" id="7297198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7297201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7297204">if</span>&nbsp;<span class="ident" id="7297207"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7297212">.</span><span class="ident" id="7297213"><a href="/gostd/runtime/debug/garbage.go.html#5439292">PauseTotal</a></span>&nbsp;<span class="op" id="7297224">!=</span>&nbsp;<span class="ident" id="7297227"><a href="/gostd/runtime/debug/garbage_test.go.html#7296586">time</a></span><span class="op" id="7297231">.</span><span class="ident" id="7297232"><a href="/gostd/time/time.go.html#2734212">Duration</a></span><span class="op" id="7297240">(</span><span class="ident" id="7297241"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297247">.</span><span class="ident" id="7297248"><a href="/gostd/runtime/mem.go.html#1614773">PauseTotalNs</a></span><span class="op" id="7297260">)</span>&nbsp;<span class="op" id="7297262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7297266"><a href="/gostd/runtime/debug/garbage_test.go.html#7296617">t</a></span><span class="op" id="7297267">.</span><span class="ident" id="7297268"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7297274">(</span><span class="string" id="7297275">&#34;stats.PauseTotal&nbsp;=&nbsp;%d,&nbsp;but&nbsp;mstats.PauseTotalNs&nbsp;=&nbsp;%d&#34;</span><span class="op" id="7297328">,</span>&nbsp;<span class="ident" id="7297330"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7297335">.</span><span class="ident" id="7297336"><a href="/gostd/runtime/debug/garbage.go.html#5439292">PauseTotal</a></span><span class="op" id="7297346">,</span>&nbsp;<span class="ident" id="7297348"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297354">.</span><span class="ident" id="7297355"><a href="/gostd/runtime/mem.go.html#1614773">PauseTotalNs</a></span><span class="op" id="7297367">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7297370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7297373">if</span>&nbsp;<span class="ident" id="7297376"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7297381">.</span><span class="ident" id="7297382"><a href="/gostd/runtime/debug/garbage.go.html#5439168">LastGC</a></span><span class="op" id="7297388">.</span><span class="ident" id="7297389"><a href="/gostd/time/time.go.html#2744495">UnixNano</a></span><span class="op" id="7297397">(</span><span class="op" id="7297398">)</span>&nbsp;<span class="op" id="7297400">!=</span>&nbsp;<span class="builtintype" id="7297403">int64</span><span class="op" id="7297408">(</span><span class="ident" id="7297409"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297415">.</span><span class="ident" id="7297416"><a href="/gostd/runtime/mem.go.html#1614696">LastGC</a></span><span class="op" id="7297422">)</span>&nbsp;<span class="op" id="7297424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7297428"><a href="/gostd/runtime/debug/garbage_test.go.html#7296617">t</a></span><span class="op" id="7297429">.</span><span class="ident" id="7297430"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7297436">(</span><span class="string" id="7297437">&#34;stats.LastGC.UnixNano&nbsp;=&nbsp;%d,&nbsp;but&nbsp;mstats.LastGC&nbsp;=&nbsp;%d&#34;</span><span class="op" id="7297489">,</span>&nbsp;<span class="ident" id="7297491"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7297496">.</span><span class="ident" id="7297497"><a href="/gostd/runtime/debug/garbage.go.html#5439168">LastGC</a></span><span class="op" id="7297503">.</span><span class="ident" id="7297504"><a href="/gostd/time/time.go.html#2744495">UnixNano</a></span><span class="op" id="7297512">(</span><span class="op" id="7297513">)</span><span class="op" id="7297514">,</span>&nbsp;<span class="ident" id="7297516"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297522">.</span><span class="ident" id="7297523"><a href="/gostd/runtime/mem.go.html#1614696">LastGC</a></span><span class="op" id="7297529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7297532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7297535">n</span>&nbsp;<span class="op" id="7297537">:=</span>&nbsp;<span class="builtintype" id="7297540">int</span><span class="op" id="7297543">(</span><span class="ident" id="7297544"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297550">.</span><span class="ident" id="7297551"><a href="/gostd/runtime/mem.go.html#1614976">NumGC</a></span><span class="op" id="7297556">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7297559">if</span>&nbsp;<span class="ident" id="7297562"><a href="/gostd/runtime/debug/garbage_test.go.html#7297535">n</a></span>&nbsp;<span class="op" id="7297564">&gt;</span>&nbsp;<span class="builtinfunc" id="7297566">len</span><span class="op" id="7297569">(</span><span class="ident" id="7297570"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297576">.</span><span class="ident" id="7297577"><a href="/gostd/runtime/mem.go.html#1614794">PauseNs</a></span><span class="op" id="7297584">)</span>&nbsp;<span class="op" id="7297586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7297590"><a href="/gostd/runtime/debug/garbage_test.go.html#7297535">n</a></span>&nbsp;<span class="op" id="7297592">=</span>&nbsp;<span class="builtinfunc" id="7297594">len</span><span class="op" id="7297597">(</span><span class="ident" id="7297598"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297604">.</span><span class="ident" id="7297605"><a href="/gostd/runtime/mem.go.html#1614794">PauseNs</a></span><span class="op" id="7297612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7297615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7297618">if</span>&nbsp;<span class="builtinfunc" id="7297621">len</span><span class="op" id="7297624">(</span><span class="ident" id="7297625"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7297630">.</span><span class="ident" id="7297631"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span><span class="op" id="7297636">)</span>&nbsp;<span class="op" id="7297638">!=</span>&nbsp;<span class="ident" id="7297641"><a href="/gostd/runtime/debug/garbage_test.go.html#7297535">n</a></span>&nbsp;<span class="op" id="7297643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7297647"><a href="/gostd/runtime/debug/garbage_test.go.html#7296617">t</a></span><span class="op" id="7297648">.</span><span class="ident" id="7297649"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7297655">(</span><span class="string" id="7297656">&#34;len(stats.Pause)&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7297688">,</span>&nbsp;<span class="builtinfunc" id="7297690">len</span><span class="op" id="7297693">(</span><span class="ident" id="7297694"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7297699">.</span><span class="ident" id="7297700"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span><span class="op" id="7297705">)</span><span class="op" id="7297706">,</span>&nbsp;<span class="ident" id="7297708"><a href="/gostd/runtime/debug/garbage_test.go.html#7297535">n</a></span><span class="op" id="7297709">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7297712">}</span>&nbsp;<span class="keyword" id="7297714">else</span>&nbsp;<span class="op" id="7297719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7297723">off</span>&nbsp;<span class="op" id="7297727">:=</span>&nbsp;<span class="op" id="7297730">(</span><span class="builtintype" id="7297731">int</span><span class="op" id="7297734">(</span><span class="ident" id="7297735"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297741">.</span><span class="ident" id="7297742"><a href="/gostd/runtime/mem.go.html#1614976">NumGC</a></span><span class="op" id="7297747">)</span>&nbsp;<span class="op" id="7297749">+</span>&nbsp;<span class="builtinfunc" id="7297751">len</span><span class="op" id="7297754">(</span><span class="ident" id="7297755"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297761">.</span><span class="ident" id="7297762"><a href="/gostd/runtime/mem.go.html#1614794">PauseNs</a></span><span class="op" id="7297769">)</span>&nbsp;<span class="op" id="7297771">-</span>&nbsp;<span class="num" id="7297773">1</span><span class="op" id="7297774">)</span>&nbsp;<span class="op" id="7297776">%</span>&nbsp;<span class="builtinfunc" id="7297778">len</span><span class="op" id="7297781">(</span><span class="ident" id="7297782"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297788">.</span><span class="ident" id="7297789"><a href="/gostd/runtime/mem.go.html#1614794">PauseNs</a></span><span class="op" id="7297796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7297800">for</span>&nbsp;<span class="ident" id="7297804">i</span>&nbsp;<span class="op" id="7297806">:=</span>&nbsp;<span class="num" id="7297809">0</span><span class="op" id="7297810">;</span>&nbsp;<span class="ident" id="7297812"><a href="/gostd/runtime/debug/garbage_test.go.html#7297804">i</a></span>&nbsp;<span class="op" id="7297814">&lt;</span>&nbsp;<span class="ident" id="7297816"><a href="/gostd/runtime/debug/garbage_test.go.html#7297535">n</a></span><span class="op" id="7297817">;</span>&nbsp;<span class="ident" id="7297819"><a href="/gostd/runtime/debug/garbage_test.go.html#7297804">i</a></span><span class="op" id="7297820">++</span>&nbsp;<span class="op" id="7297823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7297828">dt</span>&nbsp;<span class="op" id="7297831">:=</span>&nbsp;<span class="ident" id="7297834"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7297839">.</span><span class="ident" id="7297840"><a href="/gostd/runtime/debug/garbage.go.html#5439359">Pause</a></span><span class="op" id="7297845">[</span><span class="ident" id="7297846"><a href="/gostd/runtime/debug/garbage_test.go.html#7297804">i</a></span><span class="op" id="7297847">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7297852">if</span>&nbsp;<span class="ident" id="7297855"><a href="/gostd/runtime/debug/garbage_test.go.html#7297828">dt</a></span>&nbsp;<span class="op" id="7297858">!=</span>&nbsp;<span class="ident" id="7297861"><a href="/gostd/runtime/debug/garbage_test.go.html#7296586">time</a></span><span class="op" id="7297865">.</span><span class="ident" id="7297866"><a href="/gostd/time/time.go.html#2734212">Duration</a></span><span class="op" id="7297874">(</span><span class="ident" id="7297875"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297881">.</span><span class="ident" id="7297882"><a href="/gostd/runtime/mem.go.html#1614794">PauseNs</a></span><span class="op" id="7297889">[</span><span class="ident" id="7297890"><a href="/gostd/runtime/debug/garbage_test.go.html#7297723">off</a></span><span class="op" id="7297893">]</span><span class="op" id="7297894">)</span>&nbsp;<span class="op" id="7297896">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7297902"><a href="/gostd/runtime/debug/garbage_test.go.html#7296617">t</a></span><span class="op" id="7297903">.</span><span class="ident" id="7297904"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7297910">(</span><span class="string" id="7297911">&#34;stats.Pause[%d]&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7297942">,</span>&nbsp;<span class="ident" id="7297944"><a href="/gostd/runtime/debug/garbage_test.go.html#7297804">i</a></span><span class="op" id="7297945">,</span>&nbsp;<span class="ident" id="7297947"><a href="/gostd/runtime/debug/garbage_test.go.html#7297828">dt</a></span><span class="op" id="7297949">,</span>&nbsp;<span class="ident" id="7297951"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7297957">.</span><span class="ident" id="7297958"><a href="/gostd/runtime/mem.go.html#1614794">PauseNs</a></span><span class="op" id="7297965">[</span><span class="ident" id="7297966"><a href="/gostd/runtime/debug/garbage_test.go.html#7297723">off</a></span><span class="op" id="7297969">]</span><span class="op" id="7297970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7297975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7297980">if</span>&nbsp;<span class="ident" id="7297983"><a href="/gostd/runtime/debug/garbage_test.go.html#7296730">max</a></span>&nbsp;<span class="op" id="7297987">&lt;</span>&nbsp;<span class="ident" id="7297989"><a href="/gostd/runtime/debug/garbage_test.go.html#7297828">dt</a></span>&nbsp;<span class="op" id="7297992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7297998"><a href="/gostd/runtime/debug/garbage_test.go.html#7296730">max</a></span>&nbsp;<span class="op" id="7298002">=</span>&nbsp;<span class="ident" id="7298004"><a href="/gostd/runtime/debug/garbage_test.go.html#7297828">dt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7298010">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7298015">if</span>&nbsp;<span class="ident" id="7298018"><a href="/gostd/runtime/debug/garbage_test.go.html#7296725">min</a></span>&nbsp;<span class="op" id="7298022">&gt;</span>&nbsp;<span class="ident" id="7298024"><a href="/gostd/runtime/debug/garbage_test.go.html#7297828">dt</a></span>&nbsp;<span class="op" id="7298027">||</span>&nbsp;<span class="ident" id="7298030"><a href="/gostd/runtime/debug/garbage_test.go.html#7297804">i</a></span>&nbsp;<span class="op" id="7298032">==</span>&nbsp;<span class="num" id="7298035">0</span>&nbsp;<span class="op" id="7298037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7298043"><a href="/gostd/runtime/debug/garbage_test.go.html#7296725">min</a></span>&nbsp;<span class="op" id="7298047">=</span>&nbsp;<span class="ident" id="7298049"><a href="/gostd/runtime/debug/garbage_test.go.html#7297828">dt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7298055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7298060"><a href="/gostd/runtime/debug/garbage_test.go.html#7297723">off</a></span>&nbsp;<span class="op" id="7298064">=</span>&nbsp;<span class="op" id="7298066">(</span><span class="ident" id="7298067"><a href="/gostd/runtime/debug/garbage_test.go.html#7297723">off</a></span>&nbsp;<span class="op" id="7298071">+</span>&nbsp;<span class="builtinfunc" id="7298073">len</span><span class="op" id="7298076">(</span><span class="ident" id="7298077"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7298083">.</span><span class="ident" id="7298084"><a href="/gostd/runtime/mem.go.html#1614794">PauseNs</a></span><span class="op" id="7298091">)</span>&nbsp;<span class="op" id="7298093">-</span>&nbsp;<span class="num" id="7298095">1</span><span class="op" id="7298096">)</span>&nbsp;<span class="op" id="7298098">%</span>&nbsp;<span class="builtinfunc" id="7298100">len</span><span class="op" id="7298103">(</span><span class="ident" id="7298104"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7298110">.</span><span class="ident" id="7298111"><a href="/gostd/runtime/mem.go.html#1614794">PauseNs</a></span><span class="op" id="7298118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7298122">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7298125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7298129">q</span>&nbsp;<span class="op" id="7298131">:=</span>&nbsp;<span class="ident" id="7298134"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7298139">.</span><span class="ident" id="7298140"><a href="/gostd/runtime/debug/garbage.go.html#5439505">PauseQuantiles</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7298156">nq</span>&nbsp;<span class="op" id="7298159">:=</span>&nbsp;<span class="builtinfunc" id="7298162">len</span><span class="op" id="7298165">(</span><span class="ident" id="7298166"><a href="/gostd/runtime/debug/garbage_test.go.html#7298129">q</a></span><span class="op" id="7298167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7298170">if</span>&nbsp;<span class="ident" id="7298173"><a href="/gostd/runtime/debug/garbage_test.go.html#7298129">q</a></span><span class="op" id="7298174">[</span><span class="num" id="7298175">0</span><span class="op" id="7298176">]</span>&nbsp;<span class="op" id="7298178">!=</span>&nbsp;<span class="ident" id="7298181"><a href="/gostd/runtime/debug/garbage_test.go.html#7296725">min</a></span>&nbsp;<span class="op" id="7298185">||</span>&nbsp;<span class="ident" id="7298188"><a href="/gostd/runtime/debug/garbage_test.go.html#7298129">q</a></span><span class="op" id="7298189">[</span><span class="ident" id="7298190"><a href="/gostd/runtime/debug/garbage_test.go.html#7298156">nq</a></span><span class="op" id="7298192">-</span><span class="num" id="7298193">1</span><span class="op" id="7298194">]</span>&nbsp;<span class="op" id="7298196">!=</span>&nbsp;<span class="ident" id="7298199"><a href="/gostd/runtime/debug/garbage_test.go.html#7296730">max</a></span>&nbsp;<span class="op" id="7298203">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7298207"><a href="/gostd/runtime/debug/garbage_test.go.html#7296617">t</a></span><span class="op" id="7298208">.</span><span class="ident" id="7298209"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7298215">(</span><span class="string" id="7298216">&#34;stats.PauseQuantiles&nbsp;=&nbsp;[%d,&nbsp;...,&nbsp;%d],&nbsp;want&nbsp;[%d,&nbsp;...,&nbsp;%d]&#34;</span><span class="op" id="7298274">,</span>&nbsp;<span class="ident" id="7298276"><a href="/gostd/runtime/debug/garbage_test.go.html#7298129">q</a></span><span class="op" id="7298277">[</span><span class="num" id="7298278">0</span><span class="op" id="7298279">]</span><span class="op" id="7298280">,</span>&nbsp;<span class="ident" id="7298282"><a href="/gostd/runtime/debug/garbage_test.go.html#7298129">q</a></span><span class="op" id="7298283">[</span><span class="ident" id="7298284"><a href="/gostd/runtime/debug/garbage_test.go.html#7298156">nq</a></span><span class="op" id="7298286">-</span><span class="num" id="7298287">1</span><span class="op" id="7298288">]</span><span class="op" id="7298289">,</span>&nbsp;<span class="ident" id="7298291"><a href="/gostd/runtime/debug/garbage_test.go.html#7296725">min</a></span><span class="op" id="7298294">,</span>&nbsp;<span class="ident" id="7298296"><a href="/gostd/runtime/debug/garbage_test.go.html#7296730">max</a></span><span class="op" id="7298299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7298302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7298306">for</span>&nbsp;<span class="ident" id="7298310">i</span>&nbsp;<span class="op" id="7298312">:=</span>&nbsp;<span class="num" id="7298315">0</span><span class="op" id="7298316">;</span>&nbsp;<span class="ident" id="7298318"><a href="/gostd/runtime/debug/garbage_test.go.html#7298310">i</a></span>&nbsp;<span class="op" id="7298320">&lt;</span>&nbsp;<span class="ident" id="7298322"><a href="/gostd/runtime/debug/garbage_test.go.html#7298156">nq</a></span><span class="op" id="7298324">-</span><span class="num" id="7298325">1</span><span class="op" id="7298326">;</span>&nbsp;<span class="ident" id="7298328"><a href="/gostd/runtime/debug/garbage_test.go.html#7298310">i</a></span><span class="op" id="7298329">++</span>&nbsp;<span class="op" id="7298332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7298336">if</span>&nbsp;<span class="ident" id="7298339"><a href="/gostd/runtime/debug/garbage_test.go.html#7298129">q</a></span><span class="op" id="7298340">[</span><span class="ident" id="7298341"><a href="/gostd/runtime/debug/garbage_test.go.html#7298310">i</a></span><span class="op" id="7298342">]</span>&nbsp;<span class="op" id="7298344">&gt;</span>&nbsp;<span class="ident" id="7298346"><a href="/gostd/runtime/debug/garbage_test.go.html#7298129">q</a></span><span class="op" id="7298347">[</span><span class="ident" id="7298348"><a href="/gostd/runtime/debug/garbage_test.go.html#7298310">i</a></span><span class="op" id="7298349">+</span><span class="num" id="7298350">1</span><span class="op" id="7298351">]</span>&nbsp;<span class="op" id="7298353">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7298358"><a href="/gostd/runtime/debug/garbage_test.go.html#7296617">t</a></span><span class="op" id="7298359">.</span><span class="ident" id="7298360"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7298366">(</span><span class="string" id="7298367">&#34;stats.PauseQuantiles[%d]=%d&nbsp;&gt;&nbsp;stats.PauseQuantiles[%d]=%d&#34;</span><span class="op" id="7298426">,</span>&nbsp;<span class="ident" id="7298428"><a href="/gostd/runtime/debug/garbage_test.go.html#7298310">i</a></span><span class="op" id="7298429">,</span>&nbsp;<span class="ident" id="7298431"><a href="/gostd/runtime/debug/garbage_test.go.html#7298129">q</a></span><span class="op" id="7298432">[</span><span class="ident" id="7298433"><a href="/gostd/runtime/debug/garbage_test.go.html#7298310">i</a></span><span class="op" id="7298434">]</span><span class="op" id="7298435">,</span>&nbsp;<span class="ident" id="7298437"><a href="/gostd/runtime/debug/garbage_test.go.html#7298310">i</a></span><span class="op" id="7298438">+</span><span class="num" id="7298439">1</span><span class="op" id="7298440">,</span>&nbsp;<span class="ident" id="7298442"><a href="/gostd/runtime/debug/garbage_test.go.html#7298129">q</a></span><span class="op" id="7298443">[</span><span class="ident" id="7298444"><a href="/gostd/runtime/debug/garbage_test.go.html#7298310">i</a></span><span class="op" id="7298445">+</span><span class="num" id="7298446">1</span><span class="op" id="7298447">]</span><span class="op" id="7298448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7298452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7298455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7298459">//&nbsp;compare&nbsp;memory&nbsp;stats&nbsp;with&nbsp;gc&nbsp;stats:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7298499">if</span>&nbsp;<span class="builtinfunc" id="7298502">len</span><span class="op" id="7298505">(</span><span class="ident" id="7298506"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7298511">.</span><span class="ident" id="7298512"><a href="/gostd/runtime/debug/garbage.go.html#5439427">PauseEnd</a></span><span class="op" id="7298520">)</span>&nbsp;<span class="op" id="7298522">!=</span>&nbsp;<span class="ident" id="7298525"><a href="/gostd/runtime/debug/garbage_test.go.html#7297535">n</a></span>&nbsp;<span class="op" id="7298527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7298531"><a href="/gostd/runtime/debug/garbage_test.go.html#7296617">t</a></span><span class="op" id="7298532">.</span><span class="ident" id="7298533"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7298539">(</span><span class="string" id="7298540">&#34;len(stats.PauseEnd)&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7298575">,</span>&nbsp;<span class="builtinfunc" id="7298577">len</span><span class="op" id="7298580">(</span><span class="ident" id="7298581"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7298586">.</span><span class="ident" id="7298587"><a href="/gostd/runtime/debug/garbage.go.html#5439427">PauseEnd</a></span><span class="op" id="7298595">)</span><span class="op" id="7298596">,</span>&nbsp;<span class="ident" id="7298598"><a href="/gostd/runtime/debug/garbage_test.go.html#7297535">n</a></span><span class="op" id="7298599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7298602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7298605">off</span>&nbsp;<span class="op" id="7298609">:=</span>&nbsp;<span class="op" id="7298612">(</span><span class="builtintype" id="7298613">int</span><span class="op" id="7298616">(</span><span class="ident" id="7298617"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7298623">.</span><span class="ident" id="7298624"><a href="/gostd/runtime/mem.go.html#1614976">NumGC</a></span><span class="op" id="7298629">)</span>&nbsp;<span class="op" id="7298631">+</span>&nbsp;<span class="builtinfunc" id="7298633">len</span><span class="op" id="7298636">(</span><span class="ident" id="7298637"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7298643">.</span><span class="ident" id="7298644"><a href="/gostd/runtime/mem.go.html#1614902">PauseEnd</a></span><span class="op" id="7298652">)</span>&nbsp;<span class="op" id="7298654">-</span>&nbsp;<span class="num" id="7298656">1</span><span class="op" id="7298657">)</span>&nbsp;<span class="op" id="7298659">%</span>&nbsp;<span class="builtinfunc" id="7298661">len</span><span class="op" id="7298664">(</span><span class="ident" id="7298665"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7298671">.</span><span class="ident" id="7298672"><a href="/gostd/runtime/mem.go.html#1614902">PauseEnd</a></span><span class="op" id="7298680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7298683">for</span>&nbsp;<span class="ident" id="7298687">i</span>&nbsp;<span class="op" id="7298689">:=</span>&nbsp;<span class="num" id="7298692">0</span><span class="op" id="7298693">;</span>&nbsp;<span class="ident" id="7298695"><a href="/gostd/runtime/debug/garbage_test.go.html#7298687">i</a></span>&nbsp;<span class="op" id="7298697">&lt;</span>&nbsp;<span class="ident" id="7298699"><a href="/gostd/runtime/debug/garbage_test.go.html#7297535">n</a></span><span class="op" id="7298700">;</span>&nbsp;<span class="ident" id="7298702"><a href="/gostd/runtime/debug/garbage_test.go.html#7298687">i</a></span><span class="op" id="7298703">++</span>&nbsp;<span class="op" id="7298706">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7298710">dt</span>&nbsp;<span class="op" id="7298713">:=</span>&nbsp;<span class="ident" id="7298716"><a href="/gostd/runtime/debug/garbage_test.go.html#7296677">stats</a></span><span class="op" id="7298721">.</span><span class="ident" id="7298722"><a href="/gostd/runtime/debug/garbage.go.html#5439427">PauseEnd</a></span><span class="op" id="7298730">[</span><span class="ident" id="7298731"><a href="/gostd/runtime/debug/garbage_test.go.html#7298687">i</a></span><span class="op" id="7298732">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7298736">if</span>&nbsp;<span class="ident" id="7298739"><a href="/gostd/runtime/debug/garbage_test.go.html#7298710">dt</a></span><span class="op" id="7298741">.</span><span class="ident" id="7298742"><a href="/gostd/time/time.go.html#2744495">UnixNano</a></span><span class="op" id="7298750">(</span><span class="op" id="7298751">)</span>&nbsp;<span class="op" id="7298753">!=</span>&nbsp;<span class="builtintype" id="7298756">int64</span><span class="op" id="7298761">(</span><span class="ident" id="7298762"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7298768">.</span><span class="ident" id="7298769"><a href="/gostd/runtime/mem.go.html#1614902">PauseEnd</a></span><span class="op" id="7298777">[</span><span class="ident" id="7298778"><a href="/gostd/runtime/debug/garbage_test.go.html#7298605">off</a></span><span class="op" id="7298781">]</span><span class="op" id="7298782">)</span>&nbsp;<span class="op" id="7298784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7298789"><a href="/gostd/runtime/debug/garbage_test.go.html#7296617">t</a></span><span class="op" id="7298790">.</span><span class="ident" id="7298791"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7298797">(</span><span class="string" id="7298798">&#34;stats.PauseEnd[%d]&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7298832">,</span>&nbsp;<span class="ident" id="7298834"><a href="/gostd/runtime/debug/garbage_test.go.html#7298687">i</a></span><span class="op" id="7298835">,</span>&nbsp;<span class="ident" id="7298837"><a href="/gostd/runtime/debug/garbage_test.go.html#7298710">dt</a></span><span class="op" id="7298839">,</span>&nbsp;<span class="ident" id="7298841"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7298847">.</span><span class="ident" id="7298848"><a href="/gostd/runtime/mem.go.html#1614902">PauseEnd</a></span><span class="op" id="7298856">[</span><span class="ident" id="7298857"><a href="/gostd/runtime/debug/garbage_test.go.html#7298605">off</a></span><span class="op" id="7298860">]</span><span class="op" id="7298861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7298865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7298869"><a href="/gostd/runtime/debug/garbage_test.go.html#7298605">off</a></span>&nbsp;<span class="op" id="7298873">=</span>&nbsp;<span class="op" id="7298875">(</span><span class="ident" id="7298876"><a href="/gostd/runtime/debug/garbage_test.go.html#7298605">off</a></span>&nbsp;<span class="op" id="7298880">+</span>&nbsp;<span class="builtinfunc" id="7298882">len</span><span class="op" id="7298885">(</span><span class="ident" id="7298886"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7298892">.</span><span class="ident" id="7298893"><a href="/gostd/runtime/mem.go.html#1614902">PauseEnd</a></span><span class="op" id="7298901">)</span>&nbsp;<span class="op" id="7298903">-</span>&nbsp;<span class="num" id="7298905">1</span><span class="op" id="7298906">)</span>&nbsp;<span class="op" id="7298908">%</span>&nbsp;<span class="builtinfunc" id="7298910">len</span><span class="op" id="7298913">(</span><span class="ident" id="7298914"><a href="/gostd/runtime/debug/garbage_test.go.html#7296696">mstats</a></span><span class="op" id="7298920">.</span><span class="ident" id="7298921"><a href="/gostd/runtime/mem.go.html#1614902">PauseEnd</a></span><span class="op" id="7298929">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7298932">}</span><br>
<span class="lineno"></span><span class="op" id="7298934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7298937">var</span>&nbsp;<span class="ident" id="7298941">big</span>&nbsp;<span class="op" id="7298945">=</span>&nbsp;<span class="builtinfunc" id="7298947">make</span><span class="op" id="7298951">(</span><span class="op" id="7298952">[</span><span class="op" id="7298953">]</span><span class="builtintype" id="7298954">byte</span><span class="op" id="7298958">,</span>&nbsp;<span class="num" id="7298960">1</span><span class="op" id="7298961">&lt;&lt;</span><span class="num" id="7298963">20</span><span class="op" id="7298965">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7298968">func</span>&nbsp;<span class="ident" id="7298973">TestFreeOSMemory</span><span class="op" id="7298989">(</span><span class="ident" id="7298990">t</span>&nbsp;<span class="op" id="7298992">*</span><span class="ident" id="7298993"><a href="/gostd/runtime/debug/garbage_test.go.html#7296575">testing</a></span><span class="op" id="7299000">.</span><span class="ident" id="7299001"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7299002">)</span>&nbsp;<span class="op" id="7299004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7299007">var</span>&nbsp;<span class="ident" id="7299011">ms1</span><span class="op" id="7299014">,</span>&nbsp;<span class="ident" id="7299016">ms2</span>&nbsp;<span class="ident" id="7299020"><a href="/gostd/runtime/debug/garbage_test.go.html#7296564">runtime</a></span><span class="op" id="7299027">.</span><span class="ident" id="7299028"><a href="/gostd/runtime/mem.go.html#1613431">MemStats</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7299039">if</span>&nbsp;<span class="ident" id="7299042"><a href="/gostd/runtime/debug/garbage_test.go.html#7298941">big</a></span>&nbsp;<span class="op" id="7299046">==</span>&nbsp;<span class="builtintype" id="7299049">nil</span>&nbsp;<span class="op" id="7299053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7299057"><a href="/gostd/runtime/debug/garbage_test.go.html#7298990">t</a></span><span class="op" id="7299058">.</span><span class="ident" id="7299059"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="7299063">(</span><span class="string" id="7299064">&#34;test&nbsp;is&nbsp;not&nbsp;reliable&nbsp;when&nbsp;run&nbsp;multiple&nbsp;times&#34;</span><span class="op" id="7299110">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7299113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7299116"><a href="/gostd/runtime/debug/garbage_test.go.html#7298941">big</a></span>&nbsp;<span class="op" id="7299120">=</span>&nbsp;<span class="builtintype" id="7299122">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7299127"><a href="/gostd/runtime/debug/garbage_test.go.html#7296564">runtime</a></span><span class="op" id="7299134">.</span><span class="ident" id="7299135"><a href="/gostd/runtime/malloc.go.html#1602269">GC</a></span><span class="op" id="7299137">(</span><span class="op" id="7299138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7299141"><a href="/gostd/runtime/debug/garbage_test.go.html#7296564">runtime</a></span><span class="op" id="7299148">.</span><span class="ident" id="7299149"><a href="/gostd/runtime/mem.go.html#1615506">ReadMemStats</a></span><span class="op" id="7299161">(</span><span class="op" id="7299162">&amp;</span><span class="ident" id="7299163"><a href="/gostd/runtime/debug/garbage_test.go.html#7299011">ms1</a></span><span class="op" id="7299166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7299169"><a href="/gostd/runtime/debug/garbage.go.html#5442936">FreeOSMemory</a></span><span class="op" id="7299181">(</span><span class="op" id="7299182">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7299185"><a href="/gostd/runtime/debug/garbage_test.go.html#7296564">runtime</a></span><span class="op" id="7299192">.</span><span class="ident" id="7299193"><a href="/gostd/runtime/mem.go.html#1615506">ReadMemStats</a></span><span class="op" id="7299205">(</span><span class="op" id="7299206">&amp;</span><span class="ident" id="7299207"><a href="/gostd/runtime/debug/garbage_test.go.html#7299016">ms2</a></span><span class="op" id="7299210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7299213">if</span>&nbsp;<span class="ident" id="7299216"><a href="/gostd/runtime/debug/garbage_test.go.html#7299011">ms1</a></span><span class="op" id="7299219">.</span><span class="ident" id="7299220"><a href="/gostd/runtime/mem.go.html#1614017">HeapReleased</a></span>&nbsp;<span class="op" id="7299233">&gt;=</span>&nbsp;<span class="ident" id="7299236"><a href="/gostd/runtime/debug/garbage_test.go.html#7299016">ms2</a></span><span class="op" id="7299239">.</span><span class="ident" id="7299240"><a href="/gostd/runtime/mem.go.html#1614017">HeapReleased</a></span>&nbsp;<span class="op" id="7299253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7299257"><a href="/gostd/runtime/debug/garbage_test.go.html#7298990">t</a></span><span class="op" id="7299258">.</span><span class="ident" id="7299259"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7299265">(</span><span class="string" id="7299266">&#34;released&nbsp;before=%d;&nbsp;released&nbsp;after=%d;&nbsp;did&nbsp;not&nbsp;go&nbsp;up&#34;</span><span class="op" id="7299320">,</span>&nbsp;<span class="ident" id="7299322"><a href="/gostd/runtime/debug/garbage_test.go.html#7299011">ms1</a></span><span class="op" id="7299325">.</span><span class="ident" id="7299326"><a href="/gostd/runtime/mem.go.html#1614017">HeapReleased</a></span><span class="op" id="7299338">,</span>&nbsp;<span class="ident" id="7299340"><a href="/gostd/runtime/debug/garbage_test.go.html#7299016">ms2</a></span><span class="op" id="7299343">.</span><span class="ident" id="7299344"><a href="/gostd/runtime/mem.go.html#1614017">HeapReleased</a></span><span class="op" id="7299356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7299359">}</span><br>
<span class="lineno"></span><span class="op" id="7299361">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="7299364">func</span>&nbsp;<span class="ident" id="7299369">TestSetGCPercent</span><span class="op" id="7299385">(</span><span class="ident" id="7299386">t</span>&nbsp;<span class="op" id="7299388">*</span><span class="ident" id="7299389"><a href="/gostd/runtime/debug/garbage_test.go.html#7296575">testing</a></span><span class="op" id="7299396">.</span><span class="ident" id="7299397"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7299398">)</span>&nbsp;<span class="op" id="7299400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7299403">//&nbsp;Test&nbsp;that&nbsp;the&nbsp;variable&nbsp;is&nbsp;being&nbsp;set&nbsp;and&nbsp;returned&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7299467">//&nbsp;Assume&nbsp;the&nbsp;percentage&nbsp;itself&nbsp;is&nbsp;implemented&nbsp;fine&nbsp;during&nbsp;GC,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7299531">//&nbsp;which&nbsp;is&nbsp;harder&nbsp;to&nbsp;test.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7299560">old</span>&nbsp;<span class="op" id="7299564">:=</span>&nbsp;<span class="ident" id="7299567"><a href="/gostd/runtime/debug/garbage.go.html#5442577">SetGCPercent</a></span><span class="op" id="7299579">(</span><span class="num" id="7299580">123</span><span class="op" id="7299583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7299586">new</span>&nbsp;<span class="op" id="7299590">:=</span>&nbsp;<span class="ident" id="7299593"><a href="/gostd/runtime/debug/garbage.go.html#5442577">SetGCPercent</a></span><span class="op" id="7299605">(</span><span class="ident" id="7299606"><a href="/gostd/runtime/debug/garbage_test.go.html#7299560">old</a></span><span class="op" id="7299609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7299612">if</span>&nbsp;<span class="builtinfunc" id="7299615"><a href="/gostd/runtime/debug/garbage_test.go.html#7299586">new</a></span>&nbsp;<span class="op" id="7299619">!=</span>&nbsp;<span class="num" id="7299622">123</span>&nbsp;<span class="op" id="7299626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7299630"><a href="/gostd/runtime/debug/garbage_test.go.html#7299386">t</a></span><span class="op" id="7299631">.</span><span class="ident" id="7299632"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7299638">(</span><span class="string" id="7299639">&#34;SetGCPercent(123);&nbsp;SetGCPercent(x)&nbsp;=&nbsp;%d,&nbsp;want&nbsp;123&#34;</span><span class="op" id="7299690">,</span>&nbsp;<span class="builtinfunc" id="7299692"><a href="/gostd/runtime/debug/garbage_test.go.html#7299586">new</a></span><span class="op" id="7299695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7299698">}</span><br>
<span class="lineno">115</span><span class="op" id="7299700">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
