<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6658272">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6658327">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6658381">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6658432">package</span>&nbsp;<span class="ident" id="6658440">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6658445">import</span>&nbsp;<span class="op" id="6658452">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6658455">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6658465">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="6658468">func</span>&nbsp;<span class="ident" id="6658473">TestRoundUp</span><span class="op" id="6658484">(</span><span class="ident" id="6658485">t</span>&nbsp;<span class="op" id="6658487">*</span><span class="ident" id="6658488">testing</span><span class="op" id="6658495">.</span><span class="ident" id="6658496">T</span><span class="op" id="6658497">)</span>&nbsp;<span class="op" id="6658499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658502">if</span>&nbsp;<span class="ident" id="6658505">roundUp</span><span class="op" id="6658512">(</span><span class="num" id="6658513">0</span><span class="op" id="6658514">,</span>&nbsp;<span class="num" id="6658516">16</span><span class="op" id="6658518">)</span>&nbsp;<span class="op" id="6658520">!=</span>&nbsp;<span class="num" id="6658523">0</span>&nbsp;<span class="op" id="6658525">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658530">roundUp</span><span class="op" id="6658537">(</span><span class="num" id="6658538">1</span><span class="op" id="6658539">,</span>&nbsp;<span class="num" id="6658541">16</span><span class="op" id="6658543">)</span>&nbsp;<span class="op" id="6658545">!=</span>&nbsp;<span class="num" id="6658548">16</span>&nbsp;<span class="op" id="6658551">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658556">roundUp</span><span class="op" id="6658563">(</span><span class="num" id="6658564">15</span><span class="op" id="6658566">,</span>&nbsp;<span class="num" id="6658568">16</span><span class="op" id="6658570">)</span>&nbsp;<span class="op" id="6658572">!=</span>&nbsp;<span class="num" id="6658575">16</span>&nbsp;<span class="op" id="6658578">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658583">roundUp</span><span class="op" id="6658590">(</span><span class="num" id="6658591">16</span><span class="op" id="6658593">,</span>&nbsp;<span class="num" id="6658595">16</span><span class="op" id="6658597">)</span>&nbsp;<span class="op" id="6658599">!=</span>&nbsp;<span class="num" id="6658602">16</span>&nbsp;<span class="op" id="6658605">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658610">roundUp</span><span class="op" id="6658617">(</span><span class="num" id="6658618">17</span><span class="op" id="6658620">,</span>&nbsp;<span class="num" id="6658622">16</span><span class="op" id="6658624">)</span>&nbsp;<span class="op" id="6658626">!=</span>&nbsp;<span class="num" id="6658629">32</span>&nbsp;<span class="op" id="6658632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658636">t</span><span class="op" id="6658637">.</span><span class="ident" id="6658638">Error</span><span class="op" id="6658643">(</span><span class="string" id="6658644">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="6658660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658663">}</span><br>
<span class="lineno"></span><span class="op" id="6658665">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="6658668">var</span>&nbsp;<span class="ident" id="6658672">paddingTests</span>&nbsp;<span class="op" id="6658685">=</span>&nbsp;<span class="op" id="6658687">[</span><span class="op" id="6658688">]</span><span class="keyword" id="6658689">struct</span>&nbsp;<span class="op" id="6658696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658699">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6658711">[</span><span class="op" id="6658712">]</span><span class="builtintype" id="6658713">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658719">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6658731">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658737">expectedLen</span>&nbsp;<span class="builtintype" id="6658749">int</span><br>
<span class="lineno">25</span><span class="op" id="6658753">}</span><span class="op" id="6658754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658757">{</span><span class="op" id="6658758">[</span><span class="op" id="6658759">]</span><span class="builtintype" id="6658760">byte</span><span class="op" id="6658764">{</span><span class="num" id="6658765">1</span><span class="op" id="6658766">,</span>&nbsp;<span class="num" id="6658768">2</span><span class="op" id="6658769">,</span>&nbsp;<span class="num" id="6658771">3</span><span class="op" id="6658772">,</span>&nbsp;<span class="num" id="6658774">4</span><span class="op" id="6658775">,</span>&nbsp;<span class="num" id="6658777">0</span><span class="op" id="6658778">}</span><span class="op" id="6658779">,</span>&nbsp;<span class="builtintype" id="6658781">true</span><span class="op" id="6658785">,</span>&nbsp;<span class="num" id="6658787">4</span><span class="op" id="6658788">}</span><span class="op" id="6658789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658792">{</span><span class="op" id="6658793">[</span><span class="op" id="6658794">]</span><span class="builtintype" id="6658795">byte</span><span class="op" id="6658799">{</span><span class="num" id="6658800">1</span><span class="op" id="6658801">,</span>&nbsp;<span class="num" id="6658803">2</span><span class="op" id="6658804">,</span>&nbsp;<span class="num" id="6658806">3</span><span class="op" id="6658807">,</span>&nbsp;<span class="num" id="6658809">4</span><span class="op" id="6658810">,</span>&nbsp;<span class="num" id="6658812">0</span><span class="op" id="6658813">,</span>&nbsp;<span class="num" id="6658815">1</span><span class="op" id="6658816">}</span><span class="op" id="6658817">,</span>&nbsp;<span class="builtintype" id="6658819">false</span><span class="op" id="6658824">,</span>&nbsp;<span class="num" id="6658826">0</span><span class="op" id="6658827">}</span><span class="op" id="6658828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658831">{</span><span class="op" id="6658832">[</span><span class="op" id="6658833">]</span><span class="builtintype" id="6658834">byte</span><span class="op" id="6658838">{</span><span class="num" id="6658839">1</span><span class="op" id="6658840">,</span>&nbsp;<span class="num" id="6658842">2</span><span class="op" id="6658843">,</span>&nbsp;<span class="num" id="6658845">3</span><span class="op" id="6658846">,</span>&nbsp;<span class="num" id="6658848">4</span><span class="op" id="6658849">,</span>&nbsp;<span class="num" id="6658851">99</span><span class="op" id="6658853">,</span>&nbsp;<span class="num" id="6658855">99</span><span class="op" id="6658857">}</span><span class="op" id="6658858">,</span>&nbsp;<span class="builtintype" id="6658860">false</span><span class="op" id="6658865">,</span>&nbsp;<span class="num" id="6658867">0</span><span class="op" id="6658868">}</span><span class="op" id="6658869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658872">{</span><span class="op" id="6658873">[</span><span class="op" id="6658874">]</span><span class="builtintype" id="6658875">byte</span><span class="op" id="6658879">{</span><span class="num" id="6658880">1</span><span class="op" id="6658881">,</span>&nbsp;<span class="num" id="6658883">2</span><span class="op" id="6658884">,</span>&nbsp;<span class="num" id="6658886">3</span><span class="op" id="6658887">,</span>&nbsp;<span class="num" id="6658889">4</span><span class="op" id="6658890">,</span>&nbsp;<span class="num" id="6658892">1</span><span class="op" id="6658893">,</span>&nbsp;<span class="num" id="6658895">1</span><span class="op" id="6658896">}</span><span class="op" id="6658897">,</span>&nbsp;<span class="builtintype" id="6658899">true</span><span class="op" id="6658903">,</span>&nbsp;<span class="num" id="6658905">4</span><span class="op" id="6658906">}</span><span class="op" id="6658907">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658910">{</span><span class="op" id="6658911">[</span><span class="op" id="6658912">]</span><span class="builtintype" id="6658913">byte</span><span class="op" id="6658917">{</span><span class="num" id="6658918">1</span><span class="op" id="6658919">,</span>&nbsp;<span class="num" id="6658921">2</span><span class="op" id="6658922">,</span>&nbsp;<span class="num" id="6658924">3</span><span class="op" id="6658925">,</span>&nbsp;<span class="num" id="6658927">2</span><span class="op" id="6658928">,</span>&nbsp;<span class="num" id="6658930">2</span><span class="op" id="6658931">,</span>&nbsp;<span class="num" id="6658933">2</span><span class="op" id="6658934">}</span><span class="op" id="6658935">,</span>&nbsp;<span class="builtintype" id="6658937">true</span><span class="op" id="6658941">,</span>&nbsp;<span class="num" id="6658943">3</span><span class="op" id="6658944">}</span><span class="op" id="6658945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658948">{</span><span class="op" id="6658949">[</span><span class="op" id="6658950">]</span><span class="builtintype" id="6658951">byte</span><span class="op" id="6658955">{</span><span class="num" id="6658956">1</span><span class="op" id="6658957">,</span>&nbsp;<span class="num" id="6658959">2</span><span class="op" id="6658960">,</span>&nbsp;<span class="num" id="6658962">3</span><span class="op" id="6658963">,</span>&nbsp;<span class="num" id="6658965">3</span><span class="op" id="6658966">,</span>&nbsp;<span class="num" id="6658968">3</span><span class="op" id="6658969">,</span>&nbsp;<span class="num" id="6658971">3</span><span class="op" id="6658972">}</span><span class="op" id="6658973">,</span>&nbsp;<span class="builtintype" id="6658975">true</span><span class="op" id="6658979">,</span>&nbsp;<span class="num" id="6658981">2</span><span class="op" id="6658982">}</span><span class="op" id="6658983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658986">{</span><span class="op" id="6658987">[</span><span class="op" id="6658988">]</span><span class="builtintype" id="6658989">byte</span><span class="op" id="6658993">{</span><span class="num" id="6658994">1</span><span class="op" id="6658995">,</span>&nbsp;<span class="num" id="6658997">2</span><span class="op" id="6658998">,</span>&nbsp;<span class="num" id="6659000">3</span><span class="op" id="6659001">,</span>&nbsp;<span class="num" id="6659003">4</span><span class="op" id="6659004">,</span>&nbsp;<span class="num" id="6659006">3</span><span class="op" id="6659007">,</span>&nbsp;<span class="num" id="6659009">3</span><span class="op" id="6659010">}</span><span class="op" id="6659011">,</span>&nbsp;<span class="builtintype" id="6659013">false</span><span class="op" id="6659018">,</span>&nbsp;<span class="num" id="6659020">0</span><span class="op" id="6659021">}</span><span class="op" id="6659022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659025">{</span><span class="op" id="6659026">[</span><span class="op" id="6659027">]</span><span class="builtintype" id="6659028">byte</span><span class="op" id="6659032">{</span><span class="num" id="6659033">1</span><span class="op" id="6659034">,</span>&nbsp;<span class="num" id="6659036">4</span><span class="op" id="6659037">,</span>&nbsp;<span class="num" id="6659039">4</span><span class="op" id="6659040">,</span>&nbsp;<span class="num" id="6659042">4</span><span class="op" id="6659043">,</span>&nbsp;<span class="num" id="6659045">4</span><span class="op" id="6659046">,</span>&nbsp;<span class="num" id="6659048">4</span><span class="op" id="6659049">}</span><span class="op" id="6659050">,</span>&nbsp;<span class="builtintype" id="6659052">true</span><span class="op" id="6659056">,</span>&nbsp;<span class="num" id="6659058">1</span><span class="op" id="6659059">}</span><span class="op" id="6659060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659063">{</span><span class="op" id="6659064">[</span><span class="op" id="6659065">]</span><span class="builtintype" id="6659066">byte</span><span class="op" id="6659070">{</span><span class="num" id="6659071">5</span><span class="op" id="6659072">,</span>&nbsp;<span class="num" id="6659074">5</span><span class="op" id="6659075">,</span>&nbsp;<span class="num" id="6659077">5</span><span class="op" id="6659078">,</span>&nbsp;<span class="num" id="6659080">5</span><span class="op" id="6659081">,</span>&nbsp;<span class="num" id="6659083">5</span><span class="op" id="6659084">,</span>&nbsp;<span class="num" id="6659086">5</span><span class="op" id="6659087">}</span><span class="op" id="6659088">,</span>&nbsp;<span class="builtintype" id="6659090">true</span><span class="op" id="6659094">,</span>&nbsp;<span class="num" id="6659096">0</span><span class="op" id="6659097">}</span><span class="op" id="6659098">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659101">{</span><span class="op" id="6659102">[</span><span class="op" id="6659103">]</span><span class="builtintype" id="6659104">byte</span><span class="op" id="6659108">{</span><span class="num" id="6659109">6</span><span class="op" id="6659110">,</span>&nbsp;<span class="num" id="6659112">6</span><span class="op" id="6659113">,</span>&nbsp;<span class="num" id="6659115">6</span><span class="op" id="6659116">,</span>&nbsp;<span class="num" id="6659118">6</span><span class="op" id="6659119">,</span>&nbsp;<span class="num" id="6659121">6</span><span class="op" id="6659122">,</span>&nbsp;<span class="num" id="6659124">6</span><span class="op" id="6659125">}</span><span class="op" id="6659126">,</span>&nbsp;<span class="builtintype" id="6659128">false</span><span class="op" id="6659133">,</span>&nbsp;<span class="num" id="6659135">0</span><span class="op" id="6659136">}</span><span class="op" id="6659137">,</span><br>
<span class="lineno"></span><span class="op" id="6659139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6659142">func</span>&nbsp;<span class="ident" id="6659147">TestRemovePadding</span><span class="op" id="6659164">(</span><span class="ident" id="6659165">t</span>&nbsp;<span class="op" id="6659167">*</span><span class="ident" id="6659168">testing</span><span class="op" id="6659175">.</span><span class="ident" id="6659176">T</span><span class="op" id="6659177">)</span>&nbsp;<span class="op" id="6659179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659182">for</span>&nbsp;<span class="ident" id="6659186">i</span><span class="op" id="6659187">,</span>&nbsp;<span class="ident" id="6659189">test</span>&nbsp;<span class="op" id="6659194">:=</span>&nbsp;<span class="keyword" id="6659197">range</span>&nbsp;<span class="ident" id="6659203">paddingTests</span>&nbsp;<span class="op" id="6659216">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659220">payload</span><span class="op" id="6659227">,</span>&nbsp;<span class="ident" id="6659229">good</span>&nbsp;<span class="op" id="6659234">:=</span>&nbsp;<span class="ident" id="6659237">removePadding</span><span class="op" id="6659250">(</span><span class="ident" id="6659251">test</span><span class="op" id="6659255">.</span><span class="ident" id="6659256">in</span><span class="op" id="6659258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659262">expectedGood</span>&nbsp;<span class="op" id="6659275">:=</span>&nbsp;<span class="builtintype" id="6659278">byte</span><span class="op" id="6659282">(</span><span class="num" id="6659283">255</span><span class="op" id="6659286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659290">if</span>&nbsp;<span class="op" id="6659293">!</span><span class="ident" id="6659294">test</span><span class="op" id="6659298">.</span><span class="ident" id="6659299">good</span>&nbsp;<span class="op" id="6659304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659309">expectedGood</span>&nbsp;<span class="op" id="6659322">=</span>&nbsp;<span class="num" id="6659324">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659328">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659332">if</span>&nbsp;<span class="ident" id="6659335">good</span>&nbsp;<span class="op" id="6659340">!=</span>&nbsp;<span class="ident" id="6659343">expectedGood</span>&nbsp;<span class="op" id="6659356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659361">t</span><span class="op" id="6659362">.</span><span class="ident" id="6659363">Errorf</span><span class="op" id="6659369">(</span><span class="string" id="6659370">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="6659407">,</span>&nbsp;<span class="ident" id="6659409">i</span><span class="op" id="6659410">,</span>&nbsp;<span class="ident" id="6659412">expectedGood</span><span class="op" id="6659424">,</span>&nbsp;<span class="ident" id="6659426">good</span><span class="op" id="6659430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659438">if</span>&nbsp;<span class="ident" id="6659441">good</span>&nbsp;<span class="op" id="6659446">==</span>&nbsp;<span class="num" id="6659449">255</span>&nbsp;<span class="op" id="6659453">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6659456">len</span><span class="op" id="6659459">(</span><span class="ident" id="6659460">payload</span><span class="op" id="6659467">)</span>&nbsp;<span class="op" id="6659469">!=</span>&nbsp;<span class="ident" id="6659472">test</span><span class="op" id="6659476">.</span><span class="ident" id="6659477">expectedLen</span>&nbsp;<span class="op" id="6659489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659494">t</span><span class="op" id="6659495">.</span><span class="ident" id="6659496">Errorf</span><span class="op" id="6659502">(</span><span class="string" id="6659503">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6659525">,</span>&nbsp;<span class="ident" id="6659527">i</span><span class="op" id="6659528">,</span>&nbsp;<span class="builtinfunc" id="6659530">len</span><span class="op" id="6659533">(</span><span class="ident" id="6659534">payload</span><span class="op" id="6659541">)</span><span class="op" id="6659542">,</span>&nbsp;<span class="ident" id="6659544">test</span><span class="op" id="6659548">.</span><span class="ident" id="6659549">expectedLen</span><span class="op" id="6659560">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659567">}</span><br>
<span class="lineno"></span><span class="op" id="6659569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6659572">var</span>&nbsp;<span class="ident" id="6659576">certExampleCom</span>&nbsp;<span class="op" id="6659591">=</span>&nbsp;<span class="string" id="6659593">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="6660245">var</span>&nbsp;<span class="ident" id="6660249">certWildcardExampleCom</span>&nbsp;<span class="op" id="6660272">=</span>&nbsp;<span class="string" id="6660274">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6660930">var</span>&nbsp;<span class="ident" id="6660934">certFooExampleCom</span>&nbsp;<span class="op" id="6660952">=</span>&nbsp;<span class="string" id="6660954">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="6661614">var</span>&nbsp;<span class="ident" id="6661618">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="6661647">=</span>&nbsp;<span class="string" id="6661649">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6662309">func</span>&nbsp;<span class="ident" id="6662314">TestCertificateSelection</span><span class="op" id="6662338">(</span><span class="ident" id="6662339">t</span>&nbsp;<span class="op" id="6662341">*</span><span class="ident" id="6662342">testing</span><span class="op" id="6662349">.</span><span class="ident" id="6662350">T</span><span class="op" id="6662351">)</span>&nbsp;<span class="op" id="6662353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662356">config</span>&nbsp;<span class="op" id="6662363">:=</span>&nbsp;<span class="ident" id="6662366">Config</span><span class="op" id="6662372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662376">Certificates</span><span class="op" id="6662388">:</span>&nbsp;<span class="op" id="6662390">[</span><span class="op" id="6662391">]</span><span class="ident" id="6662392">Certificate</span><span class="op" id="6662403">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662414">Certificate</span><span class="op" id="6662425">:</span>&nbsp;<span class="op" id="6662427">[</span><span class="op" id="6662428">]</span><span class="op" id="6662429">[</span><span class="op" id="6662430">]</span><span class="builtintype" id="6662431">byte</span><span class="op" id="6662435">{</span><span class="ident" id="6662436">fromHex</span><span class="op" id="6662443">(</span><span class="ident" id="6662444">certExampleCom</span><span class="op" id="6662458">)</span><span class="op" id="6662459">}</span><span class="op" id="6662460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662465">}</span><span class="op" id="6662466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662477">Certificate</span><span class="op" id="6662488">:</span>&nbsp;<span class="op" id="6662490">[</span><span class="op" id="6662491">]</span><span class="op" id="6662492">[</span><span class="op" id="6662493">]</span><span class="builtintype" id="6662494">byte</span><span class="op" id="6662498">{</span><span class="ident" id="6662499">fromHex</span><span class="op" id="6662506">(</span><span class="ident" id="6662507">certWildcardExampleCom</span><span class="op" id="6662529">)</span><span class="op" id="6662530">}</span><span class="op" id="6662531">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662536">}</span><span class="op" id="6662537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662548">Certificate</span><span class="op" id="6662559">:</span>&nbsp;<span class="op" id="6662561">[</span><span class="op" id="6662562">]</span><span class="op" id="6662563">[</span><span class="op" id="6662564">]</span><span class="builtintype" id="6662565">byte</span><span class="op" id="6662569">{</span><span class="ident" id="6662570">fromHex</span><span class="op" id="6662577">(</span><span class="ident" id="6662578">certFooExampleCom</span><span class="op" id="6662595">)</span><span class="op" id="6662596">}</span><span class="op" id="6662597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662602">}</span><span class="op" id="6662603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662608">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662614">Certificate</span><span class="op" id="6662625">:</span>&nbsp;<span class="op" id="6662627">[</span><span class="op" id="6662628">]</span><span class="op" id="6662629">[</span><span class="op" id="6662630">]</span><span class="builtintype" id="6662631">byte</span><span class="op" id="6662635">{</span><span class="ident" id="6662636">fromHex</span><span class="op" id="6662643">(</span><span class="ident" id="6662644">certDoubleWildcardExampleCom</span><span class="op" id="6662672">)</span><span class="op" id="6662673">}</span><span class="op" id="6662674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662679">}</span><span class="op" id="6662680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662684">}</span><span class="op" id="6662685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662692">config</span><span class="op" id="6662698">.</span><span class="ident" id="6662699">BuildNameToCertificate</span><span class="op" id="6662721">(</span><span class="op" id="6662722">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662726">pointerToIndex</span>&nbsp;<span class="op" id="6662741">:=</span>&nbsp;<span class="keyword" id="6662744">func</span><span class="op" id="6662748">(</span><span class="ident" id="6662749">c</span>&nbsp;<span class="op" id="6662751">*</span><span class="ident" id="6662752">Certificate</span><span class="op" id="6662763">)</span>&nbsp;<span class="builtintype" id="6662765">int</span>&nbsp;<span class="op" id="6662769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662773">for</span>&nbsp;<span class="ident" id="6662777">i</span>&nbsp;<span class="op" id="6662779">:=</span>&nbsp;<span class="keyword" id="6662782">range</span>&nbsp;<span class="ident" id="6662788">config</span><span class="op" id="6662794">.</span><span class="ident" id="6662795">Certificates</span>&nbsp;<span class="op" id="6662808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662813">if</span>&nbsp;<span class="ident" id="6662816">c</span>&nbsp;<span class="op" id="6662818">==</span>&nbsp;<span class="op" id="6662821">&amp;</span><span class="ident" id="6662822">config</span><span class="op" id="6662828">.</span><span class="ident" id="6662829">Certificates</span><span class="op" id="6662841">[</span><span class="ident" id="6662842">i</span><span class="op" id="6662843">]</span>&nbsp;<span class="op" id="6662845">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662851">return</span>&nbsp;<span class="ident" id="6662858">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662871">return</span>&nbsp;<span class="op" id="6662878">-</span><span class="num" id="6662879">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662882">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662886">certificateForName</span>&nbsp;<span class="op" id="6662905">:=</span>&nbsp;<span class="keyword" id="6662908">func</span><span class="op" id="6662912">(</span><span class="ident" id="6662913">name</span>&nbsp;<span class="builtintype" id="6662918">string</span><span class="op" id="6662924">)</span>&nbsp;<span class="op" id="6662926">*</span><span class="ident" id="6662927">Certificate</span>&nbsp;<span class="op" id="6662939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662943">clientHello</span>&nbsp;<span class="op" id="6662955">:=</span>&nbsp;<span class="op" id="6662958">&amp;</span><span class="ident" id="6662959">ClientHelloInfo</span><span class="op" id="6662974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662979">ServerName</span><span class="op" id="6662989">:</span>&nbsp;<span class="ident" id="6662991">name</span><span class="op" id="6662995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662999">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663003">if</span>&nbsp;<span class="ident" id="6663006">cert</span><span class="op" id="6663010">,</span>&nbsp;<span class="ident" id="6663012">err</span>&nbsp;<span class="op" id="6663016">:=</span>&nbsp;<span class="ident" id="6663019">config</span><span class="op" id="6663025">.</span><span class="ident" id="6663026">getCertificate</span><span class="op" id="6663040">(</span><span class="ident" id="6663041">clientHello</span><span class="op" id="6663052">)</span><span class="op" id="6663053">;</span>&nbsp;<span class="ident" id="6663055">err</span>&nbsp;<span class="op" id="6663059">!=</span>&nbsp;<span class="ident" id="6663062">nil</span>&nbsp;<span class="op" id="6663066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663071">t</span><span class="op" id="6663072">.</span><span class="ident" id="6663073">Errorf</span><span class="op" id="6663079">(</span><span class="string" id="6663080">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="6663125">,</span>&nbsp;<span class="ident" id="6663127">name</span><span class="op" id="6663131">,</span>&nbsp;<span class="ident" id="6663133">err</span><span class="op" id="6663136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663141">return</span>&nbsp;<span class="ident" id="6663148">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663154">}</span>&nbsp;<span class="keyword" id="6663156">else</span>&nbsp;<span class="op" id="6663161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663166">return</span>&nbsp;<span class="ident" id="6663173">cert</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663187">if</span>&nbsp;<span class="ident" id="6663190">n</span>&nbsp;<span class="op" id="6663192">:=</span>&nbsp;<span class="ident" id="6663195">pointerToIndex</span><span class="op" id="6663209">(</span><span class="ident" id="6663210">certificateForName</span><span class="op" id="6663228">(</span><span class="string" id="6663229">&#34;example.com&#34;</span><span class="op" id="6663242">)</span><span class="op" id="6663243">)</span><span class="op" id="6663244">;</span>&nbsp;<span class="ident" id="6663246">n</span>&nbsp;<span class="op" id="6663248">!=</span>&nbsp;<span class="num" id="6663251">0</span>&nbsp;<span class="op" id="6663253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663257">t</span><span class="op" id="6663258">.</span><span class="ident" id="6663259">Errorf</span><span class="op" id="6663265">(</span><span class="string" id="6663266">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="6663310">,</span>&nbsp;<span class="ident" id="6663312">n</span><span class="op" id="6663313">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663319">if</span>&nbsp;<span class="ident" id="6663322">n</span>&nbsp;<span class="op" id="6663324">:=</span>&nbsp;<span class="ident" id="6663327">pointerToIndex</span><span class="op" id="6663341">(</span><span class="ident" id="6663342">certificateForName</span><span class="op" id="6663360">(</span><span class="string" id="6663361">&#34;bar.example.com&#34;</span><span class="op" id="6663378">)</span><span class="op" id="6663379">)</span><span class="op" id="6663380">;</span>&nbsp;<span class="ident" id="6663382">n</span>&nbsp;<span class="op" id="6663384">!=</span>&nbsp;<span class="num" id="6663387">1</span>&nbsp;<span class="op" id="6663389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663393">t</span><span class="op" id="6663394">.</span><span class="ident" id="6663395">Errorf</span><span class="op" id="6663401">(</span><span class="string" id="6663402">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="6663450">,</span>&nbsp;<span class="ident" id="6663452">n</span><span class="op" id="6663453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663459">if</span>&nbsp;<span class="ident" id="6663462">n</span>&nbsp;<span class="op" id="6663464">:=</span>&nbsp;<span class="ident" id="6663467">pointerToIndex</span><span class="op" id="6663481">(</span><span class="ident" id="6663482">certificateForName</span><span class="op" id="6663500">(</span><span class="string" id="6663501">&#34;foo.example.com&#34;</span><span class="op" id="6663518">)</span><span class="op" id="6663519">)</span><span class="op" id="6663520">;</span>&nbsp;<span class="ident" id="6663522">n</span>&nbsp;<span class="op" id="6663524">!=</span>&nbsp;<span class="num" id="6663527">2</span>&nbsp;<span class="op" id="6663529">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663533">t</span><span class="op" id="6663534">.</span><span class="ident" id="6663535">Errorf</span><span class="op" id="6663541">(</span><span class="string" id="6663542">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="6663590">,</span>&nbsp;<span class="ident" id="6663592">n</span><span class="op" id="6663593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663599">if</span>&nbsp;<span class="ident" id="6663602">n</span>&nbsp;<span class="op" id="6663604">:=</span>&nbsp;<span class="ident" id="6663607">pointerToIndex</span><span class="op" id="6663621">(</span><span class="ident" id="6663622">certificateForName</span><span class="op" id="6663640">(</span><span class="string" id="6663641">&#34;foo.bar.example.com&#34;</span><span class="op" id="6663662">)</span><span class="op" id="6663663">)</span><span class="op" id="6663664">;</span>&nbsp;<span class="ident" id="6663666">n</span>&nbsp;<span class="op" id="6663668">!=</span>&nbsp;<span class="num" id="6663671">3</span>&nbsp;<span class="op" id="6663673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663677">t</span><span class="op" id="6663678">.</span><span class="ident" id="6663679">Errorf</span><span class="op" id="6663685">(</span><span class="string" id="6663686">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="6663738">,</span>&nbsp;<span class="ident" id="6663740">n</span><span class="op" id="6663741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663744">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663747">if</span>&nbsp;<span class="ident" id="6663750">n</span>&nbsp;<span class="op" id="6663752">:=</span>&nbsp;<span class="ident" id="6663755">pointerToIndex</span><span class="op" id="6663769">(</span><span class="ident" id="6663770">certificateForName</span><span class="op" id="6663788">(</span><span class="string" id="6663789">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="6663814">)</span><span class="op" id="6663815">)</span><span class="op" id="6663816">;</span>&nbsp;<span class="ident" id="6663818">n</span>&nbsp;<span class="op" id="6663820">!=</span>&nbsp;<span class="num" id="6663823">0</span>&nbsp;<span class="op" id="6663825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663829">t</span><span class="op" id="6663830">.</span><span class="ident" id="6663831">Errorf</span><span class="op" id="6663837">(</span><span class="string" id="6663838">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="6663894">,</span>&nbsp;<span class="ident" id="6663896">n</span><span class="op" id="6663897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663900">}</span><br>
<span class="lineno"></span><span class="op" id="6663902">}</span>
</div>
</body>
</html>
