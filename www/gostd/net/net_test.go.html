<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6659231">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6659286">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6659340">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6659391">package</span>&nbsp;<span class="ident" id="6659399">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6659404">import</span>&nbsp;<span class="op" id="6659411">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6659414">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6659420">&#34;io/ioutil&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6659433">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6659439">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6659450">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6659461">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6659468">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6659471">func</span>&nbsp;<span class="ident" id="6659476">TestShutdown</span><span class="op" id="6659488">(</span><span class="ident" id="6659489">t</span>&nbsp;<span class="op" id="6659491">*</span><span class="ident" id="6659492">testing</span><span class="op" id="6659499">.</span><span class="ident" id="6659500">T</span><span class="op" id="6659501">)</span>&nbsp;<span class="op" id="6659503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659506">if</span>&nbsp;<span class="ident" id="6659509">runtime</span><span class="op" id="6659516">.</span><span class="ident" id="6659517">GOOS</span>&nbsp;<span class="op" id="6659522">==</span>&nbsp;<span class="string" id="6659525">&#34;plan9&#34;</span>&nbsp;<span class="op" id="6659533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659537">t</span><span class="op" id="6659538">.</span><span class="ident" id="6659539">Skipf</span><span class="op" id="6659544">(</span><span class="string" id="6659545">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6659566">,</span>&nbsp;<span class="ident" id="6659568">runtime</span><span class="op" id="6659575">.</span><span class="ident" id="6659576">GOOS</span><span class="op" id="6659580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659583">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659586">ln</span><span class="op" id="6659588">,</span>&nbsp;<span class="ident" id="6659590">err</span>&nbsp;<span class="op" id="6659594">:=</span>&nbsp;<span class="ident" id="6659597">Listen</span><span class="op" id="6659603">(</span><span class="string" id="6659604">&#34;tcp&#34;</span><span class="op" id="6659609">,</span>&nbsp;<span class="string" id="6659611">&#34;127.0.0.1:0&#34;</span><span class="op" id="6659624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659627">if</span>&nbsp;<span class="ident" id="6659630">err</span>&nbsp;<span class="op" id="6659634">!=</span>&nbsp;<span class="ident" id="6659637">nil</span>&nbsp;<span class="op" id="6659641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659645">if</span>&nbsp;<span class="ident" id="6659648">ln</span><span class="op" id="6659650">,</span>&nbsp;<span class="ident" id="6659652">err</span>&nbsp;<span class="op" id="6659656">=</span>&nbsp;<span class="ident" id="6659658">Listen</span><span class="op" id="6659664">(</span><span class="string" id="6659665">&#34;tcp6&#34;</span><span class="op" id="6659671">,</span>&nbsp;<span class="string" id="6659673">&#34;[::1]:0&#34;</span><span class="op" id="6659682">)</span><span class="op" id="6659683">;</span>&nbsp;<span class="ident" id="6659685">err</span>&nbsp;<span class="op" id="6659689">!=</span>&nbsp;<span class="ident" id="6659692">nil</span>&nbsp;<span class="op" id="6659696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659701">t</span><span class="op" id="6659702">.</span><span class="ident" id="6659703">Fatalf</span><span class="op" id="6659709">(</span><span class="string" id="6659710">&#34;ListenTCP&nbsp;on&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="6659731">,</span>&nbsp;<span class="ident" id="6659733">err</span><span class="op" id="6659736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659740">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659747">go</span>&nbsp;<span class="keyword" id="6659750">func</span><span class="op" id="6659754">(</span><span class="op" id="6659755">)</span>&nbsp;<span class="op" id="6659757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659761">defer</span>&nbsp;<span class="ident" id="6659767">ln</span><span class="op" id="6659769">.</span><span class="ident" id="6659770">Close</span><span class="op" id="6659775">(</span><span class="op" id="6659776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659780">c</span><span class="op" id="6659781">,</span>&nbsp;<span class="ident" id="6659783">err</span>&nbsp;<span class="op" id="6659787">:=</span>&nbsp;<span class="ident" id="6659790">ln</span><span class="op" id="6659792">.</span><span class="ident" id="6659793">Accept</span><span class="op" id="6659799">(</span><span class="op" id="6659800">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659804">if</span>&nbsp;<span class="ident" id="6659807">err</span>&nbsp;<span class="op" id="6659811">!=</span>&nbsp;<span class="ident" id="6659814">nil</span>&nbsp;<span class="op" id="6659818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659823">t</span><span class="op" id="6659824">.</span><span class="ident" id="6659825">Errorf</span><span class="op" id="6659831">(</span><span class="string" id="6659832">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6659844">,</span>&nbsp;<span class="ident" id="6659846">err</span><span class="op" id="6659849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659854">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659867">var</span>&nbsp;<span class="ident" id="6659871">buf</span>&nbsp;<span class="op" id="6659875">[</span><span class="num" id="6659876">10</span><span class="op" id="6659878">]</span><span class="builtintype" id="6659879">byte</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659886">n</span><span class="op" id="6659887">,</span>&nbsp;<span class="ident" id="6659889">err</span>&nbsp;<span class="op" id="6659893">:=</span>&nbsp;<span class="ident" id="6659896">c</span><span class="op" id="6659897">.</span><span class="ident" id="6659898">Read</span><span class="op" id="6659902">(</span><span class="ident" id="6659903">buf</span><span class="op" id="6659906">[</span><span class="op" id="6659907">:</span><span class="op" id="6659908">]</span><span class="op" id="6659909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659913">if</span>&nbsp;<span class="ident" id="6659916">n</span>&nbsp;<span class="op" id="6659918">!=</span>&nbsp;<span class="num" id="6659921">0</span>&nbsp;<span class="op" id="6659923">||</span>&nbsp;<span class="ident" id="6659926">err</span>&nbsp;<span class="op" id="6659930">!=</span>&nbsp;<span class="ident" id="6659933">io</span><span class="op" id="6659935">.</span><span class="ident" id="6659936">EOF</span>&nbsp;<span class="op" id="6659940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659945">t</span><span class="op" id="6659946">.</span><span class="ident" id="6659947">Errorf</span><span class="op" id="6659953">(</span><span class="string" id="6659954">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="6659992">,</span>&nbsp;<span class="ident" id="6659994">n</span><span class="op" id="6659995">,</span>&nbsp;<span class="ident" id="6659997">err</span><span class="op" id="6660000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660005">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660014">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660018">c</span><span class="op" id="6660019">.</span><span class="ident" id="6660020">Write</span><span class="op" id="6660025">(</span><span class="op" id="6660026">[</span><span class="op" id="6660027">]</span><span class="builtintype" id="6660028">byte</span><span class="op" id="6660032">(</span><span class="string" id="6660033">&#34;response&#34;</span><span class="op" id="6660043">)</span><span class="op" id="6660044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660048">c</span><span class="op" id="6660049">.</span><span class="ident" id="6660050">Close</span><span class="op" id="6660055">(</span><span class="op" id="6660056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660059">}</span><span class="op" id="6660060">(</span><span class="op" id="6660061">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660065">c</span><span class="op" id="6660066">,</span>&nbsp;<span class="ident" id="6660068">err</span>&nbsp;<span class="op" id="6660072">:=</span>&nbsp;<span class="ident" id="6660075">Dial</span><span class="op" id="6660079">(</span><span class="string" id="6660080">&#34;tcp&#34;</span><span class="op" id="6660085">,</span>&nbsp;<span class="ident" id="6660087">ln</span><span class="op" id="6660089">.</span><span class="ident" id="6660090">Addr</span><span class="op" id="6660094">(</span><span class="op" id="6660095">)</span><span class="op" id="6660096">.</span><span class="ident" id="6660097">String</span><span class="op" id="6660103">(</span><span class="op" id="6660104">)</span><span class="op" id="6660105">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660108">if</span>&nbsp;<span class="ident" id="6660111">err</span>&nbsp;<span class="op" id="6660115">!=</span>&nbsp;<span class="ident" id="6660118">nil</span>&nbsp;<span class="op" id="6660122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660126">t</span><span class="op" id="6660127">.</span><span class="ident" id="6660128">Fatalf</span><span class="op" id="6660134">(</span><span class="string" id="6660135">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6660145">,</span>&nbsp;<span class="ident" id="6660147">err</span><span class="op" id="6660150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660156">defer</span>&nbsp;<span class="ident" id="6660162">c</span><span class="op" id="6660163">.</span><span class="ident" id="6660164">Close</span><span class="op" id="6660169">(</span><span class="op" id="6660170">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660174">err</span>&nbsp;<span class="op" id="6660178">=</span>&nbsp;<span class="ident" id="6660180">c</span><span class="op" id="6660181">.</span><span class="op" id="6660182">(</span><span class="op" id="6660183">*</span><span class="ident" id="6660184">TCPConn</span><span class="op" id="6660191">)</span><span class="op" id="6660192">.</span><span class="ident" id="6660193">CloseWrite</span><span class="op" id="6660203">(</span><span class="op" id="6660204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660207">if</span>&nbsp;<span class="ident" id="6660210">err</span>&nbsp;<span class="op" id="6660214">!=</span>&nbsp;<span class="ident" id="6660217">nil</span>&nbsp;<span class="op" id="6660221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660225">t</span><span class="op" id="6660226">.</span><span class="ident" id="6660227">Fatalf</span><span class="op" id="6660233">(</span><span class="string" id="6660234">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="6660250">,</span>&nbsp;<span class="ident" id="6660252">err</span><span class="op" id="6660255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660261">var</span>&nbsp;<span class="ident" id="6660265">buf</span>&nbsp;<span class="op" id="6660269">[</span><span class="num" id="6660270">10</span><span class="op" id="6660272">]</span><span class="builtintype" id="6660273">byte</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660279">n</span><span class="op" id="6660280">,</span>&nbsp;<span class="ident" id="6660282">err</span>&nbsp;<span class="op" id="6660286">:=</span>&nbsp;<span class="ident" id="6660289">c</span><span class="op" id="6660290">.</span><span class="ident" id="6660291">Read</span><span class="op" id="6660295">(</span><span class="ident" id="6660296">buf</span><span class="op" id="6660299">[</span><span class="op" id="6660300">:</span><span class="op" id="6660301">]</span><span class="op" id="6660302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660305">if</span>&nbsp;<span class="ident" id="6660308">err</span>&nbsp;<span class="op" id="6660312">!=</span>&nbsp;<span class="ident" id="6660315">nil</span>&nbsp;<span class="op" id="6660319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660323">t</span><span class="op" id="6660324">.</span><span class="ident" id="6660325">Fatalf</span><span class="op" id="6660331">(</span><span class="string" id="6660332">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6660353">,</span>&nbsp;<span class="ident" id="6660355">n</span><span class="op" id="6660356">,</span>&nbsp;<span class="ident" id="6660358">err</span><span class="op" id="6660361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660367">got</span>&nbsp;<span class="op" id="6660371">:=</span>&nbsp;<span class="builtintype" id="6660374">string</span><span class="op" id="6660380">(</span><span class="ident" id="6660381">buf</span><span class="op" id="6660384">[</span><span class="op" id="6660385">:</span><span class="ident" id="6660386">n</span><span class="op" id="6660387">]</span><span class="op" id="6660388">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660391">if</span>&nbsp;<span class="ident" id="6660394">got</span>&nbsp;<span class="op" id="6660398">!=</span>&nbsp;<span class="string" id="6660401">&#34;response&#34;</span>&nbsp;<span class="op" id="6660412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660416">t</span><span class="op" id="6660417">.</span><span class="ident" id="6660418">Errorf</span><span class="op" id="6660424">(</span><span class="string" id="6660425">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="6660455">,</span>&nbsp;<span class="ident" id="6660457">got</span><span class="op" id="6660460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660463">}</span><br>
<span class="lineno"></span><span class="op" id="6660465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6660468">func</span>&nbsp;<span class="ident" id="6660473">TestShutdownUnix</span><span class="op" id="6660489">(</span><span class="ident" id="6660490">t</span>&nbsp;<span class="op" id="6660492">*</span><span class="ident" id="6660493">testing</span><span class="op" id="6660500">.</span><span class="ident" id="6660501">T</span><span class="op" id="6660502">)</span>&nbsp;<span class="op" id="6660504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660507">switch</span>&nbsp;<span class="ident" id="6660514">runtime</span><span class="op" id="6660521">.</span><span class="ident" id="6660522">GOOS</span>&nbsp;<span class="op" id="6660527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660530">case</span>&nbsp;<span class="string" id="6660535">&#34;nacl&#34;</span><span class="op" id="6660541">,</span>&nbsp;<span class="string" id="6660543">&#34;plan9&#34;</span><span class="op" id="6660550">,</span>&nbsp;<span class="string" id="6660552">&#34;windows&#34;</span><span class="op" id="6660561">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660565">t</span><span class="op" id="6660566">.</span><span class="ident" id="6660567">Skipf</span><span class="op" id="6660572">(</span><span class="string" id="6660573">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6660594">,</span>&nbsp;<span class="ident" id="6660596">runtime</span><span class="op" id="6660603">.</span><span class="ident" id="6660604">GOOS</span><span class="op" id="6660608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660611">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660614">f</span><span class="op" id="6660615">,</span>&nbsp;<span class="ident" id="6660617">err</span>&nbsp;<span class="op" id="6660621">:=</span>&nbsp;<span class="ident" id="6660624">ioutil</span><span class="op" id="6660630">.</span><span class="ident" id="6660631">TempFile</span><span class="op" id="6660639">(</span><span class="string" id="6660640">&#34;&#34;</span><span class="op" id="6660642">,</span>&nbsp;<span class="string" id="6660644">&#34;go_net_unixtest&#34;</span><span class="op" id="6660661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660664">if</span>&nbsp;<span class="ident" id="6660667">err</span>&nbsp;<span class="op" id="6660671">!=</span>&nbsp;<span class="ident" id="6660674">nil</span>&nbsp;<span class="op" id="6660678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660682">t</span><span class="op" id="6660683">.</span><span class="ident" id="6660684">Fatalf</span><span class="op" id="6660690">(</span><span class="string" id="6660691">&#34;TempFile:&nbsp;%s&#34;</span><span class="op" id="6660705">,</span>&nbsp;<span class="ident" id="6660707">err</span><span class="op" id="6660710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660716">f</span><span class="op" id="6660717">.</span><span class="ident" id="6660718">Close</span><span class="op" id="6660723">(</span><span class="op" id="6660724">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660727">tmpname</span>&nbsp;<span class="op" id="6660735">:=</span>&nbsp;<span class="ident" id="6660738">f</span><span class="op" id="6660739">.</span><span class="ident" id="6660740">Name</span><span class="op" id="6660744">(</span><span class="op" id="6660745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660748">os</span><span class="op" id="6660750">.</span><span class="ident" id="6660751">Remove</span><span class="op" id="6660757">(</span><span class="ident" id="6660758">tmpname</span><span class="op" id="6660765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660768">ln</span><span class="op" id="6660770">,</span>&nbsp;<span class="ident" id="6660772">err</span>&nbsp;<span class="op" id="6660776">:=</span>&nbsp;<span class="ident" id="6660779">Listen</span><span class="op" id="6660785">(</span><span class="string" id="6660786">&#34;unix&#34;</span><span class="op" id="6660792">,</span>&nbsp;<span class="ident" id="6660794">tmpname</span><span class="op" id="6660801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660804">if</span>&nbsp;<span class="ident" id="6660807">err</span>&nbsp;<span class="op" id="6660811">!=</span>&nbsp;<span class="ident" id="6660814">nil</span>&nbsp;<span class="op" id="6660818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660822">t</span><span class="op" id="6660823">.</span><span class="ident" id="6660824">Fatalf</span><span class="op" id="6660830">(</span><span class="string" id="6660831">&#34;ListenUnix&nbsp;on&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="6660853">,</span>&nbsp;<span class="ident" id="6660855">tmpname</span><span class="op" id="6660862">,</span>&nbsp;<span class="ident" id="6660864">err</span><span class="op" id="6660867">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660873">defer</span>&nbsp;<span class="keyword" id="6660879">func</span><span class="op" id="6660883">(</span><span class="op" id="6660884">)</span>&nbsp;<span class="op" id="6660886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660890">ln</span><span class="op" id="6660892">.</span><span class="ident" id="6660893">Close</span><span class="op" id="6660898">(</span><span class="op" id="6660899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660903">os</span><span class="op" id="6660905">.</span><span class="ident" id="6660906">Remove</span><span class="op" id="6660912">(</span><span class="ident" id="6660913">tmpname</span><span class="op" id="6660920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660923">}</span><span class="op" id="6660924">(</span><span class="op" id="6660925">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660929">go</span>&nbsp;<span class="keyword" id="6660932">func</span><span class="op" id="6660936">(</span><span class="op" id="6660937">)</span>&nbsp;<span class="op" id="6660939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660943">c</span><span class="op" id="6660944">,</span>&nbsp;<span class="ident" id="6660946">err</span>&nbsp;<span class="op" id="6660950">:=</span>&nbsp;<span class="ident" id="6660953">ln</span><span class="op" id="6660955">.</span><span class="ident" id="6660956">Accept</span><span class="op" id="6660962">(</span><span class="op" id="6660963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660967">if</span>&nbsp;<span class="ident" id="6660970">err</span>&nbsp;<span class="op" id="6660974">!=</span>&nbsp;<span class="ident" id="6660977">nil</span>&nbsp;<span class="op" id="6660981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660986">t</span><span class="op" id="6660987">.</span><span class="ident" id="6660988">Errorf</span><span class="op" id="6660994">(</span><span class="string" id="6660995">&#34;Accept:&nbsp;%v&#34;</span><span class="op" id="6661007">,</span>&nbsp;<span class="ident" id="6661009">err</span><span class="op" id="6661012">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6661017">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6661026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6661030">var</span>&nbsp;<span class="ident" id="6661034">buf</span>&nbsp;<span class="op" id="6661038">[</span><span class="num" id="6661039">10</span><span class="op" id="6661041">]</span><span class="builtintype" id="6661042">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661049">n</span><span class="op" id="6661050">,</span>&nbsp;<span class="ident" id="6661052">err</span>&nbsp;<span class="op" id="6661056">:=</span>&nbsp;<span class="ident" id="6661059">c</span><span class="op" id="6661060">.</span><span class="ident" id="6661061">Read</span><span class="op" id="6661065">(</span><span class="ident" id="6661066">buf</span><span class="op" id="6661069">[</span><span class="op" id="6661070">:</span><span class="op" id="6661071">]</span><span class="op" id="6661072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6661076">if</span>&nbsp;<span class="ident" id="6661079">n</span>&nbsp;<span class="op" id="6661081">!=</span>&nbsp;<span class="num" id="6661084">0</span>&nbsp;<span class="op" id="6661086">||</span>&nbsp;<span class="ident" id="6661089">err</span>&nbsp;<span class="op" id="6661093">!=</span>&nbsp;<span class="ident" id="6661096">io</span><span class="op" id="6661098">.</span><span class="ident" id="6661099">EOF</span>&nbsp;<span class="op" id="6661103">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661108">t</span><span class="op" id="6661109">.</span><span class="ident" id="6661110">Errorf</span><span class="op" id="6661116">(</span><span class="string" id="6661117">&#34;server&nbsp;Read&nbsp;=&nbsp;%d,&nbsp;%v;&nbsp;want&nbsp;0,&nbsp;io.EOF&#34;</span><span class="op" id="6661155">,</span>&nbsp;<span class="ident" id="6661157">n</span><span class="op" id="6661158">,</span>&nbsp;<span class="ident" id="6661160">err</span><span class="op" id="6661163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6661168">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6661177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661181">c</span><span class="op" id="6661182">.</span><span class="ident" id="6661183">Write</span><span class="op" id="6661188">(</span><span class="op" id="6661189">[</span><span class="op" id="6661190">]</span><span class="builtintype" id="6661191">byte</span><span class="op" id="6661195">(</span><span class="string" id="6661196">&#34;response&#34;</span><span class="op" id="6661206">)</span><span class="op" id="6661207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661211">c</span><span class="op" id="6661212">.</span><span class="ident" id="6661213">Close</span><span class="op" id="6661218">(</span><span class="op" id="6661219">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6661222">}</span><span class="op" id="6661223">(</span><span class="op" id="6661224">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661228">c</span><span class="op" id="6661229">,</span>&nbsp;<span class="ident" id="6661231">err</span>&nbsp;<span class="op" id="6661235">:=</span>&nbsp;<span class="ident" id="6661238">Dial</span><span class="op" id="6661242">(</span><span class="string" id="6661243">&#34;unix&#34;</span><span class="op" id="6661249">,</span>&nbsp;<span class="ident" id="6661251">tmpname</span><span class="op" id="6661258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6661261">if</span>&nbsp;<span class="ident" id="6661264">err</span>&nbsp;<span class="op" id="6661268">!=</span>&nbsp;<span class="ident" id="6661271">nil</span>&nbsp;<span class="op" id="6661275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661279">t</span><span class="op" id="6661280">.</span><span class="ident" id="6661281">Fatalf</span><span class="op" id="6661287">(</span><span class="string" id="6661288">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6661298">,</span>&nbsp;<span class="ident" id="6661300">err</span><span class="op" id="6661303">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6661306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6661309">defer</span>&nbsp;<span class="ident" id="6661315">c</span><span class="op" id="6661316">.</span><span class="ident" id="6661317">Close</span><span class="op" id="6661322">(</span><span class="op" id="6661323">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661327">err</span>&nbsp;<span class="op" id="6661331">=</span>&nbsp;<span class="ident" id="6661333">c</span><span class="op" id="6661334">.</span><span class="op" id="6661335">(</span><span class="op" id="6661336">*</span><span class="ident" id="6661337">UnixConn</span><span class="op" id="6661345">)</span><span class="op" id="6661346">.</span><span class="ident" id="6661347">CloseWrite</span><span class="op" id="6661357">(</span><span class="op" id="6661358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6661361">if</span>&nbsp;<span class="ident" id="6661364">err</span>&nbsp;<span class="op" id="6661368">!=</span>&nbsp;<span class="ident" id="6661371">nil</span>&nbsp;<span class="op" id="6661375">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661379">t</span><span class="op" id="6661380">.</span><span class="ident" id="6661381">Fatalf</span><span class="op" id="6661387">(</span><span class="string" id="6661388">&#34;CloseWrite:&nbsp;%v&#34;</span><span class="op" id="6661404">,</span>&nbsp;<span class="ident" id="6661406">err</span><span class="op" id="6661409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6661412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6661415">var</span>&nbsp;<span class="ident" id="6661419">buf</span>&nbsp;<span class="op" id="6661423">[</span><span class="num" id="6661424">10</span><span class="op" id="6661426">]</span><span class="builtintype" id="6661427">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661433">n</span><span class="op" id="6661434">,</span>&nbsp;<span class="ident" id="6661436">err</span>&nbsp;<span class="op" id="6661440">:=</span>&nbsp;<span class="ident" id="6661443">c</span><span class="op" id="6661444">.</span><span class="ident" id="6661445">Read</span><span class="op" id="6661449">(</span><span class="ident" id="6661450">buf</span><span class="op" id="6661453">[</span><span class="op" id="6661454">:</span><span class="op" id="6661455">]</span><span class="op" id="6661456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6661459">if</span>&nbsp;<span class="ident" id="6661462">err</span>&nbsp;<span class="op" id="6661466">!=</span>&nbsp;<span class="ident" id="6661469">nil</span>&nbsp;<span class="op" id="6661473">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661477">t</span><span class="op" id="6661478">.</span><span class="ident" id="6661479">Fatalf</span><span class="op" id="6661485">(</span><span class="string" id="6661486">&#34;client&nbsp;Read:&nbsp;%d,&nbsp;%v&#34;</span><span class="op" id="6661507">,</span>&nbsp;<span class="ident" id="6661509">n</span><span class="op" id="6661510">,</span>&nbsp;<span class="ident" id="6661512">err</span><span class="op" id="6661515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6661518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661521">got</span>&nbsp;<span class="op" id="6661525">:=</span>&nbsp;<span class="builtintype" id="6661528">string</span><span class="op" id="6661534">(</span><span class="ident" id="6661535">buf</span><span class="op" id="6661538">[</span><span class="op" id="6661539">:</span><span class="ident" id="6661540">n</span><span class="op" id="6661541">]</span><span class="op" id="6661542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6661545">if</span>&nbsp;<span class="ident" id="6661548">got</span>&nbsp;<span class="op" id="6661552">!=</span>&nbsp;<span class="string" id="6661555">&#34;response&#34;</span>&nbsp;<span class="op" id="6661566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661570">t</span><span class="op" id="6661571">.</span><span class="ident" id="6661572">Errorf</span><span class="op" id="6661578">(</span><span class="string" id="6661579">&#34;read&nbsp;=&nbsp;%q,&nbsp;want&nbsp;\&#34;response\&#34;&#34;</span><span class="op" id="6661609">,</span>&nbsp;<span class="ident" id="6661611">got</span><span class="op" id="6661614">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6661617">}</span><br>
<span class="lineno"></span><span class="op" id="6661619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6661622">func</span>&nbsp;<span class="ident" id="6661627">TestTCPListenClose</span><span class="op" id="6661645">(</span><span class="ident" id="6661646">t</span>&nbsp;<span class="op" id="6661648">*</span><span class="ident" id="6661649">testing</span><span class="op" id="6661656">.</span><span class="ident" id="6661657">T</span><span class="op" id="6661658">)</span>&nbsp;<span class="op" id="6661660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661663">ln</span><span class="op" id="6661665">,</span>&nbsp;<span class="ident" id="6661667">err</span>&nbsp;<span class="op" id="6661671">:=</span>&nbsp;<span class="ident" id="6661674">Listen</span><span class="op" id="6661680">(</span><span class="string" id="6661681">&#34;tcp&#34;</span><span class="op" id="6661686">,</span>&nbsp;<span class="string" id="6661688">&#34;127.0.0.1:0&#34;</span><span class="op" id="6661701">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6661704">if</span>&nbsp;<span class="ident" id="6661707">err</span>&nbsp;<span class="op" id="6661711">!=</span>&nbsp;<span class="ident" id="6661714">nil</span>&nbsp;<span class="op" id="6661718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661722">t</span><span class="op" id="6661723">.</span><span class="ident" id="6661724">Fatalf</span><span class="op" id="6661730">(</span><span class="string" id="6661731">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6661750">,</span>&nbsp;<span class="ident" id="6661752">err</span><span class="op" id="6661755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6661758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661762">done</span>&nbsp;<span class="op" id="6661767">:=</span>&nbsp;<span class="builtinfunc" id="6661770">make</span><span class="op" id="6661774">(</span><span class="keyword" id="6661775">chan</span>&nbsp;<span class="builtintype" id="6661780">bool</span><span class="op" id="6661784">,</span>&nbsp;<span class="num" id="6661786">1</span><span class="op" id="6661787">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6661790">go</span>&nbsp;<span class="keyword" id="6661793">func</span><span class="op" id="6661797">(</span><span class="op" id="6661798">)</span>&nbsp;<span class="op" id="6661800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661804">time</span><span class="op" id="6661808">.</span><span class="ident" id="6661809">Sleep</span><span class="op" id="6661814">(</span><span class="num" id="6661815">100</span>&nbsp;<span class="op" id="6661819">*</span>&nbsp;<span class="ident" id="6661821">time</span><span class="op" id="6661825">.</span><span class="ident" id="6661826">Millisecond</span><span class="op" id="6661837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661841">ln</span><span class="op" id="6661843">.</span><span class="ident" id="6661844">Close</span><span class="op" id="6661849">(</span><span class="op" id="6661850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6661853">}</span><span class="op" id="6661854">(</span><span class="op" id="6661855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6661858">go</span>&nbsp;<span class="keyword" id="6661861">func</span><span class="op" id="6661865">(</span><span class="op" id="6661866">)</span>&nbsp;<span class="op" id="6661868">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661872">c</span><span class="op" id="6661873">,</span>&nbsp;<span class="ident" id="6661875">err</span>&nbsp;<span class="op" id="6661879">:=</span>&nbsp;<span class="ident" id="6661882">ln</span><span class="op" id="6661884">.</span><span class="ident" id="6661885">Accept</span><span class="op" id="6661891">(</span><span class="op" id="6661892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6661896">if</span>&nbsp;<span class="ident" id="6661899">err</span>&nbsp;<span class="op" id="6661903">==</span>&nbsp;<span class="ident" id="6661906">nil</span>&nbsp;<span class="op" id="6661910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661915">c</span><span class="op" id="6661916">.</span><span class="ident" id="6661917">Close</span><span class="op" id="6661922">(</span><span class="op" id="6661923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661928">t</span><span class="op" id="6661929">.</span><span class="ident" id="6661930">Error</span><span class="op" id="6661935">(</span><span class="string" id="6661936">&#34;Accept&nbsp;succeeded&#34;</span><span class="op" id="6661954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6661958">}</span>&nbsp;<span class="keyword" id="6661960">else</span>&nbsp;<span class="op" id="6661965">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6661970">t</span><span class="op" id="6661971">.</span><span class="ident" id="6661972">Logf</span><span class="op" id="6661976">(</span><span class="string" id="6661977">&#34;Accept&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="6662023">,</span>&nbsp;<span class="ident" id="6662025">err</span><span class="op" id="6662028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662036">done</span>&nbsp;<span class="op" id="6662041">&lt;-</span>&nbsp;<span class="builtintype" id="6662044">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662050">}</span><span class="op" id="6662051">(</span><span class="op" id="6662052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662055">select</span>&nbsp;<span class="op" id="6662062">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662065">case</span>&nbsp;<span class="op" id="6662070">&lt;-</span><span class="ident" id="6662072">done</span><span class="op" id="6662076">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662079">case</span>&nbsp;<span class="op" id="6662084">&lt;-</span><span class="ident" id="6662086">time</span><span class="op" id="6662090">.</span><span class="ident" id="6662091">After</span><span class="op" id="6662096">(</span><span class="num" id="6662097">2</span>&nbsp;<span class="op" id="6662099">*</span>&nbsp;<span class="ident" id="6662101">time</span><span class="op" id="6662105">.</span><span class="ident" id="6662106">Second</span><span class="op" id="6662112">)</span><span class="op" id="6662113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662117">t</span><span class="op" id="6662118">.</span><span class="ident" id="6662119">Fatal</span><span class="op" id="6662124">(</span><span class="string" id="6662125">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;TCP&nbsp;close&#34;</span><span class="op" id="6662156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662159">}</span><br>
<span class="lineno"></span><span class="op" id="6662161">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="6662164">func</span>&nbsp;<span class="ident" id="6662169">TestUDPListenClose</span><span class="op" id="6662187">(</span><span class="ident" id="6662188">t</span>&nbsp;<span class="op" id="6662190">*</span><span class="ident" id="6662191">testing</span><span class="op" id="6662198">.</span><span class="ident" id="6662199">T</span><span class="op" id="6662200">)</span>&nbsp;<span class="op" id="6662202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662205">switch</span>&nbsp;<span class="ident" id="6662212">runtime</span><span class="op" id="6662219">.</span><span class="ident" id="6662220">GOOS</span>&nbsp;<span class="op" id="6662225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662228">case</span>&nbsp;<span class="string" id="6662233">&#34;plan9&#34;</span><span class="op" id="6662240">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662244">t</span><span class="op" id="6662245">.</span><span class="ident" id="6662246">Skipf</span><span class="op" id="6662251">(</span><span class="string" id="6662252">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6662273">,</span>&nbsp;<span class="ident" id="6662275">runtime</span><span class="op" id="6662282">.</span><span class="ident" id="6662283">GOOS</span><span class="op" id="6662287">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662293">ln</span><span class="op" id="6662295">,</span>&nbsp;<span class="ident" id="6662297">err</span>&nbsp;<span class="op" id="6662301">:=</span>&nbsp;<span class="ident" id="6662304">ListenPacket</span><span class="op" id="6662316">(</span><span class="string" id="6662317">&#34;udp&#34;</span><span class="op" id="6662322">,</span>&nbsp;<span class="string" id="6662324">&#34;127.0.0.1:0&#34;</span><span class="op" id="6662337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662340">if</span>&nbsp;<span class="ident" id="6662343">err</span>&nbsp;<span class="op" id="6662347">!=</span>&nbsp;<span class="ident" id="6662350">nil</span>&nbsp;<span class="op" id="6662354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662358">t</span><span class="op" id="6662359">.</span><span class="ident" id="6662360">Fatalf</span><span class="op" id="6662366">(</span><span class="string" id="6662367">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6662386">,</span>&nbsp;<span class="ident" id="6662388">err</span><span class="op" id="6662391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662394">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662398">buf</span>&nbsp;<span class="op" id="6662402">:=</span>&nbsp;<span class="builtinfunc" id="6662405">make</span><span class="op" id="6662409">(</span><span class="op" id="6662410">[</span><span class="op" id="6662411">]</span><span class="builtintype" id="6662412">byte</span><span class="op" id="6662416">,</span>&nbsp;<span class="num" id="6662418">1000</span><span class="op" id="6662422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662425">done</span>&nbsp;<span class="op" id="6662430">:=</span>&nbsp;<span class="builtinfunc" id="6662433">make</span><span class="op" id="6662437">(</span><span class="keyword" id="6662438">chan</span>&nbsp;<span class="builtintype" id="6662443">bool</span><span class="op" id="6662447">,</span>&nbsp;<span class="num" id="6662449">1</span><span class="op" id="6662450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662453">go</span>&nbsp;<span class="keyword" id="6662456">func</span><span class="op" id="6662460">(</span><span class="op" id="6662461">)</span>&nbsp;<span class="op" id="6662463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662467">time</span><span class="op" id="6662471">.</span><span class="ident" id="6662472">Sleep</span><span class="op" id="6662477">(</span><span class="num" id="6662478">100</span>&nbsp;<span class="op" id="6662482">*</span>&nbsp;<span class="ident" id="6662484">time</span><span class="op" id="6662488">.</span><span class="ident" id="6662489">Millisecond</span><span class="op" id="6662500">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662504">ln</span><span class="op" id="6662506">.</span><span class="ident" id="6662507">Close</span><span class="op" id="6662512">(</span><span class="op" id="6662513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662516">}</span><span class="op" id="6662517">(</span><span class="op" id="6662518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662521">go</span>&nbsp;<span class="keyword" id="6662524">func</span><span class="op" id="6662528">(</span><span class="op" id="6662529">)</span>&nbsp;<span class="op" id="6662531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662535">_</span><span class="op" id="6662536">,</span>&nbsp;<span class="ident" id="6662538">_</span><span class="op" id="6662539">,</span>&nbsp;<span class="ident" id="6662541">err</span>&nbsp;<span class="op" id="6662545">=</span>&nbsp;<span class="ident" id="6662547">ln</span><span class="op" id="6662549">.</span><span class="ident" id="6662550">ReadFrom</span><span class="op" id="6662558">(</span><span class="ident" id="6662559">buf</span><span class="op" id="6662562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662566">if</span>&nbsp;<span class="ident" id="6662569">err</span>&nbsp;<span class="op" id="6662573">==</span>&nbsp;<span class="ident" id="6662576">nil</span>&nbsp;<span class="op" id="6662580">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662585">t</span><span class="op" id="6662586">.</span><span class="ident" id="6662587">Error</span><span class="op" id="6662592">(</span><span class="string" id="6662593">&#34;ReadFrom&nbsp;succeeded&#34;</span><span class="op" id="6662613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662617">}</span>&nbsp;<span class="keyword" id="6662619">else</span>&nbsp;<span class="op" id="6662624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662629">t</span><span class="op" id="6662630">.</span><span class="ident" id="6662631">Logf</span><span class="op" id="6662635">(</span><span class="string" id="6662636">&#34;ReadFrom&nbsp;timeout&nbsp;error:&nbsp;%s&nbsp;(any&nbsp;error&nbsp;is&nbsp;fine)&#34;</span><span class="op" id="6662684">,</span>&nbsp;<span class="ident" id="6662686">err</span><span class="op" id="6662689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662697">done</span>&nbsp;<span class="op" id="6662702">&lt;-</span>&nbsp;<span class="builtintype" id="6662705">true</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662711">}</span><span class="op" id="6662712">(</span><span class="op" id="6662713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662716">select</span>&nbsp;<span class="op" id="6662723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662726">case</span>&nbsp;<span class="op" id="6662731">&lt;-</span><span class="ident" id="6662733">done</span><span class="op" id="6662737">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662740">case</span>&nbsp;<span class="op" id="6662745">&lt;-</span><span class="ident" id="6662747">time</span><span class="op" id="6662751">.</span><span class="ident" id="6662752">After</span><span class="op" id="6662757">(</span><span class="num" id="6662758">2</span>&nbsp;<span class="op" id="6662760">*</span>&nbsp;<span class="ident" id="6662762">time</span><span class="op" id="6662766">.</span><span class="ident" id="6662767">Second</span><span class="op" id="6662773">)</span><span class="op" id="6662774">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662778">t</span><span class="op" id="6662779">.</span><span class="ident" id="6662780">Fatal</span><span class="op" id="6662785">(</span><span class="string" id="6662786">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;UDP&nbsp;close&#34;</span><span class="op" id="6662817">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662820">}</span><br>
<span class="lineno"></span><span class="op" id="6662822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6662825">func</span>&nbsp;<span class="ident" id="6662830">TestTCPClose</span><span class="op" id="6662842">(</span><span class="ident" id="6662843">t</span>&nbsp;<span class="op" id="6662845">*</span><span class="ident" id="6662846">testing</span><span class="op" id="6662853">.</span><span class="ident" id="6662854">T</span><span class="op" id="6662855">)</span>&nbsp;<span class="op" id="6662857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662860">switch</span>&nbsp;<span class="ident" id="6662867">runtime</span><span class="op" id="6662874">.</span><span class="ident" id="6662875">GOOS</span>&nbsp;<span class="op" id="6662880">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662883">case</span>&nbsp;<span class="string" id="6662888">&#34;plan9&#34;</span><span class="op" id="6662895">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662899">t</span><span class="op" id="6662900">.</span><span class="ident" id="6662901">Skipf</span><span class="op" id="6662906">(</span><span class="string" id="6662907">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6662928">,</span>&nbsp;<span class="ident" id="6662930">runtime</span><span class="op" id="6662937">.</span><span class="ident" id="6662938">GOOS</span><span class="op" id="6662942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662948">l</span><span class="op" id="6662949">,</span>&nbsp;<span class="ident" id="6662951">err</span>&nbsp;<span class="op" id="6662955">:=</span>&nbsp;<span class="ident" id="6662958">Listen</span><span class="op" id="6662964">(</span><span class="string" id="6662965">&#34;tcp&#34;</span><span class="op" id="6662970">,</span>&nbsp;<span class="string" id="6662972">&#34;127.0.0.1:0&#34;</span><span class="op" id="6662985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662988">if</span>&nbsp;<span class="ident" id="6662991">err</span>&nbsp;<span class="op" id="6662995">!=</span>&nbsp;<span class="ident" id="6662998">nil</span>&nbsp;<span class="op" id="6663002">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663006">t</span><span class="op" id="6663007">.</span><span class="ident" id="6663008">Fatal</span><span class="op" id="6663013">(</span><span class="ident" id="6663014">err</span><span class="op" id="6663017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663023">defer</span>&nbsp;<span class="ident" id="6663029">l</span><span class="op" id="6663030">.</span><span class="ident" id="6663031">Close</span><span class="op" id="6663036">(</span><span class="op" id="6663037">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663041">read</span>&nbsp;<span class="op" id="6663046">:=</span>&nbsp;<span class="keyword" id="6663049">func</span><span class="op" id="6663053">(</span><span class="ident" id="6663054">r</span>&nbsp;<span class="ident" id="6663056">io</span><span class="op" id="6663058">.</span><span class="ident" id="6663059">Reader</span><span class="op" id="6663065">)</span>&nbsp;<span class="builtintype" id="6663067">error</span>&nbsp;<span class="op" id="6663073">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663077">var</span>&nbsp;<span class="ident" id="6663081">m</span>&nbsp;<span class="op" id="6663083">[</span><span class="num" id="6663084">1</span><span class="op" id="6663085">]</span><span class="builtintype" id="6663086">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663093">_</span><span class="op" id="6663094">,</span>&nbsp;<span class="ident" id="6663096">err</span>&nbsp;<span class="op" id="6663100">:=</span>&nbsp;<span class="ident" id="6663103">r</span><span class="op" id="6663104">.</span><span class="ident" id="6663105">Read</span><span class="op" id="6663109">(</span><span class="ident" id="6663110">m</span><span class="op" id="6663111">[</span><span class="op" id="6663112">:</span><span class="op" id="6663113">]</span><span class="op" id="6663114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663118">return</span>&nbsp;<span class="ident" id="6663125">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663134">go</span>&nbsp;<span class="keyword" id="6663137">func</span><span class="op" id="6663141">(</span><span class="op" id="6663142">)</span>&nbsp;<span class="op" id="6663144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663148">c</span><span class="op" id="6663149">,</span>&nbsp;<span class="ident" id="6663151">err</span>&nbsp;<span class="op" id="6663155">:=</span>&nbsp;<span class="ident" id="6663158">Dial</span><span class="op" id="6663162">(</span><span class="string" id="6663163">&#34;tcp&#34;</span><span class="op" id="6663168">,</span>&nbsp;<span class="ident" id="6663170">l</span><span class="op" id="6663171">.</span><span class="ident" id="6663172">Addr</span><span class="op" id="6663176">(</span><span class="op" id="6663177">)</span><span class="op" id="6663178">.</span><span class="ident" id="6663179">String</span><span class="op" id="6663185">(</span><span class="op" id="6663186">)</span><span class="op" id="6663187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663191">if</span>&nbsp;<span class="ident" id="6663194">err</span>&nbsp;<span class="op" id="6663198">!=</span>&nbsp;<span class="ident" id="6663201">nil</span>&nbsp;<span class="op" id="6663205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663210">t</span><span class="op" id="6663211">.</span><span class="ident" id="6663212">Errorf</span><span class="op" id="6663218">(</span><span class="string" id="6663219">&#34;Dial:&nbsp;%v&#34;</span><span class="op" id="6663229">,</span>&nbsp;<span class="ident" id="6663231">err</span><span class="op" id="6663234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663239">return</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663253">go</span>&nbsp;<span class="ident" id="6663256">read</span><span class="op" id="6663260">(</span><span class="ident" id="6663261">c</span><span class="op" id="6663262">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663267">time</span><span class="op" id="6663271">.</span><span class="ident" id="6663272">Sleep</span><span class="op" id="6663277">(</span><span class="num" id="6663278">10</span>&nbsp;<span class="op" id="6663281">*</span>&nbsp;<span class="ident" id="6663283">time</span><span class="op" id="6663287">.</span><span class="ident" id="6663288">Millisecond</span><span class="op" id="6663299">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663303">c</span><span class="op" id="6663304">.</span><span class="ident" id="6663305">Close</span><span class="op" id="6663310">(</span><span class="op" id="6663311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663314">}</span><span class="op" id="6663315">(</span><span class="op" id="6663316">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663320">c</span><span class="op" id="6663321">,</span>&nbsp;<span class="ident" id="6663323">err</span>&nbsp;<span class="op" id="6663327">:=</span>&nbsp;<span class="ident" id="6663330">l</span><span class="op" id="6663331">.</span><span class="ident" id="6663332">Accept</span><span class="op" id="6663338">(</span><span class="op" id="6663339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663342">if</span>&nbsp;<span class="ident" id="6663345">err</span>&nbsp;<span class="op" id="6663349">!=</span>&nbsp;<span class="ident" id="6663352">nil</span>&nbsp;<span class="op" id="6663356">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663360">t</span><span class="op" id="6663361">.</span><span class="ident" id="6663362">Fatal</span><span class="op" id="6663367">(</span><span class="ident" id="6663368">err</span><span class="op" id="6663371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663377">defer</span>&nbsp;<span class="ident" id="6663383">c</span><span class="op" id="6663384">.</span><span class="ident" id="6663385">Close</span><span class="op" id="6663390">(</span><span class="op" id="6663391">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663395">for</span>&nbsp;<span class="ident" id="6663399">err</span>&nbsp;<span class="op" id="6663403">==</span>&nbsp;<span class="ident" id="6663406">nil</span>&nbsp;<span class="op" id="6663410">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663414">err</span>&nbsp;<span class="op" id="6663418">=</span>&nbsp;<span class="ident" id="6663420">read</span><span class="op" id="6663424">(</span><span class="ident" id="6663425">c</span><span class="op" id="6663426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663432">if</span>&nbsp;<span class="ident" id="6663435">err</span>&nbsp;<span class="op" id="6663439">!=</span>&nbsp;<span class="ident" id="6663442">nil</span>&nbsp;<span class="op" id="6663446">&amp;&amp;</span>&nbsp;<span class="ident" id="6663449">err</span>&nbsp;<span class="op" id="6663453">!=</span>&nbsp;<span class="ident" id="6663456">io</span><span class="op" id="6663458">.</span><span class="ident" id="6663459">EOF</span>&nbsp;<span class="op" id="6663463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663467">t</span><span class="op" id="6663468">.</span><span class="ident" id="6663469">Fatal</span><span class="op" id="6663474">(</span><span class="ident" id="6663475">err</span><span class="op" id="6663478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663481">}</span><br>
<span class="lineno">225</span><span class="op" id="6663483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6663486">func</span>&nbsp;<span class="ident" id="6663491">TestErrorNil</span><span class="op" id="6663503">(</span><span class="ident" id="6663504">t</span>&nbsp;<span class="op" id="6663506">*</span><span class="ident" id="6663507">testing</span><span class="op" id="6663514">.</span><span class="ident" id="6663515">T</span><span class="op" id="6663516">)</span>&nbsp;<span class="op" id="6663518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663521">c</span><span class="op" id="6663522">,</span>&nbsp;<span class="ident" id="6663524">err</span>&nbsp;<span class="op" id="6663528">:=</span>&nbsp;<span class="ident" id="6663531">Dial</span><span class="op" id="6663535">(</span><span class="string" id="6663536">&#34;tcp&#34;</span><span class="op" id="6663541">,</span>&nbsp;<span class="string" id="6663543">&#34;127.0.0.1:65535&#34;</span><span class="op" id="6663560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663563">if</span>&nbsp;<span class="ident" id="6663566">err</span>&nbsp;<span class="op" id="6663570">==</span>&nbsp;<span class="ident" id="6663573">nil</span>&nbsp;<span class="op" id="6663577">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663581">t</span><span class="op" id="6663582">.</span><span class="ident" id="6663583">Fatal</span><span class="op" id="6663588">(</span><span class="string" id="6663589">&#34;Dial&nbsp;127.0.0.1:65535&nbsp;succeeded&#34;</span><span class="op" id="6663621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663627">if</span>&nbsp;<span class="ident" id="6663630">c</span>&nbsp;<span class="op" id="6663632">!=</span>&nbsp;<span class="ident" id="6663635">nil</span>&nbsp;<span class="op" id="6663639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663643">t</span><span class="op" id="6663644">.</span><span class="ident" id="6663645">Fatalf</span><span class="op" id="6663651">(</span><span class="string" id="6663652">&#34;Dial&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6663708">,</span>&nbsp;<span class="ident" id="6663710">c</span><span class="op" id="6663711">,</span>&nbsp;<span class="ident" id="6663713">c</span><span class="op" id="6663714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663717">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6663721">//&nbsp;Make&nbsp;Listen&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663778">l</span><span class="op" id="6663779">,</span>&nbsp;<span class="ident" id="6663781">err</span>&nbsp;<span class="op" id="6663785">:=</span>&nbsp;<span class="ident" id="6663788">Listen</span><span class="op" id="6663794">(</span><span class="string" id="6663795">&#34;tcp&#34;</span><span class="op" id="6663800">,</span>&nbsp;<span class="string" id="6663802">&#34;127.0.0.1:0&#34;</span><span class="op" id="6663815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663818">if</span>&nbsp;<span class="ident" id="6663821">err</span>&nbsp;<span class="op" id="6663825">!=</span>&nbsp;<span class="ident" id="6663828">nil</span>&nbsp;<span class="op" id="6663832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663836">t</span><span class="op" id="6663837">.</span><span class="ident" id="6663838">Fatalf</span><span class="op" id="6663844">(</span><span class="string" id="6663845">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="6663869">,</span>&nbsp;<span class="ident" id="6663871">err</span><span class="op" id="6663874">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663880">defer</span>&nbsp;<span class="ident" id="6663886">l</span><span class="op" id="6663887">.</span><span class="ident" id="6663888">Close</span><span class="op" id="6663893">(</span><span class="op" id="6663894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663897">l1</span><span class="op" id="6663899">,</span>&nbsp;<span class="ident" id="6663901">err</span>&nbsp;<span class="op" id="6663905">:=</span>&nbsp;<span class="ident" id="6663908">Listen</span><span class="op" id="6663914">(</span><span class="string" id="6663915">&#34;tcp&#34;</span><span class="op" id="6663920">,</span>&nbsp;<span class="ident" id="6663922">l</span><span class="op" id="6663923">.</span><span class="ident" id="6663924">Addr</span><span class="op" id="6663928">(</span><span class="op" id="6663929">)</span><span class="op" id="6663930">.</span><span class="ident" id="6663931">String</span><span class="op" id="6663937">(</span><span class="op" id="6663938">)</span><span class="op" id="6663939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663942">if</span>&nbsp;<span class="ident" id="6663945">err</span>&nbsp;<span class="op" id="6663949">==</span>&nbsp;<span class="ident" id="6663952">nil</span>&nbsp;<span class="op" id="6663956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663960">t</span><span class="op" id="6663961">.</span><span class="ident" id="6663962">Fatalf</span><span class="op" id="6663968">(</span><span class="string" id="6663969">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="6663991">,</span>&nbsp;<span class="ident" id="6663993">l</span><span class="op" id="6663994">.</span><span class="ident" id="6663995">Addr</span><span class="op" id="6663999">(</span><span class="op" id="6664000">)</span><span class="op" id="6664001">,</span>&nbsp;<span class="ident" id="6664003">err</span><span class="op" id="6664006">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664012">if</span>&nbsp;<span class="ident" id="6664015">l1</span>&nbsp;<span class="op" id="6664018">!=</span>&nbsp;<span class="ident" id="6664021">nil</span>&nbsp;<span class="op" id="6664025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664029">t</span><span class="op" id="6664030">.</span><span class="ident" id="6664031">Fatalf</span><span class="op" id="6664037">(</span><span class="string" id="6664038">&#34;Listen&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6664096">,</span>&nbsp;<span class="ident" id="6664098">l1</span><span class="op" id="6664100">,</span>&nbsp;<span class="ident" id="6664102">l1</span><span class="op" id="6664104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6664111">//&nbsp;Make&nbsp;ListenPacket&nbsp;fail&nbsp;by&nbsp;relistening&nbsp;on&nbsp;the&nbsp;same&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664174">lp</span><span class="op" id="6664176">,</span>&nbsp;<span class="ident" id="6664178">err</span>&nbsp;<span class="op" id="6664182">:=</span>&nbsp;<span class="ident" id="6664185">ListenPacket</span><span class="op" id="6664197">(</span><span class="string" id="6664198">&#34;udp&#34;</span><span class="op" id="6664203">,</span>&nbsp;<span class="string" id="6664205">&#34;127.0.0.1:0&#34;</span><span class="op" id="6664218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664221">if</span>&nbsp;<span class="ident" id="6664224">err</span>&nbsp;<span class="op" id="6664228">!=</span>&nbsp;<span class="ident" id="6664231">nil</span>&nbsp;<span class="op" id="6664235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664239">t</span><span class="op" id="6664240">.</span><span class="ident" id="6664241">Fatalf</span><span class="op" id="6664247">(</span><span class="string" id="6664248">&#34;Listen&nbsp;127.0.0.1:0:&nbsp;%v&#34;</span><span class="op" id="6664272">,</span>&nbsp;<span class="ident" id="6664274">err</span><span class="op" id="6664277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664280">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664283">defer</span>&nbsp;<span class="ident" id="6664289">lp</span><span class="op" id="6664291">.</span><span class="ident" id="6664292">Close</span><span class="op" id="6664297">(</span><span class="op" id="6664298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664301">lp1</span><span class="op" id="6664304">,</span>&nbsp;<span class="ident" id="6664306">err</span>&nbsp;<span class="op" id="6664310">:=</span>&nbsp;<span class="ident" id="6664313">ListenPacket</span><span class="op" id="6664325">(</span><span class="string" id="6664326">&#34;udp&#34;</span><span class="op" id="6664331">,</span>&nbsp;<span class="ident" id="6664333">lp</span><span class="op" id="6664335">.</span><span class="ident" id="6664336">LocalAddr</span><span class="op" id="6664345">(</span><span class="op" id="6664346">)</span><span class="op" id="6664347">.</span><span class="ident" id="6664348">String</span><span class="op" id="6664354">(</span><span class="op" id="6664355">)</span><span class="op" id="6664356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664359">if</span>&nbsp;<span class="ident" id="6664362">err</span>&nbsp;<span class="op" id="6664366">==</span>&nbsp;<span class="ident" id="6664369">nil</span>&nbsp;<span class="op" id="6664373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664377">t</span><span class="op" id="6664378">.</span><span class="ident" id="6664379">Fatalf</span><span class="op" id="6664385">(</span><span class="string" id="6664386">&#34;second&nbsp;Listen&nbsp;%v:&nbsp;%v&#34;</span><span class="op" id="6664408">,</span>&nbsp;<span class="ident" id="6664410">lp</span><span class="op" id="6664412">.</span><span class="ident" id="6664413">LocalAddr</span><span class="op" id="6664422">(</span><span class="op" id="6664423">)</span><span class="op" id="6664424">,</span>&nbsp;<span class="ident" id="6664426">err</span><span class="op" id="6664429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664432">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664435">if</span>&nbsp;<span class="ident" id="6664438">lp1</span>&nbsp;<span class="op" id="6664442">!=</span>&nbsp;<span class="ident" id="6664445">nil</span>&nbsp;<span class="op" id="6664449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664453">t</span><span class="op" id="6664454">.</span><span class="ident" id="6664455">Fatalf</span><span class="op" id="6664461">(</span><span class="string" id="6664462">&#34;ListenPacket&nbsp;returned&nbsp;non-nil&nbsp;interface&nbsp;%T(%v)&nbsp;with&nbsp;err&nbsp;!=&nbsp;nil&#34;</span><span class="op" id="6664526">,</span>&nbsp;<span class="ident" id="6664528">lp1</span><span class="op" id="6664531">,</span>&nbsp;<span class="ident" id="6664533">lp1</span><span class="op" id="6664536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664539">}</span><br>
<span class="lineno"></span><span class="op" id="6664541">}</span>
</div>
</body>
</html>
