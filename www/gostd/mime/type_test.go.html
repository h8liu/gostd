<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7518738">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7518793">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7518847">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7518898">package</span>&nbsp;<span class="ident" id="7518906">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7518912">import</span>&nbsp;<span class="op" id="7518919">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7518922">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7518932">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="7518935">var</span>&nbsp;<span class="ident" id="7518939">typeTests</span>&nbsp;<span class="op" id="7518949">=</span>&nbsp;<span class="ident" id="7518951">initMimeForTests</span><span class="op" id="7518967">(</span><span class="op" id="7518968">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7518971">func</span>&nbsp;<span class="ident" id="7518976">TestTypeByExtension</span><span class="op" id="7518995">(</span><span class="ident" id="7518996">t</span>&nbsp;<span class="op" id="7518998">*</span><span class="ident" id="7518999">testing</span><span class="op" id="7519006">.</span><span class="ident" id="7519007">T</span><span class="op" id="7519008">)</span>&nbsp;<span class="op" id="7519010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7519013">for</span>&nbsp;<span class="ident" id="7519017">ext</span><span class="op" id="7519020">,</span>&nbsp;<span class="ident" id="7519022">want</span>&nbsp;<span class="op" id="7519027">:=</span>&nbsp;<span class="keyword" id="7519030">range</span>&nbsp;<span class="ident" id="7519036">typeTests</span>&nbsp;<span class="op" id="7519046">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519050">val</span>&nbsp;<span class="op" id="7519054">:=</span>&nbsp;<span class="ident" id="7519057">TypeByExtension</span><span class="op" id="7519072">(</span><span class="ident" id="7519073">ext</span><span class="op" id="7519076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7519080">if</span>&nbsp;<span class="ident" id="7519083">val</span>&nbsp;<span class="op" id="7519087">!=</span>&nbsp;<span class="ident" id="7519090">want</span>&nbsp;<span class="op" id="7519095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519100">t</span><span class="op" id="7519101">.</span><span class="ident" id="7519102">Errorf</span><span class="op" id="7519108">(</span><span class="string" id="7519109">&#34;TypeByExtension(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7519144">,</span>&nbsp;<span class="ident" id="7519146">ext</span><span class="op" id="7519149">,</span>&nbsp;<span class="ident" id="7519151">val</span><span class="op" id="7519154">,</span>&nbsp;<span class="ident" id="7519156">want</span><span class="op" id="7519160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7519164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7519167">}</span><br>
<span class="lineno">20</span><span class="op" id="7519169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7519172">func</span>&nbsp;<span class="ident" id="7519177">TestTypeByExtensionCase</span><span class="op" id="7519200">(</span><span class="ident" id="7519201">t</span>&nbsp;<span class="op" id="7519203">*</span><span class="ident" id="7519204">testing</span><span class="op" id="7519211">.</span><span class="ident" id="7519212">T</span><span class="op" id="7519213">)</span>&nbsp;<span class="op" id="7519215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7519218">const</span>&nbsp;<span class="ident" id="7519224">custom</span>&nbsp;<span class="op" id="7519231">=</span>&nbsp;<span class="string" id="7519233">&#34;test/test;&nbsp;charset=iso-8859-1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7519266">const</span>&nbsp;<span class="ident" id="7519272">caps</span>&nbsp;<span class="op" id="7519277">=</span>&nbsp;<span class="string" id="7519279">&#34;test/test;&nbsp;WAS=ALLCAPS&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7519305">if</span>&nbsp;<span class="ident" id="7519308">err</span>&nbsp;<span class="op" id="7519312">:=</span>&nbsp;<span class="ident" id="7519315">AddExtensionType</span><span class="op" id="7519331">(</span><span class="string" id="7519332">&#34;.TEST&#34;</span><span class="op" id="7519339">,</span>&nbsp;<span class="ident" id="7519341">caps</span><span class="op" id="7519345">)</span><span class="op" id="7519346">;</span>&nbsp;<span class="ident" id="7519348">err</span>&nbsp;<span class="op" id="7519352">!=</span>&nbsp;<span class="ident" id="7519355">nil</span>&nbsp;<span class="op" id="7519359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519363">t</span><span class="op" id="7519364">.</span><span class="ident" id="7519365">Fatalf</span><span class="op" id="7519371">(</span><span class="string" id="7519372">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="7519403">,</span>&nbsp;<span class="ident" id="7519405">err</span><span class="op" id="7519408">,</span>&nbsp;<span class="ident" id="7519410">custom</span><span class="op" id="7519416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7519419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7519422">if</span>&nbsp;<span class="ident" id="7519425">err</span>&nbsp;<span class="op" id="7519429">:=</span>&nbsp;<span class="ident" id="7519432">AddExtensionType</span><span class="op" id="7519448">(</span><span class="string" id="7519449">&#34;.tesT&#34;</span><span class="op" id="7519456">,</span>&nbsp;<span class="ident" id="7519458">custom</span><span class="op" id="7519464">)</span><span class="op" id="7519465">;</span>&nbsp;<span class="ident" id="7519467">err</span>&nbsp;<span class="op" id="7519471">!=</span>&nbsp;<span class="ident" id="7519474">nil</span>&nbsp;<span class="op" id="7519478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519482">t</span><span class="op" id="7519483">.</span><span class="ident" id="7519484">Fatalf</span><span class="op" id="7519490">(</span><span class="string" id="7519491">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="7519522">,</span>&nbsp;<span class="ident" id="7519524">err</span><span class="op" id="7519527">,</span>&nbsp;<span class="ident" id="7519529">custom</span><span class="op" id="7519535">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7519538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7519542">//&nbsp;case-sensitive&nbsp;lookup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7519568">if</span>&nbsp;<span class="ident" id="7519571">got</span>&nbsp;<span class="op" id="7519575">:=</span>&nbsp;<span class="ident" id="7519578">TypeByExtension</span><span class="op" id="7519593">(</span><span class="string" id="7519594">&#34;.tesT&#34;</span><span class="op" id="7519601">)</span><span class="op" id="7519602">;</span>&nbsp;<span class="ident" id="7519604">got</span>&nbsp;<span class="op" id="7519608">!=</span>&nbsp;<span class="ident" id="7519611">custom</span>&nbsp;<span class="op" id="7519618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519622">t</span><span class="op" id="7519623">.</span><span class="ident" id="7519624">Fatalf</span><span class="op" id="7519630">(</span><span class="string" id="7519631">&#34;for&nbsp;.tesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7519659">,</span>&nbsp;<span class="ident" id="7519661">got</span><span class="op" id="7519664">,</span>&nbsp;<span class="ident" id="7519666">custom</span><span class="op" id="7519672">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7519675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7519678">if</span>&nbsp;<span class="ident" id="7519681">got</span>&nbsp;<span class="op" id="7519685">:=</span>&nbsp;<span class="ident" id="7519688">TypeByExtension</span><span class="op" id="7519703">(</span><span class="string" id="7519704">&#34;.TEST&#34;</span><span class="op" id="7519711">)</span><span class="op" id="7519712">;</span>&nbsp;<span class="ident" id="7519714">got</span>&nbsp;<span class="op" id="7519718">!=</span>&nbsp;<span class="ident" id="7519721">caps</span>&nbsp;<span class="op" id="7519726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519730">t</span><span class="op" id="7519731">.</span><span class="ident" id="7519732">Fatalf</span><span class="op" id="7519738">(</span><span class="string" id="7519739">&#34;for&nbsp;.TEST,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7519767">,</span>&nbsp;<span class="ident" id="7519769">got</span><span class="op" id="7519772">,</span>&nbsp;<span class="ident" id="7519774">caps</span><span class="op" id="7519778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7519781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7519785">//&nbsp;case-insensitive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7519806">if</span>&nbsp;<span class="ident" id="7519809">got</span>&nbsp;<span class="op" id="7519813">:=</span>&nbsp;<span class="ident" id="7519816">TypeByExtension</span><span class="op" id="7519831">(</span><span class="string" id="7519832">&#34;.TesT&#34;</span><span class="op" id="7519839">)</span><span class="op" id="7519840">;</span>&nbsp;<span class="ident" id="7519842">got</span>&nbsp;<span class="op" id="7519846">!=</span>&nbsp;<span class="ident" id="7519849">custom</span>&nbsp;<span class="op" id="7519856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519860">t</span><span class="op" id="7519861">.</span><span class="ident" id="7519862">Fatalf</span><span class="op" id="7519868">(</span><span class="string" id="7519869">&#34;for&nbsp;.TesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7519897">,</span>&nbsp;<span class="ident" id="7519899">got</span><span class="op" id="7519902">,</span>&nbsp;<span class="ident" id="7519904">custom</span><span class="op" id="7519910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7519913">}</span><br>
<span class="lineno"></span><span class="op" id="7519915">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7519918">func</span>&nbsp;<span class="ident" id="7519923">TestLookupMallocs</span><span class="op" id="7519940">(</span><span class="ident" id="7519941">t</span>&nbsp;<span class="op" id="7519943">*</span><span class="ident" id="7519944">testing</span><span class="op" id="7519951">.</span><span class="ident" id="7519952">T</span><span class="op" id="7519953">)</span>&nbsp;<span class="op" id="7519955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7519958">n</span>&nbsp;<span class="op" id="7519960">:=</span>&nbsp;<span class="ident" id="7519963">testing</span><span class="op" id="7519970">.</span><span class="ident" id="7519971">AllocsPerRun</span><span class="op" id="7519983">(</span><span class="num" id="7519984">10000</span><span class="op" id="7519989">,</span>&nbsp;<span class="keyword" id="7519991">func</span><span class="op" id="7519995">(</span><span class="op" id="7519996">)</span>&nbsp;<span class="op" id="7519998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520002">TypeByExtension</span><span class="op" id="7520017">(</span><span class="string" id="7520018">&#34;.html&#34;</span><span class="op" id="7520025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520029">TypeByExtension</span><span class="op" id="7520044">(</span><span class="string" id="7520045">&#34;.HtML&#34;</span><span class="op" id="7520052">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7520055">}</span><span class="op" id="7520056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7520059">if</span>&nbsp;<span class="ident" id="7520062">n</span>&nbsp;<span class="op" id="7520064">&gt;</span>&nbsp;<span class="num" id="7520066">0</span>&nbsp;<span class="op" id="7520068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7520072">t</span><span class="op" id="7520073">.</span><span class="ident" id="7520074">Errorf</span><span class="op" id="7520080">(</span><span class="string" id="7520081">&#34;allocs&nbsp;=&nbsp;%v;&nbsp;want&nbsp;0&#34;</span><span class="op" id="7520102">,</span>&nbsp;<span class="ident" id="7520104">n</span><span class="op" id="7520105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7520108">}</span><br>
<span class="lineno"></span><span class="op" id="7520110">}</span>
</div>
</body>
</html>
