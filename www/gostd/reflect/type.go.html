<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>reflect</h2>
<ul>
<li><a href="/gostd/reflect/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/reflect/deepequal.go.html">deepequal.go</a></li>
<li><a href="/gostd/reflect/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/reflect/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/reflect/makefunc.go.html">makefunc.go</a></li>
<li><a href="/gostd/reflect/set_test.go.html">set_test.go</a></li>
<li><a href="/gostd/reflect/tostring_test.go.html">tostring_test.go</a></li>
<li><a href="/gostd/reflect/type.go.html" class="current">type.go</a></li>
<li><a href="/gostd/reflect/value.go.html">value.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2188817">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2188872">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2188926">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2188977">//&nbsp;Package&nbsp;reflect&nbsp;implements&nbsp;run-time&nbsp;reflection,&nbsp;allowing&nbsp;a&nbsp;program&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2189050">//&nbsp;manipulate&nbsp;objects&nbsp;with&nbsp;arbitrary&nbsp;types.&nbsp;&nbsp;The&nbsp;typical&nbsp;use&nbsp;is&nbsp;to&nbsp;take&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2189130">//&nbsp;with&nbsp;static&nbsp;type&nbsp;interface{}&nbsp;and&nbsp;extract&nbsp;its&nbsp;dynamic&nbsp;type&nbsp;information&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2189206">//&nbsp;calling&nbsp;TypeOf,&nbsp;which&nbsp;returns&nbsp;a&nbsp;Type.</span><br>
<span class="lineno"></span><span class="comment" id="2189247">//</span><br>
<span class="lineno">10</span><span class="comment" id="2189250">//&nbsp;A&nbsp;call&nbsp;to&nbsp;ValueOf&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;the&nbsp;run-time&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="2189319">//&nbsp;Zero&nbsp;takes&nbsp;a&nbsp;Type&nbsp;and&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;a&nbsp;zero&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2189386">//&nbsp;for&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2189404">//</span><br>
<span class="lineno"></span><span class="comment" id="2189407">//&nbsp;See&nbsp;&#34;The&nbsp;Laws&nbsp;of&nbsp;Reflection&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;reflection&nbsp;in&nbsp;Go:</span><br>
<span class="lineno">15</span><span class="comment" id="2189480">//&nbsp;http://golang.org/doc/articles/laws_of_reflection.html</span><br>
<span class="lineno"></span><span class="keyword" id="2189538">package</span>&nbsp;<span class="ident" id="2189546">reflect</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2189555">import</span>&nbsp;<span class="op" id="2189562">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2189565">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2189576">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2189587">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2189595">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2189604">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2189607">//&nbsp;Type&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2189651">//</span><br>
<span class="lineno"></span><span class="comment" id="2189654">//&nbsp;Not&nbsp;all&nbsp;methods&nbsp;apply&nbsp;to&nbsp;all&nbsp;kinds&nbsp;of&nbsp;types.&nbsp;&nbsp;Restrictions,</span><br>
<span class="lineno"></span><span class="comment" id="2189717">//&nbsp;if&nbsp;any,&nbsp;are&nbsp;noted&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;each&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2189776">//&nbsp;Use&nbsp;the&nbsp;Kind&nbsp;method&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;before</span><br>
<span class="lineno">30</span><span class="comment" id="2189835">//&nbsp;calling&nbsp;kind-specific&nbsp;methods.&nbsp;&nbsp;Calling&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="2189887">//&nbsp;inappropriate&nbsp;to&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;causes&nbsp;a&nbsp;run-time&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="2189949">type</span>&nbsp;<span class="ident" id="2189954">Type</span>&nbsp;<span class="keyword" id="2189959">interface</span>&nbsp;<span class="op" id="2189969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2189972">//&nbsp;Methods&nbsp;applicable&nbsp;to&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190010">//&nbsp;Align&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190065">//&nbsp;this&nbsp;type&nbsp;when&nbsp;allocated&nbsp;in&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190105">Align</span><span class="op" id="2190110">(</span><span class="op" id="2190111">)</span>&nbsp;<span class="builtintype" id="2190113">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190119">//&nbsp;FieldAlign&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190179">//&nbsp;this&nbsp;type&nbsp;when&nbsp;used&nbsp;as&nbsp;a&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190227">FieldAlign</span><span class="op" id="2190237">(</span><span class="op" id="2190238">)</span>&nbsp;<span class="builtintype" id="2190240">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190246">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190307">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumMethod()).</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190364">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190368">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190442">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190511">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190515">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190585">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2190654">Method</span><span class="op" id="2190660">(</span><span class="builtintype" id="2190661">int</span><span class="op" id="2190664">)</span>&nbsp;<span class="ident" id="2190666">Method</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190675">//&nbsp;MethodByName&nbsp;returns&nbsp;the&nbsp;method&nbsp;with&nbsp;that&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190740">//&nbsp;method&nbsp;set&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;method&nbsp;was&nbsp;found.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190805">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190809">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190883">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190952">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2190956">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191026">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191095">MethodByName</span><span class="op" id="2191107">(</span><span class="builtintype" id="2191108">string</span><span class="op" id="2191114">)</span>&nbsp;<span class="op" id="2191116">(</span><span class="ident" id="2191117">Method</span><span class="op" id="2191123">,</span>&nbsp;<span class="builtintype" id="2191125">bool</span><span class="op" id="2191129">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191133">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191203">NumMethod</span><span class="op" id="2191212">(</span><span class="op" id="2191213">)</span>&nbsp;<span class="builtintype" id="2191215">int</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191221">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;type&#39;s&nbsp;name&nbsp;within&nbsp;its&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191274">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;string&nbsp;for&nbsp;unnamed&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191324">Name</span><span class="op" id="2191328">(</span><span class="op" id="2191329">)</span>&nbsp;<span class="builtintype" id="2191331">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191340">//&nbsp;PkgPath&nbsp;returns&nbsp;a&nbsp;named&nbsp;type&#39;s&nbsp;package&nbsp;path,&nbsp;that&nbsp;is,&nbsp;the&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191414">//&nbsp;that&nbsp;uniquely&nbsp;identifies&nbsp;the&nbsp;package,&nbsp;such&nbsp;as&nbsp;&#34;encoding/base64&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191483">//&nbsp;If&nbsp;the&nbsp;type&nbsp;was&nbsp;predeclared&nbsp;(string,&nbsp;error)&nbsp;or&nbsp;unnamed&nbsp;(*T,&nbsp;struct{},&nbsp;[]int),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191565">//&nbsp;the&nbsp;package&nbsp;path&nbsp;will&nbsp;be&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191612">PkgPath</span><span class="op" id="2191619">(</span><span class="op" id="2191620">)</span>&nbsp;<span class="builtintype" id="2191622">string</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191631">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;needed&nbsp;to&nbsp;store</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191684">//&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;given&nbsp;type;&nbsp;it&nbsp;is&nbsp;analogous&nbsp;to&nbsp;unsafe.Sizeof.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2191749">Size</span><span class="op" id="2191753">(</span><span class="op" id="2191754">)</span>&nbsp;<span class="builtintype" id="2191756">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191766">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191822">//&nbsp;The&nbsp;string&nbsp;representation&nbsp;may&nbsp;use&nbsp;shortened&nbsp;package&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191884">//&nbsp;(e.g.,&nbsp;base64&nbsp;instead&nbsp;of&nbsp;&#34;encoding/base64&#34;)&nbsp;and&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2191943">//&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique&nbsp;among&nbsp;types.&nbsp;&nbsp;To&nbsp;test&nbsp;for&nbsp;equality,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192007">//&nbsp;compare&nbsp;the&nbsp;Types&nbsp;directly.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192039">String</span><span class="op" id="2192045">(</span><span class="op" id="2192046">)</span>&nbsp;<span class="builtintype" id="2192048">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192057">//&nbsp;Kind&nbsp;returns&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192106">Kind</span><span class="op" id="2192110">(</span><span class="op" id="2192111">)</span>&nbsp;<span class="ident" id="2192113">Kind</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192120">//&nbsp;Implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192193">Implements</span><span class="op" id="2192203">(</span><span class="ident" id="2192204">u</span>&nbsp;<span class="ident" id="2192206">Type</span><span class="op" id="2192210">)</span>&nbsp;<span class="builtintype" id="2192212">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192219">//&nbsp;AssignableTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;assignable&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192297">AssignableTo</span><span class="op" id="2192309">(</span><span class="ident" id="2192310">u</span>&nbsp;<span class="ident" id="2192312">Type</span><span class="op" id="2192316">)</span>&nbsp;<span class="builtintype" id="2192318">bool</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192325">//&nbsp;ConvertibleTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;convertible&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192405">ConvertibleTo</span><span class="op" id="2192418">(</span><span class="ident" id="2192419">u</span>&nbsp;<span class="ident" id="2192421">Type</span><span class="op" id="2192425">)</span>&nbsp;<span class="builtintype" id="2192427">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192434">//&nbsp;Comparable&nbsp;returns&nbsp;true&nbsp;if&nbsp;values&nbsp;of&nbsp;this&nbsp;type&nbsp;are&nbsp;comparable.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2192501">Comparable</span><span class="op" id="2192511">(</span><span class="op" id="2192512">)</span>&nbsp;<span class="builtintype" id="2192514">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192521">//&nbsp;Methods&nbsp;applicable&nbsp;only&nbsp;to&nbsp;some&nbsp;types,&nbsp;depending&nbsp;on&nbsp;Kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192583">//&nbsp;The&nbsp;methods&nbsp;allowed&nbsp;for&nbsp;each&nbsp;kind&nbsp;are:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192626">//</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192630">//&nbsp;&nbsp;&nbsp;&nbsp;Int*,&nbsp;Uint*,&nbsp;Float*,&nbsp;Complex*:&nbsp;Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192670">//&nbsp;&nbsp;&nbsp;&nbsp;Array:&nbsp;Elem,&nbsp;Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192691">//&nbsp;&nbsp;&nbsp;&nbsp;Chan:&nbsp;ChanDir,&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192715">//&nbsp;&nbsp;&nbsp;&nbsp;Func:&nbsp;In,&nbsp;NumIn,&nbsp;Out,&nbsp;NumOut,&nbsp;IsVariadic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192761">//&nbsp;&nbsp;&nbsp;&nbsp;Map:&nbsp;Key,&nbsp;Elem</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192780">//&nbsp;&nbsp;&nbsp;&nbsp;Ptr:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192794">//&nbsp;&nbsp;&nbsp;&nbsp;Slice:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192810">//&nbsp;&nbsp;&nbsp;&nbsp;Struct:&nbsp;Field,&nbsp;FieldByIndex,&nbsp;FieldByName,&nbsp;FieldByNameFunc,&nbsp;NumField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192883">//&nbsp;Bits&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;type&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192930">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2192981">//&nbsp;sized&nbsp;or&nbsp;unsized&nbsp;Int,&nbsp;Uint,&nbsp;Float,&nbsp;or&nbsp;Complex&nbsp;kinds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193038">Bits</span><span class="op" id="2193042">(</span><span class="op" id="2193043">)</span>&nbsp;<span class="builtintype" id="2193045">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193051">//&nbsp;ChanDir&nbsp;returns&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193099">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193145">ChanDir</span><span class="op" id="2193152">(</span><span class="op" id="2193153">)</span>&nbsp;<span class="ident" id="2193155">ChanDir</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193165">//&nbsp;IsVariadic&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;final&nbsp;input&nbsp;parameter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193236">//&nbsp;is&nbsp;a&nbsp;&#34;...&#34;&nbsp;parameter.&nbsp;&nbsp;If&nbsp;so,&nbsp;t.In(t.NumIn()&nbsp;-&nbsp;1)&nbsp;returns&nbsp;the&nbsp;parameter&#39;s</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193314">//&nbsp;implicit&nbsp;actual&nbsp;type&nbsp;[]T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193344">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193348">//&nbsp;For&nbsp;concreteness,&nbsp;if&nbsp;t&nbsp;represents&nbsp;func(x&nbsp;int,&nbsp;y&nbsp;...&nbsp;float64),&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193419">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193423">//&nbsp;&nbsp;&nbsp;&nbsp;t.NumIn()&nbsp;==&nbsp;2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193442">//&nbsp;&nbsp;&nbsp;&nbsp;t.In(0)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;int&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193484">//&nbsp;&nbsp;&nbsp;&nbsp;t.In(1)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;[]float64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193532">//&nbsp;&nbsp;&nbsp;&nbsp;t.IsVariadic()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193559">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193563">//&nbsp;IsVariadic&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193617">IsVariadic</span><span class="op" id="2193627">(</span><span class="op" id="2193628">)</span>&nbsp;<span class="builtintype" id="2193630">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193637">//&nbsp;Elem&nbsp;returns&nbsp;a&nbsp;type&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193677">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Chan,&nbsp;Map,&nbsp;Ptr,&nbsp;or&nbsp;Slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193750">Elem</span><span class="op" id="2193754">(</span><span class="op" id="2193755">)</span>&nbsp;<span class="ident" id="2193757">Type</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193764">//&nbsp;Field&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193810">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193858">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumField()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2193914">Field</span><span class="op" id="2193919">(</span><span class="ident" id="2193920">i</span>&nbsp;<span class="builtintype" id="2193922">int</span><span class="op" id="2193925">)</span>&nbsp;<span class="ident" id="2193927">StructField</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193941">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2193997">//&nbsp;to&nbsp;the&nbsp;index&nbsp;sequence.&nbsp;&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194059">//&nbsp;successively&nbsp;for&nbsp;each&nbsp;index&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194094">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194142">FieldByIndex</span><span class="op" id="2194154">(</span><span class="ident" id="2194155">index</span>&nbsp;<span class="op" id="2194161">[</span><span class="op" id="2194162">]</span><span class="builtintype" id="2194163">int</span><span class="op" id="2194166">)</span>&nbsp;<span class="ident" id="2194168">StructField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194182">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194243">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194296">FieldByName</span><span class="op" id="2194307">(</span><span class="ident" id="2194308">name</span>&nbsp;<span class="builtintype" id="2194313">string</span><span class="op" id="2194319">)</span>&nbsp;<span class="op" id="2194321">(</span><span class="ident" id="2194322">StructField</span><span class="op" id="2194333">,</span>&nbsp;<span class="builtintype" id="2194335">bool</span><span class="op" id="2194339">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194343">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;first&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194406">//&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194472">//&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194497">FieldByNameFunc</span><span class="op" id="2194512">(</span><span class="ident" id="2194513">match</span>&nbsp;<span class="keyword" id="2194519">func</span><span class="op" id="2194523">(</span><span class="builtintype" id="2194524">string</span><span class="op" id="2194530">)</span>&nbsp;<span class="builtintype" id="2194532">bool</span><span class="op" id="2194536">)</span>&nbsp;<span class="op" id="2194538">(</span><span class="ident" id="2194539">StructField</span><span class="op" id="2194550">,</span>&nbsp;<span class="builtintype" id="2194552">bool</span><span class="op" id="2194556">)</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194560">//&nbsp;In&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;input&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194627">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194673">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumIn()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194726">In</span><span class="op" id="2194728">(</span><span class="ident" id="2194729">i</span>&nbsp;<span class="builtintype" id="2194731">int</span><span class="op" id="2194734">)</span>&nbsp;<span class="ident" id="2194736">Type</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194743">//&nbsp;Key&nbsp;returns&nbsp;a&nbsp;map&nbsp;type&#39;s&nbsp;key&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194782">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194827">Key</span><span class="op" id="2194830">(</span><span class="op" id="2194831">)</span>&nbsp;<span class="ident" id="2194833">Type</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194840">//&nbsp;Len&nbsp;returns&nbsp;an&nbsp;array&nbsp;type&#39;s&nbsp;length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194880">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2194927">Len</span><span class="op" id="2194930">(</span><span class="op" id="2194931">)</span>&nbsp;<span class="builtintype" id="2194933">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194939">//&nbsp;NumField&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;field&nbsp;count.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2194989">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195037">NumField</span><span class="op" id="2195045">(</span><span class="op" id="2195046">)</span>&nbsp;<span class="builtintype" id="2195048">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2195054">//&nbsp;NumIn&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;input&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2195113">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195159">NumIn</span><span class="op" id="2195164">(</span><span class="op" id="2195165">)</span>&nbsp;<span class="builtintype" id="2195167">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2195173">//&nbsp;NumOut&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;output&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2195234">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195280">NumOut</span><span class="op" id="2195286">(</span><span class="op" id="2195287">)</span>&nbsp;<span class="builtintype" id="2195289">int</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2195295">//&nbsp;Out&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;output&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2195364">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2195410">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumOut()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195464">Out</span><span class="op" id="2195467">(</span><span class="ident" id="2195468">i</span>&nbsp;<span class="builtintype" id="2195470">int</span><span class="op" id="2195473">)</span>&nbsp;<span class="ident" id="2195475">Type</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195482">common</span><span class="op" id="2195488">(</span><span class="op" id="2195489">)</span>&nbsp;<span class="op" id="2195491">*</span><span class="ident" id="2195492">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2195499">uncommon</span><span class="op" id="2195507">(</span><span class="op" id="2195508">)</span>&nbsp;<span class="op" id="2195510">*</span><span class="ident" id="2195511">uncommonType</span><br>
<span class="lineno"></span><span class="op" id="2195524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="2195527">//&nbsp;BUG(rsc):&nbsp;FieldByName&nbsp;and&nbsp;related&nbsp;functions&nbsp;consider&nbsp;struct&nbsp;field&nbsp;names&nbsp;to&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span><span class="comment" id="2195614">//&nbsp;if&nbsp;the&nbsp;names&nbsp;are&nbsp;equal,&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;unexported&nbsp;names&nbsp;originating</span><br>
<span class="lineno"></span><span class="comment" id="2195687">//&nbsp;in&nbsp;different&nbsp;packages.&nbsp;The&nbsp;practical&nbsp;effect&nbsp;of&nbsp;this&nbsp;is&nbsp;that&nbsp;the&nbsp;result&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2195764">//&nbsp;t.FieldByName(&#34;x&#34;)&nbsp;is&nbsp;not&nbsp;well&nbsp;defined&nbsp;if&nbsp;the&nbsp;struct&nbsp;type&nbsp;t&nbsp;contains</span><br>
<span class="lineno"></span><span class="comment" id="2195836">//&nbsp;multiple&nbsp;fields&nbsp;named&nbsp;x&nbsp;(embedded&nbsp;from&nbsp;different&nbsp;packages).</span><br>
<span class="lineno">200</span><span class="comment" id="2195899">//&nbsp;FieldByName&nbsp;may&nbsp;return&nbsp;one&nbsp;of&nbsp;the&nbsp;fields&nbsp;named&nbsp;x&nbsp;or&nbsp;may&nbsp;report&nbsp;that&nbsp;there&nbsp;are&nbsp;none.</span><br>
<span class="lineno"></span><span class="comment" id="2195986">//&nbsp;See&nbsp;golang.org/issue/4876&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2196034">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;These&nbsp;data&nbsp;structures&nbsp;are&nbsp;known&nbsp;to&nbsp;the&nbsp;compiler&nbsp;(../../cmd/gc/reflect.c).<br>
<span class="lineno">205</span>&nbsp;*&nbsp;A&nbsp;few&nbsp;are&nbsp;known&nbsp;to&nbsp;../runtime/type.go&nbsp;to&nbsp;convey&nbsp;to&nbsp;debuggers.<br>
<span class="lineno"></span>&nbsp;*&nbsp;They&nbsp;are&nbsp;also&nbsp;known&nbsp;to&nbsp;../runtime/type.h.<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2196229">//&nbsp;A&nbsp;Kind&nbsp;represents&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;type&nbsp;that&nbsp;a&nbsp;Type&nbsp;represents.</span><br>
<span class="lineno">210</span><span class="comment" id="2196300">//&nbsp;The&nbsp;zero&nbsp;Kind&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;kind.</span><br>
<span class="lineno"></span><span class="keyword" id="2196338">type</span>&nbsp;<span class="ident" id="2196343">Kind</span>&nbsp;<span class="builtintype" id="2196348">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2196354">const</span>&nbsp;<span class="op" id="2196360">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196363">Invalid</span>&nbsp;<span class="ident" id="2196371">Kind</span>&nbsp;<span class="op" id="2196376">=</span>&nbsp;<span class="ident" id="2196378">iota</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196384">Bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196390">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196395">Int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196401">Int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196408">Int32</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196415">Int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196422">Uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196428">Uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196435">Uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196443">Uint32</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196451">Uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196459">Uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196468">Float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196477">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196486">Complex64</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196497">Complex128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196509">Array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196516">Chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196522">Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196528">Interface</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196539">Map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196544">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196549">Slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196556">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196564">Struct</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196572">UnsafePointer</span><br>
<span class="lineno"></span><span class="op" id="2196586">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2196589">//&nbsp;rtype&nbsp;is&nbsp;the&nbsp;common&nbsp;implementation&nbsp;of&nbsp;most&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="2196643">//&nbsp;It&nbsp;is&nbsp;embedded&nbsp;in&nbsp;other,&nbsp;public&nbsp;struct&nbsp;types,&nbsp;but&nbsp;always</span><br>
<span class="lineno">245</span><span class="comment" id="2196703">//&nbsp;with&nbsp;a&nbsp;unique&nbsp;tag&nbsp;like&nbsp;`reflect:&#34;array&#34;`&nbsp;or&nbsp;`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="2196766">//&nbsp;so&nbsp;that&nbsp;code&nbsp;cannot&nbsp;convert&nbsp;from,&nbsp;say,&nbsp;*arrayType&nbsp;to&nbsp;*ptrType.</span><br>
<span class="lineno"></span><span class="keyword" id="2196832">type</span>&nbsp;<span class="ident" id="2196837">rtype</span>&nbsp;<span class="keyword" id="2196843">struct</span>&nbsp;<span class="op" id="2196850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196853">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2196867">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196876">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2196890">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2196908">//&nbsp;hash&nbsp;of&nbsp;type;&nbsp;avoids&nbsp;computation&nbsp;in&nbsp;hash&nbsp;tables</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2196960">_</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2196974">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2196992">//&nbsp;unused/padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2197011">align</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2197025">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197043">//&nbsp;alignment&nbsp;of&nbsp;variable&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2197084">fieldAlign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2197098">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197116">//&nbsp;alignment&nbsp;of&nbsp;struct&nbsp;field&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2197161">kind</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2197175">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197193">//&nbsp;enumeration&nbsp;for&nbsp;C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2197215">alg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2197229">*</span><span class="ident" id="2197230">typeAlg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197247">//&nbsp;algorithm&nbsp;table&nbsp;(../runtime/runtime.h:/Alg)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2197295">gc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2197309">[</span><span class="num" id="2197310">2</span><span class="op" id="2197311">]</span><span class="ident" id="2197312">unsafe</span><span class="op" id="2197318">.</span><span class="ident" id="2197319">Pointer</span>&nbsp;<span class="comment" id="2197327">//&nbsp;garbage&nbsp;collection&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2197355">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2197369">*</span><span class="builtintype" id="2197370">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197387">//&nbsp;string&nbsp;form;&nbsp;unnecessary&nbsp;but&nbsp;undeniably&nbsp;useful</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2197438">*</span><span class="ident" id="2197439">uncommonType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197470">//&nbsp;(relatively)&nbsp;uncommon&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2197503">ptrToThis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2197517">*</span><span class="ident" id="2197518">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197535">//&nbsp;type&nbsp;for&nbsp;pointer&nbsp;to&nbsp;this&nbsp;type,&nbsp;if&nbsp;used&nbsp;in&nbsp;binary&nbsp;or&nbsp;has&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2197603">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2197617">unsafe</span><span class="op" id="2197623">.</span><span class="ident" id="2197624">Pointer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197635">//&nbsp;pointer&nbsp;to&nbsp;zero&nbsp;value</span><br>
<span class="lineno">260</span><span class="op" id="2197660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2197663">type</span>&nbsp;<span class="ident" id="2197668">typeAlg</span>&nbsp;<span class="keyword" id="2197676">struct</span>&nbsp;<span class="op" id="2197683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197686">//&nbsp;function&nbsp;for&nbsp;hashing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197732">//&nbsp;(ptr&nbsp;to&nbsp;object,&nbsp;size,&nbsp;seed)&nbsp;-&gt;&nbsp;hash</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2197772">hash</span>&nbsp;<span class="keyword" id="2197777">func</span><span class="op" id="2197781">(</span><span class="ident" id="2197782">unsafe</span><span class="op" id="2197788">.</span><span class="ident" id="2197789">Pointer</span><span class="op" id="2197796">,</span>&nbsp;<span class="builtintype" id="2197798">uintptr</span><span class="op" id="2197805">,</span>&nbsp;<span class="builtintype" id="2197807">uintptr</span><span class="op" id="2197814">)</span>&nbsp;<span class="builtintype" id="2197816">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197825">//&nbsp;function&nbsp;for&nbsp;comparing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2197873">//&nbsp;(ptr&nbsp;to&nbsp;object&nbsp;A,&nbsp;ptr&nbsp;to&nbsp;object&nbsp;B,&nbsp;size)&nbsp;-&gt;&nbsp;==?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2197925">equal</span>&nbsp;<span class="keyword" id="2197931">func</span><span class="op" id="2197935">(</span><span class="ident" id="2197936">unsafe</span><span class="op" id="2197942">.</span><span class="ident" id="2197943">Pointer</span><span class="op" id="2197950">,</span>&nbsp;<span class="ident" id="2197952">unsafe</span><span class="op" id="2197958">.</span><span class="ident" id="2197959">Pointer</span><span class="op" id="2197966">,</span>&nbsp;<span class="builtintype" id="2197968">uintptr</span><span class="op" id="2197975">)</span>&nbsp;<span class="builtintype" id="2197977">bool</span><br>
<span class="lineno"></span><span class="op" id="2197982">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="2197985">//&nbsp;Method&nbsp;on&nbsp;non-interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2198017">type</span>&nbsp;<span class="ident" id="2198022">method</span>&nbsp;<span class="keyword" id="2198029">struct</span>&nbsp;<span class="op" id="2198036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2198039">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2198047">*</span><span class="builtintype" id="2198048">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2198062">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2198081">pkgPath</span>&nbsp;<span class="op" id="2198089">*</span><span class="builtintype" id="2198090">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2198104">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2198154">mtyp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2198162">*</span><span class="ident" id="2198163">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2198177">//&nbsp;method&nbsp;type&nbsp;(without&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2198212">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2198220">*</span><span class="ident" id="2198221">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2198235">//&nbsp;.(*FuncType)&nbsp;underneath&nbsp;(with&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2198279">ifn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2198287">unsafe</span><span class="op" id="2198293">.</span><span class="ident" id="2198294">Pointer</span>&nbsp;<span class="comment" id="2198302">//&nbsp;fn&nbsp;used&nbsp;in&nbsp;interface&nbsp;call&nbsp;(one-word&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2198352">tfn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2198360">unsafe</span><span class="op" id="2198366">.</span><span class="ident" id="2198367">Pointer</span>&nbsp;<span class="comment" id="2198375">//&nbsp;fn&nbsp;used&nbsp;for&nbsp;normal&nbsp;method&nbsp;call</span><br>
<span class="lineno"></span><span class="op" id="2198409">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="2198412">//&nbsp;uncommonType&nbsp;is&nbsp;present&nbsp;only&nbsp;for&nbsp;types&nbsp;with&nbsp;names&nbsp;or&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="2198476">//&nbsp;(if&nbsp;T&nbsp;is&nbsp;a&nbsp;named&nbsp;type,&nbsp;the&nbsp;uncommonTypes&nbsp;for&nbsp;T&nbsp;and&nbsp;*T&nbsp;have&nbsp;methods).</span><br>
<span class="lineno"></span><span class="comment" id="2198548">//&nbsp;Using&nbsp;a&nbsp;pointer&nbsp;to&nbsp;this&nbsp;struct&nbsp;reduces&nbsp;the&nbsp;overall&nbsp;size&nbsp;required</span><br>
<span class="lineno"></span><span class="comment" id="2198616">//&nbsp;to&nbsp;describe&nbsp;an&nbsp;unnamed&nbsp;type&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno">285</span><span class="keyword" id="2198664">type</span>&nbsp;<span class="ident" id="2198669">uncommonType</span>&nbsp;<span class="keyword" id="2198682">struct</span>&nbsp;<span class="op" id="2198689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2198692">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2198700">*</span><span class="builtintype" id="2198701">string</span>&nbsp;&nbsp;<span class="comment" id="2198709">//&nbsp;name&nbsp;of&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2198726">pkgPath</span>&nbsp;<span class="op" id="2198734">*</span><span class="builtintype" id="2198735">string</span>&nbsp;&nbsp;<span class="comment" id="2198743">//&nbsp;import&nbsp;path;&nbsp;nil&nbsp;for&nbsp;built-in&nbsp;types&nbsp;like&nbsp;int,&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2198800">methods</span>&nbsp;<span class="op" id="2198808">[</span><span class="op" id="2198809">]</span><span class="ident" id="2198810">method</span>&nbsp;<span class="comment" id="2198817">//&nbsp;methods&nbsp;associated&nbsp;with&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2198849">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="2198852">//&nbsp;ChanDir&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno"></span><span class="keyword" id="2198902">type</span>&nbsp;<span class="ident" id="2198907">ChanDir</span>&nbsp;<span class="builtintype" id="2198915">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2198920">const</span>&nbsp;<span class="op" id="2198926">(</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2198929">RecvDir</span>&nbsp;<span class="ident" id="2198937">ChanDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2198957">=</span>&nbsp;<span class="num" id="2198959">1</span>&nbsp;<span class="op" id="2198961">&lt;&lt;</span>&nbsp;<span class="ident" id="2198964">iota</span>&nbsp;<span class="comment" id="2198969">//&nbsp;&lt;-chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2198980">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2199020">//&nbsp;chan&lt;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199031">BothDir</span>&nbsp;<span class="op" id="2199039">=</span>&nbsp;<span class="ident" id="2199041">RecvDir</span>&nbsp;<span class="op" id="2199049">|</span>&nbsp;<span class="ident" id="2199051">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2199071">//&nbsp;chan</span><br>
<span class="lineno"></span><span class="op" id="2199079">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="2199082">//&nbsp;arrayType&nbsp;represents&nbsp;a&nbsp;fixed&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2199126">type</span>&nbsp;<span class="ident" id="2199131">arrayType</span>&nbsp;<span class="keyword" id="2199141">struct</span>&nbsp;<span class="op" id="2199148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199151">rtype</span>&nbsp;<span class="string" id="2199157">`reflect:&#34;array&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199176">elem</span>&nbsp;&nbsp;<span class="op" id="2199182">*</span><span class="ident" id="2199183">rtype</span>&nbsp;<span class="comment" id="2199189">//&nbsp;array&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199212">slice</span>&nbsp;<span class="op" id="2199218">*</span><span class="ident" id="2199219">rtype</span>&nbsp;<span class="comment" id="2199225">//&nbsp;slice&nbsp;type</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2199240">len</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2199246">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2199254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2199257">//&nbsp;chanType&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2199296">type</span>&nbsp;<span class="ident" id="2199301">chanType</span>&nbsp;<span class="keyword" id="2199310">struct</span>&nbsp;<span class="op" id="2199317">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199320">rtype</span>&nbsp;<span class="string" id="2199326">`reflect:&#34;chan&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199344">elem</span>&nbsp;&nbsp;<span class="op" id="2199350">*</span><span class="ident" id="2199351">rtype</span>&nbsp;&nbsp;<span class="comment" id="2199358">//&nbsp;channel&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199383">dir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2199389">uintptr</span>&nbsp;<span class="comment" id="2199397">//&nbsp;channel&nbsp;direction&nbsp;(ChanDir)</span><br>
<span class="lineno"></span><span class="op" id="2199428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2199431">//&nbsp;funcType&nbsp;represents&nbsp;a&nbsp;function&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2199471">type</span>&nbsp;<span class="ident" id="2199476">funcType</span>&nbsp;<span class="keyword" id="2199485">struct</span>&nbsp;<span class="op" id="2199492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199495">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2199505">`reflect:&#34;func&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199523">dotdotdot</span>&nbsp;<span class="builtintype" id="2199533">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2199542">//&nbsp;last&nbsp;input&nbsp;parameter&nbsp;is&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199574">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2199584">[</span><span class="op" id="2199585">]</span><span class="op" id="2199586">*</span><span class="ident" id="2199587">rtype</span>&nbsp;<span class="comment" id="2199593">//&nbsp;input&nbsp;parameter&nbsp;types</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199619">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2199629">[</span><span class="op" id="2199630">]</span><span class="op" id="2199631">*</span><span class="ident" id="2199632">rtype</span>&nbsp;<span class="comment" id="2199638">//&nbsp;output&nbsp;parameter&nbsp;types</span><br>
<span class="lineno"></span><span class="op" id="2199664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2199667">//&nbsp;imethod&nbsp;represents&nbsp;a&nbsp;method&nbsp;on&nbsp;an&nbsp;interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2199719">type</span>&nbsp;<span class="ident" id="2199724">imethod</span>&nbsp;<span class="keyword" id="2199732">struct</span>&nbsp;<span class="op" id="2199739">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199742">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2199750">*</span><span class="builtintype" id="2199751">string</span>&nbsp;<span class="comment" id="2199758">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199777">pkgPath</span>&nbsp;<span class="op" id="2199785">*</span><span class="builtintype" id="2199786">string</span>&nbsp;<span class="comment" id="2199793">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199843">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2199851">*</span><span class="ident" id="2199852">rtype</span>&nbsp;&nbsp;<span class="comment" id="2199859">//&nbsp;.(*FuncType)&nbsp;underneath</span><br>
<span class="lineno"></span><span class="op" id="2199886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="comment" id="2199889">//&nbsp;interfaceType&nbsp;represents&nbsp;an&nbsp;interface&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2199936">type</span>&nbsp;<span class="ident" id="2199941">interfaceType</span>&nbsp;<span class="keyword" id="2199955">struct</span>&nbsp;<span class="op" id="2199962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199965">rtype</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2199973">`reflect:&#34;interface&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2199996">methods</span>&nbsp;<span class="op" id="2200004">[</span><span class="op" id="2200005">]</span><span class="ident" id="2200006">imethod</span>&nbsp;<span class="comment" id="2200014">//&nbsp;sorted&nbsp;by&nbsp;hash</span><br>
<span class="lineno"></span><span class="op" id="2200032">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="comment" id="2200035">//&nbsp;mapType&nbsp;represents&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2200069">type</span>&nbsp;<span class="ident" id="2200074">mapType</span>&nbsp;<span class="keyword" id="2200082">struct</span>&nbsp;<span class="op" id="2200089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200092">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2200106">`reflect:&#34;map&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200123">key</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2200137">*</span><span class="ident" id="2200138">rtype</span>&nbsp;<span class="comment" id="2200144">//&nbsp;map&nbsp;key&nbsp;type</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200161">elem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2200175">*</span><span class="ident" id="2200176">rtype</span>&nbsp;<span class="comment" id="2200182">//&nbsp;map&nbsp;element&nbsp;(value)&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200211">bucket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2200225">*</span><span class="ident" id="2200226">rtype</span>&nbsp;<span class="comment" id="2200232">//&nbsp;internal&nbsp;bucket&nbsp;structure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200262">hmap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2200276">*</span><span class="ident" id="2200277">rtype</span>&nbsp;<span class="comment" id="2200283">//&nbsp;internal&nbsp;map&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200307">keysize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2200321">uint8</span>&nbsp;&nbsp;<span class="comment" id="2200328">//&nbsp;size&nbsp;of&nbsp;key&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200349">indirectkey</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2200363">uint8</span>&nbsp;&nbsp;<span class="comment" id="2200370">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;key&nbsp;instead&nbsp;of&nbsp;key&nbsp;itself</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200413">valuesize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2200427">uint8</span>&nbsp;&nbsp;<span class="comment" id="2200434">//&nbsp;size&nbsp;of&nbsp;value&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200457">indirectvalue</span>&nbsp;<span class="builtintype" id="2200471">uint8</span>&nbsp;&nbsp;<span class="comment" id="2200478">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;value&nbsp;instead&nbsp;of&nbsp;value&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200525">bucketsize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2200539">uint16</span>&nbsp;<span class="comment" id="2200546">//&nbsp;size&nbsp;of&nbsp;bucket</span><br>
<span class="lineno"></span><span class="op" id="2200564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="2200567">//&nbsp;ptrType&nbsp;represents&nbsp;a&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2200605">type</span>&nbsp;<span class="ident" id="2200610">ptrType</span>&nbsp;<span class="keyword" id="2200618">struct</span>&nbsp;<span class="op" id="2200625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200628">rtype</span>&nbsp;<span class="string" id="2200634">`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200651">elem</span>&nbsp;&nbsp;<span class="op" id="2200657">*</span><span class="ident" id="2200658">rtype</span>&nbsp;<span class="comment" id="2200664">//&nbsp;pointer&nbsp;element&nbsp;(pointed&nbsp;at)&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2200701">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2200704">//&nbsp;sliceType&nbsp;represents&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2200742">type</span>&nbsp;<span class="ident" id="2200747">sliceType</span>&nbsp;<span class="keyword" id="2200757">struct</span>&nbsp;<span class="op" id="2200764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200767">rtype</span>&nbsp;<span class="string" id="2200773">`reflect:&#34;slice&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200792">elem</span>&nbsp;&nbsp;<span class="op" id="2200798">*</span><span class="ident" id="2200799">rtype</span>&nbsp;<span class="comment" id="2200805">//&nbsp;slice&nbsp;element&nbsp;type</span><br>
<span class="lineno">360</span><span class="op" id="2200827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2200830">//&nbsp;Struct&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="2200846">type</span>&nbsp;<span class="ident" id="2200851">structField</span>&nbsp;<span class="keyword" id="2200863">struct</span>&nbsp;<span class="op" id="2200870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200873">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2200881">*</span><span class="builtintype" id="2200882">string</span>&nbsp;<span class="comment" id="2200889">//&nbsp;nil&nbsp;for&nbsp;embedded&nbsp;fields</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200917">pkgPath</span>&nbsp;<span class="op" id="2200925">*</span><span class="builtintype" id="2200926">string</span>&nbsp;<span class="comment" id="2200933">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2200983">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2200991">*</span><span class="ident" id="2200992">rtype</span>&nbsp;&nbsp;<span class="comment" id="2200999">//&nbsp;type&nbsp;of&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201017">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2201025">*</span><span class="builtintype" id="2201026">string</span>&nbsp;<span class="comment" id="2201033">//&nbsp;nil&nbsp;if&nbsp;no&nbsp;tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201051">offset</span>&nbsp;&nbsp;<span class="builtintype" id="2201059">uintptr</span>&nbsp;<span class="comment" id="2201067">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;field&nbsp;within&nbsp;struct</span><br>
<span class="lineno"></span><span class="op" id="2201105">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="2201108">//&nbsp;structType&nbsp;represents&nbsp;a&nbsp;struct&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2201148">type</span>&nbsp;<span class="ident" id="2201153">structType</span>&nbsp;<span class="keyword" id="2201164">struct</span>&nbsp;<span class="op" id="2201171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201174">rtype</span>&nbsp;&nbsp;<span class="string" id="2201181">`reflect:&#34;struct&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201201">fields</span>&nbsp;<span class="op" id="2201208">[</span><span class="op" id="2201209">]</span><span class="ident" id="2201210">structField</span>&nbsp;<span class="comment" id="2201222">//&nbsp;sorted&nbsp;by&nbsp;offset</span><br>
<span class="lineno">375</span><span class="op" id="2201242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2201245">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;knows&nbsp;the&nbsp;exact&nbsp;layout&nbsp;of&nbsp;all&nbsp;the&nbsp;data&nbsp;structures&nbsp;above.<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;does&nbsp;not&nbsp;know&nbsp;about&nbsp;the&nbsp;data&nbsp;structures&nbsp;and&nbsp;methods&nbsp;below.<br>
<span class="lineno">380</span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2201401">//&nbsp;Method&nbsp;represents&nbsp;a&nbsp;single&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2201439">type</span>&nbsp;<span class="ident" id="2201444">Method</span>&nbsp;<span class="keyword" id="2201451">struct</span>&nbsp;<span class="op" id="2201458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2201461">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;method&nbsp;name.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2201490">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2201563">//&nbsp;method&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;method&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2201633">//&nbsp;The&nbsp;combination&nbsp;of&nbsp;PkgPath&nbsp;and&nbsp;Name&nbsp;uniquely&nbsp;identifies&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2201702">//&nbsp;in&nbsp;a&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2201723">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201784">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2201792">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201800">PkgPath</span>&nbsp;<span class="builtintype" id="2201808">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201817">Type</span>&nbsp;&nbsp;<span class="ident" id="2201823">Type</span>&nbsp;&nbsp;<span class="comment" id="2201829">//&nbsp;method&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201845">Func</span>&nbsp;&nbsp;<span class="ident" id="2201851">Value</span>&nbsp;<span class="comment" id="2201857">//&nbsp;func&nbsp;with&nbsp;receiver&nbsp;as&nbsp;first&nbsp;argument</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201898">Index</span>&nbsp;<span class="builtintype" id="2201904">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2201910">//&nbsp;index&nbsp;for&nbsp;Type.Method</span><br>
<span class="lineno"></span><span class="op" id="2201935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2201938">const</span>&nbsp;<span class="op" id="2201944">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201947">kindDirectIface</span>&nbsp;<span class="op" id="2201963">=</span>&nbsp;<span class="num" id="2201965">1</span>&nbsp;<span class="op" id="2201967">&lt;&lt;</span>&nbsp;<span class="num" id="2201970">5</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2201973">kindGCProg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2201989">=</span>&nbsp;<span class="num" id="2201991">1</span>&nbsp;<span class="op" id="2201993">&lt;&lt;</span>&nbsp;<span class="num" id="2201996">6</span>&nbsp;<span class="comment" id="2201998">//&nbsp;Type.gc&nbsp;points&nbsp;to&nbsp;GC&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202031">kindNoPointers</span>&nbsp;&nbsp;<span class="op" id="2202047">=</span>&nbsp;<span class="num" id="2202049">1</span>&nbsp;<span class="op" id="2202051">&lt;&lt;</span>&nbsp;<span class="num" id="2202054">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202057">kindMask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2202073">=</span>&nbsp;<span class="op" id="2202075">(</span><span class="num" id="2202076">1</span>&nbsp;<span class="op" id="2202078">&lt;&lt;</span>&nbsp;<span class="num" id="2202081">5</span><span class="op" id="2202082">)</span>&nbsp;<span class="op" id="2202084">-</span>&nbsp;<span class="num" id="2202086">1</span><br>
<span class="lineno"></span><span class="op" id="2202088">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="keyword" id="2202091">func</span>&nbsp;<span class="op" id="2202096">(</span><span class="ident" id="2202097">k</span>&nbsp;<span class="ident" id="2202099">Kind</span><span class="op" id="2202103">)</span>&nbsp;<span class="ident" id="2202105">String</span><span class="op" id="2202111">(</span><span class="op" id="2202112">)</span>&nbsp;<span class="builtintype" id="2202114">string</span>&nbsp;<span class="op" id="2202121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2202124">if</span>&nbsp;<span class="builtintype" id="2202127">int</span><span class="op" id="2202130">(</span><span class="ident" id="2202131">k</span><span class="op" id="2202132">)</span>&nbsp;<span class="op" id="2202134">&lt;</span>&nbsp;<span class="builtinfunc" id="2202136">len</span><span class="op" id="2202139">(</span><span class="ident" id="2202140">kindNames</span><span class="op" id="2202149">)</span>&nbsp;<span class="op" id="2202151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2202155">return</span>&nbsp;<span class="ident" id="2202162">kindNames</span><span class="op" id="2202171">[</span><span class="ident" id="2202172">k</span><span class="op" id="2202173">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2202176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2202179">return</span>&nbsp;<span class="string" id="2202186">&#34;kind&#34;</span>&nbsp;<span class="op" id="2202193">+</span>&nbsp;<span class="ident" id="2202195">strconv</span><span class="op" id="2202202">.</span><span class="ident" id="2202203">Itoa</span><span class="op" id="2202207">(</span><span class="builtintype" id="2202208">int</span><span class="op" id="2202211">(</span><span class="ident" id="2202212">k</span><span class="op" id="2202213">)</span><span class="op" id="2202214">)</span><br>
<span class="lineno">410</span><span class="op" id="2202216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2202219">var</span>&nbsp;<span class="ident" id="2202223">kindNames</span>&nbsp;<span class="op" id="2202233">=</span>&nbsp;<span class="op" id="2202235">[</span><span class="op" id="2202236">]</span><span class="builtintype" id="2202237">string</span><span class="op" id="2202243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202246">Invalid</span><span class="op" id="2202253">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202261">&#34;invalid&#34;</span><span class="op" id="2202270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202273">Bool</span><span class="op" id="2202277">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202288">&#34;bool&#34;</span><span class="op" id="2202294">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202297">Int</span><span class="op" id="2202300">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202312">&#34;int&#34;</span><span class="op" id="2202317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202320">Int8</span><span class="op" id="2202324">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202335">&#34;int8&#34;</span><span class="op" id="2202341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202344">Int16</span><span class="op" id="2202349">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202359">&#34;int16&#34;</span><span class="op" id="2202366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202369">Int32</span><span class="op" id="2202374">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202384">&#34;int32&#34;</span><span class="op" id="2202391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202394">Int64</span><span class="op" id="2202399">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202409">&#34;int64&#34;</span><span class="op" id="2202416">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202419">Uint</span><span class="op" id="2202423">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202434">&#34;uint&#34;</span><span class="op" id="2202440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202443">Uint8</span><span class="op" id="2202448">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202458">&#34;uint8&#34;</span><span class="op" id="2202465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202468">Uint16</span><span class="op" id="2202474">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202483">&#34;uint16&#34;</span><span class="op" id="2202491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202494">Uint32</span><span class="op" id="2202500">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202509">&#34;uint32&#34;</span><span class="op" id="2202517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202520">Uint64</span><span class="op" id="2202526">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202535">&#34;uint64&#34;</span><span class="op" id="2202543">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202546">Uintptr</span><span class="op" id="2202553">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202561">&#34;uintptr&#34;</span><span class="op" id="2202570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202573">Float32</span><span class="op" id="2202580">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202588">&#34;float32&#34;</span><span class="op" id="2202597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202600">Float64</span><span class="op" id="2202607">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202615">&#34;float64&#34;</span><span class="op" id="2202624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202627">Complex64</span><span class="op" id="2202636">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202642">&#34;complex64&#34;</span><span class="op" id="2202653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202656">Complex128</span><span class="op" id="2202666">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202671">&#34;complex128&#34;</span><span class="op" id="2202683">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202686">Array</span><span class="op" id="2202691">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202701">&#34;array&#34;</span><span class="op" id="2202708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202711">Chan</span><span class="op" id="2202715">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202726">&#34;chan&#34;</span><span class="op" id="2202732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202735">Func</span><span class="op" id="2202739">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202750">&#34;func&#34;</span><span class="op" id="2202756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202759">Interface</span><span class="op" id="2202768">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202774">&#34;interface&#34;</span><span class="op" id="2202785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202788">Map</span><span class="op" id="2202791">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202803">&#34;map&#34;</span><span class="op" id="2202808">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202811">Ptr</span><span class="op" id="2202814">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202826">&#34;ptr&#34;</span><span class="op" id="2202831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202834">Slice</span><span class="op" id="2202839">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202849">&#34;slice&#34;</span><span class="op" id="2202856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202859">String</span><span class="op" id="2202865">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202874">&#34;string&#34;</span><span class="op" id="2202882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202885">Struct</span><span class="op" id="2202891">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2202900">&#34;struct&#34;</span><span class="op" id="2202908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2202911">UnsafePointer</span><span class="op" id="2202924">:</span>&nbsp;<span class="string" id="2202926">&#34;unsafe.Pointer&#34;</span><span class="op" id="2202942">,</span><br>
<span class="lineno">440</span><span class="op" id="2202944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2202947">func</span>&nbsp;<span class="op" id="2202952">(</span><span class="ident" id="2202953">t</span>&nbsp;<span class="op" id="2202955">*</span><span class="ident" id="2202956">uncommonType</span><span class="op" id="2202968">)</span>&nbsp;<span class="ident" id="2202970">uncommon</span><span class="op" id="2202978">(</span><span class="op" id="2202979">)</span>&nbsp;<span class="op" id="2202981">*</span><span class="ident" id="2202982">uncommonType</span>&nbsp;<span class="op" id="2202995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2202998">return</span>&nbsp;<span class="ident" id="2203005">t</span><br>
<span class="lineno"></span><span class="op" id="2203007">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="2203010">func</span>&nbsp;<span class="op" id="2203015">(</span><span class="ident" id="2203016">t</span>&nbsp;<span class="op" id="2203018">*</span><span class="ident" id="2203019">uncommonType</span><span class="op" id="2203031">)</span>&nbsp;<span class="ident" id="2203033">PkgPath</span><span class="op" id="2203040">(</span><span class="op" id="2203041">)</span>&nbsp;<span class="builtintype" id="2203043">string</span>&nbsp;<span class="op" id="2203050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2203053">if</span>&nbsp;<span class="ident" id="2203056">t</span>&nbsp;<span class="op" id="2203058">==</span>&nbsp;<span class="ident" id="2203061">nil</span>&nbsp;<span class="op" id="2203065">||</span>&nbsp;<span class="ident" id="2203068">t</span><span class="op" id="2203069">.</span><span class="ident" id="2203070">pkgPath</span>&nbsp;<span class="op" id="2203078">==</span>&nbsp;<span class="ident" id="2203081">nil</span>&nbsp;<span class="op" id="2203085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2203089">return</span>&nbsp;<span class="string" id="2203096">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2203100">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2203103">return</span>&nbsp;<span class="op" id="2203110">*</span><span class="ident" id="2203111">t</span><span class="op" id="2203112">.</span><span class="ident" id="2203113">pkgPath</span><br>
<span class="lineno"></span><span class="op" id="2203121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2203124">func</span>&nbsp;<span class="op" id="2203129">(</span><span class="ident" id="2203130">t</span>&nbsp;<span class="op" id="2203132">*</span><span class="ident" id="2203133">uncommonType</span><span class="op" id="2203145">)</span>&nbsp;<span class="ident" id="2203147">Name</span><span class="op" id="2203151">(</span><span class="op" id="2203152">)</span>&nbsp;<span class="builtintype" id="2203154">string</span>&nbsp;<span class="op" id="2203161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2203164">if</span>&nbsp;<span class="ident" id="2203167">t</span>&nbsp;<span class="op" id="2203169">==</span>&nbsp;<span class="ident" id="2203172">nil</span>&nbsp;<span class="op" id="2203176">||</span>&nbsp;<span class="ident" id="2203179">t</span><span class="op" id="2203180">.</span><span class="ident" id="2203181">name</span>&nbsp;<span class="op" id="2203186">==</span>&nbsp;<span class="ident" id="2203189">nil</span>&nbsp;<span class="op" id="2203193">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2203197">return</span>&nbsp;<span class="string" id="2203204">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2203208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2203211">return</span>&nbsp;<span class="op" id="2203218">*</span><span class="ident" id="2203219">t</span><span class="op" id="2203220">.</span><span class="ident" id="2203221">name</span><br>
<span class="lineno"></span><span class="op" id="2203226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="2203229">func</span>&nbsp;<span class="op" id="2203234">(</span><span class="ident" id="2203235">t</span>&nbsp;<span class="op" id="2203237">*</span><span class="ident" id="2203238">rtype</span><span class="op" id="2203243">)</span>&nbsp;<span class="ident" id="2203245">String</span><span class="op" id="2203251">(</span><span class="op" id="2203252">)</span>&nbsp;<span class="builtintype" id="2203254">string</span>&nbsp;<span class="op" id="2203261">{</span>&nbsp;<span class="keyword" id="2203263">return</span>&nbsp;<span class="op" id="2203270">*</span><span class="ident" id="2203271">t</span><span class="op" id="2203272">.</span><span class="builtintype" id="2203273">string</span>&nbsp;<span class="op" id="2203280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2203283">func</span>&nbsp;<span class="op" id="2203288">(</span><span class="ident" id="2203289">t</span>&nbsp;<span class="op" id="2203291">*</span><span class="ident" id="2203292">rtype</span><span class="op" id="2203297">)</span>&nbsp;<span class="ident" id="2203299">Size</span><span class="op" id="2203303">(</span><span class="op" id="2203304">)</span>&nbsp;<span class="builtintype" id="2203306">uintptr</span>&nbsp;<span class="op" id="2203314">{</span>&nbsp;<span class="keyword" id="2203316">return</span>&nbsp;<span class="ident" id="2203323">t</span><span class="op" id="2203324">.</span><span class="ident" id="2203325">size</span>&nbsp;<span class="op" id="2203330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2203333">func</span>&nbsp;<span class="op" id="2203338">(</span><span class="ident" id="2203339">t</span>&nbsp;<span class="op" id="2203341">*</span><span class="ident" id="2203342">rtype</span><span class="op" id="2203347">)</span>&nbsp;<span class="ident" id="2203349">Bits</span><span class="op" id="2203353">(</span><span class="op" id="2203354">)</span>&nbsp;<span class="builtintype" id="2203356">int</span>&nbsp;<span class="op" id="2203360">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2203363">if</span>&nbsp;<span class="ident" id="2203366">t</span>&nbsp;<span class="op" id="2203368">==</span>&nbsp;<span class="ident" id="2203371">nil</span>&nbsp;<span class="op" id="2203375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2203379">panic</span><span class="op" id="2203384">(</span><span class="string" id="2203385">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;nil&nbsp;Type&#34;</span><span class="op" id="2203412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2203415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2203418">k</span>&nbsp;<span class="op" id="2203420">:=</span>&nbsp;<span class="ident" id="2203423">t</span><span class="op" id="2203424">.</span><span class="ident" id="2203425">Kind</span><span class="op" id="2203429">(</span><span class="op" id="2203430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2203433">if</span>&nbsp;<span class="ident" id="2203436">k</span>&nbsp;<span class="op" id="2203438">&lt;</span>&nbsp;<span class="ident" id="2203440">Int</span>&nbsp;<span class="op" id="2203444">||</span>&nbsp;<span class="ident" id="2203447">k</span>&nbsp;<span class="op" id="2203449">&gt;</span>&nbsp;<span class="ident" id="2203451">Complex128</span>&nbsp;<span class="op" id="2203462">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2203466">panic</span><span class="op" id="2203471">(</span><span class="string" id="2203472">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;non-arithmetic&nbsp;Type&nbsp;&#34;</span>&nbsp;<span class="op" id="2203512">+</span>&nbsp;<span class="ident" id="2203514">t</span><span class="op" id="2203515">.</span><span class="ident" id="2203516">String</span><span class="op" id="2203522">(</span><span class="op" id="2203523">)</span><span class="op" id="2203524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2203527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2203530">return</span>&nbsp;<span class="builtintype" id="2203537">int</span><span class="op" id="2203540">(</span><span class="ident" id="2203541">t</span><span class="op" id="2203542">.</span><span class="ident" id="2203543">size</span><span class="op" id="2203547">)</span>&nbsp;<span class="op" id="2203549">*</span>&nbsp;<span class="num" id="2203551">8</span><br>
<span class="lineno"></span><span class="op" id="2203553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="2203556">func</span>&nbsp;<span class="op" id="2203561">(</span><span class="ident" id="2203562">t</span>&nbsp;<span class="op" id="2203564">*</span><span class="ident" id="2203565">rtype</span><span class="op" id="2203570">)</span>&nbsp;<span class="ident" id="2203572">Align</span><span class="op" id="2203577">(</span><span class="op" id="2203578">)</span>&nbsp;<span class="builtintype" id="2203580">int</span>&nbsp;<span class="op" id="2203584">{</span>&nbsp;<span class="keyword" id="2203586">return</span>&nbsp;<span class="builtintype" id="2203593">int</span><span class="op" id="2203596">(</span><span class="ident" id="2203597">t</span><span class="op" id="2203598">.</span><span class="ident" id="2203599">align</span><span class="op" id="2203604">)</span>&nbsp;<span class="op" id="2203606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2203609">func</span>&nbsp;<span class="op" id="2203614">(</span><span class="ident" id="2203615">t</span>&nbsp;<span class="op" id="2203617">*</span><span class="ident" id="2203618">rtype</span><span class="op" id="2203623">)</span>&nbsp;<span class="ident" id="2203625">FieldAlign</span><span class="op" id="2203635">(</span><span class="op" id="2203636">)</span>&nbsp;<span class="builtintype" id="2203638">int</span>&nbsp;<span class="op" id="2203642">{</span>&nbsp;<span class="keyword" id="2203644">return</span>&nbsp;<span class="builtintype" id="2203651">int</span><span class="op" id="2203654">(</span><span class="ident" id="2203655">t</span><span class="op" id="2203656">.</span><span class="ident" id="2203657">fieldAlign</span><span class="op" id="2203667">)</span>&nbsp;<span class="op" id="2203669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2203672">func</span>&nbsp;<span class="op" id="2203677">(</span><span class="ident" id="2203678">t</span>&nbsp;<span class="op" id="2203680">*</span><span class="ident" id="2203681">rtype</span><span class="op" id="2203686">)</span>&nbsp;<span class="ident" id="2203688">Kind</span><span class="op" id="2203692">(</span><span class="op" id="2203693">)</span>&nbsp;<span class="ident" id="2203695">Kind</span>&nbsp;<span class="op" id="2203700">{</span>&nbsp;<span class="keyword" id="2203702">return</span>&nbsp;<span class="ident" id="2203709">Kind</span><span class="op" id="2203713">(</span><span class="ident" id="2203714">t</span><span class="op" id="2203715">.</span><span class="ident" id="2203716">kind</span>&nbsp;<span class="op" id="2203721">&amp;</span>&nbsp;<span class="ident" id="2203723">kindMask</span><span class="op" id="2203731">)</span>&nbsp;<span class="op" id="2203733">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="keyword" id="2203736">func</span>&nbsp;<span class="op" id="2203741">(</span><span class="ident" id="2203742">t</span>&nbsp;<span class="op" id="2203744">*</span><span class="ident" id="2203745">rtype</span><span class="op" id="2203750">)</span>&nbsp;<span class="ident" id="2203752">pointers</span><span class="op" id="2203760">(</span><span class="op" id="2203761">)</span>&nbsp;<span class="builtintype" id="2203763">bool</span>&nbsp;<span class="op" id="2203768">{</span>&nbsp;<span class="keyword" id="2203770">return</span>&nbsp;<span class="ident" id="2203777">t</span><span class="op" id="2203778">.</span><span class="ident" id="2203779">kind</span><span class="op" id="2203783">&amp;</span><span class="ident" id="2203784">kindNoPointers</span>&nbsp;<span class="op" id="2203799">==</span>&nbsp;<span class="num" id="2203802">0</span>&nbsp;<span class="op" id="2203804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2203807">func</span>&nbsp;<span class="op" id="2203812">(</span><span class="ident" id="2203813">t</span>&nbsp;<span class="op" id="2203815">*</span><span class="ident" id="2203816">rtype</span><span class="op" id="2203821">)</span>&nbsp;<span class="ident" id="2203823">common</span><span class="op" id="2203829">(</span><span class="op" id="2203830">)</span>&nbsp;<span class="op" id="2203832">*</span><span class="ident" id="2203833">rtype</span>&nbsp;<span class="op" id="2203839">{</span>&nbsp;<span class="keyword" id="2203841">return</span>&nbsp;<span class="ident" id="2203848">t</span>&nbsp;<span class="op" id="2203850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2203853">func</span>&nbsp;<span class="op" id="2203858">(</span><span class="ident" id="2203859">t</span>&nbsp;<span class="op" id="2203861">*</span><span class="ident" id="2203862">uncommonType</span><span class="op" id="2203874">)</span>&nbsp;<span class="ident" id="2203876">Method</span><span class="op" id="2203882">(</span><span class="ident" id="2203883">i</span>&nbsp;<span class="builtintype" id="2203885">int</span><span class="op" id="2203888">)</span>&nbsp;<span class="op" id="2203890">(</span><span class="ident" id="2203891">m</span>&nbsp;<span class="ident" id="2203893">Method</span><span class="op" id="2203899">)</span>&nbsp;<span class="op" id="2203901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2203904">if</span>&nbsp;<span class="ident" id="2203907">t</span>&nbsp;<span class="op" id="2203909">==</span>&nbsp;<span class="ident" id="2203912">nil</span>&nbsp;<span class="op" id="2203916">||</span>&nbsp;<span class="ident" id="2203919">i</span>&nbsp;<span class="op" id="2203921">&lt;</span>&nbsp;<span class="num" id="2203923">0</span>&nbsp;<span class="op" id="2203925">||</span>&nbsp;<span class="ident" id="2203928">i</span>&nbsp;<span class="op" id="2203930">&gt;=</span>&nbsp;<span class="builtinfunc" id="2203933">len</span><span class="op" id="2203936">(</span><span class="ident" id="2203937">t</span><span class="op" id="2203938">.</span><span class="ident" id="2203939">methods</span><span class="op" id="2203946">)</span>&nbsp;<span class="op" id="2203948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2203952">panic</span><span class="op" id="2203957">(</span><span class="string" id="2203958">&#34;reflect:&nbsp;Method&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="2203994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2203997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2204000">p</span>&nbsp;<span class="op" id="2204002">:=</span>&nbsp;<span class="op" id="2204005">&amp;</span><span class="ident" id="2204006">t</span><span class="op" id="2204007">.</span><span class="ident" id="2204008">methods</span><span class="op" id="2204015">[</span><span class="ident" id="2204016">i</span><span class="op" id="2204017">]</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204020">if</span>&nbsp;<span class="ident" id="2204023">p</span><span class="op" id="2204024">.</span><span class="ident" id="2204025">name</span>&nbsp;<span class="op" id="2204030">!=</span>&nbsp;<span class="ident" id="2204033">nil</span>&nbsp;<span class="op" id="2204037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2204041">m</span><span class="op" id="2204042">.</span><span class="ident" id="2204043">Name</span>&nbsp;<span class="op" id="2204048">=</span>&nbsp;<span class="op" id="2204050">*</span><span class="ident" id="2204051">p</span><span class="op" id="2204052">.</span><span class="ident" id="2204053">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2204059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2204062">fl</span>&nbsp;<span class="op" id="2204065">:=</span>&nbsp;<span class="ident" id="2204068">flag</span><span class="op" id="2204072">(</span><span class="ident" id="2204073">Func</span><span class="op" id="2204077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204080">if</span>&nbsp;<span class="ident" id="2204083">p</span><span class="op" id="2204084">.</span><span class="ident" id="2204085">pkgPath</span>&nbsp;<span class="op" id="2204093">!=</span>&nbsp;<span class="ident" id="2204096">nil</span>&nbsp;<span class="op" id="2204100">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2204104">m</span><span class="op" id="2204105">.</span><span class="ident" id="2204106">PkgPath</span>&nbsp;<span class="op" id="2204114">=</span>&nbsp;<span class="op" id="2204116">*</span><span class="ident" id="2204117">p</span><span class="op" id="2204118">.</span><span class="ident" id="2204119">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2204129">fl</span>&nbsp;<span class="op" id="2204132">|=</span>&nbsp;<span class="ident" id="2204135">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2204143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2204146">mt</span>&nbsp;<span class="op" id="2204149">:=</span>&nbsp;<span class="ident" id="2204152">p</span><span class="op" id="2204153">.</span><span class="ident" id="2204154">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2204159">m</span><span class="op" id="2204160">.</span><span class="ident" id="2204161">Type</span>&nbsp;<span class="op" id="2204166">=</span>&nbsp;<span class="ident" id="2204168">mt</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2204172">fn</span>&nbsp;<span class="op" id="2204175">:=</span>&nbsp;<span class="ident" id="2204178">unsafe</span><span class="op" id="2204184">.</span><span class="ident" id="2204185">Pointer</span><span class="op" id="2204192">(</span><span class="op" id="2204193">&amp;</span><span class="ident" id="2204194">p</span><span class="op" id="2204195">.</span><span class="ident" id="2204196">tfn</span><span class="op" id="2204199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2204202">m</span><span class="op" id="2204203">.</span><span class="ident" id="2204204">Func</span>&nbsp;<span class="op" id="2204209">=</span>&nbsp;<span class="ident" id="2204211">Value</span><span class="op" id="2204216">{</span><span class="ident" id="2204217">mt</span><span class="op" id="2204219">,</span>&nbsp;<span class="ident" id="2204221">fn</span><span class="op" id="2204223">,</span>&nbsp;<span class="ident" id="2204225">fl</span><span class="op" id="2204227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2204230">m</span><span class="op" id="2204231">.</span><span class="ident" id="2204232">Index</span>&nbsp;<span class="op" id="2204238">=</span>&nbsp;<span class="ident" id="2204240">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204243">return</span><br>
<span class="lineno"></span><span class="op" id="2204250">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="2204253">func</span>&nbsp;<span class="op" id="2204258">(</span><span class="ident" id="2204259">t</span>&nbsp;<span class="op" id="2204261">*</span><span class="ident" id="2204262">uncommonType</span><span class="op" id="2204274">)</span>&nbsp;<span class="ident" id="2204276">NumMethod</span><span class="op" id="2204285">(</span><span class="op" id="2204286">)</span>&nbsp;<span class="builtintype" id="2204288">int</span>&nbsp;<span class="op" id="2204292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204295">if</span>&nbsp;<span class="ident" id="2204298">t</span>&nbsp;<span class="op" id="2204300">==</span>&nbsp;<span class="ident" id="2204303">nil</span>&nbsp;<span class="op" id="2204307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204311">return</span>&nbsp;<span class="num" id="2204318">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2204321">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204324">return</span>&nbsp;<span class="builtinfunc" id="2204331">len</span><span class="op" id="2204334">(</span><span class="ident" id="2204335">t</span><span class="op" id="2204336">.</span><span class="ident" id="2204337">methods</span><span class="op" id="2204344">)</span><br>
<span class="lineno"></span><span class="op" id="2204346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2204349">func</span>&nbsp;<span class="op" id="2204354">(</span><span class="ident" id="2204355">t</span>&nbsp;<span class="op" id="2204357">*</span><span class="ident" id="2204358">uncommonType</span><span class="op" id="2204370">)</span>&nbsp;<span class="ident" id="2204372">MethodByName</span><span class="op" id="2204384">(</span><span class="ident" id="2204385">name</span>&nbsp;<span class="builtintype" id="2204390">string</span><span class="op" id="2204396">)</span>&nbsp;<span class="op" id="2204398">(</span><span class="ident" id="2204399">m</span>&nbsp;<span class="ident" id="2204401">Method</span><span class="op" id="2204407">,</span>&nbsp;<span class="ident" id="2204409">ok</span>&nbsp;<span class="builtintype" id="2204412">bool</span><span class="op" id="2204416">)</span>&nbsp;<span class="op" id="2204418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204421">if</span>&nbsp;<span class="ident" id="2204424">t</span>&nbsp;<span class="op" id="2204426">==</span>&nbsp;<span class="ident" id="2204429">nil</span>&nbsp;<span class="op" id="2204433">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204437">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2204445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204448">var</span>&nbsp;<span class="ident" id="2204452">p</span>&nbsp;<span class="op" id="2204454">*</span><span class="ident" id="2204455">method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204463">for</span>&nbsp;<span class="ident" id="2204467">i</span>&nbsp;<span class="op" id="2204469">:=</span>&nbsp;<span class="keyword" id="2204472">range</span>&nbsp;<span class="ident" id="2204478">t</span><span class="op" id="2204479">.</span><span class="ident" id="2204480">methods</span>&nbsp;<span class="op" id="2204488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2204492">p</span>&nbsp;<span class="op" id="2204494">=</span>&nbsp;<span class="op" id="2204496">&amp;</span><span class="ident" id="2204497">t</span><span class="op" id="2204498">.</span><span class="ident" id="2204499">methods</span><span class="op" id="2204506">[</span><span class="ident" id="2204507">i</span><span class="op" id="2204508">]</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204512">if</span>&nbsp;<span class="ident" id="2204515">p</span><span class="op" id="2204516">.</span><span class="ident" id="2204517">name</span>&nbsp;<span class="op" id="2204522">!=</span>&nbsp;<span class="ident" id="2204525">nil</span>&nbsp;<span class="op" id="2204529">&amp;&amp;</span>&nbsp;<span class="op" id="2204532">*</span><span class="ident" id="2204533">p</span><span class="op" id="2204534">.</span><span class="ident" id="2204535">name</span>&nbsp;<span class="op" id="2204540">==</span>&nbsp;<span class="ident" id="2204543">name</span>&nbsp;<span class="op" id="2204548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204553">return</span>&nbsp;<span class="ident" id="2204560">t</span><span class="op" id="2204561">.</span><span class="ident" id="2204562">Method</span><span class="op" id="2204568">(</span><span class="ident" id="2204569">i</span><span class="op" id="2204570">)</span><span class="op" id="2204571">,</span>&nbsp;<span class="builtintype" id="2204573">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2204580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2204583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204586">return</span><br>
<span class="lineno">525</span><span class="op" id="2204593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2204596">//&nbsp;TODO(rsc):&nbsp;6g&nbsp;supplies&nbsp;these,&nbsp;but&nbsp;they&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2204646">//&nbsp;as&nbsp;efficient&nbsp;as&nbsp;they&nbsp;could&nbsp;be:&nbsp;they&nbsp;have&nbsp;commonType</span><br>
<span class="lineno"></span><span class="comment" id="2204701">//&nbsp;as&nbsp;the&nbsp;receiver&nbsp;instead&nbsp;of&nbsp;*rtype.</span><br>
<span class="lineno">530</span><span class="keyword" id="2204739">func</span>&nbsp;<span class="op" id="2204744">(</span><span class="ident" id="2204745">t</span>&nbsp;<span class="op" id="2204747">*</span><span class="ident" id="2204748">rtype</span><span class="op" id="2204753">)</span>&nbsp;<span class="ident" id="2204755">NumMethod</span><span class="op" id="2204764">(</span><span class="op" id="2204765">)</span>&nbsp;<span class="builtintype" id="2204767">int</span>&nbsp;<span class="op" id="2204771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204774">if</span>&nbsp;<span class="ident" id="2204777">t</span><span class="op" id="2204778">.</span><span class="ident" id="2204779">Kind</span><span class="op" id="2204783">(</span><span class="op" id="2204784">)</span>&nbsp;<span class="op" id="2204786">==</span>&nbsp;<span class="ident" id="2204789">Interface</span>&nbsp;<span class="op" id="2204799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2204803">tt</span>&nbsp;<span class="op" id="2204806">:=</span>&nbsp;<span class="op" id="2204809">(</span><span class="op" id="2204810">*</span><span class="ident" id="2204811">interfaceType</span><span class="op" id="2204824">)</span><span class="op" id="2204825">(</span><span class="ident" id="2204826">unsafe</span><span class="op" id="2204832">.</span><span class="ident" id="2204833">Pointer</span><span class="op" id="2204840">(</span><span class="ident" id="2204841">t</span><span class="op" id="2204842">)</span><span class="op" id="2204843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204847">return</span>&nbsp;<span class="ident" id="2204854">tt</span><span class="op" id="2204856">.</span><span class="ident" id="2204857">NumMethod</span><span class="op" id="2204866">(</span><span class="op" id="2204867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2204870">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204873">return</span>&nbsp;<span class="ident" id="2204880">t</span><span class="op" id="2204881">.</span><span class="ident" id="2204882">uncommonType</span><span class="op" id="2204894">.</span><span class="ident" id="2204895">NumMethod</span><span class="op" id="2204904">(</span><span class="op" id="2204905">)</span><br>
<span class="lineno"></span><span class="op" id="2204907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2204910">func</span>&nbsp;<span class="op" id="2204915">(</span><span class="ident" id="2204916">t</span>&nbsp;<span class="op" id="2204918">*</span><span class="ident" id="2204919">rtype</span><span class="op" id="2204924">)</span>&nbsp;<span class="ident" id="2204926">Method</span><span class="op" id="2204932">(</span><span class="ident" id="2204933">i</span>&nbsp;<span class="builtintype" id="2204935">int</span><span class="op" id="2204938">)</span>&nbsp;<span class="op" id="2204940">(</span><span class="ident" id="2204941">m</span>&nbsp;<span class="ident" id="2204943">Method</span><span class="op" id="2204949">)</span>&nbsp;<span class="op" id="2204951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2204954">if</span>&nbsp;<span class="ident" id="2204957">t</span><span class="op" id="2204958">.</span><span class="ident" id="2204959">Kind</span><span class="op" id="2204963">(</span><span class="op" id="2204964">)</span>&nbsp;<span class="op" id="2204966">==</span>&nbsp;<span class="ident" id="2204969">Interface</span>&nbsp;<span class="op" id="2204979">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2204983">tt</span>&nbsp;<span class="op" id="2204986">:=</span>&nbsp;<span class="op" id="2204989">(</span><span class="op" id="2204990">*</span><span class="ident" id="2204991">interfaceType</span><span class="op" id="2205004">)</span><span class="op" id="2205005">(</span><span class="ident" id="2205006">unsafe</span><span class="op" id="2205012">.</span><span class="ident" id="2205013">Pointer</span><span class="op" id="2205020">(</span><span class="ident" id="2205021">t</span><span class="op" id="2205022">)</span><span class="op" id="2205023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205027">return</span>&nbsp;<span class="ident" id="2205034">tt</span><span class="op" id="2205036">.</span><span class="ident" id="2205037">Method</span><span class="op" id="2205043">(</span><span class="ident" id="2205044">i</span><span class="op" id="2205045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2205048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205051">return</span>&nbsp;<span class="ident" id="2205058">t</span><span class="op" id="2205059">.</span><span class="ident" id="2205060">uncommonType</span><span class="op" id="2205072">.</span><span class="ident" id="2205073">Method</span><span class="op" id="2205079">(</span><span class="ident" id="2205080">i</span><span class="op" id="2205081">)</span><br>
<span class="lineno"></span><span class="op" id="2205083">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="keyword" id="2205086">func</span>&nbsp;<span class="op" id="2205091">(</span><span class="ident" id="2205092">t</span>&nbsp;<span class="op" id="2205094">*</span><span class="ident" id="2205095">rtype</span><span class="op" id="2205100">)</span>&nbsp;<span class="ident" id="2205102">MethodByName</span><span class="op" id="2205114">(</span><span class="ident" id="2205115">name</span>&nbsp;<span class="builtintype" id="2205120">string</span><span class="op" id="2205126">)</span>&nbsp;<span class="op" id="2205128">(</span><span class="ident" id="2205129">m</span>&nbsp;<span class="ident" id="2205131">Method</span><span class="op" id="2205137">,</span>&nbsp;<span class="ident" id="2205139">ok</span>&nbsp;<span class="builtintype" id="2205142">bool</span><span class="op" id="2205146">)</span>&nbsp;<span class="op" id="2205148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205151">if</span>&nbsp;<span class="ident" id="2205154">t</span><span class="op" id="2205155">.</span><span class="ident" id="2205156">Kind</span><span class="op" id="2205160">(</span><span class="op" id="2205161">)</span>&nbsp;<span class="op" id="2205163">==</span>&nbsp;<span class="ident" id="2205166">Interface</span>&nbsp;<span class="op" id="2205176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2205180">tt</span>&nbsp;<span class="op" id="2205183">:=</span>&nbsp;<span class="op" id="2205186">(</span><span class="op" id="2205187">*</span><span class="ident" id="2205188">interfaceType</span><span class="op" id="2205201">)</span><span class="op" id="2205202">(</span><span class="ident" id="2205203">unsafe</span><span class="op" id="2205209">.</span><span class="ident" id="2205210">Pointer</span><span class="op" id="2205217">(</span><span class="ident" id="2205218">t</span><span class="op" id="2205219">)</span><span class="op" id="2205220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205224">return</span>&nbsp;<span class="ident" id="2205231">tt</span><span class="op" id="2205233">.</span><span class="ident" id="2205234">MethodByName</span><span class="op" id="2205246">(</span><span class="ident" id="2205247">name</span><span class="op" id="2205251">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2205254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205257">return</span>&nbsp;<span class="ident" id="2205264">t</span><span class="op" id="2205265">.</span><span class="ident" id="2205266">uncommonType</span><span class="op" id="2205278">.</span><span class="ident" id="2205279">MethodByName</span><span class="op" id="2205291">(</span><span class="ident" id="2205292">name</span><span class="op" id="2205296">)</span><br>
<span class="lineno"></span><span class="op" id="2205298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2205301">func</span>&nbsp;<span class="op" id="2205306">(</span><span class="ident" id="2205307">t</span>&nbsp;<span class="op" id="2205309">*</span><span class="ident" id="2205310">rtype</span><span class="op" id="2205315">)</span>&nbsp;<span class="ident" id="2205317">PkgPath</span><span class="op" id="2205324">(</span><span class="op" id="2205325">)</span>&nbsp;<span class="builtintype" id="2205327">string</span>&nbsp;<span class="op" id="2205334">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205337">return</span>&nbsp;<span class="ident" id="2205344">t</span><span class="op" id="2205345">.</span><span class="ident" id="2205346">uncommonType</span><span class="op" id="2205358">.</span><span class="ident" id="2205359">PkgPath</span><span class="op" id="2205366">(</span><span class="op" id="2205367">)</span><br>
<span class="lineno"></span><span class="op" id="2205369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2205372">func</span>&nbsp;<span class="op" id="2205377">(</span><span class="ident" id="2205378">t</span>&nbsp;<span class="op" id="2205380">*</span><span class="ident" id="2205381">rtype</span><span class="op" id="2205386">)</span>&nbsp;<span class="ident" id="2205388">Name</span><span class="op" id="2205392">(</span><span class="op" id="2205393">)</span>&nbsp;<span class="builtintype" id="2205395">string</span>&nbsp;<span class="op" id="2205402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205405">return</span>&nbsp;<span class="ident" id="2205412">t</span><span class="op" id="2205413">.</span><span class="ident" id="2205414">uncommonType</span><span class="op" id="2205426">.</span><span class="ident" id="2205427">Name</span><span class="op" id="2205431">(</span><span class="op" id="2205432">)</span><br>
<span class="lineno">560</span><span class="op" id="2205434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2205437">func</span>&nbsp;<span class="op" id="2205442">(</span><span class="ident" id="2205443">t</span>&nbsp;<span class="op" id="2205445">*</span><span class="ident" id="2205446">rtype</span><span class="op" id="2205451">)</span>&nbsp;<span class="ident" id="2205453">ChanDir</span><span class="op" id="2205460">(</span><span class="op" id="2205461">)</span>&nbsp;<span class="ident" id="2205463">ChanDir</span>&nbsp;<span class="op" id="2205471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205474">if</span>&nbsp;<span class="ident" id="2205477">t</span><span class="op" id="2205478">.</span><span class="ident" id="2205479">Kind</span><span class="op" id="2205483">(</span><span class="op" id="2205484">)</span>&nbsp;<span class="op" id="2205486">!=</span>&nbsp;<span class="ident" id="2205489">Chan</span>&nbsp;<span class="op" id="2205494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2205498">panic</span><span class="op" id="2205503">(</span><span class="string" id="2205504">&#34;reflect:&nbsp;ChanDir&nbsp;of&nbsp;non-chan&nbsp;type&#34;</span><span class="op" id="2205539">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2205542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2205545">tt</span>&nbsp;<span class="op" id="2205548">:=</span>&nbsp;<span class="op" id="2205551">(</span><span class="op" id="2205552">*</span><span class="ident" id="2205553">chanType</span><span class="op" id="2205561">)</span><span class="op" id="2205562">(</span><span class="ident" id="2205563">unsafe</span><span class="op" id="2205569">.</span><span class="ident" id="2205570">Pointer</span><span class="op" id="2205577">(</span><span class="ident" id="2205578">t</span><span class="op" id="2205579">)</span><span class="op" id="2205580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205583">return</span>&nbsp;<span class="ident" id="2205590">ChanDir</span><span class="op" id="2205597">(</span><span class="ident" id="2205598">tt</span><span class="op" id="2205600">.</span><span class="ident" id="2205601">dir</span><span class="op" id="2205604">)</span><br>
<span class="lineno"></span><span class="op" id="2205606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="keyword" id="2205609">func</span>&nbsp;<span class="op" id="2205614">(</span><span class="ident" id="2205615">t</span>&nbsp;<span class="op" id="2205617">*</span><span class="ident" id="2205618">rtype</span><span class="op" id="2205623">)</span>&nbsp;<span class="ident" id="2205625">IsVariadic</span><span class="op" id="2205635">(</span><span class="op" id="2205636">)</span>&nbsp;<span class="builtintype" id="2205638">bool</span>&nbsp;<span class="op" id="2205643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205646">if</span>&nbsp;<span class="ident" id="2205649">t</span><span class="op" id="2205650">.</span><span class="ident" id="2205651">Kind</span><span class="op" id="2205655">(</span><span class="op" id="2205656">)</span>&nbsp;<span class="op" id="2205658">!=</span>&nbsp;<span class="ident" id="2205661">Func</span>&nbsp;<span class="op" id="2205666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2205670">panic</span><span class="op" id="2205675">(</span><span class="string" id="2205676">&#34;reflect:&nbsp;IsVariadic&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2205714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2205717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2205720">tt</span>&nbsp;<span class="op" id="2205723">:=</span>&nbsp;<span class="op" id="2205726">(</span><span class="op" id="2205727">*</span><span class="ident" id="2205728">funcType</span><span class="op" id="2205736">)</span><span class="op" id="2205737">(</span><span class="ident" id="2205738">unsafe</span><span class="op" id="2205744">.</span><span class="ident" id="2205745">Pointer</span><span class="op" id="2205752">(</span><span class="ident" id="2205753">t</span><span class="op" id="2205754">)</span><span class="op" id="2205755">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205758">return</span>&nbsp;<span class="ident" id="2205765">tt</span><span class="op" id="2205767">.</span><span class="ident" id="2205768">dotdotdot</span><br>
<span class="lineno"></span><span class="op" id="2205778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2205781">func</span>&nbsp;<span class="op" id="2205786">(</span><span class="ident" id="2205787">t</span>&nbsp;<span class="op" id="2205789">*</span><span class="ident" id="2205790">rtype</span><span class="op" id="2205795">)</span>&nbsp;<span class="ident" id="2205797">Elem</span><span class="op" id="2205801">(</span><span class="op" id="2205802">)</span>&nbsp;<span class="ident" id="2205804">Type</span>&nbsp;<span class="op" id="2205809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205812">switch</span>&nbsp;<span class="ident" id="2205819">t</span><span class="op" id="2205820">.</span><span class="ident" id="2205821">Kind</span><span class="op" id="2205825">(</span><span class="op" id="2205826">)</span>&nbsp;<span class="op" id="2205828">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205831">case</span>&nbsp;<span class="ident" id="2205836">Array</span><span class="op" id="2205841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2205845">tt</span>&nbsp;<span class="op" id="2205848">:=</span>&nbsp;<span class="op" id="2205851">(</span><span class="op" id="2205852">*</span><span class="ident" id="2205853">arrayType</span><span class="op" id="2205862">)</span><span class="op" id="2205863">(</span><span class="ident" id="2205864">unsafe</span><span class="op" id="2205870">.</span><span class="ident" id="2205871">Pointer</span><span class="op" id="2205878">(</span><span class="ident" id="2205879">t</span><span class="op" id="2205880">)</span><span class="op" id="2205881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205885">return</span>&nbsp;<span class="ident" id="2205892">toType</span><span class="op" id="2205898">(</span><span class="ident" id="2205899">tt</span><span class="op" id="2205901">.</span><span class="ident" id="2205902">elem</span><span class="op" id="2205906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205909">case</span>&nbsp;<span class="ident" id="2205914">Chan</span><span class="op" id="2205918">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2205922">tt</span>&nbsp;<span class="op" id="2205925">:=</span>&nbsp;<span class="op" id="2205928">(</span><span class="op" id="2205929">*</span><span class="ident" id="2205930">chanType</span><span class="op" id="2205938">)</span><span class="op" id="2205939">(</span><span class="ident" id="2205940">unsafe</span><span class="op" id="2205946">.</span><span class="ident" id="2205947">Pointer</span><span class="op" id="2205954">(</span><span class="ident" id="2205955">t</span><span class="op" id="2205956">)</span><span class="op" id="2205957">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205961">return</span>&nbsp;<span class="ident" id="2205968">toType</span><span class="op" id="2205974">(</span><span class="ident" id="2205975">tt</span><span class="op" id="2205977">.</span><span class="ident" id="2205978">elem</span><span class="op" id="2205982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2205985">case</span>&nbsp;<span class="ident" id="2205990">Map</span><span class="op" id="2205993">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2205997">tt</span>&nbsp;<span class="op" id="2206000">:=</span>&nbsp;<span class="op" id="2206003">(</span><span class="op" id="2206004">*</span><span class="ident" id="2206005">mapType</span><span class="op" id="2206012">)</span><span class="op" id="2206013">(</span><span class="ident" id="2206014">unsafe</span><span class="op" id="2206020">.</span><span class="ident" id="2206021">Pointer</span><span class="op" id="2206028">(</span><span class="ident" id="2206029">t</span><span class="op" id="2206030">)</span><span class="op" id="2206031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2206035">return</span>&nbsp;<span class="ident" id="2206042">toType</span><span class="op" id="2206048">(</span><span class="ident" id="2206049">tt</span><span class="op" id="2206051">.</span><span class="ident" id="2206052">elem</span><span class="op" id="2206056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2206059">case</span>&nbsp;<span class="ident" id="2206064">Ptr</span><span class="op" id="2206067">:</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2206071">tt</span>&nbsp;<span class="op" id="2206074">:=</span>&nbsp;<span class="op" id="2206077">(</span><span class="op" id="2206078">*</span><span class="ident" id="2206079">ptrType</span><span class="op" id="2206086">)</span><span class="op" id="2206087">(</span><span class="ident" id="2206088">unsafe</span><span class="op" id="2206094">.</span><span class="ident" id="2206095">Pointer</span><span class="op" id="2206102">(</span><span class="ident" id="2206103">t</span><span class="op" id="2206104">)</span><span class="op" id="2206105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2206109">return</span>&nbsp;<span class="ident" id="2206116">toType</span><span class="op" id="2206122">(</span><span class="ident" id="2206123">tt</span><span class="op" id="2206125">.</span><span class="ident" id="2206126">elem</span><span class="op" id="2206130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2206133">case</span>&nbsp;<span class="ident" id="2206138">Slice</span><span class="op" id="2206143">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2206147">tt</span>&nbsp;<span class="op" id="2206150">:=</span>&nbsp;<span class="op" id="2206153">(</span><span class="op" id="2206154">*</span><span class="ident" id="2206155">sliceType</span><span class="op" id="2206164">)</span><span class="op" id="2206165">(</span><span class="ident" id="2206166">unsafe</span><span class="op" id="2206172">.</span><span class="ident" id="2206173">Pointer</span><span class="op" id="2206180">(</span><span class="ident" id="2206181">t</span><span class="op" id="2206182">)</span><span class="op" id="2206183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2206187">return</span>&nbsp;<span class="ident" id="2206194">toType</span><span class="op" id="2206200">(</span><span class="ident" id="2206201">tt</span><span class="op" id="2206203">.</span><span class="ident" id="2206204">elem</span><span class="op" id="2206208">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2206211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2206214">panic</span><span class="op" id="2206219">(</span><span class="string" id="2206220">&#34;reflect:&nbsp;Elem&nbsp;of&nbsp;invalid&nbsp;type&#34;</span><span class="op" id="2206251">)</span><br>
<span class="lineno"></span><span class="op" id="2206253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2206256">func</span>&nbsp;<span class="op" id="2206261">(</span><span class="ident" id="2206262">t</span>&nbsp;<span class="op" id="2206264">*</span><span class="ident" id="2206265">rtype</span><span class="op" id="2206270">)</span>&nbsp;<span class="ident" id="2206272">Field</span><span class="op" id="2206277">(</span><span class="ident" id="2206278">i</span>&nbsp;<span class="builtintype" id="2206280">int</span><span class="op" id="2206283">)</span>&nbsp;<span class="ident" id="2206285">StructField</span>&nbsp;<span class="op" id="2206297">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2206300">if</span>&nbsp;<span class="ident" id="2206303">t</span><span class="op" id="2206304">.</span><span class="ident" id="2206305">Kind</span><span class="op" id="2206309">(</span><span class="op" id="2206310">)</span>&nbsp;<span class="op" id="2206312">!=</span>&nbsp;<span class="ident" id="2206315">Struct</span>&nbsp;<span class="op" id="2206322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2206326">panic</span><span class="op" id="2206331">(</span><span class="string" id="2206332">&#34;reflect:&nbsp;Field&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2206367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2206370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2206373">tt</span>&nbsp;<span class="op" id="2206376">:=</span>&nbsp;<span class="op" id="2206379">(</span><span class="op" id="2206380">*</span><span class="ident" id="2206381">structType</span><span class="op" id="2206391">)</span><span class="op" id="2206392">(</span><span class="ident" id="2206393">unsafe</span><span class="op" id="2206399">.</span><span class="ident" id="2206400">Pointer</span><span class="op" id="2206407">(</span><span class="ident" id="2206408">t</span><span class="op" id="2206409">)</span><span class="op" id="2206410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2206413">return</span>&nbsp;<span class="ident" id="2206420">tt</span><span class="op" id="2206422">.</span><span class="ident" id="2206423">Field</span><span class="op" id="2206428">(</span><span class="ident" id="2206429">i</span><span class="op" id="2206430">)</span><br>
<span class="lineno">605</span><span class="op" id="2206432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2206435">func</span>&nbsp;<span class="op" id="2206440">(</span><span class="ident" id="2206441">t</span>&nbsp;<span class="op" id="2206443">*</span><span class="ident" id="2206444">rtype</span><span class="op" id="2206449">)</span>&nbsp;<span class="ident" id="2206451">FieldByIndex</span><span class="op" id="2206463">(</span><span class="ident" id="2206464">index</span>&nbsp;<span class="op" id="2206470">[</span><span class="op" id="2206471">]</span><span class="builtintype" id="2206472">int</span><span class="op" id="2206475">)</span>&nbsp;<span class="ident" id="2206477">StructField</span>&nbsp;<span class="op" id="2206489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2206492">if</span>&nbsp;<span class="ident" id="2206495">t</span><span class="op" id="2206496">.</span><span class="ident" id="2206497">Kind</span><span class="op" id="2206501">(</span><span class="op" id="2206502">)</span>&nbsp;<span class="op" id="2206504">!=</span>&nbsp;<span class="ident" id="2206507">Struct</span>&nbsp;<span class="op" id="2206514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2206518">panic</span><span class="op" id="2206523">(</span><span class="string" id="2206524">&#34;reflect:&nbsp;FieldByIndex&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2206566">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2206569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2206572">tt</span>&nbsp;<span class="op" id="2206575">:=</span>&nbsp;<span class="op" id="2206578">(</span><span class="op" id="2206579">*</span><span class="ident" id="2206580">structType</span><span class="op" id="2206590">)</span><span class="op" id="2206591">(</span><span class="ident" id="2206592">unsafe</span><span class="op" id="2206598">.</span><span class="ident" id="2206599">Pointer</span><span class="op" id="2206606">(</span><span class="ident" id="2206607">t</span><span class="op" id="2206608">)</span><span class="op" id="2206609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2206612">return</span>&nbsp;<span class="ident" id="2206619">tt</span><span class="op" id="2206621">.</span><span class="ident" id="2206622">FieldByIndex</span><span class="op" id="2206634">(</span><span class="ident" id="2206635">index</span><span class="op" id="2206640">)</span><br>
<span class="lineno"></span><span class="op" id="2206642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="2206645">func</span>&nbsp;<span class="op" id="2206650">(</span><span class="ident" id="2206651">t</span>&nbsp;<span class="op" id="2206653">*</span><span class="ident" id="2206654">rtype</span><span class="op" id="2206659">)</span>&nbsp;<span class="ident" id="2206661">FieldByName</span><span class="op" id="2206672">(</span><span class="ident" id="2206673">name</span>&nbsp;<span class="builtintype" id="2206678">string</span><span class="op" id="2206684">)</span>&nbsp;<span class="op" id="2206686">(</span><span class="ident" id="2206687">StructField</span><span class="op" id="2206698">,</span>&nbsp;<span class="builtintype" id="2206700">bool</span><span class="op" id="2206704">)</span>&nbsp;<span class="op" id="2206706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2206709">if</span>&nbsp;<span class="ident" id="2206712">t</span><span class="op" id="2206713">.</span><span class="ident" id="2206714">Kind</span><span class="op" id="2206718">(</span><span class="op" id="2206719">)</span>&nbsp;<span class="op" id="2206721">!=</span>&nbsp;<span class="ident" id="2206724">Struct</span>&nbsp;<span class="op" id="2206731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2206735">panic</span><span class="op" id="2206740">(</span><span class="string" id="2206741">&#34;reflect:&nbsp;FieldByName&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2206782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2206785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2206788">tt</span>&nbsp;<span class="op" id="2206791">:=</span>&nbsp;<span class="op" id="2206794">(</span><span class="op" id="2206795">*</span><span class="ident" id="2206796">structType</span><span class="op" id="2206806">)</span><span class="op" id="2206807">(</span><span class="ident" id="2206808">unsafe</span><span class="op" id="2206814">.</span><span class="ident" id="2206815">Pointer</span><span class="op" id="2206822">(</span><span class="ident" id="2206823">t</span><span class="op" id="2206824">)</span><span class="op" id="2206825">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2206828">return</span>&nbsp;<span class="ident" id="2206835">tt</span><span class="op" id="2206837">.</span><span class="ident" id="2206838">FieldByName</span><span class="op" id="2206849">(</span><span class="ident" id="2206850">name</span><span class="op" id="2206854">)</span><br>
<span class="lineno"></span><span class="op" id="2206856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2206859">func</span>&nbsp;<span class="op" id="2206864">(</span><span class="ident" id="2206865">t</span>&nbsp;<span class="op" id="2206867">*</span><span class="ident" id="2206868">rtype</span><span class="op" id="2206873">)</span>&nbsp;<span class="ident" id="2206875">FieldByNameFunc</span><span class="op" id="2206890">(</span><span class="ident" id="2206891">match</span>&nbsp;<span class="keyword" id="2206897">func</span><span class="op" id="2206901">(</span><span class="builtintype" id="2206902">string</span><span class="op" id="2206908">)</span>&nbsp;<span class="builtintype" id="2206910">bool</span><span class="op" id="2206914">)</span>&nbsp;<span class="op" id="2206916">(</span><span class="ident" id="2206917">StructField</span><span class="op" id="2206928">,</span>&nbsp;<span class="builtintype" id="2206930">bool</span><span class="op" id="2206934">)</span>&nbsp;<span class="op" id="2206936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2206939">if</span>&nbsp;<span class="ident" id="2206942">t</span><span class="op" id="2206943">.</span><span class="ident" id="2206944">Kind</span><span class="op" id="2206948">(</span><span class="op" id="2206949">)</span>&nbsp;<span class="op" id="2206951">!=</span>&nbsp;<span class="ident" id="2206954">Struct</span>&nbsp;<span class="op" id="2206961">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2206965">panic</span><span class="op" id="2206970">(</span><span class="string" id="2206971">&#34;reflect:&nbsp;FieldByNameFunc&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2207016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2207019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2207022">tt</span>&nbsp;<span class="op" id="2207025">:=</span>&nbsp;<span class="op" id="2207028">(</span><span class="op" id="2207029">*</span><span class="ident" id="2207030">structType</span><span class="op" id="2207040">)</span><span class="op" id="2207041">(</span><span class="ident" id="2207042">unsafe</span><span class="op" id="2207048">.</span><span class="ident" id="2207049">Pointer</span><span class="op" id="2207056">(</span><span class="ident" id="2207057">t</span><span class="op" id="2207058">)</span><span class="op" id="2207059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2207062">return</span>&nbsp;<span class="ident" id="2207069">tt</span><span class="op" id="2207071">.</span><span class="ident" id="2207072">FieldByNameFunc</span><span class="op" id="2207087">(</span><span class="ident" id="2207088">match</span><span class="op" id="2207093">)</span><br>
<span class="lineno"></span><span class="op" id="2207095">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="2207098">func</span>&nbsp;<span class="op" id="2207103">(</span><span class="ident" id="2207104">t</span>&nbsp;<span class="op" id="2207106">*</span><span class="ident" id="2207107">rtype</span><span class="op" id="2207112">)</span>&nbsp;<span class="ident" id="2207114">In</span><span class="op" id="2207116">(</span><span class="ident" id="2207117">i</span>&nbsp;<span class="builtintype" id="2207119">int</span><span class="op" id="2207122">)</span>&nbsp;<span class="ident" id="2207124">Type</span>&nbsp;<span class="op" id="2207129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2207132">if</span>&nbsp;<span class="ident" id="2207135">t</span><span class="op" id="2207136">.</span><span class="ident" id="2207137">Kind</span><span class="op" id="2207141">(</span><span class="op" id="2207142">)</span>&nbsp;<span class="op" id="2207144">!=</span>&nbsp;<span class="ident" id="2207147">Func</span>&nbsp;<span class="op" id="2207152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2207156">panic</span><span class="op" id="2207161">(</span><span class="string" id="2207162">&#34;reflect:&nbsp;In&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2207192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2207195">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2207198">tt</span>&nbsp;<span class="op" id="2207201">:=</span>&nbsp;<span class="op" id="2207204">(</span><span class="op" id="2207205">*</span><span class="ident" id="2207206">funcType</span><span class="op" id="2207214">)</span><span class="op" id="2207215">(</span><span class="ident" id="2207216">unsafe</span><span class="op" id="2207222">.</span><span class="ident" id="2207223">Pointer</span><span class="op" id="2207230">(</span><span class="ident" id="2207231">t</span><span class="op" id="2207232">)</span><span class="op" id="2207233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2207236">return</span>&nbsp;<span class="ident" id="2207243">toType</span><span class="op" id="2207249">(</span><span class="ident" id="2207250">tt</span><span class="op" id="2207252">.</span><span class="ident" id="2207253">in</span><span class="op" id="2207255">[</span><span class="ident" id="2207256">i</span><span class="op" id="2207257">]</span><span class="op" id="2207258">)</span><br>
<span class="lineno"></span><span class="op" id="2207260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2207263">func</span>&nbsp;<span class="op" id="2207268">(</span><span class="ident" id="2207269">t</span>&nbsp;<span class="op" id="2207271">*</span><span class="ident" id="2207272">rtype</span><span class="op" id="2207277">)</span>&nbsp;<span class="ident" id="2207279">Key</span><span class="op" id="2207282">(</span><span class="op" id="2207283">)</span>&nbsp;<span class="ident" id="2207285">Type</span>&nbsp;<span class="op" id="2207290">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2207293">if</span>&nbsp;<span class="ident" id="2207296">t</span><span class="op" id="2207297">.</span><span class="ident" id="2207298">Kind</span><span class="op" id="2207302">(</span><span class="op" id="2207303">)</span>&nbsp;<span class="op" id="2207305">!=</span>&nbsp;<span class="ident" id="2207308">Map</span>&nbsp;<span class="op" id="2207312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2207316">panic</span><span class="op" id="2207321">(</span><span class="string" id="2207322">&#34;reflect:&nbsp;Key&nbsp;of&nbsp;non-map&nbsp;type&#34;</span><span class="op" id="2207352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2207355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2207358">tt</span>&nbsp;<span class="op" id="2207361">:=</span>&nbsp;<span class="op" id="2207364">(</span><span class="op" id="2207365">*</span><span class="ident" id="2207366">mapType</span><span class="op" id="2207373">)</span><span class="op" id="2207374">(</span><span class="ident" id="2207375">unsafe</span><span class="op" id="2207381">.</span><span class="ident" id="2207382">Pointer</span><span class="op" id="2207389">(</span><span class="ident" id="2207390">t</span><span class="op" id="2207391">)</span><span class="op" id="2207392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2207395">return</span>&nbsp;<span class="ident" id="2207402">toType</span><span class="op" id="2207408">(</span><span class="ident" id="2207409">tt</span><span class="op" id="2207411">.</span><span class="ident" id="2207412">key</span><span class="op" id="2207415">)</span><br>
<span class="lineno">645</span><span class="op" id="2207417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2207420">func</span>&nbsp;<span class="op" id="2207425">(</span><span class="ident" id="2207426">t</span>&nbsp;<span class="op" id="2207428">*</span><span class="ident" id="2207429">rtype</span><span class="op" id="2207434">)</span>&nbsp;<span class="ident" id="2207436">Len</span><span class="op" id="2207439">(</span><span class="op" id="2207440">)</span>&nbsp;<span class="builtintype" id="2207442">int</span>&nbsp;<span class="op" id="2207446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2207449">if</span>&nbsp;<span class="ident" id="2207452">t</span><span class="op" id="2207453">.</span><span class="ident" id="2207454">Kind</span><span class="op" id="2207458">(</span><span class="op" id="2207459">)</span>&nbsp;<span class="op" id="2207461">!=</span>&nbsp;<span class="ident" id="2207464">Array</span>&nbsp;<span class="op" id="2207470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2207474">panic</span><span class="op" id="2207479">(</span><span class="string" id="2207480">&#34;reflect:&nbsp;Len&nbsp;of&nbsp;non-array&nbsp;type&#34;</span><span class="op" id="2207512">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2207515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2207518">tt</span>&nbsp;<span class="op" id="2207521">:=</span>&nbsp;<span class="op" id="2207524">(</span><span class="op" id="2207525">*</span><span class="ident" id="2207526">arrayType</span><span class="op" id="2207535">)</span><span class="op" id="2207536">(</span><span class="ident" id="2207537">unsafe</span><span class="op" id="2207543">.</span><span class="ident" id="2207544">Pointer</span><span class="op" id="2207551">(</span><span class="ident" id="2207552">t</span><span class="op" id="2207553">)</span><span class="op" id="2207554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2207557">return</span>&nbsp;<span class="builtintype" id="2207564">int</span><span class="op" id="2207567">(</span><span class="ident" id="2207568">tt</span><span class="op" id="2207570">.</span><span class="builtinfunc" id="2207571">len</span><span class="op" id="2207574">)</span><br>
<span class="lineno"></span><span class="op" id="2207576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="2207579">func</span>&nbsp;<span class="op" id="2207584">(</span><span class="ident" id="2207585">t</span>&nbsp;<span class="op" id="2207587">*</span><span class="ident" id="2207588">rtype</span><span class="op" id="2207593">)</span>&nbsp;<span class="ident" id="2207595">NumField</span><span class="op" id="2207603">(</span><span class="op" id="2207604">)</span>&nbsp;<span class="builtintype" id="2207606">int</span>&nbsp;<span class="op" id="2207610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2207613">if</span>&nbsp;<span class="ident" id="2207616">t</span><span class="op" id="2207617">.</span><span class="ident" id="2207618">Kind</span><span class="op" id="2207622">(</span><span class="op" id="2207623">)</span>&nbsp;<span class="op" id="2207625">!=</span>&nbsp;<span class="ident" id="2207628">Struct</span>&nbsp;<span class="op" id="2207635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2207639">panic</span><span class="op" id="2207644">(</span><span class="string" id="2207645">&#34;reflect:&nbsp;NumField&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2207683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2207686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2207689">tt</span>&nbsp;<span class="op" id="2207692">:=</span>&nbsp;<span class="op" id="2207695">(</span><span class="op" id="2207696">*</span><span class="ident" id="2207697">structType</span><span class="op" id="2207707">)</span><span class="op" id="2207708">(</span><span class="ident" id="2207709">unsafe</span><span class="op" id="2207715">.</span><span class="ident" id="2207716">Pointer</span><span class="op" id="2207723">(</span><span class="ident" id="2207724">t</span><span class="op" id="2207725">)</span><span class="op" id="2207726">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2207729">return</span>&nbsp;<span class="builtinfunc" id="2207736">len</span><span class="op" id="2207739">(</span><span class="ident" id="2207740">tt</span><span class="op" id="2207742">.</span><span class="ident" id="2207743">fields</span><span class="op" id="2207749">)</span><br>
<span class="lineno"></span><span class="op" id="2207751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2207754">func</span>&nbsp;<span class="op" id="2207759">(</span><span class="ident" id="2207760">t</span>&nbsp;<span class="op" id="2207762">*</span><span class="ident" id="2207763">rtype</span><span class="op" id="2207768">)</span>&nbsp;<span class="ident" id="2207770">NumIn</span><span class="op" id="2207775">(</span><span class="op" id="2207776">)</span>&nbsp;<span class="builtintype" id="2207778">int</span>&nbsp;<span class="op" id="2207782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2207785">if</span>&nbsp;<span class="ident" id="2207788">t</span><span class="op" id="2207789">.</span><span class="ident" id="2207790">Kind</span><span class="op" id="2207794">(</span><span class="op" id="2207795">)</span>&nbsp;<span class="op" id="2207797">!=</span>&nbsp;<span class="ident" id="2207800">Func</span>&nbsp;<span class="op" id="2207805">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2207809">panic</span><span class="op" id="2207814">(</span><span class="string" id="2207815">&#34;reflect:&nbsp;NumIn&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2207848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2207851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2207854">tt</span>&nbsp;<span class="op" id="2207857">:=</span>&nbsp;<span class="op" id="2207860">(</span><span class="op" id="2207861">*</span><span class="ident" id="2207862">funcType</span><span class="op" id="2207870">)</span><span class="op" id="2207871">(</span><span class="ident" id="2207872">unsafe</span><span class="op" id="2207878">.</span><span class="ident" id="2207879">Pointer</span><span class="op" id="2207886">(</span><span class="ident" id="2207887">t</span><span class="op" id="2207888">)</span><span class="op" id="2207889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2207892">return</span>&nbsp;<span class="builtinfunc" id="2207899">len</span><span class="op" id="2207902">(</span><span class="ident" id="2207903">tt</span><span class="op" id="2207905">.</span><span class="ident" id="2207906">in</span><span class="op" id="2207908">)</span><br>
<span class="lineno"></span><span class="op" id="2207910">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="2207913">func</span>&nbsp;<span class="op" id="2207918">(</span><span class="ident" id="2207919">t</span>&nbsp;<span class="op" id="2207921">*</span><span class="ident" id="2207922">rtype</span><span class="op" id="2207927">)</span>&nbsp;<span class="ident" id="2207929">NumOut</span><span class="op" id="2207935">(</span><span class="op" id="2207936">)</span>&nbsp;<span class="builtintype" id="2207938">int</span>&nbsp;<span class="op" id="2207942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2207945">if</span>&nbsp;<span class="ident" id="2207948">t</span><span class="op" id="2207949">.</span><span class="ident" id="2207950">Kind</span><span class="op" id="2207954">(</span><span class="op" id="2207955">)</span>&nbsp;<span class="op" id="2207957">!=</span>&nbsp;<span class="ident" id="2207960">Func</span>&nbsp;<span class="op" id="2207965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2207969">panic</span><span class="op" id="2207974">(</span><span class="string" id="2207975">&#34;reflect:&nbsp;NumOut&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2208009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2208012">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2208015">tt</span>&nbsp;<span class="op" id="2208018">:=</span>&nbsp;<span class="op" id="2208021">(</span><span class="op" id="2208022">*</span><span class="ident" id="2208023">funcType</span><span class="op" id="2208031">)</span><span class="op" id="2208032">(</span><span class="ident" id="2208033">unsafe</span><span class="op" id="2208039">.</span><span class="ident" id="2208040">Pointer</span><span class="op" id="2208047">(</span><span class="ident" id="2208048">t</span><span class="op" id="2208049">)</span><span class="op" id="2208050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208053">return</span>&nbsp;<span class="builtinfunc" id="2208060">len</span><span class="op" id="2208063">(</span><span class="ident" id="2208064">tt</span><span class="op" id="2208066">.</span><span class="ident" id="2208067">out</span><span class="op" id="2208070">)</span><br>
<span class="lineno"></span><span class="op" id="2208072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2208075">func</span>&nbsp;<span class="op" id="2208080">(</span><span class="ident" id="2208081">t</span>&nbsp;<span class="op" id="2208083">*</span><span class="ident" id="2208084">rtype</span><span class="op" id="2208089">)</span>&nbsp;<span class="ident" id="2208091">Out</span><span class="op" id="2208094">(</span><span class="ident" id="2208095">i</span>&nbsp;<span class="builtintype" id="2208097">int</span><span class="op" id="2208100">)</span>&nbsp;<span class="ident" id="2208102">Type</span>&nbsp;<span class="op" id="2208107">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208110">if</span>&nbsp;<span class="ident" id="2208113">t</span><span class="op" id="2208114">.</span><span class="ident" id="2208115">Kind</span><span class="op" id="2208119">(</span><span class="op" id="2208120">)</span>&nbsp;<span class="op" id="2208122">!=</span>&nbsp;<span class="ident" id="2208125">Func</span>&nbsp;<span class="op" id="2208130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2208134">panic</span><span class="op" id="2208139">(</span><span class="string" id="2208140">&#34;reflect:&nbsp;Out&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2208171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2208174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2208177">tt</span>&nbsp;<span class="op" id="2208180">:=</span>&nbsp;<span class="op" id="2208183">(</span><span class="op" id="2208184">*</span><span class="ident" id="2208185">funcType</span><span class="op" id="2208193">)</span><span class="op" id="2208194">(</span><span class="ident" id="2208195">unsafe</span><span class="op" id="2208201">.</span><span class="ident" id="2208202">Pointer</span><span class="op" id="2208209">(</span><span class="ident" id="2208210">t</span><span class="op" id="2208211">)</span><span class="op" id="2208212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208215">return</span>&nbsp;<span class="ident" id="2208222">toType</span><span class="op" id="2208228">(</span><span class="ident" id="2208229">tt</span><span class="op" id="2208231">.</span><span class="ident" id="2208232">out</span><span class="op" id="2208235">[</span><span class="ident" id="2208236">i</span><span class="op" id="2208237">]</span><span class="op" id="2208238">)</span><br>
<span class="lineno">685</span><span class="op" id="2208240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2208243">func</span>&nbsp;<span class="op" id="2208248">(</span><span class="ident" id="2208249">d</span>&nbsp;<span class="ident" id="2208251">ChanDir</span><span class="op" id="2208258">)</span>&nbsp;<span class="ident" id="2208260">String</span><span class="op" id="2208266">(</span><span class="op" id="2208267">)</span>&nbsp;<span class="builtintype" id="2208269">string</span>&nbsp;<span class="op" id="2208276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208279">switch</span>&nbsp;<span class="ident" id="2208286">d</span>&nbsp;<span class="op" id="2208288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208291">case</span>&nbsp;<span class="ident" id="2208296">SendDir</span><span class="op" id="2208303">:</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208307">return</span>&nbsp;<span class="string" id="2208314">&#34;chan&lt;-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208324">case</span>&nbsp;<span class="ident" id="2208329">RecvDir</span><span class="op" id="2208336">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208340">return</span>&nbsp;<span class="string" id="2208347">&#34;&lt;-chan&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208357">case</span>&nbsp;<span class="ident" id="2208362">BothDir</span><span class="op" id="2208369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208373">return</span>&nbsp;<span class="string" id="2208380">&#34;chan&#34;</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2208388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208391">return</span>&nbsp;<span class="string" id="2208398">&#34;ChanDir&#34;</span>&nbsp;<span class="op" id="2208408">+</span>&nbsp;<span class="ident" id="2208410">strconv</span><span class="op" id="2208417">.</span><span class="ident" id="2208418">Itoa</span><span class="op" id="2208422">(</span><span class="builtintype" id="2208423">int</span><span class="op" id="2208426">(</span><span class="ident" id="2208427">d</span><span class="op" id="2208428">)</span><span class="op" id="2208429">)</span><br>
<span class="lineno"></span><span class="op" id="2208431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2208434">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">700</span><span class="keyword" id="2208494">func</span>&nbsp;<span class="op" id="2208499">(</span><span class="ident" id="2208500">t</span>&nbsp;<span class="op" id="2208502">*</span><span class="ident" id="2208503">interfaceType</span><span class="op" id="2208516">)</span>&nbsp;<span class="ident" id="2208518">Method</span><span class="op" id="2208524">(</span><span class="ident" id="2208525">i</span>&nbsp;<span class="builtintype" id="2208527">int</span><span class="op" id="2208530">)</span>&nbsp;<span class="op" id="2208532">(</span><span class="ident" id="2208533">m</span>&nbsp;<span class="ident" id="2208535">Method</span><span class="op" id="2208541">)</span>&nbsp;<span class="op" id="2208543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208546">if</span>&nbsp;<span class="ident" id="2208549">i</span>&nbsp;<span class="op" id="2208551">&lt;</span>&nbsp;<span class="num" id="2208553">0</span>&nbsp;<span class="op" id="2208555">||</span>&nbsp;<span class="ident" id="2208558">i</span>&nbsp;<span class="op" id="2208560">&gt;=</span>&nbsp;<span class="builtinfunc" id="2208563">len</span><span class="op" id="2208566">(</span><span class="ident" id="2208567">t</span><span class="op" id="2208568">.</span><span class="ident" id="2208569">methods</span><span class="op" id="2208576">)</span>&nbsp;<span class="op" id="2208578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208582">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2208590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2208593">p</span>&nbsp;<span class="op" id="2208595">:=</span>&nbsp;<span class="op" id="2208598">&amp;</span><span class="ident" id="2208599">t</span><span class="op" id="2208600">.</span><span class="ident" id="2208601">methods</span><span class="op" id="2208608">[</span><span class="ident" id="2208609">i</span><span class="op" id="2208610">]</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2208613">m</span><span class="op" id="2208614">.</span><span class="ident" id="2208615">Name</span>&nbsp;<span class="op" id="2208620">=</span>&nbsp;<span class="op" id="2208622">*</span><span class="ident" id="2208623">p</span><span class="op" id="2208624">.</span><span class="ident" id="2208625">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208631">if</span>&nbsp;<span class="ident" id="2208634">p</span><span class="op" id="2208635">.</span><span class="ident" id="2208636">pkgPath</span>&nbsp;<span class="op" id="2208644">!=</span>&nbsp;<span class="ident" id="2208647">nil</span>&nbsp;<span class="op" id="2208651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2208655">m</span><span class="op" id="2208656">.</span><span class="ident" id="2208657">PkgPath</span>&nbsp;<span class="op" id="2208665">=</span>&nbsp;<span class="op" id="2208667">*</span><span class="ident" id="2208668">p</span><span class="op" id="2208669">.</span><span class="ident" id="2208670">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2208679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2208682">m</span><span class="op" id="2208683">.</span><span class="ident" id="2208684">Type</span>&nbsp;<span class="op" id="2208689">=</span>&nbsp;<span class="ident" id="2208691">toType</span><span class="op" id="2208697">(</span><span class="ident" id="2208698">p</span><span class="op" id="2208699">.</span><span class="ident" id="2208700">typ</span><span class="op" id="2208703">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2208706">m</span><span class="op" id="2208707">.</span><span class="ident" id="2208708">Index</span>&nbsp;<span class="op" id="2208714">=</span>&nbsp;<span class="ident" id="2208716">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2208719">return</span><br>
<span class="lineno"></span><span class="op" id="2208726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2208729">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;interface&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">715</span><span class="keyword" id="2208808">func</span>&nbsp;<span class="op" id="2208813">(</span><span class="ident" id="2208814">t</span>&nbsp;<span class="op" id="2208816">*</span><span class="ident" id="2208817">interfaceType</span><span class="op" id="2208830">)</span>&nbsp;<span class="ident" id="2208832">NumMethod</span><span class="op" id="2208841">(</span><span class="op" id="2208842">)</span>&nbsp;<span class="builtintype" id="2208844">int</span>&nbsp;<span class="op" id="2208848">{</span>&nbsp;<span class="keyword" id="2208850">return</span>&nbsp;<span class="builtinfunc" id="2208857">len</span><span class="op" id="2208860">(</span><span class="ident" id="2208861">t</span><span class="op" id="2208862">.</span><span class="ident" id="2208863">methods</span><span class="op" id="2208870">)</span>&nbsp;<span class="op" id="2208872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2208875">//&nbsp;MethodByName&nbsp;method&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="2208944">func</span>&nbsp;<span class="op" id="2208949">(</span><span class="ident" id="2208950">t</span>&nbsp;<span class="op" id="2208952">*</span><span class="ident" id="2208953">interfaceType</span><span class="op" id="2208966">)</span>&nbsp;<span class="ident" id="2208968">MethodByName</span><span class="op" id="2208980">(</span><span class="ident" id="2208981">name</span>&nbsp;<span class="builtintype" id="2208986">string</span><span class="op" id="2208992">)</span>&nbsp;<span class="op" id="2208994">(</span><span class="ident" id="2208995">m</span>&nbsp;<span class="ident" id="2208997">Method</span><span class="op" id="2209003">,</span>&nbsp;<span class="ident" id="2209005">ok</span>&nbsp;<span class="builtintype" id="2209008">bool</span><span class="op" id="2209012">)</span>&nbsp;<span class="op" id="2209014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2209017">if</span>&nbsp;<span class="ident" id="2209020">t</span>&nbsp;<span class="op" id="2209022">==</span>&nbsp;<span class="ident" id="2209025">nil</span>&nbsp;<span class="op" id="2209029">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2209033">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2209041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2209044">var</span>&nbsp;<span class="ident" id="2209048">p</span>&nbsp;<span class="op" id="2209050">*</span><span class="ident" id="2209051">imethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2209060">for</span>&nbsp;<span class="ident" id="2209064">i</span>&nbsp;<span class="op" id="2209066">:=</span>&nbsp;<span class="keyword" id="2209069">range</span>&nbsp;<span class="ident" id="2209075">t</span><span class="op" id="2209076">.</span><span class="ident" id="2209077">methods</span>&nbsp;<span class="op" id="2209085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2209089">p</span>&nbsp;<span class="op" id="2209091">=</span>&nbsp;<span class="op" id="2209093">&amp;</span><span class="ident" id="2209094">t</span><span class="op" id="2209095">.</span><span class="ident" id="2209096">methods</span><span class="op" id="2209103">[</span><span class="ident" id="2209104">i</span><span class="op" id="2209105">]</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2209109">if</span>&nbsp;<span class="op" id="2209112">*</span><span class="ident" id="2209113">p</span><span class="op" id="2209114">.</span><span class="ident" id="2209115">name</span>&nbsp;<span class="op" id="2209120">==</span>&nbsp;<span class="ident" id="2209123">name</span>&nbsp;<span class="op" id="2209128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2209133">return</span>&nbsp;<span class="ident" id="2209140">t</span><span class="op" id="2209141">.</span><span class="ident" id="2209142">Method</span><span class="op" id="2209148">(</span><span class="ident" id="2209149">i</span><span class="op" id="2209150">)</span><span class="op" id="2209151">,</span>&nbsp;<span class="builtintype" id="2209153">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2209160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2209163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2209166">return</span><br>
<span class="lineno">730</span><span class="op" id="2209173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2209176">//&nbsp;A&nbsp;StructField&nbsp;describes&nbsp;a&nbsp;single&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="2209231">type</span>&nbsp;<span class="ident" id="2209236">StructField</span>&nbsp;<span class="keyword" id="2209248">struct</span>&nbsp;<span class="op" id="2209255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2209258">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2209286">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2209359">//&nbsp;field&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2209427">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2209488">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2209496">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2209504">PkgPath</span>&nbsp;<span class="builtintype" id="2209512">string</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2209521">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2209531">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2209541">//&nbsp;field&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2209556">Tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2209566">StructTag</span>&nbsp;<span class="comment" id="2209576">//&nbsp;field&nbsp;tag&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2209597">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2209607">uintptr</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2209617">//&nbsp;offset&nbsp;within&nbsp;struct,&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2209652">Index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2209662">[</span><span class="op" id="2209663">]</span><span class="builtintype" id="2209664">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2209672">//&nbsp;index&nbsp;sequence&nbsp;for&nbsp;Type.FieldByIndex</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2209713">Anonymous</span>&nbsp;<span class="builtintype" id="2209723">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2209733">//&nbsp;is&nbsp;an&nbsp;embedded&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="2209757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2209760">//&nbsp;A&nbsp;StructTag&nbsp;is&nbsp;the&nbsp;tag&nbsp;string&nbsp;in&nbsp;a&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="2209812">//</span><br>
<span class="lineno">750</span><span class="comment" id="2209815">//&nbsp;By&nbsp;convention,&nbsp;tag&nbsp;strings&nbsp;are&nbsp;a&nbsp;concatenation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2209868">//&nbsp;optionally&nbsp;space-separated&nbsp;key:&#34;value&#34;&nbsp;pairs.</span><br>
<span class="lineno"></span><span class="comment" id="2209917">//&nbsp;Each&nbsp;key&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of&nbsp;non-control</span><br>
<span class="lineno"></span><span class="comment" id="2209977">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;space&nbsp;(U+0020&nbsp;&#39;&nbsp;&#39;),&nbsp;quote&nbsp;(U+0022&nbsp;&#39;&#34;&#39;),</span><br>
<span class="lineno"></span><span class="comment" id="2210042">//&nbsp;and&nbsp;colon&nbsp;(U+003A&nbsp;&#39;:&#39;).&nbsp;&nbsp;Each&nbsp;value&nbsp;is&nbsp;quoted&nbsp;using&nbsp;U+0022&nbsp;&#39;&#34;&#39;</span><br>
<span class="lineno">755</span><span class="comment" id="2210108">//&nbsp;characters&nbsp;and&nbsp;Go&nbsp;string&nbsp;literal&nbsp;syntax.</span><br>
<span class="lineno"></span><span class="keyword" id="2210152">type</span>&nbsp;<span class="ident" id="2210157">StructTag</span>&nbsp;<span class="builtintype" id="2210167">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2210175">//&nbsp;Get&nbsp;returns&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;key&nbsp;in&nbsp;the&nbsp;tag&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2210239">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;key&nbsp;in&nbsp;the&nbsp;tag,&nbsp;Get&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno">760</span><span class="comment" id="2210308">//&nbsp;If&nbsp;the&nbsp;tag&nbsp;does&nbsp;not&nbsp;have&nbsp;the&nbsp;conventional&nbsp;format,&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2210371">//&nbsp;returned&nbsp;by&nbsp;Get&nbsp;is&nbsp;unspecified.</span><br>
<span class="lineno"></span><span class="keyword" id="2210406">func</span>&nbsp;<span class="op" id="2210411">(</span><span class="ident" id="2210412">tag</span>&nbsp;<span class="ident" id="2210416">StructTag</span><span class="op" id="2210425">)</span>&nbsp;<span class="ident" id="2210427">Get</span><span class="op" id="2210430">(</span><span class="ident" id="2210431">key</span>&nbsp;<span class="builtintype" id="2210435">string</span><span class="op" id="2210441">)</span>&nbsp;<span class="builtintype" id="2210443">string</span>&nbsp;<span class="op" id="2210450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2210453">for</span>&nbsp;<span class="ident" id="2210457">tag</span>&nbsp;<span class="op" id="2210461">!=</span>&nbsp;<span class="string" id="2210464">&#34;&#34;</span>&nbsp;<span class="op" id="2210467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2210471">//&nbsp;skip&nbsp;leading&nbsp;space</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2210495">i</span>&nbsp;<span class="op" id="2210497">:=</span>&nbsp;<span class="num" id="2210500">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2210504">for</span>&nbsp;<span class="ident" id="2210508">i</span>&nbsp;<span class="op" id="2210510">&lt;</span>&nbsp;<span class="builtinfunc" id="2210512">len</span><span class="op" id="2210515">(</span><span class="ident" id="2210516">tag</span><span class="op" id="2210519">)</span>&nbsp;<span class="op" id="2210521">&amp;&amp;</span>&nbsp;<span class="ident" id="2210524">tag</span><span class="op" id="2210527">[</span><span class="ident" id="2210528">i</span><span class="op" id="2210529">]</span>&nbsp;<span class="op" id="2210531">==</span>&nbsp;<span class="string" id="2210534">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2210538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2210543">i</span><span class="op" id="2210544">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2210549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2210553">tag</span>&nbsp;<span class="op" id="2210557">=</span>&nbsp;<span class="ident" id="2210559">tag</span><span class="op" id="2210562">[</span><span class="ident" id="2210563">i</span><span class="op" id="2210564">:</span><span class="op" id="2210565">]</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2210569">if</span>&nbsp;<span class="ident" id="2210572">tag</span>&nbsp;<span class="op" id="2210576">==</span>&nbsp;<span class="string" id="2210579">&#34;&#34;</span>&nbsp;<span class="op" id="2210582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2210587">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2210595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2210600">//&nbsp;scan&nbsp;to&nbsp;colon.</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2210620">//&nbsp;a&nbsp;space&nbsp;or&nbsp;a&nbsp;quote&nbsp;is&nbsp;a&nbsp;syntax&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2210662">i</span>&nbsp;<span class="op" id="2210664">=</span>&nbsp;<span class="num" id="2210666">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2210670">for</span>&nbsp;<span class="ident" id="2210674">i</span>&nbsp;<span class="op" id="2210676">&lt;</span>&nbsp;<span class="builtinfunc" id="2210678">len</span><span class="op" id="2210681">(</span><span class="ident" id="2210682">tag</span><span class="op" id="2210685">)</span>&nbsp;<span class="op" id="2210687">&amp;&amp;</span>&nbsp;<span class="ident" id="2210690">tag</span><span class="op" id="2210693">[</span><span class="ident" id="2210694">i</span><span class="op" id="2210695">]</span>&nbsp;<span class="op" id="2210697">!=</span>&nbsp;<span class="string" id="2210700">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2210704">&amp;&amp;</span>&nbsp;<span class="ident" id="2210707">tag</span><span class="op" id="2210710">[</span><span class="ident" id="2210711">i</span><span class="op" id="2210712">]</span>&nbsp;<span class="op" id="2210714">!=</span>&nbsp;<span class="string" id="2210717">&#39;:&#39;</span>&nbsp;<span class="op" id="2210721">&amp;&amp;</span>&nbsp;<span class="ident" id="2210724">tag</span><span class="op" id="2210727">[</span><span class="ident" id="2210728">i</span><span class="op" id="2210729">]</span>&nbsp;<span class="op" id="2210731">!=</span>&nbsp;<span class="string" id="2210734">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2210738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2210743">i</span><span class="op" id="2210744">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2210749">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2210753">if</span>&nbsp;<span class="ident" id="2210756">i</span><span class="op" id="2210757">+</span><span class="num" id="2210758">1</span>&nbsp;<span class="op" id="2210760">&gt;=</span>&nbsp;<span class="builtinfunc" id="2210763">len</span><span class="op" id="2210766">(</span><span class="ident" id="2210767">tag</span><span class="op" id="2210770">)</span>&nbsp;<span class="op" id="2210772">||</span>&nbsp;<span class="ident" id="2210775">tag</span><span class="op" id="2210778">[</span><span class="ident" id="2210779">i</span><span class="op" id="2210780">]</span>&nbsp;<span class="op" id="2210782">!=</span>&nbsp;<span class="string" id="2210785">&#39;:&#39;</span>&nbsp;<span class="op" id="2210789">||</span>&nbsp;<span class="ident" id="2210792">tag</span><span class="op" id="2210795">[</span><span class="ident" id="2210796">i</span><span class="op" id="2210797">+</span><span class="num" id="2210798">1</span><span class="op" id="2210799">]</span>&nbsp;<span class="op" id="2210801">!=</span>&nbsp;<span class="string" id="2210804">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2210808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2210813">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2210821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2210825">name</span>&nbsp;<span class="op" id="2210830">:=</span>&nbsp;<span class="builtintype" id="2210833">string</span><span class="op" id="2210839">(</span><span class="ident" id="2210840">tag</span><span class="op" id="2210843">[</span><span class="op" id="2210844">:</span><span class="ident" id="2210845">i</span><span class="op" id="2210846">]</span><span class="op" id="2210847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2210851">tag</span>&nbsp;<span class="op" id="2210855">=</span>&nbsp;<span class="ident" id="2210857">tag</span><span class="op" id="2210860">[</span><span class="ident" id="2210861">i</span><span class="op" id="2210862">+</span><span class="num" id="2210863">1</span><span class="op" id="2210864">:</span><span class="op" id="2210865">]</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2210870">//&nbsp;scan&nbsp;quoted&nbsp;string&nbsp;to&nbsp;find&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2210908">i</span>&nbsp;<span class="op" id="2210910">=</span>&nbsp;<span class="num" id="2210912">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2210916">for</span>&nbsp;<span class="ident" id="2210920">i</span>&nbsp;<span class="op" id="2210922">&lt;</span>&nbsp;<span class="builtinfunc" id="2210924">len</span><span class="op" id="2210927">(</span><span class="ident" id="2210928">tag</span><span class="op" id="2210931">)</span>&nbsp;<span class="op" id="2210933">&amp;&amp;</span>&nbsp;<span class="ident" id="2210936">tag</span><span class="op" id="2210939">[</span><span class="ident" id="2210940">i</span><span class="op" id="2210941">]</span>&nbsp;<span class="op" id="2210943">!=</span>&nbsp;<span class="string" id="2210946">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2210950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2210955">if</span>&nbsp;<span class="ident" id="2210958">tag</span><span class="op" id="2210961">[</span><span class="ident" id="2210962">i</span><span class="op" id="2210963">]</span>&nbsp;<span class="op" id="2210965">==</span>&nbsp;<span class="string" id="2210968">&#39;\\&#39;</span>&nbsp;<span class="op" id="2210973">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2210979">i</span><span class="op" id="2210980">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2210986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2210991">i</span><span class="op" id="2210992">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2210997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2211001">if</span>&nbsp;<span class="ident" id="2211004">i</span>&nbsp;<span class="op" id="2211006">&gt;=</span>&nbsp;<span class="builtinfunc" id="2211009">len</span><span class="op" id="2211012">(</span><span class="ident" id="2211013">tag</span><span class="op" id="2211016">)</span>&nbsp;<span class="op" id="2211018">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2211023">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2211031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2211035">qvalue</span>&nbsp;<span class="op" id="2211042">:=</span>&nbsp;<span class="builtintype" id="2211045">string</span><span class="op" id="2211051">(</span><span class="ident" id="2211052">tag</span><span class="op" id="2211055">[</span><span class="op" id="2211056">:</span><span class="ident" id="2211057">i</span><span class="op" id="2211058">+</span><span class="num" id="2211059">1</span><span class="op" id="2211060">]</span><span class="op" id="2211061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2211065">tag</span>&nbsp;<span class="op" id="2211069">=</span>&nbsp;<span class="ident" id="2211071">tag</span><span class="op" id="2211074">[</span><span class="ident" id="2211075">i</span><span class="op" id="2211076">+</span><span class="num" id="2211077">1</span><span class="op" id="2211078">:</span><span class="op" id="2211079">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2211084">if</span>&nbsp;<span class="ident" id="2211087">key</span>&nbsp;<span class="op" id="2211091">==</span>&nbsp;<span class="ident" id="2211094">name</span>&nbsp;<span class="op" id="2211099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2211104">value</span><span class="op" id="2211109">,</span>&nbsp;<span class="ident" id="2211111">_</span>&nbsp;<span class="op" id="2211113">:=</span>&nbsp;<span class="ident" id="2211116">strconv</span><span class="op" id="2211123">.</span><span class="ident" id="2211124">Unquote</span><span class="op" id="2211131">(</span><span class="ident" id="2211132">qvalue</span><span class="op" id="2211138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2211143">return</span>&nbsp;<span class="ident" id="2211150">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2211158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2211161">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2211164">return</span>&nbsp;<span class="string" id="2211171">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2211174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2211177">//&nbsp;Field&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="2211217">func</span>&nbsp;<span class="op" id="2211222">(</span><span class="ident" id="2211223">t</span>&nbsp;<span class="op" id="2211225">*</span><span class="ident" id="2211226">structType</span><span class="op" id="2211236">)</span>&nbsp;<span class="ident" id="2211238">Field</span><span class="op" id="2211243">(</span><span class="ident" id="2211244">i</span>&nbsp;<span class="builtintype" id="2211246">int</span><span class="op" id="2211249">)</span>&nbsp;<span class="op" id="2211251">(</span><span class="ident" id="2211252">f</span>&nbsp;<span class="ident" id="2211254">StructField</span><span class="op" id="2211265">)</span>&nbsp;<span class="op" id="2211267">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2211270">if</span>&nbsp;<span class="ident" id="2211273">i</span>&nbsp;<span class="op" id="2211275">&lt;</span>&nbsp;<span class="num" id="2211277">0</span>&nbsp;<span class="op" id="2211279">||</span>&nbsp;<span class="ident" id="2211282">i</span>&nbsp;<span class="op" id="2211284">&gt;=</span>&nbsp;<span class="builtinfunc" id="2211287">len</span><span class="op" id="2211290">(</span><span class="ident" id="2211291">t</span><span class="op" id="2211292">.</span><span class="ident" id="2211293">fields</span><span class="op" id="2211299">)</span>&nbsp;<span class="op" id="2211301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2211305">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2211313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2211316">p</span>&nbsp;<span class="op" id="2211318">:=</span>&nbsp;<span class="op" id="2211321">&amp;</span><span class="ident" id="2211322">t</span><span class="op" id="2211323">.</span><span class="ident" id="2211324">fields</span><span class="op" id="2211330">[</span><span class="ident" id="2211331">i</span><span class="op" id="2211332">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2211335">f</span><span class="op" id="2211336">.</span><span class="ident" id="2211337">Type</span>&nbsp;<span class="op" id="2211342">=</span>&nbsp;<span class="ident" id="2211344">toType</span><span class="op" id="2211350">(</span><span class="ident" id="2211351">p</span><span class="op" id="2211352">.</span><span class="ident" id="2211353">typ</span><span class="op" id="2211356">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2211359">if</span>&nbsp;<span class="ident" id="2211362">p</span><span class="op" id="2211363">.</span><span class="ident" id="2211364">name</span>&nbsp;<span class="op" id="2211369">!=</span>&nbsp;<span class="ident" id="2211372">nil</span>&nbsp;<span class="op" id="2211376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2211380">f</span><span class="op" id="2211381">.</span><span class="ident" id="2211382">Name</span>&nbsp;<span class="op" id="2211387">=</span>&nbsp;<span class="op" id="2211389">*</span><span class="ident" id="2211390">p</span><span class="op" id="2211391">.</span><span class="ident" id="2211392">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2211398">}</span>&nbsp;<span class="keyword" id="2211400">else</span>&nbsp;<span class="op" id="2211405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2211409">t</span>&nbsp;<span class="op" id="2211411">:=</span>&nbsp;<span class="ident" id="2211414">f</span><span class="op" id="2211415">.</span><span class="ident" id="2211416">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2211423">if</span>&nbsp;<span class="ident" id="2211426">t</span><span class="op" id="2211427">.</span><span class="ident" id="2211428">Kind</span><span class="op" id="2211432">(</span><span class="op" id="2211433">)</span>&nbsp;<span class="op" id="2211435">==</span>&nbsp;<span class="ident" id="2211438">Ptr</span>&nbsp;<span class="op" id="2211442">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2211447">t</span>&nbsp;<span class="op" id="2211449">=</span>&nbsp;<span class="ident" id="2211451">t</span><span class="op" id="2211452">.</span><span class="ident" id="2211453">Elem</span><span class="op" id="2211457">(</span><span class="op" id="2211458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2211462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2211466">f</span><span class="op" id="2211467">.</span><span class="ident" id="2211468">Name</span>&nbsp;<span class="op" id="2211473">=</span>&nbsp;<span class="ident" id="2211475">t</span><span class="op" id="2211476">.</span><span class="ident" id="2211477">Name</span><span class="op" id="2211481">(</span><span class="op" id="2211482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2211486">f</span><span class="op" id="2211487">.</span><span class="ident" id="2211488">Anonymous</span>&nbsp;<span class="op" id="2211498">=</span>&nbsp;<span class="builtintype" id="2211500">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2211506">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2211509">if</span>&nbsp;<span class="ident" id="2211512">p</span><span class="op" id="2211513">.</span><span class="ident" id="2211514">pkgPath</span>&nbsp;<span class="op" id="2211522">!=</span>&nbsp;<span class="ident" id="2211525">nil</span>&nbsp;<span class="op" id="2211529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2211533">f</span><span class="op" id="2211534">.</span><span class="ident" id="2211535">PkgPath</span>&nbsp;<span class="op" id="2211543">=</span>&nbsp;<span class="op" id="2211545">*</span><span class="ident" id="2211546">p</span><span class="op" id="2211547">.</span><span class="ident" id="2211548">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2211557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2211560">if</span>&nbsp;<span class="ident" id="2211563">p</span><span class="op" id="2211564">.</span><span class="ident" id="2211565">tag</span>&nbsp;<span class="op" id="2211569">!=</span>&nbsp;<span class="ident" id="2211572">nil</span>&nbsp;<span class="op" id="2211576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2211580">f</span><span class="op" id="2211581">.</span><span class="ident" id="2211582">Tag</span>&nbsp;<span class="op" id="2211586">=</span>&nbsp;<span class="ident" id="2211588">StructTag</span><span class="op" id="2211597">(</span><span class="op" id="2211598">*</span><span class="ident" id="2211599">p</span><span class="op" id="2211600">.</span><span class="ident" id="2211601">tag</span><span class="op" id="2211604">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2211607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2211610">f</span><span class="op" id="2211611">.</span><span class="ident" id="2211612">Offset</span>&nbsp;<span class="op" id="2211619">=</span>&nbsp;<span class="ident" id="2211621">p</span><span class="op" id="2211622">.</span><span class="ident" id="2211623">offset</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2211632">//&nbsp;NOTE(rsc):&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;allocation&nbsp;in&nbsp;the&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2211692">//&nbsp;presented&nbsp;by&nbsp;a&nbsp;reflect.Type.&nbsp;&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;avoid,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2211753">//&nbsp;at&nbsp;least&nbsp;in&nbsp;the&nbsp;common&nbsp;cases,&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2211812">//&nbsp;that&nbsp;misbehaving&nbsp;clients&nbsp;of&nbsp;reflect&nbsp;cannot&nbsp;affect&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2211872">//&nbsp;uses&nbsp;of&nbsp;reflect.&nbsp;&nbsp;One&nbsp;possibility&nbsp;is&nbsp;CL&nbsp;5371098,&nbsp;but&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2211932">//&nbsp;postponed&nbsp;that&nbsp;ugliness&nbsp;until&nbsp;there&nbsp;is&nbsp;a&nbsp;demonstrated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2211990">//&nbsp;need&nbsp;for&nbsp;the&nbsp;performance.&nbsp;&nbsp;This&nbsp;is&nbsp;issue&nbsp;2320.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2212041">f</span><span class="op" id="2212042">.</span><span class="ident" id="2212043">Index</span>&nbsp;<span class="op" id="2212049">=</span>&nbsp;<span class="op" id="2212051">[</span><span class="op" id="2212052">]</span><span class="builtintype" id="2212053">int</span><span class="op" id="2212056">{</span><span class="ident" id="2212057">i</span><span class="op" id="2212058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2212061">return</span><br>
<span class="lineno"></span><span class="op" id="2212068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2212071">//&nbsp;TODO(gri):&nbsp;Should&nbsp;there&nbsp;be&nbsp;an&nbsp;error/bool&nbsp;indicator&nbsp;if&nbsp;the&nbsp;index</span><br>
<span class="lineno">845</span><span class="comment" id="2212138">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;wrong&nbsp;for&nbsp;FieldByIndex?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2212180">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="2212245">func</span>&nbsp;<span class="op" id="2212250">(</span><span class="ident" id="2212251">t</span>&nbsp;<span class="op" id="2212253">*</span><span class="ident" id="2212254">structType</span><span class="op" id="2212264">)</span>&nbsp;<span class="ident" id="2212266">FieldByIndex</span><span class="op" id="2212278">(</span><span class="ident" id="2212279">index</span>&nbsp;<span class="op" id="2212285">[</span><span class="op" id="2212286">]</span><span class="builtintype" id="2212287">int</span><span class="op" id="2212290">)</span>&nbsp;<span class="op" id="2212292">(</span><span class="ident" id="2212293">f</span>&nbsp;<span class="ident" id="2212295">StructField</span><span class="op" id="2212306">)</span>&nbsp;<span class="op" id="2212308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2212311">f</span><span class="op" id="2212312">.</span><span class="ident" id="2212313">Type</span>&nbsp;<span class="op" id="2212318">=</span>&nbsp;<span class="ident" id="2212320">toType</span><span class="op" id="2212326">(</span><span class="op" id="2212327">&amp;</span><span class="ident" id="2212328">t</span><span class="op" id="2212329">.</span><span class="ident" id="2212330">rtype</span><span class="op" id="2212335">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2212338">for</span>&nbsp;<span class="ident" id="2212342">i</span><span class="op" id="2212343">,</span>&nbsp;<span class="ident" id="2212345">x</span>&nbsp;<span class="op" id="2212347">:=</span>&nbsp;<span class="keyword" id="2212350">range</span>&nbsp;<span class="ident" id="2212356">index</span>&nbsp;<span class="op" id="2212362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2212366">if</span>&nbsp;<span class="ident" id="2212369">i</span>&nbsp;<span class="op" id="2212371">&gt;</span>&nbsp;<span class="num" id="2212373">0</span>&nbsp;<span class="op" id="2212375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2212380">ft</span>&nbsp;<span class="op" id="2212383">:=</span>&nbsp;<span class="ident" id="2212386">f</span><span class="op" id="2212387">.</span><span class="ident" id="2212388">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2212396">if</span>&nbsp;<span class="ident" id="2212399">ft</span><span class="op" id="2212401">.</span><span class="ident" id="2212402">Kind</span><span class="op" id="2212406">(</span><span class="op" id="2212407">)</span>&nbsp;<span class="op" id="2212409">==</span>&nbsp;<span class="ident" id="2212412">Ptr</span>&nbsp;<span class="op" id="2212416">&amp;&amp;</span>&nbsp;<span class="ident" id="2212419">ft</span><span class="op" id="2212421">.</span><span class="ident" id="2212422">Elem</span><span class="op" id="2212426">(</span><span class="op" id="2212427">)</span><span class="op" id="2212428">.</span><span class="ident" id="2212429">Kind</span><span class="op" id="2212433">(</span><span class="op" id="2212434">)</span>&nbsp;<span class="op" id="2212436">==</span>&nbsp;<span class="ident" id="2212439">Struct</span>&nbsp;<span class="op" id="2212446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2212452">ft</span>&nbsp;<span class="op" id="2212455">=</span>&nbsp;<span class="ident" id="2212457">ft</span><span class="op" id="2212459">.</span><span class="ident" id="2212460">Elem</span><span class="op" id="2212464">(</span><span class="op" id="2212465">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2212470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2212475">f</span><span class="op" id="2212476">.</span><span class="ident" id="2212477">Type</span>&nbsp;<span class="op" id="2212482">=</span>&nbsp;<span class="ident" id="2212484">ft</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2212489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2212493">f</span>&nbsp;<span class="op" id="2212495">=</span>&nbsp;<span class="ident" id="2212497">f</span><span class="op" id="2212498">.</span><span class="ident" id="2212499">Type</span><span class="op" id="2212503">.</span><span class="ident" id="2212504">Field</span><span class="op" id="2212509">(</span><span class="ident" id="2212510">x</span><span class="op" id="2212511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2212514">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2212517">return</span><br>
<span class="lineno"></span><span class="op" id="2212524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2212527">//&nbsp;A&nbsp;fieldScan&nbsp;represents&nbsp;an&nbsp;item&nbsp;on&nbsp;the&nbsp;fieldByNameFunc&nbsp;scan&nbsp;work&nbsp;list.</span><br>
<span class="lineno"></span><span class="keyword" id="2212600">type</span>&nbsp;<span class="ident" id="2212605">fieldScan</span>&nbsp;<span class="keyword" id="2212615">struct</span>&nbsp;<span class="op" id="2212622">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2212625">typ</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2212631">*</span><span class="ident" id="2212632">structType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2212644">index</span>&nbsp;<span class="op" id="2212650">[</span><span class="op" id="2212651">]</span><span class="builtintype" id="2212652">int</span><br>
<span class="lineno"></span><span class="op" id="2212656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2212659">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;that&nbsp;satisfies&nbsp;the</span><br>
<span class="lineno">870</span><span class="comment" id="2212734">//&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2212802">func</span>&nbsp;<span class="op" id="2212807">(</span><span class="ident" id="2212808">t</span>&nbsp;<span class="op" id="2212810">*</span><span class="ident" id="2212811">structType</span><span class="op" id="2212821">)</span>&nbsp;<span class="ident" id="2212823">FieldByNameFunc</span><span class="op" id="2212838">(</span><span class="ident" id="2212839">match</span>&nbsp;<span class="keyword" id="2212845">func</span><span class="op" id="2212849">(</span><span class="builtintype" id="2212850">string</span><span class="op" id="2212856">)</span>&nbsp;<span class="builtintype" id="2212858">bool</span><span class="op" id="2212862">)</span>&nbsp;<span class="op" id="2212864">(</span><span class="ident" id="2212865">result</span>&nbsp;<span class="ident" id="2212872">StructField</span><span class="op" id="2212883">,</span>&nbsp;<span class="ident" id="2212885">ok</span>&nbsp;<span class="builtintype" id="2212888">bool</span><span class="op" id="2212892">)</span>&nbsp;<span class="op" id="2212894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2212897">//&nbsp;This&nbsp;uses&nbsp;the&nbsp;same&nbsp;condition&nbsp;that&nbsp;the&nbsp;Go&nbsp;language&nbsp;does:&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;unique&nbsp;instance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2212989">//&nbsp;of&nbsp;the&nbsp;match&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;instances&nbsp;of&nbsp;a&nbsp;match&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213080">//&nbsp;same&nbsp;depth,&nbsp;they&nbsp;annihilate&nbsp;each&nbsp;other&nbsp;and&nbsp;inhibit&nbsp;any&nbsp;possible&nbsp;match&nbsp;at&nbsp;a&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213172">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth&nbsp;first&nbsp;search,&nbsp;one&nbsp;depth&nbsp;level&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213243">//&nbsp;The&nbsp;current&nbsp;and&nbsp;next&nbsp;slices&nbsp;are&nbsp;work&nbsp;queues:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213292">//&nbsp;current&nbsp;lists&nbsp;the&nbsp;fields&nbsp;to&nbsp;visit&nbsp;on&nbsp;this&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213351">//&nbsp;and&nbsp;next&nbsp;lists&nbsp;the&nbsp;fields&nbsp;on&nbsp;the&nbsp;next&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2213406">current</span>&nbsp;<span class="op" id="2213414">:=</span>&nbsp;<span class="op" id="2213417">[</span><span class="op" id="2213418">]</span><span class="ident" id="2213419">fieldScan</span><span class="op" id="2213428">{</span><span class="op" id="2213429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2213432">next</span>&nbsp;<span class="op" id="2213437">:=</span>&nbsp;<span class="op" id="2213440">[</span><span class="op" id="2213441">]</span><span class="ident" id="2213442">fieldScan</span><span class="op" id="2213451">{</span><span class="op" id="2213452">{</span><span class="ident" id="2213453">typ</span><span class="op" id="2213456">:</span>&nbsp;<span class="ident" id="2213458">t</span><span class="op" id="2213459">}</span><span class="op" id="2213460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213464">//&nbsp;nextCount&nbsp;records&nbsp;the&nbsp;number&nbsp;of&nbsp;times&nbsp;an&nbsp;embedded&nbsp;type&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213532">//&nbsp;encountered&nbsp;and&nbsp;considered&nbsp;for&nbsp;queueing&nbsp;in&nbsp;the&nbsp;&#39;next&#39;&nbsp;slice.</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213597">//&nbsp;We&nbsp;only&nbsp;queue&nbsp;the&nbsp;first&nbsp;one,&nbsp;but&nbsp;we&nbsp;increment&nbsp;the&nbsp;count&nbsp;on&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213666">//&nbsp;If&nbsp;a&nbsp;struct&nbsp;type&nbsp;T&nbsp;can&nbsp;be&nbsp;reached&nbsp;more&nbsp;than&nbsp;once&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213743">//&nbsp;then&nbsp;it&nbsp;annihilates&nbsp;itself&nbsp;and&nbsp;need&nbsp;not&nbsp;be&nbsp;considered&nbsp;at&nbsp;all&nbsp;when&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213816">//&nbsp;process&nbsp;that&nbsp;next&nbsp;depth&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2213851">var</span>&nbsp;<span class="ident" id="2213855">nextCount</span>&nbsp;<span class="keyword" id="2213865">map</span><span class="op" id="2213868">[</span><span class="op" id="2213869">*</span><span class="ident" id="2213870">structType</span><span class="op" id="2213880">]</span><span class="builtintype" id="2213881">int</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213887">//&nbsp;visited&nbsp;records&nbsp;the&nbsp;structs&nbsp;that&nbsp;have&nbsp;been&nbsp;considered&nbsp;already.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2213954">//&nbsp;Embedded&nbsp;pointer&nbsp;fields&nbsp;can&nbsp;create&nbsp;cycles&nbsp;in&nbsp;the&nbsp;graph&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2214016">//&nbsp;reachable&nbsp;embedded&nbsp;types;&nbsp;visited&nbsp;avoids&nbsp;following&nbsp;those&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2214085">//&nbsp;It&nbsp;also&nbsp;avoids&nbsp;duplicated&nbsp;effort:&nbsp;if&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;the&nbsp;field&nbsp;in&nbsp;an</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2214157">//&nbsp;embedded&nbsp;type&nbsp;T&nbsp;at&nbsp;level&nbsp;2,&nbsp;we&nbsp;won&#39;t&nbsp;find&nbsp;it&nbsp;in&nbsp;one&nbsp;at&nbsp;level&nbsp;4&nbsp;either.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2214232">visited</span>&nbsp;<span class="op" id="2214240">:=</span>&nbsp;<span class="keyword" id="2214243">map</span><span class="op" id="2214246">[</span><span class="op" id="2214247">*</span><span class="ident" id="2214248">structType</span><span class="op" id="2214258">]</span><span class="builtintype" id="2214259">bool</span><span class="op" id="2214263">{</span><span class="op" id="2214264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2214268">for</span>&nbsp;<span class="builtinfunc" id="2214272">len</span><span class="op" id="2214275">(</span><span class="ident" id="2214276">next</span><span class="op" id="2214280">)</span>&nbsp;<span class="op" id="2214282">&gt;</span>&nbsp;<span class="num" id="2214284">0</span>&nbsp;<span class="op" id="2214286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2214290">current</span><span class="op" id="2214297">,</span>&nbsp;<span class="ident" id="2214299">next</span>&nbsp;<span class="op" id="2214304">=</span>&nbsp;<span class="ident" id="2214306">next</span><span class="op" id="2214310">,</span>&nbsp;<span class="ident" id="2214312">current</span><span class="op" id="2214319">[</span><span class="op" id="2214320">:</span><span class="num" id="2214321">0</span><span class="op" id="2214322">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2214326">count</span>&nbsp;<span class="op" id="2214332">:=</span>&nbsp;<span class="ident" id="2214335">nextCount</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2214347">nextCount</span>&nbsp;<span class="op" id="2214357">=</span>&nbsp;<span class="ident" id="2214359">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2214366">//&nbsp;Process&nbsp;all&nbsp;the&nbsp;fields&nbsp;at&nbsp;this&nbsp;depth,&nbsp;now&nbsp;listed&nbsp;in&nbsp;&#39;current&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2214434">//&nbsp;The&nbsp;loop&nbsp;queues&nbsp;embedded&nbsp;fields&nbsp;found&nbsp;in&nbsp;&#39;next&#39;,&nbsp;for&nbsp;processing&nbsp;during&nbsp;the&nbsp;next</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2214519">//&nbsp;iteration.&nbsp;The&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;current&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2214594">//&nbsp;in&nbsp;&#39;count&#39;;&nbsp;the&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;next&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded&nbsp;in&nbsp;&#39;nextCount&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2214683">for</span>&nbsp;<span class="ident" id="2214687">_</span><span class="op" id="2214688">,</span>&nbsp;<span class="ident" id="2214690">scan</span>&nbsp;<span class="op" id="2214695">:=</span>&nbsp;<span class="keyword" id="2214698">range</span>&nbsp;<span class="ident" id="2214704">current</span>&nbsp;<span class="op" id="2214712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2214717">t</span>&nbsp;<span class="op" id="2214719">:=</span>&nbsp;<span class="ident" id="2214722">scan</span><span class="op" id="2214726">.</span><span class="ident" id="2214727">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2214734">if</span>&nbsp;<span class="ident" id="2214737">visited</span><span class="op" id="2214744">[</span><span class="ident" id="2214745">t</span><span class="op" id="2214746">]</span>&nbsp;<span class="op" id="2214748">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2214754">//&nbsp;We&#39;ve&nbsp;looked&nbsp;through&nbsp;this&nbsp;type&nbsp;before,&nbsp;at&nbsp;a&nbsp;higher&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2214819">//&nbsp;That&nbsp;higher&nbsp;level&nbsp;would&nbsp;shadow&nbsp;the&nbsp;lower&nbsp;level&nbsp;we&#39;re&nbsp;now&nbsp;at,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2214887">//&nbsp;so&nbsp;this&nbsp;one&nbsp;can&#39;t&nbsp;be&nbsp;useful&nbsp;to&nbsp;us.&nbsp;Ignore&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2214940">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2214952">}</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2214957">visited</span><span class="op" id="2214964">[</span><span class="ident" id="2214965">t</span><span class="op" id="2214966">]</span>&nbsp;<span class="op" id="2214968">=</span>&nbsp;<span class="builtintype" id="2214970">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2214978">for</span>&nbsp;<span class="ident" id="2214982">i</span>&nbsp;<span class="op" id="2214984">:=</span>&nbsp;<span class="keyword" id="2214987">range</span>&nbsp;<span class="ident" id="2214993">t</span><span class="op" id="2214994">.</span><span class="ident" id="2214995">fields</span>&nbsp;<span class="op" id="2215002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215008">f</span>&nbsp;<span class="op" id="2215010">:=</span>&nbsp;<span class="op" id="2215013">&amp;</span><span class="ident" id="2215014">t</span><span class="op" id="2215015">.</span><span class="ident" id="2215016">fields</span><span class="op" id="2215022">[</span><span class="ident" id="2215023">i</span><span class="op" id="2215024">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2215030">//&nbsp;Find&nbsp;name&nbsp;and&nbsp;type&nbsp;for&nbsp;field&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2215069">var</span>&nbsp;<span class="ident" id="2215073">fname</span>&nbsp;<span class="builtintype" id="2215079">string</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2215090">var</span>&nbsp;<span class="ident" id="2215094">ntyp</span>&nbsp;<span class="op" id="2215099">*</span><span class="ident" id="2215100">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2215110">if</span>&nbsp;<span class="ident" id="2215113">f</span><span class="op" id="2215114">.</span><span class="ident" id="2215115">name</span>&nbsp;<span class="op" id="2215120">!=</span>&nbsp;<span class="ident" id="2215123">nil</span>&nbsp;<span class="op" id="2215127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215134">fname</span>&nbsp;<span class="op" id="2215140">=</span>&nbsp;<span class="op" id="2215142">*</span><span class="ident" id="2215143">f</span><span class="op" id="2215144">.</span><span class="ident" id="2215145">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215154">}</span>&nbsp;<span class="keyword" id="2215156">else</span>&nbsp;<span class="op" id="2215161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2215168">//&nbsp;Anonymous&nbsp;field&nbsp;of&nbsp;type&nbsp;T&nbsp;or&nbsp;*T.</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2215209">//&nbsp;Name&nbsp;taken&nbsp;from&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215239">ntyp</span>&nbsp;<span class="op" id="2215244">=</span>&nbsp;<span class="ident" id="2215246">f</span><span class="op" id="2215247">.</span><span class="ident" id="2215248">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2215257">if</span>&nbsp;<span class="ident" id="2215260">ntyp</span><span class="op" id="2215264">.</span><span class="ident" id="2215265">Kind</span><span class="op" id="2215269">(</span><span class="op" id="2215270">)</span>&nbsp;<span class="op" id="2215272">==</span>&nbsp;<span class="ident" id="2215275">Ptr</span>&nbsp;<span class="op" id="2215279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215287">ntyp</span>&nbsp;<span class="op" id="2215292">=</span>&nbsp;<span class="ident" id="2215294">ntyp</span><span class="op" id="2215298">.</span><span class="ident" id="2215299">Elem</span><span class="op" id="2215303">(</span><span class="op" id="2215304">)</span><span class="op" id="2215305">.</span><span class="ident" id="2215306">common</span><span class="op" id="2215312">(</span><span class="op" id="2215313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215320">}</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215327">fname</span>&nbsp;<span class="op" id="2215333">=</span>&nbsp;<span class="ident" id="2215335">ntyp</span><span class="op" id="2215339">.</span><span class="ident" id="2215340">Name</span><span class="op" id="2215344">(</span><span class="op" id="2215345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2215358">//&nbsp;Does&nbsp;it&nbsp;match?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2215380">if</span>&nbsp;<span class="ident" id="2215383">match</span><span class="op" id="2215388">(</span><span class="ident" id="2215389">fname</span><span class="op" id="2215394">)</span>&nbsp;<span class="op" id="2215396">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2215403">//&nbsp;Potential&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2215427">if</span>&nbsp;<span class="ident" id="2215430">count</span><span class="op" id="2215435">[</span><span class="ident" id="2215436">t</span><span class="op" id="2215437">]</span>&nbsp;<span class="op" id="2215439">&gt;</span>&nbsp;<span class="num" id="2215441">1</span>&nbsp;<span class="op" id="2215443">||</span>&nbsp;<span class="ident" id="2215446">ok</span>&nbsp;<span class="op" id="2215449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2215457">//&nbsp;Name&nbsp;appeared&nbsp;multiple&nbsp;times&nbsp;at&nbsp;this&nbsp;level:&nbsp;annihilate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2215522">return</span>&nbsp;<span class="ident" id="2215529">StructField</span><span class="op" id="2215540">{</span><span class="op" id="2215541">}</span><span class="op" id="2215542">,</span>&nbsp;<span class="builtintype" id="2215544">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215555">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215562">result</span>&nbsp;<span class="op" id="2215569">=</span>&nbsp;<span class="ident" id="2215571">t</span><span class="op" id="2215572">.</span><span class="ident" id="2215573">Field</span><span class="op" id="2215578">(</span><span class="ident" id="2215579">i</span><span class="op" id="2215580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215587">result</span><span class="op" id="2215593">.</span><span class="ident" id="2215594">Index</span>&nbsp;<span class="op" id="2215600">=</span>&nbsp;<span class="ident" id="2215602">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215611">result</span><span class="op" id="2215617">.</span><span class="ident" id="2215618">Index</span>&nbsp;<span class="op" id="2215624">=</span>&nbsp;<span class="builtinfunc" id="2215626">append</span><span class="op" id="2215632">(</span><span class="ident" id="2215633">result</span><span class="op" id="2215639">.</span><span class="ident" id="2215640">Index</span><span class="op" id="2215645">,</span>&nbsp;<span class="ident" id="2215647">scan</span><span class="op" id="2215651">.</span><span class="ident" id="2215652">index</span><span class="op" id="2215657">...</span><span class="op" id="2215660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215667">result</span><span class="op" id="2215673">.</span><span class="ident" id="2215674">Index</span>&nbsp;<span class="op" id="2215680">=</span>&nbsp;<span class="builtinfunc" id="2215682">append</span><span class="op" id="2215688">(</span><span class="ident" id="2215689">result</span><span class="op" id="2215695">.</span><span class="ident" id="2215696">Index</span><span class="op" id="2215701">,</span>&nbsp;<span class="ident" id="2215703">i</span><span class="op" id="2215704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2215711">ok</span>&nbsp;<span class="op" id="2215714">=</span>&nbsp;<span class="builtintype" id="2215716">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2215726">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2215739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2215746">//&nbsp;Queue&nbsp;embedded&nbsp;struct&nbsp;fields&nbsp;for&nbsp;processing&nbsp;with&nbsp;next&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2215814">//&nbsp;but&nbsp;only&nbsp;if&nbsp;we&nbsp;haven&#39;t&nbsp;seen&nbsp;a&nbsp;match&nbsp;yet&nbsp;at&nbsp;this&nbsp;level&nbsp;and&nbsp;only</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2215884">//&nbsp;if&nbsp;the&nbsp;embedded&nbsp;types&nbsp;haven&#39;t&nbsp;already&nbsp;been&nbsp;queued.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2215942">if</span>&nbsp;<span class="ident" id="2215945">ok</span>&nbsp;<span class="op" id="2215948">||</span>&nbsp;<span class="ident" id="2215951">ntyp</span>&nbsp;<span class="op" id="2215956">==</span>&nbsp;<span class="ident" id="2215959">nil</span>&nbsp;<span class="op" id="2215963">||</span>&nbsp;<span class="ident" id="2215966">ntyp</span><span class="op" id="2215970">.</span><span class="ident" id="2215971">Kind</span><span class="op" id="2215975">(</span><span class="op" id="2215976">)</span>&nbsp;<span class="op" id="2215978">!=</span>&nbsp;<span class="ident" id="2215981">Struct</span>&nbsp;<span class="op" id="2215988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2215995">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216014">styp</span>&nbsp;<span class="op" id="2216019">:=</span>&nbsp;<span class="op" id="2216022">(</span><span class="op" id="2216023">*</span><span class="ident" id="2216024">structType</span><span class="op" id="2216034">)</span><span class="op" id="2216035">(</span><span class="ident" id="2216036">unsafe</span><span class="op" id="2216042">.</span><span class="ident" id="2216043">Pointer</span><span class="op" id="2216050">(</span><span class="ident" id="2216051">ntyp</span><span class="op" id="2216055">)</span><span class="op" id="2216056">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216062">if</span>&nbsp;<span class="ident" id="2216065">nextCount</span><span class="op" id="2216074">[</span><span class="ident" id="2216075">styp</span><span class="op" id="2216079">]</span>&nbsp;<span class="op" id="2216081">&gt;</span>&nbsp;<span class="num" id="2216083">0</span>&nbsp;<span class="op" id="2216085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216092">nextCount</span><span class="op" id="2216101">[</span><span class="ident" id="2216102">styp</span><span class="op" id="2216106">]</span>&nbsp;<span class="op" id="2216108">=</span>&nbsp;<span class="num" id="2216110">2</span>&nbsp;<span class="comment" id="2216112">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216150">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216169">if</span>&nbsp;<span class="ident" id="2216172">nextCount</span>&nbsp;<span class="op" id="2216182">==</span>&nbsp;<span class="ident" id="2216185">nil</span>&nbsp;<span class="op" id="2216189">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216196">nextCount</span>&nbsp;<span class="op" id="2216206">=</span>&nbsp;<span class="keyword" id="2216208">map</span><span class="op" id="2216211">[</span><span class="op" id="2216212">*</span><span class="ident" id="2216213">structType</span><span class="op" id="2216223">]</span><span class="builtintype" id="2216224">int</span><span class="op" id="2216227">{</span><span class="op" id="2216228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216240">nextCount</span><span class="op" id="2216249">[</span><span class="ident" id="2216250">styp</span><span class="op" id="2216254">]</span>&nbsp;<span class="op" id="2216256">=</span>&nbsp;<span class="num" id="2216258">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216264">if</span>&nbsp;<span class="ident" id="2216267">count</span><span class="op" id="2216272">[</span><span class="ident" id="2216273">t</span><span class="op" id="2216274">]</span>&nbsp;<span class="op" id="2216276">&gt;</span>&nbsp;<span class="num" id="2216278">1</span>&nbsp;<span class="op" id="2216280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216287">nextCount</span><span class="op" id="2216296">[</span><span class="ident" id="2216297">styp</span><span class="op" id="2216301">]</span>&nbsp;<span class="op" id="2216303">=</span>&nbsp;<span class="num" id="2216305">2</span>&nbsp;<span class="comment" id="2216307">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216350">var</span>&nbsp;<span class="ident" id="2216354">index</span>&nbsp;<span class="op" id="2216360">[</span><span class="op" id="2216361">]</span><span class="builtintype" id="2216362">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216370">index</span>&nbsp;<span class="op" id="2216376">=</span>&nbsp;<span class="builtinfunc" id="2216378">append</span><span class="op" id="2216384">(</span><span class="ident" id="2216385">index</span><span class="op" id="2216390">,</span>&nbsp;<span class="ident" id="2216392">scan</span><span class="op" id="2216396">.</span><span class="ident" id="2216397">index</span><span class="op" id="2216402">...</span><span class="op" id="2216405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216411">index</span>&nbsp;<span class="op" id="2216417">=</span>&nbsp;<span class="builtinfunc" id="2216419">append</span><span class="op" id="2216425">(</span><span class="ident" id="2216426">index</span><span class="op" id="2216431">,</span>&nbsp;<span class="ident" id="2216433">i</span><span class="op" id="2216434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216440">next</span>&nbsp;<span class="op" id="2216445">=</span>&nbsp;<span class="builtinfunc" id="2216447">append</span><span class="op" id="2216453">(</span><span class="ident" id="2216454">next</span><span class="op" id="2216458">,</span>&nbsp;<span class="ident" id="2216460">fieldScan</span><span class="op" id="2216469">{</span><span class="ident" id="2216470">styp</span><span class="op" id="2216474">,</span>&nbsp;<span class="ident" id="2216476">index</span><span class="op" id="2216481">}</span><span class="op" id="2216482">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216495">if</span>&nbsp;<span class="ident" id="2216498">ok</span>&nbsp;<span class="op" id="2216501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216506">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216514">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216520">return</span><br>
<span class="lineno"></span><span class="op" id="2216527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2216530">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">980</span><span class="comment" id="2216590">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2216643">func</span>&nbsp;<span class="op" id="2216648">(</span><span class="ident" id="2216649">t</span>&nbsp;<span class="op" id="2216651">*</span><span class="ident" id="2216652">structType</span><span class="op" id="2216662">)</span>&nbsp;<span class="ident" id="2216664">FieldByName</span><span class="op" id="2216675">(</span><span class="ident" id="2216676">name</span>&nbsp;<span class="builtintype" id="2216681">string</span><span class="op" id="2216687">)</span>&nbsp;<span class="op" id="2216689">(</span><span class="ident" id="2216690">f</span>&nbsp;<span class="ident" id="2216692">StructField</span><span class="op" id="2216703">,</span>&nbsp;<span class="ident" id="2216705">present</span>&nbsp;<span class="builtintype" id="2216713">bool</span><span class="op" id="2216717">)</span>&nbsp;<span class="op" id="2216719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2216722">//&nbsp;Quick&nbsp;check&nbsp;for&nbsp;top-level&nbsp;name,&nbsp;or&nbsp;struct&nbsp;without&nbsp;anonymous&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216794">hasAnon</span>&nbsp;<span class="op" id="2216802">:=</span>&nbsp;<span class="builtintype" id="2216805">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216812">if</span>&nbsp;<span class="ident" id="2216815">name</span>&nbsp;<span class="op" id="2216820">!=</span>&nbsp;<span class="string" id="2216823">&#34;&#34;</span>&nbsp;<span class="op" id="2216826">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216830">for</span>&nbsp;<span class="ident" id="2216834">i</span>&nbsp;<span class="op" id="2216836">:=</span>&nbsp;<span class="keyword" id="2216839">range</span>&nbsp;<span class="ident" id="2216845">t</span><span class="op" id="2216846">.</span><span class="ident" id="2216847">fields</span>&nbsp;<span class="op" id="2216854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216859">tf</span>&nbsp;<span class="op" id="2216862">:=</span>&nbsp;<span class="op" id="2216865">&amp;</span><span class="ident" id="2216866">t</span><span class="op" id="2216867">.</span><span class="ident" id="2216868">fields</span><span class="op" id="2216874">[</span><span class="ident" id="2216875">i</span><span class="op" id="2216876">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216881">if</span>&nbsp;<span class="ident" id="2216884">tf</span><span class="op" id="2216886">.</span><span class="ident" id="2216887">name</span>&nbsp;<span class="op" id="2216892">==</span>&nbsp;<span class="ident" id="2216895">nil</span>&nbsp;<span class="op" id="2216899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2216905">hasAnon</span>&nbsp;<span class="op" id="2216913">=</span>&nbsp;<span class="builtintype" id="2216915">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216924">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216941">if</span>&nbsp;<span class="op" id="2216944">*</span><span class="ident" id="2216945">tf</span><span class="op" id="2216947">.</span><span class="ident" id="2216948">name</span>&nbsp;<span class="op" id="2216953">==</span>&nbsp;<span class="ident" id="2216956">name</span>&nbsp;<span class="op" id="2216961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2216967">return</span>&nbsp;<span class="ident" id="2216974">t</span><span class="op" id="2216975">.</span><span class="ident" id="2216976">Field</span><span class="op" id="2216981">(</span><span class="ident" id="2216982">i</span><span class="op" id="2216983">)</span><span class="op" id="2216984">,</span>&nbsp;<span class="builtintype" id="2216986">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2216998">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2217001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217004">if</span>&nbsp;<span class="op" id="2217007">!</span><span class="ident" id="2217008">hasAnon</span>&nbsp;<span class="op" id="2217016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217020">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2217028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217031">return</span>&nbsp;<span class="ident" id="2217038">t</span><span class="op" id="2217039">.</span><span class="ident" id="2217040">FieldByNameFunc</span><span class="op" id="2217055">(</span><span class="keyword" id="2217056">func</span><span class="op" id="2217060">(</span><span class="ident" id="2217061">s</span>&nbsp;<span class="builtintype" id="2217063">string</span><span class="op" id="2217069">)</span>&nbsp;<span class="builtintype" id="2217071">bool</span>&nbsp;<span class="op" id="2217076">{</span>&nbsp;<span class="keyword" id="2217078">return</span>&nbsp;<span class="ident" id="2217085">s</span>&nbsp;<span class="op" id="2217087">==</span>&nbsp;<span class="ident" id="2217090">name</span>&nbsp;<span class="op" id="2217095">}</span><span class="op" id="2217096">)</span><br>
<span class="lineno">1000</span><span class="op" id="2217098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2217101">//&nbsp;TypeOf&nbsp;returns&nbsp;the&nbsp;reflection&nbsp;Type&nbsp;of&nbsp;the&nbsp;value&nbsp;in&nbsp;the&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="2217172">//&nbsp;TypeOf(nil)&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2217200">func</span>&nbsp;<span class="ident" id="2217205">TypeOf</span><span class="op" id="2217211">(</span><span class="ident" id="2217212">i</span>&nbsp;<span class="keyword" id="2217214">interface</span><span class="op" id="2217223">{</span><span class="op" id="2217224">}</span><span class="op" id="2217225">)</span>&nbsp;<span class="ident" id="2217227">Type</span>&nbsp;<span class="op" id="2217232">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217235">eface</span>&nbsp;<span class="op" id="2217241">:=</span>&nbsp;<span class="op" id="2217244">*</span><span class="op" id="2217245">(</span><span class="op" id="2217246">*</span><span class="ident" id="2217247">emptyInterface</span><span class="op" id="2217261">)</span><span class="op" id="2217262">(</span><span class="ident" id="2217263">unsafe</span><span class="op" id="2217269">.</span><span class="ident" id="2217270">Pointer</span><span class="op" id="2217277">(</span><span class="op" id="2217278">&amp;</span><span class="ident" id="2217279">i</span><span class="op" id="2217280">)</span><span class="op" id="2217281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217284">return</span>&nbsp;<span class="ident" id="2217291">toType</span><span class="op" id="2217297">(</span><span class="ident" id="2217298">eface</span><span class="op" id="2217303">.</span><span class="ident" id="2217304">typ</span><span class="op" id="2217307">)</span><br>
<span class="lineno"></span><span class="op" id="2217309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2217312">//&nbsp;ptrMap&nbsp;is&nbsp;the&nbsp;cache&nbsp;for&nbsp;PtrTo.</span><br>
<span class="lineno">1010</span><span class="keyword" id="2217346">var</span>&nbsp;<span class="ident" id="2217350">ptrMap</span>&nbsp;<span class="keyword" id="2217357">struct</span>&nbsp;<span class="op" id="2217364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217367">sync</span><span class="op" id="2217371">.</span><span class="ident" id="2217372">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217381">m</span>&nbsp;<span class="keyword" id="2217383">map</span><span class="op" id="2217386">[</span><span class="op" id="2217387">*</span><span class="ident" id="2217388">rtype</span><span class="op" id="2217393">]</span><span class="op" id="2217394">*</span><span class="ident" id="2217395">ptrType</span><br>
<span class="lineno"></span><span class="op" id="2217403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1015</span><span class="comment" id="2217406">//&nbsp;PtrTo&nbsp;returns&nbsp;the&nbsp;pointer&nbsp;type&nbsp;with&nbsp;element&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2217456">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;type&nbsp;Foo,&nbsp;PtrTo(t)&nbsp;represents&nbsp;*Foo.</span><br>
<span class="lineno"></span><span class="keyword" id="2217524">func</span>&nbsp;<span class="ident" id="2217529">PtrTo</span><span class="op" id="2217534">(</span><span class="ident" id="2217535">t</span>&nbsp;<span class="ident" id="2217537">Type</span><span class="op" id="2217541">)</span>&nbsp;<span class="ident" id="2217543">Type</span>&nbsp;<span class="op" id="2217548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217551">return</span>&nbsp;<span class="ident" id="2217558">t</span><span class="op" id="2217559">.</span><span class="op" id="2217560">(</span><span class="op" id="2217561">*</span><span class="ident" id="2217562">rtype</span><span class="op" id="2217567">)</span><span class="op" id="2217568">.</span><span class="ident" id="2217569">ptrTo</span><span class="op" id="2217574">(</span><span class="op" id="2217575">)</span><br>
<span class="lineno"></span><span class="op" id="2217577">}</span><br>
<span class="lineno">1020</span><br>
<span class="lineno"></span><span class="keyword" id="2217580">func</span>&nbsp;<span class="op" id="2217585">(</span><span class="ident" id="2217586">t</span>&nbsp;<span class="op" id="2217588">*</span><span class="ident" id="2217589">rtype</span><span class="op" id="2217594">)</span>&nbsp;<span class="ident" id="2217596">ptrTo</span><span class="op" id="2217601">(</span><span class="op" id="2217602">)</span>&nbsp;<span class="op" id="2217604">*</span><span class="ident" id="2217605">rtype</span>&nbsp;<span class="op" id="2217611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217614">if</span>&nbsp;<span class="ident" id="2217617">p</span>&nbsp;<span class="op" id="2217619">:=</span>&nbsp;<span class="ident" id="2217622">t</span><span class="op" id="2217623">.</span><span class="ident" id="2217624">ptrToThis</span><span class="op" id="2217633">;</span>&nbsp;<span class="ident" id="2217635">p</span>&nbsp;<span class="op" id="2217637">!=</span>&nbsp;<span class="ident" id="2217640">nil</span>&nbsp;<span class="op" id="2217644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217648">return</span>&nbsp;<span class="ident" id="2217655">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2217658">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2217662">//&nbsp;Otherwise,&nbsp;synthesize&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2217693">//&nbsp;This&nbsp;only&nbsp;happens&nbsp;for&nbsp;pointers&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2217745">//&nbsp;We&nbsp;keep&nbsp;the&nbsp;mapping&nbsp;in&nbsp;a&nbsp;map&nbsp;on&nbsp;the&nbsp;side,&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2217799">//&nbsp;this&nbsp;operation&nbsp;is&nbsp;rare&nbsp;and&nbsp;a&nbsp;separate&nbsp;map&nbsp;lets&nbsp;us&nbsp;keep</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2217858">//&nbsp;the&nbsp;type&nbsp;structures&nbsp;in&nbsp;read-only&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217903">ptrMap</span><span class="op" id="2217909">.</span><span class="ident" id="2217910">RLock</span><span class="op" id="2217915">(</span><span class="op" id="2217916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217919">if</span>&nbsp;<span class="ident" id="2217922">m</span>&nbsp;<span class="op" id="2217924">:=</span>&nbsp;<span class="ident" id="2217927">ptrMap</span><span class="op" id="2217933">.</span><span class="ident" id="2217934">m</span><span class="op" id="2217935">;</span>&nbsp;<span class="ident" id="2217937">m</span>&nbsp;<span class="op" id="2217939">!=</span>&nbsp;<span class="ident" id="2217942">nil</span>&nbsp;<span class="op" id="2217946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217950">if</span>&nbsp;<span class="ident" id="2217953">p</span>&nbsp;<span class="op" id="2217955">:=</span>&nbsp;<span class="ident" id="2217958">m</span><span class="op" id="2217959">[</span><span class="ident" id="2217960">t</span><span class="op" id="2217961">]</span><span class="op" id="2217962">;</span>&nbsp;<span class="ident" id="2217964">p</span>&nbsp;<span class="op" id="2217966">!=</span>&nbsp;<span class="ident" id="2217969">nil</span>&nbsp;<span class="op" id="2217973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2217978">ptrMap</span><span class="op" id="2217984">.</span><span class="ident" id="2217985">RUnlock</span><span class="op" id="2217992">(</span><span class="op" id="2217993">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2217998">return</span>&nbsp;<span class="op" id="2218005">&amp;</span><span class="ident" id="2218006">p</span><span class="op" id="2218007">.</span><span class="ident" id="2218008">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2218016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2218019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218022">ptrMap</span><span class="op" id="2218028">.</span><span class="ident" id="2218029">RUnlock</span><span class="op" id="2218036">(</span><span class="op" id="2218037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218040">ptrMap</span><span class="op" id="2218046">.</span><span class="ident" id="2218047">Lock</span><span class="op" id="2218051">(</span><span class="op" id="2218052">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2218055">if</span>&nbsp;<span class="ident" id="2218058">ptrMap</span><span class="op" id="2218064">.</span><span class="ident" id="2218065">m</span>&nbsp;<span class="op" id="2218067">==</span>&nbsp;<span class="ident" id="2218070">nil</span>&nbsp;<span class="op" id="2218074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218078">ptrMap</span><span class="op" id="2218084">.</span><span class="ident" id="2218085">m</span>&nbsp;<span class="op" id="2218087">=</span>&nbsp;<span class="builtinfunc" id="2218089">make</span><span class="op" id="2218093">(</span><span class="keyword" id="2218094">map</span><span class="op" id="2218097">[</span><span class="op" id="2218098">*</span><span class="ident" id="2218099">rtype</span><span class="op" id="2218104">]</span><span class="op" id="2218105">*</span><span class="ident" id="2218106">ptrType</span><span class="op" id="2218113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2218116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218119">p</span>&nbsp;<span class="op" id="2218121">:=</span>&nbsp;<span class="ident" id="2218124">ptrMap</span><span class="op" id="2218130">.</span><span class="ident" id="2218131">m</span><span class="op" id="2218132">[</span><span class="ident" id="2218133">t</span><span class="op" id="2218134">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2218137">if</span>&nbsp;<span class="ident" id="2218140">p</span>&nbsp;<span class="op" id="2218142">!=</span>&nbsp;<span class="ident" id="2218145">nil</span>&nbsp;<span class="op" id="2218149">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2218153">//&nbsp;some&nbsp;other&nbsp;goroutine&nbsp;won&nbsp;the&nbsp;race&nbsp;and&nbsp;created&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218207">ptrMap</span><span class="op" id="2218213">.</span><span class="ident" id="2218214">Unlock</span><span class="op" id="2218220">(</span><span class="op" id="2218221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2218225">return</span>&nbsp;<span class="op" id="2218232">&amp;</span><span class="ident" id="2218233">p</span><span class="op" id="2218234">.</span><span class="ident" id="2218235">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2218242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2218246">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;ptrType&nbsp;starting&nbsp;with&nbsp;the&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2218301">//&nbsp;of&nbsp;an&nbsp;*unsafe.Pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218328">p</span>&nbsp;<span class="op" id="2218330">=</span>&nbsp;<span class="builtinfunc" id="2218332">new</span><span class="op" id="2218335">(</span><span class="ident" id="2218336">ptrType</span><span class="op" id="2218343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2218346">var</span>&nbsp;<span class="ident" id="2218350">iptr</span>&nbsp;<span class="keyword" id="2218355">interface</span><span class="op" id="2218364">{</span><span class="op" id="2218365">}</span>&nbsp;<span class="op" id="2218367">=</span>&nbsp;<span class="op" id="2218369">(</span><span class="op" id="2218370">*</span><span class="ident" id="2218371">unsafe</span><span class="op" id="2218377">.</span><span class="ident" id="2218378">Pointer</span><span class="op" id="2218385">)</span><span class="op" id="2218386">(</span><span class="ident" id="2218387">nil</span><span class="op" id="2218390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218393">prototype</span>&nbsp;<span class="op" id="2218403">:=</span>&nbsp;<span class="op" id="2218406">*</span><span class="op" id="2218407">(</span><span class="op" id="2218408">*</span><span class="op" id="2218409">*</span><span class="ident" id="2218410">ptrType</span><span class="op" id="2218417">)</span><span class="op" id="2218418">(</span><span class="ident" id="2218419">unsafe</span><span class="op" id="2218425">.</span><span class="ident" id="2218426">Pointer</span><span class="op" id="2218433">(</span><span class="op" id="2218434">&amp;</span><span class="ident" id="2218435">iptr</span><span class="op" id="2218439">)</span><span class="op" id="2218440">)</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2218443">*</span><span class="ident" id="2218444">p</span>&nbsp;<span class="op" id="2218446">=</span>&nbsp;<span class="op" id="2218448">*</span><span class="ident" id="2218449">prototype</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218461">s</span>&nbsp;<span class="op" id="2218463">:=</span>&nbsp;<span class="string" id="2218466">&#34;*&#34;</span>&nbsp;<span class="op" id="2218470">+</span>&nbsp;<span class="op" id="2218472">*</span><span class="ident" id="2218473">t</span><span class="op" id="2218474">.</span><span class="builtintype" id="2218475">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218483">p</span><span class="op" id="2218484">.</span><span class="builtintype" id="2218485">string</span>&nbsp;<span class="op" id="2218492">=</span>&nbsp;<span class="op" id="2218494">&amp;</span><span class="ident" id="2218495">s</span><br>
<span class="lineno"></span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2218499">//&nbsp;For&nbsp;the&nbsp;type&nbsp;structures&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary,&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2218555">//&nbsp;compiler&nbsp;provides&nbsp;a&nbsp;good&nbsp;hash&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2218604">//&nbsp;Create&nbsp;a&nbsp;good&nbsp;hash&nbsp;for&nbsp;the&nbsp;new&nbsp;string&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2218655">//&nbsp;the&nbsp;FNV-1&nbsp;hash&#39;s&nbsp;mixing&nbsp;function&nbsp;to&nbsp;combine&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2218707">//&nbsp;old&nbsp;hash&nbsp;and&nbsp;the&nbsp;new&nbsp;&#34;*&#34;.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218737">p</span><span class="op" id="2218738">.</span><span class="ident" id="2218739">hash</span>&nbsp;<span class="op" id="2218744">=</span>&nbsp;<span class="ident" id="2218746">fnv1</span><span class="op" id="2218750">(</span><span class="ident" id="2218751">t</span><span class="op" id="2218752">.</span><span class="ident" id="2218753">hash</span><span class="op" id="2218757">,</span>&nbsp;<span class="string" id="2218759">&#39;*&#39;</span><span class="op" id="2218762">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218766">p</span><span class="op" id="2218767">.</span><span class="ident" id="2218768">uncommonType</span>&nbsp;<span class="op" id="2218781">=</span>&nbsp;<span class="ident" id="2218783">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218788">p</span><span class="op" id="2218789">.</span><span class="ident" id="2218790">ptrToThis</span>&nbsp;<span class="op" id="2218800">=</span>&nbsp;<span class="ident" id="2218802">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218807">p</span><span class="op" id="2218808">.</span><span class="ident" id="2218809">zero</span>&nbsp;<span class="op" id="2218814">=</span>&nbsp;<span class="ident" id="2218816">unsafe</span><span class="op" id="2218822">.</span><span class="ident" id="2218823">Pointer</span><span class="op" id="2218830">(</span><span class="op" id="2218831">&amp;</span><span class="builtinfunc" id="2218832">make</span><span class="op" id="2218836">(</span><span class="op" id="2218837">[</span><span class="op" id="2218838">]</span><span class="builtintype" id="2218839">byte</span><span class="op" id="2218843">,</span>&nbsp;<span class="ident" id="2218845">p</span><span class="op" id="2218846">.</span><span class="ident" id="2218847">size</span><span class="op" id="2218851">)</span><span class="op" id="2218852">[</span><span class="num" id="2218853">0</span><span class="op" id="2218854">]</span><span class="op" id="2218855">)</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218858">p</span><span class="op" id="2218859">.</span><span class="ident" id="2218860">elem</span>&nbsp;<span class="op" id="2218865">=</span>&nbsp;<span class="ident" id="2218867">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218871">ptrMap</span><span class="op" id="2218877">.</span><span class="ident" id="2218878">m</span><span class="op" id="2218879">[</span><span class="ident" id="2218880">t</span><span class="op" id="2218881">]</span>&nbsp;<span class="op" id="2218883">=</span>&nbsp;<span class="ident" id="2218885">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2218888">ptrMap</span><span class="op" id="2218894">.</span><span class="ident" id="2218895">Unlock</span><span class="op" id="2218901">(</span><span class="op" id="2218902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2218905">return</span>&nbsp;<span class="op" id="2218912">&amp;</span><span class="ident" id="2218913">p</span><span class="op" id="2218914">.</span><span class="ident" id="2218915">rtype</span><br>
<span class="lineno">1075</span><span class="op" id="2218921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2218924">//&nbsp;fnv1&nbsp;incorporates&nbsp;the&nbsp;list&nbsp;of&nbsp;bytes&nbsp;into&nbsp;the&nbsp;hash&nbsp;x&nbsp;using&nbsp;the&nbsp;FNV-1&nbsp;hash&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="2219010">func</span>&nbsp;<span class="ident" id="2219015">fnv1</span><span class="op" id="2219019">(</span><span class="ident" id="2219020">x</span>&nbsp;<span class="builtintype" id="2219022">uint32</span><span class="op" id="2219028">,</span>&nbsp;<span class="ident" id="2219030">list</span>&nbsp;<span class="op" id="2219035">...</span><span class="builtintype" id="2219038">byte</span><span class="op" id="2219042">)</span>&nbsp;<span class="builtintype" id="2219044">uint32</span>&nbsp;<span class="op" id="2219051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2219054">for</span>&nbsp;<span class="ident" id="2219058">_</span><span class="op" id="2219059">,</span>&nbsp;<span class="ident" id="2219061">b</span>&nbsp;<span class="op" id="2219063">:=</span>&nbsp;<span class="keyword" id="2219066">range</span>&nbsp;<span class="ident" id="2219072">list</span>&nbsp;<span class="op" id="2219077">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2219081">x</span>&nbsp;<span class="op" id="2219083">=</span>&nbsp;<span class="ident" id="2219085">x</span><span class="op" id="2219086">*</span><span class="num" id="2219087">16777619</span>&nbsp;<span class="op" id="2219096">^</span>&nbsp;<span class="builtintype" id="2219098">uint32</span><span class="op" id="2219104">(</span><span class="ident" id="2219105">b</span><span class="op" id="2219106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2219109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2219112">return</span>&nbsp;<span class="ident" id="2219119">x</span><br>
<span class="lineno"></span><span class="op" id="2219121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1085</span><span class="keyword" id="2219124">func</span>&nbsp;<span class="op" id="2219129">(</span><span class="ident" id="2219130">t</span>&nbsp;<span class="op" id="2219132">*</span><span class="ident" id="2219133">rtype</span><span class="op" id="2219138">)</span>&nbsp;<span class="ident" id="2219140">Implements</span><span class="op" id="2219150">(</span><span class="ident" id="2219151">u</span>&nbsp;<span class="ident" id="2219153">Type</span><span class="op" id="2219157">)</span>&nbsp;<span class="builtintype" id="2219159">bool</span>&nbsp;<span class="op" id="2219164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2219167">if</span>&nbsp;<span class="ident" id="2219170">u</span>&nbsp;<span class="op" id="2219172">==</span>&nbsp;<span class="ident" id="2219175">nil</span>&nbsp;<span class="op" id="2219179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2219183">panic</span><span class="op" id="2219188">(</span><span class="string" id="2219189">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2219234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2219237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2219240">if</span>&nbsp;<span class="ident" id="2219243">u</span><span class="op" id="2219244">.</span><span class="ident" id="2219245">Kind</span><span class="op" id="2219249">(</span><span class="op" id="2219250">)</span>&nbsp;<span class="op" id="2219252">!=</span>&nbsp;<span class="ident" id="2219255">Interface</span>&nbsp;<span class="op" id="2219265">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2219269">panic</span><span class="op" id="2219274">(</span><span class="string" id="2219275">&#34;reflect:&nbsp;non-interface&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2219330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2219333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2219336">return</span>&nbsp;<span class="ident" id="2219343">implements</span><span class="op" id="2219353">(</span><span class="ident" id="2219354">u</span><span class="op" id="2219355">.</span><span class="op" id="2219356">(</span><span class="op" id="2219357">*</span><span class="ident" id="2219358">rtype</span><span class="op" id="2219363">)</span><span class="op" id="2219364">,</span>&nbsp;<span class="ident" id="2219366">t</span><span class="op" id="2219367">)</span><br>
<span class="lineno"></span><span class="op" id="2219369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span><span class="keyword" id="2219372">func</span>&nbsp;<span class="op" id="2219377">(</span><span class="ident" id="2219378">t</span>&nbsp;<span class="op" id="2219380">*</span><span class="ident" id="2219381">rtype</span><span class="op" id="2219386">)</span>&nbsp;<span class="ident" id="2219388">AssignableTo</span><span class="op" id="2219400">(</span><span class="ident" id="2219401">u</span>&nbsp;<span class="ident" id="2219403">Type</span><span class="op" id="2219407">)</span>&nbsp;<span class="builtintype" id="2219409">bool</span>&nbsp;<span class="op" id="2219414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2219417">if</span>&nbsp;<span class="ident" id="2219420">u</span>&nbsp;<span class="op" id="2219422">==</span>&nbsp;<span class="ident" id="2219425">nil</span>&nbsp;<span class="op" id="2219429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2219433">panic</span><span class="op" id="2219438">(</span><span class="string" id="2219439">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.AssignableTo&#34;</span><span class="op" id="2219486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2219489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2219492">uu</span>&nbsp;<span class="op" id="2219495">:=</span>&nbsp;<span class="ident" id="2219498">u</span><span class="op" id="2219499">.</span><span class="op" id="2219500">(</span><span class="op" id="2219501">*</span><span class="ident" id="2219502">rtype</span><span class="op" id="2219507">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2219510">return</span>&nbsp;<span class="ident" id="2219517">directlyAssignable</span><span class="op" id="2219535">(</span><span class="ident" id="2219536">uu</span><span class="op" id="2219538">,</span>&nbsp;<span class="ident" id="2219540">t</span><span class="op" id="2219541">)</span>&nbsp;<span class="op" id="2219543">||</span>&nbsp;<span class="ident" id="2219546">implements</span><span class="op" id="2219556">(</span><span class="ident" id="2219557">uu</span><span class="op" id="2219559">,</span>&nbsp;<span class="ident" id="2219561">t</span><span class="op" id="2219562">)</span><br>
<span class="lineno"></span><span class="op" id="2219564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2219567">func</span>&nbsp;<span class="op" id="2219572">(</span><span class="ident" id="2219573">t</span>&nbsp;<span class="op" id="2219575">*</span><span class="ident" id="2219576">rtype</span><span class="op" id="2219581">)</span>&nbsp;<span class="ident" id="2219583">ConvertibleTo</span><span class="op" id="2219596">(</span><span class="ident" id="2219597">u</span>&nbsp;<span class="ident" id="2219599">Type</span><span class="op" id="2219603">)</span>&nbsp;<span class="builtintype" id="2219605">bool</span>&nbsp;<span class="op" id="2219610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2219613">if</span>&nbsp;<span class="ident" id="2219616">u</span>&nbsp;<span class="op" id="2219618">==</span>&nbsp;<span class="ident" id="2219621">nil</span>&nbsp;<span class="op" id="2219625">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2219629">panic</span><span class="op" id="2219634">(</span><span class="string" id="2219635">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.ConvertibleTo&#34;</span><span class="op" id="2219683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2219686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2219689">uu</span>&nbsp;<span class="op" id="2219692">:=</span>&nbsp;<span class="ident" id="2219695">u</span><span class="op" id="2219696">.</span><span class="op" id="2219697">(</span><span class="op" id="2219698">*</span><span class="ident" id="2219699">rtype</span><span class="op" id="2219704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2219707">return</span>&nbsp;<span class="ident" id="2219714">convertOp</span><span class="op" id="2219723">(</span><span class="ident" id="2219724">uu</span><span class="op" id="2219726">,</span>&nbsp;<span class="ident" id="2219728">t</span><span class="op" id="2219729">)</span>&nbsp;<span class="op" id="2219731">!=</span>&nbsp;<span class="ident" id="2219734">nil</span><br>
<span class="lineno"></span><span class="op" id="2219738">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span><span class="keyword" id="2219741">func</span>&nbsp;<span class="op" id="2219746">(</span><span class="ident" id="2219747">t</span>&nbsp;<span class="op" id="2219749">*</span><span class="ident" id="2219750">rtype</span><span class="op" id="2219755">)</span>&nbsp;<span class="ident" id="2219757">Comparable</span><span class="op" id="2219767">(</span><span class="op" id="2219768">)</span>&nbsp;<span class="builtintype" id="2219770">bool</span>&nbsp;<span class="op" id="2219775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2219778">return</span>&nbsp;<span class="ident" id="2219785">t</span><span class="op" id="2219786">.</span><span class="ident" id="2219787">alg</span>&nbsp;<span class="op" id="2219791">!=</span>&nbsp;<span class="ident" id="2219794">nil</span>&nbsp;<span class="op" id="2219798">&amp;&amp;</span>&nbsp;<span class="ident" id="2219801">t</span><span class="op" id="2219802">.</span><span class="ident" id="2219803">alg</span><span class="op" id="2219806">.</span><span class="ident" id="2219807">equal</span>&nbsp;<span class="op" id="2219813">!=</span>&nbsp;<span class="ident" id="2219816">nil</span><br>
<span class="lineno"></span><span class="op" id="2219820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2219823">//&nbsp;implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;V&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="keyword" id="2219897">func</span>&nbsp;<span class="ident" id="2219902">implements</span><span class="op" id="2219912">(</span><span class="ident" id="2219913">T</span><span class="op" id="2219914">,</span>&nbsp;<span class="ident" id="2219916">V</span>&nbsp;<span class="op" id="2219918">*</span><span class="ident" id="2219919">rtype</span><span class="op" id="2219924">)</span>&nbsp;<span class="builtintype" id="2219926">bool</span>&nbsp;<span class="op" id="2219931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2219934">if</span>&nbsp;<span class="ident" id="2219937">T</span><span class="op" id="2219938">.</span><span class="ident" id="2219939">Kind</span><span class="op" id="2219943">(</span><span class="op" id="2219944">)</span>&nbsp;<span class="op" id="2219946">!=</span>&nbsp;<span class="ident" id="2219949">Interface</span>&nbsp;<span class="op" id="2219959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2219963">return</span>&nbsp;<span class="builtintype" id="2219970">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2219977">}</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2219980">t</span>&nbsp;<span class="op" id="2219982">:=</span>&nbsp;<span class="op" id="2219985">(</span><span class="op" id="2219986">*</span><span class="ident" id="2219987">interfaceType</span><span class="op" id="2220000">)</span><span class="op" id="2220001">(</span><span class="ident" id="2220002">unsafe</span><span class="op" id="2220008">.</span><span class="ident" id="2220009">Pointer</span><span class="op" id="2220016">(</span><span class="ident" id="2220017">T</span><span class="op" id="2220018">)</span><span class="op" id="2220019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2220022">if</span>&nbsp;<span class="builtinfunc" id="2220025">len</span><span class="op" id="2220028">(</span><span class="ident" id="2220029">t</span><span class="op" id="2220030">.</span><span class="ident" id="2220031">methods</span><span class="op" id="2220038">)</span>&nbsp;<span class="op" id="2220040">==</span>&nbsp;<span class="num" id="2220043">0</span>&nbsp;<span class="op" id="2220045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2220049">return</span>&nbsp;<span class="builtintype" id="2220056">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2220062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2220066">//&nbsp;The&nbsp;same&nbsp;algorithm&nbsp;applies&nbsp;in&nbsp;both&nbsp;cases,&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2220120">//&nbsp;method&nbsp;tables&nbsp;for&nbsp;an&nbsp;interface&nbsp;type&nbsp;and&nbsp;a&nbsp;concrete&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2220180">//&nbsp;are&nbsp;different,&nbsp;so&nbsp;the&nbsp;code&nbsp;is&nbsp;duplicated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2220226">//&nbsp;In&nbsp;both&nbsp;cases&nbsp;the&nbsp;algorithm&nbsp;is&nbsp;a&nbsp;linear&nbsp;scan&nbsp;over&nbsp;the&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2220288">//&nbsp;lists&nbsp;-&nbsp;T&#39;s&nbsp;methods&nbsp;and&nbsp;V&#39;s&nbsp;methods&nbsp;-&nbsp;simultaneously.</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2220346">//&nbsp;Since&nbsp;method&nbsp;tables&nbsp;are&nbsp;stored&nbsp;in&nbsp;a&nbsp;unique&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2220406">//&nbsp;(alphabetical,&nbsp;with&nbsp;no&nbsp;duplicate&nbsp;method&nbsp;names),&nbsp;the&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2220467">//&nbsp;through&nbsp;V&#39;s&nbsp;methods&nbsp;must&nbsp;hit&nbsp;a&nbsp;match&nbsp;for&nbsp;each&nbsp;of&nbsp;T&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2220524">//&nbsp;methods&nbsp;along&nbsp;the&nbsp;way,&nbsp;or&nbsp;else&nbsp;V&nbsp;does&nbsp;not&nbsp;implement&nbsp;T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2220583">//&nbsp;This&nbsp;lets&nbsp;us&nbsp;run&nbsp;the&nbsp;scan&nbsp;in&nbsp;overall&nbsp;linear&nbsp;time&nbsp;instead&nbsp;of</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2220647">//&nbsp;the&nbsp;quadratic&nbsp;time&nbsp;&nbsp;a&nbsp;naive&nbsp;search&nbsp;would&nbsp;require.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2220701">//&nbsp;See&nbsp;also&nbsp;../runtime/iface.c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2220734">if</span>&nbsp;<span class="ident" id="2220737">V</span><span class="op" id="2220738">.</span><span class="ident" id="2220739">Kind</span><span class="op" id="2220743">(</span><span class="op" id="2220744">)</span>&nbsp;<span class="op" id="2220746">==</span>&nbsp;<span class="ident" id="2220749">Interface</span>&nbsp;<span class="op" id="2220759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2220763">v</span>&nbsp;<span class="op" id="2220765">:=</span>&nbsp;<span class="op" id="2220768">(</span><span class="op" id="2220769">*</span><span class="ident" id="2220770">interfaceType</span><span class="op" id="2220783">)</span><span class="op" id="2220784">(</span><span class="ident" id="2220785">unsafe</span><span class="op" id="2220791">.</span><span class="ident" id="2220792">Pointer</span><span class="op" id="2220799">(</span><span class="ident" id="2220800">V</span><span class="op" id="2220801">)</span><span class="op" id="2220802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2220806">i</span>&nbsp;<span class="op" id="2220808">:=</span>&nbsp;<span class="num" id="2220811">0</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2220815">for</span>&nbsp;<span class="ident" id="2220819">j</span>&nbsp;<span class="op" id="2220821">:=</span>&nbsp;<span class="num" id="2220824">0</span><span class="op" id="2220825">;</span>&nbsp;<span class="ident" id="2220827">j</span>&nbsp;<span class="op" id="2220829">&lt;</span>&nbsp;<span class="builtinfunc" id="2220831">len</span><span class="op" id="2220834">(</span><span class="ident" id="2220835">v</span><span class="op" id="2220836">.</span><span class="ident" id="2220837">methods</span><span class="op" id="2220844">)</span><span class="op" id="2220845">;</span>&nbsp;<span class="ident" id="2220847">j</span><span class="op" id="2220848">++</span>&nbsp;<span class="op" id="2220851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2220856">tm</span>&nbsp;<span class="op" id="2220859">:=</span>&nbsp;<span class="op" id="2220862">&amp;</span><span class="ident" id="2220863">t</span><span class="op" id="2220864">.</span><span class="ident" id="2220865">methods</span><span class="op" id="2220872">[</span><span class="ident" id="2220873">i</span><span class="op" id="2220874">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2220879">vm</span>&nbsp;<span class="op" id="2220882">:=</span>&nbsp;<span class="op" id="2220885">&amp;</span><span class="ident" id="2220886">v</span><span class="op" id="2220887">.</span><span class="ident" id="2220888">methods</span><span class="op" id="2220895">[</span><span class="ident" id="2220896">j</span><span class="op" id="2220897">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2220902">if</span>&nbsp;<span class="ident" id="2220905">vm</span><span class="op" id="2220907">.</span><span class="ident" id="2220908">name</span>&nbsp;<span class="op" id="2220913">==</span>&nbsp;<span class="ident" id="2220916">tm</span><span class="op" id="2220918">.</span><span class="ident" id="2220919">name</span>&nbsp;<span class="op" id="2220924">&amp;&amp;</span>&nbsp;<span class="ident" id="2220927">vm</span><span class="op" id="2220929">.</span><span class="ident" id="2220930">pkgPath</span>&nbsp;<span class="op" id="2220938">==</span>&nbsp;<span class="ident" id="2220941">tm</span><span class="op" id="2220943">.</span><span class="ident" id="2220944">pkgPath</span>&nbsp;<span class="op" id="2220952">&amp;&amp;</span>&nbsp;<span class="ident" id="2220955">vm</span><span class="op" id="2220957">.</span><span class="ident" id="2220958">typ</span>&nbsp;<span class="op" id="2220962">==</span>&nbsp;<span class="ident" id="2220965">tm</span><span class="op" id="2220967">.</span><span class="ident" id="2220968">typ</span>&nbsp;<span class="op" id="2220972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2220978">if</span>&nbsp;<span class="ident" id="2220981">i</span><span class="op" id="2220982">++</span><span class="op" id="2220984">;</span>&nbsp;<span class="ident" id="2220986">i</span>&nbsp;<span class="op" id="2220988">&gt;=</span>&nbsp;<span class="builtinfunc" id="2220991">len</span><span class="op" id="2220994">(</span><span class="ident" id="2220995">t</span><span class="op" id="2220996">.</span><span class="ident" id="2220997">methods</span><span class="op" id="2221004">)</span>&nbsp;<span class="op" id="2221006">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2221013">return</span>&nbsp;<span class="builtintype" id="2221020">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2221029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2221034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2221038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2221042">return</span>&nbsp;<span class="builtintype" id="2221049">false</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2221056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2221060">v</span>&nbsp;<span class="op" id="2221062">:=</span>&nbsp;<span class="ident" id="2221065">V</span><span class="op" id="2221066">.</span><span class="ident" id="2221067">uncommon</span><span class="op" id="2221075">(</span><span class="op" id="2221076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2221079">if</span>&nbsp;<span class="ident" id="2221082">v</span>&nbsp;<span class="op" id="2221084">==</span>&nbsp;<span class="ident" id="2221087">nil</span>&nbsp;<span class="op" id="2221091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2221095">return</span>&nbsp;<span class="builtintype" id="2221102">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2221109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2221112">i</span>&nbsp;<span class="op" id="2221114">:=</span>&nbsp;<span class="num" id="2221117">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2221120">for</span>&nbsp;<span class="ident" id="2221124">j</span>&nbsp;<span class="op" id="2221126">:=</span>&nbsp;<span class="num" id="2221129">0</span><span class="op" id="2221130">;</span>&nbsp;<span class="ident" id="2221132">j</span>&nbsp;<span class="op" id="2221134">&lt;</span>&nbsp;<span class="builtinfunc" id="2221136">len</span><span class="op" id="2221139">(</span><span class="ident" id="2221140">v</span><span class="op" id="2221141">.</span><span class="ident" id="2221142">methods</span><span class="op" id="2221149">)</span><span class="op" id="2221150">;</span>&nbsp;<span class="ident" id="2221152">j</span><span class="op" id="2221153">++</span>&nbsp;<span class="op" id="2221156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2221160">tm</span>&nbsp;<span class="op" id="2221163">:=</span>&nbsp;<span class="op" id="2221166">&amp;</span><span class="ident" id="2221167">t</span><span class="op" id="2221168">.</span><span class="ident" id="2221169">methods</span><span class="op" id="2221176">[</span><span class="ident" id="2221177">i</span><span class="op" id="2221178">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2221182">vm</span>&nbsp;<span class="op" id="2221185">:=</span>&nbsp;<span class="op" id="2221188">&amp;</span><span class="ident" id="2221189">v</span><span class="op" id="2221190">.</span><span class="ident" id="2221191">methods</span><span class="op" id="2221198">[</span><span class="ident" id="2221199">j</span><span class="op" id="2221200">]</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2221204">if</span>&nbsp;<span class="ident" id="2221207">vm</span><span class="op" id="2221209">.</span><span class="ident" id="2221210">name</span>&nbsp;<span class="op" id="2221215">==</span>&nbsp;<span class="ident" id="2221218">tm</span><span class="op" id="2221220">.</span><span class="ident" id="2221221">name</span>&nbsp;<span class="op" id="2221226">&amp;&amp;</span>&nbsp;<span class="ident" id="2221229">vm</span><span class="op" id="2221231">.</span><span class="ident" id="2221232">pkgPath</span>&nbsp;<span class="op" id="2221240">==</span>&nbsp;<span class="ident" id="2221243">tm</span><span class="op" id="2221245">.</span><span class="ident" id="2221246">pkgPath</span>&nbsp;<span class="op" id="2221254">&amp;&amp;</span>&nbsp;<span class="ident" id="2221257">vm</span><span class="op" id="2221259">.</span><span class="ident" id="2221260">mtyp</span>&nbsp;<span class="op" id="2221265">==</span>&nbsp;<span class="ident" id="2221268">tm</span><span class="op" id="2221270">.</span><span class="ident" id="2221271">typ</span>&nbsp;<span class="op" id="2221275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2221280">if</span>&nbsp;<span class="ident" id="2221283">i</span><span class="op" id="2221284">++</span><span class="op" id="2221286">;</span>&nbsp;<span class="ident" id="2221288">i</span>&nbsp;<span class="op" id="2221290">&gt;=</span>&nbsp;<span class="builtinfunc" id="2221293">len</span><span class="op" id="2221296">(</span><span class="ident" id="2221297">t</span><span class="op" id="2221298">.</span><span class="ident" id="2221299">methods</span><span class="op" id="2221306">)</span>&nbsp;<span class="op" id="2221308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2221314">return</span>&nbsp;<span class="builtintype" id="2221321">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2221329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2221333">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2221336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2221339">return</span>&nbsp;<span class="builtintype" id="2221346">false</span><br>
<span class="lineno"></span><span class="op" id="2221352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2221355">//&nbsp;directlyAssignable&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;x&nbsp;of&nbsp;type&nbsp;V&nbsp;can&nbsp;be&nbsp;directly</span><br>
<span class="lineno">1170</span><span class="comment" id="2221429">//&nbsp;assigned&nbsp;(using&nbsp;memmove)&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="comment" id="2221479">//&nbsp;http://golang.org/doc/go_spec.html#Assignability</span><br>
<span class="lineno"></span><span class="comment" id="2221531">//&nbsp;Ignoring&nbsp;the&nbsp;interface&nbsp;rules&nbsp;(implemented&nbsp;elsewhere)</span><br>
<span class="lineno"></span><span class="comment" id="2221587">//&nbsp;and&nbsp;the&nbsp;ideal&nbsp;constant&nbsp;rules&nbsp;(no&nbsp;ideal&nbsp;constants&nbsp;at&nbsp;run&nbsp;time).</span><br>
<span class="lineno"></span><span class="keyword" id="2221653">func</span>&nbsp;<span class="ident" id="2221658">directlyAssignable</span><span class="op" id="2221676">(</span><span class="ident" id="2221677">T</span><span class="op" id="2221678">,</span>&nbsp;<span class="ident" id="2221680">V</span>&nbsp;<span class="op" id="2221682">*</span><span class="ident" id="2221683">rtype</span><span class="op" id="2221688">)</span>&nbsp;<span class="builtintype" id="2221690">bool</span>&nbsp;<span class="op" id="2221695">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2221698">//&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;is&nbsp;identical&nbsp;to&nbsp;T?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2221732">if</span>&nbsp;<span class="ident" id="2221735">T</span>&nbsp;<span class="op" id="2221737">==</span>&nbsp;<span class="ident" id="2221740">V</span>&nbsp;<span class="op" id="2221742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2221746">return</span>&nbsp;<span class="builtintype" id="2221753">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2221759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2221763">//&nbsp;Otherwise&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;be&nbsp;unnamed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2221817">//&nbsp;and&nbsp;they&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2221855">if</span>&nbsp;<span class="ident" id="2221858">T</span><span class="op" id="2221859">.</span><span class="ident" id="2221860">Name</span><span class="op" id="2221864">(</span><span class="op" id="2221865">)</span>&nbsp;<span class="op" id="2221867">!=</span>&nbsp;<span class="string" id="2221870">&#34;&#34;</span>&nbsp;<span class="op" id="2221873">&amp;&amp;</span>&nbsp;<span class="ident" id="2221876">V</span><span class="op" id="2221877">.</span><span class="ident" id="2221878">Name</span><span class="op" id="2221882">(</span><span class="op" id="2221883">)</span>&nbsp;<span class="op" id="2221885">!=</span>&nbsp;<span class="string" id="2221888">&#34;&#34;</span>&nbsp;<span class="op" id="2221891">||</span>&nbsp;<span class="ident" id="2221894">T</span><span class="op" id="2221895">.</span><span class="ident" id="2221896">Kind</span><span class="op" id="2221900">(</span><span class="op" id="2221901">)</span>&nbsp;<span class="op" id="2221903">!=</span>&nbsp;<span class="ident" id="2221906">V</span><span class="op" id="2221907">.</span><span class="ident" id="2221908">Kind</span><span class="op" id="2221912">(</span><span class="op" id="2221913">)</span>&nbsp;<span class="op" id="2221915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2221919">return</span>&nbsp;<span class="builtintype" id="2221926">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2221933">}</span><br>
<span class="lineno">1185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2221937">//&nbsp;x&#39;s&nbsp;type&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;&nbsp;have&nbsp;identical&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2221997">return</span>&nbsp;<span class="ident" id="2222004">haveIdenticalUnderlyingType</span><span class="op" id="2222031">(</span><span class="ident" id="2222032">T</span><span class="op" id="2222033">,</span>&nbsp;<span class="ident" id="2222035">V</span><span class="op" id="2222036">)</span><br>
<span class="lineno"></span><span class="op" id="2222038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1190</span><span class="keyword" id="2222041">func</span>&nbsp;<span class="ident" id="2222046">haveIdenticalUnderlyingType</span><span class="op" id="2222073">(</span><span class="ident" id="2222074">T</span><span class="op" id="2222075">,</span>&nbsp;<span class="ident" id="2222077">V</span>&nbsp;<span class="op" id="2222079">*</span><span class="ident" id="2222080">rtype</span><span class="op" id="2222085">)</span>&nbsp;<span class="builtintype" id="2222087">bool</span>&nbsp;<span class="op" id="2222092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222095">if</span>&nbsp;<span class="ident" id="2222098">T</span>&nbsp;<span class="op" id="2222100">==</span>&nbsp;<span class="ident" id="2222103">V</span>&nbsp;<span class="op" id="2222105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222109">return</span>&nbsp;<span class="builtintype" id="2222116">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2222122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2222126">kind</span>&nbsp;<span class="op" id="2222131">:=</span>&nbsp;<span class="ident" id="2222134">T</span><span class="op" id="2222135">.</span><span class="ident" id="2222136">Kind</span><span class="op" id="2222140">(</span><span class="op" id="2222141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222144">if</span>&nbsp;<span class="ident" id="2222147">kind</span>&nbsp;<span class="op" id="2222152">!=</span>&nbsp;<span class="ident" id="2222155">V</span><span class="op" id="2222156">.</span><span class="ident" id="2222157">Kind</span><span class="op" id="2222161">(</span><span class="op" id="2222162">)</span>&nbsp;<span class="op" id="2222164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222168">return</span>&nbsp;<span class="builtintype" id="2222175">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2222182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2222186">//&nbsp;Non-composite&nbsp;types&nbsp;of&nbsp;equal&nbsp;kind&nbsp;have&nbsp;same&nbsp;underlying&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2222250">//&nbsp;(the&nbsp;predefined&nbsp;instance&nbsp;of&nbsp;the&nbsp;type).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222293">if</span>&nbsp;<span class="ident" id="2222296">Bool</span>&nbsp;<span class="op" id="2222301">&lt;=</span>&nbsp;<span class="ident" id="2222304">kind</span>&nbsp;<span class="op" id="2222309">&amp;&amp;</span>&nbsp;<span class="ident" id="2222312">kind</span>&nbsp;<span class="op" id="2222317">&lt;=</span>&nbsp;<span class="ident" id="2222320">Complex128</span>&nbsp;<span class="op" id="2222331">||</span>&nbsp;<span class="ident" id="2222334">kind</span>&nbsp;<span class="op" id="2222339">==</span>&nbsp;<span class="ident" id="2222342">String</span>&nbsp;<span class="op" id="2222349">||</span>&nbsp;<span class="ident" id="2222352">kind</span>&nbsp;<span class="op" id="2222357">==</span>&nbsp;<span class="ident" id="2222360">UnsafePointer</span>&nbsp;<span class="op" id="2222374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222378">return</span>&nbsp;<span class="builtintype" id="2222385">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2222391">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2222395">//&nbsp;Composite&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222416">switch</span>&nbsp;<span class="ident" id="2222423">kind</span>&nbsp;<span class="op" id="2222428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222431">case</span>&nbsp;<span class="ident" id="2222436">Array</span><span class="op" id="2222441">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222445">return</span>&nbsp;<span class="ident" id="2222452">T</span><span class="op" id="2222453">.</span><span class="ident" id="2222454">Elem</span><span class="op" id="2222458">(</span><span class="op" id="2222459">)</span>&nbsp;<span class="op" id="2222461">==</span>&nbsp;<span class="ident" id="2222464">V</span><span class="op" id="2222465">.</span><span class="ident" id="2222466">Elem</span><span class="op" id="2222470">(</span><span class="op" id="2222471">)</span>&nbsp;<span class="op" id="2222473">&amp;&amp;</span>&nbsp;<span class="ident" id="2222476">T</span><span class="op" id="2222477">.</span><span class="ident" id="2222478">Len</span><span class="op" id="2222481">(</span><span class="op" id="2222482">)</span>&nbsp;<span class="op" id="2222484">==</span>&nbsp;<span class="ident" id="2222487">V</span><span class="op" id="2222488">.</span><span class="ident" id="2222489">Len</span><span class="op" id="2222492">(</span><span class="op" id="2222493">)</span><br>
<span class="lineno">1210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222497">case</span>&nbsp;<span class="ident" id="2222502">Chan</span><span class="op" id="2222506">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2222510">//&nbsp;Special&nbsp;case:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2222529">//&nbsp;x&nbsp;is&nbsp;a&nbsp;bidirectional&nbsp;channel&nbsp;value,&nbsp;T&nbsp;is&nbsp;a&nbsp;channel&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2222591">//&nbsp;and&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;and&nbsp;T&nbsp;have&nbsp;identical&nbsp;element&nbsp;types.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222647">if</span>&nbsp;<span class="ident" id="2222650">V</span><span class="op" id="2222651">.</span><span class="ident" id="2222652">ChanDir</span><span class="op" id="2222659">(</span><span class="op" id="2222660">)</span>&nbsp;<span class="op" id="2222662">==</span>&nbsp;<span class="ident" id="2222665">BothDir</span>&nbsp;<span class="op" id="2222673">&amp;&amp;</span>&nbsp;<span class="ident" id="2222676">T</span><span class="op" id="2222677">.</span><span class="ident" id="2222678">Elem</span><span class="op" id="2222682">(</span><span class="op" id="2222683">)</span>&nbsp;<span class="op" id="2222685">==</span>&nbsp;<span class="ident" id="2222688">V</span><span class="op" id="2222689">.</span><span class="ident" id="2222690">Elem</span><span class="op" id="2222694">(</span><span class="op" id="2222695">)</span>&nbsp;<span class="op" id="2222697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222702">return</span>&nbsp;<span class="builtintype" id="2222709">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2222716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2222721">//&nbsp;Otherwise&nbsp;continue&nbsp;test&nbsp;for&nbsp;identical&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222781">return</span>&nbsp;<span class="ident" id="2222788">V</span><span class="op" id="2222789">.</span><span class="ident" id="2222790">ChanDir</span><span class="op" id="2222797">(</span><span class="op" id="2222798">)</span>&nbsp;<span class="op" id="2222800">==</span>&nbsp;<span class="ident" id="2222803">T</span><span class="op" id="2222804">.</span><span class="ident" id="2222805">ChanDir</span><span class="op" id="2222812">(</span><span class="op" id="2222813">)</span>&nbsp;<span class="op" id="2222815">&amp;&amp;</span>&nbsp;<span class="ident" id="2222818">T</span><span class="op" id="2222819">.</span><span class="ident" id="2222820">Elem</span><span class="op" id="2222824">(</span><span class="op" id="2222825">)</span>&nbsp;<span class="op" id="2222827">==</span>&nbsp;<span class="ident" id="2222830">V</span><span class="op" id="2222831">.</span><span class="ident" id="2222832">Elem</span><span class="op" id="2222836">(</span><span class="op" id="2222837">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222841">case</span>&nbsp;<span class="ident" id="2222846">Func</span><span class="op" id="2222850">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2222854">t</span>&nbsp;<span class="op" id="2222856">:=</span>&nbsp;<span class="op" id="2222859">(</span><span class="op" id="2222860">*</span><span class="ident" id="2222861">funcType</span><span class="op" id="2222869">)</span><span class="op" id="2222870">(</span><span class="ident" id="2222871">unsafe</span><span class="op" id="2222877">.</span><span class="ident" id="2222878">Pointer</span><span class="op" id="2222885">(</span><span class="ident" id="2222886">T</span><span class="op" id="2222887">)</span><span class="op" id="2222888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2222892">v</span>&nbsp;<span class="op" id="2222894">:=</span>&nbsp;<span class="op" id="2222897">(</span><span class="op" id="2222898">*</span><span class="ident" id="2222899">funcType</span><span class="op" id="2222907">)</span><span class="op" id="2222908">(</span><span class="ident" id="2222909">unsafe</span><span class="op" id="2222915">.</span><span class="ident" id="2222916">Pointer</span><span class="op" id="2222923">(</span><span class="ident" id="2222924">V</span><span class="op" id="2222925">)</span><span class="op" id="2222926">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2222930">if</span>&nbsp;<span class="ident" id="2222933">t</span><span class="op" id="2222934">.</span><span class="ident" id="2222935">dotdotdot</span>&nbsp;<span class="op" id="2222945">!=</span>&nbsp;<span class="ident" id="2222948">v</span><span class="op" id="2222949">.</span><span class="ident" id="2222950">dotdotdot</span>&nbsp;<span class="op" id="2222960">||</span>&nbsp;<span class="builtinfunc" id="2222963">len</span><span class="op" id="2222966">(</span><span class="ident" id="2222967">t</span><span class="op" id="2222968">.</span><span class="ident" id="2222969">in</span><span class="op" id="2222971">)</span>&nbsp;<span class="op" id="2222973">!=</span>&nbsp;<span class="builtinfunc" id="2222976">len</span><span class="op" id="2222979">(</span><span class="ident" id="2222980">v</span><span class="op" id="2222981">.</span><span class="ident" id="2222982">in</span><span class="op" id="2222984">)</span>&nbsp;<span class="op" id="2222986">||</span>&nbsp;<span class="builtinfunc" id="2222989">len</span><span class="op" id="2222992">(</span><span class="ident" id="2222993">t</span><span class="op" id="2222994">.</span><span class="ident" id="2222995">out</span><span class="op" id="2222998">)</span>&nbsp;<span class="op" id="2223000">!=</span>&nbsp;<span class="builtinfunc" id="2223003">len</span><span class="op" id="2223006">(</span><span class="ident" id="2223007">v</span><span class="op" id="2223008">.</span><span class="ident" id="2223009">out</span><span class="op" id="2223012">)</span>&nbsp;<span class="op" id="2223014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223019">return</span>&nbsp;<span class="builtintype" id="2223026">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2223034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223038">for</span>&nbsp;<span class="ident" id="2223042">i</span><span class="op" id="2223043">,</span>&nbsp;<span class="ident" id="2223045">typ</span>&nbsp;<span class="op" id="2223049">:=</span>&nbsp;<span class="keyword" id="2223052">range</span>&nbsp;<span class="ident" id="2223058">t</span><span class="op" id="2223059">.</span><span class="ident" id="2223060">in</span>&nbsp;<span class="op" id="2223063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223068">if</span>&nbsp;<span class="ident" id="2223071">typ</span>&nbsp;<span class="op" id="2223075">!=</span>&nbsp;<span class="ident" id="2223078">v</span><span class="op" id="2223079">.</span><span class="ident" id="2223080">in</span><span class="op" id="2223082">[</span><span class="ident" id="2223083">i</span><span class="op" id="2223084">]</span>&nbsp;<span class="op" id="2223086">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223092">return</span>&nbsp;<span class="builtintype" id="2223099">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2223108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2223112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223116">for</span>&nbsp;<span class="ident" id="2223120">i</span><span class="op" id="2223121">,</span>&nbsp;<span class="ident" id="2223123">typ</span>&nbsp;<span class="op" id="2223127">:=</span>&nbsp;<span class="keyword" id="2223130">range</span>&nbsp;<span class="ident" id="2223136">t</span><span class="op" id="2223137">.</span><span class="ident" id="2223138">out</span>&nbsp;<span class="op" id="2223142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223147">if</span>&nbsp;<span class="ident" id="2223150">typ</span>&nbsp;<span class="op" id="2223154">!=</span>&nbsp;<span class="ident" id="2223157">v</span><span class="op" id="2223158">.</span><span class="ident" id="2223159">out</span><span class="op" id="2223162">[</span><span class="ident" id="2223163">i</span><span class="op" id="2223164">]</span>&nbsp;<span class="op" id="2223166">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223172">return</span>&nbsp;<span class="builtintype" id="2223179">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2223188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2223192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223196">return</span>&nbsp;<span class="builtintype" id="2223203">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223210">case</span>&nbsp;<span class="ident" id="2223215">Interface</span><span class="op" id="2223224">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2223228">t</span>&nbsp;<span class="op" id="2223230">:=</span>&nbsp;<span class="op" id="2223233">(</span><span class="op" id="2223234">*</span><span class="ident" id="2223235">interfaceType</span><span class="op" id="2223248">)</span><span class="op" id="2223249">(</span><span class="ident" id="2223250">unsafe</span><span class="op" id="2223256">.</span><span class="ident" id="2223257">Pointer</span><span class="op" id="2223264">(</span><span class="ident" id="2223265">T</span><span class="op" id="2223266">)</span><span class="op" id="2223267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2223271">v</span>&nbsp;<span class="op" id="2223273">:=</span>&nbsp;<span class="op" id="2223276">(</span><span class="op" id="2223277">*</span><span class="ident" id="2223278">interfaceType</span><span class="op" id="2223291">)</span><span class="op" id="2223292">(</span><span class="ident" id="2223293">unsafe</span><span class="op" id="2223299">.</span><span class="ident" id="2223300">Pointer</span><span class="op" id="2223307">(</span><span class="ident" id="2223308">V</span><span class="op" id="2223309">)</span><span class="op" id="2223310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223314">if</span>&nbsp;<span class="builtinfunc" id="2223317">len</span><span class="op" id="2223320">(</span><span class="ident" id="2223321">t</span><span class="op" id="2223322">.</span><span class="ident" id="2223323">methods</span><span class="op" id="2223330">)</span>&nbsp;<span class="op" id="2223332">==</span>&nbsp;<span class="num" id="2223335">0</span>&nbsp;<span class="op" id="2223337">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2223340">len</span><span class="op" id="2223343">(</span><span class="ident" id="2223344">v</span><span class="op" id="2223345">.</span><span class="ident" id="2223346">methods</span><span class="op" id="2223353">)</span>&nbsp;<span class="op" id="2223355">==</span>&nbsp;<span class="num" id="2223358">0</span>&nbsp;<span class="op" id="2223360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223365">return</span>&nbsp;<span class="builtintype" id="2223372">true</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2223379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2223383">//&nbsp;Might&nbsp;have&nbsp;the&nbsp;same&nbsp;methods&nbsp;but&nbsp;still</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2223426">//&nbsp;need&nbsp;a&nbsp;run&nbsp;time&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223459">return</span>&nbsp;<span class="builtintype" id="2223466">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223474">case</span>&nbsp;<span class="ident" id="2223479">Map</span><span class="op" id="2223482">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223486">return</span>&nbsp;<span class="ident" id="2223493">T</span><span class="op" id="2223494">.</span><span class="ident" id="2223495">Key</span><span class="op" id="2223498">(</span><span class="op" id="2223499">)</span>&nbsp;<span class="op" id="2223501">==</span>&nbsp;<span class="ident" id="2223504">V</span><span class="op" id="2223505">.</span><span class="ident" id="2223506">Key</span><span class="op" id="2223509">(</span><span class="op" id="2223510">)</span>&nbsp;<span class="op" id="2223512">&amp;&amp;</span>&nbsp;<span class="ident" id="2223515">T</span><span class="op" id="2223516">.</span><span class="ident" id="2223517">Elem</span><span class="op" id="2223521">(</span><span class="op" id="2223522">)</span>&nbsp;<span class="op" id="2223524">==</span>&nbsp;<span class="ident" id="2223527">V</span><span class="op" id="2223528">.</span><span class="ident" id="2223529">Elem</span><span class="op" id="2223533">(</span><span class="op" id="2223534">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223538">case</span>&nbsp;<span class="ident" id="2223543">Ptr</span><span class="op" id="2223546">,</span>&nbsp;<span class="ident" id="2223548">Slice</span><span class="op" id="2223553">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223557">return</span>&nbsp;<span class="ident" id="2223564">T</span><span class="op" id="2223565">.</span><span class="ident" id="2223566">Elem</span><span class="op" id="2223570">(</span><span class="op" id="2223571">)</span>&nbsp;<span class="op" id="2223573">==</span>&nbsp;<span class="ident" id="2223576">V</span><span class="op" id="2223577">.</span><span class="ident" id="2223578">Elem</span><span class="op" id="2223582">(</span><span class="op" id="2223583">)</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223587">case</span>&nbsp;<span class="ident" id="2223592">Struct</span><span class="op" id="2223598">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2223602">t</span>&nbsp;<span class="op" id="2223604">:=</span>&nbsp;<span class="op" id="2223607">(</span><span class="op" id="2223608">*</span><span class="ident" id="2223609">structType</span><span class="op" id="2223619">)</span><span class="op" id="2223620">(</span><span class="ident" id="2223621">unsafe</span><span class="op" id="2223627">.</span><span class="ident" id="2223628">Pointer</span><span class="op" id="2223635">(</span><span class="ident" id="2223636">T</span><span class="op" id="2223637">)</span><span class="op" id="2223638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2223642">v</span>&nbsp;<span class="op" id="2223644">:=</span>&nbsp;<span class="op" id="2223647">(</span><span class="op" id="2223648">*</span><span class="ident" id="2223649">structType</span><span class="op" id="2223659">)</span><span class="op" id="2223660">(</span><span class="ident" id="2223661">unsafe</span><span class="op" id="2223667">.</span><span class="ident" id="2223668">Pointer</span><span class="op" id="2223675">(</span><span class="ident" id="2223676">V</span><span class="op" id="2223677">)</span><span class="op" id="2223678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223682">if</span>&nbsp;<span class="builtinfunc" id="2223685">len</span><span class="op" id="2223688">(</span><span class="ident" id="2223689">t</span><span class="op" id="2223690">.</span><span class="ident" id="2223691">fields</span><span class="op" id="2223697">)</span>&nbsp;<span class="op" id="2223699">!=</span>&nbsp;<span class="builtinfunc" id="2223702">len</span><span class="op" id="2223705">(</span><span class="ident" id="2223706">v</span><span class="op" id="2223707">.</span><span class="ident" id="2223708">fields</span><span class="op" id="2223714">)</span>&nbsp;<span class="op" id="2223716">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223721">return</span>&nbsp;<span class="builtintype" id="2223728">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2223736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223740">for</span>&nbsp;<span class="ident" id="2223744">i</span>&nbsp;<span class="op" id="2223746">:=</span>&nbsp;<span class="keyword" id="2223749">range</span>&nbsp;<span class="ident" id="2223755">t</span><span class="op" id="2223756">.</span><span class="ident" id="2223757">fields</span>&nbsp;<span class="op" id="2223764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2223769">tf</span>&nbsp;<span class="op" id="2223772">:=</span>&nbsp;<span class="op" id="2223775">&amp;</span><span class="ident" id="2223776">t</span><span class="op" id="2223777">.</span><span class="ident" id="2223778">fields</span><span class="op" id="2223784">[</span><span class="ident" id="2223785">i</span><span class="op" id="2223786">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2223791">vf</span>&nbsp;<span class="op" id="2223794">:=</span>&nbsp;<span class="op" id="2223797">&amp;</span><span class="ident" id="2223798">v</span><span class="op" id="2223799">.</span><span class="ident" id="2223800">fields</span><span class="op" id="2223806">[</span><span class="ident" id="2223807">i</span><span class="op" id="2223808">]</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223813">if</span>&nbsp;<span class="ident" id="2223816">tf</span><span class="op" id="2223818">.</span><span class="ident" id="2223819">name</span>&nbsp;<span class="op" id="2223824">!=</span>&nbsp;<span class="ident" id="2223827">vf</span><span class="op" id="2223829">.</span><span class="ident" id="2223830">name</span>&nbsp;<span class="op" id="2223835">&amp;&amp;</span>&nbsp;<span class="op" id="2223838">(</span><span class="ident" id="2223839">tf</span><span class="op" id="2223841">.</span><span class="ident" id="2223842">name</span>&nbsp;<span class="op" id="2223847">==</span>&nbsp;<span class="ident" id="2223850">nil</span>&nbsp;<span class="op" id="2223854">||</span>&nbsp;<span class="ident" id="2223857">vf</span><span class="op" id="2223859">.</span><span class="ident" id="2223860">name</span>&nbsp;<span class="op" id="2223865">==</span>&nbsp;<span class="ident" id="2223868">nil</span>&nbsp;<span class="op" id="2223872">||</span>&nbsp;<span class="op" id="2223875">*</span><span class="ident" id="2223876">tf</span><span class="op" id="2223878">.</span><span class="ident" id="2223879">name</span>&nbsp;<span class="op" id="2223884">!=</span>&nbsp;<span class="op" id="2223887">*</span><span class="ident" id="2223888">vf</span><span class="op" id="2223890">.</span><span class="ident" id="2223891">name</span><span class="op" id="2223895">)</span>&nbsp;<span class="op" id="2223897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223903">return</span>&nbsp;<span class="builtintype" id="2223910">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2223919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2223924">if</span>&nbsp;<span class="ident" id="2223927">tf</span><span class="op" id="2223929">.</span><span class="ident" id="2223930">pkgPath</span>&nbsp;<span class="op" id="2223938">!=</span>&nbsp;<span class="ident" id="2223941">vf</span><span class="op" id="2223943">.</span><span class="ident" id="2223944">pkgPath</span>&nbsp;<span class="op" id="2223952">&amp;&amp;</span>&nbsp;<span class="op" id="2223955">(</span><span class="ident" id="2223956">tf</span><span class="op" id="2223958">.</span><span class="ident" id="2223959">pkgPath</span>&nbsp;<span class="op" id="2223967">==</span>&nbsp;<span class="ident" id="2223970">nil</span>&nbsp;<span class="op" id="2223974">||</span>&nbsp;<span class="ident" id="2223977">vf</span><span class="op" id="2223979">.</span><span class="ident" id="2223980">pkgPath</span>&nbsp;<span class="op" id="2223988">==</span>&nbsp;<span class="ident" id="2223991">nil</span>&nbsp;<span class="op" id="2223995">||</span>&nbsp;<span class="op" id="2223998">*</span><span class="ident" id="2223999">tf</span><span class="op" id="2224001">.</span><span class="ident" id="2224002">pkgPath</span>&nbsp;<span class="op" id="2224010">!=</span>&nbsp;<span class="op" id="2224013">*</span><span class="ident" id="2224014">vf</span><span class="op" id="2224016">.</span><span class="ident" id="2224017">pkgPath</span><span class="op" id="2224024">)</span>&nbsp;<span class="op" id="2224026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2224032">return</span>&nbsp;<span class="builtintype" id="2224039">false</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2224048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2224053">if</span>&nbsp;<span class="ident" id="2224056">tf</span><span class="op" id="2224058">.</span><span class="ident" id="2224059">typ</span>&nbsp;<span class="op" id="2224063">!=</span>&nbsp;<span class="ident" id="2224066">vf</span><span class="op" id="2224068">.</span><span class="ident" id="2224069">typ</span>&nbsp;<span class="op" id="2224073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2224079">return</span>&nbsp;<span class="builtintype" id="2224086">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2224095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2224100">if</span>&nbsp;<span class="ident" id="2224103">tf</span><span class="op" id="2224105">.</span><span class="ident" id="2224106">tag</span>&nbsp;<span class="op" id="2224110">!=</span>&nbsp;<span class="ident" id="2224113">vf</span><span class="op" id="2224115">.</span><span class="ident" id="2224116">tag</span>&nbsp;<span class="op" id="2224120">&amp;&amp;</span>&nbsp;<span class="op" id="2224123">(</span><span class="ident" id="2224124">tf</span><span class="op" id="2224126">.</span><span class="ident" id="2224127">tag</span>&nbsp;<span class="op" id="2224131">==</span>&nbsp;<span class="ident" id="2224134">nil</span>&nbsp;<span class="op" id="2224138">||</span>&nbsp;<span class="ident" id="2224141">vf</span><span class="op" id="2224143">.</span><span class="ident" id="2224144">tag</span>&nbsp;<span class="op" id="2224148">==</span>&nbsp;<span class="ident" id="2224151">nil</span>&nbsp;<span class="op" id="2224155">||</span>&nbsp;<span class="op" id="2224158">*</span><span class="ident" id="2224159">tf</span><span class="op" id="2224161">.</span><span class="ident" id="2224162">tag</span>&nbsp;<span class="op" id="2224166">!=</span>&nbsp;<span class="op" id="2224169">*</span><span class="ident" id="2224170">vf</span><span class="op" id="2224172">.</span><span class="ident" id="2224173">tag</span><span class="op" id="2224176">)</span>&nbsp;<span class="op" id="2224178">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2224184">return</span>&nbsp;<span class="builtintype" id="2224191">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2224200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2224205">if</span>&nbsp;<span class="ident" id="2224208">tf</span><span class="op" id="2224210">.</span><span class="ident" id="2224211">offset</span>&nbsp;<span class="op" id="2224218">!=</span>&nbsp;<span class="ident" id="2224221">vf</span><span class="op" id="2224223">.</span><span class="ident" id="2224224">offset</span>&nbsp;<span class="op" id="2224231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2224237">return</span>&nbsp;<span class="builtintype" id="2224244">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2224253">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2224257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2224261">return</span>&nbsp;<span class="builtintype" id="2224268">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2224274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2224278">return</span>&nbsp;<span class="builtintype" id="2224285">false</span><br>
<span class="lineno">1285</span><span class="op" id="2224291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2224294">//&nbsp;typelinks&nbsp;is&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="comment" id="2224342">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;&#39;typelink&#39;&nbsp;information&nbsp;in&nbsp;the&nbsp;binary,</span><br>
<span class="lineno"></span><span class="comment" id="2224413">//&nbsp;which&nbsp;is&nbsp;to&nbsp;say&nbsp;a&nbsp;slice&nbsp;of&nbsp;known&nbsp;types,&nbsp;sorted&nbsp;by&nbsp;string.</span><br>
<span class="lineno">1290</span><span class="comment" id="2224474">//&nbsp;Note&nbsp;that&nbsp;strings&nbsp;are&nbsp;not&nbsp;unique&nbsp;identifiers&nbsp;for&nbsp;types:</span><br>
<span class="lineno"></span><span class="comment" id="2224533">//&nbsp;there&nbsp;can&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;with&nbsp;a&nbsp;given&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2224584">//&nbsp;Only&nbsp;types&nbsp;we&nbsp;might&nbsp;want&nbsp;to&nbsp;look&nbsp;up&nbsp;are&nbsp;included:</span><br>
<span class="lineno"></span><span class="comment" id="2224637">//&nbsp;channels,&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;arrays.</span><br>
<span class="lineno"></span><span class="keyword" id="2224676">func</span>&nbsp;<span class="ident" id="2224681">typelinks</span><span class="op" id="2224690">(</span><span class="op" id="2224691">)</span>&nbsp;<span class="op" id="2224693">[</span><span class="op" id="2224694">]</span><span class="op" id="2224695">*</span><span class="ident" id="2224696">rtype</span><br>
<span class="lineno">1295</span><br>
<span class="lineno"></span><span class="comment" id="2224703">//&nbsp;typesByString&nbsp;returns&nbsp;the&nbsp;subslice&nbsp;of&nbsp;typelinks()&nbsp;whose&nbsp;elements&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2224776">//&nbsp;the&nbsp;given&nbsp;string&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="2224812">//&nbsp;It&nbsp;may&nbsp;be&nbsp;empty&nbsp;(no&nbsp;known&nbsp;types&nbsp;with&nbsp;that&nbsp;string)&nbsp;or&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2224877">//&nbsp;multiple&nbsp;elements&nbsp;(multiple&nbsp;types&nbsp;with&nbsp;that&nbsp;string).</span><br>
<span class="lineno">1300</span><span class="keyword" id="2224933">func</span>&nbsp;<span class="ident" id="2224938">typesByString</span><span class="op" id="2224951">(</span><span class="ident" id="2224952">s</span>&nbsp;<span class="builtintype" id="2224954">string</span><span class="op" id="2224960">)</span>&nbsp;<span class="op" id="2224962">[</span><span class="op" id="2224963">]</span><span class="op" id="2224964">*</span><span class="ident" id="2224965">rtype</span>&nbsp;<span class="op" id="2224971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2224974">typ</span>&nbsp;<span class="op" id="2224978">:=</span>&nbsp;<span class="ident" id="2224981">typelinks</span><span class="op" id="2224990">(</span><span class="op" id="2224991">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2224995">//&nbsp;We&nbsp;are&nbsp;looking&nbsp;for&nbsp;the&nbsp;first&nbsp;index&nbsp;i&nbsp;where&nbsp;the&nbsp;string&nbsp;becomes&nbsp;&gt;=&nbsp;s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2225067">//&nbsp;This&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;sort.Search,&nbsp;with&nbsp;f(h)&nbsp;replaced&nbsp;by&nbsp;(*typ[h].string&nbsp;&gt;=&nbsp;s).</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2225147">i</span><span class="op" id="2225148">,</span>&nbsp;<span class="ident" id="2225150">j</span>&nbsp;<span class="op" id="2225152">:=</span>&nbsp;<span class="num" id="2225155">0</span><span class="op" id="2225156">,</span>&nbsp;<span class="builtinfunc" id="2225158">len</span><span class="op" id="2225161">(</span><span class="ident" id="2225162">typ</span><span class="op" id="2225165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2225168">for</span>&nbsp;<span class="ident" id="2225172">i</span>&nbsp;<span class="op" id="2225174">&lt;</span>&nbsp;<span class="ident" id="2225176">j</span>&nbsp;<span class="op" id="2225178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2225182">h</span>&nbsp;<span class="op" id="2225184">:=</span>&nbsp;<span class="ident" id="2225187">i</span>&nbsp;<span class="op" id="2225189">+</span>&nbsp;<span class="op" id="2225191">(</span><span class="ident" id="2225192">j</span><span class="op" id="2225193">-</span><span class="ident" id="2225194">i</span><span class="op" id="2225195">)</span><span class="op" id="2225196">/</span><span class="num" id="2225197">2</span>&nbsp;<span class="comment" id="2225199">//&nbsp;avoid&nbsp;overflow&nbsp;when&nbsp;computing&nbsp;h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2225236">//&nbsp;i&nbsp;&nbsp;h&nbsp;&lt;&nbsp;j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2225253">if</span>&nbsp;<span class="op" id="2225256">!</span><span class="op" id="2225257">(</span><span class="op" id="2225258">*</span><span class="ident" id="2225259">typ</span><span class="op" id="2225262">[</span><span class="ident" id="2225263">h</span><span class="op" id="2225264">]</span><span class="op" id="2225265">.</span><span class="builtintype" id="2225266">string</span>&nbsp;<span class="op" id="2225273">&gt;=</span>&nbsp;<span class="ident" id="2225276">s</span><span class="op" id="2225277">)</span>&nbsp;<span class="op" id="2225279">{</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2225284">i</span>&nbsp;<span class="op" id="2225286">=</span>&nbsp;<span class="ident" id="2225288">h</span>&nbsp;<span class="op" id="2225290">+</span>&nbsp;<span class="num" id="2225292">1</span>&nbsp;<span class="comment" id="2225294">//&nbsp;preserves&nbsp;f(i-1)&nbsp;==&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2225325">}</span>&nbsp;<span class="keyword" id="2225327">else</span>&nbsp;<span class="op" id="2225332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2225337">j</span>&nbsp;<span class="op" id="2225339">=</span>&nbsp;<span class="ident" id="2225341">h</span>&nbsp;<span class="comment" id="2225343">//&nbsp;preserves&nbsp;f(j)&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2225371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2225374">}</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2225377">//&nbsp;i&nbsp;==&nbsp;j,&nbsp;f(i-1)&nbsp;==&nbsp;false,&nbsp;and&nbsp;f(j)&nbsp;(=&nbsp;f(i))&nbsp;==&nbsp;true&nbsp;&nbsp;=&gt;&nbsp;&nbsp;answer&nbsp;is&nbsp;i.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2225451">//&nbsp;Having&nbsp;found&nbsp;the&nbsp;first,&nbsp;linear&nbsp;scan&nbsp;forward&nbsp;to&nbsp;find&nbsp;the&nbsp;last.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2225517">//&nbsp;We&nbsp;could&nbsp;do&nbsp;a&nbsp;second&nbsp;binary&nbsp;search,&nbsp;but&nbsp;the&nbsp;caller&nbsp;is&nbsp;going</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2225581">//&nbsp;to&nbsp;do&nbsp;a&nbsp;linear&nbsp;scan&nbsp;anyway.</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2225613">j</span>&nbsp;<span class="op" id="2225615">=</span>&nbsp;<span class="ident" id="2225617">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2225620">for</span>&nbsp;<span class="ident" id="2225624">j</span>&nbsp;<span class="op" id="2225626">&lt;</span>&nbsp;<span class="builtinfunc" id="2225628">len</span><span class="op" id="2225631">(</span><span class="ident" id="2225632">typ</span><span class="op" id="2225635">)</span>&nbsp;<span class="op" id="2225637">&amp;&amp;</span>&nbsp;<span class="op" id="2225640">*</span><span class="ident" id="2225641">typ</span><span class="op" id="2225644">[</span><span class="ident" id="2225645">j</span><span class="op" id="2225646">]</span><span class="op" id="2225647">.</span><span class="builtintype" id="2225648">string</span>&nbsp;<span class="op" id="2225655">==</span>&nbsp;<span class="ident" id="2225658">s</span>&nbsp;<span class="op" id="2225660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2225664">j</span><span class="op" id="2225665">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2225669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2225673">//&nbsp;This&nbsp;slice&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;string&nbsp;is&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2225730">return</span>&nbsp;<span class="ident" id="2225737">typ</span><span class="op" id="2225740">[</span><span class="ident" id="2225741">i</span><span class="op" id="2225742">:</span><span class="ident" id="2225743">j</span><span class="op" id="2225744">]</span><br>
<span class="lineno"></span><span class="op" id="2225746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2225749">//&nbsp;The&nbsp;lookupCache&nbsp;caches&nbsp;ChanOf,&nbsp;MapOf,&nbsp;and&nbsp;SliceOf&nbsp;lookups.</span><br>
<span class="lineno">1330</span><span class="keyword" id="2225811">var</span>&nbsp;<span class="ident" id="2225815">lookupCache</span>&nbsp;<span class="keyword" id="2225827">struct</span>&nbsp;<span class="op" id="2225834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2225837">sync</span><span class="op" id="2225841">.</span><span class="ident" id="2225842">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2225851">m</span>&nbsp;<span class="keyword" id="2225853">map</span><span class="op" id="2225856">[</span><span class="ident" id="2225857">cacheKey</span><span class="op" id="2225865">]</span><span class="op" id="2225866">*</span><span class="ident" id="2225867">rtype</span><br>
<span class="lineno"></span><span class="op" id="2225873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="comment" id="2225876">//&nbsp;A&nbsp;cacheKey&nbsp;is&nbsp;the&nbsp;key&nbsp;for&nbsp;use&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2225929">//&nbsp;Four&nbsp;values&nbsp;describe&nbsp;any&nbsp;of&nbsp;the&nbsp;types&nbsp;we&nbsp;are&nbsp;looking&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="2225990">//&nbsp;type&nbsp;kind,&nbsp;one&nbsp;or&nbsp;two&nbsp;subtypes,&nbsp;and&nbsp;an&nbsp;extra&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="2226047">type</span>&nbsp;<span class="ident" id="2226052">cacheKey</span>&nbsp;<span class="keyword" id="2226061">struct</span>&nbsp;<span class="op" id="2226068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226071">kind</span>&nbsp;&nbsp;<span class="ident" id="2226077">Kind</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226083">t1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2226089">*</span><span class="ident" id="2226090">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226097">t2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2226103">*</span><span class="ident" id="2226104">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226111">extra</span>&nbsp;<span class="builtintype" id="2226117">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2226125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1345</span><span class="comment" id="2226128">//&nbsp;cacheGet&nbsp;looks&nbsp;for&nbsp;a&nbsp;type&nbsp;under&nbsp;the&nbsp;key&nbsp;k&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2226193">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;one,&nbsp;it&nbsp;returns&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2226235">//&nbsp;If&nbsp;not,&nbsp;it&nbsp;returns&nbsp;nil&nbsp;with&nbsp;the&nbsp;cache&nbsp;locked.</span><br>
<span class="lineno"></span><span class="comment" id="2226284">//&nbsp;The&nbsp;caller&nbsp;is&nbsp;expected&nbsp;to&nbsp;use&nbsp;cachePut&nbsp;to&nbsp;unlock&nbsp;the&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="2226347">func</span>&nbsp;<span class="ident" id="2226352">cacheGet</span><span class="op" id="2226360">(</span><span class="ident" id="2226361">k</span>&nbsp;<span class="ident" id="2226363">cacheKey</span><span class="op" id="2226371">)</span>&nbsp;<span class="ident" id="2226373">Type</span>&nbsp;<span class="op" id="2226378">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226381">lookupCache</span><span class="op" id="2226392">.</span><span class="ident" id="2226393">RLock</span><span class="op" id="2226398">(</span><span class="op" id="2226399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226402">t</span>&nbsp;<span class="op" id="2226404">:=</span>&nbsp;<span class="ident" id="2226407">lookupCache</span><span class="op" id="2226418">.</span><span class="ident" id="2226419">m</span><span class="op" id="2226420">[</span><span class="ident" id="2226421">k</span><span class="op" id="2226422">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226425">lookupCache</span><span class="op" id="2226436">.</span><span class="ident" id="2226437">RUnlock</span><span class="op" id="2226444">(</span><span class="op" id="2226445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226448">if</span>&nbsp;<span class="ident" id="2226451">t</span>&nbsp;<span class="op" id="2226453">!=</span>&nbsp;<span class="ident" id="2226456">nil</span>&nbsp;<span class="op" id="2226460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226464">return</span>&nbsp;<span class="ident" id="2226471">t</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2226474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226478">lookupCache</span><span class="op" id="2226489">.</span><span class="ident" id="2226490">Lock</span><span class="op" id="2226494">(</span><span class="op" id="2226495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226498">t</span>&nbsp;<span class="op" id="2226500">=</span>&nbsp;<span class="ident" id="2226502">lookupCache</span><span class="op" id="2226513">.</span><span class="ident" id="2226514">m</span><span class="op" id="2226515">[</span><span class="ident" id="2226516">k</span><span class="op" id="2226517">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226520">if</span>&nbsp;<span class="ident" id="2226523">t</span>&nbsp;<span class="op" id="2226525">!=</span>&nbsp;<span class="ident" id="2226528">nil</span>&nbsp;<span class="op" id="2226532">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226536">lookupCache</span><span class="op" id="2226547">.</span><span class="ident" id="2226548">Unlock</span><span class="op" id="2226554">(</span><span class="op" id="2226555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226559">return</span>&nbsp;<span class="ident" id="2226566">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2226569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226573">if</span>&nbsp;<span class="ident" id="2226576">lookupCache</span><span class="op" id="2226587">.</span><span class="ident" id="2226588">m</span>&nbsp;<span class="op" id="2226590">==</span>&nbsp;<span class="ident" id="2226593">nil</span>&nbsp;<span class="op" id="2226597">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226601">lookupCache</span><span class="op" id="2226612">.</span><span class="ident" id="2226613">m</span>&nbsp;<span class="op" id="2226615">=</span>&nbsp;<span class="builtinfunc" id="2226617">make</span><span class="op" id="2226621">(</span><span class="keyword" id="2226622">map</span><span class="op" id="2226625">[</span><span class="ident" id="2226626">cacheKey</span><span class="op" id="2226634">]</span><span class="op" id="2226635">*</span><span class="ident" id="2226636">rtype</span><span class="op" id="2226641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2226644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226648">return</span>&nbsp;<span class="ident" id="2226655">nil</span><br>
<span class="lineno"></span><span class="op" id="2226659">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="2226662">//&nbsp;cachePut&nbsp;stores&nbsp;the&nbsp;given&nbsp;type&nbsp;in&nbsp;the&nbsp;cache,&nbsp;unlocks&nbsp;the&nbsp;cache,</span><br>
<span class="lineno"></span><span class="comment" id="2226729">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type.&nbsp;It&nbsp;is&nbsp;expected&nbsp;that&nbsp;the&nbsp;cache&nbsp;is&nbsp;locked</span><br>
<span class="lineno"></span><span class="comment" id="2226794">//&nbsp;because&nbsp;cacheGet&nbsp;returned&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2226828">func</span>&nbsp;<span class="ident" id="2226833">cachePut</span><span class="op" id="2226841">(</span><span class="ident" id="2226842">k</span>&nbsp;<span class="ident" id="2226844">cacheKey</span><span class="op" id="2226852">,</span>&nbsp;<span class="ident" id="2226854">t</span>&nbsp;<span class="op" id="2226856">*</span><span class="ident" id="2226857">rtype</span><span class="op" id="2226862">)</span>&nbsp;<span class="ident" id="2226864">Type</span>&nbsp;<span class="op" id="2226869">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226872">lookupCache</span><span class="op" id="2226883">.</span><span class="ident" id="2226884">m</span><span class="op" id="2226885">[</span><span class="ident" id="2226886">k</span><span class="op" id="2226887">]</span>&nbsp;<span class="op" id="2226889">=</span>&nbsp;<span class="ident" id="2226891">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2226894">lookupCache</span><span class="op" id="2226905">.</span><span class="ident" id="2226906">Unlock</span><span class="op" id="2226912">(</span><span class="op" id="2226913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2226916">return</span>&nbsp;<span class="ident" id="2226923">t</span><br>
<span class="lineno"></span><span class="op" id="2226925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span><span class="comment" id="2226928">//&nbsp;ChanOf&nbsp;returns&nbsp;the&nbsp;channel&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;direction&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2227006">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ChanOf(RecvDir,&nbsp;t)&nbsp;represents&nbsp;&lt;-chan&nbsp;int.</span><br>
<span class="lineno"></span><span class="comment" id="2227085">//</span><br>
<span class="lineno"></span><span class="comment" id="2227088">//&nbsp;The&nbsp;gc&nbsp;runtime&nbsp;imposes&nbsp;a&nbsp;limit&nbsp;of&nbsp;64&nbsp;kB&nbsp;on&nbsp;channel&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2227157">//&nbsp;If&nbsp;t&#39;s&nbsp;size&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;exceeds&nbsp;this&nbsp;limit,&nbsp;ChanOf&nbsp;panics.</span><br>
<span class="lineno">1385</span><span class="keyword" id="2227222">func</span>&nbsp;<span class="ident" id="2227227">ChanOf</span><span class="op" id="2227233">(</span><span class="ident" id="2227234">dir</span>&nbsp;<span class="ident" id="2227238">ChanDir</span><span class="op" id="2227245">,</span>&nbsp;<span class="ident" id="2227247">t</span>&nbsp;<span class="ident" id="2227249">Type</span><span class="op" id="2227253">)</span>&nbsp;<span class="ident" id="2227255">Type</span>&nbsp;<span class="op" id="2227260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227263">typ</span>&nbsp;<span class="op" id="2227267">:=</span>&nbsp;<span class="ident" id="2227270">t</span><span class="op" id="2227271">.</span><span class="op" id="2227272">(</span><span class="op" id="2227273">*</span><span class="ident" id="2227274">rtype</span><span class="op" id="2227279">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2227283">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227302">ckey</span>&nbsp;<span class="op" id="2227307">:=</span>&nbsp;<span class="ident" id="2227310">cacheKey</span><span class="op" id="2227318">{</span><span class="ident" id="2227319">Chan</span><span class="op" id="2227323">,</span>&nbsp;<span class="ident" id="2227325">typ</span><span class="op" id="2227328">,</span>&nbsp;<span class="ident" id="2227330">nil</span><span class="op" id="2227333">,</span>&nbsp;<span class="builtintype" id="2227335">uintptr</span><span class="op" id="2227342">(</span><span class="ident" id="2227343">dir</span><span class="op" id="2227346">)</span><span class="op" id="2227347">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227350">if</span>&nbsp;<span class="ident" id="2227353">ch</span>&nbsp;<span class="op" id="2227356">:=</span>&nbsp;<span class="ident" id="2227359">cacheGet</span><span class="op" id="2227367">(</span><span class="ident" id="2227368">ckey</span><span class="op" id="2227372">)</span><span class="op" id="2227373">;</span>&nbsp;<span class="ident" id="2227375">ch</span>&nbsp;<span class="op" id="2227378">!=</span>&nbsp;<span class="ident" id="2227381">nil</span>&nbsp;<span class="op" id="2227385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227389">return</span>&nbsp;<span class="ident" id="2227396">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2227400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2227404">//&nbsp;This&nbsp;restriction&nbsp;is&nbsp;imposed&nbsp;by&nbsp;the&nbsp;gc&nbsp;compiler&nbsp;and&nbsp;the&nbsp;runtime.</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227472">if</span>&nbsp;<span class="ident" id="2227475">typ</span><span class="op" id="2227478">.</span><span class="ident" id="2227479">size</span>&nbsp;<span class="op" id="2227484">&gt;=</span>&nbsp;<span class="num" id="2227487">1</span><span class="op" id="2227488">&lt;&lt;</span><span class="num" id="2227490">16</span>&nbsp;<span class="op" id="2227493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227497">lookupCache</span><span class="op" id="2227508">.</span><span class="ident" id="2227509">Unlock</span><span class="op" id="2227515">(</span><span class="op" id="2227516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2227520">panic</span><span class="op" id="2227525">(</span><span class="string" id="2227526">&#34;reflect.ChanOf:&nbsp;element&nbsp;size&nbsp;too&nbsp;large&#34;</span><span class="op" id="2227566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2227569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2227573">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2227598">//&nbsp;TODO:&nbsp;Precedence&nbsp;when&nbsp;constructing&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227645">var</span>&nbsp;<span class="ident" id="2227649">s</span>&nbsp;<span class="builtintype" id="2227651">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227659">switch</span>&nbsp;<span class="ident" id="2227666">dir</span>&nbsp;<span class="op" id="2227670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227673">default</span><span class="op" id="2227680">:</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227684">lookupCache</span><span class="op" id="2227695">.</span><span class="ident" id="2227696">Unlock</span><span class="op" id="2227702">(</span><span class="op" id="2227703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2227707">panic</span><span class="op" id="2227712">(</span><span class="string" id="2227713">&#34;reflect.ChanOf:&nbsp;invalid&nbsp;dir&#34;</span><span class="op" id="2227742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227745">case</span>&nbsp;<span class="ident" id="2227750">SendDir</span><span class="op" id="2227757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227761">s</span>&nbsp;<span class="op" id="2227763">=</span>&nbsp;<span class="string" id="2227765">&#34;chan&lt;-&nbsp;&#34;</span>&nbsp;<span class="op" id="2227775">+</span>&nbsp;<span class="op" id="2227777">*</span><span class="ident" id="2227778">typ</span><span class="op" id="2227781">.</span><span class="builtintype" id="2227782">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227790">case</span>&nbsp;<span class="ident" id="2227795">RecvDir</span><span class="op" id="2227802">:</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227806">s</span>&nbsp;<span class="op" id="2227808">=</span>&nbsp;<span class="string" id="2227810">&#34;&lt;-chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2227820">+</span>&nbsp;<span class="op" id="2227822">*</span><span class="ident" id="2227823">typ</span><span class="op" id="2227826">.</span><span class="builtintype" id="2227827">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227835">case</span>&nbsp;<span class="ident" id="2227840">BothDir</span><span class="op" id="2227847">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227851">s</span>&nbsp;<span class="op" id="2227853">=</span>&nbsp;<span class="string" id="2227855">&#34;chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2227863">+</span>&nbsp;<span class="op" id="2227865">*</span><span class="ident" id="2227866">typ</span><span class="op" id="2227869">.</span><span class="builtintype" id="2227870">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2227878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227881">for</span>&nbsp;<span class="ident" id="2227885">_</span><span class="op" id="2227886">,</span>&nbsp;<span class="ident" id="2227888">tt</span>&nbsp;<span class="op" id="2227891">:=</span>&nbsp;<span class="keyword" id="2227894">range</span>&nbsp;<span class="ident" id="2227900">typesByString</span><span class="op" id="2227913">(</span><span class="ident" id="2227914">s</span><span class="op" id="2227915">)</span>&nbsp;<span class="op" id="2227917">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2227921">ch</span>&nbsp;<span class="op" id="2227924">:=</span>&nbsp;<span class="op" id="2227927">(</span><span class="op" id="2227928">*</span><span class="ident" id="2227929">chanType</span><span class="op" id="2227937">)</span><span class="op" id="2227938">(</span><span class="ident" id="2227939">unsafe</span><span class="op" id="2227945">.</span><span class="ident" id="2227946">Pointer</span><span class="op" id="2227953">(</span><span class="ident" id="2227954">tt</span><span class="op" id="2227956">)</span><span class="op" id="2227957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2227961">if</span>&nbsp;<span class="ident" id="2227964">ch</span><span class="op" id="2227966">.</span><span class="ident" id="2227967">elem</span>&nbsp;<span class="op" id="2227972">==</span>&nbsp;<span class="ident" id="2227975">typ</span>&nbsp;<span class="op" id="2227979">&amp;&amp;</span>&nbsp;<span class="ident" id="2227982">ch</span><span class="op" id="2227984">.</span><span class="ident" id="2227985">dir</span>&nbsp;<span class="op" id="2227989">==</span>&nbsp;<span class="builtintype" id="2227992">uintptr</span><span class="op" id="2227999">(</span><span class="ident" id="2228000">dir</span><span class="op" id="2228003">)</span>&nbsp;<span class="op" id="2228005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2228010">return</span>&nbsp;<span class="ident" id="2228017">cachePut</span><span class="op" id="2228025">(</span><span class="ident" id="2228026">ckey</span><span class="op" id="2228030">,</span>&nbsp;<span class="ident" id="2228032">tt</span><span class="op" id="2228034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2228038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2228041">}</span><br>
<span class="lineno">1420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228045">//&nbsp;Make&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2228070">var</span>&nbsp;<span class="ident" id="2228074">ichan</span>&nbsp;<span class="keyword" id="2228080">interface</span><span class="op" id="2228089">{</span><span class="op" id="2228090">}</span>&nbsp;<span class="op" id="2228092">=</span>&nbsp;<span class="op" id="2228094">(</span><span class="keyword" id="2228095">chan</span>&nbsp;<span class="ident" id="2228100">unsafe</span><span class="op" id="2228106">.</span><span class="ident" id="2228107">Pointer</span><span class="op" id="2228114">)</span><span class="op" id="2228115">(</span><span class="ident" id="2228116">nil</span><span class="op" id="2228119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2228122">prototype</span>&nbsp;<span class="op" id="2228132">:=</span>&nbsp;<span class="op" id="2228135">*</span><span class="op" id="2228136">(</span><span class="op" id="2228137">*</span><span class="op" id="2228138">*</span><span class="ident" id="2228139">chanType</span><span class="op" id="2228147">)</span><span class="op" id="2228148">(</span><span class="ident" id="2228149">unsafe</span><span class="op" id="2228155">.</span><span class="ident" id="2228156">Pointer</span><span class="op" id="2228163">(</span><span class="op" id="2228164">&amp;</span><span class="ident" id="2228165">ichan</span><span class="op" id="2228170">)</span><span class="op" id="2228171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2228174">ch</span>&nbsp;<span class="op" id="2228177">:=</span>&nbsp;<span class="builtinfunc" id="2228180">new</span><span class="op" id="2228183">(</span><span class="ident" id="2228184">chanType</span><span class="op" id="2228192">)</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2228195">*</span><span class="ident" id="2228196">ch</span>&nbsp;<span class="op" id="2228199">=</span>&nbsp;<span class="op" id="2228201">*</span><span class="ident" id="2228202">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2228213">ch</span><span class="op" id="2228215">.</span><span class="builtintype" id="2228216">string</span>&nbsp;<span class="op" id="2228223">=</span>&nbsp;<span class="op" id="2228225">&amp;</span><span class="ident" id="2228226">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2228229">ch</span><span class="op" id="2228231">.</span><span class="ident" id="2228232">hash</span>&nbsp;<span class="op" id="2228237">=</span>&nbsp;<span class="ident" id="2228239">fnv1</span><span class="op" id="2228243">(</span><span class="ident" id="2228244">typ</span><span class="op" id="2228247">.</span><span class="ident" id="2228248">hash</span><span class="op" id="2228252">,</span>&nbsp;<span class="string" id="2228254">&#39;c&#39;</span><span class="op" id="2228257">,</span>&nbsp;<span class="builtintype" id="2228259">byte</span><span class="op" id="2228263">(</span><span class="ident" id="2228264">dir</span><span class="op" id="2228267">)</span><span class="op" id="2228268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2228271">ch</span><span class="op" id="2228273">.</span><span class="ident" id="2228274">elem</span>&nbsp;<span class="op" id="2228279">=</span>&nbsp;<span class="ident" id="2228281">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2228286">ch</span><span class="op" id="2228288">.</span><span class="ident" id="2228289">uncommonType</span>&nbsp;<span class="op" id="2228302">=</span>&nbsp;<span class="ident" id="2228304">nil</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2228309">ch</span><span class="op" id="2228311">.</span><span class="ident" id="2228312">ptrToThis</span>&nbsp;<span class="op" id="2228322">=</span>&nbsp;<span class="ident" id="2228324">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2228329">ch</span><span class="op" id="2228331">.</span><span class="ident" id="2228332">zero</span>&nbsp;<span class="op" id="2228337">=</span>&nbsp;<span class="ident" id="2228339">unsafe</span><span class="op" id="2228345">.</span><span class="ident" id="2228346">Pointer</span><span class="op" id="2228353">(</span><span class="op" id="2228354">&amp;</span><span class="builtinfunc" id="2228355">make</span><span class="op" id="2228359">(</span><span class="op" id="2228360">[</span><span class="op" id="2228361">]</span><span class="builtintype" id="2228362">byte</span><span class="op" id="2228366">,</span>&nbsp;<span class="ident" id="2228368">ch</span><span class="op" id="2228370">.</span><span class="ident" id="2228371">size</span><span class="op" id="2228375">)</span><span class="op" id="2228376">[</span><span class="num" id="2228377">0</span><span class="op" id="2228378">]</span><span class="op" id="2228379">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2228383">return</span>&nbsp;<span class="ident" id="2228390">cachePut</span><span class="op" id="2228398">(</span><span class="ident" id="2228399">ckey</span><span class="op" id="2228403">,</span>&nbsp;<span class="op" id="2228405">&amp;</span><span class="ident" id="2228406">ch</span><span class="op" id="2228408">.</span><span class="ident" id="2228409">rtype</span><span class="op" id="2228414">)</span><br>
<span class="lineno"></span><span class="op" id="2228416">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="keyword" id="2228419">func</span>&nbsp;<span class="ident" id="2228424">ismapkey</span><span class="op" id="2228432">(</span><span class="op" id="2228433">*</span><span class="ident" id="2228434">rtype</span><span class="op" id="2228439">)</span>&nbsp;<span class="builtintype" id="2228441">bool</span>&nbsp;<span class="comment" id="2228446">//&nbsp;implemented&nbsp;in&nbsp;runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2228473">//&nbsp;MapOf&nbsp;returns&nbsp;the&nbsp;map&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;key&nbsp;and&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2228541">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;k&nbsp;represents&nbsp;int&nbsp;and&nbsp;e&nbsp;represents&nbsp;string,</span><br>
<span class="lineno">1440</span><span class="comment" id="2228602">//&nbsp;MapOf(k,&nbsp;e)&nbsp;represents&nbsp;map[int]string.</span><br>
<span class="lineno"></span><span class="comment" id="2228644">//</span><br>
<span class="lineno"></span><span class="comment" id="2228647">//&nbsp;If&nbsp;the&nbsp;key&nbsp;type&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;map&nbsp;key&nbsp;type&nbsp;(that&nbsp;is,&nbsp;if&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2228715">//&nbsp;not&nbsp;implement&nbsp;Go&#39;s&nbsp;==&nbsp;operator),&nbsp;MapOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="keyword" id="2228765">func</span>&nbsp;<span class="ident" id="2228770">MapOf</span><span class="op" id="2228775">(</span><span class="ident" id="2228776">key</span><span class="op" id="2228779">,</span>&nbsp;<span class="ident" id="2228781">elem</span>&nbsp;<span class="ident" id="2228786">Type</span><span class="op" id="2228790">)</span>&nbsp;<span class="ident" id="2228792">Type</span>&nbsp;<span class="op" id="2228797">{</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2228800">ktyp</span>&nbsp;<span class="op" id="2228805">:=</span>&nbsp;<span class="ident" id="2228808">key</span><span class="op" id="2228811">.</span><span class="op" id="2228812">(</span><span class="op" id="2228813">*</span><span class="ident" id="2228814">rtype</span><span class="op" id="2228819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2228822">etyp</span>&nbsp;<span class="op" id="2228827">:=</span>&nbsp;<span class="ident" id="2228830">elem</span><span class="op" id="2228834">.</span><span class="op" id="2228835">(</span><span class="op" id="2228836">*</span><span class="ident" id="2228837">rtype</span><span class="op" id="2228842">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2228846">if</span>&nbsp;<span class="op" id="2228849">!</span><span class="ident" id="2228850">ismapkey</span><span class="op" id="2228858">(</span><span class="ident" id="2228859">ktyp</span><span class="op" id="2228863">)</span>&nbsp;<span class="op" id="2228865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2228869">panic</span><span class="op" id="2228874">(</span><span class="string" id="2228875">&#34;reflect.MapOf:&nbsp;invalid&nbsp;key&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="2228910">+</span>&nbsp;<span class="ident" id="2228912">ktyp</span><span class="op" id="2228916">.</span><span class="ident" id="2228917">String</span><span class="op" id="2228923">(</span><span class="op" id="2228924">)</span><span class="op" id="2228925">)</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2228928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2228932">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2228951">ckey</span>&nbsp;<span class="op" id="2228956">:=</span>&nbsp;<span class="ident" id="2228959">cacheKey</span><span class="op" id="2228967">{</span><span class="ident" id="2228968">Map</span><span class="op" id="2228971">,</span>&nbsp;<span class="ident" id="2228973">ktyp</span><span class="op" id="2228977">,</span>&nbsp;<span class="ident" id="2228979">etyp</span><span class="op" id="2228983">,</span>&nbsp;<span class="num" id="2228985">0</span><span class="op" id="2228986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2228989">if</span>&nbsp;<span class="ident" id="2228992">mt</span>&nbsp;<span class="op" id="2228995">:=</span>&nbsp;<span class="ident" id="2228998">cacheGet</span><span class="op" id="2229006">(</span><span class="ident" id="2229007">ckey</span><span class="op" id="2229011">)</span><span class="op" id="2229012">;</span>&nbsp;<span class="ident" id="2229014">mt</span>&nbsp;<span class="op" id="2229017">!=</span>&nbsp;<span class="ident" id="2229020">nil</span>&nbsp;<span class="op" id="2229024">{</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229028">return</span>&nbsp;<span class="ident" id="2229035">mt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229043">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229068">s</span>&nbsp;<span class="op" id="2229070">:=</span>&nbsp;<span class="string" id="2229073">&#34;map[&#34;</span>&nbsp;<span class="op" id="2229080">+</span>&nbsp;<span class="op" id="2229082">*</span><span class="ident" id="2229083">ktyp</span><span class="op" id="2229087">.</span><span class="builtintype" id="2229088">string</span>&nbsp;<span class="op" id="2229095">+</span>&nbsp;<span class="string" id="2229097">&#34;]&#34;</span>&nbsp;<span class="op" id="2229101">+</span>&nbsp;<span class="op" id="2229103">*</span><span class="ident" id="2229104">etyp</span><span class="op" id="2229108">.</span><span class="builtintype" id="2229109">string</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229117">for</span>&nbsp;<span class="ident" id="2229121">_</span><span class="op" id="2229122">,</span>&nbsp;<span class="ident" id="2229124">tt</span>&nbsp;<span class="op" id="2229127">:=</span>&nbsp;<span class="keyword" id="2229130">range</span>&nbsp;<span class="ident" id="2229136">typesByString</span><span class="op" id="2229149">(</span><span class="ident" id="2229150">s</span><span class="op" id="2229151">)</span>&nbsp;<span class="op" id="2229153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229157">mt</span>&nbsp;<span class="op" id="2229160">:=</span>&nbsp;<span class="op" id="2229163">(</span><span class="op" id="2229164">*</span><span class="ident" id="2229165">mapType</span><span class="op" id="2229172">)</span><span class="op" id="2229173">(</span><span class="ident" id="2229174">unsafe</span><span class="op" id="2229180">.</span><span class="ident" id="2229181">Pointer</span><span class="op" id="2229188">(</span><span class="ident" id="2229189">tt</span><span class="op" id="2229191">)</span><span class="op" id="2229192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229196">if</span>&nbsp;<span class="ident" id="2229199">mt</span><span class="op" id="2229201">.</span><span class="ident" id="2229202">key</span>&nbsp;<span class="op" id="2229206">==</span>&nbsp;<span class="ident" id="2229209">ktyp</span>&nbsp;<span class="op" id="2229214">&amp;&amp;</span>&nbsp;<span class="ident" id="2229217">mt</span><span class="op" id="2229219">.</span><span class="ident" id="2229220">elem</span>&nbsp;<span class="op" id="2229225">==</span>&nbsp;<span class="ident" id="2229228">etyp</span>&nbsp;<span class="op" id="2229233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229238">return</span>&nbsp;<span class="ident" id="2229245">cachePut</span><span class="op" id="2229253">(</span><span class="ident" id="2229254">ckey</span><span class="op" id="2229258">,</span>&nbsp;<span class="ident" id="2229260">tt</span><span class="op" id="2229262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229266">}</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2229273">//&nbsp;Make&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229294">var</span>&nbsp;<span class="ident" id="2229298">imap</span>&nbsp;<span class="keyword" id="2229303">interface</span><span class="op" id="2229312">{</span><span class="op" id="2229313">}</span>&nbsp;<span class="op" id="2229315">=</span>&nbsp;<span class="op" id="2229317">(</span><span class="keyword" id="2229318">map</span><span class="op" id="2229321">[</span><span class="ident" id="2229322">unsafe</span><span class="op" id="2229328">.</span><span class="ident" id="2229329">Pointer</span><span class="op" id="2229336">]</span><span class="ident" id="2229337">unsafe</span><span class="op" id="2229343">.</span><span class="ident" id="2229344">Pointer</span><span class="op" id="2229351">)</span><span class="op" id="2229352">(</span><span class="ident" id="2229353">nil</span><span class="op" id="2229356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229359">prototype</span>&nbsp;<span class="op" id="2229369">:=</span>&nbsp;<span class="op" id="2229372">*</span><span class="op" id="2229373">(</span><span class="op" id="2229374">*</span><span class="op" id="2229375">*</span><span class="ident" id="2229376">mapType</span><span class="op" id="2229383">)</span><span class="op" id="2229384">(</span><span class="ident" id="2229385">unsafe</span><span class="op" id="2229391">.</span><span class="ident" id="2229392">Pointer</span><span class="op" id="2229399">(</span><span class="op" id="2229400">&amp;</span><span class="ident" id="2229401">imap</span><span class="op" id="2229405">)</span><span class="op" id="2229406">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229409">mt</span>&nbsp;<span class="op" id="2229412">:=</span>&nbsp;<span class="builtinfunc" id="2229415">new</span><span class="op" id="2229418">(</span><span class="ident" id="2229419">mapType</span><span class="op" id="2229426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229429">*</span><span class="ident" id="2229430">mt</span>&nbsp;<span class="op" id="2229433">=</span>&nbsp;<span class="op" id="2229435">*</span><span class="ident" id="2229436">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229447">mt</span><span class="op" id="2229449">.</span><span class="builtintype" id="2229450">string</span>&nbsp;<span class="op" id="2229457">=</span>&nbsp;<span class="op" id="2229459">&amp;</span><span class="ident" id="2229460">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229463">mt</span><span class="op" id="2229465">.</span><span class="ident" id="2229466">hash</span>&nbsp;<span class="op" id="2229471">=</span>&nbsp;<span class="ident" id="2229473">fnv1</span><span class="op" id="2229477">(</span><span class="ident" id="2229478">etyp</span><span class="op" id="2229482">.</span><span class="ident" id="2229483">hash</span><span class="op" id="2229487">,</span>&nbsp;<span class="string" id="2229489">&#39;m&#39;</span><span class="op" id="2229492">,</span>&nbsp;<span class="builtintype" id="2229494">byte</span><span class="op" id="2229498">(</span><span class="ident" id="2229499">ktyp</span><span class="op" id="2229503">.</span><span class="ident" id="2229504">hash</span><span class="op" id="2229508">&gt;&gt;</span><span class="num" id="2229510">24</span><span class="op" id="2229512">)</span><span class="op" id="2229513">,</span>&nbsp;<span class="builtintype" id="2229515">byte</span><span class="op" id="2229519">(</span><span class="ident" id="2229520">ktyp</span><span class="op" id="2229524">.</span><span class="ident" id="2229525">hash</span><span class="op" id="2229529">&gt;&gt;</span><span class="num" id="2229531">16</span><span class="op" id="2229533">)</span><span class="op" id="2229534">,</span>&nbsp;<span class="builtintype" id="2229536">byte</span><span class="op" id="2229540">(</span><span class="ident" id="2229541">ktyp</span><span class="op" id="2229545">.</span><span class="ident" id="2229546">hash</span><span class="op" id="2229550">&gt;&gt;</span><span class="num" id="2229552">8</span><span class="op" id="2229553">)</span><span class="op" id="2229554">,</span>&nbsp;<span class="builtintype" id="2229556">byte</span><span class="op" id="2229560">(</span><span class="ident" id="2229561">ktyp</span><span class="op" id="2229565">.</span><span class="ident" id="2229566">hash</span><span class="op" id="2229570">)</span><span class="op" id="2229571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229574">mt</span><span class="op" id="2229576">.</span><span class="ident" id="2229577">key</span>&nbsp;<span class="op" id="2229581">=</span>&nbsp;<span class="ident" id="2229583">ktyp</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229589">mt</span><span class="op" id="2229591">.</span><span class="ident" id="2229592">elem</span>&nbsp;<span class="op" id="2229597">=</span>&nbsp;<span class="ident" id="2229599">etyp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229605">mt</span><span class="op" id="2229607">.</span><span class="ident" id="2229608">bucket</span>&nbsp;<span class="op" id="2229615">=</span>&nbsp;<span class="ident" id="2229617">bucketOf</span><span class="op" id="2229625">(</span><span class="ident" id="2229626">ktyp</span><span class="op" id="2229630">,</span>&nbsp;<span class="ident" id="2229632">etyp</span><span class="op" id="2229636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229639">if</span>&nbsp;<span class="ident" id="2229642">ktyp</span><span class="op" id="2229646">.</span><span class="ident" id="2229647">size</span>&nbsp;<span class="op" id="2229652">&gt;</span>&nbsp;<span class="ident" id="2229654">maxKeySize</span>&nbsp;<span class="op" id="2229665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229669">mt</span><span class="op" id="2229671">.</span><span class="ident" id="2229672">keysize</span>&nbsp;<span class="op" id="2229680">=</span>&nbsp;<span class="builtintype" id="2229682">uint8</span><span class="op" id="2229687">(</span><span class="ident" id="2229688">ptrSize</span><span class="op" id="2229695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229699">mt</span><span class="op" id="2229701">.</span><span class="ident" id="2229702">indirectkey</span>&nbsp;<span class="op" id="2229714">=</span>&nbsp;<span class="num" id="2229716">1</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229719">}</span>&nbsp;<span class="keyword" id="2229721">else</span>&nbsp;<span class="op" id="2229726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229730">mt</span><span class="op" id="2229732">.</span><span class="ident" id="2229733">keysize</span>&nbsp;<span class="op" id="2229741">=</span>&nbsp;<span class="builtintype" id="2229743">uint8</span><span class="op" id="2229748">(</span><span class="ident" id="2229749">ktyp</span><span class="op" id="2229753">.</span><span class="ident" id="2229754">size</span><span class="op" id="2229758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229762">mt</span><span class="op" id="2229764">.</span><span class="ident" id="2229765">indirectkey</span>&nbsp;<span class="op" id="2229777">=</span>&nbsp;<span class="num" id="2229779">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2229785">if</span>&nbsp;<span class="ident" id="2229788">etyp</span><span class="op" id="2229792">.</span><span class="ident" id="2229793">size</span>&nbsp;<span class="op" id="2229798">&gt;</span>&nbsp;<span class="ident" id="2229800">maxValSize</span>&nbsp;<span class="op" id="2229811">{</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229815">mt</span><span class="op" id="2229817">.</span><span class="ident" id="2229818">valuesize</span>&nbsp;<span class="op" id="2229828">=</span>&nbsp;<span class="builtintype" id="2229830">uint8</span><span class="op" id="2229835">(</span><span class="ident" id="2229836">ptrSize</span><span class="op" id="2229843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229847">mt</span><span class="op" id="2229849">.</span><span class="ident" id="2229850">indirectvalue</span>&nbsp;<span class="op" id="2229864">=</span>&nbsp;<span class="num" id="2229866">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229869">}</span>&nbsp;<span class="keyword" id="2229871">else</span>&nbsp;<span class="op" id="2229876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229880">mt</span><span class="op" id="2229882">.</span><span class="ident" id="2229883">valuesize</span>&nbsp;<span class="op" id="2229893">=</span>&nbsp;<span class="builtintype" id="2229895">uint8</span><span class="op" id="2229900">(</span><span class="ident" id="2229901">etyp</span><span class="op" id="2229905">.</span><span class="ident" id="2229906">size</span><span class="op" id="2229910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229914">mt</span><span class="op" id="2229916">.</span><span class="ident" id="2229917">indirectvalue</span>&nbsp;<span class="op" id="2229931">=</span>&nbsp;<span class="num" id="2229933">0</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2229936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229939">mt</span><span class="op" id="2229941">.</span><span class="ident" id="2229942">bucketsize</span>&nbsp;<span class="op" id="2229953">=</span>&nbsp;<span class="builtintype" id="2229955">uint16</span><span class="op" id="2229961">(</span><span class="ident" id="2229962">mt</span><span class="op" id="2229964">.</span><span class="ident" id="2229965">bucket</span><span class="op" id="2229971">.</span><span class="ident" id="2229972">size</span><span class="op" id="2229976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2229979">mt</span><span class="op" id="2229981">.</span><span class="ident" id="2229982">uncommonType</span>&nbsp;<span class="op" id="2229995">=</span>&nbsp;<span class="ident" id="2229997">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230002">mt</span><span class="op" id="2230004">.</span><span class="ident" id="2230005">ptrToThis</span>&nbsp;<span class="op" id="2230015">=</span>&nbsp;<span class="ident" id="2230017">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230022">mt</span><span class="op" id="2230024">.</span><span class="ident" id="2230025">zero</span>&nbsp;<span class="op" id="2230030">=</span>&nbsp;<span class="ident" id="2230032">unsafe</span><span class="op" id="2230038">.</span><span class="ident" id="2230039">Pointer</span><span class="op" id="2230046">(</span><span class="op" id="2230047">&amp;</span><span class="builtinfunc" id="2230048">make</span><span class="op" id="2230052">(</span><span class="op" id="2230053">[</span><span class="op" id="2230054">]</span><span class="builtintype" id="2230055">byte</span><span class="op" id="2230059">,</span>&nbsp;<span class="ident" id="2230061">mt</span><span class="op" id="2230063">.</span><span class="ident" id="2230064">size</span><span class="op" id="2230068">)</span><span class="op" id="2230069">[</span><span class="num" id="2230070">0</span><span class="op" id="2230071">]</span><span class="op" id="2230072">)</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230076">return</span>&nbsp;<span class="ident" id="2230083">cachePut</span><span class="op" id="2230091">(</span><span class="ident" id="2230092">ckey</span><span class="op" id="2230096">,</span>&nbsp;<span class="op" id="2230098">&amp;</span><span class="ident" id="2230099">mt</span><span class="op" id="2230101">.</span><span class="ident" id="2230102">rtype</span><span class="op" id="2230107">)</span><br>
<span class="lineno"></span><span class="op" id="2230109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2230112">//&nbsp;gcProg&nbsp;is&nbsp;a&nbsp;helper&nbsp;type&nbsp;for&nbsp;generatation&nbsp;of&nbsp;GC&nbsp;pointer&nbsp;info.</span><br>
<span class="lineno">1500</span><span class="keyword" id="2230176">type</span>&nbsp;<span class="ident" id="2230181">gcProg</span>&nbsp;<span class="keyword" id="2230188">struct</span>&nbsp;<span class="op" id="2230195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230198">gc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2230203">[</span><span class="op" id="2230204">]</span><span class="builtintype" id="2230205">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230211">size</span>&nbsp;<span class="builtintype" id="2230216">uintptr</span>&nbsp;<span class="comment" id="2230224">//&nbsp;size&nbsp;of&nbsp;type&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><span class="op" id="2230249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1505</span><span class="keyword" id="2230252">func</span>&nbsp;<span class="op" id="2230257">(</span><span class="ident" id="2230258">gc</span>&nbsp;<span class="op" id="2230261">*</span><span class="ident" id="2230262">gcProg</span><span class="op" id="2230268">)</span>&nbsp;<span class="builtinfunc" id="2230270">append</span><span class="op" id="2230276">(</span><span class="ident" id="2230277">v</span>&nbsp;<span class="builtintype" id="2230279">byte</span><span class="op" id="2230283">)</span>&nbsp;<span class="op" id="2230285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230288">gc</span><span class="op" id="2230290">.</span><span class="ident" id="2230291">align</span><span class="op" id="2230296">(</span><span class="ident" id="2230297">unsafe</span><span class="op" id="2230303">.</span><span class="ident" id="2230304">Sizeof</span><span class="op" id="2230310">(</span><span class="builtintype" id="2230311">uintptr</span><span class="op" id="2230318">(</span><span class="num" id="2230319">0</span><span class="op" id="2230320">)</span><span class="op" id="2230321">)</span><span class="op" id="2230322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230325">gc</span><span class="op" id="2230327">.</span><span class="ident" id="2230328">appendWord</span><span class="op" id="2230338">(</span><span class="ident" id="2230339">v</span><span class="op" id="2230340">)</span><br>
<span class="lineno"></span><span class="op" id="2230342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1510</span><span class="comment" id="2230345">//&nbsp;Appends&nbsp;t&#39;s&nbsp;type&nbsp;info&nbsp;to&nbsp;the&nbsp;current&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2230394">func</span>&nbsp;<span class="op" id="2230399">(</span><span class="ident" id="2230400">gc</span>&nbsp;<span class="op" id="2230403">*</span><span class="ident" id="2230404">gcProg</span><span class="op" id="2230410">)</span>&nbsp;<span class="ident" id="2230412">appendProg</span><span class="op" id="2230422">(</span><span class="ident" id="2230423">t</span>&nbsp;<span class="op" id="2230425">*</span><span class="ident" id="2230426">rtype</span><span class="op" id="2230431">)</span>&nbsp;<span class="op" id="2230433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230436">gc</span><span class="op" id="2230438">.</span><span class="ident" id="2230439">align</span><span class="op" id="2230444">(</span><span class="builtintype" id="2230445">uintptr</span><span class="op" id="2230452">(</span><span class="ident" id="2230453">t</span><span class="op" id="2230454">.</span><span class="ident" id="2230455">align</span><span class="op" id="2230460">)</span><span class="op" id="2230461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230464">if</span>&nbsp;<span class="op" id="2230467">!</span><span class="ident" id="2230468">t</span><span class="op" id="2230469">.</span><span class="ident" id="2230470">pointers</span><span class="op" id="2230478">(</span><span class="op" id="2230479">)</span>&nbsp;<span class="op" id="2230481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230485">gc</span><span class="op" id="2230487">.</span><span class="ident" id="2230488">size</span>&nbsp;<span class="op" id="2230493">+=</span>&nbsp;<span class="ident" id="2230496">t</span><span class="op" id="2230497">.</span><span class="ident" id="2230498">size</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230505">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230516">switch</span>&nbsp;<span class="ident" id="2230523">t</span><span class="op" id="2230524">.</span><span class="ident" id="2230525">Kind</span><span class="op" id="2230529">(</span><span class="op" id="2230530">)</span>&nbsp;<span class="op" id="2230532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230535">default</span><span class="op" id="2230542">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2230546">panic</span><span class="op" id="2230551">(</span><span class="string" id="2230552">&#34;reflect:&nbsp;non-pointer&nbsp;type&nbsp;marked&nbsp;as&nbsp;having&nbsp;pointers&#34;</span><span class="op" id="2230605">)</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230608">case</span>&nbsp;<span class="ident" id="2230613">Ptr</span><span class="op" id="2230616">,</span>&nbsp;<span class="ident" id="2230618">UnsafePointer</span><span class="op" id="2230631">,</span>&nbsp;<span class="ident" id="2230633">Chan</span><span class="op" id="2230637">,</span>&nbsp;<span class="ident" id="2230639">Func</span><span class="op" id="2230643">,</span>&nbsp;<span class="ident" id="2230645">Map</span><span class="op" id="2230648">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230652">gc</span><span class="op" id="2230654">.</span><span class="ident" id="2230655">appendWord</span><span class="op" id="2230665">(</span><span class="ident" id="2230666">bitsPointer</span><span class="op" id="2230677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230680">case</span>&nbsp;<span class="ident" id="2230685">Slice</span><span class="op" id="2230690">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230694">gc</span><span class="op" id="2230696">.</span><span class="ident" id="2230697">appendWord</span><span class="op" id="2230707">(</span><span class="ident" id="2230708">bitsPointer</span><span class="op" id="2230719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230723">gc</span><span class="op" id="2230725">.</span><span class="ident" id="2230726">appendWord</span><span class="op" id="2230736">(</span><span class="ident" id="2230737">bitsScalar</span><span class="op" id="2230747">)</span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230751">gc</span><span class="op" id="2230753">.</span><span class="ident" id="2230754">appendWord</span><span class="op" id="2230764">(</span><span class="ident" id="2230765">bitsScalar</span><span class="op" id="2230775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230778">case</span>&nbsp;<span class="ident" id="2230783">String</span><span class="op" id="2230789">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230793">gc</span><span class="op" id="2230795">.</span><span class="ident" id="2230796">appendWord</span><span class="op" id="2230806">(</span><span class="ident" id="2230807">bitsPointer</span><span class="op" id="2230818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230822">gc</span><span class="op" id="2230824">.</span><span class="ident" id="2230825">appendWord</span><span class="op" id="2230835">(</span><span class="ident" id="2230836">bitsScalar</span><span class="op" id="2230846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230849">case</span>&nbsp;<span class="ident" id="2230854">Array</span><span class="op" id="2230859">:</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230863">c</span>&nbsp;<span class="op" id="2230865">:=</span>&nbsp;<span class="ident" id="2230868">t</span><span class="op" id="2230869">.</span><span class="ident" id="2230870">Len</span><span class="op" id="2230873">(</span><span class="op" id="2230874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230878">e</span>&nbsp;<span class="op" id="2230880">:=</span>&nbsp;<span class="ident" id="2230883">t</span><span class="op" id="2230884">.</span><span class="ident" id="2230885">Elem</span><span class="op" id="2230889">(</span><span class="op" id="2230890">)</span><span class="op" id="2230891">.</span><span class="ident" id="2230892">common</span><span class="op" id="2230898">(</span><span class="op" id="2230899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230903">for</span>&nbsp;<span class="ident" id="2230907">i</span>&nbsp;<span class="op" id="2230909">:=</span>&nbsp;<span class="num" id="2230912">0</span><span class="op" id="2230913">;</span>&nbsp;<span class="ident" id="2230915">i</span>&nbsp;<span class="op" id="2230917">&lt;</span>&nbsp;<span class="ident" id="2230919">c</span><span class="op" id="2230920">;</span>&nbsp;<span class="ident" id="2230922">i</span><span class="op" id="2230923">++</span>&nbsp;<span class="op" id="2230926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230931">gc</span><span class="op" id="2230933">.</span><span class="ident" id="2230934">appendProg</span><span class="op" id="2230944">(</span><span class="ident" id="2230945">e</span><span class="op" id="2230946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2230950">}</span><br>
<span class="lineno">1535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2230953">case</span>&nbsp;<span class="ident" id="2230958">Interface</span><span class="op" id="2230967">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2230971">gc</span><span class="op" id="2230973">.</span><span class="ident" id="2230974">appendWord</span><span class="op" id="2230984">(</span><span class="ident" id="2230985">bitsMultiWord</span><span class="op" id="2230998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231002">if</span>&nbsp;<span class="ident" id="2231005">t</span><span class="op" id="2231006">.</span><span class="ident" id="2231007">NumMethod</span><span class="op" id="2231016">(</span><span class="op" id="2231017">)</span>&nbsp;<span class="op" id="2231019">==</span>&nbsp;<span class="num" id="2231022">0</span>&nbsp;<span class="op" id="2231024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231029">gc</span><span class="op" id="2231031">.</span><span class="ident" id="2231032">appendWord</span><span class="op" id="2231042">(</span><span class="ident" id="2231043">bitsEface</span><span class="op" id="2231052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2231056">}</span>&nbsp;<span class="keyword" id="2231058">else</span>&nbsp;<span class="op" id="2231063">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231068">gc</span><span class="op" id="2231070">.</span><span class="ident" id="2231071">appendWord</span><span class="op" id="2231081">(</span><span class="ident" id="2231082">bitsIface</span><span class="op" id="2231091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2231095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231098">case</span>&nbsp;<span class="ident" id="2231103">Struct</span><span class="op" id="2231109">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231113">c</span>&nbsp;<span class="op" id="2231115">:=</span>&nbsp;<span class="ident" id="2231118">t</span><span class="op" id="2231119">.</span><span class="ident" id="2231120">NumField</span><span class="op" id="2231128">(</span><span class="op" id="2231129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231133">for</span>&nbsp;<span class="ident" id="2231137">i</span>&nbsp;<span class="op" id="2231139">:=</span>&nbsp;<span class="num" id="2231142">0</span><span class="op" id="2231143">;</span>&nbsp;<span class="ident" id="2231145">i</span>&nbsp;<span class="op" id="2231147">&lt;</span>&nbsp;<span class="ident" id="2231149">c</span><span class="op" id="2231150">;</span>&nbsp;<span class="ident" id="2231152">i</span><span class="op" id="2231153">++</span>&nbsp;<span class="op" id="2231156">{</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231161">gc</span><span class="op" id="2231163">.</span><span class="ident" id="2231164">appendProg</span><span class="op" id="2231174">(</span><span class="ident" id="2231175">t</span><span class="op" id="2231176">.</span><span class="ident" id="2231177">Field</span><span class="op" id="2231182">(</span><span class="ident" id="2231183">i</span><span class="op" id="2231184">)</span><span class="op" id="2231185">.</span><span class="ident" id="2231186">Type</span><span class="op" id="2231190">.</span><span class="ident" id="2231191">common</span><span class="op" id="2231197">(</span><span class="op" id="2231198">)</span><span class="op" id="2231199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2231203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231207">gc</span><span class="op" id="2231209">.</span><span class="ident" id="2231210">align</span><span class="op" id="2231215">(</span><span class="builtintype" id="2231216">uintptr</span><span class="op" id="2231223">(</span><span class="ident" id="2231224">t</span><span class="op" id="2231225">.</span><span class="ident" id="2231226">align</span><span class="op" id="2231231">)</span><span class="op" id="2231232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2231235">}</span><br>
<span class="lineno"></span><span class="op" id="2231237">}</span><br>
<span class="lineno">1550</span><br>
<span class="lineno"></span><span class="keyword" id="2231240">func</span>&nbsp;<span class="op" id="2231245">(</span><span class="ident" id="2231246">gc</span>&nbsp;<span class="op" id="2231249">*</span><span class="ident" id="2231250">gcProg</span><span class="op" id="2231256">)</span>&nbsp;<span class="ident" id="2231258">appendWord</span><span class="op" id="2231268">(</span><span class="ident" id="2231269">v</span>&nbsp;<span class="builtintype" id="2231271">byte</span><span class="op" id="2231275">)</span>&nbsp;<span class="op" id="2231277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231280">ptrsize</span>&nbsp;<span class="op" id="2231288">:=</span>&nbsp;<span class="ident" id="2231291">unsafe</span><span class="op" id="2231297">.</span><span class="ident" id="2231298">Sizeof</span><span class="op" id="2231304">(</span><span class="builtintype" id="2231305">uintptr</span><span class="op" id="2231312">(</span><span class="num" id="2231313">0</span><span class="op" id="2231314">)</span><span class="op" id="2231315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231318">if</span>&nbsp;<span class="ident" id="2231321">gc</span><span class="op" id="2231323">.</span><span class="ident" id="2231324">size</span><span class="op" id="2231328">%</span><span class="ident" id="2231329">ptrsize</span>&nbsp;<span class="op" id="2231337">!=</span>&nbsp;<span class="num" id="2231340">0</span>&nbsp;<span class="op" id="2231342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2231346">panic</span><span class="op" id="2231351">(</span><span class="string" id="2231352">&#34;reflect:&nbsp;unaligned&nbsp;GC&nbsp;program&#34;</span><span class="op" id="2231383">)</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2231386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231389">nptr</span>&nbsp;<span class="op" id="2231394">:=</span>&nbsp;<span class="ident" id="2231397">gc</span><span class="op" id="2231399">.</span><span class="ident" id="2231400">size</span>&nbsp;<span class="op" id="2231405">/</span>&nbsp;<span class="ident" id="2231407">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231416">for</span>&nbsp;<span class="builtintype" id="2231420">uintptr</span><span class="op" id="2231427">(</span><span class="builtinfunc" id="2231428">len</span><span class="op" id="2231431">(</span><span class="ident" id="2231432">gc</span><span class="op" id="2231434">.</span><span class="ident" id="2231435">gc</span><span class="op" id="2231437">)</span><span class="op" id="2231438">)</span>&nbsp;<span class="op" id="2231440">&lt;</span>&nbsp;<span class="ident" id="2231442">nptr</span><span class="op" id="2231446">/</span><span class="num" id="2231447">2</span><span class="op" id="2231448">+</span><span class="num" id="2231449">1</span>&nbsp;<span class="op" id="2231451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231455">gc</span><span class="op" id="2231457">.</span><span class="ident" id="2231458">gc</span>&nbsp;<span class="op" id="2231461">=</span>&nbsp;<span class="builtinfunc" id="2231463">append</span><span class="op" id="2231469">(</span><span class="ident" id="2231470">gc</span><span class="op" id="2231472">.</span><span class="ident" id="2231473">gc</span><span class="op" id="2231475">,</span>&nbsp;<span class="num" id="2231477">0x44</span><span class="op" id="2231481">)</span>&nbsp;<span class="comment" id="2231483">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2231498">}</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231501">gc</span><span class="op" id="2231503">.</span><span class="ident" id="2231504">gc</span><span class="op" id="2231506">[</span><span class="ident" id="2231507">nptr</span><span class="op" id="2231511">/</span><span class="num" id="2231512">2</span><span class="op" id="2231513">]</span>&nbsp;<span class="op" id="2231515">&amp;=</span>&nbsp;<span class="op" id="2231518">^</span><span class="op" id="2231519">(</span><span class="num" id="2231520">3</span>&nbsp;<span class="op" id="2231522">&lt;&lt;</span>&nbsp;<span class="op" id="2231525">(</span><span class="op" id="2231526">(</span><span class="ident" id="2231527">nptr</span><span class="op" id="2231531">%</span><span class="num" id="2231532">2</span><span class="op" id="2231533">)</span><span class="op" id="2231534">*</span><span class="num" id="2231535">4</span>&nbsp;<span class="op" id="2231537">+</span>&nbsp;<span class="num" id="2231539">2</span><span class="op" id="2231540">)</span><span class="op" id="2231541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231544">gc</span><span class="op" id="2231546">.</span><span class="ident" id="2231547">gc</span><span class="op" id="2231549">[</span><span class="ident" id="2231550">nptr</span><span class="op" id="2231554">/</span><span class="num" id="2231555">2</span><span class="op" id="2231556">]</span>&nbsp;<span class="op" id="2231558">|=</span>&nbsp;<span class="ident" id="2231561">v</span>&nbsp;<span class="op" id="2231563">&lt;&lt;</span>&nbsp;<span class="op" id="2231566">(</span><span class="op" id="2231567">(</span><span class="ident" id="2231568">nptr</span><span class="op" id="2231572">%</span><span class="num" id="2231573">2</span><span class="op" id="2231574">)</span><span class="op" id="2231575">*</span><span class="num" id="2231576">4</span>&nbsp;<span class="op" id="2231578">+</span>&nbsp;<span class="num" id="2231580">2</span><span class="op" id="2231581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231584">gc</span><span class="op" id="2231586">.</span><span class="ident" id="2231587">size</span>&nbsp;<span class="op" id="2231592">+=</span>&nbsp;<span class="ident" id="2231595">ptrsize</span><br>
<span class="lineno"></span><span class="op" id="2231603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="keyword" id="2231606">func</span>&nbsp;<span class="op" id="2231611">(</span><span class="ident" id="2231612">gc</span>&nbsp;<span class="op" id="2231615">*</span><span class="ident" id="2231616">gcProg</span><span class="op" id="2231622">)</span>&nbsp;<span class="ident" id="2231624">finalize</span><span class="op" id="2231632">(</span><span class="op" id="2231633">)</span>&nbsp;<span class="ident" id="2231635">unsafe</span><span class="op" id="2231641">.</span><span class="ident" id="2231642">Pointer</span>&nbsp;<span class="op" id="2231650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231653">if</span>&nbsp;<span class="ident" id="2231656">gc</span><span class="op" id="2231658">.</span><span class="ident" id="2231659">size</span>&nbsp;<span class="op" id="2231664">==</span>&nbsp;<span class="num" id="2231667">0</span>&nbsp;<span class="op" id="2231669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231673">return</span>&nbsp;<span class="ident" id="2231680">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2231685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231688">ptrsize</span>&nbsp;<span class="op" id="2231696">:=</span>&nbsp;<span class="ident" id="2231699">unsafe</span><span class="op" id="2231705">.</span><span class="ident" id="2231706">Sizeof</span><span class="op" id="2231712">(</span><span class="builtintype" id="2231713">uintptr</span><span class="op" id="2231720">(</span><span class="num" id="2231721">0</span><span class="op" id="2231722">)</span><span class="op" id="2231723">)</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231726">gc</span><span class="op" id="2231728">.</span><span class="ident" id="2231729">align</span><span class="op" id="2231734">(</span><span class="ident" id="2231735">ptrsize</span><span class="op" id="2231742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231745">nptr</span>&nbsp;<span class="op" id="2231750">:=</span>&nbsp;<span class="ident" id="2231753">gc</span><span class="op" id="2231755">.</span><span class="ident" id="2231756">size</span>&nbsp;<span class="op" id="2231761">/</span>&nbsp;<span class="ident" id="2231763">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231772">for</span>&nbsp;<span class="builtintype" id="2231776">uintptr</span><span class="op" id="2231783">(</span><span class="builtinfunc" id="2231784">len</span><span class="op" id="2231787">(</span><span class="ident" id="2231788">gc</span><span class="op" id="2231790">.</span><span class="ident" id="2231791">gc</span><span class="op" id="2231793">)</span><span class="op" id="2231794">)</span>&nbsp;<span class="op" id="2231796">&lt;</span>&nbsp;<span class="ident" id="2231798">nptr</span><span class="op" id="2231802">/</span><span class="num" id="2231803">2</span><span class="op" id="2231804">+</span><span class="num" id="2231805">1</span>&nbsp;<span class="op" id="2231807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231811">gc</span><span class="op" id="2231813">.</span><span class="ident" id="2231814">gc</span>&nbsp;<span class="op" id="2231817">=</span>&nbsp;<span class="builtinfunc" id="2231819">append</span><span class="op" id="2231825">(</span><span class="ident" id="2231826">gc</span><span class="op" id="2231828">.</span><span class="ident" id="2231829">gc</span><span class="op" id="2231831">,</span>&nbsp;<span class="num" id="2231833">0x44</span><span class="op" id="2231837">)</span>&nbsp;<span class="comment" id="2231839">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2231854">}</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2231857">//&nbsp;If&nbsp;number&nbsp;of&nbsp;words&nbsp;is&nbsp;odd,&nbsp;repeat&nbsp;the&nbsp;mask&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2231911">//&nbsp;Compiler&nbsp;does&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231939">if</span>&nbsp;<span class="ident" id="2231942">nptr</span><span class="op" id="2231946">%</span><span class="num" id="2231947">2</span>&nbsp;<span class="op" id="2231949">!=</span>&nbsp;<span class="num" id="2231952">0</span>&nbsp;<span class="op" id="2231954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2231958">for</span>&nbsp;<span class="ident" id="2231962">i</span>&nbsp;<span class="op" id="2231964">:=</span>&nbsp;<span class="builtintype" id="2231967">uintptr</span><span class="op" id="2231974">(</span><span class="num" id="2231975">0</span><span class="op" id="2231976">)</span><span class="op" id="2231977">;</span>&nbsp;<span class="ident" id="2231979">i</span>&nbsp;<span class="op" id="2231981">&lt;</span>&nbsp;<span class="ident" id="2231983">nptr</span><span class="op" id="2231987">;</span>&nbsp;<span class="ident" id="2231989">i</span><span class="op" id="2231990">++</span>&nbsp;<span class="op" id="2231993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2231998">gc</span><span class="op" id="2232000">.</span><span class="ident" id="2232001">appendWord</span><span class="op" id="2232011">(</span><span class="ident" id="2232012">extractGCWord</span><span class="op" id="2232025">(</span><span class="ident" id="2232026">gc</span><span class="op" id="2232028">.</span><span class="ident" id="2232029">gc</span><span class="op" id="2232031">,</span>&nbsp;<span class="ident" id="2232033">i</span><span class="op" id="2232034">)</span><span class="op" id="2232035">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2232039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2232042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2232045">return</span>&nbsp;<span class="ident" id="2232052">unsafe</span><span class="op" id="2232058">.</span><span class="ident" id="2232059">Pointer</span><span class="op" id="2232066">(</span><span class="op" id="2232067">&amp;</span><span class="ident" id="2232068">gc</span><span class="op" id="2232070">.</span><span class="ident" id="2232071">gc</span><span class="op" id="2232073">[</span><span class="num" id="2232074">0</span><span class="op" id="2232075">]</span><span class="op" id="2232076">)</span><br>
<span class="lineno"></span><span class="op" id="2232078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span><span class="keyword" id="2232081">func</span>&nbsp;<span class="ident" id="2232086">extractGCWord</span><span class="op" id="2232099">(</span><span class="ident" id="2232100">gc</span>&nbsp;<span class="op" id="2232103">[</span><span class="op" id="2232104">]</span><span class="builtintype" id="2232105">byte</span><span class="op" id="2232109">,</span>&nbsp;<span class="ident" id="2232111">i</span>&nbsp;<span class="builtintype" id="2232113">uintptr</span><span class="op" id="2232120">)</span>&nbsp;<span class="builtintype" id="2232122">byte</span>&nbsp;<span class="op" id="2232127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2232130">return</span>&nbsp;<span class="op" id="2232137">(</span><span class="ident" id="2232138">gc</span><span class="op" id="2232140">[</span><span class="ident" id="2232141">i</span><span class="op" id="2232142">/</span><span class="num" id="2232143">2</span><span class="op" id="2232144">]</span>&nbsp;<span class="op" id="2232146">&gt;&gt;</span>&nbsp;<span class="op" id="2232149">(</span><span class="op" id="2232150">(</span><span class="ident" id="2232151">i</span><span class="op" id="2232152">%</span><span class="num" id="2232153">2</span><span class="op" id="2232154">)</span><span class="op" id="2232155">*</span><span class="num" id="2232156">4</span>&nbsp;<span class="op" id="2232158">+</span>&nbsp;<span class="num" id="2232160">2</span><span class="op" id="2232161">)</span><span class="op" id="2232162">)</span>&nbsp;<span class="op" id="2232164">&amp;</span>&nbsp;<span class="num" id="2232166">3</span><br>
<span class="lineno"></span><span class="op" id="2232168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2232171">func</span>&nbsp;<span class="op" id="2232176">(</span><span class="ident" id="2232177">gc</span>&nbsp;<span class="op" id="2232180">*</span><span class="ident" id="2232181">gcProg</span><span class="op" id="2232187">)</span>&nbsp;<span class="ident" id="2232189">align</span><span class="op" id="2232194">(</span><span class="ident" id="2232195">a</span>&nbsp;<span class="builtintype" id="2232197">uintptr</span><span class="op" id="2232204">)</span>&nbsp;<span class="op" id="2232206">{</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232209">gc</span><span class="op" id="2232211">.</span><span class="ident" id="2232212">size</span>&nbsp;<span class="op" id="2232217">=</span>&nbsp;<span class="ident" id="2232219">align</span><span class="op" id="2232224">(</span><span class="ident" id="2232225">gc</span><span class="op" id="2232227">.</span><span class="ident" id="2232228">size</span><span class="op" id="2232232">,</span>&nbsp;<span class="ident" id="2232234">a</span><span class="op" id="2232235">)</span><br>
<span class="lineno"></span><span class="op" id="2232237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2232240">//&nbsp;These&nbsp;constants&nbsp;must&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/mgc0.h.</span><br>
<span class="lineno"></span><span class="keyword" id="2232301">const</span>&nbsp;<span class="op" id="2232307">(</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232310">bitsScalar</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2232324">=</span>&nbsp;<span class="num" id="2232326">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232329">bitsPointer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2232343">=</span>&nbsp;<span class="num" id="2232345">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232348">bitsMultiWord</span>&nbsp;<span class="op" id="2232362">=</span>&nbsp;<span class="num" id="2232364">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232368">bitsIface</span>&nbsp;<span class="op" id="2232378">=</span>&nbsp;<span class="num" id="2232380">2</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232383">bitsEface</span>&nbsp;<span class="op" id="2232393">=</span>&nbsp;<span class="num" id="2232395">3</span><br>
<span class="lineno"></span><span class="op" id="2232397">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2232400">//&nbsp;Make&nbsp;sure&nbsp;these&nbsp;routines&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../../runtime/hashmap.go!</span><br>
<span class="lineno"></span><span class="comment" id="2232472">//&nbsp;These&nbsp;types&nbsp;exist&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno">1605</span><span class="comment" id="2232544">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2232619">//&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2232650">const</span>&nbsp;<span class="op" id="2232656">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232659">bucketSize</span>&nbsp;<span class="op" id="2232670">=</span>&nbsp;<span class="num" id="2232672">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232675">maxKeySize</span>&nbsp;<span class="op" id="2232686">=</span>&nbsp;<span class="num" id="2232688">128</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232693">maxValSize</span>&nbsp;<span class="op" id="2232704">=</span>&nbsp;<span class="num" id="2232706">128</span><br>
<span class="lineno"></span><span class="op" id="2232710">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2232713">func</span>&nbsp;<span class="ident" id="2232718">bucketOf</span><span class="op" id="2232726">(</span><span class="ident" id="2232727">ktyp</span><span class="op" id="2232731">,</span>&nbsp;<span class="ident" id="2232733">etyp</span>&nbsp;<span class="op" id="2232738">*</span><span class="ident" id="2232739">rtype</span><span class="op" id="2232744">)</span>&nbsp;<span class="op" id="2232746">*</span><span class="ident" id="2232747">rtype</span>&nbsp;<span class="op" id="2232753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2232756">if</span>&nbsp;<span class="ident" id="2232759">ktyp</span><span class="op" id="2232763">.</span><span class="ident" id="2232764">size</span>&nbsp;<span class="op" id="2232769">&gt;</span>&nbsp;<span class="ident" id="2232771">maxKeySize</span>&nbsp;<span class="op" id="2232782">{</span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232786">ktyp</span>&nbsp;<span class="op" id="2232791">=</span>&nbsp;<span class="ident" id="2232793">PtrTo</span><span class="op" id="2232798">(</span><span class="ident" id="2232799">ktyp</span><span class="op" id="2232803">)</span><span class="op" id="2232804">.</span><span class="op" id="2232805">(</span><span class="op" id="2232806">*</span><span class="ident" id="2232807">rtype</span><span class="op" id="2232812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2232815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2232818">if</span>&nbsp;<span class="ident" id="2232821">etyp</span><span class="op" id="2232825">.</span><span class="ident" id="2232826">size</span>&nbsp;<span class="op" id="2232831">&gt;</span>&nbsp;<span class="ident" id="2232833">maxValSize</span>&nbsp;<span class="op" id="2232844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232848">etyp</span>&nbsp;<span class="op" id="2232853">=</span>&nbsp;<span class="ident" id="2232855">PtrTo</span><span class="op" id="2232860">(</span><span class="ident" id="2232861">etyp</span><span class="op" id="2232865">)</span><span class="op" id="2232866">.</span><span class="op" id="2232867">(</span><span class="op" id="2232868">*</span><span class="ident" id="2232869">rtype</span><span class="op" id="2232874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2232877">}</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2232880">ptrsize</span>&nbsp;<span class="op" id="2232888">:=</span>&nbsp;<span class="ident" id="2232891">unsafe</span><span class="op" id="2232897">.</span><span class="ident" id="2232898">Sizeof</span><span class="op" id="2232904">(</span><span class="builtintype" id="2232905">uintptr</span><span class="op" id="2232912">(</span><span class="num" id="2232913">0</span><span class="op" id="2232914">)</span><span class="op" id="2232915">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2232919">var</span>&nbsp;<span class="ident" id="2232923">gc</span>&nbsp;<span class="ident" id="2232926">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2232934">//&nbsp;topbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2232946">for</span>&nbsp;<span class="ident" id="2232950">i</span>&nbsp;<span class="op" id="2232952">:=</span>&nbsp;<span class="num" id="2232955">0</span><span class="op" id="2232956">;</span>&nbsp;<span class="ident" id="2232958">i</span>&nbsp;<span class="op" id="2232960">&lt;</span>&nbsp;<span class="builtintype" id="2232962">int</span><span class="op" id="2232965">(</span><span class="ident" id="2232966">bucketSize</span><span class="op" id="2232976">*</span><span class="ident" id="2232977">unsafe</span><span class="op" id="2232983">.</span><span class="ident" id="2232984">Sizeof</span><span class="op" id="2232990">(</span><span class="builtintype" id="2232991">uint8</span><span class="op" id="2232996">(</span><span class="num" id="2232997">0</span><span class="op" id="2232998">)</span><span class="op" id="2232999">)</span><span class="op" id="2233000">/</span><span class="ident" id="2233001">ptrsize</span><span class="op" id="2233008">)</span><span class="op" id="2233009">;</span>&nbsp;<span class="ident" id="2233011">i</span><span class="op" id="2233012">++</span>&nbsp;<span class="op" id="2233015">{</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233019">gc</span><span class="op" id="2233021">.</span><span class="builtinfunc" id="2233022">append</span><span class="op" id="2233028">(</span><span class="ident" id="2233029">bitsScalar</span><span class="op" id="2233039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2233042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233045">gc</span><span class="op" id="2233047">.</span><span class="builtinfunc" id="2233048">append</span><span class="op" id="2233054">(</span><span class="ident" id="2233055">bitsPointer</span><span class="op" id="2233066">)</span>&nbsp;<span class="comment" id="2233068">//&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233081">if</span>&nbsp;<span class="ident" id="2233084">runtime</span><span class="op" id="2233091">.</span><span class="ident" id="2233092">GOARCH</span>&nbsp;<span class="op" id="2233099">==</span>&nbsp;<span class="string" id="2233102">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2233113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233117">gc</span><span class="op" id="2233119">.</span><span class="builtinfunc" id="2233120">append</span><span class="op" id="2233126">(</span><span class="ident" id="2233127">bitsScalar</span><span class="op" id="2233137">)</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2233140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2233143">//&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233152">for</span>&nbsp;<span class="ident" id="2233156">i</span>&nbsp;<span class="op" id="2233158">:=</span>&nbsp;<span class="num" id="2233161">0</span><span class="op" id="2233162">;</span>&nbsp;<span class="ident" id="2233164">i</span>&nbsp;<span class="op" id="2233166">&lt;</span>&nbsp;<span class="ident" id="2233168">bucketSize</span><span class="op" id="2233178">;</span>&nbsp;<span class="ident" id="2233180">i</span><span class="op" id="2233181">++</span>&nbsp;<span class="op" id="2233184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233188">gc</span><span class="op" id="2233190">.</span><span class="ident" id="2233191">appendProg</span><span class="op" id="2233201">(</span><span class="ident" id="2233202">ktyp</span><span class="op" id="2233206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2233209">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2233212">//&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233223">for</span>&nbsp;<span class="ident" id="2233227">i</span>&nbsp;<span class="op" id="2233229">:=</span>&nbsp;<span class="num" id="2233232">0</span><span class="op" id="2233233">;</span>&nbsp;<span class="ident" id="2233235">i</span>&nbsp;<span class="op" id="2233237">&lt;</span>&nbsp;<span class="ident" id="2233239">bucketSize</span><span class="op" id="2233249">;</span>&nbsp;<span class="ident" id="2233251">i</span><span class="op" id="2233252">++</span>&nbsp;<span class="op" id="2233255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233259">gc</span><span class="op" id="2233261">.</span><span class="ident" id="2233262">appendProg</span><span class="op" id="2233272">(</span><span class="ident" id="2233273">etyp</span><span class="op" id="2233277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2233280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233284">b</span>&nbsp;<span class="op" id="2233286">:=</span>&nbsp;<span class="builtinfunc" id="2233289">new</span><span class="op" id="2233292">(</span><span class="ident" id="2233293">rtype</span><span class="op" id="2233298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233301">b</span><span class="op" id="2233302">.</span><span class="ident" id="2233303">size</span>&nbsp;<span class="op" id="2233308">=</span>&nbsp;<span class="ident" id="2233310">gc</span><span class="op" id="2233312">.</span><span class="ident" id="2233313">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233319">b</span><span class="op" id="2233320">.</span><span class="ident" id="2233321">gc</span><span class="op" id="2233323">[</span><span class="num" id="2233324">0</span><span class="op" id="2233325">]</span>&nbsp;<span class="op" id="2233327">=</span>&nbsp;<span class="ident" id="2233329">gc</span><span class="op" id="2233331">.</span><span class="ident" id="2233332">finalize</span><span class="op" id="2233340">(</span><span class="op" id="2233341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233344">s</span>&nbsp;<span class="op" id="2233346">:=</span>&nbsp;<span class="string" id="2233349">&#34;bucket(&#34;</span>&nbsp;<span class="op" id="2233359">+</span>&nbsp;<span class="op" id="2233361">*</span><span class="ident" id="2233362">ktyp</span><span class="op" id="2233366">.</span><span class="builtintype" id="2233367">string</span>&nbsp;<span class="op" id="2233374">+</span>&nbsp;<span class="string" id="2233376">&#34;,&#34;</span>&nbsp;<span class="op" id="2233380">+</span>&nbsp;<span class="op" id="2233382">*</span><span class="ident" id="2233383">etyp</span><span class="op" id="2233387">.</span><span class="builtintype" id="2233388">string</span>&nbsp;<span class="op" id="2233395">+</span>&nbsp;<span class="string" id="2233397">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233402">b</span><span class="op" id="2233403">.</span><span class="builtintype" id="2233404">string</span>&nbsp;<span class="op" id="2233411">=</span>&nbsp;<span class="op" id="2233413">&amp;</span><span class="ident" id="2233414">s</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233417">return</span>&nbsp;<span class="ident" id="2233424">b</span><br>
<span class="lineno"></span><span class="op" id="2233426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2233429">//&nbsp;SliceOf&nbsp;returns&nbsp;the&nbsp;slice&nbsp;type&nbsp;with&nbsp;element&nbsp;type&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2233484">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;SliceOf(t)&nbsp;represents&nbsp;[]int.</span><br>
<span class="lineno">1650</span><span class="keyword" id="2233550">func</span>&nbsp;<span class="ident" id="2233555">SliceOf</span><span class="op" id="2233562">(</span><span class="ident" id="2233563">t</span>&nbsp;<span class="ident" id="2233565">Type</span><span class="op" id="2233569">)</span>&nbsp;<span class="ident" id="2233571">Type</span>&nbsp;<span class="op" id="2233576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233579">typ</span>&nbsp;<span class="op" id="2233583">:=</span>&nbsp;<span class="ident" id="2233586">t</span><span class="op" id="2233587">.</span><span class="op" id="2233588">(</span><span class="op" id="2233589">*</span><span class="ident" id="2233590">rtype</span><span class="op" id="2233595">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2233599">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233618">ckey</span>&nbsp;<span class="op" id="2233623">:=</span>&nbsp;<span class="ident" id="2233626">cacheKey</span><span class="op" id="2233634">{</span><span class="ident" id="2233635">Slice</span><span class="op" id="2233640">,</span>&nbsp;<span class="ident" id="2233642">typ</span><span class="op" id="2233645">,</span>&nbsp;<span class="ident" id="2233647">nil</span><span class="op" id="2233650">,</span>&nbsp;<span class="num" id="2233652">0</span><span class="op" id="2233653">}</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233656">if</span>&nbsp;<span class="ident" id="2233659">slice</span>&nbsp;<span class="op" id="2233665">:=</span>&nbsp;<span class="ident" id="2233668">cacheGet</span><span class="op" id="2233676">(</span><span class="ident" id="2233677">ckey</span><span class="op" id="2233681">)</span><span class="op" id="2233682">;</span>&nbsp;<span class="ident" id="2233684">slice</span>&nbsp;<span class="op" id="2233690">!=</span>&nbsp;<span class="ident" id="2233693">nil</span>&nbsp;<span class="op" id="2233697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233701">return</span>&nbsp;<span class="ident" id="2233708">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2233715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2233719">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233744">s</span>&nbsp;<span class="op" id="2233746">:=</span>&nbsp;<span class="string" id="2233749">&#34;[]&#34;</span>&nbsp;<span class="op" id="2233754">+</span>&nbsp;<span class="op" id="2233756">*</span><span class="ident" id="2233757">typ</span><span class="op" id="2233760">.</span><span class="builtintype" id="2233761">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233769">for</span>&nbsp;<span class="ident" id="2233773">_</span><span class="op" id="2233774">,</span>&nbsp;<span class="ident" id="2233776">tt</span>&nbsp;<span class="op" id="2233779">:=</span>&nbsp;<span class="keyword" id="2233782">range</span>&nbsp;<span class="ident" id="2233788">typesByString</span><span class="op" id="2233801">(</span><span class="ident" id="2233802">s</span><span class="op" id="2233803">)</span>&nbsp;<span class="op" id="2233805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233809">slice</span>&nbsp;<span class="op" id="2233815">:=</span>&nbsp;<span class="op" id="2233818">(</span><span class="op" id="2233819">*</span><span class="ident" id="2233820">sliceType</span><span class="op" id="2233829">)</span><span class="op" id="2233830">(</span><span class="ident" id="2233831">unsafe</span><span class="op" id="2233837">.</span><span class="ident" id="2233838">Pointer</span><span class="op" id="2233845">(</span><span class="ident" id="2233846">tt</span><span class="op" id="2233848">)</span><span class="op" id="2233849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233853">if</span>&nbsp;<span class="ident" id="2233856">slice</span><span class="op" id="2233861">.</span><span class="ident" id="2233862">elem</span>&nbsp;<span class="op" id="2233867">==</span>&nbsp;<span class="ident" id="2233870">typ</span>&nbsp;<span class="op" id="2233874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233879">return</span>&nbsp;<span class="ident" id="2233886">cachePut</span><span class="op" id="2233894">(</span><span class="ident" id="2233895">ckey</span><span class="op" id="2233899">,</span>&nbsp;<span class="ident" id="2233901">tt</span><span class="op" id="2233903">)</span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2233907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2233910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2233914">//&nbsp;Make&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2233937">var</span>&nbsp;<span class="ident" id="2233941">islice</span>&nbsp;<span class="keyword" id="2233948">interface</span><span class="op" id="2233957">{</span><span class="op" id="2233958">}</span>&nbsp;<span class="op" id="2233960">=</span>&nbsp;<span class="op" id="2233962">(</span><span class="op" id="2233963">[</span><span class="op" id="2233964">]</span><span class="ident" id="2233965">unsafe</span><span class="op" id="2233971">.</span><span class="ident" id="2233972">Pointer</span><span class="op" id="2233979">)</span><span class="op" id="2233980">(</span><span class="ident" id="2233981">nil</span><span class="op" id="2233984">)</span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2233987">prototype</span>&nbsp;<span class="op" id="2233997">:=</span>&nbsp;<span class="op" id="2234000">*</span><span class="op" id="2234001">(</span><span class="op" id="2234002">*</span><span class="op" id="2234003">*</span><span class="ident" id="2234004">sliceType</span><span class="op" id="2234013">)</span><span class="op" id="2234014">(</span><span class="ident" id="2234015">unsafe</span><span class="op" id="2234021">.</span><span class="ident" id="2234022">Pointer</span><span class="op" id="2234029">(</span><span class="op" id="2234030">&amp;</span><span class="ident" id="2234031">islice</span><span class="op" id="2234037">)</span><span class="op" id="2234038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234041">slice</span>&nbsp;<span class="op" id="2234047">:=</span>&nbsp;<span class="builtinfunc" id="2234050">new</span><span class="op" id="2234053">(</span><span class="ident" id="2234054">sliceType</span><span class="op" id="2234063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2234066">*</span><span class="ident" id="2234067">slice</span>&nbsp;<span class="op" id="2234073">=</span>&nbsp;<span class="op" id="2234075">*</span><span class="ident" id="2234076">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234087">slice</span><span class="op" id="2234092">.</span><span class="builtintype" id="2234093">string</span>&nbsp;<span class="op" id="2234100">=</span>&nbsp;<span class="op" id="2234102">&amp;</span><span class="ident" id="2234103">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234106">slice</span><span class="op" id="2234111">.</span><span class="ident" id="2234112">hash</span>&nbsp;<span class="op" id="2234117">=</span>&nbsp;<span class="ident" id="2234119">fnv1</span><span class="op" id="2234123">(</span><span class="ident" id="2234124">typ</span><span class="op" id="2234127">.</span><span class="ident" id="2234128">hash</span><span class="op" id="2234132">,</span>&nbsp;<span class="string" id="2234134">&#39;[&#39;</span><span class="op" id="2234137">)</span><br>
<span class="lineno">1675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234140">slice</span><span class="op" id="2234145">.</span><span class="ident" id="2234146">elem</span>&nbsp;<span class="op" id="2234151">=</span>&nbsp;<span class="ident" id="2234153">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234158">slice</span><span class="op" id="2234163">.</span><span class="ident" id="2234164">uncommonType</span>&nbsp;<span class="op" id="2234177">=</span>&nbsp;<span class="ident" id="2234179">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234184">slice</span><span class="op" id="2234189">.</span><span class="ident" id="2234190">ptrToThis</span>&nbsp;<span class="op" id="2234200">=</span>&nbsp;<span class="ident" id="2234202">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234207">slice</span><span class="op" id="2234212">.</span><span class="ident" id="2234213">zero</span>&nbsp;<span class="op" id="2234218">=</span>&nbsp;<span class="ident" id="2234220">unsafe</span><span class="op" id="2234226">.</span><span class="ident" id="2234227">Pointer</span><span class="op" id="2234234">(</span><span class="op" id="2234235">&amp;</span><span class="builtinfunc" id="2234236">make</span><span class="op" id="2234240">(</span><span class="op" id="2234241">[</span><span class="op" id="2234242">]</span><span class="builtintype" id="2234243">byte</span><span class="op" id="2234247">,</span>&nbsp;<span class="ident" id="2234249">slice</span><span class="op" id="2234254">.</span><span class="ident" id="2234255">size</span><span class="op" id="2234259">)</span><span class="op" id="2234260">[</span><span class="num" id="2234261">0</span><span class="op" id="2234262">]</span><span class="op" id="2234263">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2234267">return</span>&nbsp;<span class="ident" id="2234274">cachePut</span><span class="op" id="2234282">(</span><span class="ident" id="2234283">ckey</span><span class="op" id="2234287">,</span>&nbsp;<span class="op" id="2234289">&amp;</span><span class="ident" id="2234290">slice</span><span class="op" id="2234295">.</span><span class="ident" id="2234296">rtype</span><span class="op" id="2234301">)</span><br>
<span class="lineno"></span><span class="op" id="2234303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2234306">//&nbsp;ArrayOf&nbsp;returns&nbsp;the&nbsp;array&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;count&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2234379">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ArrayOf(5,&nbsp;t)&nbsp;represents&nbsp;[5]int.</span><br>
<span class="lineno">1685</span><span class="comment" id="2234449">//</span><br>
<span class="lineno"></span><span class="comment" id="2234452">//&nbsp;If&nbsp;the&nbsp;resulting&nbsp;type&nbsp;would&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;available&nbsp;address&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="2234527">//&nbsp;ArrayOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2234546">//</span><br>
<span class="lineno"></span><span class="comment" id="2234549">//&nbsp;TODO(rsc):&nbsp;Unexported&nbsp;for&nbsp;now.&nbsp;Export&nbsp;once&nbsp;the&nbsp;alg&nbsp;field&nbsp;is&nbsp;set&nbsp;correctly</span><br>
<span class="lineno">1690</span><span class="comment" id="2234626">//&nbsp;for&nbsp;the&nbsp;type.&nbsp;This&nbsp;may&nbsp;require&nbsp;significant&nbsp;work.</span><br>
<span class="lineno"></span><span class="comment" id="2234678">//</span><br>
<span class="lineno"></span><span class="comment" id="2234681">//&nbsp;TODO(rsc):&nbsp;TestArrayOf&nbsp;is&nbsp;also&nbsp;disabled.&nbsp;Re-enable.</span><br>
<span class="lineno"></span><span class="keyword" id="2234736">func</span>&nbsp;<span class="ident" id="2234741">arrayOf</span><span class="op" id="2234748">(</span><span class="ident" id="2234749">count</span>&nbsp;<span class="builtintype" id="2234755">int</span><span class="op" id="2234758">,</span>&nbsp;<span class="ident" id="2234760">elem</span>&nbsp;<span class="ident" id="2234765">Type</span><span class="op" id="2234769">)</span>&nbsp;<span class="ident" id="2234771">Type</span>&nbsp;<span class="op" id="2234776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234779">typ</span>&nbsp;<span class="op" id="2234783">:=</span>&nbsp;<span class="ident" id="2234786">elem</span><span class="op" id="2234790">.</span><span class="op" id="2234791">(</span><span class="op" id="2234792">*</span><span class="ident" id="2234793">rtype</span><span class="op" id="2234798">)</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234801">slice</span>&nbsp;<span class="op" id="2234807">:=</span>&nbsp;<span class="ident" id="2234810">SliceOf</span><span class="op" id="2234817">(</span><span class="ident" id="2234818">elem</span><span class="op" id="2234822">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2234826">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234845">ckey</span>&nbsp;<span class="op" id="2234850">:=</span>&nbsp;<span class="ident" id="2234853">cacheKey</span><span class="op" id="2234861">{</span><span class="ident" id="2234862">Array</span><span class="op" id="2234867">,</span>&nbsp;<span class="ident" id="2234869">typ</span><span class="op" id="2234872">,</span>&nbsp;<span class="ident" id="2234874">nil</span><span class="op" id="2234877">,</span>&nbsp;<span class="builtintype" id="2234879">uintptr</span><span class="op" id="2234886">(</span><span class="ident" id="2234887">count</span><span class="op" id="2234892">)</span><span class="op" id="2234893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2234896">if</span>&nbsp;<span class="ident" id="2234899">slice</span>&nbsp;<span class="op" id="2234905">:=</span>&nbsp;<span class="ident" id="2234908">cacheGet</span><span class="op" id="2234916">(</span><span class="ident" id="2234917">ckey</span><span class="op" id="2234921">)</span><span class="op" id="2234922">;</span>&nbsp;<span class="ident" id="2234924">slice</span>&nbsp;<span class="op" id="2234930">!=</span>&nbsp;<span class="ident" id="2234933">nil</span>&nbsp;<span class="op" id="2234937">{</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2234941">return</span>&nbsp;<span class="ident" id="2234948">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2234955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2234959">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2234984">s</span>&nbsp;<span class="op" id="2234986">:=</span>&nbsp;<span class="string" id="2234989">&#34;[&#34;</span>&nbsp;<span class="op" id="2234993">+</span>&nbsp;<span class="ident" id="2234995">strconv</span><span class="op" id="2235002">.</span><span class="ident" id="2235003">Itoa</span><span class="op" id="2235007">(</span><span class="ident" id="2235008">count</span><span class="op" id="2235013">)</span>&nbsp;<span class="op" id="2235015">+</span>&nbsp;<span class="string" id="2235017">&#34;]&#34;</span>&nbsp;<span class="op" id="2235021">+</span>&nbsp;<span class="op" id="2235023">*</span><span class="ident" id="2235024">typ</span><span class="op" id="2235027">.</span><span class="builtintype" id="2235028">string</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235036">for</span>&nbsp;<span class="ident" id="2235040">_</span><span class="op" id="2235041">,</span>&nbsp;<span class="ident" id="2235043">tt</span>&nbsp;<span class="op" id="2235046">:=</span>&nbsp;<span class="keyword" id="2235049">range</span>&nbsp;<span class="ident" id="2235055">typesByString</span><span class="op" id="2235068">(</span><span class="ident" id="2235069">s</span><span class="op" id="2235070">)</span>&nbsp;<span class="op" id="2235072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235076">slice</span>&nbsp;<span class="op" id="2235082">:=</span>&nbsp;<span class="op" id="2235085">(</span><span class="op" id="2235086">*</span><span class="ident" id="2235087">sliceType</span><span class="op" id="2235096">)</span><span class="op" id="2235097">(</span><span class="ident" id="2235098">unsafe</span><span class="op" id="2235104">.</span><span class="ident" id="2235105">Pointer</span><span class="op" id="2235112">(</span><span class="ident" id="2235113">tt</span><span class="op" id="2235115">)</span><span class="op" id="2235116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235120">if</span>&nbsp;<span class="ident" id="2235123">slice</span><span class="op" id="2235128">.</span><span class="ident" id="2235129">elem</span>&nbsp;<span class="op" id="2235134">==</span>&nbsp;<span class="ident" id="2235137">typ</span>&nbsp;<span class="op" id="2235141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235146">return</span>&nbsp;<span class="ident" id="2235153">cachePut</span><span class="op" id="2235161">(</span><span class="ident" id="2235162">ckey</span><span class="op" id="2235166">,</span>&nbsp;<span class="ident" id="2235168">tt</span><span class="op" id="2235170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2235174">}</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2235177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2235181">//&nbsp;Make&nbsp;an&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235205">var</span>&nbsp;<span class="ident" id="2235209">iarray</span>&nbsp;<span class="keyword" id="2235216">interface</span><span class="op" id="2235225">{</span><span class="op" id="2235226">}</span>&nbsp;<span class="op" id="2235228">=</span>&nbsp;<span class="op" id="2235230">[</span><span class="num" id="2235231">1</span><span class="op" id="2235232">]</span><span class="ident" id="2235233">unsafe</span><span class="op" id="2235239">.</span><span class="ident" id="2235240">Pointer</span><span class="op" id="2235247">{</span><span class="op" id="2235248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235251">prototype</span>&nbsp;<span class="op" id="2235261">:=</span>&nbsp;<span class="op" id="2235264">*</span><span class="op" id="2235265">(</span><span class="op" id="2235266">*</span><span class="op" id="2235267">*</span><span class="ident" id="2235268">arrayType</span><span class="op" id="2235277">)</span><span class="op" id="2235278">(</span><span class="ident" id="2235279">unsafe</span><span class="op" id="2235285">.</span><span class="ident" id="2235286">Pointer</span><span class="op" id="2235293">(</span><span class="op" id="2235294">&amp;</span><span class="ident" id="2235295">iarray</span><span class="op" id="2235301">)</span><span class="op" id="2235302">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235305">array</span>&nbsp;<span class="op" id="2235311">:=</span>&nbsp;<span class="builtinfunc" id="2235314">new</span><span class="op" id="2235317">(</span><span class="ident" id="2235318">arrayType</span><span class="op" id="2235327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2235330">*</span><span class="ident" id="2235331">array</span>&nbsp;<span class="op" id="2235337">=</span>&nbsp;<span class="op" id="2235339">*</span><span class="ident" id="2235340">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2235351">//&nbsp;TODO:&nbsp;Set&nbsp;extra&nbsp;kind&nbsp;bits&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235392">array</span><span class="op" id="2235397">.</span><span class="builtintype" id="2235398">string</span>&nbsp;<span class="op" id="2235405">=</span>&nbsp;<span class="op" id="2235407">&amp;</span><span class="ident" id="2235408">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235411">array</span><span class="op" id="2235416">.</span><span class="ident" id="2235417">hash</span>&nbsp;<span class="op" id="2235422">=</span>&nbsp;<span class="ident" id="2235424">fnv1</span><span class="op" id="2235428">(</span><span class="ident" id="2235429">typ</span><span class="op" id="2235432">.</span><span class="ident" id="2235433">hash</span><span class="op" id="2235437">,</span>&nbsp;<span class="string" id="2235439">&#39;[&#39;</span><span class="op" id="2235442">)</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235445">for</span>&nbsp;<span class="ident" id="2235449">n</span>&nbsp;<span class="op" id="2235451">:=</span>&nbsp;<span class="builtintype" id="2235454">uint32</span><span class="op" id="2235460">(</span><span class="ident" id="2235461">count</span><span class="op" id="2235466">)</span><span class="op" id="2235467">;</span>&nbsp;<span class="ident" id="2235469">n</span>&nbsp;<span class="op" id="2235471">&gt;</span>&nbsp;<span class="num" id="2235473">0</span><span class="op" id="2235474">;</span>&nbsp;<span class="ident" id="2235476">n</span>&nbsp;<span class="op" id="2235478">&gt;&gt;=</span>&nbsp;<span class="num" id="2235482">8</span>&nbsp;<span class="op" id="2235484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235488">array</span><span class="op" id="2235493">.</span><span class="ident" id="2235494">hash</span>&nbsp;<span class="op" id="2235499">=</span>&nbsp;<span class="ident" id="2235501">fnv1</span><span class="op" id="2235505">(</span><span class="ident" id="2235506">array</span><span class="op" id="2235511">.</span><span class="ident" id="2235512">hash</span><span class="op" id="2235516">,</span>&nbsp;<span class="builtintype" id="2235518">byte</span><span class="op" id="2235522">(</span><span class="ident" id="2235523">n</span><span class="op" id="2235524">)</span><span class="op" id="2235525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2235528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235531">array</span><span class="op" id="2235536">.</span><span class="ident" id="2235537">hash</span>&nbsp;<span class="op" id="2235542">=</span>&nbsp;<span class="ident" id="2235544">fnv1</span><span class="op" id="2235548">(</span><span class="ident" id="2235549">array</span><span class="op" id="2235554">.</span><span class="ident" id="2235555">hash</span><span class="op" id="2235559">,</span>&nbsp;<span class="string" id="2235561">&#39;]&#39;</span><span class="op" id="2235564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235567">array</span><span class="op" id="2235572">.</span><span class="ident" id="2235573">elem</span>&nbsp;<span class="op" id="2235578">=</span>&nbsp;<span class="ident" id="2235580">typ</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235585">max</span>&nbsp;<span class="op" id="2235589">:=</span>&nbsp;<span class="op" id="2235592">^</span><span class="builtintype" id="2235593">uintptr</span><span class="op" id="2235600">(</span><span class="num" id="2235601">0</span><span class="op" id="2235602">)</span>&nbsp;<span class="op" id="2235604">/</span>&nbsp;<span class="ident" id="2235606">typ</span><span class="op" id="2235609">.</span><span class="ident" id="2235610">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2235616">if</span>&nbsp;<span class="builtintype" id="2235619">uintptr</span><span class="op" id="2235626">(</span><span class="ident" id="2235627">count</span><span class="op" id="2235632">)</span>&nbsp;<span class="op" id="2235634">&gt;</span>&nbsp;<span class="ident" id="2235636">max</span>&nbsp;<span class="op" id="2235640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2235644">panic</span><span class="op" id="2235649">(</span><span class="string" id="2235650">&#34;reflect.ArrayOf:&nbsp;array&nbsp;size&nbsp;would&nbsp;exceed&nbsp;virtual&nbsp;address&nbsp;space&#34;</span><span class="op" id="2235714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2235717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235720">array</span><span class="op" id="2235725">.</span><span class="ident" id="2235726">size</span>&nbsp;<span class="op" id="2235731">=</span>&nbsp;<span class="ident" id="2235733">typ</span><span class="op" id="2235736">.</span><span class="ident" id="2235737">size</span>&nbsp;<span class="op" id="2235742">*</span>&nbsp;<span class="builtintype" id="2235744">uintptr</span><span class="op" id="2235751">(</span><span class="ident" id="2235752">count</span><span class="op" id="2235757">)</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235760">array</span><span class="op" id="2235765">.</span><span class="ident" id="2235766">align</span>&nbsp;<span class="op" id="2235772">=</span>&nbsp;<span class="ident" id="2235774">typ</span><span class="op" id="2235777">.</span><span class="ident" id="2235778">align</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235785">array</span><span class="op" id="2235790">.</span><span class="ident" id="2235791">fieldAlign</span>&nbsp;<span class="op" id="2235802">=</span>&nbsp;<span class="ident" id="2235804">typ</span><span class="op" id="2235807">.</span><span class="ident" id="2235808">fieldAlign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2235820">//&nbsp;TODO:&nbsp;array.alg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2235840">//&nbsp;TODO:&nbsp;array.gc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2235859">//&nbsp;TODO:</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235869">array</span><span class="op" id="2235874">.</span><span class="ident" id="2235875">uncommonType</span>&nbsp;<span class="op" id="2235888">=</span>&nbsp;<span class="ident" id="2235890">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235895">array</span><span class="op" id="2235900">.</span><span class="ident" id="2235901">ptrToThis</span>&nbsp;<span class="op" id="2235911">=</span>&nbsp;<span class="ident" id="2235913">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235918">array</span><span class="op" id="2235923">.</span><span class="ident" id="2235924">zero</span>&nbsp;<span class="op" id="2235929">=</span>&nbsp;<span class="ident" id="2235931">unsafe</span><span class="op" id="2235937">.</span><span class="ident" id="2235938">Pointer</span><span class="op" id="2235945">(</span><span class="op" id="2235946">&amp;</span><span class="builtinfunc" id="2235947">make</span><span class="op" id="2235951">(</span><span class="op" id="2235952">[</span><span class="op" id="2235953">]</span><span class="builtintype" id="2235954">byte</span><span class="op" id="2235958">,</span>&nbsp;<span class="ident" id="2235960">array</span><span class="op" id="2235965">.</span><span class="ident" id="2235966">size</span><span class="op" id="2235970">)</span><span class="op" id="2235971">[</span><span class="num" id="2235972">0</span><span class="op" id="2235973">]</span><span class="op" id="2235974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235977">array</span><span class="op" id="2235982">.</span><span class="builtinfunc" id="2235983">len</span>&nbsp;<span class="op" id="2235987">=</span>&nbsp;<span class="builtintype" id="2235989">uintptr</span><span class="op" id="2235996">(</span><span class="ident" id="2235997">count</span><span class="op" id="2236002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236005">array</span><span class="op" id="2236010">.</span><span class="ident" id="2236011">slice</span>&nbsp;<span class="op" id="2236017">=</span>&nbsp;<span class="ident" id="2236019">slice</span><span class="op" id="2236024">.</span><span class="op" id="2236025">(</span><span class="op" id="2236026">*</span><span class="ident" id="2236027">rtype</span><span class="op" id="2236032">)</span><br>
<span class="lineno">1740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236036">return</span>&nbsp;<span class="ident" id="2236043">cachePut</span><span class="op" id="2236051">(</span><span class="ident" id="2236052">ckey</span><span class="op" id="2236056">,</span>&nbsp;<span class="op" id="2236058">&amp;</span><span class="ident" id="2236059">array</span><span class="op" id="2236064">.</span><span class="ident" id="2236065">rtype</span><span class="op" id="2236070">)</span><br>
<span class="lineno"></span><span class="op" id="2236072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2236075">//&nbsp;toType&nbsp;converts&nbsp;from&nbsp;a&nbsp;*rtype&nbsp;to&nbsp;a&nbsp;Type&nbsp;that&nbsp;can&nbsp;be&nbsp;returned</span><br>
<span class="lineno">1745</span><span class="comment" id="2236139">//&nbsp;to&nbsp;the&nbsp;client&nbsp;of&nbsp;package&nbsp;reflect.&nbsp;In&nbsp;gc,&nbsp;the&nbsp;only&nbsp;concern&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2236208">//&nbsp;a&nbsp;nil&nbsp;*rtype&nbsp;must&nbsp;be&nbsp;replaced&nbsp;by&nbsp;a&nbsp;nil&nbsp;Type,&nbsp;but&nbsp;in&nbsp;gccgo&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2236274">//&nbsp;function&nbsp;takes&nbsp;care&nbsp;of&nbsp;ensuring&nbsp;that&nbsp;multiple&nbsp;*rtype&nbsp;for&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2236343">//&nbsp;type&nbsp;are&nbsp;coalesced&nbsp;into&nbsp;a&nbsp;single&nbsp;Type.</span><br>
<span class="lineno"></span><span class="keyword" id="2236385">func</span>&nbsp;<span class="ident" id="2236390">toType</span><span class="op" id="2236396">(</span><span class="ident" id="2236397">t</span>&nbsp;<span class="op" id="2236399">*</span><span class="ident" id="2236400">rtype</span><span class="op" id="2236405">)</span>&nbsp;<span class="ident" id="2236407">Type</span>&nbsp;<span class="op" id="2236412">{</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236415">if</span>&nbsp;<span class="ident" id="2236418">t</span>&nbsp;<span class="op" id="2236420">==</span>&nbsp;<span class="ident" id="2236423">nil</span>&nbsp;<span class="op" id="2236427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236431">return</span>&nbsp;<span class="ident" id="2236438">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2236443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2236446">return</span>&nbsp;<span class="ident" id="2236453">t</span><br>
<span class="lineno"></span><span class="op" id="2236455">}</span><br>
<span class="lineno">1755</span><br>
<span class="lineno"></span><span class="keyword" id="2236458">type</span>&nbsp;<span class="ident" id="2236463">layoutKey</span>&nbsp;<span class="keyword" id="2236473">struct</span>&nbsp;<span class="op" id="2236480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236483">t</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2236488">*</span><span class="ident" id="2236489">rtype</span>&nbsp;<span class="comment" id="2236495">//&nbsp;function&nbsp;signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236518">rcvr</span>&nbsp;<span class="op" id="2236523">*</span><span class="ident" id="2236524">rtype</span>&nbsp;<span class="comment" id="2236530">//&nbsp;receiver&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;none</span><br>
<span class="lineno"></span><span class="op" id="2236563">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span><span class="keyword" id="2236566">type</span>&nbsp;<span class="ident" id="2236571">layoutType</span>&nbsp;<span class="keyword" id="2236582">struct</span>&nbsp;<span class="op" id="2236589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236592">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2236602">*</span><span class="ident" id="2236603">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236610">argSize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2236620">uintptr</span>&nbsp;<span class="comment" id="2236628">//&nbsp;size&nbsp;of&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236650">retOffset</span>&nbsp;<span class="builtintype" id="2236660">uintptr</span>&nbsp;<span class="comment" id="2236668">//&nbsp;offset&nbsp;of&nbsp;return&nbsp;values.</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236697">stack</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2236707">*</span><span class="ident" id="2236708">bitVector</span><br>
<span class="lineno"></span><span class="op" id="2236718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2236721">var</span>&nbsp;<span class="ident" id="2236725">layoutCache</span>&nbsp;<span class="keyword" id="2236737">struct</span>&nbsp;<span class="op" id="2236744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236747">sync</span><span class="op" id="2236751">.</span><span class="ident" id="2236752">RWMutex</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2236761">m</span>&nbsp;<span class="keyword" id="2236763">map</span><span class="op" id="2236766">[</span><span class="ident" id="2236767">layoutKey</span><span class="op" id="2236776">]</span><span class="ident" id="2236777">layoutType</span><br>
<span class="lineno"></span><span class="op" id="2236788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2236791">//&nbsp;funcLayout&nbsp;computes&nbsp;a&nbsp;struct&nbsp;type&nbsp;representing&nbsp;the&nbsp;layout&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2236859">//&nbsp;function&nbsp;arguments&nbsp;and&nbsp;return&nbsp;values&nbsp;for&nbsp;the&nbsp;function&nbsp;type&nbsp;t.</span><br>
<span class="lineno">1775</span><span class="comment" id="2236924">//&nbsp;If&nbsp;rcvr&nbsp;!=&nbsp;nil,&nbsp;rcvr&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="2236984">//&nbsp;The&nbsp;returned&nbsp;type&nbsp;exists&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2237063">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2237131">//&nbsp;the&nbsp;name&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2237171">func</span>&nbsp;<span class="ident" id="2237176">funcLayout</span><span class="op" id="2237186">(</span><span class="ident" id="2237187">t</span>&nbsp;<span class="op" id="2237189">*</span><span class="ident" id="2237190">rtype</span><span class="op" id="2237195">,</span>&nbsp;<span class="ident" id="2237197">rcvr</span>&nbsp;<span class="op" id="2237202">*</span><span class="ident" id="2237203">rtype</span><span class="op" id="2237208">)</span>&nbsp;<span class="op" id="2237210">(</span><span class="ident" id="2237211">frametype</span>&nbsp;<span class="op" id="2237221">*</span><span class="ident" id="2237222">rtype</span><span class="op" id="2237227">,</span>&nbsp;<span class="ident" id="2237229">argSize</span><span class="op" id="2237236">,</span>&nbsp;<span class="ident" id="2237238">retOffset</span>&nbsp;<span class="builtintype" id="2237248">uintptr</span><span class="op" id="2237255">,</span>&nbsp;<span class="ident" id="2237257">stack</span>&nbsp;<span class="op" id="2237263">*</span><span class="ident" id="2237264">bitVector</span><span class="op" id="2237273">)</span>&nbsp;<span class="op" id="2237275">{</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237278">if</span>&nbsp;<span class="ident" id="2237281">t</span><span class="op" id="2237282">.</span><span class="ident" id="2237283">Kind</span><span class="op" id="2237287">(</span><span class="op" id="2237288">)</span>&nbsp;<span class="op" id="2237290">!=</span>&nbsp;<span class="ident" id="2237293">Func</span>&nbsp;<span class="op" id="2237298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2237302">panic</span><span class="op" id="2237307">(</span><span class="string" id="2237308">&#34;reflect:&nbsp;funcLayout&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2237346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237352">if</span>&nbsp;<span class="ident" id="2237355">rcvr</span>&nbsp;<span class="op" id="2237360">!=</span>&nbsp;<span class="ident" id="2237363">nil</span>&nbsp;<span class="op" id="2237367">&amp;&amp;</span>&nbsp;<span class="ident" id="2237370">rcvr</span><span class="op" id="2237374">.</span><span class="ident" id="2237375">Kind</span><span class="op" id="2237379">(</span><span class="op" id="2237380">)</span>&nbsp;<span class="op" id="2237382">==</span>&nbsp;<span class="ident" id="2237385">Interface</span>&nbsp;<span class="op" id="2237395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2237399">panic</span><span class="op" id="2237404">(</span><span class="string" id="2237405">&#34;reflect:&nbsp;funcLayout&nbsp;with&nbsp;interface&nbsp;receiver&nbsp;&#34;</span>&nbsp;<span class="op" id="2237452">+</span>&nbsp;<span class="ident" id="2237454">rcvr</span><span class="op" id="2237458">.</span><span class="ident" id="2237459">String</span><span class="op" id="2237465">(</span><span class="op" id="2237466">)</span><span class="op" id="2237467">)</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237473">k</span>&nbsp;<span class="op" id="2237475">:=</span>&nbsp;<span class="ident" id="2237478">layoutKey</span><span class="op" id="2237487">{</span><span class="ident" id="2237488">t</span><span class="op" id="2237489">,</span>&nbsp;<span class="ident" id="2237491">rcvr</span><span class="op" id="2237495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237498">layoutCache</span><span class="op" id="2237509">.</span><span class="ident" id="2237510">RLock</span><span class="op" id="2237515">(</span><span class="op" id="2237516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237519">if</span>&nbsp;<span class="ident" id="2237522">x</span>&nbsp;<span class="op" id="2237524">:=</span>&nbsp;<span class="ident" id="2237527">layoutCache</span><span class="op" id="2237538">.</span><span class="ident" id="2237539">m</span><span class="op" id="2237540">[</span><span class="ident" id="2237541">k</span><span class="op" id="2237542">]</span><span class="op" id="2237543">;</span>&nbsp;<span class="ident" id="2237545">x</span><span class="op" id="2237546">.</span><span class="ident" id="2237547">t</span>&nbsp;<span class="op" id="2237549">!=</span>&nbsp;<span class="ident" id="2237552">nil</span>&nbsp;<span class="op" id="2237556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237560">layoutCache</span><span class="op" id="2237571">.</span><span class="ident" id="2237572">RUnlock</span><span class="op" id="2237579">(</span><span class="op" id="2237580">)</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237584">return</span>&nbsp;<span class="ident" id="2237591">x</span><span class="op" id="2237592">.</span><span class="ident" id="2237593">t</span><span class="op" id="2237594">,</span>&nbsp;<span class="ident" id="2237596">x</span><span class="op" id="2237597">.</span><span class="ident" id="2237598">argSize</span><span class="op" id="2237605">,</span>&nbsp;<span class="ident" id="2237607">x</span><span class="op" id="2237608">.</span><span class="ident" id="2237609">retOffset</span><span class="op" id="2237618">,</span>&nbsp;<span class="ident" id="2237620">x</span><span class="op" id="2237621">.</span><span class="ident" id="2237622">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237632">layoutCache</span><span class="op" id="2237643">.</span><span class="ident" id="2237644">RUnlock</span><span class="op" id="2237651">(</span><span class="op" id="2237652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237655">layoutCache</span><span class="op" id="2237666">.</span><span class="ident" id="2237667">Lock</span><span class="op" id="2237671">(</span><span class="op" id="2237672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237675">if</span>&nbsp;<span class="ident" id="2237678">x</span>&nbsp;<span class="op" id="2237680">:=</span>&nbsp;<span class="ident" id="2237683">layoutCache</span><span class="op" id="2237694">.</span><span class="ident" id="2237695">m</span><span class="op" id="2237696">[</span><span class="ident" id="2237697">k</span><span class="op" id="2237698">]</span><span class="op" id="2237699">;</span>&nbsp;<span class="ident" id="2237701">x</span><span class="op" id="2237702">.</span><span class="ident" id="2237703">t</span>&nbsp;<span class="op" id="2237705">!=</span>&nbsp;<span class="ident" id="2237708">nil</span>&nbsp;<span class="op" id="2237712">{</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237716">layoutCache</span><span class="op" id="2237727">.</span><span class="ident" id="2237728">Unlock</span><span class="op" id="2237734">(</span><span class="op" id="2237735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237739">return</span>&nbsp;<span class="ident" id="2237746">x</span><span class="op" id="2237747">.</span><span class="ident" id="2237748">t</span><span class="op" id="2237749">,</span>&nbsp;<span class="ident" id="2237751">x</span><span class="op" id="2237752">.</span><span class="ident" id="2237753">argSize</span><span class="op" id="2237760">,</span>&nbsp;<span class="ident" id="2237762">x</span><span class="op" id="2237763">.</span><span class="ident" id="2237764">retOffset</span><span class="op" id="2237773">,</span>&nbsp;<span class="ident" id="2237775">x</span><span class="op" id="2237776">.</span><span class="ident" id="2237777">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237788">tt</span>&nbsp;<span class="op" id="2237791">:=</span>&nbsp;<span class="op" id="2237794">(</span><span class="op" id="2237795">*</span><span class="ident" id="2237796">funcType</span><span class="op" id="2237804">)</span><span class="op" id="2237805">(</span><span class="ident" id="2237806">unsafe</span><span class="op" id="2237812">.</span><span class="ident" id="2237813">Pointer</span><span class="op" id="2237820">(</span><span class="ident" id="2237821">t</span><span class="op" id="2237822">)</span><span class="op" id="2237823">)</span><br>
<span class="lineno">1800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2237827">//&nbsp;compute&nbsp;gc&nbsp;program&nbsp;&amp;&nbsp;stack&nbsp;bitmap&nbsp;for&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2237879">stack</span>&nbsp;<span class="op" id="2237885">=</span>&nbsp;<span class="builtinfunc" id="2237887">new</span><span class="op" id="2237890">(</span><span class="ident" id="2237891">bitVector</span><span class="op" id="2237900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237903">var</span>&nbsp;<span class="ident" id="2237907">gc</span>&nbsp;<span class="ident" id="2237910">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237918">var</span>&nbsp;<span class="ident" id="2237922">offset</span>&nbsp;<span class="builtintype" id="2237929">uintptr</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2237938">if</span>&nbsp;<span class="ident" id="2237941">rcvr</span>&nbsp;<span class="op" id="2237946">!=</span>&nbsp;<span class="ident" id="2237949">nil</span>&nbsp;<span class="op" id="2237953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2237957">//&nbsp;Reflect&nbsp;uses&nbsp;the&nbsp;&#34;interface&#34;&nbsp;calling&nbsp;convention&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2238014">//&nbsp;methods,&nbsp;where&nbsp;receivers&nbsp;take&nbsp;one&nbsp;word&nbsp;of&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2238070">//&nbsp;space&nbsp;no&nbsp;matter&nbsp;how&nbsp;big&nbsp;they&nbsp;actually&nbsp;are.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238118">if</span>&nbsp;<span class="ident" id="2238121">ifaceIndir</span><span class="op" id="2238131">(</span><span class="ident" id="2238132">rcvr</span><span class="op" id="2238136">)</span>&nbsp;<span class="op" id="2238138">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2238143">//&nbsp;we&nbsp;pass&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238184">gc</span><span class="op" id="2238186">.</span><span class="builtinfunc" id="2238187">append</span><span class="op" id="2238193">(</span><span class="ident" id="2238194">bitsPointer</span><span class="op" id="2238205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238210">stack</span><span class="op" id="2238215">.</span><span class="ident" id="2238216">append2</span><span class="op" id="2238223">(</span><span class="ident" id="2238224">bitsPointer</span><span class="op" id="2238235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238239">}</span>&nbsp;<span class="keyword" id="2238241">else</span>&nbsp;<span class="keyword" id="2238246">if</span>&nbsp;<span class="ident" id="2238249">rcvr</span><span class="op" id="2238253">.</span><span class="ident" id="2238254">pointers</span><span class="op" id="2238262">(</span><span class="op" id="2238263">)</span>&nbsp;<span class="op" id="2238265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2238270">//&nbsp;rcvr&nbsp;is&nbsp;a&nbsp;one-word&nbsp;pointer&nbsp;object.&nbsp;&nbsp;Its&nbsp;gc&nbsp;program</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2238327">//&nbsp;is&nbsp;just&nbsp;what&nbsp;we&nbsp;need&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238360">gc</span><span class="op" id="2238362">.</span><span class="builtinfunc" id="2238363">append</span><span class="op" id="2238369">(</span><span class="ident" id="2238370">bitsPointer</span><span class="op" id="2238381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238386">stack</span><span class="op" id="2238391">.</span><span class="ident" id="2238392">append2</span><span class="op" id="2238399">(</span><span class="ident" id="2238400">bitsPointer</span><span class="op" id="2238411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238415">}</span>&nbsp;<span class="keyword" id="2238417">else</span>&nbsp;<span class="op" id="2238422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238427">gc</span><span class="op" id="2238429">.</span><span class="builtinfunc" id="2238430">append</span><span class="op" id="2238436">(</span><span class="ident" id="2238437">bitsScalar</span><span class="op" id="2238447">)</span><br>
<span class="lineno">1820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238452">stack</span><span class="op" id="2238457">.</span><span class="ident" id="2238458">append2</span><span class="op" id="2238465">(</span><span class="ident" id="2238466">bitsScalar</span><span class="op" id="2238476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238484">offset</span>&nbsp;<span class="op" id="2238491">+=</span>&nbsp;<span class="ident" id="2238494">ptrSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238506">for</span>&nbsp;<span class="ident" id="2238510">_</span><span class="op" id="2238511">,</span>&nbsp;<span class="ident" id="2238513">arg</span>&nbsp;<span class="op" id="2238517">:=</span>&nbsp;<span class="keyword" id="2238520">range</span>&nbsp;<span class="ident" id="2238526">tt</span><span class="op" id="2238528">.</span><span class="ident" id="2238529">in</span>&nbsp;<span class="op" id="2238532">{</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238536">gc</span><span class="op" id="2238538">.</span><span class="ident" id="2238539">appendProg</span><span class="op" id="2238549">(</span><span class="ident" id="2238550">arg</span><span class="op" id="2238553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238557">addTypeBits</span><span class="op" id="2238568">(</span><span class="ident" id="2238569">stack</span><span class="op" id="2238574">,</span>&nbsp;<span class="op" id="2238576">&amp;</span><span class="ident" id="2238577">offset</span><span class="op" id="2238583">,</span>&nbsp;<span class="ident" id="2238585">arg</span><span class="op" id="2238588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238594">argSize</span>&nbsp;<span class="op" id="2238602">=</span>&nbsp;<span class="ident" id="2238604">gc</span><span class="op" id="2238606">.</span><span class="ident" id="2238607">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238613">if</span>&nbsp;<span class="ident" id="2238616">runtime</span><span class="op" id="2238623">.</span><span class="ident" id="2238624">GOARCH</span>&nbsp;<span class="op" id="2238631">==</span>&nbsp;<span class="string" id="2238634">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2238645">{</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238649">gc</span><span class="op" id="2238651">.</span><span class="ident" id="2238652">align</span><span class="op" id="2238657">(</span><span class="num" id="2238658">8</span><span class="op" id="2238659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238665">gc</span><span class="op" id="2238667">.</span><span class="ident" id="2238668">align</span><span class="op" id="2238673">(</span><span class="ident" id="2238674">ptrSize</span><span class="op" id="2238681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238684">retOffset</span>&nbsp;<span class="op" id="2238694">=</span>&nbsp;<span class="ident" id="2238696">gc</span><span class="op" id="2238698">.</span><span class="ident" id="2238699">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238705">for</span>&nbsp;<span class="ident" id="2238709">_</span><span class="op" id="2238710">,</span>&nbsp;<span class="ident" id="2238712">res</span>&nbsp;<span class="op" id="2238716">:=</span>&nbsp;<span class="keyword" id="2238719">range</span>&nbsp;<span class="ident" id="2238725">tt</span><span class="op" id="2238727">.</span><span class="ident" id="2238728">out</span>&nbsp;<span class="op" id="2238732">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238736">gc</span><span class="op" id="2238738">.</span><span class="ident" id="2238739">appendProg</span><span class="op" id="2238749">(</span><span class="ident" id="2238750">res</span><span class="op" id="2238753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2238757">//&nbsp;stack&nbsp;map&nbsp;does&nbsp;not&nbsp;need&nbsp;result&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238800">gc</span><span class="op" id="2238802">.</span><span class="ident" id="2238803">align</span><span class="op" id="2238808">(</span><span class="ident" id="2238809">ptrSize</span><span class="op" id="2238816">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2238820">//&nbsp;build&nbsp;dummy&nbsp;rtype&nbsp;holding&nbsp;gc&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238861">x</span>&nbsp;<span class="op" id="2238863">:=</span>&nbsp;<span class="builtinfunc" id="2238866">new</span><span class="op" id="2238869">(</span><span class="ident" id="2238870">rtype</span><span class="op" id="2238875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238878">x</span><span class="op" id="2238879">.</span><span class="ident" id="2238880">size</span>&nbsp;<span class="op" id="2238885">=</span>&nbsp;<span class="ident" id="2238887">gc</span><span class="op" id="2238889">.</span><span class="ident" id="2238890">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238896">x</span><span class="op" id="2238897">.</span><span class="ident" id="2238898">gc</span><span class="op" id="2238900">[</span><span class="num" id="2238901">0</span><span class="op" id="2238902">]</span>&nbsp;<span class="op" id="2238904">=</span>&nbsp;<span class="ident" id="2238906">gc</span><span class="op" id="2238908">.</span><span class="ident" id="2238909">finalize</span><span class="op" id="2238917">(</span><span class="op" id="2238918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238921">var</span>&nbsp;<span class="ident" id="2238925">s</span>&nbsp;<span class="builtintype" id="2238927">string</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2238935">if</span>&nbsp;<span class="ident" id="2238938">rcvr</span>&nbsp;<span class="op" id="2238943">!=</span>&nbsp;<span class="ident" id="2238946">nil</span>&nbsp;<span class="op" id="2238950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2238954">s</span>&nbsp;<span class="op" id="2238956">=</span>&nbsp;<span class="string" id="2238958">&#34;methodargs(&#34;</span>&nbsp;<span class="op" id="2238972">+</span>&nbsp;<span class="op" id="2238974">*</span><span class="ident" id="2238975">rcvr</span><span class="op" id="2238979">.</span><span class="builtintype" id="2238980">string</span>&nbsp;<span class="op" id="2238987">+</span>&nbsp;<span class="string" id="2238989">&#34;)(&#34;</span>&nbsp;<span class="op" id="2238994">+</span>&nbsp;<span class="op" id="2238996">*</span><span class="ident" id="2238997">t</span><span class="op" id="2238998">.</span><span class="builtintype" id="2238999">string</span>&nbsp;<span class="op" id="2239006">+</span>&nbsp;<span class="string" id="2239008">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239013">}</span>&nbsp;<span class="keyword" id="2239015">else</span>&nbsp;<span class="op" id="2239020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239024">s</span>&nbsp;<span class="op" id="2239026">=</span>&nbsp;<span class="string" id="2239028">&#34;funcargs(&#34;</span>&nbsp;<span class="op" id="2239040">+</span>&nbsp;<span class="op" id="2239042">*</span><span class="ident" id="2239043">t</span><span class="op" id="2239044">.</span><span class="builtintype" id="2239045">string</span>&nbsp;<span class="op" id="2239052">+</span>&nbsp;<span class="string" id="2239054">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239059">}</span><br>
<span class="lineno">1850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239062">x</span><span class="op" id="2239063">.</span><span class="builtintype" id="2239064">string</span>&nbsp;<span class="op" id="2239071">=</span>&nbsp;<span class="op" id="2239073">&amp;</span><span class="ident" id="2239074">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2239078">//&nbsp;cache&nbsp;result&nbsp;for&nbsp;future&nbsp;callers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239114">if</span>&nbsp;<span class="ident" id="2239117">layoutCache</span><span class="op" id="2239128">.</span><span class="ident" id="2239129">m</span>&nbsp;<span class="op" id="2239131">==</span>&nbsp;<span class="ident" id="2239134">nil</span>&nbsp;<span class="op" id="2239138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239142">layoutCache</span><span class="op" id="2239153">.</span><span class="ident" id="2239154">m</span>&nbsp;<span class="op" id="2239156">=</span>&nbsp;<span class="builtinfunc" id="2239158">make</span><span class="op" id="2239162">(</span><span class="keyword" id="2239163">map</span><span class="op" id="2239166">[</span><span class="ident" id="2239167">layoutKey</span><span class="op" id="2239176">]</span><span class="ident" id="2239177">layoutType</span><span class="op" id="2239187">)</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239193">layoutCache</span><span class="op" id="2239204">.</span><span class="ident" id="2239205">m</span><span class="op" id="2239206">[</span><span class="ident" id="2239207">k</span><span class="op" id="2239208">]</span>&nbsp;<span class="op" id="2239210">=</span>&nbsp;<span class="ident" id="2239212">layoutType</span><span class="op" id="2239222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239226">t</span><span class="op" id="2239227">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239237">x</span><span class="op" id="2239238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239242">argSize</span><span class="op" id="2239249">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2239253">argSize</span><span class="op" id="2239260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239264">retOffset</span><span class="op" id="2239273">:</span>&nbsp;<span class="ident" id="2239275">retOffset</span><span class="op" id="2239284">,</span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239288">stack</span><span class="op" id="2239293">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239299">stack</span><span class="op" id="2239304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239310">layoutCache</span><span class="op" id="2239321">.</span><span class="ident" id="2239322">Unlock</span><span class="op" id="2239328">(</span><span class="op" id="2239329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239332">return</span>&nbsp;<span class="ident" id="2239339">x</span><span class="op" id="2239340">,</span>&nbsp;<span class="ident" id="2239342">argSize</span><span class="op" id="2239349">,</span>&nbsp;<span class="ident" id="2239351">retOffset</span><span class="op" id="2239360">,</span>&nbsp;<span class="ident" id="2239362">stack</span><br>
<span class="lineno"></span><span class="op" id="2239368">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span><span class="comment" id="2239371">//&nbsp;ifaceIndir&nbsp;reports&nbsp;whether&nbsp;t&nbsp;is&nbsp;stored&nbsp;indirectly&nbsp;in&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="2239447">func</span>&nbsp;<span class="ident" id="2239452">ifaceIndir</span><span class="op" id="2239462">(</span><span class="ident" id="2239463">t</span>&nbsp;<span class="op" id="2239465">*</span><span class="ident" id="2239466">rtype</span><span class="op" id="2239471">)</span>&nbsp;<span class="builtintype" id="2239473">bool</span>&nbsp;<span class="op" id="2239478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239481">return</span>&nbsp;<span class="ident" id="2239488">t</span><span class="op" id="2239489">.</span><span class="ident" id="2239490">kind</span><span class="op" id="2239494">&amp;</span><span class="ident" id="2239495">kindDirectIface</span>&nbsp;<span class="op" id="2239511">==</span>&nbsp;<span class="num" id="2239514">0</span><br>
<span class="lineno"></span><span class="op" id="2239516">}</span><br>
<span class="lineno">1870</span><br>
<span class="lineno"></span><span class="comment" id="2239519">//&nbsp;Layout&nbsp;matches&nbsp;runtime.BitVector&nbsp;(well&nbsp;enough).</span><br>
<span class="lineno"></span><span class="keyword" id="2239570">type</span>&nbsp;<span class="ident" id="2239575">bitVector</span>&nbsp;<span class="keyword" id="2239585">struct</span>&nbsp;<span class="op" id="2239592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239595">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2239600">uint32</span>&nbsp;<span class="comment" id="2239607">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239626">data</span>&nbsp;<span class="op" id="2239631">[</span><span class="op" id="2239632">]</span><span class="builtintype" id="2239633">byte</span><br>
<span class="lineno">1875</span><span class="op" id="2239638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2239641">//&nbsp;append&nbsp;a&nbsp;bit&nbsp;pair&nbsp;to&nbsp;the&nbsp;bitmap.</span><br>
<span class="lineno"></span><span class="keyword" id="2239677">func</span>&nbsp;<span class="op" id="2239682">(</span><span class="ident" id="2239683">bv</span>&nbsp;<span class="op" id="2239686">*</span><span class="ident" id="2239687">bitVector</span><span class="op" id="2239696">)</span>&nbsp;<span class="ident" id="2239698">append2</span><span class="op" id="2239705">(</span><span class="ident" id="2239706">bits</span>&nbsp;<span class="builtintype" id="2239711">uint8</span><span class="op" id="2239716">)</span>&nbsp;<span class="op" id="2239718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2239721">//&nbsp;assume&nbsp;bv.n&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;2,&nbsp;since&nbsp;append2&nbsp;is&nbsp;the&nbsp;only&nbsp;operation.</span><br>
<span class="lineno">1880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239794">if</span>&nbsp;<span class="ident" id="2239797">bv</span><span class="op" id="2239799">.</span><span class="ident" id="2239800">n</span><span class="op" id="2239801">%</span><span class="num" id="2239802">8</span>&nbsp;<span class="op" id="2239804">==</span>&nbsp;<span class="num" id="2239807">0</span>&nbsp;<span class="op" id="2239809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239813">bv</span><span class="op" id="2239815">.</span><span class="ident" id="2239816">data</span>&nbsp;<span class="op" id="2239821">=</span>&nbsp;<span class="builtinfunc" id="2239823">append</span><span class="op" id="2239829">(</span><span class="ident" id="2239830">bv</span><span class="op" id="2239832">.</span><span class="ident" id="2239833">data</span><span class="op" id="2239837">,</span>&nbsp;<span class="num" id="2239839">0</span><span class="op" id="2239840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239846">bv</span><span class="op" id="2239848">.</span><span class="ident" id="2239849">data</span><span class="op" id="2239853">[</span><span class="ident" id="2239854">bv</span><span class="op" id="2239856">.</span><span class="ident" id="2239857">n</span><span class="op" id="2239858">/</span><span class="num" id="2239859">8</span><span class="op" id="2239860">]</span>&nbsp;<span class="op" id="2239862">|=</span>&nbsp;<span class="ident" id="2239865">bits</span>&nbsp;<span class="op" id="2239870">&lt;&lt;</span>&nbsp;<span class="op" id="2239873">(</span><span class="ident" id="2239874">bv</span><span class="op" id="2239876">.</span><span class="ident" id="2239877">n</span>&nbsp;<span class="op" id="2239879">%</span>&nbsp;<span class="num" id="2239881">8</span><span class="op" id="2239882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239885">bv</span><span class="op" id="2239887">.</span><span class="ident" id="2239888">n</span>&nbsp;<span class="op" id="2239890">+=</span>&nbsp;<span class="num" id="2239893">2</span><br>
<span class="lineno">1885</span><span class="op" id="2239895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2239898">func</span>&nbsp;<span class="ident" id="2239903">addTypeBits</span><span class="op" id="2239914">(</span><span class="ident" id="2239915">bv</span>&nbsp;<span class="op" id="2239918">*</span><span class="ident" id="2239919">bitVector</span><span class="op" id="2239928">,</span>&nbsp;<span class="ident" id="2239930">offset</span>&nbsp;<span class="op" id="2239937">*</span><span class="builtintype" id="2239938">uintptr</span><span class="op" id="2239945">,</span>&nbsp;<span class="ident" id="2239947">t</span>&nbsp;<span class="op" id="2239949">*</span><span class="ident" id="2239950">rtype</span><span class="op" id="2239955">)</span>&nbsp;<span class="op" id="2239957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239960">*</span><span class="ident" id="2239961">offset</span>&nbsp;<span class="op" id="2239968">=</span>&nbsp;<span class="ident" id="2239970">align</span><span class="op" id="2239975">(</span><span class="op" id="2239976">*</span><span class="ident" id="2239977">offset</span><span class="op" id="2239983">,</span>&nbsp;<span class="builtintype" id="2239985">uintptr</span><span class="op" id="2239992">(</span><span class="ident" id="2239993">t</span><span class="op" id="2239994">.</span><span class="ident" id="2239995">align</span><span class="op" id="2240000">)</span><span class="op" id="2240001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240004">if</span>&nbsp;<span class="ident" id="2240007">t</span><span class="op" id="2240008">.</span><span class="ident" id="2240009">kind</span><span class="op" id="2240013">&amp;</span><span class="ident" id="2240014">kindNoPointers</span>&nbsp;<span class="op" id="2240029">!=</span>&nbsp;<span class="num" id="2240032">0</span>&nbsp;<span class="op" id="2240034">{</span><br>
<span class="lineno">1890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240038">*</span><span class="ident" id="2240039">offset</span>&nbsp;<span class="op" id="2240046">+=</span>&nbsp;<span class="ident" id="2240049">t</span><span class="op" id="2240050">.</span><span class="ident" id="2240051">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240058">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240070">switch</span>&nbsp;<span class="ident" id="2240077">Kind</span><span class="op" id="2240081">(</span><span class="ident" id="2240082">t</span><span class="op" id="2240083">.</span><span class="ident" id="2240084">kind</span>&nbsp;<span class="op" id="2240089">&amp;</span>&nbsp;<span class="ident" id="2240091">kindMask</span><span class="op" id="2240099">)</span>&nbsp;<span class="op" id="2240101">{</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240104">case</span>&nbsp;<span class="ident" id="2240109">Chan</span><span class="op" id="2240113">,</span>&nbsp;<span class="ident" id="2240115">Func</span><span class="op" id="2240119">,</span>&nbsp;<span class="ident" id="2240121">Map</span><span class="op" id="2240124">,</span>&nbsp;<span class="ident" id="2240126">Ptr</span><span class="op" id="2240129">,</span>&nbsp;<span class="ident" id="2240131">Slice</span><span class="op" id="2240136">,</span>&nbsp;<span class="ident" id="2240138">String</span><span class="op" id="2240144">,</span>&nbsp;<span class="ident" id="2240146">UnsafePointer</span><span class="op" id="2240159">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240163">//&nbsp;1&nbsp;pointer&nbsp;at&nbsp;start&nbsp;of&nbsp;representation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240205">for</span>&nbsp;<span class="ident" id="2240209">bv</span><span class="op" id="2240211">.</span><span class="ident" id="2240212">n</span>&nbsp;<span class="op" id="2240214">&lt;</span>&nbsp;<span class="num" id="2240216">2</span><span class="op" id="2240217">*</span><span class="builtintype" id="2240218">uint32</span><span class="op" id="2240224">(</span><span class="op" id="2240225">*</span><span class="ident" id="2240226">offset</span><span class="op" id="2240232">/</span><span class="builtintype" id="2240233">uintptr</span><span class="op" id="2240240">(</span><span class="ident" id="2240241">ptrSize</span><span class="op" id="2240248">)</span><span class="op" id="2240249">)</span>&nbsp;<span class="op" id="2240251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240256">bv</span><span class="op" id="2240258">.</span><span class="ident" id="2240259">append2</span><span class="op" id="2240266">(</span><span class="ident" id="2240267">bitsScalar</span><span class="op" id="2240277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240281">}</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240285">bv</span><span class="op" id="2240287">.</span><span class="ident" id="2240288">append2</span><span class="op" id="2240295">(</span><span class="ident" id="2240296">bitsPointer</span><span class="op" id="2240307">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240311">case</span>&nbsp;<span class="ident" id="2240316">Interface</span><span class="op" id="2240325">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240329">//&nbsp;2&nbsp;pointers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240345">for</span>&nbsp;<span class="ident" id="2240349">bv</span><span class="op" id="2240351">.</span><span class="ident" id="2240352">n</span>&nbsp;<span class="op" id="2240354">&lt;</span>&nbsp;<span class="num" id="2240356">2</span><span class="op" id="2240357">*</span><span class="builtintype" id="2240358">uint32</span><span class="op" id="2240364">(</span><span class="op" id="2240365">*</span><span class="ident" id="2240366">offset</span><span class="op" id="2240372">/</span><span class="builtintype" id="2240373">uintptr</span><span class="op" id="2240380">(</span><span class="ident" id="2240381">ptrSize</span><span class="op" id="2240388">)</span><span class="op" id="2240389">)</span>&nbsp;<span class="op" id="2240391">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240396">bv</span><span class="op" id="2240398">.</span><span class="ident" id="2240399">append2</span><span class="op" id="2240406">(</span><span class="ident" id="2240407">bitsScalar</span><span class="op" id="2240417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240425">bv</span><span class="op" id="2240427">.</span><span class="ident" id="2240428">append2</span><span class="op" id="2240435">(</span><span class="ident" id="2240436">bitsPointer</span><span class="op" id="2240447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240451">bv</span><span class="op" id="2240453">.</span><span class="ident" id="2240454">append2</span><span class="op" id="2240461">(</span><span class="ident" id="2240462">bitsPointer</span><span class="op" id="2240473">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240477">case</span>&nbsp;<span class="ident" id="2240482">Array</span><span class="op" id="2240487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240491">//&nbsp;repeat&nbsp;inner&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240514">tt</span>&nbsp;<span class="op" id="2240517">:=</span>&nbsp;<span class="op" id="2240520">(</span><span class="op" id="2240521">*</span><span class="ident" id="2240522">arrayType</span><span class="op" id="2240531">)</span><span class="op" id="2240532">(</span><span class="ident" id="2240533">unsafe</span><span class="op" id="2240539">.</span><span class="ident" id="2240540">Pointer</span><span class="op" id="2240547">(</span><span class="ident" id="2240548">t</span><span class="op" id="2240549">)</span><span class="op" id="2240550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240554">for</span>&nbsp;<span class="ident" id="2240558">i</span>&nbsp;<span class="op" id="2240560">:=</span>&nbsp;<span class="num" id="2240563">0</span><span class="op" id="2240564">;</span>&nbsp;<span class="ident" id="2240566">i</span>&nbsp;<span class="op" id="2240568">&lt;</span>&nbsp;<span class="builtintype" id="2240570">int</span><span class="op" id="2240573">(</span><span class="ident" id="2240574">tt</span><span class="op" id="2240576">.</span><span class="builtinfunc" id="2240577">len</span><span class="op" id="2240580">)</span><span class="op" id="2240581">;</span>&nbsp;<span class="ident" id="2240583">i</span><span class="op" id="2240584">++</span>&nbsp;<span class="op" id="2240587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240592">addTypeBits</span><span class="op" id="2240603">(</span><span class="ident" id="2240604">bv</span><span class="op" id="2240606">,</span>&nbsp;<span class="ident" id="2240608">offset</span><span class="op" id="2240614">,</span>&nbsp;<span class="ident" id="2240616">tt</span><span class="op" id="2240618">.</span><span class="ident" id="2240619">elem</span><span class="op" id="2240623">)</span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240631">case</span>&nbsp;<span class="ident" id="2240636">Struct</span><span class="op" id="2240642">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240646">//&nbsp;apply&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240664">tt</span>&nbsp;<span class="op" id="2240667">:=</span>&nbsp;<span class="op" id="2240670">(</span><span class="op" id="2240671">*</span><span class="ident" id="2240672">structType</span><span class="op" id="2240682">)</span><span class="op" id="2240683">(</span><span class="ident" id="2240684">unsafe</span><span class="op" id="2240690">.</span><span class="ident" id="2240691">Pointer</span><span class="op" id="2240698">(</span><span class="ident" id="2240699">t</span><span class="op" id="2240700">)</span><span class="op" id="2240701">)</span><br>
<span class="lineno">1920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240705">start</span>&nbsp;<span class="op" id="2240711">:=</span>&nbsp;<span class="op" id="2240714">*</span><span class="ident" id="2240715">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240724">for</span>&nbsp;<span class="ident" id="2240728">i</span>&nbsp;<span class="op" id="2240730">:=</span>&nbsp;<span class="keyword" id="2240733">range</span>&nbsp;<span class="ident" id="2240739">tt</span><span class="op" id="2240741">.</span><span class="ident" id="2240742">fields</span>&nbsp;<span class="op" id="2240749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240754">f</span>&nbsp;<span class="op" id="2240756">:=</span>&nbsp;<span class="op" id="2240759">&amp;</span><span class="ident" id="2240760">tt</span><span class="op" id="2240762">.</span><span class="ident" id="2240763">fields</span><span class="op" id="2240769">[</span><span class="ident" id="2240770">i</span><span class="op" id="2240771">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240776">off</span>&nbsp;<span class="op" id="2240780">:=</span>&nbsp;<span class="ident" id="2240783">start</span>&nbsp;<span class="op" id="2240789">+</span>&nbsp;<span class="ident" id="2240791">f</span><span class="op" id="2240792">.</span><span class="ident" id="2240793">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240803">addTypeBits</span><span class="op" id="2240814">(</span><span class="ident" id="2240815">bv</span><span class="op" id="2240817">,</span>&nbsp;<span class="op" id="2240819">&amp;</span><span class="ident" id="2240820">off</span><span class="op" id="2240823">,</span>&nbsp;<span class="ident" id="2240825">f</span><span class="op" id="2240826">.</span><span class="ident" id="2240827">typ</span><span class="op" id="2240830">)</span><br>
<span class="lineno">1925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240841">*</span><span class="ident" id="2240842">offset</span>&nbsp;<span class="op" id="2240849">+=</span>&nbsp;<span class="ident" id="2240852">t</span><span class="op" id="2240853">.</span><span class="ident" id="2240854">size</span><br>
<span class="lineno"></span><span class="op" id="2240859">}</span>
</div>
</body>
</html>
