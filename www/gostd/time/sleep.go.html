<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2817044">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2817099">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2817153">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2817204">package</span>&nbsp;<span class="ident" id="2817212">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2817218">//&nbsp;Sleep&nbsp;pauses&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;for&nbsp;at&nbsp;least&nbsp;the&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="2817285">//&nbsp;A&nbsp;negative&nbsp;or&nbsp;zero&nbsp;duration&nbsp;causes&nbsp;Sleep&nbsp;to&nbsp;return&nbsp;immediately.</span><br>
<span class="lineno"></span><span class="keyword" id="2817352">func</span>&nbsp;<span class="ident" id="2817357">Sleep</span><span class="op" id="2817362">(</span><span class="ident" id="2817363">d</span>&nbsp;<span class="ident" id="2817365">Duration</span><span class="op" id="2817373">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2817376">//&nbsp;runtimeNano&nbsp;returns&nbsp;the&nbsp;current&nbsp;value&nbsp;of&nbsp;the&nbsp;runtime&nbsp;clock&nbsp;in&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="2817454">func</span>&nbsp;<span class="ident" id="2817459">runtimeNano</span><span class="op" id="2817470">(</span><span class="op" id="2817471">)</span>&nbsp;<span class="ident" id="2817473">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2817480">//&nbsp;Interface&nbsp;to&nbsp;timers&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno">15</span><span class="comment" id="2817535">//&nbsp;Must&nbsp;be&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/runtime.h:/^struct.Timer$</span><br>
<span class="lineno"></span><span class="keyword" id="2817596">type</span>&nbsp;<span class="ident" id="2817601">runtimeTimer</span>&nbsp;<span class="keyword" id="2817614">struct</span>&nbsp;<span class="op" id="2817621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817624">i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2817631">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817636">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2817643">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817650">period</span>&nbsp;<span class="ident" id="2817657">int64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817664">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817671">func</span><span class="op" id="2817675">(</span><span class="keyword" id="2817676">interface</span><span class="op" id="2817685">{</span><span class="op" id="2817686">}</span><span class="op" id="2817687">,</span>&nbsp;<span class="builtintype" id="2817689">uintptr</span><span class="op" id="2817696">)</span>&nbsp;<span class="comment" id="2817698">//&nbsp;NOTE:&nbsp;must&nbsp;not&nbsp;be&nbsp;closure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817728">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2817735">interface</span><span class="op" id="2817744">{</span><span class="op" id="2817745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2817748">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2817755">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2817763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2817766">//&nbsp;when&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;setting&nbsp;the&nbsp;&#39;when&#39;&nbsp;field&nbsp;of&nbsp;a&nbsp;runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="2817843">//&nbsp;It&nbsp;returns&nbsp;what&nbsp;the&nbsp;time&nbsp;will&nbsp;be,&nbsp;in&nbsp;nanoseconds,&nbsp;Duration&nbsp;d&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span><span class="comment" id="2817922">//&nbsp;If&nbsp;d&nbsp;is&nbsp;negative,&nbsp;it&nbsp;is&nbsp;ignored.&nbsp;&nbsp;If&nbsp;the&nbsp;returned&nbsp;value&nbsp;would&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2818000">//&nbsp;zero&nbsp;because&nbsp;of&nbsp;an&nbsp;overflow,&nbsp;MaxInt64&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span><span class="keyword" id="2818054">func</span>&nbsp;<span class="ident" id="2818059">when</span><span class="op" id="2818063">(</span><span class="ident" id="2818064">d</span>&nbsp;<span class="ident" id="2818066">Duration</span><span class="op" id="2818074">)</span>&nbsp;<span class="ident" id="2818076">int64</span>&nbsp;<span class="op" id="2818082">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818085">if</span>&nbsp;<span class="ident" id="2818088">d</span>&nbsp;<span class="op" id="2818090">&lt;=</span>&nbsp;<span class="num" id="2818093">0</span>&nbsp;<span class="op" id="2818095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818099">return</span>&nbsp;<span class="ident" id="2818106">runtimeNano</span><span class="op" id="2818117">(</span><span class="op" id="2818118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818124">t</span>&nbsp;<span class="op" id="2818126">:=</span>&nbsp;<span class="ident" id="2818129">runtimeNano</span><span class="op" id="2818140">(</span><span class="op" id="2818141">)</span>&nbsp;<span class="op" id="2818143">+</span>&nbsp;<span class="ident" id="2818145">int64</span><span class="op" id="2818150">(</span><span class="ident" id="2818151">d</span><span class="op" id="2818152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818155">if</span>&nbsp;<span class="ident" id="2818158">t</span>&nbsp;<span class="op" id="2818160">&lt;</span>&nbsp;<span class="num" id="2818162">0</span>&nbsp;<span class="op" id="2818164">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818168">t</span>&nbsp;<span class="op" id="2818170">=</span>&nbsp;<span class="num" id="2818172">1</span><span class="op" id="2818173">&lt;&lt;</span><span class="num" id="2818175">63</span>&nbsp;<span class="op" id="2818178">-</span>&nbsp;<span class="num" id="2818180">1</span>&nbsp;<span class="comment" id="2818182">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818203">return</span>&nbsp;<span class="ident" id="2818210">t</span><br>
<span class="lineno"></span><span class="op" id="2818212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2818215">func</span>&nbsp;<span class="ident" id="2818220">startTimer</span><span class="op" id="2818230">(</span><span class="op" id="2818231">*</span><span class="ident" id="2818232">runtimeTimer</span><span class="op" id="2818244">)</span><br>
<span class="lineno"></span><span class="keyword" id="2818246">func</span>&nbsp;<span class="ident" id="2818251">stopTimer</span><span class="op" id="2818260">(</span><span class="op" id="2818261">*</span><span class="ident" id="2818262">runtimeTimer</span><span class="op" id="2818274">)</span>&nbsp;<span class="builtintype" id="2818276">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2818282">//&nbsp;The&nbsp;Timer&nbsp;type&nbsp;represents&nbsp;a&nbsp;single&nbsp;event.</span><br>
<span class="lineno"></span><span class="comment" id="2818327">//&nbsp;When&nbsp;the&nbsp;Timer&nbsp;expires,&nbsp;the&nbsp;current&nbsp;time&nbsp;will&nbsp;be&nbsp;sent&nbsp;on&nbsp;C,</span><br>
<span class="lineno">45</span><span class="comment" id="2818390">//&nbsp;unless&nbsp;the&nbsp;Timer&nbsp;was&nbsp;created&nbsp;by&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="comment" id="2818436">//&nbsp;A&nbsp;Timer&nbsp;must&nbsp;be&nbsp;created&nbsp;with&nbsp;NewTimer&nbsp;or&nbsp;AfterFunc.</span><br>
<span class="lineno"></span><span class="keyword" id="2818491">type</span>&nbsp;<span class="ident" id="2818496">Timer</span>&nbsp;<span class="keyword" id="2818502">struct</span>&nbsp;<span class="op" id="2818509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818512">C</span>&nbsp;<span class="op" id="2818514">&lt;-</span><span class="keyword" id="2818516">chan</span>&nbsp;<span class="ident" id="2818521">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2818527">r</span>&nbsp;<span class="ident" id="2818529">runtimeTimer</span><br>
<span class="lineno">50</span><span class="op" id="2818542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2818545">//&nbsp;Stop&nbsp;prevents&nbsp;the&nbsp;Timer&nbsp;from&nbsp;firing.</span><br>
<span class="lineno"></span><span class="comment" id="2818585">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;call&nbsp;stops&nbsp;the&nbsp;timer,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;has&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="2818664">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno">55</span><span class="comment" id="2818692">//&nbsp;Stop&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;channel,&nbsp;to&nbsp;prevent&nbsp;a&nbsp;read&nbsp;from&nbsp;the&nbsp;channel&nbsp;succeeding</span><br>
<span class="lineno"></span><span class="comment" id="2818774">//&nbsp;incorrectly.</span><br>
<span class="lineno"></span><span class="keyword" id="2818790">func</span>&nbsp;<span class="op" id="2818795">(</span><span class="ident" id="2818796">t</span>&nbsp;<span class="op" id="2818798">*</span><span class="ident" id="2818799">Timer</span><span class="op" id="2818804">)</span>&nbsp;<span class="ident" id="2818806">Stop</span><span class="op" id="2818810">(</span><span class="op" id="2818811">)</span>&nbsp;<span class="builtintype" id="2818813">bool</span>&nbsp;<span class="op" id="2818818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818821">if</span>&nbsp;<span class="ident" id="2818824">t</span><span class="op" id="2818825">.</span><span class="ident" id="2818826">r</span><span class="op" id="2818827">.</span><span class="ident" id="2818828">f</span>&nbsp;<span class="op" id="2818830">==</span>&nbsp;<span class="ident" id="2818833">nil</span>&nbsp;<span class="op" id="2818837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2818841">panic</span><span class="op" id="2818846">(</span><span class="string" id="2818847">&#34;time:&nbsp;Stop&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="2818889">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2818892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2818895">return</span>&nbsp;<span class="ident" id="2818902">stopTimer</span><span class="op" id="2818911">(</span><span class="op" id="2818912">&amp;</span><span class="ident" id="2818913">t</span><span class="op" id="2818914">.</span><span class="ident" id="2818915">r</span><span class="op" id="2818916">)</span><br>
<span class="lineno"></span><span class="op" id="2818918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2818921">//&nbsp;NewTimer&nbsp;creates&nbsp;a&nbsp;new&nbsp;Timer&nbsp;that&nbsp;will&nbsp;send</span><br>
<span class="lineno">65</span><span class="comment" id="2818968">//&nbsp;the&nbsp;current&nbsp;time&nbsp;on&nbsp;its&nbsp;channel&nbsp;after&nbsp;at&nbsp;least&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="keyword" id="2819030">func</span>&nbsp;<span class="ident" id="2819035">NewTimer</span><span class="op" id="2819043">(</span><span class="ident" id="2819044">d</span>&nbsp;<span class="ident" id="2819046">Duration</span><span class="op" id="2819054">)</span>&nbsp;<span class="op" id="2819056">*</span><span class="ident" id="2819057">Timer</span>&nbsp;<span class="op" id="2819063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819066">c</span>&nbsp;<span class="op" id="2819068">:=</span>&nbsp;<span class="builtinfunc" id="2819071">make</span><span class="op" id="2819075">(</span><span class="keyword" id="2819076">chan</span>&nbsp;<span class="ident" id="2819081">Time</span><span class="op" id="2819085">,</span>&nbsp;<span class="num" id="2819087">1</span><span class="op" id="2819088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819091">t</span>&nbsp;<span class="op" id="2819093">:=</span>&nbsp;<span class="op" id="2819096">&amp;</span><span class="ident" id="2819097">Timer</span><span class="op" id="2819102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819106">C</span><span class="op" id="2819107">:</span>&nbsp;<span class="ident" id="2819109">c</span><span class="op" id="2819110">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819114">r</span><span class="op" id="2819115">:</span>&nbsp;<span class="ident" id="2819117">runtimeTimer</span><span class="op" id="2819129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819134">when</span><span class="op" id="2819138">:</span>&nbsp;<span class="ident" id="2819140">when</span><span class="op" id="2819144">(</span><span class="ident" id="2819145">d</span><span class="op" id="2819146">)</span><span class="op" id="2819147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819152">f</span><span class="op" id="2819153">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2819158">sendTime</span><span class="op" id="2819166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819171">arg</span><span class="op" id="2819174">:</span>&nbsp;&nbsp;<span class="ident" id="2819177">c</span><span class="op" id="2819178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2819182">}</span><span class="op" id="2819183">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2819186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819189">startTimer</span><span class="op" id="2819199">(</span><span class="op" id="2819200">&amp;</span><span class="ident" id="2819201">t</span><span class="op" id="2819202">.</span><span class="ident" id="2819203">r</span><span class="op" id="2819204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819207">return</span>&nbsp;<span class="ident" id="2819214">t</span><br>
<span class="lineno"></span><span class="op" id="2819216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="2819219">//&nbsp;Reset&nbsp;changes&nbsp;the&nbsp;timer&nbsp;to&nbsp;expire&nbsp;after&nbsp;duration&nbsp;d.</span><br>
<span class="lineno"></span><span class="comment" id="2819274">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;timer&nbsp;had&nbsp;been&nbsp;active,&nbsp;false&nbsp;if&nbsp;the&nbsp;timer&nbsp;had</span><br>
<span class="lineno"></span><span class="comment" id="2819346">//&nbsp;expired&nbsp;or&nbsp;been&nbsp;stopped.</span><br>
<span class="lineno"></span><span class="keyword" id="2819374">func</span>&nbsp;<span class="op" id="2819379">(</span><span class="ident" id="2819380">t</span>&nbsp;<span class="op" id="2819382">*</span><span class="ident" id="2819383">Timer</span><span class="op" id="2819388">)</span>&nbsp;<span class="ident" id="2819390">Reset</span><span class="op" id="2819395">(</span><span class="ident" id="2819396">d</span>&nbsp;<span class="ident" id="2819398">Duration</span><span class="op" id="2819406">)</span>&nbsp;<span class="builtintype" id="2819408">bool</span>&nbsp;<span class="op" id="2819413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819416">if</span>&nbsp;<span class="ident" id="2819419">t</span><span class="op" id="2819420">.</span><span class="ident" id="2819421">r</span><span class="op" id="2819422">.</span><span class="ident" id="2819423">f</span>&nbsp;<span class="op" id="2819425">==</span>&nbsp;<span class="ident" id="2819428">nil</span>&nbsp;<span class="op" id="2819432">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2819436">panic</span><span class="op" id="2819441">(</span><span class="string" id="2819442">&#34;time:&nbsp;Reset&nbsp;called&nbsp;on&nbsp;uninitialized&nbsp;Timer&#34;</span><span class="op" id="2819485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2819488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819491">w</span>&nbsp;<span class="op" id="2819493">:=</span>&nbsp;<span class="ident" id="2819496">when</span><span class="op" id="2819500">(</span><span class="ident" id="2819501">d</span><span class="op" id="2819502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819505">active</span>&nbsp;<span class="op" id="2819512">:=</span>&nbsp;<span class="ident" id="2819515">stopTimer</span><span class="op" id="2819524">(</span><span class="op" id="2819525">&amp;</span><span class="ident" id="2819526">t</span><span class="op" id="2819527">.</span><span class="ident" id="2819528">r</span><span class="op" id="2819529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819532">t</span><span class="op" id="2819533">.</span><span class="ident" id="2819534">r</span><span class="op" id="2819535">.</span><span class="ident" id="2819536">when</span>&nbsp;<span class="op" id="2819541">=</span>&nbsp;<span class="ident" id="2819543">w</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2819546">startTimer</span><span class="op" id="2819556">(</span><span class="op" id="2819557">&amp;</span><span class="ident" id="2819558">t</span><span class="op" id="2819559">.</span><span class="ident" id="2819560">r</span><span class="op" id="2819561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819564">return</span>&nbsp;<span class="ident" id="2819571">active</span><br>
<span class="lineno"></span><span class="op" id="2819578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2819581">func</span>&nbsp;<span class="ident" id="2819586">sendTime</span><span class="op" id="2819594">(</span><span class="ident" id="2819595">c</span>&nbsp;<span class="keyword" id="2819597">interface</span><span class="op" id="2819606">{</span><span class="op" id="2819607">}</span><span class="op" id="2819608">,</span>&nbsp;<span class="ident" id="2819610">seq</span>&nbsp;<span class="builtintype" id="2819614">uintptr</span><span class="op" id="2819621">)</span>&nbsp;<span class="op" id="2819623">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2819626">//&nbsp;Non-blocking&nbsp;send&nbsp;of&nbsp;time&nbsp;on&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2819662">//&nbsp;Used&nbsp;in&nbsp;NewTimer,&nbsp;it&nbsp;cannot&nbsp;block&nbsp;anyway&nbsp;(buffer).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2819717">//&nbsp;Used&nbsp;in&nbsp;NewTicker,&nbsp;dropping&nbsp;sends&nbsp;on&nbsp;the&nbsp;floor&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2819771">//&nbsp;the&nbsp;desired&nbsp;behavior&nbsp;when&nbsp;the&nbsp;reader&nbsp;gets&nbsp;behind,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2819825">//&nbsp;because&nbsp;the&nbsp;sends&nbsp;are&nbsp;periodic.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819861">select</span>&nbsp;<span class="op" id="2819868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819871">case</span>&nbsp;<span class="ident" id="2819876">c</span><span class="op" id="2819877">.</span><span class="op" id="2819878">(</span><span class="keyword" id="2819879">chan</span>&nbsp;<span class="ident" id="2819884">Time</span><span class="op" id="2819888">)</span>&nbsp;<span class="op" id="2819890">&lt;-</span>&nbsp;<span class="ident" id="2819893">Now</span><span class="op" id="2819896">(</span><span class="op" id="2819897">)</span><span class="op" id="2819898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2819901">default</span><span class="op" id="2819908">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2819911">}</span><br>
<span class="lineno"></span><span class="op" id="2819913">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="2819916">//&nbsp;After&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;sends&nbsp;the&nbsp;current&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2819990">//&nbsp;on&nbsp;the&nbsp;returned&nbsp;channel.</span><br>
<span class="lineno"></span><span class="comment" id="2820018">//&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;NewTimer(d).C.</span><br>
<span class="lineno"></span><span class="keyword" id="2820056">func</span>&nbsp;<span class="ident" id="2820061">After</span><span class="op" id="2820066">(</span><span class="ident" id="2820067">d</span>&nbsp;<span class="ident" id="2820069">Duration</span><span class="op" id="2820077">)</span>&nbsp;<span class="op" id="2820079">&lt;-</span><span class="keyword" id="2820081">chan</span>&nbsp;<span class="ident" id="2820086">Time</span>&nbsp;<span class="op" id="2820091">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820094">return</span>&nbsp;<span class="ident" id="2820101">NewTimer</span><span class="op" id="2820109">(</span><span class="ident" id="2820110">d</span><span class="op" id="2820111">)</span><span class="op" id="2820112">.</span><span class="ident" id="2820113">C</span><br>
<span class="lineno"></span><span class="op" id="2820115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2820118">//&nbsp;AfterFunc&nbsp;waits&nbsp;for&nbsp;the&nbsp;duration&nbsp;to&nbsp;elapse&nbsp;and&nbsp;then&nbsp;calls&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="2820181">//&nbsp;in&nbsp;its&nbsp;own&nbsp;goroutine.&nbsp;It&nbsp;returns&nbsp;a&nbsp;Timer&nbsp;that&nbsp;can</span><br>
<span class="lineno">115</span><span class="comment" id="2820234">//&nbsp;be&nbsp;used&nbsp;to&nbsp;cancel&nbsp;the&nbsp;call&nbsp;using&nbsp;its&nbsp;Stop&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2820287">func</span>&nbsp;<span class="ident" id="2820292">AfterFunc</span><span class="op" id="2820301">(</span><span class="ident" id="2820302">d</span>&nbsp;<span class="ident" id="2820304">Duration</span><span class="op" id="2820312">,</span>&nbsp;<span class="ident" id="2820314">f</span>&nbsp;<span class="keyword" id="2820316">func</span><span class="op" id="2820320">(</span><span class="op" id="2820321">)</span><span class="op" id="2820322">)</span>&nbsp;<span class="op" id="2820324">*</span><span class="ident" id="2820325">Timer</span>&nbsp;<span class="op" id="2820331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820334">t</span>&nbsp;<span class="op" id="2820336">:=</span>&nbsp;<span class="op" id="2820339">&amp;</span><span class="ident" id="2820340">Timer</span><span class="op" id="2820345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820349">r</span><span class="op" id="2820350">:</span>&nbsp;<span class="ident" id="2820352">runtimeTimer</span><span class="op" id="2820364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820369">when</span><span class="op" id="2820373">:</span>&nbsp;<span class="ident" id="2820375">when</span><span class="op" id="2820379">(</span><span class="ident" id="2820380">d</span><span class="op" id="2820381">)</span><span class="op" id="2820382">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820387">f</span><span class="op" id="2820388">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2820393">goFunc</span><span class="op" id="2820399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820404">arg</span><span class="op" id="2820407">:</span>&nbsp;&nbsp;<span class="ident" id="2820410">f</span><span class="op" id="2820411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2820415">}</span><span class="op" id="2820416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2820419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2820422">startTimer</span><span class="op" id="2820432">(</span><span class="op" id="2820433">&amp;</span><span class="ident" id="2820434">t</span><span class="op" id="2820435">.</span><span class="ident" id="2820436">r</span><span class="op" id="2820437">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820440">return</span>&nbsp;<span class="ident" id="2820447">t</span><br>
<span class="lineno"></span><span class="op" id="2820449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2820452">func</span>&nbsp;<span class="ident" id="2820457">goFunc</span><span class="op" id="2820463">(</span><span class="ident" id="2820464">arg</span>&nbsp;<span class="keyword" id="2820468">interface</span><span class="op" id="2820477">{</span><span class="op" id="2820478">}</span><span class="op" id="2820479">,</span>&nbsp;<span class="ident" id="2820481">seq</span>&nbsp;<span class="builtintype" id="2820485">uintptr</span><span class="op" id="2820492">)</span>&nbsp;<span class="op" id="2820494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2820497">go</span>&nbsp;<span class="ident" id="2820500">arg</span><span class="op" id="2820503">.</span><span class="op" id="2820504">(</span><span class="keyword" id="2820505">func</span><span class="op" id="2820509">(</span><span class="op" id="2820510">)</span><span class="op" id="2820511">)</span><span class="op" id="2820512">(</span><span class="op" id="2820513">)</span><br>
<span class="lineno">130</span><span class="op" id="2820515">}</span>
</div>
</body>
</html>
