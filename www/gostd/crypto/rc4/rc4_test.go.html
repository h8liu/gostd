<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rc4</h2>
<ul>
<li><a href="/gostd/crypto/rc4/rc4.go.html">rc4.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_asm.go.html">rc4_asm.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_test.go.html" class="current">rc4_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7454351">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7454406">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7454460">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7454511">package</span>&nbsp;<span class="ident" id="7454519">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7454524">import</span>&nbsp;<span class="op" id="7454531">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7454534">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7454543">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7454550">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7454560">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7454563">type</span>&nbsp;<span class="ident" id="7454568">rc4Test</span>&nbsp;<span class="keyword" id="7454576">struct</span>&nbsp;<span class="op" id="7454583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7454586">key</span><span class="op" id="7454589">,</span>&nbsp;<span class="ident" id="7454591">keystream</span>&nbsp;<span class="op" id="7454601">[</span><span class="op" id="7454602">]</span><span class="builtintype" id="7454603">byte</span><br>
<span class="lineno">15</span><span class="op" id="7454608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7454611">var</span>&nbsp;<span class="ident" id="7454615">golden</span>&nbsp;<span class="op" id="7454622">=</span>&nbsp;<span class="op" id="7454624">[</span><span class="op" id="7454625">]</span><span class="ident" id="7454626"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454568">rc4Test</a></span><span class="op" id="7454633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7454636">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7454699">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7454773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7454777">[</span><span class="op" id="7454778">]</span><span class="builtintype" id="7454779">byte</span><span class="op" id="7454783">{</span><span class="num" id="7454784">0x01</span><span class="op" id="7454788">,</span>&nbsp;<span class="num" id="7454790">0x23</span><span class="op" id="7454794">,</span>&nbsp;<span class="num" id="7454796">0x45</span><span class="op" id="7454800">,</span>&nbsp;<span class="num" id="7454802">0x67</span><span class="op" id="7454806">,</span>&nbsp;<span class="num" id="7454808">0x89</span><span class="op" id="7454812">,</span>&nbsp;<span class="num" id="7454814">0xab</span><span class="op" id="7454818">,</span>&nbsp;<span class="num" id="7454820">0xcd</span><span class="op" id="7454824">,</span>&nbsp;<span class="num" id="7454826">0xef</span><span class="op" id="7454830">}</span><span class="op" id="7454831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7454835">[</span><span class="op" id="7454836">]</span><span class="builtintype" id="7454837">byte</span><span class="op" id="7454841">{</span><span class="num" id="7454842">0x74</span><span class="op" id="7454846">,</span>&nbsp;<span class="num" id="7454848">0x94</span><span class="op" id="7454852">,</span>&nbsp;<span class="num" id="7454854">0xc2</span><span class="op" id="7454858">,</span>&nbsp;<span class="num" id="7454860">0xe7</span><span class="op" id="7454864">,</span>&nbsp;<span class="num" id="7454866">0x10</span><span class="op" id="7454870">,</span>&nbsp;<span class="num" id="7454872">0x4b</span><span class="op" id="7454876">,</span>&nbsp;<span class="num" id="7454878">0x08</span><span class="op" id="7454882">,</span>&nbsp;<span class="num" id="7454884">0x79</span><span class="op" id="7454888">}</span><span class="op" id="7454889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7454892">}</span><span class="op" id="7454893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7454896">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7454900">[</span><span class="op" id="7454901">]</span><span class="builtintype" id="7454902">byte</span><span class="op" id="7454906">{</span><span class="num" id="7454907">0x00</span><span class="op" id="7454911">,</span>&nbsp;<span class="num" id="7454913">0x00</span><span class="op" id="7454917">,</span>&nbsp;<span class="num" id="7454919">0x00</span><span class="op" id="7454923">,</span>&nbsp;<span class="num" id="7454925">0x00</span><span class="op" id="7454929">,</span>&nbsp;<span class="num" id="7454931">0x00</span><span class="op" id="7454935">,</span>&nbsp;<span class="num" id="7454937">0x00</span><span class="op" id="7454941">,</span>&nbsp;<span class="num" id="7454943">0x00</span><span class="op" id="7454947">,</span>&nbsp;<span class="num" id="7454949">0x00</span><span class="op" id="7454953">}</span><span class="op" id="7454954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7454958">[</span><span class="op" id="7454959">]</span><span class="builtintype" id="7454960">byte</span><span class="op" id="7454964">{</span><span class="num" id="7454965">0xde</span><span class="op" id="7454969">,</span>&nbsp;<span class="num" id="7454971">0x18</span><span class="op" id="7454975">,</span>&nbsp;<span class="num" id="7454977">0x89</span><span class="op" id="7454981">,</span>&nbsp;<span class="num" id="7454983">0x41</span><span class="op" id="7454987">,</span>&nbsp;<span class="num" id="7454989">0xa3</span><span class="op" id="7454993">,</span>&nbsp;<span class="num" id="7454995">0x37</span><span class="op" id="7454999">,</span>&nbsp;<span class="num" id="7455001">0x5d</span><span class="op" id="7455005">,</span>&nbsp;<span class="num" id="7455007">0x3a</span><span class="op" id="7455011">}</span><span class="op" id="7455012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455015">}</span><span class="op" id="7455016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455023">[</span><span class="op" id="7455024">]</span><span class="builtintype" id="7455025">byte</span><span class="op" id="7455029">{</span><span class="num" id="7455030">0xef</span><span class="op" id="7455034">,</span>&nbsp;<span class="num" id="7455036">0x01</span><span class="op" id="7455040">,</span>&nbsp;<span class="num" id="7455042">0x23</span><span class="op" id="7455046">,</span>&nbsp;<span class="num" id="7455048">0x45</span><span class="op" id="7455052">}</span><span class="op" id="7455053">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455057">[</span><span class="op" id="7455058">]</span><span class="builtintype" id="7455059">byte</span><span class="op" id="7455063">{</span><span class="num" id="7455064">0xd6</span><span class="op" id="7455068">,</span>&nbsp;<span class="num" id="7455070">0xa1</span><span class="op" id="7455074">,</span>&nbsp;<span class="num" id="7455076">0x41</span><span class="op" id="7455080">,</span>&nbsp;<span class="num" id="7455082">0xa7</span><span class="op" id="7455086">,</span>&nbsp;<span class="num" id="7455088">0xec</span><span class="op" id="7455092">,</span>&nbsp;<span class="num" id="7455094">0x3c</span><span class="op" id="7455098">,</span>&nbsp;<span class="num" id="7455100">0x38</span><span class="op" id="7455104">,</span>&nbsp;<span class="num" id="7455106">0xdf</span><span class="op" id="7455110">,</span>&nbsp;<span class="num" id="7455112">0xbd</span><span class="op" id="7455116">,</span>&nbsp;<span class="num" id="7455118">0x61</span><span class="op" id="7455122">}</span><span class="op" id="7455123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455126">}</span><span class="op" id="7455127">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7455131">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455206">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455210">[</span><span class="op" id="7455211">]</span><span class="builtintype" id="7455212">byte</span><span class="op" id="7455216">{</span><span class="num" id="7455217">0x4b</span><span class="op" id="7455221">,</span>&nbsp;<span class="num" id="7455223">0x65</span><span class="op" id="7455227">,</span>&nbsp;<span class="num" id="7455229">0x79</span><span class="op" id="7455233">}</span><span class="op" id="7455234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455238">[</span><span class="op" id="7455239">]</span><span class="builtintype" id="7455240">byte</span><span class="op" id="7455244">{</span><span class="num" id="7455245">0xeb</span><span class="op" id="7455249">,</span>&nbsp;<span class="num" id="7455251">0x9f</span><span class="op" id="7455255">,</span>&nbsp;<span class="num" id="7455257">0x77</span><span class="op" id="7455261">,</span>&nbsp;<span class="num" id="7455263">0x81</span><span class="op" id="7455267">,</span>&nbsp;<span class="num" id="7455269">0xb7</span><span class="op" id="7455273">,</span>&nbsp;<span class="num" id="7455275">0x34</span><span class="op" id="7455279">,</span>&nbsp;<span class="num" id="7455281">0xca</span><span class="op" id="7455285">,</span>&nbsp;<span class="num" id="7455287">0x72</span><span class="op" id="7455291">,</span>&nbsp;<span class="num" id="7455293">0xa7</span><span class="op" id="7455297">,</span>&nbsp;<span class="num" id="7455299">0x19</span><span class="op" id="7455303">}</span><span class="op" id="7455304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455307">}</span><span class="op" id="7455308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455315">[</span><span class="op" id="7455316">]</span><span class="builtintype" id="7455317">byte</span><span class="op" id="7455321">{</span><span class="num" id="7455322">0x57</span><span class="op" id="7455326">,</span>&nbsp;<span class="num" id="7455328">0x69</span><span class="op" id="7455332">,</span>&nbsp;<span class="num" id="7455334">0x6b</span><span class="op" id="7455338">,</span>&nbsp;<span class="num" id="7455340">0x69</span><span class="op" id="7455344">}</span><span class="op" id="7455345">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455349">[</span><span class="op" id="7455350">]</span><span class="builtintype" id="7455351">byte</span><span class="op" id="7455355">{</span><span class="num" id="7455356">0x60</span><span class="op" id="7455360">,</span>&nbsp;<span class="num" id="7455362">0x44</span><span class="op" id="7455366">,</span>&nbsp;<span class="num" id="7455368">0xdb</span><span class="op" id="7455372">,</span>&nbsp;<span class="num" id="7455374">0x6d</span><span class="op" id="7455378">,</span>&nbsp;<span class="num" id="7455380">0x41</span><span class="op" id="7455384">,</span>&nbsp;<span class="num" id="7455386">0xb7</span><span class="op" id="7455390">}</span><span class="op" id="7455391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455394">}</span><span class="op" id="7455395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455402">[</span><span class="op" id="7455403">]</span><span class="builtintype" id="7455404">byte</span><span class="op" id="7455408">{</span><span class="num" id="7455409">0x00</span><span class="op" id="7455413">,</span>&nbsp;<span class="num" id="7455415">0x00</span><span class="op" id="7455419">,</span>&nbsp;<span class="num" id="7455421">0x00</span><span class="op" id="7455425">,</span>&nbsp;<span class="num" id="7455427">0x00</span><span class="op" id="7455431">,</span>&nbsp;<span class="num" id="7455433">0x00</span><span class="op" id="7455437">,</span>&nbsp;<span class="num" id="7455439">0x00</span><span class="op" id="7455443">,</span>&nbsp;<span class="num" id="7455445">0x00</span><span class="op" id="7455449">,</span>&nbsp;<span class="num" id="7455451">0x00</span><span class="op" id="7455455">}</span><span class="op" id="7455456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7455460">[</span><span class="op" id="7455461">]</span><span class="builtintype" id="7455462">byte</span><span class="op" id="7455466">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455471">0xde</span><span class="op" id="7455475">,</span>&nbsp;<span class="num" id="7455477">0x18</span><span class="op" id="7455481">,</span>&nbsp;<span class="num" id="7455483">0x89</span><span class="op" id="7455487">,</span>&nbsp;<span class="num" id="7455489">0x41</span><span class="op" id="7455493">,</span>&nbsp;<span class="num" id="7455495">0xa3</span><span class="op" id="7455499">,</span>&nbsp;<span class="num" id="7455501">0x37</span><span class="op" id="7455505">,</span>&nbsp;<span class="num" id="7455507">0x5d</span><span class="op" id="7455511">,</span>&nbsp;<span class="num" id="7455513">0x3a</span><span class="op" id="7455517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455522">0x8a</span><span class="op" id="7455526">,</span>&nbsp;<span class="num" id="7455528">0x06</span><span class="op" id="7455532">,</span>&nbsp;<span class="num" id="7455534">0x1e</span><span class="op" id="7455538">,</span>&nbsp;<span class="num" id="7455540">0x67</span><span class="op" id="7455544">,</span>&nbsp;<span class="num" id="7455546">0x57</span><span class="op" id="7455550">,</span>&nbsp;<span class="num" id="7455552">0x6e</span><span class="op" id="7455556">,</span>&nbsp;<span class="num" id="7455558">0x92</span><span class="op" id="7455562">,</span>&nbsp;<span class="num" id="7455564">0x6d</span><span class="op" id="7455568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455573">0xc7</span><span class="op" id="7455577">,</span>&nbsp;<span class="num" id="7455579">0x1a</span><span class="op" id="7455583">,</span>&nbsp;<span class="num" id="7455585">0x7f</span><span class="op" id="7455589">,</span>&nbsp;<span class="num" id="7455591">0xa3</span><span class="op" id="7455595">,</span>&nbsp;<span class="num" id="7455597">0xf0</span><span class="op" id="7455601">,</span>&nbsp;<span class="num" id="7455603">0xcc</span><span class="op" id="7455607">,</span>&nbsp;<span class="num" id="7455609">0xeb</span><span class="op" id="7455613">,</span>&nbsp;<span class="num" id="7455615">0x97</span><span class="op" id="7455619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455624">0x45</span><span class="op" id="7455628">,</span>&nbsp;<span class="num" id="7455630">0x2b</span><span class="op" id="7455634">,</span>&nbsp;<span class="num" id="7455636">0x4d</span><span class="op" id="7455640">,</span>&nbsp;<span class="num" id="7455642">0x32</span><span class="op" id="7455646">,</span>&nbsp;<span class="num" id="7455648">0x27</span><span class="op" id="7455652">,</span>&nbsp;<span class="num" id="7455654">0x96</span><span class="op" id="7455658">,</span>&nbsp;<span class="num" id="7455660">0x5f</span><span class="op" id="7455664">,</span>&nbsp;<span class="num" id="7455666">0x9e</span><span class="op" id="7455670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455675">0xa8</span><span class="op" id="7455679">,</span>&nbsp;<span class="num" id="7455681">0xcc</span><span class="op" id="7455685">,</span>&nbsp;<span class="num" id="7455687">0x75</span><span class="op" id="7455691">,</span>&nbsp;<span class="num" id="7455693">0x07</span><span class="op" id="7455697">,</span>&nbsp;<span class="num" id="7455699">0x6d</span><span class="op" id="7455703">,</span>&nbsp;<span class="num" id="7455705">0x9f</span><span class="op" id="7455709">,</span>&nbsp;<span class="num" id="7455711">0xb9</span><span class="op" id="7455715">,</span>&nbsp;<span class="num" id="7455717">0xc5</span><span class="op" id="7455721">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455726">0x41</span><span class="op" id="7455730">,</span>&nbsp;<span class="num" id="7455732">0x7a</span><span class="op" id="7455736">,</span>&nbsp;<span class="num" id="7455738">0xa5</span><span class="op" id="7455742">,</span>&nbsp;<span class="num" id="7455744">0xcb</span><span class="op" id="7455748">,</span>&nbsp;<span class="num" id="7455750">0x30</span><span class="op" id="7455754">,</span>&nbsp;<span class="num" id="7455756">0xfc</span><span class="op" id="7455760">,</span>&nbsp;<span class="num" id="7455762">0x22</span><span class="op" id="7455766">,</span>&nbsp;<span class="num" id="7455768">0x19</span><span class="op" id="7455772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455777">0x8b</span><span class="op" id="7455781">,</span>&nbsp;<span class="num" id="7455783">0x34</span><span class="op" id="7455787">,</span>&nbsp;<span class="num" id="7455789">0x98</span><span class="op" id="7455793">,</span>&nbsp;<span class="num" id="7455795">0x2d</span><span class="op" id="7455799">,</span>&nbsp;<span class="num" id="7455801">0xbb</span><span class="op" id="7455805">,</span>&nbsp;<span class="num" id="7455807">0x62</span><span class="op" id="7455811">,</span>&nbsp;<span class="num" id="7455813">0x9e</span><span class="op" id="7455817">,</span>&nbsp;<span class="num" id="7455819">0xc0</span><span class="op" id="7455823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455828">0x4b</span><span class="op" id="7455832">,</span>&nbsp;<span class="num" id="7455834">0x4f</span><span class="op" id="7455838">,</span>&nbsp;<span class="num" id="7455840">0x8b</span><span class="op" id="7455844">,</span>&nbsp;<span class="num" id="7455846">0x05</span><span class="op" id="7455850">,</span>&nbsp;<span class="num" id="7455852">0xa0</span><span class="op" id="7455856">,</span>&nbsp;<span class="num" id="7455858">0x71</span><span class="op" id="7455862">,</span>&nbsp;<span class="num" id="7455864">0x08</span><span class="op" id="7455868">,</span>&nbsp;<span class="num" id="7455870">0x50</span><span class="op" id="7455874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455879">0x92</span><span class="op" id="7455883">,</span>&nbsp;<span class="num" id="7455885">0xa0</span><span class="op" id="7455889">,</span>&nbsp;<span class="num" id="7455891">0xc3</span><span class="op" id="7455895">,</span>&nbsp;<span class="num" id="7455897">0x58</span><span class="op" id="7455901">,</span>&nbsp;<span class="num" id="7455903">0x4a</span><span class="op" id="7455907">,</span>&nbsp;<span class="num" id="7455909">0x48</span><span class="op" id="7455913">,</span>&nbsp;<span class="num" id="7455915">0xe4</span><span class="op" id="7455919">,</span>&nbsp;<span class="num" id="7455921">0xa3</span><span class="op" id="7455925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455930">0x0a</span><span class="op" id="7455934">,</span>&nbsp;<span class="num" id="7455936">0x39</span><span class="op" id="7455940">,</span>&nbsp;<span class="num" id="7455942">0x7b</span><span class="op" id="7455946">,</span>&nbsp;<span class="num" id="7455948">0x8a</span><span class="op" id="7455952">,</span>&nbsp;<span class="num" id="7455954">0xcd</span><span class="op" id="7455958">,</span>&nbsp;<span class="num" id="7455960">0x1d</span><span class="op" id="7455964">,</span>&nbsp;<span class="num" id="7455966">0x00</span><span class="op" id="7455970">,</span>&nbsp;<span class="num" id="7455972">0x9e</span><span class="op" id="7455976">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7455981">0xc8</span><span class="op" id="7455985">,</span>&nbsp;<span class="num" id="7455987">0x7d</span><span class="op" id="7455991">,</span>&nbsp;<span class="num" id="7455993">0x68</span><span class="op" id="7455997">,</span>&nbsp;<span class="num" id="7455999">0x11</span><span class="op" id="7456003">,</span>&nbsp;<span class="num" id="7456005">0xf2</span><span class="op" id="7456009">,</span>&nbsp;<span class="num" id="7456011">0x2c</span><span class="op" id="7456015">,</span>&nbsp;<span class="num" id="7456017">0xf4</span><span class="op" id="7456021">,</span>&nbsp;<span class="num" id="7456023">0x9c</span><span class="op" id="7456027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456032">0xa3</span><span class="op" id="7456036">,</span>&nbsp;<span class="num" id="7456038">0xe5</span><span class="op" id="7456042">,</span>&nbsp;<span class="num" id="7456044">0x93</span><span class="op" id="7456048">,</span>&nbsp;<span class="num" id="7456050">0x54</span><span class="op" id="7456054">,</span>&nbsp;<span class="num" id="7456056">0xb9</span><span class="op" id="7456060">,</span>&nbsp;<span class="num" id="7456062">0x45</span><span class="op" id="7456066">,</span>&nbsp;<span class="num" id="7456068">0x15</span><span class="op" id="7456072">,</span>&nbsp;<span class="num" id="7456074">0x35</span><span class="op" id="7456078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456083">0xa2</span><span class="op" id="7456087">,</span>&nbsp;<span class="num" id="7456089">0x18</span><span class="op" id="7456093">,</span>&nbsp;<span class="num" id="7456095">0x7a</span><span class="op" id="7456099">,</span>&nbsp;<span class="num" id="7456101">0x86</span><span class="op" id="7456105">,</span>&nbsp;<span class="num" id="7456107">0x42</span><span class="op" id="7456111">,</span>&nbsp;<span class="num" id="7456113">0x6c</span><span class="op" id="7456117">,</span>&nbsp;<span class="num" id="7456119">0xca</span><span class="op" id="7456123">,</span>&nbsp;<span class="num" id="7456125">0x7d</span><span class="op" id="7456129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456134">0x5e</span><span class="op" id="7456138">,</span>&nbsp;<span class="num" id="7456140">0x82</span><span class="op" id="7456144">,</span>&nbsp;<span class="num" id="7456146">0x3e</span><span class="op" id="7456150">,</span>&nbsp;<span class="num" id="7456152">0xba</span><span class="op" id="7456156">,</span>&nbsp;<span class="num" id="7456158">0x00</span><span class="op" id="7456162">,</span>&nbsp;<span class="num" id="7456164">0x44</span><span class="op" id="7456168">,</span>&nbsp;<span class="num" id="7456170">0x12</span><span class="op" id="7456174">,</span>&nbsp;<span class="num" id="7456176">0x67</span><span class="op" id="7456180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456185">0x12</span><span class="op" id="7456189">,</span>&nbsp;<span class="num" id="7456191">0x57</span><span class="op" id="7456195">,</span>&nbsp;<span class="num" id="7456197">0xb8</span><span class="op" id="7456201">,</span>&nbsp;<span class="num" id="7456203">0xd8</span><span class="op" id="7456207">,</span>&nbsp;<span class="num" id="7456209">0x60</span><span class="op" id="7456213">,</span>&nbsp;<span class="num" id="7456215">0xae</span><span class="op" id="7456219">,</span>&nbsp;<span class="num" id="7456221">0x4c</span><span class="op" id="7456225">,</span>&nbsp;<span class="num" id="7456227">0xbd</span><span class="op" id="7456231">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456236">0x4c</span><span class="op" id="7456240">,</span>&nbsp;<span class="num" id="7456242">0x49</span><span class="op" id="7456246">,</span>&nbsp;<span class="num" id="7456248">0x06</span><span class="op" id="7456252">,</span>&nbsp;<span class="num" id="7456254">0xbb</span><span class="op" id="7456258">,</span>&nbsp;<span class="num" id="7456260">0xc5</span><span class="op" id="7456264">,</span>&nbsp;<span class="num" id="7456266">0x35</span><span class="op" id="7456270">,</span>&nbsp;<span class="num" id="7456272">0xef</span><span class="op" id="7456276">,</span>&nbsp;<span class="num" id="7456278">0xe1</span><span class="op" id="7456282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456287">0x58</span><span class="op" id="7456291">,</span>&nbsp;<span class="num" id="7456293">0x7f</span><span class="op" id="7456297">,</span>&nbsp;<span class="num" id="7456299">0x08</span><span class="op" id="7456303">,</span>&nbsp;<span class="num" id="7456305">0xdb</span><span class="op" id="7456309">,</span>&nbsp;<span class="num" id="7456311">0x33</span><span class="op" id="7456315">,</span>&nbsp;<span class="num" id="7456317">0x95</span><span class="op" id="7456321">,</span>&nbsp;<span class="num" id="7456323">0x5c</span><span class="op" id="7456327">,</span>&nbsp;<span class="num" id="7456329">0xdb</span><span class="op" id="7456333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456338">0xcb</span><span class="op" id="7456342">,</span>&nbsp;<span class="num" id="7456344">0xad</span><span class="op" id="7456348">,</span>&nbsp;<span class="num" id="7456350">0x9b</span><span class="op" id="7456354">,</span>&nbsp;<span class="num" id="7456356">0x10</span><span class="op" id="7456360">,</span>&nbsp;<span class="num" id="7456362">0xf5</span><span class="op" id="7456366">,</span>&nbsp;<span class="num" id="7456368">0x3f</span><span class="op" id="7456372">,</span>&nbsp;<span class="num" id="7456374">0xc4</span><span class="op" id="7456378">,</span>&nbsp;<span class="num" id="7456380">0xe5</span><span class="op" id="7456384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456389">0x2c</span><span class="op" id="7456393">,</span>&nbsp;<span class="num" id="7456395">0x59</span><span class="op" id="7456399">,</span>&nbsp;<span class="num" id="7456401">0x15</span><span class="op" id="7456405">,</span>&nbsp;<span class="num" id="7456407">0x65</span><span class="op" id="7456411">,</span>&nbsp;<span class="num" id="7456413">0x51</span><span class="op" id="7456417">,</span>&nbsp;<span class="num" id="7456419">0x84</span><span class="op" id="7456423">,</span>&nbsp;<span class="num" id="7456425">0x87</span><span class="op" id="7456429">,</span>&nbsp;<span class="num" id="7456431">0xfe</span><span class="op" id="7456435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456440">0x08</span><span class="op" id="7456444">,</span>&nbsp;<span class="num" id="7456446">0x4d</span><span class="op" id="7456450">,</span>&nbsp;<span class="num" id="7456452">0x0e</span><span class="op" id="7456456">,</span>&nbsp;<span class="num" id="7456458">0x3f</span><span class="op" id="7456462">,</span>&nbsp;<span class="num" id="7456464">0x03</span><span class="op" id="7456468">,</span>&nbsp;<span class="num" id="7456470">0xde</span><span class="op" id="7456474">,</span>&nbsp;<span class="num" id="7456476">0xbc</span><span class="op" id="7456480">,</span>&nbsp;<span class="num" id="7456482">0xc9</span><span class="op" id="7456486">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456491">0xda</span><span class="op" id="7456495">,</span>&nbsp;<span class="num" id="7456497">0x1c</span><span class="op" id="7456501">,</span>&nbsp;<span class="num" id="7456503">0xe9</span><span class="op" id="7456507">,</span>&nbsp;<span class="num" id="7456509">0x0d</span><span class="op" id="7456513">,</span>&nbsp;<span class="num" id="7456515">0x08</span><span class="op" id="7456519">,</span>&nbsp;<span class="num" id="7456521">0x5c</span><span class="op" id="7456525">,</span>&nbsp;<span class="num" id="7456527">0x2d</span><span class="op" id="7456531">,</span>&nbsp;<span class="num" id="7456533">0x8a</span><span class="op" id="7456537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456542">0x19</span><span class="op" id="7456546">,</span>&nbsp;<span class="num" id="7456548">0xd8</span><span class="op" id="7456552">,</span>&nbsp;<span class="num" id="7456554">0x37</span><span class="op" id="7456558">,</span>&nbsp;<span class="num" id="7456560">0x30</span><span class="op" id="7456564">,</span>&nbsp;<span class="num" id="7456566">0x86</span><span class="op" id="7456570">,</span>&nbsp;<span class="num" id="7456572">0x16</span><span class="op" id="7456576">,</span>&nbsp;<span class="num" id="7456578">0x36</span><span class="op" id="7456582">,</span>&nbsp;<span class="num" id="7456584">0x92</span><span class="op" id="7456588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456593">0x14</span><span class="op" id="7456597">,</span>&nbsp;<span class="num" id="7456599">0x2b</span><span class="op" id="7456603">,</span>&nbsp;<span class="num" id="7456605">0xd8</span><span class="op" id="7456609">,</span>&nbsp;<span class="num" id="7456611">0xfc</span><span class="op" id="7456615">,</span>&nbsp;<span class="num" id="7456617">0x5d</span><span class="op" id="7456621">,</span>&nbsp;<span class="num" id="7456623">0x7a</span><span class="op" id="7456627">,</span>&nbsp;<span class="num" id="7456629">0x73</span><span class="op" id="7456633">,</span>&nbsp;<span class="num" id="7456635">0x49</span><span class="op" id="7456639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456644">0x6a</span><span class="op" id="7456648">,</span>&nbsp;<span class="num" id="7456650">0x8e</span><span class="op" id="7456654">,</span>&nbsp;<span class="num" id="7456656">0x59</span><span class="op" id="7456660">,</span>&nbsp;<span class="num" id="7456662">0xee</span><span class="op" id="7456666">,</span>&nbsp;<span class="num" id="7456668">0x7e</span><span class="op" id="7456672">,</span>&nbsp;<span class="num" id="7456674">0xcf</span><span class="op" id="7456678">,</span>&nbsp;<span class="num" id="7456680">0x6b</span><span class="op" id="7456684">,</span>&nbsp;<span class="num" id="7456686">0x94</span><span class="op" id="7456690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456695">0x06</span><span class="op" id="7456699">,</span>&nbsp;<span class="num" id="7456701">0x63</span><span class="op" id="7456705">,</span>&nbsp;<span class="num" id="7456707">0xf4</span><span class="op" id="7456711">,</span>&nbsp;<span class="num" id="7456713">0xa6</span><span class="op" id="7456717">,</span>&nbsp;<span class="num" id="7456719">0xbe</span><span class="op" id="7456723">,</span>&nbsp;<span class="num" id="7456725">0xe6</span><span class="op" id="7456729">,</span>&nbsp;<span class="num" id="7456731">0x5b</span><span class="op" id="7456735">,</span>&nbsp;<span class="num" id="7456737">0xd2</span><span class="op" id="7456741">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456746">0xc8</span><span class="op" id="7456750">,</span>&nbsp;<span class="num" id="7456752">0x5c</span><span class="op" id="7456756">,</span>&nbsp;<span class="num" id="7456758">0x46</span><span class="op" id="7456762">,</span>&nbsp;<span class="num" id="7456764">0x98</span><span class="op" id="7456768">,</span>&nbsp;<span class="num" id="7456770">0x6c</span><span class="op" id="7456774">,</span>&nbsp;<span class="num" id="7456776">0x1b</span><span class="op" id="7456780">,</span>&nbsp;<span class="num" id="7456782">0xef</span><span class="op" id="7456786">,</span>&nbsp;<span class="num" id="7456788">0x34</span><span class="op" id="7456792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456797">0x90</span><span class="op" id="7456801">,</span>&nbsp;<span class="num" id="7456803">0xd3</span><span class="op" id="7456807">,</span>&nbsp;<span class="num" id="7456809">0x7b</span><span class="op" id="7456813">,</span>&nbsp;<span class="num" id="7456815">0x38</span><span class="op" id="7456819">,</span>&nbsp;<span class="num" id="7456821">0xda</span><span class="op" id="7456825">,</span>&nbsp;<span class="num" id="7456827">0x85</span><span class="op" id="7456831">,</span>&nbsp;<span class="num" id="7456833">0xd3</span><span class="op" id="7456837">,</span>&nbsp;<span class="num" id="7456839">0x2e</span><span class="op" id="7456843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7456848">0x97</span><span class="op" id="7456852">,</span>&nbsp;<span class="num" id="7456854">0x39</span><span class="op" id="7456858">,</span>&nbsp;<span class="num" id="7456860">0xcb</span><span class="op" id="7456864">,</span>&nbsp;<span class="num" id="7456866">0x23</span><span class="op" id="7456870">,</span>&nbsp;<span class="num" id="7456872">0x4a</span><span class="op" id="7456876">,</span>&nbsp;<span class="num" id="7456878">0x2b</span><span class="op" id="7456882">,</span>&nbsp;<span class="num" id="7456884">0xe7</span><span class="op" id="7456888">,</span>&nbsp;<span class="num" id="7456890">0x40</span><span class="op" id="7456894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7456898">}</span><span class="op" id="7456899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7456902">}</span><span class="op" id="7456903">,</span><br>
<span class="lineno">75</span><span class="op" id="7456905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7456908">func</span>&nbsp;<span class="ident" id="7456913">testEncrypt</span><span class="op" id="7456924">(</span><span class="ident" id="7456925">t</span>&nbsp;<span class="op" id="7456927">*</span><span class="ident" id="7456928"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454550">testing</a></span><span class="op" id="7456935">.</span><span class="ident" id="7456936"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7456937">,</span>&nbsp;<span class="ident" id="7456939">desc</span>&nbsp;<span class="builtintype" id="7456944">string</span><span class="op" id="7456950">,</span>&nbsp;<span class="ident" id="7456952">c</span>&nbsp;<span class="op" id="7456954">*</span><span class="ident" id="7456955"><a href="/gostd/crypto/rc4/rc4.go.html#4606332">Cipher</a></span><span class="op" id="7456961">,</span>&nbsp;<span class="ident" id="7456963">src</span><span class="op" id="7456966">,</span>&nbsp;<span class="ident" id="7456968">expect</span>&nbsp;<span class="op" id="7456975">[</span><span class="op" id="7456976">]</span><span class="builtintype" id="7456977">byte</span><span class="op" id="7456981">)</span>&nbsp;<span class="op" id="7456983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7456986">dst</span>&nbsp;<span class="op" id="7456990">:=</span>&nbsp;<span class="builtinfunc" id="7456993">make</span><span class="op" id="7456997">(</span><span class="op" id="7456998">[</span><span class="op" id="7456999">]</span><span class="builtintype" id="7457000">byte</span><span class="op" id="7457004">,</span>&nbsp;<span class="builtinfunc" id="7457006">len</span><span class="op" id="7457009">(</span><span class="ident" id="7457010"><a href="/gostd/crypto/rc4/rc4_test.go.html#7456963">src</a></span><span class="op" id="7457013">)</span><span class="op" id="7457014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457017"><a href="/gostd/crypto/rc4/rc4_test.go.html#7456952">c</a></span><span class="op" id="7457018">.</span><span class="ident" id="7457019"><a href="/gostd/crypto/rc4/rc4_asm.go.html#4608108">XORKeyStream</a></span><span class="op" id="7457031">(</span><span class="ident" id="7457032"><a href="/gostd/crypto/rc4/rc4_test.go.html#7456986">dst</a></span><span class="op" id="7457035">,</span>&nbsp;<span class="ident" id="7457037"><a href="/gostd/crypto/rc4/rc4_test.go.html#7456963">src</a></span><span class="op" id="7457040">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7457043">for</span>&nbsp;<span class="ident" id="7457047">i</span><span class="op" id="7457048">,</span>&nbsp;<span class="ident" id="7457050">v</span>&nbsp;<span class="op" id="7457052">:=</span>&nbsp;<span class="keyword" id="7457055">range</span>&nbsp;<span class="ident" id="7457061"><a href="/gostd/crypto/rc4/rc4_test.go.html#7456986">dst</a></span>&nbsp;<span class="op" id="7457065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7457069">if</span>&nbsp;<span class="ident" id="7457072"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457050">v</a></span>&nbsp;<span class="op" id="7457074">!=</span>&nbsp;<span class="ident" id="7457077"><a href="/gostd/crypto/rc4/rc4_test.go.html#7456968">expect</a></span><span class="op" id="7457083">[</span><span class="ident" id="7457084"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457047">i</a></span><span class="op" id="7457085">]</span>&nbsp;<span class="op" id="7457087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457092"><a href="/gostd/crypto/rc4/rc4_test.go.html#7456925">t</a></span><span class="op" id="7457093">.</span><span class="ident" id="7457094"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7457100">(</span><span class="string" id="7457101">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="7457145">,</span>&nbsp;<span class="ident" id="7457147"><a href="/gostd/crypto/rc4/rc4_test.go.html#7456939">desc</a></span><span class="op" id="7457151">,</span>&nbsp;<span class="ident" id="7457153"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457047">i</a></span><span class="op" id="7457154">,</span>&nbsp;<span class="ident" id="7457156"><a href="/gostd/crypto/rc4/rc4_test.go.html#7456986">dst</a></span><span class="op" id="7457159">,</span>&nbsp;<span class="ident" id="7457161"><a href="/gostd/crypto/rc4/rc4_test.go.html#7456968">expect</a></span><span class="op" id="7457167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7457171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7457174">}</span><br>
<span class="lineno">85</span><span class="op" id="7457176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7457179">func</span>&nbsp;<span class="ident" id="7457184">TestGolden</span><span class="op" id="7457194">(</span><span class="ident" id="7457195">t</span>&nbsp;<span class="op" id="7457197">*</span><span class="ident" id="7457198"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454550">testing</a></span><span class="op" id="7457205">.</span><span class="ident" id="7457206"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7457207">)</span>&nbsp;<span class="op" id="7457209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7457212">for</span>&nbsp;<span class="ident" id="7457216">gi</span><span class="op" id="7457218">,</span>&nbsp;<span class="ident" id="7457220">g</span>&nbsp;<span class="op" id="7457222">:=</span>&nbsp;<span class="keyword" id="7457225">range</span>&nbsp;<span class="ident" id="7457231"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454615">golden</a></span>&nbsp;<span class="op" id="7457238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457242">data</span>&nbsp;<span class="op" id="7457247">:=</span>&nbsp;<span class="builtinfunc" id="7457250">make</span><span class="op" id="7457254">(</span><span class="op" id="7457255">[</span><span class="op" id="7457256">]</span><span class="builtintype" id="7457257">byte</span><span class="op" id="7457261">,</span>&nbsp;<span class="builtinfunc" id="7457263">len</span><span class="op" id="7457266">(</span><span class="ident" id="7457267"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457220">g</a></span><span class="op" id="7457268">.</span><span class="ident" id="7457269"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454591">keystream</a></span><span class="op" id="7457278">)</span><span class="op" id="7457279">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7457283">for</span>&nbsp;<span class="ident" id="7457287">i</span>&nbsp;<span class="op" id="7457289">:=</span>&nbsp;<span class="keyword" id="7457292">range</span>&nbsp;<span class="ident" id="7457298"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457242">data</a></span>&nbsp;<span class="op" id="7457303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457308"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457242">data</a></span><span class="op" id="7457312">[</span><span class="ident" id="7457313"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457287">i</a></span><span class="op" id="7457314">]</span>&nbsp;<span class="op" id="7457316">=</span>&nbsp;<span class="builtintype" id="7457318">byte</span><span class="op" id="7457322">(</span><span class="ident" id="7457323"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457287">i</a></span><span class="op" id="7457324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7457328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457333">expect</span>&nbsp;<span class="op" id="7457340">:=</span>&nbsp;<span class="builtinfunc" id="7457343">make</span><span class="op" id="7457347">(</span><span class="op" id="7457348">[</span><span class="op" id="7457349">]</span><span class="builtintype" id="7457350">byte</span><span class="op" id="7457354">,</span>&nbsp;<span class="builtinfunc" id="7457356">len</span><span class="op" id="7457359">(</span><span class="ident" id="7457360"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457220">g</a></span><span class="op" id="7457361">.</span><span class="ident" id="7457362"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454591">keystream</a></span><span class="op" id="7457371">)</span><span class="op" id="7457372">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7457376">for</span>&nbsp;<span class="ident" id="7457380">i</span>&nbsp;<span class="op" id="7457382">:=</span>&nbsp;<span class="keyword" id="7457385">range</span>&nbsp;<span class="ident" id="7457391"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457333">expect</a></span>&nbsp;<span class="op" id="7457398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457403"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457333">expect</a></span><span class="op" id="7457409">[</span><span class="ident" id="7457410"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457380">i</a></span><span class="op" id="7457411">]</span>&nbsp;<span class="op" id="7457413">=</span>&nbsp;<span class="builtintype" id="7457415">byte</span><span class="op" id="7457419">(</span><span class="ident" id="7457420"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457380">i</a></span><span class="op" id="7457421">)</span>&nbsp;<span class="op" id="7457423">^</span>&nbsp;<span class="ident" id="7457425"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457220">g</a></span><span class="op" id="7457426">.</span><span class="ident" id="7457427"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454591">keystream</a></span><span class="op" id="7457436">[</span><span class="ident" id="7457437"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457380">i</a></span><span class="op" id="7457438">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7457442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7457447">for</span>&nbsp;<span class="ident" id="7457451">size</span>&nbsp;<span class="op" id="7457456">:=</span>&nbsp;<span class="num" id="7457459">1</span><span class="op" id="7457460">;</span>&nbsp;<span class="ident" id="7457462"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457451">size</a></span>&nbsp;<span class="op" id="7457467">&lt;=</span>&nbsp;<span class="builtinfunc" id="7457470">len</span><span class="op" id="7457473">(</span><span class="ident" id="7457474"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457220">g</a></span><span class="op" id="7457475">.</span><span class="ident" id="7457476"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454591">keystream</a></span><span class="op" id="7457485">)</span><span class="op" id="7457486">;</span>&nbsp;<span class="ident" id="7457488"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457451">size</a></span><span class="op" id="7457492">++</span>&nbsp;<span class="op" id="7457495">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457500">c</span><span class="op" id="7457501">,</span>&nbsp;<span class="ident" id="7457503">err</span>&nbsp;<span class="op" id="7457507">:=</span>&nbsp;<span class="ident" id="7457510"><a href="/gostd/crypto/rc4/rc4.go.html#4606644">NewCipher</a></span><span class="op" id="7457519">(</span><span class="ident" id="7457520"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457220">g</a></span><span class="op" id="7457521">.</span><span class="ident" id="7457522"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454586">key</a></span><span class="op" id="7457525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7457530">if</span>&nbsp;<span class="ident" id="7457533"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457503">err</a></span>&nbsp;<span class="op" id="7457537">!=</span>&nbsp;<span class="builtintype" id="7457540">nil</span>&nbsp;<span class="op" id="7457544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457550"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457195">t</a></span><span class="op" id="7457551">.</span><span class="ident" id="7457552"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7457558">(</span><span class="string" id="7457559">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="7457579">,</span>&nbsp;<span class="ident" id="7457581"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457216">gi</a></span><span class="op" id="7457583">,</span>&nbsp;<span class="ident" id="7457585"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457503">err</a></span><span class="op" id="7457588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7457593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457599">off</span>&nbsp;<span class="op" id="7457603">:=</span>&nbsp;<span class="num" id="7457606">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7457611">for</span>&nbsp;<span class="ident" id="7457615"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457599">off</a></span>&nbsp;<span class="op" id="7457619">&lt;</span>&nbsp;<span class="builtinfunc" id="7457621">len</span><span class="op" id="7457624">(</span><span class="ident" id="7457625"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457220">g</a></span><span class="op" id="7457626">.</span><span class="ident" id="7457627"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454591">keystream</a></span><span class="op" id="7457636">)</span>&nbsp;<span class="op" id="7457638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457644">n</span>&nbsp;<span class="op" id="7457646">:=</span>&nbsp;<span class="builtinfunc" id="7457649">len</span><span class="op" id="7457652">(</span><span class="ident" id="7457653"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457220">g</a></span><span class="op" id="7457654">.</span><span class="ident" id="7457655"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454591">keystream</a></span><span class="op" id="7457664">)</span>&nbsp;<span class="op" id="7457666">-</span>&nbsp;<span class="ident" id="7457668"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457599">off</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7457676">if</span>&nbsp;<span class="ident" id="7457679"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457644">n</a></span>&nbsp;<span class="op" id="7457681">&gt;</span>&nbsp;<span class="ident" id="7457683"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457451">size</a></span>&nbsp;<span class="op" id="7457688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457695"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457644">n</a></span>&nbsp;<span class="op" id="7457697">=</span>&nbsp;<span class="ident" id="7457699"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457451">size</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7457708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457714">desc</span>&nbsp;<span class="op" id="7457719">:=</span>&nbsp;<span class="ident" id="7457722"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454543">fmt</a></span><span class="op" id="7457725">.</span><span class="ident" id="7457726"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="7457733">(</span><span class="string" id="7457734">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="7457747">,</span>&nbsp;<span class="ident" id="7457749"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457216">gi</a></span><span class="op" id="7457751">,</span>&nbsp;<span class="ident" id="7457753"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457599">off</a></span><span class="op" id="7457756">,</span>&nbsp;<span class="ident" id="7457758"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457599">off</a></span><span class="op" id="7457761">+</span><span class="ident" id="7457762"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457644">n</a></span><span class="op" id="7457763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457769"><a href="/gostd/crypto/rc4/rc4_test.go.html#7456913">testEncrypt</a></span><span class="op" id="7457780">(</span><span class="ident" id="7457781"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457195">t</a></span><span class="op" id="7457782">,</span>&nbsp;<span class="ident" id="7457784"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457714">desc</a></span><span class="op" id="7457788">,</span>&nbsp;<span class="ident" id="7457790"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457500">c</a></span><span class="op" id="7457791">,</span>&nbsp;<span class="ident" id="7457793"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457242">data</a></span><span class="op" id="7457797">[</span><span class="ident" id="7457798"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457599">off</a></span><span class="op" id="7457801">:</span><span class="ident" id="7457802"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457599">off</a></span><span class="op" id="7457805">+</span><span class="ident" id="7457806"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457644">n</a></span><span class="op" id="7457807">]</span><span class="op" id="7457808">,</span>&nbsp;<span class="ident" id="7457810"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457333">expect</a></span><span class="op" id="7457816">[</span><span class="ident" id="7457817"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457599">off</a></span><span class="op" id="7457820">:</span><span class="ident" id="7457821"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457599">off</a></span><span class="op" id="7457824">+</span><span class="ident" id="7457825"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457644">n</a></span><span class="op" id="7457826">]</span><span class="op" id="7457827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457833"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457599">off</a></span>&nbsp;<span class="op" id="7457837">+=</span>&nbsp;<span class="ident" id="7457840"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457644">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7457845">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7457849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7457852">}</span><br>
<span class="lineno"></span><span class="op" id="7457854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7457857">func</span>&nbsp;<span class="ident" id="7457862">TestBlock</span><span class="op" id="7457871">(</span><span class="ident" id="7457872">t</span>&nbsp;<span class="op" id="7457874">*</span><span class="ident" id="7457875"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454550">testing</a></span><span class="op" id="7457882">.</span><span class="ident" id="7457883"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7457884">)</span>&nbsp;<span class="op" id="7457886">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7457889"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458160">testBlock</a></span><span class="op" id="7457898">(</span><span class="ident" id="7457899"><a href="/gostd/crypto/rc4/rc4_test.go.html#7457872">t</a></span><span class="op" id="7457900">,</span>&nbsp;<span class="op" id="7457902">(</span><span class="op" id="7457903">*</span><span class="ident" id="7457904"><a href="/gostd/crypto/rc4/rc4.go.html#4606332">Cipher</a></span><span class="op" id="7457910">)</span><span class="op" id="7457911">.</span><span class="ident" id="7457912"><a href="/gostd/crypto/rc4/rc4_asm.go.html#4608108">XORKeyStream</a></span><span class="op" id="7457924">)</span><br>
<span class="lineno"></span><span class="op" id="7457926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7457929">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="7457958">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="7458025">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="7458069">func</span>&nbsp;<span class="ident" id="7458074">TestBlockGeneric</span><span class="op" id="7458090">(</span><span class="ident" id="7458091">t</span>&nbsp;<span class="op" id="7458093">*</span><span class="ident" id="7458094"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454550">testing</a></span><span class="op" id="7458101">.</span><span class="ident" id="7458102"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7458103">)</span>&nbsp;<span class="op" id="7458105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458108"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458160">testBlock</a></span><span class="op" id="7458117">(</span><span class="ident" id="7458118"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458091">t</a></span><span class="op" id="7458119">,</span>&nbsp;<span class="op" id="7458121">(</span><span class="op" id="7458122">*</span><span class="ident" id="7458123"><a href="/gostd/crypto/rc4/rc4.go.html#4606332">Cipher</a></span><span class="op" id="7458129">)</span><span class="op" id="7458130">.</span><span class="ident" id="7458131"><a href="/gostd/crypto/rc4/rc4.go.html#4607441">xorKeyStreamGeneric</a></span><span class="op" id="7458150">)</span><br>
<span class="lineno"></span><span class="op" id="7458152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7458155">func</span>&nbsp;<span class="ident" id="7458160">testBlock</span><span class="op" id="7458169">(</span><span class="ident" id="7458170">t</span>&nbsp;<span class="op" id="7458172">*</span><span class="ident" id="7458173"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454550">testing</a></span><span class="op" id="7458180">.</span><span class="ident" id="7458181"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7458182">,</span>&nbsp;<span class="ident" id="7458184">xor</span>&nbsp;<span class="keyword" id="7458188">func</span><span class="op" id="7458192">(</span><span class="ident" id="7458193">c</span>&nbsp;<span class="op" id="7458195">*</span><span class="ident" id="7458196"><a href="/gostd/crypto/rc4/rc4.go.html#4606332">Cipher</a></span><span class="op" id="7458202">,</span>&nbsp;<span class="ident" id="7458204">dst</span><span class="op" id="7458207">,</span>&nbsp;<span class="ident" id="7458209">src</span>&nbsp;<span class="op" id="7458213">[</span><span class="op" id="7458214">]</span><span class="builtintype" id="7458215">byte</span><span class="op" id="7458219">)</span><span class="op" id="7458220">)</span>&nbsp;<span class="op" id="7458222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458225">c1a</span><span class="op" id="7458228">,</span>&nbsp;<span class="ident" id="7458230">_</span>&nbsp;<span class="op" id="7458232">:=</span>&nbsp;<span class="ident" id="7458235"><a href="/gostd/crypto/rc4/rc4.go.html#4606644">NewCipher</a></span><span class="op" id="7458244">(</span><span class="ident" id="7458245"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454615">golden</a></span><span class="op" id="7458251">[</span><span class="num" id="7458252">0</span><span class="op" id="7458253">]</span><span class="op" id="7458254">.</span><span class="ident" id="7458255"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454586">key</a></span><span class="op" id="7458258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458261">c1b</span><span class="op" id="7458264">,</span>&nbsp;<span class="ident" id="7458266">_</span>&nbsp;<span class="op" id="7458268">:=</span>&nbsp;<span class="ident" id="7458271"><a href="/gostd/crypto/rc4/rc4.go.html#4606644">NewCipher</a></span><span class="op" id="7458280">(</span><span class="ident" id="7458281"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454615">golden</a></span><span class="op" id="7458287">[</span><span class="num" id="7458288">1</span><span class="op" id="7458289">]</span><span class="op" id="7458290">.</span><span class="ident" id="7458291"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454586">key</a></span><span class="op" id="7458294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458297">data1</span>&nbsp;<span class="op" id="7458303">:=</span>&nbsp;<span class="builtinfunc" id="7458306">make</span><span class="op" id="7458310">(</span><span class="op" id="7458311">[</span><span class="op" id="7458312">]</span><span class="builtintype" id="7458313">byte</span><span class="op" id="7458317">,</span>&nbsp;<span class="num" id="7458319">1</span><span class="op" id="7458320">&lt;&lt;</span><span class="num" id="7458322">20</span><span class="op" id="7458324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7458327">for</span>&nbsp;<span class="ident" id="7458331">i</span>&nbsp;<span class="op" id="7458333">:=</span>&nbsp;<span class="keyword" id="7458336">range</span>&nbsp;<span class="ident" id="7458342"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458297">data1</a></span>&nbsp;<span class="op" id="7458348">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458352"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458184">xor</a></span><span class="op" id="7458355">(</span><span class="ident" id="7458356"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458225">c1a</a></span><span class="op" id="7458359">,</span>&nbsp;<span class="ident" id="7458361"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458297">data1</a></span><span class="op" id="7458366">[</span><span class="ident" id="7458367"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458331">i</a></span><span class="op" id="7458368">:</span><span class="ident" id="7458369"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458331">i</a></span><span class="op" id="7458370">+</span><span class="num" id="7458371">1</span><span class="op" id="7458372">]</span><span class="op" id="7458373">,</span>&nbsp;<span class="ident" id="7458375"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458297">data1</a></span><span class="op" id="7458380">[</span><span class="ident" id="7458381"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458331">i</a></span><span class="op" id="7458382">:</span><span class="ident" id="7458383"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458331">i</a></span><span class="op" id="7458384">+</span><span class="num" id="7458385">1</span><span class="op" id="7458386">]</span><span class="op" id="7458387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458391"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458184">xor</a></span><span class="op" id="7458394">(</span><span class="ident" id="7458395"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458261">c1b</a></span><span class="op" id="7458398">,</span>&nbsp;<span class="ident" id="7458400"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458297">data1</a></span><span class="op" id="7458405">[</span><span class="ident" id="7458406"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458331">i</a></span><span class="op" id="7458407">:</span><span class="ident" id="7458408"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458331">i</a></span><span class="op" id="7458409">+</span><span class="num" id="7458410">1</span><span class="op" id="7458411">]</span><span class="op" id="7458412">,</span>&nbsp;<span class="ident" id="7458414"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458297">data1</a></span><span class="op" id="7458419">[</span><span class="ident" id="7458420"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458331">i</a></span><span class="op" id="7458421">:</span><span class="ident" id="7458422"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458331">i</a></span><span class="op" id="7458423">+</span><span class="num" id="7458424">1</span><span class="op" id="7458425">]</span><span class="op" id="7458426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458433">c2a</span><span class="op" id="7458436">,</span>&nbsp;<span class="ident" id="7458438">_</span>&nbsp;<span class="op" id="7458440">:=</span>&nbsp;<span class="ident" id="7458443"><a href="/gostd/crypto/rc4/rc4.go.html#4606644">NewCipher</a></span><span class="op" id="7458452">(</span><span class="ident" id="7458453"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454615">golden</a></span><span class="op" id="7458459">[</span><span class="num" id="7458460">0</span><span class="op" id="7458461">]</span><span class="op" id="7458462">.</span><span class="ident" id="7458463"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454586">key</a></span><span class="op" id="7458466">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458469">c2b</span><span class="op" id="7458472">,</span>&nbsp;<span class="ident" id="7458474">_</span>&nbsp;<span class="op" id="7458476">:=</span>&nbsp;<span class="ident" id="7458479"><a href="/gostd/crypto/rc4/rc4.go.html#4606644">NewCipher</a></span><span class="op" id="7458488">(</span><span class="ident" id="7458489"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454615">golden</a></span><span class="op" id="7458495">[</span><span class="num" id="7458496">1</span><span class="op" id="7458497">]</span><span class="op" id="7458498">.</span><span class="ident" id="7458499"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454586">key</a></span><span class="op" id="7458502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458505">data2</span>&nbsp;<span class="op" id="7458511">:=</span>&nbsp;<span class="builtinfunc" id="7458514">make</span><span class="op" id="7458518">(</span><span class="op" id="7458519">[</span><span class="op" id="7458520">]</span><span class="builtintype" id="7458521">byte</span><span class="op" id="7458525">,</span>&nbsp;<span class="num" id="7458527">1</span><span class="op" id="7458528">&lt;&lt;</span><span class="num" id="7458530">20</span><span class="op" id="7458532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458535"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458184">xor</a></span><span class="op" id="7458538">(</span><span class="ident" id="7458539"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458433">c2a</a></span><span class="op" id="7458542">,</span>&nbsp;<span class="ident" id="7458544"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458505">data2</a></span><span class="op" id="7458549">,</span>&nbsp;<span class="ident" id="7458551"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458505">data2</a></span><span class="op" id="7458556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458559"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458184">xor</a></span><span class="op" id="7458562">(</span><span class="ident" id="7458563"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458469">c2b</a></span><span class="op" id="7458566">,</span>&nbsp;<span class="ident" id="7458568"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458505">data2</a></span><span class="op" id="7458573">,</span>&nbsp;<span class="ident" id="7458575"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458505">data2</a></span><span class="op" id="7458580">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7458584">if</span>&nbsp;<span class="op" id="7458587">!</span><span class="ident" id="7458588"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454534">bytes</a></span><span class="op" id="7458593">.</span><span class="ident" id="7458594"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="7458599">(</span><span class="ident" id="7458600"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458297">data1</a></span><span class="op" id="7458605">,</span>&nbsp;<span class="ident" id="7458607"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458505">data2</a></span><span class="op" id="7458612">)</span>&nbsp;<span class="op" id="7458614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458618"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458170">t</a></span><span class="op" id="7458619">.</span><span class="ident" id="7458620"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7458626">(</span><span class="string" id="7458627">&#34;bad&nbsp;block&#34;</span><span class="op" id="7458638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458641">}</span><br>
<span class="lineno"></span><span class="op" id="7458643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="7458646">func</span>&nbsp;<span class="ident" id="7458651">benchmark</span><span class="op" id="7458660">(</span><span class="ident" id="7458661">b</span>&nbsp;<span class="op" id="7458663">*</span><span class="ident" id="7458664"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454550">testing</a></span><span class="op" id="7458671">.</span><span class="ident" id="7458672"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="7458673">,</span>&nbsp;<span class="ident" id="7458675">size</span>&nbsp;<span class="builtintype" id="7458680">int64</span><span class="op" id="7458685">)</span>&nbsp;<span class="op" id="7458687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458690">buf</span>&nbsp;<span class="op" id="7458694">:=</span>&nbsp;<span class="builtinfunc" id="7458697">make</span><span class="op" id="7458701">(</span><span class="op" id="7458702">[</span><span class="op" id="7458703">]</span><span class="builtintype" id="7458704">byte</span><span class="op" id="7458708">,</span>&nbsp;<span class="ident" id="7458710"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458675">size</a></span><span class="op" id="7458714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458717">c</span><span class="op" id="7458718">,</span>&nbsp;<span class="ident" id="7458720">err</span>&nbsp;<span class="op" id="7458724">:=</span>&nbsp;<span class="ident" id="7458727"><a href="/gostd/crypto/rc4/rc4.go.html#4606644">NewCipher</a></span><span class="op" id="7458736">(</span><span class="ident" id="7458737"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454615">golden</a></span><span class="op" id="7458743">[</span><span class="num" id="7458744">0</span><span class="op" id="7458745">]</span><span class="op" id="7458746">.</span><span class="ident" id="7458747"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454586">key</a></span><span class="op" id="7458750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7458753">if</span>&nbsp;<span class="ident" id="7458756"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458720">err</a></span>&nbsp;<span class="op" id="7458760">!=</span>&nbsp;<span class="builtintype" id="7458763">nil</span>&nbsp;<span class="op" id="7458767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7458771">panic</span><span class="op" id="7458776">(</span><span class="ident" id="7458777"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458720">err</a></span><span class="op" id="7458780">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458786"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458661">b</a></span><span class="op" id="7458787">.</span><span class="ident" id="7458788"><a href="/gostd/testing/benchmark.go.html#5452834">SetBytes</a></span><span class="op" id="7458796">(</span><span class="ident" id="7458797"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458675">size</a></span><span class="op" id="7458801">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7458805">for</span>&nbsp;<span class="ident" id="7458809">i</span>&nbsp;<span class="op" id="7458811">:=</span>&nbsp;<span class="num" id="7458814">0</span><span class="op" id="7458815">;</span>&nbsp;<span class="ident" id="7458817"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458809">i</a></span>&nbsp;<span class="op" id="7458819">&lt;</span>&nbsp;<span class="ident" id="7458821"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458661">b</a></span><span class="op" id="7458822">.</span><span class="ident" id="7458823"><a href="/gostd/testing/benchmark.go.html#5450983">N</a></span><span class="op" id="7458824">;</span>&nbsp;<span class="ident" id="7458826"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458809">i</a></span><span class="op" id="7458827">++</span>&nbsp;<span class="op" id="7458830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458834"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458717">c</a></span><span class="op" id="7458835">.</span><span class="ident" id="7458836"><a href="/gostd/crypto/rc4/rc4_asm.go.html#4608108">XORKeyStream</a></span><span class="op" id="7458848">(</span><span class="ident" id="7458849"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458690">buf</a></span><span class="op" id="7458852">,</span>&nbsp;<span class="ident" id="7458854"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458690">buf</a></span><span class="op" id="7458857">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7458860">}</span><br>
<span class="lineno"></span><span class="op" id="7458862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7458865">func</span>&nbsp;<span class="ident" id="7458870">BenchmarkRC4_128</span><span class="op" id="7458886">(</span><span class="ident" id="7458887">b</span>&nbsp;<span class="op" id="7458889">*</span><span class="ident" id="7458890"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454550">testing</a></span><span class="op" id="7458897">.</span><span class="ident" id="7458898"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="7458899">)</span>&nbsp;<span class="op" id="7458901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458904"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458651">benchmark</a></span><span class="op" id="7458913">(</span><span class="ident" id="7458914"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458887">b</a></span><span class="op" id="7458915">,</span>&nbsp;<span class="num" id="7458917">128</span><span class="op" id="7458920">)</span><br>
<span class="lineno">165</span><span class="op" id="7458922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7458925">func</span>&nbsp;<span class="ident" id="7458930">BenchmarkRC4_1K</span><span class="op" id="7458945">(</span><span class="ident" id="7458946">b</span>&nbsp;<span class="op" id="7458948">*</span><span class="ident" id="7458949"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454550">testing</a></span><span class="op" id="7458956">.</span><span class="ident" id="7458957"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="7458958">)</span>&nbsp;<span class="op" id="7458960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7458963"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458651">benchmark</a></span><span class="op" id="7458972">(</span><span class="ident" id="7458973"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458946">b</a></span><span class="op" id="7458974">,</span>&nbsp;<span class="num" id="7458976">1024</span><span class="op" id="7458980">)</span><br>
<span class="lineno"></span><span class="op" id="7458982">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7458985">func</span>&nbsp;<span class="ident" id="7458990">BenchmarkRC4_8K</span><span class="op" id="7459005">(</span><span class="ident" id="7459006">b</span>&nbsp;<span class="op" id="7459008">*</span><span class="ident" id="7459009"><a href="/gostd/crypto/rc4/rc4_test.go.html#7454550">testing</a></span><span class="op" id="7459016">.</span><span class="ident" id="7459017"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="7459018">)</span>&nbsp;<span class="op" id="7459020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7459023"><a href="/gostd/crypto/rc4/rc4_test.go.html#7458651">benchmark</a></span><span class="op" id="7459032">(</span><span class="ident" id="7459033"><a href="/gostd/crypto/rc4/rc4_test.go.html#7459006">b</a></span><span class="op" id="7459034">,</span>&nbsp;<span class="num" id="7459036">8096</span><span class="op" id="7459040">)</span><br>
<span class="lineno"></span><span class="op" id="7459042">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
