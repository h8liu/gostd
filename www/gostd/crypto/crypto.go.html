<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto</h2>
<ul>
<li><a href="/gostd/crypto/crypto.go.html">crypto.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3202322">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3202377">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3202431">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3202482">//&nbsp;Package&nbsp;crypto&nbsp;collects&nbsp;common&nbsp;cryptographic&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3202541">package</span>&nbsp;<span class="ident" id="3202549">crypto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3202557">import</span>&nbsp;<span class="op" id="3202564">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3202567">&#34;hash&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3202575">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3202581">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="3202591">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3202594">//&nbsp;Hash&nbsp;identifies&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;function&nbsp;that&nbsp;is&nbsp;implemented&nbsp;in&nbsp;another</span><br>
<span class="lineno">15</span><span class="comment" id="3202674">//&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="3202686">type</span>&nbsp;<span class="ident" id="3202691">Hash</span>&nbsp;<span class="builtintype" id="3202696">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3202702">//&nbsp;HashFunc&nbsp;simply&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;h&nbsp;so&nbsp;that&nbsp;Hash&nbsp;implements&nbsp;SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="3202780">func</span>&nbsp;<span class="op" id="3202785">(</span><span class="ident" id="3202786">h</span>&nbsp;<span class="ident" id="3202788">Hash</span><span class="op" id="3202792">)</span>&nbsp;<span class="ident" id="3202794">HashFunc</span><span class="op" id="3202802">(</span><span class="op" id="3202803">)</span>&nbsp;<span class="ident" id="3202805">Hash</span>&nbsp;<span class="op" id="3202810">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3202813">return</span>&nbsp;<span class="ident" id="3202820">h</span><br>
<span class="lineno"></span><span class="op" id="3202822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3202825">const</span>&nbsp;<span class="op" id="3202831">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202834">MD4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3202844">Hash</span>&nbsp;<span class="op" id="3202849">=</span>&nbsp;<span class="num" id="3202851">1</span>&nbsp;<span class="op" id="3202853">+</span>&nbsp;<span class="ident" id="3202855">iota</span>&nbsp;<span class="comment" id="3202860">//&nbsp;import&nbsp;golang.org/x/crypto/md4</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202895">MD5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3202921">//&nbsp;import&nbsp;crypto/md5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202943">SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3202969">//&nbsp;import&nbsp;crypto/sha1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3202992">SHA224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3203018">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203043">SHA256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3203069">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203094">SHA384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3203120">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203145">SHA512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3203171">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203196">MD5SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3203222">//&nbsp;no&nbsp;implementation;&nbsp;MD5+SHA1&nbsp;used&nbsp;for&nbsp;TLS&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203271">RIPEMD160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3203297">//&nbsp;import&nbsp;golang.org/x/crypto/ripemd160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203338">SHA3_224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3203364">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203400">SHA3_256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3203426">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203462">SHA3_384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3203488">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203524">SHA3_512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3203550">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203586">maxHash</span><br>
<span class="lineno"></span><span class="op" id="3203594">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3203597">var</span>&nbsp;<span class="ident" id="3203601">digestSizes</span>&nbsp;<span class="op" id="3203613">=</span>&nbsp;<span class="op" id="3203615">[</span><span class="op" id="3203616">]</span><span class="builtintype" id="3203617">uint8</span><span class="op" id="3203622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203625">MD4</span><span class="op" id="3203628">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3203636">16</span><span class="op" id="3203638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203641">MD5</span><span class="op" id="3203644">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3203652">16</span><span class="op" id="3203654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203657">SHA1</span><span class="op" id="3203661">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3203668">20</span><span class="op" id="3203670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203673">SHA224</span><span class="op" id="3203679">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3203684">28</span><span class="op" id="3203686">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203689">SHA256</span><span class="op" id="3203695">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3203700">32</span><span class="op" id="3203702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203705">SHA384</span><span class="op" id="3203711">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3203716">48</span><span class="op" id="3203718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203721">SHA512</span><span class="op" id="3203727">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3203732">64</span><span class="op" id="3203734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203737">SHA3_224</span><span class="op" id="3203745">:</span>&nbsp;&nbsp;<span class="num" id="3203748">28</span><span class="op" id="3203750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203753">SHA3_256</span><span class="op" id="3203761">:</span>&nbsp;&nbsp;<span class="num" id="3203764">32</span><span class="op" id="3203766">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203769">SHA3_384</span><span class="op" id="3203777">:</span>&nbsp;&nbsp;<span class="num" id="3203780">48</span><span class="op" id="3203782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203785">SHA3_512</span><span class="op" id="3203793">:</span>&nbsp;&nbsp;<span class="num" id="3203796">64</span><span class="op" id="3203798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203801">MD5SHA1</span><span class="op" id="3203808">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="3203812">36</span><span class="op" id="3203814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3203817">RIPEMD160</span><span class="op" id="3203826">:</span>&nbsp;<span class="num" id="3203828">20</span><span class="op" id="3203830">,</span><br>
<span class="lineno"></span><span class="op" id="3203832">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="3203835">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;length,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;a&nbsp;digest&nbsp;resulting&nbsp;from&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="3203915">//&nbsp;function.&nbsp;It&nbsp;doesn&#39;t&nbsp;require&nbsp;that&nbsp;the&nbsp;hash&nbsp;function&nbsp;in&nbsp;question&nbsp;be&nbsp;linked</span><br>
<span class="lineno"></span><span class="comment" id="3203992">//&nbsp;into&nbsp;the&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="3204013">func</span>&nbsp;<span class="op" id="3204018">(</span><span class="ident" id="3204019">h</span>&nbsp;<span class="ident" id="3204021">Hash</span><span class="op" id="3204025">)</span>&nbsp;<span class="ident" id="3204027">Size</span><span class="op" id="3204031">(</span><span class="op" id="3204032">)</span>&nbsp;<span class="builtintype" id="3204034">int</span>&nbsp;<span class="op" id="3204038">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204041">if</span>&nbsp;<span class="ident" id="3204044">h</span>&nbsp;<span class="op" id="3204046">&gt;</span>&nbsp;<span class="num" id="3204048">0</span>&nbsp;<span class="op" id="3204050">&amp;&amp;</span>&nbsp;<span class="ident" id="3204053">h</span>&nbsp;<span class="op" id="3204055">&lt;</span>&nbsp;<span class="ident" id="3204057">maxHash</span>&nbsp;<span class="op" id="3204065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204069">return</span>&nbsp;<span class="builtintype" id="3204076">int</span><span class="op" id="3204079">(</span><span class="ident" id="3204080">digestSizes</span><span class="op" id="3204091">[</span><span class="ident" id="3204092">h</span><span class="op" id="3204093">]</span><span class="op" id="3204094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3204097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3204100">panic</span><span class="op" id="3204105">(</span><span class="string" id="3204106">&#34;crypto:&nbsp;Size&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="3204145">)</span><br>
<span class="lineno"></span><span class="op" id="3204147">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3204150">var</span>&nbsp;<span class="ident" id="3204154">hashes</span>&nbsp;<span class="op" id="3204161">=</span>&nbsp;<span class="builtinfunc" id="3204163">make</span><span class="op" id="3204167">(</span><span class="op" id="3204168">[</span><span class="op" id="3204169">]</span><span class="keyword" id="3204170">func</span><span class="op" id="3204174">(</span><span class="op" id="3204175">)</span>&nbsp;<span class="ident" id="3204177">hash</span><span class="op" id="3204181">.</span><span class="ident" id="3204182">Hash</span><span class="op" id="3204186">,</span>&nbsp;<span class="ident" id="3204188">maxHash</span><span class="op" id="3204195">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3204198">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;calculating&nbsp;the&nbsp;given&nbsp;hash&nbsp;function.&nbsp;New&nbsp;panics</span><br>
<span class="lineno"></span><span class="comment" id="3204277">//&nbsp;if&nbsp;the&nbsp;hash&nbsp;function&nbsp;is&nbsp;not&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno">70</span><span class="keyword" id="3204332">func</span>&nbsp;<span class="op" id="3204337">(</span><span class="ident" id="3204338">h</span>&nbsp;<span class="ident" id="3204340">Hash</span><span class="op" id="3204344">)</span>&nbsp;<span class="ident" id="3204346">New</span><span class="op" id="3204349">(</span><span class="op" id="3204350">)</span>&nbsp;<span class="ident" id="3204352">hash</span><span class="op" id="3204356">.</span><span class="ident" id="3204357">Hash</span>&nbsp;<span class="op" id="3204362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204365">if</span>&nbsp;<span class="ident" id="3204368">h</span>&nbsp;<span class="op" id="3204370">&gt;</span>&nbsp;<span class="num" id="3204372">0</span>&nbsp;<span class="op" id="3204374">&amp;&amp;</span>&nbsp;<span class="ident" id="3204377">h</span>&nbsp;<span class="op" id="3204379">&lt;</span>&nbsp;<span class="ident" id="3204381">maxHash</span>&nbsp;<span class="op" id="3204389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3204393">f</span>&nbsp;<span class="op" id="3204395">:=</span>&nbsp;<span class="ident" id="3204398">hashes</span><span class="op" id="3204404">[</span><span class="ident" id="3204405">h</span><span class="op" id="3204406">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204410">if</span>&nbsp;<span class="ident" id="3204413">f</span>&nbsp;<span class="op" id="3204415">!=</span>&nbsp;<span class="ident" id="3204418">nil</span>&nbsp;<span class="op" id="3204422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204427">return</span>&nbsp;<span class="ident" id="3204434">f</span><span class="op" id="3204435">(</span><span class="op" id="3204436">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3204440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3204443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3204446">panic</span><span class="op" id="3204451">(</span><span class="string" id="3204452">&#34;crypto:&nbsp;requested&nbsp;hash&nbsp;function&nbsp;#&#34;</span>&nbsp;<span class="op" id="3204488">+</span>&nbsp;<span class="ident" id="3204490">strconv</span><span class="op" id="3204497">.</span><span class="ident" id="3204498">Itoa</span><span class="op" id="3204502">(</span><span class="builtintype" id="3204503">int</span><span class="op" id="3204506">(</span><span class="ident" id="3204507">h</span><span class="op" id="3204508">)</span><span class="op" id="3204509">)</span>&nbsp;<span class="op" id="3204511">+</span>&nbsp;<span class="string" id="3204513">&#34;&nbsp;is&nbsp;unavailable&#34;</span><span class="op" id="3204530">)</span><br>
<span class="lineno"></span><span class="op" id="3204532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3204535">//&nbsp;Available&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;hash&nbsp;function&nbsp;is&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="3204615">func</span>&nbsp;<span class="op" id="3204620">(</span><span class="ident" id="3204621">h</span>&nbsp;<span class="ident" id="3204623">Hash</span><span class="op" id="3204627">)</span>&nbsp;<span class="ident" id="3204629">Available</span><span class="op" id="3204638">(</span><span class="op" id="3204639">)</span>&nbsp;<span class="builtintype" id="3204641">bool</span>&nbsp;<span class="op" id="3204646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204649">return</span>&nbsp;<span class="ident" id="3204656">h</span>&nbsp;<span class="op" id="3204658">&lt;</span>&nbsp;<span class="ident" id="3204660">maxHash</span>&nbsp;<span class="op" id="3204668">&amp;&amp;</span>&nbsp;<span class="ident" id="3204671">hashes</span><span class="op" id="3204677">[</span><span class="ident" id="3204678">h</span><span class="op" id="3204679">]</span>&nbsp;<span class="op" id="3204681">!=</span>&nbsp;<span class="ident" id="3204684">nil</span><br>
<span class="lineno"></span><span class="op" id="3204688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3204691">//&nbsp;RegisterHash&nbsp;registers&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3204769">//&nbsp;hash&nbsp;function.&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;init&nbsp;function&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3204843">//&nbsp;packages&nbsp;that&nbsp;implement&nbsp;hash&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="3204886">func</span>&nbsp;<span class="ident" id="3204891">RegisterHash</span><span class="op" id="3204903">(</span><span class="ident" id="3204904">h</span>&nbsp;<span class="ident" id="3204906">Hash</span><span class="op" id="3204910">,</span>&nbsp;<span class="ident" id="3204912">f</span>&nbsp;<span class="keyword" id="3204914">func</span><span class="op" id="3204918">(</span><span class="op" id="3204919">)</span>&nbsp;<span class="ident" id="3204921">hash</span><span class="op" id="3204925">.</span><span class="ident" id="3204926">Hash</span><span class="op" id="3204930">)</span>&nbsp;<span class="op" id="3204932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3204935">if</span>&nbsp;<span class="ident" id="3204938">h</span>&nbsp;<span class="op" id="3204940">&gt;=</span>&nbsp;<span class="ident" id="3204943">maxHash</span>&nbsp;<span class="op" id="3204951">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3204955">panic</span><span class="op" id="3204960">(</span><span class="string" id="3204961">&#34;crypto:&nbsp;RegisterHash&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="3205008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3205011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3205014">hashes</span><span class="op" id="3205020">[</span><span class="ident" id="3205021">h</span><span class="op" id="3205022">]</span>&nbsp;<span class="op" id="3205024">=</span>&nbsp;<span class="ident" id="3205026">f</span><br>
<span class="lineno"></span><span class="op" id="3205028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="3205031">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;public&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3205100">type</span>&nbsp;<span class="ident" id="3205105">PublicKey</span>&nbsp;<span class="keyword" id="3205115">interface</span><span class="op" id="3205124">{</span><span class="op" id="3205125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3205128">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;private&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3205199">type</span>&nbsp;<span class="ident" id="3205204">PrivateKey</span>&nbsp;<span class="keyword" id="3205215">interface</span><span class="op" id="3205224">{</span><span class="op" id="3205225">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3205228">//&nbsp;Signer&nbsp;is&nbsp;an&nbsp;interface&nbsp;for&nbsp;an&nbsp;opaque&nbsp;private&nbsp;key&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3205301">//&nbsp;signing&nbsp;operations.&nbsp;For&nbsp;example,&nbsp;an&nbsp;RSA&nbsp;key&nbsp;kept&nbsp;in&nbsp;a&nbsp;hardware&nbsp;module.</span><br>
<span class="lineno"></span><span class="keyword" id="3205375">type</span>&nbsp;<span class="ident" id="3205380">Signer</span>&nbsp;<span class="keyword" id="3205387">interface</span>&nbsp;<span class="op" id="3205397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3205400">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;opaque,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3205463">//&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3205480">Public</span><span class="op" id="3205486">(</span><span class="op" id="3205487">)</span>&nbsp;<span class="ident" id="3205489">PublicKey</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3205501">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;the&nbsp;private&nbsp;key,&nbsp;possibly&nbsp;using&nbsp;entropy&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3205570">//&nbsp;rand.&nbsp;For&nbsp;an&nbsp;RSA&nbsp;key,&nbsp;the&nbsp;resulting&nbsp;signature&nbsp;should&nbsp;be&nbsp;either&nbsp;a</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3205639">//&nbsp;PKCS#1&nbsp;v1.5&nbsp;or&nbsp;PSS&nbsp;signature&nbsp;(as&nbsp;indicated&nbsp;by&nbsp;opts).&nbsp;For&nbsp;an&nbsp;(EC)DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3205711">//&nbsp;key,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;DER-serialised,&nbsp;ASN.1&nbsp;signature&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3205778">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3205782">//&nbsp;Hash&nbsp;implements&nbsp;the&nbsp;SignerOpts&nbsp;interface&nbsp;and,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;one&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3205855">//&nbsp;simply&nbsp;pass&nbsp;in&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;as&nbsp;opts.&nbsp;Sign&nbsp;may&nbsp;also&nbsp;attempt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3205928">//&nbsp;to&nbsp;type&nbsp;assert&nbsp;opts&nbsp;to&nbsp;other&nbsp;types&nbsp;in&nbsp;order&nbsp;to&nbsp;obtain&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3205996">//&nbsp;specific&nbsp;values.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;in&nbsp;each&nbsp;package&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206068">Sign</span><span class="op" id="3206072">(</span><span class="ident" id="3206073">rand</span>&nbsp;<span class="ident" id="3206078">io</span><span class="op" id="3206080">.</span><span class="ident" id="3206081">Reader</span><span class="op" id="3206087">,</span>&nbsp;<span class="ident" id="3206089">msg</span>&nbsp;<span class="op" id="3206093">[</span><span class="op" id="3206094">]</span><span class="builtintype" id="3206095">byte</span><span class="op" id="3206099">,</span>&nbsp;<span class="ident" id="3206101">opts</span>&nbsp;<span class="ident" id="3206106">SignerOpts</span><span class="op" id="3206116">)</span>&nbsp;<span class="op" id="3206118">(</span><span class="ident" id="3206119">signature</span>&nbsp;<span class="op" id="3206129">[</span><span class="op" id="3206130">]</span><span class="builtintype" id="3206131">byte</span><span class="op" id="3206135">,</span>&nbsp;<span class="ident" id="3206137">err</span>&nbsp;<span class="builtintype" id="3206141">error</span><span class="op" id="3206146">)</span><br>
<span class="lineno"></span><span class="op" id="3206148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3206151">//&nbsp;SignerOpts&nbsp;contains&nbsp;options&nbsp;for&nbsp;signing&nbsp;with&nbsp;a&nbsp;Signer.</span><br>
<span class="lineno"></span><span class="keyword" id="3206209">type</span>&nbsp;<span class="ident" id="3206214">SignerOpts</span>&nbsp;<span class="keyword" id="3206225">interface</span>&nbsp;<span class="op" id="3206235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3206238">//&nbsp;HashFunc&nbsp;returns&nbsp;an&nbsp;identifier&nbsp;for&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;to&nbsp;produce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3206311">//&nbsp;the&nbsp;message&nbsp;passed&nbsp;to&nbsp;Signer.Sign,&nbsp;or&nbsp;else&nbsp;zero&nbsp;to&nbsp;indicate&nbsp;that&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3206383">//&nbsp;hashing&nbsp;was&nbsp;done.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3206405">HashFunc</span><span class="op" id="3206413">(</span><span class="op" id="3206414">)</span>&nbsp;<span class="ident" id="3206416">Hash</span><br>
<span class="lineno"></span><span class="op" id="3206421">}</span>
</div>
</body>
</html>
