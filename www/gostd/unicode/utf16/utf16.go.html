<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode/utf16</h2>
<ul>
<li><a href="/gostd/unicode/utf16/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16.go.html">utf16.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16_test.go.html">utf16_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3332654">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3332710">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3332764">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3332815">//&nbsp;Package&nbsp;utf16&nbsp;implements&nbsp;encoding&nbsp;and&nbsp;decoding&nbsp;of&nbsp;UTF-16&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="keyword" id="3332886">package</span>&nbsp;<span class="ident" id="3332894">utf16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3332901">//&nbsp;The&nbsp;conditions&nbsp;replacementChar==unicode.ReplacementChar&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3332964">//&nbsp;maxRune==unicode.MaxRune&nbsp;are&nbsp;verified&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno">10</span><span class="comment" id="3333019">//&nbsp;Defining&nbsp;them&nbsp;locally&nbsp;avoids&nbsp;this&nbsp;package&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3333095">const</span>&nbsp;<span class="op" id="3333101">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3333104">replacementChar</span>&nbsp;<span class="op" id="3333120">=</span>&nbsp;<span class="string" id="3333122">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3333135">//&nbsp;Unicode&nbsp;replacement&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3333169">maxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3333185">=</span>&nbsp;<span class="string" id="3333187">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="3333200">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno">15</span><span class="op" id="3333237">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3333240">const</span>&nbsp;<span class="op" id="3333246">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3333249">//&nbsp;0xd800-0xdc00&nbsp;encodes&nbsp;the&nbsp;high&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3333303">//&nbsp;0xdc00-0xe000&nbsp;encodes&nbsp;the&nbsp;low&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3333356">//&nbsp;the&nbsp;value&nbsp;is&nbsp;those&nbsp;20&nbsp;bits&nbsp;plus&nbsp;0x10000.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3333401">surr1</span>&nbsp;<span class="op" id="3333407">=</span>&nbsp;<span class="num" id="3333409">0xd800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3333417">surr2</span>&nbsp;<span class="op" id="3333423">=</span>&nbsp;<span class="num" id="3333425">0xdc00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3333433">surr3</span>&nbsp;<span class="op" id="3333439">=</span>&nbsp;<span class="num" id="3333441">0xe000</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3333450">surrSelf</span>&nbsp;<span class="op" id="3333459">=</span>&nbsp;<span class="num" id="3333461">0x10000</span><br>
<span class="lineno"></span><span class="op" id="3333469">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3333472">//&nbsp;IsSurrogate&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;specified&nbsp;Unicode&nbsp;code&nbsp;point</span><br>
<span class="lineno"></span><span class="comment" id="3333536">//&nbsp;can&nbsp;appear&nbsp;in&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">30</span><span class="keyword" id="3333571">func</span>&nbsp;<span class="ident" id="3333576">IsSurrogate</span><span class="op" id="3333587">(</span><span class="ident" id="3333588">r</span>&nbsp;<span class="builtintype" id="3333590">rune</span><span class="op" id="3333594">)</span>&nbsp;<span class="builtintype" id="3333596">bool</span>&nbsp;<span class="op" id="3333601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3333604">return</span>&nbsp;<span class="ident" id="3333611">surr1</span>&nbsp;<span class="op" id="3333617">&lt;=</span>&nbsp;<span class="ident" id="3333620">r</span>&nbsp;<span class="op" id="3333622">&amp;&amp;</span>&nbsp;<span class="ident" id="3333625">r</span>&nbsp;<span class="op" id="3333627">&lt;</span>&nbsp;<span class="ident" id="3333629">surr3</span><br>
<span class="lineno"></span><span class="op" id="3333635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3333638">//&nbsp;DecodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;decoding&nbsp;of&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">35</span><span class="comment" id="3333701">//&nbsp;If&nbsp;the&nbsp;pair&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;UTF-16&nbsp;surrogate&nbsp;pair,&nbsp;DecodeRune&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3333773">//&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;code&nbsp;point&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="3333819">func</span>&nbsp;<span class="ident" id="3333824">DecodeRune</span><span class="op" id="3333834">(</span><span class="ident" id="3333835">r1</span><span class="op" id="3333837">,</span>&nbsp;<span class="ident" id="3333839">r2</span>&nbsp;<span class="builtintype" id="3333842">rune</span><span class="op" id="3333846">)</span>&nbsp;<span class="builtintype" id="3333848">rune</span>&nbsp;<span class="op" id="3333853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3333856">if</span>&nbsp;<span class="ident" id="3333859">surr1</span>&nbsp;<span class="op" id="3333865">&lt;=</span>&nbsp;<span class="ident" id="3333868">r1</span>&nbsp;<span class="op" id="3333871">&amp;&amp;</span>&nbsp;<span class="ident" id="3333874">r1</span>&nbsp;<span class="op" id="3333877">&lt;</span>&nbsp;<span class="ident" id="3333879">surr2</span>&nbsp;<span class="op" id="3333885">&amp;&amp;</span>&nbsp;<span class="ident" id="3333888">surr2</span>&nbsp;<span class="op" id="3333894">&lt;=</span>&nbsp;<span class="ident" id="3333897">r2</span>&nbsp;<span class="op" id="3333900">&amp;&amp;</span>&nbsp;<span class="ident" id="3333903">r2</span>&nbsp;<span class="op" id="3333906">&lt;</span>&nbsp;<span class="ident" id="3333908">surr3</span>&nbsp;<span class="op" id="3333914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3333918">return</span>&nbsp;<span class="op" id="3333925">(</span><span class="ident" id="3333926">r1</span><span class="op" id="3333928">-</span><span class="ident" id="3333929">surr1</span><span class="op" id="3333934">)</span><span class="op" id="3333935">&lt;&lt;</span><span class="num" id="3333937">10</span>&nbsp;<span class="op" id="3333940">|</span>&nbsp;<span class="op" id="3333942">(</span><span class="ident" id="3333943">r2</span>&nbsp;<span class="op" id="3333946">-</span>&nbsp;<span class="ident" id="3333948">surr2</span><span class="op" id="3333953">)</span>&nbsp;<span class="op" id="3333955">+</span>&nbsp;<span class="num" id="3333957">0x10000</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3333966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3333969">return</span>&nbsp;<span class="ident" id="3333976">replacementChar</span><br>
<span class="lineno"></span><span class="op" id="3333992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3333995">//&nbsp;EncodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;surrogate&nbsp;pair&nbsp;r1,&nbsp;r2&nbsp;for&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno">45</span><span class="comment" id="3334070">//&nbsp;If&nbsp;the&nbsp;rune&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;does&nbsp;not&nbsp;need&nbsp;encoding,</span><br>
<span class="lineno"></span><span class="comment" id="3334146">//&nbsp;EncodeRune&nbsp;returns&nbsp;U+FFFD,&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="3334184">func</span>&nbsp;<span class="ident" id="3334189">EncodeRune</span><span class="op" id="3334199">(</span><span class="ident" id="3334200">r</span>&nbsp;<span class="builtintype" id="3334202">rune</span><span class="op" id="3334206">)</span>&nbsp;<span class="op" id="3334208">(</span><span class="ident" id="3334209">r1</span><span class="op" id="3334211">,</span>&nbsp;<span class="ident" id="3334213">r2</span>&nbsp;<span class="builtintype" id="3334216">rune</span><span class="op" id="3334220">)</span>&nbsp;<span class="op" id="3334222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334225">if</span>&nbsp;<span class="ident" id="3334228">r</span>&nbsp;<span class="op" id="3334230">&lt;</span>&nbsp;<span class="ident" id="3334232">surrSelf</span>&nbsp;<span class="op" id="3334241">||</span>&nbsp;<span class="ident" id="3334244">r</span>&nbsp;<span class="op" id="3334246">&gt;</span>&nbsp;<span class="ident" id="3334248">maxRune</span>&nbsp;<span class="op" id="3334256">||</span>&nbsp;<span class="ident" id="3334259">IsSurrogate</span><span class="op" id="3334270">(</span><span class="ident" id="3334271">r</span><span class="op" id="3334272">)</span>&nbsp;<span class="op" id="3334274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334278">return</span>&nbsp;<span class="ident" id="3334285">replacementChar</span><span class="op" id="3334300">,</span>&nbsp;<span class="ident" id="3334302">replacementChar</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3334319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334322">r</span>&nbsp;<span class="op" id="3334324">-=</span>&nbsp;<span class="ident" id="3334327">surrSelf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334337">return</span>&nbsp;<span class="ident" id="3334344">surr1</span>&nbsp;<span class="op" id="3334350">+</span>&nbsp;<span class="op" id="3334352">(</span><span class="ident" id="3334353">r</span><span class="op" id="3334354">&gt;&gt;</span><span class="num" id="3334356">10</span><span class="op" id="3334358">)</span><span class="op" id="3334359">&amp;</span><span class="num" id="3334360">0x3ff</span><span class="op" id="3334365">,</span>&nbsp;<span class="ident" id="3334367">surr2</span>&nbsp;<span class="op" id="3334373">+</span>&nbsp;<span class="ident" id="3334375">r</span><span class="op" id="3334376">&amp;</span><span class="num" id="3334377">0x3ff</span><br>
<span class="lineno"></span><span class="op" id="3334383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="3334386">//&nbsp;Encode&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;of&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3334462">func</span>&nbsp;<span class="ident" id="3334467">Encode</span><span class="op" id="3334473">(</span><span class="ident" id="3334474">s</span>&nbsp;<span class="op" id="3334476">[</span><span class="op" id="3334477">]</span><span class="builtintype" id="3334478">rune</span><span class="op" id="3334482">)</span>&nbsp;<span class="op" id="3334484">[</span><span class="op" id="3334485">]</span><span class="builtintype" id="3334486">uint16</span>&nbsp;<span class="op" id="3334493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334496">n</span>&nbsp;<span class="op" id="3334498">:=</span>&nbsp;<span class="builtinfunc" id="3334501">len</span><span class="op" id="3334504">(</span><span class="ident" id="3334505">s</span><span class="op" id="3334506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334509">for</span>&nbsp;<span class="ident" id="3334513">_</span><span class="op" id="3334514">,</span>&nbsp;<span class="ident" id="3334516">v</span>&nbsp;<span class="op" id="3334518">:=</span>&nbsp;<span class="keyword" id="3334521">range</span>&nbsp;<span class="ident" id="3334527">s</span>&nbsp;<span class="op" id="3334529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334533">if</span>&nbsp;<span class="ident" id="3334536">v</span>&nbsp;<span class="op" id="3334538">&gt;=</span>&nbsp;<span class="ident" id="3334541">surrSelf</span>&nbsp;<span class="op" id="3334550">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334555">n</span><span class="op" id="3334556">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3334561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3334564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334568">a</span>&nbsp;<span class="op" id="3334570">:=</span>&nbsp;<span class="builtinfunc" id="3334573">make</span><span class="op" id="3334577">(</span><span class="op" id="3334578">[</span><span class="op" id="3334579">]</span><span class="builtintype" id="3334580">uint16</span><span class="op" id="3334586">,</span>&nbsp;<span class="ident" id="3334588">n</span><span class="op" id="3334589">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334592">n</span>&nbsp;<span class="op" id="3334594">=</span>&nbsp;<span class="num" id="3334596">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334599">for</span>&nbsp;<span class="ident" id="3334603">_</span><span class="op" id="3334604">,</span>&nbsp;<span class="ident" id="3334606">v</span>&nbsp;<span class="op" id="3334608">:=</span>&nbsp;<span class="keyword" id="3334611">range</span>&nbsp;<span class="ident" id="3334617">s</span>&nbsp;<span class="op" id="3334619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334623">switch</span>&nbsp;<span class="op" id="3334630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334634">case</span>&nbsp;<span class="ident" id="3334639">v</span>&nbsp;<span class="op" id="3334641">&lt;</span>&nbsp;<span class="num" id="3334643">0</span><span class="op" id="3334644">,</span>&nbsp;<span class="ident" id="3334646">surr1</span>&nbsp;<span class="op" id="3334652">&lt;=</span>&nbsp;<span class="ident" id="3334655">v</span>&nbsp;<span class="op" id="3334657">&amp;&amp;</span>&nbsp;<span class="ident" id="3334660">v</span>&nbsp;<span class="op" id="3334662">&lt;</span>&nbsp;<span class="ident" id="3334664">surr3</span><span class="op" id="3334669">,</span>&nbsp;<span class="ident" id="3334671">v</span>&nbsp;<span class="op" id="3334673">&gt;</span>&nbsp;<span class="ident" id="3334675">maxRune</span><span class="op" id="3334682">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334687">v</span>&nbsp;<span class="op" id="3334689">=</span>&nbsp;<span class="ident" id="3334691">replacementChar</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334710">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334724">case</span>&nbsp;<span class="ident" id="3334729">v</span>&nbsp;<span class="op" id="3334731">&lt;</span>&nbsp;<span class="ident" id="3334733">surrSelf</span><span class="op" id="3334741">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334746">a</span><span class="op" id="3334747">[</span><span class="ident" id="3334748">n</span><span class="op" id="3334749">]</span>&nbsp;<span class="op" id="3334751">=</span>&nbsp;<span class="builtintype" id="3334753">uint16</span><span class="op" id="3334759">(</span><span class="ident" id="3334760">v</span><span class="op" id="3334761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334766">n</span><span class="op" id="3334767">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334772">default</span><span class="op" id="3334779">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334784">r1</span><span class="op" id="3334786">,</span>&nbsp;<span class="ident" id="3334788">r2</span>&nbsp;<span class="op" id="3334791">:=</span>&nbsp;<span class="ident" id="3334794">EncodeRune</span><span class="op" id="3334804">(</span><span class="ident" id="3334805">v</span><span class="op" id="3334806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334811">a</span><span class="op" id="3334812">[</span><span class="ident" id="3334813">n</span><span class="op" id="3334814">]</span>&nbsp;<span class="op" id="3334816">=</span>&nbsp;<span class="builtintype" id="3334818">uint16</span><span class="op" id="3334824">(</span><span class="ident" id="3334825">r1</span><span class="op" id="3334827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334832">a</span><span class="op" id="3334833">[</span><span class="ident" id="3334834">n</span><span class="op" id="3334835">+</span><span class="num" id="3334836">1</span><span class="op" id="3334837">]</span>&nbsp;<span class="op" id="3334839">=</span>&nbsp;<span class="builtintype" id="3334841">uint16</span><span class="op" id="3334847">(</span><span class="ident" id="3334848">r2</span><span class="op" id="3334850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3334855">n</span>&nbsp;<span class="op" id="3334857">+=</span>&nbsp;<span class="num" id="3334860">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3334864">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3334867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3334870">return</span>&nbsp;<span class="ident" id="3334877">a</span><span class="op" id="3334878">[</span><span class="num" id="3334879">0</span><span class="op" id="3334880">:</span><span class="ident" id="3334881">n</span><span class="op" id="3334882">]</span><br>
<span class="lineno"></span><span class="op" id="3334884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3334887">//&nbsp;Decode&nbsp;returns&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;represented</span><br>
<span class="lineno">85</span><span class="comment" id="3334949">//&nbsp;by&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3334978">func</span>&nbsp;<span class="ident" id="3334983">Decode</span><span class="op" id="3334989">(</span><span class="ident" id="3334990">s</span>&nbsp;<span class="op" id="3334992">[</span><span class="op" id="3334993">]</span><span class="builtintype" id="3334994">uint16</span><span class="op" id="3335000">)</span>&nbsp;<span class="op" id="3335002">[</span><span class="op" id="3335003">]</span><span class="builtintype" id="3335004">rune</span>&nbsp;<span class="op" id="3335009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3335012">a</span>&nbsp;<span class="op" id="3335014">:=</span>&nbsp;<span class="builtinfunc" id="3335017">make</span><span class="op" id="3335021">(</span><span class="op" id="3335022">[</span><span class="op" id="3335023">]</span><span class="builtintype" id="3335024">rune</span><span class="op" id="3335028">,</span>&nbsp;<span class="builtinfunc" id="3335030">len</span><span class="op" id="3335033">(</span><span class="ident" id="3335034">s</span><span class="op" id="3335035">)</span><span class="op" id="3335036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3335039">n</span>&nbsp;<span class="op" id="3335041">:=</span>&nbsp;<span class="num" id="3335044">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3335047">for</span>&nbsp;<span class="ident" id="3335051">i</span>&nbsp;<span class="op" id="3335053">:=</span>&nbsp;<span class="num" id="3335056">0</span><span class="op" id="3335057">;</span>&nbsp;<span class="ident" id="3335059">i</span>&nbsp;<span class="op" id="3335061">&lt;</span>&nbsp;<span class="builtinfunc" id="3335063">len</span><span class="op" id="3335066">(</span><span class="ident" id="3335067">s</span><span class="op" id="3335068">)</span><span class="op" id="3335069">;</span>&nbsp;<span class="ident" id="3335071">i</span><span class="op" id="3335072">++</span>&nbsp;<span class="op" id="3335075">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3335079">switch</span>&nbsp;<span class="ident" id="3335086">r</span>&nbsp;<span class="op" id="3335088">:=</span>&nbsp;<span class="ident" id="3335091">s</span><span class="op" id="3335092">[</span><span class="ident" id="3335093">i</span><span class="op" id="3335094">]</span><span class="op" id="3335095">;</span>&nbsp;<span class="op" id="3335097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3335101">case</span>&nbsp;<span class="ident" id="3335106">surr1</span>&nbsp;<span class="op" id="3335112">&lt;=</span>&nbsp;<span class="ident" id="3335115">r</span>&nbsp;<span class="op" id="3335117">&amp;&amp;</span>&nbsp;<span class="ident" id="3335120">r</span>&nbsp;<span class="op" id="3335122">&lt;</span>&nbsp;<span class="ident" id="3335124">surr2</span>&nbsp;<span class="op" id="3335130">&amp;&amp;</span>&nbsp;<span class="ident" id="3335133">i</span><span class="op" id="3335134">+</span><span class="num" id="3335135">1</span>&nbsp;<span class="op" id="3335137">&lt;</span>&nbsp;<span class="builtinfunc" id="3335139">len</span><span class="op" id="3335142">(</span><span class="ident" id="3335143">s</span><span class="op" id="3335144">)</span>&nbsp;<span class="op" id="3335146">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3335152">surr2</span>&nbsp;<span class="op" id="3335158">&lt;=</span>&nbsp;<span class="ident" id="3335161">s</span><span class="op" id="3335162">[</span><span class="ident" id="3335163">i</span><span class="op" id="3335164">+</span><span class="num" id="3335165">1</span><span class="op" id="3335166">]</span>&nbsp;<span class="op" id="3335168">&amp;&amp;</span>&nbsp;<span class="ident" id="3335171">s</span><span class="op" id="3335172">[</span><span class="ident" id="3335173">i</span><span class="op" id="3335174">+</span><span class="num" id="3335175">1</span><span class="op" id="3335176">]</span>&nbsp;<span class="op" id="3335178">&lt;</span>&nbsp;<span class="ident" id="3335180">surr3</span><span class="op" id="3335185">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3335190">//&nbsp;valid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3335221">a</span><span class="op" id="3335222">[</span><span class="ident" id="3335223">n</span><span class="op" id="3335224">]</span>&nbsp;<span class="op" id="3335226">=</span>&nbsp;<span class="ident" id="3335228">DecodeRune</span><span class="op" id="3335238">(</span><span class="builtintype" id="3335239">rune</span><span class="op" id="3335243">(</span><span class="ident" id="3335244">r</span><span class="op" id="3335245">)</span><span class="op" id="3335246">,</span>&nbsp;<span class="builtintype" id="3335248">rune</span><span class="op" id="3335252">(</span><span class="ident" id="3335253">s</span><span class="op" id="3335254">[</span><span class="ident" id="3335255">i</span><span class="op" id="3335256">+</span><span class="num" id="3335257">1</span><span class="op" id="3335258">]</span><span class="op" id="3335259">)</span><span class="op" id="3335260">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3335265">i</span><span class="op" id="3335266">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3335272">n</span><span class="op" id="3335273">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3335278">case</span>&nbsp;<span class="ident" id="3335283">surr1</span>&nbsp;<span class="op" id="3335289">&lt;=</span>&nbsp;<span class="ident" id="3335292">r</span>&nbsp;<span class="op" id="3335294">&amp;&amp;</span>&nbsp;<span class="ident" id="3335297">r</span>&nbsp;<span class="op" id="3335299">&lt;</span>&nbsp;<span class="ident" id="3335301">surr3</span><span class="op" id="3335306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3335311">//&nbsp;invalid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3335344">a</span><span class="op" id="3335345">[</span><span class="ident" id="3335346">n</span><span class="op" id="3335347">]</span>&nbsp;<span class="op" id="3335349">=</span>&nbsp;<span class="ident" id="3335351">replacementChar</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3335370">n</span><span class="op" id="3335371">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3335376">default</span><span class="op" id="3335383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3335388">//&nbsp;normal&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3335406">a</span><span class="op" id="3335407">[</span><span class="ident" id="3335408">n</span><span class="op" id="3335409">]</span>&nbsp;<span class="op" id="3335411">=</span>&nbsp;<span class="builtintype" id="3335413">rune</span><span class="op" id="3335417">(</span><span class="ident" id="3335418">r</span><span class="op" id="3335419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3335424">n</span><span class="op" id="3335425">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3335430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3335433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3335436">return</span>&nbsp;<span class="ident" id="3335443">a</span><span class="op" id="3335444">[</span><span class="num" id="3335445">0</span><span class="op" id="3335446">:</span><span class="ident" id="3335447">n</span><span class="op" id="3335448">]</span><br>
<span class="lineno"></span><span class="op" id="3335450">}</span>
</div>
</body>
</html>
