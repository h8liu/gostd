<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html" class="current">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8196035">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8196090">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8196144">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8196195">package</span>&nbsp;<span class="ident" id="8196203">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8196209">import</span>&nbsp;<span class="op" id="8196216">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196219">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196228">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196242">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196258">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196277">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196292">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196306">_</span>&nbsp;<span class="string" id="8196308">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196325">_</span>&nbsp;<span class="string" id="8196327">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196344">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196364">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196381">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196400">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196416">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196432">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196444">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196451">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196462">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196473">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196484">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8196495">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8196502">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="8196505">func</span>&nbsp;<span class="ident" id="8196510">TestParsePKCS1PrivateKey</span><span class="op" id="8196534">(</span><span class="ident" id="8196535">t</span>&nbsp;<span class="op" id="8196537">*</span><span class="ident" id="8196538">testing</span><span class="op" id="8196545">.</span><span class="ident" id="8196546">T</span><span class="op" id="8196547">)</span>&nbsp;<span class="op" id="8196549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196552">block</span><span class="op" id="8196557">,</span>&nbsp;<span class="ident" id="8196559">_</span>&nbsp;<span class="op" id="8196561">:=</span>&nbsp;<span class="ident" id="8196564">pem</span><span class="op" id="8196567">.</span><span class="ident" id="8196568">Decode</span><span class="op" id="8196574">(</span><span class="op" id="8196575">[</span><span class="op" id="8196576">]</span><span class="builtintype" id="8196577">byte</span><span class="op" id="8196581">(</span><span class="ident" id="8196582">pemPrivateKey</span><span class="op" id="8196595">)</span><span class="op" id="8196596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196599">priv</span><span class="op" id="8196603">,</span>&nbsp;<span class="ident" id="8196605">err</span>&nbsp;<span class="op" id="8196609">:=</span>&nbsp;<span class="ident" id="8196612">ParsePKCS1PrivateKey</span><span class="op" id="8196632">(</span><span class="ident" id="8196633">block</span><span class="op" id="8196638">.</span><span class="ident" id="8196639">Bytes</span><span class="op" id="8196644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196647">if</span>&nbsp;<span class="ident" id="8196650">err</span>&nbsp;<span class="op" id="8196654">!=</span>&nbsp;<span class="builtintype" id="8196657">nil</span>&nbsp;<span class="op" id="8196661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196665">t</span><span class="op" id="8196666">.</span><span class="ident" id="8196667">Errorf</span><span class="op" id="8196673">(</span><span class="string" id="8196674">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8196707">,</span>&nbsp;<span class="ident" id="8196709">err</span><span class="op" id="8196712">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196716">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8196724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8196727">if</span>&nbsp;<span class="ident" id="8196730">priv</span><span class="op" id="8196734">.</span><span class="ident" id="8196735">PublicKey</span><span class="op" id="8196744">.</span><span class="ident" id="8196745">N</span><span class="op" id="8196746">.</span><span class="ident" id="8196747">Cmp</span><span class="op" id="8196750">(</span><span class="ident" id="8196751">rsaPrivateKey</span><span class="op" id="8196764">.</span><span class="ident" id="8196765">PublicKey</span><span class="op" id="8196774">.</span><span class="ident" id="8196775">N</span><span class="op" id="8196776">)</span>&nbsp;<span class="op" id="8196778">!=</span>&nbsp;<span class="num" id="8196781">0</span>&nbsp;<span class="op" id="8196783">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196788">priv</span><span class="op" id="8196792">.</span><span class="ident" id="8196793">PublicKey</span><span class="op" id="8196802">.</span><span class="ident" id="8196803">E</span>&nbsp;<span class="op" id="8196805">!=</span>&nbsp;<span class="ident" id="8196808">rsaPrivateKey</span><span class="op" id="8196821">.</span><span class="ident" id="8196822">PublicKey</span><span class="op" id="8196831">.</span><span class="ident" id="8196832">E</span>&nbsp;<span class="op" id="8196834">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196839">priv</span><span class="op" id="8196843">.</span><span class="ident" id="8196844">D</span><span class="op" id="8196845">.</span><span class="ident" id="8196846">Cmp</span><span class="op" id="8196849">(</span><span class="ident" id="8196850">rsaPrivateKey</span><span class="op" id="8196863">.</span><span class="ident" id="8196864">D</span><span class="op" id="8196865">)</span>&nbsp;<span class="op" id="8196867">!=</span>&nbsp;<span class="num" id="8196870">0</span>&nbsp;<span class="op" id="8196872">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196877">priv</span><span class="op" id="8196881">.</span><span class="ident" id="8196882">Primes</span><span class="op" id="8196888">[</span><span class="num" id="8196889">0</span><span class="op" id="8196890">]</span><span class="op" id="8196891">.</span><span class="ident" id="8196892">Cmp</span><span class="op" id="8196895">(</span><span class="ident" id="8196896">rsaPrivateKey</span><span class="op" id="8196909">.</span><span class="ident" id="8196910">Primes</span><span class="op" id="8196916">[</span><span class="num" id="8196917">0</span><span class="op" id="8196918">]</span><span class="op" id="8196919">)</span>&nbsp;<span class="op" id="8196921">!=</span>&nbsp;<span class="num" id="8196924">0</span>&nbsp;<span class="op" id="8196926">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196931">priv</span><span class="op" id="8196935">.</span><span class="ident" id="8196936">Primes</span><span class="op" id="8196942">[</span><span class="num" id="8196943">1</span><span class="op" id="8196944">]</span><span class="op" id="8196945">.</span><span class="ident" id="8196946">Cmp</span><span class="op" id="8196949">(</span><span class="ident" id="8196950">rsaPrivateKey</span><span class="op" id="8196963">.</span><span class="ident" id="8196964">Primes</span><span class="op" id="8196970">[</span><span class="num" id="8196971">1</span><span class="op" id="8196972">]</span><span class="op" id="8196973">)</span>&nbsp;<span class="op" id="8196975">!=</span>&nbsp;<span class="num" id="8196978">0</span>&nbsp;<span class="op" id="8196980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8196984">t</span><span class="op" id="8196985">.</span><span class="ident" id="8196986">Errorf</span><span class="op" id="8196992">(</span><span class="string" id="8196993">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="8197011">,</span>&nbsp;<span class="ident" id="8197013">priv</span><span class="op" id="8197017">,</span>&nbsp;<span class="ident" id="8197019">rsaPrivateKey</span><span class="op" id="8197032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197035">}</span><br>
<span class="lineno"></span><span class="op" id="8197037">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8197040">func</span>&nbsp;<span class="ident" id="8197045">TestParsePKIXPublicKey</span><span class="op" id="8197067">(</span><span class="ident" id="8197068">t</span>&nbsp;<span class="op" id="8197070">*</span><span class="ident" id="8197071">testing</span><span class="op" id="8197078">.</span><span class="ident" id="8197079">T</span><span class="op" id="8197080">)</span>&nbsp;<span class="op" id="8197082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197085">block</span><span class="op" id="8197090">,</span>&nbsp;<span class="ident" id="8197092">_</span>&nbsp;<span class="op" id="8197094">:=</span>&nbsp;<span class="ident" id="8197097">pem</span><span class="op" id="8197100">.</span><span class="ident" id="8197101">Decode</span><span class="op" id="8197107">(</span><span class="op" id="8197108">[</span><span class="op" id="8197109">]</span><span class="builtintype" id="8197110">byte</span><span class="op" id="8197114">(</span><span class="ident" id="8197115">pemPublicKey</span><span class="op" id="8197127">)</span><span class="op" id="8197128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197131">pub</span><span class="op" id="8197134">,</span>&nbsp;<span class="ident" id="8197136">err</span>&nbsp;<span class="op" id="8197140">:=</span>&nbsp;<span class="ident" id="8197143">ParsePKIXPublicKey</span><span class="op" id="8197161">(</span><span class="ident" id="8197162">block</span><span class="op" id="8197167">.</span><span class="ident" id="8197168">Bytes</span><span class="op" id="8197173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197176">if</span>&nbsp;<span class="ident" id="8197179">err</span>&nbsp;<span class="op" id="8197183">!=</span>&nbsp;<span class="builtintype" id="8197186">nil</span>&nbsp;<span class="op" id="8197190">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197194">t</span><span class="op" id="8197195">.</span><span class="ident" id="8197196">Errorf</span><span class="op" id="8197202">(</span><span class="string" id="8197203">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8197239">,</span>&nbsp;<span class="ident" id="8197241">err</span><span class="op" id="8197244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197248">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197259">rsaPub</span><span class="op" id="8197265">,</span>&nbsp;<span class="ident" id="8197267">ok</span>&nbsp;<span class="op" id="8197270">:=</span>&nbsp;<span class="ident" id="8197273">pub</span><span class="op" id="8197276">.</span><span class="op" id="8197277">(</span><span class="op" id="8197278">*</span><span class="ident" id="8197279">rsa</span><span class="op" id="8197282">.</span><span class="ident" id="8197283">PublicKey</span><span class="op" id="8197292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197295">if</span>&nbsp;<span class="op" id="8197298">!</span><span class="ident" id="8197299">ok</span>&nbsp;<span class="op" id="8197302">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197306">t</span><span class="op" id="8197307">.</span><span class="ident" id="8197308">Errorf</span><span class="op" id="8197314">(</span><span class="string" id="8197315">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="8197381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197385">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197397">pubBytes2</span><span class="op" id="8197406">,</span>&nbsp;<span class="ident" id="8197408">err</span>&nbsp;<span class="op" id="8197412">:=</span>&nbsp;<span class="ident" id="8197415">MarshalPKIXPublicKey</span><span class="op" id="8197435">(</span><span class="ident" id="8197436">rsaPub</span><span class="op" id="8197442">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197445">if</span>&nbsp;<span class="ident" id="8197448">err</span>&nbsp;<span class="op" id="8197452">!=</span>&nbsp;<span class="builtintype" id="8197455">nil</span>&nbsp;<span class="op" id="8197459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197463">t</span><span class="op" id="8197464">.</span><span class="ident" id="8197465">Errorf</span><span class="op" id="8197471">(</span><span class="string" id="8197472">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="8197530">,</span>&nbsp;<span class="ident" id="8197532">err</span><span class="op" id="8197535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197539">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8197550">if</span>&nbsp;<span class="op" id="8197553">!</span><span class="ident" id="8197554">bytes</span><span class="op" id="8197559">.</span><span class="ident" id="8197560">Equal</span><span class="op" id="8197565">(</span><span class="ident" id="8197566">pubBytes2</span><span class="op" id="8197575">,</span>&nbsp;<span class="ident" id="8197577">block</span><span class="op" id="8197582">.</span><span class="ident" id="8197583">Bytes</span><span class="op" id="8197588">)</span>&nbsp;<span class="op" id="8197590">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8197594">t</span><span class="op" id="8197595">.</span><span class="ident" id="8197596">Errorf</span><span class="op" id="8197602">(</span><span class="string" id="8197603">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8197664">,</span>&nbsp;<span class="ident" id="8197666">pubBytes2</span><span class="op" id="8197675">,</span>&nbsp;<span class="ident" id="8197677">block</span><span class="op" id="8197682">.</span><span class="ident" id="8197683">Bytes</span><span class="op" id="8197688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8197691">}</span><br>
<span class="lineno"></span><span class="op" id="8197693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8197696">var</span>&nbsp;<span class="ident" id="8197700">pemPublicKey</span>&nbsp;<span class="op" id="8197713">=</span>&nbsp;<span class="string" id="8197715">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="8198170">var</span>&nbsp;<span class="ident" id="8198174">pemPrivateKey</span>&nbsp;<span class="op" id="8198188">=</span>&nbsp;<span class="string" id="8198190">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="8198687">func</span>&nbsp;<span class="ident" id="8198692">bigFromString</span><span class="op" id="8198705">(</span><span class="ident" id="8198706">s</span>&nbsp;<span class="builtintype" id="8198708">string</span><span class="op" id="8198714">)</span>&nbsp;<span class="op" id="8198716">*</span><span class="ident" id="8198717">big</span><span class="op" id="8198720">.</span><span class="ident" id="8198721">Int</span>&nbsp;<span class="op" id="8198725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198728">ret</span>&nbsp;<span class="op" id="8198732">:=</span>&nbsp;<span class="builtinfunc" id="8198735">new</span><span class="op" id="8198738">(</span><span class="ident" id="8198739">big</span><span class="op" id="8198742">.</span><span class="ident" id="8198743">Int</span><span class="op" id="8198746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198749">ret</span><span class="op" id="8198752">.</span><span class="ident" id="8198753">SetString</span><span class="op" id="8198762">(</span><span class="ident" id="8198763">s</span><span class="op" id="8198764">,</span>&nbsp;<span class="num" id="8198766">10</span><span class="op" id="8198768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198771">return</span>&nbsp;<span class="ident" id="8198778">ret</span><br>
<span class="lineno">95</span><span class="op" id="8198782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8198785">func</span>&nbsp;<span class="ident" id="8198790">fromBase10</span><span class="op" id="8198800">(</span><span class="ident" id="8198801">base10</span>&nbsp;<span class="builtintype" id="8198808">string</span><span class="op" id="8198814">)</span>&nbsp;<span class="op" id="8198816">*</span><span class="ident" id="8198817">big</span><span class="op" id="8198820">.</span><span class="ident" id="8198821">Int</span>&nbsp;<span class="op" id="8198825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198828">i</span>&nbsp;<span class="op" id="8198830">:=</span>&nbsp;<span class="builtinfunc" id="8198833">new</span><span class="op" id="8198836">(</span><span class="ident" id="8198837">big</span><span class="op" id="8198840">.</span><span class="ident" id="8198841">Int</span><span class="op" id="8198844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198847">i</span><span class="op" id="8198848">.</span><span class="ident" id="8198849">SetString</span><span class="op" id="8198858">(</span><span class="ident" id="8198859">base10</span><span class="op" id="8198865">,</span>&nbsp;<span class="num" id="8198867">10</span><span class="op" id="8198869">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198872">return</span>&nbsp;<span class="ident" id="8198879">i</span><br>
<span class="lineno"></span><span class="op" id="8198881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8198884">func</span>&nbsp;<span class="ident" id="8198889">bigFromHexString</span><span class="op" id="8198905">(</span><span class="ident" id="8198906">s</span>&nbsp;<span class="builtintype" id="8198908">string</span><span class="op" id="8198914">)</span>&nbsp;<span class="op" id="8198916">*</span><span class="ident" id="8198917">big</span><span class="op" id="8198920">.</span><span class="ident" id="8198921">Int</span>&nbsp;<span class="op" id="8198925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198928">ret</span>&nbsp;<span class="op" id="8198932">:=</span>&nbsp;<span class="builtinfunc" id="8198935">new</span><span class="op" id="8198938">(</span><span class="ident" id="8198939">big</span><span class="op" id="8198942">.</span><span class="ident" id="8198943">Int</span><span class="op" id="8198946">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8198949">ret</span><span class="op" id="8198952">.</span><span class="ident" id="8198953">SetString</span><span class="op" id="8198962">(</span><span class="ident" id="8198963">s</span><span class="op" id="8198964">,</span>&nbsp;<span class="num" id="8198966">16</span><span class="op" id="8198968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8198971">return</span>&nbsp;<span class="ident" id="8198978">ret</span><br>
<span class="lineno"></span><span class="op" id="8198982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8198985">var</span>&nbsp;<span class="ident" id="8198989">rsaPrivateKey</span>&nbsp;<span class="op" id="8199003">=</span>&nbsp;<span class="op" id="8199005">&amp;</span><span class="ident" id="8199006">rsa</span><span class="op" id="8199009">.</span><span class="ident" id="8199010">PrivateKey</span><span class="op" id="8199020">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199023">PublicKey</span><span class="op" id="8199032">:</span>&nbsp;<span class="ident" id="8199034">rsa</span><span class="op" id="8199037">.</span><span class="ident" id="8199038">PublicKey</span><span class="op" id="8199047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199051">N</span><span class="op" id="8199052">:</span>&nbsp;<span class="ident" id="8199054">bigFromString</span><span class="op" id="8199067">(</span><span class="string" id="8199068">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="8199224">)</span><span class="op" id="8199225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199229">E</span><span class="op" id="8199230">:</span>&nbsp;<span class="num" id="8199232">65537</span><span class="op" id="8199237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8199240">}</span><span class="op" id="8199241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199244">D</span><span class="op" id="8199245">:</span>&nbsp;<span class="ident" id="8199247">bigFromString</span><span class="op" id="8199260">(</span><span class="string" id="8199261">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="8199417">)</span><span class="op" id="8199418">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199421">Primes</span><span class="op" id="8199427">:</span>&nbsp;<span class="op" id="8199429">[</span><span class="op" id="8199430">]</span><span class="op" id="8199431">*</span><span class="ident" id="8199432">big</span><span class="op" id="8199435">.</span><span class="ident" id="8199436">Int</span><span class="op" id="8199439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199443">bigFromString</span><span class="op" id="8199456">(</span><span class="string" id="8199457">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="8199536">)</span><span class="op" id="8199537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199541">bigFromString</span><span class="op" id="8199554">(</span><span class="string" id="8199555">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="8199634">)</span><span class="op" id="8199635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8199638">}</span><span class="op" id="8199639">,</span><br>
<span class="lineno"></span><span class="op" id="8199641">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="8199644">func</span>&nbsp;<span class="ident" id="8199649">TestMarshalRSAPrivateKey</span><span class="op" id="8199673">(</span><span class="ident" id="8199674">t</span>&nbsp;<span class="op" id="8199676">*</span><span class="ident" id="8199677">testing</span><span class="op" id="8199684">.</span><span class="ident" id="8199685">T</span><span class="op" id="8199686">)</span>&nbsp;<span class="op" id="8199688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199691">priv</span>&nbsp;<span class="op" id="8199696">:=</span>&nbsp;<span class="op" id="8199699">&amp;</span><span class="ident" id="8199700">rsa</span><span class="op" id="8199703">.</span><span class="ident" id="8199704">PrivateKey</span><span class="op" id="8199714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199718">PublicKey</span><span class="op" id="8199727">:</span>&nbsp;<span class="ident" id="8199729">rsa</span><span class="op" id="8199732">.</span><span class="ident" id="8199733">PublicKey</span><span class="op" id="8199742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8199747">N</span><span class="op" id="8199748">:</span>&nbsp;<span class="ident" id="8199750">fromBase10</span><span class="op" id="8199760">(</span><span class="string" id="8199761">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="8200380">)</span><span class="op" id="8200381">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200386">E</span><span class="op" id="8200387">:</span>&nbsp;<span class="num" id="8200389">3</span><span class="op" id="8200390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8200394">}</span><span class="op" id="8200395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8200399">D</span><span class="op" id="8200400">:</span>&nbsp;<span class="ident" id="8200402">fromBase10</span><span class="op" id="8200412">(</span><span class="string" id="8200413">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="8201032">)</span><span class="op" id="8201033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8201037">Primes</span><span class="op" id="8201043">:</span>&nbsp;<span class="op" id="8201045">[</span><span class="op" id="8201046">]</span><span class="op" id="8201047">*</span><span class="ident" id="8201048">big</span><span class="op" id="8201051">.</span><span class="ident" id="8201052">Int</span><span class="op" id="8201055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8201060">fromBase10</span><span class="op" id="8201070">(</span><span class="string" id="8201071">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="8201281">)</span><span class="op" id="8201282">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8201287">fromBase10</span><span class="op" id="8201297">(</span><span class="string" id="8201298">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="8201505">)</span><span class="op" id="8201506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8201511">fromBase10</span><span class="op" id="8201521">(</span><span class="string" id="8201522">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="8201729">)</span><span class="op" id="8201730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8201734">}</span><span class="op" id="8201735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8201738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8201742">derBytes</span>&nbsp;<span class="op" id="8201751">:=</span>&nbsp;<span class="ident" id="8201754">MarshalPKCS1PrivateKey</span><span class="op" id="8201776">(</span><span class="ident" id="8201777">priv</span><span class="op" id="8201781">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8201785">priv2</span><span class="op" id="8201790">,</span>&nbsp;<span class="ident" id="8201792">err</span>&nbsp;<span class="op" id="8201796">:=</span>&nbsp;<span class="ident" id="8201799">ParsePKCS1PrivateKey</span><span class="op" id="8201819">(</span><span class="ident" id="8201820">derBytes</span><span class="op" id="8201828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8201831">if</span>&nbsp;<span class="ident" id="8201834">err</span>&nbsp;<span class="op" id="8201838">!=</span>&nbsp;<span class="builtintype" id="8201841">nil</span>&nbsp;<span class="op" id="8201845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8201849">t</span><span class="op" id="8201850">.</span><span class="ident" id="8201851">Errorf</span><span class="op" id="8201857">(</span><span class="string" id="8201858">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8201892">,</span>&nbsp;<span class="ident" id="8201894">err</span><span class="op" id="8201897">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8201901">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8201909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8201912">if</span>&nbsp;<span class="ident" id="8201915">priv</span><span class="op" id="8201919">.</span><span class="ident" id="8201920">PublicKey</span><span class="op" id="8201929">.</span><span class="ident" id="8201930">N</span><span class="op" id="8201931">.</span><span class="ident" id="8201932">Cmp</span><span class="op" id="8201935">(</span><span class="ident" id="8201936">priv2</span><span class="op" id="8201941">.</span><span class="ident" id="8201942">PublicKey</span><span class="op" id="8201951">.</span><span class="ident" id="8201952">N</span><span class="op" id="8201953">)</span>&nbsp;<span class="op" id="8201955">!=</span>&nbsp;<span class="num" id="8201958">0</span>&nbsp;<span class="op" id="8201960">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8201965">priv</span><span class="op" id="8201969">.</span><span class="ident" id="8201970">PublicKey</span><span class="op" id="8201979">.</span><span class="ident" id="8201980">E</span>&nbsp;<span class="op" id="8201982">!=</span>&nbsp;<span class="ident" id="8201985">priv2</span><span class="op" id="8201990">.</span><span class="ident" id="8201991">PublicKey</span><span class="op" id="8202000">.</span><span class="ident" id="8202001">E</span>&nbsp;<span class="op" id="8202003">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8202008">priv</span><span class="op" id="8202012">.</span><span class="ident" id="8202013">D</span><span class="op" id="8202014">.</span><span class="ident" id="8202015">Cmp</span><span class="op" id="8202018">(</span><span class="ident" id="8202019">priv2</span><span class="op" id="8202024">.</span><span class="ident" id="8202025">D</span><span class="op" id="8202026">)</span>&nbsp;<span class="op" id="8202028">!=</span>&nbsp;<span class="num" id="8202031">0</span>&nbsp;<span class="op" id="8202033">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8202038">len</span><span class="op" id="8202041">(</span><span class="ident" id="8202042">priv2</span><span class="op" id="8202047">.</span><span class="ident" id="8202048">Primes</span><span class="op" id="8202054">)</span>&nbsp;<span class="op" id="8202056">!=</span>&nbsp;<span class="num" id="8202059">3</span>&nbsp;<span class="op" id="8202061">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8202066">priv</span><span class="op" id="8202070">.</span><span class="ident" id="8202071">Primes</span><span class="op" id="8202077">[</span><span class="num" id="8202078">0</span><span class="op" id="8202079">]</span><span class="op" id="8202080">.</span><span class="ident" id="8202081">Cmp</span><span class="op" id="8202084">(</span><span class="ident" id="8202085">priv2</span><span class="op" id="8202090">.</span><span class="ident" id="8202091">Primes</span><span class="op" id="8202097">[</span><span class="num" id="8202098">0</span><span class="op" id="8202099">]</span><span class="op" id="8202100">)</span>&nbsp;<span class="op" id="8202102">!=</span>&nbsp;<span class="num" id="8202105">0</span>&nbsp;<span class="op" id="8202107">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8202112">priv</span><span class="op" id="8202116">.</span><span class="ident" id="8202117">Primes</span><span class="op" id="8202123">[</span><span class="num" id="8202124">1</span><span class="op" id="8202125">]</span><span class="op" id="8202126">.</span><span class="ident" id="8202127">Cmp</span><span class="op" id="8202130">(</span><span class="ident" id="8202131">priv2</span><span class="op" id="8202136">.</span><span class="ident" id="8202137">Primes</span><span class="op" id="8202143">[</span><span class="num" id="8202144">1</span><span class="op" id="8202145">]</span><span class="op" id="8202146">)</span>&nbsp;<span class="op" id="8202148">!=</span>&nbsp;<span class="num" id="8202151">0</span>&nbsp;<span class="op" id="8202153">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8202158">priv</span><span class="op" id="8202162">.</span><span class="ident" id="8202163">Primes</span><span class="op" id="8202169">[</span><span class="num" id="8202170">2</span><span class="op" id="8202171">]</span><span class="op" id="8202172">.</span><span class="ident" id="8202173">Cmp</span><span class="op" id="8202176">(</span><span class="ident" id="8202177">priv2</span><span class="op" id="8202182">.</span><span class="ident" id="8202183">Primes</span><span class="op" id="8202189">[</span><span class="num" id="8202190">2</span><span class="op" id="8202191">]</span><span class="op" id="8202192">)</span>&nbsp;<span class="op" id="8202194">!=</span>&nbsp;<span class="num" id="8202197">0</span>&nbsp;<span class="op" id="8202199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8202203">t</span><span class="op" id="8202204">.</span><span class="ident" id="8202205">Errorf</span><span class="op" id="8202211">(</span><span class="string" id="8202212">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="8202230">,</span>&nbsp;<span class="ident" id="8202232">priv</span><span class="op" id="8202236">,</span>&nbsp;<span class="ident" id="8202238">priv2</span><span class="op" id="8202243">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8202246">}</span><br>
<span class="lineno"></span><span class="op" id="8202248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8202251">type</span>&nbsp;<span class="ident" id="8202256">matchHostnamesTest</span>&nbsp;<span class="keyword" id="8202275">struct</span>&nbsp;<span class="op" id="8202282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8202285">pattern</span><span class="op" id="8202292">,</span>&nbsp;<span class="ident" id="8202294">host</span>&nbsp;<span class="builtintype" id="8202299">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8202307">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8202321">bool</span><br>
<span class="lineno"></span><span class="op" id="8202326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8202329">var</span>&nbsp;<span class="ident" id="8202333">matchHostnamesTests</span>&nbsp;<span class="op" id="8202353">=</span>&nbsp;<span class="op" id="8202355">[</span><span class="op" id="8202356">]</span><span class="ident" id="8202357">matchHostnamesTest</span><span class="op" id="8202375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8202378">{</span><span class="string" id="8202379">&#34;a.b.c&#34;</span><span class="op" id="8202386">,</span>&nbsp;<span class="string" id="8202388">&#34;a.b.c&#34;</span><span class="op" id="8202395">,</span>&nbsp;<span class="builtintype" id="8202397">true</span><span class="op" id="8202401">}</span><span class="op" id="8202402">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8202405">{</span><span class="string" id="8202406">&#34;a.b.c&#34;</span><span class="op" id="8202413">,</span>&nbsp;<span class="string" id="8202415">&#34;b.b.c&#34;</span><span class="op" id="8202422">,</span>&nbsp;<span class="builtintype" id="8202424">false</span><span class="op" id="8202429">}</span><span class="op" id="8202430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8202433">{</span><span class="string" id="8202434">&#34;&#34;</span><span class="op" id="8202436">,</span>&nbsp;<span class="string" id="8202438">&#34;b.b.c&#34;</span><span class="op" id="8202445">,</span>&nbsp;<span class="builtintype" id="8202447">false</span><span class="op" id="8202452">}</span><span class="op" id="8202453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8202456">{</span><span class="string" id="8202457">&#34;a.b.c&#34;</span><span class="op" id="8202464">,</span>&nbsp;<span class="string" id="8202466">&#34;&#34;</span><span class="op" id="8202468">,</span>&nbsp;<span class="builtintype" id="8202470">false</span><span class="op" id="8202475">}</span><span class="op" id="8202476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8202479">{</span><span class="string" id="8202480">&#34;example.com&#34;</span><span class="op" id="8202493">,</span>&nbsp;<span class="string" id="8202495">&#34;example.com&#34;</span><span class="op" id="8202508">,</span>&nbsp;<span class="builtintype" id="8202510">true</span><span class="op" id="8202514">}</span><span class="op" id="8202515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8202518">{</span><span class="string" id="8202519">&#34;example.com&#34;</span><span class="op" id="8202532">,</span>&nbsp;<span class="string" id="8202534">&#34;www.example.com&#34;</span><span class="op" id="8202551">,</span>&nbsp;<span class="builtintype" id="8202553">false</span><span class="op" id="8202558">}</span><span class="op" id="8202559">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8202562">{</span><span class="string" id="8202563">&#34;*.example.com&#34;</span><span class="op" id="8202578">,</span>&nbsp;<span class="string" id="8202580">&#34;www.example.com&#34;</span><span class="op" id="8202597">,</span>&nbsp;<span class="builtintype" id="8202599">true</span><span class="op" id="8202603">}</span><span class="op" id="8202604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8202607">{</span><span class="string" id="8202608">&#34;*.example.com&#34;</span><span class="op" id="8202623">,</span>&nbsp;<span class="string" id="8202625">&#34;xyz.www.example.com&#34;</span><span class="op" id="8202646">,</span>&nbsp;<span class="builtintype" id="8202648">false</span><span class="op" id="8202653">}</span><span class="op" id="8202654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8202657">{</span><span class="string" id="8202658">&#34;*.*.example.com&#34;</span><span class="op" id="8202675">,</span>&nbsp;<span class="string" id="8202677">&#34;xyz.www.example.com&#34;</span><span class="op" id="8202698">,</span>&nbsp;<span class="builtintype" id="8202700">true</span><span class="op" id="8202704">}</span><span class="op" id="8202705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8202708">{</span><span class="string" id="8202709">&#34;*.www.*.com&#34;</span><span class="op" id="8202722">,</span>&nbsp;<span class="string" id="8202724">&#34;xyz.www.example.com&#34;</span><span class="op" id="8202745">,</span>&nbsp;<span class="builtintype" id="8202747">true</span><span class="op" id="8202751">}</span><span class="op" id="8202752">,</span><br>
<span class="lineno"></span><span class="op" id="8202754">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8202757">func</span>&nbsp;<span class="ident" id="8202762">TestMatchHostnames</span><span class="op" id="8202780">(</span><span class="ident" id="8202781">t</span>&nbsp;<span class="op" id="8202783">*</span><span class="ident" id="8202784">testing</span><span class="op" id="8202791">.</span><span class="ident" id="8202792">T</span><span class="op" id="8202793">)</span>&nbsp;<span class="op" id="8202795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8202798">for</span>&nbsp;<span class="ident" id="8202802">i</span><span class="op" id="8202803">,</span>&nbsp;<span class="ident" id="8202805">test</span>&nbsp;<span class="op" id="8202810">:=</span>&nbsp;<span class="keyword" id="8202813">range</span>&nbsp;<span class="ident" id="8202819">matchHostnamesTests</span>&nbsp;<span class="op" id="8202839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8202843">r</span>&nbsp;<span class="op" id="8202845">:=</span>&nbsp;<span class="ident" id="8202848">matchHostnames</span><span class="op" id="8202862">(</span><span class="ident" id="8202863">test</span><span class="op" id="8202867">.</span><span class="ident" id="8202868">pattern</span><span class="op" id="8202875">,</span>&nbsp;<span class="ident" id="8202877">test</span><span class="op" id="8202881">.</span><span class="ident" id="8202882">host</span><span class="op" id="8202886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8202890">if</span>&nbsp;<span class="ident" id="8202893">r</span>&nbsp;<span class="op" id="8202895">!=</span>&nbsp;<span class="ident" id="8202898">test</span><span class="op" id="8202902">.</span><span class="ident" id="8202903">ok</span>&nbsp;<span class="op" id="8202906">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8202911">t</span><span class="op" id="8202912">.</span><span class="ident" id="8202913">Errorf</span><span class="op" id="8202919">(</span><span class="string" id="8202920">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="8202951">,</span>&nbsp;<span class="ident" id="8202953">i</span><span class="op" id="8202954">,</span>&nbsp;<span class="ident" id="8202956">r</span><span class="op" id="8202957">,</span>&nbsp;<span class="ident" id="8202959">test</span><span class="op" id="8202963">.</span><span class="ident" id="8202964">ok</span><span class="op" id="8202966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8202970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8202973">}</span><br>
<span class="lineno"></span><span class="op" id="8202975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="8202978">func</span>&nbsp;<span class="ident" id="8202983">TestMatchIP</span><span class="op" id="8202994">(</span><span class="ident" id="8202995">t</span>&nbsp;<span class="op" id="8202997">*</span><span class="ident" id="8202998">testing</span><span class="op" id="8203005">.</span><span class="ident" id="8203006">T</span><span class="op" id="8203007">)</span>&nbsp;<span class="op" id="8203009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8203012">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203056">c</span>&nbsp;<span class="op" id="8203058">:=</span>&nbsp;<span class="op" id="8203061">&amp;</span><span class="ident" id="8203062">Certificate</span><span class="op" id="8203073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203077">DNSNames</span><span class="op" id="8203085">:</span>&nbsp;<span class="op" id="8203087">[</span><span class="op" id="8203088">]</span><span class="builtintype" id="8203089">string</span><span class="op" id="8203095">{</span><span class="string" id="8203096">&#34;*.foo.bar.baz&#34;</span><span class="op" id="8203111">}</span><span class="op" id="8203112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203116">Subject</span><span class="op" id="8203123">:</span>&nbsp;<span class="ident" id="8203125">pkix</span><span class="op" id="8203129">.</span><span class="ident" id="8203130">Name</span><span class="op" id="8203134">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203139">CommonName</span><span class="op" id="8203149">:</span>&nbsp;<span class="string" id="8203151">&#34;*.foo.bar.baz&#34;</span><span class="op" id="8203166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8203170">}</span><span class="op" id="8203171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8203174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203177">err</span>&nbsp;<span class="op" id="8203181">:=</span>&nbsp;<span class="ident" id="8203184">c</span><span class="op" id="8203185">.</span><span class="ident" id="8203186">VerifyHostname</span><span class="op" id="8203200">(</span><span class="string" id="8203201">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="8203219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8203222">if</span>&nbsp;<span class="ident" id="8203225">err</span>&nbsp;<span class="op" id="8203229">!=</span>&nbsp;<span class="builtintype" id="8203232">nil</span>&nbsp;<span class="op" id="8203236">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203240">t</span><span class="op" id="8203241">.</span><span class="ident" id="8203242">Fatalf</span><span class="op" id="8203248">(</span><span class="string" id="8203249">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="8203287">,</span>&nbsp;<span class="ident" id="8203289">err</span><span class="op" id="8203292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8203295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8203299">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8203372">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203392">c</span>&nbsp;<span class="op" id="8203394">=</span>&nbsp;<span class="op" id="8203396">&amp;</span><span class="ident" id="8203397">Certificate</span><span class="op" id="8203408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203412">DNSNames</span><span class="op" id="8203420">:</span>&nbsp;<span class="op" id="8203422">[</span><span class="op" id="8203423">]</span><span class="builtintype" id="8203424">string</span><span class="op" id="8203430">{</span><span class="string" id="8203431">&#34;*.2.3.4&#34;</span><span class="op" id="8203440">}</span><span class="op" id="8203441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203445">Subject</span><span class="op" id="8203452">:</span>&nbsp;<span class="ident" id="8203454">pkix</span><span class="op" id="8203458">.</span><span class="ident" id="8203459">Name</span><span class="op" id="8203463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203468">CommonName</span><span class="op" id="8203478">:</span>&nbsp;<span class="string" id="8203480">&#34;*.2.3.4&#34;</span><span class="op" id="8203489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8203493">}</span><span class="op" id="8203494">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8203497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203500">err</span>&nbsp;<span class="op" id="8203504">=</span>&nbsp;<span class="ident" id="8203506">c</span><span class="op" id="8203507">.</span><span class="ident" id="8203508">VerifyHostname</span><span class="op" id="8203522">(</span><span class="string" id="8203523">&#34;1.2.3.4&#34;</span><span class="op" id="8203532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8203535">if</span>&nbsp;<span class="ident" id="8203538">err</span>&nbsp;<span class="op" id="8203542">==</span>&nbsp;<span class="builtintype" id="8203545">nil</span>&nbsp;<span class="op" id="8203549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203553">t</span><span class="op" id="8203554">.</span><span class="ident" id="8203555">Fatalf</span><span class="op" id="8203561">(</span><span class="string" id="8203562">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="8203615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8203618">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203622">c</span>&nbsp;<span class="op" id="8203624">=</span>&nbsp;<span class="op" id="8203626">&amp;</span><span class="ident" id="8203627">Certificate</span><span class="op" id="8203638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203642">IPAddresses</span><span class="op" id="8203653">:</span>&nbsp;<span class="op" id="8203655">[</span><span class="op" id="8203656">]</span><span class="ident" id="8203657">net</span><span class="op" id="8203660">.</span><span class="ident" id="8203661">IP</span><span class="op" id="8203663">{</span><span class="ident" id="8203664">net</span><span class="op" id="8203667">.</span><span class="ident" id="8203668">ParseIP</span><span class="op" id="8203675">(</span><span class="string" id="8203676">&#34;127.0.0.1&#34;</span><span class="op" id="8203687">)</span><span class="op" id="8203688">,</span>&nbsp;<span class="ident" id="8203690">net</span><span class="op" id="8203693">.</span><span class="ident" id="8203694">ParseIP</span><span class="op" id="8203701">(</span><span class="string" id="8203702">&#34;::1&#34;</span><span class="op" id="8203707">)</span><span class="op" id="8203708">}</span><span class="op" id="8203709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8203712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203715">err</span>&nbsp;<span class="op" id="8203719">=</span>&nbsp;<span class="ident" id="8203721">c</span><span class="op" id="8203722">.</span><span class="ident" id="8203723">VerifyHostname</span><span class="op" id="8203737">(</span><span class="string" id="8203738">&#34;127.0.0.1&#34;</span><span class="op" id="8203749">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8203752">if</span>&nbsp;<span class="ident" id="8203755">err</span>&nbsp;<span class="op" id="8203759">!=</span>&nbsp;<span class="builtintype" id="8203762">nil</span>&nbsp;<span class="op" id="8203766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203770">t</span><span class="op" id="8203771">.</span><span class="ident" id="8203772">Fatalf</span><span class="op" id="8203778">(</span><span class="string" id="8203779">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="8203810">,</span>&nbsp;<span class="ident" id="8203812">err</span><span class="op" id="8203815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8203818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203821">err</span>&nbsp;<span class="op" id="8203825">=</span>&nbsp;<span class="ident" id="8203827">c</span><span class="op" id="8203828">.</span><span class="ident" id="8203829">VerifyHostname</span><span class="op" id="8203843">(</span><span class="string" id="8203844">&#34;::1&#34;</span><span class="op" id="8203849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8203852">if</span>&nbsp;<span class="ident" id="8203855">err</span>&nbsp;<span class="op" id="8203859">!=</span>&nbsp;<span class="builtintype" id="8203862">nil</span>&nbsp;<span class="op" id="8203866">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203870">t</span><span class="op" id="8203871">.</span><span class="ident" id="8203872">Fatalf</span><span class="op" id="8203878">(</span><span class="string" id="8203879">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="8203904">,</span>&nbsp;<span class="ident" id="8203906">err</span><span class="op" id="8203909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8203912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203915">err</span>&nbsp;<span class="op" id="8203919">=</span>&nbsp;<span class="ident" id="8203921">c</span><span class="op" id="8203922">.</span><span class="ident" id="8203923">VerifyHostname</span><span class="op" id="8203937">(</span><span class="string" id="8203938">&#34;[::1]&#34;</span><span class="op" id="8203945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8203948">if</span>&nbsp;<span class="ident" id="8203951">err</span>&nbsp;<span class="op" id="8203955">!=</span>&nbsp;<span class="builtintype" id="8203958">nil</span>&nbsp;<span class="op" id="8203962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8203966">t</span><span class="op" id="8203967">.</span><span class="ident" id="8203968">Fatalf</span><span class="op" id="8203974">(</span><span class="string" id="8203975">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="8204002">,</span>&nbsp;<span class="ident" id="8204004">err</span><span class="op" id="8204007">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8204010">}</span><br>
<span class="lineno"></span><span class="op" id="8204012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8204015">func</span>&nbsp;<span class="ident" id="8204020">TestCertificateParse</span><span class="op" id="8204040">(</span><span class="ident" id="8204041">t</span>&nbsp;<span class="op" id="8204043">*</span><span class="ident" id="8204044">testing</span><span class="op" id="8204051">.</span><span class="ident" id="8204052">T</span><span class="op" id="8204053">)</span>&nbsp;<span class="op" id="8204055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8204058">s</span><span class="op" id="8204059">,</span>&nbsp;<span class="ident" id="8204061">_</span>&nbsp;<span class="op" id="8204063">:=</span>&nbsp;<span class="ident" id="8204066">hex</span><span class="op" id="8204069">.</span><span class="ident" id="8204070">DecodeString</span><span class="op" id="8204082">(</span><span class="ident" id="8204083">certBytes</span><span class="op" id="8204092">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8204095">certs</span><span class="op" id="8204100">,</span>&nbsp;<span class="ident" id="8204102">err</span>&nbsp;<span class="op" id="8204106">:=</span>&nbsp;<span class="ident" id="8204109">ParseCertificates</span><span class="op" id="8204126">(</span><span class="ident" id="8204127">s</span><span class="op" id="8204128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8204131">if</span>&nbsp;<span class="ident" id="8204134">err</span>&nbsp;<span class="op" id="8204138">!=</span>&nbsp;<span class="builtintype" id="8204141">nil</span>&nbsp;<span class="op" id="8204145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8204149">t</span><span class="op" id="8204150">.</span><span class="ident" id="8204151">Error</span><span class="op" id="8204156">(</span><span class="ident" id="8204157">err</span><span class="op" id="8204160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8204163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8204166">if</span>&nbsp;<span class="builtinfunc" id="8204169">len</span><span class="op" id="8204172">(</span><span class="ident" id="8204173">certs</span><span class="op" id="8204178">)</span>&nbsp;<span class="op" id="8204180">!=</span>&nbsp;<span class="num" id="8204183">2</span>&nbsp;<span class="op" id="8204185">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8204189">t</span><span class="op" id="8204190">.</span><span class="ident" id="8204191">Errorf</span><span class="op" id="8204197">(</span><span class="string" id="8204198">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="8204236">,</span>&nbsp;<span class="builtinfunc" id="8204238">len</span><span class="op" id="8204241">(</span><span class="ident" id="8204242">certs</span><span class="op" id="8204247">)</span><span class="op" id="8204248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8204252">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8204260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8204264">err</span>&nbsp;<span class="op" id="8204268">=</span>&nbsp;<span class="ident" id="8204270">certs</span><span class="op" id="8204275">[</span><span class="num" id="8204276">0</span><span class="op" id="8204277">]</span><span class="op" id="8204278">.</span><span class="ident" id="8204279">CheckSignatureFrom</span><span class="op" id="8204297">(</span><span class="ident" id="8204298">certs</span><span class="op" id="8204303">[</span><span class="num" id="8204304">1</span><span class="op" id="8204305">]</span><span class="op" id="8204306">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8204309">if</span>&nbsp;<span class="ident" id="8204312">err</span>&nbsp;<span class="op" id="8204316">!=</span>&nbsp;<span class="builtintype" id="8204319">nil</span>&nbsp;<span class="op" id="8204323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8204327">t</span><span class="op" id="8204328">.</span><span class="ident" id="8204329">Error</span><span class="op" id="8204334">(</span><span class="ident" id="8204335">err</span><span class="op" id="8204338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8204341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8204345">if</span>&nbsp;<span class="ident" id="8204348">err</span>&nbsp;<span class="op" id="8204352">:=</span>&nbsp;<span class="ident" id="8204355">certs</span><span class="op" id="8204360">[</span><span class="num" id="8204361">0</span><span class="op" id="8204362">]</span><span class="op" id="8204363">.</span><span class="ident" id="8204364">VerifyHostname</span><span class="op" id="8204378">(</span><span class="string" id="8204379">&#34;mail.google.com&#34;</span><span class="op" id="8204396">)</span><span class="op" id="8204397">;</span>&nbsp;<span class="ident" id="8204399">err</span>&nbsp;<span class="op" id="8204403">!=</span>&nbsp;<span class="builtintype" id="8204406">nil</span>&nbsp;<span class="op" id="8204410">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8204414">t</span><span class="op" id="8204415">.</span><span class="ident" id="8204416">Error</span><span class="op" id="8204421">(</span><span class="ident" id="8204422">err</span><span class="op" id="8204425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8204428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8204432">const</span>&nbsp;<span class="ident" id="8204438">expectedExtensions</span>&nbsp;<span class="op" id="8204457">=</span>&nbsp;<span class="num" id="8204459">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8204462">if</span>&nbsp;<span class="ident" id="8204465">n</span>&nbsp;<span class="op" id="8204467">:=</span>&nbsp;<span class="builtinfunc" id="8204470">len</span><span class="op" id="8204473">(</span><span class="ident" id="8204474">certs</span><span class="op" id="8204479">[</span><span class="num" id="8204480">0</span><span class="op" id="8204481">]</span><span class="op" id="8204482">.</span><span class="ident" id="8204483">Extensions</span><span class="op" id="8204493">)</span><span class="op" id="8204494">;</span>&nbsp;<span class="ident" id="8204496">n</span>&nbsp;<span class="op" id="8204498">!=</span>&nbsp;<span class="ident" id="8204501">expectedExtensions</span>&nbsp;<span class="op" id="8204520">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8204524">t</span><span class="op" id="8204525">.</span><span class="ident" id="8204526">Errorf</span><span class="op" id="8204532">(</span><span class="string" id="8204533">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8204561">,</span>&nbsp;<span class="ident" id="8204563">expectedExtensions</span><span class="op" id="8204581">,</span>&nbsp;<span class="ident" id="8204583">n</span><span class="op" id="8204584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8204587">}</span><br>
<span class="lineno"></span><span class="op" id="8204589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8204592">var</span>&nbsp;<span class="ident" id="8204596">certBytes</span>&nbsp;<span class="op" id="8204606">=</span>&nbsp;<span class="string" id="8204608">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="8204689">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8204692">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="8204773">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8204776">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="8204857">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8204860">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="8204941">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8204944">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="8205025">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8205028">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="8205109">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8205112">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="8205193">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8205196">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="8205277">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8205280">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="8205361">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8205364">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="8205445">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8205448">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="8205529">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8205532">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="8205613">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8205616">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="8205697">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8205700">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="8205781">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8205784">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="8205865">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8205868">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="8205949">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8205952">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="8206033">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8206036">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="8206117">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8206120">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="8206201">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8206204">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="8206285">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8206288">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="8206369">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8206372">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="8206453">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8206456">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="8206537">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8206540">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="8206621">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8206624">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="8206705">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8206708">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="8206789">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8206792">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="8206873">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8206876">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="8206957">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8206960">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="8207041">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8207044">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="8207125">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8207128">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="8207209">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8207212">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="8207293">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8207296">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="8207377">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8207380">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="8207461">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8207464">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="8207545">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8207548">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="8207629">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8207632">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="8207713">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8207716">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="8207797">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8207800">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="8207881">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8207884">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="8207965">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8207968">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="8208049">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8208052">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8208084">func</span>&nbsp;<span class="ident" id="8208089">TestCreateSelfSignedCertificate</span><span class="op" id="8208120">(</span><span class="ident" id="8208121">t</span>&nbsp;<span class="op" id="8208123">*</span><span class="ident" id="8208124">testing</span><span class="op" id="8208131">.</span><span class="ident" id="8208132">T</span><span class="op" id="8208133">)</span>&nbsp;<span class="op" id="8208135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8208138">random</span>&nbsp;<span class="op" id="8208145">:=</span>&nbsp;<span class="ident" id="8208148">rand</span><span class="op" id="8208152">.</span><span class="ident" id="8208153">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8208162">block</span><span class="op" id="8208167">,</span>&nbsp;<span class="ident" id="8208169">_</span>&nbsp;<span class="op" id="8208171">:=</span>&nbsp;<span class="ident" id="8208174">pem</span><span class="op" id="8208177">.</span><span class="ident" id="8208178">Decode</span><span class="op" id="8208184">(</span><span class="op" id="8208185">[</span><span class="op" id="8208186">]</span><span class="builtintype" id="8208187">byte</span><span class="op" id="8208191">(</span><span class="ident" id="8208192">pemPrivateKey</span><span class="op" id="8208205">)</span><span class="op" id="8208206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8208209">rsaPriv</span><span class="op" id="8208216">,</span>&nbsp;<span class="ident" id="8208218">err</span>&nbsp;<span class="op" id="8208222">:=</span>&nbsp;<span class="ident" id="8208225">ParsePKCS1PrivateKey</span><span class="op" id="8208245">(</span><span class="ident" id="8208246">block</span><span class="op" id="8208251">.</span><span class="ident" id="8208252">Bytes</span><span class="op" id="8208257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8208260">if</span>&nbsp;<span class="ident" id="8208263">err</span>&nbsp;<span class="op" id="8208267">!=</span>&nbsp;<span class="builtintype" id="8208270">nil</span>&nbsp;<span class="op" id="8208274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8208278">t</span><span class="op" id="8208279">.</span><span class="ident" id="8208280">Fatalf</span><span class="op" id="8208286">(</span><span class="string" id="8208287">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8208320">,</span>&nbsp;<span class="ident" id="8208322">err</span><span class="op" id="8208325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8208328">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8208332">ecdsaPriv</span><span class="op" id="8208341">,</span>&nbsp;<span class="ident" id="8208343">err</span>&nbsp;<span class="op" id="8208347">:=</span>&nbsp;<span class="ident" id="8208350">ecdsa</span><span class="op" id="8208355">.</span><span class="ident" id="8208356">GenerateKey</span><span class="op" id="8208367">(</span><span class="ident" id="8208368">elliptic</span><span class="op" id="8208376">.</span><span class="ident" id="8208377">P256</span><span class="op" id="8208381">(</span><span class="op" id="8208382">)</span><span class="op" id="8208383">,</span>&nbsp;<span class="ident" id="8208385">rand</span><span class="op" id="8208389">.</span><span class="ident" id="8208390">Reader</span><span class="op" id="8208396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8208399">if</span>&nbsp;<span class="ident" id="8208402">err</span>&nbsp;<span class="op" id="8208406">!=</span>&nbsp;<span class="builtintype" id="8208409">nil</span>&nbsp;<span class="op" id="8208413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8208417">t</span><span class="op" id="8208418">.</span><span class="ident" id="8208419">Fatalf</span><span class="op" id="8208425">(</span><span class="string" id="8208426">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8208460">,</span>&nbsp;<span class="ident" id="8208462">err</span><span class="op" id="8208465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8208468">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8208472">tests</span>&nbsp;<span class="op" id="8208478">:=</span>&nbsp;<span class="op" id="8208481">[</span><span class="op" id="8208482">]</span><span class="keyword" id="8208483">struct</span>&nbsp;<span class="op" id="8208490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8208494">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8208504">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8208513">pub</span><span class="op" id="8208516">,</span>&nbsp;<span class="ident" id="8208518">priv</span>&nbsp;<span class="keyword" id="8208523">interface</span><span class="op" id="8208532">{</span><span class="op" id="8208533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8208537">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="8208547">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8208554">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8208564">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8208584">}</span><span class="op" id="8208585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8208589">{</span><span class="string" id="8208590">&#34;RSA/RSA&#34;</span><span class="op" id="8208599">,</span>&nbsp;<span class="op" id="8208601">&amp;</span><span class="ident" id="8208602">rsaPriv</span><span class="op" id="8208609">.</span><span class="ident" id="8208610">PublicKey</span><span class="op" id="8208619">,</span>&nbsp;<span class="ident" id="8208621">rsaPriv</span><span class="op" id="8208628">,</span>&nbsp;<span class="builtintype" id="8208630">true</span><span class="op" id="8208634">,</span>&nbsp;<span class="ident" id="8208636">SHA1WithRSA</span><span class="op" id="8208647">}</span><span class="op" id="8208648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8208652">{</span><span class="string" id="8208653">&#34;RSA/ECDSA&#34;</span><span class="op" id="8208664">,</span>&nbsp;<span class="op" id="8208666">&amp;</span><span class="ident" id="8208667">rsaPriv</span><span class="op" id="8208674">.</span><span class="ident" id="8208675">PublicKey</span><span class="op" id="8208684">,</span>&nbsp;<span class="ident" id="8208686">ecdsaPriv</span><span class="op" id="8208695">,</span>&nbsp;<span class="builtintype" id="8208697">false</span><span class="op" id="8208702">,</span>&nbsp;<span class="ident" id="8208704">ECDSAWithSHA384</span><span class="op" id="8208719">}</span><span class="op" id="8208720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8208724">{</span><span class="string" id="8208725">&#34;ECDSA/RSA&#34;</span><span class="op" id="8208736">,</span>&nbsp;<span class="op" id="8208738">&amp;</span><span class="ident" id="8208739">ecdsaPriv</span><span class="op" id="8208748">.</span><span class="ident" id="8208749">PublicKey</span><span class="op" id="8208758">,</span>&nbsp;<span class="ident" id="8208760">rsaPriv</span><span class="op" id="8208767">,</span>&nbsp;<span class="builtintype" id="8208769">false</span><span class="op" id="8208774">,</span>&nbsp;<span class="ident" id="8208776">SHA256WithRSA</span><span class="op" id="8208789">}</span><span class="op" id="8208790">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8208794">{</span><span class="string" id="8208795">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="8208808">,</span>&nbsp;<span class="op" id="8208810">&amp;</span><span class="ident" id="8208811">ecdsaPriv</span><span class="op" id="8208820">.</span><span class="ident" id="8208821">PublicKey</span><span class="op" id="8208830">,</span>&nbsp;<span class="ident" id="8208832">ecdsaPriv</span><span class="op" id="8208841">,</span>&nbsp;<span class="builtintype" id="8208843">true</span><span class="op" id="8208847">,</span>&nbsp;<span class="ident" id="8208849">ECDSAWithSHA1</span><span class="op" id="8208862">}</span><span class="op" id="8208863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8208866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8208870">testExtKeyUsage</span>&nbsp;<span class="op" id="8208886">:=</span>&nbsp;<span class="op" id="8208889">[</span><span class="op" id="8208890">]</span><span class="ident" id="8208891">ExtKeyUsage</span><span class="op" id="8208902">{</span><span class="ident" id="8208903">ExtKeyUsageClientAuth</span><span class="op" id="8208924">,</span>&nbsp;<span class="ident" id="8208926">ExtKeyUsageServerAuth</span><span class="op" id="8208947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8208950">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="8208973">:=</span>&nbsp;<span class="op" id="8208976">[</span><span class="op" id="8208977">]</span><span class="ident" id="8208978">asn1</span><span class="op" id="8208982">.</span><span class="ident" id="8208983">ObjectIdentifier</span><span class="op" id="8208999">{</span><span class="op" id="8209000">[</span><span class="op" id="8209001">]</span><span class="builtintype" id="8209002">int</span><span class="op" id="8209005">{</span><span class="num" id="8209006">1</span><span class="op" id="8209007">,</span>&nbsp;<span class="num" id="8209009">2</span><span class="op" id="8209010">,</span>&nbsp;<span class="num" id="8209012">3</span><span class="op" id="8209013">}</span><span class="op" id="8209014">,</span>&nbsp;<span class="op" id="8209016">[</span><span class="op" id="8209017">]</span><span class="builtintype" id="8209018">int</span><span class="op" id="8209021">{</span><span class="num" id="8209022">2</span><span class="op" id="8209023">,</span>&nbsp;<span class="num" id="8209025">59</span><span class="op" id="8209027">,</span>&nbsp;<span class="num" id="8209029">1</span><span class="op" id="8209030">}</span><span class="op" id="8209031">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209034">extraExtensionData</span>&nbsp;<span class="op" id="8209053">:=</span>&nbsp;<span class="op" id="8209056">[</span><span class="op" id="8209057">]</span><span class="builtintype" id="8209058">byte</span><span class="op" id="8209062">(</span><span class="string" id="8209063">&#34;extra&nbsp;extension&#34;</span><span class="op" id="8209080">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8209084">for</span>&nbsp;<span class="ident" id="8209088">_</span><span class="op" id="8209089">,</span>&nbsp;<span class="ident" id="8209091">test</span>&nbsp;<span class="op" id="8209096">:=</span>&nbsp;<span class="keyword" id="8209099">range</span>&nbsp;<span class="ident" id="8209105">tests</span>&nbsp;<span class="op" id="8209111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209115">commonName</span>&nbsp;<span class="op" id="8209126">:=</span>&nbsp;<span class="string" id="8209129">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209150">template</span>&nbsp;<span class="op" id="8209159">:=</span>&nbsp;<span class="ident" id="8209162">Certificate</span><span class="op" id="8209173">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209178">SerialNumber</span><span class="op" id="8209190">:</span>&nbsp;<span class="ident" id="8209192">big</span><span class="op" id="8209195">.</span><span class="ident" id="8209196">NewInt</span><span class="op" id="8209202">(</span><span class="num" id="8209203">1</span><span class="op" id="8209204">)</span><span class="op" id="8209205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209210">Subject</span><span class="op" id="8209217">:</span>&nbsp;<span class="ident" id="8209219">pkix</span><span class="op" id="8209223">.</span><span class="ident" id="8209224">Name</span><span class="op" id="8209228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209234">CommonName</span><span class="op" id="8209244">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8209248">commonName</span><span class="op" id="8209258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209264">Organization</span><span class="op" id="8209276">:</span>&nbsp;<span class="op" id="8209278">[</span><span class="op" id="8209279">]</span><span class="builtintype" id="8209280">string</span><span class="op" id="8209286">{</span><span class="string" id="8209287">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8209299">}</span><span class="op" id="8209300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8209305">}</span><span class="op" id="8209306">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209311">NotBefore</span><span class="op" id="8209320">:</span>&nbsp;<span class="ident" id="8209322">time</span><span class="op" id="8209326">.</span><span class="ident" id="8209327">Unix</span><span class="op" id="8209331">(</span><span class="num" id="8209332">1000</span><span class="op" id="8209336">,</span>&nbsp;<span class="num" id="8209338">0</span><span class="op" id="8209339">)</span><span class="op" id="8209340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209345">NotAfter</span><span class="op" id="8209353">:</span>&nbsp;&nbsp;<span class="ident" id="8209356">time</span><span class="op" id="8209360">.</span><span class="ident" id="8209361">Unix</span><span class="op" id="8209365">(</span><span class="num" id="8209366">100000</span><span class="op" id="8209372">,</span>&nbsp;<span class="num" id="8209374">0</span><span class="op" id="8209375">)</span><span class="op" id="8209376">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209382">SignatureAlgorithm</span><span class="op" id="8209400">:</span>&nbsp;<span class="ident" id="8209402">test</span><span class="op" id="8209406">.</span><span class="ident" id="8209407">sigAlgo</span><span class="op" id="8209414">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209420">SubjectKeyId</span><span class="op" id="8209432">:</span>&nbsp;<span class="op" id="8209434">[</span><span class="op" id="8209435">]</span><span class="builtintype" id="8209436">byte</span><span class="op" id="8209440">{</span><span class="num" id="8209441">1</span><span class="op" id="8209442">,</span>&nbsp;<span class="num" id="8209444">2</span><span class="op" id="8209445">,</span>&nbsp;<span class="num" id="8209447">3</span><span class="op" id="8209448">,</span>&nbsp;<span class="num" id="8209450">4</span><span class="op" id="8209451">}</span><span class="op" id="8209452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209457">KeyUsage</span><span class="op" id="8209465">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209471">KeyUsageCertSign</span><span class="op" id="8209487">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209493">ExtKeyUsage</span><span class="op" id="8209504">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209513">testExtKeyUsage</span><span class="op" id="8209528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209533">UnknownExtKeyUsage</span><span class="op" id="8209551">:</span>&nbsp;<span class="ident" id="8209553">testUnknownExtKeyUsage</span><span class="op" id="8209575">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209581">BasicConstraintsValid</span><span class="op" id="8209602">:</span>&nbsp;<span class="builtintype" id="8209604">true</span><span class="op" id="8209608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209613">IsCA</span><span class="op" id="8209617">:</span>&nbsp;<span class="builtintype" id="8209619">true</span><span class="op" id="8209623">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209629">OCSPServer</span><span class="op" id="8209639">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8209652">[</span><span class="op" id="8209653">]</span><span class="builtintype" id="8209654">string</span><span class="op" id="8209660">{</span><span class="string" id="8209661">&#34;http://ocsp.example.com&#34;</span><span class="op" id="8209686">}</span><span class="op" id="8209687">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209692">IssuingCertificateURL</span><span class="op" id="8209713">:</span>&nbsp;<span class="op" id="8209715">[</span><span class="op" id="8209716">]</span><span class="builtintype" id="8209717">string</span><span class="op" id="8209723">{</span><span class="string" id="8209724">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="8209756">}</span><span class="op" id="8209757">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209763">DNSNames</span><span class="op" id="8209771">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8209779">[</span><span class="op" id="8209780">]</span><span class="builtintype" id="8209781">string</span><span class="op" id="8209787">{</span><span class="string" id="8209788">&#34;test.example.com&#34;</span><span class="op" id="8209806">}</span><span class="op" id="8209807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209812">EmailAddresses</span><span class="op" id="8209826">:</span>&nbsp;<span class="op" id="8209828">[</span><span class="op" id="8209829">]</span><span class="builtintype" id="8209830">string</span><span class="op" id="8209836">{</span><span class="string" id="8209837">&#34;gopher@golang.org&#34;</span><span class="op" id="8209856">}</span><span class="op" id="8209857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209862">IPAddresses</span><span class="op" id="8209873">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8209878">[</span><span class="op" id="8209879">]</span><span class="ident" id="8209880">net</span><span class="op" id="8209883">.</span><span class="ident" id="8209884">IP</span><span class="op" id="8209886">{</span><span class="ident" id="8209887">net</span><span class="op" id="8209890">.</span><span class="ident" id="8209891">IPv4</span><span class="op" id="8209895">(</span><span class="num" id="8209896">127</span><span class="op" id="8209899">,</span>&nbsp;<span class="num" id="8209901">0</span><span class="op" id="8209902">,</span>&nbsp;<span class="num" id="8209904">0</span><span class="op" id="8209905">,</span>&nbsp;<span class="num" id="8209907">1</span><span class="op" id="8209908">)</span><span class="op" id="8209909">.</span><span class="ident" id="8209910">To4</span><span class="op" id="8209913">(</span><span class="op" id="8209914">)</span><span class="op" id="8209915">,</span>&nbsp;<span class="ident" id="8209917">net</span><span class="op" id="8209920">.</span><span class="ident" id="8209921">ParseIP</span><span class="op" id="8209928">(</span><span class="string" id="8209929">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="8209951">)</span><span class="op" id="8209952">}</span><span class="op" id="8209953">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8209959">PolicyIdentifiers</span><span class="op" id="8209976">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8209980">[</span><span class="op" id="8209981">]</span><span class="ident" id="8209982">asn1</span><span class="op" id="8209986">.</span><span class="ident" id="8209987">ObjectIdentifier</span><span class="op" id="8210003">{</span><span class="op" id="8210004">[</span><span class="op" id="8210005">]</span><span class="builtintype" id="8210006">int</span><span class="op" id="8210009">{</span><span class="num" id="8210010">1</span><span class="op" id="8210011">,</span>&nbsp;<span class="num" id="8210013">2</span><span class="op" id="8210014">,</span>&nbsp;<span class="num" id="8210016">3</span><span class="op" id="8210017">}</span><span class="op" id="8210018">}</span><span class="op" id="8210019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210024">PermittedDNSDomains</span><span class="op" id="8210043">:</span>&nbsp;<span class="op" id="8210045">[</span><span class="op" id="8210046">]</span><span class="builtintype" id="8210047">string</span><span class="op" id="8210053">{</span><span class="string" id="8210054">&#34;.example.com&#34;</span><span class="op" id="8210068">,</span>&nbsp;<span class="string" id="8210070">&#34;example.com&#34;</span><span class="op" id="8210083">}</span><span class="op" id="8210084">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210090">CRLDistributionPoints</span><span class="op" id="8210111">:</span>&nbsp;<span class="op" id="8210113">[</span><span class="op" id="8210114">]</span><span class="builtintype" id="8210115">string</span><span class="op" id="8210121">{</span><span class="string" id="8210122">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="8210155">,</span>&nbsp;<span class="string" id="8210157">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="8210190">}</span><span class="op" id="8210191">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210197">ExtraExtensions</span><span class="op" id="8210212">:</span>&nbsp;<span class="op" id="8210214">[</span><span class="op" id="8210215">]</span><span class="ident" id="8210216">pkix</span><span class="op" id="8210220">.</span><span class="ident" id="8210221">Extension</span><span class="op" id="8210230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8210236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210243">Id</span><span class="op" id="8210245">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8210250">[</span><span class="op" id="8210251">]</span><span class="builtintype" id="8210252">int</span><span class="op" id="8210255">{</span><span class="num" id="8210256">1</span><span class="op" id="8210257">,</span>&nbsp;<span class="num" id="8210259">2</span><span class="op" id="8210260">,</span>&nbsp;<span class="num" id="8210262">3</span><span class="op" id="8210263">,</span>&nbsp;<span class="num" id="8210265">4</span><span class="op" id="8210266">}</span><span class="op" id="8210267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210274">Value</span><span class="op" id="8210279">:</span>&nbsp;<span class="ident" id="8210281">extraExtensionData</span><span class="op" id="8210299">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8210305">}</span><span class="op" id="8210306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8210312">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8210375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210382">Id</span><span class="op" id="8210384">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210392">oidExtensionSubjectKeyId</span><span class="op" id="8210416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210423">Critical</span><span class="op" id="8210431">:</span>&nbsp;<span class="builtintype" id="8210433">false</span><span class="op" id="8210438">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210445">Value</span><span class="op" id="8210450">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8210455">[</span><span class="op" id="8210456">]</span><span class="builtintype" id="8210457">byte</span><span class="op" id="8210461">{</span><span class="num" id="8210462">0x04</span><span class="op" id="8210466">,</span>&nbsp;<span class="num" id="8210468">0x04</span><span class="op" id="8210472">,</span>&nbsp;<span class="num" id="8210474">4</span><span class="op" id="8210475">,</span>&nbsp;<span class="num" id="8210477">3</span><span class="op" id="8210478">,</span>&nbsp;<span class="num" id="8210480">2</span><span class="op" id="8210481">,</span>&nbsp;<span class="num" id="8210483">1</span><span class="op" id="8210484">}</span><span class="op" id="8210485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8210491">}</span><span class="op" id="8210492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8210497">}</span><span class="op" id="8210498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8210502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210507">derBytes</span><span class="op" id="8210515">,</span>&nbsp;<span class="ident" id="8210517">err</span>&nbsp;<span class="op" id="8210521">:=</span>&nbsp;<span class="ident" id="8210524">CreateCertificate</span><span class="op" id="8210541">(</span><span class="ident" id="8210542">random</span><span class="op" id="8210548">,</span>&nbsp;<span class="op" id="8210550">&amp;</span><span class="ident" id="8210551">template</span><span class="op" id="8210559">,</span>&nbsp;<span class="op" id="8210561">&amp;</span><span class="ident" id="8210562">template</span><span class="op" id="8210570">,</span>&nbsp;<span class="ident" id="8210572">test</span><span class="op" id="8210576">.</span><span class="ident" id="8210577">pub</span><span class="op" id="8210580">,</span>&nbsp;<span class="ident" id="8210582">test</span><span class="op" id="8210586">.</span><span class="ident" id="8210587">priv</span><span class="op" id="8210591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8210595">if</span>&nbsp;<span class="ident" id="8210598">err</span>&nbsp;<span class="op" id="8210602">!=</span>&nbsp;<span class="builtintype" id="8210605">nil</span>&nbsp;<span class="op" id="8210609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210614">t</span><span class="op" id="8210615">.</span><span class="ident" id="8210616">Errorf</span><span class="op" id="8210622">(</span><span class="string" id="8210623">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8210661">,</span>&nbsp;<span class="ident" id="8210663">test</span><span class="op" id="8210667">.</span><span class="ident" id="8210668">name</span><span class="op" id="8210672">,</span>&nbsp;<span class="ident" id="8210674">err</span><span class="op" id="8210677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8210682">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8210693">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210698">cert</span><span class="op" id="8210702">,</span>&nbsp;<span class="ident" id="8210704">err</span>&nbsp;<span class="op" id="8210708">:=</span>&nbsp;<span class="ident" id="8210711">ParseCertificate</span><span class="op" id="8210727">(</span><span class="ident" id="8210728">derBytes</span><span class="op" id="8210736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8210740">if</span>&nbsp;<span class="ident" id="8210743">err</span>&nbsp;<span class="op" id="8210747">!=</span>&nbsp;<span class="builtintype" id="8210750">nil</span>&nbsp;<span class="op" id="8210754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210759">t</span><span class="op" id="8210760">.</span><span class="ident" id="8210761">Errorf</span><span class="op" id="8210767">(</span><span class="string" id="8210768">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8210805">,</span>&nbsp;<span class="ident" id="8210807">test</span><span class="op" id="8210811">.</span><span class="ident" id="8210812">name</span><span class="op" id="8210816">,</span>&nbsp;<span class="ident" id="8210818">err</span><span class="op" id="8210821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8210826">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8210837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8210842">if</span>&nbsp;<span class="builtinfunc" id="8210845">len</span><span class="op" id="8210848">(</span><span class="ident" id="8210849">cert</span><span class="op" id="8210853">.</span><span class="ident" id="8210854">PolicyIdentifiers</span><span class="op" id="8210871">)</span>&nbsp;<span class="op" id="8210873">!=</span>&nbsp;<span class="num" id="8210876">1</span>&nbsp;<span class="op" id="8210878">||</span>&nbsp;<span class="op" id="8210881">!</span><span class="ident" id="8210882">cert</span><span class="op" id="8210886">.</span><span class="ident" id="8210887">PolicyIdentifiers</span><span class="op" id="8210904">[</span><span class="num" id="8210905">0</span><span class="op" id="8210906">]</span><span class="op" id="8210907">.</span><span class="ident" id="8210908">Equal</span><span class="op" id="8210913">(</span><span class="ident" id="8210914">template</span><span class="op" id="8210922">.</span><span class="ident" id="8210923">PolicyIdentifiers</span><span class="op" id="8210940">[</span><span class="num" id="8210941">0</span><span class="op" id="8210942">]</span><span class="op" id="8210943">)</span>&nbsp;<span class="op" id="8210945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8210950">t</span><span class="op" id="8210951">.</span><span class="ident" id="8210952">Errorf</span><span class="op" id="8210958">(</span><span class="string" id="8210959">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8211017">,</span>&nbsp;<span class="ident" id="8211019">test</span><span class="op" id="8211023">.</span><span class="ident" id="8211024">name</span><span class="op" id="8211028">,</span>&nbsp;<span class="ident" id="8211030">cert</span><span class="op" id="8211034">.</span><span class="ident" id="8211035">PolicyIdentifiers</span><span class="op" id="8211052">,</span>&nbsp;<span class="ident" id="8211054">template</span><span class="op" id="8211062">.</span><span class="ident" id="8211063">PolicyIdentifiers</span><span class="op" id="8211080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8211084">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8211089">if</span>&nbsp;<span class="builtinfunc" id="8211092">len</span><span class="op" id="8211095">(</span><span class="ident" id="8211096">cert</span><span class="op" id="8211100">.</span><span class="ident" id="8211101">PermittedDNSDomains</span><span class="op" id="8211120">)</span>&nbsp;<span class="op" id="8211122">!=</span>&nbsp;<span class="num" id="8211125">2</span>&nbsp;<span class="op" id="8211127">||</span>&nbsp;<span class="ident" id="8211130">cert</span><span class="op" id="8211134">.</span><span class="ident" id="8211135">PermittedDNSDomains</span><span class="op" id="8211154">[</span><span class="num" id="8211155">0</span><span class="op" id="8211156">]</span>&nbsp;<span class="op" id="8211158">!=</span>&nbsp;<span class="string" id="8211161">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="8211176">||</span>&nbsp;<span class="ident" id="8211179">cert</span><span class="op" id="8211183">.</span><span class="ident" id="8211184">PermittedDNSDomains</span><span class="op" id="8211203">[</span><span class="num" id="8211204">1</span><span class="op" id="8211205">]</span>&nbsp;<span class="op" id="8211207">!=</span>&nbsp;<span class="string" id="8211210">&#34;example.com&#34;</span>&nbsp;<span class="op" id="8211224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8211229">t</span><span class="op" id="8211230">.</span><span class="ident" id="8211231">Errorf</span><span class="op" id="8211237">(</span><span class="string" id="8211238">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="8211281">,</span>&nbsp;<span class="ident" id="8211283">test</span><span class="op" id="8211287">.</span><span class="ident" id="8211288">name</span><span class="op" id="8211292">,</span>&nbsp;<span class="ident" id="8211294">cert</span><span class="op" id="8211298">.</span><span class="ident" id="8211299">PermittedDNSDomains</span><span class="op" id="8211318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8211322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8211327">if</span>&nbsp;<span class="ident" id="8211330">cert</span><span class="op" id="8211334">.</span><span class="ident" id="8211335">Subject</span><span class="op" id="8211342">.</span><span class="ident" id="8211343">CommonName</span>&nbsp;<span class="op" id="8211354">!=</span>&nbsp;<span class="ident" id="8211357">commonName</span>&nbsp;<span class="op" id="8211368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8211373">t</span><span class="op" id="8211374">.</span><span class="ident" id="8211375">Errorf</span><span class="op" id="8211381">(</span><span class="string" id="8211382">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8211454">,</span>&nbsp;<span class="ident" id="8211456">test</span><span class="op" id="8211460">.</span><span class="ident" id="8211461">name</span><span class="op" id="8211465">,</span>&nbsp;<span class="ident" id="8211467">cert</span><span class="op" id="8211471">.</span><span class="ident" id="8211472">Subject</span><span class="op" id="8211479">.</span><span class="ident" id="8211480">CommonName</span><span class="op" id="8211490">,</span>&nbsp;<span class="ident" id="8211492">commonName</span><span class="op" id="8211502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8211506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8211511">if</span>&nbsp;<span class="ident" id="8211514">cert</span><span class="op" id="8211518">.</span><span class="ident" id="8211519">Issuer</span><span class="op" id="8211525">.</span><span class="ident" id="8211526">CommonName</span>&nbsp;<span class="op" id="8211537">!=</span>&nbsp;<span class="ident" id="8211540">commonName</span>&nbsp;<span class="op" id="8211551">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8211556">t</span><span class="op" id="8211557">.</span><span class="ident" id="8211558">Errorf</span><span class="op" id="8211564">(</span><span class="string" id="8211565">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8211636">,</span>&nbsp;<span class="ident" id="8211638">test</span><span class="op" id="8211642">.</span><span class="ident" id="8211643">name</span><span class="op" id="8211647">,</span>&nbsp;<span class="ident" id="8211649">cert</span><span class="op" id="8211653">.</span><span class="ident" id="8211654">Issuer</span><span class="op" id="8211660">.</span><span class="ident" id="8211661">CommonName</span><span class="op" id="8211671">,</span>&nbsp;<span class="ident" id="8211673">commonName</span><span class="op" id="8211683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8211687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8211692">if</span>&nbsp;<span class="ident" id="8211695">cert</span><span class="op" id="8211699">.</span><span class="ident" id="8211700">SignatureAlgorithm</span>&nbsp;<span class="op" id="8211719">!=</span>&nbsp;<span class="ident" id="8211722">test</span><span class="op" id="8211726">.</span><span class="ident" id="8211727">sigAlgo</span>&nbsp;<span class="op" id="8211735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8211740">t</span><span class="op" id="8211741">.</span><span class="ident" id="8211742">Errorf</span><span class="op" id="8211748">(</span><span class="string" id="8211749">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8211818">,</span>&nbsp;<span class="ident" id="8211820">test</span><span class="op" id="8211824">.</span><span class="ident" id="8211825">name</span><span class="op" id="8211829">,</span>&nbsp;<span class="ident" id="8211831">cert</span><span class="op" id="8211835">.</span><span class="ident" id="8211836">SignatureAlgorithm</span><span class="op" id="8211854">,</span>&nbsp;<span class="ident" id="8211856">test</span><span class="op" id="8211860">.</span><span class="ident" id="8211861">sigAlgo</span><span class="op" id="8211868">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8211872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8211877">if</span>&nbsp;<span class="op" id="8211880">!</span><span class="ident" id="8211881">reflect</span><span class="op" id="8211888">.</span><span class="ident" id="8211889">DeepEqual</span><span class="op" id="8211898">(</span><span class="ident" id="8211899">cert</span><span class="op" id="8211903">.</span><span class="ident" id="8211904">ExtKeyUsage</span><span class="op" id="8211915">,</span>&nbsp;<span class="ident" id="8211917">testExtKeyUsage</span><span class="op" id="8211932">)</span>&nbsp;<span class="op" id="8211934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8211939">t</span><span class="op" id="8211940">.</span><span class="ident" id="8211941">Errorf</span><span class="op" id="8211947">(</span><span class="string" id="8211948">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8212024">,</span>&nbsp;<span class="ident" id="8212026">test</span><span class="op" id="8212030">.</span><span class="ident" id="8212031">name</span><span class="op" id="8212035">,</span>&nbsp;<span class="ident" id="8212037">cert</span><span class="op" id="8212041">.</span><span class="ident" id="8212042">ExtKeyUsage</span><span class="op" id="8212053">,</span>&nbsp;<span class="ident" id="8212055">testExtKeyUsage</span><span class="op" id="8212070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8212074">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8212079">if</span>&nbsp;<span class="op" id="8212082">!</span><span class="ident" id="8212083">reflect</span><span class="op" id="8212090">.</span><span class="ident" id="8212091">DeepEqual</span><span class="op" id="8212100">(</span><span class="ident" id="8212101">cert</span><span class="op" id="8212105">.</span><span class="ident" id="8212106">UnknownExtKeyUsage</span><span class="op" id="8212124">,</span>&nbsp;<span class="ident" id="8212126">testUnknownExtKeyUsage</span><span class="op" id="8212148">)</span>&nbsp;<span class="op" id="8212150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8212155">t</span><span class="op" id="8212156">.</span><span class="ident" id="8212157">Errorf</span><span class="op" id="8212163">(</span><span class="string" id="8212164">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8212248">,</span>&nbsp;<span class="ident" id="8212250">test</span><span class="op" id="8212254">.</span><span class="ident" id="8212255">name</span><span class="op" id="8212259">,</span>&nbsp;<span class="ident" id="8212261">cert</span><span class="op" id="8212265">.</span><span class="ident" id="8212266">UnknownExtKeyUsage</span><span class="op" id="8212284">,</span>&nbsp;<span class="ident" id="8212286">testUnknownExtKeyUsage</span><span class="op" id="8212308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8212312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8212317">if</span>&nbsp;<span class="op" id="8212320">!</span><span class="ident" id="8212321">reflect</span><span class="op" id="8212328">.</span><span class="ident" id="8212329">DeepEqual</span><span class="op" id="8212338">(</span><span class="ident" id="8212339">cert</span><span class="op" id="8212343">.</span><span class="ident" id="8212344">OCSPServer</span><span class="op" id="8212354">,</span>&nbsp;<span class="ident" id="8212356">template</span><span class="op" id="8212364">.</span><span class="ident" id="8212365">OCSPServer</span><span class="op" id="8212375">)</span>&nbsp;<span class="op" id="8212377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8212382">t</span><span class="op" id="8212383">.</span><span class="ident" id="8212384">Errorf</span><span class="op" id="8212390">(</span><span class="string" id="8212391">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8212447">,</span>&nbsp;<span class="ident" id="8212449">test</span><span class="op" id="8212453">.</span><span class="ident" id="8212454">name</span><span class="op" id="8212458">,</span>&nbsp;<span class="ident" id="8212460">cert</span><span class="op" id="8212464">.</span><span class="ident" id="8212465">OCSPServer</span><span class="op" id="8212475">,</span>&nbsp;<span class="ident" id="8212477">template</span><span class="op" id="8212485">.</span><span class="ident" id="8212486">OCSPServer</span><span class="op" id="8212496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8212500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8212505">if</span>&nbsp;<span class="op" id="8212508">!</span><span class="ident" id="8212509">reflect</span><span class="op" id="8212516">.</span><span class="ident" id="8212517">DeepEqual</span><span class="op" id="8212526">(</span><span class="ident" id="8212527">cert</span><span class="op" id="8212531">.</span><span class="ident" id="8212532">IssuingCertificateURL</span><span class="op" id="8212553">,</span>&nbsp;<span class="ident" id="8212555">template</span><span class="op" id="8212563">.</span><span class="ident" id="8212564">IssuingCertificateURL</span><span class="op" id="8212585">)</span>&nbsp;<span class="op" id="8212587">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8212592">t</span><span class="op" id="8212593">.</span><span class="ident" id="8212594">Errorf</span><span class="op" id="8212600">(</span><span class="string" id="8212601">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8212669">,</span>&nbsp;<span class="ident" id="8212671">test</span><span class="op" id="8212675">.</span><span class="ident" id="8212676">name</span><span class="op" id="8212680">,</span>&nbsp;<span class="ident" id="8212682">cert</span><span class="op" id="8212686">.</span><span class="ident" id="8212687">IssuingCertificateURL</span><span class="op" id="8212708">,</span>&nbsp;<span class="ident" id="8212710">template</span><span class="op" id="8212718">.</span><span class="ident" id="8212719">IssuingCertificateURL</span><span class="op" id="8212740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8212744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8212749">if</span>&nbsp;<span class="op" id="8212752">!</span><span class="ident" id="8212753">reflect</span><span class="op" id="8212760">.</span><span class="ident" id="8212761">DeepEqual</span><span class="op" id="8212770">(</span><span class="ident" id="8212771">cert</span><span class="op" id="8212775">.</span><span class="ident" id="8212776">DNSNames</span><span class="op" id="8212784">,</span>&nbsp;<span class="ident" id="8212786">template</span><span class="op" id="8212794">.</span><span class="ident" id="8212795">DNSNames</span><span class="op" id="8212803">)</span>&nbsp;<span class="op" id="8212805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8212810">t</span><span class="op" id="8212811">.</span><span class="ident" id="8212812">Errorf</span><span class="op" id="8212818">(</span><span class="string" id="8212819">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8212876">,</span>&nbsp;<span class="ident" id="8212878">test</span><span class="op" id="8212882">.</span><span class="ident" id="8212883">name</span><span class="op" id="8212887">,</span>&nbsp;<span class="ident" id="8212889">cert</span><span class="op" id="8212893">.</span><span class="ident" id="8212894">DNSNames</span><span class="op" id="8212902">,</span>&nbsp;<span class="ident" id="8212904">template</span><span class="op" id="8212912">.</span><span class="ident" id="8212913">DNSNames</span><span class="op" id="8212921">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8212925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8212930">if</span>&nbsp;<span class="op" id="8212933">!</span><span class="ident" id="8212934">reflect</span><span class="op" id="8212941">.</span><span class="ident" id="8212942">DeepEqual</span><span class="op" id="8212951">(</span><span class="ident" id="8212952">cert</span><span class="op" id="8212956">.</span><span class="ident" id="8212957">EmailAddresses</span><span class="op" id="8212971">,</span>&nbsp;<span class="ident" id="8212973">template</span><span class="op" id="8212981">.</span><span class="ident" id="8212982">EmailAddresses</span><span class="op" id="8212996">)</span>&nbsp;<span class="op" id="8212998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8213003">t</span><span class="op" id="8213004">.</span><span class="ident" id="8213005">Errorf</span><span class="op" id="8213011">(</span><span class="string" id="8213012">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8213066">,</span>&nbsp;<span class="ident" id="8213068">test</span><span class="op" id="8213072">.</span><span class="ident" id="8213073">name</span><span class="op" id="8213077">,</span>&nbsp;<span class="ident" id="8213079">cert</span><span class="op" id="8213083">.</span><span class="ident" id="8213084">EmailAddresses</span><span class="op" id="8213098">,</span>&nbsp;<span class="ident" id="8213100">template</span><span class="op" id="8213108">.</span><span class="ident" id="8213109">EmailAddresses</span><span class="op" id="8213123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8213127">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8213132">if</span>&nbsp;<span class="op" id="8213135">!</span><span class="ident" id="8213136">reflect</span><span class="op" id="8213143">.</span><span class="ident" id="8213144">DeepEqual</span><span class="op" id="8213153">(</span><span class="ident" id="8213154">cert</span><span class="op" id="8213158">.</span><span class="ident" id="8213159">IPAddresses</span><span class="op" id="8213170">,</span>&nbsp;<span class="ident" id="8213172">template</span><span class="op" id="8213180">.</span><span class="ident" id="8213181">IPAddresses</span><span class="op" id="8213192">)</span>&nbsp;<span class="op" id="8213194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8213199">t</span><span class="op" id="8213200">.</span><span class="ident" id="8213201">Errorf</span><span class="op" id="8213207">(</span><span class="string" id="8213208">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8213259">,</span>&nbsp;<span class="ident" id="8213261">test</span><span class="op" id="8213265">.</span><span class="ident" id="8213266">name</span><span class="op" id="8213270">,</span>&nbsp;<span class="ident" id="8213272">cert</span><span class="op" id="8213276">.</span><span class="ident" id="8213277">IPAddresses</span><span class="op" id="8213288">,</span>&nbsp;<span class="ident" id="8213290">template</span><span class="op" id="8213298">.</span><span class="ident" id="8213299">IPAddresses</span><span class="op" id="8213310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8213314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8213319">if</span>&nbsp;<span class="op" id="8213322">!</span><span class="ident" id="8213323">reflect</span><span class="op" id="8213330">.</span><span class="ident" id="8213331">DeepEqual</span><span class="op" id="8213340">(</span><span class="ident" id="8213341">cert</span><span class="op" id="8213345">.</span><span class="ident" id="8213346">CRLDistributionPoints</span><span class="op" id="8213367">,</span>&nbsp;<span class="ident" id="8213369">template</span><span class="op" id="8213377">.</span><span class="ident" id="8213378">CRLDistributionPoints</span><span class="op" id="8213399">)</span>&nbsp;<span class="op" id="8213401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8213406">t</span><span class="op" id="8213407">.</span><span class="ident" id="8213408">Errorf</span><span class="op" id="8213414">(</span><span class="string" id="8213415">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8213482">,</span>&nbsp;<span class="ident" id="8213484">test</span><span class="op" id="8213488">.</span><span class="ident" id="8213489">name</span><span class="op" id="8213493">,</span>&nbsp;<span class="ident" id="8213495">cert</span><span class="op" id="8213499">.</span><span class="ident" id="8213500">CRLDistributionPoints</span><span class="op" id="8213521">,</span>&nbsp;<span class="ident" id="8213523">template</span><span class="op" id="8213531">.</span><span class="ident" id="8213532">CRLDistributionPoints</span><span class="op" id="8213553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8213557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8213562">if</span>&nbsp;<span class="op" id="8213565">!</span><span class="ident" id="8213566">bytes</span><span class="op" id="8213571">.</span><span class="ident" id="8213572">Equal</span><span class="op" id="8213577">(</span><span class="ident" id="8213578">cert</span><span class="op" id="8213582">.</span><span class="ident" id="8213583">SubjectKeyId</span><span class="op" id="8213595">,</span>&nbsp;<span class="op" id="8213597">[</span><span class="op" id="8213598">]</span><span class="builtintype" id="8213599">byte</span><span class="op" id="8213603">{</span><span class="num" id="8213604">4</span><span class="op" id="8213605">,</span>&nbsp;<span class="num" id="8213607">3</span><span class="op" id="8213608">,</span>&nbsp;<span class="num" id="8213610">2</span><span class="op" id="8213611">,</span>&nbsp;<span class="num" id="8213613">1</span><span class="op" id="8213614">}</span><span class="op" id="8213615">)</span>&nbsp;<span class="op" id="8213617">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8213622">t</span><span class="op" id="8213623">.</span><span class="ident" id="8213624">Errorf</span><span class="op" id="8213630">(</span><span class="string" id="8213631">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="8213681">,</span>&nbsp;<span class="ident" id="8213683">test</span><span class="op" id="8213687">.</span><span class="ident" id="8213688">name</span><span class="op" id="8213692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8213696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8213701">if</span>&nbsp;<span class="ident" id="8213704">bytes</span><span class="op" id="8213709">.</span><span class="ident" id="8213710">Index</span><span class="op" id="8213715">(</span><span class="ident" id="8213716">derBytes</span><span class="op" id="8213724">,</span>&nbsp;<span class="ident" id="8213726">extraExtensionData</span><span class="op" id="8213744">)</span>&nbsp;<span class="op" id="8213746">==</span>&nbsp;<span class="op" id="8213749">-</span><span class="num" id="8213750">1</span>&nbsp;<span class="op" id="8213752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8213757">t</span><span class="op" id="8213758">.</span><span class="ident" id="8213759">Errorf</span><span class="op" id="8213765">(</span><span class="string" id="8213766">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="8213813">,</span>&nbsp;<span class="ident" id="8213815">test</span><span class="op" id="8213819">.</span><span class="ident" id="8213820">name</span><span class="op" id="8213824">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8213828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8213833">if</span>&nbsp;<span class="ident" id="8213836">test</span><span class="op" id="8213840">.</span><span class="ident" id="8213841">checkSig</span>&nbsp;<span class="op" id="8213850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8213855">err</span>&nbsp;<span class="op" id="8213859">=</span>&nbsp;<span class="ident" id="8213861">cert</span><span class="op" id="8213865">.</span><span class="ident" id="8213866">CheckSignatureFrom</span><span class="op" id="8213884">(</span><span class="ident" id="8213885">cert</span><span class="op" id="8213889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8213894">if</span>&nbsp;<span class="ident" id="8213897">err</span>&nbsp;<span class="op" id="8213901">!=</span>&nbsp;<span class="builtintype" id="8213904">nil</span>&nbsp;<span class="op" id="8213908">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8213914">t</span><span class="op" id="8213915">.</span><span class="ident" id="8213916">Errorf</span><span class="op" id="8213922">(</span><span class="string" id="8213923">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8213962">,</span>&nbsp;<span class="ident" id="8213964">test</span><span class="op" id="8213968">.</span><span class="ident" id="8213969">name</span><span class="op" id="8213973">,</span>&nbsp;<span class="ident" id="8213975">err</span><span class="op" id="8213978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8213983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8213987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8213990">}</span><br>
<span class="lineno"></span><span class="op" id="8213992">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="8213995">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="8214056">var</span>&nbsp;<span class="ident" id="8214060">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="8214077">=</span>&nbsp;<span class="string" id="8214079">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8214858">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="8214921">var</span>&nbsp;<span class="ident" id="8214925">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="8214948">=</span>&nbsp;<span class="string" id="8214950">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8215729">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="8215792">var</span>&nbsp;<span class="ident" id="8215796">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="8215819">=</span>&nbsp;<span class="string" id="8215821">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="8216681">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="8216744">var</span>&nbsp;<span class="ident" id="8216748">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="8216771">=</span>&nbsp;<span class="string" id="8216773">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="8217734">var</span>&nbsp;<span class="ident" id="8217738">ecdsaTests</span>&nbsp;<span class="op" id="8217749">=</span>&nbsp;<span class="op" id="8217751">[</span><span class="op" id="8217752">]</span><span class="keyword" id="8217753">struct</span>&nbsp;<span class="op" id="8217760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217763">sigAlgo</span>&nbsp;<span class="ident" id="8217771">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217791">pemCert</span>&nbsp;<span class="builtintype" id="8217799">string</span><br>
<span class="lineno"></span><span class="op" id="8217806">}</span><span class="op" id="8217807">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8217810">{</span><span class="ident" id="8217811">ECDSAWithSHA1</span><span class="op" id="8217824">,</span>&nbsp;<span class="ident" id="8217826">ecdsaSHA1CertPem</span><span class="op" id="8217842">}</span><span class="op" id="8217843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8217846">{</span><span class="ident" id="8217847">ECDSAWithSHA256</span><span class="op" id="8217862">,</span>&nbsp;<span class="ident" id="8217864">ecdsaSHA256p256CertPem</span><span class="op" id="8217886">}</span><span class="op" id="8217887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8217890">{</span><span class="ident" id="8217891">ECDSAWithSHA256</span><span class="op" id="8217906">,</span>&nbsp;<span class="ident" id="8217908">ecdsaSHA256p384CertPem</span><span class="op" id="8217930">}</span><span class="op" id="8217931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8217934">{</span><span class="ident" id="8217935">ECDSAWithSHA384</span><span class="op" id="8217950">,</span>&nbsp;<span class="ident" id="8217952">ecdsaSHA384p521CertPem</span><span class="op" id="8217974">}</span><span class="op" id="8217975">,</span><br>
<span class="lineno"></span><span class="op" id="8217977">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="8217980">func</span>&nbsp;<span class="ident" id="8217985">TestECDSA</span><span class="op" id="8217994">(</span><span class="ident" id="8217995">t</span>&nbsp;<span class="op" id="8217997">*</span><span class="ident" id="8217998">testing</span><span class="op" id="8218005">.</span><span class="ident" id="8218006">T</span><span class="op" id="8218007">)</span>&nbsp;<span class="op" id="8218009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8218012">for</span>&nbsp;<span class="ident" id="8218016">i</span><span class="op" id="8218017">,</span>&nbsp;<span class="ident" id="8218019">test</span>&nbsp;<span class="op" id="8218024">:=</span>&nbsp;<span class="keyword" id="8218027">range</span>&nbsp;<span class="ident" id="8218033">ecdsaTests</span>&nbsp;<span class="op" id="8218044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218048">pemBlock</span><span class="op" id="8218056">,</span>&nbsp;<span class="ident" id="8218058">_</span>&nbsp;<span class="op" id="8218060">:=</span>&nbsp;<span class="ident" id="8218063">pem</span><span class="op" id="8218066">.</span><span class="ident" id="8218067">Decode</span><span class="op" id="8218073">(</span><span class="op" id="8218074">[</span><span class="op" id="8218075">]</span><span class="builtintype" id="8218076">byte</span><span class="op" id="8218080">(</span><span class="ident" id="8218081">test</span><span class="op" id="8218085">.</span><span class="ident" id="8218086">pemCert</span><span class="op" id="8218093">)</span><span class="op" id="8218094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218098">cert</span><span class="op" id="8218102">,</span>&nbsp;<span class="ident" id="8218104">err</span>&nbsp;<span class="op" id="8218108">:=</span>&nbsp;<span class="ident" id="8218111">ParseCertificate</span><span class="op" id="8218127">(</span><span class="ident" id="8218128">pemBlock</span><span class="op" id="8218136">.</span><span class="ident" id="8218137">Bytes</span><span class="op" id="8218142">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8218146">if</span>&nbsp;<span class="ident" id="8218149">err</span>&nbsp;<span class="op" id="8218153">!=</span>&nbsp;<span class="builtintype" id="8218156">nil</span>&nbsp;<span class="op" id="8218160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218165">t</span><span class="op" id="8218166">.</span><span class="ident" id="8218167">Errorf</span><span class="op" id="8218173">(</span><span class="string" id="8218174">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8218211">,</span>&nbsp;<span class="ident" id="8218213">i</span><span class="op" id="8218214">,</span>&nbsp;<span class="ident" id="8218216">err</span><span class="op" id="8218219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8218224">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8218235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8218239">if</span>&nbsp;<span class="ident" id="8218242">sa</span>&nbsp;<span class="op" id="8218245">:=</span>&nbsp;<span class="ident" id="8218248">cert</span><span class="op" id="8218252">.</span><span class="ident" id="8218253">SignatureAlgorithm</span><span class="op" id="8218271">;</span>&nbsp;<span class="ident" id="8218273">sa</span>&nbsp;<span class="op" id="8218276">!=</span>&nbsp;<span class="ident" id="8218279">test</span><span class="op" id="8218283">.</span><span class="ident" id="8218284">sigAlgo</span>&nbsp;<span class="op" id="8218292">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218297">t</span><span class="op" id="8218298">.</span><span class="ident" id="8218299">Errorf</span><span class="op" id="8218305">(</span><span class="string" id="8218306">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8218346">,</span>&nbsp;<span class="ident" id="8218348">i</span><span class="op" id="8218349">,</span>&nbsp;<span class="ident" id="8218351">sa</span><span class="op" id="8218353">,</span>&nbsp;<span class="ident" id="8218355">test</span><span class="op" id="8218359">.</span><span class="ident" id="8218360">sigAlgo</span><span class="op" id="8218367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8218371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8218375">if</span>&nbsp;<span class="ident" id="8218378">parsedKey</span><span class="op" id="8218387">,</span>&nbsp;<span class="ident" id="8218389">ok</span>&nbsp;<span class="op" id="8218392">:=</span>&nbsp;<span class="ident" id="8218395">cert</span><span class="op" id="8218399">.</span><span class="ident" id="8218400">PublicKey</span><span class="op" id="8218409">.</span><span class="op" id="8218410">(</span><span class="op" id="8218411">*</span><span class="ident" id="8218412">ecdsa</span><span class="op" id="8218417">.</span><span class="ident" id="8218418">PublicKey</span><span class="op" id="8218427">)</span><span class="op" id="8218428">;</span>&nbsp;<span class="op" id="8218430">!</span><span class="ident" id="8218431">ok</span>&nbsp;<span class="op" id="8218434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218439">t</span><span class="op" id="8218440">.</span><span class="ident" id="8218441">Errorf</span><span class="op" id="8218447">(</span><span class="string" id="8218448">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="8218495">,</span>&nbsp;<span class="ident" id="8218497">i</span><span class="op" id="8218498">,</span>&nbsp;<span class="ident" id="8218500">parsedKey</span><span class="op" id="8218509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8218513">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8218517">if</span>&nbsp;<span class="ident" id="8218520">pka</span>&nbsp;<span class="op" id="8218524">:=</span>&nbsp;<span class="ident" id="8218527">cert</span><span class="op" id="8218531">.</span><span class="ident" id="8218532">PublicKeyAlgorithm</span><span class="op" id="8218550">;</span>&nbsp;<span class="ident" id="8218552">pka</span>&nbsp;<span class="op" id="8218556">!=</span>&nbsp;<span class="ident" id="8218559">ECDSA</span>&nbsp;<span class="op" id="8218565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218570">t</span><span class="op" id="8218571">.</span><span class="ident" id="8218572">Errorf</span><span class="op" id="8218578">(</span><span class="string" id="8218579">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="8218623">,</span>&nbsp;<span class="ident" id="8218625">i</span><span class="op" id="8218626">,</span>&nbsp;<span class="ident" id="8218628">pka</span><span class="op" id="8218631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8218635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8218639">if</span>&nbsp;<span class="ident" id="8218642">err</span>&nbsp;<span class="op" id="8218646">=</span>&nbsp;<span class="ident" id="8218648">cert</span><span class="op" id="8218652">.</span><span class="ident" id="8218653">CheckSignatureFrom</span><span class="op" id="8218671">(</span><span class="ident" id="8218672">cert</span><span class="op" id="8218676">)</span><span class="op" id="8218677">;</span>&nbsp;<span class="ident" id="8218679">err</span>&nbsp;<span class="op" id="8218683">!=</span>&nbsp;<span class="builtintype" id="8218686">nil</span>&nbsp;<span class="op" id="8218690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218695">t</span><span class="op" id="8218696">.</span><span class="ident" id="8218697">Errorf</span><span class="op" id="8218703">(</span><span class="string" id="8218704">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8218745">,</span>&nbsp;<span class="ident" id="8218747">i</span><span class="op" id="8218748">,</span>&nbsp;<span class="ident" id="8218750">err</span><span class="op" id="8218753">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8218757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8218760">}</span><br>
<span class="lineno"></span><span class="op" id="8218762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8218765">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="8218812">var</span>&nbsp;<span class="ident" id="8218816">dsaCertPem</span>&nbsp;<span class="op" id="8218827">=</span>&nbsp;<span class="string" id="8218829">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="8220297">func</span>&nbsp;<span class="ident" id="8220302">TestParseCertificateWithDsaPublicKey</span><span class="op" id="8220338">(</span><span class="ident" id="8220339">t</span>&nbsp;<span class="op" id="8220341">*</span><span class="ident" id="8220342">testing</span><span class="op" id="8220349">.</span><span class="ident" id="8220350">T</span><span class="op" id="8220351">)</span>&nbsp;<span class="op" id="8220353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220356">expectedKey</span>&nbsp;<span class="op" id="8220368">:=</span>&nbsp;<span class="op" id="8220371">&amp;</span><span class="ident" id="8220372">dsa</span><span class="op" id="8220375">.</span><span class="ident" id="8220376">PublicKey</span><span class="op" id="8220385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220389">Parameters</span><span class="op" id="8220399">:</span>&nbsp;<span class="ident" id="8220401">dsa</span><span class="op" id="8220404">.</span><span class="ident" id="8220405">Parameters</span><span class="op" id="8220415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220420">P</span><span class="op" id="8220421">:</span>&nbsp;<span class="ident" id="8220423">bigFromHexString</span><span class="op" id="8220439">(</span><span class="string" id="8220440">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="8220700">)</span><span class="op" id="8220701">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220706">Q</span><span class="op" id="8220707">:</span>&nbsp;<span class="ident" id="8220709">bigFromHexString</span><span class="op" id="8220725">(</span><span class="string" id="8220726">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="8220770">)</span><span class="op" id="8220771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220776">G</span><span class="op" id="8220777">:</span>&nbsp;<span class="ident" id="8220779">bigFromHexString</span><span class="op" id="8220795">(</span><span class="string" id="8220796">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="8221056">)</span><span class="op" id="8221057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221061">}</span><span class="op" id="8221062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221066">Y</span><span class="op" id="8221067">:</span>&nbsp;<span class="ident" id="8221069">bigFromHexString</span><span class="op" id="8221085">(</span><span class="string" id="8221086">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="8221344">)</span><span class="op" id="8221345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221348">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221351">pemBlock</span><span class="op" id="8221359">,</span>&nbsp;<span class="ident" id="8221361">_</span>&nbsp;<span class="op" id="8221363">:=</span>&nbsp;<span class="ident" id="8221366">pem</span><span class="op" id="8221369">.</span><span class="ident" id="8221370">Decode</span><span class="op" id="8221376">(</span><span class="op" id="8221377">[</span><span class="op" id="8221378">]</span><span class="builtintype" id="8221379">byte</span><span class="op" id="8221383">(</span><span class="ident" id="8221384">dsaCertPem</span><span class="op" id="8221394">)</span><span class="op" id="8221395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221398">cert</span><span class="op" id="8221402">,</span>&nbsp;<span class="ident" id="8221404">err</span>&nbsp;<span class="op" id="8221408">:=</span>&nbsp;<span class="ident" id="8221411">ParseCertificate</span><span class="op" id="8221427">(</span><span class="ident" id="8221428">pemBlock</span><span class="op" id="8221436">.</span><span class="ident" id="8221437">Bytes</span><span class="op" id="8221442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8221445">if</span>&nbsp;<span class="ident" id="8221448">err</span>&nbsp;<span class="op" id="8221452">!=</span>&nbsp;<span class="builtintype" id="8221455">nil</span>&nbsp;<span class="op" id="8221459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221463">t</span><span class="op" id="8221464">.</span><span class="ident" id="8221465">Fatalf</span><span class="op" id="8221471">(</span><span class="string" id="8221472">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8221505">,</span>&nbsp;<span class="ident" id="8221507">err</span><span class="op" id="8221510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221513">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8221516">if</span>&nbsp;<span class="ident" id="8221519">cert</span><span class="op" id="8221523">.</span><span class="ident" id="8221524">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="8221543">!=</span>&nbsp;<span class="ident" id="8221546">DSA</span>&nbsp;<span class="op" id="8221550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221554">t</span><span class="op" id="8221555">.</span><span class="ident" id="8221556">Errorf</span><span class="op" id="8221562">(</span><span class="string" id="8221563">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="8221597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221603">parsedKey</span><span class="op" id="8221612">,</span>&nbsp;<span class="ident" id="8221614">ok</span>&nbsp;<span class="op" id="8221617">:=</span>&nbsp;<span class="ident" id="8221620">cert</span><span class="op" id="8221624">.</span><span class="ident" id="8221625">PublicKey</span><span class="op" id="8221634">.</span><span class="op" id="8221635">(</span><span class="op" id="8221636">*</span><span class="ident" id="8221637">dsa</span><span class="op" id="8221640">.</span><span class="ident" id="8221641">PublicKey</span><span class="op" id="8221650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8221653">if</span>&nbsp;<span class="op" id="8221656">!</span><span class="ident" id="8221657">ok</span>&nbsp;<span class="op" id="8221660">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221664">t</span><span class="op" id="8221665">.</span><span class="ident" id="8221666">Fatalf</span><span class="op" id="8221672">(</span><span class="string" id="8221673">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8221707">,</span>&nbsp;<span class="ident" id="8221709">err</span><span class="op" id="8221712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8221718">if</span>&nbsp;<span class="ident" id="8221721">expectedKey</span><span class="op" id="8221732">.</span><span class="ident" id="8221733">Y</span><span class="op" id="8221734">.</span><span class="ident" id="8221735">Cmp</span><span class="op" id="8221738">(</span><span class="ident" id="8221739">parsedKey</span><span class="op" id="8221748">.</span><span class="ident" id="8221749">Y</span><span class="op" id="8221750">)</span>&nbsp;<span class="op" id="8221752">!=</span>&nbsp;<span class="num" id="8221755">0</span>&nbsp;<span class="op" id="8221757">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221762">expectedKey</span><span class="op" id="8221773">.</span><span class="ident" id="8221774">P</span><span class="op" id="8221775">.</span><span class="ident" id="8221776">Cmp</span><span class="op" id="8221779">(</span><span class="ident" id="8221780">parsedKey</span><span class="op" id="8221789">.</span><span class="ident" id="8221790">P</span><span class="op" id="8221791">)</span>&nbsp;<span class="op" id="8221793">!=</span>&nbsp;<span class="num" id="8221796">0</span>&nbsp;<span class="op" id="8221798">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221803">expectedKey</span><span class="op" id="8221814">.</span><span class="ident" id="8221815">Q</span><span class="op" id="8221816">.</span><span class="ident" id="8221817">Cmp</span><span class="op" id="8221820">(</span><span class="ident" id="8221821">parsedKey</span><span class="op" id="8221830">.</span><span class="ident" id="8221831">Q</span><span class="op" id="8221832">)</span>&nbsp;<span class="op" id="8221834">!=</span>&nbsp;<span class="num" id="8221837">0</span>&nbsp;<span class="op" id="8221839">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221844">expectedKey</span><span class="op" id="8221855">.</span><span class="ident" id="8221856">G</span><span class="op" id="8221857">.</span><span class="ident" id="8221858">Cmp</span><span class="op" id="8221861">(</span><span class="ident" id="8221862">parsedKey</span><span class="op" id="8221871">.</span><span class="ident" id="8221872">G</span><span class="op" id="8221873">)</span>&nbsp;<span class="op" id="8221875">!=</span>&nbsp;<span class="num" id="8221878">0</span>&nbsp;<span class="op" id="8221880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221884">t</span><span class="op" id="8221885">.</span><span class="ident" id="8221886">Fatal</span><span class="op" id="8221891">(</span><span class="string" id="8221892">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="8221930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221933">}</span><br>
<span class="lineno"></span><span class="op" id="8221935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="8221938">func</span>&nbsp;<span class="ident" id="8221943">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="8221988">(</span><span class="ident" id="8221989">t</span>&nbsp;<span class="op" id="8221991">*</span><span class="ident" id="8221992">testing</span><span class="op" id="8221999">.</span><span class="ident" id="8222000">T</span><span class="op" id="8222001">)</span>&nbsp;<span class="op" id="8222003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222006">pemBlock</span><span class="op" id="8222014">,</span>&nbsp;<span class="ident" id="8222016">_</span>&nbsp;<span class="op" id="8222018">:=</span>&nbsp;<span class="ident" id="8222021">pem</span><span class="op" id="8222024">.</span><span class="ident" id="8222025">Decode</span><span class="op" id="8222031">(</span><span class="op" id="8222032">[</span><span class="op" id="8222033">]</span><span class="builtintype" id="8222034">byte</span><span class="op" id="8222038">(</span><span class="ident" id="8222039">dsaCertPem</span><span class="op" id="8222049">)</span><span class="op" id="8222050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222053">cert</span><span class="op" id="8222057">,</span>&nbsp;<span class="ident" id="8222059">err</span>&nbsp;<span class="op" id="8222063">:=</span>&nbsp;<span class="ident" id="8222066">ParseCertificate</span><span class="op" id="8222082">(</span><span class="ident" id="8222083">pemBlock</span><span class="op" id="8222091">.</span><span class="ident" id="8222092">Bytes</span><span class="op" id="8222097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222100">if</span>&nbsp;<span class="ident" id="8222103">err</span>&nbsp;<span class="op" id="8222107">!=</span>&nbsp;<span class="builtintype" id="8222110">nil</span>&nbsp;<span class="op" id="8222114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222118">t</span><span class="op" id="8222119">.</span><span class="ident" id="8222120">Fatalf</span><span class="op" id="8222126">(</span><span class="string" id="8222127">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8222160">,</span>&nbsp;<span class="ident" id="8222162">err</span><span class="op" id="8222165">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222171">if</span>&nbsp;<span class="ident" id="8222174">cert</span><span class="op" id="8222178">.</span><span class="ident" id="8222179">SignatureAlgorithm</span>&nbsp;<span class="op" id="8222198">!=</span>&nbsp;<span class="ident" id="8222201">DSAWithSHA1</span>&nbsp;<span class="op" id="8222213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222217">t</span><span class="op" id="8222218">.</span><span class="ident" id="8222219">Errorf</span><span class="op" id="8222225">(</span><span class="string" id="8222226">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="8222274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222277">}</span><br>
<span class="lineno"></span><span class="op" id="8222279">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="8222282">func</span>&nbsp;<span class="ident" id="8222287">TestVerifyCertificateWithDSASignature</span><span class="op" id="8222324">(</span><span class="ident" id="8222325">t</span>&nbsp;<span class="op" id="8222327">*</span><span class="ident" id="8222328">testing</span><span class="op" id="8222335">.</span><span class="ident" id="8222336">T</span><span class="op" id="8222337">)</span>&nbsp;<span class="op" id="8222339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222342">pemBlock</span><span class="op" id="8222350">,</span>&nbsp;<span class="ident" id="8222352">_</span>&nbsp;<span class="op" id="8222354">:=</span>&nbsp;<span class="ident" id="8222357">pem</span><span class="op" id="8222360">.</span><span class="ident" id="8222361">Decode</span><span class="op" id="8222367">(</span><span class="op" id="8222368">[</span><span class="op" id="8222369">]</span><span class="builtintype" id="8222370">byte</span><span class="op" id="8222374">(</span><span class="ident" id="8222375">dsaCertPem</span><span class="op" id="8222385">)</span><span class="op" id="8222386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222389">cert</span><span class="op" id="8222393">,</span>&nbsp;<span class="ident" id="8222395">err</span>&nbsp;<span class="op" id="8222399">:=</span>&nbsp;<span class="ident" id="8222402">ParseCertificate</span><span class="op" id="8222418">(</span><span class="ident" id="8222419">pemBlock</span><span class="op" id="8222427">.</span><span class="ident" id="8222428">Bytes</span><span class="op" id="8222433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222436">if</span>&nbsp;<span class="ident" id="8222439">err</span>&nbsp;<span class="op" id="8222443">!=</span>&nbsp;<span class="builtintype" id="8222446">nil</span>&nbsp;<span class="op" id="8222450">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222454">t</span><span class="op" id="8222455">.</span><span class="ident" id="8222456">Fatalf</span><span class="op" id="8222462">(</span><span class="string" id="8222463">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8222496">,</span>&nbsp;<span class="ident" id="8222498">err</span><span class="op" id="8222501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8222507">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222536">if</span>&nbsp;<span class="ident" id="8222539">err</span>&nbsp;<span class="op" id="8222543">=</span>&nbsp;<span class="ident" id="8222545">cert</span><span class="op" id="8222549">.</span><span class="ident" id="8222550">CheckSignatureFrom</span><span class="op" id="8222568">(</span><span class="ident" id="8222569">cert</span><span class="op" id="8222573">)</span><span class="op" id="8222574">;</span>&nbsp;<span class="ident" id="8222576">err</span>&nbsp;<span class="op" id="8222580">!=</span>&nbsp;<span class="builtintype" id="8222583">nil</span>&nbsp;<span class="op" id="8222587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222591">t</span><span class="op" id="8222592">.</span><span class="ident" id="8222593">Fatalf</span><span class="op" id="8222599">(</span><span class="string" id="8222600">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8222641">,</span>&nbsp;<span class="ident" id="8222643">err</span><span class="op" id="8222646">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222649">}</span><br>
<span class="lineno"></span><span class="op" id="8222651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8222654">const</span>&nbsp;<span class="ident" id="8222660">pemCertificate</span>&nbsp;<span class="op" id="8222675">=</span>&nbsp;<span class="string" id="8222677">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="8223395">func</span>&nbsp;<span class="ident" id="8223400">TestCRLCreation</span><span class="op" id="8223415">(</span><span class="ident" id="8223416">t</span>&nbsp;<span class="op" id="8223418">*</span><span class="ident" id="8223419">testing</span><span class="op" id="8223426">.</span><span class="ident" id="8223427">T</span><span class="op" id="8223428">)</span>&nbsp;<span class="op" id="8223430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223433">block</span><span class="op" id="8223438">,</span>&nbsp;<span class="ident" id="8223440">_</span>&nbsp;<span class="op" id="8223442">:=</span>&nbsp;<span class="ident" id="8223445">pem</span><span class="op" id="8223448">.</span><span class="ident" id="8223449">Decode</span><span class="op" id="8223455">(</span><span class="op" id="8223456">[</span><span class="op" id="8223457">]</span><span class="builtintype" id="8223458">byte</span><span class="op" id="8223462">(</span><span class="ident" id="8223463">pemPrivateKey</span><span class="op" id="8223476">)</span><span class="op" id="8223477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223480">priv</span><span class="op" id="8223484">,</span>&nbsp;<span class="ident" id="8223486">_</span>&nbsp;<span class="op" id="8223488">:=</span>&nbsp;<span class="ident" id="8223491">ParsePKCS1PrivateKey</span><span class="op" id="8223511">(</span><span class="ident" id="8223512">block</span><span class="op" id="8223517">.</span><span class="ident" id="8223518">Bytes</span><span class="op" id="8223523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223526">block</span><span class="op" id="8223531">,</span>&nbsp;<span class="ident" id="8223533">_</span>&nbsp;<span class="op" id="8223535">=</span>&nbsp;<span class="ident" id="8223537">pem</span><span class="op" id="8223540">.</span><span class="ident" id="8223541">Decode</span><span class="op" id="8223547">(</span><span class="op" id="8223548">[</span><span class="op" id="8223549">]</span><span class="builtintype" id="8223550">byte</span><span class="op" id="8223554">(</span><span class="ident" id="8223555">pemCertificate</span><span class="op" id="8223569">)</span><span class="op" id="8223570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223573">cert</span><span class="op" id="8223577">,</span>&nbsp;<span class="ident" id="8223579">_</span>&nbsp;<span class="op" id="8223581">:=</span>&nbsp;<span class="ident" id="8223584">ParseCertificate</span><span class="op" id="8223600">(</span><span class="ident" id="8223601">block</span><span class="op" id="8223606">.</span><span class="ident" id="8223607">Bytes</span><span class="op" id="8223612">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223616">now</span>&nbsp;<span class="op" id="8223620">:=</span>&nbsp;<span class="ident" id="8223623">time</span><span class="op" id="8223627">.</span><span class="ident" id="8223628">Unix</span><span class="op" id="8223632">(</span><span class="num" id="8223633">1000</span><span class="op" id="8223637">,</span>&nbsp;<span class="num" id="8223639">0</span><span class="op" id="8223640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223643">expiry</span>&nbsp;<span class="op" id="8223650">:=</span>&nbsp;<span class="ident" id="8223653">time</span><span class="op" id="8223657">.</span><span class="ident" id="8223658">Unix</span><span class="op" id="8223662">(</span><span class="num" id="8223663">10000</span><span class="op" id="8223668">,</span>&nbsp;<span class="num" id="8223670">0</span><span class="op" id="8223671">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223675">revokedCerts</span>&nbsp;<span class="op" id="8223688">:=</span>&nbsp;<span class="op" id="8223691">[</span><span class="op" id="8223692">]</span><span class="ident" id="8223693">pkix</span><span class="op" id="8223697">.</span><span class="ident" id="8223698">RevokedCertificate</span><span class="op" id="8223716">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8223720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223725">SerialNumber</span><span class="op" id="8223737">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8223741">big</span><span class="op" id="8223744">.</span><span class="ident" id="8223745">NewInt</span><span class="op" id="8223751">(</span><span class="num" id="8223752">1</span><span class="op" id="8223753">)</span><span class="op" id="8223754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223759">RevocationTime</span><span class="op" id="8223773">:</span>&nbsp;<span class="ident" id="8223775">now</span><span class="op" id="8223778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8223782">}</span><span class="op" id="8223783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8223787">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223792">SerialNumber</span><span class="op" id="8223804">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8223808">big</span><span class="op" id="8223811">.</span><span class="ident" id="8223812">NewInt</span><span class="op" id="8223818">(</span><span class="num" id="8223819">42</span><span class="op" id="8223821">)</span><span class="op" id="8223822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223827">RevocationTime</span><span class="op" id="8223841">:</span>&nbsp;<span class="ident" id="8223843">now</span><span class="op" id="8223846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8223850">}</span><span class="op" id="8223851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8223854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223858">crlBytes</span><span class="op" id="8223866">,</span>&nbsp;<span class="ident" id="8223868">err</span>&nbsp;<span class="op" id="8223872">:=</span>&nbsp;<span class="ident" id="8223875">cert</span><span class="op" id="8223879">.</span><span class="ident" id="8223880">CreateCRL</span><span class="op" id="8223889">(</span><span class="ident" id="8223890">rand</span><span class="op" id="8223894">.</span><span class="ident" id="8223895">Reader</span><span class="op" id="8223901">,</span>&nbsp;<span class="ident" id="8223903">priv</span><span class="op" id="8223907">,</span>&nbsp;<span class="ident" id="8223909">revokedCerts</span><span class="op" id="8223921">,</span>&nbsp;<span class="ident" id="8223923">now</span><span class="op" id="8223926">,</span>&nbsp;<span class="ident" id="8223928">expiry</span><span class="op" id="8223934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8223937">if</span>&nbsp;<span class="ident" id="8223940">err</span>&nbsp;<span class="op" id="8223944">!=</span>&nbsp;<span class="builtintype" id="8223947">nil</span>&nbsp;<span class="op" id="8223951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223955">t</span><span class="op" id="8223956">.</span><span class="ident" id="8223957">Errorf</span><span class="op" id="8223963">(</span><span class="string" id="8223964">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="8223988">,</span>&nbsp;<span class="ident" id="8223990">err</span><span class="op" id="8223993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8223996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224000">_</span><span class="op" id="8224001">,</span>&nbsp;<span class="ident" id="8224003">err</span>&nbsp;<span class="op" id="8224007">=</span>&nbsp;<span class="ident" id="8224009">ParseDERCRL</span><span class="op" id="8224020">(</span><span class="ident" id="8224021">crlBytes</span><span class="op" id="8224029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8224032">if</span>&nbsp;<span class="ident" id="8224035">err</span>&nbsp;<span class="op" id="8224039">!=</span>&nbsp;<span class="builtintype" id="8224042">nil</span>&nbsp;<span class="op" id="8224046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224050">t</span><span class="op" id="8224051">.</span><span class="ident" id="8224052">Errorf</span><span class="op" id="8224058">(</span><span class="string" id="8224059">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="8224084">,</span>&nbsp;<span class="ident" id="8224086">err</span><span class="op" id="8224089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224092">}</span><br>
<span class="lineno"></span><span class="op" id="8224094">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="8224097">func</span>&nbsp;<span class="ident" id="8224102">fromBase64</span><span class="op" id="8224112">(</span><span class="ident" id="8224113">in</span>&nbsp;<span class="builtintype" id="8224116">string</span><span class="op" id="8224122">)</span>&nbsp;<span class="op" id="8224124">[</span><span class="op" id="8224125">]</span><span class="builtintype" id="8224126">byte</span>&nbsp;<span class="op" id="8224131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224134">out</span>&nbsp;<span class="op" id="8224138">:=</span>&nbsp;<span class="builtinfunc" id="8224141">make</span><span class="op" id="8224145">(</span><span class="op" id="8224146">[</span><span class="op" id="8224147">]</span><span class="builtintype" id="8224148">byte</span><span class="op" id="8224152">,</span>&nbsp;<span class="ident" id="8224154">base64</span><span class="op" id="8224160">.</span><span class="ident" id="8224161">StdEncoding</span><span class="op" id="8224172">.</span><span class="ident" id="8224173">DecodedLen</span><span class="op" id="8224183">(</span><span class="builtinfunc" id="8224184">len</span><span class="op" id="8224187">(</span><span class="ident" id="8224188">in</span><span class="op" id="8224190">)</span><span class="op" id="8224191">)</span><span class="op" id="8224192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224195">n</span><span class="op" id="8224196">,</span>&nbsp;<span class="ident" id="8224198">err</span>&nbsp;<span class="op" id="8224202">:=</span>&nbsp;<span class="ident" id="8224205">base64</span><span class="op" id="8224211">.</span><span class="ident" id="8224212">StdEncoding</span><span class="op" id="8224223">.</span><span class="ident" id="8224224">Decode</span><span class="op" id="8224230">(</span><span class="ident" id="8224231">out</span><span class="op" id="8224234">,</span>&nbsp;<span class="op" id="8224236">[</span><span class="op" id="8224237">]</span><span class="builtintype" id="8224238">byte</span><span class="op" id="8224242">(</span><span class="ident" id="8224243">in</span><span class="op" id="8224245">)</span><span class="op" id="8224246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8224249">if</span>&nbsp;<span class="ident" id="8224252">err</span>&nbsp;<span class="op" id="8224256">!=</span>&nbsp;<span class="builtintype" id="8224259">nil</span>&nbsp;<span class="op" id="8224263">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8224267">panic</span><span class="op" id="8224272">(</span><span class="string" id="8224273">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="8224298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8224304">return</span>&nbsp;<span class="ident" id="8224311">out</span><span class="op" id="8224314">[</span><span class="op" id="8224315">:</span><span class="ident" id="8224316">n</span><span class="op" id="8224317">]</span><br>
<span class="lineno"></span><span class="op" id="8224319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="8224322">func</span>&nbsp;<span class="ident" id="8224327">TestParseDERCRL</span><span class="op" id="8224342">(</span><span class="ident" id="8224343">t</span>&nbsp;<span class="op" id="8224345">*</span><span class="ident" id="8224346">testing</span><span class="op" id="8224353">.</span><span class="ident" id="8224354">T</span><span class="op" id="8224355">)</span>&nbsp;<span class="op" id="8224357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224360">derBytes</span>&nbsp;<span class="op" id="8224369">:=</span>&nbsp;<span class="ident" id="8224372">fromBase64</span><span class="op" id="8224382">(</span><span class="ident" id="8224383">derCRLBase64</span><span class="op" id="8224395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224398">certList</span><span class="op" id="8224406">,</span>&nbsp;<span class="ident" id="8224408">err</span>&nbsp;<span class="op" id="8224412">:=</span>&nbsp;<span class="ident" id="8224415">ParseDERCRL</span><span class="op" id="8224426">(</span><span class="ident" id="8224427">derBytes</span><span class="op" id="8224435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8224438">if</span>&nbsp;<span class="ident" id="8224441">err</span>&nbsp;<span class="op" id="8224445">!=</span>&nbsp;<span class="builtintype" id="8224448">nil</span>&nbsp;<span class="op" id="8224452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224456">t</span><span class="op" id="8224457">.</span><span class="ident" id="8224458">Errorf</span><span class="op" id="8224464">(</span><span class="string" id="8224465">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="8224484">,</span>&nbsp;<span class="ident" id="8224486">err</span><span class="op" id="8224489">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8224493">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224504">numCerts</span>&nbsp;<span class="op" id="8224513">:=</span>&nbsp;<span class="builtinfunc" id="8224516">len</span><span class="op" id="8224519">(</span><span class="ident" id="8224520">certList</span><span class="op" id="8224528">.</span><span class="ident" id="8224529">TBSCertList</span><span class="op" id="8224540">.</span><span class="ident" id="8224541">RevokedCertificates</span><span class="op" id="8224560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224563">expected</span>&nbsp;<span class="op" id="8224572">:=</span>&nbsp;<span class="num" id="8224575">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8224579">if</span>&nbsp;<span class="ident" id="8224582">numCerts</span>&nbsp;<span class="op" id="8224591">!=</span>&nbsp;<span class="ident" id="8224594">expected</span>&nbsp;<span class="op" id="8224603">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224607">t</span><span class="op" id="8224608">.</span><span class="ident" id="8224609">Errorf</span><span class="op" id="8224615">(</span><span class="string" id="8224616">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="8224670">,</span>&nbsp;<span class="ident" id="8224672">numCerts</span><span class="op" id="8224680">,</span>&nbsp;<span class="ident" id="8224682">expected</span><span class="op" id="8224690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8224697">if</span>&nbsp;<span class="ident" id="8224700">certList</span><span class="op" id="8224708">.</span><span class="ident" id="8224709">HasExpired</span><span class="op" id="8224719">(</span><span class="ident" id="8224720">time</span><span class="op" id="8224724">.</span><span class="ident" id="8224725">Unix</span><span class="op" id="8224729">(</span><span class="num" id="8224730">1302517272</span><span class="op" id="8224740">,</span>&nbsp;<span class="num" id="8224742">0</span><span class="op" id="8224743">)</span><span class="op" id="8224744">)</span>&nbsp;<span class="op" id="8224746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224750">t</span><span class="op" id="8224751">.</span><span class="ident" id="8224752">Errorf</span><span class="op" id="8224758">(</span><span class="string" id="8224759">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="8224797">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8224804">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="8224863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="8224866">func</span>&nbsp;<span class="ident" id="8224871">TestCRLWithoutExpiry</span><span class="op" id="8224891">(</span><span class="ident" id="8224892">t</span>&nbsp;<span class="op" id="8224894">*</span><span class="ident" id="8224895">testing</span><span class="op" id="8224902">.</span><span class="ident" id="8224903">T</span><span class="op" id="8224904">)</span>&nbsp;<span class="op" id="8224906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224909">derBytes</span>&nbsp;<span class="op" id="8224918">:=</span>&nbsp;<span class="ident" id="8224921">fromBase64</span><span class="op" id="8224931">(</span><span class="string" id="8224932">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="8225226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225229">certList</span><span class="op" id="8225237">,</span>&nbsp;<span class="ident" id="8225239">err</span>&nbsp;<span class="op" id="8225243">:=</span>&nbsp;<span class="ident" id="8225246">ParseDERCRL</span><span class="op" id="8225257">(</span><span class="ident" id="8225258">derBytes</span><span class="op" id="8225266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8225269">if</span>&nbsp;<span class="ident" id="8225272">err</span>&nbsp;<span class="op" id="8225276">!=</span>&nbsp;<span class="builtintype" id="8225279">nil</span>&nbsp;<span class="op" id="8225283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225287">t</span><span class="op" id="8225288">.</span><span class="ident" id="8225289">Fatal</span><span class="op" id="8225294">(</span><span class="ident" id="8225295">err</span><span class="op" id="8225298">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8225304">if</span>&nbsp;<span class="op" id="8225307">!</span><span class="ident" id="8225308">certList</span><span class="op" id="8225316">.</span><span class="ident" id="8225317">TBSCertList</span><span class="op" id="8225328">.</span><span class="ident" id="8225329">NextUpdate</span><span class="op" id="8225339">.</span><span class="ident" id="8225340">IsZero</span><span class="op" id="8225346">(</span><span class="op" id="8225347">)</span>&nbsp;<span class="op" id="8225349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225353">t</span><span class="op" id="8225354">.</span><span class="ident" id="8225355">Errorf</span><span class="op" id="8225361">(</span><span class="string" id="8225362">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="8225396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225399">}</span><br>
<span class="lineno"></span><span class="op" id="8225401">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="8225404">func</span>&nbsp;<span class="ident" id="8225409">TestParsePEMCRL</span><span class="op" id="8225424">(</span><span class="ident" id="8225425">t</span>&nbsp;<span class="op" id="8225427">*</span><span class="ident" id="8225428">testing</span><span class="op" id="8225435">.</span><span class="ident" id="8225436">T</span><span class="op" id="8225437">)</span>&nbsp;<span class="op" id="8225439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225442">pemBytes</span>&nbsp;<span class="op" id="8225451">:=</span>&nbsp;<span class="ident" id="8225454">fromBase64</span><span class="op" id="8225464">(</span><span class="ident" id="8225465">pemCRLBase64</span><span class="op" id="8225477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225480">certList</span><span class="op" id="8225488">,</span>&nbsp;<span class="ident" id="8225490">err</span>&nbsp;<span class="op" id="8225494">:=</span>&nbsp;<span class="ident" id="8225497">ParseCRL</span><span class="op" id="8225505">(</span><span class="ident" id="8225506">pemBytes</span><span class="op" id="8225514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8225517">if</span>&nbsp;<span class="ident" id="8225520">err</span>&nbsp;<span class="op" id="8225524">!=</span>&nbsp;<span class="builtintype" id="8225527">nil</span>&nbsp;<span class="op" id="8225531">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225535">t</span><span class="op" id="8225536">.</span><span class="ident" id="8225537">Errorf</span><span class="op" id="8225543">(</span><span class="string" id="8225544">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="8225563">,</span>&nbsp;<span class="ident" id="8225565">err</span><span class="op" id="8225568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8225572">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225583">numCerts</span>&nbsp;<span class="op" id="8225592">:=</span>&nbsp;<span class="builtinfunc" id="8225595">len</span><span class="op" id="8225598">(</span><span class="ident" id="8225599">certList</span><span class="op" id="8225607">.</span><span class="ident" id="8225608">TBSCertList</span><span class="op" id="8225619">.</span><span class="ident" id="8225620">RevokedCertificates</span><span class="op" id="8225639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225642">expected</span>&nbsp;<span class="op" id="8225651">:=</span>&nbsp;<span class="num" id="8225654">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8225657">if</span>&nbsp;<span class="ident" id="8225660">numCerts</span>&nbsp;<span class="op" id="8225669">!=</span>&nbsp;<span class="ident" id="8225672">expected</span>&nbsp;<span class="op" id="8225681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225685">t</span><span class="op" id="8225686">.</span><span class="ident" id="8225687">Errorf</span><span class="op" id="8225693">(</span><span class="string" id="8225694">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="8225748">,</span>&nbsp;<span class="ident" id="8225750">numCerts</span><span class="op" id="8225758">,</span>&nbsp;<span class="ident" id="8225760">expected</span><span class="op" id="8225768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8225775">if</span>&nbsp;<span class="ident" id="8225778">certList</span><span class="op" id="8225786">.</span><span class="ident" id="8225787">HasExpired</span><span class="op" id="8225797">(</span><span class="ident" id="8225798">time</span><span class="op" id="8225802">.</span><span class="ident" id="8225803">Unix</span><span class="op" id="8225807">(</span><span class="num" id="8225808">1302517272</span><span class="op" id="8225818">,</span>&nbsp;<span class="num" id="8225820">0</span><span class="op" id="8225821">)</span><span class="op" id="8225822">)</span>&nbsp;<span class="op" id="8225824">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225828">t</span><span class="op" id="8225829">.</span><span class="ident" id="8225830">Errorf</span><span class="op" id="8225836">(</span><span class="string" id="8225837">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="8225875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8225882">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="8225941">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="8225944">func</span>&nbsp;<span class="ident" id="8225949">TestImports</span><span class="op" id="8225960">(</span><span class="ident" id="8225961">t</span>&nbsp;<span class="op" id="8225963">*</span><span class="ident" id="8225964">testing</span><span class="op" id="8225971">.</span><span class="ident" id="8225972">T</span><span class="op" id="8225973">)</span>&nbsp;<span class="op" id="8225975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8225978">switch</span>&nbsp;<span class="ident" id="8225985">runtime</span><span class="op" id="8225992">.</span><span class="ident" id="8225993">GOOS</span>&nbsp;<span class="op" id="8225998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8226001">case</span>&nbsp;<span class="string" id="8226006">&#34;android&#34;</span><span class="op" id="8226015">,</span>&nbsp;<span class="string" id="8226017">&#34;nacl&#34;</span><span class="op" id="8226023">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8226027">t</span><span class="op" id="8226028">.</span><span class="ident" id="8226029">Skipf</span><span class="op" id="8226034">(</span><span class="string" id="8226035">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="8226051">,</span>&nbsp;<span class="ident" id="8226053">runtime</span><span class="op" id="8226060">.</span><span class="ident" id="8226061">GOOS</span><span class="op" id="8226065">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8226072">if</span>&nbsp;<span class="ident" id="8226075">err</span>&nbsp;<span class="op" id="8226079">:=</span>&nbsp;<span class="ident" id="8226082">exec</span><span class="op" id="8226086">.</span><span class="ident" id="8226087">Command</span><span class="op" id="8226094">(</span><span class="string" id="8226095">&#34;go&#34;</span><span class="op" id="8226099">,</span>&nbsp;<span class="string" id="8226101">&#34;run&#34;</span><span class="op" id="8226106">,</span>&nbsp;<span class="string" id="8226108">&#34;x509_test_import.go&#34;</span><span class="op" id="8226129">)</span><span class="op" id="8226130">.</span><span class="ident" id="8226131">Run</span><span class="op" id="8226134">(</span><span class="op" id="8226135">)</span><span class="op" id="8226136">;</span>&nbsp;<span class="ident" id="8226138">err</span>&nbsp;<span class="op" id="8226142">!=</span>&nbsp;<span class="builtintype" id="8226145">nil</span>&nbsp;<span class="op" id="8226149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8226153">t</span><span class="op" id="8226154">.</span><span class="ident" id="8226155">Errorf</span><span class="op" id="8226161">(</span><span class="string" id="8226162">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="8226201">,</span>&nbsp;<span class="ident" id="8226203">err</span><span class="op" id="8226206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8226209">}</span><br>
<span class="lineno">750</span><span class="op" id="8226211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8226214">const</span>&nbsp;<span class="ident" id="8226220">derCRLBase64</span>&nbsp;<span class="op" id="8226233">=</span>&nbsp;<span class="string" id="8226235">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8230911">const</span>&nbsp;<span class="ident" id="8230917">pemCRLBase64</span>&nbsp;<span class="op" id="8230930">=</span>&nbsp;<span class="string" id="8230932">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="8231936">func</span>&nbsp;<span class="ident" id="8231941">TestCreateCertificateRequest</span><span class="op" id="8231969">(</span><span class="ident" id="8231970">t</span>&nbsp;<span class="op" id="8231972">*</span><span class="ident" id="8231973">testing</span><span class="op" id="8231980">.</span><span class="ident" id="8231981">T</span><span class="op" id="8231982">)</span>&nbsp;<span class="op" id="8231984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8231987">random</span>&nbsp;<span class="op" id="8231994">:=</span>&nbsp;<span class="ident" id="8231997">rand</span><span class="op" id="8232001">.</span><span class="ident" id="8232002">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232011">block</span><span class="op" id="8232016">,</span>&nbsp;<span class="ident" id="8232018">_</span>&nbsp;<span class="op" id="8232020">:=</span>&nbsp;<span class="ident" id="8232023">pem</span><span class="op" id="8232026">.</span><span class="ident" id="8232027">Decode</span><span class="op" id="8232033">(</span><span class="op" id="8232034">[</span><span class="op" id="8232035">]</span><span class="builtintype" id="8232036">byte</span><span class="op" id="8232040">(</span><span class="ident" id="8232041">pemPrivateKey</span><span class="op" id="8232054">)</span><span class="op" id="8232055">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232058">rsaPriv</span><span class="op" id="8232065">,</span>&nbsp;<span class="ident" id="8232067">err</span>&nbsp;<span class="op" id="8232071">:=</span>&nbsp;<span class="ident" id="8232074">ParsePKCS1PrivateKey</span><span class="op" id="8232094">(</span><span class="ident" id="8232095">block</span><span class="op" id="8232100">.</span><span class="ident" id="8232101">Bytes</span><span class="op" id="8232106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8232109">if</span>&nbsp;<span class="ident" id="8232112">err</span>&nbsp;<span class="op" id="8232116">!=</span>&nbsp;<span class="builtintype" id="8232119">nil</span>&nbsp;<span class="op" id="8232123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232127">t</span><span class="op" id="8232128">.</span><span class="ident" id="8232129">Fatalf</span><span class="op" id="8232135">(</span><span class="string" id="8232136">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8232169">,</span>&nbsp;<span class="ident" id="8232171">err</span><span class="op" id="8232174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8232177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232181">ecdsa256Priv</span><span class="op" id="8232193">,</span>&nbsp;<span class="ident" id="8232195">err</span>&nbsp;<span class="op" id="8232199">:=</span>&nbsp;<span class="ident" id="8232202">ecdsa</span><span class="op" id="8232207">.</span><span class="ident" id="8232208">GenerateKey</span><span class="op" id="8232219">(</span><span class="ident" id="8232220">elliptic</span><span class="op" id="8232228">.</span><span class="ident" id="8232229">P256</span><span class="op" id="8232233">(</span><span class="op" id="8232234">)</span><span class="op" id="8232235">,</span>&nbsp;<span class="ident" id="8232237">rand</span><span class="op" id="8232241">.</span><span class="ident" id="8232242">Reader</span><span class="op" id="8232248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8232251">if</span>&nbsp;<span class="ident" id="8232254">err</span>&nbsp;<span class="op" id="8232258">!=</span>&nbsp;<span class="builtintype" id="8232261">nil</span>&nbsp;<span class="op" id="8232265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232269">t</span><span class="op" id="8232270">.</span><span class="ident" id="8232271">Fatalf</span><span class="op" id="8232277">(</span><span class="string" id="8232278">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8232312">,</span>&nbsp;<span class="ident" id="8232314">err</span><span class="op" id="8232317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8232320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232324">ecdsa384Priv</span><span class="op" id="8232336">,</span>&nbsp;<span class="ident" id="8232338">err</span>&nbsp;<span class="op" id="8232342">:=</span>&nbsp;<span class="ident" id="8232345">ecdsa</span><span class="op" id="8232350">.</span><span class="ident" id="8232351">GenerateKey</span><span class="op" id="8232362">(</span><span class="ident" id="8232363">elliptic</span><span class="op" id="8232371">.</span><span class="ident" id="8232372">P384</span><span class="op" id="8232376">(</span><span class="op" id="8232377">)</span><span class="op" id="8232378">,</span>&nbsp;<span class="ident" id="8232380">rand</span><span class="op" id="8232384">.</span><span class="ident" id="8232385">Reader</span><span class="op" id="8232391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8232394">if</span>&nbsp;<span class="ident" id="8232397">err</span>&nbsp;<span class="op" id="8232401">!=</span>&nbsp;<span class="builtintype" id="8232404">nil</span>&nbsp;<span class="op" id="8232408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232412">t</span><span class="op" id="8232413">.</span><span class="ident" id="8232414">Fatalf</span><span class="op" id="8232420">(</span><span class="string" id="8232421">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8232455">,</span>&nbsp;<span class="ident" id="8232457">err</span><span class="op" id="8232460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8232463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232467">ecdsa521Priv</span><span class="op" id="8232479">,</span>&nbsp;<span class="ident" id="8232481">err</span>&nbsp;<span class="op" id="8232485">:=</span>&nbsp;<span class="ident" id="8232488">ecdsa</span><span class="op" id="8232493">.</span><span class="ident" id="8232494">GenerateKey</span><span class="op" id="8232505">(</span><span class="ident" id="8232506">elliptic</span><span class="op" id="8232514">.</span><span class="ident" id="8232515">P521</span><span class="op" id="8232519">(</span><span class="op" id="8232520">)</span><span class="op" id="8232521">,</span>&nbsp;<span class="ident" id="8232523">rand</span><span class="op" id="8232527">.</span><span class="ident" id="8232528">Reader</span><span class="op" id="8232534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8232537">if</span>&nbsp;<span class="ident" id="8232540">err</span>&nbsp;<span class="op" id="8232544">!=</span>&nbsp;<span class="builtintype" id="8232547">nil</span>&nbsp;<span class="op" id="8232551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232555">t</span><span class="op" id="8232556">.</span><span class="ident" id="8232557">Fatalf</span><span class="op" id="8232563">(</span><span class="string" id="8232564">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8232598">,</span>&nbsp;<span class="ident" id="8232600">err</span><span class="op" id="8232603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8232606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232610">tests</span>&nbsp;<span class="op" id="8232616">:=</span>&nbsp;<span class="op" id="8232619">[</span><span class="op" id="8232620">]</span><span class="keyword" id="8232621">struct</span>&nbsp;<span class="op" id="8232628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232632">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8232640">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232649">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8232657">interface</span><span class="op" id="8232666">{</span><span class="op" id="8232667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232671">sigAlgo</span>&nbsp;<span class="ident" id="8232679">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8232699">}</span><span class="op" id="8232700">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8232704">{</span><span class="string" id="8232705">&#34;RSA&#34;</span><span class="op" id="8232710">,</span>&nbsp;<span class="ident" id="8232712">rsaPriv</span><span class="op" id="8232719">,</span>&nbsp;<span class="ident" id="8232721">SHA1WithRSA</span><span class="op" id="8232732">}</span><span class="op" id="8232733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8232737">{</span><span class="string" id="8232738">&#34;ECDSA-256&#34;</span><span class="op" id="8232749">,</span>&nbsp;<span class="ident" id="8232751">ecdsa256Priv</span><span class="op" id="8232763">,</span>&nbsp;<span class="ident" id="8232765">ECDSAWithSHA1</span><span class="op" id="8232778">}</span><span class="op" id="8232779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8232783">{</span><span class="string" id="8232784">&#34;ECDSA-384&#34;</span><span class="op" id="8232795">,</span>&nbsp;<span class="ident" id="8232797">ecdsa384Priv</span><span class="op" id="8232809">,</span>&nbsp;<span class="ident" id="8232811">ECDSAWithSHA1</span><span class="op" id="8232824">}</span><span class="op" id="8232825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8232829">{</span><span class="string" id="8232830">&#34;ECDSA-521&#34;</span><span class="op" id="8232841">,</span>&nbsp;<span class="ident" id="8232843">ecdsa521Priv</span><span class="op" id="8232855">,</span>&nbsp;<span class="ident" id="8232857">ECDSAWithSHA1</span><span class="op" id="8232870">}</span><span class="op" id="8232871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8232874">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8232878">for</span>&nbsp;<span class="ident" id="8232882">_</span><span class="op" id="8232883">,</span>&nbsp;<span class="ident" id="8232885">test</span>&nbsp;<span class="op" id="8232890">:=</span>&nbsp;<span class="keyword" id="8232893">range</span>&nbsp;<span class="ident" id="8232899">tests</span>&nbsp;<span class="op" id="8232905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232909">template</span>&nbsp;<span class="op" id="8232918">:=</span>&nbsp;<span class="ident" id="8232921">CertificateRequest</span><span class="op" id="8232939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232944">Subject</span><span class="op" id="8232951">:</span>&nbsp;<span class="ident" id="8232953">pkix</span><span class="op" id="8232957">.</span><span class="ident" id="8232958">Name</span><span class="op" id="8232962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8232968">CommonName</span><span class="op" id="8232978">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8232982">&#34;test.example.com&#34;</span><span class="op" id="8233000">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8233006">Organization</span><span class="op" id="8233018">:</span>&nbsp;<span class="op" id="8233020">[</span><span class="op" id="8233021">]</span><span class="builtintype" id="8233022">string</span><span class="op" id="8233028">{</span><span class="string" id="8233029">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8233041">}</span><span class="op" id="8233042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8233047">}</span><span class="op" id="8233048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8233053">SignatureAlgorithm</span><span class="op" id="8233071">:</span>&nbsp;<span class="ident" id="8233073">test</span><span class="op" id="8233077">.</span><span class="ident" id="8233078">sigAlgo</span><span class="op" id="8233085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8233090">DNSNames</span><span class="op" id="8233098">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8233110">[</span><span class="op" id="8233111">]</span><span class="builtintype" id="8233112">string</span><span class="op" id="8233118">{</span><span class="string" id="8233119">&#34;test.example.com&#34;</span><span class="op" id="8233137">}</span><span class="op" id="8233138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8233143">EmailAddresses</span><span class="op" id="8233157">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8233163">[</span><span class="op" id="8233164">]</span><span class="builtintype" id="8233165">string</span><span class="op" id="8233171">{</span><span class="string" id="8233172">&#34;gopher@golang.org&#34;</span><span class="op" id="8233191">}</span><span class="op" id="8233192">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8233197">IPAddresses</span><span class="op" id="8233208">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8233217">[</span><span class="op" id="8233218">]</span><span class="ident" id="8233219">net</span><span class="op" id="8233222">.</span><span class="ident" id="8233223">IP</span><span class="op" id="8233225">{</span><span class="ident" id="8233226">net</span><span class="op" id="8233229">.</span><span class="ident" id="8233230">IPv4</span><span class="op" id="8233234">(</span><span class="num" id="8233235">127</span><span class="op" id="8233238">,</span>&nbsp;<span class="num" id="8233240">0</span><span class="op" id="8233241">,</span>&nbsp;<span class="num" id="8233243">0</span><span class="op" id="8233244">,</span>&nbsp;<span class="num" id="8233246">1</span><span class="op" id="8233247">)</span><span class="op" id="8233248">.</span><span class="ident" id="8233249">To4</span><span class="op" id="8233252">(</span><span class="op" id="8233253">)</span><span class="op" id="8233254">,</span>&nbsp;<span class="ident" id="8233256">net</span><span class="op" id="8233259">.</span><span class="ident" id="8233260">ParseIP</span><span class="op" id="8233267">(</span><span class="string" id="8233268">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="8233290">)</span><span class="op" id="8233291">}</span><span class="op" id="8233292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8233296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8233301">derBytes</span><span class="op" id="8233309">,</span>&nbsp;<span class="ident" id="8233311">err</span>&nbsp;<span class="op" id="8233315">:=</span>&nbsp;<span class="ident" id="8233318">CreateCertificateRequest</span><span class="op" id="8233342">(</span><span class="ident" id="8233343">random</span><span class="op" id="8233349">,</span>&nbsp;<span class="op" id="8233351">&amp;</span><span class="ident" id="8233352">template</span><span class="op" id="8233360">,</span>&nbsp;<span class="ident" id="8233362">test</span><span class="op" id="8233366">.</span><span class="ident" id="8233367">priv</span><span class="op" id="8233371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8233375">if</span>&nbsp;<span class="ident" id="8233378">err</span>&nbsp;<span class="op" id="8233382">!=</span>&nbsp;<span class="builtintype" id="8233385">nil</span>&nbsp;<span class="op" id="8233389">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8233394">t</span><span class="op" id="8233395">.</span><span class="ident" id="8233396">Errorf</span><span class="op" id="8233402">(</span><span class="string" id="8233403">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="8233449">,</span>&nbsp;<span class="ident" id="8233451">test</span><span class="op" id="8233455">.</span><span class="ident" id="8233456">name</span><span class="op" id="8233460">,</span>&nbsp;<span class="ident" id="8233462">err</span><span class="op" id="8233465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8233470">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8233481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8233486">out</span><span class="op" id="8233489">,</span>&nbsp;<span class="ident" id="8233491">err</span>&nbsp;<span class="op" id="8233495">:=</span>&nbsp;<span class="ident" id="8233498">ParseCertificateRequest</span><span class="op" id="8233521">(</span><span class="ident" id="8233522">derBytes</span><span class="op" id="8233530">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8233534">if</span>&nbsp;<span class="ident" id="8233537">err</span>&nbsp;<span class="op" id="8233541">!=</span>&nbsp;<span class="builtintype" id="8233544">nil</span>&nbsp;<span class="op" id="8233548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8233553">t</span><span class="op" id="8233554">.</span><span class="ident" id="8233555">Errorf</span><span class="op" id="8233561">(</span><span class="string" id="8233562">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="8233608">,</span>&nbsp;<span class="ident" id="8233610">test</span><span class="op" id="8233614">.</span><span class="ident" id="8233615">name</span><span class="op" id="8233619">,</span>&nbsp;<span class="ident" id="8233621">err</span><span class="op" id="8233624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8233629">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8233640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8233645">if</span>&nbsp;<span class="ident" id="8233648">out</span><span class="op" id="8233651">.</span><span class="ident" id="8233652">Subject</span><span class="op" id="8233659">.</span><span class="ident" id="8233660">CommonName</span>&nbsp;<span class="op" id="8233671">!=</span>&nbsp;<span class="ident" id="8233674">template</span><span class="op" id="8233682">.</span><span class="ident" id="8233683">Subject</span><span class="op" id="8233690">.</span><span class="ident" id="8233691">CommonName</span>&nbsp;<span class="op" id="8233702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8233707">t</span><span class="op" id="8233708">.</span><span class="ident" id="8233709">Errorf</span><span class="op" id="8233715">(</span><span class="string" id="8233716">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8233793">,</span>&nbsp;<span class="ident" id="8233795">test</span><span class="op" id="8233799">.</span><span class="ident" id="8233800">name</span><span class="op" id="8233804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8233808">}</span>&nbsp;<span class="keyword" id="8233810">else</span>&nbsp;<span class="keyword" id="8233815">if</span>&nbsp;<span class="builtinfunc" id="8233818">len</span><span class="op" id="8233821">(</span><span class="ident" id="8233822">out</span><span class="op" id="8233825">.</span><span class="ident" id="8233826">Subject</span><span class="op" id="8233833">.</span><span class="ident" id="8233834">Organization</span><span class="op" id="8233846">)</span>&nbsp;<span class="op" id="8233848">!=</span>&nbsp;<span class="builtinfunc" id="8233851">len</span><span class="op" id="8233854">(</span><span class="ident" id="8233855">template</span><span class="op" id="8233863">.</span><span class="ident" id="8233864">Subject</span><span class="op" id="8233871">.</span><span class="ident" id="8233872">Organization</span><span class="op" id="8233884">)</span>&nbsp;<span class="op" id="8233886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8233891">t</span><span class="op" id="8233892">.</span><span class="ident" id="8233893">Errorf</span><span class="op" id="8233899">(</span><span class="string" id="8233900">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8233979">,</span>&nbsp;<span class="ident" id="8233981">test</span><span class="op" id="8233985">.</span><span class="ident" id="8233986">name</span><span class="op" id="8233990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8233994">}</span>&nbsp;<span class="keyword" id="8233996">else</span>&nbsp;<span class="keyword" id="8234001">if</span>&nbsp;<span class="builtinfunc" id="8234004">len</span><span class="op" id="8234007">(</span><span class="ident" id="8234008">out</span><span class="op" id="8234011">.</span><span class="ident" id="8234012">DNSNames</span><span class="op" id="8234020">)</span>&nbsp;<span class="op" id="8234022">!=</span>&nbsp;<span class="builtinfunc" id="8234025">len</span><span class="op" id="8234028">(</span><span class="ident" id="8234029">template</span><span class="op" id="8234037">.</span><span class="ident" id="8234038">DNSNames</span><span class="op" id="8234046">)</span>&nbsp;<span class="op" id="8234048">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8234053">t</span><span class="op" id="8234054">.</span><span class="ident" id="8234055">Errorf</span><span class="op" id="8234061">(</span><span class="string" id="8234062">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8234119">,</span>&nbsp;<span class="ident" id="8234121">test</span><span class="op" id="8234125">.</span><span class="ident" id="8234126">name</span><span class="op" id="8234130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8234134">}</span>&nbsp;<span class="keyword" id="8234136">else</span>&nbsp;<span class="keyword" id="8234141">if</span>&nbsp;<span class="builtinfunc" id="8234144">len</span><span class="op" id="8234147">(</span><span class="ident" id="8234148">out</span><span class="op" id="8234151">.</span><span class="ident" id="8234152">EmailAddresses</span><span class="op" id="8234166">)</span>&nbsp;<span class="op" id="8234168">!=</span>&nbsp;<span class="builtinfunc" id="8234171">len</span><span class="op" id="8234174">(</span><span class="ident" id="8234175">template</span><span class="op" id="8234183">.</span><span class="ident" id="8234184">EmailAddresses</span><span class="op" id="8234198">)</span>&nbsp;<span class="op" id="8234200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8234205">t</span><span class="op" id="8234206">.</span><span class="ident" id="8234207">Errorf</span><span class="op" id="8234213">(</span><span class="string" id="8234214">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8234283">,</span>&nbsp;<span class="ident" id="8234285">test</span><span class="op" id="8234289">.</span><span class="ident" id="8234290">name</span><span class="op" id="8234294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8234298">}</span>&nbsp;<span class="keyword" id="8234300">else</span>&nbsp;<span class="keyword" id="8234305">if</span>&nbsp;<span class="builtinfunc" id="8234308">len</span><span class="op" id="8234311">(</span><span class="ident" id="8234312">out</span><span class="op" id="8234315">.</span><span class="ident" id="8234316">IPAddresses</span><span class="op" id="8234327">)</span>&nbsp;<span class="op" id="8234329">!=</span>&nbsp;<span class="builtinfunc" id="8234332">len</span><span class="op" id="8234335">(</span><span class="ident" id="8234336">template</span><span class="op" id="8234344">.</span><span class="ident" id="8234345">IPAddresses</span><span class="op" id="8234356">)</span>&nbsp;<span class="op" id="8234358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8234363">t</span><span class="op" id="8234364">.</span><span class="ident" id="8234365">Errorf</span><span class="op" id="8234371">(</span><span class="string" id="8234372">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8234441">,</span>&nbsp;<span class="ident" id="8234443">test</span><span class="op" id="8234447">.</span><span class="ident" id="8234448">name</span><span class="op" id="8234452">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8234456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8234459">}</span><br>
<span class="lineno"></span><span class="op" id="8234461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8234464">func</span>&nbsp;<span class="ident" id="8234469">marshalAndParseCSR</span><span class="op" id="8234487">(</span><span class="ident" id="8234488">t</span>&nbsp;<span class="op" id="8234490">*</span><span class="ident" id="8234491">testing</span><span class="op" id="8234498">.</span><span class="ident" id="8234499">T</span><span class="op" id="8234500">,</span>&nbsp;<span class="ident" id="8234502">template</span>&nbsp;<span class="op" id="8234511">*</span><span class="ident" id="8234512">CertificateRequest</span><span class="op" id="8234530">)</span>&nbsp;<span class="op" id="8234532">*</span><span class="ident" id="8234533">CertificateRequest</span>&nbsp;<span class="op" id="8234552">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8234555">block</span><span class="op" id="8234560">,</span>&nbsp;<span class="ident" id="8234562">_</span>&nbsp;<span class="op" id="8234564">:=</span>&nbsp;<span class="ident" id="8234567">pem</span><span class="op" id="8234570">.</span><span class="ident" id="8234571">Decode</span><span class="op" id="8234577">(</span><span class="op" id="8234578">[</span><span class="op" id="8234579">]</span><span class="builtintype" id="8234580">byte</span><span class="op" id="8234584">(</span><span class="ident" id="8234585">pemPrivateKey</span><span class="op" id="8234598">)</span><span class="op" id="8234599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8234602">rsaPriv</span><span class="op" id="8234609">,</span>&nbsp;<span class="ident" id="8234611">err</span>&nbsp;<span class="op" id="8234615">:=</span>&nbsp;<span class="ident" id="8234618">ParsePKCS1PrivateKey</span><span class="op" id="8234638">(</span><span class="ident" id="8234639">block</span><span class="op" id="8234644">.</span><span class="ident" id="8234645">Bytes</span><span class="op" id="8234650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8234653">if</span>&nbsp;<span class="ident" id="8234656">err</span>&nbsp;<span class="op" id="8234660">!=</span>&nbsp;<span class="builtintype" id="8234663">nil</span>&nbsp;<span class="op" id="8234667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8234671">t</span><span class="op" id="8234672">.</span><span class="ident" id="8234673">Fatal</span><span class="op" id="8234678">(</span><span class="ident" id="8234679">err</span><span class="op" id="8234682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8234685">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8234689">derBytes</span><span class="op" id="8234697">,</span>&nbsp;<span class="ident" id="8234699">err</span>&nbsp;<span class="op" id="8234703">:=</span>&nbsp;<span class="ident" id="8234706">CreateCertificateRequest</span><span class="op" id="8234730">(</span><span class="ident" id="8234731">rand</span><span class="op" id="8234735">.</span><span class="ident" id="8234736">Reader</span><span class="op" id="8234742">,</span>&nbsp;<span class="ident" id="8234744">template</span><span class="op" id="8234752">,</span>&nbsp;<span class="ident" id="8234754">rsaPriv</span><span class="op" id="8234761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8234764">if</span>&nbsp;<span class="ident" id="8234767">err</span>&nbsp;<span class="op" id="8234771">!=</span>&nbsp;<span class="builtintype" id="8234774">nil</span>&nbsp;<span class="op" id="8234778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8234782">t</span><span class="op" id="8234783">.</span><span class="ident" id="8234784">Fatal</span><span class="op" id="8234789">(</span><span class="ident" id="8234790">err</span><span class="op" id="8234793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8234796">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8234800">csr</span><span class="op" id="8234803">,</span>&nbsp;<span class="ident" id="8234805">err</span>&nbsp;<span class="op" id="8234809">:=</span>&nbsp;<span class="ident" id="8234812">ParseCertificateRequest</span><span class="op" id="8234835">(</span><span class="ident" id="8234836">derBytes</span><span class="op" id="8234844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8234847">if</span>&nbsp;<span class="ident" id="8234850">err</span>&nbsp;<span class="op" id="8234854">!=</span>&nbsp;<span class="builtintype" id="8234857">nil</span>&nbsp;<span class="op" id="8234861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8234865">t</span><span class="op" id="8234866">.</span><span class="ident" id="8234867">Fatal</span><span class="op" id="8234872">(</span><span class="ident" id="8234873">err</span><span class="op" id="8234876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8234879">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8234883">return</span>&nbsp;<span class="ident" id="8234890">csr</span><br>
<span class="lineno"></span><span class="op" id="8234894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8234897">func</span>&nbsp;<span class="ident" id="8234902">TestCertificateRequestOverrides</span><span class="op" id="8234933">(</span><span class="ident" id="8234934">t</span>&nbsp;<span class="op" id="8234936">*</span><span class="ident" id="8234937">testing</span><span class="op" id="8234944">.</span><span class="ident" id="8234945">T</span><span class="op" id="8234946">)</span>&nbsp;<span class="op" id="8234948">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8234951">sanContents</span><span class="op" id="8234962">,</span>&nbsp;<span class="ident" id="8234964">err</span>&nbsp;<span class="op" id="8234968">:=</span>&nbsp;<span class="ident" id="8234971">marshalSANs</span><span class="op" id="8234982">(</span><span class="op" id="8234983">[</span><span class="op" id="8234984">]</span><span class="builtintype" id="8234985">string</span><span class="op" id="8234991">{</span><span class="string" id="8234992">&#34;foo.example.com&#34;</span><span class="op" id="8235009">}</span><span class="op" id="8235010">,</span>&nbsp;<span class="builtintype" id="8235012">nil</span><span class="op" id="8235015">,</span>&nbsp;<span class="builtintype" id="8235017">nil</span><span class="op" id="8235020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8235023">if</span>&nbsp;<span class="ident" id="8235026">err</span>&nbsp;<span class="op" id="8235030">!=</span>&nbsp;<span class="builtintype" id="8235033">nil</span>&nbsp;<span class="op" id="8235037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235041">t</span><span class="op" id="8235042">.</span><span class="ident" id="8235043">Fatal</span><span class="op" id="8235048">(</span><span class="ident" id="8235049">err</span><span class="op" id="8235052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8235055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235059">template</span>&nbsp;<span class="op" id="8235068">:=</span>&nbsp;<span class="ident" id="8235071">CertificateRequest</span><span class="op" id="8235089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235093">Subject</span><span class="op" id="8235100">:</span>&nbsp;<span class="ident" id="8235102">pkix</span><span class="op" id="8235106">.</span><span class="ident" id="8235107">Name</span><span class="op" id="8235111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235116">CommonName</span><span class="op" id="8235126">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8235130">&#34;test.example.com&#34;</span><span class="op" id="8235148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235153">Organization</span><span class="op" id="8235165">:</span>&nbsp;<span class="op" id="8235167">[</span><span class="op" id="8235168">]</span><span class="builtintype" id="8235169">string</span><span class="op" id="8235175">{</span><span class="string" id="8235176">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8235188">}</span><span class="op" id="8235189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8235193">}</span><span class="op" id="8235194">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235198">DNSNames</span><span class="op" id="8235206">:</span>&nbsp;<span class="op" id="8235208">[</span><span class="op" id="8235209">]</span><span class="builtintype" id="8235210">string</span><span class="op" id="8235216">{</span><span class="string" id="8235217">&#34;test.example.com&#34;</span><span class="op" id="8235235">}</span><span class="op" id="8235236">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8235241">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8235306">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235321">ExtraExtensions</span><span class="op" id="8235336">:</span>&nbsp;<span class="op" id="8235338">[</span><span class="op" id="8235339">]</span><span class="ident" id="8235340">pkix</span><span class="op" id="8235344">.</span><span class="ident" id="8235345">Extension</span><span class="op" id="8235354">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8235359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235365">Id</span><span class="op" id="8235367">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235372">oidExtensionSubjectAltName</span><span class="op" id="8235398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235404">Value</span><span class="op" id="8235409">:</span>&nbsp;<span class="ident" id="8235411">sanContents</span><span class="op" id="8235422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8235427">}</span><span class="op" id="8235428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8235432">}</span><span class="op" id="8235433">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8235436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235440">csr</span>&nbsp;<span class="op" id="8235444">:=</span>&nbsp;<span class="ident" id="8235447">marshalAndParseCSR</span><span class="op" id="8235465">(</span><span class="ident" id="8235466">t</span><span class="op" id="8235467">,</span>&nbsp;<span class="op" id="8235469">&amp;</span><span class="ident" id="8235470">template</span><span class="op" id="8235478">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8235482">if</span>&nbsp;<span class="builtinfunc" id="8235485">len</span><span class="op" id="8235488">(</span><span class="ident" id="8235489">csr</span><span class="op" id="8235492">.</span><span class="ident" id="8235493">DNSNames</span><span class="op" id="8235501">)</span>&nbsp;<span class="op" id="8235503">!=</span>&nbsp;<span class="num" id="8235506">1</span>&nbsp;<span class="op" id="8235508">||</span>&nbsp;<span class="ident" id="8235511">csr</span><span class="op" id="8235514">.</span><span class="ident" id="8235515">DNSNames</span><span class="op" id="8235523">[</span><span class="num" id="8235524">0</span><span class="op" id="8235525">]</span>&nbsp;<span class="op" id="8235527">!=</span>&nbsp;<span class="string" id="8235530">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="8235548">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235552">t</span><span class="op" id="8235553">.</span><span class="ident" id="8235554">Errorf</span><span class="op" id="8235560">(</span><span class="string" id="8235561">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="8235608">,</span>&nbsp;<span class="ident" id="8235610">csr</span><span class="op" id="8235613">.</span><span class="ident" id="8235614">DNSNames</span><span class="op" id="8235622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8235625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8235629">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8235697">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8235767">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235803">template</span><span class="op" id="8235811">.</span><span class="ident" id="8235812">Attributes</span>&nbsp;<span class="op" id="8235823">=</span>&nbsp;<span class="op" id="8235825">[</span><span class="op" id="8235826">]</span><span class="ident" id="8235827">pkix</span><span class="op" id="8235831">.</span><span class="ident" id="8235832">AttributeTypeAndValueSET</span><span class="op" id="8235856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8235860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235865">Type</span><span class="op" id="8235869">:</span>&nbsp;<span class="ident" id="8235871">oidExtensionRequest</span><span class="op" id="8235890">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235895">Value</span><span class="op" id="8235900">:</span>&nbsp;<span class="op" id="8235902">[</span><span class="op" id="8235903">]</span><span class="op" id="8235904">[</span><span class="op" id="8235905">]</span><span class="ident" id="8235906">pkix</span><span class="op" id="8235910">.</span><span class="ident" id="8235911">AttributeTypeAndValue</span><span class="op" id="8235932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8235938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8235945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235953">Type</span><span class="op" id="8235957">:</span>&nbsp;&nbsp;<span class="ident" id="8235960">oidExtensionAuthorityInfoAccess</span><span class="op" id="8235991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8235999">Value</span><span class="op" id="8236004">:</span>&nbsp;<span class="op" id="8236006">[</span><span class="op" id="8236007">]</span><span class="builtintype" id="8236008">byte</span><span class="op" id="8236012">(</span><span class="string" id="8236013">&#34;foo&#34;</span><span class="op" id="8236018">)</span><span class="op" id="8236019">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8236026">}</span><span class="op" id="8236027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8236033">}</span><span class="op" id="8236034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8236039">}</span><span class="op" id="8236040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8236044">}</span><span class="op" id="8236045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8236048">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8236052">csr</span>&nbsp;<span class="op" id="8236056">=</span>&nbsp;<span class="ident" id="8236058">marshalAndParseCSR</span><span class="op" id="8236076">(</span><span class="ident" id="8236077">t</span><span class="op" id="8236078">,</span>&nbsp;<span class="op" id="8236080">&amp;</span><span class="ident" id="8236081">template</span><span class="op" id="8236089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8236092">if</span>&nbsp;<span class="ident" id="8236095">l</span>&nbsp;<span class="op" id="8236097">:=</span>&nbsp;<span class="builtinfunc" id="8236100">len</span><span class="op" id="8236103">(</span><span class="ident" id="8236104">csr</span><span class="op" id="8236107">.</span><span class="ident" id="8236108">Attributes</span><span class="op" id="8236118">)</span><span class="op" id="8236119">;</span>&nbsp;<span class="ident" id="8236121">l</span>&nbsp;<span class="op" id="8236123">!=</span>&nbsp;<span class="num" id="8236126">1</span>&nbsp;<span class="op" id="8236128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8236132">t</span><span class="op" id="8236133">.</span><span class="ident" id="8236134">Errorf</span><span class="op" id="8236140">(</span><span class="string" id="8236141">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="8236179">,</span>&nbsp;<span class="ident" id="8236181">l</span><span class="op" id="8236182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8236185">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8236189">if</span>&nbsp;<span class="op" id="8236192">!</span><span class="ident" id="8236193">csr</span><span class="op" id="8236196">.</span><span class="ident" id="8236197">Attributes</span><span class="op" id="8236207">[</span><span class="num" id="8236208">0</span><span class="op" id="8236209">]</span><span class="op" id="8236210">.</span><span class="ident" id="8236211">Type</span><span class="op" id="8236215">.</span><span class="ident" id="8236216">Equal</span><span class="op" id="8236221">(</span><span class="ident" id="8236222">oidExtensionRequest</span><span class="op" id="8236241">)</span>&nbsp;<span class="op" id="8236243">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8236248">len</span><span class="op" id="8236251">(</span><span class="ident" id="8236252">csr</span><span class="op" id="8236255">.</span><span class="ident" id="8236256">Attributes</span><span class="op" id="8236266">[</span><span class="num" id="8236267">0</span><span class="op" id="8236268">]</span><span class="op" id="8236269">.</span><span class="ident" id="8236270">Value</span><span class="op" id="8236275">)</span>&nbsp;<span class="op" id="8236277">!=</span>&nbsp;<span class="num" id="8236280">1</span>&nbsp;<span class="op" id="8236282">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8236287">len</span><span class="op" id="8236290">(</span><span class="ident" id="8236291">csr</span><span class="op" id="8236294">.</span><span class="ident" id="8236295">Attributes</span><span class="op" id="8236305">[</span><span class="num" id="8236306">0</span><span class="op" id="8236307">]</span><span class="op" id="8236308">.</span><span class="ident" id="8236309">Value</span><span class="op" id="8236314">[</span><span class="num" id="8236315">0</span><span class="op" id="8236316">]</span><span class="op" id="8236317">)</span>&nbsp;<span class="op" id="8236319">!=</span>&nbsp;<span class="num" id="8236322">2</span>&nbsp;<span class="op" id="8236324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8236328">t</span><span class="op" id="8236329">.</span><span class="ident" id="8236330">Errorf</span><span class="op" id="8236336">(</span><span class="string" id="8236337">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="8236360">,</span>&nbsp;<span class="ident" id="8236362">csr</span><span class="op" id="8236365">.</span><span class="ident" id="8236366">Attributes</span><span class="op" id="8236376">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8236379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8236383">sanContents2</span><span class="op" id="8236395">,</span>&nbsp;<span class="ident" id="8236397">err</span>&nbsp;<span class="op" id="8236401">:=</span>&nbsp;<span class="ident" id="8236404">marshalSANs</span><span class="op" id="8236415">(</span><span class="op" id="8236416">[</span><span class="op" id="8236417">]</span><span class="builtintype" id="8236418">string</span><span class="op" id="8236424">{</span><span class="string" id="8236425">&#34;foo2.example.com&#34;</span><span class="op" id="8236443">}</span><span class="op" id="8236444">,</span>&nbsp;<span class="builtintype" id="8236446">nil</span><span class="op" id="8236449">,</span>&nbsp;<span class="builtintype" id="8236451">nil</span><span class="op" id="8236454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8236457">if</span>&nbsp;<span class="ident" id="8236460">err</span>&nbsp;<span class="op" id="8236464">!=</span>&nbsp;<span class="builtintype" id="8236467">nil</span>&nbsp;<span class="op" id="8236471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8236475">t</span><span class="op" id="8236476">.</span><span class="ident" id="8236477">Fatal</span><span class="op" id="8236482">(</span><span class="ident" id="8236483">err</span><span class="op" id="8236486">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8236489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8236493">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8236564">template</span><span class="op" id="8236572">.</span><span class="ident" id="8236573">Attributes</span><span class="op" id="8236583">[</span><span class="num" id="8236584">0</span><span class="op" id="8236585">]</span><span class="op" id="8236586">.</span><span class="ident" id="8236587">Value</span><span class="op" id="8236592">[</span><span class="num" id="8236593">0</span><span class="op" id="8236594">]</span>&nbsp;<span class="op" id="8236596">=</span>&nbsp;<span class="builtinfunc" id="8236598">append</span><span class="op" id="8236604">(</span><span class="ident" id="8236605">template</span><span class="op" id="8236613">.</span><span class="ident" id="8236614">Attributes</span><span class="op" id="8236624">[</span><span class="num" id="8236625">0</span><span class="op" id="8236626">]</span><span class="op" id="8236627">.</span><span class="ident" id="8236628">Value</span><span class="op" id="8236633">[</span><span class="num" id="8236634">0</span><span class="op" id="8236635">]</span><span class="op" id="8236636">,</span>&nbsp;<span class="ident" id="8236638">pkix</span><span class="op" id="8236642">.</span><span class="ident" id="8236643">AttributeTypeAndValue</span><span class="op" id="8236664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8236668">Type</span><span class="op" id="8236672">:</span>&nbsp;&nbsp;<span class="ident" id="8236675">oidExtensionSubjectAltName</span><span class="op" id="8236701">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8236705">Value</span><span class="op" id="8236710">:</span>&nbsp;<span class="ident" id="8236712">sanContents2</span><span class="op" id="8236724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8236727">}</span><span class="op" id="8236728">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8236732">csr</span>&nbsp;<span class="op" id="8236736">=</span>&nbsp;<span class="ident" id="8236738">marshalAndParseCSR</span><span class="op" id="8236756">(</span><span class="ident" id="8236757">t</span><span class="op" id="8236758">,</span>&nbsp;<span class="op" id="8236760">&amp;</span><span class="ident" id="8236761">template</span><span class="op" id="8236769">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8236773">if</span>&nbsp;<span class="builtinfunc" id="8236776">len</span><span class="op" id="8236779">(</span><span class="ident" id="8236780">csr</span><span class="op" id="8236783">.</span><span class="ident" id="8236784">DNSNames</span><span class="op" id="8236792">)</span>&nbsp;<span class="op" id="8236794">!=</span>&nbsp;<span class="num" id="8236797">1</span>&nbsp;<span class="op" id="8236799">||</span>&nbsp;<span class="ident" id="8236802">csr</span><span class="op" id="8236805">.</span><span class="ident" id="8236806">DNSNames</span><span class="op" id="8236814">[</span><span class="num" id="8236815">0</span><span class="op" id="8236816">]</span>&nbsp;<span class="op" id="8236818">!=</span>&nbsp;<span class="string" id="8236821">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="8236840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8236844">t</span><span class="op" id="8236845">.</span><span class="ident" id="8236846">Errorf</span><span class="op" id="8236852">(</span><span class="string" id="8236853">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="8236908">,</span>&nbsp;<span class="ident" id="8236910">csr</span><span class="op" id="8236913">.</span><span class="ident" id="8236914">DNSNames</span><span class="op" id="8236922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8236925">}</span><br>
<span class="lineno"></span><span class="op" id="8236927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="8236930">func</span>&nbsp;<span class="ident" id="8236935">TestParseCertificateRequest</span><span class="op" id="8236962">(</span><span class="ident" id="8236963">t</span>&nbsp;<span class="op" id="8236965">*</span><span class="ident" id="8236966">testing</span><span class="op" id="8236973">.</span><span class="ident" id="8236974">T</span><span class="op" id="8236975">)</span>&nbsp;<span class="op" id="8236977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8236980">csrBytes</span>&nbsp;<span class="op" id="8236989">:=</span>&nbsp;<span class="ident" id="8236992">fromBase64</span><span class="op" id="8237002">(</span><span class="ident" id="8237003">csrBase64</span><span class="op" id="8237012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8237015">csr</span><span class="op" id="8237018">,</span>&nbsp;<span class="ident" id="8237020">err</span>&nbsp;<span class="op" id="8237024">:=</span>&nbsp;<span class="ident" id="8237027">ParseCertificateRequest</span><span class="op" id="8237050">(</span><span class="ident" id="8237051">csrBytes</span><span class="op" id="8237059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8237062">if</span>&nbsp;<span class="ident" id="8237065">err</span>&nbsp;<span class="op" id="8237069">!=</span>&nbsp;<span class="builtintype" id="8237072">nil</span>&nbsp;<span class="op" id="8237076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8237080">t</span><span class="op" id="8237081">.</span><span class="ident" id="8237082">Fatalf</span><span class="op" id="8237088">(</span><span class="string" id="8237089">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="8237114">,</span>&nbsp;<span class="ident" id="8237116">err</span><span class="op" id="8237119">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8237122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8237126">if</span>&nbsp;<span class="builtinfunc" id="8237129">len</span><span class="op" id="8237132">(</span><span class="ident" id="8237133">csr</span><span class="op" id="8237136">.</span><span class="ident" id="8237137">EmailAddresses</span><span class="op" id="8237151">)</span>&nbsp;<span class="op" id="8237153">!=</span>&nbsp;<span class="num" id="8237156">1</span>&nbsp;<span class="op" id="8237158">||</span>&nbsp;<span class="ident" id="8237161">csr</span><span class="op" id="8237164">.</span><span class="ident" id="8237165">EmailAddresses</span><span class="op" id="8237179">[</span><span class="num" id="8237180">0</span><span class="op" id="8237181">]</span>&nbsp;<span class="op" id="8237183">!=</span>&nbsp;<span class="string" id="8237186">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="8237206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8237210">t</span><span class="op" id="8237211">.</span><span class="ident" id="8237212">Errorf</span><span class="op" id="8237218">(</span><span class="string" id="8237219">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="8237256">,</span>&nbsp;<span class="ident" id="8237258">csr</span><span class="op" id="8237261">.</span><span class="ident" id="8237262">EmailAddresses</span><span class="op" id="8237276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8237279">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8237283">if</span>&nbsp;<span class="builtinfunc" id="8237286">len</span><span class="op" id="8237289">(</span><span class="ident" id="8237290">csr</span><span class="op" id="8237293">.</span><span class="ident" id="8237294">DNSNames</span><span class="op" id="8237302">)</span>&nbsp;<span class="op" id="8237304">!=</span>&nbsp;<span class="num" id="8237307">1</span>&nbsp;<span class="op" id="8237309">||</span>&nbsp;<span class="ident" id="8237312">csr</span><span class="op" id="8237315">.</span><span class="ident" id="8237316">DNSNames</span><span class="op" id="8237324">[</span><span class="num" id="8237325">0</span><span class="op" id="8237326">]</span>&nbsp;<span class="op" id="8237328">!=</span>&nbsp;<span class="string" id="8237331">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="8237350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8237354">t</span><span class="op" id="8237355">.</span><span class="ident" id="8237356">Errorf</span><span class="op" id="8237362">(</span><span class="string" id="8237363">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="8237394">,</span>&nbsp;<span class="ident" id="8237396">csr</span><span class="op" id="8237399">.</span><span class="ident" id="8237400">DNSNames</span><span class="op" id="8237408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8237411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8237415">if</span>&nbsp;<span class="builtinfunc" id="8237418">len</span><span class="op" id="8237421">(</span><span class="ident" id="8237422">csr</span><span class="op" id="8237425">.</span><span class="ident" id="8237426">Subject</span><span class="op" id="8237433">.</span><span class="ident" id="8237434">Country</span><span class="op" id="8237441">)</span>&nbsp;<span class="op" id="8237443">!=</span>&nbsp;<span class="num" id="8237446">1</span>&nbsp;<span class="op" id="8237448">||</span>&nbsp;<span class="ident" id="8237451">csr</span><span class="op" id="8237454">.</span><span class="ident" id="8237455">Subject</span><span class="op" id="8237462">.</span><span class="ident" id="8237463">Country</span><span class="op" id="8237470">[</span><span class="num" id="8237471">0</span><span class="op" id="8237472">]</span>&nbsp;<span class="op" id="8237474">!=</span>&nbsp;<span class="string" id="8237477">&#34;AU&#34;</span>&nbsp;<span class="op" id="8237482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8237486">t</span><span class="op" id="8237487">.</span><span class="ident" id="8237488">Errorf</span><span class="op" id="8237494">(</span><span class="string" id="8237495">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8237523">,</span>&nbsp;<span class="ident" id="8237525">csr</span><span class="op" id="8237528">.</span><span class="ident" id="8237529">Subject</span><span class="op" id="8237536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8237539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8237543">found</span>&nbsp;<span class="op" id="8237549">:=</span>&nbsp;<span class="builtintype" id="8237552">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8237559">for</span>&nbsp;<span class="ident" id="8237563">_</span><span class="op" id="8237564">,</span>&nbsp;<span class="ident" id="8237566">e</span>&nbsp;<span class="op" id="8237568">:=</span>&nbsp;<span class="keyword" id="8237571">range</span>&nbsp;<span class="ident" id="8237577">csr</span><span class="op" id="8237580">.</span><span class="ident" id="8237581">Extensions</span>&nbsp;<span class="op" id="8237592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8237596">if</span>&nbsp;<span class="ident" id="8237599">e</span><span class="op" id="8237600">.</span><span class="ident" id="8237601">Id</span><span class="op" id="8237603">.</span><span class="ident" id="8237604">Equal</span><span class="op" id="8237609">(</span><span class="ident" id="8237610">oidExtensionBasicConstraints</span><span class="op" id="8237638">)</span>&nbsp;<span class="op" id="8237640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8237645">found</span>&nbsp;<span class="op" id="8237651">=</span>&nbsp;<span class="builtintype" id="8237653">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8237661">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8237669">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8237672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8237675">if</span>&nbsp;<span class="op" id="8237678">!</span><span class="ident" id="8237679">found</span>&nbsp;<span class="op" id="8237685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8237689">t</span><span class="op" id="8237690">.</span><span class="ident" id="8237691">Errorf</span><span class="op" id="8237697">(</span><span class="string" id="8237698">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="8237744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8237747">}</span><br>
<span class="lineno"></span><span class="op" id="8237749">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="8237752">func</span>&nbsp;<span class="ident" id="8237757">TestMaxPathLen</span><span class="op" id="8237771">(</span><span class="ident" id="8237772">t</span>&nbsp;<span class="op" id="8237774">*</span><span class="ident" id="8237775">testing</span><span class="op" id="8237782">.</span><span class="ident" id="8237783">T</span><span class="op" id="8237784">)</span>&nbsp;<span class="op" id="8237786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8237789">block</span><span class="op" id="8237794">,</span>&nbsp;<span class="ident" id="8237796">_</span>&nbsp;<span class="op" id="8237798">:=</span>&nbsp;<span class="ident" id="8237801">pem</span><span class="op" id="8237804">.</span><span class="ident" id="8237805">Decode</span><span class="op" id="8237811">(</span><span class="op" id="8237812">[</span><span class="op" id="8237813">]</span><span class="builtintype" id="8237814">byte</span><span class="op" id="8237818">(</span><span class="ident" id="8237819">pemPrivateKey</span><span class="op" id="8237832">)</span><span class="op" id="8237833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8237836">rsaPriv</span><span class="op" id="8237843">,</span>&nbsp;<span class="ident" id="8237845">err</span>&nbsp;<span class="op" id="8237849">:=</span>&nbsp;<span class="ident" id="8237852">ParsePKCS1PrivateKey</span><span class="op" id="8237872">(</span><span class="ident" id="8237873">block</span><span class="op" id="8237878">.</span><span class="ident" id="8237879">Bytes</span><span class="op" id="8237884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8237887">if</span>&nbsp;<span class="ident" id="8237890">err</span>&nbsp;<span class="op" id="8237894">!=</span>&nbsp;<span class="builtintype" id="8237897">nil</span>&nbsp;<span class="op" id="8237901">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8237905">t</span><span class="op" id="8237906">.</span><span class="ident" id="8237907">Fatalf</span><span class="op" id="8237913">(</span><span class="string" id="8237914">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8237947">,</span>&nbsp;<span class="ident" id="8237949">err</span><span class="op" id="8237952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8237955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8237959">template</span>&nbsp;<span class="op" id="8237968">:=</span>&nbsp;<span class="op" id="8237971">&amp;</span><span class="ident" id="8237972">Certificate</span><span class="op" id="8237983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8237987">SerialNumber</span><span class="op" id="8237999">:</span>&nbsp;<span class="ident" id="8238001">big</span><span class="op" id="8238004">.</span><span class="ident" id="8238005">NewInt</span><span class="op" id="8238011">(</span><span class="num" id="8238012">1</span><span class="op" id="8238013">)</span><span class="op" id="8238014">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238018">Subject</span><span class="op" id="8238025">:</span>&nbsp;<span class="ident" id="8238027">pkix</span><span class="op" id="8238031">.</span><span class="ident" id="8238032">Name</span><span class="op" id="8238036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238041">CommonName</span><span class="op" id="8238051">:</span>&nbsp;<span class="string" id="8238053">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8238065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8238069">}</span><span class="op" id="8238070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238074">NotBefore</span><span class="op" id="8238083">:</span>&nbsp;<span class="ident" id="8238085">time</span><span class="op" id="8238089">.</span><span class="ident" id="8238090">Unix</span><span class="op" id="8238094">(</span><span class="num" id="8238095">1000</span><span class="op" id="8238099">,</span>&nbsp;<span class="num" id="8238101">0</span><span class="op" id="8238102">)</span><span class="op" id="8238103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238107">NotAfter</span><span class="op" id="8238115">:</span>&nbsp;&nbsp;<span class="ident" id="8238118">time</span><span class="op" id="8238122">.</span><span class="ident" id="8238123">Unix</span><span class="op" id="8238127">(</span><span class="num" id="8238128">100000</span><span class="op" id="8238134">,</span>&nbsp;<span class="num" id="8238136">0</span><span class="op" id="8238137">)</span><span class="op" id="8238138">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238143">BasicConstraintsValid</span><span class="op" id="8238164">:</span>&nbsp;<span class="builtintype" id="8238166">true</span><span class="op" id="8238170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238174">IsCA</span><span class="op" id="8238178">:</span>&nbsp;<span class="builtintype" id="8238180">true</span><span class="op" id="8238184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8238187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238191">serialiseAndParse</span>&nbsp;<span class="op" id="8238209">:=</span>&nbsp;<span class="keyword" id="8238212">func</span><span class="op" id="8238216">(</span><span class="ident" id="8238217">template</span>&nbsp;<span class="op" id="8238226">*</span><span class="ident" id="8238227">Certificate</span><span class="op" id="8238238">)</span>&nbsp;<span class="op" id="8238240">*</span><span class="ident" id="8238241">Certificate</span>&nbsp;<span class="op" id="8238253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238257">derBytes</span><span class="op" id="8238265">,</span>&nbsp;<span class="ident" id="8238267">err</span>&nbsp;<span class="op" id="8238271">:=</span>&nbsp;<span class="ident" id="8238274">CreateCertificate</span><span class="op" id="8238291">(</span><span class="ident" id="8238292">rand</span><span class="op" id="8238296">.</span><span class="ident" id="8238297">Reader</span><span class="op" id="8238303">,</span>&nbsp;<span class="ident" id="8238305">template</span><span class="op" id="8238313">,</span>&nbsp;<span class="ident" id="8238315">template</span><span class="op" id="8238323">,</span>&nbsp;<span class="op" id="8238325">&amp;</span><span class="ident" id="8238326">rsaPriv</span><span class="op" id="8238333">.</span><span class="ident" id="8238334">PublicKey</span><span class="op" id="8238343">,</span>&nbsp;<span class="ident" id="8238345">rsaPriv</span><span class="op" id="8238352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8238356">if</span>&nbsp;<span class="ident" id="8238359">err</span>&nbsp;<span class="op" id="8238363">!=</span>&nbsp;<span class="builtintype" id="8238366">nil</span>&nbsp;<span class="op" id="8238370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238375">t</span><span class="op" id="8238376">.</span><span class="ident" id="8238377">Fatalf</span><span class="op" id="8238383">(</span><span class="string" id="8238384">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8238418">,</span>&nbsp;<span class="ident" id="8238420">err</span><span class="op" id="8238423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8238428">return</span>&nbsp;<span class="builtintype" id="8238435">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8238441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238446">cert</span><span class="op" id="8238450">,</span>&nbsp;<span class="ident" id="8238452">err</span>&nbsp;<span class="op" id="8238456">:=</span>&nbsp;<span class="ident" id="8238459">ParseCertificate</span><span class="op" id="8238475">(</span><span class="ident" id="8238476">derBytes</span><span class="op" id="8238484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8238488">if</span>&nbsp;<span class="ident" id="8238491">err</span>&nbsp;<span class="op" id="8238495">!=</span>&nbsp;<span class="builtintype" id="8238498">nil</span>&nbsp;<span class="op" id="8238502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238507">t</span><span class="op" id="8238508">.</span><span class="ident" id="8238509">Fatalf</span><span class="op" id="8238515">(</span><span class="string" id="8238516">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8238549">,</span>&nbsp;<span class="ident" id="8238551">err</span><span class="op" id="8238554">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8238559">return</span>&nbsp;<span class="builtintype" id="8238566">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8238572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8238577">return</span>&nbsp;<span class="ident" id="8238584">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8238590">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238594">cert1</span>&nbsp;<span class="op" id="8238600">:=</span>&nbsp;<span class="ident" id="8238603">serialiseAndParse</span><span class="op" id="8238620">(</span><span class="ident" id="8238621">template</span><span class="op" id="8238629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8238632">if</span>&nbsp;<span class="ident" id="8238635">m</span>&nbsp;<span class="op" id="8238637">:=</span>&nbsp;<span class="ident" id="8238640">cert1</span><span class="op" id="8238645">.</span><span class="ident" id="8238646">MaxPathLen</span><span class="op" id="8238656">;</span>&nbsp;<span class="ident" id="8238658">m</span>&nbsp;<span class="op" id="8238660">!=</span>&nbsp;<span class="op" id="8238663">-</span><span class="num" id="8238664">1</span>&nbsp;<span class="op" id="8238666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238670">t</span><span class="op" id="8238671">.</span><span class="ident" id="8238672">Errorf</span><span class="op" id="8238678">(</span><span class="string" id="8238679">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8238728">,</span>&nbsp;<span class="ident" id="8238730">m</span><span class="op" id="8238731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8238734">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8238737">if</span>&nbsp;<span class="ident" id="8238740">cert1</span><span class="op" id="8238745">.</span><span class="ident" id="8238746">MaxPathLenZero</span>&nbsp;<span class="op" id="8238761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238765">t</span><span class="op" id="8238766">.</span><span class="ident" id="8238767">Errorf</span><span class="op" id="8238773">(</span><span class="string" id="8238774">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="8238822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8238825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238829">template</span><span class="op" id="8238837">.</span><span class="ident" id="8238838">MaxPathLen</span>&nbsp;<span class="op" id="8238849">=</span>&nbsp;<span class="num" id="8238851">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238854">cert2</span>&nbsp;<span class="op" id="8238860">:=</span>&nbsp;<span class="ident" id="8238863">serialiseAndParse</span><span class="op" id="8238880">(</span><span class="ident" id="8238881">template</span><span class="op" id="8238889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8238892">if</span>&nbsp;<span class="ident" id="8238895">m</span>&nbsp;<span class="op" id="8238897">:=</span>&nbsp;<span class="ident" id="8238900">cert2</span><span class="op" id="8238905">.</span><span class="ident" id="8238906">MaxPathLen</span><span class="op" id="8238916">;</span>&nbsp;<span class="ident" id="8238918">m</span>&nbsp;<span class="op" id="8238920">!=</span>&nbsp;<span class="num" id="8238923">1</span>&nbsp;<span class="op" id="8238925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8238929">t</span><span class="op" id="8238930">.</span><span class="ident" id="8238931">Errorf</span><span class="op" id="8238937">(</span><span class="string" id="8238938">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="8238988">,</span>&nbsp;<span class="ident" id="8238990">m</span><span class="op" id="8238991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8238994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8238997">if</span>&nbsp;<span class="ident" id="8239000">cert2</span><span class="op" id="8239005">.</span><span class="ident" id="8239006">MaxPathLenZero</span>&nbsp;<span class="op" id="8239021">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8239025">t</span><span class="op" id="8239026">.</span><span class="ident" id="8239027">Errorf</span><span class="op" id="8239033">(</span><span class="string" id="8239034">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="8239081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8239084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8239088">template</span><span class="op" id="8239096">.</span><span class="ident" id="8239097">MaxPathLen</span>&nbsp;<span class="op" id="8239108">=</span>&nbsp;<span class="num" id="8239110">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8239113">template</span><span class="op" id="8239121">.</span><span class="ident" id="8239122">MaxPathLenZero</span>&nbsp;<span class="op" id="8239137">=</span>&nbsp;<span class="builtintype" id="8239139">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8239145">cert3</span>&nbsp;<span class="op" id="8239151">:=</span>&nbsp;<span class="ident" id="8239154">serialiseAndParse</span><span class="op" id="8239171">(</span><span class="ident" id="8239172">template</span><span class="op" id="8239180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8239183">if</span>&nbsp;<span class="ident" id="8239186">m</span>&nbsp;<span class="op" id="8239188">:=</span>&nbsp;<span class="ident" id="8239191">cert3</span><span class="op" id="8239196">.</span><span class="ident" id="8239197">MaxPathLen</span><span class="op" id="8239207">;</span>&nbsp;<span class="ident" id="8239209">m</span>&nbsp;<span class="op" id="8239211">!=</span>&nbsp;<span class="num" id="8239214">0</span>&nbsp;<span class="op" id="8239216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8239220">t</span><span class="op" id="8239221">.</span><span class="ident" id="8239222">Errorf</span><span class="op" id="8239228">(</span><span class="string" id="8239229">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8239273">,</span>&nbsp;<span class="ident" id="8239275">m</span><span class="op" id="8239276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8239279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8239282">if</span>&nbsp;<span class="op" id="8239285">!</span><span class="ident" id="8239286">cert3</span><span class="op" id="8239291">.</span><span class="ident" id="8239292">MaxPathLenZero</span>&nbsp;<span class="op" id="8239307">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8239311">t</span><span class="op" id="8239312">.</span><span class="ident" id="8239313">Errorf</span><span class="op" id="8239319">(</span><span class="string" id="8239320">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="8239380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8239383">}</span><br>
<span class="lineno"></span><span class="op" id="8239385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8239388">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="8239428">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="8239529">//</span><br>
<span class="lineno"></span><span class="comment" id="8239532">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="8239582">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="8239598">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="8239631">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="8239697">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="8239764">const</span>&nbsp;<span class="ident" id="8239770">csrBase64</span>&nbsp;<span class="op" id="8239780">=</span>&nbsp;<span class="string" id="8239782">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>
</body>
</html>
