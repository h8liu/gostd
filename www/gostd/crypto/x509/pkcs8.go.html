<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html" class="current">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4359458">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4359513">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4359567">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4359618">package</span>&nbsp;<span class="ident" id="4359626">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4359632">import</span>&nbsp;<span class="op" id="4359639">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4359642">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4359662">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4359679">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4359689">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="4359695">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4359698">//&nbsp;pkcs8&nbsp;reflects&nbsp;an&nbsp;ASN.1,&nbsp;PKCS#8&nbsp;PrivateKey.&nbsp;See</span><br>
<span class="lineno">15</span><span class="comment" id="4359749">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-8/pkcs-8v1_2.asn</span><br>
<span class="lineno"></span><span class="comment" id="4359809">//&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4359825">type</span>&nbsp;<span class="ident" id="4359830">pkcs8</span>&nbsp;<span class="keyword" id="4359836">struct</span>&nbsp;<span class="op" id="4359843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359846">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4359857">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359862">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359873">pkix</span><span class="op" id="4359877">.</span><span class="ident" id="4359878">AlgorithmIdentifier</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359899">PrivateKey</span>&nbsp;<span class="op" id="4359910">[</span><span class="op" id="4359911">]</span><span class="builtintype" id="4359912">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4359918">//&nbsp;optional&nbsp;attributes&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="op" id="4359950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4359953">//&nbsp;ParsePKCS8PrivateKey&nbsp;parses&nbsp;an&nbsp;unencrypted,&nbsp;PKCS#8&nbsp;private&nbsp;key.&nbsp;See</span><br>
<span class="lineno">25</span><span class="comment" id="4360024">//&nbsp;http://www.rsa.com/rsalabs/node.asp?id=2130&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4360084">func</span>&nbsp;<span class="ident" id="4360089">ParsePKCS8PrivateKey</span><span class="op" id="4360109">(</span><span class="ident" id="4360110">der</span>&nbsp;<span class="op" id="4360114">[</span><span class="op" id="4360115">]</span><span class="builtintype" id="4360116">byte</span><span class="op" id="4360120">)</span>&nbsp;<span class="op" id="4360122">(</span><span class="ident" id="4360123">key</span>&nbsp;<span class="keyword" id="4360127">interface</span><span class="op" id="4360136">{</span><span class="op" id="4360137">}</span><span class="op" id="4360138">,</span>&nbsp;<span class="ident" id="4360140">err</span>&nbsp;<span class="builtintype" id="4360144">error</span><span class="op" id="4360149">)</span>&nbsp;<span class="op" id="4360151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360154">var</span>&nbsp;<span class="ident" id="4360158">privKey</span>&nbsp;<span class="ident" id="4360166">pkcs8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360173">if</span>&nbsp;<span class="ident" id="4360176">_</span><span class="op" id="4360177">,</span>&nbsp;<span class="ident" id="4360179">err</span>&nbsp;<span class="op" id="4360183">:=</span>&nbsp;<span class="ident" id="4360186">asn1</span><span class="op" id="4360190">.</span><span class="ident" id="4360191">Unmarshal</span><span class="op" id="4360200">(</span><span class="ident" id="4360201">der</span><span class="op" id="4360204">,</span>&nbsp;<span class="op" id="4360206">&amp;</span><span class="ident" id="4360207">privKey</span><span class="op" id="4360214">)</span><span class="op" id="4360215">;</span>&nbsp;<span class="ident" id="4360217">err</span>&nbsp;<span class="op" id="4360221">!=</span>&nbsp;<span class="builtintype" id="4360224">nil</span>&nbsp;<span class="op" id="4360228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360232">return</span>&nbsp;<span class="builtintype" id="4360239">nil</span><span class="op" id="4360242">,</span>&nbsp;<span class="ident" id="4360244">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4360249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360252">switch</span>&nbsp;<span class="op" id="4360259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360262">case</span>&nbsp;<span class="ident" id="4360267">privKey</span><span class="op" id="4360274">.</span><span class="ident" id="4360275">Algo</span><span class="op" id="4360279">.</span><span class="ident" id="4360280">Algorithm</span><span class="op" id="4360289">.</span><span class="ident" id="4360290">Equal</span><span class="op" id="4360295">(</span><span class="ident" id="4360296">oidPublicKeyRSA</span><span class="op" id="4360311">)</span><span class="op" id="4360312">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4360316">key</span><span class="op" id="4360319">,</span>&nbsp;<span class="ident" id="4360321">err</span>&nbsp;<span class="op" id="4360325">=</span>&nbsp;<span class="ident" id="4360327">ParsePKCS1PrivateKey</span><span class="op" id="4360347">(</span><span class="ident" id="4360348">privKey</span><span class="op" id="4360355">.</span><span class="ident" id="4360356">PrivateKey</span><span class="op" id="4360366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360370">if</span>&nbsp;<span class="ident" id="4360373">err</span>&nbsp;<span class="op" id="4360377">!=</span>&nbsp;<span class="builtintype" id="4360380">nil</span>&nbsp;<span class="op" id="4360384">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360389">return</span>&nbsp;<span class="builtintype" id="4360396">nil</span><span class="op" id="4360399">,</span>&nbsp;<span class="ident" id="4360401">errors</span><span class="op" id="4360407">.</span><span class="ident" id="4360408">New</span><span class="op" id="4360411">(</span><span class="string" id="4360412">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4360473">+</span>&nbsp;<span class="ident" id="4360475">err</span><span class="op" id="4360478">.</span><span class="ident" id="4360479">Error</span><span class="op" id="4360484">(</span><span class="op" id="4360485">)</span><span class="op" id="4360486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4360490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360494">return</span>&nbsp;<span class="ident" id="4360501">key</span><span class="op" id="4360504">,</span>&nbsp;<span class="builtintype" id="4360506">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360512">case</span>&nbsp;<span class="ident" id="4360517">privKey</span><span class="op" id="4360524">.</span><span class="ident" id="4360525">Algo</span><span class="op" id="4360529">.</span><span class="ident" id="4360530">Algorithm</span><span class="op" id="4360539">.</span><span class="ident" id="4360540">Equal</span><span class="op" id="4360545">(</span><span class="ident" id="4360546">oidPublicKeyECDSA</span><span class="op" id="4360563">)</span><span class="op" id="4360564">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4360568">bytes</span>&nbsp;<span class="op" id="4360574">:=</span>&nbsp;<span class="ident" id="4360577">privKey</span><span class="op" id="4360584">.</span><span class="ident" id="4360585">Algo</span><span class="op" id="4360589">.</span><span class="ident" id="4360590">Parameters</span><span class="op" id="4360600">.</span><span class="ident" id="4360601">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4360613">namedCurveOID</span>&nbsp;<span class="op" id="4360627">:=</span>&nbsp;<span class="builtinfunc" id="4360630">new</span><span class="op" id="4360633">(</span><span class="ident" id="4360634">asn1</span><span class="op" id="4360638">.</span><span class="ident" id="4360639">ObjectIdentifier</span><span class="op" id="4360655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360659">if</span>&nbsp;<span class="ident" id="4360662">_</span><span class="op" id="4360663">,</span>&nbsp;<span class="ident" id="4360665">err</span>&nbsp;<span class="op" id="4360669">:=</span>&nbsp;<span class="ident" id="4360672">asn1</span><span class="op" id="4360676">.</span><span class="ident" id="4360677">Unmarshal</span><span class="op" id="4360686">(</span><span class="ident" id="4360687">bytes</span><span class="op" id="4360692">,</span>&nbsp;<span class="ident" id="4360694">namedCurveOID</span><span class="op" id="4360707">)</span><span class="op" id="4360708">;</span>&nbsp;<span class="ident" id="4360710">err</span>&nbsp;<span class="op" id="4360714">!=</span>&nbsp;<span class="builtintype" id="4360717">nil</span>&nbsp;<span class="op" id="4360721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4360726">namedCurveOID</span>&nbsp;<span class="op" id="4360740">=</span>&nbsp;<span class="builtintype" id="4360742">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4360748">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4360752">key</span><span class="op" id="4360755">,</span>&nbsp;<span class="ident" id="4360757">err</span>&nbsp;<span class="op" id="4360761">=</span>&nbsp;<span class="ident" id="4360763">parseECPrivateKey</span><span class="op" id="4360780">(</span><span class="ident" id="4360781">namedCurveOID</span><span class="op" id="4360794">,</span>&nbsp;<span class="ident" id="4360796">privKey</span><span class="op" id="4360803">.</span><span class="ident" id="4360804">PrivateKey</span><span class="op" id="4360814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360818">if</span>&nbsp;<span class="ident" id="4360821">err</span>&nbsp;<span class="op" id="4360825">!=</span>&nbsp;<span class="builtintype" id="4360828">nil</span>&nbsp;<span class="op" id="4360832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360837">return</span>&nbsp;<span class="builtintype" id="4360844">nil</span><span class="op" id="4360847">,</span>&nbsp;<span class="ident" id="4360849">errors</span><span class="op" id="4360855">.</span><span class="ident" id="4360856">New</span><span class="op" id="4360859">(</span><span class="string" id="4360860">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4360920">+</span>&nbsp;<span class="ident" id="4360922">err</span><span class="op" id="4360925">.</span><span class="ident" id="4360926">Error</span><span class="op" id="4360931">(</span><span class="op" id="4360932">)</span><span class="op" id="4360933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4360937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360941">return</span>&nbsp;<span class="ident" id="4360948">key</span><span class="op" id="4360951">,</span>&nbsp;<span class="builtintype" id="4360953">nil</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360959">default</span><span class="op" id="4360966">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360970">return</span>&nbsp;<span class="builtintype" id="4360977">nil</span><span class="op" id="4360980">,</span>&nbsp;<span class="ident" id="4360982">fmt</span><span class="op" id="4360985">.</span><span class="ident" id="4360986">Errorf</span><span class="op" id="4360992">(</span><span class="string" id="4360993">&#34;x509:&nbsp;PKCS#8&nbsp;wrapping&nbsp;contained&nbsp;private&nbsp;key&nbsp;with&nbsp;unknown&nbsp;algorithm:&nbsp;%v&#34;</span><span class="op" id="4361065">,</span>&nbsp;<span class="ident" id="4361067">privKey</span><span class="op" id="4361074">.</span><span class="ident" id="4361075">Algo</span><span class="op" id="4361079">.</span><span class="ident" id="4361080">Algorithm</span><span class="op" id="4361089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4361092">}</span><br>
<span class="lineno"></span><span class="op" id="4361094">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
