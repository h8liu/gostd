<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html" class="current">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6150500">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6150555">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6150609">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6150660">package</span>&nbsp;<span class="ident" id="6150668">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6150675">import</span>&nbsp;<span class="string" id="6150682">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6150690">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="6150750">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="6150820">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="6150878">//</span><br>
<span class="lineno"></span><span class="comment" id="6150881">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="6150929">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="6150993">//</span><br>
<span class="lineno"></span><span class="comment" id="6150996">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="6151057">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6151127">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="6151202">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6151269">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="6151342">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6151414">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="6151428">//</span><br>
<span class="lineno"></span><span class="comment" id="6151431">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="6151497">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="6151563">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="6151576">//</span><br>
<span class="lineno"></span><span class="comment" id="6151579">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="6151603">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6151633">//&nbsp;Complex&nbsp;circular&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="6151661">//</span><br>
<span class="lineno"></span><span class="comment" id="6151664">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6151680">//</span><br>
<span class="lineno">35</span><span class="comment" id="6151683">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="6151689">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno"></span><span class="comment" id="6151708">//</span><br>
<span class="lineno"></span><span class="comment" id="6151711">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6151719">//</span><br>
<span class="lineno">40</span><span class="comment" id="6151722">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6151756">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno"></span><span class="comment" id="6151791">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;cosh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6151824">//</span><br>
<span class="lineno"></span><span class="comment" id="6151827">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis&nbsp;the&nbsp;denominator&nbsp;is&nbsp;zero&nbsp;at&nbsp;odd&nbsp;multiples</span><br>
<span class="lineno">45</span><span class="comment" id="6151888">//&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;The&nbsp;denominator&nbsp;is&nbsp;evaluated&nbsp;by&nbsp;its&nbsp;Taylor</span><br>
<span class="lineno"></span><span class="comment" id="6151944">//&nbsp;series&nbsp;near&nbsp;these&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="6151973">//</span><br>
<span class="lineno"></span><span class="comment" id="6151976">//&nbsp;ctan(z)&nbsp;=&nbsp;-i&nbsp;ctanh(iz).</span><br>
<span class="lineno"></span><span class="comment" id="6152003">//</span><br>
<span class="lineno">50</span><span class="comment" id="6152006">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6152019">//</span><br>
<span class="lineno"></span><span class="comment" id="6152022">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6152062">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="6152120">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.1e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno">55</span><span class="comment" id="6152180">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="6152240">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;and&nbsp;catan(ctan(z))&nbsp;&nbsp;=&nbsp;&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6152301">//&nbsp;Tan&nbsp;returns&nbsp;the&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6152334">func</span>&nbsp;<span class="ident" id="6152339">Tan</span><span class="op" id="6152342">(</span><span class="ident" id="6152343">x</span>&nbsp;<span class="builtintype" id="6152345">complex128</span><span class="op" id="6152355">)</span>&nbsp;<span class="builtintype" id="6152357">complex128</span>&nbsp;<span class="op" id="6152368">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6152371">d</span>&nbsp;<span class="op" id="6152373">:=</span>&nbsp;<span class="ident" id="6152376">math</span><span class="op" id="6152380">.</span><span class="ident" id="6152381">Cos</span><span class="op" id="6152384">(</span><span class="num" id="6152385">2</span><span class="op" id="6152386">*</span><span class="builtinfunc" id="6152387">real</span><span class="op" id="6152391">(</span><span class="ident" id="6152392">x</span><span class="op" id="6152393">)</span><span class="op" id="6152394">)</span>&nbsp;<span class="op" id="6152396">+</span>&nbsp;<span class="ident" id="6152398">math</span><span class="op" id="6152402">.</span><span class="ident" id="6152403">Cosh</span><span class="op" id="6152407">(</span><span class="num" id="6152408">2</span><span class="op" id="6152409">*</span><span class="builtinfunc" id="6152410">imag</span><span class="op" id="6152414">(</span><span class="ident" id="6152415">x</span><span class="op" id="6152416">)</span><span class="op" id="6152417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152420">if</span>&nbsp;<span class="ident" id="6152423">math</span><span class="op" id="6152427">.</span><span class="ident" id="6152428">Abs</span><span class="op" id="6152431">(</span><span class="ident" id="6152432">d</span><span class="op" id="6152433">)</span>&nbsp;<span class="op" id="6152435">&lt;</span>&nbsp;<span class="num" id="6152437">0.25</span>&nbsp;<span class="op" id="6152442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6152446">d</span>&nbsp;<span class="op" id="6152448">=</span>&nbsp;<span class="ident" id="6152450">tanSeries</span><span class="op" id="6152459">(</span><span class="ident" id="6152460">x</span><span class="op" id="6152461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6152464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152467">if</span>&nbsp;<span class="ident" id="6152470">d</span>&nbsp;<span class="op" id="6152472">==</span>&nbsp;<span class="num" id="6152475">0</span>&nbsp;<span class="op" id="6152477">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152481">return</span>&nbsp;<span class="ident" id="6152488">Inf</span><span class="op" id="6152491">(</span><span class="op" id="6152492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6152495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152498">return</span>&nbsp;<span class="builtinfunc" id="6152505">complex</span><span class="op" id="6152512">(</span><span class="ident" id="6152513">math</span><span class="op" id="6152517">.</span><span class="ident" id="6152518">Sin</span><span class="op" id="6152521">(</span><span class="num" id="6152522">2</span><span class="op" id="6152523">*</span><span class="builtinfunc" id="6152524">real</span><span class="op" id="6152528">(</span><span class="ident" id="6152529">x</span><span class="op" id="6152530">)</span><span class="op" id="6152531">)</span><span class="op" id="6152532">/</span><span class="ident" id="6152533">d</span><span class="op" id="6152534">,</span>&nbsp;<span class="ident" id="6152536">math</span><span class="op" id="6152540">.</span><span class="ident" id="6152541">Sinh</span><span class="op" id="6152545">(</span><span class="num" id="6152546">2</span><span class="op" id="6152547">*</span><span class="builtinfunc" id="6152548">imag</span><span class="op" id="6152552">(</span><span class="ident" id="6152553">x</span><span class="op" id="6152554">)</span><span class="op" id="6152555">)</span><span class="op" id="6152556">/</span><span class="ident" id="6152557">d</span><span class="op" id="6152558">)</span><br>
<span class="lineno"></span><span class="op" id="6152560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="6152563">//&nbsp;Complex&nbsp;hyperbolic&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="6152593">//</span><br>
<span class="lineno"></span><span class="comment" id="6152596">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6152612">//</span><br>
<span class="lineno"></span><span class="comment" id="6152615">//&nbsp;tanh&nbsp;z&nbsp;=&nbsp;(sinh&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sin&nbsp;2y)&nbsp;/&nbsp;(cosh&nbsp;2x&nbsp;+&nbsp;cos&nbsp;2y)&nbsp;.</span><br>
<span class="lineno">75</span><span class="comment" id="6152673">//</span><br>
<span class="lineno"></span><span class="comment" id="6152676">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6152689">//</span><br>
<span class="lineno"></span><span class="comment" id="6152692">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6152732">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">80</span><span class="comment" id="6152790">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.7e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4e-16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6152851">//&nbsp;Tanh&nbsp;returns&nbsp;the&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6152896">func</span>&nbsp;<span class="ident" id="6152901">Tanh</span><span class="op" id="6152905">(</span><span class="ident" id="6152906">x</span>&nbsp;<span class="builtintype" id="6152908">complex128</span><span class="op" id="6152918">)</span>&nbsp;<span class="builtintype" id="6152920">complex128</span>&nbsp;<span class="op" id="6152931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6152934">d</span>&nbsp;<span class="op" id="6152936">:=</span>&nbsp;<span class="ident" id="6152939">math</span><span class="op" id="6152943">.</span><span class="ident" id="6152944">Cosh</span><span class="op" id="6152948">(</span><span class="num" id="6152949">2</span><span class="op" id="6152950">*</span><span class="builtinfunc" id="6152951">real</span><span class="op" id="6152955">(</span><span class="ident" id="6152956">x</span><span class="op" id="6152957">)</span><span class="op" id="6152958">)</span>&nbsp;<span class="op" id="6152960">+</span>&nbsp;<span class="ident" id="6152962">math</span><span class="op" id="6152966">.</span><span class="ident" id="6152967">Cos</span><span class="op" id="6152970">(</span><span class="num" id="6152971">2</span><span class="op" id="6152972">*</span><span class="builtinfunc" id="6152973">imag</span><span class="op" id="6152977">(</span><span class="ident" id="6152978">x</span><span class="op" id="6152979">)</span><span class="op" id="6152980">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152983">if</span>&nbsp;<span class="ident" id="6152986">d</span>&nbsp;<span class="op" id="6152988">==</span>&nbsp;<span class="num" id="6152991">0</span>&nbsp;<span class="op" id="6152993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6152997">return</span>&nbsp;<span class="ident" id="6153004">Inf</span><span class="op" id="6153007">(</span><span class="op" id="6153008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6153011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153014">return</span>&nbsp;<span class="builtinfunc" id="6153021">complex</span><span class="op" id="6153028">(</span><span class="ident" id="6153029">math</span><span class="op" id="6153033">.</span><span class="ident" id="6153034">Sinh</span><span class="op" id="6153038">(</span><span class="num" id="6153039">2</span><span class="op" id="6153040">*</span><span class="builtinfunc" id="6153041">real</span><span class="op" id="6153045">(</span><span class="ident" id="6153046">x</span><span class="op" id="6153047">)</span><span class="op" id="6153048">)</span><span class="op" id="6153049">/</span><span class="ident" id="6153050">d</span><span class="op" id="6153051">,</span>&nbsp;<span class="ident" id="6153053">math</span><span class="op" id="6153057">.</span><span class="ident" id="6153058">Sin</span><span class="op" id="6153061">(</span><span class="num" id="6153062">2</span><span class="op" id="6153063">*</span><span class="builtinfunc" id="6153064">imag</span><span class="op" id="6153068">(</span><span class="ident" id="6153069">x</span><span class="op" id="6153070">)</span><span class="op" id="6153071">)</span><span class="op" id="6153072">/</span><span class="ident" id="6153073">d</span><span class="op" id="6153074">)</span><br>
<span class="lineno"></span><span class="op" id="6153076">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="6153079">//&nbsp;Program&nbsp;to&nbsp;subtract&nbsp;nearest&nbsp;integer&nbsp;multiple&nbsp;of&nbsp;PI</span><br>
<span class="lineno"></span><span class="keyword" id="6153133">func</span>&nbsp;<span class="ident" id="6153138">reducePi</span><span class="op" id="6153146">(</span><span class="ident" id="6153147">x</span>&nbsp;<span class="builtintype" id="6153149">float64</span><span class="op" id="6153156">)</span>&nbsp;<span class="builtintype" id="6153158">float64</span>&nbsp;<span class="op" id="6153166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153169">const</span>&nbsp;<span class="op" id="6153175">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6153179">//&nbsp;extended&nbsp;precision&nbsp;value&nbsp;of&nbsp;PI:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153216">DP1</span>&nbsp;<span class="op" id="6153220">=</span>&nbsp;<span class="num" id="6153222">3.14159265160560607910E0</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6153249">//&nbsp;??&nbsp;0x400921fb54000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153276">DP2</span>&nbsp;<span class="op" id="6153280">=</span>&nbsp;<span class="num" id="6153282">1.98418714791870343106E-9</span>&nbsp;&nbsp;<span class="comment" id="6153309">//&nbsp;??&nbsp;0x3e210b4610000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153336">DP3</span>&nbsp;<span class="op" id="6153340">=</span>&nbsp;<span class="num" id="6153342">1.14423774522196636802E-17</span>&nbsp;<span class="comment" id="6153369">//&nbsp;??&nbsp;0x3c6a62633145c06e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6153395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153398">t</span>&nbsp;<span class="op" id="6153400">:=</span>&nbsp;<span class="ident" id="6153403">x</span>&nbsp;<span class="op" id="6153405">/</span>&nbsp;<span class="ident" id="6153407">math</span><span class="op" id="6153411">.</span><span class="ident" id="6153412">Pi</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153416">if</span>&nbsp;<span class="ident" id="6153419">t</span>&nbsp;<span class="op" id="6153421">&gt;=</span>&nbsp;<span class="num" id="6153424">0</span>&nbsp;<span class="op" id="6153426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153430">t</span>&nbsp;<span class="op" id="6153432">+=</span>&nbsp;<span class="num" id="6153435">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6153440">}</span>&nbsp;<span class="keyword" id="6153442">else</span>&nbsp;<span class="op" id="6153447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153451">t</span>&nbsp;<span class="op" id="6153453">-=</span>&nbsp;<span class="num" id="6153456">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6153461">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153464">t</span>&nbsp;<span class="op" id="6153466">=</span>&nbsp;<span class="builtintype" id="6153468">float64</span><span class="op" id="6153475">(</span><span class="ident" id="6153476">int64</span><span class="op" id="6153481">(</span><span class="ident" id="6153482">t</span><span class="op" id="6153483">)</span><span class="op" id="6153484">)</span>&nbsp;<span class="comment" id="6153486">//&nbsp;int64(t)&nbsp;=&nbsp;the&nbsp;multiple</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153514">return</span>&nbsp;<span class="op" id="6153521">(</span><span class="op" id="6153522">(</span><span class="ident" id="6153523">x</span>&nbsp;<span class="op" id="6153525">-</span>&nbsp;<span class="ident" id="6153527">t</span><span class="op" id="6153528">*</span><span class="ident" id="6153529">DP1</span><span class="op" id="6153532">)</span>&nbsp;<span class="op" id="6153534">-</span>&nbsp;<span class="ident" id="6153536">t</span><span class="op" id="6153537">*</span><span class="ident" id="6153538">DP2</span><span class="op" id="6153541">)</span>&nbsp;<span class="op" id="6153543">-</span>&nbsp;<span class="ident" id="6153545">t</span><span class="op" id="6153546">*</span><span class="ident" id="6153547">DP3</span><br>
<span class="lineno"></span><span class="op" id="6153551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6153554">//&nbsp;Taylor&nbsp;series&nbsp;expansion&nbsp;for&nbsp;cosh(2y)&nbsp;-&nbsp;cos(2x)</span><br>
<span class="lineno">110</span><span class="keyword" id="6153604">func</span>&nbsp;<span class="ident" id="6153609">tanSeries</span><span class="op" id="6153618">(</span><span class="ident" id="6153619">z</span>&nbsp;<span class="builtintype" id="6153621">complex128</span><span class="op" id="6153631">)</span>&nbsp;<span class="builtintype" id="6153633">float64</span>&nbsp;<span class="op" id="6153641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153644">const</span>&nbsp;<span class="ident" id="6153650">MACHEP</span>&nbsp;<span class="op" id="6153657">=</span>&nbsp;<span class="num" id="6153659">1.0</span>&nbsp;<span class="op" id="6153663">/</span>&nbsp;<span class="op" id="6153665">(</span><span class="num" id="6153666">1</span>&nbsp;<span class="op" id="6153668">&lt;&lt;</span>&nbsp;<span class="num" id="6153671">53</span><span class="op" id="6153673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153676">x</span>&nbsp;<span class="op" id="6153678">:=</span>&nbsp;<span class="ident" id="6153681">math</span><span class="op" id="6153685">.</span><span class="ident" id="6153686">Abs</span><span class="op" id="6153689">(</span><span class="num" id="6153690">2</span>&nbsp;<span class="op" id="6153692">*</span>&nbsp;<span class="builtinfunc" id="6153694">real</span><span class="op" id="6153698">(</span><span class="ident" id="6153699">z</span><span class="op" id="6153700">)</span><span class="op" id="6153701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153704">y</span>&nbsp;<span class="op" id="6153706">:=</span>&nbsp;<span class="ident" id="6153709">math</span><span class="op" id="6153713">.</span><span class="ident" id="6153714">Abs</span><span class="op" id="6153717">(</span><span class="num" id="6153718">2</span>&nbsp;<span class="op" id="6153720">*</span>&nbsp;<span class="builtinfunc" id="6153722">imag</span><span class="op" id="6153726">(</span><span class="ident" id="6153727">z</span><span class="op" id="6153728">)</span><span class="op" id="6153729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153732">x</span>&nbsp;<span class="op" id="6153734">=</span>&nbsp;<span class="ident" id="6153736">reducePi</span><span class="op" id="6153744">(</span><span class="ident" id="6153745">x</span><span class="op" id="6153746">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153749">x</span>&nbsp;<span class="op" id="6153751">=</span>&nbsp;<span class="ident" id="6153753">x</span>&nbsp;<span class="op" id="6153755">*</span>&nbsp;<span class="ident" id="6153757">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153760">y</span>&nbsp;<span class="op" id="6153762">=</span>&nbsp;<span class="ident" id="6153764">y</span>&nbsp;<span class="op" id="6153766">*</span>&nbsp;<span class="ident" id="6153768">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153771">x2</span>&nbsp;<span class="op" id="6153774">:=</span>&nbsp;<span class="num" id="6153777">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153782">y2</span>&nbsp;<span class="op" id="6153785">:=</span>&nbsp;<span class="num" id="6153788">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153793">f</span>&nbsp;<span class="op" id="6153795">:=</span>&nbsp;<span class="num" id="6153798">1.0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153803">rn</span>&nbsp;<span class="op" id="6153806">:=</span>&nbsp;<span class="num" id="6153809">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153814">d</span>&nbsp;<span class="op" id="6153816">:=</span>&nbsp;<span class="num" id="6153819">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6153824">for</span>&nbsp;<span class="op" id="6153828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153832">rn</span>&nbsp;<span class="op" id="6153835">+=</span>&nbsp;<span class="num" id="6153838">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153842">f</span>&nbsp;<span class="op" id="6153844">*=</span>&nbsp;<span class="ident" id="6153847">rn</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153852">rn</span>&nbsp;<span class="op" id="6153855">+=</span>&nbsp;<span class="num" id="6153858">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153862">f</span>&nbsp;<span class="op" id="6153864">*=</span>&nbsp;<span class="ident" id="6153867">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153872">x2</span>&nbsp;<span class="op" id="6153875">*=</span>&nbsp;<span class="ident" id="6153878">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153882">y2</span>&nbsp;<span class="op" id="6153885">*=</span>&nbsp;<span class="ident" id="6153888">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153892">t</span>&nbsp;<span class="op" id="6153894">:=</span>&nbsp;<span class="ident" id="6153897">y2</span>&nbsp;<span class="op" id="6153900">+</span>&nbsp;<span class="ident" id="6153902">x2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153907">t</span>&nbsp;<span class="op" id="6153909">/=</span>&nbsp;<span class="ident" id="6153912">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153916">d</span>&nbsp;<span class="op" id="6153918">+=</span>&nbsp;<span class="ident" id="6153921">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153926">rn</span>&nbsp;<span class="op" id="6153929">+=</span>&nbsp;<span class="num" id="6153932">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153936">f</span>&nbsp;<span class="op" id="6153938">*=</span>&nbsp;<span class="ident" id="6153941">rn</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153946">rn</span>&nbsp;<span class="op" id="6153949">+=</span>&nbsp;<span class="num" id="6153952">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153956">f</span>&nbsp;<span class="op" id="6153958">*=</span>&nbsp;<span class="ident" id="6153961">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153966">x2</span>&nbsp;<span class="op" id="6153969">*=</span>&nbsp;<span class="ident" id="6153972">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153976">y2</span>&nbsp;<span class="op" id="6153979">*=</span>&nbsp;<span class="ident" id="6153982">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6153986">t</span>&nbsp;<span class="op" id="6153988">=</span>&nbsp;<span class="ident" id="6153990">y2</span>&nbsp;<span class="op" id="6153993">-</span>&nbsp;<span class="ident" id="6153995">x2</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154000">t</span>&nbsp;<span class="op" id="6154002">/=</span>&nbsp;<span class="ident" id="6154005">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154009">d</span>&nbsp;<span class="op" id="6154011">+=</span>&nbsp;<span class="ident" id="6154014">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154018">if</span>&nbsp;<span class="ident" id="6154021">math</span><span class="op" id="6154025">.</span><span class="ident" id="6154026">Abs</span><span class="op" id="6154029">(</span><span class="ident" id="6154030">t</span><span class="op" id="6154031">/</span><span class="ident" id="6154032">d</span><span class="op" id="6154033">)</span>&nbsp;<span class="op" id="6154035">&lt;=</span>&nbsp;<span class="ident" id="6154038">MACHEP</span>&nbsp;<span class="op" id="6154045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154050">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6154058">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6154061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154064">return</span>&nbsp;<span class="ident" id="6154071">d</span><br>
<span class="lineno"></span><span class="op" id="6154073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6154076">//&nbsp;Complex&nbsp;circular&nbsp;cotangent</span><br>
<span class="lineno">150</span><span class="comment" id="6154106">//</span><br>
<span class="lineno"></span><span class="comment" id="6154109">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6154125">//</span><br>
<span class="lineno"></span><span class="comment" id="6154128">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="6154134">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno">155</span><span class="comment" id="6154153">//</span><br>
<span class="lineno"></span><span class="comment" id="6154156">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6154164">//</span><br>
<span class="lineno"></span><span class="comment" id="6154167">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;-&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6154201">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno">160</span><span class="comment" id="6154236">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cosh&nbsp;2y&nbsp;&nbsp;-&nbsp;&nbsp;cos&nbsp;2x</span><br>
<span class="lineno"></span><span class="comment" id="6154269">//</span><br>
<span class="lineno"></span><span class="comment" id="6154272">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis,&nbsp;the&nbsp;denominator&nbsp;has&nbsp;zeros&nbsp;at&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="6154327">//&nbsp;multiples&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;Near&nbsp;these&nbsp;points&nbsp;it&nbsp;is&nbsp;evaluated</span><br>
<span class="lineno"></span><span class="comment" id="6154384">//&nbsp;by&nbsp;a&nbsp;Taylor&nbsp;series.</span><br>
<span class="lineno">165</span><span class="comment" id="6154407">//</span><br>
<span class="lineno"></span><span class="comment" id="6154410">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6154423">//</span><br>
<span class="lineno"></span><span class="comment" id="6154426">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6154466">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">170</span><span class="comment" id="6154524">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.5e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno"></span><span class="comment" id="6154584">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="6154644">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;+&nbsp;i0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6154685">//&nbsp;Cot&nbsp;returns&nbsp;the&nbsp;cotangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno">175</span><span class="keyword" id="6154720">func</span>&nbsp;<span class="ident" id="6154725">Cot</span><span class="op" id="6154728">(</span><span class="ident" id="6154729">x</span>&nbsp;<span class="builtintype" id="6154731">complex128</span><span class="op" id="6154741">)</span>&nbsp;<span class="builtintype" id="6154743">complex128</span>&nbsp;<span class="op" id="6154754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154757">d</span>&nbsp;<span class="op" id="6154759">:=</span>&nbsp;<span class="ident" id="6154762">math</span><span class="op" id="6154766">.</span><span class="ident" id="6154767">Cosh</span><span class="op" id="6154771">(</span><span class="num" id="6154772">2</span><span class="op" id="6154773">*</span><span class="builtinfunc" id="6154774">imag</span><span class="op" id="6154778">(</span><span class="ident" id="6154779">x</span><span class="op" id="6154780">)</span><span class="op" id="6154781">)</span>&nbsp;<span class="op" id="6154783">-</span>&nbsp;<span class="ident" id="6154785">math</span><span class="op" id="6154789">.</span><span class="ident" id="6154790">Cos</span><span class="op" id="6154793">(</span><span class="num" id="6154794">2</span><span class="op" id="6154795">*</span><span class="builtinfunc" id="6154796">real</span><span class="op" id="6154800">(</span><span class="ident" id="6154801">x</span><span class="op" id="6154802">)</span><span class="op" id="6154803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154806">if</span>&nbsp;<span class="ident" id="6154809">math</span><span class="op" id="6154813">.</span><span class="ident" id="6154814">Abs</span><span class="op" id="6154817">(</span><span class="ident" id="6154818">d</span><span class="op" id="6154819">)</span>&nbsp;<span class="op" id="6154821">&lt;</span>&nbsp;<span class="num" id="6154823">0.25</span>&nbsp;<span class="op" id="6154828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6154832">d</span>&nbsp;<span class="op" id="6154834">=</span>&nbsp;<span class="ident" id="6154836">tanSeries</span><span class="op" id="6154845">(</span><span class="ident" id="6154846">x</span><span class="op" id="6154847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6154850">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154853">if</span>&nbsp;<span class="ident" id="6154856">d</span>&nbsp;<span class="op" id="6154858">==</span>&nbsp;<span class="num" id="6154861">0</span>&nbsp;<span class="op" id="6154863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154867">return</span>&nbsp;<span class="ident" id="6154874">Inf</span><span class="op" id="6154877">(</span><span class="op" id="6154878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6154881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6154884">return</span>&nbsp;<span class="builtinfunc" id="6154891">complex</span><span class="op" id="6154898">(</span><span class="ident" id="6154899">math</span><span class="op" id="6154903">.</span><span class="ident" id="6154904">Sin</span><span class="op" id="6154907">(</span><span class="num" id="6154908">2</span><span class="op" id="6154909">*</span><span class="builtinfunc" id="6154910">real</span><span class="op" id="6154914">(</span><span class="ident" id="6154915">x</span><span class="op" id="6154916">)</span><span class="op" id="6154917">)</span><span class="op" id="6154918">/</span><span class="ident" id="6154919">d</span><span class="op" id="6154920">,</span>&nbsp;<span class="op" id="6154922">-</span><span class="ident" id="6154923">math</span><span class="op" id="6154927">.</span><span class="ident" id="6154928">Sinh</span><span class="op" id="6154932">(</span><span class="num" id="6154933">2</span><span class="op" id="6154934">*</span><span class="builtinfunc" id="6154935">imag</span><span class="op" id="6154939">(</span><span class="ident" id="6154940">x</span><span class="op" id="6154941">)</span><span class="op" id="6154942">)</span><span class="op" id="6154943">/</span><span class="ident" id="6154944">d</span><span class="op" id="6154945">)</span><br>
<span class="lineno"></span><span class="op" id="6154947">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
