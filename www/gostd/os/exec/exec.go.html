<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5571651">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5571706">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5571760">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5571811">//&nbsp;Package&nbsp;exec&nbsp;runs&nbsp;external&nbsp;commands.&nbsp;It&nbsp;wraps&nbsp;os.StartProcess&nbsp;to&nbsp;make&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5571887">//&nbsp;easier&nbsp;to&nbsp;remap&nbsp;stdin&nbsp;and&nbsp;stdout,&nbsp;connect&nbsp;I/O&nbsp;with&nbsp;pipes,&nbsp;and&nbsp;do&nbsp;other</span><br>
<span class="lineno"></span><span class="comment" id="5571961">//&nbsp;adjustments.</span><br>
<span class="lineno"></span><span class="keyword" id="5571977">package</span>&nbsp;<span class="ident" id="5571985">exec</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5571991">import</span>&nbsp;<span class="op" id="5571998">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5572001">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5572010">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5572020">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5572026">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5572032">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5572049">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5572060">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5572071">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5572082">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5572090">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="5572100">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5572103">//&nbsp;Error&nbsp;records&nbsp;the&nbsp;name&nbsp;of&nbsp;a&nbsp;binary&nbsp;that&nbsp;failed&nbsp;to&nbsp;be&nbsp;executed</span><br>
<span class="lineno"></span><span class="comment" id="5572168">//&nbsp;and&nbsp;the&nbsp;reason&nbsp;it&nbsp;failed.</span><br>
<span class="lineno">25</span><span class="keyword" id="5572197">type</span>&nbsp;<span class="ident" id="5572202">Error</span>&nbsp;<span class="keyword" id="5572208">struct</span>&nbsp;<span class="op" id="5572215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572218">Name</span>&nbsp;<span class="builtintype" id="5572223">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572231">Err</span>&nbsp;&nbsp;<span class="builtintype" id="5572236">error</span><br>
<span class="lineno"></span><span class="op" id="5572242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="5572245">func</span>&nbsp;<span class="op" id="5572250">(</span><span class="ident" id="5572251">e</span>&nbsp;<span class="op" id="5572253">*</span><span class="ident" id="5572254">Error</span><span class="op" id="5572259">)</span>&nbsp;<span class="ident" id="5572261">Error</span><span class="op" id="5572266">(</span><span class="op" id="5572267">)</span>&nbsp;<span class="builtintype" id="5572269">string</span>&nbsp;<span class="op" id="5572276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5572279">return</span>&nbsp;<span class="string" id="5572286">&#34;exec:&nbsp;&#34;</span>&nbsp;<span class="op" id="5572295">+</span>&nbsp;<span class="ident" id="5572297">strconv</span><span class="op" id="5572304">.</span><span class="ident" id="5572305">Quote</span><span class="op" id="5572310">(</span><span class="ident" id="5572311">e</span><span class="op" id="5572312">.</span><span class="ident" id="5572313">Name</span><span class="op" id="5572317">)</span>&nbsp;<span class="op" id="5572319">+</span>&nbsp;<span class="string" id="5572321">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="5572326">+</span>&nbsp;<span class="ident" id="5572328">e</span><span class="op" id="5572329">.</span><span class="ident" id="5572330">Err</span><span class="op" id="5572333">.</span><span class="ident" id="5572334">Error</span><span class="op" id="5572339">(</span><span class="op" id="5572340">)</span><br>
<span class="lineno"></span><span class="op" id="5572342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5572345">//&nbsp;Cmd&nbsp;represents&nbsp;an&nbsp;external&nbsp;command&nbsp;being&nbsp;prepared&nbsp;or&nbsp;run.</span><br>
<span class="lineno">35</span><span class="keyword" id="5572406">type</span>&nbsp;<span class="ident" id="5572411">Cmd</span>&nbsp;<span class="keyword" id="5572415">struct</span>&nbsp;<span class="op" id="5572422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572425">//&nbsp;Path&nbsp;is&nbsp;the&nbsp;path&nbsp;of&nbsp;the&nbsp;command&nbsp;to&nbsp;run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572469">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572473">//&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;field&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;to&nbsp;a&nbsp;non-zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572531">//&nbsp;value.&nbsp;If&nbsp;Path&nbsp;is&nbsp;relative,&nbsp;it&nbsp;is&nbsp;evaluated&nbsp;relative</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572588">//&nbsp;to&nbsp;Dir.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572600">Path</span>&nbsp;<span class="builtintype" id="5572605">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572614">//&nbsp;Args&nbsp;holds&nbsp;command&nbsp;line&nbsp;arguments,&nbsp;including&nbsp;the&nbsp;command&nbsp;as&nbsp;Args[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572687">//&nbsp;If&nbsp;the&nbsp;Args&nbsp;field&nbsp;is&nbsp;empty&nbsp;or&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;{Path}.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572743">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572747">//&nbsp;In&nbsp;typical&nbsp;use,&nbsp;both&nbsp;Path&nbsp;and&nbsp;Args&nbsp;are&nbsp;set&nbsp;by&nbsp;calling&nbsp;Command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572814">Args</span>&nbsp;<span class="op" id="5572819">[</span><span class="op" id="5572820">]</span><span class="builtintype" id="5572821">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572830">//&nbsp;Env&nbsp;specifies&nbsp;the&nbsp;environment&nbsp;of&nbsp;the&nbsp;process.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572880">//&nbsp;If&nbsp;Env&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;uses&nbsp;the&nbsp;current&nbsp;process&#39;s&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5572943">Env</span>&nbsp;<span class="op" id="5572947">[</span><span class="op" id="5572948">]</span><span class="builtintype" id="5572949">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5572958">//&nbsp;Dir&nbsp;specifies&nbsp;the&nbsp;working&nbsp;directory&nbsp;of&nbsp;the&nbsp;command.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573014">//&nbsp;If&nbsp;Dir&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;Run&nbsp;runs&nbsp;the&nbsp;command&nbsp;in&nbsp;the</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573074">//&nbsp;calling&nbsp;process&#39;s&nbsp;current&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573115">Dir</span>&nbsp;<span class="builtintype" id="5573119">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573128">//&nbsp;Stdin&nbsp;specifies&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573178">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;nil,&nbsp;the&nbsp;process&nbsp;reads&nbsp;from&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573252">//&nbsp;If&nbsp;Stdin&nbsp;is&nbsp;an&nbsp;*os.File,&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;input&nbsp;is&nbsp;connected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573323">//&nbsp;directly&nbsp;to&nbsp;that&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573350">//&nbsp;Otherwise,&nbsp;during&nbsp;the&nbsp;execution&nbsp;of&nbsp;the&nbsp;command&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573412">//&nbsp;goroutine&nbsp;reads&nbsp;from&nbsp;Stdin&nbsp;and&nbsp;delivers&nbsp;that&nbsp;data&nbsp;to&nbsp;the&nbsp;command</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573481">//&nbsp;over&nbsp;a&nbsp;pipe.&nbsp;In&nbsp;this&nbsp;case,&nbsp;Wait&nbsp;does&nbsp;not&nbsp;complete&nbsp;until&nbsp;the&nbsp;goroutine</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573555">//&nbsp;stops&nbsp;copying,&nbsp;either&nbsp;because&nbsp;it&nbsp;has&nbsp;reached&nbsp;the&nbsp;end&nbsp;of&nbsp;Stdin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573621">//&nbsp;(EOF&nbsp;or&nbsp;a&nbsp;read&nbsp;error)&nbsp;or&nbsp;because&nbsp;writing&nbsp;to&nbsp;the&nbsp;pipe&nbsp;returned&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573697">Stdin</span>&nbsp;<span class="ident" id="5573703">io</span><span class="op" id="5573705">.</span><span class="ident" id="5573706">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573715">//&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;specify&nbsp;the&nbsp;process&#39;s&nbsp;standard&nbsp;output&nbsp;and&nbsp;error.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573786">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573790">//&nbsp;If&nbsp;either&nbsp;is&nbsp;nil,&nbsp;Run&nbsp;connects&nbsp;the&nbsp;corresponding&nbsp;file&nbsp;descriptor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573859">//&nbsp;to&nbsp;the&nbsp;null&nbsp;device&nbsp;(os.DevNull).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573896">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573900">//&nbsp;If&nbsp;Stdout&nbsp;and&nbsp;Stderr&nbsp;are&nbsp;the&nbsp;same&nbsp;writer,&nbsp;at&nbsp;most&nbsp;one</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5573958">//&nbsp;goroutine&nbsp;at&nbsp;a&nbsp;time&nbsp;will&nbsp;call&nbsp;Write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5573999">Stdout</span>&nbsp;<span class="ident" id="5574006">io</span><span class="op" id="5574008">.</span><span class="ident" id="5574009">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574017">Stderr</span>&nbsp;<span class="ident" id="5574024">io</span><span class="op" id="5574026">.</span><span class="ident" id="5574027">Writer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5574036">//&nbsp;ExtraFiles&nbsp;specifies&nbsp;additional&nbsp;open&nbsp;files&nbsp;to&nbsp;be&nbsp;inherited&nbsp;by&nbsp;the</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5574106">//&nbsp;new&nbsp;process.&nbsp;It&nbsp;does&nbsp;not&nbsp;include&nbsp;standard&nbsp;input,&nbsp;standard&nbsp;output,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5574179">//&nbsp;standard&nbsp;error.&nbsp;If&nbsp;non-nil,&nbsp;entry&nbsp;i&nbsp;becomes&nbsp;file&nbsp;descriptor&nbsp;3+i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5574248">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5574252">//&nbsp;BUG:&nbsp;on&nbsp;OS&nbsp;X&nbsp;10.6,&nbsp;child&nbsp;processes&nbsp;may&nbsp;sometimes&nbsp;inherit&nbsp;unwanted&nbsp;fds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5574327">//&nbsp;http://golang.org/issue/2603</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574360">ExtraFiles</span>&nbsp;<span class="op" id="5574371">[</span><span class="op" id="5574372">]</span><span class="op" id="5574373">*</span><span class="ident" id="5574374">os</span><span class="op" id="5574376">.</span><span class="ident" id="5574377">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5574384">//&nbsp;SysProcAttr&nbsp;holds&nbsp;optional,&nbsp;operating&nbsp;system-specific&nbsp;attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5574454">//&nbsp;Run&nbsp;passes&nbsp;it&nbsp;to&nbsp;os.StartProcess&nbsp;as&nbsp;the&nbsp;os.ProcAttr&#39;s&nbsp;Sys&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574523">SysProcAttr</span>&nbsp;<span class="op" id="5574535">*</span><span class="ident" id="5574536">syscall</span><span class="op" id="5574543">.</span><span class="ident" id="5574544">SysProcAttr</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5574558">//&nbsp;Process&nbsp;is&nbsp;the&nbsp;underlying&nbsp;process,&nbsp;once&nbsp;started.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574611">Process</span>&nbsp;<span class="op" id="5574619">*</span><span class="ident" id="5574620">os</span><span class="op" id="5574622">.</span><span class="ident" id="5574623">Process</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5574633">//&nbsp;ProcessState&nbsp;contains&nbsp;information&nbsp;about&nbsp;an&nbsp;exited&nbsp;process,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5574696">//&nbsp;available&nbsp;after&nbsp;a&nbsp;call&nbsp;to&nbsp;Wait&nbsp;or&nbsp;Run.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574739">ProcessState</span>&nbsp;<span class="op" id="5574752">*</span><span class="ident" id="5574753">os</span><span class="op" id="5574755">.</span><span class="ident" id="5574756">ProcessState</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574771">lookPathErr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5574787">error</span>&nbsp;<span class="comment" id="5574793">//&nbsp;LookPath&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574821">finished</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5574837">bool</span>&nbsp;&nbsp;<span class="comment" id="5574843">//&nbsp;when&nbsp;Wait&nbsp;was&nbsp;called</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574868">childFiles</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5574884">[</span><span class="op" id="5574885">]</span><span class="op" id="5574886">*</span><span class="ident" id="5574887">os</span><span class="op" id="5574889">.</span><span class="ident" id="5574890">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574896">closeAfterStart</span>&nbsp;<span class="op" id="5574912">[</span><span class="op" id="5574913">]</span><span class="ident" id="5574914">io</span><span class="op" id="5574916">.</span><span class="ident" id="5574917">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574925">closeAfterWait</span>&nbsp;&nbsp;<span class="op" id="5574941">[</span><span class="op" id="5574942">]</span><span class="ident" id="5574943">io</span><span class="op" id="5574945">.</span><span class="ident" id="5574946">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574954">goroutine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5574970">[</span><span class="op" id="5574971">]</span><span class="keyword" id="5574972">func</span><span class="op" id="5574976">(</span><span class="op" id="5574977">)</span>&nbsp;<span class="builtintype" id="5574979">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5574986">errch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5575002">chan</span>&nbsp;<span class="builtintype" id="5575007">error</span>&nbsp;<span class="comment" id="5575013">//&nbsp;one&nbsp;send&nbsp;per&nbsp;goroutine</span><br>
<span class="lineno">105</span><span class="op" id="5575039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5575042">//&nbsp;Command&nbsp;returns&nbsp;the&nbsp;Cmd&nbsp;struct&nbsp;to&nbsp;execute&nbsp;the&nbsp;named&nbsp;program&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5575110">//&nbsp;the&nbsp;given&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="5575134">//</span><br>
<span class="lineno">110</span><span class="comment" id="5575137">//&nbsp;It&nbsp;sets&nbsp;only&nbsp;the&nbsp;Path&nbsp;and&nbsp;Args&nbsp;in&nbsp;the&nbsp;returned&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="5575198">//</span><br>
<span class="lineno"></span><span class="comment" id="5575201">//&nbsp;If&nbsp;name&nbsp;contains&nbsp;no&nbsp;path&nbsp;separators,&nbsp;Command&nbsp;uses&nbsp;LookPath&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5575266">//&nbsp;resolve&nbsp;the&nbsp;path&nbsp;to&nbsp;a&nbsp;complete&nbsp;name&nbsp;if&nbsp;possible.&nbsp;Otherwise&nbsp;it&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="5575336">//&nbsp;name&nbsp;directly.</span><br>
<span class="lineno">115</span><span class="comment" id="5575354">//</span><br>
<span class="lineno"></span><span class="comment" id="5575357">//&nbsp;The&nbsp;returned&nbsp;Cmd&#39;s&nbsp;Args&nbsp;field&nbsp;is&nbsp;constructed&nbsp;from&nbsp;the&nbsp;command&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="5575427">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;elements&nbsp;of&nbsp;arg,&nbsp;so&nbsp;arg&nbsp;should&nbsp;not&nbsp;include&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5575493">//&nbsp;command&nbsp;name&nbsp;itself.&nbsp;For&nbsp;example,&nbsp;Command(&#34;echo&#34;,&nbsp;&#34;hello&#34;)</span><br>
<span class="lineno"></span><span class="keyword" id="5575555">func</span>&nbsp;<span class="ident" id="5575560">Command</span><span class="op" id="5575567">(</span><span class="ident" id="5575568">name</span>&nbsp;<span class="builtintype" id="5575573">string</span><span class="op" id="5575579">,</span>&nbsp;<span class="ident" id="5575581">arg</span>&nbsp;<span class="op" id="5575585">...</span><span class="builtintype" id="5575588">string</span><span class="op" id="5575594">)</span>&nbsp;<span class="op" id="5575596">*</span><span class="ident" id="5575597">Cmd</span>&nbsp;<span class="op" id="5575601">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575604">cmd</span>&nbsp;<span class="op" id="5575608">:=</span>&nbsp;<span class="op" id="5575611">&amp;</span><span class="ident" id="5575612">Cmd</span><span class="op" id="5575615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575619">Path</span><span class="op" id="5575623">:</span>&nbsp;<span class="ident" id="5575625">name</span><span class="op" id="5575629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575633">Args</span><span class="op" id="5575637">:</span>&nbsp;<span class="builtinfunc" id="5575639">append</span><span class="op" id="5575645">(</span><span class="op" id="5575646">[</span><span class="op" id="5575647">]</span><span class="builtintype" id="5575648">string</span><span class="op" id="5575654">{</span><span class="ident" id="5575655">name</span><span class="op" id="5575659">}</span><span class="op" id="5575660">,</span>&nbsp;<span class="ident" id="5575662">arg</span><span class="op" id="5575665">...</span><span class="op" id="5575668">)</span><span class="op" id="5575669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5575672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5575675">if</span>&nbsp;<span class="ident" id="5575678">filepath</span><span class="op" id="5575686">.</span><span class="ident" id="5575687">Base</span><span class="op" id="5575691">(</span><span class="ident" id="5575692">name</span><span class="op" id="5575696">)</span>&nbsp;<span class="op" id="5575698">==</span>&nbsp;<span class="ident" id="5575701">name</span>&nbsp;<span class="op" id="5575706">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5575710">if</span>&nbsp;<span class="ident" id="5575713">lp</span><span class="op" id="5575715">,</span>&nbsp;<span class="ident" id="5575717">err</span>&nbsp;<span class="op" id="5575721">:=</span>&nbsp;<span class="ident" id="5575724">LookPath</span><span class="op" id="5575732">(</span><span class="ident" id="5575733">name</span><span class="op" id="5575737">)</span><span class="op" id="5575738">;</span>&nbsp;<span class="ident" id="5575740">err</span>&nbsp;<span class="op" id="5575744">!=</span>&nbsp;<span class="ident" id="5575747">nil</span>&nbsp;<span class="op" id="5575751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575756">cmd</span><span class="op" id="5575759">.</span><span class="ident" id="5575760">lookPathErr</span>&nbsp;<span class="op" id="5575772">=</span>&nbsp;<span class="ident" id="5575774">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5575780">}</span>&nbsp;<span class="keyword" id="5575782">else</span>&nbsp;<span class="op" id="5575787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5575792">cmd</span><span class="op" id="5575795">.</span><span class="ident" id="5575796">Path</span>&nbsp;<span class="op" id="5575801">=</span>&nbsp;<span class="ident" id="5575803">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5575808">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5575811">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5575814">return</span>&nbsp;<span class="ident" id="5575821">cmd</span><br>
<span class="lineno"></span><span class="op" id="5575825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5575828">//&nbsp;interfaceEqual&nbsp;protects&nbsp;against&nbsp;panics&nbsp;from&nbsp;doing&nbsp;equality&nbsp;tests&nbsp;on</span><br>
<span class="lineno">135</span><span class="comment" id="5575899">//&nbsp;two&nbsp;interfaces&nbsp;with&nbsp;non-comparable&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="5575955">func</span>&nbsp;<span class="ident" id="5575960">interfaceEqual</span><span class="op" id="5575974">(</span><span class="ident" id="5575975">a</span><span class="op" id="5575976">,</span>&nbsp;<span class="ident" id="5575978">b</span>&nbsp;<span class="keyword" id="5575980">interface</span><span class="op" id="5575989">{</span><span class="op" id="5575990">}</span><span class="op" id="5575991">)</span>&nbsp;<span class="builtintype" id="5575993">bool</span>&nbsp;<span class="op" id="5575998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576001">defer</span>&nbsp;<span class="keyword" id="5576007">func</span><span class="op" id="5576011">(</span><span class="op" id="5576012">)</span>&nbsp;<span class="op" id="5576014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5576018">recover</span><span class="op" id="5576025">(</span><span class="op" id="5576026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5576029">}</span><span class="op" id="5576030">(</span><span class="op" id="5576031">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576034">return</span>&nbsp;<span class="ident" id="5576041">a</span>&nbsp;<span class="op" id="5576043">==</span>&nbsp;<span class="ident" id="5576046">b</span><br>
<span class="lineno"></span><span class="op" id="5576048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5576051">func</span>&nbsp;<span class="op" id="5576056">(</span><span class="ident" id="5576057">c</span>&nbsp;<span class="op" id="5576059">*</span><span class="ident" id="5576060">Cmd</span><span class="op" id="5576063">)</span>&nbsp;<span class="ident" id="5576065">envv</span><span class="op" id="5576069">(</span><span class="op" id="5576070">)</span>&nbsp;<span class="op" id="5576072">[</span><span class="op" id="5576073">]</span><span class="builtintype" id="5576074">string</span>&nbsp;<span class="op" id="5576081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576084">if</span>&nbsp;<span class="ident" id="5576087">c</span><span class="op" id="5576088">.</span><span class="ident" id="5576089">Env</span>&nbsp;<span class="op" id="5576093">!=</span>&nbsp;<span class="ident" id="5576096">nil</span>&nbsp;<span class="op" id="5576100">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576104">return</span>&nbsp;<span class="ident" id="5576111">c</span><span class="op" id="5576112">.</span><span class="ident" id="5576113">Env</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5576118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576121">return</span>&nbsp;<span class="ident" id="5576128">os</span><span class="op" id="5576130">.</span><span class="ident" id="5576131">Environ</span><span class="op" id="5576138">(</span><span class="op" id="5576139">)</span><br>
<span class="lineno"></span><span class="op" id="5576141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="5576144">func</span>&nbsp;<span class="op" id="5576149">(</span><span class="ident" id="5576150">c</span>&nbsp;<span class="op" id="5576152">*</span><span class="ident" id="5576153">Cmd</span><span class="op" id="5576156">)</span>&nbsp;<span class="ident" id="5576158">argv</span><span class="op" id="5576162">(</span><span class="op" id="5576163">)</span>&nbsp;<span class="op" id="5576165">[</span><span class="op" id="5576166">]</span><span class="builtintype" id="5576167">string</span>&nbsp;<span class="op" id="5576174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576177">if</span>&nbsp;<span class="builtinfunc" id="5576180">len</span><span class="op" id="5576183">(</span><span class="ident" id="5576184">c</span><span class="op" id="5576185">.</span><span class="ident" id="5576186">Args</span><span class="op" id="5576190">)</span>&nbsp;<span class="op" id="5576192">&gt;</span>&nbsp;<span class="num" id="5576194">0</span>&nbsp;<span class="op" id="5576196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576200">return</span>&nbsp;<span class="ident" id="5576207">c</span><span class="op" id="5576208">.</span><span class="ident" id="5576209">Args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5576215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576218">return</span>&nbsp;<span class="op" id="5576225">[</span><span class="op" id="5576226">]</span><span class="builtintype" id="5576227">string</span><span class="op" id="5576233">{</span><span class="ident" id="5576234">c</span><span class="op" id="5576235">.</span><span class="ident" id="5576236">Path</span><span class="op" id="5576240">}</span><br>
<span class="lineno">155</span><span class="op" id="5576242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5576245">func</span>&nbsp;<span class="op" id="5576250">(</span><span class="ident" id="5576251">c</span>&nbsp;<span class="op" id="5576253">*</span><span class="ident" id="5576254">Cmd</span><span class="op" id="5576257">)</span>&nbsp;<span class="ident" id="5576259">stdin</span><span class="op" id="5576264">(</span><span class="op" id="5576265">)</span>&nbsp;<span class="op" id="5576267">(</span><span class="ident" id="5576268">f</span>&nbsp;<span class="op" id="5576270">*</span><span class="ident" id="5576271">os</span><span class="op" id="5576273">.</span><span class="ident" id="5576274">File</span><span class="op" id="5576278">,</span>&nbsp;<span class="ident" id="5576280">err</span>&nbsp;<span class="builtintype" id="5576284">error</span><span class="op" id="5576289">)</span>&nbsp;<span class="op" id="5576291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576294">if</span>&nbsp;<span class="ident" id="5576297">c</span><span class="op" id="5576298">.</span><span class="ident" id="5576299">Stdin</span>&nbsp;<span class="op" id="5576305">==</span>&nbsp;<span class="ident" id="5576308">nil</span>&nbsp;<span class="op" id="5576312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5576316">f</span><span class="op" id="5576317">,</span>&nbsp;<span class="ident" id="5576319">err</span>&nbsp;<span class="op" id="5576323">=</span>&nbsp;<span class="ident" id="5576325">os</span><span class="op" id="5576327">.</span><span class="ident" id="5576328">Open</span><span class="op" id="5576332">(</span><span class="ident" id="5576333">os</span><span class="op" id="5576335">.</span><span class="ident" id="5576336">DevNull</span><span class="op" id="5576343">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576347">if</span>&nbsp;<span class="ident" id="5576350">err</span>&nbsp;<span class="op" id="5576354">!=</span>&nbsp;<span class="ident" id="5576357">nil</span>&nbsp;<span class="op" id="5576361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576366">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5576375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5576379">c</span><span class="op" id="5576380">.</span><span class="ident" id="5576381">closeAfterStart</span>&nbsp;<span class="op" id="5576397">=</span>&nbsp;<span class="builtinfunc" id="5576399">append</span><span class="op" id="5576405">(</span><span class="ident" id="5576406">c</span><span class="op" id="5576407">.</span><span class="ident" id="5576408">closeAfterStart</span><span class="op" id="5576423">,</span>&nbsp;<span class="ident" id="5576425">f</span><span class="op" id="5576426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576430">return</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5576438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576442">if</span>&nbsp;<span class="ident" id="5576445">f</span><span class="op" id="5576446">,</span>&nbsp;<span class="ident" id="5576448">ok</span>&nbsp;<span class="op" id="5576451">:=</span>&nbsp;<span class="ident" id="5576454">c</span><span class="op" id="5576455">.</span><span class="ident" id="5576456">Stdin</span><span class="op" id="5576461">.</span><span class="op" id="5576462">(</span><span class="op" id="5576463">*</span><span class="ident" id="5576464">os</span><span class="op" id="5576466">.</span><span class="ident" id="5576467">File</span><span class="op" id="5576471">)</span><span class="op" id="5576472">;</span>&nbsp;<span class="ident" id="5576474">ok</span>&nbsp;<span class="op" id="5576477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576481">return</span>&nbsp;<span class="ident" id="5576488">f</span><span class="op" id="5576489">,</span>&nbsp;<span class="ident" id="5576491">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5576496">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5576500">pr</span><span class="op" id="5576502">,</span>&nbsp;<span class="ident" id="5576504">pw</span><span class="op" id="5576506">,</span>&nbsp;<span class="ident" id="5576508">err</span>&nbsp;<span class="op" id="5576512">:=</span>&nbsp;<span class="ident" id="5576515">os</span><span class="op" id="5576517">.</span><span class="ident" id="5576518">Pipe</span><span class="op" id="5576522">(</span><span class="op" id="5576523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576526">if</span>&nbsp;<span class="ident" id="5576529">err</span>&nbsp;<span class="op" id="5576533">!=</span>&nbsp;<span class="ident" id="5576536">nil</span>&nbsp;<span class="op" id="5576540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576544">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5576552">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5576556">c</span><span class="op" id="5576557">.</span><span class="ident" id="5576558">closeAfterStart</span>&nbsp;<span class="op" id="5576574">=</span>&nbsp;<span class="builtinfunc" id="5576576">append</span><span class="op" id="5576582">(</span><span class="ident" id="5576583">c</span><span class="op" id="5576584">.</span><span class="ident" id="5576585">closeAfterStart</span><span class="op" id="5576600">,</span>&nbsp;<span class="ident" id="5576602">pr</span><span class="op" id="5576604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5576607">c</span><span class="op" id="5576608">.</span><span class="ident" id="5576609">closeAfterWait</span>&nbsp;<span class="op" id="5576624">=</span>&nbsp;<span class="builtinfunc" id="5576626">append</span><span class="op" id="5576632">(</span><span class="ident" id="5576633">c</span><span class="op" id="5576634">.</span><span class="ident" id="5576635">closeAfterWait</span><span class="op" id="5576649">,</span>&nbsp;<span class="ident" id="5576651">pw</span><span class="op" id="5576653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5576656">c</span><span class="op" id="5576657">.</span><span class="ident" id="5576658">goroutine</span>&nbsp;<span class="op" id="5576668">=</span>&nbsp;<span class="builtinfunc" id="5576670">append</span><span class="op" id="5576676">(</span><span class="ident" id="5576677">c</span><span class="op" id="5576678">.</span><span class="ident" id="5576679">goroutine</span><span class="op" id="5576688">,</span>&nbsp;<span class="keyword" id="5576690">func</span><span class="op" id="5576694">(</span><span class="op" id="5576695">)</span>&nbsp;<span class="builtintype" id="5576697">error</span>&nbsp;<span class="op" id="5576703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5576707">_</span><span class="op" id="5576708">,</span>&nbsp;<span class="ident" id="5576710">err</span>&nbsp;<span class="op" id="5576714">:=</span>&nbsp;<span class="ident" id="5576717">io</span><span class="op" id="5576719">.</span><span class="ident" id="5576720">Copy</span><span class="op" id="5576724">(</span><span class="ident" id="5576725">pw</span><span class="op" id="5576727">,</span>&nbsp;<span class="ident" id="5576729">c</span><span class="op" id="5576730">.</span><span class="ident" id="5576731">Stdin</span><span class="op" id="5576736">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576740">if</span>&nbsp;<span class="ident" id="5576743">err1</span>&nbsp;<span class="op" id="5576748">:=</span>&nbsp;<span class="ident" id="5576751">pw</span><span class="op" id="5576753">.</span><span class="ident" id="5576754">Close</span><span class="op" id="5576759">(</span><span class="op" id="5576760">)</span><span class="op" id="5576761">;</span>&nbsp;<span class="ident" id="5576763">err</span>&nbsp;<span class="op" id="5576767">==</span>&nbsp;<span class="ident" id="5576770">nil</span>&nbsp;<span class="op" id="5576774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5576779">err</span>&nbsp;<span class="op" id="5576783">=</span>&nbsp;<span class="ident" id="5576785">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5576792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576796">return</span>&nbsp;<span class="ident" id="5576803">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5576808">}</span><span class="op" id="5576809">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576812">return</span>&nbsp;<span class="ident" id="5576819">pr</span><span class="op" id="5576821">,</span>&nbsp;<span class="ident" id="5576823">nil</span><br>
<span class="lineno"></span><span class="op" id="5576827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5576830">func</span>&nbsp;<span class="op" id="5576835">(</span><span class="ident" id="5576836">c</span>&nbsp;<span class="op" id="5576838">*</span><span class="ident" id="5576839">Cmd</span><span class="op" id="5576842">)</span>&nbsp;<span class="ident" id="5576844">stdout</span><span class="op" id="5576850">(</span><span class="op" id="5576851">)</span>&nbsp;<span class="op" id="5576853">(</span><span class="ident" id="5576854">f</span>&nbsp;<span class="op" id="5576856">*</span><span class="ident" id="5576857">os</span><span class="op" id="5576859">.</span><span class="ident" id="5576860">File</span><span class="op" id="5576864">,</span>&nbsp;<span class="ident" id="5576866">err</span>&nbsp;<span class="builtintype" id="5576870">error</span><span class="op" id="5576875">)</span>&nbsp;<span class="op" id="5576877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576880">return</span>&nbsp;<span class="ident" id="5576887">c</span><span class="op" id="5576888">.</span><span class="ident" id="5576889">writerDescriptor</span><span class="op" id="5576905">(</span><span class="ident" id="5576906">c</span><span class="op" id="5576907">.</span><span class="ident" id="5576908">Stdout</span><span class="op" id="5576914">)</span><br>
<span class="lineno">190</span><span class="op" id="5576916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5576919">func</span>&nbsp;<span class="op" id="5576924">(</span><span class="ident" id="5576925">c</span>&nbsp;<span class="op" id="5576927">*</span><span class="ident" id="5576928">Cmd</span><span class="op" id="5576931">)</span>&nbsp;<span class="ident" id="5576933">stderr</span><span class="op" id="5576939">(</span><span class="op" id="5576940">)</span>&nbsp;<span class="op" id="5576942">(</span><span class="ident" id="5576943">f</span>&nbsp;<span class="op" id="5576945">*</span><span class="ident" id="5576946">os</span><span class="op" id="5576948">.</span><span class="ident" id="5576949">File</span><span class="op" id="5576953">,</span>&nbsp;<span class="ident" id="5576955">err</span>&nbsp;<span class="builtintype" id="5576959">error</span><span class="op" id="5576964">)</span>&nbsp;<span class="op" id="5576966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5576969">if</span>&nbsp;<span class="ident" id="5576972">c</span><span class="op" id="5576973">.</span><span class="ident" id="5576974">Stderr</span>&nbsp;<span class="op" id="5576981">!=</span>&nbsp;<span class="ident" id="5576984">nil</span>&nbsp;<span class="op" id="5576988">&amp;&amp;</span>&nbsp;<span class="ident" id="5576991">interfaceEqual</span><span class="op" id="5577005">(</span><span class="ident" id="5577006">c</span><span class="op" id="5577007">.</span><span class="ident" id="5577008">Stderr</span><span class="op" id="5577014">,</span>&nbsp;<span class="ident" id="5577016">c</span><span class="op" id="5577017">.</span><span class="ident" id="5577018">Stdout</span><span class="op" id="5577024">)</span>&nbsp;<span class="op" id="5577026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5577030">return</span>&nbsp;<span class="ident" id="5577037">c</span><span class="op" id="5577038">.</span><span class="ident" id="5577039">childFiles</span><span class="op" id="5577049">[</span><span class="num" id="5577050">1</span><span class="op" id="5577051">]</span><span class="op" id="5577052">,</span>&nbsp;<span class="ident" id="5577054">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5577059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5577062">return</span>&nbsp;<span class="ident" id="5577069">c</span><span class="op" id="5577070">.</span><span class="ident" id="5577071">writerDescriptor</span><span class="op" id="5577087">(</span><span class="ident" id="5577088">c</span><span class="op" id="5577089">.</span><span class="ident" id="5577090">Stderr</span><span class="op" id="5577096">)</span><br>
<span class="lineno"></span><span class="op" id="5577098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5577101">func</span>&nbsp;<span class="op" id="5577106">(</span><span class="ident" id="5577107">c</span>&nbsp;<span class="op" id="5577109">*</span><span class="ident" id="5577110">Cmd</span><span class="op" id="5577113">)</span>&nbsp;<span class="ident" id="5577115">writerDescriptor</span><span class="op" id="5577131">(</span><span class="ident" id="5577132">w</span>&nbsp;<span class="ident" id="5577134">io</span><span class="op" id="5577136">.</span><span class="ident" id="5577137">Writer</span><span class="op" id="5577143">)</span>&nbsp;<span class="op" id="5577145">(</span><span class="ident" id="5577146">f</span>&nbsp;<span class="op" id="5577148">*</span><span class="ident" id="5577149">os</span><span class="op" id="5577151">.</span><span class="ident" id="5577152">File</span><span class="op" id="5577156">,</span>&nbsp;<span class="ident" id="5577158">err</span>&nbsp;<span class="builtintype" id="5577162">error</span><span class="op" id="5577167">)</span>&nbsp;<span class="op" id="5577169">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5577172">if</span>&nbsp;<span class="ident" id="5577175">w</span>&nbsp;<span class="op" id="5577177">==</span>&nbsp;<span class="ident" id="5577180">nil</span>&nbsp;<span class="op" id="5577184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5577188">f</span><span class="op" id="5577189">,</span>&nbsp;<span class="ident" id="5577191">err</span>&nbsp;<span class="op" id="5577195">=</span>&nbsp;<span class="ident" id="5577197">os</span><span class="op" id="5577199">.</span><span class="ident" id="5577200">OpenFile</span><span class="op" id="5577208">(</span><span class="ident" id="5577209">os</span><span class="op" id="5577211">.</span><span class="ident" id="5577212">DevNull</span><span class="op" id="5577219">,</span>&nbsp;<span class="ident" id="5577221">os</span><span class="op" id="5577223">.</span><span class="ident" id="5577224">O_WRONLY</span><span class="op" id="5577232">,</span>&nbsp;<span class="num" id="5577234">0</span><span class="op" id="5577235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5577239">if</span>&nbsp;<span class="ident" id="5577242">err</span>&nbsp;<span class="op" id="5577246">!=</span>&nbsp;<span class="ident" id="5577249">nil</span>&nbsp;<span class="op" id="5577253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5577258">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5577267">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5577271">c</span><span class="op" id="5577272">.</span><span class="ident" id="5577273">closeAfterStart</span>&nbsp;<span class="op" id="5577289">=</span>&nbsp;<span class="builtinfunc" id="5577291">append</span><span class="op" id="5577297">(</span><span class="ident" id="5577298">c</span><span class="op" id="5577299">.</span><span class="ident" id="5577300">closeAfterStart</span><span class="op" id="5577315">,</span>&nbsp;<span class="ident" id="5577317">f</span><span class="op" id="5577318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5577322">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5577330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5577334">if</span>&nbsp;<span class="ident" id="5577337">f</span><span class="op" id="5577338">,</span>&nbsp;<span class="ident" id="5577340">ok</span>&nbsp;<span class="op" id="5577343">:=</span>&nbsp;<span class="ident" id="5577346">w</span><span class="op" id="5577347">.</span><span class="op" id="5577348">(</span><span class="op" id="5577349">*</span><span class="ident" id="5577350">os</span><span class="op" id="5577352">.</span><span class="ident" id="5577353">File</span><span class="op" id="5577357">)</span><span class="op" id="5577358">;</span>&nbsp;<span class="ident" id="5577360">ok</span>&nbsp;<span class="op" id="5577363">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5577367">return</span>&nbsp;<span class="ident" id="5577374">f</span><span class="op" id="5577375">,</span>&nbsp;<span class="ident" id="5577377">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5577382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5577386">pr</span><span class="op" id="5577388">,</span>&nbsp;<span class="ident" id="5577390">pw</span><span class="op" id="5577392">,</span>&nbsp;<span class="ident" id="5577394">err</span>&nbsp;<span class="op" id="5577398">:=</span>&nbsp;<span class="ident" id="5577401">os</span><span class="op" id="5577403">.</span><span class="ident" id="5577404">Pipe</span><span class="op" id="5577408">(</span><span class="op" id="5577409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5577412">if</span>&nbsp;<span class="ident" id="5577415">err</span>&nbsp;<span class="op" id="5577419">!=</span>&nbsp;<span class="ident" id="5577422">nil</span>&nbsp;<span class="op" id="5577426">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5577430">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5577438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5577442">c</span><span class="op" id="5577443">.</span><span class="ident" id="5577444">closeAfterStart</span>&nbsp;<span class="op" id="5577460">=</span>&nbsp;<span class="builtinfunc" id="5577462">append</span><span class="op" id="5577468">(</span><span class="ident" id="5577469">c</span><span class="op" id="5577470">.</span><span class="ident" id="5577471">closeAfterStart</span><span class="op" id="5577486">,</span>&nbsp;<span class="ident" id="5577488">pw</span><span class="op" id="5577490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5577493">c</span><span class="op" id="5577494">.</span><span class="ident" id="5577495">closeAfterWait</span>&nbsp;<span class="op" id="5577510">=</span>&nbsp;<span class="builtinfunc" id="5577512">append</span><span class="op" id="5577518">(</span><span class="ident" id="5577519">c</span><span class="op" id="5577520">.</span><span class="ident" id="5577521">closeAfterWait</span><span class="op" id="5577535">,</span>&nbsp;<span class="ident" id="5577537">pr</span><span class="op" id="5577539">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5577542">c</span><span class="op" id="5577543">.</span><span class="ident" id="5577544">goroutine</span>&nbsp;<span class="op" id="5577554">=</span>&nbsp;<span class="builtinfunc" id="5577556">append</span><span class="op" id="5577562">(</span><span class="ident" id="5577563">c</span><span class="op" id="5577564">.</span><span class="ident" id="5577565">goroutine</span><span class="op" id="5577574">,</span>&nbsp;<span class="keyword" id="5577576">func</span><span class="op" id="5577580">(</span><span class="op" id="5577581">)</span>&nbsp;<span class="builtintype" id="5577583">error</span>&nbsp;<span class="op" id="5577589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5577593">_</span><span class="op" id="5577594">,</span>&nbsp;<span class="ident" id="5577596">err</span>&nbsp;<span class="op" id="5577600">:=</span>&nbsp;<span class="ident" id="5577603">io</span><span class="op" id="5577605">.</span><span class="ident" id="5577606">Copy</span><span class="op" id="5577610">(</span><span class="ident" id="5577611">w</span><span class="op" id="5577612">,</span>&nbsp;<span class="ident" id="5577614">pr</span><span class="op" id="5577616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5577620">return</span>&nbsp;<span class="ident" id="5577627">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5577632">}</span><span class="op" id="5577633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5577636">return</span>&nbsp;<span class="ident" id="5577643">pw</span><span class="op" id="5577645">,</span>&nbsp;<span class="ident" id="5577647">nil</span><br>
<span class="lineno">225</span><span class="op" id="5577651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5577654">func</span>&nbsp;<span class="op" id="5577659">(</span><span class="ident" id="5577660">c</span>&nbsp;<span class="op" id="5577662">*</span><span class="ident" id="5577663">Cmd</span><span class="op" id="5577666">)</span>&nbsp;<span class="ident" id="5577668">closeDescriptors</span><span class="op" id="5577684">(</span><span class="ident" id="5577685">closers</span>&nbsp;<span class="op" id="5577693">[</span><span class="op" id="5577694">]</span><span class="ident" id="5577695">io</span><span class="op" id="5577697">.</span><span class="ident" id="5577698">Closer</span><span class="op" id="5577704">)</span>&nbsp;<span class="op" id="5577706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5577709">for</span>&nbsp;<span class="ident" id="5577713">_</span><span class="op" id="5577714">,</span>&nbsp;<span class="ident" id="5577716">fd</span>&nbsp;<span class="op" id="5577719">:=</span>&nbsp;<span class="keyword" id="5577722">range</span>&nbsp;<span class="ident" id="5577728">closers</span>&nbsp;<span class="op" id="5577736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5577740">fd</span><span class="op" id="5577742">.</span><span class="ident" id="5577743">Close</span><span class="op" id="5577748">(</span><span class="op" id="5577749">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5577752">}</span><br>
<span class="lineno"></span><span class="op" id="5577754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5577757">//&nbsp;Run&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;and&nbsp;waits&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5577823">//</span><br>
<span class="lineno">235</span><span class="comment" id="5577826">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5577892">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5577957">//&nbsp;status.</span><br>
<span class="lineno"></span><span class="comment" id="5577968">//</span><br>
<span class="lineno"></span><span class="comment" id="5577971">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno">240</span><span class="comment" id="5578040">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5578097">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="keyword" id="5578127">func</span>&nbsp;<span class="op" id="5578132">(</span><span class="ident" id="5578133">c</span>&nbsp;<span class="op" id="5578135">*</span><span class="ident" id="5578136">Cmd</span><span class="op" id="5578139">)</span>&nbsp;<span class="ident" id="5578141">Run</span><span class="op" id="5578144">(</span><span class="op" id="5578145">)</span>&nbsp;<span class="builtintype" id="5578147">error</span>&nbsp;<span class="op" id="5578153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5578156">if</span>&nbsp;<span class="ident" id="5578159">err</span>&nbsp;<span class="op" id="5578163">:=</span>&nbsp;<span class="ident" id="5578166">c</span><span class="op" id="5578167">.</span><span class="ident" id="5578168">Start</span><span class="op" id="5578173">(</span><span class="op" id="5578174">)</span><span class="op" id="5578175">;</span>&nbsp;<span class="ident" id="5578177">err</span>&nbsp;<span class="op" id="5578181">!=</span>&nbsp;<span class="ident" id="5578184">nil</span>&nbsp;<span class="op" id="5578188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5578192">return</span>&nbsp;<span class="ident" id="5578199">err</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5578204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5578207">return</span>&nbsp;<span class="ident" id="5578214">c</span><span class="op" id="5578215">.</span><span class="ident" id="5578216">Wait</span><span class="op" id="5578220">(</span><span class="op" id="5578221">)</span><br>
<span class="lineno"></span><span class="op" id="5578223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5578226">//&nbsp;lookExtensions&nbsp;finds&nbsp;windows&nbsp;executable&nbsp;by&nbsp;its&nbsp;dir&nbsp;and&nbsp;path.</span><br>
<span class="lineno">250</span><span class="comment" id="5578290">//&nbsp;It&nbsp;uses&nbsp;LookPath&nbsp;to&nbsp;try&nbsp;appropriate&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="comment" id="5578341">//&nbsp;lookExtensions&nbsp;does&nbsp;not&nbsp;search&nbsp;PATH,&nbsp;instead&nbsp;it&nbsp;converts&nbsp;`prog`&nbsp;into&nbsp;`.\prog`.</span><br>
<span class="lineno"></span><span class="keyword" id="5578423">func</span>&nbsp;<span class="ident" id="5578428">lookExtensions</span><span class="op" id="5578442">(</span><span class="ident" id="5578443">path</span><span class="op" id="5578447">,</span>&nbsp;<span class="ident" id="5578449">dir</span>&nbsp;<span class="builtintype" id="5578453">string</span><span class="op" id="5578459">)</span>&nbsp;<span class="op" id="5578461">(</span><span class="builtintype" id="5578462">string</span><span class="op" id="5578468">,</span>&nbsp;<span class="builtintype" id="5578470">error</span><span class="op" id="5578475">)</span>&nbsp;<span class="op" id="5578477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5578480">if</span>&nbsp;<span class="ident" id="5578483">filepath</span><span class="op" id="5578491">.</span><span class="ident" id="5578492">Base</span><span class="op" id="5578496">(</span><span class="ident" id="5578497">path</span><span class="op" id="5578501">)</span>&nbsp;<span class="op" id="5578503">==</span>&nbsp;<span class="ident" id="5578506">path</span>&nbsp;<span class="op" id="5578511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5578515">path</span>&nbsp;<span class="op" id="5578520">=</span>&nbsp;<span class="ident" id="5578522">filepath</span><span class="op" id="5578530">.</span><span class="ident" id="5578531">Join</span><span class="op" id="5578535">(</span><span class="string" id="5578536">&#34;.&#34;</span><span class="op" id="5578539">,</span>&nbsp;<span class="ident" id="5578541">path</span><span class="op" id="5578545">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5578548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5578551">if</span>&nbsp;<span class="ident" id="5578554">dir</span>&nbsp;<span class="op" id="5578558">==</span>&nbsp;<span class="string" id="5578561">&#34;&#34;</span>&nbsp;<span class="op" id="5578564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5578568">return</span>&nbsp;<span class="ident" id="5578575">LookPath</span><span class="op" id="5578583">(</span><span class="ident" id="5578584">path</span><span class="op" id="5578588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5578591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5578594">if</span>&nbsp;<span class="ident" id="5578597">filepath</span><span class="op" id="5578605">.</span><span class="ident" id="5578606">VolumeName</span><span class="op" id="5578616">(</span><span class="ident" id="5578617">path</span><span class="op" id="5578621">)</span>&nbsp;<span class="op" id="5578623">!=</span>&nbsp;<span class="string" id="5578626">&#34;&#34;</span>&nbsp;<span class="op" id="5578629">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5578633">return</span>&nbsp;<span class="ident" id="5578640">LookPath</span><span class="op" id="5578648">(</span><span class="ident" id="5578649">path</span><span class="op" id="5578653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5578656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5578659">if</span>&nbsp;<span class="builtinfunc" id="5578662">len</span><span class="op" id="5578665">(</span><span class="ident" id="5578666">path</span><span class="op" id="5578670">)</span>&nbsp;<span class="op" id="5578672">&gt;</span>&nbsp;<span class="num" id="5578674">1</span>&nbsp;<span class="op" id="5578676">&amp;&amp;</span>&nbsp;<span class="ident" id="5578679">os</span><span class="op" id="5578681">.</span><span class="ident" id="5578682">IsPathSeparator</span><span class="op" id="5578697">(</span><span class="ident" id="5578698">path</span><span class="op" id="5578702">[</span><span class="num" id="5578703">0</span><span class="op" id="5578704">]</span><span class="op" id="5578705">)</span>&nbsp;<span class="op" id="5578707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5578711">return</span>&nbsp;<span class="ident" id="5578718">LookPath</span><span class="op" id="5578726">(</span><span class="ident" id="5578727">path</span><span class="op" id="5578731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5578734">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5578737">dirandpath</span>&nbsp;<span class="op" id="5578748">:=</span>&nbsp;<span class="ident" id="5578751">filepath</span><span class="op" id="5578759">.</span><span class="ident" id="5578760">Join</span><span class="op" id="5578764">(</span><span class="ident" id="5578765">dir</span><span class="op" id="5578768">,</span>&nbsp;<span class="ident" id="5578770">path</span><span class="op" id="5578774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5578777">//&nbsp;We&nbsp;assume&nbsp;that&nbsp;LookPath&nbsp;will&nbsp;only&nbsp;add&nbsp;file&nbsp;extension.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5578835">lp</span><span class="op" id="5578837">,</span>&nbsp;<span class="ident" id="5578839">err</span>&nbsp;<span class="op" id="5578843">:=</span>&nbsp;<span class="ident" id="5578846">LookPath</span><span class="op" id="5578854">(</span><span class="ident" id="5578855">dirandpath</span><span class="op" id="5578865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5578868">if</span>&nbsp;<span class="ident" id="5578871">err</span>&nbsp;<span class="op" id="5578875">!=</span>&nbsp;<span class="ident" id="5578878">nil</span>&nbsp;<span class="op" id="5578882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5578886">return</span>&nbsp;<span class="string" id="5578893">&#34;&#34;</span><span class="op" id="5578895">,</span>&nbsp;<span class="ident" id="5578897">err</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5578902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5578905">ext</span>&nbsp;<span class="op" id="5578909">:=</span>&nbsp;<span class="ident" id="5578912">strings</span><span class="op" id="5578919">.</span><span class="ident" id="5578920">TrimPrefix</span><span class="op" id="5578930">(</span><span class="ident" id="5578931">lp</span><span class="op" id="5578933">,</span>&nbsp;<span class="ident" id="5578935">dirandpath</span><span class="op" id="5578945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5578948">return</span>&nbsp;<span class="ident" id="5578955">path</span>&nbsp;<span class="op" id="5578960">+</span>&nbsp;<span class="ident" id="5578962">ext</span><span class="op" id="5578965">,</span>&nbsp;<span class="ident" id="5578967">nil</span><br>
<span class="lineno"></span><span class="op" id="5578971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="5578974">//&nbsp;Start&nbsp;starts&nbsp;the&nbsp;specified&nbsp;command&nbsp;but&nbsp;does&nbsp;not&nbsp;wait&nbsp;for&nbsp;it&nbsp;to&nbsp;complete.</span><br>
<span class="lineno"></span><span class="comment" id="5579050">//</span><br>
<span class="lineno"></span><span class="comment" id="5579053">//&nbsp;The&nbsp;Wait&nbsp;method&nbsp;will&nbsp;return&nbsp;the&nbsp;exit&nbsp;code&nbsp;and&nbsp;release&nbsp;associated&nbsp;resources</span><br>
<span class="lineno"></span><span class="comment" id="5579131">//&nbsp;once&nbsp;the&nbsp;command&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="5579158">func</span>&nbsp;<span class="op" id="5579163">(</span><span class="ident" id="5579164">c</span>&nbsp;<span class="op" id="5579166">*</span><span class="ident" id="5579167">Cmd</span><span class="op" id="5579170">)</span>&nbsp;<span class="ident" id="5579172">Start</span><span class="op" id="5579177">(</span><span class="op" id="5579178">)</span>&nbsp;<span class="builtintype" id="5579180">error</span>&nbsp;<span class="op" id="5579186">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5579189">if</span>&nbsp;<span class="ident" id="5579192">c</span><span class="op" id="5579193">.</span><span class="ident" id="5579194">lookPathErr</span>&nbsp;<span class="op" id="5579206">!=</span>&nbsp;<span class="ident" id="5579209">nil</span>&nbsp;<span class="op" id="5579213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5579217">c</span><span class="op" id="5579218">.</span><span class="ident" id="5579219">closeDescriptors</span><span class="op" id="5579235">(</span><span class="ident" id="5579236">c</span><span class="op" id="5579237">.</span><span class="ident" id="5579238">closeAfterStart</span><span class="op" id="5579253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5579257">c</span><span class="op" id="5579258">.</span><span class="ident" id="5579259">closeDescriptors</span><span class="op" id="5579275">(</span><span class="ident" id="5579276">c</span><span class="op" id="5579277">.</span><span class="ident" id="5579278">closeAfterWait</span><span class="op" id="5579292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5579296">return</span>&nbsp;<span class="ident" id="5579303">c</span><span class="op" id="5579304">.</span><span class="ident" id="5579305">lookPathErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5579318">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5579321">if</span>&nbsp;<span class="ident" id="5579324">runtime</span><span class="op" id="5579331">.</span><span class="ident" id="5579332">GOOS</span>&nbsp;<span class="op" id="5579337">==</span>&nbsp;<span class="string" id="5579340">&#34;windows&#34;</span>&nbsp;<span class="op" id="5579350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5579354">lp</span><span class="op" id="5579356">,</span>&nbsp;<span class="ident" id="5579358">err</span>&nbsp;<span class="op" id="5579362">:=</span>&nbsp;<span class="ident" id="5579365">lookExtensions</span><span class="op" id="5579379">(</span><span class="ident" id="5579380">c</span><span class="op" id="5579381">.</span><span class="ident" id="5579382">Path</span><span class="op" id="5579386">,</span>&nbsp;<span class="ident" id="5579388">c</span><span class="op" id="5579389">.</span><span class="ident" id="5579390">Dir</span><span class="op" id="5579393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5579397">if</span>&nbsp;<span class="ident" id="5579400">err</span>&nbsp;<span class="op" id="5579404">!=</span>&nbsp;<span class="ident" id="5579407">nil</span>&nbsp;<span class="op" id="5579411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5579416">c</span><span class="op" id="5579417">.</span><span class="ident" id="5579418">closeDescriptors</span><span class="op" id="5579434">(</span><span class="ident" id="5579435">c</span><span class="op" id="5579436">.</span><span class="ident" id="5579437">closeAfterStart</span><span class="op" id="5579452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5579457">c</span><span class="op" id="5579458">.</span><span class="ident" id="5579459">closeDescriptors</span><span class="op" id="5579475">(</span><span class="ident" id="5579476">c</span><span class="op" id="5579477">.</span><span class="ident" id="5579478">closeAfterWait</span><span class="op" id="5579492">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5579497">return</span>&nbsp;<span class="ident" id="5579504">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5579510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5579514">c</span><span class="op" id="5579515">.</span><span class="ident" id="5579516">Path</span>&nbsp;<span class="op" id="5579521">=</span>&nbsp;<span class="ident" id="5579523">lp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5579527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5579530">if</span>&nbsp;<span class="ident" id="5579533">c</span><span class="op" id="5579534">.</span><span class="ident" id="5579535">Process</span>&nbsp;<span class="op" id="5579543">!=</span>&nbsp;<span class="ident" id="5579546">nil</span>&nbsp;<span class="op" id="5579550">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5579554">return</span>&nbsp;<span class="ident" id="5579561">errors</span><span class="op" id="5579567">.</span><span class="ident" id="5579568">New</span><span class="op" id="5579571">(</span><span class="string" id="5579572">&#34;exec:&nbsp;already&nbsp;started&#34;</span><span class="op" id="5579595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5579598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5579602">type</span>&nbsp;<span class="ident" id="5579607">F</span>&nbsp;<span class="keyword" id="5579609">func</span><span class="op" id="5579613">(</span><span class="op" id="5579614">*</span><span class="ident" id="5579615">Cmd</span><span class="op" id="5579618">)</span>&nbsp;<span class="op" id="5579620">(</span><span class="op" id="5579621">*</span><span class="ident" id="5579622">os</span><span class="op" id="5579624">.</span><span class="ident" id="5579625">File</span><span class="op" id="5579629">,</span>&nbsp;<span class="builtintype" id="5579631">error</span><span class="op" id="5579636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5579639">for</span>&nbsp;<span class="ident" id="5579643">_</span><span class="op" id="5579644">,</span>&nbsp;<span class="ident" id="5579646">setupFd</span>&nbsp;<span class="op" id="5579654">:=</span>&nbsp;<span class="keyword" id="5579657">range</span>&nbsp;<span class="op" id="5579663">[</span><span class="op" id="5579664">]</span><span class="ident" id="5579665">F</span><span class="op" id="5579666">{</span><span class="op" id="5579667">(</span><span class="op" id="5579668">*</span><span class="ident" id="5579669">Cmd</span><span class="op" id="5579672">)</span><span class="op" id="5579673">.</span><span class="ident" id="5579674">stdin</span><span class="op" id="5579679">,</span>&nbsp;<span class="op" id="5579681">(</span><span class="op" id="5579682">*</span><span class="ident" id="5579683">Cmd</span><span class="op" id="5579686">)</span><span class="op" id="5579687">.</span><span class="ident" id="5579688">stdout</span><span class="op" id="5579694">,</span>&nbsp;<span class="op" id="5579696">(</span><span class="op" id="5579697">*</span><span class="ident" id="5579698">Cmd</span><span class="op" id="5579701">)</span><span class="op" id="5579702">.</span><span class="ident" id="5579703">stderr</span><span class="op" id="5579709">}</span>&nbsp;<span class="op" id="5579711">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5579715">fd</span><span class="op" id="5579717">,</span>&nbsp;<span class="ident" id="5579719">err</span>&nbsp;<span class="op" id="5579723">:=</span>&nbsp;<span class="ident" id="5579726">setupFd</span><span class="op" id="5579733">(</span><span class="ident" id="5579734">c</span><span class="op" id="5579735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5579739">if</span>&nbsp;<span class="ident" id="5579742">err</span>&nbsp;<span class="op" id="5579746">!=</span>&nbsp;<span class="ident" id="5579749">nil</span>&nbsp;<span class="op" id="5579753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5579758">c</span><span class="op" id="5579759">.</span><span class="ident" id="5579760">closeDescriptors</span><span class="op" id="5579776">(</span><span class="ident" id="5579777">c</span><span class="op" id="5579778">.</span><span class="ident" id="5579779">closeAfterStart</span><span class="op" id="5579794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5579799">c</span><span class="op" id="5579800">.</span><span class="ident" id="5579801">closeDescriptors</span><span class="op" id="5579817">(</span><span class="ident" id="5579818">c</span><span class="op" id="5579819">.</span><span class="ident" id="5579820">closeAfterWait</span><span class="op" id="5579834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5579839">return</span>&nbsp;<span class="ident" id="5579846">err</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5579852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5579856">c</span><span class="op" id="5579857">.</span><span class="ident" id="5579858">childFiles</span>&nbsp;<span class="op" id="5579869">=</span>&nbsp;<span class="builtinfunc" id="5579871">append</span><span class="op" id="5579877">(</span><span class="ident" id="5579878">c</span><span class="op" id="5579879">.</span><span class="ident" id="5579880">childFiles</span><span class="op" id="5579890">,</span>&nbsp;<span class="ident" id="5579892">fd</span><span class="op" id="5579894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5579897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5579900">c</span><span class="op" id="5579901">.</span><span class="ident" id="5579902">childFiles</span>&nbsp;<span class="op" id="5579913">=</span>&nbsp;<span class="builtinfunc" id="5579915">append</span><span class="op" id="5579921">(</span><span class="ident" id="5579922">c</span><span class="op" id="5579923">.</span><span class="ident" id="5579924">childFiles</span><span class="op" id="5579934">,</span>&nbsp;<span class="ident" id="5579936">c</span><span class="op" id="5579937">.</span><span class="ident" id="5579938">ExtraFiles</span><span class="op" id="5579948">...</span><span class="op" id="5579951">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5579955">var</span>&nbsp;<span class="ident" id="5579959">err</span>&nbsp;<span class="builtintype" id="5579963">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5579970">c</span><span class="op" id="5579971">.</span><span class="ident" id="5579972">Process</span><span class="op" id="5579979">,</span>&nbsp;<span class="ident" id="5579981">err</span>&nbsp;<span class="op" id="5579985">=</span>&nbsp;<span class="ident" id="5579987">os</span><span class="op" id="5579989">.</span><span class="ident" id="5579990">StartProcess</span><span class="op" id="5580002">(</span><span class="ident" id="5580003">c</span><span class="op" id="5580004">.</span><span class="ident" id="5580005">Path</span><span class="op" id="5580009">,</span>&nbsp;<span class="ident" id="5580011">c</span><span class="op" id="5580012">.</span><span class="ident" id="5580013">argv</span><span class="op" id="5580017">(</span><span class="op" id="5580018">)</span><span class="op" id="5580019">,</span>&nbsp;<span class="op" id="5580021">&amp;</span><span class="ident" id="5580022">os</span><span class="op" id="5580024">.</span><span class="ident" id="5580025">ProcAttr</span><span class="op" id="5580033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5580037">Dir</span><span class="op" id="5580040">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5580044">c</span><span class="op" id="5580045">.</span><span class="ident" id="5580046">Dir</span><span class="op" id="5580049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5580053">Files</span><span class="op" id="5580058">:</span>&nbsp;<span class="ident" id="5580060">c</span><span class="op" id="5580061">.</span><span class="ident" id="5580062">childFiles</span><span class="op" id="5580072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5580076">Env</span><span class="op" id="5580079">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5580083">c</span><span class="op" id="5580084">.</span><span class="ident" id="5580085">envv</span><span class="op" id="5580089">(</span><span class="op" id="5580090">)</span><span class="op" id="5580091">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5580095">Sys</span><span class="op" id="5580098">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5580102">c</span><span class="op" id="5580103">.</span><span class="ident" id="5580104">SysProcAttr</span><span class="op" id="5580115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5580118">}</span><span class="op" id="5580119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5580122">if</span>&nbsp;<span class="ident" id="5580125">err</span>&nbsp;<span class="op" id="5580129">!=</span>&nbsp;<span class="ident" id="5580132">nil</span>&nbsp;<span class="op" id="5580136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5580140">c</span><span class="op" id="5580141">.</span><span class="ident" id="5580142">closeDescriptors</span><span class="op" id="5580158">(</span><span class="ident" id="5580159">c</span><span class="op" id="5580160">.</span><span class="ident" id="5580161">closeAfterStart</span><span class="op" id="5580176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5580180">c</span><span class="op" id="5580181">.</span><span class="ident" id="5580182">closeDescriptors</span><span class="op" id="5580198">(</span><span class="ident" id="5580199">c</span><span class="op" id="5580200">.</span><span class="ident" id="5580201">closeAfterWait</span><span class="op" id="5580215">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5580219">return</span>&nbsp;<span class="ident" id="5580226">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5580231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5580235">c</span><span class="op" id="5580236">.</span><span class="ident" id="5580237">closeDescriptors</span><span class="op" id="5580253">(</span><span class="ident" id="5580254">c</span><span class="op" id="5580255">.</span><span class="ident" id="5580256">closeAfterStart</span><span class="op" id="5580271">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5580275">c</span><span class="op" id="5580276">.</span><span class="ident" id="5580277">errch</span>&nbsp;<span class="op" id="5580283">=</span>&nbsp;<span class="builtinfunc" id="5580285">make</span><span class="op" id="5580289">(</span><span class="keyword" id="5580290">chan</span>&nbsp;<span class="builtintype" id="5580295">error</span><span class="op" id="5580300">,</span>&nbsp;<span class="builtinfunc" id="5580302">len</span><span class="op" id="5580305">(</span><span class="ident" id="5580306">c</span><span class="op" id="5580307">.</span><span class="ident" id="5580308">goroutine</span><span class="op" id="5580317">)</span><span class="op" id="5580318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5580321">for</span>&nbsp;<span class="ident" id="5580325">_</span><span class="op" id="5580326">,</span>&nbsp;<span class="ident" id="5580328">fn</span>&nbsp;<span class="op" id="5580331">:=</span>&nbsp;<span class="keyword" id="5580334">range</span>&nbsp;<span class="ident" id="5580340">c</span><span class="op" id="5580341">.</span><span class="ident" id="5580342">goroutine</span>&nbsp;<span class="op" id="5580352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5580356">go</span>&nbsp;<span class="keyword" id="5580359">func</span><span class="op" id="5580363">(</span><span class="ident" id="5580364">fn</span>&nbsp;<span class="keyword" id="5580367">func</span><span class="op" id="5580371">(</span><span class="op" id="5580372">)</span>&nbsp;<span class="builtintype" id="5580374">error</span><span class="op" id="5580379">)</span>&nbsp;<span class="op" id="5580381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5580386">c</span><span class="op" id="5580387">.</span><span class="ident" id="5580388">errch</span>&nbsp;<span class="op" id="5580394">&lt;-</span>&nbsp;<span class="ident" id="5580397">fn</span><span class="op" id="5580399">(</span><span class="op" id="5580400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5580404">}</span><span class="op" id="5580405">(</span><span class="ident" id="5580406">fn</span><span class="op" id="5580408">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5580411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5580415">return</span>&nbsp;<span class="ident" id="5580422">nil</span><br>
<span class="lineno"></span><span class="op" id="5580426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="comment" id="5580429">//&nbsp;An&nbsp;ExitError&nbsp;reports&nbsp;an&nbsp;unsuccessful&nbsp;exit&nbsp;by&nbsp;a&nbsp;command.</span><br>
<span class="lineno"></span><span class="keyword" id="5580488">type</span>&nbsp;<span class="ident" id="5580493">ExitError</span>&nbsp;<span class="keyword" id="5580503">struct</span>&nbsp;<span class="op" id="5580510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5580513">*</span><span class="ident" id="5580514">os</span><span class="op" id="5580516">.</span><span class="ident" id="5580517">ProcessState</span><br>
<span class="lineno"></span><span class="op" id="5580530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="keyword" id="5580533">func</span>&nbsp;<span class="op" id="5580538">(</span><span class="ident" id="5580539">e</span>&nbsp;<span class="op" id="5580541">*</span><span class="ident" id="5580542">ExitError</span><span class="op" id="5580551">)</span>&nbsp;<span class="ident" id="5580553">Error</span><span class="op" id="5580558">(</span><span class="op" id="5580559">)</span>&nbsp;<span class="builtintype" id="5580561">string</span>&nbsp;<span class="op" id="5580568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5580571">return</span>&nbsp;<span class="ident" id="5580578">e</span><span class="op" id="5580579">.</span><span class="ident" id="5580580">ProcessState</span><span class="op" id="5580592">.</span><span class="ident" id="5580593">String</span><span class="op" id="5580599">(</span><span class="op" id="5580600">)</span><br>
<span class="lineno"></span><span class="op" id="5580602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5580605">//&nbsp;Wait&nbsp;waits&nbsp;for&nbsp;the&nbsp;command&nbsp;to&nbsp;exit.</span><br>
<span class="lineno">345</span><span class="comment" id="5580644">//&nbsp;It&nbsp;must&nbsp;have&nbsp;been&nbsp;started&nbsp;by&nbsp;Start.</span><br>
<span class="lineno"></span><span class="comment" id="5580683">//</span><br>
<span class="lineno"></span><span class="comment" id="5580686">//&nbsp;The&nbsp;returned&nbsp;error&nbsp;is&nbsp;nil&nbsp;if&nbsp;the&nbsp;command&nbsp;runs,&nbsp;has&nbsp;no&nbsp;problems</span><br>
<span class="lineno"></span><span class="comment" id="5580752">//&nbsp;copying&nbsp;stdin,&nbsp;stdout,&nbsp;and&nbsp;stderr,&nbsp;and&nbsp;exits&nbsp;with&nbsp;a&nbsp;zero&nbsp;exit</span><br>
<span class="lineno"></span><span class="comment" id="5580817">//&nbsp;status.</span><br>
<span class="lineno">350</span><span class="comment" id="5580828">//</span><br>
<span class="lineno"></span><span class="comment" id="5580831">//&nbsp;If&nbsp;the&nbsp;command&nbsp;fails&nbsp;to&nbsp;run&nbsp;or&nbsp;doesn&#39;t&nbsp;complete&nbsp;successfully,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5580900">//&nbsp;error&nbsp;is&nbsp;of&nbsp;type&nbsp;*ExitError.&nbsp;Other&nbsp;error&nbsp;types&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5580957">//&nbsp;returned&nbsp;for&nbsp;I/O&nbsp;problems.</span><br>
<span class="lineno"></span><span class="comment" id="5580987">//</span><br>
<span class="lineno">355</span><span class="comment" id="5580990">//&nbsp;Wait&nbsp;releases&nbsp;any&nbsp;resources&nbsp;associated&nbsp;with&nbsp;the&nbsp;Cmd.</span><br>
<span class="lineno"></span><span class="keyword" id="5581046">func</span>&nbsp;<span class="op" id="5581051">(</span><span class="ident" id="5581052">c</span>&nbsp;<span class="op" id="5581054">*</span><span class="ident" id="5581055">Cmd</span><span class="op" id="5581058">)</span>&nbsp;<span class="ident" id="5581060">Wait</span><span class="op" id="5581064">(</span><span class="op" id="5581065">)</span>&nbsp;<span class="builtintype" id="5581067">error</span>&nbsp;<span class="op" id="5581073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581076">if</span>&nbsp;<span class="ident" id="5581079">c</span><span class="op" id="5581080">.</span><span class="ident" id="5581081">Process</span>&nbsp;<span class="op" id="5581089">==</span>&nbsp;<span class="ident" id="5581092">nil</span>&nbsp;<span class="op" id="5581096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581100">return</span>&nbsp;<span class="ident" id="5581107">errors</span><span class="op" id="5581113">.</span><span class="ident" id="5581114">New</span><span class="op" id="5581117">(</span><span class="string" id="5581118">&#34;exec:&nbsp;not&nbsp;started&#34;</span><span class="op" id="5581137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5581140">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581143">if</span>&nbsp;<span class="ident" id="5581146">c</span><span class="op" id="5581147">.</span><span class="ident" id="5581148">finished</span>&nbsp;<span class="op" id="5581157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581161">return</span>&nbsp;<span class="ident" id="5581168">errors</span><span class="op" id="5581174">.</span><span class="ident" id="5581175">New</span><span class="op" id="5581178">(</span><span class="string" id="5581179">&#34;exec:&nbsp;Wait&nbsp;was&nbsp;already&nbsp;called&#34;</span><span class="op" id="5581210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5581213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5581216">c</span><span class="op" id="5581217">.</span><span class="ident" id="5581218">finished</span>&nbsp;<span class="op" id="5581227">=</span>&nbsp;<span class="builtintype" id="5581229">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5581235">state</span><span class="op" id="5581240">,</span>&nbsp;<span class="ident" id="5581242">err</span>&nbsp;<span class="op" id="5581246">:=</span>&nbsp;<span class="ident" id="5581249">c</span><span class="op" id="5581250">.</span><span class="ident" id="5581251">Process</span><span class="op" id="5581258">.</span><span class="ident" id="5581259">Wait</span><span class="op" id="5581263">(</span><span class="op" id="5581264">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5581267">c</span><span class="op" id="5581268">.</span><span class="ident" id="5581269">ProcessState</span>&nbsp;<span class="op" id="5581282">=</span>&nbsp;<span class="ident" id="5581284">state</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581292">var</span>&nbsp;<span class="ident" id="5581296">copyError</span>&nbsp;<span class="builtintype" id="5581306">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581313">for</span>&nbsp;<span class="keyword" id="5581317">range</span>&nbsp;<span class="ident" id="5581323">c</span><span class="op" id="5581324">.</span><span class="ident" id="5581325">goroutine</span>&nbsp;<span class="op" id="5581335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581339">if</span>&nbsp;<span class="ident" id="5581342">err</span>&nbsp;<span class="op" id="5581346">:=</span>&nbsp;<span class="op" id="5581349">&lt;-</span><span class="ident" id="5581351">c</span><span class="op" id="5581352">.</span><span class="ident" id="5581353">errch</span><span class="op" id="5581358">;</span>&nbsp;<span class="ident" id="5581360">err</span>&nbsp;<span class="op" id="5581364">!=</span>&nbsp;<span class="ident" id="5581367">nil</span>&nbsp;<span class="op" id="5581371">&amp;&amp;</span>&nbsp;<span class="ident" id="5581374">copyError</span>&nbsp;<span class="op" id="5581384">==</span>&nbsp;<span class="ident" id="5581387">nil</span>&nbsp;<span class="op" id="5581391">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5581396">copyError</span>&nbsp;<span class="op" id="5581406">=</span>&nbsp;<span class="ident" id="5581408">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5581414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5581417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5581421">c</span><span class="op" id="5581422">.</span><span class="ident" id="5581423">closeDescriptors</span><span class="op" id="5581439">(</span><span class="ident" id="5581440">c</span><span class="op" id="5581441">.</span><span class="ident" id="5581442">closeAfterWait</span><span class="op" id="5581456">)</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581460">if</span>&nbsp;<span class="ident" id="5581463">err</span>&nbsp;<span class="op" id="5581467">!=</span>&nbsp;<span class="ident" id="5581470">nil</span>&nbsp;<span class="op" id="5581474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581478">return</span>&nbsp;<span class="ident" id="5581485">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5581490">}</span>&nbsp;<span class="keyword" id="5581492">else</span>&nbsp;<span class="keyword" id="5581497">if</span>&nbsp;<span class="op" id="5581500">!</span><span class="ident" id="5581501">state</span><span class="op" id="5581506">.</span><span class="ident" id="5581507">Success</span><span class="op" id="5581514">(</span><span class="op" id="5581515">)</span>&nbsp;<span class="op" id="5581517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581521">return</span>&nbsp;<span class="op" id="5581528">&amp;</span><span class="ident" id="5581529">ExitError</span><span class="op" id="5581538">{</span><span class="ident" id="5581539">state</span><span class="op" id="5581544">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5581547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581551">return</span>&nbsp;<span class="ident" id="5581558">copyError</span><br>
<span class="lineno"></span><span class="op" id="5581568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="5581571">//&nbsp;Output&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;standard&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="5581631">func</span>&nbsp;<span class="op" id="5581636">(</span><span class="ident" id="5581637">c</span>&nbsp;<span class="op" id="5581639">*</span><span class="ident" id="5581640">Cmd</span><span class="op" id="5581643">)</span>&nbsp;<span class="ident" id="5581645">Output</span><span class="op" id="5581651">(</span><span class="op" id="5581652">)</span>&nbsp;<span class="op" id="5581654">(</span><span class="op" id="5581655">[</span><span class="op" id="5581656">]</span><span class="builtintype" id="5581657">byte</span><span class="op" id="5581661">,</span>&nbsp;<span class="builtintype" id="5581663">error</span><span class="op" id="5581668">)</span>&nbsp;<span class="op" id="5581670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581673">if</span>&nbsp;<span class="ident" id="5581676">c</span><span class="op" id="5581677">.</span><span class="ident" id="5581678">Stdout</span>&nbsp;<span class="op" id="5581685">!=</span>&nbsp;<span class="ident" id="5581688">nil</span>&nbsp;<span class="op" id="5581692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581696">return</span>&nbsp;<span class="ident" id="5581703">nil</span><span class="op" id="5581706">,</span>&nbsp;<span class="ident" id="5581708">errors</span><span class="op" id="5581714">.</span><span class="ident" id="5581715">New</span><span class="op" id="5581718">(</span><span class="string" id="5581719">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5581745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5581748">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581751">var</span>&nbsp;<span class="ident" id="5581755">b</span>&nbsp;<span class="ident" id="5581757">bytes</span><span class="op" id="5581762">.</span><span class="ident" id="5581763">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5581771">c</span><span class="op" id="5581772">.</span><span class="ident" id="5581773">Stdout</span>&nbsp;<span class="op" id="5581780">=</span>&nbsp;<span class="op" id="5581782">&amp;</span><span class="ident" id="5581783">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5581786">err</span>&nbsp;<span class="op" id="5581790">:=</span>&nbsp;<span class="ident" id="5581793">c</span><span class="op" id="5581794">.</span><span class="ident" id="5581795">Run</span><span class="op" id="5581798">(</span><span class="op" id="5581799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581802">return</span>&nbsp;<span class="ident" id="5581809">b</span><span class="op" id="5581810">.</span><span class="ident" id="5581811">Bytes</span><span class="op" id="5581816">(</span><span class="op" id="5581817">)</span><span class="op" id="5581818">,</span>&nbsp;<span class="ident" id="5581820">err</span><br>
<span class="lineno"></span><span class="op" id="5581824">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="comment" id="5581827">//&nbsp;CombinedOutput&nbsp;runs&nbsp;the&nbsp;command&nbsp;and&nbsp;returns&nbsp;its&nbsp;combined&nbsp;standard</span><br>
<span class="lineno"></span><span class="comment" id="5581896">//&nbsp;output&nbsp;and&nbsp;standard&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5581926">func</span>&nbsp;<span class="op" id="5581931">(</span><span class="ident" id="5581932">c</span>&nbsp;<span class="op" id="5581934">*</span><span class="ident" id="5581935">Cmd</span><span class="op" id="5581938">)</span>&nbsp;<span class="ident" id="5581940">CombinedOutput</span><span class="op" id="5581954">(</span><span class="op" id="5581955">)</span>&nbsp;<span class="op" id="5581957">(</span><span class="op" id="5581958">[</span><span class="op" id="5581959">]</span><span class="builtintype" id="5581960">byte</span><span class="op" id="5581964">,</span>&nbsp;<span class="builtintype" id="5581966">error</span><span class="op" id="5581971">)</span>&nbsp;<span class="op" id="5581973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581976">if</span>&nbsp;<span class="ident" id="5581979">c</span><span class="op" id="5581980">.</span><span class="ident" id="5581981">Stdout</span>&nbsp;<span class="op" id="5581988">!=</span>&nbsp;<span class="ident" id="5581991">nil</span>&nbsp;<span class="op" id="5581995">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5581999">return</span>&nbsp;<span class="ident" id="5582006">nil</span><span class="op" id="5582009">,</span>&nbsp;<span class="ident" id="5582011">errors</span><span class="op" id="5582017">.</span><span class="ident" id="5582018">New</span><span class="op" id="5582021">(</span><span class="string" id="5582022">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5582048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5582051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5582054">if</span>&nbsp;<span class="ident" id="5582057">c</span><span class="op" id="5582058">.</span><span class="ident" id="5582059">Stderr</span>&nbsp;<span class="op" id="5582066">!=</span>&nbsp;<span class="ident" id="5582069">nil</span>&nbsp;<span class="op" id="5582073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5582077">return</span>&nbsp;<span class="ident" id="5582084">nil</span><span class="op" id="5582087">,</span>&nbsp;<span class="ident" id="5582089">errors</span><span class="op" id="5582095">.</span><span class="ident" id="5582096">New</span><span class="op" id="5582099">(</span><span class="string" id="5582100">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5582126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5582129">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5582132">var</span>&nbsp;<span class="ident" id="5582136">b</span>&nbsp;<span class="ident" id="5582138">bytes</span><span class="op" id="5582143">.</span><span class="ident" id="5582144">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5582152">c</span><span class="op" id="5582153">.</span><span class="ident" id="5582154">Stdout</span>&nbsp;<span class="op" id="5582161">=</span>&nbsp;<span class="op" id="5582163">&amp;</span><span class="ident" id="5582164">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5582167">c</span><span class="op" id="5582168">.</span><span class="ident" id="5582169">Stderr</span>&nbsp;<span class="op" id="5582176">=</span>&nbsp;<span class="op" id="5582178">&amp;</span><span class="ident" id="5582179">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5582182">err</span>&nbsp;<span class="op" id="5582186">:=</span>&nbsp;<span class="ident" id="5582189">c</span><span class="op" id="5582190">.</span><span class="ident" id="5582191">Run</span><span class="op" id="5582194">(</span><span class="op" id="5582195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5582198">return</span>&nbsp;<span class="ident" id="5582205">b</span><span class="op" id="5582206">.</span><span class="ident" id="5582207">Bytes</span><span class="op" id="5582212">(</span><span class="op" id="5582213">)</span><span class="op" id="5582214">,</span>&nbsp;<span class="ident" id="5582216">err</span><br>
<span class="lineno">410</span><span class="op" id="5582220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5582223">//&nbsp;StdinPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5582291">//&nbsp;standard&nbsp;input&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5582334">//&nbsp;The&nbsp;pipe&nbsp;will&nbsp;be&nbsp;closed&nbsp;automatically&nbsp;after&nbsp;Wait&nbsp;sees&nbsp;the&nbsp;command&nbsp;exit.</span><br>
<span class="lineno">415</span><span class="comment" id="5582409">//&nbsp;A&nbsp;caller&nbsp;need&nbsp;only&nbsp;call&nbsp;Close&nbsp;to&nbsp;force&nbsp;the&nbsp;pipe&nbsp;to&nbsp;close&nbsp;sooner.</span><br>
<span class="lineno"></span><span class="comment" id="5582477">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;command&nbsp;being&nbsp;run&nbsp;will&nbsp;not&nbsp;exit&nbsp;until&nbsp;standard&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="5582553">//&nbsp;is&nbsp;closed,&nbsp;the&nbsp;caller&nbsp;must&nbsp;close&nbsp;the&nbsp;pipe.</span><br>
<span class="lineno"></span><span class="keyword" id="5582599">func</span>&nbsp;<span class="op" id="5582604">(</span><span class="ident" id="5582605">c</span>&nbsp;<span class="op" id="5582607">*</span><span class="ident" id="5582608">Cmd</span><span class="op" id="5582611">)</span>&nbsp;<span class="ident" id="5582613">StdinPipe</span><span class="op" id="5582622">(</span><span class="op" id="5582623">)</span>&nbsp;<span class="op" id="5582625">(</span><span class="ident" id="5582626">io</span><span class="op" id="5582628">.</span><span class="ident" id="5582629">WriteCloser</span><span class="op" id="5582640">,</span>&nbsp;<span class="builtintype" id="5582642">error</span><span class="op" id="5582647">)</span>&nbsp;<span class="op" id="5582649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5582652">if</span>&nbsp;<span class="ident" id="5582655">c</span><span class="op" id="5582656">.</span><span class="ident" id="5582657">Stdin</span>&nbsp;<span class="op" id="5582663">!=</span>&nbsp;<span class="ident" id="5582666">nil</span>&nbsp;<span class="op" id="5582670">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5582674">return</span>&nbsp;<span class="ident" id="5582681">nil</span><span class="op" id="5582684">,</span>&nbsp;<span class="ident" id="5582686">errors</span><span class="op" id="5582692">.</span><span class="ident" id="5582693">New</span><span class="op" id="5582696">(</span><span class="string" id="5582697">&#34;exec:&nbsp;Stdin&nbsp;already&nbsp;set&#34;</span><span class="op" id="5582722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5582725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5582728">if</span>&nbsp;<span class="ident" id="5582731">c</span><span class="op" id="5582732">.</span><span class="ident" id="5582733">Process</span>&nbsp;<span class="op" id="5582741">!=</span>&nbsp;<span class="ident" id="5582744">nil</span>&nbsp;<span class="op" id="5582748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5582752">return</span>&nbsp;<span class="ident" id="5582759">nil</span><span class="op" id="5582762">,</span>&nbsp;<span class="ident" id="5582764">errors</span><span class="op" id="5582770">.</span><span class="ident" id="5582771">New</span><span class="op" id="5582774">(</span><span class="string" id="5582775">&#34;exec:&nbsp;StdinPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5582814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5582817">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5582820">pr</span><span class="op" id="5582822">,</span>&nbsp;<span class="ident" id="5582824">pw</span><span class="op" id="5582826">,</span>&nbsp;<span class="ident" id="5582828">err</span>&nbsp;<span class="op" id="5582832">:=</span>&nbsp;<span class="ident" id="5582835">os</span><span class="op" id="5582837">.</span><span class="ident" id="5582838">Pipe</span><span class="op" id="5582842">(</span><span class="op" id="5582843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5582846">if</span>&nbsp;<span class="ident" id="5582849">err</span>&nbsp;<span class="op" id="5582853">!=</span>&nbsp;<span class="ident" id="5582856">nil</span>&nbsp;<span class="op" id="5582860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5582864">return</span>&nbsp;<span class="ident" id="5582871">nil</span><span class="op" id="5582874">,</span>&nbsp;<span class="ident" id="5582876">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5582881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5582884">c</span><span class="op" id="5582885">.</span><span class="ident" id="5582886">Stdin</span>&nbsp;<span class="op" id="5582892">=</span>&nbsp;<span class="ident" id="5582894">pr</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5582898">c</span><span class="op" id="5582899">.</span><span class="ident" id="5582900">closeAfterStart</span>&nbsp;<span class="op" id="5582916">=</span>&nbsp;<span class="builtinfunc" id="5582918">append</span><span class="op" id="5582924">(</span><span class="ident" id="5582925">c</span><span class="op" id="5582926">.</span><span class="ident" id="5582927">closeAfterStart</span><span class="op" id="5582942">,</span>&nbsp;<span class="ident" id="5582944">pr</span><span class="op" id="5582946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5582949">wc</span>&nbsp;<span class="op" id="5582952">:=</span>&nbsp;<span class="op" id="5582955">&amp;</span><span class="ident" id="5582956">closeOnce</span><span class="op" id="5582965">{</span><span class="ident" id="5582966">File</span><span class="op" id="5582970">:</span>&nbsp;<span class="ident" id="5582972">pw</span><span class="op" id="5582974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5582977">c</span><span class="op" id="5582978">.</span><span class="ident" id="5582979">closeAfterWait</span>&nbsp;<span class="op" id="5582994">=</span>&nbsp;<span class="builtinfunc" id="5582996">append</span><span class="op" id="5583002">(</span><span class="ident" id="5583003">c</span><span class="op" id="5583004">.</span><span class="ident" id="5583005">closeAfterWait</span><span class="op" id="5583019">,</span>&nbsp;<span class="ident" id="5583021">wc</span><span class="op" id="5583023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5583026">return</span>&nbsp;<span class="ident" id="5583033">wc</span><span class="op" id="5583035">,</span>&nbsp;<span class="ident" id="5583037">nil</span><br>
<span class="lineno"></span><span class="op" id="5583041">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="5583044">type</span>&nbsp;<span class="ident" id="5583049">closeOnce</span>&nbsp;<span class="keyword" id="5583059">struct</span>&nbsp;<span class="op" id="5583066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5583069">*</span><span class="ident" id="5583070">os</span><span class="op" id="5583072">.</span><span class="ident" id="5583073">File</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5583080">once</span>&nbsp;<span class="ident" id="5583085">sync</span><span class="op" id="5583089">.</span><span class="ident" id="5583090">Once</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5583096">err</span>&nbsp;&nbsp;<span class="builtintype" id="5583101">error</span><br>
<span class="lineno"></span><span class="op" id="5583107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5583110">func</span>&nbsp;<span class="op" id="5583115">(</span><span class="ident" id="5583116">c</span>&nbsp;<span class="op" id="5583118">*</span><span class="ident" id="5583119">closeOnce</span><span class="op" id="5583128">)</span>&nbsp;<span class="ident" id="5583130">Close</span><span class="op" id="5583135">(</span><span class="op" id="5583136">)</span>&nbsp;<span class="builtintype" id="5583138">error</span>&nbsp;<span class="op" id="5583144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5583147">c</span><span class="op" id="5583148">.</span><span class="ident" id="5583149">once</span><span class="op" id="5583153">.</span><span class="ident" id="5583154">Do</span><span class="op" id="5583156">(</span><span class="ident" id="5583157">c</span><span class="op" id="5583158">.</span><span class="builtinfunc" id="5583159">close</span><span class="op" id="5583164">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5583167">return</span>&nbsp;<span class="ident" id="5583174">c</span><span class="op" id="5583175">.</span><span class="ident" id="5583176">err</span><br>
<span class="lineno"></span><span class="op" id="5583180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5583183">func</span>&nbsp;<span class="op" id="5583188">(</span><span class="ident" id="5583189">c</span>&nbsp;<span class="op" id="5583191">*</span><span class="ident" id="5583192">closeOnce</span><span class="op" id="5583201">)</span>&nbsp;<span class="builtinfunc" id="5583203">close</span><span class="op" id="5583208">(</span><span class="op" id="5583209">)</span>&nbsp;<span class="op" id="5583211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5583214">c</span><span class="op" id="5583215">.</span><span class="ident" id="5583216">err</span>&nbsp;<span class="op" id="5583220">=</span>&nbsp;<span class="ident" id="5583222">c</span><span class="op" id="5583223">.</span><span class="ident" id="5583224">File</span><span class="op" id="5583228">.</span><span class="ident" id="5583229">Close</span><span class="op" id="5583234">(</span><span class="op" id="5583235">)</span><br>
<span class="lineno">450</span><span class="op" id="5583237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5583240">//&nbsp;StdoutPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5583309">//&nbsp;standard&nbsp;output&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5583353">//</span><br>
<span class="lineno">455</span><span class="comment" id="5583356">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5583431">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5583502">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5583581">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Run&nbsp;when&nbsp;using&nbsp;StdoutPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5583656">//&nbsp;See&nbsp;the&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">460</span><span class="keyword" id="5583696">func</span>&nbsp;<span class="op" id="5583701">(</span><span class="ident" id="5583702">c</span>&nbsp;<span class="op" id="5583704">*</span><span class="ident" id="5583705">Cmd</span><span class="op" id="5583708">)</span>&nbsp;<span class="ident" id="5583710">StdoutPipe</span><span class="op" id="5583720">(</span><span class="op" id="5583721">)</span>&nbsp;<span class="op" id="5583723">(</span><span class="ident" id="5583724">io</span><span class="op" id="5583726">.</span><span class="ident" id="5583727">ReadCloser</span><span class="op" id="5583737">,</span>&nbsp;<span class="builtintype" id="5583739">error</span><span class="op" id="5583744">)</span>&nbsp;<span class="op" id="5583746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5583749">if</span>&nbsp;<span class="ident" id="5583752">c</span><span class="op" id="5583753">.</span><span class="ident" id="5583754">Stdout</span>&nbsp;<span class="op" id="5583761">!=</span>&nbsp;<span class="ident" id="5583764">nil</span>&nbsp;<span class="op" id="5583768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5583772">return</span>&nbsp;<span class="ident" id="5583779">nil</span><span class="op" id="5583782">,</span>&nbsp;<span class="ident" id="5583784">errors</span><span class="op" id="5583790">.</span><span class="ident" id="5583791">New</span><span class="op" id="5583794">(</span><span class="string" id="5583795">&#34;exec:&nbsp;Stdout&nbsp;already&nbsp;set&#34;</span><span class="op" id="5583821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5583824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5583827">if</span>&nbsp;<span class="ident" id="5583830">c</span><span class="op" id="5583831">.</span><span class="ident" id="5583832">Process</span>&nbsp;<span class="op" id="5583840">!=</span>&nbsp;<span class="ident" id="5583843">nil</span>&nbsp;<span class="op" id="5583847">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5583851">return</span>&nbsp;<span class="ident" id="5583858">nil</span><span class="op" id="5583861">,</span>&nbsp;<span class="ident" id="5583863">errors</span><span class="op" id="5583869">.</span><span class="ident" id="5583870">New</span><span class="op" id="5583873">(</span><span class="string" id="5583874">&#34;exec:&nbsp;StdoutPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5583914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5583917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5583920">pr</span><span class="op" id="5583922">,</span>&nbsp;<span class="ident" id="5583924">pw</span><span class="op" id="5583926">,</span>&nbsp;<span class="ident" id="5583928">err</span>&nbsp;<span class="op" id="5583932">:=</span>&nbsp;<span class="ident" id="5583935">os</span><span class="op" id="5583937">.</span><span class="ident" id="5583938">Pipe</span><span class="op" id="5583942">(</span><span class="op" id="5583943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5583946">if</span>&nbsp;<span class="ident" id="5583949">err</span>&nbsp;<span class="op" id="5583953">!=</span>&nbsp;<span class="ident" id="5583956">nil</span>&nbsp;<span class="op" id="5583960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5583964">return</span>&nbsp;<span class="ident" id="5583971">nil</span><span class="op" id="5583974">,</span>&nbsp;<span class="ident" id="5583976">err</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5583981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5583984">c</span><span class="op" id="5583985">.</span><span class="ident" id="5583986">Stdout</span>&nbsp;<span class="op" id="5583993">=</span>&nbsp;<span class="ident" id="5583995">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5583999">c</span><span class="op" id="5584000">.</span><span class="ident" id="5584001">closeAfterStart</span>&nbsp;<span class="op" id="5584017">=</span>&nbsp;<span class="builtinfunc" id="5584019">append</span><span class="op" id="5584025">(</span><span class="ident" id="5584026">c</span><span class="op" id="5584027">.</span><span class="ident" id="5584028">closeAfterStart</span><span class="op" id="5584043">,</span>&nbsp;<span class="ident" id="5584045">pw</span><span class="op" id="5584047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5584050">c</span><span class="op" id="5584051">.</span><span class="ident" id="5584052">closeAfterWait</span>&nbsp;<span class="op" id="5584067">=</span>&nbsp;<span class="builtinfunc" id="5584069">append</span><span class="op" id="5584075">(</span><span class="ident" id="5584076">c</span><span class="op" id="5584077">.</span><span class="ident" id="5584078">closeAfterWait</span><span class="op" id="5584092">,</span>&nbsp;<span class="ident" id="5584094">pr</span><span class="op" id="5584096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5584099">return</span>&nbsp;<span class="ident" id="5584106">pr</span><span class="op" id="5584108">,</span>&nbsp;<span class="ident" id="5584110">nil</span><br>
<span class="lineno">475</span><span class="op" id="5584114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5584117">//&nbsp;StderrPipe&nbsp;returns&nbsp;a&nbsp;pipe&nbsp;that&nbsp;will&nbsp;be&nbsp;connected&nbsp;to&nbsp;the&nbsp;command&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="5584186">//&nbsp;standard&nbsp;error&nbsp;when&nbsp;the&nbsp;command&nbsp;starts.</span><br>
<span class="lineno"></span><span class="comment" id="5584229">//</span><br>
<span class="lineno">480</span><span class="comment" id="5584232">//&nbsp;Wait&nbsp;will&nbsp;close&nbsp;the&nbsp;pipe&nbsp;after&nbsp;seeing&nbsp;the&nbsp;command&nbsp;exit,&nbsp;so&nbsp;most&nbsp;callers</span><br>
<span class="lineno"></span><span class="comment" id="5584307">//&nbsp;need&nbsp;not&nbsp;close&nbsp;the&nbsp;pipe&nbsp;themselves;&nbsp;however,&nbsp;an&nbsp;implication&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5584378">//&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;call&nbsp;Wait&nbsp;before&nbsp;all&nbsp;reads&nbsp;from&nbsp;the&nbsp;pipe&nbsp;have&nbsp;completed.</span><br>
<span class="lineno"></span><span class="comment" id="5584457">//&nbsp;For&nbsp;the&nbsp;same&nbsp;reason,&nbsp;it&nbsp;is&nbsp;incorrect&nbsp;to&nbsp;use&nbsp;Run&nbsp;when&nbsp;using&nbsp;StderrPipe.</span><br>
<span class="lineno"></span><span class="comment" id="5584531">//&nbsp;See&nbsp;the&nbsp;StdoutPipe&nbsp;example&nbsp;for&nbsp;idiomatic&nbsp;usage.</span><br>
<span class="lineno">485</span><span class="keyword" id="5584582">func</span>&nbsp;<span class="op" id="5584587">(</span><span class="ident" id="5584588">c</span>&nbsp;<span class="op" id="5584590">*</span><span class="ident" id="5584591">Cmd</span><span class="op" id="5584594">)</span>&nbsp;<span class="ident" id="5584596">StderrPipe</span><span class="op" id="5584606">(</span><span class="op" id="5584607">)</span>&nbsp;<span class="op" id="5584609">(</span><span class="ident" id="5584610">io</span><span class="op" id="5584612">.</span><span class="ident" id="5584613">ReadCloser</span><span class="op" id="5584623">,</span>&nbsp;<span class="builtintype" id="5584625">error</span><span class="op" id="5584630">)</span>&nbsp;<span class="op" id="5584632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5584635">if</span>&nbsp;<span class="ident" id="5584638">c</span><span class="op" id="5584639">.</span><span class="ident" id="5584640">Stderr</span>&nbsp;<span class="op" id="5584647">!=</span>&nbsp;<span class="ident" id="5584650">nil</span>&nbsp;<span class="op" id="5584654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5584658">return</span>&nbsp;<span class="ident" id="5584665">nil</span><span class="op" id="5584668">,</span>&nbsp;<span class="ident" id="5584670">errors</span><span class="op" id="5584676">.</span><span class="ident" id="5584677">New</span><span class="op" id="5584680">(</span><span class="string" id="5584681">&#34;exec:&nbsp;Stderr&nbsp;already&nbsp;set&#34;</span><span class="op" id="5584707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5584710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5584713">if</span>&nbsp;<span class="ident" id="5584716">c</span><span class="op" id="5584717">.</span><span class="ident" id="5584718">Process</span>&nbsp;<span class="op" id="5584726">!=</span>&nbsp;<span class="ident" id="5584729">nil</span>&nbsp;<span class="op" id="5584733">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5584737">return</span>&nbsp;<span class="ident" id="5584744">nil</span><span class="op" id="5584747">,</span>&nbsp;<span class="ident" id="5584749">errors</span><span class="op" id="5584755">.</span><span class="ident" id="5584756">New</span><span class="op" id="5584759">(</span><span class="string" id="5584760">&#34;exec:&nbsp;StderrPipe&nbsp;after&nbsp;process&nbsp;started&#34;</span><span class="op" id="5584800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5584803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5584806">pr</span><span class="op" id="5584808">,</span>&nbsp;<span class="ident" id="5584810">pw</span><span class="op" id="5584812">,</span>&nbsp;<span class="ident" id="5584814">err</span>&nbsp;<span class="op" id="5584818">:=</span>&nbsp;<span class="ident" id="5584821">os</span><span class="op" id="5584823">.</span><span class="ident" id="5584824">Pipe</span><span class="op" id="5584828">(</span><span class="op" id="5584829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5584832">if</span>&nbsp;<span class="ident" id="5584835">err</span>&nbsp;<span class="op" id="5584839">!=</span>&nbsp;<span class="ident" id="5584842">nil</span>&nbsp;<span class="op" id="5584846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5584850">return</span>&nbsp;<span class="ident" id="5584857">nil</span><span class="op" id="5584860">,</span>&nbsp;<span class="ident" id="5584862">err</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5584867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5584870">c</span><span class="op" id="5584871">.</span><span class="ident" id="5584872">Stderr</span>&nbsp;<span class="op" id="5584879">=</span>&nbsp;<span class="ident" id="5584881">pw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5584885">c</span><span class="op" id="5584886">.</span><span class="ident" id="5584887">closeAfterStart</span>&nbsp;<span class="op" id="5584903">=</span>&nbsp;<span class="builtinfunc" id="5584905">append</span><span class="op" id="5584911">(</span><span class="ident" id="5584912">c</span><span class="op" id="5584913">.</span><span class="ident" id="5584914">closeAfterStart</span><span class="op" id="5584929">,</span>&nbsp;<span class="ident" id="5584931">pw</span><span class="op" id="5584933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5584936">c</span><span class="op" id="5584937">.</span><span class="ident" id="5584938">closeAfterWait</span>&nbsp;<span class="op" id="5584953">=</span>&nbsp;<span class="builtinfunc" id="5584955">append</span><span class="op" id="5584961">(</span><span class="ident" id="5584962">c</span><span class="op" id="5584963">.</span><span class="ident" id="5584964">closeAfterWait</span><span class="op" id="5584978">,</span>&nbsp;<span class="ident" id="5584980">pr</span><span class="op" id="5584982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5584985">return</span>&nbsp;<span class="ident" id="5584992">pr</span><span class="op" id="5584994">,</span>&nbsp;<span class="ident" id="5584996">nil</span><br>
<span class="lineno">500</span><span class="op" id="5585000">}</span>
</div>
</body>
</html>
