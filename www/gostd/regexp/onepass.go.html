<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>regexp</h2>
<ul>
<li><a href="/gostd/regexp/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/regexp/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/regexp/exec.go.html">exec.go</a></li>
<li><a href="/gostd/regexp/exec2_test.go.html">exec2_test.go</a></li>
<li><a href="/gostd/regexp/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/regexp/find_test.go.html">find_test.go</a></li>
<li><a href="/gostd/regexp/onepass.go.html" class="current">onepass.go</a></li>
<li><a href="/gostd/regexp/onepass_test.go.html">onepass_test.go</a></li>
<li><a href="/gostd/regexp/regexp.go.html">regexp.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3547535">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3547591">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3547645">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3547696">package</span>&nbsp;<span class="ident" id="3547704">regexp</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3547712">import</span>&nbsp;<span class="op" id="3547719">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3547722">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3547731">&#34;regexp/syntax&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3547748">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3547756">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="3547766">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3547769">//&nbsp;&#34;One-pass&#34;&nbsp;regexp&nbsp;execution.</span><br>
<span class="lineno">15</span><span class="comment" id="3547801">//&nbsp;Some&nbsp;regexps&nbsp;can&nbsp;be&nbsp;analyzed&nbsp;to&nbsp;determine&nbsp;that&nbsp;they&nbsp;never&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="3547867">//&nbsp;backtracking:&nbsp;they&nbsp;are&nbsp;guaranteed&nbsp;to&nbsp;run&nbsp;in&nbsp;one&nbsp;pass&nbsp;over&nbsp;the&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="3547939">//&nbsp;without&nbsp;bothering&nbsp;to&nbsp;save&nbsp;all&nbsp;the&nbsp;usual&nbsp;NFA&nbsp;state.</span><br>
<span class="lineno"></span><span class="comment" id="3547993">//&nbsp;Detect&nbsp;those&nbsp;and&nbsp;execute&nbsp;them&nbsp;more&nbsp;quickly.</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="3548041">//&nbsp;A&nbsp;onePassProg&nbsp;is&nbsp;a&nbsp;compiled&nbsp;one-pass&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="comment" id="3548109">//&nbsp;It&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;syntax.Prog&nbsp;except&nbsp;for&nbsp;the&nbsp;use&nbsp;of&nbsp;onePassInst.</span><br>
<span class="lineno"></span><span class="keyword" id="3548177">type</span>&nbsp;<span class="ident" id="3548182">onePassProg</span>&nbsp;<span class="keyword" id="3548194">struct</span>&nbsp;<span class="op" id="3548201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3548204">Inst</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3548211">[</span><span class="op" id="3548212">]</span><span class="ident" id="3548213"><a href="/gostd/regexp/onepass.go.html#3548473">onePassInst</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3548226">Start</span>&nbsp;&nbsp;<span class="builtintype" id="3548233">int</span>&nbsp;<span class="comment" id="3548237">//&nbsp;index&nbsp;of&nbsp;start&nbsp;instruction</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3548268">NumCap</span>&nbsp;<span class="builtintype" id="3548275">int</span>&nbsp;<span class="comment" id="3548279">//&nbsp;number&nbsp;of&nbsp;InstCapture&nbsp;insts&nbsp;in&nbsp;re</span><br>
<span class="lineno"></span><span class="op" id="3548316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3548319">//&nbsp;A&nbsp;onePassInst&nbsp;is&nbsp;a&nbsp;single&nbsp;instruction&nbsp;in&nbsp;a&nbsp;one-pass&nbsp;regular&nbsp;expression&nbsp;program.</span><br>
<span class="lineno"></span><span class="comment" id="3548402">//&nbsp;It&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;syntax.Inst&nbsp;except&nbsp;for&nbsp;the&nbsp;new&nbsp;&#39;Next&#39;&nbsp;field.</span><br>
<span class="lineno">30</span><span class="keyword" id="3548468">type</span>&nbsp;<span class="ident" id="3548473">onePassInst</span>&nbsp;<span class="keyword" id="3548485">struct</span>&nbsp;<span class="op" id="3548492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3548495"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3548501">.</span><span class="ident" id="3548502"><a href="/gostd/regexp/syntax/prog.go.html#3661062">Inst</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3548508">Next</span>&nbsp;<span class="op" id="3548513">[</span><span class="op" id="3548514">]</span><span class="builtintype" id="3548515">uint32</span><br>
<span class="lineno"></span><span class="op" id="3548522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3548525">//&nbsp;OnePassPrefix&nbsp;returns&nbsp;a&nbsp;literal&nbsp;string&nbsp;that&nbsp;all&nbsp;matches&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3548592">//&nbsp;regexp&nbsp;must&nbsp;start&nbsp;with.&nbsp;&nbsp;Complete&nbsp;is&nbsp;true&nbsp;if&nbsp;the&nbsp;prefix</span><br>
<span class="lineno"></span><span class="comment" id="3548651">//&nbsp;is&nbsp;the&nbsp;entire&nbsp;match.&nbsp;Pc&nbsp;is&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;last&nbsp;rune&nbsp;instruction</span><br>
<span class="lineno"></span><span class="comment" id="3548720">//&nbsp;in&nbsp;the&nbsp;string.&nbsp;The&nbsp;OnePassPrefix&nbsp;skips&nbsp;over&nbsp;the&nbsp;mandatory</span><br>
<span class="lineno"></span><span class="comment" id="3548781">//&nbsp;EmptyBeginText</span><br>
<span class="lineno">40</span><span class="keyword" id="3548799">func</span>&nbsp;<span class="ident" id="3548804">onePassPrefix</span><span class="op" id="3548817">(</span><span class="ident" id="3548818">p</span>&nbsp;<span class="op" id="3548820">*</span><span class="ident" id="3548821"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3548827">.</span><span class="ident" id="3548828"><a href="/gostd/regexp/syntax/prog.go.html#3659010">Prog</a></span><span class="op" id="3548832">)</span>&nbsp;<span class="op" id="3548834">(</span><span class="ident" id="3548835">prefix</span>&nbsp;<span class="builtintype" id="3548842">string</span><span class="op" id="3548848">,</span>&nbsp;<span class="ident" id="3548850">complete</span>&nbsp;<span class="builtintype" id="3548859">bool</span><span class="op" id="3548863">,</span>&nbsp;<span class="ident" id="3548865">pc</span>&nbsp;<span class="builtintype" id="3548868">uint32</span><span class="op" id="3548874">)</span>&nbsp;<span class="op" id="3548876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3548879">i</span>&nbsp;<span class="op" id="3548881">:=</span>&nbsp;<span class="op" id="3548884">&amp;</span><span class="ident" id="3548885"><a href="/gostd/regexp/onepass.go.html#3548818">p</a></span><span class="op" id="3548886">.</span><span class="ident" id="3548887"><a href="/gostd/regexp/syntax/prog.go.html#3659025">Inst</a></span><span class="op" id="3548891">[</span><span class="ident" id="3548892"><a href="/gostd/regexp/onepass.go.html#3548818">p</a></span><span class="op" id="3548893">.</span><span class="ident" id="3548894"><a href="/gostd/regexp/syntax/prog.go.html#3659040">Start</a></span><span class="op" id="3548899">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3548902">if</span>&nbsp;<span class="ident" id="3548905"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3548906">.</span><span class="ident" id="3548907"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3548910">!=</span>&nbsp;<span class="ident" id="3548913"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3548919">.</span><span class="ident" id="3548920"><a href="/gostd/regexp/syntax/prog.go.html#3659250">InstEmptyWidth</a></span>&nbsp;<span class="op" id="3548935">||</span>&nbsp;<span class="op" id="3548938">(</span><span class="ident" id="3548939"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3548945">.</span><span class="ident" id="3548946"><a href="/gostd/regexp/syntax/prog.go.html#3659736">EmptyOp</a></span><span class="op" id="3548953">(</span><span class="ident" id="3548954"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3548955">.</span><span class="ident" id="3548956"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3548959">)</span><span class="op" id="3548960">)</span><span class="op" id="3548961">&amp;</span><span class="ident" id="3548962"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3548968">.</span><span class="ident" id="3548969"><a href="/gostd/regexp/syntax/prog.go.html#3659810">EmptyBeginText</a></span>&nbsp;<span class="op" id="3548984">==</span>&nbsp;<span class="num" id="3548987">0</span>&nbsp;<span class="op" id="3548989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3548993">return</span>&nbsp;<span class="string" id="3549000">&#34;&#34;</span><span class="op" id="3549002">,</span>&nbsp;<span class="ident" id="3549004"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549005">.</span><span class="ident" id="3549006"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3549009">==</span>&nbsp;<span class="ident" id="3549012"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3549018">.</span><span class="ident" id="3549019"><a href="/gostd/regexp/syntax/prog.go.html#3659266">InstMatch</a></span><span class="op" id="3549028">,</span>&nbsp;<span class="builtintype" id="3549030">uint32</span><span class="op" id="3549036">(</span><span class="ident" id="3549037"><a href="/gostd/regexp/onepass.go.html#3548818">p</a></span><span class="op" id="3549038">.</span><span class="ident" id="3549039"><a href="/gostd/regexp/syntax/prog.go.html#3659040">Start</a></span><span class="op" id="3549044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3549047">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549050"><a href="/gostd/regexp/onepass.go.html#3548865">pc</a></span>&nbsp;<span class="op" id="3549053">=</span>&nbsp;<span class="ident" id="3549055"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549056">.</span><span class="ident" id="3549057"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549062"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span>&nbsp;<span class="op" id="3549064">=</span>&nbsp;<span class="op" id="3549066">&amp;</span><span class="ident" id="3549067"><a href="/gostd/regexp/onepass.go.html#3548818">p</a></span><span class="op" id="3549068">.</span><span class="ident" id="3549069"><a href="/gostd/regexp/syntax/prog.go.html#3659025">Inst</a></span><span class="op" id="3549073">[</span><span class="ident" id="3549074"><a href="/gostd/regexp/onepass.go.html#3548865">pc</a></span><span class="op" id="3549076">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3549079">for</span>&nbsp;<span class="ident" id="3549083"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549084">.</span><span class="ident" id="3549085"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3549088">==</span>&nbsp;<span class="ident" id="3549091"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3549097">.</span><span class="ident" id="3549098"><a href="/gostd/regexp/syntax/prog.go.html#3659287">InstNop</a></span>&nbsp;<span class="op" id="3549106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549110"><a href="/gostd/regexp/onepass.go.html#3548865">pc</a></span>&nbsp;<span class="op" id="3549113">=</span>&nbsp;<span class="ident" id="3549115"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549116">.</span><span class="ident" id="3549117"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549123"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span>&nbsp;<span class="op" id="3549125">=</span>&nbsp;<span class="op" id="3549127">&amp;</span><span class="ident" id="3549128"><a href="/gostd/regexp/onepass.go.html#3548818">p</a></span><span class="op" id="3549129">.</span><span class="ident" id="3549130"><a href="/gostd/regexp/syntax/prog.go.html#3659025">Inst</a></span><span class="op" id="3549134">[</span><span class="ident" id="3549135"><a href="/gostd/regexp/onepass.go.html#3548865">pc</a></span><span class="op" id="3549137">]</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3549140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3549143">//&nbsp;Avoid&nbsp;allocation&nbsp;of&nbsp;buffer&nbsp;if&nbsp;prefix&nbsp;is&nbsp;empty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3549194">if</span>&nbsp;<span class="ident" id="3549197"><a href="/gostd/regexp/onepass.go.html#3550190">iop</a></span><span class="op" id="3549200">(</span><span class="ident" id="3549201"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549202">)</span>&nbsp;<span class="op" id="3549204">!=</span>&nbsp;<span class="ident" id="3549207"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3549213">.</span><span class="ident" id="3549214"><a href="/gostd/regexp/syntax/prog.go.html#3659296">InstRune</a></span>&nbsp;<span class="op" id="3549223">||</span>&nbsp;<span class="builtinfunc" id="3549226">len</span><span class="op" id="3549229">(</span><span class="ident" id="3549230"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549231">.</span><span class="ident" id="3549232"><a href="/gostd/regexp/syntax/prog.go.html#3661201">Rune</a></span><span class="op" id="3549236">)</span>&nbsp;<span class="op" id="3549238">!=</span>&nbsp;<span class="num" id="3549241">1</span>&nbsp;<span class="op" id="3549243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3549247">return</span>&nbsp;<span class="string" id="3549254">&#34;&#34;</span><span class="op" id="3549256">,</span>&nbsp;<span class="ident" id="3549258"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549259">.</span><span class="ident" id="3549260"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3549263">==</span>&nbsp;<span class="ident" id="3549266"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3549272">.</span><span class="ident" id="3549273"><a href="/gostd/regexp/syntax/prog.go.html#3659266">InstMatch</a></span><span class="op" id="3549282">,</span>&nbsp;<span class="builtintype" id="3549284">uint32</span><span class="op" id="3549290">(</span><span class="ident" id="3549291"><a href="/gostd/regexp/onepass.go.html#3548818">p</a></span><span class="op" id="3549292">.</span><span class="ident" id="3549293"><a href="/gostd/regexp/syntax/prog.go.html#3659040">Start</a></span><span class="op" id="3549298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3549301">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3549305">//&nbsp;Have&nbsp;prefix;&nbsp;gather&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3549341">var</span>&nbsp;<span class="ident" id="3549345">buf</span>&nbsp;<span class="ident" id="3549349"><a href="/gostd/regexp/onepass.go.html#3547722">bytes</a></span><span class="op" id="3549354">.</span><span class="ident" id="3549355"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3549363">for</span>&nbsp;<span class="ident" id="3549367"><a href="/gostd/regexp/onepass.go.html#3550190">iop</a></span><span class="op" id="3549370">(</span><span class="ident" id="3549371"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549372">)</span>&nbsp;<span class="op" id="3549374">==</span>&nbsp;<span class="ident" id="3549377"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3549383">.</span><span class="ident" id="3549384"><a href="/gostd/regexp/syntax/prog.go.html#3659296">InstRune</a></span>&nbsp;<span class="op" id="3549393">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3549396">len</span><span class="op" id="3549399">(</span><span class="ident" id="3549400"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549401">.</span><span class="ident" id="3549402"><a href="/gostd/regexp/syntax/prog.go.html#3661201">Rune</a></span><span class="op" id="3549406">)</span>&nbsp;<span class="op" id="3549408">==</span>&nbsp;<span class="num" id="3549411">1</span>&nbsp;<span class="op" id="3549413">&amp;&amp;</span>&nbsp;<span class="ident" id="3549416"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3549422">.</span><span class="ident" id="3549423"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span><span class="op" id="3549428">(</span><span class="ident" id="3549429"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549430">.</span><span class="ident" id="3549431"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3549434">)</span><span class="op" id="3549435">&amp;</span><span class="ident" id="3549436"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3549442">.</span><span class="ident" id="3549443"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span>&nbsp;<span class="op" id="3549452">==</span>&nbsp;<span class="num" id="3549455">0</span>&nbsp;<span class="op" id="3549457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549461"><a href="/gostd/regexp/onepass.go.html#3549345">buf</a></span><span class="op" id="3549464">.</span><span class="ident" id="3549465"><a href="/gostd/bytes/buffer.go.html#1390522">WriteRune</a></span><span class="op" id="3549474">(</span><span class="ident" id="3549475"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549476">.</span><span class="ident" id="3549477"><a href="/gostd/regexp/syntax/prog.go.html#3661201">Rune</a></span><span class="op" id="3549481">[</span><span class="num" id="3549482">0</span><span class="op" id="3549483">]</span><span class="op" id="3549484">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549488"><a href="/gostd/regexp/onepass.go.html#3548865">pc</a></span><span class="op" id="3549490">,</span>&nbsp;<span class="ident" id="3549492"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span>&nbsp;<span class="op" id="3549494">=</span>&nbsp;<span class="ident" id="3549496"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549497">.</span><span class="ident" id="3549498"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3549501">,</span>&nbsp;<span class="op" id="3549503">&amp;</span><span class="ident" id="3549504"><a href="/gostd/regexp/onepass.go.html#3548818">p</a></span><span class="op" id="3549505">.</span><span class="ident" id="3549506"><a href="/gostd/regexp/syntax/prog.go.html#3659025">Inst</a></span><span class="op" id="3549510">[</span><span class="ident" id="3549511"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549512">.</span><span class="ident" id="3549513"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3549516">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3549519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3549522">return</span>&nbsp;<span class="ident" id="3549529"><a href="/gostd/regexp/onepass.go.html#3549345">buf</a></span><span class="op" id="3549532">.</span><span class="ident" id="3549533"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="3549539">(</span><span class="op" id="3549540">)</span><span class="op" id="3549541">,</span>&nbsp;<span class="ident" id="3549543"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549544">.</span><span class="ident" id="3549545"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3549548">==</span>&nbsp;<span class="ident" id="3549551"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3549557">.</span><span class="ident" id="3549558"><a href="/gostd/regexp/syntax/prog.go.html#3659250">InstEmptyWidth</a></span>&nbsp;<span class="op" id="3549573">&amp;&amp;</span>&nbsp;<span class="op" id="3549576">(</span><span class="ident" id="3549577"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3549583">.</span><span class="ident" id="3549584"><a href="/gostd/regexp/syntax/prog.go.html#3659736">EmptyOp</a></span><span class="op" id="3549591">(</span><span class="ident" id="3549592"><a href="/gostd/regexp/onepass.go.html#3548879">i</a></span><span class="op" id="3549593">.</span><span class="ident" id="3549594"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3549597">)</span><span class="op" id="3549598">)</span><span class="op" id="3549599">&amp;</span><span class="ident" id="3549600"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3549606">.</span><span class="ident" id="3549607"><a href="/gostd/regexp/syntax/prog.go.html#3659810">EmptyBeginText</a></span>&nbsp;<span class="op" id="3549622">!=</span>&nbsp;<span class="num" id="3549625">0</span><span class="op" id="3549626">,</span>&nbsp;<span class="ident" id="3549628"><a href="/gostd/regexp/onepass.go.html#3548865">pc</a></span><br>
<span class="lineno"></span><span class="op" id="3549631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="3549634">//&nbsp;OnePassNext&nbsp;selects&nbsp;the&nbsp;next&nbsp;actionable&nbsp;state&nbsp;of&nbsp;the&nbsp;prog,&nbsp;based&nbsp;on&nbsp;the&nbsp;input&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="3549726">//&nbsp;It&nbsp;should&nbsp;only&nbsp;be&nbsp;called&nbsp;when&nbsp;i.Op&nbsp;==&nbsp;InstAlt&nbsp;or&nbsp;InstAltMatch,&nbsp;and&nbsp;from&nbsp;the&nbsp;one-pass&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="3549823">//&nbsp;One&nbsp;of&nbsp;the&nbsp;alternates&nbsp;may&nbsp;ultimately&nbsp;lead&nbsp;without&nbsp;input&nbsp;to&nbsp;end&nbsp;of&nbsp;line.&nbsp;If&nbsp;the&nbsp;instruction</span><br>
<span class="lineno"></span><span class="comment" id="3549917">//&nbsp;is&nbsp;InstAltMatch&nbsp;the&nbsp;path&nbsp;to&nbsp;the&nbsp;InstMatch&nbsp;is&nbsp;in&nbsp;i.Out,&nbsp;the&nbsp;normal&nbsp;node&nbsp;in&nbsp;i.Next.</span><br>
<span class="lineno"></span><span class="keyword" id="3550002">func</span>&nbsp;<span class="ident" id="3550007">onePassNext</span><span class="op" id="3550018">(</span><span class="ident" id="3550019">i</span>&nbsp;<span class="op" id="3550021">*</span><span class="ident" id="3550022"><a href="/gostd/regexp/onepass.go.html#3548473">onePassInst</a></span><span class="op" id="3550033">,</span>&nbsp;<span class="ident" id="3550035">r</span>&nbsp;<span class="builtintype" id="3550037">rune</span><span class="op" id="3550041">)</span>&nbsp;<span class="builtintype" id="3550043">uint32</span>&nbsp;<span class="op" id="3550050">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550053">next</span>&nbsp;<span class="op" id="3550058">:=</span>&nbsp;<span class="ident" id="3550061"><a href="/gostd/regexp/onepass.go.html#3550019">i</a></span><span class="op" id="3550062">.</span><span class="ident" id="3550063"><a href="/gostd/regexp/syntax/prog.go.html#3663367">MatchRunePos</a></span><span class="op" id="3550075">(</span><span class="ident" id="3550076"><a href="/gostd/regexp/onepass.go.html#3550035">r</a></span><span class="op" id="3550077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550080">if</span>&nbsp;<span class="ident" id="3550083"><a href="/gostd/regexp/onepass.go.html#3550053">next</a></span>&nbsp;<span class="op" id="3550088">&gt;=</span>&nbsp;<span class="num" id="3550091">0</span>&nbsp;<span class="op" id="3550093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550097">return</span>&nbsp;<span class="ident" id="3550104"><a href="/gostd/regexp/onepass.go.html#3550019">i</a></span><span class="op" id="3550105">.</span><span class="ident" id="3550106"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span><span class="op" id="3550110">[</span><span class="ident" id="3550111"><a href="/gostd/regexp/onepass.go.html#3550053">next</a></span><span class="op" id="3550115">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3550118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550121">if</span>&nbsp;<span class="ident" id="3550124"><a href="/gostd/regexp/onepass.go.html#3550019">i</a></span><span class="op" id="3550125">.</span><span class="ident" id="3550126"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3550129">==</span>&nbsp;<span class="ident" id="3550132"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3550138">.</span><span class="ident" id="3550139"><a href="/gostd/regexp/syntax/prog.go.html#3659223">InstAltMatch</a></span>&nbsp;<span class="op" id="3550152">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550156">return</span>&nbsp;<span class="ident" id="3550163"><a href="/gostd/regexp/onepass.go.html#3550019">i</a></span><span class="op" id="3550164">.</span><span class="ident" id="3550165"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3550170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550173">return</span>&nbsp;<span class="num" id="3550180">0</span><br>
<span class="lineno"></span><span class="op" id="3550182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="3550185">func</span>&nbsp;<span class="ident" id="3550190">iop</span><span class="op" id="3550193">(</span><span class="ident" id="3550194">i</span>&nbsp;<span class="op" id="3550196">*</span><span class="ident" id="3550197"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3550203">.</span><span class="ident" id="3550204"><a href="/gostd/regexp/syntax/prog.go.html#3661062">Inst</a></span><span class="op" id="3550208">)</span>&nbsp;<span class="ident" id="3550210"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3550216">.</span><span class="ident" id="3550217"><a href="/gostd/regexp/syntax/prog.go.html#3659177">InstOp</a></span>&nbsp;<span class="op" id="3550224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550227">op</span>&nbsp;<span class="op" id="3550230">:=</span>&nbsp;<span class="ident" id="3550233"><a href="/gostd/regexp/onepass.go.html#3550194">i</a></span><span class="op" id="3550234">.</span><span class="ident" id="3550235"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550239">switch</span>&nbsp;<span class="ident" id="3550246"><a href="/gostd/regexp/onepass.go.html#3550227">op</a></span>&nbsp;<span class="op" id="3550249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550252">case</span>&nbsp;<span class="ident" id="3550257"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3550263">.</span><span class="ident" id="3550264"><a href="/gostd/regexp/syntax/prog.go.html#3659306">InstRune1</a></span><span class="op" id="3550273">,</span>&nbsp;<span class="ident" id="3550275"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3550281">.</span><span class="ident" id="3550282"><a href="/gostd/regexp/syntax/prog.go.html#3659317">InstRuneAny</a></span><span class="op" id="3550293">,</span>&nbsp;<span class="ident" id="3550295"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3550301">.</span><span class="ident" id="3550302"><a href="/gostd/regexp/syntax/prog.go.html#3659330">InstRuneAnyNotNL</a></span><span class="op" id="3550318">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550322"><a href="/gostd/regexp/onepass.go.html#3550227">op</a></span>&nbsp;<span class="op" id="3550325">=</span>&nbsp;<span class="ident" id="3550327"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3550333">.</span><span class="ident" id="3550334"><a href="/gostd/regexp/syntax/prog.go.html#3659296">InstRune</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3550344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550347">return</span>&nbsp;<span class="ident" id="3550354"><a href="/gostd/regexp/onepass.go.html#3550227">op</a></span><br>
<span class="lineno"></span><span class="op" id="3550357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3550360">//&nbsp;Sparse&nbsp;Array&nbsp;implementation&nbsp;is&nbsp;used&nbsp;as&nbsp;a&nbsp;queueOnePass.</span><br>
<span class="lineno">90</span><span class="keyword" id="3550418">type</span>&nbsp;<span class="ident" id="3550423">queueOnePass</span>&nbsp;<span class="keyword" id="3550436">struct</span>&nbsp;<span class="op" id="3550443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550446">sparse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3550462">[</span><span class="op" id="3550463">]</span><span class="builtintype" id="3550464">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550472">dense</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3550488">[</span><span class="op" id="3550489">]</span><span class="builtintype" id="3550490">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550498">size</span><span class="op" id="3550502">,</span>&nbsp;<span class="ident" id="3550504">nextIndex</span>&nbsp;<span class="builtintype" id="3550514">uint32</span><br>
<span class="lineno"></span><span class="op" id="3550521">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="3550524">func</span>&nbsp;<span class="op" id="3550529">(</span><span class="ident" id="3550530">q</span>&nbsp;<span class="op" id="3550532">*</span><span class="ident" id="3550533"><a href="/gostd/regexp/onepass.go.html#3550423">queueOnePass</a></span><span class="op" id="3550545">)</span>&nbsp;<span class="ident" id="3550547">empty</span><span class="op" id="3550552">(</span><span class="op" id="3550553">)</span>&nbsp;<span class="builtintype" id="3550555">bool</span>&nbsp;<span class="op" id="3550560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550563">return</span>&nbsp;<span class="ident" id="3550570"><a href="/gostd/regexp/onepass.go.html#3550530">q</a></span><span class="op" id="3550571">.</span><span class="ident" id="3550572"><a href="/gostd/regexp/onepass.go.html#3550504">nextIndex</a></span>&nbsp;<span class="op" id="3550582">&gt;=</span>&nbsp;<span class="ident" id="3550585"><a href="/gostd/regexp/onepass.go.html#3550530">q</a></span><span class="op" id="3550586">.</span><span class="ident" id="3550587"><a href="/gostd/regexp/onepass.go.html#3550498">size</a></span><br>
<span class="lineno"></span><span class="op" id="3550592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3550595">func</span>&nbsp;<span class="op" id="3550600">(</span><span class="ident" id="3550601">q</span>&nbsp;<span class="op" id="3550603">*</span><span class="ident" id="3550604"><a href="/gostd/regexp/onepass.go.html#3550423">queueOnePass</a></span><span class="op" id="3550616">)</span>&nbsp;<span class="ident" id="3550618">next</span><span class="op" id="3550622">(</span><span class="op" id="3550623">)</span>&nbsp;<span class="op" id="3550625">(</span><span class="ident" id="3550626">n</span>&nbsp;<span class="builtintype" id="3550628">uint32</span><span class="op" id="3550634">)</span>&nbsp;<span class="op" id="3550636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550639"><a href="/gostd/regexp/onepass.go.html#3550626">n</a></span>&nbsp;<span class="op" id="3550641">=</span>&nbsp;<span class="ident" id="3550643"><a href="/gostd/regexp/onepass.go.html#3550601">q</a></span><span class="op" id="3550644">.</span><span class="ident" id="3550645"><a href="/gostd/regexp/onepass.go.html#3550472">dense</a></span><span class="op" id="3550650">[</span><span class="ident" id="3550651"><a href="/gostd/regexp/onepass.go.html#3550601">q</a></span><span class="op" id="3550652">.</span><span class="ident" id="3550653"><a href="/gostd/regexp/onepass.go.html#3550504">nextIndex</a></span><span class="op" id="3550662">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550665"><a href="/gostd/regexp/onepass.go.html#3550601">q</a></span><span class="op" id="3550666">.</span><span class="ident" id="3550667"><a href="/gostd/regexp/onepass.go.html#3550504">nextIndex</a></span><span class="op" id="3550676">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550680">return</span><br>
<span class="lineno"></span><span class="op" id="3550687">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="3550690">func</span>&nbsp;<span class="op" id="3550695">(</span><span class="ident" id="3550696">q</span>&nbsp;<span class="op" id="3550698">*</span><span class="ident" id="3550699"><a href="/gostd/regexp/onepass.go.html#3550423">queueOnePass</a></span><span class="op" id="3550711">)</span>&nbsp;<span class="ident" id="3550713">clear</span><span class="op" id="3550718">(</span><span class="op" id="3550719">)</span>&nbsp;<span class="op" id="3550721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550724"><a href="/gostd/regexp/onepass.go.html#3550696">q</a></span><span class="op" id="3550725">.</span><span class="ident" id="3550726"><a href="/gostd/regexp/onepass.go.html#3550498">size</a></span>&nbsp;<span class="op" id="3550731">=</span>&nbsp;<span class="num" id="3550733">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550736"><a href="/gostd/regexp/onepass.go.html#3550696">q</a></span><span class="op" id="3550737">.</span><span class="ident" id="3550738"><a href="/gostd/regexp/onepass.go.html#3550504">nextIndex</a></span>&nbsp;<span class="op" id="3550748">=</span>&nbsp;<span class="num" id="3550750">0</span><br>
<span class="lineno"></span><span class="op" id="3550752">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="3550755">func</span>&nbsp;<span class="op" id="3550760">(</span><span class="ident" id="3550761">q</span>&nbsp;<span class="op" id="3550763">*</span><span class="ident" id="3550764"><a href="/gostd/regexp/onepass.go.html#3550423">queueOnePass</a></span><span class="op" id="3550776">)</span>&nbsp;<span class="ident" id="3550778">reset</span><span class="op" id="3550783">(</span><span class="op" id="3550784">)</span>&nbsp;<span class="op" id="3550786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550789"><a href="/gostd/regexp/onepass.go.html#3550761">q</a></span><span class="op" id="3550790">.</span><span class="ident" id="3550791"><a href="/gostd/regexp/onepass.go.html#3550504">nextIndex</a></span>&nbsp;<span class="op" id="3550801">=</span>&nbsp;<span class="num" id="3550803">0</span><br>
<span class="lineno"></span><span class="op" id="3550805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="3550808">func</span>&nbsp;<span class="op" id="3550813">(</span><span class="ident" id="3550814">q</span>&nbsp;<span class="op" id="3550816">*</span><span class="ident" id="3550817"><a href="/gostd/regexp/onepass.go.html#3550423">queueOnePass</a></span><span class="op" id="3550829">)</span>&nbsp;<span class="ident" id="3550831">contains</span><span class="op" id="3550839">(</span><span class="ident" id="3550840">u</span>&nbsp;<span class="builtintype" id="3550842">uint32</span><span class="op" id="3550848">)</span>&nbsp;<span class="builtintype" id="3550850">bool</span>&nbsp;<span class="op" id="3550855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550858">if</span>&nbsp;<span class="ident" id="3550861"><a href="/gostd/regexp/onepass.go.html#3550840">u</a></span>&nbsp;<span class="op" id="3550863">&gt;=</span>&nbsp;<span class="builtintype" id="3550866">uint32</span><span class="op" id="3550872">(</span><span class="builtinfunc" id="3550873">len</span><span class="op" id="3550876">(</span><span class="ident" id="3550877"><a href="/gostd/regexp/onepass.go.html#3550814">q</a></span><span class="op" id="3550878">.</span><span class="ident" id="3550879"><a href="/gostd/regexp/onepass.go.html#3550446">sparse</a></span><span class="op" id="3550885">)</span><span class="op" id="3550886">)</span>&nbsp;<span class="op" id="3550888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550892">return</span>&nbsp;<span class="builtintype" id="3550899">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3550906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550909">return</span>&nbsp;<span class="ident" id="3550916"><a href="/gostd/regexp/onepass.go.html#3550814">q</a></span><span class="op" id="3550917">.</span><span class="ident" id="3550918"><a href="/gostd/regexp/onepass.go.html#3550446">sparse</a></span><span class="op" id="3550924">[</span><span class="ident" id="3550925"><a href="/gostd/regexp/onepass.go.html#3550840">u</a></span><span class="op" id="3550926">]</span>&nbsp;<span class="op" id="3550928">&lt;</span>&nbsp;<span class="ident" id="3550930"><a href="/gostd/regexp/onepass.go.html#3550814">q</a></span><span class="op" id="3550931">.</span><span class="ident" id="3550932"><a href="/gostd/regexp/onepass.go.html#3550498">size</a></span>&nbsp;<span class="op" id="3550937">&amp;&amp;</span>&nbsp;<span class="ident" id="3550940"><a href="/gostd/regexp/onepass.go.html#3550814">q</a></span><span class="op" id="3550941">.</span><span class="ident" id="3550942"><a href="/gostd/regexp/onepass.go.html#3550472">dense</a></span><span class="op" id="3550947">[</span><span class="ident" id="3550948"><a href="/gostd/regexp/onepass.go.html#3550814">q</a></span><span class="op" id="3550949">.</span><span class="ident" id="3550950"><a href="/gostd/regexp/onepass.go.html#3550446">sparse</a></span><span class="op" id="3550956">[</span><span class="ident" id="3550957"><a href="/gostd/regexp/onepass.go.html#3550840">u</a></span><span class="op" id="3550958">]</span><span class="op" id="3550959">]</span>&nbsp;<span class="op" id="3550961">==</span>&nbsp;<span class="ident" id="3550964"><a href="/gostd/regexp/onepass.go.html#3550840">u</a></span><br>
<span class="lineno">120</span><span class="op" id="3550966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3550969">func</span>&nbsp;<span class="op" id="3550974">(</span><span class="ident" id="3550975">q</span>&nbsp;<span class="op" id="3550977">*</span><span class="ident" id="3550978"><a href="/gostd/regexp/onepass.go.html#3550423">queueOnePass</a></span><span class="op" id="3550990">)</span>&nbsp;<span class="ident" id="3550992">insert</span><span class="op" id="3550998">(</span><span class="ident" id="3550999">u</span>&nbsp;<span class="builtintype" id="3551001">uint32</span><span class="op" id="3551007">)</span>&nbsp;<span class="op" id="3551009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3551012">if</span>&nbsp;<span class="op" id="3551015">!</span><span class="ident" id="3551016"><a href="/gostd/regexp/onepass.go.html#3550975">q</a></span><span class="op" id="3551017">.</span><span class="ident" id="3551018"><a href="/gostd/regexp/onepass.go.html#3550831">contains</a></span><span class="op" id="3551026">(</span><span class="ident" id="3551027"><a href="/gostd/regexp/onepass.go.html#3550999">u</a></span><span class="op" id="3551028">)</span>&nbsp;<span class="op" id="3551030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3551034"><a href="/gostd/regexp/onepass.go.html#3550975">q</a></span><span class="op" id="3551035">.</span><span class="ident" id="3551036"><a href="/gostd/regexp/onepass.go.html#3551078">insertNew</a></span><span class="op" id="3551045">(</span><span class="ident" id="3551046"><a href="/gostd/regexp/onepass.go.html#3550999">u</a></span><span class="op" id="3551047">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3551050">}</span><br>
<span class="lineno"></span><span class="op" id="3551052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3551055">func</span>&nbsp;<span class="op" id="3551060">(</span><span class="ident" id="3551061">q</span>&nbsp;<span class="op" id="3551063">*</span><span class="ident" id="3551064"><a href="/gostd/regexp/onepass.go.html#3550423">queueOnePass</a></span><span class="op" id="3551076">)</span>&nbsp;<span class="ident" id="3551078">insertNew</span><span class="op" id="3551087">(</span><span class="ident" id="3551088">u</span>&nbsp;<span class="builtintype" id="3551090">uint32</span><span class="op" id="3551096">)</span>&nbsp;<span class="op" id="3551098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3551101">if</span>&nbsp;<span class="ident" id="3551104"><a href="/gostd/regexp/onepass.go.html#3551088">u</a></span>&nbsp;<span class="op" id="3551106">&gt;=</span>&nbsp;<span class="builtintype" id="3551109">uint32</span><span class="op" id="3551115">(</span><span class="builtinfunc" id="3551116">len</span><span class="op" id="3551119">(</span><span class="ident" id="3551120"><a href="/gostd/regexp/onepass.go.html#3551061">q</a></span><span class="op" id="3551121">.</span><span class="ident" id="3551122"><a href="/gostd/regexp/onepass.go.html#3550446">sparse</a></span><span class="op" id="3551128">)</span><span class="op" id="3551129">)</span>&nbsp;<span class="op" id="3551131">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3551135">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3551143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3551146"><a href="/gostd/regexp/onepass.go.html#3551061">q</a></span><span class="op" id="3551147">.</span><span class="ident" id="3551148"><a href="/gostd/regexp/onepass.go.html#3550446">sparse</a></span><span class="op" id="3551154">[</span><span class="ident" id="3551155"><a href="/gostd/regexp/onepass.go.html#3551088">u</a></span><span class="op" id="3551156">]</span>&nbsp;<span class="op" id="3551158">=</span>&nbsp;<span class="ident" id="3551160"><a href="/gostd/regexp/onepass.go.html#3551061">q</a></span><span class="op" id="3551161">.</span><span class="ident" id="3551162"><a href="/gostd/regexp/onepass.go.html#3550498">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3551168"><a href="/gostd/regexp/onepass.go.html#3551061">q</a></span><span class="op" id="3551169">.</span><span class="ident" id="3551170"><a href="/gostd/regexp/onepass.go.html#3550472">dense</a></span><span class="op" id="3551175">[</span><span class="ident" id="3551176"><a href="/gostd/regexp/onepass.go.html#3551061">q</a></span><span class="op" id="3551177">.</span><span class="ident" id="3551178"><a href="/gostd/regexp/onepass.go.html#3550498">size</a></span><span class="op" id="3551182">]</span>&nbsp;<span class="op" id="3551184">=</span>&nbsp;<span class="ident" id="3551186"><a href="/gostd/regexp/onepass.go.html#3551088">u</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3551189"><a href="/gostd/regexp/onepass.go.html#3551061">q</a></span><span class="op" id="3551190">.</span><span class="ident" id="3551191"><a href="/gostd/regexp/onepass.go.html#3550498">size</a></span><span class="op" id="3551195">++</span><br>
<span class="lineno">135</span><span class="op" id="3551198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3551201">func</span>&nbsp;<span class="ident" id="3551206">newQueue</span><span class="op" id="3551214">(</span><span class="ident" id="3551215">size</span>&nbsp;<span class="builtintype" id="3551220">int</span><span class="op" id="3551223">)</span>&nbsp;<span class="op" id="3551225">(</span><span class="ident" id="3551226">q</span>&nbsp;<span class="op" id="3551228">*</span><span class="ident" id="3551229"><a href="/gostd/regexp/onepass.go.html#3550423">queueOnePass</a></span><span class="op" id="3551241">)</span>&nbsp;<span class="op" id="3551243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3551246">return</span>&nbsp;<span class="op" id="3551253">&amp;</span><span class="ident" id="3551254"><a href="/gostd/regexp/onepass.go.html#3550423">queueOnePass</a></span><span class="op" id="3551266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3551270"><a href="/gostd/regexp/onepass.go.html#3550446">sparse</a></span><span class="op" id="3551276">:</span>&nbsp;<span class="builtinfunc" id="3551278">make</span><span class="op" id="3551282">(</span><span class="op" id="3551283">[</span><span class="op" id="3551284">]</span><span class="builtintype" id="3551285">uint32</span><span class="op" id="3551291">,</span>&nbsp;<span class="ident" id="3551293"><a href="/gostd/regexp/onepass.go.html#3551215">size</a></span><span class="op" id="3551297">)</span><span class="op" id="3551298">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3551302"><a href="/gostd/regexp/onepass.go.html#3550472">dense</a></span><span class="op" id="3551307">:</span>&nbsp;&nbsp;<span class="builtinfunc" id="3551310">make</span><span class="op" id="3551314">(</span><span class="op" id="3551315">[</span><span class="op" id="3551316">]</span><span class="builtintype" id="3551317">uint32</span><span class="op" id="3551323">,</span>&nbsp;<span class="ident" id="3551325"><a href="/gostd/regexp/onepass.go.html#3551215">size</a></span><span class="op" id="3551329">)</span><span class="op" id="3551330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3551333">}</span><br>
<span class="lineno"></span><span class="op" id="3551335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3551338">//&nbsp;mergeRuneSets&nbsp;merges&nbsp;two&nbsp;non-intersecting&nbsp;runesets,&nbsp;and&nbsp;returns&nbsp;the&nbsp;merged&nbsp;result,</span><br>
<span class="lineno">145</span><span class="comment" id="3551424">//&nbsp;and&nbsp;a&nbsp;NextIp&nbsp;array.&nbsp;The&nbsp;idea&nbsp;is&nbsp;that&nbsp;if&nbsp;a&nbsp;rune&nbsp;matches&nbsp;the&nbsp;OnePassRunes&nbsp;at&nbsp;index</span><br>
<span class="lineno"></span><span class="comment" id="3551508">//&nbsp;i,&nbsp;NextIp[i/2]&nbsp;is&nbsp;the&nbsp;target.&nbsp;If&nbsp;the&nbsp;input&nbsp;sets&nbsp;intersect,&nbsp;an&nbsp;empty&nbsp;runeset&nbsp;and&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3551593">//&nbsp;NextIp&nbsp;array&nbsp;with&nbsp;the&nbsp;single&nbsp;element&nbsp;mergeFailed&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="3551658">//&nbsp;The&nbsp;code&nbsp;assumes&nbsp;that&nbsp;both&nbsp;inputs&nbsp;contain&nbsp;ordered&nbsp;and&nbsp;non-intersecting&nbsp;rune&nbsp;pairs.</span><br>
<span class="lineno"></span><span class="keyword" id="3551744">const</span>&nbsp;<span class="ident" id="3551750">mergeFailed</span>&nbsp;<span class="op" id="3551762">=</span>&nbsp;<span class="builtintype" id="3551764">uint32</span><span class="op" id="3551770">(</span><span class="num" id="3551771">0xffffffff</span><span class="op" id="3551781">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="3551784">var</span>&nbsp;<span class="op" id="3551788">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3551791">noRune</span>&nbsp;<span class="op" id="3551798">=</span>&nbsp;<span class="op" id="3551800">[</span><span class="op" id="3551801">]</span><span class="builtintype" id="3551802">rune</span><span class="op" id="3551806">{</span><span class="op" id="3551807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3551810">noNext</span>&nbsp;<span class="op" id="3551817">=</span>&nbsp;<span class="op" id="3551819">[</span><span class="op" id="3551820">]</span><span class="builtintype" id="3551821">uint32</span><span class="op" id="3551827">{</span><span class="ident" id="3551828"><a href="/gostd/regexp/onepass.go.html#3551750">mergeFailed</a></span><span class="op" id="3551839">}</span><br>
<span class="lineno"></span><span class="op" id="3551841">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="3551844">func</span>&nbsp;<span class="ident" id="3551849">mergeRuneSets</span><span class="op" id="3551862">(</span><span class="ident" id="3551863">leftRunes</span><span class="op" id="3551872">,</span>&nbsp;<span class="ident" id="3551874">rightRunes</span>&nbsp;<span class="op" id="3551885">*</span><span class="op" id="3551886">[</span><span class="op" id="3551887">]</span><span class="builtintype" id="3551888">rune</span><span class="op" id="3551892">,</span>&nbsp;<span class="ident" id="3551894">leftPC</span><span class="op" id="3551900">,</span>&nbsp;<span class="ident" id="3551902">rightPC</span>&nbsp;<span class="builtintype" id="3551910">uint32</span><span class="op" id="3551916">)</span>&nbsp;<span class="op" id="3551918">(</span><span class="op" id="3551919">[</span><span class="op" id="3551920">]</span><span class="builtintype" id="3551921">rune</span><span class="op" id="3551925">,</span>&nbsp;<span class="op" id="3551927">[</span><span class="op" id="3551928">]</span><span class="builtintype" id="3551929">uint32</span><span class="op" id="3551935">)</span>&nbsp;<span class="op" id="3551937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3551940">leftLen</span>&nbsp;<span class="op" id="3551948">:=</span>&nbsp;<span class="builtinfunc" id="3551951">len</span><span class="op" id="3551954">(</span><span class="op" id="3551955">*</span><span class="ident" id="3551956"><a href="/gostd/regexp/onepass.go.html#3551863">leftRunes</a></span><span class="op" id="3551965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3551968">rightLen</span>&nbsp;<span class="op" id="3551977">:=</span>&nbsp;<span class="builtinfunc" id="3551980">len</span><span class="op" id="3551983">(</span><span class="op" id="3551984">*</span><span class="ident" id="3551985"><a href="/gostd/regexp/onepass.go.html#3551874">rightRunes</a></span><span class="op" id="3551995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3551998">if</span>&nbsp;<span class="ident" id="3552001"><a href="/gostd/regexp/onepass.go.html#3551940">leftLen</a></span><span class="op" id="3552008">&amp;</span><span class="num" id="3552009">0x1</span>&nbsp;<span class="op" id="3552013">!=</span>&nbsp;<span class="num" id="3552016">0</span>&nbsp;<span class="op" id="3552018">||</span>&nbsp;<span class="ident" id="3552021"><a href="/gostd/regexp/onepass.go.html#3551968">rightLen</a></span><span class="op" id="3552029">&amp;</span><span class="num" id="3552030">0x1</span>&nbsp;<span class="op" id="3552034">!=</span>&nbsp;<span class="num" id="3552037">0</span>&nbsp;<span class="op" id="3552039">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3552043">panic</span><span class="op" id="3552048">(</span><span class="string" id="3552049">&#34;mergeRuneSets&nbsp;odd&nbsp;length&nbsp;[]rune&#34;</span><span class="op" id="3552082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552088">var</span>&nbsp;<span class="op" id="3552092">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552096">lx</span><span class="op" id="3552098">,</span>&nbsp;<span class="ident" id="3552100">rx</span>&nbsp;<span class="builtintype" id="3552103">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552108">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552111">merged</span>&nbsp;<span class="op" id="3552118">:=</span>&nbsp;<span class="builtinfunc" id="3552121">make</span><span class="op" id="3552125">(</span><span class="op" id="3552126">[</span><span class="op" id="3552127">]</span><span class="builtintype" id="3552128">rune</span><span class="op" id="3552132">,</span>&nbsp;<span class="num" id="3552134">0</span><span class="op" id="3552135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552138">next</span>&nbsp;<span class="op" id="3552143">:=</span>&nbsp;<span class="builtinfunc" id="3552146">make</span><span class="op" id="3552150">(</span><span class="op" id="3552151">[</span><span class="op" id="3552152">]</span><span class="builtintype" id="3552153">uint32</span><span class="op" id="3552159">,</span>&nbsp;<span class="num" id="3552161">0</span><span class="op" id="3552162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552165">ok</span>&nbsp;<span class="op" id="3552168">:=</span>&nbsp;<span class="builtintype" id="3552171">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552177">defer</span>&nbsp;<span class="keyword" id="3552183">func</span><span class="op" id="3552187">(</span><span class="op" id="3552188">)</span>&nbsp;<span class="op" id="3552190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552194">if</span>&nbsp;<span class="op" id="3552197">!</span><span class="ident" id="3552198"><a href="/gostd/regexp/onepass.go.html#3552165">ok</a></span>&nbsp;<span class="op" id="3552201">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552206"><a href="/gostd/regexp/onepass.go.html#3552111">merged</a></span>&nbsp;<span class="op" id="3552213">=</span>&nbsp;<span class="builtintype" id="3552215">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552222"><a href="/gostd/regexp/onepass.go.html#3552138">next</a></span>&nbsp;<span class="op" id="3552227">=</span>&nbsp;<span class="builtintype" id="3552229">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552238">}</span><span class="op" id="3552239">(</span><span class="op" id="3552240">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552244">ix</span>&nbsp;<span class="op" id="3552247">:=</span>&nbsp;<span class="op" id="3552250">-</span><span class="num" id="3552251">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552254">extend</span>&nbsp;<span class="op" id="3552261">:=</span>&nbsp;<span class="keyword" id="3552264">func</span><span class="op" id="3552268">(</span><span class="ident" id="3552269">newLow</span>&nbsp;<span class="op" id="3552276">*</span><span class="builtintype" id="3552277">int</span><span class="op" id="3552280">,</span>&nbsp;<span class="ident" id="3552282">newArray</span>&nbsp;<span class="op" id="3552291">*</span><span class="op" id="3552292">[</span><span class="op" id="3552293">]</span><span class="builtintype" id="3552294">rune</span><span class="op" id="3552298">,</span>&nbsp;<span class="ident" id="3552300">pc</span>&nbsp;<span class="builtintype" id="3552303">uint32</span><span class="op" id="3552309">)</span>&nbsp;<span class="builtintype" id="3552311">bool</span>&nbsp;<span class="op" id="3552316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552320">if</span>&nbsp;<span class="ident" id="3552323"><a href="/gostd/regexp/onepass.go.html#3552244">ix</a></span>&nbsp;<span class="op" id="3552326">&gt;</span>&nbsp;<span class="num" id="3552328">0</span>&nbsp;<span class="op" id="3552330">&amp;&amp;</span>&nbsp;<span class="op" id="3552333">(</span><span class="op" id="3552334">*</span><span class="ident" id="3552335"><a href="/gostd/regexp/onepass.go.html#3552282">newArray</a></span><span class="op" id="3552343">)</span><span class="op" id="3552344">[</span><span class="op" id="3552345">*</span><span class="ident" id="3552346"><a href="/gostd/regexp/onepass.go.html#3552269">newLow</a></span><span class="op" id="3552352">]</span>&nbsp;<span class="op" id="3552354">&lt;=</span>&nbsp;<span class="ident" id="3552357"><a href="/gostd/regexp/onepass.go.html#3552111">merged</a></span><span class="op" id="3552363">[</span><span class="ident" id="3552364"><a href="/gostd/regexp/onepass.go.html#3552244">ix</a></span><span class="op" id="3552366">]</span>&nbsp;<span class="op" id="3552368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552373">return</span>&nbsp;<span class="builtintype" id="3552380">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552388">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552392"><a href="/gostd/regexp/onepass.go.html#3552111">merged</a></span>&nbsp;<span class="op" id="3552399">=</span>&nbsp;<span class="builtinfunc" id="3552401">append</span><span class="op" id="3552407">(</span><span class="ident" id="3552408"><a href="/gostd/regexp/onepass.go.html#3552111">merged</a></span><span class="op" id="3552414">,</span>&nbsp;<span class="op" id="3552416">(</span><span class="op" id="3552417">*</span><span class="ident" id="3552418"><a href="/gostd/regexp/onepass.go.html#3552282">newArray</a></span><span class="op" id="3552426">)</span><span class="op" id="3552427">[</span><span class="op" id="3552428">*</span><span class="ident" id="3552429"><a href="/gostd/regexp/onepass.go.html#3552269">newLow</a></span><span class="op" id="3552435">]</span><span class="op" id="3552436">,</span>&nbsp;<span class="op" id="3552438">(</span><span class="op" id="3552439">*</span><span class="ident" id="3552440"><a href="/gostd/regexp/onepass.go.html#3552282">newArray</a></span><span class="op" id="3552448">)</span><span class="op" id="3552449">[</span><span class="op" id="3552450">*</span><span class="ident" id="3552451"><a href="/gostd/regexp/onepass.go.html#3552269">newLow</a></span><span class="op" id="3552457">+</span><span class="num" id="3552458">1</span><span class="op" id="3552459">]</span><span class="op" id="3552460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552464">*</span><span class="ident" id="3552465"><a href="/gostd/regexp/onepass.go.html#3552269">newLow</a></span>&nbsp;<span class="op" id="3552472">+=</span>&nbsp;<span class="num" id="3552475">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552479"><a href="/gostd/regexp/onepass.go.html#3552244">ix</a></span>&nbsp;<span class="op" id="3552482">+=</span>&nbsp;<span class="num" id="3552485">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552489"><a href="/gostd/regexp/onepass.go.html#3552138">next</a></span>&nbsp;<span class="op" id="3552494">=</span>&nbsp;<span class="builtinfunc" id="3552496">append</span><span class="op" id="3552502">(</span><span class="ident" id="3552503"><a href="/gostd/regexp/onepass.go.html#3552138">next</a></span><span class="op" id="3552507">,</span>&nbsp;<span class="ident" id="3552509"><a href="/gostd/regexp/onepass.go.html#3552300">pc</a></span><span class="op" id="3552511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552515">return</span>&nbsp;<span class="builtintype" id="3552522">true</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552532">for</span>&nbsp;<span class="ident" id="3552536"><a href="/gostd/regexp/onepass.go.html#3552096">lx</a></span>&nbsp;<span class="op" id="3552539">&lt;</span>&nbsp;<span class="ident" id="3552541"><a href="/gostd/regexp/onepass.go.html#3551940">leftLen</a></span>&nbsp;<span class="op" id="3552549">||</span>&nbsp;<span class="ident" id="3552552"><a href="/gostd/regexp/onepass.go.html#3552100">rx</a></span>&nbsp;<span class="op" id="3552555">&lt;</span>&nbsp;<span class="ident" id="3552557"><a href="/gostd/regexp/onepass.go.html#3551968">rightLen</a></span>&nbsp;<span class="op" id="3552566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552570">switch</span>&nbsp;<span class="op" id="3552577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552581">case</span>&nbsp;<span class="ident" id="3552586"><a href="/gostd/regexp/onepass.go.html#3552100">rx</a></span>&nbsp;<span class="op" id="3552589">&gt;=</span>&nbsp;<span class="ident" id="3552592"><a href="/gostd/regexp/onepass.go.html#3551968">rightLen</a></span><span class="op" id="3552600">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552605"><a href="/gostd/regexp/onepass.go.html#3552165">ok</a></span>&nbsp;<span class="op" id="3552608">=</span>&nbsp;<span class="ident" id="3552610"><a href="/gostd/regexp/onepass.go.html#3552254">extend</a></span><span class="op" id="3552616">(</span><span class="op" id="3552617">&amp;</span><span class="ident" id="3552618"><a href="/gostd/regexp/onepass.go.html#3552096">lx</a></span><span class="op" id="3552620">,</span>&nbsp;<span class="ident" id="3552622"><a href="/gostd/regexp/onepass.go.html#3551863">leftRunes</a></span><span class="op" id="3552631">,</span>&nbsp;<span class="ident" id="3552633"><a href="/gostd/regexp/onepass.go.html#3551894">leftPC</a></span><span class="op" id="3552639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552643">case</span>&nbsp;<span class="ident" id="3552648"><a href="/gostd/regexp/onepass.go.html#3552096">lx</a></span>&nbsp;<span class="op" id="3552651">&gt;=</span>&nbsp;<span class="ident" id="3552654"><a href="/gostd/regexp/onepass.go.html#3551940">leftLen</a></span><span class="op" id="3552661">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552666"><a href="/gostd/regexp/onepass.go.html#3552165">ok</a></span>&nbsp;<span class="op" id="3552669">=</span>&nbsp;<span class="ident" id="3552671"><a href="/gostd/regexp/onepass.go.html#3552254">extend</a></span><span class="op" id="3552677">(</span><span class="op" id="3552678">&amp;</span><span class="ident" id="3552679"><a href="/gostd/regexp/onepass.go.html#3552100">rx</a></span><span class="op" id="3552681">,</span>&nbsp;<span class="ident" id="3552683"><a href="/gostd/regexp/onepass.go.html#3551874">rightRunes</a></span><span class="op" id="3552693">,</span>&nbsp;<span class="ident" id="3552695"><a href="/gostd/regexp/onepass.go.html#3551902">rightPC</a></span><span class="op" id="3552702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552706">case</span>&nbsp;<span class="op" id="3552711">(</span><span class="op" id="3552712">*</span><span class="ident" id="3552713"><a href="/gostd/regexp/onepass.go.html#3551874">rightRunes</a></span><span class="op" id="3552723">)</span><span class="op" id="3552724">[</span><span class="ident" id="3552725"><a href="/gostd/regexp/onepass.go.html#3552100">rx</a></span><span class="op" id="3552727">]</span>&nbsp;<span class="op" id="3552729">&lt;</span>&nbsp;<span class="op" id="3552731">(</span><span class="op" id="3552732">*</span><span class="ident" id="3552733"><a href="/gostd/regexp/onepass.go.html#3551863">leftRunes</a></span><span class="op" id="3552742">)</span><span class="op" id="3552743">[</span><span class="ident" id="3552744"><a href="/gostd/regexp/onepass.go.html#3552096">lx</a></span><span class="op" id="3552746">]</span><span class="op" id="3552747">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552752"><a href="/gostd/regexp/onepass.go.html#3552165">ok</a></span>&nbsp;<span class="op" id="3552755">=</span>&nbsp;<span class="ident" id="3552757"><a href="/gostd/regexp/onepass.go.html#3552254">extend</a></span><span class="op" id="3552763">(</span><span class="op" id="3552764">&amp;</span><span class="ident" id="3552765"><a href="/gostd/regexp/onepass.go.html#3552100">rx</a></span><span class="op" id="3552767">,</span>&nbsp;<span class="ident" id="3552769"><a href="/gostd/regexp/onepass.go.html#3551874">rightRunes</a></span><span class="op" id="3552779">,</span>&nbsp;<span class="ident" id="3552781"><a href="/gostd/regexp/onepass.go.html#3551902">rightPC</a></span><span class="op" id="3552788">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552792">default</span><span class="op" id="3552799">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552804"><a href="/gostd/regexp/onepass.go.html#3552165">ok</a></span>&nbsp;<span class="op" id="3552807">=</span>&nbsp;<span class="ident" id="3552809"><a href="/gostd/regexp/onepass.go.html#3552254">extend</a></span><span class="op" id="3552815">(</span><span class="op" id="3552816">&amp;</span><span class="ident" id="3552817"><a href="/gostd/regexp/onepass.go.html#3552096">lx</a></span><span class="op" id="3552819">,</span>&nbsp;<span class="ident" id="3552821"><a href="/gostd/regexp/onepass.go.html#3551863">leftRunes</a></span><span class="op" id="3552830">,</span>&nbsp;<span class="ident" id="3552832"><a href="/gostd/regexp/onepass.go.html#3551894">leftPC</a></span><span class="op" id="3552838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552846">if</span>&nbsp;<span class="op" id="3552849">!</span><span class="ident" id="3552850"><a href="/gostd/regexp/onepass.go.html#3552165">ok</a></span>&nbsp;<span class="op" id="3552853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552858">return</span>&nbsp;<span class="ident" id="3552865"><a href="/gostd/regexp/onepass.go.html#3551791">noRune</a></span><span class="op" id="3552871">,</span>&nbsp;<span class="ident" id="3552873"><a href="/gostd/regexp/onepass.go.html#3551810">noNext</a></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552888">return</span>&nbsp;<span class="ident" id="3552895"><a href="/gostd/regexp/onepass.go.html#3552111">merged</a></span><span class="op" id="3552901">,</span>&nbsp;<span class="ident" id="3552903"><a href="/gostd/regexp/onepass.go.html#3552138">next</a></span><br>
<span class="lineno"></span><span class="op" id="3552908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="3552911">//&nbsp;cleanupOnePass&nbsp;drops&nbsp;working&nbsp;memory,&nbsp;and&nbsp;restores&nbsp;certain&nbsp;shortcut&nbsp;instructions.</span><br>
<span class="lineno"></span><span class="keyword" id="3552995">func</span>&nbsp;<span class="ident" id="3553000">cleanupOnePass</span><span class="op" id="3553014">(</span><span class="ident" id="3553015">prog</span>&nbsp;<span class="op" id="3553020">*</span><span class="ident" id="3553021"><a href="/gostd/regexp/onepass.go.html#3548182">onePassProg</a></span><span class="op" id="3553032">,</span>&nbsp;<span class="ident" id="3553034">original</span>&nbsp;<span class="op" id="3553043">*</span><span class="ident" id="3553044"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3553050">.</span><span class="ident" id="3553051"><a href="/gostd/regexp/syntax/prog.go.html#3659010">Prog</a></span><span class="op" id="3553055">)</span>&nbsp;<span class="op" id="3553057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553060">for</span>&nbsp;<span class="ident" id="3553064">ix</span><span class="op" id="3553066">,</span>&nbsp;<span class="ident" id="3553068">instOriginal</span>&nbsp;<span class="op" id="3553081">:=</span>&nbsp;<span class="keyword" id="3553084">range</span>&nbsp;<span class="ident" id="3553090"><a href="/gostd/regexp/onepass.go.html#3553034">original</a></span><span class="op" id="3553098">.</span><span class="ident" id="3553099"><a href="/gostd/regexp/syntax/prog.go.html#3659025">Inst</a></span>&nbsp;<span class="op" id="3553104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553108">switch</span>&nbsp;<span class="ident" id="3553115"><a href="/gostd/regexp/onepass.go.html#3553068">instOriginal</a></span><span class="op" id="3553127">.</span><span class="ident" id="3553128"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3553131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553135">case</span>&nbsp;<span class="ident" id="3553140"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3553146">.</span><span class="ident" id="3553147"><a href="/gostd/regexp/syntax/prog.go.html#3659200">InstAlt</a></span><span class="op" id="3553154">,</span>&nbsp;<span class="ident" id="3553156"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3553162">.</span><span class="ident" id="3553163"><a href="/gostd/regexp/syntax/prog.go.html#3659223">InstAltMatch</a></span><span class="op" id="3553175">,</span>&nbsp;<span class="ident" id="3553177"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3553183">.</span><span class="ident" id="3553184"><a href="/gostd/regexp/syntax/prog.go.html#3659296">InstRune</a></span><span class="op" id="3553192">:</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553196">case</span>&nbsp;<span class="ident" id="3553201"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3553207">.</span><span class="ident" id="3553208"><a href="/gostd/regexp/syntax/prog.go.html#3659237">InstCapture</a></span><span class="op" id="3553219">,</span>&nbsp;<span class="ident" id="3553221"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3553227">.</span><span class="ident" id="3553228"><a href="/gostd/regexp/syntax/prog.go.html#3659250">InstEmptyWidth</a></span><span class="op" id="3553242">,</span>&nbsp;<span class="ident" id="3553244"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3553250">.</span><span class="ident" id="3553251"><a href="/gostd/regexp/syntax/prog.go.html#3659287">InstNop</a></span><span class="op" id="3553258">,</span>&nbsp;<span class="ident" id="3553260"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3553266">.</span><span class="ident" id="3553267"><a href="/gostd/regexp/syntax/prog.go.html#3659266">InstMatch</a></span><span class="op" id="3553276">,</span>&nbsp;<span class="ident" id="3553278"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3553284">.</span><span class="ident" id="3553285"><a href="/gostd/regexp/syntax/prog.go.html#3659277">InstFail</a></span><span class="op" id="3553293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553298"><a href="/gostd/regexp/onepass.go.html#3553015">prog</a></span><span class="op" id="3553302">.</span><span class="ident" id="3553303"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3553307">[</span><span class="ident" id="3553308"><a href="/gostd/regexp/onepass.go.html#3553064">ix</a></span><span class="op" id="3553310">]</span><span class="op" id="3553311">.</span><span class="ident" id="3553312"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3553317">=</span>&nbsp;<span class="builtintype" id="3553319">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553325">case</span>&nbsp;<span class="ident" id="3553330"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3553336">.</span><span class="ident" id="3553337"><a href="/gostd/regexp/syntax/prog.go.html#3659306">InstRune1</a></span><span class="op" id="3553346">,</span>&nbsp;<span class="ident" id="3553348"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3553354">.</span><span class="ident" id="3553355"><a href="/gostd/regexp/syntax/prog.go.html#3659317">InstRuneAny</a></span><span class="op" id="3553366">,</span>&nbsp;<span class="ident" id="3553368"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3553374">.</span><span class="ident" id="3553375"><a href="/gostd/regexp/syntax/prog.go.html#3659330">InstRuneAnyNotNL</a></span><span class="op" id="3553391">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553396"><a href="/gostd/regexp/onepass.go.html#3553015">prog</a></span><span class="op" id="3553400">.</span><span class="ident" id="3553401"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3553405">[</span><span class="ident" id="3553406"><a href="/gostd/regexp/onepass.go.html#3553064">ix</a></span><span class="op" id="3553408">]</span><span class="op" id="3553409">.</span><span class="ident" id="3553410"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3553415">=</span>&nbsp;<span class="builtintype" id="3553417">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553424"><a href="/gostd/regexp/onepass.go.html#3553015">prog</a></span><span class="op" id="3553428">.</span><span class="ident" id="3553429"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3553433">[</span><span class="ident" id="3553434"><a href="/gostd/regexp/onepass.go.html#3553064">ix</a></span><span class="op" id="3553436">]</span>&nbsp;<span class="op" id="3553438">=</span>&nbsp;<span class="ident" id="3553440"><a href="/gostd/regexp/onepass.go.html#3548473">onePassInst</a></span><span class="op" id="3553451">{</span><span class="ident" id="3553452"><a href="/gostd/regexp/onepass.go.html#3548495">Inst</a></span><span class="op" id="3553456">:</span>&nbsp;<span class="ident" id="3553458"><a href="/gostd/regexp/onepass.go.html#3553068">instOriginal</a></span><span class="op" id="3553470">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3553474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3553477">}</span><br>
<span class="lineno"></span><span class="op" id="3553479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3553482">//&nbsp;onePassCopy&nbsp;creates&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;original&nbsp;Prog,&nbsp;as&nbsp;we&#39;ll&nbsp;be&nbsp;modifying&nbsp;it</span><br>
<span class="lineno">220</span><span class="keyword" id="3553559">func</span>&nbsp;<span class="ident" id="3553564">onePassCopy</span><span class="op" id="3553575">(</span><span class="ident" id="3553576">prog</span>&nbsp;<span class="op" id="3553581">*</span><span class="ident" id="3553582"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3553588">.</span><span class="ident" id="3553589"><a href="/gostd/regexp/syntax/prog.go.html#3659010">Prog</a></span><span class="op" id="3553593">)</span>&nbsp;<span class="op" id="3553595">*</span><span class="ident" id="3553596"><a href="/gostd/regexp/onepass.go.html#3548182">onePassProg</a></span>&nbsp;<span class="op" id="3553608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553611">p</span>&nbsp;<span class="op" id="3553613">:=</span>&nbsp;<span class="op" id="3553616">&amp;</span><span class="ident" id="3553617"><a href="/gostd/regexp/onepass.go.html#3548182">onePassProg</a></span><span class="op" id="3553628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553632"><a href="/gostd/regexp/onepass.go.html#3548226">Start</a></span><span class="op" id="3553637">:</span>&nbsp;&nbsp;<span class="ident" id="3553640"><a href="/gostd/regexp/onepass.go.html#3553576">prog</a></span><span class="op" id="3553644">.</span><span class="ident" id="3553645"><a href="/gostd/regexp/syntax/prog.go.html#3659040">Start</a></span><span class="op" id="3553650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553654"><a href="/gostd/regexp/onepass.go.html#3548268">NumCap</a></span><span class="op" id="3553660">:</span>&nbsp;<span class="ident" id="3553662"><a href="/gostd/regexp/onepass.go.html#3553576">prog</a></span><span class="op" id="3553666">.</span><span class="ident" id="3553667"><a href="/gostd/regexp/syntax/prog.go.html#3659082">NumCap</a></span><span class="op" id="3553673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3553676">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553679">for</span>&nbsp;<span class="ident" id="3553683">_</span><span class="op" id="3553684">,</span>&nbsp;<span class="ident" id="3553686">inst</span>&nbsp;<span class="op" id="3553691">:=</span>&nbsp;<span class="keyword" id="3553694">range</span>&nbsp;<span class="ident" id="3553700"><a href="/gostd/regexp/onepass.go.html#3553576">prog</a></span><span class="op" id="3553704">.</span><span class="ident" id="3553705"><a href="/gostd/regexp/syntax/prog.go.html#3659025">Inst</a></span>&nbsp;<span class="op" id="3553710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553714"><a href="/gostd/regexp/onepass.go.html#3553611">p</a></span><span class="op" id="3553715">.</span><span class="ident" id="3553716"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span>&nbsp;<span class="op" id="3553721">=</span>&nbsp;<span class="builtinfunc" id="3553723">append</span><span class="op" id="3553729">(</span><span class="ident" id="3553730"><a href="/gostd/regexp/onepass.go.html#3553611">p</a></span><span class="op" id="3553731">.</span><span class="ident" id="3553732"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3553736">,</span>&nbsp;<span class="ident" id="3553738"><a href="/gostd/regexp/onepass.go.html#3548473">onePassInst</a></span><span class="op" id="3553749">{</span><span class="ident" id="3553750"><a href="/gostd/regexp/onepass.go.html#3548495">Inst</a></span><span class="op" id="3553754">:</span>&nbsp;<span class="ident" id="3553756"><a href="/gostd/regexp/onepass.go.html#3553686">inst</a></span><span class="op" id="3553760">}</span><span class="op" id="3553761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3553764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3553768">//&nbsp;rewrites&nbsp;one&nbsp;or&nbsp;more&nbsp;common&nbsp;Prog&nbsp;constructs&nbsp;that&nbsp;enable&nbsp;some&nbsp;otherwise</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3553843">//&nbsp;non-onepass&nbsp;Progs&nbsp;to&nbsp;be&nbsp;onepass.&nbsp;A:BD&nbsp;(for&nbsp;example)&nbsp;means&nbsp;an&nbsp;InstAlt&nbsp;at</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3553919">//&nbsp;ip&nbsp;A,&nbsp;that&nbsp;points&nbsp;to&nbsp;ips&nbsp;B&nbsp;&amp;&nbsp;C.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3553955">//&nbsp;A:BC&nbsp;+&nbsp;B:DA&nbsp;=&gt;&nbsp;A:BC&nbsp;+&nbsp;B:CD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3553986">//&nbsp;A:BC&nbsp;+&nbsp;B:DC&nbsp;=&gt;&nbsp;A:DC&nbsp;+&nbsp;B:DC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554017">for</span>&nbsp;<span class="ident" id="3554021">pc</span>&nbsp;<span class="op" id="3554024">:=</span>&nbsp;<span class="keyword" id="3554027">range</span>&nbsp;<span class="ident" id="3554033"><a href="/gostd/regexp/onepass.go.html#3553611">p</a></span><span class="op" id="3554034">.</span><span class="ident" id="3554035"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span>&nbsp;<span class="op" id="3554040">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554044">switch</span>&nbsp;<span class="ident" id="3554051"><a href="/gostd/regexp/onepass.go.html#3553611">p</a></span><span class="op" id="3554052">.</span><span class="ident" id="3554053"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3554057">[</span><span class="ident" id="3554058"><a href="/gostd/regexp/onepass.go.html#3554021">pc</a></span><span class="op" id="3554060">]</span><span class="op" id="3554061">.</span><span class="ident" id="3554062"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3554065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554069">default</span><span class="op" id="3554076">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554081">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554092">case</span>&nbsp;<span class="ident" id="3554097"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3554103">.</span><span class="ident" id="3554104"><a href="/gostd/regexp/syntax/prog.go.html#3659200">InstAlt</a></span><span class="op" id="3554111">,</span>&nbsp;<span class="ident" id="3554113"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3554119">.</span><span class="ident" id="3554120"><a href="/gostd/regexp/syntax/prog.go.html#3659223">InstAltMatch</a></span><span class="op" id="3554132">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3554137">//&nbsp;A:Bx&nbsp;+&nbsp;B:Ay</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554155">p_A_Other</span>&nbsp;<span class="op" id="3554165">:=</span>&nbsp;<span class="op" id="3554168">&amp;</span><span class="ident" id="3554169"><a href="/gostd/regexp/onepass.go.html#3553611">p</a></span><span class="op" id="3554170">.</span><span class="ident" id="3554171"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3554175">[</span><span class="ident" id="3554176"><a href="/gostd/regexp/onepass.go.html#3554021">pc</a></span><span class="op" id="3554178">]</span><span class="op" id="3554179">.</span><span class="ident" id="3554180"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554187">p_A_Alt</span>&nbsp;<span class="op" id="3554195">:=</span>&nbsp;<span class="op" id="3554198">&amp;</span><span class="ident" id="3554199"><a href="/gostd/regexp/onepass.go.html#3553611">p</a></span><span class="op" id="3554200">.</span><span class="ident" id="3554201"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3554205">[</span><span class="ident" id="3554206"><a href="/gostd/regexp/onepass.go.html#3554021">pc</a></span><span class="op" id="3554208">]</span><span class="op" id="3554209">.</span><span class="ident" id="3554210"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3554217">//&nbsp;make&nbsp;sure&nbsp;a&nbsp;target&nbsp;is&nbsp;another&nbsp;Alt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554257">instAlt</span>&nbsp;<span class="op" id="3554265">:=</span>&nbsp;<span class="ident" id="3554268"><a href="/gostd/regexp/onepass.go.html#3553611">p</a></span><span class="op" id="3554269">.</span><span class="ident" id="3554270"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3554274">[</span><span class="op" id="3554275">*</span><span class="ident" id="3554276"><a href="/gostd/regexp/onepass.go.html#3554187">p_A_Alt</a></span><span class="op" id="3554283">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554288">if</span>&nbsp;<span class="op" id="3554291">!</span><span class="op" id="3554292">(</span><span class="ident" id="3554293"><a href="/gostd/regexp/onepass.go.html#3554257">instAlt</a></span><span class="op" id="3554300">.</span><span class="ident" id="3554301"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3554304">==</span>&nbsp;<span class="ident" id="3554307"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3554313">.</span><span class="ident" id="3554314"><a href="/gostd/regexp/syntax/prog.go.html#3659200">InstAlt</a></span>&nbsp;<span class="op" id="3554322">||</span>&nbsp;<span class="ident" id="3554325"><a href="/gostd/regexp/onepass.go.html#3554257">instAlt</a></span><span class="op" id="3554332">.</span><span class="ident" id="3554333"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3554336">==</span>&nbsp;<span class="ident" id="3554339"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3554345">.</span><span class="ident" id="3554346"><a href="/gostd/regexp/syntax/prog.go.html#3659223">InstAltMatch</a></span><span class="op" id="3554358">)</span>&nbsp;<span class="op" id="3554360">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554366"><a href="/gostd/regexp/onepass.go.html#3554187">p_A_Alt</a></span><span class="op" id="3554373">,</span>&nbsp;<span class="ident" id="3554375"><a href="/gostd/regexp/onepass.go.html#3554155">p_A_Other</a></span>&nbsp;<span class="op" id="3554385">=</span>&nbsp;<span class="ident" id="3554387"><a href="/gostd/regexp/onepass.go.html#3554155">p_A_Other</a></span><span class="op" id="3554396">,</span>&nbsp;<span class="ident" id="3554398"><a href="/gostd/regexp/onepass.go.html#3554187">p_A_Alt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554410"><a href="/gostd/regexp/onepass.go.html#3554257">instAlt</a></span>&nbsp;<span class="op" id="3554418">=</span>&nbsp;<span class="ident" id="3554420"><a href="/gostd/regexp/onepass.go.html#3553611">p</a></span><span class="op" id="3554421">.</span><span class="ident" id="3554422"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3554426">[</span><span class="op" id="3554427">*</span><span class="ident" id="3554428"><a href="/gostd/regexp/onepass.go.html#3554187">p_A_Alt</a></span><span class="op" id="3554435">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554441">if</span>&nbsp;<span class="op" id="3554444">!</span><span class="op" id="3554445">(</span><span class="ident" id="3554446"><a href="/gostd/regexp/onepass.go.html#3554257">instAlt</a></span><span class="op" id="3554453">.</span><span class="ident" id="3554454"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3554457">==</span>&nbsp;<span class="ident" id="3554460"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3554466">.</span><span class="ident" id="3554467"><a href="/gostd/regexp/syntax/prog.go.html#3659200">InstAlt</a></span>&nbsp;<span class="op" id="3554475">||</span>&nbsp;<span class="ident" id="3554478"><a href="/gostd/regexp/onepass.go.html#3554257">instAlt</a></span><span class="op" id="3554485">.</span><span class="ident" id="3554486"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3554489">==</span>&nbsp;<span class="ident" id="3554492"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3554498">.</span><span class="ident" id="3554499"><a href="/gostd/regexp/syntax/prog.go.html#3659223">InstAltMatch</a></span><span class="op" id="3554511">)</span>&nbsp;<span class="op" id="3554513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554520">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3554533">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3554538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554543">instOther</span>&nbsp;<span class="op" id="3554553">:=</span>&nbsp;<span class="ident" id="3554556"><a href="/gostd/regexp/onepass.go.html#3553611">p</a></span><span class="op" id="3554557">.</span><span class="ident" id="3554558"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3554562">[</span><span class="op" id="3554563">*</span><span class="ident" id="3554564"><a href="/gostd/regexp/onepass.go.html#3554155">p_A_Other</a></span><span class="op" id="3554573">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3554578">//&nbsp;Analyzing&nbsp;both&nbsp;legs&nbsp;pointing&nbsp;to&nbsp;Alts&nbsp;is&nbsp;for&nbsp;another&nbsp;day</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554640">if</span>&nbsp;<span class="ident" id="3554643"><a href="/gostd/regexp/onepass.go.html#3554543">instOther</a></span><span class="op" id="3554652">.</span><span class="ident" id="3554653"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3554656">==</span>&nbsp;<span class="ident" id="3554659"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3554665">.</span><span class="ident" id="3554666"><a href="/gostd/regexp/syntax/prog.go.html#3659200">InstAlt</a></span>&nbsp;<span class="op" id="3554674">||</span>&nbsp;<span class="ident" id="3554677"><a href="/gostd/regexp/onepass.go.html#3554543">instOther</a></span><span class="op" id="3554686">.</span><span class="ident" id="3554687"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3554690">==</span>&nbsp;<span class="ident" id="3554693"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3554699">.</span><span class="ident" id="3554700"><a href="/gostd/regexp/syntax/prog.go.html#3659223">InstAltMatch</a></span>&nbsp;<span class="op" id="3554713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3554719">//&nbsp;too&nbsp;complicated</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554742">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3554754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3554759">//&nbsp;simple&nbsp;empty&nbsp;transition&nbsp;loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3554794">//&nbsp;A:BC&nbsp;+&nbsp;B:DA&nbsp;=&gt;&nbsp;A:BC&nbsp;+&nbsp;B:DC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554827">p_B_Alt</span>&nbsp;<span class="op" id="3554835">:=</span>&nbsp;<span class="op" id="3554838">&amp;</span><span class="ident" id="3554839"><a href="/gostd/regexp/onepass.go.html#3553611">p</a></span><span class="op" id="3554840">.</span><span class="ident" id="3554841"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3554845">[</span><span class="op" id="3554846">*</span><span class="ident" id="3554847"><a href="/gostd/regexp/onepass.go.html#3554187">p_A_Alt</a></span><span class="op" id="3554854">]</span><span class="op" id="3554855">.</span><span class="ident" id="3554856"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554863">p_B_Other</span>&nbsp;<span class="op" id="3554873">:=</span>&nbsp;<span class="op" id="3554876">&amp;</span><span class="ident" id="3554877"><a href="/gostd/regexp/onepass.go.html#3553611">p</a></span><span class="op" id="3554878">.</span><span class="ident" id="3554879"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3554883">[</span><span class="op" id="3554884">*</span><span class="ident" id="3554885"><a href="/gostd/regexp/onepass.go.html#3554187">p_A_Alt</a></span><span class="op" id="3554892">]</span><span class="op" id="3554893">.</span><span class="ident" id="3554894"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554901">patch</span>&nbsp;<span class="op" id="3554907">:=</span>&nbsp;<span class="builtintype" id="3554910">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554919">if</span>&nbsp;<span class="ident" id="3554922"><a href="/gostd/regexp/onepass.go.html#3554257">instAlt</a></span><span class="op" id="3554929">.</span><span class="ident" id="3554930"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span>&nbsp;<span class="op" id="3554934">==</span>&nbsp;<span class="builtintype" id="3554937">uint32</span><span class="op" id="3554943">(</span><span class="ident" id="3554944"><a href="/gostd/regexp/onepass.go.html#3554021">pc</a></span><span class="op" id="3554946">)</span>&nbsp;<span class="op" id="3554948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554954"><a href="/gostd/regexp/onepass.go.html#3554901">patch</a></span>&nbsp;<span class="op" id="3554960">=</span>&nbsp;<span class="builtintype" id="3554962">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3554970">}</span>&nbsp;<span class="keyword" id="3554972">else</span>&nbsp;<span class="keyword" id="3554977">if</span>&nbsp;<span class="ident" id="3554980"><a href="/gostd/regexp/onepass.go.html#3554257">instAlt</a></span><span class="op" id="3554987">.</span><span class="ident" id="3554988"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span>&nbsp;<span class="op" id="3554992">==</span>&nbsp;<span class="builtintype" id="3554995">uint32</span><span class="op" id="3555001">(</span><span class="ident" id="3555002"><a href="/gostd/regexp/onepass.go.html#3554021">pc</a></span><span class="op" id="3555004">)</span>&nbsp;<span class="op" id="3555006">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3555012"><a href="/gostd/regexp/onepass.go.html#3554901">patch</a></span>&nbsp;<span class="op" id="3555018">=</span>&nbsp;<span class="builtintype" id="3555020">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3555029"><a href="/gostd/regexp/onepass.go.html#3554827">p_B_Alt</a></span><span class="op" id="3555036">,</span>&nbsp;<span class="ident" id="3555038"><a href="/gostd/regexp/onepass.go.html#3554863">p_B_Other</a></span>&nbsp;<span class="op" id="3555048">=</span>&nbsp;<span class="ident" id="3555050"><a href="/gostd/regexp/onepass.go.html#3554863">p_B_Other</a></span><span class="op" id="3555059">,</span>&nbsp;<span class="ident" id="3555061"><a href="/gostd/regexp/onepass.go.html#3554827">p_B_Alt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3555072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3555077">if</span>&nbsp;<span class="ident" id="3555080"><a href="/gostd/regexp/onepass.go.html#3554901">patch</a></span>&nbsp;<span class="op" id="3555086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3555092">*</span><span class="ident" id="3555093"><a href="/gostd/regexp/onepass.go.html#3554827">p_B_Alt</a></span>&nbsp;<span class="op" id="3555101">=</span>&nbsp;<span class="op" id="3555103">*</span><span class="ident" id="3555104"><a href="/gostd/regexp/onepass.go.html#3554155">p_A_Other</a></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3555117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3555123">//&nbsp;empty&nbsp;transition&nbsp;to&nbsp;common&nbsp;target</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3555163">//&nbsp;A:BC&nbsp;+&nbsp;B:DC&nbsp;=&gt;&nbsp;A:DC&nbsp;+&nbsp;B:DC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3555196">if</span>&nbsp;<span class="op" id="3555199">*</span><span class="ident" id="3555200"><a href="/gostd/regexp/onepass.go.html#3554155">p_A_Other</a></span>&nbsp;<span class="op" id="3555210">==</span>&nbsp;<span class="op" id="3555213">*</span><span class="ident" id="3555214"><a href="/gostd/regexp/onepass.go.html#3554827">p_B_Alt</a></span>&nbsp;<span class="op" id="3555222">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3555228">*</span><span class="ident" id="3555229"><a href="/gostd/regexp/onepass.go.html#3554187">p_A_Alt</a></span>&nbsp;<span class="op" id="3555237">=</span>&nbsp;<span class="op" id="3555239">*</span><span class="ident" id="3555240"><a href="/gostd/regexp/onepass.go.html#3554863">p_B_Other</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3555253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3555257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3555260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3555263">return</span>&nbsp;<span class="ident" id="3555270"><a href="/gostd/regexp/onepass.go.html#3553611">p</a></span><br>
<span class="lineno">280</span><span class="op" id="3555272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3555275">//&nbsp;runeSlice&nbsp;exists&nbsp;to&nbsp;permit&nbsp;sorting&nbsp;the&nbsp;case-folded&nbsp;rune&nbsp;sets.</span><br>
<span class="lineno"></span><span class="keyword" id="3555340">type</span>&nbsp;<span class="ident" id="3555345">runeSlice</span>&nbsp;<span class="op" id="3555355">[</span><span class="op" id="3555356">]</span><span class="builtintype" id="3555357">rune</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="3555363">func</span>&nbsp;<span class="op" id="3555368">(</span><span class="ident" id="3555369">p</span>&nbsp;<span class="ident" id="3555371"><a href="/gostd/regexp/onepass.go.html#3555345">runeSlice</a></span><span class="op" id="3555380">)</span>&nbsp;<span class="ident" id="3555382">Len</span><span class="op" id="3555385">(</span><span class="op" id="3555386">)</span>&nbsp;<span class="builtintype" id="3555388">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3555402">{</span>&nbsp;<span class="keyword" id="3555404">return</span>&nbsp;<span class="builtinfunc" id="3555411">len</span><span class="op" id="3555414">(</span><span class="ident" id="3555415"><a href="/gostd/regexp/onepass.go.html#3555369">p</a></span><span class="op" id="3555416">)</span>&nbsp;<span class="op" id="3555418">}</span><br>
<span class="lineno"></span><span class="keyword" id="3555420">func</span>&nbsp;<span class="op" id="3555425">(</span><span class="ident" id="3555426">p</span>&nbsp;<span class="ident" id="3555428"><a href="/gostd/regexp/onepass.go.html#3555345">runeSlice</a></span><span class="op" id="3555437">)</span>&nbsp;<span class="ident" id="3555439">Less</span><span class="op" id="3555443">(</span><span class="ident" id="3555444">i</span><span class="op" id="3555445">,</span>&nbsp;<span class="ident" id="3555447">j</span>&nbsp;<span class="builtintype" id="3555449">int</span><span class="op" id="3555452">)</span>&nbsp;<span class="builtintype" id="3555454">bool</span>&nbsp;<span class="op" id="3555459">{</span>&nbsp;<span class="keyword" id="3555461">return</span>&nbsp;<span class="ident" id="3555468"><a href="/gostd/regexp/onepass.go.html#3555426">p</a></span><span class="op" id="3555469">[</span><span class="ident" id="3555470"><a href="/gostd/regexp/onepass.go.html#3555444">i</a></span><span class="op" id="3555471">]</span>&nbsp;<span class="op" id="3555473">&lt;</span>&nbsp;<span class="ident" id="3555475"><a href="/gostd/regexp/onepass.go.html#3555426">p</a></span><span class="op" id="3555476">[</span><span class="ident" id="3555477"><a href="/gostd/regexp/onepass.go.html#3555447">j</a></span><span class="op" id="3555478">]</span>&nbsp;<span class="op" id="3555480">}</span><br>
<span class="lineno"></span><span class="keyword" id="3555482">func</span>&nbsp;<span class="op" id="3555487">(</span><span class="ident" id="3555488">p</span>&nbsp;<span class="ident" id="3555490"><a href="/gostd/regexp/onepass.go.html#3555345">runeSlice</a></span><span class="op" id="3555499">)</span>&nbsp;<span class="ident" id="3555501">Swap</span><span class="op" id="3555505">(</span><span class="ident" id="3555506">i</span><span class="op" id="3555507">,</span>&nbsp;<span class="ident" id="3555509">j</span>&nbsp;<span class="builtintype" id="3555511">int</span><span class="op" id="3555514">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3555521">{</span>&nbsp;<span class="ident" id="3555523"><a href="/gostd/regexp/onepass.go.html#3555488">p</a></span><span class="op" id="3555524">[</span><span class="ident" id="3555525"><a href="/gostd/regexp/onepass.go.html#3555506">i</a></span><span class="op" id="3555526">]</span><span class="op" id="3555527">,</span>&nbsp;<span class="ident" id="3555529"><a href="/gostd/regexp/onepass.go.html#3555488">p</a></span><span class="op" id="3555530">[</span><span class="ident" id="3555531"><a href="/gostd/regexp/onepass.go.html#3555509">j</a></span><span class="op" id="3555532">]</span>&nbsp;<span class="op" id="3555534">=</span>&nbsp;<span class="ident" id="3555536"><a href="/gostd/regexp/onepass.go.html#3555488">p</a></span><span class="op" id="3555537">[</span><span class="ident" id="3555538"><a href="/gostd/regexp/onepass.go.html#3555509">j</a></span><span class="op" id="3555539">]</span><span class="op" id="3555540">,</span>&nbsp;<span class="ident" id="3555542"><a href="/gostd/regexp/onepass.go.html#3555488">p</a></span><span class="op" id="3555543">[</span><span class="ident" id="3555544"><a href="/gostd/regexp/onepass.go.html#3555506">i</a></span><span class="op" id="3555545">]</span>&nbsp;<span class="op" id="3555547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3555550">//&nbsp;Sort&nbsp;is&nbsp;a&nbsp;convenience&nbsp;method.</span><br>
<span class="lineno">290</span><span class="keyword" id="3555583">func</span>&nbsp;<span class="op" id="3555588">(</span><span class="ident" id="3555589">p</span>&nbsp;<span class="ident" id="3555591"><a href="/gostd/regexp/onepass.go.html#3555345">runeSlice</a></span><span class="op" id="3555600">)</span>&nbsp;<span class="ident" id="3555602">Sort</span><span class="op" id="3555606">(</span><span class="op" id="3555607">)</span>&nbsp;<span class="op" id="3555609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3555612"><a href="/gostd/regexp/onepass.go.html#3547748">sort</a></span><span class="op" id="3555616">.</span><span class="ident" id="3555617"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="3555621">(</span><span class="ident" id="3555622"><a href="/gostd/regexp/onepass.go.html#3555589">p</a></span><span class="op" id="3555623">)</span><br>
<span class="lineno"></span><span class="op" id="3555625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3555628">var</span>&nbsp;<span class="ident" id="3555632">anyRuneNotNL</span>&nbsp;<span class="op" id="3555645">=</span>&nbsp;<span class="op" id="3555647">[</span><span class="op" id="3555648">]</span><span class="builtintype" id="3555649">rune</span><span class="op" id="3555653">{</span><span class="num" id="3555654">0</span><span class="op" id="3555655">,</span>&nbsp;<span class="string" id="3555657">&#39;\n&#39;</span>&nbsp;<span class="op" id="3555662">-</span>&nbsp;<span class="num" id="3555664">1</span><span class="op" id="3555665">,</span>&nbsp;<span class="string" id="3555667">&#39;\n&#39;</span>&nbsp;<span class="op" id="3555672">+</span>&nbsp;<span class="num" id="3555674">1</span><span class="op" id="3555675">,</span>&nbsp;<span class="ident" id="3555677"><a href="/gostd/regexp/onepass.go.html#3547756">unicode</a></span><span class="op" id="3555684">.</span><span class="ident" id="3555685"><a href="/gostd/unicode/letter.go.html#1821536">MaxRune</a></span><span class="op" id="3555692">}</span><br>
<span class="lineno">295</span><span class="keyword" id="3555694">var</span>&nbsp;<span class="ident" id="3555698">anyRune</span>&nbsp;<span class="op" id="3555706">=</span>&nbsp;<span class="op" id="3555708">[</span><span class="op" id="3555709">]</span><span class="builtintype" id="3555710">rune</span><span class="op" id="3555714">{</span><span class="num" id="3555715">0</span><span class="op" id="3555716">,</span>&nbsp;<span class="ident" id="3555718"><a href="/gostd/regexp/onepass.go.html#3547756">unicode</a></span><span class="op" id="3555725">.</span><span class="ident" id="3555726"><a href="/gostd/unicode/letter.go.html#1821536">MaxRune</a></span><span class="op" id="3555733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3555736">//&nbsp;makeOnePass&nbsp;creates&nbsp;a&nbsp;onepass&nbsp;Prog,&nbsp;if&nbsp;possible.&nbsp;It&nbsp;is&nbsp;possible&nbsp;if&nbsp;at&nbsp;any&nbsp;alt,</span><br>
<span class="lineno"></span><span class="comment" id="3555818">//&nbsp;the&nbsp;match&nbsp;engine&nbsp;can&nbsp;always&nbsp;tell&nbsp;which&nbsp;branch&nbsp;to&nbsp;take.&nbsp;The&nbsp;routine&nbsp;may&nbsp;modify</span><br>
<span class="lineno"></span><span class="comment" id="3555899">//&nbsp;p&nbsp;if&nbsp;it&nbsp;is&nbsp;turned&nbsp;into&nbsp;a&nbsp;onepass&nbsp;Prog.&nbsp;If&nbsp;it&nbsp;isn&#39;t&nbsp;possible&nbsp;for&nbsp;this&nbsp;to&nbsp;be&nbsp;a</span><br>
<span class="lineno">300</span><span class="comment" id="3555979">//&nbsp;onepass&nbsp;Prog,&nbsp;the&nbsp;Prog&nbsp;notOnePass&nbsp;is&nbsp;returned.&nbsp;makeOnePass&nbsp;is&nbsp;recursive</span><br>
<span class="lineno"></span><span class="comment" id="3556054">//&nbsp;to&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;Prog.</span><br>
<span class="lineno"></span><span class="keyword" id="3556082">func</span>&nbsp;<span class="ident" id="3556087">makeOnePass</span><span class="op" id="3556098">(</span><span class="ident" id="3556099">p</span>&nbsp;<span class="op" id="3556101">*</span><span class="ident" id="3556102"><a href="/gostd/regexp/onepass.go.html#3548182">onePassProg</a></span><span class="op" id="3556113">)</span>&nbsp;<span class="op" id="3556115">*</span><span class="ident" id="3556116"><a href="/gostd/regexp/onepass.go.html#3548182">onePassProg</a></span>&nbsp;<span class="op" id="3556128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3556131">//&nbsp;If&nbsp;the&nbsp;machine&nbsp;is&nbsp;very&nbsp;long,&nbsp;it&#39;s&nbsp;not&nbsp;worth&nbsp;the&nbsp;time&nbsp;to&nbsp;check&nbsp;if&nbsp;we&nbsp;can&nbsp;use&nbsp;one&nbsp;pass.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556221">if</span>&nbsp;<span class="builtinfunc" id="3556224">len</span><span class="op" id="3556227">(</span><span class="ident" id="3556228"><a href="/gostd/regexp/onepass.go.html#3556099">p</a></span><span class="op" id="3556229">.</span><span class="ident" id="3556230"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3556234">)</span>&nbsp;<span class="op" id="3556236">&gt;=</span>&nbsp;<span class="num" id="3556239">1000</span>&nbsp;<span class="op" id="3556244">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556248">return</span>&nbsp;<span class="ident" id="3556255"><a href="/gostd/regexp/onepass.go.html#3562168">notOnePass</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556271">var</span>&nbsp;<span class="op" id="3556275">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556279">instQueue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556292">=</span>&nbsp;<span class="ident" id="3556294"><a href="/gostd/regexp/onepass.go.html#3551206">newQueue</a></span><span class="op" id="3556302">(</span><span class="builtinfunc" id="3556303">len</span><span class="op" id="3556306">(</span><span class="ident" id="3556307"><a href="/gostd/regexp/onepass.go.html#3556099">p</a></span><span class="op" id="3556308">.</span><span class="ident" id="3556309"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3556313">)</span><span class="op" id="3556314">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556318">visitQueue</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3556331">=</span>&nbsp;<span class="ident" id="3556333"><a href="/gostd/regexp/onepass.go.html#3551206">newQueue</a></span><span class="op" id="3556341">(</span><span class="builtinfunc" id="3556342">len</span><span class="op" id="3556345">(</span><span class="ident" id="3556346"><a href="/gostd/regexp/onepass.go.html#3556099">p</a></span><span class="op" id="3556347">.</span><span class="ident" id="3556348"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3556352">)</span><span class="op" id="3556353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556357">build</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556370">func</span><span class="op" id="3556374">(</span><span class="builtintype" id="3556375">uint32</span><span class="op" id="3556381">,</span>&nbsp;<span class="op" id="3556383">*</span><span class="ident" id="3556384"><a href="/gostd/regexp/onepass.go.html#3550423">queueOnePass</a></span><span class="op" id="3556396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556400">check</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556413">func</span><span class="op" id="3556417">(</span><span class="builtintype" id="3556418">uint32</span><span class="op" id="3556424">,</span>&nbsp;<span class="keyword" id="3556426">map</span><span class="op" id="3556429">[</span><span class="builtintype" id="3556430">uint32</span><span class="op" id="3556436">]</span><span class="builtintype" id="3556437">bool</span><span class="op" id="3556441">)</span>&nbsp;<span class="builtintype" id="3556443">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556450">onePassRunes</span>&nbsp;<span class="op" id="3556463">=</span>&nbsp;<span class="builtinfunc" id="3556465">make</span><span class="op" id="3556469">(</span><span class="op" id="3556470">[</span><span class="op" id="3556471">]</span><span class="op" id="3556472">[</span><span class="op" id="3556473">]</span><span class="builtintype" id="3556474">rune</span><span class="op" id="3556478">,</span>&nbsp;<span class="builtinfunc" id="3556480">len</span><span class="op" id="3556483">(</span><span class="ident" id="3556484"><a href="/gostd/regexp/onepass.go.html#3556099">p</a></span><span class="op" id="3556485">.</span><span class="ident" id="3556486"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3556490">)</span><span class="op" id="3556491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556494">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556497"><a href="/gostd/regexp/onepass.go.html#3556357">build</a></span>&nbsp;<span class="op" id="3556503">=</span>&nbsp;<span class="keyword" id="3556505">func</span><span class="op" id="3556509">(</span><span class="ident" id="3556510">pc</span>&nbsp;<span class="builtintype" id="3556513">uint32</span><span class="op" id="3556519">,</span>&nbsp;<span class="ident" id="3556521">q</span>&nbsp;<span class="op" id="3556523">*</span><span class="ident" id="3556524"><a href="/gostd/regexp/onepass.go.html#3550423">queueOnePass</a></span><span class="op" id="3556536">)</span>&nbsp;<span class="op" id="3556538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556542">if</span>&nbsp;<span class="ident" id="3556545"><a href="/gostd/regexp/onepass.go.html#3556521">q</a></span><span class="op" id="3556546">.</span><span class="ident" id="3556547"><a href="/gostd/regexp/onepass.go.html#3550831">contains</a></span><span class="op" id="3556555">(</span><span class="ident" id="3556556"><a href="/gostd/regexp/onepass.go.html#3556510">pc</a></span><span class="op" id="3556558">)</span>&nbsp;<span class="op" id="3556560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556565">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556578">inst</span>&nbsp;<span class="op" id="3556583">:=</span>&nbsp;<span class="ident" id="3556586"><a href="/gostd/regexp/onepass.go.html#3556099">p</a></span><span class="op" id="3556587">.</span><span class="ident" id="3556588"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3556592">[</span><span class="ident" id="3556593"><a href="/gostd/regexp/onepass.go.html#3556510">pc</a></span><span class="op" id="3556595">]</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556599">switch</span>&nbsp;<span class="ident" id="3556606"><a href="/gostd/regexp/onepass.go.html#3556578">inst</a></span><span class="op" id="3556610">.</span><span class="ident" id="3556611"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3556614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556618">case</span>&nbsp;<span class="ident" id="3556623"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3556629">.</span><span class="ident" id="3556630"><a href="/gostd/regexp/syntax/prog.go.html#3659200">InstAlt</a></span><span class="op" id="3556637">,</span>&nbsp;<span class="ident" id="3556639"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3556645">.</span><span class="ident" id="3556646"><a href="/gostd/regexp/syntax/prog.go.html#3659223">InstAltMatch</a></span><span class="op" id="3556658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556663"><a href="/gostd/regexp/onepass.go.html#3556521">q</a></span><span class="op" id="3556664">.</span><span class="ident" id="3556665"><a href="/gostd/regexp/onepass.go.html#3550992">insert</a></span><span class="op" id="3556671">(</span><span class="ident" id="3556672"><a href="/gostd/regexp/onepass.go.html#3556578">inst</a></span><span class="op" id="3556676">.</span><span class="ident" id="3556677"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3556680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556685"><a href="/gostd/regexp/onepass.go.html#3556357">build</a></span><span class="op" id="3556690">(</span><span class="ident" id="3556691"><a href="/gostd/regexp/onepass.go.html#3556578">inst</a></span><span class="op" id="3556695">.</span><span class="ident" id="3556696"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3556699">,</span>&nbsp;<span class="ident" id="3556701"><a href="/gostd/regexp/onepass.go.html#3556521">q</a></span><span class="op" id="3556702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556707"><a href="/gostd/regexp/onepass.go.html#3556521">q</a></span><span class="op" id="3556708">.</span><span class="ident" id="3556709"><a href="/gostd/regexp/onepass.go.html#3550992">insert</a></span><span class="op" id="3556715">(</span><span class="ident" id="3556716"><a href="/gostd/regexp/onepass.go.html#3556578">inst</a></span><span class="op" id="3556720">.</span><span class="ident" id="3556721"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3556724">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556728">case</span>&nbsp;<span class="ident" id="3556733"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3556739">.</span><span class="ident" id="3556740"><a href="/gostd/regexp/syntax/prog.go.html#3659266">InstMatch</a></span><span class="op" id="3556749">,</span>&nbsp;<span class="ident" id="3556751"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3556757">.</span><span class="ident" id="3556758"><a href="/gostd/regexp/syntax/prog.go.html#3659277">InstFail</a></span><span class="op" id="3556766">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556770">default</span><span class="op" id="3556777">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556782"><a href="/gostd/regexp/onepass.go.html#3556521">q</a></span><span class="op" id="3556783">.</span><span class="ident" id="3556784"><a href="/gostd/regexp/onepass.go.html#3550992">insert</a></span><span class="op" id="3556790">(</span><span class="ident" id="3556791"><a href="/gostd/regexp/onepass.go.html#3556578">inst</a></span><span class="op" id="3556795">.</span><span class="ident" id="3556796"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3556799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556806">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3556810">//&nbsp;check&nbsp;that&nbsp;paths&nbsp;from&nbsp;Alt&nbsp;instructions&nbsp;are&nbsp;unambiguous,&nbsp;and&nbsp;rebuild&nbsp;the&nbsp;new</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3556890">//&nbsp;program&nbsp;as&nbsp;a&nbsp;onepass&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556923"><a href="/gostd/regexp/onepass.go.html#3556400">check</a></span>&nbsp;<span class="op" id="3556929">=</span>&nbsp;<span class="keyword" id="3556931">func</span><span class="op" id="3556935">(</span><span class="ident" id="3556936">pc</span>&nbsp;<span class="builtintype" id="3556939">uint32</span><span class="op" id="3556945">,</span>&nbsp;<span class="ident" id="3556947">m</span>&nbsp;<span class="keyword" id="3556949">map</span><span class="op" id="3556952">[</span><span class="builtintype" id="3556953">uint32</span><span class="op" id="3556959">]</span><span class="builtintype" id="3556960">bool</span><span class="op" id="3556964">)</span>&nbsp;<span class="op" id="3556966">(</span><span class="ident" id="3556967">ok</span>&nbsp;<span class="builtintype" id="3556970">bool</span><span class="op" id="3556974">)</span>&nbsp;<span class="op" id="3556976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556980"><a href="/gostd/regexp/onepass.go.html#3556967">ok</a></span>&nbsp;<span class="op" id="3556983">=</span>&nbsp;<span class="builtintype" id="3556985">true</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556992">inst</span>&nbsp;<span class="op" id="3556997">:=</span>&nbsp;<span class="op" id="3557000">&amp;</span><span class="ident" id="3557001"><a href="/gostd/regexp/onepass.go.html#3556099">p</a></span><span class="op" id="3557002">.</span><span class="ident" id="3557003"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3557007">[</span><span class="ident" id="3557008"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3557010">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3557014">if</span>&nbsp;<span class="ident" id="3557017"><a href="/gostd/regexp/onepass.go.html#3556318">visitQueue</a></span><span class="op" id="3557027">.</span><span class="ident" id="3557028"><a href="/gostd/regexp/onepass.go.html#3550831">contains</a></span><span class="op" id="3557036">(</span><span class="ident" id="3557037"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3557039">)</span>&nbsp;<span class="op" id="3557041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3557046">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3557055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557059"><a href="/gostd/regexp/onepass.go.html#3556318">visitQueue</a></span><span class="op" id="3557069">.</span><span class="ident" id="3557070"><a href="/gostd/regexp/onepass.go.html#3550992">insert</a></span><span class="op" id="3557076">(</span><span class="ident" id="3557077"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3557079">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3557083">switch</span>&nbsp;<span class="ident" id="3557090"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557094">.</span><span class="ident" id="3557095"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3557098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3557102">case</span>&nbsp;<span class="ident" id="3557107"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3557113">.</span><span class="ident" id="3557114"><a href="/gostd/regexp/syntax/prog.go.html#3659200">InstAlt</a></span><span class="op" id="3557121">,</span>&nbsp;<span class="ident" id="3557123"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3557129">.</span><span class="ident" id="3557130"><a href="/gostd/regexp/syntax/prog.go.html#3659223">InstAltMatch</a></span><span class="op" id="3557142">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557147"><a href="/gostd/regexp/onepass.go.html#3556967">ok</a></span>&nbsp;<span class="op" id="3557150">=</span>&nbsp;<span class="ident" id="3557152"><a href="/gostd/regexp/onepass.go.html#3556400">check</a></span><span class="op" id="3557157">(</span><span class="ident" id="3557158"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557162">.</span><span class="ident" id="3557163"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3557166">,</span>&nbsp;<span class="ident" id="3557168"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3557169">)</span>&nbsp;<span class="op" id="3557171">&amp;&amp;</span>&nbsp;<span class="ident" id="3557174"><a href="/gostd/regexp/onepass.go.html#3556400">check</a></span><span class="op" id="3557179">(</span><span class="ident" id="3557180"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557184">.</span><span class="ident" id="3557185"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3557188">,</span>&nbsp;<span class="ident" id="3557190"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3557191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3557196">//&nbsp;check&nbsp;no-input&nbsp;paths&nbsp;to&nbsp;InstMatch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557236">matchOut</span>&nbsp;<span class="op" id="3557245">:=</span>&nbsp;<span class="ident" id="3557248"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3557249">[</span><span class="ident" id="3557250"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557254">.</span><span class="ident" id="3557255"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3557258">]</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557263">matchArg</span>&nbsp;<span class="op" id="3557272">:=</span>&nbsp;<span class="ident" id="3557275"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3557276">[</span><span class="ident" id="3557277"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557281">.</span><span class="ident" id="3557282"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3557285">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3557290">if</span>&nbsp;<span class="ident" id="3557293"><a href="/gostd/regexp/onepass.go.html#3557236">matchOut</a></span>&nbsp;<span class="op" id="3557302">&amp;&amp;</span>&nbsp;<span class="ident" id="3557305"><a href="/gostd/regexp/onepass.go.html#3557263">matchArg</a></span>&nbsp;<span class="op" id="3557314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557320"><a href="/gostd/regexp/onepass.go.html#3556967">ok</a></span>&nbsp;<span class="op" id="3557323">=</span>&nbsp;<span class="builtintype" id="3557325">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3557335">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3557344">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3557349">//&nbsp;Match&nbsp;on&nbsp;empty&nbsp;goes&nbsp;in&nbsp;inst.Out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3557387">if</span>&nbsp;<span class="ident" id="3557390"><a href="/gostd/regexp/onepass.go.html#3557263">matchArg</a></span>&nbsp;<span class="op" id="3557399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557405"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557409">.</span><span class="ident" id="3557410"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3557413">,</span>&nbsp;<span class="ident" id="3557415"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557419">.</span><span class="ident" id="3557420"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span>&nbsp;<span class="op" id="3557424">=</span>&nbsp;<span class="ident" id="3557426"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557430">.</span><span class="ident" id="3557431"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3557434">,</span>&nbsp;<span class="ident" id="3557436"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557440">.</span><span class="ident" id="3557441"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557449"><a href="/gostd/regexp/onepass.go.html#3557236">matchOut</a></span><span class="op" id="3557457">,</span>&nbsp;<span class="ident" id="3557459"><a href="/gostd/regexp/onepass.go.html#3557263">matchArg</a></span>&nbsp;<span class="op" id="3557468">=</span>&nbsp;<span class="ident" id="3557470"><a href="/gostd/regexp/onepass.go.html#3557263">matchArg</a></span><span class="op" id="3557478">,</span>&nbsp;<span class="ident" id="3557480"><a href="/gostd/regexp/onepass.go.html#3557236">matchOut</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3557492">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3557497">if</span>&nbsp;<span class="ident" id="3557500"><a href="/gostd/regexp/onepass.go.html#3557236">matchOut</a></span>&nbsp;<span class="op" id="3557509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557515"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3557516">[</span><span class="ident" id="3557517"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3557519">]</span>&nbsp;<span class="op" id="3557521">=</span>&nbsp;<span class="builtintype" id="3557523">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557532"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557536">.</span><span class="ident" id="3557537"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3557540">=</span>&nbsp;<span class="ident" id="3557542"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3557548">.</span><span class="ident" id="3557549"><a href="/gostd/regexp/syntax/prog.go.html#3659223">InstAltMatch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3557565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3557571">//&nbsp;build&nbsp;a&nbsp;dispatch&nbsp;operator&nbsp;from&nbsp;the&nbsp;two&nbsp;legs&nbsp;of&nbsp;the&nbsp;alt.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557633"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3557645">[</span><span class="ident" id="3557646"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3557648">]</span><span class="op" id="3557649">,</span>&nbsp;<span class="ident" id="3557651"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557655">.</span><span class="ident" id="3557656"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3557661">=</span>&nbsp;<span class="ident" id="3557663"><a href="/gostd/regexp/onepass.go.html#3551849">mergeRuneSets</a></span><span class="op" id="3557676">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3557682">&amp;</span><span class="ident" id="3557683"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3557695">[</span><span class="ident" id="3557696"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557700">.</span><span class="ident" id="3557701"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3557704">]</span><span class="op" id="3557705">,</span>&nbsp;<span class="op" id="3557707">&amp;</span><span class="ident" id="3557708"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3557720">[</span><span class="ident" id="3557721"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557725">.</span><span class="ident" id="3557726"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3557729">]</span><span class="op" id="3557730">,</span>&nbsp;<span class="ident" id="3557732"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557736">.</span><span class="ident" id="3557737"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3557740">,</span>&nbsp;<span class="ident" id="3557742"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557746">.</span><span class="ident" id="3557747"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3557750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3557755">if</span>&nbsp;<span class="builtinfunc" id="3557758">len</span><span class="op" id="3557761">(</span><span class="ident" id="3557762"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557766">.</span><span class="ident" id="3557767"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span><span class="op" id="3557771">)</span>&nbsp;<span class="op" id="3557773">&gt;</span>&nbsp;<span class="num" id="3557775">0</span>&nbsp;<span class="op" id="3557777">&amp;&amp;</span>&nbsp;<span class="ident" id="3557780"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557784">.</span><span class="ident" id="3557785"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span><span class="op" id="3557789">[</span><span class="num" id="3557790">0</span><span class="op" id="3557791">]</span>&nbsp;<span class="op" id="3557793">==</span>&nbsp;<span class="ident" id="3557796"><a href="/gostd/regexp/onepass.go.html#3551750">mergeFailed</a></span>&nbsp;<span class="op" id="3557808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557814"><a href="/gostd/regexp/onepass.go.html#3556967">ok</a></span>&nbsp;<span class="op" id="3557817">=</span>&nbsp;<span class="builtintype" id="3557819">false</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3557829">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3557838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3557842">case</span>&nbsp;<span class="ident" id="3557847"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3557853">.</span><span class="ident" id="3557854"><a href="/gostd/regexp/syntax/prog.go.html#3659237">InstCapture</a></span><span class="op" id="3557865">,</span>&nbsp;<span class="ident" id="3557867"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3557873">.</span><span class="ident" id="3557874"><a href="/gostd/regexp/syntax/prog.go.html#3659287">InstNop</a></span><span class="op" id="3557881">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557886"><a href="/gostd/regexp/onepass.go.html#3556967">ok</a></span>&nbsp;<span class="op" id="3557889">=</span>&nbsp;<span class="ident" id="3557891"><a href="/gostd/regexp/onepass.go.html#3556400">check</a></span><span class="op" id="3557896">(</span><span class="ident" id="3557897"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557901">.</span><span class="ident" id="3557902"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3557905">,</span>&nbsp;<span class="ident" id="3557907"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3557908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557913"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3557914">[</span><span class="ident" id="3557915"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3557917">]</span>&nbsp;<span class="op" id="3557919">=</span>&nbsp;<span class="ident" id="3557921"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3557922">[</span><span class="ident" id="3557923"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3557927">.</span><span class="ident" id="3557928"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3557931">]</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3557936">//&nbsp;pass&nbsp;matching&nbsp;runes&nbsp;back&nbsp;through&nbsp;these&nbsp;no-ops.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557989"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3558001">[</span><span class="ident" id="3558002"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3558004">]</span>&nbsp;<span class="op" id="3558006">=</span>&nbsp;<span class="builtinfunc" id="3558008">append</span><span class="op" id="3558014">(</span><span class="op" id="3558015">[</span><span class="op" id="3558016">]</span><span class="builtintype" id="3558017">rune</span><span class="op" id="3558021">{</span><span class="op" id="3558022">}</span><span class="op" id="3558023">,</span>&nbsp;<span class="ident" id="3558025"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3558037">[</span><span class="ident" id="3558038"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558042">.</span><span class="ident" id="3558043"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3558046">]</span><span class="op" id="3558047">...</span><span class="op" id="3558050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558055"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558059">.</span><span class="ident" id="3558060"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3558065">=</span>&nbsp;<span class="op" id="3558067">[</span><span class="op" id="3558068">]</span><span class="builtintype" id="3558069">uint32</span><span class="op" id="3558075">{</span><span class="op" id="3558076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558081">for</span>&nbsp;<span class="ident" id="3558085">i</span>&nbsp;<span class="op" id="3558087">:=</span>&nbsp;<span class="builtinfunc" id="3558090">len</span><span class="op" id="3558093">(</span><span class="ident" id="3558094"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3558106">[</span><span class="ident" id="3558107"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3558109">]</span><span class="op" id="3558110">)</span>&nbsp;<span class="op" id="3558112">/</span>&nbsp;<span class="num" id="3558114">2</span><span class="op" id="3558115">;</span>&nbsp;<span class="ident" id="3558117"><a href="/gostd/regexp/onepass.go.html#3558085">i</a></span>&nbsp;<span class="op" id="3558119">&gt;=</span>&nbsp;<span class="num" id="3558122">0</span><span class="op" id="3558123">;</span>&nbsp;<span class="ident" id="3558125"><a href="/gostd/regexp/onepass.go.html#3558085">i</a></span><span class="op" id="3558126">--</span>&nbsp;<span class="op" id="3558129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558135"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558139">.</span><span class="ident" id="3558140"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3558145">=</span>&nbsp;<span class="builtinfunc" id="3558147">append</span><span class="op" id="3558153">(</span><span class="ident" id="3558154"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558158">.</span><span class="ident" id="3558159"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span><span class="op" id="3558163">,</span>&nbsp;<span class="ident" id="3558165"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558169">.</span><span class="ident" id="3558170"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3558173">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3558178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558182">case</span>&nbsp;<span class="ident" id="3558187"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3558193">.</span><span class="ident" id="3558194"><a href="/gostd/regexp/syntax/prog.go.html#3659250">InstEmptyWidth</a></span><span class="op" id="3558208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558213"><a href="/gostd/regexp/onepass.go.html#3556967">ok</a></span>&nbsp;<span class="op" id="3558216">=</span>&nbsp;<span class="ident" id="3558218"><a href="/gostd/regexp/onepass.go.html#3556400">check</a></span><span class="op" id="3558223">(</span><span class="ident" id="3558224"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558228">.</span><span class="ident" id="3558229"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3558232">,</span>&nbsp;<span class="ident" id="3558234"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3558235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558240"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3558241">[</span><span class="ident" id="3558242"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3558244">]</span>&nbsp;<span class="op" id="3558246">=</span>&nbsp;<span class="ident" id="3558248"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3558249">[</span><span class="ident" id="3558250"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558254">.</span><span class="ident" id="3558255"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3558258">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558263"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3558275">[</span><span class="ident" id="3558276"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3558278">]</span>&nbsp;<span class="op" id="3558280">=</span>&nbsp;<span class="builtinfunc" id="3558282">append</span><span class="op" id="3558288">(</span><span class="op" id="3558289">[</span><span class="op" id="3558290">]</span><span class="builtintype" id="3558291">rune</span><span class="op" id="3558295">{</span><span class="op" id="3558296">}</span><span class="op" id="3558297">,</span>&nbsp;<span class="ident" id="3558299"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3558311">[</span><span class="ident" id="3558312"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558316">.</span><span class="ident" id="3558317"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3558320">]</span><span class="op" id="3558321">...</span><span class="op" id="3558324">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558329"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558333">.</span><span class="ident" id="3558334"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3558339">=</span>&nbsp;<span class="op" id="3558341">[</span><span class="op" id="3558342">]</span><span class="builtintype" id="3558343">uint32</span><span class="op" id="3558349">{</span><span class="op" id="3558350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558355">for</span>&nbsp;<span class="ident" id="3558359">i</span>&nbsp;<span class="op" id="3558361">:=</span>&nbsp;<span class="builtinfunc" id="3558364">len</span><span class="op" id="3558367">(</span><span class="ident" id="3558368"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3558380">[</span><span class="ident" id="3558381"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3558383">]</span><span class="op" id="3558384">)</span>&nbsp;<span class="op" id="3558386">/</span>&nbsp;<span class="num" id="3558388">2</span><span class="op" id="3558389">;</span>&nbsp;<span class="ident" id="3558391"><a href="/gostd/regexp/onepass.go.html#3558359">i</a></span>&nbsp;<span class="op" id="3558393">&gt;=</span>&nbsp;<span class="num" id="3558396">0</span><span class="op" id="3558397">;</span>&nbsp;<span class="ident" id="3558399"><a href="/gostd/regexp/onepass.go.html#3558359">i</a></span><span class="op" id="3558400">--</span>&nbsp;<span class="op" id="3558403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558409"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558413">.</span><span class="ident" id="3558414"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3558419">=</span>&nbsp;<span class="builtinfunc" id="3558421">append</span><span class="op" id="3558427">(</span><span class="ident" id="3558428"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558432">.</span><span class="ident" id="3558433"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span><span class="op" id="3558437">,</span>&nbsp;<span class="ident" id="3558439"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558443">.</span><span class="ident" id="3558444"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3558447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3558452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558456">case</span>&nbsp;<span class="ident" id="3558461"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3558467">.</span><span class="ident" id="3558468"><a href="/gostd/regexp/syntax/prog.go.html#3659266">InstMatch</a></span><span class="op" id="3558477">,</span>&nbsp;<span class="ident" id="3558479"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3558485">.</span><span class="ident" id="3558486"><a href="/gostd/regexp/syntax/prog.go.html#3659277">InstFail</a></span><span class="op" id="3558494">:</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558499"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3558500">[</span><span class="ident" id="3558501"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3558503">]</span>&nbsp;<span class="op" id="3558505">=</span>&nbsp;<span class="ident" id="3558507"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558511">.</span><span class="ident" id="3558512"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3558515">==</span>&nbsp;<span class="ident" id="3558518"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3558524">.</span><span class="ident" id="3558525"><a href="/gostd/regexp/syntax/prog.go.html#3659266">InstMatch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558538">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558546">case</span>&nbsp;<span class="ident" id="3558551"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3558557">.</span><span class="ident" id="3558558"><a href="/gostd/regexp/syntax/prog.go.html#3659296">InstRune</a></span><span class="op" id="3558566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558571"><a href="/gostd/regexp/onepass.go.html#3556967">ok</a></span>&nbsp;<span class="op" id="3558574">=</span>&nbsp;<span class="ident" id="3558576"><a href="/gostd/regexp/onepass.go.html#3556400">check</a></span><span class="op" id="3558581">(</span><span class="ident" id="3558582"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558586">.</span><span class="ident" id="3558587"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3558590">,</span>&nbsp;<span class="ident" id="3558592"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3558593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558598"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3558599">[</span><span class="ident" id="3558600"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3558602">]</span>&nbsp;<span class="op" id="3558604">=</span>&nbsp;<span class="builtintype" id="3558606">false</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558615">if</span>&nbsp;<span class="builtinfunc" id="3558618">len</span><span class="op" id="3558621">(</span><span class="ident" id="3558622"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558626">.</span><span class="ident" id="3558627"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span><span class="op" id="3558631">)</span>&nbsp;<span class="op" id="3558633">&gt;</span>&nbsp;<span class="num" id="3558635">0</span>&nbsp;<span class="op" id="3558637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558643">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3558652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558657">if</span>&nbsp;<span class="builtinfunc" id="3558660">len</span><span class="op" id="3558663">(</span><span class="ident" id="3558664"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558668">.</span><span class="ident" id="3558669"><a href="/gostd/regexp/syntax/prog.go.html#3661201">Rune</a></span><span class="op" id="3558673">)</span>&nbsp;<span class="op" id="3558675">==</span>&nbsp;<span class="num" id="3558678">0</span>&nbsp;<span class="op" id="3558680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558686"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3558698">[</span><span class="ident" id="3558699"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3558701">]</span>&nbsp;<span class="op" id="3558703">=</span>&nbsp;<span class="op" id="3558705">[</span><span class="op" id="3558706">]</span><span class="builtintype" id="3558707">rune</span><span class="op" id="3558711">{</span><span class="op" id="3558712">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558718"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558722">.</span><span class="ident" id="3558723"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3558728">=</span>&nbsp;<span class="op" id="3558730">[</span><span class="op" id="3558731">]</span><span class="builtintype" id="3558732">uint32</span><span class="op" id="3558738">{</span><span class="ident" id="3558739"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558743">.</span><span class="ident" id="3558744"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3558747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558753">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3558762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558767">runes</span>&nbsp;<span class="op" id="3558773">:=</span>&nbsp;<span class="builtinfunc" id="3558776">make</span><span class="op" id="3558780">(</span><span class="op" id="3558781">[</span><span class="op" id="3558782">]</span><span class="builtintype" id="3558783">rune</span><span class="op" id="3558787">,</span>&nbsp;<span class="num" id="3558789">0</span><span class="op" id="3558790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558795">if</span>&nbsp;<span class="builtinfunc" id="3558798">len</span><span class="op" id="3558801">(</span><span class="ident" id="3558802"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558806">.</span><span class="ident" id="3558807"><a href="/gostd/regexp/syntax/prog.go.html#3661201">Rune</a></span><span class="op" id="3558811">)</span>&nbsp;<span class="op" id="3558813">==</span>&nbsp;<span class="num" id="3558816">1</span>&nbsp;<span class="op" id="3558818">&amp;&amp;</span>&nbsp;<span class="ident" id="3558821"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3558827">.</span><span class="ident" id="3558828"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span><span class="op" id="3558833">(</span><span class="ident" id="3558834"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558838">.</span><span class="ident" id="3558839"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3558842">)</span><span class="op" id="3558843">&amp;</span><span class="ident" id="3558844"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3558850">.</span><span class="ident" id="3558851"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span>&nbsp;<span class="op" id="3558860">!=</span>&nbsp;<span class="num" id="3558863">0</span>&nbsp;<span class="op" id="3558865">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558871">r0</span>&nbsp;<span class="op" id="3558874">:=</span>&nbsp;<span class="ident" id="3558877"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3558881">.</span><span class="ident" id="3558882"><a href="/gostd/regexp/syntax/prog.go.html#3661201">Rune</a></span><span class="op" id="3558886">[</span><span class="num" id="3558887">0</span><span class="op" id="3558888">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558894"><a href="/gostd/regexp/onepass.go.html#3558767">runes</a></span>&nbsp;<span class="op" id="3558900">=</span>&nbsp;<span class="builtinfunc" id="3558902">append</span><span class="op" id="3558908">(</span><span class="ident" id="3558909"><a href="/gostd/regexp/onepass.go.html#3558767">runes</a></span><span class="op" id="3558914">,</span>&nbsp;<span class="ident" id="3558916"><a href="/gostd/regexp/onepass.go.html#3558871">r0</a></span><span class="op" id="3558918">,</span>&nbsp;<span class="ident" id="3558920"><a href="/gostd/regexp/onepass.go.html#3558871">r0</a></span><span class="op" id="3558922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558928">for</span>&nbsp;<span class="ident" id="3558932">r1</span>&nbsp;<span class="op" id="3558935">:=</span>&nbsp;<span class="ident" id="3558938"><a href="/gostd/regexp/onepass.go.html#3547756">unicode</a></span><span class="op" id="3558945">.</span><span class="ident" id="3558946"><a href="/gostd/unicode/letter.go.html#1830259">SimpleFold</a></span><span class="op" id="3558956">(</span><span class="ident" id="3558957"><a href="/gostd/regexp/onepass.go.html#3558871">r0</a></span><span class="op" id="3558959">)</span><span class="op" id="3558960">;</span>&nbsp;<span class="ident" id="3558962"><a href="/gostd/regexp/onepass.go.html#3558932">r1</a></span>&nbsp;<span class="op" id="3558965">!=</span>&nbsp;<span class="ident" id="3558968"><a href="/gostd/regexp/onepass.go.html#3558871">r0</a></span><span class="op" id="3558970">;</span>&nbsp;<span class="ident" id="3558972"><a href="/gostd/regexp/onepass.go.html#3558932">r1</a></span>&nbsp;<span class="op" id="3558975">=</span>&nbsp;<span class="ident" id="3558977"><a href="/gostd/regexp/onepass.go.html#3547756">unicode</a></span><span class="op" id="3558984">.</span><span class="ident" id="3558985"><a href="/gostd/unicode/letter.go.html#1830259">SimpleFold</a></span><span class="op" id="3558995">(</span><span class="ident" id="3558996"><a href="/gostd/regexp/onepass.go.html#3558932">r1</a></span><span class="op" id="3558998">)</span>&nbsp;<span class="op" id="3559000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559007"><a href="/gostd/regexp/onepass.go.html#3558767">runes</a></span>&nbsp;<span class="op" id="3559013">=</span>&nbsp;<span class="builtinfunc" id="3559015">append</span><span class="op" id="3559021">(</span><span class="ident" id="3559022"><a href="/gostd/regexp/onepass.go.html#3558767">runes</a></span><span class="op" id="3559027">,</span>&nbsp;<span class="ident" id="3559029"><a href="/gostd/regexp/onepass.go.html#3558932">r1</a></span><span class="op" id="3559031">,</span>&nbsp;<span class="ident" id="3559033"><a href="/gostd/regexp/onepass.go.html#3558932">r1</a></span><span class="op" id="3559035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3559041">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559047"><a href="/gostd/regexp/onepass.go.html#3547748">sort</a></span><span class="op" id="3559051">.</span><span class="ident" id="3559052"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="3559056">(</span><span class="ident" id="3559057"><a href="/gostd/regexp/onepass.go.html#3555345">runeSlice</a></span><span class="op" id="3559066">(</span><span class="ident" id="3559067"><a href="/gostd/regexp/onepass.go.html#3558767">runes</a></span><span class="op" id="3559072">)</span><span class="op" id="3559073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3559078">}</span>&nbsp;<span class="keyword" id="3559080">else</span>&nbsp;<span class="op" id="3559085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559091"><a href="/gostd/regexp/onepass.go.html#3558767">runes</a></span>&nbsp;<span class="op" id="3559097">=</span>&nbsp;<span class="builtinfunc" id="3559099">append</span><span class="op" id="3559105">(</span><span class="ident" id="3559106"><a href="/gostd/regexp/onepass.go.html#3558767">runes</a></span><span class="op" id="3559111">,</span>&nbsp;<span class="ident" id="3559113"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559117">.</span><span class="ident" id="3559118"><a href="/gostd/regexp/syntax/prog.go.html#3661201">Rune</a></span><span class="op" id="3559122">...</span><span class="op" id="3559125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3559130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559135"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3559147">[</span><span class="ident" id="3559148"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3559150">]</span>&nbsp;<span class="op" id="3559152">=</span>&nbsp;<span class="ident" id="3559154"><a href="/gostd/regexp/onepass.go.html#3558767">runes</a></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559163"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559167">.</span><span class="ident" id="3559168"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3559173">=</span>&nbsp;<span class="op" id="3559175">[</span><span class="op" id="3559176">]</span><span class="builtintype" id="3559177">uint32</span><span class="op" id="3559183">{</span><span class="op" id="3559184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559189">for</span>&nbsp;<span class="ident" id="3559193">i</span>&nbsp;<span class="op" id="3559195">:=</span>&nbsp;<span class="builtinfunc" id="3559198">len</span><span class="op" id="3559201">(</span><span class="ident" id="3559202"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3559214">[</span><span class="ident" id="3559215"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3559217">]</span><span class="op" id="3559218">)</span>&nbsp;<span class="op" id="3559220">/</span>&nbsp;<span class="num" id="3559222">2</span><span class="op" id="3559223">;</span>&nbsp;<span class="ident" id="3559225"><a href="/gostd/regexp/onepass.go.html#3559193">i</a></span>&nbsp;<span class="op" id="3559227">&gt;=</span>&nbsp;<span class="num" id="3559230">0</span><span class="op" id="3559231">;</span>&nbsp;<span class="ident" id="3559233"><a href="/gostd/regexp/onepass.go.html#3559193">i</a></span><span class="op" id="3559234">--</span>&nbsp;<span class="op" id="3559237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559243"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559247">.</span><span class="ident" id="3559248"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3559253">=</span>&nbsp;<span class="builtinfunc" id="3559255">append</span><span class="op" id="3559261">(</span><span class="ident" id="3559262"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559266">.</span><span class="ident" id="3559267"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span><span class="op" id="3559271">,</span>&nbsp;<span class="ident" id="3559273"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559277">.</span><span class="ident" id="3559278"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3559281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3559286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559291"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559295">.</span><span class="ident" id="3559296"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3559299">=</span>&nbsp;<span class="ident" id="3559301"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3559307">.</span><span class="ident" id="3559308"><a href="/gostd/regexp/syntax/prog.go.html#3659296">InstRune</a></span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559319">case</span>&nbsp;<span class="ident" id="3559324"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3559330">.</span><span class="ident" id="3559331"><a href="/gostd/regexp/syntax/prog.go.html#3659306">InstRune1</a></span><span class="op" id="3559340">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559345"><a href="/gostd/regexp/onepass.go.html#3556967">ok</a></span>&nbsp;<span class="op" id="3559348">=</span>&nbsp;<span class="ident" id="3559350"><a href="/gostd/regexp/onepass.go.html#3556400">check</a></span><span class="op" id="3559355">(</span><span class="ident" id="3559356"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559360">.</span><span class="ident" id="3559361"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3559364">,</span>&nbsp;<span class="ident" id="3559366"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3559367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559372"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3559373">[</span><span class="ident" id="3559374"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3559376">]</span>&nbsp;<span class="op" id="3559378">=</span>&nbsp;<span class="builtintype" id="3559380">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559389">if</span>&nbsp;<span class="builtinfunc" id="3559392">len</span><span class="op" id="3559395">(</span><span class="ident" id="3559396"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559400">.</span><span class="ident" id="3559401"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span><span class="op" id="3559405">)</span>&nbsp;<span class="op" id="3559407">&gt;</span>&nbsp;<span class="num" id="3559409">0</span>&nbsp;<span class="op" id="3559411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559417">break</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3559426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559431">runes</span>&nbsp;<span class="op" id="3559437">:=</span>&nbsp;<span class="op" id="3559440">[</span><span class="op" id="3559441">]</span><span class="builtintype" id="3559442">rune</span><span class="op" id="3559446">{</span><span class="op" id="3559447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3559452">//&nbsp;expand&nbsp;case-folded&nbsp;runes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559483">if</span>&nbsp;<span class="ident" id="3559486"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3559492">.</span><span class="ident" id="3559493"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span><span class="op" id="3559498">(</span><span class="ident" id="3559499"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559503">.</span><span class="ident" id="3559504"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3559507">)</span><span class="op" id="3559508">&amp;</span><span class="ident" id="3559509"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3559515">.</span><span class="ident" id="3559516"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span>&nbsp;<span class="op" id="3559525">!=</span>&nbsp;<span class="num" id="3559528">0</span>&nbsp;<span class="op" id="3559530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559536">r0</span>&nbsp;<span class="op" id="3559539">:=</span>&nbsp;<span class="ident" id="3559542"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559546">.</span><span class="ident" id="3559547"><a href="/gostd/regexp/syntax/prog.go.html#3661201">Rune</a></span><span class="op" id="3559551">[</span><span class="num" id="3559552">0</span><span class="op" id="3559553">]</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559559"><a href="/gostd/regexp/onepass.go.html#3559431">runes</a></span>&nbsp;<span class="op" id="3559565">=</span>&nbsp;<span class="builtinfunc" id="3559567">append</span><span class="op" id="3559573">(</span><span class="ident" id="3559574"><a href="/gostd/regexp/onepass.go.html#3559431">runes</a></span><span class="op" id="3559579">,</span>&nbsp;<span class="ident" id="3559581"><a href="/gostd/regexp/onepass.go.html#3559536">r0</a></span><span class="op" id="3559583">,</span>&nbsp;<span class="ident" id="3559585"><a href="/gostd/regexp/onepass.go.html#3559536">r0</a></span><span class="op" id="3559587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559593">for</span>&nbsp;<span class="ident" id="3559597">r1</span>&nbsp;<span class="op" id="3559600">:=</span>&nbsp;<span class="ident" id="3559603"><a href="/gostd/regexp/onepass.go.html#3547756">unicode</a></span><span class="op" id="3559610">.</span><span class="ident" id="3559611"><a href="/gostd/unicode/letter.go.html#1830259">SimpleFold</a></span><span class="op" id="3559621">(</span><span class="ident" id="3559622"><a href="/gostd/regexp/onepass.go.html#3559536">r0</a></span><span class="op" id="3559624">)</span><span class="op" id="3559625">;</span>&nbsp;<span class="ident" id="3559627"><a href="/gostd/regexp/onepass.go.html#3559597">r1</a></span>&nbsp;<span class="op" id="3559630">!=</span>&nbsp;<span class="ident" id="3559633"><a href="/gostd/regexp/onepass.go.html#3559536">r0</a></span><span class="op" id="3559635">;</span>&nbsp;<span class="ident" id="3559637"><a href="/gostd/regexp/onepass.go.html#3559597">r1</a></span>&nbsp;<span class="op" id="3559640">=</span>&nbsp;<span class="ident" id="3559642"><a href="/gostd/regexp/onepass.go.html#3547756">unicode</a></span><span class="op" id="3559649">.</span><span class="ident" id="3559650"><a href="/gostd/unicode/letter.go.html#1830259">SimpleFold</a></span><span class="op" id="3559660">(</span><span class="ident" id="3559661"><a href="/gostd/regexp/onepass.go.html#3559597">r1</a></span><span class="op" id="3559663">)</span>&nbsp;<span class="op" id="3559665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559672"><a href="/gostd/regexp/onepass.go.html#3559431">runes</a></span>&nbsp;<span class="op" id="3559678">=</span>&nbsp;<span class="builtinfunc" id="3559680">append</span><span class="op" id="3559686">(</span><span class="ident" id="3559687"><a href="/gostd/regexp/onepass.go.html#3559431">runes</a></span><span class="op" id="3559692">,</span>&nbsp;<span class="ident" id="3559694"><a href="/gostd/regexp/onepass.go.html#3559597">r1</a></span><span class="op" id="3559696">,</span>&nbsp;<span class="ident" id="3559698"><a href="/gostd/regexp/onepass.go.html#3559597">r1</a></span><span class="op" id="3559700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3559706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559712"><a href="/gostd/regexp/onepass.go.html#3547748">sort</a></span><span class="op" id="3559716">.</span><span class="ident" id="3559717"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="3559721">(</span><span class="ident" id="3559722"><a href="/gostd/regexp/onepass.go.html#3555345">runeSlice</a></span><span class="op" id="3559731">(</span><span class="ident" id="3559732"><a href="/gostd/regexp/onepass.go.html#3559431">runes</a></span><span class="op" id="3559737">)</span><span class="op" id="3559738">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3559743">}</span>&nbsp;<span class="keyword" id="3559745">else</span>&nbsp;<span class="op" id="3559750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559756"><a href="/gostd/regexp/onepass.go.html#3559431">runes</a></span>&nbsp;<span class="op" id="3559762">=</span>&nbsp;<span class="builtinfunc" id="3559764">append</span><span class="op" id="3559770">(</span><span class="ident" id="3559771"><a href="/gostd/regexp/onepass.go.html#3559431">runes</a></span><span class="op" id="3559776">,</span>&nbsp;<span class="ident" id="3559778"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559782">.</span><span class="ident" id="3559783"><a href="/gostd/regexp/syntax/prog.go.html#3661201">Rune</a></span><span class="op" id="3559787">[</span><span class="num" id="3559788">0</span><span class="op" id="3559789">]</span><span class="op" id="3559790">,</span>&nbsp;<span class="ident" id="3559792"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559796">.</span><span class="ident" id="3559797"><a href="/gostd/regexp/syntax/prog.go.html#3661201">Rune</a></span><span class="op" id="3559801">[</span><span class="num" id="3559802">0</span><span class="op" id="3559803">]</span><span class="op" id="3559804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3559809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559814"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3559826">[</span><span class="ident" id="3559827"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3559829">]</span>&nbsp;<span class="op" id="3559831">=</span>&nbsp;<span class="ident" id="3559833"><a href="/gostd/regexp/onepass.go.html#3559431">runes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559842"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559846">.</span><span class="ident" id="3559847"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3559852">=</span>&nbsp;<span class="op" id="3559854">[</span><span class="op" id="3559855">]</span><span class="builtintype" id="3559856">uint32</span><span class="op" id="3559862">{</span><span class="op" id="3559863">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559868">for</span>&nbsp;<span class="ident" id="3559872">i</span>&nbsp;<span class="op" id="3559874">:=</span>&nbsp;<span class="builtinfunc" id="3559877">len</span><span class="op" id="3559880">(</span><span class="ident" id="3559881"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3559893">[</span><span class="ident" id="3559894"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3559896">]</span><span class="op" id="3559897">)</span>&nbsp;<span class="op" id="3559899">/</span>&nbsp;<span class="num" id="3559901">2</span><span class="op" id="3559902">;</span>&nbsp;<span class="ident" id="3559904"><a href="/gostd/regexp/onepass.go.html#3559872">i</a></span>&nbsp;<span class="op" id="3559906">&gt;=</span>&nbsp;<span class="num" id="3559909">0</span><span class="op" id="3559910">;</span>&nbsp;<span class="ident" id="3559912"><a href="/gostd/regexp/onepass.go.html#3559872">i</a></span><span class="op" id="3559913">--</span>&nbsp;<span class="op" id="3559916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559922"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559926">.</span><span class="ident" id="3559927"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3559932">=</span>&nbsp;<span class="builtinfunc" id="3559934">append</span><span class="op" id="3559940">(</span><span class="ident" id="3559941"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559945">.</span><span class="ident" id="3559946"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span><span class="op" id="3559950">,</span>&nbsp;<span class="ident" id="3559952"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559956">.</span><span class="ident" id="3559957"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3559960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3559965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559970"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3559974">.</span><span class="ident" id="3559975"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3559978">=</span>&nbsp;<span class="ident" id="3559980"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3559986">.</span><span class="ident" id="3559987"><a href="/gostd/regexp/syntax/prog.go.html#3659296">InstRune</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559998">case</span>&nbsp;<span class="ident" id="3560003"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3560009">.</span><span class="ident" id="3560010"><a href="/gostd/regexp/syntax/prog.go.html#3659317">InstRuneAny</a></span><span class="op" id="3560021">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560026"><a href="/gostd/regexp/onepass.go.html#3556967">ok</a></span>&nbsp;<span class="op" id="3560029">=</span>&nbsp;<span class="ident" id="3560031"><a href="/gostd/regexp/onepass.go.html#3556400">check</a></span><span class="op" id="3560036">(</span><span class="ident" id="3560037"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3560041">.</span><span class="ident" id="3560042"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3560045">,</span>&nbsp;<span class="ident" id="3560047"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3560048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560053"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3560054">[</span><span class="ident" id="3560055"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3560057">]</span>&nbsp;<span class="op" id="3560059">=</span>&nbsp;<span class="builtintype" id="3560061">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560070">if</span>&nbsp;<span class="builtinfunc" id="3560073">len</span><span class="op" id="3560076">(</span><span class="ident" id="3560077"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3560081">.</span><span class="ident" id="3560082"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span><span class="op" id="3560086">)</span>&nbsp;<span class="op" id="3560088">&gt;</span>&nbsp;<span class="num" id="3560090">0</span>&nbsp;<span class="op" id="3560092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560098">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3560107">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560112"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3560124">[</span><span class="ident" id="3560125"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3560127">]</span>&nbsp;<span class="op" id="3560129">=</span>&nbsp;<span class="builtinfunc" id="3560131">append</span><span class="op" id="3560137">(</span><span class="op" id="3560138">[</span><span class="op" id="3560139">]</span><span class="builtintype" id="3560140">rune</span><span class="op" id="3560144">{</span><span class="op" id="3560145">}</span><span class="op" id="3560146">,</span>&nbsp;<span class="ident" id="3560148"><a href="/gostd/regexp/onepass.go.html#3555698">anyRune</a></span><span class="op" id="3560155">...</span><span class="op" id="3560158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560163"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3560167">.</span><span class="ident" id="3560168"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3560173">=</span>&nbsp;<span class="op" id="3560175">[</span><span class="op" id="3560176">]</span><span class="builtintype" id="3560177">uint32</span><span class="op" id="3560183">{</span><span class="ident" id="3560184"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3560188">.</span><span class="ident" id="3560189"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3560192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560196">case</span>&nbsp;<span class="ident" id="3560201"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3560207">.</span><span class="ident" id="3560208"><a href="/gostd/regexp/syntax/prog.go.html#3659330">InstRuneAnyNotNL</a></span><span class="op" id="3560224">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560229"><a href="/gostd/regexp/onepass.go.html#3556967">ok</a></span>&nbsp;<span class="op" id="3560232">=</span>&nbsp;<span class="ident" id="3560234"><a href="/gostd/regexp/onepass.go.html#3556400">check</a></span><span class="op" id="3560239">(</span><span class="ident" id="3560240"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3560244">.</span><span class="ident" id="3560245"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3560248">,</span>&nbsp;<span class="ident" id="3560250"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3560251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560256"><a href="/gostd/regexp/onepass.go.html#3556947">m</a></span><span class="op" id="3560257">[</span><span class="ident" id="3560258"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3560260">]</span>&nbsp;<span class="op" id="3560262">=</span>&nbsp;<span class="builtintype" id="3560264">false</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560273">if</span>&nbsp;<span class="builtinfunc" id="3560276">len</span><span class="op" id="3560279">(</span><span class="ident" id="3560280"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3560284">.</span><span class="ident" id="3560285"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span><span class="op" id="3560289">)</span>&nbsp;<span class="op" id="3560291">&gt;</span>&nbsp;<span class="num" id="3560293">0</span>&nbsp;<span class="op" id="3560295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560301">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3560310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560315"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3560327">[</span><span class="ident" id="3560328"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3560330">]</span>&nbsp;<span class="op" id="3560332">=</span>&nbsp;<span class="builtinfunc" id="3560334">append</span><span class="op" id="3560340">(</span><span class="op" id="3560341">[</span><span class="op" id="3560342">]</span><span class="builtintype" id="3560343">rune</span><span class="op" id="3560347">{</span><span class="op" id="3560348">}</span><span class="op" id="3560349">,</span>&nbsp;<span class="ident" id="3560351"><a href="/gostd/regexp/onepass.go.html#3555632">anyRuneNotNL</a></span><span class="op" id="3560363">...</span><span class="op" id="3560366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560371"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3560375">.</span><span class="ident" id="3560376"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3560381">=</span>&nbsp;<span class="op" id="3560383">[</span><span class="op" id="3560384">]</span><span class="builtintype" id="3560385">uint32</span><span class="op" id="3560391">{</span><span class="op" id="3560392">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560397">for</span>&nbsp;<span class="ident" id="3560401">i</span>&nbsp;<span class="op" id="3560403">:=</span>&nbsp;<span class="builtinfunc" id="3560406">len</span><span class="op" id="3560409">(</span><span class="ident" id="3560410"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3560422">[</span><span class="ident" id="3560423"><a href="/gostd/regexp/onepass.go.html#3556936">pc</a></span><span class="op" id="3560425">]</span><span class="op" id="3560426">)</span>&nbsp;<span class="op" id="3560428">/</span>&nbsp;<span class="num" id="3560430">2</span><span class="op" id="3560431">;</span>&nbsp;<span class="ident" id="3560433"><a href="/gostd/regexp/onepass.go.html#3560401">i</a></span>&nbsp;<span class="op" id="3560435">&gt;=</span>&nbsp;<span class="num" id="3560438">0</span><span class="op" id="3560439">;</span>&nbsp;<span class="ident" id="3560441"><a href="/gostd/regexp/onepass.go.html#3560401">i</a></span><span class="op" id="3560442">--</span>&nbsp;<span class="op" id="3560445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560451"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3560455">.</span><span class="ident" id="3560456"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span>&nbsp;<span class="op" id="3560461">=</span>&nbsp;<span class="builtinfunc" id="3560463">append</span><span class="op" id="3560469">(</span><span class="ident" id="3560470"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3560474">.</span><span class="ident" id="3560475"><a href="/gostd/regexp/onepass.go.html#3548508">Next</a></span><span class="op" id="3560479">,</span>&nbsp;<span class="ident" id="3560481"><a href="/gostd/regexp/onepass.go.html#3556992">inst</a></span><span class="op" id="3560485">.</span><span class="ident" id="3560486"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3560489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3560494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3560498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560502">return</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3560510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560514"><a href="/gostd/regexp/onepass.go.html#3556279">instQueue</a></span><span class="op" id="3560523">.</span><span class="ident" id="3560524"><a href="/gostd/regexp/onepass.go.html#3550713">clear</a></span><span class="op" id="3560529">(</span><span class="op" id="3560530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560533"><a href="/gostd/regexp/onepass.go.html#3556279">instQueue</a></span><span class="op" id="3560542">.</span><span class="ident" id="3560543"><a href="/gostd/regexp/onepass.go.html#3550992">insert</a></span><span class="op" id="3560549">(</span><span class="builtintype" id="3560550">uint32</span><span class="op" id="3560556">(</span><span class="ident" id="3560557"><a href="/gostd/regexp/onepass.go.html#3556099">p</a></span><span class="op" id="3560558">.</span><span class="ident" id="3560559"><a href="/gostd/regexp/onepass.go.html#3548226">Start</a></span><span class="op" id="3560564">)</span><span class="op" id="3560565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560568">m</span>&nbsp;<span class="op" id="3560570">:=</span>&nbsp;<span class="builtinfunc" id="3560573">make</span><span class="op" id="3560577">(</span><span class="keyword" id="3560578">map</span><span class="op" id="3560581">[</span><span class="builtintype" id="3560582">uint32</span><span class="op" id="3560588">]</span><span class="builtintype" id="3560589">bool</span><span class="op" id="3560593">,</span>&nbsp;<span class="builtinfunc" id="3560595">len</span><span class="op" id="3560598">(</span><span class="ident" id="3560599"><a href="/gostd/regexp/onepass.go.html#3556099">p</a></span><span class="op" id="3560600">.</span><span class="ident" id="3560601"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3560605">)</span><span class="op" id="3560606">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560609">for</span>&nbsp;<span class="op" id="3560613">!</span><span class="ident" id="3560614"><a href="/gostd/regexp/onepass.go.html#3556279">instQueue</a></span><span class="op" id="3560623">.</span><span class="ident" id="3560624"><a href="/gostd/regexp/onepass.go.html#3550547">empty</a></span><span class="op" id="3560629">(</span><span class="op" id="3560630">)</span>&nbsp;<span class="op" id="3560632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560636">pc</span>&nbsp;<span class="op" id="3560639">:=</span>&nbsp;<span class="ident" id="3560642"><a href="/gostd/regexp/onepass.go.html#3556279">instQueue</a></span><span class="op" id="3560651">.</span><span class="ident" id="3560652"><a href="/gostd/regexp/onepass.go.html#3550618">next</a></span><span class="op" id="3560656">(</span><span class="op" id="3560657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560661">inst</span>&nbsp;<span class="op" id="3560666">:=</span>&nbsp;<span class="ident" id="3560669"><a href="/gostd/regexp/onepass.go.html#3556099">p</a></span><span class="op" id="3560670">.</span><span class="ident" id="3560671"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3560675">[</span><span class="ident" id="3560676"><a href="/gostd/regexp/onepass.go.html#3560636">pc</a></span><span class="op" id="3560678">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560682"><a href="/gostd/regexp/onepass.go.html#3556318">visitQueue</a></span><span class="op" id="3560692">.</span><span class="ident" id="3560693"><a href="/gostd/regexp/onepass.go.html#3550713">clear</a></span><span class="op" id="3560698">(</span><span class="op" id="3560699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560703">if</span>&nbsp;<span class="op" id="3560706">!</span><span class="ident" id="3560707"><a href="/gostd/regexp/onepass.go.html#3556400">check</a></span><span class="op" id="3560712">(</span><span class="builtintype" id="3560713">uint32</span><span class="op" id="3560719">(</span><span class="ident" id="3560720"><a href="/gostd/regexp/onepass.go.html#3560636">pc</a></span><span class="op" id="3560722">)</span><span class="op" id="3560723">,</span>&nbsp;<span class="ident" id="3560725"><a href="/gostd/regexp/onepass.go.html#3560568">m</a></span><span class="op" id="3560726">)</span>&nbsp;<span class="op" id="3560728">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560733"><a href="/gostd/regexp/onepass.go.html#3556099">p</a></span>&nbsp;<span class="op" id="3560735">=</span>&nbsp;<span class="ident" id="3560737"><a href="/gostd/regexp/onepass.go.html#3562168">notOnePass</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560751">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3560759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560763">switch</span>&nbsp;<span class="ident" id="3560770"><a href="/gostd/regexp/onepass.go.html#3560661">inst</a></span><span class="op" id="3560774">.</span><span class="ident" id="3560775"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3560778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560782">case</span>&nbsp;<span class="ident" id="3560787"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3560793">.</span><span class="ident" id="3560794"><a href="/gostd/regexp/syntax/prog.go.html#3659200">InstAlt</a></span><span class="op" id="3560801">,</span>&nbsp;<span class="ident" id="3560803"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3560809">.</span><span class="ident" id="3560810"><a href="/gostd/regexp/syntax/prog.go.html#3659223">InstAltMatch</a></span><span class="op" id="3560822">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560827"><a href="/gostd/regexp/onepass.go.html#3556279">instQueue</a></span><span class="op" id="3560836">.</span><span class="ident" id="3560837"><a href="/gostd/regexp/onepass.go.html#3550992">insert</a></span><span class="op" id="3560843">(</span><span class="ident" id="3560844"><a href="/gostd/regexp/onepass.go.html#3560661">inst</a></span><span class="op" id="3560848">.</span><span class="ident" id="3560849"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3560852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560857"><a href="/gostd/regexp/onepass.go.html#3556279">instQueue</a></span><span class="op" id="3560866">.</span><span class="ident" id="3560867"><a href="/gostd/regexp/onepass.go.html#3550992">insert</a></span><span class="op" id="3560873">(</span><span class="ident" id="3560874"><a href="/gostd/regexp/onepass.go.html#3560661">inst</a></span><span class="op" id="3560878">.</span><span class="ident" id="3560879"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3560882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560886">case</span>&nbsp;<span class="ident" id="3560891"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3560897">.</span><span class="ident" id="3560898"><a href="/gostd/regexp/syntax/prog.go.html#3659237">InstCapture</a></span><span class="op" id="3560909">,</span>&nbsp;<span class="ident" id="3560911"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3560917">.</span><span class="ident" id="3560918"><a href="/gostd/regexp/syntax/prog.go.html#3659250">InstEmptyWidth</a></span><span class="op" id="3560932">,</span>&nbsp;<span class="ident" id="3560934"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3560940">.</span><span class="ident" id="3560941"><a href="/gostd/regexp/syntax/prog.go.html#3659287">InstNop</a></span><span class="op" id="3560948">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560953"><a href="/gostd/regexp/onepass.go.html#3556279">instQueue</a></span><span class="op" id="3560962">.</span><span class="ident" id="3560963"><a href="/gostd/regexp/onepass.go.html#3550992">insert</a></span><span class="op" id="3560969">(</span><span class="ident" id="3560970"><a href="/gostd/regexp/onepass.go.html#3560661">inst</a></span><span class="op" id="3560974">.</span><span class="ident" id="3560975"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3560978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560982">case</span>&nbsp;<span class="ident" id="3560987"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3560993">.</span><span class="ident" id="3560994"><a href="/gostd/regexp/syntax/prog.go.html#3659266">InstMatch</a></span><span class="op" id="3561003">:</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561007">case</span>&nbsp;<span class="ident" id="3561012"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3561018">.</span><span class="ident" id="3561019"><a href="/gostd/regexp/syntax/prog.go.html#3659277">InstFail</a></span><span class="op" id="3561027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561031">case</span>&nbsp;<span class="ident" id="3561036"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3561042">.</span><span class="ident" id="3561043"><a href="/gostd/regexp/syntax/prog.go.html#3659296">InstRune</a></span><span class="op" id="3561051">,</span>&nbsp;<span class="ident" id="3561053"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3561059">.</span><span class="ident" id="3561060"><a href="/gostd/regexp/syntax/prog.go.html#3659306">InstRune1</a></span><span class="op" id="3561069">,</span>&nbsp;<span class="ident" id="3561071"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3561077">.</span><span class="ident" id="3561078"><a href="/gostd/regexp/syntax/prog.go.html#3659317">InstRuneAny</a></span><span class="op" id="3561089">,</span>&nbsp;<span class="ident" id="3561091"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3561097">.</span><span class="ident" id="3561098"><a href="/gostd/regexp/syntax/prog.go.html#3659330">InstRuneAnyNotNL</a></span><span class="op" id="3561114">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561118">default</span><span class="op" id="3561125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3561129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3561132">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561135">if</span>&nbsp;<span class="ident" id="3561138"><a href="/gostd/regexp/onepass.go.html#3556099">p</a></span>&nbsp;<span class="op" id="3561140">!=</span>&nbsp;<span class="ident" id="3561143"><a href="/gostd/regexp/onepass.go.html#3562168">notOnePass</a></span>&nbsp;<span class="op" id="3561154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561158">for</span>&nbsp;<span class="ident" id="3561162">i</span>&nbsp;<span class="op" id="3561164">:=</span>&nbsp;<span class="keyword" id="3561167">range</span>&nbsp;<span class="ident" id="3561173"><a href="/gostd/regexp/onepass.go.html#3556099">p</a></span><span class="op" id="3561174">.</span><span class="ident" id="3561175"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span>&nbsp;<span class="op" id="3561180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561185"><a href="/gostd/regexp/onepass.go.html#3556099">p</a></span><span class="op" id="3561186">.</span><span class="ident" id="3561187"><a href="/gostd/regexp/onepass.go.html#3548204">Inst</a></span><span class="op" id="3561191">[</span><span class="ident" id="3561192"><a href="/gostd/regexp/onepass.go.html#3561162">i</a></span><span class="op" id="3561193">]</span><span class="op" id="3561194">.</span><span class="ident" id="3561195"><a href="/gostd/regexp/syntax/prog.go.html#3661201">Rune</a></span>&nbsp;<span class="op" id="3561200">=</span>&nbsp;<span class="ident" id="3561202"><a href="/gostd/regexp/onepass.go.html#3556450">onePassRunes</a></span><span class="op" id="3561214">[</span><span class="ident" id="3561215"><a href="/gostd/regexp/onepass.go.html#3561162">i</a></span><span class="op" id="3561216">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3561220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3561223">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561226">return</span>&nbsp;<span class="ident" id="3561233"><a href="/gostd/regexp/onepass.go.html#3556099">p</a></span><br>
<span class="lineno"></span><span class="op" id="3561235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3561238">//&nbsp;walk&nbsp;visits&nbsp;each&nbsp;Inst&nbsp;in&nbsp;the&nbsp;prog&nbsp;once,&nbsp;and&nbsp;applies&nbsp;the&nbsp;argument</span><br>
<span class="lineno"></span><span class="comment" id="3561306">//&nbsp;function(ip,&nbsp;next),&nbsp;in&nbsp;pre-order.</span><br>
<span class="lineno">495</span><span class="keyword" id="3561343">func</span>&nbsp;<span class="ident" id="3561348">walk</span><span class="op" id="3561352">(</span><span class="ident" id="3561353">prog</span>&nbsp;<span class="op" id="3561358">*</span><span class="ident" id="3561359"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3561365">.</span><span class="ident" id="3561366"><a href="/gostd/regexp/syntax/prog.go.html#3659010">Prog</a></span><span class="op" id="3561370">,</span>&nbsp;<span class="ident" id="3561372">funcs</span>&nbsp;<span class="op" id="3561378">...</span><span class="keyword" id="3561381">func</span><span class="op" id="3561385">(</span><span class="ident" id="3561386">ip</span><span class="op" id="3561388">,</span>&nbsp;<span class="ident" id="3561390">next</span>&nbsp;<span class="builtintype" id="3561395">uint32</span><span class="op" id="3561401">)</span><span class="op" id="3561402">)</span>&nbsp;<span class="op" id="3561404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561407">var</span>&nbsp;<span class="ident" id="3561411">walk1</span>&nbsp;<span class="keyword" id="3561417">func</span><span class="op" id="3561421">(</span><span class="builtintype" id="3561422">uint32</span><span class="op" id="3561428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561431">progQueue</span>&nbsp;<span class="op" id="3561441">:=</span>&nbsp;<span class="ident" id="3561444"><a href="/gostd/regexp/onepass.go.html#3551206">newQueue</a></span><span class="op" id="3561452">(</span><span class="builtinfunc" id="3561453">len</span><span class="op" id="3561456">(</span><span class="ident" id="3561457"><a href="/gostd/regexp/onepass.go.html#3561353">prog</a></span><span class="op" id="3561461">.</span><span class="ident" id="3561462"><a href="/gostd/regexp/syntax/prog.go.html#3659025">Inst</a></span><span class="op" id="3561466">)</span><span class="op" id="3561467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561470"><a href="/gostd/regexp/onepass.go.html#3561411">walk1</a></span>&nbsp;<span class="op" id="3561476">=</span>&nbsp;<span class="keyword" id="3561478">func</span><span class="op" id="3561482">(</span><span class="ident" id="3561483">ip</span>&nbsp;<span class="builtintype" id="3561486">uint32</span><span class="op" id="3561492">)</span>&nbsp;<span class="op" id="3561494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561498">if</span>&nbsp;<span class="ident" id="3561501"><a href="/gostd/regexp/onepass.go.html#3561431">progQueue</a></span><span class="op" id="3561510">.</span><span class="ident" id="3561511"><a href="/gostd/regexp/onepass.go.html#3550831">contains</a></span><span class="op" id="3561519">(</span><span class="ident" id="3561520"><a href="/gostd/regexp/onepass.go.html#3561483">ip</a></span><span class="op" id="3561522">)</span>&nbsp;<span class="op" id="3561524">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561529">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3561538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561542"><a href="/gostd/regexp/onepass.go.html#3561431">progQueue</a></span><span class="op" id="3561551">.</span><span class="ident" id="3561552"><a href="/gostd/regexp/onepass.go.html#3550992">insert</a></span><span class="op" id="3561558">(</span><span class="ident" id="3561559"><a href="/gostd/regexp/onepass.go.html#3561483">ip</a></span><span class="op" id="3561561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561565">inst</span>&nbsp;<span class="op" id="3561570">:=</span>&nbsp;<span class="ident" id="3561573"><a href="/gostd/regexp/onepass.go.html#3561353">prog</a></span><span class="op" id="3561577">.</span><span class="ident" id="3561578"><a href="/gostd/regexp/syntax/prog.go.html#3659025">Inst</a></span><span class="op" id="3561582">[</span><span class="ident" id="3561583"><a href="/gostd/regexp/onepass.go.html#3561483">ip</a></span><span class="op" id="3561585">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561589">switch</span>&nbsp;<span class="ident" id="3561596"><a href="/gostd/regexp/onepass.go.html#3561565">inst</a></span><span class="op" id="3561600">.</span><span class="ident" id="3561601"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3561604">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561608">case</span>&nbsp;<span class="ident" id="3561613"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3561619">.</span><span class="ident" id="3561620"><a href="/gostd/regexp/syntax/prog.go.html#3659200">InstAlt</a></span><span class="op" id="3561627">,</span>&nbsp;<span class="ident" id="3561629"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3561635">.</span><span class="ident" id="3561636"><a href="/gostd/regexp/syntax/prog.go.html#3659223">InstAltMatch</a></span><span class="op" id="3561648">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561653">for</span>&nbsp;<span class="ident" id="3561657">_</span><span class="op" id="3561658">,</span>&nbsp;<span class="ident" id="3561660">f</span>&nbsp;<span class="op" id="3561662">:=</span>&nbsp;<span class="keyword" id="3561665">range</span>&nbsp;<span class="ident" id="3561671"><a href="/gostd/regexp/onepass.go.html#3561372">funcs</a></span>&nbsp;<span class="op" id="3561677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561683"><a href="/gostd/regexp/onepass.go.html#3561660">f</a></span><span class="op" id="3561684">(</span><span class="ident" id="3561685"><a href="/gostd/regexp/onepass.go.html#3561483">ip</a></span><span class="op" id="3561687">,</span>&nbsp;<span class="ident" id="3561689"><a href="/gostd/regexp/onepass.go.html#3561565">inst</a></span><span class="op" id="3561693">.</span><span class="ident" id="3561694"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3561697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561703"><a href="/gostd/regexp/onepass.go.html#3561660">f</a></span><span class="op" id="3561704">(</span><span class="ident" id="3561705"><a href="/gostd/regexp/onepass.go.html#3561483">ip</a></span><span class="op" id="3561707">,</span>&nbsp;<span class="ident" id="3561709"><a href="/gostd/regexp/onepass.go.html#3561565">inst</a></span><span class="op" id="3561713">.</span><span class="ident" id="3561714"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3561717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3561722">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561727"><a href="/gostd/regexp/onepass.go.html#3561411">walk1</a></span><span class="op" id="3561732">(</span><span class="ident" id="3561733"><a href="/gostd/regexp/onepass.go.html#3561565">inst</a></span><span class="op" id="3561737">.</span><span class="ident" id="3561738"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3561741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561746"><a href="/gostd/regexp/onepass.go.html#3561411">walk1</a></span><span class="op" id="3561751">(</span><span class="ident" id="3561752"><a href="/gostd/regexp/onepass.go.html#3561565">inst</a></span><span class="op" id="3561756">.</span><span class="ident" id="3561757"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3561760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561764">default</span><span class="op" id="3561771">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561776">for</span>&nbsp;<span class="ident" id="3561780">_</span><span class="op" id="3561781">,</span>&nbsp;<span class="ident" id="3561783">f</span>&nbsp;<span class="op" id="3561785">:=</span>&nbsp;<span class="keyword" id="3561788">range</span>&nbsp;<span class="ident" id="3561794"><a href="/gostd/regexp/onepass.go.html#3561372">funcs</a></span>&nbsp;<span class="op" id="3561800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561806"><a href="/gostd/regexp/onepass.go.html#3561783">f</a></span><span class="op" id="3561807">(</span><span class="ident" id="3561808"><a href="/gostd/regexp/onepass.go.html#3561483">ip</a></span><span class="op" id="3561810">,</span>&nbsp;<span class="ident" id="3561812"><a href="/gostd/regexp/onepass.go.html#3561565">inst</a></span><span class="op" id="3561816">.</span><span class="ident" id="3561817"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3561820">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3561825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561830"><a href="/gostd/regexp/onepass.go.html#3561411">walk1</a></span><span class="op" id="3561835">(</span><span class="ident" id="3561836"><a href="/gostd/regexp/onepass.go.html#3561565">inst</a></span><span class="op" id="3561840">.</span><span class="ident" id="3561841"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3561844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3561848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3561851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561854"><a href="/gostd/regexp/onepass.go.html#3561411">walk1</a></span><span class="op" id="3561859">(</span><span class="builtintype" id="3561860">uint32</span><span class="op" id="3561866">(</span><span class="ident" id="3561867"><a href="/gostd/regexp/onepass.go.html#3561353">prog</a></span><span class="op" id="3561871">.</span><span class="ident" id="3561872"><a href="/gostd/regexp/syntax/prog.go.html#3659040">Start</a></span><span class="op" id="3561877">)</span><span class="op" id="3561878">)</span><br>
<span class="lineno">520</span><span class="op" id="3561880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3561883">//&nbsp;find&nbsp;returns&nbsp;the&nbsp;Insts&nbsp;that&nbsp;match&nbsp;the&nbsp;argument&nbsp;predicate&nbsp;function</span><br>
<span class="lineno"></span><span class="keyword" id="3561952">func</span>&nbsp;<span class="ident" id="3561957">find</span><span class="op" id="3561961">(</span><span class="ident" id="3561962">prog</span>&nbsp;<span class="op" id="3561967">*</span><span class="ident" id="3561968"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3561974">.</span><span class="ident" id="3561975"><a href="/gostd/regexp/syntax/prog.go.html#3659010">Prog</a></span><span class="op" id="3561979">,</span>&nbsp;<span class="ident" id="3561981">f</span>&nbsp;<span class="keyword" id="3561983">func</span><span class="op" id="3561987">(</span><span class="op" id="3561988">*</span><span class="ident" id="3561989"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3561995">.</span><span class="ident" id="3561996"><a href="/gostd/regexp/syntax/prog.go.html#3659010">Prog</a></span><span class="op" id="3562000">,</span>&nbsp;<span class="builtintype" id="3562002">int</span><span class="op" id="3562005">)</span>&nbsp;<span class="builtintype" id="3562007">bool</span><span class="op" id="3562011">)</span>&nbsp;<span class="op" id="3562013">(</span><span class="ident" id="3562014">matches</span>&nbsp;<span class="op" id="3562022">[</span><span class="op" id="3562023">]</span><span class="builtintype" id="3562024">uint32</span><span class="op" id="3562030">)</span>&nbsp;<span class="op" id="3562032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3562035"><a href="/gostd/regexp/onepass.go.html#3562014">matches</a></span>&nbsp;<span class="op" id="3562043">=</span>&nbsp;<span class="op" id="3562045">[</span><span class="op" id="3562046">]</span><span class="builtintype" id="3562047">uint32</span><span class="op" id="3562053">{</span><span class="op" id="3562054">}</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3562058">for</span>&nbsp;<span class="ident" id="3562062">ip</span>&nbsp;<span class="op" id="3562065">:=</span>&nbsp;<span class="keyword" id="3562068">range</span>&nbsp;<span class="ident" id="3562074"><a href="/gostd/regexp/onepass.go.html#3561962">prog</a></span><span class="op" id="3562078">.</span><span class="ident" id="3562079"><a href="/gostd/regexp/syntax/prog.go.html#3659025">Inst</a></span>&nbsp;<span class="op" id="3562084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3562088">if</span>&nbsp;<span class="ident" id="3562091"><a href="/gostd/regexp/onepass.go.html#3561981">f</a></span><span class="op" id="3562092">(</span><span class="ident" id="3562093"><a href="/gostd/regexp/onepass.go.html#3561962">prog</a></span><span class="op" id="3562097">,</span>&nbsp;<span class="ident" id="3562099"><a href="/gostd/regexp/onepass.go.html#3562062">ip</a></span><span class="op" id="3562101">)</span>&nbsp;<span class="op" id="3562103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3562108"><a href="/gostd/regexp/onepass.go.html#3562014">matches</a></span>&nbsp;<span class="op" id="3562116">=</span>&nbsp;<span class="builtinfunc" id="3562118">append</span><span class="op" id="3562124">(</span><span class="ident" id="3562125"><a href="/gostd/regexp/onepass.go.html#3562014">matches</a></span><span class="op" id="3562132">,</span>&nbsp;<span class="builtintype" id="3562134">uint32</span><span class="op" id="3562140">(</span><span class="ident" id="3562141"><a href="/gostd/regexp/onepass.go.html#3562062">ip</a></span><span class="op" id="3562143">)</span><span class="op" id="3562144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3562148">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3562151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3562154">return</span><br>
<span class="lineno"></span><span class="op" id="3562161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3562164">var</span>&nbsp;<span class="ident" id="3562168">notOnePass</span>&nbsp;<span class="op" id="3562179">*</span><span class="ident" id="3562180"><a href="/gostd/regexp/onepass.go.html#3548182">onePassProg</a></span>&nbsp;<span class="op" id="3562192">=</span>&nbsp;<span class="builtintype" id="3562194">nil</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="comment" id="3562199">//&nbsp;compileOnePass&nbsp;returns&nbsp;a&nbsp;new&nbsp;*syntax.Prog&nbsp;suitable&nbsp;for&nbsp;onePass&nbsp;execution&nbsp;if&nbsp;the&nbsp;original&nbsp;Prog</span><br>
<span class="lineno"></span><span class="comment" id="3562296">//&nbsp;can&nbsp;be&nbsp;recharacterized&nbsp;as&nbsp;a&nbsp;one-pass&nbsp;regexp&nbsp;program,&nbsp;or&nbsp;syntax.notOnePass&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3562380">//&nbsp;Prog&nbsp;cannot&nbsp;be&nbsp;converted.&nbsp;For&nbsp;a&nbsp;one&nbsp;pass&nbsp;prog,&nbsp;the&nbsp;fundamental&nbsp;condition&nbsp;that&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="3562466">//&nbsp;be&nbsp;true&nbsp;is:&nbsp;at&nbsp;any&nbsp;InstAlt,&nbsp;there&nbsp;must&nbsp;be&nbsp;no&nbsp;ambiguity&nbsp;about&nbsp;what&nbsp;branch&nbsp;to&nbsp;&nbsp;take.</span><br>
<span class="lineno">540</span><span class="keyword" id="3562552">func</span>&nbsp;<span class="ident" id="3562557">compileOnePass</span><span class="op" id="3562571">(</span><span class="ident" id="3562572">prog</span>&nbsp;<span class="op" id="3562577">*</span><span class="ident" id="3562578"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3562584">.</span><span class="ident" id="3562585"><a href="/gostd/regexp/syntax/prog.go.html#3659010">Prog</a></span><span class="op" id="3562589">)</span>&nbsp;<span class="op" id="3562591">(</span><span class="ident" id="3562592">p</span>&nbsp;<span class="op" id="3562594">*</span><span class="ident" id="3562595"><a href="/gostd/regexp/onepass.go.html#3548182">onePassProg</a></span><span class="op" id="3562606">)</span>&nbsp;<span class="op" id="3562608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3562611">if</span>&nbsp;<span class="ident" id="3562614"><a href="/gostd/regexp/onepass.go.html#3562572">prog</a></span><span class="op" id="3562618">.</span><span class="ident" id="3562619"><a href="/gostd/regexp/syntax/prog.go.html#3659040">Start</a></span>&nbsp;<span class="op" id="3562625">==</span>&nbsp;<span class="num" id="3562628">0</span>&nbsp;<span class="op" id="3562630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3562634">return</span>&nbsp;<span class="ident" id="3562641"><a href="/gostd/regexp/onepass.go.html#3562168">notOnePass</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3562653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3562656">//&nbsp;onepass&nbsp;regexp&nbsp;is&nbsp;anchored</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3562687">if</span>&nbsp;<span class="ident" id="3562690"><a href="/gostd/regexp/onepass.go.html#3562572">prog</a></span><span class="op" id="3562694">.</span><span class="ident" id="3562695"><a href="/gostd/regexp/syntax/prog.go.html#3659025">Inst</a></span><span class="op" id="3562699">[</span><span class="ident" id="3562700"><a href="/gostd/regexp/onepass.go.html#3562572">prog</a></span><span class="op" id="3562704">.</span><span class="ident" id="3562705"><a href="/gostd/regexp/syntax/prog.go.html#3659040">Start</a></span><span class="op" id="3562710">]</span><span class="op" id="3562711">.</span><span class="ident" id="3562712"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3562715">!=</span>&nbsp;<span class="ident" id="3562718"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3562724">.</span><span class="ident" id="3562725"><a href="/gostd/regexp/syntax/prog.go.html#3659250">InstEmptyWidth</a></span>&nbsp;<span class="op" id="3562740">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3562745"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3562751">.</span><span class="ident" id="3562752"><a href="/gostd/regexp/syntax/prog.go.html#3659736">EmptyOp</a></span><span class="op" id="3562759">(</span><span class="ident" id="3562760"><a href="/gostd/regexp/onepass.go.html#3562572">prog</a></span><span class="op" id="3562764">.</span><span class="ident" id="3562765"><a href="/gostd/regexp/syntax/prog.go.html#3659025">Inst</a></span><span class="op" id="3562769">[</span><span class="ident" id="3562770"><a href="/gostd/regexp/onepass.go.html#3562572">prog</a></span><span class="op" id="3562774">.</span><span class="ident" id="3562775"><a href="/gostd/regexp/syntax/prog.go.html#3659040">Start</a></span><span class="op" id="3562780">]</span><span class="op" id="3562781">.</span><span class="ident" id="3562782"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3562785">)</span><span class="op" id="3562786">&amp;</span><span class="ident" id="3562787"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3562793">.</span><span class="ident" id="3562794"><a href="/gostd/regexp/syntax/prog.go.html#3659810">EmptyBeginText</a></span>&nbsp;<span class="op" id="3562809">!=</span>&nbsp;<span class="ident" id="3562812"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3562818">.</span><span class="ident" id="3562819"><a href="/gostd/regexp/syntax/prog.go.html#3659810">EmptyBeginText</a></span>&nbsp;<span class="op" id="3562834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3562838">return</span>&nbsp;<span class="ident" id="3562845"><a href="/gostd/regexp/onepass.go.html#3562168">notOnePass</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3562857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3562860">//&nbsp;every&nbsp;instruction&nbsp;leading&nbsp;to&nbsp;InstMatch&nbsp;must&nbsp;be&nbsp;EmptyEndText</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3562924">for</span>&nbsp;<span class="ident" id="3562928">_</span><span class="op" id="3562929">,</span>&nbsp;<span class="ident" id="3562931">inst</span>&nbsp;<span class="op" id="3562936">:=</span>&nbsp;<span class="keyword" id="3562939">range</span>&nbsp;<span class="ident" id="3562945"><a href="/gostd/regexp/onepass.go.html#3562572">prog</a></span><span class="op" id="3562949">.</span><span class="ident" id="3562950"><a href="/gostd/regexp/syntax/prog.go.html#3659025">Inst</a></span>&nbsp;<span class="op" id="3562955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3562959">opOut</span>&nbsp;<span class="op" id="3562965">:=</span>&nbsp;<span class="ident" id="3562968"><a href="/gostd/regexp/onepass.go.html#3562572">prog</a></span><span class="op" id="3562972">.</span><span class="ident" id="3562973"><a href="/gostd/regexp/syntax/prog.go.html#3659025">Inst</a></span><span class="op" id="3562977">[</span><span class="ident" id="3562978"><a href="/gostd/regexp/onepass.go.html#3562931">inst</a></span><span class="op" id="3562982">.</span><span class="ident" id="3562983"><a href="/gostd/regexp/syntax/prog.go.html#3661090">Out</a></span><span class="op" id="3562986">]</span><span class="op" id="3562987">.</span><span class="ident" id="3562988"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3562993">switch</span>&nbsp;<span class="ident" id="3563000"><a href="/gostd/regexp/onepass.go.html#3562931">inst</a></span><span class="op" id="3563004">.</span><span class="ident" id="3563005"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3563008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563012">default</span><span class="op" id="3563019">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563024">if</span>&nbsp;<span class="ident" id="3563027"><a href="/gostd/regexp/onepass.go.html#3562959">opOut</a></span>&nbsp;<span class="op" id="3563033">==</span>&nbsp;<span class="ident" id="3563036"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3563042">.</span><span class="ident" id="3563043"><a href="/gostd/regexp/syntax/prog.go.html#3659266">InstMatch</a></span>&nbsp;<span class="op" id="3563053">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563059">return</span>&nbsp;<span class="ident" id="3563066"><a href="/gostd/regexp/onepass.go.html#3562168">notOnePass</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3563080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563084">case</span>&nbsp;<span class="ident" id="3563089"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3563095">.</span><span class="ident" id="3563096"><a href="/gostd/regexp/syntax/prog.go.html#3659200">InstAlt</a></span><span class="op" id="3563103">,</span>&nbsp;<span class="ident" id="3563105"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3563111">.</span><span class="ident" id="3563112"><a href="/gostd/regexp/syntax/prog.go.html#3659223">InstAltMatch</a></span><span class="op" id="3563124">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563129">if</span>&nbsp;<span class="ident" id="3563132"><a href="/gostd/regexp/onepass.go.html#3562959">opOut</a></span>&nbsp;<span class="op" id="3563138">==</span>&nbsp;<span class="ident" id="3563141"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3563147">.</span><span class="ident" id="3563148"><a href="/gostd/regexp/syntax/prog.go.html#3659266">InstMatch</a></span>&nbsp;<span class="op" id="3563158">||</span>&nbsp;<span class="ident" id="3563161"><a href="/gostd/regexp/onepass.go.html#3562572">prog</a></span><span class="op" id="3563165">.</span><span class="ident" id="3563166"><a href="/gostd/regexp/syntax/prog.go.html#3659025">Inst</a></span><span class="op" id="3563170">[</span><span class="ident" id="3563171"><a href="/gostd/regexp/onepass.go.html#3562931">inst</a></span><span class="op" id="3563175">.</span><span class="ident" id="3563176"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3563179">]</span><span class="op" id="3563180">.</span><span class="ident" id="3563181"><a href="/gostd/regexp/syntax/prog.go.html#3661077">Op</a></span>&nbsp;<span class="op" id="3563184">==</span>&nbsp;<span class="ident" id="3563187"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3563193">.</span><span class="ident" id="3563194"><a href="/gostd/regexp/syntax/prog.go.html#3659266">InstMatch</a></span>&nbsp;<span class="op" id="3563204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563210">return</span>&nbsp;<span class="ident" id="3563217"><a href="/gostd/regexp/onepass.go.html#3562168">notOnePass</a></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3563231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563235">case</span>&nbsp;<span class="ident" id="3563240"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3563246">.</span><span class="ident" id="3563247"><a href="/gostd/regexp/syntax/prog.go.html#3659250">InstEmptyWidth</a></span><span class="op" id="3563261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563266">if</span>&nbsp;<span class="ident" id="3563269"><a href="/gostd/regexp/onepass.go.html#3562959">opOut</a></span>&nbsp;<span class="op" id="3563275">==</span>&nbsp;<span class="ident" id="3563278"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3563284">.</span><span class="ident" id="3563285"><a href="/gostd/regexp/syntax/prog.go.html#3659266">InstMatch</a></span>&nbsp;<span class="op" id="3563295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563301">if</span>&nbsp;<span class="ident" id="3563304"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3563310">.</span><span class="ident" id="3563311"><a href="/gostd/regexp/syntax/prog.go.html#3659736">EmptyOp</a></span><span class="op" id="3563318">(</span><span class="ident" id="3563319"><a href="/gostd/regexp/onepass.go.html#3562931">inst</a></span><span class="op" id="3563323">.</span><span class="ident" id="3563324"><a href="/gostd/regexp/syntax/prog.go.html#3661134">Arg</a></span><span class="op" id="3563327">)</span><span class="op" id="3563328">&amp;</span><span class="ident" id="3563329"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3563335">.</span><span class="ident" id="3563336"><a href="/gostd/regexp/syntax/prog.go.html#3659826">EmptyEndText</a></span>&nbsp;<span class="op" id="3563349">==</span>&nbsp;<span class="ident" id="3563352"><a href="/gostd/regexp/onepass.go.html#3547731">syntax</a></span><span class="op" id="3563358">.</span><span class="ident" id="3563359"><a href="/gostd/regexp/syntax/prog.go.html#3659826">EmptyEndText</a></span>&nbsp;<span class="op" id="3563372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563379">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3563392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563398">return</span>&nbsp;<span class="ident" id="3563405"><a href="/gostd/regexp/onepass.go.html#3562168">notOnePass</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3563419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3563423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3563426">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3563429">//&nbsp;Creates&nbsp;a&nbsp;slightly&nbsp;optimized&nbsp;copy&nbsp;of&nbsp;the&nbsp;original&nbsp;Prog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3563488">//&nbsp;that&nbsp;cleans&nbsp;up&nbsp;some&nbsp;Prog&nbsp;idioms&nbsp;that&nbsp;block&nbsp;valid&nbsp;onepass&nbsp;programs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3563558"><a href="/gostd/regexp/onepass.go.html#3562592">p</a></span>&nbsp;<span class="op" id="3563560">=</span>&nbsp;<span class="ident" id="3563562"><a href="/gostd/regexp/onepass.go.html#3553564">onePassCopy</a></span><span class="op" id="3563573">(</span><span class="ident" id="3563574"><a href="/gostd/regexp/onepass.go.html#3562572">prog</a></span><span class="op" id="3563578">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3563582">//&nbsp;checkAmbiguity&nbsp;on&nbsp;InstAlts,&nbsp;build&nbsp;onepass&nbsp;Prog&nbsp;if&nbsp;possible</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3563645"><a href="/gostd/regexp/onepass.go.html#3562592">p</a></span>&nbsp;<span class="op" id="3563647">=</span>&nbsp;<span class="ident" id="3563649"><a href="/gostd/regexp/onepass.go.html#3556087">makeOnePass</a></span><span class="op" id="3563660">(</span><span class="ident" id="3563661"><a href="/gostd/regexp/onepass.go.html#3562592">p</a></span><span class="op" id="3563662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563666">if</span>&nbsp;<span class="ident" id="3563669"><a href="/gostd/regexp/onepass.go.html#3562592">p</a></span>&nbsp;<span class="op" id="3563671">!=</span>&nbsp;<span class="ident" id="3563674"><a href="/gostd/regexp/onepass.go.html#3562168">notOnePass</a></span>&nbsp;<span class="op" id="3563685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3563689"><a href="/gostd/regexp/onepass.go.html#3553000">cleanupOnePass</a></span><span class="op" id="3563703">(</span><span class="ident" id="3563704"><a href="/gostd/regexp/onepass.go.html#3562592">p</a></span><span class="op" id="3563705">,</span>&nbsp;<span class="ident" id="3563707"><a href="/gostd/regexp/onepass.go.html#3562572">prog</a></span><span class="op" id="3563711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3563714">}</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563717">return</span>&nbsp;<span class="ident" id="3563724"><a href="/gostd/regexp/onepass.go.html#3562592">p</a></span><br>
<span class="lineno"></span><span class="op" id="3563726">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
