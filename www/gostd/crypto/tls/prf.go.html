<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html" class="current">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4570579">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4570634">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4570688">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4570739">package</span>&nbsp;<span class="ident" id="4570747">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4570752">import</span>&nbsp;<span class="op" id="4570759">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4570762">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4570772">&#34;crypto/hmac&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4570787">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4570801">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4570816">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4570833">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4570840">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="4570843">//&nbsp;Split&nbsp;a&nbsp;premaster&nbsp;secret&nbsp;in&nbsp;two&nbsp;as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;4346,&nbsp;section&nbsp;5.</span><br>
<span class="lineno"></span><span class="keyword" id="4570915">func</span>&nbsp;<span class="ident" id="4570920">splitPreMasterSecret</span><span class="op" id="4570940">(</span><span class="ident" id="4570941">secret</span>&nbsp;<span class="op" id="4570948">[</span><span class="op" id="4570949">]</span><span class="builtintype" id="4570950">byte</span><span class="op" id="4570954">)</span>&nbsp;<span class="op" id="4570956">(</span><span class="ident" id="4570957">s1</span><span class="op" id="4570959">,</span>&nbsp;<span class="ident" id="4570961">s2</span>&nbsp;<span class="op" id="4570964">[</span><span class="op" id="4570965">]</span><span class="builtintype" id="4570966">byte</span><span class="op" id="4570970">)</span>&nbsp;<span class="op" id="4570972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4570975"><a href="/gostd/crypto/tls/prf.go.html#4570957">s1</a></span>&nbsp;<span class="op" id="4570978">=</span>&nbsp;<span class="ident" id="4570980"><a href="/gostd/crypto/tls/prf.go.html#4570941">secret</a></span><span class="op" id="4570986">[</span><span class="num" id="4570987">0</span>&nbsp;<span class="op" id="4570989">:</span>&nbsp;<span class="op" id="4570991">(</span><span class="builtinfunc" id="4570992">len</span><span class="op" id="4570995">(</span><span class="ident" id="4570996"><a href="/gostd/crypto/tls/prf.go.html#4570941">secret</a></span><span class="op" id="4571002">)</span><span class="op" id="4571003">+</span><span class="num" id="4571004">1</span><span class="op" id="4571005">)</span><span class="op" id="4571006">/</span><span class="num" id="4571007">2</span><span class="op" id="4571008">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571011"><a href="/gostd/crypto/tls/prf.go.html#4570961">s2</a></span>&nbsp;<span class="op" id="4571014">=</span>&nbsp;<span class="ident" id="4571016"><a href="/gostd/crypto/tls/prf.go.html#4570941">secret</a></span><span class="op" id="4571022">[</span><span class="builtinfunc" id="4571023">len</span><span class="op" id="4571026">(</span><span class="ident" id="4571027"><a href="/gostd/crypto/tls/prf.go.html#4570941">secret</a></span><span class="op" id="4571033">)</span><span class="op" id="4571034">/</span><span class="num" id="4571035">2</span><span class="op" id="4571036">:</span><span class="op" id="4571037">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571040">return</span><br>
<span class="lineno"></span><span class="op" id="4571047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4571050">//&nbsp;pHash&nbsp;implements&nbsp;the&nbsp;P_hash&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4346,&nbsp;section&nbsp;5.</span><br>
<span class="lineno"></span><span class="keyword" id="4571126">func</span>&nbsp;<span class="ident" id="4571131">pHash</span><span class="op" id="4571136">(</span><span class="ident" id="4571137">result</span><span class="op" id="4571143">,</span>&nbsp;<span class="ident" id="4571145">secret</span><span class="op" id="4571151">,</span>&nbsp;<span class="ident" id="4571153">seed</span>&nbsp;<span class="op" id="4571158">[</span><span class="op" id="4571159">]</span><span class="builtintype" id="4571160">byte</span><span class="op" id="4571164">,</span>&nbsp;<span class="ident" id="4571166">hash</span>&nbsp;<span class="keyword" id="4571171">func</span><span class="op" id="4571175">(</span><span class="op" id="4571176">)</span>&nbsp;<span class="ident" id="4571178"><a href="/gostd/crypto/tls/prf.go.html#4570833">hash</a></span><span class="op" id="4571182">.</span><span class="ident" id="4571183"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><span class="op" id="4571187">)</span>&nbsp;<span class="op" id="4571189">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571192">h</span>&nbsp;<span class="op" id="4571194">:=</span>&nbsp;<span class="ident" id="4571197"><a href="/gostd/crypto/tls/prf.go.html#4570772">hmac</a></span><span class="op" id="4571201">.</span><span class="ident" id="4571202"><a href="/gostd/crypto/hmac/hmac.go.html#4605122">New</a></span><span class="op" id="4571205">(</span><span class="ident" id="4571206"><a href="/gostd/crypto/tls/prf.go.html#4571166">hash</a></span><span class="op" id="4571210">,</span>&nbsp;<span class="ident" id="4571212"><a href="/gostd/crypto/tls/prf.go.html#4571145">secret</a></span><span class="op" id="4571218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571221"><a href="/gostd/crypto/tls/prf.go.html#4571192">h</a></span><span class="op" id="4571222">.</span><span class="ident" id="4571223"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4571228">(</span><span class="ident" id="4571229"><a href="/gostd/crypto/tls/prf.go.html#4571153">seed</a></span><span class="op" id="4571233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571236">a</span>&nbsp;<span class="op" id="4571238">:=</span>&nbsp;<span class="ident" id="4571241"><a href="/gostd/crypto/tls/prf.go.html#4571192">h</a></span><span class="op" id="4571242">.</span><span class="ident" id="4571243"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4571246">(</span><span class="builtintype" id="4571247">nil</span><span class="op" id="4571250">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571254">j</span>&nbsp;<span class="op" id="4571256">:=</span>&nbsp;<span class="num" id="4571259">0</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571262">for</span>&nbsp;<span class="ident" id="4571266"><a href="/gostd/crypto/tls/prf.go.html#4571254">j</a></span>&nbsp;<span class="op" id="4571268">&lt;</span>&nbsp;<span class="builtinfunc" id="4571270">len</span><span class="op" id="4571273">(</span><span class="ident" id="4571274"><a href="/gostd/crypto/tls/prf.go.html#4571137">result</a></span><span class="op" id="4571280">)</span>&nbsp;<span class="op" id="4571282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571286"><a href="/gostd/crypto/tls/prf.go.html#4571192">h</a></span><span class="op" id="4571287">.</span><span class="ident" id="4571288"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4571293">(</span><span class="op" id="4571294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571298"><a href="/gostd/crypto/tls/prf.go.html#4571192">h</a></span><span class="op" id="4571299">.</span><span class="ident" id="4571300"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4571305">(</span><span class="ident" id="4571306"><a href="/gostd/crypto/tls/prf.go.html#4571236">a</a></span><span class="op" id="4571307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571311"><a href="/gostd/crypto/tls/prf.go.html#4571192">h</a></span><span class="op" id="4571312">.</span><span class="ident" id="4571313"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4571318">(</span><span class="ident" id="4571319"><a href="/gostd/crypto/tls/prf.go.html#4571153">seed</a></span><span class="op" id="4571323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571327">b</span>&nbsp;<span class="op" id="4571329">:=</span>&nbsp;<span class="ident" id="4571332"><a href="/gostd/crypto/tls/prf.go.html#4571192">h</a></span><span class="op" id="4571333">.</span><span class="ident" id="4571334"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4571337">(</span><span class="builtintype" id="4571338">nil</span><span class="op" id="4571341">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571345">todo</span>&nbsp;<span class="op" id="4571350">:=</span>&nbsp;<span class="builtinfunc" id="4571353">len</span><span class="op" id="4571356">(</span><span class="ident" id="4571357"><a href="/gostd/crypto/tls/prf.go.html#4571327">b</a></span><span class="op" id="4571358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571362">if</span>&nbsp;<span class="ident" id="4571365"><a href="/gostd/crypto/tls/prf.go.html#4571254">j</a></span><span class="op" id="4571366">+</span><span class="ident" id="4571367"><a href="/gostd/crypto/tls/prf.go.html#4571345">todo</a></span>&nbsp;<span class="op" id="4571372">&gt;</span>&nbsp;<span class="builtinfunc" id="4571374">len</span><span class="op" id="4571377">(</span><span class="ident" id="4571378"><a href="/gostd/crypto/tls/prf.go.html#4571137">result</a></span><span class="op" id="4571384">)</span>&nbsp;<span class="op" id="4571386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571391"><a href="/gostd/crypto/tls/prf.go.html#4571345">todo</a></span>&nbsp;<span class="op" id="4571396">=</span>&nbsp;<span class="builtinfunc" id="4571398">len</span><span class="op" id="4571401">(</span><span class="ident" id="4571402"><a href="/gostd/crypto/tls/prf.go.html#4571137">result</a></span><span class="op" id="4571408">)</span>&nbsp;<span class="op" id="4571410">-</span>&nbsp;<span class="ident" id="4571412"><a href="/gostd/crypto/tls/prf.go.html#4571254">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4571416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4571420">copy</span><span class="op" id="4571424">(</span><span class="ident" id="4571425"><a href="/gostd/crypto/tls/prf.go.html#4571137">result</a></span><span class="op" id="4571431">[</span><span class="ident" id="4571432"><a href="/gostd/crypto/tls/prf.go.html#4571254">j</a></span><span class="op" id="4571433">:</span><span class="ident" id="4571434"><a href="/gostd/crypto/tls/prf.go.html#4571254">j</a></span><span class="op" id="4571435">+</span><span class="ident" id="4571436"><a href="/gostd/crypto/tls/prf.go.html#4571345">todo</a></span><span class="op" id="4571440">]</span><span class="op" id="4571441">,</span>&nbsp;<span class="ident" id="4571443"><a href="/gostd/crypto/tls/prf.go.html#4571327">b</a></span><span class="op" id="4571444">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571448"><a href="/gostd/crypto/tls/prf.go.html#4571254">j</a></span>&nbsp;<span class="op" id="4571450">+=</span>&nbsp;<span class="ident" id="4571453"><a href="/gostd/crypto/tls/prf.go.html#4571345">todo</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571461"><a href="/gostd/crypto/tls/prf.go.html#4571192">h</a></span><span class="op" id="4571462">.</span><span class="ident" id="4571463"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4571468">(</span><span class="op" id="4571469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571473"><a href="/gostd/crypto/tls/prf.go.html#4571192">h</a></span><span class="op" id="4571474">.</span><span class="ident" id="4571475"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4571480">(</span><span class="ident" id="4571481"><a href="/gostd/crypto/tls/prf.go.html#4571236">a</a></span><span class="op" id="4571482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571486"><a href="/gostd/crypto/tls/prf.go.html#4571236">a</a></span>&nbsp;<span class="op" id="4571488">=</span>&nbsp;<span class="ident" id="4571490"><a href="/gostd/crypto/tls/prf.go.html#4571192">h</a></span><span class="op" id="4571491">.</span><span class="ident" id="4571492"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4571495">(</span><span class="builtintype" id="4571496">nil</span><span class="op" id="4571499">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4571502">}</span><br>
<span class="lineno"></span><span class="op" id="4571504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4571507">//&nbsp;prf10&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;pseudo-random&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;5.</span><br>
<span class="lineno"></span><span class="keyword" id="4571598">func</span>&nbsp;<span class="ident" id="4571603">prf10</span><span class="op" id="4571608">(</span><span class="ident" id="4571609">result</span><span class="op" id="4571615">,</span>&nbsp;<span class="ident" id="4571617">secret</span><span class="op" id="4571623">,</span>&nbsp;<span class="ident" id="4571625">label</span><span class="op" id="4571630">,</span>&nbsp;<span class="ident" id="4571632">seed</span>&nbsp;<span class="op" id="4571637">[</span><span class="op" id="4571638">]</span><span class="builtintype" id="4571639">byte</span><span class="op" id="4571643">)</span>&nbsp;<span class="op" id="4571645">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571648">hashSHA1</span>&nbsp;<span class="op" id="4571657">:=</span>&nbsp;<span class="ident" id="4571660"><a href="/gostd/crypto/tls/prf.go.html#4570801">sha1</a></span><span class="op" id="4571664">.</span><span class="ident" id="4571665"><a href="/gostd/crypto/sha1/sha1.go.html#4609140">New</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571670">hashMD5</span>&nbsp;<span class="op" id="4571678">:=</span>&nbsp;<span class="ident" id="4571681"><a href="/gostd/crypto/tls/prf.go.html#4570787">md5</a></span><span class="op" id="4571684">.</span><span class="ident" id="4571685"><a href="/gostd/crypto/md5/md5.go.html#4710829">New</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571691">labelAndSeed</span>&nbsp;<span class="op" id="4571704">:=</span>&nbsp;<span class="builtinfunc" id="4571707">make</span><span class="op" id="4571711">(</span><span class="op" id="4571712">[</span><span class="op" id="4571713">]</span><span class="builtintype" id="4571714">byte</span><span class="op" id="4571718">,</span>&nbsp;<span class="builtinfunc" id="4571720">len</span><span class="op" id="4571723">(</span><span class="ident" id="4571724"><a href="/gostd/crypto/tls/prf.go.html#4571625">label</a></span><span class="op" id="4571729">)</span><span class="op" id="4571730">+</span><span class="builtinfunc" id="4571731">len</span><span class="op" id="4571734">(</span><span class="ident" id="4571735"><a href="/gostd/crypto/tls/prf.go.html#4571632">seed</a></span><span class="op" id="4571739">)</span><span class="op" id="4571740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4571743">copy</span><span class="op" id="4571747">(</span><span class="ident" id="4571748"><a href="/gostd/crypto/tls/prf.go.html#4571691">labelAndSeed</a></span><span class="op" id="4571760">,</span>&nbsp;<span class="ident" id="4571762"><a href="/gostd/crypto/tls/prf.go.html#4571625">label</a></span><span class="op" id="4571767">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4571770">copy</span><span class="op" id="4571774">(</span><span class="ident" id="4571775"><a href="/gostd/crypto/tls/prf.go.html#4571691">labelAndSeed</a></span><span class="op" id="4571787">[</span><span class="builtinfunc" id="4571788">len</span><span class="op" id="4571791">(</span><span class="ident" id="4571792"><a href="/gostd/crypto/tls/prf.go.html#4571625">label</a></span><span class="op" id="4571797">)</span><span class="op" id="4571798">:</span><span class="op" id="4571799">]</span><span class="op" id="4571800">,</span>&nbsp;<span class="ident" id="4571802"><a href="/gostd/crypto/tls/prf.go.html#4571632">seed</a></span><span class="op" id="4571806">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571810">s1</span><span class="op" id="4571812">,</span>&nbsp;<span class="ident" id="4571814">s2</span>&nbsp;<span class="op" id="4571817">:=</span>&nbsp;<span class="ident" id="4571820"><a href="/gostd/crypto/tls/prf.go.html#4570920">splitPreMasterSecret</a></span><span class="op" id="4571840">(</span><span class="ident" id="4571841"><a href="/gostd/crypto/tls/prf.go.html#4571617">secret</a></span><span class="op" id="4571847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571850"><a href="/gostd/crypto/tls/prf.go.html#4571131">pHash</a></span><span class="op" id="4571855">(</span><span class="ident" id="4571856"><a href="/gostd/crypto/tls/prf.go.html#4571609">result</a></span><span class="op" id="4571862">,</span>&nbsp;<span class="ident" id="4571864"><a href="/gostd/crypto/tls/prf.go.html#4571810">s1</a></span><span class="op" id="4571866">,</span>&nbsp;<span class="ident" id="4571868"><a href="/gostd/crypto/tls/prf.go.html#4571691">labelAndSeed</a></span><span class="op" id="4571880">,</span>&nbsp;<span class="ident" id="4571882"><a href="/gostd/crypto/tls/prf.go.html#4571670">hashMD5</a></span><span class="op" id="4571889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571892">result2</span>&nbsp;<span class="op" id="4571900">:=</span>&nbsp;<span class="builtinfunc" id="4571903">make</span><span class="op" id="4571907">(</span><span class="op" id="4571908">[</span><span class="op" id="4571909">]</span><span class="builtintype" id="4571910">byte</span><span class="op" id="4571914">,</span>&nbsp;<span class="builtinfunc" id="4571916">len</span><span class="op" id="4571919">(</span><span class="ident" id="4571920"><a href="/gostd/crypto/tls/prf.go.html#4571609">result</a></span><span class="op" id="4571926">)</span><span class="op" id="4571927">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4571930"><a href="/gostd/crypto/tls/prf.go.html#4571131">pHash</a></span><span class="op" id="4571935">(</span><span class="ident" id="4571936"><a href="/gostd/crypto/tls/prf.go.html#4571892">result2</a></span><span class="op" id="4571943">,</span>&nbsp;<span class="ident" id="4571945"><a href="/gostd/crypto/tls/prf.go.html#4571814">s2</a></span><span class="op" id="4571947">,</span>&nbsp;<span class="ident" id="4571949"><a href="/gostd/crypto/tls/prf.go.html#4571691">labelAndSeed</a></span><span class="op" id="4571961">,</span>&nbsp;<span class="ident" id="4571963"><a href="/gostd/crypto/tls/prf.go.html#4571648">hashSHA1</a></span><span class="op" id="4571971">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4571975">for</span>&nbsp;<span class="ident" id="4571979">i</span><span class="op" id="4571980">,</span>&nbsp;<span class="ident" id="4571982">b</span>&nbsp;<span class="op" id="4571984">:=</span>&nbsp;<span class="keyword" id="4571987">range</span>&nbsp;<span class="ident" id="4571993"><a href="/gostd/crypto/tls/prf.go.html#4571892">result2</a></span>&nbsp;<span class="op" id="4572001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572005"><a href="/gostd/crypto/tls/prf.go.html#4571609">result</a></span><span class="op" id="4572011">[</span><span class="ident" id="4572012"><a href="/gostd/crypto/tls/prf.go.html#4571979">i</a></span><span class="op" id="4572013">]</span>&nbsp;<span class="op" id="4572015">^=</span>&nbsp;<span class="ident" id="4572018"><a href="/gostd/crypto/tls/prf.go.html#4571982">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4572021">}</span><br>
<span class="lineno">65</span><span class="op" id="4572023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4572026">//&nbsp;prf12&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.2&nbsp;pseudo-random&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;5246,&nbsp;section&nbsp;5.</span><br>
<span class="lineno"></span><span class="keyword" id="4572117">func</span>&nbsp;<span class="ident" id="4572122">prf12</span><span class="op" id="4572127">(</span><span class="ident" id="4572128">result</span><span class="op" id="4572134">,</span>&nbsp;<span class="ident" id="4572136">secret</span><span class="op" id="4572142">,</span>&nbsp;<span class="ident" id="4572144">label</span><span class="op" id="4572149">,</span>&nbsp;<span class="ident" id="4572151">seed</span>&nbsp;<span class="op" id="4572156">[</span><span class="op" id="4572157">]</span><span class="builtintype" id="4572158">byte</span><span class="op" id="4572162">)</span>&nbsp;<span class="op" id="4572164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572167">labelAndSeed</span>&nbsp;<span class="op" id="4572180">:=</span>&nbsp;<span class="builtinfunc" id="4572183">make</span><span class="op" id="4572187">(</span><span class="op" id="4572188">[</span><span class="op" id="4572189">]</span><span class="builtintype" id="4572190">byte</span><span class="op" id="4572194">,</span>&nbsp;<span class="builtinfunc" id="4572196">len</span><span class="op" id="4572199">(</span><span class="ident" id="4572200"><a href="/gostd/crypto/tls/prf.go.html#4572144">label</a></span><span class="op" id="4572205">)</span><span class="op" id="4572206">+</span><span class="builtinfunc" id="4572207">len</span><span class="op" id="4572210">(</span><span class="ident" id="4572211"><a href="/gostd/crypto/tls/prf.go.html#4572151">seed</a></span><span class="op" id="4572215">)</span><span class="op" id="4572216">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4572219">copy</span><span class="op" id="4572223">(</span><span class="ident" id="4572224"><a href="/gostd/crypto/tls/prf.go.html#4572167">labelAndSeed</a></span><span class="op" id="4572236">,</span>&nbsp;<span class="ident" id="4572238"><a href="/gostd/crypto/tls/prf.go.html#4572144">label</a></span><span class="op" id="4572243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4572246">copy</span><span class="op" id="4572250">(</span><span class="ident" id="4572251"><a href="/gostd/crypto/tls/prf.go.html#4572167">labelAndSeed</a></span><span class="op" id="4572263">[</span><span class="builtinfunc" id="4572264">len</span><span class="op" id="4572267">(</span><span class="ident" id="4572268"><a href="/gostd/crypto/tls/prf.go.html#4572144">label</a></span><span class="op" id="4572273">)</span><span class="op" id="4572274">:</span><span class="op" id="4572275">]</span><span class="op" id="4572276">,</span>&nbsp;<span class="ident" id="4572278"><a href="/gostd/crypto/tls/prf.go.html#4572151">seed</a></span><span class="op" id="4572282">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572286"><a href="/gostd/crypto/tls/prf.go.html#4571131">pHash</a></span><span class="op" id="4572291">(</span><span class="ident" id="4572292"><a href="/gostd/crypto/tls/prf.go.html#4572128">result</a></span><span class="op" id="4572298">,</span>&nbsp;<span class="ident" id="4572300"><a href="/gostd/crypto/tls/prf.go.html#4572136">secret</a></span><span class="op" id="4572306">,</span>&nbsp;<span class="ident" id="4572308"><a href="/gostd/crypto/tls/prf.go.html#4572167">labelAndSeed</a></span><span class="op" id="4572320">,</span>&nbsp;<span class="ident" id="4572322"><a href="/gostd/crypto/tls/prf.go.html#4570816">sha256</a></span><span class="op" id="4572328">.</span><span class="ident" id="4572329"><a href="/gostd/crypto/sha256/sha256.go.html#4759893">New</a></span><span class="op" id="4572332">)</span><br>
<span class="lineno"></span><span class="op" id="4572334">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="4572337">//&nbsp;prf30&nbsp;implements&nbsp;the&nbsp;SSL&nbsp;3.0&nbsp;pseudo-random&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4572407">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;6.</span><br>
<span class="lineno"></span><span class="keyword" id="4572480">func</span>&nbsp;<span class="ident" id="4572485">prf30</span><span class="op" id="4572490">(</span><span class="ident" id="4572491">result</span><span class="op" id="4572497">,</span>&nbsp;<span class="ident" id="4572499">secret</span><span class="op" id="4572505">,</span>&nbsp;<span class="ident" id="4572507">label</span><span class="op" id="4572512">,</span>&nbsp;<span class="ident" id="4572514">seed</span>&nbsp;<span class="op" id="4572519">[</span><span class="op" id="4572520">]</span><span class="builtintype" id="4572521">byte</span><span class="op" id="4572525">)</span>&nbsp;<span class="op" id="4572527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572530">hashSHA1</span>&nbsp;<span class="op" id="4572539">:=</span>&nbsp;<span class="ident" id="4572542"><a href="/gostd/crypto/tls/prf.go.html#4570801">sha1</a></span><span class="op" id="4572546">.</span><span class="ident" id="4572547"><a href="/gostd/crypto/sha1/sha1.go.html#4609140">New</a></span><span class="op" id="4572550">(</span><span class="op" id="4572551">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572554">hashMD5</span>&nbsp;<span class="op" id="4572562">:=</span>&nbsp;<span class="ident" id="4572565"><a href="/gostd/crypto/tls/prf.go.html#4570787">md5</a></span><span class="op" id="4572568">.</span><span class="ident" id="4572569"><a href="/gostd/crypto/md5/md5.go.html#4710829">New</a></span><span class="op" id="4572572">(</span><span class="op" id="4572573">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572577">done</span>&nbsp;<span class="op" id="4572582">:=</span>&nbsp;<span class="num" id="4572585">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572588">i</span>&nbsp;<span class="op" id="4572590">:=</span>&nbsp;<span class="num" id="4572593">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4572596">//&nbsp;RFC5246&nbsp;section&nbsp;6.3&nbsp;says&nbsp;that&nbsp;the&nbsp;largest&nbsp;PRF&nbsp;output&nbsp;needed&nbsp;is&nbsp;128</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4572667">//&nbsp;bytes.&nbsp;Since&nbsp;no&nbsp;more&nbsp;ciphersuites&nbsp;will&nbsp;be&nbsp;added&nbsp;to&nbsp;SSLv3,&nbsp;this&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4572739">//&nbsp;remain&nbsp;true.&nbsp;Each&nbsp;iteration&nbsp;gives&nbsp;us&nbsp;16&nbsp;bytes&nbsp;so&nbsp;10&nbsp;iterations&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4572811">//&nbsp;be&nbsp;sufficient.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4572830">var</span>&nbsp;<span class="ident" id="4572834">b</span>&nbsp;<span class="op" id="4572836">[</span><span class="num" id="4572837">11</span><span class="op" id="4572839">]</span><span class="builtintype" id="4572840">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4572846">for</span>&nbsp;<span class="ident" id="4572850"><a href="/gostd/crypto/tls/prf.go.html#4572577">done</a></span>&nbsp;<span class="op" id="4572855">&lt;</span>&nbsp;<span class="builtinfunc" id="4572857">len</span><span class="op" id="4572860">(</span><span class="ident" id="4572861"><a href="/gostd/crypto/tls/prf.go.html#4572491">result</a></span><span class="op" id="4572867">)</span>&nbsp;<span class="op" id="4572869">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4572873">for</span>&nbsp;<span class="ident" id="4572877">j</span>&nbsp;<span class="op" id="4572879">:=</span>&nbsp;<span class="num" id="4572882">0</span><span class="op" id="4572883">;</span>&nbsp;<span class="ident" id="4572885"><a href="/gostd/crypto/tls/prf.go.html#4572877">j</a></span>&nbsp;<span class="op" id="4572887">&lt;=</span>&nbsp;<span class="ident" id="4572890"><a href="/gostd/crypto/tls/prf.go.html#4572588">i</a></span><span class="op" id="4572891">;</span>&nbsp;<span class="ident" id="4572893"><a href="/gostd/crypto/tls/prf.go.html#4572877">j</a></span><span class="op" id="4572894">++</span>&nbsp;<span class="op" id="4572897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572902"><a href="/gostd/crypto/tls/prf.go.html#4572834">b</a></span><span class="op" id="4572903">[</span><span class="ident" id="4572904"><a href="/gostd/crypto/tls/prf.go.html#4572877">j</a></span><span class="op" id="4572905">]</span>&nbsp;<span class="op" id="4572907">=</span>&nbsp;<span class="string" id="4572909">&#39;A&#39;</span>&nbsp;<span class="op" id="4572913">+</span>&nbsp;<span class="builtintype" id="4572915">byte</span><span class="op" id="4572919">(</span><span class="ident" id="4572920"><a href="/gostd/crypto/tls/prf.go.html#4572588">i</a></span><span class="op" id="4572921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4572925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572930"><a href="/gostd/crypto/tls/prf.go.html#4572530">hashSHA1</a></span><span class="op" id="4572938">.</span><span class="ident" id="4572939"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4572944">(</span><span class="op" id="4572945">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572949"><a href="/gostd/crypto/tls/prf.go.html#4572530">hashSHA1</a></span><span class="op" id="4572957">.</span><span class="ident" id="4572958"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4572963">(</span><span class="ident" id="4572964"><a href="/gostd/crypto/tls/prf.go.html#4572834">b</a></span><span class="op" id="4572965">[</span><span class="op" id="4572966">:</span><span class="ident" id="4572967"><a href="/gostd/crypto/tls/prf.go.html#4572588">i</a></span><span class="op" id="4572968">+</span><span class="num" id="4572969">1</span><span class="op" id="4572970">]</span><span class="op" id="4572971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4572975"><a href="/gostd/crypto/tls/prf.go.html#4572530">hashSHA1</a></span><span class="op" id="4572983">.</span><span class="ident" id="4572984"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4572989">(</span><span class="ident" id="4572990"><a href="/gostd/crypto/tls/prf.go.html#4572499">secret</a></span><span class="op" id="4572996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573000"><a href="/gostd/crypto/tls/prf.go.html#4572530">hashSHA1</a></span><span class="op" id="4573008">.</span><span class="ident" id="4573009"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4573014">(</span><span class="ident" id="4573015"><a href="/gostd/crypto/tls/prf.go.html#4572514">seed</a></span><span class="op" id="4573019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573023">digest</span>&nbsp;<span class="op" id="4573030">:=</span>&nbsp;<span class="ident" id="4573033"><a href="/gostd/crypto/tls/prf.go.html#4572530">hashSHA1</a></span><span class="op" id="4573041">.</span><span class="ident" id="4573042"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4573045">(</span><span class="builtintype" id="4573046">nil</span><span class="op" id="4573049">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573054"><a href="/gostd/crypto/tls/prf.go.html#4572554">hashMD5</a></span><span class="op" id="4573061">.</span><span class="ident" id="4573062"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4573067">(</span><span class="op" id="4573068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573072"><a href="/gostd/crypto/tls/prf.go.html#4572554">hashMD5</a></span><span class="op" id="4573079">.</span><span class="ident" id="4573080"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4573085">(</span><span class="ident" id="4573086"><a href="/gostd/crypto/tls/prf.go.html#4572499">secret</a></span><span class="op" id="4573092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573096"><a href="/gostd/crypto/tls/prf.go.html#4572554">hashMD5</a></span><span class="op" id="4573103">.</span><span class="ident" id="4573104"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4573109">(</span><span class="ident" id="4573110"><a href="/gostd/crypto/tls/prf.go.html#4573023">digest</a></span><span class="op" id="4573116">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573121"><a href="/gostd/crypto/tls/prf.go.html#4572577">done</a></span>&nbsp;<span class="op" id="4573126">+=</span>&nbsp;<span class="builtinfunc" id="4573129">copy</span><span class="op" id="4573133">(</span><span class="ident" id="4573134"><a href="/gostd/crypto/tls/prf.go.html#4572491">result</a></span><span class="op" id="4573140">[</span><span class="ident" id="4573141"><a href="/gostd/crypto/tls/prf.go.html#4572577">done</a></span><span class="op" id="4573145">:</span><span class="op" id="4573146">]</span><span class="op" id="4573147">,</span>&nbsp;<span class="ident" id="4573149"><a href="/gostd/crypto/tls/prf.go.html#4572554">hashMD5</a></span><span class="op" id="4573156">.</span><span class="ident" id="4573157"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4573160">(</span><span class="builtintype" id="4573161">nil</span><span class="op" id="4573164">)</span><span class="op" id="4573165">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573169"><a href="/gostd/crypto/tls/prf.go.html#4572588">i</a></span><span class="op" id="4573170">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573174">}</span><br>
<span class="lineno"></span><span class="op" id="4573176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4573179">const</span>&nbsp;<span class="op" id="4573185">(</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573188">tlsRandomLength</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573209">=</span>&nbsp;<span class="num" id="4573211">32</span>&nbsp;<span class="comment" id="4573214">//&nbsp;Length&nbsp;of&nbsp;a&nbsp;random&nbsp;nonce&nbsp;in&nbsp;TLS&nbsp;1.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573255">masterSecretLength</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4573276">=</span>&nbsp;<span class="num" id="4573278">48</span>&nbsp;<span class="comment" id="4573281">//&nbsp;Length&nbsp;of&nbsp;a&nbsp;master&nbsp;secret&nbsp;in&nbsp;TLS&nbsp;1.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4573323">finishedVerifyLength</span>&nbsp;<span class="op" id="4573344">=</span>&nbsp;<span class="num" id="4573346">12</span>&nbsp;<span class="comment" id="4573349">//&nbsp;Length&nbsp;of&nbsp;verify_data&nbsp;in&nbsp;a&nbsp;Finished&nbsp;message.</span><br>
<span class="lineno"></span><span class="op" id="4573397">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="4573400">var</span>&nbsp;<span class="ident" id="4573404">masterSecretLabel</span>&nbsp;<span class="op" id="4573422">=</span>&nbsp;<span class="op" id="4573424">[</span><span class="op" id="4573425">]</span><span class="builtintype" id="4573426">byte</span><span class="op" id="4573430">(</span><span class="string" id="4573431">&#34;master&nbsp;secret&#34;</span><span class="op" id="4573446">)</span><br>
<span class="lineno"></span><span class="keyword" id="4573448">var</span>&nbsp;<span class="ident" id="4573452">keyExpansionLabel</span>&nbsp;<span class="op" id="4573470">=</span>&nbsp;<span class="op" id="4573472">[</span><span class="op" id="4573473">]</span><span class="builtintype" id="4573474">byte</span><span class="op" id="4573478">(</span><span class="string" id="4573479">&#34;key&nbsp;expansion&#34;</span><span class="op" id="4573494">)</span><br>
<span class="lineno"></span><span class="keyword" id="4573496">var</span>&nbsp;<span class="ident" id="4573500">clientFinishedLabel</span>&nbsp;<span class="op" id="4573520">=</span>&nbsp;<span class="op" id="4573522">[</span><span class="op" id="4573523">]</span><span class="builtintype" id="4573524">byte</span><span class="op" id="4573528">(</span><span class="string" id="4573529">&#34;client&nbsp;finished&#34;</span><span class="op" id="4573546">)</span><br>
<span class="lineno"></span><span class="keyword" id="4573548">var</span>&nbsp;<span class="ident" id="4573552">serverFinishedLabel</span>&nbsp;<span class="op" id="4573572">=</span>&nbsp;<span class="op" id="4573574">[</span><span class="op" id="4573575">]</span><span class="builtintype" id="4573576">byte</span><span class="op" id="4573580">(</span><span class="string" id="4573581">&#34;server&nbsp;finished&#34;</span><span class="op" id="4573598">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="4573601">func</span>&nbsp;<span class="ident" id="4573606">prfForVersion</span><span class="op" id="4573619">(</span><span class="ident" id="4573620">version</span>&nbsp;<span class="builtintype" id="4573628">uint16</span><span class="op" id="4573634">)</span>&nbsp;<span class="keyword" id="4573636">func</span><span class="op" id="4573640">(</span><span class="ident" id="4573641">result</span><span class="op" id="4573647">,</span>&nbsp;<span class="ident" id="4573649">secret</span><span class="op" id="4573655">,</span>&nbsp;<span class="ident" id="4573657">label</span><span class="op" id="4573662">,</span>&nbsp;<span class="ident" id="4573664">seed</span>&nbsp;<span class="op" id="4573669">[</span><span class="op" id="4573670">]</span><span class="builtintype" id="4573671">byte</span><span class="op" id="4573675">)</span>&nbsp;<span class="op" id="4573677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573680">switch</span>&nbsp;<span class="ident" id="4573687"><a href="/gostd/crypto/tls/prf.go.html#4573620">version</a></span>&nbsp;<span class="op" id="4573695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573698">case</span>&nbsp;<span class="ident" id="4573703"><a href="/gostd/crypto/tls/common.go.html#4442440">VersionSSL30</a></span><span class="op" id="4573715">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573719">return</span>&nbsp;<span class="ident" id="4573726"><a href="/gostd/crypto/tls/prf.go.html#4572485">prf30</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573733">case</span>&nbsp;<span class="ident" id="4573738"><a href="/gostd/crypto/tls/common.go.html#4442463">VersionTLS10</a></span><span class="op" id="4573750">,</span>&nbsp;<span class="ident" id="4573752"><a href="/gostd/crypto/tls/common.go.html#4442486">VersionTLS11</a></span><span class="op" id="4573764">:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573768">return</span>&nbsp;<span class="ident" id="4573775"><a href="/gostd/crypto/tls/prf.go.html#4571603">prf10</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573782">case</span>&nbsp;<span class="ident" id="4573787"><a href="/gostd/crypto/tls/common.go.html#4442509">VersionTLS12</a></span><span class="op" id="4573799">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573803">return</span>&nbsp;<span class="ident" id="4573810"><a href="/gostd/crypto/tls/prf.go.html#4572122">prf12</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4573817">default</span><span class="op" id="4573824">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4573828">panic</span><span class="op" id="4573833">(</span><span class="string" id="4573834">&#34;unknown&nbsp;version&#34;</span><span class="op" id="4573851">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4573854">}</span><br>
<span class="lineno"></span><span class="op" id="4573856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4573859">//&nbsp;masterFromPreMasterSecret&nbsp;generates&nbsp;the&nbsp;master&nbsp;secret&nbsp;from&nbsp;the&nbsp;pre-master</span><br>
<span class="lineno"></span><span class="comment" id="4573936">//&nbsp;secret.&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5246#section-8.1</span><br>
<span class="lineno">135</span><span class="keyword" id="4573998">func</span>&nbsp;<span class="ident" id="4574003">masterFromPreMasterSecret</span><span class="op" id="4574028">(</span><span class="ident" id="4574029">version</span>&nbsp;<span class="builtintype" id="4574037">uint16</span><span class="op" id="4574043">,</span>&nbsp;<span class="ident" id="4574045">preMasterSecret</span><span class="op" id="4574060">,</span>&nbsp;<span class="ident" id="4574062">clientRandom</span><span class="op" id="4574074">,</span>&nbsp;<span class="ident" id="4574076">serverRandom</span>&nbsp;<span class="op" id="4574089">[</span><span class="op" id="4574090">]</span><span class="builtintype" id="4574091">byte</span><span class="op" id="4574095">)</span>&nbsp;<span class="op" id="4574097">[</span><span class="op" id="4574098">]</span><span class="builtintype" id="4574099">byte</span>&nbsp;<span class="op" id="4574104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574107">var</span>&nbsp;<span class="ident" id="4574111">seed</span>&nbsp;<span class="op" id="4574116">[</span><span class="ident" id="4574117"><a href="/gostd/crypto/tls/prf.go.html#4573188">tlsRandomLength</a></span>&nbsp;<span class="op" id="4574133">*</span>&nbsp;<span class="num" id="4574135">2</span><span class="op" id="4574136">]</span><span class="builtintype" id="4574137">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4574143">copy</span><span class="op" id="4574147">(</span><span class="ident" id="4574148"><a href="/gostd/crypto/tls/prf.go.html#4574111">seed</a></span><span class="op" id="4574152">[</span><span class="num" id="4574153">0</span><span class="op" id="4574154">:</span><span class="builtinfunc" id="4574155">len</span><span class="op" id="4574158">(</span><span class="ident" id="4574159"><a href="/gostd/crypto/tls/prf.go.html#4574062">clientRandom</a></span><span class="op" id="4574171">)</span><span class="op" id="4574172">]</span><span class="op" id="4574173">,</span>&nbsp;<span class="ident" id="4574175"><a href="/gostd/crypto/tls/prf.go.html#4574062">clientRandom</a></span><span class="op" id="4574187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4574190">copy</span><span class="op" id="4574194">(</span><span class="ident" id="4574195"><a href="/gostd/crypto/tls/prf.go.html#4574111">seed</a></span><span class="op" id="4574199">[</span><span class="builtinfunc" id="4574200">len</span><span class="op" id="4574203">(</span><span class="ident" id="4574204"><a href="/gostd/crypto/tls/prf.go.html#4574062">clientRandom</a></span><span class="op" id="4574216">)</span><span class="op" id="4574217">:</span><span class="op" id="4574218">]</span><span class="op" id="4574219">,</span>&nbsp;<span class="ident" id="4574221"><a href="/gostd/crypto/tls/prf.go.html#4574076">serverRandom</a></span><span class="op" id="4574233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574236">masterSecret</span>&nbsp;<span class="op" id="4574249">:=</span>&nbsp;<span class="builtinfunc" id="4574252">make</span><span class="op" id="4574256">(</span><span class="op" id="4574257">[</span><span class="op" id="4574258">]</span><span class="builtintype" id="4574259">byte</span><span class="op" id="4574263">,</span>&nbsp;<span class="ident" id="4574265"><a href="/gostd/crypto/tls/prf.go.html#4573255">masterSecretLength</a></span><span class="op" id="4574283">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574286"><a href="/gostd/crypto/tls/prf.go.html#4573606">prfForVersion</a></span><span class="op" id="4574299">(</span><span class="ident" id="4574300"><a href="/gostd/crypto/tls/prf.go.html#4574029">version</a></span><span class="op" id="4574307">)</span><span class="op" id="4574308">(</span><span class="ident" id="4574309"><a href="/gostd/crypto/tls/prf.go.html#4574236">masterSecret</a></span><span class="op" id="4574321">,</span>&nbsp;<span class="ident" id="4574323"><a href="/gostd/crypto/tls/prf.go.html#4574045">preMasterSecret</a></span><span class="op" id="4574338">,</span>&nbsp;<span class="ident" id="4574340"><a href="/gostd/crypto/tls/prf.go.html#4573404">masterSecretLabel</a></span><span class="op" id="4574357">,</span>&nbsp;<span class="ident" id="4574359"><a href="/gostd/crypto/tls/prf.go.html#4574111">seed</a></span><span class="op" id="4574363">[</span><span class="num" id="4574364">0</span><span class="op" id="4574365">:</span><span class="op" id="4574366">]</span><span class="op" id="4574367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574370">return</span>&nbsp;<span class="ident" id="4574377"><a href="/gostd/crypto/tls/prf.go.html#4574236">masterSecret</a></span><br>
<span class="lineno"></span><span class="op" id="4574390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4574393">//&nbsp;keysFromMasterSecret&nbsp;generates&nbsp;the&nbsp;connection&nbsp;keys&nbsp;from&nbsp;the&nbsp;master</span><br>
<span class="lineno">145</span><span class="comment" id="4574463">//&nbsp;secret,&nbsp;given&nbsp;the&nbsp;lengths&nbsp;of&nbsp;the&nbsp;MAC&nbsp;key,&nbsp;cipher&nbsp;key&nbsp;and&nbsp;IV,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4574541">//&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.3.</span><br>
<span class="lineno"></span><span class="keyword" id="4574567">func</span>&nbsp;<span class="ident" id="4574572">keysFromMasterSecret</span><span class="op" id="4574592">(</span><span class="ident" id="4574593">version</span>&nbsp;<span class="builtintype" id="4574601">uint16</span><span class="op" id="4574607">,</span>&nbsp;<span class="ident" id="4574609">masterSecret</span><span class="op" id="4574621">,</span>&nbsp;<span class="ident" id="4574623">clientRandom</span><span class="op" id="4574635">,</span>&nbsp;<span class="ident" id="4574637">serverRandom</span>&nbsp;<span class="op" id="4574650">[</span><span class="op" id="4574651">]</span><span class="builtintype" id="4574652">byte</span><span class="op" id="4574656">,</span>&nbsp;<span class="ident" id="4574658">macLen</span><span class="op" id="4574664">,</span>&nbsp;<span class="ident" id="4574666">keyLen</span><span class="op" id="4574672">,</span>&nbsp;<span class="ident" id="4574674">ivLen</span>&nbsp;<span class="builtintype" id="4574680">int</span><span class="op" id="4574683">)</span>&nbsp;<span class="op" id="4574685">(</span><span class="ident" id="4574686">clientMAC</span><span class="op" id="4574695">,</span>&nbsp;<span class="ident" id="4574697">serverMAC</span><span class="op" id="4574706">,</span>&nbsp;<span class="ident" id="4574708">clientKey</span><span class="op" id="4574717">,</span>&nbsp;<span class="ident" id="4574719">serverKey</span><span class="op" id="4574728">,</span>&nbsp;<span class="ident" id="4574730">clientIV</span><span class="op" id="4574738">,</span>&nbsp;<span class="ident" id="4574740">serverIV</span>&nbsp;<span class="op" id="4574749">[</span><span class="op" id="4574750">]</span><span class="builtintype" id="4574751">byte</span><span class="op" id="4574755">)</span>&nbsp;<span class="op" id="4574757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4574760">var</span>&nbsp;<span class="ident" id="4574764">seed</span>&nbsp;<span class="op" id="4574769">[</span><span class="ident" id="4574770"><a href="/gostd/crypto/tls/prf.go.html#4573188">tlsRandomLength</a></span>&nbsp;<span class="op" id="4574786">*</span>&nbsp;<span class="num" id="4574788">2</span><span class="op" id="4574789">]</span><span class="builtintype" id="4574790">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4574796">copy</span><span class="op" id="4574800">(</span><span class="ident" id="4574801"><a href="/gostd/crypto/tls/prf.go.html#4574764">seed</a></span><span class="op" id="4574805">[</span><span class="num" id="4574806">0</span><span class="op" id="4574807">:</span><span class="builtinfunc" id="4574808">len</span><span class="op" id="4574811">(</span><span class="ident" id="4574812"><a href="/gostd/crypto/tls/prf.go.html#4574623">clientRandom</a></span><span class="op" id="4574824">)</span><span class="op" id="4574825">]</span><span class="op" id="4574826">,</span>&nbsp;<span class="ident" id="4574828"><a href="/gostd/crypto/tls/prf.go.html#4574637">serverRandom</a></span><span class="op" id="4574840">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4574843">copy</span><span class="op" id="4574847">(</span><span class="ident" id="4574848"><a href="/gostd/crypto/tls/prf.go.html#4574764">seed</a></span><span class="op" id="4574852">[</span><span class="builtinfunc" id="4574853">len</span><span class="op" id="4574856">(</span><span class="ident" id="4574857"><a href="/gostd/crypto/tls/prf.go.html#4574637">serverRandom</a></span><span class="op" id="4574869">)</span><span class="op" id="4574870">:</span><span class="op" id="4574871">]</span><span class="op" id="4574872">,</span>&nbsp;<span class="ident" id="4574874"><a href="/gostd/crypto/tls/prf.go.html#4574623">clientRandom</a></span><span class="op" id="4574886">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574890">n</span>&nbsp;<span class="op" id="4574892">:=</span>&nbsp;<span class="num" id="4574895">2</span><span class="op" id="4574896">*</span><span class="ident" id="4574897"><a href="/gostd/crypto/tls/prf.go.html#4574658">macLen</a></span>&nbsp;<span class="op" id="4574904">+</span>&nbsp;<span class="num" id="4574906">2</span><span class="op" id="4574907">*</span><span class="ident" id="4574908"><a href="/gostd/crypto/tls/prf.go.html#4574666">keyLen</a></span>&nbsp;<span class="op" id="4574915">+</span>&nbsp;<span class="num" id="4574917">2</span><span class="op" id="4574918">*</span><span class="ident" id="4574919"><a href="/gostd/crypto/tls/prf.go.html#4574674">ivLen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574926">keyMaterial</span>&nbsp;<span class="op" id="4574938">:=</span>&nbsp;<span class="builtinfunc" id="4574941">make</span><span class="op" id="4574945">(</span><span class="op" id="4574946">[</span><span class="op" id="4574947">]</span><span class="builtintype" id="4574948">byte</span><span class="op" id="4574952">,</span>&nbsp;<span class="ident" id="4574954"><a href="/gostd/crypto/tls/prf.go.html#4574890">n</a></span><span class="op" id="4574955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4574958"><a href="/gostd/crypto/tls/prf.go.html#4573606">prfForVersion</a></span><span class="op" id="4574971">(</span><span class="ident" id="4574972"><a href="/gostd/crypto/tls/prf.go.html#4574593">version</a></span><span class="op" id="4574979">)</span><span class="op" id="4574980">(</span><span class="ident" id="4574981"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span><span class="op" id="4574992">,</span>&nbsp;<span class="ident" id="4574994"><a href="/gostd/crypto/tls/prf.go.html#4574609">masterSecret</a></span><span class="op" id="4575006">,</span>&nbsp;<span class="ident" id="4575008"><a href="/gostd/crypto/tls/prf.go.html#4573452">keyExpansionLabel</a></span><span class="op" id="4575025">,</span>&nbsp;<span class="ident" id="4575027"><a href="/gostd/crypto/tls/prf.go.html#4574764">seed</a></span><span class="op" id="4575031">[</span><span class="num" id="4575032">0</span><span class="op" id="4575033">:</span><span class="op" id="4575034">]</span><span class="op" id="4575035">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575038"><a href="/gostd/crypto/tls/prf.go.html#4574686">clientMAC</a></span>&nbsp;<span class="op" id="4575048">=</span>&nbsp;<span class="ident" id="4575050"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span><span class="op" id="4575061">[</span><span class="op" id="4575062">:</span><span class="ident" id="4575063"><a href="/gostd/crypto/tls/prf.go.html#4574658">macLen</a></span><span class="op" id="4575069">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575072"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span>&nbsp;<span class="op" id="4575084">=</span>&nbsp;<span class="ident" id="4575086"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span><span class="op" id="4575097">[</span><span class="ident" id="4575098"><a href="/gostd/crypto/tls/prf.go.html#4574658">macLen</a></span><span class="op" id="4575104">:</span><span class="op" id="4575105">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575108"><a href="/gostd/crypto/tls/prf.go.html#4574697">serverMAC</a></span>&nbsp;<span class="op" id="4575118">=</span>&nbsp;<span class="ident" id="4575120"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span><span class="op" id="4575131">[</span><span class="op" id="4575132">:</span><span class="ident" id="4575133"><a href="/gostd/crypto/tls/prf.go.html#4574658">macLen</a></span><span class="op" id="4575139">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575142"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span>&nbsp;<span class="op" id="4575154">=</span>&nbsp;<span class="ident" id="4575156"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span><span class="op" id="4575167">[</span><span class="ident" id="4575168"><a href="/gostd/crypto/tls/prf.go.html#4574658">macLen</a></span><span class="op" id="4575174">:</span><span class="op" id="4575175">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575178"><a href="/gostd/crypto/tls/prf.go.html#4574708">clientKey</a></span>&nbsp;<span class="op" id="4575188">=</span>&nbsp;<span class="ident" id="4575190"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span><span class="op" id="4575201">[</span><span class="op" id="4575202">:</span><span class="ident" id="4575203"><a href="/gostd/crypto/tls/prf.go.html#4574666">keyLen</a></span><span class="op" id="4575209">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575212"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span>&nbsp;<span class="op" id="4575224">=</span>&nbsp;<span class="ident" id="4575226"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span><span class="op" id="4575237">[</span><span class="ident" id="4575238"><a href="/gostd/crypto/tls/prf.go.html#4574666">keyLen</a></span><span class="op" id="4575244">:</span><span class="op" id="4575245">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575248"><a href="/gostd/crypto/tls/prf.go.html#4574719">serverKey</a></span>&nbsp;<span class="op" id="4575258">=</span>&nbsp;<span class="ident" id="4575260"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span><span class="op" id="4575271">[</span><span class="op" id="4575272">:</span><span class="ident" id="4575273"><a href="/gostd/crypto/tls/prf.go.html#4574666">keyLen</a></span><span class="op" id="4575279">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575282"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span>&nbsp;<span class="op" id="4575294">=</span>&nbsp;<span class="ident" id="4575296"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span><span class="op" id="4575307">[</span><span class="ident" id="4575308"><a href="/gostd/crypto/tls/prf.go.html#4574666">keyLen</a></span><span class="op" id="4575314">:</span><span class="op" id="4575315">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575318"><a href="/gostd/crypto/tls/prf.go.html#4574730">clientIV</a></span>&nbsp;<span class="op" id="4575327">=</span>&nbsp;<span class="ident" id="4575329"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span><span class="op" id="4575340">[</span><span class="op" id="4575341">:</span><span class="ident" id="4575342"><a href="/gostd/crypto/tls/prf.go.html#4574674">ivLen</a></span><span class="op" id="4575347">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575350"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span>&nbsp;<span class="op" id="4575362">=</span>&nbsp;<span class="ident" id="4575364"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span><span class="op" id="4575375">[</span><span class="ident" id="4575376"><a href="/gostd/crypto/tls/prf.go.html#4574674">ivLen</a></span><span class="op" id="4575381">:</span><span class="op" id="4575382">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575385"><a href="/gostd/crypto/tls/prf.go.html#4574740">serverIV</a></span>&nbsp;<span class="op" id="4575394">=</span>&nbsp;<span class="ident" id="4575396"><a href="/gostd/crypto/tls/prf.go.html#4574926">keyMaterial</a></span><span class="op" id="4575407">[</span><span class="op" id="4575408">:</span><span class="ident" id="4575409"><a href="/gostd/crypto/tls/prf.go.html#4574674">ivLen</a></span><span class="op" id="4575414">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575417">return</span><br>
<span class="lineno"></span><span class="op" id="4575424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4575427">func</span>&nbsp;<span class="ident" id="4575432">newFinishedHash</span><span class="op" id="4575447">(</span><span class="ident" id="4575448">version</span>&nbsp;<span class="builtintype" id="4575456">uint16</span><span class="op" id="4575462">)</span>&nbsp;<span class="ident" id="4575464"><a href="/gostd/crypto/tls/prf.go.html#4575783">finishedHash</a></span>&nbsp;<span class="op" id="4575477">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575480">if</span>&nbsp;<span class="ident" id="4575483"><a href="/gostd/crypto/tls/prf.go.html#4575448">version</a></span>&nbsp;<span class="op" id="4575491">&gt;=</span>&nbsp;<span class="ident" id="4575494"><a href="/gostd/crypto/tls/common.go.html#4442509">VersionTLS12</a></span>&nbsp;<span class="op" id="4575507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575511">return</span>&nbsp;<span class="ident" id="4575518"><a href="/gostd/crypto/tls/prf.go.html#4575783">finishedHash</a></span><span class="op" id="4575530">{</span><span class="ident" id="4575531"><a href="/gostd/crypto/tls/prf.go.html#4570816">sha256</a></span><span class="op" id="4575537">.</span><span class="ident" id="4575538"><a href="/gostd/crypto/sha256/sha256.go.html#4759893">New</a></span><span class="op" id="4575541">(</span><span class="op" id="4575542">)</span><span class="op" id="4575543">,</span>&nbsp;<span class="ident" id="4575545"><a href="/gostd/crypto/tls/prf.go.html#4570816">sha256</a></span><span class="op" id="4575551">.</span><span class="ident" id="4575552"><a href="/gostd/crypto/sha256/sha256.go.html#4759893">New</a></span><span class="op" id="4575555">(</span><span class="op" id="4575556">)</span><span class="op" id="4575557">,</span>&nbsp;<span class="builtintype" id="4575559">nil</span><span class="op" id="4575562">,</span>&nbsp;<span class="builtintype" id="4575564">nil</span><span class="op" id="4575567">,</span>&nbsp;<span class="ident" id="4575569"><a href="/gostd/crypto/tls/prf.go.html#4575448">version</a></span><span class="op" id="4575576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4575579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4575582">return</span>&nbsp;<span class="ident" id="4575589"><a href="/gostd/crypto/tls/prf.go.html#4575783">finishedHash</a></span><span class="op" id="4575601">{</span><span class="ident" id="4575602"><a href="/gostd/crypto/tls/prf.go.html#4570801">sha1</a></span><span class="op" id="4575606">.</span><span class="ident" id="4575607"><a href="/gostd/crypto/sha1/sha1.go.html#4609140">New</a></span><span class="op" id="4575610">(</span><span class="op" id="4575611">)</span><span class="op" id="4575612">,</span>&nbsp;<span class="ident" id="4575614"><a href="/gostd/crypto/tls/prf.go.html#4570801">sha1</a></span><span class="op" id="4575618">.</span><span class="ident" id="4575619"><a href="/gostd/crypto/sha1/sha1.go.html#4609140">New</a></span><span class="op" id="4575622">(</span><span class="op" id="4575623">)</span><span class="op" id="4575624">,</span>&nbsp;<span class="ident" id="4575626"><a href="/gostd/crypto/tls/prf.go.html#4570787">md5</a></span><span class="op" id="4575629">.</span><span class="ident" id="4575630"><a href="/gostd/crypto/md5/md5.go.html#4710829">New</a></span><span class="op" id="4575633">(</span><span class="op" id="4575634">)</span><span class="op" id="4575635">,</span>&nbsp;<span class="ident" id="4575637"><a href="/gostd/crypto/tls/prf.go.html#4570787">md5</a></span><span class="op" id="4575640">.</span><span class="ident" id="4575641"><a href="/gostd/crypto/md5/md5.go.html#4710829">New</a></span><span class="op" id="4575644">(</span><span class="op" id="4575645">)</span><span class="op" id="4575646">,</span>&nbsp;<span class="ident" id="4575648"><a href="/gostd/crypto/tls/prf.go.html#4575448">version</a></span><span class="op" id="4575655">}</span><br>
<span class="lineno"></span><span class="op" id="4575657">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4575660">//&nbsp;A&nbsp;finishedHash&nbsp;calculates&nbsp;the&nbsp;hash&nbsp;of&nbsp;a&nbsp;set&nbsp;of&nbsp;handshake&nbsp;messages&nbsp;suitable</span><br>
<span class="lineno"></span><span class="comment" id="4575738">//&nbsp;for&nbsp;including&nbsp;in&nbsp;a&nbsp;Finished&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="4575778">type</span>&nbsp;<span class="ident" id="4575783">finishedHash</span>&nbsp;<span class="keyword" id="4575796">struct</span>&nbsp;<span class="op" id="4575803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575806">client</span>&nbsp;<span class="ident" id="4575813"><a href="/gostd/crypto/tls/prf.go.html#4570833">hash</a></span><span class="op" id="4575817">.</span><span class="ident" id="4575818"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575824">server</span>&nbsp;<span class="ident" id="4575831"><a href="/gostd/crypto/tls/prf.go.html#4570833">hash</a></span><span class="op" id="4575835">.</span><span class="ident" id="4575836"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4575843">//&nbsp;Prior&nbsp;to&nbsp;TLS&nbsp;1.2,&nbsp;an&nbsp;additional&nbsp;MD5&nbsp;hash&nbsp;is&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575901">clientMD5</span>&nbsp;<span class="ident" id="4575911"><a href="/gostd/crypto/tls/prf.go.html#4570833">hash</a></span><span class="op" id="4575915">.</span><span class="ident" id="4575916"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575922">serverMD5</span>&nbsp;<span class="ident" id="4575932"><a href="/gostd/crypto/tls/prf.go.html#4570833">hash</a></span><span class="op" id="4575936">.</span><span class="ident" id="4575937"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4575944">version</span>&nbsp;<span class="builtintype" id="4575952">uint16</span><br>
<span class="lineno"></span><span class="op" id="4575959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4575962">func</span>&nbsp;<span class="op" id="4575967">(</span><span class="ident" id="4575968">h</span>&nbsp;<span class="ident" id="4575970"><a href="/gostd/crypto/tls/prf.go.html#4575783">finishedHash</a></span><span class="op" id="4575982">)</span>&nbsp;<span class="ident" id="4575984">Write</span><span class="op" id="4575989">(</span><span class="ident" id="4575990">msg</span>&nbsp;<span class="op" id="4575994">[</span><span class="op" id="4575995">]</span><span class="builtintype" id="4575996">byte</span><span class="op" id="4576000">)</span>&nbsp;<span class="op" id="4576002">(</span><span class="ident" id="4576003">n</span>&nbsp;<span class="builtintype" id="4576005">int</span><span class="op" id="4576008">,</span>&nbsp;<span class="ident" id="4576010">err</span>&nbsp;<span class="builtintype" id="4576014">error</span><span class="op" id="4576019">)</span>&nbsp;<span class="op" id="4576021">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576024"><a href="/gostd/crypto/tls/prf.go.html#4575968">h</a></span><span class="op" id="4576025">.</span><span class="ident" id="4576026"><a href="/gostd/crypto/tls/prf.go.html#4575806">client</a></span><span class="op" id="4576032">.</span><span class="ident" id="4576033"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576038">(</span><span class="ident" id="4576039"><a href="/gostd/crypto/tls/prf.go.html#4575990">msg</a></span><span class="op" id="4576042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576045"><a href="/gostd/crypto/tls/prf.go.html#4575968">h</a></span><span class="op" id="4576046">.</span><span class="ident" id="4576047"><a href="/gostd/crypto/tls/prf.go.html#4575824">server</a></span><span class="op" id="4576053">.</span><span class="ident" id="4576054"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576059">(</span><span class="ident" id="4576060"><a href="/gostd/crypto/tls/prf.go.html#4575990">msg</a></span><span class="op" id="4576063">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576067">if</span>&nbsp;<span class="ident" id="4576070"><a href="/gostd/crypto/tls/prf.go.html#4575968">h</a></span><span class="op" id="4576071">.</span><span class="ident" id="4576072"><a href="/gostd/crypto/tls/prf.go.html#4575944">version</a></span>&nbsp;<span class="op" id="4576080">&lt;</span>&nbsp;<span class="ident" id="4576082"><a href="/gostd/crypto/tls/common.go.html#4442509">VersionTLS12</a></span>&nbsp;<span class="op" id="4576095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576099"><a href="/gostd/crypto/tls/prf.go.html#4575968">h</a></span><span class="op" id="4576100">.</span><span class="ident" id="4576101"><a href="/gostd/crypto/tls/prf.go.html#4575901">clientMD5</a></span><span class="op" id="4576110">.</span><span class="ident" id="4576111"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576116">(</span><span class="ident" id="4576117"><a href="/gostd/crypto/tls/prf.go.html#4575990">msg</a></span><span class="op" id="4576120">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576124"><a href="/gostd/crypto/tls/prf.go.html#4575968">h</a></span><span class="op" id="4576125">.</span><span class="ident" id="4576126"><a href="/gostd/crypto/tls/prf.go.html#4575922">serverMD5</a></span><span class="op" id="4576135">.</span><span class="ident" id="4576136"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576141">(</span><span class="ident" id="4576142"><a href="/gostd/crypto/tls/prf.go.html#4575990">msg</a></span><span class="op" id="4576145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4576148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576151">return</span>&nbsp;<span class="builtinfunc" id="4576158">len</span><span class="op" id="4576161">(</span><span class="ident" id="4576162"><a href="/gostd/crypto/tls/prf.go.html#4575990">msg</a></span><span class="op" id="4576165">)</span><span class="op" id="4576166">,</span>&nbsp;<span class="builtintype" id="4576168">nil</span><br>
<span class="lineno"></span><span class="op" id="4576172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="4576175">//&nbsp;finishedSum30&nbsp;calculates&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;verify_data&nbsp;member&nbsp;of&nbsp;a&nbsp;SSLv3</span><br>
<span class="lineno"></span><span class="comment" id="4576253">//&nbsp;Finished&nbsp;message&nbsp;given&nbsp;the&nbsp;MD5&nbsp;and&nbsp;SHA1&nbsp;hashes&nbsp;of&nbsp;a&nbsp;set&nbsp;of&nbsp;handshake</span><br>
<span class="lineno"></span><span class="comment" id="4576325">//&nbsp;messages.</span><br>
<span class="lineno"></span><span class="keyword" id="4576338">func</span>&nbsp;<span class="ident" id="4576343">finishedSum30</span><span class="op" id="4576356">(</span><span class="ident" id="4576357">md5</span><span class="op" id="4576360">,</span>&nbsp;<span class="ident" id="4576362">sha1</span>&nbsp;<span class="ident" id="4576367"><a href="/gostd/crypto/tls/prf.go.html#4570833">hash</a></span><span class="op" id="4576371">.</span><span class="ident" id="4576372"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><span class="op" id="4576376">,</span>&nbsp;<span class="ident" id="4576378">masterSecret</span>&nbsp;<span class="op" id="4576391">[</span><span class="op" id="4576392">]</span><span class="builtintype" id="4576393">byte</span><span class="op" id="4576397">,</span>&nbsp;<span class="ident" id="4576399">magic</span>&nbsp;<span class="op" id="4576405">[</span><span class="num" id="4576406">4</span><span class="op" id="4576407">]</span><span class="builtintype" id="4576408">byte</span><span class="op" id="4576412">)</span>&nbsp;<span class="op" id="4576414">[</span><span class="op" id="4576415">]</span><span class="builtintype" id="4576416">byte</span>&nbsp;<span class="op" id="4576421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576424"><a href="/gostd/crypto/tls/prf.go.html#4576357">md5</a></span><span class="op" id="4576427">.</span><span class="ident" id="4576428"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576433">(</span><span class="ident" id="4576434"><a href="/gostd/crypto/tls/prf.go.html#4576399">magic</a></span><span class="op" id="4576439">[</span><span class="op" id="4576440">:</span><span class="op" id="4576441">]</span><span class="op" id="4576442">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576445"><a href="/gostd/crypto/tls/prf.go.html#4576357">md5</a></span><span class="op" id="4576448">.</span><span class="ident" id="4576449"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576454">(</span><span class="ident" id="4576455"><a href="/gostd/crypto/tls/prf.go.html#4576378">masterSecret</a></span><span class="op" id="4576467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576470"><a href="/gostd/crypto/tls/prf.go.html#4576357">md5</a></span><span class="op" id="4576473">.</span><span class="ident" id="4576474"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576479">(</span><span class="ident" id="4576480"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438961">ssl30Pad1</a></span><span class="op" id="4576489">[</span><span class="op" id="4576490">:</span><span class="op" id="4576491">]</span><span class="op" id="4576492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576495">md5Digest</span>&nbsp;<span class="op" id="4576505">:=</span>&nbsp;<span class="ident" id="4576508"><a href="/gostd/crypto/tls/prf.go.html#4576357">md5</a></span><span class="op" id="4576511">.</span><span class="ident" id="4576512"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4576515">(</span><span class="builtintype" id="4576516">nil</span><span class="op" id="4576519">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576523"><a href="/gostd/crypto/tls/prf.go.html#4576357">md5</a></span><span class="op" id="4576526">.</span><span class="ident" id="4576527"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4576532">(</span><span class="op" id="4576533">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576536"><a href="/gostd/crypto/tls/prf.go.html#4576357">md5</a></span><span class="op" id="4576539">.</span><span class="ident" id="4576540"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576545">(</span><span class="ident" id="4576546"><a href="/gostd/crypto/tls/prf.go.html#4576378">masterSecret</a></span><span class="op" id="4576558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576561"><a href="/gostd/crypto/tls/prf.go.html#4576357">md5</a></span><span class="op" id="4576564">.</span><span class="ident" id="4576565"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576570">(</span><span class="ident" id="4576571"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439275">ssl30Pad2</a></span><span class="op" id="4576580">[</span><span class="op" id="4576581">:</span><span class="op" id="4576582">]</span><span class="op" id="4576583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576586"><a href="/gostd/crypto/tls/prf.go.html#4576357">md5</a></span><span class="op" id="4576589">.</span><span class="ident" id="4576590"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576595">(</span><span class="ident" id="4576596"><a href="/gostd/crypto/tls/prf.go.html#4576495">md5Digest</a></span><span class="op" id="4576605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576608"><a href="/gostd/crypto/tls/prf.go.html#4576495">md5Digest</a></span>&nbsp;<span class="op" id="4576618">=</span>&nbsp;<span class="ident" id="4576620"><a href="/gostd/crypto/tls/prf.go.html#4576357">md5</a></span><span class="op" id="4576623">.</span><span class="ident" id="4576624"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4576627">(</span><span class="builtintype" id="4576628">nil</span><span class="op" id="4576631">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576635"><a href="/gostd/crypto/tls/prf.go.html#4576362">sha1</a></span><span class="op" id="4576639">.</span><span class="ident" id="4576640"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576645">(</span><span class="ident" id="4576646"><a href="/gostd/crypto/tls/prf.go.html#4576399">magic</a></span><span class="op" id="4576651">[</span><span class="op" id="4576652">:</span><span class="op" id="4576653">]</span><span class="op" id="4576654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576657"><a href="/gostd/crypto/tls/prf.go.html#4576362">sha1</a></span><span class="op" id="4576661">.</span><span class="ident" id="4576662"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576667">(</span><span class="ident" id="4576668"><a href="/gostd/crypto/tls/prf.go.html#4576378">masterSecret</a></span><span class="op" id="4576680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576683"><a href="/gostd/crypto/tls/prf.go.html#4576362">sha1</a></span><span class="op" id="4576687">.</span><span class="ident" id="4576688"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576693">(</span><span class="ident" id="4576694"><a href="/gostd/crypto/tls/cipher_suites.go.html#4438961">ssl30Pad1</a></span><span class="op" id="4576703">[</span><span class="op" id="4576704">:</span><span class="num" id="4576705">40</span><span class="op" id="4576707">]</span><span class="op" id="4576708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576711">sha1Digest</span>&nbsp;<span class="op" id="4576722">:=</span>&nbsp;<span class="ident" id="4576725"><a href="/gostd/crypto/tls/prf.go.html#4576362">sha1</a></span><span class="op" id="4576729">.</span><span class="ident" id="4576730"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4576733">(</span><span class="builtintype" id="4576734">nil</span><span class="op" id="4576737">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576741"><a href="/gostd/crypto/tls/prf.go.html#4576362">sha1</a></span><span class="op" id="4576745">.</span><span class="ident" id="4576746"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="4576751">(</span><span class="op" id="4576752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576755"><a href="/gostd/crypto/tls/prf.go.html#4576362">sha1</a></span><span class="op" id="4576759">.</span><span class="ident" id="4576760"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576765">(</span><span class="ident" id="4576766"><a href="/gostd/crypto/tls/prf.go.html#4576378">masterSecret</a></span><span class="op" id="4576778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576781"><a href="/gostd/crypto/tls/prf.go.html#4576362">sha1</a></span><span class="op" id="4576785">.</span><span class="ident" id="4576786"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576791">(</span><span class="ident" id="4576792"><a href="/gostd/crypto/tls/cipher_suites.go.html#4439275">ssl30Pad2</a></span><span class="op" id="4576801">[</span><span class="op" id="4576802">:</span><span class="num" id="4576803">40</span><span class="op" id="4576805">]</span><span class="op" id="4576806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576809"><a href="/gostd/crypto/tls/prf.go.html#4576362">sha1</a></span><span class="op" id="4576813">.</span><span class="ident" id="4576814"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4576819">(</span><span class="ident" id="4576820"><a href="/gostd/crypto/tls/prf.go.html#4576711">sha1Digest</a></span><span class="op" id="4576830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576833"><a href="/gostd/crypto/tls/prf.go.html#4576711">sha1Digest</a></span>&nbsp;<span class="op" id="4576844">=</span>&nbsp;<span class="ident" id="4576846"><a href="/gostd/crypto/tls/prf.go.html#4576362">sha1</a></span><span class="op" id="4576850">.</span><span class="ident" id="4576851"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4576854">(</span><span class="builtintype" id="4576855">nil</span><span class="op" id="4576858">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4576862">ret</span>&nbsp;<span class="op" id="4576866">:=</span>&nbsp;<span class="builtinfunc" id="4576869">make</span><span class="op" id="4576873">(</span><span class="op" id="4576874">[</span><span class="op" id="4576875">]</span><span class="builtintype" id="4576876">byte</span><span class="op" id="4576880">,</span>&nbsp;<span class="builtinfunc" id="4576882">len</span><span class="op" id="4576885">(</span><span class="ident" id="4576886"><a href="/gostd/crypto/tls/prf.go.html#4576495">md5Digest</a></span><span class="op" id="4576895">)</span><span class="op" id="4576896">+</span><span class="builtinfunc" id="4576897">len</span><span class="op" id="4576900">(</span><span class="ident" id="4576901"><a href="/gostd/crypto/tls/prf.go.html#4576711">sha1Digest</a></span><span class="op" id="4576911">)</span><span class="op" id="4576912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4576915">copy</span><span class="op" id="4576919">(</span><span class="ident" id="4576920"><a href="/gostd/crypto/tls/prf.go.html#4576862">ret</a></span><span class="op" id="4576923">,</span>&nbsp;<span class="ident" id="4576925"><a href="/gostd/crypto/tls/prf.go.html#4576495">md5Digest</a></span><span class="op" id="4576934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4576937">copy</span><span class="op" id="4576941">(</span><span class="ident" id="4576942"><a href="/gostd/crypto/tls/prf.go.html#4576862">ret</a></span><span class="op" id="4576945">[</span><span class="builtinfunc" id="4576946">len</span><span class="op" id="4576949">(</span><span class="ident" id="4576950"><a href="/gostd/crypto/tls/prf.go.html#4576495">md5Digest</a></span><span class="op" id="4576959">)</span><span class="op" id="4576960">:</span><span class="op" id="4576961">]</span><span class="op" id="4576962">,</span>&nbsp;<span class="ident" id="4576964"><a href="/gostd/crypto/tls/prf.go.html#4576711">sha1Digest</a></span><span class="op" id="4576974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4576977">return</span>&nbsp;<span class="ident" id="4576984"><a href="/gostd/crypto/tls/prf.go.html#4576862">ret</a></span><br>
<span class="lineno">230</span><span class="op" id="4576988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4576991">var</span>&nbsp;<span class="ident" id="4576995">ssl3ClientFinishedMagic</span>&nbsp;<span class="op" id="4577019">=</span>&nbsp;<span class="op" id="4577021">[</span><span class="num" id="4577022">4</span><span class="op" id="4577023">]</span><span class="builtintype" id="4577024">byte</span><span class="op" id="4577028">{</span><span class="num" id="4577029">0x43</span><span class="op" id="4577033">,</span>&nbsp;<span class="num" id="4577035">0x4c</span><span class="op" id="4577039">,</span>&nbsp;<span class="num" id="4577041">0x4e</span><span class="op" id="4577045">,</span>&nbsp;<span class="num" id="4577047">0x54</span><span class="op" id="4577051">}</span><br>
<span class="lineno"></span><span class="keyword" id="4577053">var</span>&nbsp;<span class="ident" id="4577057">ssl3ServerFinishedMagic</span>&nbsp;<span class="op" id="4577081">=</span>&nbsp;<span class="op" id="4577083">[</span><span class="num" id="4577084">4</span><span class="op" id="4577085">]</span><span class="builtintype" id="4577086">byte</span><span class="op" id="4577090">{</span><span class="num" id="4577091">0x53</span><span class="op" id="4577095">,</span>&nbsp;<span class="num" id="4577097">0x52</span><span class="op" id="4577101">,</span>&nbsp;<span class="num" id="4577103">0x56</span><span class="op" id="4577107">,</span>&nbsp;<span class="num" id="4577109">0x52</span><span class="op" id="4577113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="4577116">//&nbsp;clientSum&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;verify_data&nbsp;member&nbsp;of&nbsp;a&nbsp;client&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4577190">//&nbsp;Finished&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="4577211">func</span>&nbsp;<span class="op" id="4577216">(</span><span class="ident" id="4577217">h</span>&nbsp;<span class="ident" id="4577219"><a href="/gostd/crypto/tls/prf.go.html#4575783">finishedHash</a></span><span class="op" id="4577231">)</span>&nbsp;<span class="ident" id="4577233">clientSum</span><span class="op" id="4577242">(</span><span class="ident" id="4577243">masterSecret</span>&nbsp;<span class="op" id="4577256">[</span><span class="op" id="4577257">]</span><span class="builtintype" id="4577258">byte</span><span class="op" id="4577262">)</span>&nbsp;<span class="op" id="4577264">[</span><span class="op" id="4577265">]</span><span class="builtintype" id="4577266">byte</span>&nbsp;<span class="op" id="4577271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577274">if</span>&nbsp;<span class="ident" id="4577277"><a href="/gostd/crypto/tls/prf.go.html#4577217">h</a></span><span class="op" id="4577278">.</span><span class="ident" id="4577279"><a href="/gostd/crypto/tls/prf.go.html#4575944">version</a></span>&nbsp;<span class="op" id="4577287">==</span>&nbsp;<span class="ident" id="4577290"><a href="/gostd/crypto/tls/common.go.html#4442440">VersionSSL30</a></span>&nbsp;<span class="op" id="4577303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577307">return</span>&nbsp;<span class="ident" id="4577314"><a href="/gostd/crypto/tls/prf.go.html#4576343">finishedSum30</a></span><span class="op" id="4577327">(</span><span class="ident" id="4577328"><a href="/gostd/crypto/tls/prf.go.html#4577217">h</a></span><span class="op" id="4577329">.</span><span class="ident" id="4577330"><a href="/gostd/crypto/tls/prf.go.html#4575901">clientMD5</a></span><span class="op" id="4577339">,</span>&nbsp;<span class="ident" id="4577341"><a href="/gostd/crypto/tls/prf.go.html#4577217">h</a></span><span class="op" id="4577342">.</span><span class="ident" id="4577343"><a href="/gostd/crypto/tls/prf.go.html#4575806">client</a></span><span class="op" id="4577349">,</span>&nbsp;<span class="ident" id="4577351"><a href="/gostd/crypto/tls/prf.go.html#4577243">masterSecret</a></span><span class="op" id="4577363">,</span>&nbsp;<span class="ident" id="4577365"><a href="/gostd/crypto/tls/prf.go.html#4576995">ssl3ClientFinishedMagic</a></span><span class="op" id="4577388">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577395">out</span>&nbsp;<span class="op" id="4577399">:=</span>&nbsp;<span class="builtinfunc" id="4577402">make</span><span class="op" id="4577406">(</span><span class="op" id="4577407">[</span><span class="op" id="4577408">]</span><span class="builtintype" id="4577409">byte</span><span class="op" id="4577413">,</span>&nbsp;<span class="ident" id="4577415"><a href="/gostd/crypto/tls/prf.go.html#4573323">finishedVerifyLength</a></span><span class="op" id="4577435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577438">if</span>&nbsp;<span class="ident" id="4577441"><a href="/gostd/crypto/tls/prf.go.html#4577217">h</a></span><span class="op" id="4577442">.</span><span class="ident" id="4577443"><a href="/gostd/crypto/tls/prf.go.html#4575944">version</a></span>&nbsp;<span class="op" id="4577451">&gt;=</span>&nbsp;<span class="ident" id="4577454"><a href="/gostd/crypto/tls/common.go.html#4442509">VersionTLS12</a></span>&nbsp;<span class="op" id="4577467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577471">seed</span>&nbsp;<span class="op" id="4577476">:=</span>&nbsp;<span class="ident" id="4577479"><a href="/gostd/crypto/tls/prf.go.html#4577217">h</a></span><span class="op" id="4577480">.</span><span class="ident" id="4577481"><a href="/gostd/crypto/tls/prf.go.html#4575806">client</a></span><span class="op" id="4577487">.</span><span class="ident" id="4577488"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4577491">(</span><span class="builtintype" id="4577492">nil</span><span class="op" id="4577495">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577499"><a href="/gostd/crypto/tls/prf.go.html#4572122">prf12</a></span><span class="op" id="4577504">(</span><span class="ident" id="4577505"><a href="/gostd/crypto/tls/prf.go.html#4577395">out</a></span><span class="op" id="4577508">,</span>&nbsp;<span class="ident" id="4577510"><a href="/gostd/crypto/tls/prf.go.html#4577243">masterSecret</a></span><span class="op" id="4577522">,</span>&nbsp;<span class="ident" id="4577524"><a href="/gostd/crypto/tls/prf.go.html#4573500">clientFinishedLabel</a></span><span class="op" id="4577543">,</span>&nbsp;<span class="ident" id="4577545"><a href="/gostd/crypto/tls/prf.go.html#4577471">seed</a></span><span class="op" id="4577549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577552">}</span>&nbsp;<span class="keyword" id="4577554">else</span>&nbsp;<span class="op" id="4577559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577563">seed</span>&nbsp;<span class="op" id="4577568">:=</span>&nbsp;<span class="builtinfunc" id="4577571">make</span><span class="op" id="4577575">(</span><span class="op" id="4577576">[</span><span class="op" id="4577577">]</span><span class="builtintype" id="4577578">byte</span><span class="op" id="4577582">,</span>&nbsp;<span class="num" id="4577584">0</span><span class="op" id="4577585">,</span>&nbsp;<span class="ident" id="4577587"><a href="/gostd/crypto/tls/prf.go.html#4570787">md5</a></span><span class="op" id="4577590">.</span><span class="ident" id="4577591"><a href="/gostd/crypto/md5/md5.go.html#4710344">Size</a></span><span class="op" id="4577595">+</span><span class="ident" id="4577596"><a href="/gostd/crypto/tls/prf.go.html#4570801">sha1</a></span><span class="op" id="4577600">.</span><span class="ident" id="4577601"><a href="/gostd/crypto/sha1/sha1.go.html#4608617">Size</a></span><span class="op" id="4577605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577609"><a href="/gostd/crypto/tls/prf.go.html#4577563">seed</a></span>&nbsp;<span class="op" id="4577614">=</span>&nbsp;<span class="ident" id="4577616"><a href="/gostd/crypto/tls/prf.go.html#4577217">h</a></span><span class="op" id="4577617">.</span><span class="ident" id="4577618"><a href="/gostd/crypto/tls/prf.go.html#4575901">clientMD5</a></span><span class="op" id="4577627">.</span><span class="ident" id="4577628"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4577631">(</span><span class="ident" id="4577632"><a href="/gostd/crypto/tls/prf.go.html#4577563">seed</a></span><span class="op" id="4577636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577640"><a href="/gostd/crypto/tls/prf.go.html#4577563">seed</a></span>&nbsp;<span class="op" id="4577645">=</span>&nbsp;<span class="ident" id="4577647"><a href="/gostd/crypto/tls/prf.go.html#4577217">h</a></span><span class="op" id="4577648">.</span><span class="ident" id="4577649"><a href="/gostd/crypto/tls/prf.go.html#4575806">client</a></span><span class="op" id="4577655">.</span><span class="ident" id="4577656"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4577659">(</span><span class="ident" id="4577660"><a href="/gostd/crypto/tls/prf.go.html#4577563">seed</a></span><span class="op" id="4577664">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4577668"><a href="/gostd/crypto/tls/prf.go.html#4571603">prf10</a></span><span class="op" id="4577673">(</span><span class="ident" id="4577674"><a href="/gostd/crypto/tls/prf.go.html#4577395">out</a></span><span class="op" id="4577677">,</span>&nbsp;<span class="ident" id="4577679"><a href="/gostd/crypto/tls/prf.go.html#4577243">masterSecret</a></span><span class="op" id="4577691">,</span>&nbsp;<span class="ident" id="4577693"><a href="/gostd/crypto/tls/prf.go.html#4573500">clientFinishedLabel</a></span><span class="op" id="4577712">,</span>&nbsp;<span class="ident" id="4577714"><a href="/gostd/crypto/tls/prf.go.html#4577563">seed</a></span><span class="op" id="4577718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4577721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577724">return</span>&nbsp;<span class="ident" id="4577731"><a href="/gostd/crypto/tls/prf.go.html#4577395">out</a></span><br>
<span class="lineno"></span><span class="op" id="4577735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="4577738">//&nbsp;serverSum&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;verify_data&nbsp;member&nbsp;of&nbsp;a&nbsp;server&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4577812">//&nbsp;Finished&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="4577833">func</span>&nbsp;<span class="op" id="4577838">(</span><span class="ident" id="4577839">h</span>&nbsp;<span class="ident" id="4577841"><a href="/gostd/crypto/tls/prf.go.html#4575783">finishedHash</a></span><span class="op" id="4577853">)</span>&nbsp;<span class="ident" id="4577855">serverSum</span><span class="op" id="4577864">(</span><span class="ident" id="4577865">masterSecret</span>&nbsp;<span class="op" id="4577878">[</span><span class="op" id="4577879">]</span><span class="builtintype" id="4577880">byte</span><span class="op" id="4577884">)</span>&nbsp;<span class="op" id="4577886">[</span><span class="op" id="4577887">]</span><span class="builtintype" id="4577888">byte</span>&nbsp;<span class="op" id="4577893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577896">if</span>&nbsp;<span class="ident" id="4577899"><a href="/gostd/crypto/tls/prf.go.html#4577839">h</a></span><span class="op" id="4577900">.</span><span class="ident" id="4577901"><a href="/gostd/crypto/tls/prf.go.html#4575944">version</a></span>&nbsp;<span class="op" id="4577909">==</span>&nbsp;<span class="ident" id="4577912"><a href="/gostd/crypto/tls/common.go.html#4442440">VersionSSL30</a></span>&nbsp;<span class="op" id="4577925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4577929">return</span>&nbsp;<span class="ident" id="4577936"><a href="/gostd/crypto/tls/prf.go.html#4576343">finishedSum30</a></span><span class="op" id="4577949">(</span><span class="ident" id="4577950"><a href="/gostd/crypto/tls/prf.go.html#4577839">h</a></span><span class="op" id="4577951">.</span><span class="ident" id="4577952"><a href="/gostd/crypto/tls/prf.go.html#4575922">serverMD5</a></span><span class="op" id="4577961">,</span>&nbsp;<span class="ident" id="4577963"><a href="/gostd/crypto/tls/prf.go.html#4577839">h</a></span><span class="op" id="4577964">.</span><span class="ident" id="4577965"><a href="/gostd/crypto/tls/prf.go.html#4575824">server</a></span><span class="op" id="4577971">,</span>&nbsp;<span class="ident" id="4577973"><a href="/gostd/crypto/tls/prf.go.html#4577865">masterSecret</a></span><span class="op" id="4577985">,</span>&nbsp;<span class="ident" id="4577987"><a href="/gostd/crypto/tls/prf.go.html#4577057">ssl3ServerFinishedMagic</a></span><span class="op" id="4578010">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4578013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578017">out</span>&nbsp;<span class="op" id="4578021">:=</span>&nbsp;<span class="builtinfunc" id="4578024">make</span><span class="op" id="4578028">(</span><span class="op" id="4578029">[</span><span class="op" id="4578030">]</span><span class="builtintype" id="4578031">byte</span><span class="op" id="4578035">,</span>&nbsp;<span class="ident" id="4578037"><a href="/gostd/crypto/tls/prf.go.html#4573323">finishedVerifyLength</a></span><span class="op" id="4578057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578060">if</span>&nbsp;<span class="ident" id="4578063"><a href="/gostd/crypto/tls/prf.go.html#4577839">h</a></span><span class="op" id="4578064">.</span><span class="ident" id="4578065"><a href="/gostd/crypto/tls/prf.go.html#4575944">version</a></span>&nbsp;<span class="op" id="4578073">&gt;=</span>&nbsp;<span class="ident" id="4578076"><a href="/gostd/crypto/tls/common.go.html#4442509">VersionTLS12</a></span>&nbsp;<span class="op" id="4578089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578093">seed</span>&nbsp;<span class="op" id="4578098">:=</span>&nbsp;<span class="ident" id="4578101"><a href="/gostd/crypto/tls/prf.go.html#4577839">h</a></span><span class="op" id="4578102">.</span><span class="ident" id="4578103"><a href="/gostd/crypto/tls/prf.go.html#4575824">server</a></span><span class="op" id="4578109">.</span><span class="ident" id="4578110"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4578113">(</span><span class="builtintype" id="4578114">nil</span><span class="op" id="4578117">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578121"><a href="/gostd/crypto/tls/prf.go.html#4572122">prf12</a></span><span class="op" id="4578126">(</span><span class="ident" id="4578127"><a href="/gostd/crypto/tls/prf.go.html#4578017">out</a></span><span class="op" id="4578130">,</span>&nbsp;<span class="ident" id="4578132"><a href="/gostd/crypto/tls/prf.go.html#4577865">masterSecret</a></span><span class="op" id="4578144">,</span>&nbsp;<span class="ident" id="4578146"><a href="/gostd/crypto/tls/prf.go.html#4573552">serverFinishedLabel</a></span><span class="op" id="4578165">,</span>&nbsp;<span class="ident" id="4578167"><a href="/gostd/crypto/tls/prf.go.html#4578093">seed</a></span><span class="op" id="4578171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4578174">}</span>&nbsp;<span class="keyword" id="4578176">else</span>&nbsp;<span class="op" id="4578181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578185">seed</span>&nbsp;<span class="op" id="4578190">:=</span>&nbsp;<span class="builtinfunc" id="4578193">make</span><span class="op" id="4578197">(</span><span class="op" id="4578198">[</span><span class="op" id="4578199">]</span><span class="builtintype" id="4578200">byte</span><span class="op" id="4578204">,</span>&nbsp;<span class="num" id="4578206">0</span><span class="op" id="4578207">,</span>&nbsp;<span class="ident" id="4578209"><a href="/gostd/crypto/tls/prf.go.html#4570787">md5</a></span><span class="op" id="4578212">.</span><span class="ident" id="4578213"><a href="/gostd/crypto/md5/md5.go.html#4710344">Size</a></span><span class="op" id="4578217">+</span><span class="ident" id="4578218"><a href="/gostd/crypto/tls/prf.go.html#4570801">sha1</a></span><span class="op" id="4578222">.</span><span class="ident" id="4578223"><a href="/gostd/crypto/sha1/sha1.go.html#4608617">Size</a></span><span class="op" id="4578227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578231"><a href="/gostd/crypto/tls/prf.go.html#4578185">seed</a></span>&nbsp;<span class="op" id="4578236">=</span>&nbsp;<span class="ident" id="4578238"><a href="/gostd/crypto/tls/prf.go.html#4577839">h</a></span><span class="op" id="4578239">.</span><span class="ident" id="4578240"><a href="/gostd/crypto/tls/prf.go.html#4575922">serverMD5</a></span><span class="op" id="4578249">.</span><span class="ident" id="4578250"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4578253">(</span><span class="ident" id="4578254"><a href="/gostd/crypto/tls/prf.go.html#4578185">seed</a></span><span class="op" id="4578258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578262"><a href="/gostd/crypto/tls/prf.go.html#4578185">seed</a></span>&nbsp;<span class="op" id="4578267">=</span>&nbsp;<span class="ident" id="4578269"><a href="/gostd/crypto/tls/prf.go.html#4577839">h</a></span><span class="op" id="4578270">.</span><span class="ident" id="4578271"><a href="/gostd/crypto/tls/prf.go.html#4575824">server</a></span><span class="op" id="4578277">.</span><span class="ident" id="4578278"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4578281">(</span><span class="ident" id="4578282"><a href="/gostd/crypto/tls/prf.go.html#4578185">seed</a></span><span class="op" id="4578286">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578290"><a href="/gostd/crypto/tls/prf.go.html#4571603">prf10</a></span><span class="op" id="4578295">(</span><span class="ident" id="4578296"><a href="/gostd/crypto/tls/prf.go.html#4578017">out</a></span><span class="op" id="4578299">,</span>&nbsp;<span class="ident" id="4578301"><a href="/gostd/crypto/tls/prf.go.html#4577865">masterSecret</a></span><span class="op" id="4578313">,</span>&nbsp;<span class="ident" id="4578315"><a href="/gostd/crypto/tls/prf.go.html#4573552">serverFinishedLabel</a></span><span class="op" id="4578334">,</span>&nbsp;<span class="ident" id="4578336"><a href="/gostd/crypto/tls/prf.go.html#4578185">seed</a></span><span class="op" id="4578340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4578343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578346">return</span>&nbsp;<span class="ident" id="4578353"><a href="/gostd/crypto/tls/prf.go.html#4578017">out</a></span><br>
<span class="lineno"></span><span class="op" id="4578357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="4578360">//&nbsp;hashForClientCertificate&nbsp;returns&nbsp;a&nbsp;digest,&nbsp;hash&nbsp;function,&nbsp;and&nbsp;TLS&nbsp;1.2&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="4578438">//&nbsp;id&nbsp;suitable&nbsp;for&nbsp;signing&nbsp;by&nbsp;a&nbsp;TLS&nbsp;client&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="4578494">func</span>&nbsp;<span class="op" id="4578499">(</span><span class="ident" id="4578500">h</span>&nbsp;<span class="ident" id="4578502"><a href="/gostd/crypto/tls/prf.go.html#4575783">finishedHash</a></span><span class="op" id="4578514">)</span>&nbsp;<span class="ident" id="4578516">hashForClientCertificate</span><span class="op" id="4578540">(</span><span class="ident" id="4578541">sigType</span>&nbsp;<span class="builtintype" id="4578549">uint8</span><span class="op" id="4578554">)</span>&nbsp;<span class="op" id="4578556">(</span><span class="op" id="4578557">[</span><span class="op" id="4578558">]</span><span class="builtintype" id="4578559">byte</span><span class="op" id="4578563">,</span>&nbsp;<span class="ident" id="4578565"><a href="/gostd/crypto/tls/prf.go.html#4570762">crypto</a></span><span class="op" id="4578571">.</span><span class="ident" id="4578572"><a href="/gostd/crypto/crypto.go.html#3010057">Hash</a></span><span class="op" id="4578576">,</span>&nbsp;<span class="builtintype" id="4578578">uint8</span><span class="op" id="4578583">)</span>&nbsp;<span class="op" id="4578585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578588">if</span>&nbsp;<span class="ident" id="4578591"><a href="/gostd/crypto/tls/prf.go.html#4578500">h</a></span><span class="op" id="4578592">.</span><span class="ident" id="4578593"><a href="/gostd/crypto/tls/prf.go.html#4575944">version</a></span>&nbsp;<span class="op" id="4578601">&gt;=</span>&nbsp;<span class="ident" id="4578604"><a href="/gostd/crypto/tls/common.go.html#4442509">VersionTLS12</a></span>&nbsp;<span class="op" id="4578617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578621">digest</span>&nbsp;<span class="op" id="4578628">:=</span>&nbsp;<span class="ident" id="4578631"><a href="/gostd/crypto/tls/prf.go.html#4578500">h</a></span><span class="op" id="4578632">.</span><span class="ident" id="4578633"><a href="/gostd/crypto/tls/prf.go.html#4575824">server</a></span><span class="op" id="4578639">.</span><span class="ident" id="4578640"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4578643">(</span><span class="builtintype" id="4578644">nil</span><span class="op" id="4578647">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578651">return</span>&nbsp;<span class="ident" id="4578658"><a href="/gostd/crypto/tls/prf.go.html#4578621">digest</a></span><span class="op" id="4578664">,</span>&nbsp;<span class="ident" id="4578666"><a href="/gostd/crypto/tls/prf.go.html#4570762">crypto</a></span><span class="op" id="4578672">.</span><span class="ident" id="4578673"><a href="/gostd/crypto/crypto.go.html#3010409">SHA256</a></span><span class="op" id="4578679">,</span>&nbsp;<span class="ident" id="4578681"><a href="/gostd/crypto/tls/common.go.html#4445493">hashSHA256</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4578693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578696">if</span>&nbsp;<span class="ident" id="4578699"><a href="/gostd/crypto/tls/prf.go.html#4578541">sigType</a></span>&nbsp;<span class="op" id="4578707">==</span>&nbsp;<span class="ident" id="4578710"><a href="/gostd/crypto/tls/common.go.html#4445618">signatureECDSA</a></span>&nbsp;<span class="op" id="4578725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578729">digest</span>&nbsp;<span class="op" id="4578736">:=</span>&nbsp;<span class="ident" id="4578739"><a href="/gostd/crypto/tls/prf.go.html#4578500">h</a></span><span class="op" id="4578740">.</span><span class="ident" id="4578741"><a href="/gostd/crypto/tls/prf.go.html#4575824">server</a></span><span class="op" id="4578747">.</span><span class="ident" id="4578748"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4578751">(</span><span class="builtintype" id="4578752">nil</span><span class="op" id="4578755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578759">return</span>&nbsp;<span class="ident" id="4578766"><a href="/gostd/crypto/tls/prf.go.html#4578729">digest</a></span><span class="op" id="4578772">,</span>&nbsp;<span class="ident" id="4578774"><a href="/gostd/crypto/tls/prf.go.html#4570762">crypto</a></span><span class="op" id="4578780">.</span><span class="ident" id="4578781"><a href="/gostd/crypto/crypto.go.html#3010309">SHA1</a></span><span class="op" id="4578785">,</span>&nbsp;<span class="ident" id="4578787"><a href="/gostd/crypto/tls/common.go.html#4445471">hashSHA1</a></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4578797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578801">digest</span>&nbsp;<span class="op" id="4578808">:=</span>&nbsp;<span class="builtinfunc" id="4578811">make</span><span class="op" id="4578815">(</span><span class="op" id="4578816">[</span><span class="op" id="4578817">]</span><span class="builtintype" id="4578818">byte</span><span class="op" id="4578822">,</span>&nbsp;<span class="num" id="4578824">0</span><span class="op" id="4578825">,</span>&nbsp;<span class="num" id="4578827">36</span><span class="op" id="4578829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578832"><a href="/gostd/crypto/tls/prf.go.html#4578801">digest</a></span>&nbsp;<span class="op" id="4578839">=</span>&nbsp;<span class="ident" id="4578841"><a href="/gostd/crypto/tls/prf.go.html#4578500">h</a></span><span class="op" id="4578842">.</span><span class="ident" id="4578843"><a href="/gostd/crypto/tls/prf.go.html#4575922">serverMD5</a></span><span class="op" id="4578852">.</span><span class="ident" id="4578853"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4578856">(</span><span class="ident" id="4578857"><a href="/gostd/crypto/tls/prf.go.html#4578801">digest</a></span><span class="op" id="4578863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4578866"><a href="/gostd/crypto/tls/prf.go.html#4578801">digest</a></span>&nbsp;<span class="op" id="4578873">=</span>&nbsp;<span class="ident" id="4578875"><a href="/gostd/crypto/tls/prf.go.html#4578500">h</a></span><span class="op" id="4578876">.</span><span class="ident" id="4578877"><a href="/gostd/crypto/tls/prf.go.html#4575824">server</a></span><span class="op" id="4578883">.</span><span class="ident" id="4578884"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="4578887">(</span><span class="ident" id="4578888"><a href="/gostd/crypto/tls/prf.go.html#4578801">digest</a></span><span class="op" id="4578894">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4578897">return</span>&nbsp;<span class="ident" id="4578904"><a href="/gostd/crypto/tls/prf.go.html#4578801">digest</a></span><span class="op" id="4578910">,</span>&nbsp;<span class="ident" id="4578912"><a href="/gostd/crypto/tls/prf.go.html#4570762">crypto</a></span><span class="op" id="4578918">.</span><span class="ident" id="4578919"><a href="/gostd/crypto/crypto.go.html#3010562">MD5SHA1</a></span><span class="op" id="4578926">,</span>&nbsp;<span class="num" id="4578928">0</span>&nbsp;<span class="comment" id="4578930">/*&nbsp;not&nbsp;specified&nbsp;in&nbsp;TLS&nbsp;1.2.&nbsp;*/</span><br>
<span class="lineno"></span><span class="op" id="4578962">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
