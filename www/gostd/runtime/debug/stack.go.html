<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5684191">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5684246">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5684300">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5684351">//&nbsp;Package&nbsp;debug&nbsp;contains&nbsp;facilities&nbsp;for&nbsp;programs&nbsp;to&nbsp;debug&nbsp;themselves&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="5684427">//&nbsp;they&nbsp;are&nbsp;running.</span><br>
<span class="lineno"></span><span class="keyword" id="5684448">package</span>&nbsp;<span class="ident" id="5684456">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5684463">import</span>&nbsp;<span class="op" id="5684470">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5684473">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5684482">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5684489">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5684502">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5684508">&#34;runtime&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5684518">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5684521">var</span>&nbsp;<span class="op" id="5684525">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5684528">dunno</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5684538">=</span>&nbsp;<span class="op" id="5684540">[</span><span class="op" id="5684541">]</span><span class="builtintype" id="5684542">byte</span><span class="op" id="5684546">(</span><span class="string" id="5684547">&#34;???&#34;</span><span class="op" id="5684552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5684555">centerDot</span>&nbsp;<span class="op" id="5684565">=</span>&nbsp;<span class="op" id="5684567">[</span><span class="op" id="5684568">]</span><span class="builtintype" id="5684569">byte</span><span class="op" id="5684573">(</span><span class="string" id="5684574">&#34;·&#34;</span><span class="op" id="5684578">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5684581">dot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5684591">=</span>&nbsp;<span class="op" id="5684593">[</span><span class="op" id="5684594">]</span><span class="builtintype" id="5684595">byte</span><span class="op" id="5684599">(</span><span class="string" id="5684600">&#34;.&#34;</span><span class="op" id="5684603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5684606">slash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5684616">=</span>&nbsp;<span class="op" id="5684618">[</span><span class="op" id="5684619">]</span><span class="builtintype" id="5684620">byte</span><span class="op" id="5684624">(</span><span class="string" id="5684625">&#34;/&#34;</span><span class="op" id="5684628">)</span><br>
<span class="lineno"></span><span class="op" id="5684630">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5684633">//&nbsp;PrintStack&nbsp;prints&nbsp;to&nbsp;standard&nbsp;error&nbsp;the&nbsp;stack&nbsp;trace&nbsp;returned&nbsp;by&nbsp;Stack.</span><br>
<span class="lineno">25</span><span class="keyword" id="5684707">func</span>&nbsp;<span class="ident" id="5684712">PrintStack</span><span class="op" id="5684722">(</span><span class="op" id="5684723">)</span>&nbsp;<span class="op" id="5684725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5684728">os</span><span class="op" id="5684730">.</span><span class="ident" id="5684731">Stderr</span><span class="op" id="5684737">.</span><span class="ident" id="5684738">Write</span><span class="op" id="5684743">(</span><span class="ident" id="5684744">stack</span><span class="op" id="5684749">(</span><span class="op" id="5684750">)</span><span class="op" id="5684751">)</span><br>
<span class="lineno"></span><span class="op" id="5684753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5684756">//&nbsp;Stack&nbsp;returns&nbsp;a&nbsp;formatted&nbsp;stack&nbsp;trace&nbsp;of&nbsp;the&nbsp;goroutine&nbsp;that&nbsp;calls&nbsp;it.</span><br>
<span class="lineno">30</span><span class="comment" id="5684829">//&nbsp;For&nbsp;each&nbsp;routine,&nbsp;it&nbsp;includes&nbsp;the&nbsp;source&nbsp;line&nbsp;information&nbsp;and&nbsp;PC&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="5684904">//&nbsp;then&nbsp;attempts&nbsp;to&nbsp;discover,&nbsp;for&nbsp;Go&nbsp;functions,&nbsp;the&nbsp;calling&nbsp;function&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5684976">//&nbsp;method&nbsp;and&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;line&nbsp;containing&nbsp;the&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="comment" id="5685038">//</span><br>
<span class="lineno"></span><span class="comment" id="5685041">//&nbsp;This&nbsp;function&nbsp;is&nbsp;deprecated.&nbsp;Use&nbsp;package&nbsp;runtime&#39;s&nbsp;Stack&nbsp;instead.</span><br>
<span class="lineno">35</span><span class="keyword" id="5685110">func</span>&nbsp;<span class="ident" id="5685115">Stack</span><span class="op" id="5685120">(</span><span class="op" id="5685121">)</span>&nbsp;<span class="op" id="5685123">[</span><span class="op" id="5685124">]</span><span class="builtintype" id="5685125">byte</span>&nbsp;<span class="op" id="5685130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5685133">return</span>&nbsp;<span class="ident" id="5685140">stack</span><span class="op" id="5685145">(</span><span class="op" id="5685146">)</span><br>
<span class="lineno"></span><span class="op" id="5685148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5685151">//&nbsp;stack&nbsp;implements&nbsp;Stack,&nbsp;skipping&nbsp;2&nbsp;frames</span><br>
<span class="lineno">40</span><span class="keyword" id="5685196">func</span>&nbsp;<span class="ident" id="5685201">stack</span><span class="op" id="5685206">(</span><span class="op" id="5685207">)</span>&nbsp;<span class="op" id="5685209">[</span><span class="op" id="5685210">]</span><span class="builtintype" id="5685211">byte</span>&nbsp;<span class="op" id="5685216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5685219">buf</span>&nbsp;<span class="op" id="5685223">:=</span>&nbsp;<span class="builtinfunc" id="5685226">new</span><span class="op" id="5685229">(</span><span class="ident" id="5685230">bytes</span><span class="op" id="5685235">.</span><span class="ident" id="5685236">Buffer</span><span class="op" id="5685242">)</span>&nbsp;<span class="comment" id="5685244">//&nbsp;the&nbsp;returned&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5685266">//&nbsp;As&nbsp;we&nbsp;loop,&nbsp;we&nbsp;open&nbsp;files&nbsp;and&nbsp;read&nbsp;them.&nbsp;These&nbsp;variables&nbsp;record&nbsp;the&nbsp;currently</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5685348">//&nbsp;loaded&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5685365">var</span>&nbsp;<span class="ident" id="5685369">lines</span>&nbsp;<span class="op" id="5685375">[</span><span class="op" id="5685376">]</span><span class="op" id="5685377">[</span><span class="op" id="5685378">]</span><span class="builtintype" id="5685379">byte</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5685385">var</span>&nbsp;<span class="ident" id="5685389">lastFile</span>&nbsp;<span class="builtintype" id="5685398">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5685406">for</span>&nbsp;<span class="ident" id="5685410">i</span>&nbsp;<span class="op" id="5685412">:=</span>&nbsp;<span class="num" id="5685415">2</span><span class="op" id="5685416">;</span>&nbsp;<span class="op" id="5685418">;</span>&nbsp;<span class="ident" id="5685420">i</span><span class="op" id="5685421">++</span>&nbsp;<span class="op" id="5685424">{</span>&nbsp;<span class="comment" id="5685426">//&nbsp;Caller&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;user,&nbsp;2&nbsp;frames&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5685477">pc</span><span class="op" id="5685479">,</span>&nbsp;<span class="ident" id="5685481">file</span><span class="op" id="5685485">,</span>&nbsp;<span class="ident" id="5685487">line</span><span class="op" id="5685491">,</span>&nbsp;<span class="ident" id="5685493">ok</span>&nbsp;<span class="op" id="5685496">:=</span>&nbsp;<span class="ident" id="5685499">runtime</span><span class="op" id="5685506">.</span><span class="ident" id="5685507">Caller</span><span class="op" id="5685513">(</span><span class="ident" id="5685514">i</span><span class="op" id="5685515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5685519">if</span>&nbsp;<span class="op" id="5685522">!</span><span class="ident" id="5685523">ok</span>&nbsp;<span class="op" id="5685526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5685531">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5685539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5685543">//&nbsp;Print&nbsp;this&nbsp;much&nbsp;at&nbsp;least.&nbsp;&nbsp;If&nbsp;we&nbsp;can&#39;t&nbsp;find&nbsp;the&nbsp;source,&nbsp;it&nbsp;won&#39;t&nbsp;show.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5685619">fmt</span><span class="op" id="5685622">.</span><span class="ident" id="5685623">Fprintf</span><span class="op" id="5685630">(</span><span class="ident" id="5685631">buf</span><span class="op" id="5685634">,</span>&nbsp;<span class="string" id="5685636">&#34;%s:%d&nbsp;(0x%x)\n&#34;</span><span class="op" id="5685652">,</span>&nbsp;<span class="ident" id="5685654">file</span><span class="op" id="5685658">,</span>&nbsp;<span class="ident" id="5685660">line</span><span class="op" id="5685664">,</span>&nbsp;<span class="ident" id="5685666">pc</span><span class="op" id="5685668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5685672">if</span>&nbsp;<span class="ident" id="5685675">file</span>&nbsp;<span class="op" id="5685680">!=</span>&nbsp;<span class="ident" id="5685683">lastFile</span>&nbsp;<span class="op" id="5685692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5685697">data</span><span class="op" id="5685701">,</span>&nbsp;<span class="ident" id="5685703">err</span>&nbsp;<span class="op" id="5685707">:=</span>&nbsp;<span class="ident" id="5685710">ioutil</span><span class="op" id="5685716">.</span><span class="ident" id="5685717">ReadFile</span><span class="op" id="5685725">(</span><span class="ident" id="5685726">file</span><span class="op" id="5685730">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5685735">if</span>&nbsp;<span class="ident" id="5685738">err</span>&nbsp;<span class="op" id="5685742">!=</span>&nbsp;<span class="ident" id="5685745">nil</span>&nbsp;<span class="op" id="5685749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5685755">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5685767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5685772">lines</span>&nbsp;<span class="op" id="5685778">=</span>&nbsp;<span class="ident" id="5685780">bytes</span><span class="op" id="5685785">.</span><span class="ident" id="5685786">Split</span><span class="op" id="5685791">(</span><span class="ident" id="5685792">data</span><span class="op" id="5685796">,</span>&nbsp;<span class="op" id="5685798">[</span><span class="op" id="5685799">]</span><span class="builtintype" id="5685800">byte</span><span class="op" id="5685804">{</span><span class="string" id="5685805">&#39;\n&#39;</span><span class="op" id="5685809">}</span><span class="op" id="5685810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5685815">lastFile</span>&nbsp;<span class="op" id="5685824">=</span>&nbsp;<span class="ident" id="5685826">file</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5685833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5685837">line</span><span class="op" id="5685841">--</span>&nbsp;<span class="comment" id="5685844">//&nbsp;in&nbsp;stack&nbsp;trace,&nbsp;lines&nbsp;are&nbsp;1-indexed&nbsp;but&nbsp;our&nbsp;array&nbsp;is&nbsp;0-indexed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5685912">fmt</span><span class="op" id="5685915">.</span><span class="ident" id="5685916">Fprintf</span><span class="op" id="5685923">(</span><span class="ident" id="5685924">buf</span><span class="op" id="5685927">,</span>&nbsp;<span class="string" id="5685929">&#34;\t%s:&nbsp;%s\n&#34;</span><span class="op" id="5685941">,</span>&nbsp;<span class="ident" id="5685943">function</span><span class="op" id="5685951">(</span><span class="ident" id="5685952">pc</span><span class="op" id="5685954">)</span><span class="op" id="5685955">,</span>&nbsp;<span class="ident" id="5685957">source</span><span class="op" id="5685963">(</span><span class="ident" id="5685964">lines</span><span class="op" id="5685969">,</span>&nbsp;<span class="ident" id="5685971">line</span><span class="op" id="5685975">)</span><span class="op" id="5685976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5685979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5685982">return</span>&nbsp;<span class="ident" id="5685989">buf</span><span class="op" id="5685992">.</span><span class="ident" id="5685993">Bytes</span><span class="op" id="5685998">(</span><span class="op" id="5685999">)</span><br>
<span class="lineno">65</span><span class="op" id="5686001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5686004">//&nbsp;source&nbsp;returns&nbsp;a&nbsp;space-trimmed&nbsp;slice&nbsp;of&nbsp;the&nbsp;n&#39;th&nbsp;line.</span><br>
<span class="lineno"></span><span class="keyword" id="5686062">func</span>&nbsp;<span class="ident" id="5686067">source</span><span class="op" id="5686073">(</span><span class="ident" id="5686074">lines</span>&nbsp;<span class="op" id="5686080">[</span><span class="op" id="5686081">]</span><span class="op" id="5686082">[</span><span class="op" id="5686083">]</span><span class="builtintype" id="5686084">byte</span><span class="op" id="5686088">,</span>&nbsp;<span class="ident" id="5686090">n</span>&nbsp;<span class="builtintype" id="5686092">int</span><span class="op" id="5686095">)</span>&nbsp;<span class="op" id="5686097">[</span><span class="op" id="5686098">]</span><span class="builtintype" id="5686099">byte</span>&nbsp;<span class="op" id="5686104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5686107">if</span>&nbsp;<span class="ident" id="5686110">n</span>&nbsp;<span class="op" id="5686112">&lt;</span>&nbsp;<span class="num" id="5686114">0</span>&nbsp;<span class="op" id="5686116">||</span>&nbsp;<span class="ident" id="5686119">n</span>&nbsp;<span class="op" id="5686121">&gt;=</span>&nbsp;<span class="builtinfunc" id="5686124">len</span><span class="op" id="5686127">(</span><span class="ident" id="5686128">lines</span><span class="op" id="5686133">)</span>&nbsp;<span class="op" id="5686135">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5686139">return</span>&nbsp;<span class="ident" id="5686146">dunno</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5686153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5686156">return</span>&nbsp;<span class="ident" id="5686163">bytes</span><span class="op" id="5686168">.</span><span class="ident" id="5686169">Trim</span><span class="op" id="5686173">(</span><span class="ident" id="5686174">lines</span><span class="op" id="5686179">[</span><span class="ident" id="5686180">n</span><span class="op" id="5686181">]</span><span class="op" id="5686182">,</span>&nbsp;<span class="string" id="5686184">&#34;&nbsp;\t&#34;</span><span class="op" id="5686189">)</span><br>
<span class="lineno"></span><span class="op" id="5686191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="5686194">//&nbsp;function&nbsp;returns,&nbsp;if&nbsp;possible,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;function&nbsp;containing&nbsp;the&nbsp;PC.</span><br>
<span class="lineno"></span><span class="keyword" id="5686272">func</span>&nbsp;<span class="ident" id="5686277">function</span><span class="op" id="5686285">(</span><span class="ident" id="5686286">pc</span>&nbsp;<span class="builtintype" id="5686289">uintptr</span><span class="op" id="5686296">)</span>&nbsp;<span class="op" id="5686298">[</span><span class="op" id="5686299">]</span><span class="builtintype" id="5686300">byte</span>&nbsp;<span class="op" id="5686305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5686308">fn</span>&nbsp;<span class="op" id="5686311">:=</span>&nbsp;<span class="ident" id="5686314">runtime</span><span class="op" id="5686321">.</span><span class="ident" id="5686322">FuncForPC</span><span class="op" id="5686331">(</span><span class="ident" id="5686332">pc</span><span class="op" id="5686334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5686337">if</span>&nbsp;<span class="ident" id="5686340">fn</span>&nbsp;<span class="op" id="5686343">==</span>&nbsp;<span class="ident" id="5686346">nil</span>&nbsp;<span class="op" id="5686350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5686354">return</span>&nbsp;<span class="ident" id="5686361">dunno</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5686368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5686371">name</span>&nbsp;<span class="op" id="5686376">:=</span>&nbsp;<span class="op" id="5686379">[</span><span class="op" id="5686380">]</span><span class="builtintype" id="5686381">byte</span><span class="op" id="5686385">(</span><span class="ident" id="5686386">fn</span><span class="op" id="5686388">.</span><span class="ident" id="5686389">Name</span><span class="op" id="5686393">(</span><span class="op" id="5686394">)</span><span class="op" id="5686395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5686398">//&nbsp;The&nbsp;name&nbsp;includes&nbsp;the&nbsp;path&nbsp;name&nbsp;to&nbsp;the&nbsp;package,&nbsp;which&nbsp;is&nbsp;unnecessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5686471">//&nbsp;since&nbsp;the&nbsp;file&nbsp;name&nbsp;is&nbsp;already&nbsp;included.&nbsp;&nbsp;Plus,&nbsp;it&nbsp;has&nbsp;center&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5686543">//&nbsp;That&nbsp;is,&nbsp;we&nbsp;see</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5686563">//&nbsp;&nbsp;&nbsp;&nbspruntime/debug.*T·ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5686595">//&nbsp;and&nbsp;want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5686608">//&nbsp;&nbsp;&nbsp;&nbsp*T.ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5686625">//&nbsp;Since&nbsp;the&nbsp;package&nbsp;path&nbsp;might&nbsp;contains&nbsp;dots&nbsp;(e.g.&nbsp;code.google.com/...),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5686700">//&nbsp;we&nbsp;first&nbsp;remove&nbsp;the&nbsp;path&nbsp;prefix&nbsp;if&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5686753">if</span>&nbsp;<span class="ident" id="5686756">lastslash</span>&nbsp;<span class="op" id="5686766">:=</span>&nbsp;<span class="ident" id="5686769">bytes</span><span class="op" id="5686774">.</span><span class="ident" id="5686775">LastIndex</span><span class="op" id="5686784">(</span><span class="ident" id="5686785">name</span><span class="op" id="5686789">,</span>&nbsp;<span class="ident" id="5686791">slash</span><span class="op" id="5686796">)</span><span class="op" id="5686797">;</span>&nbsp;<span class="ident" id="5686799">lastslash</span>&nbsp;<span class="op" id="5686809">&gt;=</span>&nbsp;<span class="num" id="5686812">0</span>&nbsp;<span class="op" id="5686814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5686818">name</span>&nbsp;<span class="op" id="5686823">=</span>&nbsp;<span class="ident" id="5686825">name</span><span class="op" id="5686829">[</span><span class="ident" id="5686830">lastslash</span><span class="op" id="5686839">+</span><span class="num" id="5686840">1</span><span class="op" id="5686841">:</span><span class="op" id="5686842">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5686845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5686848">if</span>&nbsp;<span class="ident" id="5686851">period</span>&nbsp;<span class="op" id="5686858">:=</span>&nbsp;<span class="ident" id="5686861">bytes</span><span class="op" id="5686866">.</span><span class="ident" id="5686867">Index</span><span class="op" id="5686872">(</span><span class="ident" id="5686873">name</span><span class="op" id="5686877">,</span>&nbsp;<span class="ident" id="5686879">dot</span><span class="op" id="5686882">)</span><span class="op" id="5686883">;</span>&nbsp;<span class="ident" id="5686885">period</span>&nbsp;<span class="op" id="5686892">&gt;=</span>&nbsp;<span class="num" id="5686895">0</span>&nbsp;<span class="op" id="5686897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5686901">name</span>&nbsp;<span class="op" id="5686906">=</span>&nbsp;<span class="ident" id="5686908">name</span><span class="op" id="5686912">[</span><span class="ident" id="5686913">period</span><span class="op" id="5686919">+</span><span class="num" id="5686920">1</span><span class="op" id="5686921">:</span><span class="op" id="5686922">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5686925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5686928">name</span>&nbsp;<span class="op" id="5686933">=</span>&nbsp;<span class="ident" id="5686935">bytes</span><span class="op" id="5686940">.</span><span class="ident" id="5686941">Replace</span><span class="op" id="5686948">(</span><span class="ident" id="5686949">name</span><span class="op" id="5686953">,</span>&nbsp;<span class="ident" id="5686955">centerDot</span><span class="op" id="5686964">,</span>&nbsp;<span class="ident" id="5686966">dot</span><span class="op" id="5686969">,</span>&nbsp;<span class="op" id="5686971">-</span><span class="num" id="5686972">1</span><span class="op" id="5686973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5686976">return</span>&nbsp;<span class="ident" id="5686983">name</span><br>
<span class="lineno"></span><span class="op" id="5686988">}</span>
</div>
</body>
</html>
