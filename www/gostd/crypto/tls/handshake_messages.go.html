<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html" class="current">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4390982">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4391037">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4391091">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4391142">package</span>&nbsp;<span class="ident" id="4391150">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4391155">import</span>&nbsp;<span class="string" id="4391162">&#34;bytes&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4391171">type</span>&nbsp;<span class="ident" id="4391176">clientHelloMsg</span>&nbsp;<span class="keyword" id="4391191">struct</span>&nbsp;<span class="op" id="4391198">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391201">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391221">[</span><span class="op" id="4391222">]</span><span class="builtintype" id="4391223">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391229">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391249">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391257">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391277">[</span><span class="op" id="4391278">]</span><span class="builtintype" id="4391279">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391285">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391305">[</span><span class="op" id="4391306">]</span><span class="builtintype" id="4391307">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391313">cipherSuites</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391333">[</span><span class="op" id="4391334">]</span><span class="builtintype" id="4391335">uint16</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391343">compressionMethods</span>&nbsp;&nbsp;<span class="op" id="4391363">[</span><span class="op" id="4391364">]</span><span class="builtintype" id="4391365">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391372">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391392">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391398">serverName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391418">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391426">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391446">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391452">supportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391472">[</span><span class="op" id="4391473">]</span><span class="ident" id="4391474">CurveID</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391483">supportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391503">[</span><span class="op" id="4391504">]</span><span class="builtintype" id="4391505">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391512">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391532">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391538">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391558">[</span><span class="op" id="4391559">]</span><span class="builtintype" id="4391560">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391567">signatureAndHashes</span>&nbsp;&nbsp;<span class="op" id="4391587">[</span><span class="op" id="4391588">]</span><span class="ident" id="4391589">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391607">secureRenegotiation</span>&nbsp;<span class="builtintype" id="4391627">bool</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391633">alpnProtocols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391653">[</span><span class="op" id="4391654">]</span><span class="builtintype" id="4391655">string</span><br>
<span class="lineno"></span><span class="op" id="4391662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4391665">func</span>&nbsp;<span class="op" id="4391670">(</span><span class="ident" id="4391671">m</span>&nbsp;<span class="op" id="4391673">*</span><span class="ident" id="4391674">clientHelloMsg</span><span class="op" id="4391688">)</span>&nbsp;<span class="ident" id="4391690">equal</span><span class="op" id="4391695">(</span><span class="ident" id="4391696">i</span>&nbsp;<span class="keyword" id="4391698">interface</span><span class="op" id="4391707">{</span><span class="op" id="4391708">}</span><span class="op" id="4391709">)</span>&nbsp;<span class="builtintype" id="4391711">bool</span>&nbsp;<span class="op" id="4391716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391719">m1</span><span class="op" id="4391721">,</span>&nbsp;<span class="ident" id="4391723">ok</span>&nbsp;<span class="op" id="4391726">:=</span>&nbsp;<span class="ident" id="4391729">i</span><span class="op" id="4391730">.</span><span class="op" id="4391731">(</span><span class="op" id="4391732">*</span><span class="ident" id="4391733">clientHelloMsg</span><span class="op" id="4391747">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4391750">if</span>&nbsp;<span class="op" id="4391753">!</span><span class="ident" id="4391754">ok</span>&nbsp;<span class="op" id="4391757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4391761">return</span>&nbsp;<span class="builtintype" id="4391768">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4391775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4391779">return</span>&nbsp;<span class="ident" id="4391786">bytes</span><span class="op" id="4391791">.</span><span class="ident" id="4391792">Equal</span><span class="op" id="4391797">(</span><span class="ident" id="4391798">m</span><span class="op" id="4391799">.</span><span class="ident" id="4391800">raw</span><span class="op" id="4391803">,</span>&nbsp;<span class="ident" id="4391805">m1</span><span class="op" id="4391807">.</span><span class="ident" id="4391808">raw</span><span class="op" id="4391811">)</span>&nbsp;<span class="op" id="4391813">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391818">m</span><span class="op" id="4391819">.</span><span class="ident" id="4391820">vers</span>&nbsp;<span class="op" id="4391825">==</span>&nbsp;<span class="ident" id="4391828">m1</span><span class="op" id="4391830">.</span><span class="ident" id="4391831">vers</span>&nbsp;<span class="op" id="4391836">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391841">bytes</span><span class="op" id="4391846">.</span><span class="ident" id="4391847">Equal</span><span class="op" id="4391852">(</span><span class="ident" id="4391853">m</span><span class="op" id="4391854">.</span><span class="ident" id="4391855">random</span><span class="op" id="4391861">,</span>&nbsp;<span class="ident" id="4391863">m1</span><span class="op" id="4391865">.</span><span class="ident" id="4391866">random</span><span class="op" id="4391872">)</span>&nbsp;<span class="op" id="4391874">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391879">bytes</span><span class="op" id="4391884">.</span><span class="ident" id="4391885">Equal</span><span class="op" id="4391890">(</span><span class="ident" id="4391891">m</span><span class="op" id="4391892">.</span><span class="ident" id="4391893">sessionId</span><span class="op" id="4391902">,</span>&nbsp;<span class="ident" id="4391904">m1</span><span class="op" id="4391906">.</span><span class="ident" id="4391907">sessionId</span><span class="op" id="4391916">)</span>&nbsp;<span class="op" id="4391918">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391923">eqUint16s</span><span class="op" id="4391932">(</span><span class="ident" id="4391933">m</span><span class="op" id="4391934">.</span><span class="ident" id="4391935">cipherSuites</span><span class="op" id="4391947">,</span>&nbsp;<span class="ident" id="4391949">m1</span><span class="op" id="4391951">.</span><span class="ident" id="4391952">cipherSuites</span><span class="op" id="4391964">)</span>&nbsp;<span class="op" id="4391966">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4391971">bytes</span><span class="op" id="4391976">.</span><span class="ident" id="4391977">Equal</span><span class="op" id="4391982">(</span><span class="ident" id="4391983">m</span><span class="op" id="4391984">.</span><span class="ident" id="4391985">compressionMethods</span><span class="op" id="4392003">,</span>&nbsp;<span class="ident" id="4392005">m1</span><span class="op" id="4392007">.</span><span class="ident" id="4392008">compressionMethods</span><span class="op" id="4392026">)</span>&nbsp;<span class="op" id="4392028">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392033">m</span><span class="op" id="4392034">.</span><span class="ident" id="4392035">nextProtoNeg</span>&nbsp;<span class="op" id="4392048">==</span>&nbsp;<span class="ident" id="4392051">m1</span><span class="op" id="4392053">.</span><span class="ident" id="4392054">nextProtoNeg</span>&nbsp;<span class="op" id="4392067">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392072">m</span><span class="op" id="4392073">.</span><span class="ident" id="4392074">serverName</span>&nbsp;<span class="op" id="4392085">==</span>&nbsp;<span class="ident" id="4392088">m1</span><span class="op" id="4392090">.</span><span class="ident" id="4392091">serverName</span>&nbsp;<span class="op" id="4392102">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392107">m</span><span class="op" id="4392108">.</span><span class="ident" id="4392109">ocspStapling</span>&nbsp;<span class="op" id="4392122">==</span>&nbsp;<span class="ident" id="4392125">m1</span><span class="op" id="4392127">.</span><span class="ident" id="4392128">ocspStapling</span>&nbsp;<span class="op" id="4392141">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392146">eqCurveIDs</span><span class="op" id="4392156">(</span><span class="ident" id="4392157">m</span><span class="op" id="4392158">.</span><span class="ident" id="4392159">supportedCurves</span><span class="op" id="4392174">,</span>&nbsp;<span class="ident" id="4392176">m1</span><span class="op" id="4392178">.</span><span class="ident" id="4392179">supportedCurves</span><span class="op" id="4392194">)</span>&nbsp;<span class="op" id="4392196">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392201">bytes</span><span class="op" id="4392206">.</span><span class="ident" id="4392207">Equal</span><span class="op" id="4392212">(</span><span class="ident" id="4392213">m</span><span class="op" id="4392214">.</span><span class="ident" id="4392215">supportedPoints</span><span class="op" id="4392230">,</span>&nbsp;<span class="ident" id="4392232">m1</span><span class="op" id="4392234">.</span><span class="ident" id="4392235">supportedPoints</span><span class="op" id="4392250">)</span>&nbsp;<span class="op" id="4392252">&amp;&amp;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392257">m</span><span class="op" id="4392258">.</span><span class="ident" id="4392259">ticketSupported</span>&nbsp;<span class="op" id="4392275">==</span>&nbsp;<span class="ident" id="4392278">m1</span><span class="op" id="4392280">.</span><span class="ident" id="4392281">ticketSupported</span>&nbsp;<span class="op" id="4392297">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392302">bytes</span><span class="op" id="4392307">.</span><span class="ident" id="4392308">Equal</span><span class="op" id="4392313">(</span><span class="ident" id="4392314">m</span><span class="op" id="4392315">.</span><span class="ident" id="4392316">sessionTicket</span><span class="op" id="4392329">,</span>&nbsp;<span class="ident" id="4392331">m1</span><span class="op" id="4392333">.</span><span class="ident" id="4392334">sessionTicket</span><span class="op" id="4392347">)</span>&nbsp;<span class="op" id="4392349">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392354">eqSignatureAndHashes</span><span class="op" id="4392374">(</span><span class="ident" id="4392375">m</span><span class="op" id="4392376">.</span><span class="ident" id="4392377">signatureAndHashes</span><span class="op" id="4392395">,</span>&nbsp;<span class="ident" id="4392397">m1</span><span class="op" id="4392399">.</span><span class="ident" id="4392400">signatureAndHashes</span><span class="op" id="4392418">)</span>&nbsp;<span class="op" id="4392420">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392425">m</span><span class="op" id="4392426">.</span><span class="ident" id="4392427">secureRenegotiation</span>&nbsp;<span class="op" id="4392447">==</span>&nbsp;<span class="ident" id="4392450">m1</span><span class="op" id="4392452">.</span><span class="ident" id="4392453">secureRenegotiation</span>&nbsp;<span class="op" id="4392473">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392478">eqStrings</span><span class="op" id="4392487">(</span><span class="ident" id="4392488">m</span><span class="op" id="4392489">.</span><span class="ident" id="4392490">alpnProtocols</span><span class="op" id="4392503">,</span>&nbsp;<span class="ident" id="4392505">m1</span><span class="op" id="4392507">.</span><span class="ident" id="4392508">alpnProtocols</span><span class="op" id="4392521">)</span><br>
<span class="lineno">50</span><span class="op" id="4392523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4392526">func</span>&nbsp;<span class="op" id="4392531">(</span><span class="ident" id="4392532">m</span>&nbsp;<span class="op" id="4392534">*</span><span class="ident" id="4392535">clientHelloMsg</span><span class="op" id="4392549">)</span>&nbsp;<span class="ident" id="4392551">marshal</span><span class="op" id="4392558">(</span><span class="op" id="4392559">)</span>&nbsp;<span class="op" id="4392561">[</span><span class="op" id="4392562">]</span><span class="builtintype" id="4392563">byte</span>&nbsp;<span class="op" id="4392568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4392571">if</span>&nbsp;<span class="ident" id="4392574">m</span><span class="op" id="4392575">.</span><span class="ident" id="4392576">raw</span>&nbsp;<span class="op" id="4392580">!=</span>&nbsp;<span class="builtintype" id="4392583">nil</span>&nbsp;<span class="op" id="4392587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4392591">return</span>&nbsp;<span class="ident" id="4392598">m</span><span class="op" id="4392599">.</span><span class="ident" id="4392600">raw</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4392605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392609">length</span>&nbsp;<span class="op" id="4392616">:=</span>&nbsp;<span class="num" id="4392619">2</span>&nbsp;<span class="op" id="4392621">+</span>&nbsp;<span class="num" id="4392623">32</span>&nbsp;<span class="op" id="4392626">+</span>&nbsp;<span class="num" id="4392628">1</span>&nbsp;<span class="op" id="4392630">+</span>&nbsp;<span class="builtinfunc" id="4392632">len</span><span class="op" id="4392635">(</span><span class="ident" id="4392636">m</span><span class="op" id="4392637">.</span><span class="ident" id="4392638">sessionId</span><span class="op" id="4392647">)</span>&nbsp;<span class="op" id="4392649">+</span>&nbsp;<span class="num" id="4392651">2</span>&nbsp;<span class="op" id="4392653">+</span>&nbsp;<span class="builtinfunc" id="4392655">len</span><span class="op" id="4392658">(</span><span class="ident" id="4392659">m</span><span class="op" id="4392660">.</span><span class="ident" id="4392661">cipherSuites</span><span class="op" id="4392673">)</span><span class="op" id="4392674">*</span><span class="num" id="4392675">2</span>&nbsp;<span class="op" id="4392677">+</span>&nbsp;<span class="num" id="4392679">1</span>&nbsp;<span class="op" id="4392681">+</span>&nbsp;<span class="builtinfunc" id="4392683">len</span><span class="op" id="4392686">(</span><span class="ident" id="4392687">m</span><span class="op" id="4392688">.</span><span class="ident" id="4392689">compressionMethods</span><span class="op" id="4392707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392710">numExtensions</span>&nbsp;<span class="op" id="4392724">:=</span>&nbsp;<span class="num" id="4392727">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392730">extensionsLength</span>&nbsp;<span class="op" id="4392747">:=</span>&nbsp;<span class="num" id="4392750">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4392753">if</span>&nbsp;<span class="ident" id="4392756">m</span><span class="op" id="4392757">.</span><span class="ident" id="4392758">nextProtoNeg</span>&nbsp;<span class="op" id="4392771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392775">numExtensions</span><span class="op" id="4392788">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4392792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4392795">if</span>&nbsp;<span class="ident" id="4392798">m</span><span class="op" id="4392799">.</span><span class="ident" id="4392800">ocspStapling</span>&nbsp;<span class="op" id="4392813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392817">extensionsLength</span>&nbsp;<span class="op" id="4392834">+=</span>&nbsp;<span class="num" id="4392837">1</span>&nbsp;<span class="op" id="4392839">+</span>&nbsp;<span class="num" id="4392841">2</span>&nbsp;<span class="op" id="4392843">+</span>&nbsp;<span class="num" id="4392845">2</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392849">numExtensions</span><span class="op" id="4392862">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4392866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4392869">if</span>&nbsp;<span class="builtinfunc" id="4392872">len</span><span class="op" id="4392875">(</span><span class="ident" id="4392876">m</span><span class="op" id="4392877">.</span><span class="ident" id="4392878">serverName</span><span class="op" id="4392888">)</span>&nbsp;<span class="op" id="4392890">&gt;</span>&nbsp;<span class="num" id="4392892">0</span>&nbsp;<span class="op" id="4392894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392898">extensionsLength</span>&nbsp;<span class="op" id="4392915">+=</span>&nbsp;<span class="num" id="4392918">5</span>&nbsp;<span class="op" id="4392920">+</span>&nbsp;<span class="builtinfunc" id="4392922">len</span><span class="op" id="4392925">(</span><span class="ident" id="4392926">m</span><span class="op" id="4392927">.</span><span class="ident" id="4392928">serverName</span><span class="op" id="4392938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392942">numExtensions</span><span class="op" id="4392955">++</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4392959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4392962">if</span>&nbsp;<span class="builtinfunc" id="4392965">len</span><span class="op" id="4392968">(</span><span class="ident" id="4392969">m</span><span class="op" id="4392970">.</span><span class="ident" id="4392971">supportedCurves</span><span class="op" id="4392986">)</span>&nbsp;<span class="op" id="4392988">&gt;</span>&nbsp;<span class="num" id="4392990">0</span>&nbsp;<span class="op" id="4392992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4392996">extensionsLength</span>&nbsp;<span class="op" id="4393013">+=</span>&nbsp;<span class="num" id="4393016">2</span>&nbsp;<span class="op" id="4393018">+</span>&nbsp;<span class="num" id="4393020">2</span><span class="op" id="4393021">*</span><span class="builtinfunc" id="4393022">len</span><span class="op" id="4393025">(</span><span class="ident" id="4393026">m</span><span class="op" id="4393027">.</span><span class="ident" id="4393028">supportedCurves</span><span class="op" id="4393043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393047">numExtensions</span><span class="op" id="4393060">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393064">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393067">if</span>&nbsp;<span class="builtinfunc" id="4393070">len</span><span class="op" id="4393073">(</span><span class="ident" id="4393074">m</span><span class="op" id="4393075">.</span><span class="ident" id="4393076">supportedPoints</span><span class="op" id="4393091">)</span>&nbsp;<span class="op" id="4393093">&gt;</span>&nbsp;<span class="num" id="4393095">0</span>&nbsp;<span class="op" id="4393097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393101">extensionsLength</span>&nbsp;<span class="op" id="4393118">+=</span>&nbsp;<span class="num" id="4393121">1</span>&nbsp;<span class="op" id="4393123">+</span>&nbsp;<span class="builtinfunc" id="4393125">len</span><span class="op" id="4393128">(</span><span class="ident" id="4393129">m</span><span class="op" id="4393130">.</span><span class="ident" id="4393131">supportedPoints</span><span class="op" id="4393146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393150">numExtensions</span><span class="op" id="4393163">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393170">if</span>&nbsp;<span class="ident" id="4393173">m</span><span class="op" id="4393174">.</span><span class="ident" id="4393175">ticketSupported</span>&nbsp;<span class="op" id="4393191">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393195">extensionsLength</span>&nbsp;<span class="op" id="4393212">+=</span>&nbsp;<span class="builtinfunc" id="4393215">len</span><span class="op" id="4393218">(</span><span class="ident" id="4393219">m</span><span class="op" id="4393220">.</span><span class="ident" id="4393221">sessionTicket</span><span class="op" id="4393234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393238">numExtensions</span><span class="op" id="4393251">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393258">if</span>&nbsp;<span class="builtinfunc" id="4393261">len</span><span class="op" id="4393264">(</span><span class="ident" id="4393265">m</span><span class="op" id="4393266">.</span><span class="ident" id="4393267">signatureAndHashes</span><span class="op" id="4393285">)</span>&nbsp;<span class="op" id="4393287">&gt;</span>&nbsp;<span class="num" id="4393289">0</span>&nbsp;<span class="op" id="4393291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393295">extensionsLength</span>&nbsp;<span class="op" id="4393312">+=</span>&nbsp;<span class="num" id="4393315">2</span>&nbsp;<span class="op" id="4393317">+</span>&nbsp;<span class="num" id="4393319">2</span><span class="op" id="4393320">*</span><span class="builtinfunc" id="4393321">len</span><span class="op" id="4393324">(</span><span class="ident" id="4393325">m</span><span class="op" id="4393326">.</span><span class="ident" id="4393327">signatureAndHashes</span><span class="op" id="4393345">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393349">numExtensions</span><span class="op" id="4393362">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393369">if</span>&nbsp;<span class="ident" id="4393372">m</span><span class="op" id="4393373">.</span><span class="ident" id="4393374">secureRenegotiation</span>&nbsp;<span class="op" id="4393394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393398">extensionsLength</span>&nbsp;<span class="op" id="4393415">+=</span>&nbsp;<span class="num" id="4393418">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393422">numExtensions</span><span class="op" id="4393435">++</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393442">if</span>&nbsp;<span class="builtinfunc" id="4393445">len</span><span class="op" id="4393448">(</span><span class="ident" id="4393449">m</span><span class="op" id="4393450">.</span><span class="ident" id="4393451">alpnProtocols</span><span class="op" id="4393464">)</span>&nbsp;<span class="op" id="4393466">&gt;</span>&nbsp;<span class="num" id="4393468">0</span>&nbsp;<span class="op" id="4393470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393474">extensionsLength</span>&nbsp;<span class="op" id="4393491">+=</span>&nbsp;<span class="num" id="4393494">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393498">for</span>&nbsp;<span class="ident" id="4393502">_</span><span class="op" id="4393503">,</span>&nbsp;<span class="ident" id="4393505">s</span>&nbsp;<span class="op" id="4393507">:=</span>&nbsp;<span class="keyword" id="4393510">range</span>&nbsp;<span class="ident" id="4393516">m</span><span class="op" id="4393517">.</span><span class="ident" id="4393518">alpnProtocols</span>&nbsp;<span class="op" id="4393532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393537">if</span>&nbsp;<span class="ident" id="4393540">l</span>&nbsp;<span class="op" id="4393542">:=</span>&nbsp;<span class="builtinfunc" id="4393545">len</span><span class="op" id="4393548">(</span><span class="ident" id="4393549">s</span><span class="op" id="4393550">)</span><span class="op" id="4393551">;</span>&nbsp;<span class="ident" id="4393553">l</span>&nbsp;<span class="op" id="4393555">==</span>&nbsp;<span class="num" id="4393558">0</span>&nbsp;<span class="op" id="4393560">||</span>&nbsp;<span class="ident" id="4393563">l</span>&nbsp;<span class="op" id="4393565">&gt;</span>&nbsp;<span class="num" id="4393567">255</span>&nbsp;<span class="op" id="4393571">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4393577">panic</span><span class="op" id="4393582">(</span><span class="string" id="4393583">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="4393606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393616">extensionsLength</span><span class="op" id="4393632">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393638">extensionsLength</span>&nbsp;<span class="op" id="4393655">+=</span>&nbsp;<span class="builtinfunc" id="4393658">len</span><span class="op" id="4393661">(</span><span class="ident" id="4393662">s</span><span class="op" id="4393663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393667">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393671">numExtensions</span><span class="op" id="4393684">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4393691">if</span>&nbsp;<span class="ident" id="4393694">numExtensions</span>&nbsp;<span class="op" id="4393708">&gt;</span>&nbsp;<span class="num" id="4393710">0</span>&nbsp;<span class="op" id="4393712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393716">extensionsLength</span>&nbsp;<span class="op" id="4393733">+=</span>&nbsp;<span class="num" id="4393736">4</span>&nbsp;<span class="op" id="4393738">*</span>&nbsp;<span class="ident" id="4393740">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393756">length</span>&nbsp;<span class="op" id="4393763">+=</span>&nbsp;<span class="num" id="4393766">2</span>&nbsp;<span class="op" id="4393768">+</span>&nbsp;<span class="ident" id="4393770">extensionsLength</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4393788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393792">x</span>&nbsp;<span class="op" id="4393794">:=</span>&nbsp;<span class="builtinfunc" id="4393797">make</span><span class="op" id="4393801">(</span><span class="op" id="4393802">[</span><span class="op" id="4393803">]</span><span class="builtintype" id="4393804">byte</span><span class="op" id="4393808">,</span>&nbsp;<span class="num" id="4393810">4</span><span class="op" id="4393811">+</span><span class="ident" id="4393812">length</span><span class="op" id="4393818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393821">x</span><span class="op" id="4393822">[</span><span class="num" id="4393823">0</span><span class="op" id="4393824">]</span>&nbsp;<span class="op" id="4393826">=</span>&nbsp;<span class="ident" id="4393828">typeClientHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393845">x</span><span class="op" id="4393846">[</span><span class="num" id="4393847">1</span><span class="op" id="4393848">]</span>&nbsp;<span class="op" id="4393850">=</span>&nbsp;<span class="builtintype" id="4393852">uint8</span><span class="op" id="4393857">(</span><span class="ident" id="4393858">length</span>&nbsp;<span class="op" id="4393865">&gt;&gt;</span>&nbsp;<span class="num" id="4393868">16</span><span class="op" id="4393870">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393873">x</span><span class="op" id="4393874">[</span><span class="num" id="4393875">2</span><span class="op" id="4393876">]</span>&nbsp;<span class="op" id="4393878">=</span>&nbsp;<span class="builtintype" id="4393880">uint8</span><span class="op" id="4393885">(</span><span class="ident" id="4393886">length</span>&nbsp;<span class="op" id="4393893">&gt;&gt;</span>&nbsp;<span class="num" id="4393896">8</span><span class="op" id="4393897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393900">x</span><span class="op" id="4393901">[</span><span class="num" id="4393902">3</span><span class="op" id="4393903">]</span>&nbsp;<span class="op" id="4393905">=</span>&nbsp;<span class="builtintype" id="4393907">uint8</span><span class="op" id="4393912">(</span><span class="ident" id="4393913">length</span><span class="op" id="4393919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393922">x</span><span class="op" id="4393923">[</span><span class="num" id="4393924">4</span><span class="op" id="4393925">]</span>&nbsp;<span class="op" id="4393927">=</span>&nbsp;<span class="builtintype" id="4393929">uint8</span><span class="op" id="4393934">(</span><span class="ident" id="4393935">m</span><span class="op" id="4393936">.</span><span class="ident" id="4393937">vers</span>&nbsp;<span class="op" id="4393942">&gt;&gt;</span>&nbsp;<span class="num" id="4393945">8</span><span class="op" id="4393946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393949">x</span><span class="op" id="4393950">[</span><span class="num" id="4393951">5</span><span class="op" id="4393952">]</span>&nbsp;<span class="op" id="4393954">=</span>&nbsp;<span class="builtintype" id="4393956">uint8</span><span class="op" id="4393961">(</span><span class="ident" id="4393962">m</span><span class="op" id="4393963">.</span><span class="ident" id="4393964">vers</span><span class="op" id="4393968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4393971">copy</span><span class="op" id="4393975">(</span><span class="ident" id="4393976">x</span><span class="op" id="4393977">[</span><span class="num" id="4393978">6</span><span class="op" id="4393979">:</span><span class="num" id="4393980">38</span><span class="op" id="4393982">]</span><span class="op" id="4393983">,</span>&nbsp;<span class="ident" id="4393985">m</span><span class="op" id="4393986">.</span><span class="ident" id="4393987">random</span><span class="op" id="4393993">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4393996">x</span><span class="op" id="4393997">[</span><span class="num" id="4393998">38</span><span class="op" id="4394000">]</span>&nbsp;<span class="op" id="4394002">=</span>&nbsp;<span class="builtintype" id="4394004">uint8</span><span class="op" id="4394009">(</span><span class="builtinfunc" id="4394010">len</span><span class="op" id="4394013">(</span><span class="ident" id="4394014">m</span><span class="op" id="4394015">.</span><span class="ident" id="4394016">sessionId</span><span class="op" id="4394025">)</span><span class="op" id="4394026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4394029">copy</span><span class="op" id="4394033">(</span><span class="ident" id="4394034">x</span><span class="op" id="4394035">[</span><span class="num" id="4394036">39</span><span class="op" id="4394038">:</span><span class="num" id="4394039">39</span><span class="op" id="4394041">+</span><span class="builtinfunc" id="4394042">len</span><span class="op" id="4394045">(</span><span class="ident" id="4394046">m</span><span class="op" id="4394047">.</span><span class="ident" id="4394048">sessionId</span><span class="op" id="4394057">)</span><span class="op" id="4394058">]</span><span class="op" id="4394059">,</span>&nbsp;<span class="ident" id="4394061">m</span><span class="op" id="4394062">.</span><span class="ident" id="4394063">sessionId</span><span class="op" id="4394072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394075">y</span>&nbsp;<span class="op" id="4394077">:=</span>&nbsp;<span class="ident" id="4394080">x</span><span class="op" id="4394081">[</span><span class="num" id="4394082">39</span><span class="op" id="4394084">+</span><span class="builtinfunc" id="4394085">len</span><span class="op" id="4394088">(</span><span class="ident" id="4394089">m</span><span class="op" id="4394090">.</span><span class="ident" id="4394091">sessionId</span><span class="op" id="4394100">)</span><span class="op" id="4394101">:</span><span class="op" id="4394102">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394105">y</span><span class="op" id="4394106">[</span><span class="num" id="4394107">0</span><span class="op" id="4394108">]</span>&nbsp;<span class="op" id="4394110">=</span>&nbsp;<span class="builtintype" id="4394112">uint8</span><span class="op" id="4394117">(</span><span class="builtinfunc" id="4394118">len</span><span class="op" id="4394121">(</span><span class="ident" id="4394122">m</span><span class="op" id="4394123">.</span><span class="ident" id="4394124">cipherSuites</span><span class="op" id="4394136">)</span>&nbsp;<span class="op" id="4394138">&gt;&gt;</span>&nbsp;<span class="num" id="4394141">7</span><span class="op" id="4394142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394145">y</span><span class="op" id="4394146">[</span><span class="num" id="4394147">1</span><span class="op" id="4394148">]</span>&nbsp;<span class="op" id="4394150">=</span>&nbsp;<span class="builtintype" id="4394152">uint8</span><span class="op" id="4394157">(</span><span class="builtinfunc" id="4394158">len</span><span class="op" id="4394161">(</span><span class="ident" id="4394162">m</span><span class="op" id="4394163">.</span><span class="ident" id="4394164">cipherSuites</span><span class="op" id="4394176">)</span>&nbsp;<span class="op" id="4394178">&lt;&lt;</span>&nbsp;<span class="num" id="4394181">1</span><span class="op" id="4394182">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4394185">for</span>&nbsp;<span class="ident" id="4394189">i</span><span class="op" id="4394190">,</span>&nbsp;<span class="ident" id="4394192">suite</span>&nbsp;<span class="op" id="4394198">:=</span>&nbsp;<span class="keyword" id="4394201">range</span>&nbsp;<span class="ident" id="4394207">m</span><span class="op" id="4394208">.</span><span class="ident" id="4394209">cipherSuites</span>&nbsp;<span class="op" id="4394222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394226">y</span><span class="op" id="4394227">[</span><span class="num" id="4394228">2</span><span class="op" id="4394229">+</span><span class="ident" id="4394230">i</span><span class="op" id="4394231">*</span><span class="num" id="4394232">2</span><span class="op" id="4394233">]</span>&nbsp;<span class="op" id="4394235">=</span>&nbsp;<span class="builtintype" id="4394237">uint8</span><span class="op" id="4394242">(</span><span class="ident" id="4394243">suite</span>&nbsp;<span class="op" id="4394249">&gt;&gt;</span>&nbsp;<span class="num" id="4394252">8</span><span class="op" id="4394253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394257">y</span><span class="op" id="4394258">[</span><span class="num" id="4394259">3</span><span class="op" id="4394260">+</span><span class="ident" id="4394261">i</span><span class="op" id="4394262">*</span><span class="num" id="4394263">2</span><span class="op" id="4394264">]</span>&nbsp;<span class="op" id="4394266">=</span>&nbsp;<span class="builtintype" id="4394268">uint8</span><span class="op" id="4394273">(</span><span class="ident" id="4394274">suite</span><span class="op" id="4394279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394285">z</span>&nbsp;<span class="op" id="4394287">:=</span>&nbsp;<span class="ident" id="4394290">y</span><span class="op" id="4394291">[</span><span class="num" id="4394292">2</span><span class="op" id="4394293">+</span><span class="builtinfunc" id="4394294">len</span><span class="op" id="4394297">(</span><span class="ident" id="4394298">m</span><span class="op" id="4394299">.</span><span class="ident" id="4394300">cipherSuites</span><span class="op" id="4394312">)</span><span class="op" id="4394313">*</span><span class="num" id="4394314">2</span><span class="op" id="4394315">:</span><span class="op" id="4394316">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394319">z</span><span class="op" id="4394320">[</span><span class="num" id="4394321">0</span><span class="op" id="4394322">]</span>&nbsp;<span class="op" id="4394324">=</span>&nbsp;<span class="builtintype" id="4394326">uint8</span><span class="op" id="4394331">(</span><span class="builtinfunc" id="4394332">len</span><span class="op" id="4394335">(</span><span class="ident" id="4394336">m</span><span class="op" id="4394337">.</span><span class="ident" id="4394338">compressionMethods</span><span class="op" id="4394356">)</span><span class="op" id="4394357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4394360">copy</span><span class="op" id="4394364">(</span><span class="ident" id="4394365">z</span><span class="op" id="4394366">[</span><span class="num" id="4394367">1</span><span class="op" id="4394368">:</span><span class="op" id="4394369">]</span><span class="op" id="4394370">,</span>&nbsp;<span class="ident" id="4394372">m</span><span class="op" id="4394373">.</span><span class="ident" id="4394374">compressionMethods</span><span class="op" id="4394392">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394396">z</span>&nbsp;<span class="op" id="4394398">=</span>&nbsp;<span class="ident" id="4394400">z</span><span class="op" id="4394401">[</span><span class="num" id="4394402">1</span><span class="op" id="4394403">+</span><span class="builtinfunc" id="4394404">len</span><span class="op" id="4394407">(</span><span class="ident" id="4394408">m</span><span class="op" id="4394409">.</span><span class="ident" id="4394410">compressionMethods</span><span class="op" id="4394428">)</span><span class="op" id="4394429">:</span><span class="op" id="4394430">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4394433">if</span>&nbsp;<span class="ident" id="4394436">numExtensions</span>&nbsp;<span class="op" id="4394450">&gt;</span>&nbsp;<span class="num" id="4394452">0</span>&nbsp;<span class="op" id="4394454">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394458">z</span><span class="op" id="4394459">[</span><span class="num" id="4394460">0</span><span class="op" id="4394461">]</span>&nbsp;<span class="op" id="4394463">=</span>&nbsp;<span class="builtintype" id="4394465">byte</span><span class="op" id="4394469">(</span><span class="ident" id="4394470">extensionsLength</span>&nbsp;<span class="op" id="4394487">&gt;&gt;</span>&nbsp;<span class="num" id="4394490">8</span><span class="op" id="4394491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394495">z</span><span class="op" id="4394496">[</span><span class="num" id="4394497">1</span><span class="op" id="4394498">]</span>&nbsp;<span class="op" id="4394500">=</span>&nbsp;<span class="builtintype" id="4394502">byte</span><span class="op" id="4394506">(</span><span class="ident" id="4394507">extensionsLength</span><span class="op" id="4394523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394527">z</span>&nbsp;<span class="op" id="4394529">=</span>&nbsp;<span class="ident" id="4394531">z</span><span class="op" id="4394532">[</span><span class="num" id="4394533">2</span><span class="op" id="4394534">:</span><span class="op" id="4394535">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4394541">if</span>&nbsp;<span class="ident" id="4394544">m</span><span class="op" id="4394545">.</span><span class="ident" id="4394546">nextProtoNeg</span>&nbsp;<span class="op" id="4394559">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394563">z</span><span class="op" id="4394564">[</span><span class="num" id="4394565">0</span><span class="op" id="4394566">]</span>&nbsp;<span class="op" id="4394568">=</span>&nbsp;<span class="builtintype" id="4394570">byte</span><span class="op" id="4394574">(</span><span class="ident" id="4394575">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4394597">&gt;&gt;</span>&nbsp;<span class="num" id="4394600">8</span><span class="op" id="4394601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394605">z</span><span class="op" id="4394606">[</span><span class="num" id="4394607">1</span><span class="op" id="4394608">]</span>&nbsp;<span class="op" id="4394610">=</span>&nbsp;<span class="builtintype" id="4394612">byte</span><span class="op" id="4394616">(</span><span class="ident" id="4394617">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4394639">&amp;</span>&nbsp;<span class="num" id="4394641">0xff</span><span class="op" id="4394645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4394649">//&nbsp;The&nbsp;length&nbsp;is&nbsp;always&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394677">z</span>&nbsp;<span class="op" id="4394679">=</span>&nbsp;<span class="ident" id="4394681">z</span><span class="op" id="4394682">[</span><span class="num" id="4394683">4</span><span class="op" id="4394684">:</span><span class="op" id="4394685">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4394688">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4394691">if</span>&nbsp;<span class="builtinfunc" id="4394694">len</span><span class="op" id="4394697">(</span><span class="ident" id="4394698">m</span><span class="op" id="4394699">.</span><span class="ident" id="4394700">serverName</span><span class="op" id="4394710">)</span>&nbsp;<span class="op" id="4394712">&gt;</span>&nbsp;<span class="num" id="4394714">0</span>&nbsp;<span class="op" id="4394716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394720">z</span><span class="op" id="4394721">[</span><span class="num" id="4394722">0</span><span class="op" id="4394723">]</span>&nbsp;<span class="op" id="4394725">=</span>&nbsp;<span class="builtintype" id="4394727">byte</span><span class="op" id="4394731">(</span><span class="ident" id="4394732">extensionServerName</span>&nbsp;<span class="op" id="4394752">&gt;&gt;</span>&nbsp;<span class="num" id="4394755">8</span><span class="op" id="4394756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394760">z</span><span class="op" id="4394761">[</span><span class="num" id="4394762">1</span><span class="op" id="4394763">]</span>&nbsp;<span class="op" id="4394765">=</span>&nbsp;<span class="builtintype" id="4394767">byte</span><span class="op" id="4394771">(</span><span class="ident" id="4394772">extensionServerName</span>&nbsp;<span class="op" id="4394792">&amp;</span>&nbsp;<span class="num" id="4394794">0xff</span><span class="op" id="4394798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394802">l</span>&nbsp;<span class="op" id="4394804">:=</span>&nbsp;<span class="builtinfunc" id="4394807">len</span><span class="op" id="4394810">(</span><span class="ident" id="4394811">m</span><span class="op" id="4394812">.</span><span class="ident" id="4394813">serverName</span><span class="op" id="4394823">)</span>&nbsp;<span class="op" id="4394825">+</span>&nbsp;<span class="num" id="4394827">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394831">z</span><span class="op" id="4394832">[</span><span class="num" id="4394833">2</span><span class="op" id="4394834">]</span>&nbsp;<span class="op" id="4394836">=</span>&nbsp;<span class="builtintype" id="4394838">byte</span><span class="op" id="4394842">(</span><span class="ident" id="4394843">l</span>&nbsp;<span class="op" id="4394845">&gt;&gt;</span>&nbsp;<span class="num" id="4394848">8</span><span class="op" id="4394849">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394853">z</span><span class="op" id="4394854">[</span><span class="num" id="4394855">3</span><span class="op" id="4394856">]</span>&nbsp;<span class="op" id="4394858">=</span>&nbsp;<span class="builtintype" id="4394860">byte</span><span class="op" id="4394864">(</span><span class="ident" id="4394865">l</span><span class="op" id="4394866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4394870">z</span>&nbsp;<span class="op" id="4394872">=</span>&nbsp;<span class="ident" id="4394874">z</span><span class="op" id="4394875">[</span><span class="num" id="4394876">4</span><span class="op" id="4394877">:</span><span class="op" id="4394878">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4394883">//&nbsp;RFC&nbsp;3546,&nbsp;section&nbsp;3.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4394910">//</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4394915">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4394929">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NameType&nbsp;name_type;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4394958">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;(name_type)&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4394988">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;host_name:&nbsp;HostName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395027">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;name;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395044">//&nbsp;}&nbsp;ServerName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395063">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395068">//&nbsp;enum&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395080">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_name(0),&nbsp;(255)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395109">//&nbsp;}&nbsp;NameType;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395126">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395131">//&nbsp;opaque&nbsp;HostName&lt;1..2^16-1&gt;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395164">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395169">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395183">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerName&nbsp;server_name_list&lt;1..2^16-1&gt;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395231">//&nbsp;}&nbsp;ServerNameList;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395255">z</span><span class="op" id="4395256">[</span><span class="num" id="4395257">0</span><span class="op" id="4395258">]</span>&nbsp;<span class="op" id="4395260">=</span>&nbsp;<span class="builtintype" id="4395262">byte</span><span class="op" id="4395266">(</span><span class="op" id="4395267">(</span><span class="builtinfunc" id="4395268">len</span><span class="op" id="4395271">(</span><span class="ident" id="4395272">m</span><span class="op" id="4395273">.</span><span class="ident" id="4395274">serverName</span><span class="op" id="4395284">)</span>&nbsp;<span class="op" id="4395286">+</span>&nbsp;<span class="num" id="4395288">3</span><span class="op" id="4395289">)</span>&nbsp;<span class="op" id="4395291">&gt;&gt;</span>&nbsp;<span class="num" id="4395294">8</span><span class="op" id="4395295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395299">z</span><span class="op" id="4395300">[</span><span class="num" id="4395301">1</span><span class="op" id="4395302">]</span>&nbsp;<span class="op" id="4395304">=</span>&nbsp;<span class="builtintype" id="4395306">byte</span><span class="op" id="4395310">(</span><span class="builtinfunc" id="4395311">len</span><span class="op" id="4395314">(</span><span class="ident" id="4395315">m</span><span class="op" id="4395316">.</span><span class="ident" id="4395317">serverName</span><span class="op" id="4395327">)</span>&nbsp;<span class="op" id="4395329">+</span>&nbsp;<span class="num" id="4395331">3</span><span class="op" id="4395332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395336">z</span><span class="op" id="4395337">[</span><span class="num" id="4395338">3</span><span class="op" id="4395339">]</span>&nbsp;<span class="op" id="4395341">=</span>&nbsp;<span class="builtintype" id="4395343">byte</span><span class="op" id="4395347">(</span><span class="builtinfunc" id="4395348">len</span><span class="op" id="4395351">(</span><span class="ident" id="4395352">m</span><span class="op" id="4395353">.</span><span class="ident" id="4395354">serverName</span><span class="op" id="4395364">)</span>&nbsp;<span class="op" id="4395366">&gt;&gt;</span>&nbsp;<span class="num" id="4395369">8</span><span class="op" id="4395370">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395374">z</span><span class="op" id="4395375">[</span><span class="num" id="4395376">4</span><span class="op" id="4395377">]</span>&nbsp;<span class="op" id="4395379">=</span>&nbsp;<span class="builtintype" id="4395381">byte</span><span class="op" id="4395385">(</span><span class="builtinfunc" id="4395386">len</span><span class="op" id="4395389">(</span><span class="ident" id="4395390">m</span><span class="op" id="4395391">.</span><span class="ident" id="4395392">serverName</span><span class="op" id="4395402">)</span><span class="op" id="4395403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4395407">copy</span><span class="op" id="4395411">(</span><span class="ident" id="4395412">z</span><span class="op" id="4395413">[</span><span class="num" id="4395414">5</span><span class="op" id="4395415">:</span><span class="op" id="4395416">]</span><span class="op" id="4395417">,</span>&nbsp;<span class="op" id="4395419">[</span><span class="op" id="4395420">]</span><span class="builtintype" id="4395421">byte</span><span class="op" id="4395425">(</span><span class="ident" id="4395426">m</span><span class="op" id="4395427">.</span><span class="ident" id="4395428">serverName</span><span class="op" id="4395438">)</span><span class="op" id="4395439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395443">z</span>&nbsp;<span class="op" id="4395445">=</span>&nbsp;<span class="ident" id="4395447">z</span><span class="op" id="4395448">[</span><span class="ident" id="4395449">l</span><span class="op" id="4395450">:</span><span class="op" id="4395451">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4395454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4395457">if</span>&nbsp;<span class="ident" id="4395460">m</span><span class="op" id="4395461">.</span><span class="ident" id="4395462">ocspStapling</span>&nbsp;<span class="op" id="4395475">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395479">//&nbsp;RFC&nbsp;4366,&nbsp;section&nbsp;3.6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395506">z</span><span class="op" id="4395507">[</span><span class="num" id="4395508">0</span><span class="op" id="4395509">]</span>&nbsp;<span class="op" id="4395511">=</span>&nbsp;<span class="builtintype" id="4395513">byte</span><span class="op" id="4395517">(</span><span class="ident" id="4395518">extensionStatusRequest</span>&nbsp;<span class="op" id="4395541">&gt;&gt;</span>&nbsp;<span class="num" id="4395544">8</span><span class="op" id="4395545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395549">z</span><span class="op" id="4395550">[</span><span class="num" id="4395551">1</span><span class="op" id="4395552">]</span>&nbsp;<span class="op" id="4395554">=</span>&nbsp;<span class="builtintype" id="4395556">byte</span><span class="op" id="4395560">(</span><span class="ident" id="4395561">extensionStatusRequest</span><span class="op" id="4395583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395587">z</span><span class="op" id="4395588">[</span><span class="num" id="4395589">2</span><span class="op" id="4395590">]</span>&nbsp;<span class="op" id="4395592">=</span>&nbsp;<span class="num" id="4395594">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395598">z</span><span class="op" id="4395599">[</span><span class="num" id="4395600">3</span><span class="op" id="4395601">]</span>&nbsp;<span class="op" id="4395603">=</span>&nbsp;<span class="num" id="4395605">5</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395609">z</span><span class="op" id="4395610">[</span><span class="num" id="4395611">4</span><span class="op" id="4395612">]</span>&nbsp;<span class="op" id="4395614">=</span>&nbsp;<span class="num" id="4395616">1</span>&nbsp;<span class="comment" id="4395618">//&nbsp;OCSP&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395633">//&nbsp;Two&nbsp;zero&nbsp;valued&nbsp;uint16s&nbsp;for&nbsp;the&nbsp;two&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395683">z</span>&nbsp;<span class="op" id="4395685">=</span>&nbsp;<span class="ident" id="4395687">z</span><span class="op" id="4395688">[</span><span class="num" id="4395689">9</span><span class="op" id="4395690">:</span><span class="op" id="4395691">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4395694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4395697">if</span>&nbsp;<span class="builtinfunc" id="4395700">len</span><span class="op" id="4395703">(</span><span class="ident" id="4395704">m</span><span class="op" id="4395705">.</span><span class="ident" id="4395706">supportedCurves</span><span class="op" id="4395721">)</span>&nbsp;<span class="op" id="4395723">&gt;</span>&nbsp;<span class="num" id="4395725">0</span>&nbsp;<span class="op" id="4395727">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4395731">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395785">z</span><span class="op" id="4395786">[</span><span class="num" id="4395787">0</span><span class="op" id="4395788">]</span>&nbsp;<span class="op" id="4395790">=</span>&nbsp;<span class="builtintype" id="4395792">byte</span><span class="op" id="4395796">(</span><span class="ident" id="4395797">extensionSupportedCurves</span>&nbsp;<span class="op" id="4395822">&gt;&gt;</span>&nbsp;<span class="num" id="4395825">8</span><span class="op" id="4395826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395830">z</span><span class="op" id="4395831">[</span><span class="num" id="4395832">1</span><span class="op" id="4395833">]</span>&nbsp;<span class="op" id="4395835">=</span>&nbsp;<span class="builtintype" id="4395837">byte</span><span class="op" id="4395841">(</span><span class="ident" id="4395842">extensionSupportedCurves</span><span class="op" id="4395866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395870">l</span>&nbsp;<span class="op" id="4395872">:=</span>&nbsp;<span class="num" id="4395875">2</span>&nbsp;<span class="op" id="4395877">+</span>&nbsp;<span class="num" id="4395879">2</span><span class="op" id="4395880">*</span><span class="builtinfunc" id="4395881">len</span><span class="op" id="4395884">(</span><span class="ident" id="4395885">m</span><span class="op" id="4395886">.</span><span class="ident" id="4395887">supportedCurves</span><span class="op" id="4395902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395906">z</span><span class="op" id="4395907">[</span><span class="num" id="4395908">2</span><span class="op" id="4395909">]</span>&nbsp;<span class="op" id="4395911">=</span>&nbsp;<span class="builtintype" id="4395913">byte</span><span class="op" id="4395917">(</span><span class="ident" id="4395918">l</span>&nbsp;<span class="op" id="4395920">&gt;&gt;</span>&nbsp;<span class="num" id="4395923">8</span><span class="op" id="4395924">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395928">z</span><span class="op" id="4395929">[</span><span class="num" id="4395930">3</span><span class="op" id="4395931">]</span>&nbsp;<span class="op" id="4395933">=</span>&nbsp;<span class="builtintype" id="4395935">byte</span><span class="op" id="4395939">(</span><span class="ident" id="4395940">l</span><span class="op" id="4395941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395945">l</span>&nbsp;<span class="op" id="4395947">-=</span>&nbsp;<span class="num" id="4395950">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395954">z</span><span class="op" id="4395955">[</span><span class="num" id="4395956">4</span><span class="op" id="4395957">]</span>&nbsp;<span class="op" id="4395959">=</span>&nbsp;<span class="builtintype" id="4395961">byte</span><span class="op" id="4395965">(</span><span class="ident" id="4395966">l</span>&nbsp;<span class="op" id="4395968">&gt;&gt;</span>&nbsp;<span class="num" id="4395971">8</span><span class="op" id="4395972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395976">z</span><span class="op" id="4395977">[</span><span class="num" id="4395978">5</span><span class="op" id="4395979">]</span>&nbsp;<span class="op" id="4395981">=</span>&nbsp;<span class="builtintype" id="4395983">byte</span><span class="op" id="4395987">(</span><span class="ident" id="4395988">l</span><span class="op" id="4395989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4395993">z</span>&nbsp;<span class="op" id="4395995">=</span>&nbsp;<span class="ident" id="4395997">z</span><span class="op" id="4395998">[</span><span class="num" id="4395999">6</span><span class="op" id="4396000">:</span><span class="op" id="4396001">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4396005">for</span>&nbsp;<span class="ident" id="4396009">_</span><span class="op" id="4396010">,</span>&nbsp;<span class="ident" id="4396012">curve</span>&nbsp;<span class="op" id="4396018">:=</span>&nbsp;<span class="keyword" id="4396021">range</span>&nbsp;<span class="ident" id="4396027">m</span><span class="op" id="4396028">.</span><span class="ident" id="4396029">supportedCurves</span>&nbsp;<span class="op" id="4396045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396050">z</span><span class="op" id="4396051">[</span><span class="num" id="4396052">0</span><span class="op" id="4396053">]</span>&nbsp;<span class="op" id="4396055">=</span>&nbsp;<span class="builtintype" id="4396057">byte</span><span class="op" id="4396061">(</span><span class="ident" id="4396062">curve</span>&nbsp;<span class="op" id="4396068">&gt;&gt;</span>&nbsp;<span class="num" id="4396071">8</span><span class="op" id="4396072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396077">z</span><span class="op" id="4396078">[</span><span class="num" id="4396079">1</span><span class="op" id="4396080">]</span>&nbsp;<span class="op" id="4396082">=</span>&nbsp;<span class="builtintype" id="4396084">byte</span><span class="op" id="4396088">(</span><span class="ident" id="4396089">curve</span><span class="op" id="4396094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396099">z</span>&nbsp;<span class="op" id="4396101">=</span>&nbsp;<span class="ident" id="4396103">z</span><span class="op" id="4396104">[</span><span class="num" id="4396105">2</span><span class="op" id="4396106">:</span><span class="op" id="4396107">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4396111">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4396114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4396117">if</span>&nbsp;<span class="builtinfunc" id="4396120">len</span><span class="op" id="4396123">(</span><span class="ident" id="4396124">m</span><span class="op" id="4396125">.</span><span class="ident" id="4396126">supportedPoints</span><span class="op" id="4396141">)</span>&nbsp;<span class="op" id="4396143">&gt;</span>&nbsp;<span class="num" id="4396145">0</span>&nbsp;<span class="op" id="4396147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4396151">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396205">z</span><span class="op" id="4396206">[</span><span class="num" id="4396207">0</span><span class="op" id="4396208">]</span>&nbsp;<span class="op" id="4396210">=</span>&nbsp;<span class="builtintype" id="4396212">byte</span><span class="op" id="4396216">(</span><span class="ident" id="4396217">extensionSupportedPoints</span>&nbsp;<span class="op" id="4396242">&gt;&gt;</span>&nbsp;<span class="num" id="4396245">8</span><span class="op" id="4396246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396250">z</span><span class="op" id="4396251">[</span><span class="num" id="4396252">1</span><span class="op" id="4396253">]</span>&nbsp;<span class="op" id="4396255">=</span>&nbsp;<span class="builtintype" id="4396257">byte</span><span class="op" id="4396261">(</span><span class="ident" id="4396262">extensionSupportedPoints</span><span class="op" id="4396286">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396290">l</span>&nbsp;<span class="op" id="4396292">:=</span>&nbsp;<span class="num" id="4396295">1</span>&nbsp;<span class="op" id="4396297">+</span>&nbsp;<span class="builtinfunc" id="4396299">len</span><span class="op" id="4396302">(</span><span class="ident" id="4396303">m</span><span class="op" id="4396304">.</span><span class="ident" id="4396305">supportedPoints</span><span class="op" id="4396320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396324">z</span><span class="op" id="4396325">[</span><span class="num" id="4396326">2</span><span class="op" id="4396327">]</span>&nbsp;<span class="op" id="4396329">=</span>&nbsp;<span class="builtintype" id="4396331">byte</span><span class="op" id="4396335">(</span><span class="ident" id="4396336">l</span>&nbsp;<span class="op" id="4396338">&gt;&gt;</span>&nbsp;<span class="num" id="4396341">8</span><span class="op" id="4396342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396346">z</span><span class="op" id="4396347">[</span><span class="num" id="4396348">3</span><span class="op" id="4396349">]</span>&nbsp;<span class="op" id="4396351">=</span>&nbsp;<span class="builtintype" id="4396353">byte</span><span class="op" id="4396357">(</span><span class="ident" id="4396358">l</span><span class="op" id="4396359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396363">l</span><span class="op" id="4396364">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396369">z</span><span class="op" id="4396370">[</span><span class="num" id="4396371">4</span><span class="op" id="4396372">]</span>&nbsp;<span class="op" id="4396374">=</span>&nbsp;<span class="builtintype" id="4396376">byte</span><span class="op" id="4396380">(</span><span class="ident" id="4396381">l</span><span class="op" id="4396382">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396386">z</span>&nbsp;<span class="op" id="4396388">=</span>&nbsp;<span class="ident" id="4396390">z</span><span class="op" id="4396391">[</span><span class="num" id="4396392">5</span><span class="op" id="4396393">:</span><span class="op" id="4396394">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4396398">for</span>&nbsp;<span class="ident" id="4396402">_</span><span class="op" id="4396403">,</span>&nbsp;<span class="ident" id="4396405">pointFormat</span>&nbsp;<span class="op" id="4396417">:=</span>&nbsp;<span class="keyword" id="4396420">range</span>&nbsp;<span class="ident" id="4396426">m</span><span class="op" id="4396427">.</span><span class="ident" id="4396428">supportedPoints</span>&nbsp;<span class="op" id="4396444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396449">z</span><span class="op" id="4396450">[</span><span class="num" id="4396451">0</span><span class="op" id="4396452">]</span>&nbsp;<span class="op" id="4396454">=</span>&nbsp;<span class="builtintype" id="4396456">byte</span><span class="op" id="4396460">(</span><span class="ident" id="4396461">pointFormat</span><span class="op" id="4396472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396477">z</span>&nbsp;<span class="op" id="4396479">=</span>&nbsp;<span class="ident" id="4396481">z</span><span class="op" id="4396482">[</span><span class="num" id="4396483">1</span><span class="op" id="4396484">:</span><span class="op" id="4396485">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4396489">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4396492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4396495">if</span>&nbsp;<span class="ident" id="4396498">m</span><span class="op" id="4396499">.</span><span class="ident" id="4396500">ticketSupported</span>&nbsp;<span class="op" id="4396516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4396520">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396572">z</span><span class="op" id="4396573">[</span><span class="num" id="4396574">0</span><span class="op" id="4396575">]</span>&nbsp;<span class="op" id="4396577">=</span>&nbsp;<span class="builtintype" id="4396579">byte</span><span class="op" id="4396583">(</span><span class="ident" id="4396584">extensionSessionTicket</span>&nbsp;<span class="op" id="4396607">&gt;&gt;</span>&nbsp;<span class="num" id="4396610">8</span><span class="op" id="4396611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396615">z</span><span class="op" id="4396616">[</span><span class="num" id="4396617">1</span><span class="op" id="4396618">]</span>&nbsp;<span class="op" id="4396620">=</span>&nbsp;<span class="builtintype" id="4396622">byte</span><span class="op" id="4396626">(</span><span class="ident" id="4396627">extensionSessionTicket</span><span class="op" id="4396649">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396653">l</span>&nbsp;<span class="op" id="4396655">:=</span>&nbsp;<span class="builtinfunc" id="4396658">len</span><span class="op" id="4396661">(</span><span class="ident" id="4396662">m</span><span class="op" id="4396663">.</span><span class="ident" id="4396664">sessionTicket</span><span class="op" id="4396677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396681">z</span><span class="op" id="4396682">[</span><span class="num" id="4396683">2</span><span class="op" id="4396684">]</span>&nbsp;<span class="op" id="4396686">=</span>&nbsp;<span class="builtintype" id="4396688">byte</span><span class="op" id="4396692">(</span><span class="ident" id="4396693">l</span>&nbsp;<span class="op" id="4396695">&gt;&gt;</span>&nbsp;<span class="num" id="4396698">8</span><span class="op" id="4396699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396703">z</span><span class="op" id="4396704">[</span><span class="num" id="4396705">3</span><span class="op" id="4396706">]</span>&nbsp;<span class="op" id="4396708">=</span>&nbsp;<span class="builtintype" id="4396710">byte</span><span class="op" id="4396714">(</span><span class="ident" id="4396715">l</span><span class="op" id="4396716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396720">z</span>&nbsp;<span class="op" id="4396722">=</span>&nbsp;<span class="ident" id="4396724">z</span><span class="op" id="4396725">[</span><span class="num" id="4396726">4</span><span class="op" id="4396727">:</span><span class="op" id="4396728">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4396732">copy</span><span class="op" id="4396736">(</span><span class="ident" id="4396737">z</span><span class="op" id="4396738">,</span>&nbsp;<span class="ident" id="4396740">m</span><span class="op" id="4396741">.</span><span class="ident" id="4396742">sessionTicket</span><span class="op" id="4396755">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396759">z</span>&nbsp;<span class="op" id="4396761">=</span>&nbsp;<span class="ident" id="4396763">z</span><span class="op" id="4396764">[</span><span class="builtinfunc" id="4396765">len</span><span class="op" id="4396768">(</span><span class="ident" id="4396769">m</span><span class="op" id="4396770">.</span><span class="ident" id="4396771">sessionTicket</span><span class="op" id="4396784">)</span><span class="op" id="4396785">:</span><span class="op" id="4396786">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4396789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4396792">if</span>&nbsp;<span class="builtinfunc" id="4396795">len</span><span class="op" id="4396798">(</span><span class="ident" id="4396799">m</span><span class="op" id="4396800">.</span><span class="ident" id="4396801">signatureAndHashes</span><span class="op" id="4396819">)</span>&nbsp;<span class="op" id="4396821">&gt;</span>&nbsp;<span class="num" id="4396823">0</span>&nbsp;<span class="op" id="4396825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4396829">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396888">z</span><span class="op" id="4396889">[</span><span class="num" id="4396890">0</span><span class="op" id="4396891">]</span>&nbsp;<span class="op" id="4396893">=</span>&nbsp;<span class="builtintype" id="4396895">byte</span><span class="op" id="4396899">(</span><span class="ident" id="4396900">extensionSignatureAlgorithms</span>&nbsp;<span class="op" id="4396929">&gt;&gt;</span>&nbsp;<span class="num" id="4396932">8</span><span class="op" id="4396933">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396937">z</span><span class="op" id="4396938">[</span><span class="num" id="4396939">1</span><span class="op" id="4396940">]</span>&nbsp;<span class="op" id="4396942">=</span>&nbsp;<span class="builtintype" id="4396944">byte</span><span class="op" id="4396948">(</span><span class="ident" id="4396949">extensionSignatureAlgorithms</span><span class="op" id="4396977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4396981">l</span>&nbsp;<span class="op" id="4396983">:=</span>&nbsp;<span class="num" id="4396986">2</span>&nbsp;<span class="op" id="4396988">+</span>&nbsp;<span class="num" id="4396990">2</span><span class="op" id="4396991">*</span><span class="builtinfunc" id="4396992">len</span><span class="op" id="4396995">(</span><span class="ident" id="4396996">m</span><span class="op" id="4396997">.</span><span class="ident" id="4396998">signatureAndHashes</span><span class="op" id="4397016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397020">z</span><span class="op" id="4397021">[</span><span class="num" id="4397022">2</span><span class="op" id="4397023">]</span>&nbsp;<span class="op" id="4397025">=</span>&nbsp;<span class="builtintype" id="4397027">byte</span><span class="op" id="4397031">(</span><span class="ident" id="4397032">l</span>&nbsp;<span class="op" id="4397034">&gt;&gt;</span>&nbsp;<span class="num" id="4397037">8</span><span class="op" id="4397038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397042">z</span><span class="op" id="4397043">[</span><span class="num" id="4397044">3</span><span class="op" id="4397045">]</span>&nbsp;<span class="op" id="4397047">=</span>&nbsp;<span class="builtintype" id="4397049">byte</span><span class="op" id="4397053">(</span><span class="ident" id="4397054">l</span><span class="op" id="4397055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397059">z</span>&nbsp;<span class="op" id="4397061">=</span>&nbsp;<span class="ident" id="4397063">z</span><span class="op" id="4397064">[</span><span class="num" id="4397065">4</span><span class="op" id="4397066">:</span><span class="op" id="4397067">]</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397072">l</span>&nbsp;<span class="op" id="4397074">-=</span>&nbsp;<span class="num" id="4397077">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397081">z</span><span class="op" id="4397082">[</span><span class="num" id="4397083">0</span><span class="op" id="4397084">]</span>&nbsp;<span class="op" id="4397086">=</span>&nbsp;<span class="builtintype" id="4397088">byte</span><span class="op" id="4397092">(</span><span class="ident" id="4397093">l</span>&nbsp;<span class="op" id="4397095">&gt;&gt;</span>&nbsp;<span class="num" id="4397098">8</span><span class="op" id="4397099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397103">z</span><span class="op" id="4397104">[</span><span class="num" id="4397105">1</span><span class="op" id="4397106">]</span>&nbsp;<span class="op" id="4397108">=</span>&nbsp;<span class="builtintype" id="4397110">byte</span><span class="op" id="4397114">(</span><span class="ident" id="4397115">l</span><span class="op" id="4397116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397120">z</span>&nbsp;<span class="op" id="4397122">=</span>&nbsp;<span class="ident" id="4397124">z</span><span class="op" id="4397125">[</span><span class="num" id="4397126">2</span><span class="op" id="4397127">:</span><span class="op" id="4397128">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4397132">for</span>&nbsp;<span class="ident" id="4397136">_</span><span class="op" id="4397137">,</span>&nbsp;<span class="ident" id="4397139">sigAndHash</span>&nbsp;<span class="op" id="4397150">:=</span>&nbsp;<span class="keyword" id="4397153">range</span>&nbsp;<span class="ident" id="4397159">m</span><span class="op" id="4397160">.</span><span class="ident" id="4397161">signatureAndHashes</span>&nbsp;<span class="op" id="4397180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397185">z</span><span class="op" id="4397186">[</span><span class="num" id="4397187">0</span><span class="op" id="4397188">]</span>&nbsp;<span class="op" id="4397190">=</span>&nbsp;<span class="ident" id="4397192">sigAndHash</span><span class="op" id="4397202">.</span><span class="ident" id="4397203">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397211">z</span><span class="op" id="4397212">[</span><span class="num" id="4397213">1</span><span class="op" id="4397214">]</span>&nbsp;<span class="op" id="4397216">=</span>&nbsp;<span class="ident" id="4397218">sigAndHash</span><span class="op" id="4397228">.</span><span class="ident" id="4397229">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397242">z</span>&nbsp;<span class="op" id="4397244">=</span>&nbsp;<span class="ident" id="4397246">z</span><span class="op" id="4397247">[</span><span class="num" id="4397248">2</span><span class="op" id="4397249">:</span><span class="op" id="4397250">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4397254">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4397257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4397260">if</span>&nbsp;<span class="ident" id="4397263">m</span><span class="op" id="4397264">.</span><span class="ident" id="4397265">secureRenegotiation</span>&nbsp;<span class="op" id="4397285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397289">z</span><span class="op" id="4397290">[</span><span class="num" id="4397291">0</span><span class="op" id="4397292">]</span>&nbsp;<span class="op" id="4397294">=</span>&nbsp;<span class="builtintype" id="4397296">byte</span><span class="op" id="4397300">(</span><span class="ident" id="4397301">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4397328">&gt;&gt;</span>&nbsp;<span class="num" id="4397331">8</span><span class="op" id="4397332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397336">z</span><span class="op" id="4397337">[</span><span class="num" id="4397338">1</span><span class="op" id="4397339">]</span>&nbsp;<span class="op" id="4397341">=</span>&nbsp;<span class="builtintype" id="4397343">byte</span><span class="op" id="4397347">(</span><span class="ident" id="4397348">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4397375">&amp;</span>&nbsp;<span class="num" id="4397377">0xff</span><span class="op" id="4397381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397385">z</span><span class="op" id="4397386">[</span><span class="num" id="4397387">2</span><span class="op" id="4397388">]</span>&nbsp;<span class="op" id="4397390">=</span>&nbsp;<span class="num" id="4397392">0</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397396">z</span><span class="op" id="4397397">[</span><span class="num" id="4397398">3</span><span class="op" id="4397399">]</span>&nbsp;<span class="op" id="4397401">=</span>&nbsp;<span class="num" id="4397403">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397407">z</span>&nbsp;<span class="op" id="4397409">=</span>&nbsp;<span class="ident" id="4397411">z</span><span class="op" id="4397412">[</span><span class="num" id="4397413">5</span><span class="op" id="4397414">:</span><span class="op" id="4397415">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4397418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4397421">if</span>&nbsp;<span class="builtinfunc" id="4397424">len</span><span class="op" id="4397427">(</span><span class="ident" id="4397428">m</span><span class="op" id="4397429">.</span><span class="ident" id="4397430">alpnProtocols</span><span class="op" id="4397443">)</span>&nbsp;<span class="op" id="4397445">&gt;</span>&nbsp;<span class="num" id="4397447">0</span>&nbsp;<span class="op" id="4397449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397453">z</span><span class="op" id="4397454">[</span><span class="num" id="4397455">0</span><span class="op" id="4397456">]</span>&nbsp;<span class="op" id="4397458">=</span>&nbsp;<span class="builtintype" id="4397460">byte</span><span class="op" id="4397464">(</span><span class="ident" id="4397465">extensionALPN</span>&nbsp;<span class="op" id="4397479">&gt;&gt;</span>&nbsp;<span class="num" id="4397482">8</span><span class="op" id="4397483">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397487">z</span><span class="op" id="4397488">[</span><span class="num" id="4397489">1</span><span class="op" id="4397490">]</span>&nbsp;<span class="op" id="4397492">=</span>&nbsp;<span class="builtintype" id="4397494">byte</span><span class="op" id="4397498">(</span><span class="ident" id="4397499">extensionALPN</span>&nbsp;<span class="op" id="4397513">&amp;</span>&nbsp;<span class="num" id="4397515">0xff</span><span class="op" id="4397519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397523">lengths</span>&nbsp;<span class="op" id="4397531">:=</span>&nbsp;<span class="ident" id="4397534">z</span><span class="op" id="4397535">[</span><span class="num" id="4397536">2</span><span class="op" id="4397537">:</span><span class="op" id="4397538">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397542">z</span>&nbsp;<span class="op" id="4397544">=</span>&nbsp;<span class="ident" id="4397546">z</span><span class="op" id="4397547">[</span><span class="num" id="4397548">6</span><span class="op" id="4397549">:</span><span class="op" id="4397550">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397555">stringsLength</span>&nbsp;<span class="op" id="4397569">:=</span>&nbsp;<span class="num" id="4397572">0</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4397576">for</span>&nbsp;<span class="ident" id="4397580">_</span><span class="op" id="4397581">,</span>&nbsp;<span class="ident" id="4397583">s</span>&nbsp;<span class="op" id="4397585">:=</span>&nbsp;<span class="keyword" id="4397588">range</span>&nbsp;<span class="ident" id="4397594">m</span><span class="op" id="4397595">.</span><span class="ident" id="4397596">alpnProtocols</span>&nbsp;<span class="op" id="4397610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397615">l</span>&nbsp;<span class="op" id="4397617">:=</span>&nbsp;<span class="builtinfunc" id="4397620">len</span><span class="op" id="4397623">(</span><span class="ident" id="4397624">s</span><span class="op" id="4397625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397630">z</span><span class="op" id="4397631">[</span><span class="num" id="4397632">0</span><span class="op" id="4397633">]</span>&nbsp;<span class="op" id="4397635">=</span>&nbsp;<span class="builtintype" id="4397637">byte</span><span class="op" id="4397641">(</span><span class="ident" id="4397642">l</span><span class="op" id="4397643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4397648">copy</span><span class="op" id="4397652">(</span><span class="ident" id="4397653">z</span><span class="op" id="4397654">[</span><span class="num" id="4397655">1</span><span class="op" id="4397656">:</span><span class="op" id="4397657">]</span><span class="op" id="4397658">,</span>&nbsp;<span class="ident" id="4397660">s</span><span class="op" id="4397661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397666">z</span>&nbsp;<span class="op" id="4397668">=</span>&nbsp;<span class="ident" id="4397670">z</span><span class="op" id="4397671">[</span><span class="num" id="4397672">1</span><span class="op" id="4397673">+</span><span class="ident" id="4397674">l</span><span class="op" id="4397675">:</span><span class="op" id="4397676">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397681">stringsLength</span>&nbsp;<span class="op" id="4397695">+=</span>&nbsp;<span class="num" id="4397698">1</span>&nbsp;<span class="op" id="4397700">+</span>&nbsp;<span class="ident" id="4397702">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4397706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397711">lengths</span><span class="op" id="4397718">[</span><span class="num" id="4397719">2</span><span class="op" id="4397720">]</span>&nbsp;<span class="op" id="4397722">=</span>&nbsp;<span class="builtintype" id="4397724">byte</span><span class="op" id="4397728">(</span><span class="ident" id="4397729">stringsLength</span>&nbsp;<span class="op" id="4397743">&gt;&gt;</span>&nbsp;<span class="num" id="4397746">8</span><span class="op" id="4397747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397751">lengths</span><span class="op" id="4397758">[</span><span class="num" id="4397759">3</span><span class="op" id="4397760">]</span>&nbsp;<span class="op" id="4397762">=</span>&nbsp;<span class="builtintype" id="4397764">byte</span><span class="op" id="4397768">(</span><span class="ident" id="4397769">stringsLength</span><span class="op" id="4397782">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397786">stringsLength</span>&nbsp;<span class="op" id="4397800">+=</span>&nbsp;<span class="num" id="4397803">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397807">lengths</span><span class="op" id="4397814">[</span><span class="num" id="4397815">0</span><span class="op" id="4397816">]</span>&nbsp;<span class="op" id="4397818">=</span>&nbsp;<span class="builtintype" id="4397820">byte</span><span class="op" id="4397824">(</span><span class="ident" id="4397825">stringsLength</span>&nbsp;<span class="op" id="4397839">&gt;&gt;</span>&nbsp;<span class="num" id="4397842">8</span><span class="op" id="4397843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397847">lengths</span><span class="op" id="4397854">[</span><span class="num" id="4397855">1</span><span class="op" id="4397856">]</span>&nbsp;<span class="op" id="4397858">=</span>&nbsp;<span class="builtintype" id="4397860">byte</span><span class="op" id="4397864">(</span><span class="ident" id="4397865">stringsLength</span><span class="op" id="4397878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4397881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4397885">m</span><span class="op" id="4397886">.</span><span class="ident" id="4397887">raw</span>&nbsp;<span class="op" id="4397891">=</span>&nbsp;<span class="ident" id="4397893">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4397897">return</span>&nbsp;<span class="ident" id="4397904">x</span><br>
<span class="lineno"></span><span class="op" id="4397906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="4397909">func</span>&nbsp;<span class="op" id="4397914">(</span><span class="ident" id="4397915">m</span>&nbsp;<span class="op" id="4397917">*</span><span class="ident" id="4397918">clientHelloMsg</span><span class="op" id="4397932">)</span>&nbsp;<span class="ident" id="4397934">unmarshal</span><span class="op" id="4397943">(</span><span class="ident" id="4397944">data</span>&nbsp;<span class="op" id="4397949">[</span><span class="op" id="4397950">]</span><span class="builtintype" id="4397951">byte</span><span class="op" id="4397955">)</span>&nbsp;<span class="builtintype" id="4397957">bool</span>&nbsp;<span class="op" id="4397962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4397965">if</span>&nbsp;<span class="builtinfunc" id="4397968">len</span><span class="op" id="4397971">(</span><span class="ident" id="4397972">data</span><span class="op" id="4397976">)</span>&nbsp;<span class="op" id="4397978">&lt;</span>&nbsp;<span class="num" id="4397980">42</span>&nbsp;<span class="op" id="4397983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4397987">return</span>&nbsp;<span class="builtintype" id="4397994">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4398001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4398004">m</span><span class="op" id="4398005">.</span><span class="ident" id="4398006">raw</span>&nbsp;<span class="op" id="4398010">=</span>&nbsp;<span class="ident" id="4398012">data</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4398018">m</span><span class="op" id="4398019">.</span><span class="ident" id="4398020">vers</span>&nbsp;<span class="op" id="4398025">=</span>&nbsp;<span class="builtintype" id="4398027">uint16</span><span class="op" id="4398033">(</span><span class="ident" id="4398034">data</span><span class="op" id="4398038">[</span><span class="num" id="4398039">4</span><span class="op" id="4398040">]</span><span class="op" id="4398041">)</span><span class="op" id="4398042">&lt;&lt;</span><span class="num" id="4398044">8</span>&nbsp;<span class="op" id="4398046">|</span>&nbsp;<span class="builtintype" id="4398048">uint16</span><span class="op" id="4398054">(</span><span class="ident" id="4398055">data</span><span class="op" id="4398059">[</span><span class="num" id="4398060">5</span><span class="op" id="4398061">]</span><span class="op" id="4398062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4398065">m</span><span class="op" id="4398066">.</span><span class="ident" id="4398067">random</span>&nbsp;<span class="op" id="4398074">=</span>&nbsp;<span class="ident" id="4398076">data</span><span class="op" id="4398080">[</span><span class="num" id="4398081">6</span><span class="op" id="4398082">:</span><span class="num" id="4398083">38</span><span class="op" id="4398085">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4398088">sessionIdLen</span>&nbsp;<span class="op" id="4398101">:=</span>&nbsp;<span class="builtintype" id="4398104">int</span><span class="op" id="4398107">(</span><span class="ident" id="4398108">data</span><span class="op" id="4398112">[</span><span class="num" id="4398113">38</span><span class="op" id="4398115">]</span><span class="op" id="4398116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4398119">if</span>&nbsp;<span class="ident" id="4398122">sessionIdLen</span>&nbsp;<span class="op" id="4398135">&gt;</span>&nbsp;<span class="num" id="4398137">32</span>&nbsp;<span class="op" id="4398140">||</span>&nbsp;<span class="builtinfunc" id="4398143">len</span><span class="op" id="4398146">(</span><span class="ident" id="4398147">data</span><span class="op" id="4398151">)</span>&nbsp;<span class="op" id="4398153">&lt;</span>&nbsp;<span class="num" id="4398155">39</span><span class="op" id="4398157">+</span><span class="ident" id="4398158">sessionIdLen</span>&nbsp;<span class="op" id="4398171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4398175">return</span>&nbsp;<span class="builtintype" id="4398182">false</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4398189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4398192">m</span><span class="op" id="4398193">.</span><span class="ident" id="4398194">sessionId</span>&nbsp;<span class="op" id="4398204">=</span>&nbsp;<span class="ident" id="4398206">data</span><span class="op" id="4398210">[</span><span class="num" id="4398211">39</span>&nbsp;<span class="op" id="4398214">:</span>&nbsp;<span class="num" id="4398216">39</span><span class="op" id="4398218">+</span><span class="ident" id="4398219">sessionIdLen</span><span class="op" id="4398231">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4398234">data</span>&nbsp;<span class="op" id="4398239">=</span>&nbsp;<span class="ident" id="4398241">data</span><span class="op" id="4398245">[</span><span class="num" id="4398246">39</span><span class="op" id="4398248">+</span><span class="ident" id="4398249">sessionIdLen</span><span class="op" id="4398261">:</span><span class="op" id="4398262">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4398265">if</span>&nbsp;<span class="builtinfunc" id="4398268">len</span><span class="op" id="4398271">(</span><span class="ident" id="4398272">data</span><span class="op" id="4398276">)</span>&nbsp;<span class="op" id="4398278">&lt;</span>&nbsp;<span class="num" id="4398280">2</span>&nbsp;<span class="op" id="4398282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4398286">return</span>&nbsp;<span class="builtintype" id="4398293">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4398300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4398303">//&nbsp;cipherSuiteLen&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;cipher&nbsp;suite&nbsp;numbers.&nbsp;Since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4398376">//&nbsp;they&nbsp;are&nbsp;uint16s,&nbsp;the&nbsp;number&nbsp;must&nbsp;be&nbsp;even.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4398423">cipherSuiteLen</span>&nbsp;<span class="op" id="4398438">:=</span>&nbsp;<span class="builtintype" id="4398441">int</span><span class="op" id="4398444">(</span><span class="ident" id="4398445">data</span><span class="op" id="4398449">[</span><span class="num" id="4398450">0</span><span class="op" id="4398451">]</span><span class="op" id="4398452">)</span><span class="op" id="4398453">&lt;&lt;</span><span class="num" id="4398455">8</span>&nbsp;<span class="op" id="4398457">|</span>&nbsp;<span class="builtintype" id="4398459">int</span><span class="op" id="4398462">(</span><span class="ident" id="4398463">data</span><span class="op" id="4398467">[</span><span class="num" id="4398468">1</span><span class="op" id="4398469">]</span><span class="op" id="4398470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4398473">if</span>&nbsp;<span class="ident" id="4398476">cipherSuiteLen</span><span class="op" id="4398490">%</span><span class="num" id="4398491">2</span>&nbsp;<span class="op" id="4398493">==</span>&nbsp;<span class="num" id="4398496">1</span>&nbsp;<span class="op" id="4398498">||</span>&nbsp;<span class="builtinfunc" id="4398501">len</span><span class="op" id="4398504">(</span><span class="ident" id="4398505">data</span><span class="op" id="4398509">)</span>&nbsp;<span class="op" id="4398511">&lt;</span>&nbsp;<span class="num" id="4398513">2</span><span class="op" id="4398514">+</span><span class="ident" id="4398515">cipherSuiteLen</span>&nbsp;<span class="op" id="4398530">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4398534">return</span>&nbsp;<span class="builtintype" id="4398541">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4398548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4398551">numCipherSuites</span>&nbsp;<span class="op" id="4398567">:=</span>&nbsp;<span class="ident" id="4398570">cipherSuiteLen</span>&nbsp;<span class="op" id="4398585">/</span>&nbsp;<span class="num" id="4398587">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4398590">m</span><span class="op" id="4398591">.</span><span class="ident" id="4398592">cipherSuites</span>&nbsp;<span class="op" id="4398605">=</span>&nbsp;<span class="builtinfunc" id="4398607">make</span><span class="op" id="4398611">(</span><span class="op" id="4398612">[</span><span class="op" id="4398613">]</span><span class="builtintype" id="4398614">uint16</span><span class="op" id="4398620">,</span>&nbsp;<span class="ident" id="4398622">numCipherSuites</span><span class="op" id="4398637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4398640">for</span>&nbsp;<span class="ident" id="4398644">i</span>&nbsp;<span class="op" id="4398646">:=</span>&nbsp;<span class="num" id="4398649">0</span><span class="op" id="4398650">;</span>&nbsp;<span class="ident" id="4398652">i</span>&nbsp;<span class="op" id="4398654">&lt;</span>&nbsp;<span class="ident" id="4398656">numCipherSuites</span><span class="op" id="4398671">;</span>&nbsp;<span class="ident" id="4398673">i</span><span class="op" id="4398674">++</span>&nbsp;<span class="op" id="4398677">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4398681">m</span><span class="op" id="4398682">.</span><span class="ident" id="4398683">cipherSuites</span><span class="op" id="4398695">[</span><span class="ident" id="4398696">i</span><span class="op" id="4398697">]</span>&nbsp;<span class="op" id="4398699">=</span>&nbsp;<span class="builtintype" id="4398701">uint16</span><span class="op" id="4398707">(</span><span class="ident" id="4398708">data</span><span class="op" id="4398712">[</span><span class="num" id="4398713">2</span><span class="op" id="4398714">+</span><span class="num" id="4398715">2</span><span class="op" id="4398716">*</span><span class="ident" id="4398717">i</span><span class="op" id="4398718">]</span><span class="op" id="4398719">)</span><span class="op" id="4398720">&lt;&lt;</span><span class="num" id="4398722">8</span>&nbsp;<span class="op" id="4398724">|</span>&nbsp;<span class="builtintype" id="4398726">uint16</span><span class="op" id="4398732">(</span><span class="ident" id="4398733">data</span><span class="op" id="4398737">[</span><span class="num" id="4398738">3</span><span class="op" id="4398739">+</span><span class="num" id="4398740">2</span><span class="op" id="4398741">*</span><span class="ident" id="4398742">i</span><span class="op" id="4398743">]</span><span class="op" id="4398744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4398748">if</span>&nbsp;<span class="ident" id="4398751">m</span><span class="op" id="4398752">.</span><span class="ident" id="4398753">cipherSuites</span><span class="op" id="4398765">[</span><span class="ident" id="4398766">i</span><span class="op" id="4398767">]</span>&nbsp;<span class="op" id="4398769">==</span>&nbsp;<span class="ident" id="4398772">scsvRenegotiation</span>&nbsp;<span class="op" id="4398790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4398795">m</span><span class="op" id="4398796">.</span><span class="ident" id="4398797">secureRenegotiation</span>&nbsp;<span class="op" id="4398817">=</span>&nbsp;<span class="builtintype" id="4398819">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4398826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4398829">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4398832">data</span>&nbsp;<span class="op" id="4398837">=</span>&nbsp;<span class="ident" id="4398839">data</span><span class="op" id="4398843">[</span><span class="num" id="4398844">2</span><span class="op" id="4398845">+</span><span class="ident" id="4398846">cipherSuiteLen</span><span class="op" id="4398860">:</span><span class="op" id="4398861">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4398864">if</span>&nbsp;<span class="builtinfunc" id="4398867">len</span><span class="op" id="4398870">(</span><span class="ident" id="4398871">data</span><span class="op" id="4398875">)</span>&nbsp;<span class="op" id="4398877">&lt;</span>&nbsp;<span class="num" id="4398879">1</span>&nbsp;<span class="op" id="4398881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4398885">return</span>&nbsp;<span class="builtintype" id="4398892">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4398899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4398902">compressionMethodsLen</span>&nbsp;<span class="op" id="4398924">:=</span>&nbsp;<span class="builtintype" id="4398927">int</span><span class="op" id="4398930">(</span><span class="ident" id="4398931">data</span><span class="op" id="4398935">[</span><span class="num" id="4398936">0</span><span class="op" id="4398937">]</span><span class="op" id="4398938">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4398941">if</span>&nbsp;<span class="builtinfunc" id="4398944">len</span><span class="op" id="4398947">(</span><span class="ident" id="4398948">data</span><span class="op" id="4398952">)</span>&nbsp;<span class="op" id="4398954">&lt;</span>&nbsp;<span class="num" id="4398956">1</span><span class="op" id="4398957">+</span><span class="ident" id="4398958">compressionMethodsLen</span>&nbsp;<span class="op" id="4398980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4398984">return</span>&nbsp;<span class="builtintype" id="4398991">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4398998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399001">m</span><span class="op" id="4399002">.</span><span class="ident" id="4399003">compressionMethods</span>&nbsp;<span class="op" id="4399022">=</span>&nbsp;<span class="ident" id="4399024">data</span><span class="op" id="4399028">[</span><span class="num" id="4399029">1</span>&nbsp;<span class="op" id="4399031">:</span>&nbsp;<span class="num" id="4399033">1</span><span class="op" id="4399034">+</span><span class="ident" id="4399035">compressionMethodsLen</span><span class="op" id="4399056">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399060">data</span>&nbsp;<span class="op" id="4399065">=</span>&nbsp;<span class="ident" id="4399067">data</span><span class="op" id="4399071">[</span><span class="num" id="4399072">1</span><span class="op" id="4399073">+</span><span class="ident" id="4399074">compressionMethodsLen</span><span class="op" id="4399095">:</span><span class="op" id="4399096">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399100">m</span><span class="op" id="4399101">.</span><span class="ident" id="4399102">nextProtoNeg</span>&nbsp;<span class="op" id="4399115">=</span>&nbsp;<span class="builtintype" id="4399117">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399124">m</span><span class="op" id="4399125">.</span><span class="ident" id="4399126">serverName</span>&nbsp;<span class="op" id="4399137">=</span>&nbsp;<span class="string" id="4399139">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399143">m</span><span class="op" id="4399144">.</span><span class="ident" id="4399145">ocspStapling</span>&nbsp;<span class="op" id="4399158">=</span>&nbsp;<span class="builtintype" id="4399160">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399167">m</span><span class="op" id="4399168">.</span><span class="ident" id="4399169">ticketSupported</span>&nbsp;<span class="op" id="4399185">=</span>&nbsp;<span class="builtintype" id="4399187">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399194">m</span><span class="op" id="4399195">.</span><span class="ident" id="4399196">sessionTicket</span>&nbsp;<span class="op" id="4399210">=</span>&nbsp;<span class="builtintype" id="4399212">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399217">m</span><span class="op" id="4399218">.</span><span class="ident" id="4399219">signatureAndHashes</span>&nbsp;<span class="op" id="4399238">=</span>&nbsp;<span class="builtintype" id="4399240">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399245">m</span><span class="op" id="4399246">.</span><span class="ident" id="4399247">alpnProtocols</span>&nbsp;<span class="op" id="4399261">=</span>&nbsp;<span class="builtintype" id="4399263">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399269">if</span>&nbsp;<span class="builtinfunc" id="4399272">len</span><span class="op" id="4399275">(</span><span class="ident" id="4399276">data</span><span class="op" id="4399280">)</span>&nbsp;<span class="op" id="4399282">==</span>&nbsp;<span class="num" id="4399285">0</span>&nbsp;<span class="op" id="4399287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4399291">//&nbsp;ClientHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399349">return</span>&nbsp;<span class="builtintype" id="4399356">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4399362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399365">if</span>&nbsp;<span class="builtinfunc" id="4399368">len</span><span class="op" id="4399371">(</span><span class="ident" id="4399372">data</span><span class="op" id="4399376">)</span>&nbsp;<span class="op" id="4399378">&lt;</span>&nbsp;<span class="num" id="4399380">2</span>&nbsp;<span class="op" id="4399382">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399386">return</span>&nbsp;<span class="builtintype" id="4399393">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4399400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399404">extensionsLength</span>&nbsp;<span class="op" id="4399421">:=</span>&nbsp;<span class="builtintype" id="4399424">int</span><span class="op" id="4399427">(</span><span class="ident" id="4399428">data</span><span class="op" id="4399432">[</span><span class="num" id="4399433">0</span><span class="op" id="4399434">]</span><span class="op" id="4399435">)</span><span class="op" id="4399436">&lt;&lt;</span><span class="num" id="4399438">8</span>&nbsp;<span class="op" id="4399440">|</span>&nbsp;<span class="builtintype" id="4399442">int</span><span class="op" id="4399445">(</span><span class="ident" id="4399446">data</span><span class="op" id="4399450">[</span><span class="num" id="4399451">1</span><span class="op" id="4399452">]</span><span class="op" id="4399453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399456">data</span>&nbsp;<span class="op" id="4399461">=</span>&nbsp;<span class="ident" id="4399463">data</span><span class="op" id="4399467">[</span><span class="num" id="4399468">2</span><span class="op" id="4399469">:</span><span class="op" id="4399470">]</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399473">if</span>&nbsp;<span class="ident" id="4399476">extensionsLength</span>&nbsp;<span class="op" id="4399493">!=</span>&nbsp;<span class="builtinfunc" id="4399496">len</span><span class="op" id="4399499">(</span><span class="ident" id="4399500">data</span><span class="op" id="4399504">)</span>&nbsp;<span class="op" id="4399506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399510">return</span>&nbsp;<span class="builtintype" id="4399517">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4399524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399528">for</span>&nbsp;<span class="builtinfunc" id="4399532">len</span><span class="op" id="4399535">(</span><span class="ident" id="4399536">data</span><span class="op" id="4399540">)</span>&nbsp;<span class="op" id="4399542">!=</span>&nbsp;<span class="num" id="4399545">0</span>&nbsp;<span class="op" id="4399547">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399551">if</span>&nbsp;<span class="builtinfunc" id="4399554">len</span><span class="op" id="4399557">(</span><span class="ident" id="4399558">data</span><span class="op" id="4399562">)</span>&nbsp;<span class="op" id="4399564">&lt;</span>&nbsp;<span class="num" id="4399566">4</span>&nbsp;<span class="op" id="4399568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399573">return</span>&nbsp;<span class="builtintype" id="4399580">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4399588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399592">extension</span>&nbsp;<span class="op" id="4399602">:=</span>&nbsp;<span class="builtintype" id="4399605">uint16</span><span class="op" id="4399611">(</span><span class="ident" id="4399612">data</span><span class="op" id="4399616">[</span><span class="num" id="4399617">0</span><span class="op" id="4399618">]</span><span class="op" id="4399619">)</span><span class="op" id="4399620">&lt;&lt;</span><span class="num" id="4399622">8</span>&nbsp;<span class="op" id="4399624">|</span>&nbsp;<span class="builtintype" id="4399626">uint16</span><span class="op" id="4399632">(</span><span class="ident" id="4399633">data</span><span class="op" id="4399637">[</span><span class="num" id="4399638">1</span><span class="op" id="4399639">]</span><span class="op" id="4399640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399644">length</span>&nbsp;<span class="op" id="4399651">:=</span>&nbsp;<span class="builtintype" id="4399654">int</span><span class="op" id="4399657">(</span><span class="ident" id="4399658">data</span><span class="op" id="4399662">[</span><span class="num" id="4399663">2</span><span class="op" id="4399664">]</span><span class="op" id="4399665">)</span><span class="op" id="4399666">&lt;&lt;</span><span class="num" id="4399668">8</span>&nbsp;<span class="op" id="4399670">|</span>&nbsp;<span class="builtintype" id="4399672">int</span><span class="op" id="4399675">(</span><span class="ident" id="4399676">data</span><span class="op" id="4399680">[</span><span class="num" id="4399681">3</span><span class="op" id="4399682">]</span><span class="op" id="4399683">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399687">data</span>&nbsp;<span class="op" id="4399692">=</span>&nbsp;<span class="ident" id="4399694">data</span><span class="op" id="4399698">[</span><span class="num" id="4399699">4</span><span class="op" id="4399700">:</span><span class="op" id="4399701">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399705">if</span>&nbsp;<span class="builtinfunc" id="4399708">len</span><span class="op" id="4399711">(</span><span class="ident" id="4399712">data</span><span class="op" id="4399716">)</span>&nbsp;<span class="op" id="4399718">&lt;</span>&nbsp;<span class="ident" id="4399720">length</span>&nbsp;<span class="op" id="4399727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399732">return</span>&nbsp;<span class="builtintype" id="4399739">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4399747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399752">switch</span>&nbsp;<span class="ident" id="4399759">extension</span>&nbsp;<span class="op" id="4399769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399773">case</span>&nbsp;<span class="ident" id="4399778">extensionServerName</span><span class="op" id="4399797">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399802">if</span>&nbsp;<span class="ident" id="4399805">length</span>&nbsp;<span class="op" id="4399812">&lt;</span>&nbsp;<span class="num" id="4399814">2</span>&nbsp;<span class="op" id="4399816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399822">return</span>&nbsp;<span class="builtintype" id="4399829">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4399838">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399843">numNames</span>&nbsp;<span class="op" id="4399852">:=</span>&nbsp;<span class="builtintype" id="4399855">int</span><span class="op" id="4399858">(</span><span class="ident" id="4399859">data</span><span class="op" id="4399863">[</span><span class="num" id="4399864">0</span><span class="op" id="4399865">]</span><span class="op" id="4399866">)</span><span class="op" id="4399867">&lt;&lt;</span><span class="num" id="4399869">8</span>&nbsp;<span class="op" id="4399871">|</span>&nbsp;<span class="builtintype" id="4399873">int</span><span class="op" id="4399876">(</span><span class="ident" id="4399877">data</span><span class="op" id="4399881">[</span><span class="num" id="4399882">1</span><span class="op" id="4399883">]</span><span class="op" id="4399884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399889">d</span>&nbsp;<span class="op" id="4399891">:=</span>&nbsp;<span class="ident" id="4399894">data</span><span class="op" id="4399898">[</span><span class="num" id="4399899">2</span><span class="op" id="4399900">:</span><span class="op" id="4399901">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399906">for</span>&nbsp;<span class="ident" id="4399910">i</span>&nbsp;<span class="op" id="4399912">:=</span>&nbsp;<span class="num" id="4399915">0</span><span class="op" id="4399916">;</span>&nbsp;<span class="ident" id="4399918">i</span>&nbsp;<span class="op" id="4399920">&lt;</span>&nbsp;<span class="ident" id="4399922">numNames</span><span class="op" id="4399930">;</span>&nbsp;<span class="ident" id="4399932">i</span><span class="op" id="4399933">++</span>&nbsp;<span class="op" id="4399936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399942">if</span>&nbsp;<span class="builtinfunc" id="4399945">len</span><span class="op" id="4399948">(</span><span class="ident" id="4399949">d</span><span class="op" id="4399950">)</span>&nbsp;<span class="op" id="4399952">&lt;</span>&nbsp;<span class="num" id="4399954">3</span>&nbsp;<span class="op" id="4399956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4399963">return</span>&nbsp;<span class="builtintype" id="4399970">false</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4399980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4399986">nameType</span>&nbsp;<span class="op" id="4399995">:=</span>&nbsp;<span class="ident" id="4399998">d</span><span class="op" id="4399999">[</span><span class="num" id="4400000">0</span><span class="op" id="4400001">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400007">nameLen</span>&nbsp;<span class="op" id="4400015">:=</span>&nbsp;<span class="builtintype" id="4400018">int</span><span class="op" id="4400021">(</span><span class="ident" id="4400022">d</span><span class="op" id="4400023">[</span><span class="num" id="4400024">1</span><span class="op" id="4400025">]</span><span class="op" id="4400026">)</span><span class="op" id="4400027">&lt;&lt;</span><span class="num" id="4400029">8</span>&nbsp;<span class="op" id="4400031">|</span>&nbsp;<span class="builtintype" id="4400033">int</span><span class="op" id="4400036">(</span><span class="ident" id="4400037">d</span><span class="op" id="4400038">[</span><span class="num" id="4400039">2</span><span class="op" id="4400040">]</span><span class="op" id="4400041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400047">d</span>&nbsp;<span class="op" id="4400049">=</span>&nbsp;<span class="ident" id="4400051">d</span><span class="op" id="4400052">[</span><span class="num" id="4400053">3</span><span class="op" id="4400054">:</span><span class="op" id="4400055">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400061">if</span>&nbsp;<span class="builtinfunc" id="4400064">len</span><span class="op" id="4400067">(</span><span class="ident" id="4400068">d</span><span class="op" id="4400069">)</span>&nbsp;<span class="op" id="4400071">&lt;</span>&nbsp;<span class="ident" id="4400073">nameLen</span>&nbsp;<span class="op" id="4400081">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400088">return</span>&nbsp;<span class="builtintype" id="4400095">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4400105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400111">if</span>&nbsp;<span class="ident" id="4400114">nameType</span>&nbsp;<span class="op" id="4400123">==</span>&nbsp;<span class="num" id="4400126">0</span>&nbsp;<span class="op" id="4400128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400135">m</span><span class="op" id="4400136">.</span><span class="ident" id="4400137">serverName</span>&nbsp;<span class="op" id="4400148">=</span>&nbsp;<span class="builtintype" id="4400150">string</span><span class="op" id="4400156">(</span><span class="ident" id="4400157">d</span><span class="op" id="4400158">[</span><span class="num" id="4400159">0</span><span class="op" id="4400160">:</span><span class="ident" id="4400161">nameLen</span><span class="op" id="4400168">]</span><span class="op" id="4400169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400176">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4400186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400192">d</span>&nbsp;<span class="op" id="4400194">=</span>&nbsp;<span class="ident" id="4400196">d</span><span class="op" id="4400197">[</span><span class="ident" id="4400198">nameLen</span><span class="op" id="4400205">:</span><span class="op" id="4400206">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4400211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400215">case</span>&nbsp;<span class="ident" id="4400220">extensionNextProtoNeg</span><span class="op" id="4400241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400246">if</span>&nbsp;<span class="ident" id="4400249">length</span>&nbsp;<span class="op" id="4400256">&gt;</span>&nbsp;<span class="num" id="4400258">0</span>&nbsp;<span class="op" id="4400260">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400266">return</span>&nbsp;<span class="builtintype" id="4400273">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4400282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400287">m</span><span class="op" id="4400288">.</span><span class="ident" id="4400289">nextProtoNeg</span>&nbsp;<span class="op" id="4400302">=</span>&nbsp;<span class="builtintype" id="4400304">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400311">case</span>&nbsp;<span class="ident" id="4400316">extensionStatusRequest</span><span class="op" id="4400338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400343">m</span><span class="op" id="4400344">.</span><span class="ident" id="4400345">ocspStapling</span>&nbsp;<span class="op" id="4400358">=</span>&nbsp;<span class="ident" id="4400360">length</span>&nbsp;<span class="op" id="4400367">&gt;</span>&nbsp;<span class="num" id="4400369">0</span>&nbsp;<span class="op" id="4400371">&amp;&amp;</span>&nbsp;<span class="ident" id="4400374">data</span><span class="op" id="4400378">[</span><span class="num" id="4400379">0</span><span class="op" id="4400380">]</span>&nbsp;<span class="op" id="4400382">==</span>&nbsp;<span class="ident" id="4400385">statusTypeOCSP</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400402">case</span>&nbsp;<span class="ident" id="4400407">extensionSupportedCurves</span><span class="op" id="4400431">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4400436">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400491">if</span>&nbsp;<span class="ident" id="4400494">length</span>&nbsp;<span class="op" id="4400501">&lt;</span>&nbsp;<span class="num" id="4400503">2</span>&nbsp;<span class="op" id="4400505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400511">return</span>&nbsp;<span class="builtintype" id="4400518">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4400527">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400532">l</span>&nbsp;<span class="op" id="4400534">:=</span>&nbsp;<span class="builtintype" id="4400537">int</span><span class="op" id="4400540">(</span><span class="ident" id="4400541">data</span><span class="op" id="4400545">[</span><span class="num" id="4400546">0</span><span class="op" id="4400547">]</span><span class="op" id="4400548">)</span><span class="op" id="4400549">&lt;&lt;</span><span class="num" id="4400551">8</span>&nbsp;<span class="op" id="4400553">|</span>&nbsp;<span class="builtintype" id="4400555">int</span><span class="op" id="4400558">(</span><span class="ident" id="4400559">data</span><span class="op" id="4400563">[</span><span class="num" id="4400564">1</span><span class="op" id="4400565">]</span><span class="op" id="4400566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400571">if</span>&nbsp;<span class="ident" id="4400574">l</span><span class="op" id="4400575">%</span><span class="num" id="4400576">2</span>&nbsp;<span class="op" id="4400578">==</span>&nbsp;<span class="num" id="4400581">1</span>&nbsp;<span class="op" id="4400583">||</span>&nbsp;<span class="ident" id="4400586">length</span>&nbsp;<span class="op" id="4400593">!=</span>&nbsp;<span class="ident" id="4400596">l</span><span class="op" id="4400597">+</span><span class="num" id="4400598">2</span>&nbsp;<span class="op" id="4400600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400606">return</span>&nbsp;<span class="builtintype" id="4400613">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4400622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400627">numCurves</span>&nbsp;<span class="op" id="4400637">:=</span>&nbsp;<span class="ident" id="4400640">l</span>&nbsp;<span class="op" id="4400642">/</span>&nbsp;<span class="num" id="4400644">2</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400649">m</span><span class="op" id="4400650">.</span><span class="ident" id="4400651">supportedCurves</span>&nbsp;<span class="op" id="4400667">=</span>&nbsp;<span class="builtinfunc" id="4400669">make</span><span class="op" id="4400673">(</span><span class="op" id="4400674">[</span><span class="op" id="4400675">]</span><span class="ident" id="4400676">CurveID</span><span class="op" id="4400683">,</span>&nbsp;<span class="ident" id="4400685">numCurves</span><span class="op" id="4400694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400699">d</span>&nbsp;<span class="op" id="4400701">:=</span>&nbsp;<span class="ident" id="4400704">data</span><span class="op" id="4400708">[</span><span class="num" id="4400709">2</span><span class="op" id="4400710">:</span><span class="op" id="4400711">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400716">for</span>&nbsp;<span class="ident" id="4400720">i</span>&nbsp;<span class="op" id="4400722">:=</span>&nbsp;<span class="num" id="4400725">0</span><span class="op" id="4400726">;</span>&nbsp;<span class="ident" id="4400728">i</span>&nbsp;<span class="op" id="4400730">&lt;</span>&nbsp;<span class="ident" id="4400732">numCurves</span><span class="op" id="4400741">;</span>&nbsp;<span class="ident" id="4400743">i</span><span class="op" id="4400744">++</span>&nbsp;<span class="op" id="4400747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400753">m</span><span class="op" id="4400754">.</span><span class="ident" id="4400755">supportedCurves</span><span class="op" id="4400770">[</span><span class="ident" id="4400771">i</span><span class="op" id="4400772">]</span>&nbsp;<span class="op" id="4400774">=</span>&nbsp;<span class="ident" id="4400776">CurveID</span><span class="op" id="4400783">(</span><span class="ident" id="4400784">d</span><span class="op" id="4400785">[</span><span class="num" id="4400786">0</span><span class="op" id="4400787">]</span><span class="op" id="4400788">)</span><span class="op" id="4400789">&lt;&lt;</span><span class="num" id="4400791">8</span>&nbsp;<span class="op" id="4400793">|</span>&nbsp;<span class="ident" id="4400795">CurveID</span><span class="op" id="4400802">(</span><span class="ident" id="4400803">d</span><span class="op" id="4400804">[</span><span class="num" id="4400805">1</span><span class="op" id="4400806">]</span><span class="op" id="4400807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400813">d</span>&nbsp;<span class="op" id="4400815">=</span>&nbsp;<span class="ident" id="4400817">d</span><span class="op" id="4400818">[</span><span class="num" id="4400819">2</span><span class="op" id="4400820">:</span><span class="op" id="4400821">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4400826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400830">case</span>&nbsp;<span class="ident" id="4400835">extensionSupportedPoints</span><span class="op" id="4400859">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4400864">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400919">if</span>&nbsp;<span class="ident" id="4400922">length</span>&nbsp;<span class="op" id="4400929">&lt;</span>&nbsp;<span class="num" id="4400931">1</span>&nbsp;<span class="op" id="4400933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400939">return</span>&nbsp;<span class="builtintype" id="4400946">false</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4400955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4400960">l</span>&nbsp;<span class="op" id="4400962">:=</span>&nbsp;<span class="builtintype" id="4400965">int</span><span class="op" id="4400968">(</span><span class="ident" id="4400969">data</span><span class="op" id="4400973">[</span><span class="num" id="4400974">0</span><span class="op" id="4400975">]</span><span class="op" id="4400976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4400981">if</span>&nbsp;<span class="ident" id="4400984">length</span>&nbsp;<span class="op" id="4400991">!=</span>&nbsp;<span class="ident" id="4400994">l</span><span class="op" id="4400995">+</span><span class="num" id="4400996">1</span>&nbsp;<span class="op" id="4400998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401004">return</span>&nbsp;<span class="builtintype" id="4401011">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401020">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401025">m</span><span class="op" id="4401026">.</span><span class="ident" id="4401027">supportedPoints</span>&nbsp;<span class="op" id="4401043">=</span>&nbsp;<span class="builtinfunc" id="4401045">make</span><span class="op" id="4401049">(</span><span class="op" id="4401050">[</span><span class="op" id="4401051">]</span><span class="builtintype" id="4401052">uint8</span><span class="op" id="4401057">,</span>&nbsp;<span class="ident" id="4401059">l</span><span class="op" id="4401060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4401065">copy</span><span class="op" id="4401069">(</span><span class="ident" id="4401070">m</span><span class="op" id="4401071">.</span><span class="ident" id="4401072">supportedPoints</span><span class="op" id="4401087">,</span>&nbsp;<span class="ident" id="4401089">data</span><span class="op" id="4401093">[</span><span class="num" id="4401094">1</span><span class="op" id="4401095">:</span><span class="op" id="4401096">]</span><span class="op" id="4401097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401101">case</span>&nbsp;<span class="ident" id="4401106">extensionSessionTicket</span><span class="op" id="4401128">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4401133">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401186">m</span><span class="op" id="4401187">.</span><span class="ident" id="4401188">ticketSupported</span>&nbsp;<span class="op" id="4401204">=</span>&nbsp;<span class="builtintype" id="4401206">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401214">m</span><span class="op" id="4401215">.</span><span class="ident" id="4401216">sessionTicket</span>&nbsp;<span class="op" id="4401230">=</span>&nbsp;<span class="ident" id="4401232">data</span><span class="op" id="4401236">[</span><span class="op" id="4401237">:</span><span class="ident" id="4401238">length</span><span class="op" id="4401244">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401248">case</span>&nbsp;<span class="ident" id="4401253">extensionSignatureAlgorithms</span><span class="op" id="4401281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4401286">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401346">if</span>&nbsp;<span class="ident" id="4401349">length</span>&nbsp;<span class="op" id="4401356">&lt;</span>&nbsp;<span class="num" id="4401358">2</span>&nbsp;<span class="op" id="4401360">||</span>&nbsp;<span class="ident" id="4401363">length</span><span class="op" id="4401369">&amp;</span><span class="num" id="4401370">1</span>&nbsp;<span class="op" id="4401372">!=</span>&nbsp;<span class="num" id="4401375">0</span>&nbsp;<span class="op" id="4401377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401383">return</span>&nbsp;<span class="builtintype" id="4401390">false</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401404">l</span>&nbsp;<span class="op" id="4401406">:=</span>&nbsp;<span class="builtintype" id="4401409">int</span><span class="op" id="4401412">(</span><span class="ident" id="4401413">data</span><span class="op" id="4401417">[</span><span class="num" id="4401418">0</span><span class="op" id="4401419">]</span><span class="op" id="4401420">)</span><span class="op" id="4401421">&lt;&lt;</span><span class="num" id="4401423">8</span>&nbsp;<span class="op" id="4401425">|</span>&nbsp;<span class="builtintype" id="4401427">int</span><span class="op" id="4401430">(</span><span class="ident" id="4401431">data</span><span class="op" id="4401435">[</span><span class="num" id="4401436">1</span><span class="op" id="4401437">]</span><span class="op" id="4401438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401443">if</span>&nbsp;<span class="ident" id="4401446">l</span>&nbsp;<span class="op" id="4401448">!=</span>&nbsp;<span class="ident" id="4401451">length</span><span class="op" id="4401457">-</span><span class="num" id="4401458">2</span>&nbsp;<span class="op" id="4401460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401466">return</span>&nbsp;<span class="builtintype" id="4401473">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401482">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401487">n</span>&nbsp;<span class="op" id="4401489">:=</span>&nbsp;<span class="ident" id="4401492">l</span>&nbsp;<span class="op" id="4401494">/</span>&nbsp;<span class="num" id="4401496">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401501">d</span>&nbsp;<span class="op" id="4401503">:=</span>&nbsp;<span class="ident" id="4401506">data</span><span class="op" id="4401510">[</span><span class="num" id="4401511">2</span><span class="op" id="4401512">:</span><span class="op" id="4401513">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401518">m</span><span class="op" id="4401519">.</span><span class="ident" id="4401520">signatureAndHashes</span>&nbsp;<span class="op" id="4401539">=</span>&nbsp;<span class="builtinfunc" id="4401541">make</span><span class="op" id="4401545">(</span><span class="op" id="4401546">[</span><span class="op" id="4401547">]</span><span class="ident" id="4401548">signatureAndHash</span><span class="op" id="4401564">,</span>&nbsp;<span class="ident" id="4401566">n</span><span class="op" id="4401567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401572">for</span>&nbsp;<span class="ident" id="4401576">i</span>&nbsp;<span class="op" id="4401578">:=</span>&nbsp;<span class="keyword" id="4401581">range</span>&nbsp;<span class="ident" id="4401587">m</span><span class="op" id="4401588">.</span><span class="ident" id="4401589">signatureAndHashes</span>&nbsp;<span class="op" id="4401608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401614">m</span><span class="op" id="4401615">.</span><span class="ident" id="4401616">signatureAndHashes</span><span class="op" id="4401634">[</span><span class="ident" id="4401635">i</span><span class="op" id="4401636">]</span><span class="op" id="4401637">.</span><span class="ident" id="4401638">hash</span>&nbsp;<span class="op" id="4401643">=</span>&nbsp;<span class="ident" id="4401645">d</span><span class="op" id="4401646">[</span><span class="num" id="4401647">0</span><span class="op" id="4401648">]</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401654">m</span><span class="op" id="4401655">.</span><span class="ident" id="4401656">signatureAndHashes</span><span class="op" id="4401674">[</span><span class="ident" id="4401675">i</span><span class="op" id="4401676">]</span><span class="op" id="4401677">.</span><span class="ident" id="4401678">signature</span>&nbsp;<span class="op" id="4401688">=</span>&nbsp;<span class="ident" id="4401690">d</span><span class="op" id="4401691">[</span><span class="num" id="4401692">1</span><span class="op" id="4401693">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401699">d</span>&nbsp;<span class="op" id="4401701">=</span>&nbsp;<span class="ident" id="4401703">d</span><span class="op" id="4401704">[</span><span class="num" id="4401705">2</span><span class="op" id="4401706">:</span><span class="op" id="4401707">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401716">case</span>&nbsp;<span class="ident" id="4401721">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4401748">+</span>&nbsp;<span class="num" id="4401750">1</span><span class="op" id="4401751">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401756">if</span>&nbsp;<span class="ident" id="4401759">length</span>&nbsp;<span class="op" id="4401766">!=</span>&nbsp;<span class="num" id="4401769">1</span>&nbsp;<span class="op" id="4401771">||</span>&nbsp;<span class="ident" id="4401774">data</span><span class="op" id="4401778">[</span><span class="num" id="4401779">0</span><span class="op" id="4401780">]</span>&nbsp;<span class="op" id="4401782">!=</span>&nbsp;<span class="num" id="4401785">0</span>&nbsp;<span class="op" id="4401787">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401793">return</span>&nbsp;<span class="builtintype" id="4401800">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401814">m</span><span class="op" id="4401815">.</span><span class="ident" id="4401816">secureRenegotiation</span>&nbsp;<span class="op" id="4401836">=</span>&nbsp;<span class="builtintype" id="4401838">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401845">case</span>&nbsp;<span class="ident" id="4401850">extensionALPN</span><span class="op" id="4401863">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401868">if</span>&nbsp;<span class="ident" id="4401871">length</span>&nbsp;<span class="op" id="4401878">&lt;</span>&nbsp;<span class="num" id="4401880">2</span>&nbsp;<span class="op" id="4401882">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401888">return</span>&nbsp;<span class="builtintype" id="4401895">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401909">l</span>&nbsp;<span class="op" id="4401911">:=</span>&nbsp;<span class="builtintype" id="4401914">int</span><span class="op" id="4401917">(</span><span class="ident" id="4401918">data</span><span class="op" id="4401922">[</span><span class="num" id="4401923">0</span><span class="op" id="4401924">]</span><span class="op" id="4401925">)</span><span class="op" id="4401926">&lt;&lt;</span><span class="num" id="4401928">8</span>&nbsp;<span class="op" id="4401930">|</span>&nbsp;<span class="builtintype" id="4401932">int</span><span class="op" id="4401935">(</span><span class="ident" id="4401936">data</span><span class="op" id="4401940">[</span><span class="num" id="4401941">1</span><span class="op" id="4401942">]</span><span class="op" id="4401943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401948">if</span>&nbsp;<span class="ident" id="4401951">l</span>&nbsp;<span class="op" id="4401953">!=</span>&nbsp;<span class="ident" id="4401956">length</span><span class="op" id="4401962">-</span><span class="num" id="4401963">2</span>&nbsp;<span class="op" id="4401965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4401971">return</span>&nbsp;<span class="builtintype" id="4401978">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4401987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4401992">d</span>&nbsp;<span class="op" id="4401994">:=</span>&nbsp;<span class="ident" id="4401997">data</span><span class="op" id="4402001">[</span><span class="num" id="4402002">2</span><span class="op" id="4402003">:</span><span class="ident" id="4402004">length</span><span class="op" id="4402010">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4402015">for</span>&nbsp;<span class="builtinfunc" id="4402019">len</span><span class="op" id="4402022">(</span><span class="ident" id="4402023">d</span><span class="op" id="4402024">)</span>&nbsp;<span class="op" id="4402026">!=</span>&nbsp;<span class="num" id="4402029">0</span>&nbsp;<span class="op" id="4402031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402037">stringLen</span>&nbsp;<span class="op" id="4402047">:=</span>&nbsp;<span class="builtintype" id="4402050">int</span><span class="op" id="4402053">(</span><span class="ident" id="4402054">d</span><span class="op" id="4402055">[</span><span class="num" id="4402056">0</span><span class="op" id="4402057">]</span><span class="op" id="4402058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402064">d</span>&nbsp;<span class="op" id="4402066">=</span>&nbsp;<span class="ident" id="4402068">d</span><span class="op" id="4402069">[</span><span class="num" id="4402070">1</span><span class="op" id="4402071">:</span><span class="op" id="4402072">]</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4402078">if</span>&nbsp;<span class="ident" id="4402081">stringLen</span>&nbsp;<span class="op" id="4402091">==</span>&nbsp;<span class="num" id="4402094">0</span>&nbsp;<span class="op" id="4402096">||</span>&nbsp;<span class="ident" id="4402099">stringLen</span>&nbsp;<span class="op" id="4402109">&gt;</span>&nbsp;<span class="builtinfunc" id="4402111">len</span><span class="op" id="4402114">(</span><span class="ident" id="4402115">d</span><span class="op" id="4402116">)</span>&nbsp;<span class="op" id="4402118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4402125">return</span>&nbsp;<span class="builtintype" id="4402132">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4402142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402148">m</span><span class="op" id="4402149">.</span><span class="ident" id="4402150">alpnProtocols</span>&nbsp;<span class="op" id="4402164">=</span>&nbsp;<span class="builtinfunc" id="4402166">append</span><span class="op" id="4402172">(</span><span class="ident" id="4402173">m</span><span class="op" id="4402174">.</span><span class="ident" id="4402175">alpnProtocols</span><span class="op" id="4402188">,</span>&nbsp;<span class="builtintype" id="4402190">string</span><span class="op" id="4402196">(</span><span class="ident" id="4402197">d</span><span class="op" id="4402198">[</span><span class="op" id="4402199">:</span><span class="ident" id="4402200">stringLen</span><span class="op" id="4402209">]</span><span class="op" id="4402210">)</span><span class="op" id="4402211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402217">d</span>&nbsp;<span class="op" id="4402219">=</span>&nbsp;<span class="ident" id="4402221">d</span><span class="op" id="4402222">[</span><span class="ident" id="4402223">stringLen</span><span class="op" id="4402232">:</span><span class="op" id="4402233">]</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4402238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4402242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402246">data</span>&nbsp;<span class="op" id="4402251">=</span>&nbsp;<span class="ident" id="4402253">data</span><span class="op" id="4402257">[</span><span class="ident" id="4402258">length</span><span class="op" id="4402264">:</span><span class="op" id="4402265">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4402268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4402272">return</span>&nbsp;<span class="builtintype" id="4402279">true</span><br>
<span class="lineno"></span><span class="op" id="4402284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4402287">type</span>&nbsp;<span class="ident" id="4402292">serverHelloMsg</span>&nbsp;<span class="keyword" id="4402307">struct</span>&nbsp;<span class="op" id="4402314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402317">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4402337">[</span><span class="op" id="4402338">]</span><span class="builtintype" id="4402339">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402345">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4402365">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402373">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4402393">[</span><span class="op" id="4402394">]</span><span class="builtintype" id="4402395">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402401">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4402421">[</span><span class="op" id="4402422">]</span><span class="builtintype" id="4402423">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402429">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4402449">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402457">compressionMethod</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4402477">uint8</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402484">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4402504">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402510">nextProtos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4402530">[</span><span class="op" id="4402531">]</span><span class="builtintype" id="4402532">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402540">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4402560">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402566">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4402586">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402592">secureRenegotiation</span>&nbsp;<span class="builtintype" id="4402612">bool</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402618">alpnProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4402638">string</span><br>
<span class="lineno"></span><span class="op" id="4402645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4402648">func</span>&nbsp;<span class="op" id="4402653">(</span><span class="ident" id="4402654">m</span>&nbsp;<span class="op" id="4402656">*</span><span class="ident" id="4402657">serverHelloMsg</span><span class="op" id="4402671">)</span>&nbsp;<span class="ident" id="4402673">equal</span><span class="op" id="4402678">(</span><span class="ident" id="4402679">i</span>&nbsp;<span class="keyword" id="4402681">interface</span><span class="op" id="4402690">{</span><span class="op" id="4402691">}</span><span class="op" id="4402692">)</span>&nbsp;<span class="builtintype" id="4402694">bool</span>&nbsp;<span class="op" id="4402699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402702">m1</span><span class="op" id="4402704">,</span>&nbsp;<span class="ident" id="4402706">ok</span>&nbsp;<span class="op" id="4402709">:=</span>&nbsp;<span class="ident" id="4402712">i</span><span class="op" id="4402713">.</span><span class="op" id="4402714">(</span><span class="op" id="4402715">*</span><span class="ident" id="4402716">serverHelloMsg</span><span class="op" id="4402730">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4402733">if</span>&nbsp;<span class="op" id="4402736">!</span><span class="ident" id="4402737">ok</span>&nbsp;<span class="op" id="4402740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4402744">return</span>&nbsp;<span class="builtintype" id="4402751">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4402758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4402762">return</span>&nbsp;<span class="ident" id="4402769">bytes</span><span class="op" id="4402774">.</span><span class="ident" id="4402775">Equal</span><span class="op" id="4402780">(</span><span class="ident" id="4402781">m</span><span class="op" id="4402782">.</span><span class="ident" id="4402783">raw</span><span class="op" id="4402786">,</span>&nbsp;<span class="ident" id="4402788">m1</span><span class="op" id="4402790">.</span><span class="ident" id="4402791">raw</span><span class="op" id="4402794">)</span>&nbsp;<span class="op" id="4402796">&amp;&amp;</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402801">m</span><span class="op" id="4402802">.</span><span class="ident" id="4402803">vers</span>&nbsp;<span class="op" id="4402808">==</span>&nbsp;<span class="ident" id="4402811">m1</span><span class="op" id="4402813">.</span><span class="ident" id="4402814">vers</span>&nbsp;<span class="op" id="4402819">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402824">bytes</span><span class="op" id="4402829">.</span><span class="ident" id="4402830">Equal</span><span class="op" id="4402835">(</span><span class="ident" id="4402836">m</span><span class="op" id="4402837">.</span><span class="ident" id="4402838">random</span><span class="op" id="4402844">,</span>&nbsp;<span class="ident" id="4402846">m1</span><span class="op" id="4402848">.</span><span class="ident" id="4402849">random</span><span class="op" id="4402855">)</span>&nbsp;<span class="op" id="4402857">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402862">bytes</span><span class="op" id="4402867">.</span><span class="ident" id="4402868">Equal</span><span class="op" id="4402873">(</span><span class="ident" id="4402874">m</span><span class="op" id="4402875">.</span><span class="ident" id="4402876">sessionId</span><span class="op" id="4402885">,</span>&nbsp;<span class="ident" id="4402887">m1</span><span class="op" id="4402889">.</span><span class="ident" id="4402890">sessionId</span><span class="op" id="4402899">)</span>&nbsp;<span class="op" id="4402901">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402906">m</span><span class="op" id="4402907">.</span><span class="ident" id="4402908">cipherSuite</span>&nbsp;<span class="op" id="4402920">==</span>&nbsp;<span class="ident" id="4402923">m1</span><span class="op" id="4402925">.</span><span class="ident" id="4402926">cipherSuite</span>&nbsp;<span class="op" id="4402938">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402943">m</span><span class="op" id="4402944">.</span><span class="ident" id="4402945">compressionMethod</span>&nbsp;<span class="op" id="4402963">==</span>&nbsp;<span class="ident" id="4402966">m1</span><span class="op" id="4402968">.</span><span class="ident" id="4402969">compressionMethod</span>&nbsp;<span class="op" id="4402987">&amp;&amp;</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4402992">m</span><span class="op" id="4402993">.</span><span class="ident" id="4402994">nextProtoNeg</span>&nbsp;<span class="op" id="4403007">==</span>&nbsp;<span class="ident" id="4403010">m1</span><span class="op" id="4403012">.</span><span class="ident" id="4403013">nextProtoNeg</span>&nbsp;<span class="op" id="4403026">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403031">eqStrings</span><span class="op" id="4403040">(</span><span class="ident" id="4403041">m</span><span class="op" id="4403042">.</span><span class="ident" id="4403043">nextProtos</span><span class="op" id="4403053">,</span>&nbsp;<span class="ident" id="4403055">m1</span><span class="op" id="4403057">.</span><span class="ident" id="4403058">nextProtos</span><span class="op" id="4403068">)</span>&nbsp;<span class="op" id="4403070">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403075">m</span><span class="op" id="4403076">.</span><span class="ident" id="4403077">ocspStapling</span>&nbsp;<span class="op" id="4403090">==</span>&nbsp;<span class="ident" id="4403093">m1</span><span class="op" id="4403095">.</span><span class="ident" id="4403096">ocspStapling</span>&nbsp;<span class="op" id="4403109">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403114">m</span><span class="op" id="4403115">.</span><span class="ident" id="4403116">ticketSupported</span>&nbsp;<span class="op" id="4403132">==</span>&nbsp;<span class="ident" id="4403135">m1</span><span class="op" id="4403137">.</span><span class="ident" id="4403138">ticketSupported</span>&nbsp;<span class="op" id="4403154">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403159">m</span><span class="op" id="4403160">.</span><span class="ident" id="4403161">secureRenegotiation</span>&nbsp;<span class="op" id="4403181">==</span>&nbsp;<span class="ident" id="4403184">m1</span><span class="op" id="4403186">.</span><span class="ident" id="4403187">secureRenegotiation</span>&nbsp;<span class="op" id="4403207">&amp;&amp;</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403212">m</span><span class="op" id="4403213">.</span><span class="ident" id="4403214">alpnProtocol</span>&nbsp;<span class="op" id="4403227">==</span>&nbsp;<span class="ident" id="4403230">m1</span><span class="op" id="4403232">.</span><span class="ident" id="4403233">alpnProtocol</span><br>
<span class="lineno"></span><span class="op" id="4403246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4403249">func</span>&nbsp;<span class="op" id="4403254">(</span><span class="ident" id="4403255">m</span>&nbsp;<span class="op" id="4403257">*</span><span class="ident" id="4403258">serverHelloMsg</span><span class="op" id="4403272">)</span>&nbsp;<span class="ident" id="4403274">marshal</span><span class="op" id="4403281">(</span><span class="op" id="4403282">)</span>&nbsp;<span class="op" id="4403284">[</span><span class="op" id="4403285">]</span><span class="builtintype" id="4403286">byte</span>&nbsp;<span class="op" id="4403291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403294">if</span>&nbsp;<span class="ident" id="4403297">m</span><span class="op" id="4403298">.</span><span class="ident" id="4403299">raw</span>&nbsp;<span class="op" id="4403303">!=</span>&nbsp;<span class="builtintype" id="4403306">nil</span>&nbsp;<span class="op" id="4403310">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403314">return</span>&nbsp;<span class="ident" id="4403321">m</span><span class="op" id="4403322">.</span><span class="ident" id="4403323">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4403328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403332">length</span>&nbsp;<span class="op" id="4403339">:=</span>&nbsp;<span class="num" id="4403342">38</span>&nbsp;<span class="op" id="4403345">+</span>&nbsp;<span class="builtinfunc" id="4403347">len</span><span class="op" id="4403350">(</span><span class="ident" id="4403351">m</span><span class="op" id="4403352">.</span><span class="ident" id="4403353">sessionId</span><span class="op" id="4403362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403365">numExtensions</span>&nbsp;<span class="op" id="4403379">:=</span>&nbsp;<span class="num" id="4403382">0</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403385">extensionsLength</span>&nbsp;<span class="op" id="4403402">:=</span>&nbsp;<span class="num" id="4403405">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403409">nextProtoLen</span>&nbsp;<span class="op" id="4403422">:=</span>&nbsp;<span class="num" id="4403425">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403428">if</span>&nbsp;<span class="ident" id="4403431">m</span><span class="op" id="4403432">.</span><span class="ident" id="4403433">nextProtoNeg</span>&nbsp;<span class="op" id="4403446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403450">numExtensions</span><span class="op" id="4403463">++</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403468">for</span>&nbsp;<span class="ident" id="4403472">_</span><span class="op" id="4403473">,</span>&nbsp;<span class="ident" id="4403475">v</span>&nbsp;<span class="op" id="4403477">:=</span>&nbsp;<span class="keyword" id="4403480">range</span>&nbsp;<span class="ident" id="4403486">m</span><span class="op" id="4403487">.</span><span class="ident" id="4403488">nextProtos</span>&nbsp;<span class="op" id="4403499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403504">nextProtoLen</span>&nbsp;<span class="op" id="4403517">+=</span>&nbsp;<span class="builtinfunc" id="4403520">len</span><span class="op" id="4403523">(</span><span class="ident" id="4403524">v</span><span class="op" id="4403525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4403529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403533">nextProtoLen</span>&nbsp;<span class="op" id="4403546">+=</span>&nbsp;<span class="builtinfunc" id="4403549">len</span><span class="op" id="4403552">(</span><span class="ident" id="4403553">m</span><span class="op" id="4403554">.</span><span class="ident" id="4403555">nextProtos</span><span class="op" id="4403565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403569">extensionsLength</span>&nbsp;<span class="op" id="4403586">+=</span>&nbsp;<span class="ident" id="4403589">nextProtoLen</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4403603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403606">if</span>&nbsp;<span class="ident" id="4403609">m</span><span class="op" id="4403610">.</span><span class="ident" id="4403611">ocspStapling</span>&nbsp;<span class="op" id="4403624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403628">numExtensions</span><span class="op" id="4403641">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4403645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403648">if</span>&nbsp;<span class="ident" id="4403651">m</span><span class="op" id="4403652">.</span><span class="ident" id="4403653">ticketSupported</span>&nbsp;<span class="op" id="4403669">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403673">numExtensions</span><span class="op" id="4403686">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4403690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403693">if</span>&nbsp;<span class="ident" id="4403696">m</span><span class="op" id="4403697">.</span><span class="ident" id="4403698">secureRenegotiation</span>&nbsp;<span class="op" id="4403718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403722">extensionsLength</span>&nbsp;<span class="op" id="4403739">+=</span>&nbsp;<span class="num" id="4403742">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403746">numExtensions</span><span class="op" id="4403759">++</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4403763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403766">if</span>&nbsp;<span class="ident" id="4403769">alpnLen</span>&nbsp;<span class="op" id="4403777">:=</span>&nbsp;<span class="builtinfunc" id="4403780">len</span><span class="op" id="4403783">(</span><span class="ident" id="4403784">m</span><span class="op" id="4403785">.</span><span class="ident" id="4403786">alpnProtocol</span><span class="op" id="4403798">)</span><span class="op" id="4403799">;</span>&nbsp;<span class="ident" id="4403801">alpnLen</span>&nbsp;<span class="op" id="4403809">&gt;</span>&nbsp;<span class="num" id="4403811">0</span>&nbsp;<span class="op" id="4403813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403817">if</span>&nbsp;<span class="ident" id="4403820">alpnLen</span>&nbsp;<span class="op" id="4403828">&gt;=</span>&nbsp;<span class="num" id="4403831">256</span>&nbsp;<span class="op" id="4403835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4403840">panic</span><span class="op" id="4403845">(</span><span class="string" id="4403846">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="4403869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4403873">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403877">extensionsLength</span>&nbsp;<span class="op" id="4403894">+=</span>&nbsp;<span class="num" id="4403897">2</span>&nbsp;<span class="op" id="4403899">+</span>&nbsp;<span class="num" id="4403901">1</span>&nbsp;<span class="op" id="4403903">+</span>&nbsp;<span class="ident" id="4403905">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403915">numExtensions</span><span class="op" id="4403928">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4403932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4403936">if</span>&nbsp;<span class="ident" id="4403939">numExtensions</span>&nbsp;<span class="op" id="4403953">&gt;</span>&nbsp;<span class="num" id="4403955">0</span>&nbsp;<span class="op" id="4403957">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4403961">extensionsLength</span>&nbsp;<span class="op" id="4403978">+=</span>&nbsp;<span class="num" id="4403981">4</span>&nbsp;<span class="op" id="4403983">*</span>&nbsp;<span class="ident" id="4403985">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404001">length</span>&nbsp;<span class="op" id="4404008">+=</span>&nbsp;<span class="num" id="4404011">2</span>&nbsp;<span class="op" id="4404013">+</span>&nbsp;<span class="ident" id="4404015">extensionsLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4404033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404037">x</span>&nbsp;<span class="op" id="4404039">:=</span>&nbsp;<span class="builtinfunc" id="4404042">make</span><span class="op" id="4404046">(</span><span class="op" id="4404047">[</span><span class="op" id="4404048">]</span><span class="builtintype" id="4404049">byte</span><span class="op" id="4404053">,</span>&nbsp;<span class="num" id="4404055">4</span><span class="op" id="4404056">+</span><span class="ident" id="4404057">length</span><span class="op" id="4404063">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404066">x</span><span class="op" id="4404067">[</span><span class="num" id="4404068">0</span><span class="op" id="4404069">]</span>&nbsp;<span class="op" id="4404071">=</span>&nbsp;<span class="ident" id="4404073">typeServerHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404090">x</span><span class="op" id="4404091">[</span><span class="num" id="4404092">1</span><span class="op" id="4404093">]</span>&nbsp;<span class="op" id="4404095">=</span>&nbsp;<span class="builtintype" id="4404097">uint8</span><span class="op" id="4404102">(</span><span class="ident" id="4404103">length</span>&nbsp;<span class="op" id="4404110">&gt;&gt;</span>&nbsp;<span class="num" id="4404113">16</span><span class="op" id="4404115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404118">x</span><span class="op" id="4404119">[</span><span class="num" id="4404120">2</span><span class="op" id="4404121">]</span>&nbsp;<span class="op" id="4404123">=</span>&nbsp;<span class="builtintype" id="4404125">uint8</span><span class="op" id="4404130">(</span><span class="ident" id="4404131">length</span>&nbsp;<span class="op" id="4404138">&gt;&gt;</span>&nbsp;<span class="num" id="4404141">8</span><span class="op" id="4404142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404145">x</span><span class="op" id="4404146">[</span><span class="num" id="4404147">3</span><span class="op" id="4404148">]</span>&nbsp;<span class="op" id="4404150">=</span>&nbsp;<span class="builtintype" id="4404152">uint8</span><span class="op" id="4404157">(</span><span class="ident" id="4404158">length</span><span class="op" id="4404164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404167">x</span><span class="op" id="4404168">[</span><span class="num" id="4404169">4</span><span class="op" id="4404170">]</span>&nbsp;<span class="op" id="4404172">=</span>&nbsp;<span class="builtintype" id="4404174">uint8</span><span class="op" id="4404179">(</span><span class="ident" id="4404180">m</span><span class="op" id="4404181">.</span><span class="ident" id="4404182">vers</span>&nbsp;<span class="op" id="4404187">&gt;&gt;</span>&nbsp;<span class="num" id="4404190">8</span><span class="op" id="4404191">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404194">x</span><span class="op" id="4404195">[</span><span class="num" id="4404196">5</span><span class="op" id="4404197">]</span>&nbsp;<span class="op" id="4404199">=</span>&nbsp;<span class="builtintype" id="4404201">uint8</span><span class="op" id="4404206">(</span><span class="ident" id="4404207">m</span><span class="op" id="4404208">.</span><span class="ident" id="4404209">vers</span><span class="op" id="4404213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4404216">copy</span><span class="op" id="4404220">(</span><span class="ident" id="4404221">x</span><span class="op" id="4404222">[</span><span class="num" id="4404223">6</span><span class="op" id="4404224">:</span><span class="num" id="4404225">38</span><span class="op" id="4404227">]</span><span class="op" id="4404228">,</span>&nbsp;<span class="ident" id="4404230">m</span><span class="op" id="4404231">.</span><span class="ident" id="4404232">random</span><span class="op" id="4404238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404241">x</span><span class="op" id="4404242">[</span><span class="num" id="4404243">38</span><span class="op" id="4404245">]</span>&nbsp;<span class="op" id="4404247">=</span>&nbsp;<span class="builtintype" id="4404249">uint8</span><span class="op" id="4404254">(</span><span class="builtinfunc" id="4404255">len</span><span class="op" id="4404258">(</span><span class="ident" id="4404259">m</span><span class="op" id="4404260">.</span><span class="ident" id="4404261">sessionId</span><span class="op" id="4404270">)</span><span class="op" id="4404271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4404274">copy</span><span class="op" id="4404278">(</span><span class="ident" id="4404279">x</span><span class="op" id="4404280">[</span><span class="num" id="4404281">39</span><span class="op" id="4404283">:</span><span class="num" id="4404284">39</span><span class="op" id="4404286">+</span><span class="builtinfunc" id="4404287">len</span><span class="op" id="4404290">(</span><span class="ident" id="4404291">m</span><span class="op" id="4404292">.</span><span class="ident" id="4404293">sessionId</span><span class="op" id="4404302">)</span><span class="op" id="4404303">]</span><span class="op" id="4404304">,</span>&nbsp;<span class="ident" id="4404306">m</span><span class="op" id="4404307">.</span><span class="ident" id="4404308">sessionId</span><span class="op" id="4404317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404320">z</span>&nbsp;<span class="op" id="4404322">:=</span>&nbsp;<span class="ident" id="4404325">x</span><span class="op" id="4404326">[</span><span class="num" id="4404327">39</span><span class="op" id="4404329">+</span><span class="builtinfunc" id="4404330">len</span><span class="op" id="4404333">(</span><span class="ident" id="4404334">m</span><span class="op" id="4404335">.</span><span class="ident" id="4404336">sessionId</span><span class="op" id="4404345">)</span><span class="op" id="4404346">:</span><span class="op" id="4404347">]</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404350">z</span><span class="op" id="4404351">[</span><span class="num" id="4404352">0</span><span class="op" id="4404353">]</span>&nbsp;<span class="op" id="4404355">=</span>&nbsp;<span class="builtintype" id="4404357">uint8</span><span class="op" id="4404362">(</span><span class="ident" id="4404363">m</span><span class="op" id="4404364">.</span><span class="ident" id="4404365">cipherSuite</span>&nbsp;<span class="op" id="4404377">&gt;&gt;</span>&nbsp;<span class="num" id="4404380">8</span><span class="op" id="4404381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404384">z</span><span class="op" id="4404385">[</span><span class="num" id="4404386">1</span><span class="op" id="4404387">]</span>&nbsp;<span class="op" id="4404389">=</span>&nbsp;<span class="builtintype" id="4404391">uint8</span><span class="op" id="4404396">(</span><span class="ident" id="4404397">m</span><span class="op" id="4404398">.</span><span class="ident" id="4404399">cipherSuite</span><span class="op" id="4404410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404413">z</span><span class="op" id="4404414">[</span><span class="num" id="4404415">2</span><span class="op" id="4404416">]</span>&nbsp;<span class="op" id="4404418">=</span>&nbsp;<span class="builtintype" id="4404420">uint8</span><span class="op" id="4404425">(</span><span class="ident" id="4404426">m</span><span class="op" id="4404427">.</span><span class="ident" id="4404428">compressionMethod</span><span class="op" id="4404445">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404449">z</span>&nbsp;<span class="op" id="4404451">=</span>&nbsp;<span class="ident" id="4404453">z</span><span class="op" id="4404454">[</span><span class="num" id="4404455">3</span><span class="op" id="4404456">:</span><span class="op" id="4404457">]</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404460">if</span>&nbsp;<span class="ident" id="4404463">numExtensions</span>&nbsp;<span class="op" id="4404477">&gt;</span>&nbsp;<span class="num" id="4404479">0</span>&nbsp;<span class="op" id="4404481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404485">z</span><span class="op" id="4404486">[</span><span class="num" id="4404487">0</span><span class="op" id="4404488">]</span>&nbsp;<span class="op" id="4404490">=</span>&nbsp;<span class="builtintype" id="4404492">byte</span><span class="op" id="4404496">(</span><span class="ident" id="4404497">extensionsLength</span>&nbsp;<span class="op" id="4404514">&gt;&gt;</span>&nbsp;<span class="num" id="4404517">8</span><span class="op" id="4404518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404522">z</span><span class="op" id="4404523">[</span><span class="num" id="4404524">1</span><span class="op" id="4404525">]</span>&nbsp;<span class="op" id="4404527">=</span>&nbsp;<span class="builtintype" id="4404529">byte</span><span class="op" id="4404533">(</span><span class="ident" id="4404534">extensionsLength</span><span class="op" id="4404550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404554">z</span>&nbsp;<span class="op" id="4404556">=</span>&nbsp;<span class="ident" id="4404558">z</span><span class="op" id="4404559">[</span><span class="num" id="4404560">2</span><span class="op" id="4404561">:</span><span class="op" id="4404562">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4404565">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404568">if</span>&nbsp;<span class="ident" id="4404571">m</span><span class="op" id="4404572">.</span><span class="ident" id="4404573">nextProtoNeg</span>&nbsp;<span class="op" id="4404586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404590">z</span><span class="op" id="4404591">[</span><span class="num" id="4404592">0</span><span class="op" id="4404593">]</span>&nbsp;<span class="op" id="4404595">=</span>&nbsp;<span class="builtintype" id="4404597">byte</span><span class="op" id="4404601">(</span><span class="ident" id="4404602">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4404624">&gt;&gt;</span>&nbsp;<span class="num" id="4404627">8</span><span class="op" id="4404628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404632">z</span><span class="op" id="4404633">[</span><span class="num" id="4404634">1</span><span class="op" id="4404635">]</span>&nbsp;<span class="op" id="4404637">=</span>&nbsp;<span class="builtintype" id="4404639">byte</span><span class="op" id="4404643">(</span><span class="ident" id="4404644">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4404666">&amp;</span>&nbsp;<span class="num" id="4404668">0xff</span><span class="op" id="4404672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404676">z</span><span class="op" id="4404677">[</span><span class="num" id="4404678">2</span><span class="op" id="4404679">]</span>&nbsp;<span class="op" id="4404681">=</span>&nbsp;<span class="builtintype" id="4404683">byte</span><span class="op" id="4404687">(</span><span class="ident" id="4404688">nextProtoLen</span>&nbsp;<span class="op" id="4404701">&gt;&gt;</span>&nbsp;<span class="num" id="4404704">8</span><span class="op" id="4404705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404709">z</span><span class="op" id="4404710">[</span><span class="num" id="4404711">3</span><span class="op" id="4404712">]</span>&nbsp;<span class="op" id="4404714">=</span>&nbsp;<span class="builtintype" id="4404716">byte</span><span class="op" id="4404720">(</span><span class="ident" id="4404721">nextProtoLen</span><span class="op" id="4404733">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404737">z</span>&nbsp;<span class="op" id="4404739">=</span>&nbsp;<span class="ident" id="4404741">z</span><span class="op" id="4404742">[</span><span class="num" id="4404743">4</span><span class="op" id="4404744">:</span><span class="op" id="4404745">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404750">for</span>&nbsp;<span class="ident" id="4404754">_</span><span class="op" id="4404755">,</span>&nbsp;<span class="ident" id="4404757">v</span>&nbsp;<span class="op" id="4404759">:=</span>&nbsp;<span class="keyword" id="4404762">range</span>&nbsp;<span class="ident" id="4404768">m</span><span class="op" id="4404769">.</span><span class="ident" id="4404770">nextProtos</span>&nbsp;<span class="op" id="4404781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404786">l</span>&nbsp;<span class="op" id="4404788">:=</span>&nbsp;<span class="builtinfunc" id="4404791">len</span><span class="op" id="4404794">(</span><span class="ident" id="4404795">v</span><span class="op" id="4404796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404801">if</span>&nbsp;<span class="ident" id="4404804">l</span>&nbsp;<span class="op" id="4404806">&gt;</span>&nbsp;<span class="num" id="4404808">255</span>&nbsp;<span class="op" id="4404812">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404818">l</span>&nbsp;<span class="op" id="4404820">=</span>&nbsp;<span class="num" id="4404822">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4404829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404834">z</span><span class="op" id="4404835">[</span><span class="num" id="4404836">0</span><span class="op" id="4404837">]</span>&nbsp;<span class="op" id="4404839">=</span>&nbsp;<span class="builtintype" id="4404841">byte</span><span class="op" id="4404845">(</span><span class="ident" id="4404846">l</span><span class="op" id="4404847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4404852">copy</span><span class="op" id="4404856">(</span><span class="ident" id="4404857">z</span><span class="op" id="4404858">[</span><span class="num" id="4404859">1</span><span class="op" id="4404860">:</span><span class="op" id="4404861">]</span><span class="op" id="4404862">,</span>&nbsp;<span class="op" id="4404864">[</span><span class="op" id="4404865">]</span><span class="builtintype" id="4404866">byte</span><span class="op" id="4404870">(</span><span class="ident" id="4404871">v</span><span class="op" id="4404872">[</span><span class="num" id="4404873">0</span><span class="op" id="4404874">:</span><span class="ident" id="4404875">l</span><span class="op" id="4404876">]</span><span class="op" id="4404877">)</span><span class="op" id="4404878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404883">z</span>&nbsp;<span class="op" id="4404885">=</span>&nbsp;<span class="ident" id="4404887">z</span><span class="op" id="4404888">[</span><span class="num" id="4404889">1</span><span class="op" id="4404890">+</span><span class="ident" id="4404891">l</span><span class="op" id="4404892">:</span><span class="op" id="4404893">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4404897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4404900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4404903">if</span>&nbsp;<span class="ident" id="4404906">m</span><span class="op" id="4404907">.</span><span class="ident" id="4404908">ocspStapling</span>&nbsp;<span class="op" id="4404921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404925">z</span><span class="op" id="4404926">[</span><span class="num" id="4404927">0</span><span class="op" id="4404928">]</span>&nbsp;<span class="op" id="4404930">=</span>&nbsp;<span class="builtintype" id="4404932">byte</span><span class="op" id="4404936">(</span><span class="ident" id="4404937">extensionStatusRequest</span>&nbsp;<span class="op" id="4404960">&gt;&gt;</span>&nbsp;<span class="num" id="4404963">8</span><span class="op" id="4404964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4404968">z</span><span class="op" id="4404969">[</span><span class="num" id="4404970">1</span><span class="op" id="4404971">]</span>&nbsp;<span class="op" id="4404973">=</span>&nbsp;<span class="builtintype" id="4404975">byte</span><span class="op" id="4404979">(</span><span class="ident" id="4404980">extensionStatusRequest</span><span class="op" id="4405002">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405006">z</span>&nbsp;<span class="op" id="4405008">=</span>&nbsp;<span class="ident" id="4405010">z</span><span class="op" id="4405011">[</span><span class="num" id="4405012">4</span><span class="op" id="4405013">:</span><span class="op" id="4405014">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4405017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4405020">if</span>&nbsp;<span class="ident" id="4405023">m</span><span class="op" id="4405024">.</span><span class="ident" id="4405025">ticketSupported</span>&nbsp;<span class="op" id="4405041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405045">z</span><span class="op" id="4405046">[</span><span class="num" id="4405047">0</span><span class="op" id="4405048">]</span>&nbsp;<span class="op" id="4405050">=</span>&nbsp;<span class="builtintype" id="4405052">byte</span><span class="op" id="4405056">(</span><span class="ident" id="4405057">extensionSessionTicket</span>&nbsp;<span class="op" id="4405080">&gt;&gt;</span>&nbsp;<span class="num" id="4405083">8</span><span class="op" id="4405084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405088">z</span><span class="op" id="4405089">[</span><span class="num" id="4405090">1</span><span class="op" id="4405091">]</span>&nbsp;<span class="op" id="4405093">=</span>&nbsp;<span class="builtintype" id="4405095">byte</span><span class="op" id="4405099">(</span><span class="ident" id="4405100">extensionSessionTicket</span><span class="op" id="4405122">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405126">z</span>&nbsp;<span class="op" id="4405128">=</span>&nbsp;<span class="ident" id="4405130">z</span><span class="op" id="4405131">[</span><span class="num" id="4405132">4</span><span class="op" id="4405133">:</span><span class="op" id="4405134">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4405137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4405140">if</span>&nbsp;<span class="ident" id="4405143">m</span><span class="op" id="4405144">.</span><span class="ident" id="4405145">secureRenegotiation</span>&nbsp;<span class="op" id="4405165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405169">z</span><span class="op" id="4405170">[</span><span class="num" id="4405171">0</span><span class="op" id="4405172">]</span>&nbsp;<span class="op" id="4405174">=</span>&nbsp;<span class="builtintype" id="4405176">byte</span><span class="op" id="4405180">(</span><span class="ident" id="4405181">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4405208">&gt;&gt;</span>&nbsp;<span class="num" id="4405211">8</span><span class="op" id="4405212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405216">z</span><span class="op" id="4405217">[</span><span class="num" id="4405218">1</span><span class="op" id="4405219">]</span>&nbsp;<span class="op" id="4405221">=</span>&nbsp;<span class="builtintype" id="4405223">byte</span><span class="op" id="4405227">(</span><span class="ident" id="4405228">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4405255">&amp;</span>&nbsp;<span class="num" id="4405257">0xff</span><span class="op" id="4405261">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405265">z</span><span class="op" id="4405266">[</span><span class="num" id="4405267">2</span><span class="op" id="4405268">]</span>&nbsp;<span class="op" id="4405270">=</span>&nbsp;<span class="num" id="4405272">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405276">z</span><span class="op" id="4405277">[</span><span class="num" id="4405278">3</span><span class="op" id="4405279">]</span>&nbsp;<span class="op" id="4405281">=</span>&nbsp;<span class="num" id="4405283">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405287">z</span>&nbsp;<span class="op" id="4405289">=</span>&nbsp;<span class="ident" id="4405291">z</span><span class="op" id="4405292">[</span><span class="num" id="4405293">5</span><span class="op" id="4405294">:</span><span class="op" id="4405295">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4405298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4405301">if</span>&nbsp;<span class="ident" id="4405304">alpnLen</span>&nbsp;<span class="op" id="4405312">:=</span>&nbsp;<span class="builtinfunc" id="4405315">len</span><span class="op" id="4405318">(</span><span class="ident" id="4405319">m</span><span class="op" id="4405320">.</span><span class="ident" id="4405321">alpnProtocol</span><span class="op" id="4405333">)</span><span class="op" id="4405334">;</span>&nbsp;<span class="ident" id="4405336">alpnLen</span>&nbsp;<span class="op" id="4405344">&gt;</span>&nbsp;<span class="num" id="4405346">0</span>&nbsp;<span class="op" id="4405348">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405352">z</span><span class="op" id="4405353">[</span><span class="num" id="4405354">0</span><span class="op" id="4405355">]</span>&nbsp;<span class="op" id="4405357">=</span>&nbsp;<span class="builtintype" id="4405359">byte</span><span class="op" id="4405363">(</span><span class="ident" id="4405364">extensionALPN</span>&nbsp;<span class="op" id="4405378">&gt;&gt;</span>&nbsp;<span class="num" id="4405381">8</span><span class="op" id="4405382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405386">z</span><span class="op" id="4405387">[</span><span class="num" id="4405388">1</span><span class="op" id="4405389">]</span>&nbsp;<span class="op" id="4405391">=</span>&nbsp;<span class="builtintype" id="4405393">byte</span><span class="op" id="4405397">(</span><span class="ident" id="4405398">extensionALPN</span>&nbsp;<span class="op" id="4405412">&amp;</span>&nbsp;<span class="num" id="4405414">0xff</span><span class="op" id="4405418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405422">l</span>&nbsp;<span class="op" id="4405424">:=</span>&nbsp;<span class="num" id="4405427">2</span>&nbsp;<span class="op" id="4405429">+</span>&nbsp;<span class="num" id="4405431">1</span>&nbsp;<span class="op" id="4405433">+</span>&nbsp;<span class="ident" id="4405435">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405445">z</span><span class="op" id="4405446">[</span><span class="num" id="4405447">2</span><span class="op" id="4405448">]</span>&nbsp;<span class="op" id="4405450">=</span>&nbsp;<span class="builtintype" id="4405452">byte</span><span class="op" id="4405456">(</span><span class="ident" id="4405457">l</span>&nbsp;<span class="op" id="4405459">&gt;&gt;</span>&nbsp;<span class="num" id="4405462">8</span><span class="op" id="4405463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405467">z</span><span class="op" id="4405468">[</span><span class="num" id="4405469">3</span><span class="op" id="4405470">]</span>&nbsp;<span class="op" id="4405472">=</span>&nbsp;<span class="builtintype" id="4405474">byte</span><span class="op" id="4405478">(</span><span class="ident" id="4405479">l</span><span class="op" id="4405480">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405484">l</span>&nbsp;<span class="op" id="4405486">-=</span>&nbsp;<span class="num" id="4405489">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405493">z</span><span class="op" id="4405494">[</span><span class="num" id="4405495">4</span><span class="op" id="4405496">]</span>&nbsp;<span class="op" id="4405498">=</span>&nbsp;<span class="builtintype" id="4405500">byte</span><span class="op" id="4405504">(</span><span class="ident" id="4405505">l</span>&nbsp;<span class="op" id="4405507">&gt;&gt;</span>&nbsp;<span class="num" id="4405510">8</span><span class="op" id="4405511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405515">z</span><span class="op" id="4405516">[</span><span class="num" id="4405517">5</span><span class="op" id="4405518">]</span>&nbsp;<span class="op" id="4405520">=</span>&nbsp;<span class="builtintype" id="4405522">byte</span><span class="op" id="4405526">(</span><span class="ident" id="4405527">l</span><span class="op" id="4405528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405532">l</span>&nbsp;<span class="op" id="4405534">-=</span>&nbsp;<span class="num" id="4405537">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405541">z</span><span class="op" id="4405542">[</span><span class="num" id="4405543">6</span><span class="op" id="4405544">]</span>&nbsp;<span class="op" id="4405546">=</span>&nbsp;<span class="builtintype" id="4405548">byte</span><span class="op" id="4405552">(</span><span class="ident" id="4405553">l</span><span class="op" id="4405554">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4405558">copy</span><span class="op" id="4405562">(</span><span class="ident" id="4405563">z</span><span class="op" id="4405564">[</span><span class="num" id="4405565">7</span><span class="op" id="4405566">:</span><span class="op" id="4405567">]</span><span class="op" id="4405568">,</span>&nbsp;<span class="op" id="4405570">[</span><span class="op" id="4405571">]</span><span class="builtintype" id="4405572">byte</span><span class="op" id="4405576">(</span><span class="ident" id="4405577">m</span><span class="op" id="4405578">.</span><span class="ident" id="4405579">alpnProtocol</span><span class="op" id="4405591">)</span><span class="op" id="4405592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405596">z</span>&nbsp;<span class="op" id="4405598">=</span>&nbsp;<span class="ident" id="4405600">z</span><span class="op" id="4405601">[</span><span class="num" id="4405602">7</span><span class="op" id="4405603">+</span><span class="ident" id="4405604">alpnLen</span><span class="op" id="4405611">:</span><span class="op" id="4405612">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4405615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405619">m</span><span class="op" id="4405620">.</span><span class="ident" id="4405621">raw</span>&nbsp;<span class="op" id="4405625">=</span>&nbsp;<span class="ident" id="4405627">x</span><br>
<span class="lineno">610</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4405631">return</span>&nbsp;<span class="ident" id="4405638">x</span><br>
<span class="lineno"></span><span class="op" id="4405640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4405643">func</span>&nbsp;<span class="op" id="4405648">(</span><span class="ident" id="4405649">m</span>&nbsp;<span class="op" id="4405651">*</span><span class="ident" id="4405652">serverHelloMsg</span><span class="op" id="4405666">)</span>&nbsp;<span class="ident" id="4405668">unmarshal</span><span class="op" id="4405677">(</span><span class="ident" id="4405678">data</span>&nbsp;<span class="op" id="4405683">[</span><span class="op" id="4405684">]</span><span class="builtintype" id="4405685">byte</span><span class="op" id="4405689">)</span>&nbsp;<span class="builtintype" id="4405691">bool</span>&nbsp;<span class="op" id="4405696">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4405699">if</span>&nbsp;<span class="builtinfunc" id="4405702">len</span><span class="op" id="4405705">(</span><span class="ident" id="4405706">data</span><span class="op" id="4405710">)</span>&nbsp;<span class="op" id="4405712">&lt;</span>&nbsp;<span class="num" id="4405714">42</span>&nbsp;<span class="op" id="4405717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4405721">return</span>&nbsp;<span class="builtintype" id="4405728">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4405735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405738">m</span><span class="op" id="4405739">.</span><span class="ident" id="4405740">raw</span>&nbsp;<span class="op" id="4405744">=</span>&nbsp;<span class="ident" id="4405746">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405752">m</span><span class="op" id="4405753">.</span><span class="ident" id="4405754">vers</span>&nbsp;<span class="op" id="4405759">=</span>&nbsp;<span class="builtintype" id="4405761">uint16</span><span class="op" id="4405767">(</span><span class="ident" id="4405768">data</span><span class="op" id="4405772">[</span><span class="num" id="4405773">4</span><span class="op" id="4405774">]</span><span class="op" id="4405775">)</span><span class="op" id="4405776">&lt;&lt;</span><span class="num" id="4405778">8</span>&nbsp;<span class="op" id="4405780">|</span>&nbsp;<span class="builtintype" id="4405782">uint16</span><span class="op" id="4405788">(</span><span class="ident" id="4405789">data</span><span class="op" id="4405793">[</span><span class="num" id="4405794">5</span><span class="op" id="4405795">]</span><span class="op" id="4405796">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405799">m</span><span class="op" id="4405800">.</span><span class="ident" id="4405801">random</span>&nbsp;<span class="op" id="4405808">=</span>&nbsp;<span class="ident" id="4405810">data</span><span class="op" id="4405814">[</span><span class="num" id="4405815">6</span><span class="op" id="4405816">:</span><span class="num" id="4405817">38</span><span class="op" id="4405819">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405822">sessionIdLen</span>&nbsp;<span class="op" id="4405835">:=</span>&nbsp;<span class="builtintype" id="4405838">int</span><span class="op" id="4405841">(</span><span class="ident" id="4405842">data</span><span class="op" id="4405846">[</span><span class="num" id="4405847">38</span><span class="op" id="4405849">]</span><span class="op" id="4405850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4405853">if</span>&nbsp;<span class="ident" id="4405856">sessionIdLen</span>&nbsp;<span class="op" id="4405869">&gt;</span>&nbsp;<span class="num" id="4405871">32</span>&nbsp;<span class="op" id="4405874">||</span>&nbsp;<span class="builtinfunc" id="4405877">len</span><span class="op" id="4405880">(</span><span class="ident" id="4405881">data</span><span class="op" id="4405885">)</span>&nbsp;<span class="op" id="4405887">&lt;</span>&nbsp;<span class="num" id="4405889">39</span><span class="op" id="4405891">+</span><span class="ident" id="4405892">sessionIdLen</span>&nbsp;<span class="op" id="4405905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4405909">return</span>&nbsp;<span class="builtintype" id="4405916">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4405923">}</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405926">m</span><span class="op" id="4405927">.</span><span class="ident" id="4405928">sessionId</span>&nbsp;<span class="op" id="4405938">=</span>&nbsp;<span class="ident" id="4405940">data</span><span class="op" id="4405944">[</span><span class="num" id="4405945">39</span>&nbsp;<span class="op" id="4405948">:</span>&nbsp;<span class="num" id="4405950">39</span><span class="op" id="4405952">+</span><span class="ident" id="4405953">sessionIdLen</span><span class="op" id="4405965">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4405968">data</span>&nbsp;<span class="op" id="4405973">=</span>&nbsp;<span class="ident" id="4405975">data</span><span class="op" id="4405979">[</span><span class="num" id="4405980">39</span><span class="op" id="4405982">+</span><span class="ident" id="4405983">sessionIdLen</span><span class="op" id="4405995">:</span><span class="op" id="4405996">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4405999">if</span>&nbsp;<span class="builtinfunc" id="4406002">len</span><span class="op" id="4406005">(</span><span class="ident" id="4406006">data</span><span class="op" id="4406010">)</span>&nbsp;<span class="op" id="4406012">&lt;</span>&nbsp;<span class="num" id="4406014">3</span>&nbsp;<span class="op" id="4406016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406020">return</span>&nbsp;<span class="builtintype" id="4406027">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4406034">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406037">m</span><span class="op" id="4406038">.</span><span class="ident" id="4406039">cipherSuite</span>&nbsp;<span class="op" id="4406051">=</span>&nbsp;<span class="builtintype" id="4406053">uint16</span><span class="op" id="4406059">(</span><span class="ident" id="4406060">data</span><span class="op" id="4406064">[</span><span class="num" id="4406065">0</span><span class="op" id="4406066">]</span><span class="op" id="4406067">)</span><span class="op" id="4406068">&lt;&lt;</span><span class="num" id="4406070">8</span>&nbsp;<span class="op" id="4406072">|</span>&nbsp;<span class="builtintype" id="4406074">uint16</span><span class="op" id="4406080">(</span><span class="ident" id="4406081">data</span><span class="op" id="4406085">[</span><span class="num" id="4406086">1</span><span class="op" id="4406087">]</span><span class="op" id="4406088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406091">m</span><span class="op" id="4406092">.</span><span class="ident" id="4406093">compressionMethod</span>&nbsp;<span class="op" id="4406111">=</span>&nbsp;<span class="ident" id="4406113">data</span><span class="op" id="4406117">[</span><span class="num" id="4406118">2</span><span class="op" id="4406119">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406122">data</span>&nbsp;<span class="op" id="4406127">=</span>&nbsp;<span class="ident" id="4406129">data</span><span class="op" id="4406133">[</span><span class="num" id="4406134">3</span><span class="op" id="4406135">:</span><span class="op" id="4406136">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406140">m</span><span class="op" id="4406141">.</span><span class="ident" id="4406142">nextProtoNeg</span>&nbsp;<span class="op" id="4406155">=</span>&nbsp;<span class="builtintype" id="4406157">false</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406164">m</span><span class="op" id="4406165">.</span><span class="ident" id="4406166">nextProtos</span>&nbsp;<span class="op" id="4406177">=</span>&nbsp;<span class="builtintype" id="4406179">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406184">m</span><span class="op" id="4406185">.</span><span class="ident" id="4406186">ocspStapling</span>&nbsp;<span class="op" id="4406199">=</span>&nbsp;<span class="builtintype" id="4406201">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406208">m</span><span class="op" id="4406209">.</span><span class="ident" id="4406210">ticketSupported</span>&nbsp;<span class="op" id="4406226">=</span>&nbsp;<span class="builtintype" id="4406228">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406235">m</span><span class="op" id="4406236">.</span><span class="ident" id="4406237">alpnProtocol</span>&nbsp;<span class="op" id="4406250">=</span>&nbsp;<span class="string" id="4406252">&#34;&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406257">if</span>&nbsp;<span class="builtinfunc" id="4406260">len</span><span class="op" id="4406263">(</span><span class="ident" id="4406264">data</span><span class="op" id="4406268">)</span>&nbsp;<span class="op" id="4406270">==</span>&nbsp;<span class="num" id="4406273">0</span>&nbsp;<span class="op" id="4406275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4406279">//&nbsp;ServerHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406337">return</span>&nbsp;<span class="builtintype" id="4406344">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4406350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406353">if</span>&nbsp;<span class="builtinfunc" id="4406356">len</span><span class="op" id="4406359">(</span><span class="ident" id="4406360">data</span><span class="op" id="4406364">)</span>&nbsp;<span class="op" id="4406366">&lt;</span>&nbsp;<span class="num" id="4406368">2</span>&nbsp;<span class="op" id="4406370">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406374">return</span>&nbsp;<span class="builtintype" id="4406381">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4406388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406392">extensionsLength</span>&nbsp;<span class="op" id="4406409">:=</span>&nbsp;<span class="builtintype" id="4406412">int</span><span class="op" id="4406415">(</span><span class="ident" id="4406416">data</span><span class="op" id="4406420">[</span><span class="num" id="4406421">0</span><span class="op" id="4406422">]</span><span class="op" id="4406423">)</span><span class="op" id="4406424">&lt;&lt;</span><span class="num" id="4406426">8</span>&nbsp;<span class="op" id="4406428">|</span>&nbsp;<span class="builtintype" id="4406430">int</span><span class="op" id="4406433">(</span><span class="ident" id="4406434">data</span><span class="op" id="4406438">[</span><span class="num" id="4406439">1</span><span class="op" id="4406440">]</span><span class="op" id="4406441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406444">data</span>&nbsp;<span class="op" id="4406449">=</span>&nbsp;<span class="ident" id="4406451">data</span><span class="op" id="4406455">[</span><span class="num" id="4406456">2</span><span class="op" id="4406457">:</span><span class="op" id="4406458">]</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406461">if</span>&nbsp;<span class="builtinfunc" id="4406464">len</span><span class="op" id="4406467">(</span><span class="ident" id="4406468">data</span><span class="op" id="4406472">)</span>&nbsp;<span class="op" id="4406474">!=</span>&nbsp;<span class="ident" id="4406477">extensionsLength</span>&nbsp;<span class="op" id="4406494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406498">return</span>&nbsp;<span class="builtintype" id="4406505">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4406512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406516">for</span>&nbsp;<span class="builtinfunc" id="4406520">len</span><span class="op" id="4406523">(</span><span class="ident" id="4406524">data</span><span class="op" id="4406528">)</span>&nbsp;<span class="op" id="4406530">!=</span>&nbsp;<span class="num" id="4406533">0</span>&nbsp;<span class="op" id="4406535">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406539">if</span>&nbsp;<span class="builtinfunc" id="4406542">len</span><span class="op" id="4406545">(</span><span class="ident" id="4406546">data</span><span class="op" id="4406550">)</span>&nbsp;<span class="op" id="4406552">&lt;</span>&nbsp;<span class="num" id="4406554">4</span>&nbsp;<span class="op" id="4406556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406561">return</span>&nbsp;<span class="builtintype" id="4406568">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4406576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406580">extension</span>&nbsp;<span class="op" id="4406590">:=</span>&nbsp;<span class="builtintype" id="4406593">uint16</span><span class="op" id="4406599">(</span><span class="ident" id="4406600">data</span><span class="op" id="4406604">[</span><span class="num" id="4406605">0</span><span class="op" id="4406606">]</span><span class="op" id="4406607">)</span><span class="op" id="4406608">&lt;&lt;</span><span class="num" id="4406610">8</span>&nbsp;<span class="op" id="4406612">|</span>&nbsp;<span class="builtintype" id="4406614">uint16</span><span class="op" id="4406620">(</span><span class="ident" id="4406621">data</span><span class="op" id="4406625">[</span><span class="num" id="4406626">1</span><span class="op" id="4406627">]</span><span class="op" id="4406628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406632">length</span>&nbsp;<span class="op" id="4406639">:=</span>&nbsp;<span class="builtintype" id="4406642">int</span><span class="op" id="4406645">(</span><span class="ident" id="4406646">data</span><span class="op" id="4406650">[</span><span class="num" id="4406651">2</span><span class="op" id="4406652">]</span><span class="op" id="4406653">)</span><span class="op" id="4406654">&lt;&lt;</span><span class="num" id="4406656">8</span>&nbsp;<span class="op" id="4406658">|</span>&nbsp;<span class="builtintype" id="4406660">int</span><span class="op" id="4406663">(</span><span class="ident" id="4406664">data</span><span class="op" id="4406668">[</span><span class="num" id="4406669">3</span><span class="op" id="4406670">]</span><span class="op" id="4406671">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406675">data</span>&nbsp;<span class="op" id="4406680">=</span>&nbsp;<span class="ident" id="4406682">data</span><span class="op" id="4406686">[</span><span class="num" id="4406687">4</span><span class="op" id="4406688">:</span><span class="op" id="4406689">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406693">if</span>&nbsp;<span class="builtinfunc" id="4406696">len</span><span class="op" id="4406699">(</span><span class="ident" id="4406700">data</span><span class="op" id="4406704">)</span>&nbsp;<span class="op" id="4406706">&lt;</span>&nbsp;<span class="ident" id="4406708">length</span>&nbsp;<span class="op" id="4406715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406720">return</span>&nbsp;<span class="builtintype" id="4406727">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4406735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406740">switch</span>&nbsp;<span class="ident" id="4406747">extension</span>&nbsp;<span class="op" id="4406757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406761">case</span>&nbsp;<span class="ident" id="4406766">extensionNextProtoNeg</span><span class="op" id="4406787">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406792">m</span><span class="op" id="4406793">.</span><span class="ident" id="4406794">nextProtoNeg</span>&nbsp;<span class="op" id="4406807">=</span>&nbsp;<span class="builtintype" id="4406809">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406817">d</span>&nbsp;<span class="op" id="4406819">:=</span>&nbsp;<span class="ident" id="4406822">data</span><span class="op" id="4406826">[</span><span class="op" id="4406827">:</span><span class="ident" id="4406828">length</span><span class="op" id="4406834">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406839">for</span>&nbsp;<span class="builtinfunc" id="4406843">len</span><span class="op" id="4406846">(</span><span class="ident" id="4406847">d</span><span class="op" id="4406848">)</span>&nbsp;<span class="op" id="4406850">&gt;</span>&nbsp;<span class="num" id="4406852">0</span>&nbsp;<span class="op" id="4406854">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406860">l</span>&nbsp;<span class="op" id="4406862">:=</span>&nbsp;<span class="builtintype" id="4406865">int</span><span class="op" id="4406868">(</span><span class="ident" id="4406869">d</span><span class="op" id="4406870">[</span><span class="num" id="4406871">0</span><span class="op" id="4406872">]</span><span class="op" id="4406873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406879">d</span>&nbsp;<span class="op" id="4406881">=</span>&nbsp;<span class="ident" id="4406883">d</span><span class="op" id="4406884">[</span><span class="num" id="4406885">1</span><span class="op" id="4406886">:</span><span class="op" id="4406887">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406893">if</span>&nbsp;<span class="ident" id="4406896">l</span>&nbsp;<span class="op" id="4406898">==</span>&nbsp;<span class="num" id="4406901">0</span>&nbsp;<span class="op" id="4406903">||</span>&nbsp;<span class="ident" id="4406906">l</span>&nbsp;<span class="op" id="4406908">&gt;</span>&nbsp;<span class="builtinfunc" id="4406910">len</span><span class="op" id="4406913">(</span><span class="ident" id="4406914">d</span><span class="op" id="4406915">)</span>&nbsp;<span class="op" id="4406917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4406924">return</span>&nbsp;<span class="builtintype" id="4406931">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4406941">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4406947">m</span><span class="op" id="4406948">.</span><span class="ident" id="4406949">nextProtos</span>&nbsp;<span class="op" id="4406960">=</span>&nbsp;<span class="builtinfunc" id="4406962">append</span><span class="op" id="4406968">(</span><span class="ident" id="4406969">m</span><span class="op" id="4406970">.</span><span class="ident" id="4406971">nextProtos</span><span class="op" id="4406981">,</span>&nbsp;<span class="builtintype" id="4406983">string</span><span class="op" id="4406989">(</span><span class="ident" id="4406990">d</span><span class="op" id="4406991">[</span><span class="op" id="4406992">:</span><span class="ident" id="4406993">l</span><span class="op" id="4406994">]</span><span class="op" id="4406995">)</span><span class="op" id="4406996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407002">d</span>&nbsp;<span class="op" id="4407004">=</span>&nbsp;<span class="ident" id="4407006">d</span><span class="op" id="4407007">[</span><span class="ident" id="4407008">l</span><span class="op" id="4407009">:</span><span class="op" id="4407010">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4407015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407019">case</span>&nbsp;<span class="ident" id="4407024">extensionStatusRequest</span><span class="op" id="4407046">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407051">if</span>&nbsp;<span class="ident" id="4407054">length</span>&nbsp;<span class="op" id="4407061">&gt;</span>&nbsp;<span class="num" id="4407063">0</span>&nbsp;<span class="op" id="4407065">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407071">return</span>&nbsp;<span class="builtintype" id="4407078">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4407087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407092">m</span><span class="op" id="4407093">.</span><span class="ident" id="4407094">ocspStapling</span>&nbsp;<span class="op" id="4407107">=</span>&nbsp;<span class="builtintype" id="4407109">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407116">case</span>&nbsp;<span class="ident" id="4407121">extensionSessionTicket</span><span class="op" id="4407143">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407148">if</span>&nbsp;<span class="ident" id="4407151">length</span>&nbsp;<span class="op" id="4407158">&gt;</span>&nbsp;<span class="num" id="4407160">0</span>&nbsp;<span class="op" id="4407162">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407168">return</span>&nbsp;<span class="builtintype" id="4407175">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4407184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407189">m</span><span class="op" id="4407190">.</span><span class="ident" id="4407191">ticketSupported</span>&nbsp;<span class="op" id="4407207">=</span>&nbsp;<span class="builtintype" id="4407209">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407216">case</span>&nbsp;<span class="ident" id="4407221">extensionRenegotiationInfo</span><span class="op" id="4407247">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407252">if</span>&nbsp;<span class="ident" id="4407255">length</span>&nbsp;<span class="op" id="4407262">!=</span>&nbsp;<span class="num" id="4407265">1</span>&nbsp;<span class="op" id="4407267">||</span>&nbsp;<span class="ident" id="4407270">data</span><span class="op" id="4407274">[</span><span class="num" id="4407275">0</span><span class="op" id="4407276">]</span>&nbsp;<span class="op" id="4407278">!=</span>&nbsp;<span class="num" id="4407281">0</span>&nbsp;<span class="op" id="4407283">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407289">return</span>&nbsp;<span class="builtintype" id="4407296">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4407305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407310">m</span><span class="op" id="4407311">.</span><span class="ident" id="4407312">secureRenegotiation</span>&nbsp;<span class="op" id="4407332">=</span>&nbsp;<span class="builtintype" id="4407334">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407341">case</span>&nbsp;<span class="ident" id="4407346">extensionALPN</span><span class="op" id="4407359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407364">d</span>&nbsp;<span class="op" id="4407366">:=</span>&nbsp;<span class="ident" id="4407369">data</span><span class="op" id="4407373">[</span><span class="op" id="4407374">:</span><span class="ident" id="4407375">length</span><span class="op" id="4407381">]</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407386">if</span>&nbsp;<span class="builtinfunc" id="4407389">len</span><span class="op" id="4407392">(</span><span class="ident" id="4407393">d</span><span class="op" id="4407394">)</span>&nbsp;<span class="op" id="4407396">&lt;</span>&nbsp;<span class="num" id="4407398">3</span>&nbsp;<span class="op" id="4407400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407406">return</span>&nbsp;<span class="builtintype" id="4407413">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4407422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407427">l</span>&nbsp;<span class="op" id="4407429">:=</span>&nbsp;<span class="builtintype" id="4407432">int</span><span class="op" id="4407435">(</span><span class="ident" id="4407436">d</span><span class="op" id="4407437">[</span><span class="num" id="4407438">0</span><span class="op" id="4407439">]</span><span class="op" id="4407440">)</span><span class="op" id="4407441">&lt;&lt;</span><span class="num" id="4407443">8</span>&nbsp;<span class="op" id="4407445">|</span>&nbsp;<span class="builtintype" id="4407447">int</span><span class="op" id="4407450">(</span><span class="ident" id="4407451">d</span><span class="op" id="4407452">[</span><span class="num" id="4407453">1</span><span class="op" id="4407454">]</span><span class="op" id="4407455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407460">if</span>&nbsp;<span class="ident" id="4407463">l</span>&nbsp;<span class="op" id="4407465">!=</span>&nbsp;<span class="builtinfunc" id="4407468">len</span><span class="op" id="4407471">(</span><span class="ident" id="4407472">d</span><span class="op" id="4407473">)</span><span class="op" id="4407474">-</span><span class="num" id="4407475">2</span>&nbsp;<span class="op" id="4407477">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407483">return</span>&nbsp;<span class="builtintype" id="4407490">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4407499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407504">d</span>&nbsp;<span class="op" id="4407506">=</span>&nbsp;<span class="ident" id="4407508">d</span><span class="op" id="4407509">[</span><span class="num" id="4407510">2</span><span class="op" id="4407511">:</span><span class="op" id="4407512">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407517">l</span>&nbsp;<span class="op" id="4407519">=</span>&nbsp;<span class="builtintype" id="4407521">int</span><span class="op" id="4407524">(</span><span class="ident" id="4407525">d</span><span class="op" id="4407526">[</span><span class="num" id="4407527">0</span><span class="op" id="4407528">]</span><span class="op" id="4407529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407534">if</span>&nbsp;<span class="ident" id="4407537">l</span>&nbsp;<span class="op" id="4407539">!=</span>&nbsp;<span class="builtinfunc" id="4407542">len</span><span class="op" id="4407545">(</span><span class="ident" id="4407546">d</span><span class="op" id="4407547">)</span><span class="op" id="4407548">-</span><span class="num" id="4407549">1</span>&nbsp;<span class="op" id="4407551">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407557">return</span>&nbsp;<span class="builtintype" id="4407564">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4407573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407578">d</span>&nbsp;<span class="op" id="4407580">=</span>&nbsp;<span class="ident" id="4407582">d</span><span class="op" id="4407583">[</span><span class="num" id="4407584">1</span><span class="op" id="4407585">:</span><span class="op" id="4407586">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407591">m</span><span class="op" id="4407592">.</span><span class="ident" id="4407593">alpnProtocol</span>&nbsp;<span class="op" id="4407606">=</span>&nbsp;<span class="builtintype" id="4407608">string</span><span class="op" id="4407614">(</span><span class="ident" id="4407615">d</span><span class="op" id="4407616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4407620">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407624">data</span>&nbsp;<span class="op" id="4407629">=</span>&nbsp;<span class="ident" id="4407631">data</span><span class="op" id="4407635">[</span><span class="ident" id="4407636">length</span><span class="op" id="4407642">:</span><span class="op" id="4407643">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4407646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407650">return</span>&nbsp;<span class="builtintype" id="4407657">true</span><br>
<span class="lineno"></span><span class="op" id="4407662">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="4407665">type</span>&nbsp;<span class="ident" id="4407670">certificateMsg</span>&nbsp;<span class="keyword" id="4407685">struct</span>&nbsp;<span class="op" id="4407692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407695">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4407708">[</span><span class="op" id="4407709">]</span><span class="builtintype" id="4407710">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407716">certificates</span>&nbsp;<span class="op" id="4407729">[</span><span class="op" id="4407730">]</span><span class="op" id="4407731">[</span><span class="op" id="4407732">]</span><span class="builtintype" id="4407733">byte</span><br>
<span class="lineno"></span><span class="op" id="4407738">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="4407741">func</span>&nbsp;<span class="op" id="4407746">(</span><span class="ident" id="4407747">m</span>&nbsp;<span class="op" id="4407749">*</span><span class="ident" id="4407750">certificateMsg</span><span class="op" id="4407764">)</span>&nbsp;<span class="ident" id="4407766">equal</span><span class="op" id="4407771">(</span><span class="ident" id="4407772">i</span>&nbsp;<span class="keyword" id="4407774">interface</span><span class="op" id="4407783">{</span><span class="op" id="4407784">}</span><span class="op" id="4407785">)</span>&nbsp;<span class="builtintype" id="4407787">bool</span>&nbsp;<span class="op" id="4407792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407795">m1</span><span class="op" id="4407797">,</span>&nbsp;<span class="ident" id="4407799">ok</span>&nbsp;<span class="op" id="4407802">:=</span>&nbsp;<span class="ident" id="4407805">i</span><span class="op" id="4407806">.</span><span class="op" id="4407807">(</span><span class="op" id="4407808">*</span><span class="ident" id="4407809">certificateMsg</span><span class="op" id="4407823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407826">if</span>&nbsp;<span class="op" id="4407829">!</span><span class="ident" id="4407830">ok</span>&nbsp;<span class="op" id="4407833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407837">return</span>&nbsp;<span class="builtintype" id="4407844">false</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4407851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407855">return</span>&nbsp;<span class="ident" id="4407862">bytes</span><span class="op" id="4407867">.</span><span class="ident" id="4407868">Equal</span><span class="op" id="4407873">(</span><span class="ident" id="4407874">m</span><span class="op" id="4407875">.</span><span class="ident" id="4407876">raw</span><span class="op" id="4407879">,</span>&nbsp;<span class="ident" id="4407881">m1</span><span class="op" id="4407883">.</span><span class="ident" id="4407884">raw</span><span class="op" id="4407887">)</span>&nbsp;<span class="op" id="4407889">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4407894">eqByteSlices</span><span class="op" id="4407906">(</span><span class="ident" id="4407907">m</span><span class="op" id="4407908">.</span><span class="ident" id="4407909">certificates</span><span class="op" id="4407921">,</span>&nbsp;<span class="ident" id="4407923">m1</span><span class="op" id="4407925">.</span><span class="ident" id="4407926">certificates</span><span class="op" id="4407938">)</span><br>
<span class="lineno"></span><span class="op" id="4407940">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span><span class="keyword" id="4407943">func</span>&nbsp;<span class="op" id="4407948">(</span><span class="ident" id="4407949">m</span>&nbsp;<span class="op" id="4407951">*</span><span class="ident" id="4407952">certificateMsg</span><span class="op" id="4407966">)</span>&nbsp;<span class="ident" id="4407968">marshal</span><span class="op" id="4407975">(</span><span class="op" id="4407976">)</span>&nbsp;<span class="op" id="4407978">(</span><span class="ident" id="4407979">x</span>&nbsp;<span class="op" id="4407981">[</span><span class="op" id="4407982">]</span><span class="builtintype" id="4407983">byte</span><span class="op" id="4407987">)</span>&nbsp;<span class="op" id="4407989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4407992">if</span>&nbsp;<span class="ident" id="4407995">m</span><span class="op" id="4407996">.</span><span class="ident" id="4407997">raw</span>&nbsp;<span class="op" id="4408001">!=</span>&nbsp;<span class="builtintype" id="4408004">nil</span>&nbsp;<span class="op" id="4408008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408012">return</span>&nbsp;<span class="ident" id="4408019">m</span><span class="op" id="4408020">.</span><span class="ident" id="4408021">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4408026">}</span><br>
<span class="lineno">735</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408030">var</span>&nbsp;<span class="ident" id="4408034">i</span>&nbsp;<span class="builtintype" id="4408036">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408041">for</span>&nbsp;<span class="ident" id="4408045">_</span><span class="op" id="4408046">,</span>&nbsp;<span class="ident" id="4408048">slice</span>&nbsp;<span class="op" id="4408054">:=</span>&nbsp;<span class="keyword" id="4408057">range</span>&nbsp;<span class="ident" id="4408063">m</span><span class="op" id="4408064">.</span><span class="ident" id="4408065">certificates</span>&nbsp;<span class="op" id="4408078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408082">i</span>&nbsp;<span class="op" id="4408084">+=</span>&nbsp;<span class="builtinfunc" id="4408087">len</span><span class="op" id="4408090">(</span><span class="ident" id="4408091">slice</span><span class="op" id="4408096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4408099">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408103">length</span>&nbsp;<span class="op" id="4408110">:=</span>&nbsp;<span class="num" id="4408113">3</span>&nbsp;<span class="op" id="4408115">+</span>&nbsp;<span class="num" id="4408117">3</span><span class="op" id="4408118">*</span><span class="builtinfunc" id="4408119">len</span><span class="op" id="4408122">(</span><span class="ident" id="4408123">m</span><span class="op" id="4408124">.</span><span class="ident" id="4408125">certificates</span><span class="op" id="4408137">)</span>&nbsp;<span class="op" id="4408139">+</span>&nbsp;<span class="ident" id="4408141">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408144">x</span>&nbsp;<span class="op" id="4408146">=</span>&nbsp;<span class="builtinfunc" id="4408148">make</span><span class="op" id="4408152">(</span><span class="op" id="4408153">[</span><span class="op" id="4408154">]</span><span class="builtintype" id="4408155">byte</span><span class="op" id="4408159">,</span>&nbsp;<span class="num" id="4408161">4</span><span class="op" id="4408162">+</span><span class="ident" id="4408163">length</span><span class="op" id="4408169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408172">x</span><span class="op" id="4408173">[</span><span class="num" id="4408174">0</span><span class="op" id="4408175">]</span>&nbsp;<span class="op" id="4408177">=</span>&nbsp;<span class="ident" id="4408179">typeCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408196">x</span><span class="op" id="4408197">[</span><span class="num" id="4408198">1</span><span class="op" id="4408199">]</span>&nbsp;<span class="op" id="4408201">=</span>&nbsp;<span class="builtintype" id="4408203">uint8</span><span class="op" id="4408208">(</span><span class="ident" id="4408209">length</span>&nbsp;<span class="op" id="4408216">&gt;&gt;</span>&nbsp;<span class="num" id="4408219">16</span><span class="op" id="4408221">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408224">x</span><span class="op" id="4408225">[</span><span class="num" id="4408226">2</span><span class="op" id="4408227">]</span>&nbsp;<span class="op" id="4408229">=</span>&nbsp;<span class="builtintype" id="4408231">uint8</span><span class="op" id="4408236">(</span><span class="ident" id="4408237">length</span>&nbsp;<span class="op" id="4408244">&gt;&gt;</span>&nbsp;<span class="num" id="4408247">8</span><span class="op" id="4408248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408251">x</span><span class="op" id="4408252">[</span><span class="num" id="4408253">3</span><span class="op" id="4408254">]</span>&nbsp;<span class="op" id="4408256">=</span>&nbsp;<span class="builtintype" id="4408258">uint8</span><span class="op" id="4408263">(</span><span class="ident" id="4408264">length</span><span class="op" id="4408270">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408274">certificateOctets</span>&nbsp;<span class="op" id="4408292">:=</span>&nbsp;<span class="ident" id="4408295">length</span>&nbsp;<span class="op" id="4408302">-</span>&nbsp;<span class="num" id="4408304">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408307">x</span><span class="op" id="4408308">[</span><span class="num" id="4408309">4</span><span class="op" id="4408310">]</span>&nbsp;<span class="op" id="4408312">=</span>&nbsp;<span class="builtintype" id="4408314">uint8</span><span class="op" id="4408319">(</span><span class="ident" id="4408320">certificateOctets</span>&nbsp;<span class="op" id="4408338">&gt;&gt;</span>&nbsp;<span class="num" id="4408341">16</span><span class="op" id="4408343">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408346">x</span><span class="op" id="4408347">[</span><span class="num" id="4408348">5</span><span class="op" id="4408349">]</span>&nbsp;<span class="op" id="4408351">=</span>&nbsp;<span class="builtintype" id="4408353">uint8</span><span class="op" id="4408358">(</span><span class="ident" id="4408359">certificateOctets</span>&nbsp;<span class="op" id="4408377">&gt;&gt;</span>&nbsp;<span class="num" id="4408380">8</span><span class="op" id="4408381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408384">x</span><span class="op" id="4408385">[</span><span class="num" id="4408386">6</span><span class="op" id="4408387">]</span>&nbsp;<span class="op" id="4408389">=</span>&nbsp;<span class="builtintype" id="4408391">uint8</span><span class="op" id="4408396">(</span><span class="ident" id="4408397">certificateOctets</span><span class="op" id="4408414">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408418">y</span>&nbsp;<span class="op" id="4408420">:=</span>&nbsp;<span class="ident" id="4408423">x</span><span class="op" id="4408424">[</span><span class="num" id="4408425">7</span><span class="op" id="4408426">:</span><span class="op" id="4408427">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408430">for</span>&nbsp;<span class="ident" id="4408434">_</span><span class="op" id="4408435">,</span>&nbsp;<span class="ident" id="4408437">slice</span>&nbsp;<span class="op" id="4408443">:=</span>&nbsp;<span class="keyword" id="4408446">range</span>&nbsp;<span class="ident" id="4408452">m</span><span class="op" id="4408453">.</span><span class="ident" id="4408454">certificates</span>&nbsp;<span class="op" id="4408467">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408471">y</span><span class="op" id="4408472">[</span><span class="num" id="4408473">0</span><span class="op" id="4408474">]</span>&nbsp;<span class="op" id="4408476">=</span>&nbsp;<span class="builtintype" id="4408478">uint8</span><span class="op" id="4408483">(</span><span class="builtinfunc" id="4408484">len</span><span class="op" id="4408487">(</span><span class="ident" id="4408488">slice</span><span class="op" id="4408493">)</span>&nbsp;<span class="op" id="4408495">&gt;&gt;</span>&nbsp;<span class="num" id="4408498">16</span><span class="op" id="4408500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408504">y</span><span class="op" id="4408505">[</span><span class="num" id="4408506">1</span><span class="op" id="4408507">]</span>&nbsp;<span class="op" id="4408509">=</span>&nbsp;<span class="builtintype" id="4408511">uint8</span><span class="op" id="4408516">(</span><span class="builtinfunc" id="4408517">len</span><span class="op" id="4408520">(</span><span class="ident" id="4408521">slice</span><span class="op" id="4408526">)</span>&nbsp;<span class="op" id="4408528">&gt;&gt;</span>&nbsp;<span class="num" id="4408531">8</span><span class="op" id="4408532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408536">y</span><span class="op" id="4408537">[</span><span class="num" id="4408538">2</span><span class="op" id="4408539">]</span>&nbsp;<span class="op" id="4408541">=</span>&nbsp;<span class="builtintype" id="4408543">uint8</span><span class="op" id="4408548">(</span><span class="builtinfunc" id="4408549">len</span><span class="op" id="4408552">(</span><span class="ident" id="4408553">slice</span><span class="op" id="4408558">)</span><span class="op" id="4408559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4408563">copy</span><span class="op" id="4408567">(</span><span class="ident" id="4408568">y</span><span class="op" id="4408569">[</span><span class="num" id="4408570">3</span><span class="op" id="4408571">:</span><span class="op" id="4408572">]</span><span class="op" id="4408573">,</span>&nbsp;<span class="ident" id="4408575">slice</span><span class="op" id="4408580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408584">y</span>&nbsp;<span class="op" id="4408586">=</span>&nbsp;<span class="ident" id="4408588">y</span><span class="op" id="4408589">[</span><span class="num" id="4408590">3</span><span class="op" id="4408591">+</span><span class="builtinfunc" id="4408592">len</span><span class="op" id="4408595">(</span><span class="ident" id="4408596">slice</span><span class="op" id="4408601">)</span><span class="op" id="4408602">:</span><span class="op" id="4408603">]</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4408606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408610">m</span><span class="op" id="4408611">.</span><span class="ident" id="4408612">raw</span>&nbsp;<span class="op" id="4408616">=</span>&nbsp;<span class="ident" id="4408618">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408621">return</span><br>
<span class="lineno"></span><span class="op" id="4408628">}</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span><span class="keyword" id="4408631">func</span>&nbsp;<span class="op" id="4408636">(</span><span class="ident" id="4408637">m</span>&nbsp;<span class="op" id="4408639">*</span><span class="ident" id="4408640">certificateMsg</span><span class="op" id="4408654">)</span>&nbsp;<span class="ident" id="4408656">unmarshal</span><span class="op" id="4408665">(</span><span class="ident" id="4408666">data</span>&nbsp;<span class="op" id="4408671">[</span><span class="op" id="4408672">]</span><span class="builtintype" id="4408673">byte</span><span class="op" id="4408677">)</span>&nbsp;<span class="builtintype" id="4408679">bool</span>&nbsp;<span class="op" id="4408684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408687">if</span>&nbsp;<span class="builtinfunc" id="4408690">len</span><span class="op" id="4408693">(</span><span class="ident" id="4408694">data</span><span class="op" id="4408698">)</span>&nbsp;<span class="op" id="4408700">&lt;</span>&nbsp;<span class="num" id="4408702">7</span>&nbsp;<span class="op" id="4408704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408708">return</span>&nbsp;<span class="builtintype" id="4408715">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4408722">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408726">m</span><span class="op" id="4408727">.</span><span class="ident" id="4408728">raw</span>&nbsp;<span class="op" id="4408732">=</span>&nbsp;<span class="ident" id="4408734">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408740">certsLen</span>&nbsp;<span class="op" id="4408749">:=</span>&nbsp;<span class="builtintype" id="4408752">uint32</span><span class="op" id="4408758">(</span><span class="ident" id="4408759">data</span><span class="op" id="4408763">[</span><span class="num" id="4408764">4</span><span class="op" id="4408765">]</span><span class="op" id="4408766">)</span><span class="op" id="4408767">&lt;&lt;</span><span class="num" id="4408769">16</span>&nbsp;<span class="op" id="4408772">|</span>&nbsp;<span class="builtintype" id="4408774">uint32</span><span class="op" id="4408780">(</span><span class="ident" id="4408781">data</span><span class="op" id="4408785">[</span><span class="num" id="4408786">5</span><span class="op" id="4408787">]</span><span class="op" id="4408788">)</span><span class="op" id="4408789">&lt;&lt;</span><span class="num" id="4408791">8</span>&nbsp;<span class="op" id="4408793">|</span>&nbsp;<span class="builtintype" id="4408795">uint32</span><span class="op" id="4408801">(</span><span class="ident" id="4408802">data</span><span class="op" id="4408806">[</span><span class="num" id="4408807">6</span><span class="op" id="4408808">]</span><span class="op" id="4408809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408812">if</span>&nbsp;<span class="builtintype" id="4408815">uint32</span><span class="op" id="4408821">(</span><span class="builtinfunc" id="4408822">len</span><span class="op" id="4408825">(</span><span class="ident" id="4408826">data</span><span class="op" id="4408830">)</span><span class="op" id="4408831">)</span>&nbsp;<span class="op" id="4408833">!=</span>&nbsp;<span class="ident" id="4408836">certsLen</span><span class="op" id="4408844">+</span><span class="num" id="4408845">7</span>&nbsp;<span class="op" id="4408847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408851">return</span>&nbsp;<span class="builtintype" id="4408858">false</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4408865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408869">numCerts</span>&nbsp;<span class="op" id="4408878">:=</span>&nbsp;<span class="num" id="4408881">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408884">d</span>&nbsp;<span class="op" id="4408886">:=</span>&nbsp;<span class="ident" id="4408889">data</span><span class="op" id="4408893">[</span><span class="num" id="4408894">7</span><span class="op" id="4408895">:</span><span class="op" id="4408896">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408899">for</span>&nbsp;<span class="ident" id="4408903">certsLen</span>&nbsp;<span class="op" id="4408912">&gt;</span>&nbsp;<span class="num" id="4408914">0</span>&nbsp;<span class="op" id="4408916">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408920">if</span>&nbsp;<span class="builtinfunc" id="4408923">len</span><span class="op" id="4408926">(</span><span class="ident" id="4408927">d</span><span class="op" id="4408928">)</span>&nbsp;<span class="op" id="4408930">&lt;</span>&nbsp;<span class="num" id="4408932">4</span>&nbsp;<span class="op" id="4408934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4408939">return</span>&nbsp;<span class="builtintype" id="4408946">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4408954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4408958">certLen</span>&nbsp;<span class="op" id="4408966">:=</span>&nbsp;<span class="builtintype" id="4408969">uint32</span><span class="op" id="4408975">(</span><span class="ident" id="4408976">d</span><span class="op" id="4408977">[</span><span class="num" id="4408978">0</span><span class="op" id="4408979">]</span><span class="op" id="4408980">)</span><span class="op" id="4408981">&lt;&lt;</span><span class="num" id="4408983">16</span>&nbsp;<span class="op" id="4408986">|</span>&nbsp;<span class="builtintype" id="4408988">uint32</span><span class="op" id="4408994">(</span><span class="ident" id="4408995">d</span><span class="op" id="4408996">[</span><span class="num" id="4408997">1</span><span class="op" id="4408998">]</span><span class="op" id="4408999">)</span><span class="op" id="4409000">&lt;&lt;</span><span class="num" id="4409002">8</span>&nbsp;<span class="op" id="4409004">|</span>&nbsp;<span class="builtintype" id="4409006">uint32</span><span class="op" id="4409012">(</span><span class="ident" id="4409013">d</span><span class="op" id="4409014">[</span><span class="num" id="4409015">2</span><span class="op" id="4409016">]</span><span class="op" id="4409017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409021">if</span>&nbsp;<span class="builtintype" id="4409024">uint32</span><span class="op" id="4409030">(</span><span class="builtinfunc" id="4409031">len</span><span class="op" id="4409034">(</span><span class="ident" id="4409035">d</span><span class="op" id="4409036">)</span><span class="op" id="4409037">)</span>&nbsp;<span class="op" id="4409039">&lt;</span>&nbsp;<span class="num" id="4409041">3</span><span class="op" id="4409042">+</span><span class="ident" id="4409043">certLen</span>&nbsp;<span class="op" id="4409051">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409056">return</span>&nbsp;<span class="builtintype" id="4409063">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4409071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409075">d</span>&nbsp;<span class="op" id="4409077">=</span>&nbsp;<span class="ident" id="4409079">d</span><span class="op" id="4409080">[</span><span class="num" id="4409081">3</span><span class="op" id="4409082">+</span><span class="ident" id="4409083">certLen</span><span class="op" id="4409090">:</span><span class="op" id="4409091">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409095">certsLen</span>&nbsp;<span class="op" id="4409104">-=</span>&nbsp;<span class="num" id="4409107">3</span>&nbsp;<span class="op" id="4409109">+</span>&nbsp;<span class="ident" id="4409111">certLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409121">numCerts</span><span class="op" id="4409129">++</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4409133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409137">m</span><span class="op" id="4409138">.</span><span class="ident" id="4409139">certificates</span>&nbsp;<span class="op" id="4409152">=</span>&nbsp;<span class="builtinfunc" id="4409154">make</span><span class="op" id="4409158">(</span><span class="op" id="4409159">[</span><span class="op" id="4409160">]</span><span class="op" id="4409161">[</span><span class="op" id="4409162">]</span><span class="builtintype" id="4409163">byte</span><span class="op" id="4409167">,</span>&nbsp;<span class="ident" id="4409169">numCerts</span><span class="op" id="4409177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409180">d</span>&nbsp;<span class="op" id="4409182">=</span>&nbsp;<span class="ident" id="4409184">data</span><span class="op" id="4409188">[</span><span class="num" id="4409189">7</span><span class="op" id="4409190">:</span><span class="op" id="4409191">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409194">for</span>&nbsp;<span class="ident" id="4409198">i</span>&nbsp;<span class="op" id="4409200">:=</span>&nbsp;<span class="num" id="4409203">0</span><span class="op" id="4409204">;</span>&nbsp;<span class="ident" id="4409206">i</span>&nbsp;<span class="op" id="4409208">&lt;</span>&nbsp;<span class="ident" id="4409210">numCerts</span><span class="op" id="4409218">;</span>&nbsp;<span class="ident" id="4409220">i</span><span class="op" id="4409221">++</span>&nbsp;<span class="op" id="4409224">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409228">certLen</span>&nbsp;<span class="op" id="4409236">:=</span>&nbsp;<span class="builtintype" id="4409239">uint32</span><span class="op" id="4409245">(</span><span class="ident" id="4409246">d</span><span class="op" id="4409247">[</span><span class="num" id="4409248">0</span><span class="op" id="4409249">]</span><span class="op" id="4409250">)</span><span class="op" id="4409251">&lt;&lt;</span><span class="num" id="4409253">16</span>&nbsp;<span class="op" id="4409256">|</span>&nbsp;<span class="builtintype" id="4409258">uint32</span><span class="op" id="4409264">(</span><span class="ident" id="4409265">d</span><span class="op" id="4409266">[</span><span class="num" id="4409267">1</span><span class="op" id="4409268">]</span><span class="op" id="4409269">)</span><span class="op" id="4409270">&lt;&lt;</span><span class="num" id="4409272">8</span>&nbsp;<span class="op" id="4409274">|</span>&nbsp;<span class="builtintype" id="4409276">uint32</span><span class="op" id="4409282">(</span><span class="ident" id="4409283">d</span><span class="op" id="4409284">[</span><span class="num" id="4409285">2</span><span class="op" id="4409286">]</span><span class="op" id="4409287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409291">m</span><span class="op" id="4409292">.</span><span class="ident" id="4409293">certificates</span><span class="op" id="4409305">[</span><span class="ident" id="4409306">i</span><span class="op" id="4409307">]</span>&nbsp;<span class="op" id="4409309">=</span>&nbsp;<span class="ident" id="4409311">d</span><span class="op" id="4409312">[</span><span class="num" id="4409313">3</span>&nbsp;<span class="op" id="4409315">:</span>&nbsp;<span class="num" id="4409317">3</span><span class="op" id="4409318">+</span><span class="ident" id="4409319">certLen</span><span class="op" id="4409326">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409330">d</span>&nbsp;<span class="op" id="4409332">=</span>&nbsp;<span class="ident" id="4409334">d</span><span class="op" id="4409335">[</span><span class="num" id="4409336">3</span><span class="op" id="4409337">+</span><span class="ident" id="4409338">certLen</span><span class="op" id="4409345">:</span><span class="op" id="4409346">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4409349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409353">return</span>&nbsp;<span class="builtintype" id="4409360">true</span><br>
<span class="lineno"></span><span class="op" id="4409365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4409368">type</span>&nbsp;<span class="ident" id="4409373">serverKeyExchangeMsg</span>&nbsp;<span class="keyword" id="4409394">struct</span>&nbsp;<span class="op" id="4409401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409404">raw</span>&nbsp;<span class="op" id="4409408">[</span><span class="op" id="4409409">]</span><span class="builtintype" id="4409410">byte</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409416">key</span>&nbsp;<span class="op" id="4409420">[</span><span class="op" id="4409421">]</span><span class="builtintype" id="4409422">byte</span><br>
<span class="lineno"></span><span class="op" id="4409427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4409430">func</span>&nbsp;<span class="op" id="4409435">(</span><span class="ident" id="4409436">m</span>&nbsp;<span class="op" id="4409438">*</span><span class="ident" id="4409439">serverKeyExchangeMsg</span><span class="op" id="4409459">)</span>&nbsp;<span class="ident" id="4409461">equal</span><span class="op" id="4409466">(</span><span class="ident" id="4409467">i</span>&nbsp;<span class="keyword" id="4409469">interface</span><span class="op" id="4409478">{</span><span class="op" id="4409479">}</span><span class="op" id="4409480">)</span>&nbsp;<span class="builtintype" id="4409482">bool</span>&nbsp;<span class="op" id="4409487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409490">m1</span><span class="op" id="4409492">,</span>&nbsp;<span class="ident" id="4409494">ok</span>&nbsp;<span class="op" id="4409497">:=</span>&nbsp;<span class="ident" id="4409500">i</span><span class="op" id="4409501">.</span><span class="op" id="4409502">(</span><span class="op" id="4409503">*</span><span class="ident" id="4409504">serverKeyExchangeMsg</span><span class="op" id="4409524">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409527">if</span>&nbsp;<span class="op" id="4409530">!</span><span class="ident" id="4409531">ok</span>&nbsp;<span class="op" id="4409534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409538">return</span>&nbsp;<span class="builtintype" id="4409545">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4409552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409556">return</span>&nbsp;<span class="ident" id="4409563">bytes</span><span class="op" id="4409568">.</span><span class="ident" id="4409569">Equal</span><span class="op" id="4409574">(</span><span class="ident" id="4409575">m</span><span class="op" id="4409576">.</span><span class="ident" id="4409577">raw</span><span class="op" id="4409580">,</span>&nbsp;<span class="ident" id="4409582">m1</span><span class="op" id="4409584">.</span><span class="ident" id="4409585">raw</span><span class="op" id="4409588">)</span>&nbsp;<span class="op" id="4409590">&amp;&amp;</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409595">bytes</span><span class="op" id="4409600">.</span><span class="ident" id="4409601">Equal</span><span class="op" id="4409606">(</span><span class="ident" id="4409607">m</span><span class="op" id="4409608">.</span><span class="ident" id="4409609">key</span><span class="op" id="4409612">,</span>&nbsp;<span class="ident" id="4409614">m1</span><span class="op" id="4409616">.</span><span class="ident" id="4409617">key</span><span class="op" id="4409620">)</span><br>
<span class="lineno"></span><span class="op" id="4409622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4409625">func</span>&nbsp;<span class="op" id="4409630">(</span><span class="ident" id="4409631">m</span>&nbsp;<span class="op" id="4409633">*</span><span class="ident" id="4409634">serverKeyExchangeMsg</span><span class="op" id="4409654">)</span>&nbsp;<span class="ident" id="4409656">marshal</span><span class="op" id="4409663">(</span><span class="op" id="4409664">)</span>&nbsp;<span class="op" id="4409666">[</span><span class="op" id="4409667">]</span><span class="builtintype" id="4409668">byte</span>&nbsp;<span class="op" id="4409673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409676">if</span>&nbsp;<span class="ident" id="4409679">m</span><span class="op" id="4409680">.</span><span class="ident" id="4409681">raw</span>&nbsp;<span class="op" id="4409685">!=</span>&nbsp;<span class="builtintype" id="4409688">nil</span>&nbsp;<span class="op" id="4409692">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409696">return</span>&nbsp;<span class="ident" id="4409703">m</span><span class="op" id="4409704">.</span><span class="ident" id="4409705">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4409710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409713">length</span>&nbsp;<span class="op" id="4409720">:=</span>&nbsp;<span class="builtinfunc" id="4409723">len</span><span class="op" id="4409726">(</span><span class="ident" id="4409727">m</span><span class="op" id="4409728">.</span><span class="ident" id="4409729">key</span><span class="op" id="4409732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409735">x</span>&nbsp;<span class="op" id="4409737">:=</span>&nbsp;<span class="builtinfunc" id="4409740">make</span><span class="op" id="4409744">(</span><span class="op" id="4409745">[</span><span class="op" id="4409746">]</span><span class="builtintype" id="4409747">byte</span><span class="op" id="4409751">,</span>&nbsp;<span class="ident" id="4409753">length</span><span class="op" id="4409759">+</span><span class="num" id="4409760">4</span><span class="op" id="4409761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409764">x</span><span class="op" id="4409765">[</span><span class="num" id="4409766">0</span><span class="op" id="4409767">]</span>&nbsp;<span class="op" id="4409769">=</span>&nbsp;<span class="ident" id="4409771">typeServerKeyExchange</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409794">x</span><span class="op" id="4409795">[</span><span class="num" id="4409796">1</span><span class="op" id="4409797">]</span>&nbsp;<span class="op" id="4409799">=</span>&nbsp;<span class="builtintype" id="4409801">uint8</span><span class="op" id="4409806">(</span><span class="ident" id="4409807">length</span>&nbsp;<span class="op" id="4409814">&gt;&gt;</span>&nbsp;<span class="num" id="4409817">16</span><span class="op" id="4409819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409822">x</span><span class="op" id="4409823">[</span><span class="num" id="4409824">2</span><span class="op" id="4409825">]</span>&nbsp;<span class="op" id="4409827">=</span>&nbsp;<span class="builtintype" id="4409829">uint8</span><span class="op" id="4409834">(</span><span class="ident" id="4409835">length</span>&nbsp;<span class="op" id="4409842">&gt;&gt;</span>&nbsp;<span class="num" id="4409845">8</span><span class="op" id="4409846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409849">x</span><span class="op" id="4409850">[</span><span class="num" id="4409851">3</span><span class="op" id="4409852">]</span>&nbsp;<span class="op" id="4409854">=</span>&nbsp;<span class="builtintype" id="4409856">uint8</span><span class="op" id="4409861">(</span><span class="ident" id="4409862">length</span><span class="op" id="4409868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4409871">copy</span><span class="op" id="4409875">(</span><span class="ident" id="4409876">x</span><span class="op" id="4409877">[</span><span class="num" id="4409878">4</span><span class="op" id="4409879">:</span><span class="op" id="4409880">]</span><span class="op" id="4409881">,</span>&nbsp;<span class="ident" id="4409883">m</span><span class="op" id="4409884">.</span><span class="ident" id="4409885">key</span><span class="op" id="4409888">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409892">m</span><span class="op" id="4409893">.</span><span class="ident" id="4409894">raw</span>&nbsp;<span class="op" id="4409898">=</span>&nbsp;<span class="ident" id="4409900">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409903">return</span>&nbsp;<span class="ident" id="4409910">x</span><br>
<span class="lineno"></span><span class="op" id="4409912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4409915">func</span>&nbsp;<span class="op" id="4409920">(</span><span class="ident" id="4409921">m</span>&nbsp;<span class="op" id="4409923">*</span><span class="ident" id="4409924">serverKeyExchangeMsg</span><span class="op" id="4409944">)</span>&nbsp;<span class="ident" id="4409946">unmarshal</span><span class="op" id="4409955">(</span><span class="ident" id="4409956">data</span>&nbsp;<span class="op" id="4409961">[</span><span class="op" id="4409962">]</span><span class="builtintype" id="4409963">byte</span><span class="op" id="4409967">)</span>&nbsp;<span class="builtintype" id="4409969">bool</span>&nbsp;<span class="op" id="4409974">{</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4409977">m</span><span class="op" id="4409978">.</span><span class="ident" id="4409979">raw</span>&nbsp;<span class="op" id="4409983">=</span>&nbsp;<span class="ident" id="4409985">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4409991">if</span>&nbsp;<span class="builtinfunc" id="4409994">len</span><span class="op" id="4409997">(</span><span class="ident" id="4409998">data</span><span class="op" id="4410002">)</span>&nbsp;<span class="op" id="4410004">&lt;</span>&nbsp;<span class="num" id="4410006">4</span>&nbsp;<span class="op" id="4410008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410012">return</span>&nbsp;<span class="builtintype" id="4410019">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4410026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410029">m</span><span class="op" id="4410030">.</span><span class="ident" id="4410031">key</span>&nbsp;<span class="op" id="4410035">=</span>&nbsp;<span class="ident" id="4410037">data</span><span class="op" id="4410041">[</span><span class="num" id="4410042">4</span><span class="op" id="4410043">:</span><span class="op" id="4410044">]</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410047">return</span>&nbsp;<span class="builtintype" id="4410054">true</span><br>
<span class="lineno"></span><span class="op" id="4410059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4410062">type</span>&nbsp;<span class="ident" id="4410067">certificateStatusMsg</span>&nbsp;<span class="keyword" id="4410088">struct</span>&nbsp;<span class="op" id="4410095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410098">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4410109">[</span><span class="op" id="4410110">]</span><span class="builtintype" id="4410111">byte</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410117">statusType</span>&nbsp;<span class="builtintype" id="4410128">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410135">response</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4410146">[</span><span class="op" id="4410147">]</span><span class="builtintype" id="4410148">byte</span><br>
<span class="lineno"></span><span class="op" id="4410153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4410156">func</span>&nbsp;<span class="op" id="4410161">(</span><span class="ident" id="4410162">m</span>&nbsp;<span class="op" id="4410164">*</span><span class="ident" id="4410165">certificateStatusMsg</span><span class="op" id="4410185">)</span>&nbsp;<span class="ident" id="4410187">equal</span><span class="op" id="4410192">(</span><span class="ident" id="4410193">i</span>&nbsp;<span class="keyword" id="4410195">interface</span><span class="op" id="4410204">{</span><span class="op" id="4410205">}</span><span class="op" id="4410206">)</span>&nbsp;<span class="builtintype" id="4410208">bool</span>&nbsp;<span class="op" id="4410213">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410216">m1</span><span class="op" id="4410218">,</span>&nbsp;<span class="ident" id="4410220">ok</span>&nbsp;<span class="op" id="4410223">:=</span>&nbsp;<span class="ident" id="4410226">i</span><span class="op" id="4410227">.</span><span class="op" id="4410228">(</span><span class="op" id="4410229">*</span><span class="ident" id="4410230">certificateStatusMsg</span><span class="op" id="4410250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410253">if</span>&nbsp;<span class="op" id="4410256">!</span><span class="ident" id="4410257">ok</span>&nbsp;<span class="op" id="4410260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410264">return</span>&nbsp;<span class="builtintype" id="4410271">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4410278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410282">return</span>&nbsp;<span class="ident" id="4410289">bytes</span><span class="op" id="4410294">.</span><span class="ident" id="4410295">Equal</span><span class="op" id="4410300">(</span><span class="ident" id="4410301">m</span><span class="op" id="4410302">.</span><span class="ident" id="4410303">raw</span><span class="op" id="4410306">,</span>&nbsp;<span class="ident" id="4410308">m1</span><span class="op" id="4410310">.</span><span class="ident" id="4410311">raw</span><span class="op" id="4410314">)</span>&nbsp;<span class="op" id="4410316">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410321">m</span><span class="op" id="4410322">.</span><span class="ident" id="4410323">statusType</span>&nbsp;<span class="op" id="4410334">==</span>&nbsp;<span class="ident" id="4410337">m1</span><span class="op" id="4410339">.</span><span class="ident" id="4410340">statusType</span>&nbsp;<span class="op" id="4410351">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410356">bytes</span><span class="op" id="4410361">.</span><span class="ident" id="4410362">Equal</span><span class="op" id="4410367">(</span><span class="ident" id="4410368">m</span><span class="op" id="4410369">.</span><span class="ident" id="4410370">response</span><span class="op" id="4410378">,</span>&nbsp;<span class="ident" id="4410380">m1</span><span class="op" id="4410382">.</span><span class="ident" id="4410383">response</span><span class="op" id="4410391">)</span><br>
<span class="lineno"></span><span class="op" id="4410393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="4410396">func</span>&nbsp;<span class="op" id="4410401">(</span><span class="ident" id="4410402">m</span>&nbsp;<span class="op" id="4410404">*</span><span class="ident" id="4410405">certificateStatusMsg</span><span class="op" id="4410425">)</span>&nbsp;<span class="ident" id="4410427">marshal</span><span class="op" id="4410434">(</span><span class="op" id="4410435">)</span>&nbsp;<span class="op" id="4410437">[</span><span class="op" id="4410438">]</span><span class="builtintype" id="4410439">byte</span>&nbsp;<span class="op" id="4410444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410447">if</span>&nbsp;<span class="ident" id="4410450">m</span><span class="op" id="4410451">.</span><span class="ident" id="4410452">raw</span>&nbsp;<span class="op" id="4410456">!=</span>&nbsp;<span class="builtintype" id="4410459">nil</span>&nbsp;<span class="op" id="4410463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410467">return</span>&nbsp;<span class="ident" id="4410474">m</span><span class="op" id="4410475">.</span><span class="ident" id="4410476">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4410481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410485">var</span>&nbsp;<span class="ident" id="4410489">x</span>&nbsp;<span class="op" id="4410491">[</span><span class="op" id="4410492">]</span><span class="builtintype" id="4410493">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410499">if</span>&nbsp;<span class="ident" id="4410502">m</span><span class="op" id="4410503">.</span><span class="ident" id="4410504">statusType</span>&nbsp;<span class="op" id="4410515">==</span>&nbsp;<span class="ident" id="4410518">statusTypeOCSP</span>&nbsp;<span class="op" id="4410533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410537">x</span>&nbsp;<span class="op" id="4410539">=</span>&nbsp;<span class="builtinfunc" id="4410541">make</span><span class="op" id="4410545">(</span><span class="op" id="4410546">[</span><span class="op" id="4410547">]</span><span class="builtintype" id="4410548">byte</span><span class="op" id="4410552">,</span>&nbsp;<span class="num" id="4410554">4</span><span class="op" id="4410555">+</span><span class="num" id="4410556">4</span><span class="op" id="4410557">+</span><span class="builtinfunc" id="4410558">len</span><span class="op" id="4410561">(</span><span class="ident" id="4410562">m</span><span class="op" id="4410563">.</span><span class="ident" id="4410564">response</span><span class="op" id="4410572">)</span><span class="op" id="4410573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410577">x</span><span class="op" id="4410578">[</span><span class="num" id="4410579">0</span><span class="op" id="4410580">]</span>&nbsp;<span class="op" id="4410582">=</span>&nbsp;<span class="ident" id="4410584">typeCertificateStatus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410608">l</span>&nbsp;<span class="op" id="4410610">:=</span>&nbsp;<span class="builtinfunc" id="4410613">len</span><span class="op" id="4410616">(</span><span class="ident" id="4410617">m</span><span class="op" id="4410618">.</span><span class="ident" id="4410619">response</span><span class="op" id="4410627">)</span>&nbsp;<span class="op" id="4410629">+</span>&nbsp;<span class="num" id="4410631">4</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410635">x</span><span class="op" id="4410636">[</span><span class="num" id="4410637">1</span><span class="op" id="4410638">]</span>&nbsp;<span class="op" id="4410640">=</span>&nbsp;<span class="builtintype" id="4410642">byte</span><span class="op" id="4410646">(</span><span class="ident" id="4410647">l</span>&nbsp;<span class="op" id="4410649">&gt;&gt;</span>&nbsp;<span class="num" id="4410652">16</span><span class="op" id="4410654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410658">x</span><span class="op" id="4410659">[</span><span class="num" id="4410660">2</span><span class="op" id="4410661">]</span>&nbsp;<span class="op" id="4410663">=</span>&nbsp;<span class="builtintype" id="4410665">byte</span><span class="op" id="4410669">(</span><span class="ident" id="4410670">l</span>&nbsp;<span class="op" id="4410672">&gt;&gt;</span>&nbsp;<span class="num" id="4410675">8</span><span class="op" id="4410676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410680">x</span><span class="op" id="4410681">[</span><span class="num" id="4410682">3</span><span class="op" id="4410683">]</span>&nbsp;<span class="op" id="4410685">=</span>&nbsp;<span class="builtintype" id="4410687">byte</span><span class="op" id="4410691">(</span><span class="ident" id="4410692">l</span><span class="op" id="4410693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410697">x</span><span class="op" id="4410698">[</span><span class="num" id="4410699">4</span><span class="op" id="4410700">]</span>&nbsp;<span class="op" id="4410702">=</span>&nbsp;<span class="ident" id="4410704">statusTypeOCSP</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410722">l</span>&nbsp;<span class="op" id="4410724">-=</span>&nbsp;<span class="num" id="4410727">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410731">x</span><span class="op" id="4410732">[</span><span class="num" id="4410733">5</span><span class="op" id="4410734">]</span>&nbsp;<span class="op" id="4410736">=</span>&nbsp;<span class="builtintype" id="4410738">byte</span><span class="op" id="4410742">(</span><span class="ident" id="4410743">l</span>&nbsp;<span class="op" id="4410745">&gt;&gt;</span>&nbsp;<span class="num" id="4410748">16</span><span class="op" id="4410750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410754">x</span><span class="op" id="4410755">[</span><span class="num" id="4410756">6</span><span class="op" id="4410757">]</span>&nbsp;<span class="op" id="4410759">=</span>&nbsp;<span class="builtintype" id="4410761">byte</span><span class="op" id="4410765">(</span><span class="ident" id="4410766">l</span>&nbsp;<span class="op" id="4410768">&gt;&gt;</span>&nbsp;<span class="num" id="4410771">8</span><span class="op" id="4410772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410776">x</span><span class="op" id="4410777">[</span><span class="num" id="4410778">7</span><span class="op" id="4410779">]</span>&nbsp;<span class="op" id="4410781">=</span>&nbsp;<span class="builtintype" id="4410783">byte</span><span class="op" id="4410787">(</span><span class="ident" id="4410788">l</span><span class="op" id="4410789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4410793">copy</span><span class="op" id="4410797">(</span><span class="ident" id="4410798">x</span><span class="op" id="4410799">[</span><span class="num" id="4410800">8</span><span class="op" id="4410801">:</span><span class="op" id="4410802">]</span><span class="op" id="4410803">,</span>&nbsp;<span class="ident" id="4410805">m</span><span class="op" id="4410806">.</span><span class="ident" id="4410807">response</span><span class="op" id="4410815">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4410818">}</span>&nbsp;<span class="keyword" id="4410820">else</span>&nbsp;<span class="op" id="4410825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410829">x</span>&nbsp;<span class="op" id="4410831">=</span>&nbsp;<span class="op" id="4410833">[</span><span class="op" id="4410834">]</span><span class="builtintype" id="4410835">byte</span><span class="op" id="4410839">{</span><span class="ident" id="4410840">typeCertificateStatus</span><span class="op" id="4410861">,</span>&nbsp;<span class="num" id="4410863">0</span><span class="op" id="4410864">,</span>&nbsp;<span class="num" id="4410866">0</span><span class="op" id="4410867">,</span>&nbsp;<span class="num" id="4410869">1</span><span class="op" id="4410870">,</span>&nbsp;<span class="ident" id="4410872">m</span><span class="op" id="4410873">.</span><span class="ident" id="4410874">statusType</span><span class="op" id="4410884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4410887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410891">m</span><span class="op" id="4410892">.</span><span class="ident" id="4410893">raw</span>&nbsp;<span class="op" id="4410897">=</span>&nbsp;<span class="ident" id="4410899">x</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410902">return</span>&nbsp;<span class="ident" id="4410909">x</span><br>
<span class="lineno"></span><span class="op" id="4410911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4410914">func</span>&nbsp;<span class="op" id="4410919">(</span><span class="ident" id="4410920">m</span>&nbsp;<span class="op" id="4410922">*</span><span class="ident" id="4410923">certificateStatusMsg</span><span class="op" id="4410943">)</span>&nbsp;<span class="ident" id="4410945">unmarshal</span><span class="op" id="4410954">(</span><span class="ident" id="4410955">data</span>&nbsp;<span class="op" id="4410960">[</span><span class="op" id="4410961">]</span><span class="builtintype" id="4410962">byte</span><span class="op" id="4410966">)</span>&nbsp;<span class="builtintype" id="4410968">bool</span>&nbsp;<span class="op" id="4410973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4410976">m</span><span class="op" id="4410977">.</span><span class="ident" id="4410978">raw</span>&nbsp;<span class="op" id="4410982">=</span>&nbsp;<span class="ident" id="4410984">data</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4410990">if</span>&nbsp;<span class="builtinfunc" id="4410993">len</span><span class="op" id="4410996">(</span><span class="ident" id="4410997">data</span><span class="op" id="4411001">)</span>&nbsp;<span class="op" id="4411003">&lt;</span>&nbsp;<span class="num" id="4411005">5</span>&nbsp;<span class="op" id="4411007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411011">return</span>&nbsp;<span class="builtintype" id="4411018">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4411025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411028">m</span><span class="op" id="4411029">.</span><span class="ident" id="4411030">statusType</span>&nbsp;<span class="op" id="4411041">=</span>&nbsp;<span class="ident" id="4411043">data</span><span class="op" id="4411047">[</span><span class="num" id="4411048">4</span><span class="op" id="4411049">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411053">m</span><span class="op" id="4411054">.</span><span class="ident" id="4411055">response</span>&nbsp;<span class="op" id="4411064">=</span>&nbsp;<span class="builtintype" id="4411066">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411071">if</span>&nbsp;<span class="ident" id="4411074">m</span><span class="op" id="4411075">.</span><span class="ident" id="4411076">statusType</span>&nbsp;<span class="op" id="4411087">==</span>&nbsp;<span class="ident" id="4411090">statusTypeOCSP</span>&nbsp;<span class="op" id="4411105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411109">if</span>&nbsp;<span class="builtinfunc" id="4411112">len</span><span class="op" id="4411115">(</span><span class="ident" id="4411116">data</span><span class="op" id="4411120">)</span>&nbsp;<span class="op" id="4411122">&lt;</span>&nbsp;<span class="num" id="4411124">8</span>&nbsp;<span class="op" id="4411126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411131">return</span>&nbsp;<span class="builtintype" id="4411138">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4411146">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411150">respLen</span>&nbsp;<span class="op" id="4411158">:=</span>&nbsp;<span class="builtintype" id="4411161">uint32</span><span class="op" id="4411167">(</span><span class="ident" id="4411168">data</span><span class="op" id="4411172">[</span><span class="num" id="4411173">5</span><span class="op" id="4411174">]</span><span class="op" id="4411175">)</span><span class="op" id="4411176">&lt;&lt;</span><span class="num" id="4411178">16</span>&nbsp;<span class="op" id="4411181">|</span>&nbsp;<span class="builtintype" id="4411183">uint32</span><span class="op" id="4411189">(</span><span class="ident" id="4411190">data</span><span class="op" id="4411194">[</span><span class="num" id="4411195">6</span><span class="op" id="4411196">]</span><span class="op" id="4411197">)</span><span class="op" id="4411198">&lt;&lt;</span><span class="num" id="4411200">8</span>&nbsp;<span class="op" id="4411202">|</span>&nbsp;<span class="builtintype" id="4411204">uint32</span><span class="op" id="4411210">(</span><span class="ident" id="4411211">data</span><span class="op" id="4411215">[</span><span class="num" id="4411216">7</span><span class="op" id="4411217">]</span><span class="op" id="4411218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411222">if</span>&nbsp;<span class="builtintype" id="4411225">uint32</span><span class="op" id="4411231">(</span><span class="builtinfunc" id="4411232">len</span><span class="op" id="4411235">(</span><span class="ident" id="4411236">data</span><span class="op" id="4411240">)</span><span class="op" id="4411241">)</span>&nbsp;<span class="op" id="4411243">!=</span>&nbsp;<span class="num" id="4411246">4</span><span class="op" id="4411247">+</span><span class="num" id="4411248">4</span><span class="op" id="4411249">+</span><span class="ident" id="4411250">respLen</span>&nbsp;<span class="op" id="4411258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411263">return</span>&nbsp;<span class="builtintype" id="4411270">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4411278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411282">m</span><span class="op" id="4411283">.</span><span class="ident" id="4411284">response</span>&nbsp;<span class="op" id="4411293">=</span>&nbsp;<span class="ident" id="4411295">data</span><span class="op" id="4411299">[</span><span class="num" id="4411300">8</span><span class="op" id="4411301">:</span><span class="op" id="4411302">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4411305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411308">return</span>&nbsp;<span class="builtintype" id="4411315">true</span><br>
<span class="lineno"></span><span class="op" id="4411320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4411323">type</span>&nbsp;<span class="ident" id="4411328">serverHelloDoneMsg</span>&nbsp;<span class="keyword" id="4411347">struct</span><span class="op" id="4411353">{</span><span class="op" id="4411354">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="keyword" id="4411357">func</span>&nbsp;<span class="op" id="4411362">(</span><span class="ident" id="4411363">m</span>&nbsp;<span class="op" id="4411365">*</span><span class="ident" id="4411366">serverHelloDoneMsg</span><span class="op" id="4411384">)</span>&nbsp;<span class="ident" id="4411386">equal</span><span class="op" id="4411391">(</span><span class="ident" id="4411392">i</span>&nbsp;<span class="keyword" id="4411394">interface</span><span class="op" id="4411403">{</span><span class="op" id="4411404">}</span><span class="op" id="4411405">)</span>&nbsp;<span class="builtintype" id="4411407">bool</span>&nbsp;<span class="op" id="4411412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411415">_</span><span class="op" id="4411416">,</span>&nbsp;<span class="ident" id="4411418">ok</span>&nbsp;<span class="op" id="4411421">:=</span>&nbsp;<span class="ident" id="4411424">i</span><span class="op" id="4411425">.</span><span class="op" id="4411426">(</span><span class="op" id="4411427">*</span><span class="ident" id="4411428">serverHelloDoneMsg</span><span class="op" id="4411446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411449">return</span>&nbsp;<span class="ident" id="4411456">ok</span><br>
<span class="lineno"></span><span class="op" id="4411459">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="keyword" id="4411462">func</span>&nbsp;<span class="op" id="4411467">(</span><span class="ident" id="4411468">m</span>&nbsp;<span class="op" id="4411470">*</span><span class="ident" id="4411471">serverHelloDoneMsg</span><span class="op" id="4411489">)</span>&nbsp;<span class="ident" id="4411491">marshal</span><span class="op" id="4411498">(</span><span class="op" id="4411499">)</span>&nbsp;<span class="op" id="4411501">[</span><span class="op" id="4411502">]</span><span class="builtintype" id="4411503">byte</span>&nbsp;<span class="op" id="4411508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411511">x</span>&nbsp;<span class="op" id="4411513">:=</span>&nbsp;<span class="builtinfunc" id="4411516">make</span><span class="op" id="4411520">(</span><span class="op" id="4411521">[</span><span class="op" id="4411522">]</span><span class="builtintype" id="4411523">byte</span><span class="op" id="4411527">,</span>&nbsp;<span class="num" id="4411529">4</span><span class="op" id="4411530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411533">x</span><span class="op" id="4411534">[</span><span class="num" id="4411535">0</span><span class="op" id="4411536">]</span>&nbsp;<span class="op" id="4411538">=</span>&nbsp;<span class="ident" id="4411540">typeServerHelloDone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411561">return</span>&nbsp;<span class="ident" id="4411568">x</span><br>
<span class="lineno">920</span><span class="op" id="4411570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4411573">func</span>&nbsp;<span class="op" id="4411578">(</span><span class="ident" id="4411579">m</span>&nbsp;<span class="op" id="4411581">*</span><span class="ident" id="4411582">serverHelloDoneMsg</span><span class="op" id="4411600">)</span>&nbsp;<span class="ident" id="4411602">unmarshal</span><span class="op" id="4411611">(</span><span class="ident" id="4411612">data</span>&nbsp;<span class="op" id="4411617">[</span><span class="op" id="4411618">]</span><span class="builtintype" id="4411619">byte</span><span class="op" id="4411623">)</span>&nbsp;<span class="builtintype" id="4411625">bool</span>&nbsp;<span class="op" id="4411630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411633">return</span>&nbsp;<span class="builtinfunc" id="4411640">len</span><span class="op" id="4411643">(</span><span class="ident" id="4411644">data</span><span class="op" id="4411648">)</span>&nbsp;<span class="op" id="4411650">==</span>&nbsp;<span class="num" id="4411653">4</span><br>
<span class="lineno"></span><span class="op" id="4411655">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="4411658">type</span>&nbsp;<span class="ident" id="4411663">clientKeyExchangeMsg</span>&nbsp;<span class="keyword" id="4411684">struct</span>&nbsp;<span class="op" id="4411691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411694">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4411705">[</span><span class="op" id="4411706">]</span><span class="builtintype" id="4411707">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411713">ciphertext</span>&nbsp;<span class="op" id="4411724">[</span><span class="op" id="4411725">]</span><span class="builtintype" id="4411726">byte</span><br>
<span class="lineno"></span><span class="op" id="4411731">}</span><br>
<span class="lineno">930</span><br>
<span class="lineno"></span><span class="keyword" id="4411734">func</span>&nbsp;<span class="op" id="4411739">(</span><span class="ident" id="4411740">m</span>&nbsp;<span class="op" id="4411742">*</span><span class="ident" id="4411743">clientKeyExchangeMsg</span><span class="op" id="4411763">)</span>&nbsp;<span class="ident" id="4411765">equal</span><span class="op" id="4411770">(</span><span class="ident" id="4411771">i</span>&nbsp;<span class="keyword" id="4411773">interface</span><span class="op" id="4411782">{</span><span class="op" id="4411783">}</span><span class="op" id="4411784">)</span>&nbsp;<span class="builtintype" id="4411786">bool</span>&nbsp;<span class="op" id="4411791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411794">m1</span><span class="op" id="4411796">,</span>&nbsp;<span class="ident" id="4411798">ok</span>&nbsp;<span class="op" id="4411801">:=</span>&nbsp;<span class="ident" id="4411804">i</span><span class="op" id="4411805">.</span><span class="op" id="4411806">(</span><span class="op" id="4411807">*</span><span class="ident" id="4411808">clientKeyExchangeMsg</span><span class="op" id="4411828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411831">if</span>&nbsp;<span class="op" id="4411834">!</span><span class="ident" id="4411835">ok</span>&nbsp;<span class="op" id="4411838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411842">return</span>&nbsp;<span class="builtintype" id="4411849">false</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4411856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411860">return</span>&nbsp;<span class="ident" id="4411867">bytes</span><span class="op" id="4411872">.</span><span class="ident" id="4411873">Equal</span><span class="op" id="4411878">(</span><span class="ident" id="4411879">m</span><span class="op" id="4411880">.</span><span class="ident" id="4411881">raw</span><span class="op" id="4411884">,</span>&nbsp;<span class="ident" id="4411886">m1</span><span class="op" id="4411888">.</span><span class="ident" id="4411889">raw</span><span class="op" id="4411892">)</span>&nbsp;<span class="op" id="4411894">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4411899">bytes</span><span class="op" id="4411904">.</span><span class="ident" id="4411905">Equal</span><span class="op" id="4411910">(</span><span class="ident" id="4411911">m</span><span class="op" id="4411912">.</span><span class="ident" id="4411913">ciphertext</span><span class="op" id="4411923">,</span>&nbsp;<span class="ident" id="4411925">m1</span><span class="op" id="4411927">.</span><span class="ident" id="4411928">ciphertext</span><span class="op" id="4411938">)</span><br>
<span class="lineno"></span><span class="op" id="4411940">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="keyword" id="4411943">func</span>&nbsp;<span class="op" id="4411948">(</span><span class="ident" id="4411949">m</span>&nbsp;<span class="op" id="4411951">*</span><span class="ident" id="4411952">clientKeyExchangeMsg</span><span class="op" id="4411972">)</span>&nbsp;<span class="ident" id="4411974">marshal</span><span class="op" id="4411981">(</span><span class="op" id="4411982">)</span>&nbsp;<span class="op" id="4411984">[</span><span class="op" id="4411985">]</span><span class="builtintype" id="4411986">byte</span>&nbsp;<span class="op" id="4411991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4411994">if</span>&nbsp;<span class="ident" id="4411997">m</span><span class="op" id="4411998">.</span><span class="ident" id="4411999">raw</span>&nbsp;<span class="op" id="4412003">!=</span>&nbsp;<span class="builtintype" id="4412006">nil</span>&nbsp;<span class="op" id="4412010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412014">return</span>&nbsp;<span class="ident" id="4412021">m</span><span class="op" id="4412022">.</span><span class="ident" id="4412023">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412028">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412031">length</span>&nbsp;<span class="op" id="4412038">:=</span>&nbsp;<span class="builtinfunc" id="4412041">len</span><span class="op" id="4412044">(</span><span class="ident" id="4412045">m</span><span class="op" id="4412046">.</span><span class="ident" id="4412047">ciphertext</span><span class="op" id="4412057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412060">x</span>&nbsp;<span class="op" id="4412062">:=</span>&nbsp;<span class="builtinfunc" id="4412065">make</span><span class="op" id="4412069">(</span><span class="op" id="4412070">[</span><span class="op" id="4412071">]</span><span class="builtintype" id="4412072">byte</span><span class="op" id="4412076">,</span>&nbsp;<span class="ident" id="4412078">length</span><span class="op" id="4412084">+</span><span class="num" id="4412085">4</span><span class="op" id="4412086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412089">x</span><span class="op" id="4412090">[</span><span class="num" id="4412091">0</span><span class="op" id="4412092">]</span>&nbsp;<span class="op" id="4412094">=</span>&nbsp;<span class="ident" id="4412096">typeClientKeyExchange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412119">x</span><span class="op" id="4412120">[</span><span class="num" id="4412121">1</span><span class="op" id="4412122">]</span>&nbsp;<span class="op" id="4412124">=</span>&nbsp;<span class="builtintype" id="4412126">uint8</span><span class="op" id="4412131">(</span><span class="ident" id="4412132">length</span>&nbsp;<span class="op" id="4412139">&gt;&gt;</span>&nbsp;<span class="num" id="4412142">16</span><span class="op" id="4412144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412147">x</span><span class="op" id="4412148">[</span><span class="num" id="4412149">2</span><span class="op" id="4412150">]</span>&nbsp;<span class="op" id="4412152">=</span>&nbsp;<span class="builtintype" id="4412154">uint8</span><span class="op" id="4412159">(</span><span class="ident" id="4412160">length</span>&nbsp;<span class="op" id="4412167">&gt;&gt;</span>&nbsp;<span class="num" id="4412170">8</span><span class="op" id="4412171">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412174">x</span><span class="op" id="4412175">[</span><span class="num" id="4412176">3</span><span class="op" id="4412177">]</span>&nbsp;<span class="op" id="4412179">=</span>&nbsp;<span class="builtintype" id="4412181">uint8</span><span class="op" id="4412186">(</span><span class="ident" id="4412187">length</span><span class="op" id="4412193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4412196">copy</span><span class="op" id="4412200">(</span><span class="ident" id="4412201">x</span><span class="op" id="4412202">[</span><span class="num" id="4412203">4</span><span class="op" id="4412204">:</span><span class="op" id="4412205">]</span><span class="op" id="4412206">,</span>&nbsp;<span class="ident" id="4412208">m</span><span class="op" id="4412209">.</span><span class="ident" id="4412210">ciphertext</span><span class="op" id="4412220">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412224">m</span><span class="op" id="4412225">.</span><span class="ident" id="4412226">raw</span>&nbsp;<span class="op" id="4412230">=</span>&nbsp;<span class="ident" id="4412232">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412235">return</span>&nbsp;<span class="ident" id="4412242">x</span><br>
<span class="lineno">955</span><span class="op" id="4412244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4412247">func</span>&nbsp;<span class="op" id="4412252">(</span><span class="ident" id="4412253">m</span>&nbsp;<span class="op" id="4412255">*</span><span class="ident" id="4412256">clientKeyExchangeMsg</span><span class="op" id="4412276">)</span>&nbsp;<span class="ident" id="4412278">unmarshal</span><span class="op" id="4412287">(</span><span class="ident" id="4412288">data</span>&nbsp;<span class="op" id="4412293">[</span><span class="op" id="4412294">]</span><span class="builtintype" id="4412295">byte</span><span class="op" id="4412299">)</span>&nbsp;<span class="builtintype" id="4412301">bool</span>&nbsp;<span class="op" id="4412306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412309">m</span><span class="op" id="4412310">.</span><span class="ident" id="4412311">raw</span>&nbsp;<span class="op" id="4412315">=</span>&nbsp;<span class="ident" id="4412317">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412323">if</span>&nbsp;<span class="builtinfunc" id="4412326">len</span><span class="op" id="4412329">(</span><span class="ident" id="4412330">data</span><span class="op" id="4412334">)</span>&nbsp;<span class="op" id="4412336">&lt;</span>&nbsp;<span class="num" id="4412338">4</span>&nbsp;<span class="op" id="4412340">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412344">return</span>&nbsp;<span class="builtintype" id="4412351">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412361">l</span>&nbsp;<span class="op" id="4412363">:=</span>&nbsp;<span class="builtintype" id="4412366">int</span><span class="op" id="4412369">(</span><span class="ident" id="4412370">data</span><span class="op" id="4412374">[</span><span class="num" id="4412375">1</span><span class="op" id="4412376">]</span><span class="op" id="4412377">)</span><span class="op" id="4412378">&lt;&lt;</span><span class="num" id="4412380">16</span>&nbsp;<span class="op" id="4412383">|</span>&nbsp;<span class="builtintype" id="4412385">int</span><span class="op" id="4412388">(</span><span class="ident" id="4412389">data</span><span class="op" id="4412393">[</span><span class="num" id="4412394">2</span><span class="op" id="4412395">]</span><span class="op" id="4412396">)</span><span class="op" id="4412397">&lt;&lt;</span><span class="num" id="4412399">8</span>&nbsp;<span class="op" id="4412401">|</span>&nbsp;<span class="builtintype" id="4412403">int</span><span class="op" id="4412406">(</span><span class="ident" id="4412407">data</span><span class="op" id="4412411">[</span><span class="num" id="4412412">3</span><span class="op" id="4412413">]</span><span class="op" id="4412414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412417">if</span>&nbsp;<span class="ident" id="4412420">l</span>&nbsp;<span class="op" id="4412422">!=</span>&nbsp;<span class="builtinfunc" id="4412425">len</span><span class="op" id="4412428">(</span><span class="ident" id="4412429">data</span><span class="op" id="4412433">)</span><span class="op" id="4412434">-</span><span class="num" id="4412435">4</span>&nbsp;<span class="op" id="4412437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412441">return</span>&nbsp;<span class="builtintype" id="4412448">false</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412458">m</span><span class="op" id="4412459">.</span><span class="ident" id="4412460">ciphertext</span>&nbsp;<span class="op" id="4412471">=</span>&nbsp;<span class="ident" id="4412473">data</span><span class="op" id="4412477">[</span><span class="num" id="4412478">4</span><span class="op" id="4412479">:</span><span class="op" id="4412480">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412483">return</span>&nbsp;<span class="builtintype" id="4412490">true</span><br>
<span class="lineno"></span><span class="op" id="4412495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="keyword" id="4412498">type</span>&nbsp;<span class="ident" id="4412503">finishedMsg</span>&nbsp;<span class="keyword" id="4412515">struct</span>&nbsp;<span class="op" id="4412522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412525">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412536">[</span><span class="op" id="4412537">]</span><span class="builtintype" id="4412538">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412544">verifyData</span>&nbsp;<span class="op" id="4412555">[</span><span class="op" id="4412556">]</span><span class="builtintype" id="4412557">byte</span><br>
<span class="lineno"></span><span class="op" id="4412562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span><span class="keyword" id="4412565">func</span>&nbsp;<span class="op" id="4412570">(</span><span class="ident" id="4412571">m</span>&nbsp;<span class="op" id="4412573">*</span><span class="ident" id="4412574">finishedMsg</span><span class="op" id="4412585">)</span>&nbsp;<span class="ident" id="4412587">equal</span><span class="op" id="4412592">(</span><span class="ident" id="4412593">i</span>&nbsp;<span class="keyword" id="4412595">interface</span><span class="op" id="4412604">{</span><span class="op" id="4412605">}</span><span class="op" id="4412606">)</span>&nbsp;<span class="builtintype" id="4412608">bool</span>&nbsp;<span class="op" id="4412613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412616">m1</span><span class="op" id="4412618">,</span>&nbsp;<span class="ident" id="4412620">ok</span>&nbsp;<span class="op" id="4412623">:=</span>&nbsp;<span class="ident" id="4412626">i</span><span class="op" id="4412627">.</span><span class="op" id="4412628">(</span><span class="op" id="4412629">*</span><span class="ident" id="4412630">finishedMsg</span><span class="op" id="4412641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412644">if</span>&nbsp;<span class="op" id="4412647">!</span><span class="ident" id="4412648">ok</span>&nbsp;<span class="op" id="4412651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412655">return</span>&nbsp;<span class="builtintype" id="4412662">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412669">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412673">return</span>&nbsp;<span class="ident" id="4412680">bytes</span><span class="op" id="4412685">.</span><span class="ident" id="4412686">Equal</span><span class="op" id="4412691">(</span><span class="ident" id="4412692">m</span><span class="op" id="4412693">.</span><span class="ident" id="4412694">raw</span><span class="op" id="4412697">,</span>&nbsp;<span class="ident" id="4412699">m1</span><span class="op" id="4412701">.</span><span class="ident" id="4412702">raw</span><span class="op" id="4412705">)</span>&nbsp;<span class="op" id="4412707">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412712">bytes</span><span class="op" id="4412717">.</span><span class="ident" id="4412718">Equal</span><span class="op" id="4412723">(</span><span class="ident" id="4412724">m</span><span class="op" id="4412725">.</span><span class="ident" id="4412726">verifyData</span><span class="op" id="4412736">,</span>&nbsp;<span class="ident" id="4412738">m1</span><span class="op" id="4412740">.</span><span class="ident" id="4412741">verifyData</span><span class="op" id="4412751">)</span><br>
<span class="lineno"></span><span class="op" id="4412753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span><span class="keyword" id="4412756">func</span>&nbsp;<span class="op" id="4412761">(</span><span class="ident" id="4412762">m</span>&nbsp;<span class="op" id="4412764">*</span><span class="ident" id="4412765">finishedMsg</span><span class="op" id="4412776">)</span>&nbsp;<span class="ident" id="4412778">marshal</span><span class="op" id="4412785">(</span><span class="op" id="4412786">)</span>&nbsp;<span class="op" id="4412788">(</span><span class="ident" id="4412789">x</span>&nbsp;<span class="op" id="4412791">[</span><span class="op" id="4412792">]</span><span class="builtintype" id="4412793">byte</span><span class="op" id="4412797">)</span>&nbsp;<span class="op" id="4412799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412802">if</span>&nbsp;<span class="ident" id="4412805">m</span><span class="op" id="4412806">.</span><span class="ident" id="4412807">raw</span>&nbsp;<span class="op" id="4412811">!=</span>&nbsp;<span class="builtintype" id="4412814">nil</span>&nbsp;<span class="op" id="4412818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412822">return</span>&nbsp;<span class="ident" id="4412829">m</span><span class="op" id="4412830">.</span><span class="ident" id="4412831">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412840">x</span>&nbsp;<span class="op" id="4412842">=</span>&nbsp;<span class="builtinfunc" id="4412844">make</span><span class="op" id="4412848">(</span><span class="op" id="4412849">[</span><span class="op" id="4412850">]</span><span class="builtintype" id="4412851">byte</span><span class="op" id="4412855">,</span>&nbsp;<span class="num" id="4412857">4</span><span class="op" id="4412858">+</span><span class="builtinfunc" id="4412859">len</span><span class="op" id="4412862">(</span><span class="ident" id="4412863">m</span><span class="op" id="4412864">.</span><span class="ident" id="4412865">verifyData</span><span class="op" id="4412875">)</span><span class="op" id="4412876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412879">x</span><span class="op" id="4412880">[</span><span class="num" id="4412881">0</span><span class="op" id="4412882">]</span>&nbsp;<span class="op" id="4412884">=</span>&nbsp;<span class="ident" id="4412886">typeFinished</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412900">x</span><span class="op" id="4412901">[</span><span class="num" id="4412902">3</span><span class="op" id="4412903">]</span>&nbsp;<span class="op" id="4412905">=</span>&nbsp;<span class="builtintype" id="4412907">byte</span><span class="op" id="4412911">(</span><span class="builtinfunc" id="4412912">len</span><span class="op" id="4412915">(</span><span class="ident" id="4412916">m</span><span class="op" id="4412917">.</span><span class="ident" id="4412918">verifyData</span><span class="op" id="4412928">)</span><span class="op" id="4412929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4412932">copy</span><span class="op" id="4412936">(</span><span class="ident" id="4412937">x</span><span class="op" id="4412938">[</span><span class="num" id="4412939">4</span><span class="op" id="4412940">:</span><span class="op" id="4412941">]</span><span class="op" id="4412942">,</span>&nbsp;<span class="ident" id="4412944">m</span><span class="op" id="4412945">.</span><span class="ident" id="4412946">verifyData</span><span class="op" id="4412956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4412959">m</span><span class="op" id="4412960">.</span><span class="ident" id="4412961">raw</span>&nbsp;<span class="op" id="4412965">=</span>&nbsp;<span class="ident" id="4412967">x</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4412970">return</span><br>
<span class="lineno"></span><span class="op" id="4412977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4412980">func</span>&nbsp;<span class="op" id="4412985">(</span><span class="ident" id="4412986">m</span>&nbsp;<span class="op" id="4412988">*</span><span class="ident" id="4412989">finishedMsg</span><span class="op" id="4413000">)</span>&nbsp;<span class="ident" id="4413002">unmarshal</span><span class="op" id="4413011">(</span><span class="ident" id="4413012">data</span>&nbsp;<span class="op" id="4413017">[</span><span class="op" id="4413018">]</span><span class="builtintype" id="4413019">byte</span><span class="op" id="4413023">)</span>&nbsp;<span class="builtintype" id="4413025">bool</span>&nbsp;<span class="op" id="4413030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413033">m</span><span class="op" id="4413034">.</span><span class="ident" id="4413035">raw</span>&nbsp;<span class="op" id="4413039">=</span>&nbsp;<span class="ident" id="4413041">data</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413047">if</span>&nbsp;<span class="builtinfunc" id="4413050">len</span><span class="op" id="4413053">(</span><span class="ident" id="4413054">data</span><span class="op" id="4413058">)</span>&nbsp;<span class="op" id="4413060">&lt;</span>&nbsp;<span class="num" id="4413062">4</span>&nbsp;<span class="op" id="4413064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413068">return</span>&nbsp;<span class="builtintype" id="4413075">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413085">m</span><span class="op" id="4413086">.</span><span class="ident" id="4413087">verifyData</span>&nbsp;<span class="op" id="4413098">=</span>&nbsp;<span class="ident" id="4413100">data</span><span class="op" id="4413104">[</span><span class="num" id="4413105">4</span><span class="op" id="4413106">:</span><span class="op" id="4413107">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413110">return</span>&nbsp;<span class="builtintype" id="4413117">true</span><br>
<span class="lineno">1005</span><span class="op" id="4413122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4413125">type</span>&nbsp;<span class="ident" id="4413130">nextProtoMsg</span>&nbsp;<span class="keyword" id="4413143">struct</span>&nbsp;<span class="op" id="4413150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413153">raw</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4413159">[</span><span class="op" id="4413160">]</span><span class="builtintype" id="4413161">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413167">proto</span>&nbsp;<span class="builtintype" id="4413173">string</span><br>
<span class="lineno">1010</span><span class="op" id="4413180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4413183">func</span>&nbsp;<span class="op" id="4413188">(</span><span class="ident" id="4413189">m</span>&nbsp;<span class="op" id="4413191">*</span><span class="ident" id="4413192">nextProtoMsg</span><span class="op" id="4413204">)</span>&nbsp;<span class="ident" id="4413206">equal</span><span class="op" id="4413211">(</span><span class="ident" id="4413212">i</span>&nbsp;<span class="keyword" id="4413214">interface</span><span class="op" id="4413223">{</span><span class="op" id="4413224">}</span><span class="op" id="4413225">)</span>&nbsp;<span class="builtintype" id="4413227">bool</span>&nbsp;<span class="op" id="4413232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413235">m1</span><span class="op" id="4413237">,</span>&nbsp;<span class="ident" id="4413239">ok</span>&nbsp;<span class="op" id="4413242">:=</span>&nbsp;<span class="ident" id="4413245">i</span><span class="op" id="4413246">.</span><span class="op" id="4413247">(</span><span class="op" id="4413248">*</span><span class="ident" id="4413249">nextProtoMsg</span><span class="op" id="4413261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413264">if</span>&nbsp;<span class="op" id="4413267">!</span><span class="ident" id="4413268">ok</span>&nbsp;<span class="op" id="4413271">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413275">return</span>&nbsp;<span class="builtintype" id="4413282">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413293">return</span>&nbsp;<span class="ident" id="4413300">bytes</span><span class="op" id="4413305">.</span><span class="ident" id="4413306">Equal</span><span class="op" id="4413311">(</span><span class="ident" id="4413312">m</span><span class="op" id="4413313">.</span><span class="ident" id="4413314">raw</span><span class="op" id="4413317">,</span>&nbsp;<span class="ident" id="4413319">m1</span><span class="op" id="4413321">.</span><span class="ident" id="4413322">raw</span><span class="op" id="4413325">)</span>&nbsp;<span class="op" id="4413327">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413332">m</span><span class="op" id="4413333">.</span><span class="ident" id="4413334">proto</span>&nbsp;<span class="op" id="4413340">==</span>&nbsp;<span class="ident" id="4413343">m1</span><span class="op" id="4413345">.</span><span class="ident" id="4413346">proto</span><br>
<span class="lineno">1020</span><span class="op" id="4413352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4413355">func</span>&nbsp;<span class="op" id="4413360">(</span><span class="ident" id="4413361">m</span>&nbsp;<span class="op" id="4413363">*</span><span class="ident" id="4413364">nextProtoMsg</span><span class="op" id="4413376">)</span>&nbsp;<span class="ident" id="4413378">marshal</span><span class="op" id="4413385">(</span><span class="op" id="4413386">)</span>&nbsp;<span class="op" id="4413388">[</span><span class="op" id="4413389">]</span><span class="builtintype" id="4413390">byte</span>&nbsp;<span class="op" id="4413395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413398">if</span>&nbsp;<span class="ident" id="4413401">m</span><span class="op" id="4413402">.</span><span class="ident" id="4413403">raw</span>&nbsp;<span class="op" id="4413407">!=</span>&nbsp;<span class="builtintype" id="4413410">nil</span>&nbsp;<span class="op" id="4413414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413418">return</span>&nbsp;<span class="ident" id="4413425">m</span><span class="op" id="4413426">.</span><span class="ident" id="4413427">raw</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413435">l</span>&nbsp;<span class="op" id="4413437">:=</span>&nbsp;<span class="builtinfunc" id="4413440">len</span><span class="op" id="4413443">(</span><span class="ident" id="4413444">m</span><span class="op" id="4413445">.</span><span class="ident" id="4413446">proto</span><span class="op" id="4413451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413454">if</span>&nbsp;<span class="ident" id="4413457">l</span>&nbsp;<span class="op" id="4413459">&gt;</span>&nbsp;<span class="num" id="4413461">255</span>&nbsp;<span class="op" id="4413465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413469">l</span>&nbsp;<span class="op" id="4413471">=</span>&nbsp;<span class="num" id="4413473">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413478">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413482">padding</span>&nbsp;<span class="op" id="4413490">:=</span>&nbsp;<span class="num" id="4413493">32</span>&nbsp;<span class="op" id="4413496">-</span>&nbsp;<span class="op" id="4413498">(</span><span class="ident" id="4413499">l</span><span class="op" id="4413500">+</span><span class="num" id="4413501">2</span><span class="op" id="4413502">)</span><span class="op" id="4413503">%</span><span class="num" id="4413504">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413508">length</span>&nbsp;<span class="op" id="4413515">:=</span>&nbsp;<span class="ident" id="4413518">l</span>&nbsp;<span class="op" id="4413520">+</span>&nbsp;<span class="ident" id="4413522">padding</span>&nbsp;<span class="op" id="4413530">+</span>&nbsp;<span class="num" id="4413532">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413535">x</span>&nbsp;<span class="op" id="4413537">:=</span>&nbsp;<span class="builtinfunc" id="4413540">make</span><span class="op" id="4413544">(</span><span class="op" id="4413545">[</span><span class="op" id="4413546">]</span><span class="builtintype" id="4413547">byte</span><span class="op" id="4413551">,</span>&nbsp;<span class="ident" id="4413553">length</span><span class="op" id="4413559">+</span><span class="num" id="4413560">4</span><span class="op" id="4413561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413564">x</span><span class="op" id="4413565">[</span><span class="num" id="4413566">0</span><span class="op" id="4413567">]</span>&nbsp;<span class="op" id="4413569">=</span>&nbsp;<span class="ident" id="4413571">typeNextProtocol</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413589">x</span><span class="op" id="4413590">[</span><span class="num" id="4413591">1</span><span class="op" id="4413592">]</span>&nbsp;<span class="op" id="4413594">=</span>&nbsp;<span class="builtintype" id="4413596">uint8</span><span class="op" id="4413601">(</span><span class="ident" id="4413602">length</span>&nbsp;<span class="op" id="4413609">&gt;&gt;</span>&nbsp;<span class="num" id="4413612">16</span><span class="op" id="4413614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413617">x</span><span class="op" id="4413618">[</span><span class="num" id="4413619">2</span><span class="op" id="4413620">]</span>&nbsp;<span class="op" id="4413622">=</span>&nbsp;<span class="builtintype" id="4413624">uint8</span><span class="op" id="4413629">(</span><span class="ident" id="4413630">length</span>&nbsp;<span class="op" id="4413637">&gt;&gt;</span>&nbsp;<span class="num" id="4413640">8</span><span class="op" id="4413641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413644">x</span><span class="op" id="4413645">[</span><span class="num" id="4413646">3</span><span class="op" id="4413647">]</span>&nbsp;<span class="op" id="4413649">=</span>&nbsp;<span class="builtintype" id="4413651">uint8</span><span class="op" id="4413656">(</span><span class="ident" id="4413657">length</span><span class="op" id="4413663">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413667">y</span>&nbsp;<span class="op" id="4413669">:=</span>&nbsp;<span class="ident" id="4413672">x</span><span class="op" id="4413673">[</span><span class="num" id="4413674">4</span><span class="op" id="4413675">:</span><span class="op" id="4413676">]</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413679">y</span><span class="op" id="4413680">[</span><span class="num" id="4413681">0</span><span class="op" id="4413682">]</span>&nbsp;<span class="op" id="4413684">=</span>&nbsp;<span class="builtintype" id="4413686">byte</span><span class="op" id="4413690">(</span><span class="ident" id="4413691">l</span><span class="op" id="4413692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4413695">copy</span><span class="op" id="4413699">(</span><span class="ident" id="4413700">y</span><span class="op" id="4413701">[</span><span class="num" id="4413702">1</span><span class="op" id="4413703">:</span><span class="op" id="4413704">]</span><span class="op" id="4413705">,</span>&nbsp;<span class="op" id="4413707">[</span><span class="op" id="4413708">]</span><span class="builtintype" id="4413709">byte</span><span class="op" id="4413713">(</span><span class="ident" id="4413714">m</span><span class="op" id="4413715">.</span><span class="ident" id="4413716">proto</span><span class="op" id="4413721">[</span><span class="num" id="4413722">0</span><span class="op" id="4413723">:</span><span class="ident" id="4413724">l</span><span class="op" id="4413725">]</span><span class="op" id="4413726">)</span><span class="op" id="4413727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413730">y</span>&nbsp;<span class="op" id="4413732">=</span>&nbsp;<span class="ident" id="4413734">y</span><span class="op" id="4413735">[</span><span class="num" id="4413736">1</span><span class="op" id="4413737">+</span><span class="ident" id="4413738">l</span><span class="op" id="4413739">:</span><span class="op" id="4413740">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413743">y</span><span class="op" id="4413744">[</span><span class="num" id="4413745">0</span><span class="op" id="4413746">]</span>&nbsp;<span class="op" id="4413748">=</span>&nbsp;<span class="builtintype" id="4413750">byte</span><span class="op" id="4413754">(</span><span class="ident" id="4413755">padding</span><span class="op" id="4413762">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413766">m</span><span class="op" id="4413767">.</span><span class="ident" id="4413768">raw</span>&nbsp;<span class="op" id="4413772">=</span>&nbsp;<span class="ident" id="4413774">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413778">return</span>&nbsp;<span class="ident" id="4413785">x</span><br>
<span class="lineno"></span><span class="op" id="4413787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span><span class="keyword" id="4413790">func</span>&nbsp;<span class="op" id="4413795">(</span><span class="ident" id="4413796">m</span>&nbsp;<span class="op" id="4413798">*</span><span class="ident" id="4413799">nextProtoMsg</span><span class="op" id="4413811">)</span>&nbsp;<span class="ident" id="4413813">unmarshal</span><span class="op" id="4413822">(</span><span class="ident" id="4413823">data</span>&nbsp;<span class="op" id="4413828">[</span><span class="op" id="4413829">]</span><span class="builtintype" id="4413830">byte</span><span class="op" id="4413834">)</span>&nbsp;<span class="builtintype" id="4413836">bool</span>&nbsp;<span class="op" id="4413841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413844">m</span><span class="op" id="4413845">.</span><span class="ident" id="4413846">raw</span>&nbsp;<span class="op" id="4413850">=</span>&nbsp;<span class="ident" id="4413852">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413859">if</span>&nbsp;<span class="builtinfunc" id="4413862">len</span><span class="op" id="4413865">(</span><span class="ident" id="4413866">data</span><span class="op" id="4413870">)</span>&nbsp;<span class="op" id="4413872">&lt;</span>&nbsp;<span class="num" id="4413874">5</span>&nbsp;<span class="op" id="4413876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413880">return</span>&nbsp;<span class="builtintype" id="4413887">false</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413897">data</span>&nbsp;<span class="op" id="4413902">=</span>&nbsp;<span class="ident" id="4413904">data</span><span class="op" id="4413908">[</span><span class="num" id="4413909">4</span><span class="op" id="4413910">:</span><span class="op" id="4413911">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413914">protoLen</span>&nbsp;<span class="op" id="4413923">:=</span>&nbsp;<span class="builtintype" id="4413926">int</span><span class="op" id="4413929">(</span><span class="ident" id="4413930">data</span><span class="op" id="4413934">[</span><span class="num" id="4413935">0</span><span class="op" id="4413936">]</span><span class="op" id="4413937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4413940">data</span>&nbsp;<span class="op" id="4413945">=</span>&nbsp;<span class="ident" id="4413947">data</span><span class="op" id="4413951">[</span><span class="num" id="4413952">1</span><span class="op" id="4413953">:</span><span class="op" id="4413954">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413957">if</span>&nbsp;<span class="builtinfunc" id="4413960">len</span><span class="op" id="4413963">(</span><span class="ident" id="4413964">data</span><span class="op" id="4413968">)</span>&nbsp;<span class="op" id="4413970">&lt;</span>&nbsp;<span class="ident" id="4413972">protoLen</span>&nbsp;<span class="op" id="4413981">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4413985">return</span>&nbsp;<span class="builtintype" id="4413992">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4413999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414002">m</span><span class="op" id="4414003">.</span><span class="ident" id="4414004">proto</span>&nbsp;<span class="op" id="4414010">=</span>&nbsp;<span class="builtintype" id="4414012">string</span><span class="op" id="4414018">(</span><span class="ident" id="4414019">data</span><span class="op" id="4414023">[</span><span class="num" id="4414024">0</span><span class="op" id="4414025">:</span><span class="ident" id="4414026">protoLen</span><span class="op" id="4414034">]</span><span class="op" id="4414035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414038">data</span>&nbsp;<span class="op" id="4414043">=</span>&nbsp;<span class="ident" id="4414045">data</span><span class="op" id="4414049">[</span><span class="ident" id="4414050">protoLen</span><span class="op" id="4414058">:</span><span class="op" id="4414059">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414063">if</span>&nbsp;<span class="builtinfunc" id="4414066">len</span><span class="op" id="4414069">(</span><span class="ident" id="4414070">data</span><span class="op" id="4414074">)</span>&nbsp;<span class="op" id="4414076">&lt;</span>&nbsp;<span class="num" id="4414078">1</span>&nbsp;<span class="op" id="4414080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414084">return</span>&nbsp;<span class="builtintype" id="4414091">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4414098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414101">paddingLen</span>&nbsp;<span class="op" id="4414112">:=</span>&nbsp;<span class="builtintype" id="4414115">int</span><span class="op" id="4414118">(</span><span class="ident" id="4414119">data</span><span class="op" id="4414123">[</span><span class="num" id="4414124">0</span><span class="op" id="4414125">]</span><span class="op" id="4414126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414129">data</span>&nbsp;<span class="op" id="4414134">=</span>&nbsp;<span class="ident" id="4414136">data</span><span class="op" id="4414140">[</span><span class="num" id="4414141">1</span><span class="op" id="4414142">:</span><span class="op" id="4414143">]</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414146">if</span>&nbsp;<span class="builtinfunc" id="4414149">len</span><span class="op" id="4414152">(</span><span class="ident" id="4414153">data</span><span class="op" id="4414157">)</span>&nbsp;<span class="op" id="4414159">!=</span>&nbsp;<span class="ident" id="4414162">paddingLen</span>&nbsp;<span class="op" id="4414173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414177">return</span>&nbsp;<span class="builtintype" id="4414184">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4414191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414195">return</span>&nbsp;<span class="builtintype" id="4414202">true</span><br>
<span class="lineno">1075</span><span class="op" id="4414207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4414210">type</span>&nbsp;<span class="ident" id="4414215">certificateRequestMsg</span>&nbsp;<span class="keyword" id="4414237">struct</span>&nbsp;<span class="op" id="4414244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414247">raw</span>&nbsp;<span class="op" id="4414251">[</span><span class="op" id="4414252">]</span><span class="builtintype" id="4414253">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414259">//&nbsp;hasSignatureAndHash&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;message&nbsp;includes&nbsp;a&nbsp;list</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414330">//&nbsp;of&nbsp;signature&nbsp;and&nbsp;hash&nbsp;functions.&nbsp;This&nbsp;change&nbsp;was&nbsp;introduced&nbsp;with&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4414403">//&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414412">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="4414432">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414439">certificateTypes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4414462">[</span><span class="op" id="4414463">]</span><span class="builtintype" id="4414464">byte</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414470">signatureAndHashes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4414493">[</span><span class="op" id="4414494">]</span><span class="ident" id="4414495">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414513">certificateAuthorities</span>&nbsp;<span class="op" id="4414536">[</span><span class="op" id="4414537">]</span><span class="op" id="4414538">[</span><span class="op" id="4414539">]</span><span class="builtintype" id="4414540">byte</span><br>
<span class="lineno"></span><span class="op" id="4414545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4414548">func</span>&nbsp;<span class="op" id="4414553">(</span><span class="ident" id="4414554">m</span>&nbsp;<span class="op" id="4414556">*</span><span class="ident" id="4414557">certificateRequestMsg</span><span class="op" id="4414578">)</span>&nbsp;<span class="ident" id="4414580">equal</span><span class="op" id="4414585">(</span><span class="ident" id="4414586">i</span>&nbsp;<span class="keyword" id="4414588">interface</span><span class="op" id="4414597">{</span><span class="op" id="4414598">}</span><span class="op" id="4414599">)</span>&nbsp;<span class="builtintype" id="4414601">bool</span>&nbsp;<span class="op" id="4414606">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414609">m1</span><span class="op" id="4414611">,</span>&nbsp;<span class="ident" id="4414613">ok</span>&nbsp;<span class="op" id="4414616">:=</span>&nbsp;<span class="ident" id="4414619">i</span><span class="op" id="4414620">.</span><span class="op" id="4414621">(</span><span class="op" id="4414622">*</span><span class="ident" id="4414623">certificateRequestMsg</span><span class="op" id="4414644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414647">if</span>&nbsp;<span class="op" id="4414650">!</span><span class="ident" id="4414651">ok</span>&nbsp;<span class="op" id="4414654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414658">return</span>&nbsp;<span class="builtintype" id="4414665">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4414672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414676">return</span>&nbsp;<span class="ident" id="4414683">bytes</span><span class="op" id="4414688">.</span><span class="ident" id="4414689">Equal</span><span class="op" id="4414694">(</span><span class="ident" id="4414695">m</span><span class="op" id="4414696">.</span><span class="ident" id="4414697">raw</span><span class="op" id="4414700">,</span>&nbsp;<span class="ident" id="4414702">m1</span><span class="op" id="4414704">.</span><span class="ident" id="4414705">raw</span><span class="op" id="4414708">)</span>&nbsp;<span class="op" id="4414710">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414715">bytes</span><span class="op" id="4414720">.</span><span class="ident" id="4414721">Equal</span><span class="op" id="4414726">(</span><span class="ident" id="4414727">m</span><span class="op" id="4414728">.</span><span class="ident" id="4414729">certificateTypes</span><span class="op" id="4414745">,</span>&nbsp;<span class="ident" id="4414747">m1</span><span class="op" id="4414749">.</span><span class="ident" id="4414750">certificateTypes</span><span class="op" id="4414766">)</span>&nbsp;<span class="op" id="4414768">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414773">eqByteSlices</span><span class="op" id="4414785">(</span><span class="ident" id="4414786">m</span><span class="op" id="4414787">.</span><span class="ident" id="4414788">certificateAuthorities</span><span class="op" id="4414810">,</span>&nbsp;<span class="ident" id="4414812">m1</span><span class="op" id="4414814">.</span><span class="ident" id="4414815">certificateAuthorities</span><span class="op" id="4414837">)</span>&nbsp;<span class="op" id="4414839">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4414844">eqSignatureAndHashes</span><span class="op" id="4414864">(</span><span class="ident" id="4414865">m</span><span class="op" id="4414866">.</span><span class="ident" id="4414867">signatureAndHashes</span><span class="op" id="4414885">,</span>&nbsp;<span class="ident" id="4414887">m1</span><span class="op" id="4414889">.</span><span class="ident" id="4414890">signatureAndHashes</span><span class="op" id="4414908">)</span><br>
<span class="lineno"></span><span class="op" id="4414910">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="keyword" id="4414913">func</span>&nbsp;<span class="op" id="4414918">(</span><span class="ident" id="4414919">m</span>&nbsp;<span class="op" id="4414921">*</span><span class="ident" id="4414922">certificateRequestMsg</span><span class="op" id="4414943">)</span>&nbsp;<span class="ident" id="4414945">marshal</span><span class="op" id="4414952">(</span><span class="op" id="4414953">)</span>&nbsp;<span class="op" id="4414955">(</span><span class="ident" id="4414956">x</span>&nbsp;<span class="op" id="4414958">[</span><span class="op" id="4414959">]</span><span class="builtintype" id="4414960">byte</span><span class="op" id="4414964">)</span>&nbsp;<span class="op" id="4414966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414969">if</span>&nbsp;<span class="ident" id="4414972">m</span><span class="op" id="4414973">.</span><span class="ident" id="4414974">raw</span>&nbsp;<span class="op" id="4414978">!=</span>&nbsp;<span class="builtintype" id="4414981">nil</span>&nbsp;<span class="op" id="4414985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4414989">return</span>&nbsp;<span class="ident" id="4414996">m</span><span class="op" id="4414997">.</span><span class="ident" id="4414998">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415003">}</span><br>
<span class="lineno">1105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4415007">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415064">length</span>&nbsp;<span class="op" id="4415071">:=</span>&nbsp;<span class="num" id="4415074">1</span>&nbsp;<span class="op" id="4415076">+</span>&nbsp;<span class="builtinfunc" id="4415078">len</span><span class="op" id="4415081">(</span><span class="ident" id="4415082">m</span><span class="op" id="4415083">.</span><span class="ident" id="4415084">certificateTypes</span><span class="op" id="4415100">)</span>&nbsp;<span class="op" id="4415102">+</span>&nbsp;<span class="num" id="4415104">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415107">casLength</span>&nbsp;<span class="op" id="4415117">:=</span>&nbsp;<span class="num" id="4415120">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415123">for</span>&nbsp;<span class="ident" id="4415127">_</span><span class="op" id="4415128">,</span>&nbsp;<span class="ident" id="4415130">ca</span>&nbsp;<span class="op" id="4415133">:=</span>&nbsp;<span class="keyword" id="4415136">range</span>&nbsp;<span class="ident" id="4415142">m</span><span class="op" id="4415143">.</span><span class="ident" id="4415144">certificateAuthorities</span>&nbsp;<span class="op" id="4415167">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415171">casLength</span>&nbsp;<span class="op" id="4415181">+=</span>&nbsp;<span class="num" id="4415184">2</span>&nbsp;<span class="op" id="4415186">+</span>&nbsp;<span class="builtinfunc" id="4415188">len</span><span class="op" id="4415191">(</span><span class="ident" id="4415192">ca</span><span class="op" id="4415194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415200">length</span>&nbsp;<span class="op" id="4415207">+=</span>&nbsp;<span class="ident" id="4415210">casLength</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415222">if</span>&nbsp;<span class="ident" id="4415225">m</span><span class="op" id="4415226">.</span><span class="ident" id="4415227">hasSignatureAndHash</span>&nbsp;<span class="op" id="4415247">{</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415251">length</span>&nbsp;<span class="op" id="4415258">+=</span>&nbsp;<span class="num" id="4415261">2</span>&nbsp;<span class="op" id="4415263">+</span>&nbsp;<span class="num" id="4415265">2</span><span class="op" id="4415266">*</span><span class="builtinfunc" id="4415267">len</span><span class="op" id="4415270">(</span><span class="ident" id="4415271">m</span><span class="op" id="4415272">.</span><span class="ident" id="4415273">signatureAndHashes</span><span class="op" id="4415291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415298">x</span>&nbsp;<span class="op" id="4415300">=</span>&nbsp;<span class="builtinfunc" id="4415302">make</span><span class="op" id="4415306">(</span><span class="op" id="4415307">[</span><span class="op" id="4415308">]</span><span class="builtintype" id="4415309">byte</span><span class="op" id="4415313">,</span>&nbsp;<span class="num" id="4415315">4</span><span class="op" id="4415316">+</span><span class="ident" id="4415317">length</span><span class="op" id="4415323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415326">x</span><span class="op" id="4415327">[</span><span class="num" id="4415328">0</span><span class="op" id="4415329">]</span>&nbsp;<span class="op" id="4415331">=</span>&nbsp;<span class="ident" id="4415333">typeCertificateRequest</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415357">x</span><span class="op" id="4415358">[</span><span class="num" id="4415359">1</span><span class="op" id="4415360">]</span>&nbsp;<span class="op" id="4415362">=</span>&nbsp;<span class="builtintype" id="4415364">uint8</span><span class="op" id="4415369">(</span><span class="ident" id="4415370">length</span>&nbsp;<span class="op" id="4415377">&gt;&gt;</span>&nbsp;<span class="num" id="4415380">16</span><span class="op" id="4415382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415385">x</span><span class="op" id="4415386">[</span><span class="num" id="4415387">2</span><span class="op" id="4415388">]</span>&nbsp;<span class="op" id="4415390">=</span>&nbsp;<span class="builtintype" id="4415392">uint8</span><span class="op" id="4415397">(</span><span class="ident" id="4415398">length</span>&nbsp;<span class="op" id="4415405">&gt;&gt;</span>&nbsp;<span class="num" id="4415408">8</span><span class="op" id="4415409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415412">x</span><span class="op" id="4415413">[</span><span class="num" id="4415414">3</span><span class="op" id="4415415">]</span>&nbsp;<span class="op" id="4415417">=</span>&nbsp;<span class="builtintype" id="4415419">uint8</span><span class="op" id="4415424">(</span><span class="ident" id="4415425">length</span><span class="op" id="4415431">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415435">x</span><span class="op" id="4415436">[</span><span class="num" id="4415437">4</span><span class="op" id="4415438">]</span>&nbsp;<span class="op" id="4415440">=</span>&nbsp;<span class="builtintype" id="4415442">uint8</span><span class="op" id="4415447">(</span><span class="builtinfunc" id="4415448">len</span><span class="op" id="4415451">(</span><span class="ident" id="4415452">m</span><span class="op" id="4415453">.</span><span class="ident" id="4415454">certificateTypes</span><span class="op" id="4415470">)</span><span class="op" id="4415471">)</span><br>
<span class="lineno">1125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4415475">copy</span><span class="op" id="4415479">(</span><span class="ident" id="4415480">x</span><span class="op" id="4415481">[</span><span class="num" id="4415482">5</span><span class="op" id="4415483">:</span><span class="op" id="4415484">]</span><span class="op" id="4415485">,</span>&nbsp;<span class="ident" id="4415487">m</span><span class="op" id="4415488">.</span><span class="ident" id="4415489">certificateTypes</span><span class="op" id="4415505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415508">y</span>&nbsp;<span class="op" id="4415510">:=</span>&nbsp;<span class="ident" id="4415513">x</span><span class="op" id="4415514">[</span><span class="num" id="4415515">5</span><span class="op" id="4415516">+</span><span class="builtinfunc" id="4415517">len</span><span class="op" id="4415520">(</span><span class="ident" id="4415521">m</span><span class="op" id="4415522">.</span><span class="ident" id="4415523">certificateTypes</span><span class="op" id="4415539">)</span><span class="op" id="4415540">:</span><span class="op" id="4415541">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415545">if</span>&nbsp;<span class="ident" id="4415548">m</span><span class="op" id="4415549">.</span><span class="ident" id="4415550">hasSignatureAndHash</span>&nbsp;<span class="op" id="4415570">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415574">n</span>&nbsp;<span class="op" id="4415576">:=</span>&nbsp;<span class="builtinfunc" id="4415579">len</span><span class="op" id="4415582">(</span><span class="ident" id="4415583">m</span><span class="op" id="4415584">.</span><span class="ident" id="4415585">signatureAndHashes</span><span class="op" id="4415603">)</span>&nbsp;<span class="op" id="4415605">*</span>&nbsp;<span class="num" id="4415607">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415611">y</span><span class="op" id="4415612">[</span><span class="num" id="4415613">0</span><span class="op" id="4415614">]</span>&nbsp;<span class="op" id="4415616">=</span>&nbsp;<span class="builtintype" id="4415618">uint8</span><span class="op" id="4415623">(</span><span class="ident" id="4415624">n</span>&nbsp;<span class="op" id="4415626">&gt;&gt;</span>&nbsp;<span class="num" id="4415629">8</span><span class="op" id="4415630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415634">y</span><span class="op" id="4415635">[</span><span class="num" id="4415636">1</span><span class="op" id="4415637">]</span>&nbsp;<span class="op" id="4415639">=</span>&nbsp;<span class="builtintype" id="4415641">uint8</span><span class="op" id="4415646">(</span><span class="ident" id="4415647">n</span><span class="op" id="4415648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415652">y</span>&nbsp;<span class="op" id="4415654">=</span>&nbsp;<span class="ident" id="4415656">y</span><span class="op" id="4415657">[</span><span class="num" id="4415658">2</span><span class="op" id="4415659">:</span><span class="op" id="4415660">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415664">for</span>&nbsp;<span class="ident" id="4415668">_</span><span class="op" id="4415669">,</span>&nbsp;<span class="ident" id="4415671">sigAndHash</span>&nbsp;<span class="op" id="4415682">:=</span>&nbsp;<span class="keyword" id="4415685">range</span>&nbsp;<span class="ident" id="4415691">m</span><span class="op" id="4415692">.</span><span class="ident" id="4415693">signatureAndHashes</span>&nbsp;<span class="op" id="4415712">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415717">y</span><span class="op" id="4415718">[</span><span class="num" id="4415719">0</span><span class="op" id="4415720">]</span>&nbsp;<span class="op" id="4415722">=</span>&nbsp;<span class="ident" id="4415724">sigAndHash</span><span class="op" id="4415734">.</span><span class="ident" id="4415735">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415743">y</span><span class="op" id="4415744">[</span><span class="num" id="4415745">1</span><span class="op" id="4415746">]</span>&nbsp;<span class="op" id="4415748">=</span>&nbsp;<span class="ident" id="4415750">sigAndHash</span><span class="op" id="4415760">.</span><span class="ident" id="4415761">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415774">y</span>&nbsp;<span class="op" id="4415776">=</span>&nbsp;<span class="ident" id="4415778">y</span><span class="op" id="4415779">[</span><span class="num" id="4415780">2</span><span class="op" id="4415781">:</span><span class="op" id="4415782">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4415789">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415793">y</span><span class="op" id="4415794">[</span><span class="num" id="4415795">0</span><span class="op" id="4415796">]</span>&nbsp;<span class="op" id="4415798">=</span>&nbsp;<span class="builtintype" id="4415800">uint8</span><span class="op" id="4415805">(</span><span class="ident" id="4415806">casLength</span>&nbsp;<span class="op" id="4415816">&gt;&gt;</span>&nbsp;<span class="num" id="4415819">8</span><span class="op" id="4415820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415823">y</span><span class="op" id="4415824">[</span><span class="num" id="4415825">1</span><span class="op" id="4415826">]</span>&nbsp;<span class="op" id="4415828">=</span>&nbsp;<span class="builtintype" id="4415830">uint8</span><span class="op" id="4415835">(</span><span class="ident" id="4415836">casLength</span><span class="op" id="4415845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415848">y</span>&nbsp;<span class="op" id="4415850">=</span>&nbsp;<span class="ident" id="4415852">y</span><span class="op" id="4415853">[</span><span class="num" id="4415854">2</span><span class="op" id="4415855">:</span><span class="op" id="4415856">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4415859">for</span>&nbsp;<span class="ident" id="4415863">_</span><span class="op" id="4415864">,</span>&nbsp;<span class="ident" id="4415866">ca</span>&nbsp;<span class="op" id="4415869">:=</span>&nbsp;<span class="keyword" id="4415872">range</span>&nbsp;<span class="ident" id="4415878">m</span><span class="op" id="4415879">.</span><span class="ident" id="4415880">certificateAuthorities</span>&nbsp;<span class="op" id="4415903">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415907">y</span><span class="op" id="4415908">[</span><span class="num" id="4415909">0</span><span class="op" id="4415910">]</span>&nbsp;<span class="op" id="4415912">=</span>&nbsp;<span class="builtintype" id="4415914">uint8</span><span class="op" id="4415919">(</span><span class="builtinfunc" id="4415920">len</span><span class="op" id="4415923">(</span><span class="ident" id="4415924">ca</span><span class="op" id="4415926">)</span>&nbsp;<span class="op" id="4415928">&gt;&gt;</span>&nbsp;<span class="num" id="4415931">8</span><span class="op" id="4415932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415936">y</span><span class="op" id="4415937">[</span><span class="num" id="4415938">1</span><span class="op" id="4415939">]</span>&nbsp;<span class="op" id="4415941">=</span>&nbsp;<span class="builtintype" id="4415943">uint8</span><span class="op" id="4415948">(</span><span class="builtinfunc" id="4415949">len</span><span class="op" id="4415952">(</span><span class="ident" id="4415953">ca</span><span class="op" id="4415955">)</span><span class="op" id="4415956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415960">y</span>&nbsp;<span class="op" id="4415962">=</span>&nbsp;<span class="ident" id="4415964">y</span><span class="op" id="4415965">[</span><span class="num" id="4415966">2</span><span class="op" id="4415967">:</span><span class="op" id="4415968">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4415972">copy</span><span class="op" id="4415976">(</span><span class="ident" id="4415977">y</span><span class="op" id="4415978">,</span>&nbsp;<span class="ident" id="4415980">ca</span><span class="op" id="4415982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4415986">y</span>&nbsp;<span class="op" id="4415988">=</span>&nbsp;<span class="ident" id="4415990">y</span><span class="op" id="4415991">[</span><span class="builtinfunc" id="4415992">len</span><span class="op" id="4415995">(</span><span class="ident" id="4415996">ca</span><span class="op" id="4415998">)</span><span class="op" id="4415999">:</span><span class="op" id="4416000">]</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416007">m</span><span class="op" id="4416008">.</span><span class="ident" id="4416009">raw</span>&nbsp;<span class="op" id="4416013">=</span>&nbsp;<span class="ident" id="4416015">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416018">return</span><br>
<span class="lineno"></span><span class="op" id="4416025">}</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="keyword" id="4416028">func</span>&nbsp;<span class="op" id="4416033">(</span><span class="ident" id="4416034">m</span>&nbsp;<span class="op" id="4416036">*</span><span class="ident" id="4416037">certificateRequestMsg</span><span class="op" id="4416058">)</span>&nbsp;<span class="ident" id="4416060">unmarshal</span><span class="op" id="4416069">(</span><span class="ident" id="4416070">data</span>&nbsp;<span class="op" id="4416075">[</span><span class="op" id="4416076">]</span><span class="builtintype" id="4416077">byte</span><span class="op" id="4416081">)</span>&nbsp;<span class="builtintype" id="4416083">bool</span>&nbsp;<span class="op" id="4416088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416091">m</span><span class="op" id="4416092">.</span><span class="ident" id="4416093">raw</span>&nbsp;<span class="op" id="4416097">=</span>&nbsp;<span class="ident" id="4416099">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416106">if</span>&nbsp;<span class="builtinfunc" id="4416109">len</span><span class="op" id="4416112">(</span><span class="ident" id="4416113">data</span><span class="op" id="4416117">)</span>&nbsp;<span class="op" id="4416119">&lt;</span>&nbsp;<span class="num" id="4416121">5</span>&nbsp;<span class="op" id="4416123">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416127">return</span>&nbsp;<span class="builtintype" id="4416134">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416145">length</span>&nbsp;<span class="op" id="4416152">:=</span>&nbsp;<span class="builtintype" id="4416155">uint32</span><span class="op" id="4416161">(</span><span class="ident" id="4416162">data</span><span class="op" id="4416166">[</span><span class="num" id="4416167">1</span><span class="op" id="4416168">]</span><span class="op" id="4416169">)</span><span class="op" id="4416170">&lt;&lt;</span><span class="num" id="4416172">16</span>&nbsp;<span class="op" id="4416175">|</span>&nbsp;<span class="builtintype" id="4416177">uint32</span><span class="op" id="4416183">(</span><span class="ident" id="4416184">data</span><span class="op" id="4416188">[</span><span class="num" id="4416189">2</span><span class="op" id="4416190">]</span><span class="op" id="4416191">)</span><span class="op" id="4416192">&lt;&lt;</span><span class="num" id="4416194">8</span>&nbsp;<span class="op" id="4416196">|</span>&nbsp;<span class="builtintype" id="4416198">uint32</span><span class="op" id="4416204">(</span><span class="ident" id="4416205">data</span><span class="op" id="4416209">[</span><span class="num" id="4416210">3</span><span class="op" id="4416211">]</span><span class="op" id="4416212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416215">if</span>&nbsp;<span class="builtintype" id="4416218">uint32</span><span class="op" id="4416224">(</span><span class="builtinfunc" id="4416225">len</span><span class="op" id="4416228">(</span><span class="ident" id="4416229">data</span><span class="op" id="4416233">)</span><span class="op" id="4416234">)</span><span class="op" id="4416235">-</span><span class="num" id="4416236">4</span>&nbsp;<span class="op" id="4416238">!=</span>&nbsp;<span class="ident" id="4416241">length</span>&nbsp;<span class="op" id="4416248">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416252">return</span>&nbsp;<span class="builtintype" id="4416259">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416270">numCertTypes</span>&nbsp;<span class="op" id="4416283">:=</span>&nbsp;<span class="builtintype" id="4416286">int</span><span class="op" id="4416289">(</span><span class="ident" id="4416290">data</span><span class="op" id="4416294">[</span><span class="num" id="4416295">4</span><span class="op" id="4416296">]</span><span class="op" id="4416297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416300">data</span>&nbsp;<span class="op" id="4416305">=</span>&nbsp;<span class="ident" id="4416307">data</span><span class="op" id="4416311">[</span><span class="num" id="4416312">5</span><span class="op" id="4416313">:</span><span class="op" id="4416314">]</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416317">if</span>&nbsp;<span class="ident" id="4416320">numCertTypes</span>&nbsp;<span class="op" id="4416333">==</span>&nbsp;<span class="num" id="4416336">0</span>&nbsp;<span class="op" id="4416338">||</span>&nbsp;<span class="builtinfunc" id="4416341">len</span><span class="op" id="4416344">(</span><span class="ident" id="4416345">data</span><span class="op" id="4416349">)</span>&nbsp;<span class="op" id="4416351">&lt;=</span>&nbsp;<span class="ident" id="4416354">numCertTypes</span>&nbsp;<span class="op" id="4416367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416371">return</span>&nbsp;<span class="builtintype" id="4416378">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416389">m</span><span class="op" id="4416390">.</span><span class="ident" id="4416391">certificateTypes</span>&nbsp;<span class="op" id="4416408">=</span>&nbsp;<span class="builtinfunc" id="4416410">make</span><span class="op" id="4416414">(</span><span class="op" id="4416415">[</span><span class="op" id="4416416">]</span><span class="builtintype" id="4416417">byte</span><span class="op" id="4416421">,</span>&nbsp;<span class="ident" id="4416423">numCertTypes</span><span class="op" id="4416435">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416438">if</span>&nbsp;<span class="builtinfunc" id="4416441">copy</span><span class="op" id="4416445">(</span><span class="ident" id="4416446">m</span><span class="op" id="4416447">.</span><span class="ident" id="4416448">certificateTypes</span><span class="op" id="4416464">,</span>&nbsp;<span class="ident" id="4416466">data</span><span class="op" id="4416470">)</span>&nbsp;<span class="op" id="4416472">!=</span>&nbsp;<span class="ident" id="4416475">numCertTypes</span>&nbsp;<span class="op" id="4416488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416492">return</span>&nbsp;<span class="builtintype" id="4416499">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416510">data</span>&nbsp;<span class="op" id="4416515">=</span>&nbsp;<span class="ident" id="4416517">data</span><span class="op" id="4416521">[</span><span class="ident" id="4416522">numCertTypes</span><span class="op" id="4416534">:</span><span class="op" id="4416535">]</span><br>
<span class="lineno">1180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416539">if</span>&nbsp;<span class="ident" id="4416542">m</span><span class="op" id="4416543">.</span><span class="ident" id="4416544">hasSignatureAndHash</span>&nbsp;<span class="op" id="4416564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416568">if</span>&nbsp;<span class="builtinfunc" id="4416571">len</span><span class="op" id="4416574">(</span><span class="ident" id="4416575">data</span><span class="op" id="4416579">)</span>&nbsp;<span class="op" id="4416581">&lt;</span>&nbsp;<span class="num" id="4416583">2</span>&nbsp;<span class="op" id="4416585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416590">return</span>&nbsp;<span class="builtintype" id="4416597">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416605">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416609">sigAndHashLen</span>&nbsp;<span class="op" id="4416623">:=</span>&nbsp;<span class="builtintype" id="4416626">uint16</span><span class="op" id="4416632">(</span><span class="ident" id="4416633">data</span><span class="op" id="4416637">[</span><span class="num" id="4416638">0</span><span class="op" id="4416639">]</span><span class="op" id="4416640">)</span><span class="op" id="4416641">&lt;&lt;</span><span class="num" id="4416643">8</span>&nbsp;<span class="op" id="4416645">|</span>&nbsp;<span class="builtintype" id="4416647">uint16</span><span class="op" id="4416653">(</span><span class="ident" id="4416654">data</span><span class="op" id="4416658">[</span><span class="num" id="4416659">1</span><span class="op" id="4416660">]</span><span class="op" id="4416661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416665">data</span>&nbsp;<span class="op" id="4416670">=</span>&nbsp;<span class="ident" id="4416672">data</span><span class="op" id="4416676">[</span><span class="num" id="4416677">2</span><span class="op" id="4416678">:</span><span class="op" id="4416679">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416683">if</span>&nbsp;<span class="ident" id="4416686">sigAndHashLen</span><span class="op" id="4416699">&amp;</span><span class="num" id="4416700">1</span>&nbsp;<span class="op" id="4416702">!=</span>&nbsp;<span class="num" id="4416705">0</span>&nbsp;<span class="op" id="4416707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416712">return</span>&nbsp;<span class="builtintype" id="4416719">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416727">}</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416731">if</span>&nbsp;<span class="builtinfunc" id="4416734">len</span><span class="op" id="4416737">(</span><span class="ident" id="4416738">data</span><span class="op" id="4416742">)</span>&nbsp;<span class="op" id="4416744">&lt;</span>&nbsp;<span class="builtintype" id="4416746">int</span><span class="op" id="4416749">(</span><span class="ident" id="4416750">sigAndHashLen</span><span class="op" id="4416763">)</span>&nbsp;<span class="op" id="4416765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416770">return</span>&nbsp;<span class="builtintype" id="4416777">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416789">numSigAndHash</span>&nbsp;<span class="op" id="4416803">:=</span>&nbsp;<span class="ident" id="4416806">sigAndHashLen</span>&nbsp;<span class="op" id="4416820">/</span>&nbsp;<span class="num" id="4416822">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416826">m</span><span class="op" id="4416827">.</span><span class="ident" id="4416828">signatureAndHashes</span>&nbsp;<span class="op" id="4416847">=</span>&nbsp;<span class="builtinfunc" id="4416849">make</span><span class="op" id="4416853">(</span><span class="op" id="4416854">[</span><span class="op" id="4416855">]</span><span class="ident" id="4416856">signatureAndHash</span><span class="op" id="4416872">,</span>&nbsp;<span class="ident" id="4416874">numSigAndHash</span><span class="op" id="4416887">)</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4416891">for</span>&nbsp;<span class="ident" id="4416895">i</span>&nbsp;<span class="op" id="4416897">:=</span>&nbsp;<span class="keyword" id="4416900">range</span>&nbsp;<span class="ident" id="4416906">m</span><span class="op" id="4416907">.</span><span class="ident" id="4416908">signatureAndHashes</span>&nbsp;<span class="op" id="4416927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416932">m</span><span class="op" id="4416933">.</span><span class="ident" id="4416934">signatureAndHashes</span><span class="op" id="4416952">[</span><span class="ident" id="4416953">i</span><span class="op" id="4416954">]</span><span class="op" id="4416955">.</span><span class="ident" id="4416956">hash</span>&nbsp;<span class="op" id="4416961">=</span>&nbsp;<span class="ident" id="4416963">data</span><span class="op" id="4416967">[</span><span class="num" id="4416968">0</span><span class="op" id="4416969">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4416974">m</span><span class="op" id="4416975">.</span><span class="ident" id="4416976">signatureAndHashes</span><span class="op" id="4416994">[</span><span class="ident" id="4416995">i</span><span class="op" id="4416996">]</span><span class="op" id="4416997">.</span><span class="ident" id="4416998">signature</span>&nbsp;<span class="op" id="4417008">=</span>&nbsp;<span class="ident" id="4417010">data</span><span class="op" id="4417014">[</span><span class="num" id="4417015">1</span><span class="op" id="4417016">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417021">data</span>&nbsp;<span class="op" id="4417026">=</span>&nbsp;<span class="ident" id="4417028">data</span><span class="op" id="4417032">[</span><span class="num" id="4417033">2</span><span class="op" id="4417034">:</span><span class="op" id="4417035">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417039">}</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417046">if</span>&nbsp;<span class="builtinfunc" id="4417049">len</span><span class="op" id="4417052">(</span><span class="ident" id="4417053">data</span><span class="op" id="4417057">)</span>&nbsp;<span class="op" id="4417059">&lt;</span>&nbsp;<span class="num" id="4417061">2</span>&nbsp;<span class="op" id="4417063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417067">return</span>&nbsp;<span class="builtintype" id="4417074">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417081">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417084">casLength</span>&nbsp;<span class="op" id="4417094">:=</span>&nbsp;<span class="builtintype" id="4417097">uint16</span><span class="op" id="4417103">(</span><span class="ident" id="4417104">data</span><span class="op" id="4417108">[</span><span class="num" id="4417109">0</span><span class="op" id="4417110">]</span><span class="op" id="4417111">)</span><span class="op" id="4417112">&lt;&lt;</span><span class="num" id="4417114">8</span>&nbsp;<span class="op" id="4417116">|</span>&nbsp;<span class="builtintype" id="4417118">uint16</span><span class="op" id="4417124">(</span><span class="ident" id="4417125">data</span><span class="op" id="4417129">[</span><span class="num" id="4417130">1</span><span class="op" id="4417131">]</span><span class="op" id="4417132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417135">data</span>&nbsp;<span class="op" id="4417140">=</span>&nbsp;<span class="ident" id="4417142">data</span><span class="op" id="4417146">[</span><span class="num" id="4417147">2</span><span class="op" id="4417148">:</span><span class="op" id="4417149">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417152">if</span>&nbsp;<span class="builtinfunc" id="4417155">len</span><span class="op" id="4417158">(</span><span class="ident" id="4417159">data</span><span class="op" id="4417163">)</span>&nbsp;<span class="op" id="4417165">&lt;</span>&nbsp;<span class="builtintype" id="4417167">int</span><span class="op" id="4417170">(</span><span class="ident" id="4417171">casLength</span><span class="op" id="4417180">)</span>&nbsp;<span class="op" id="4417182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417186">return</span>&nbsp;<span class="builtintype" id="4417193">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417200">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417203">cas</span>&nbsp;<span class="op" id="4417207">:=</span>&nbsp;<span class="builtinfunc" id="4417210">make</span><span class="op" id="4417214">(</span><span class="op" id="4417215">[</span><span class="op" id="4417216">]</span><span class="builtintype" id="4417217">byte</span><span class="op" id="4417221">,</span>&nbsp;<span class="ident" id="4417223">casLength</span><span class="op" id="4417232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4417235">copy</span><span class="op" id="4417239">(</span><span class="ident" id="4417240">cas</span><span class="op" id="4417243">,</span>&nbsp;<span class="ident" id="4417245">data</span><span class="op" id="4417249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417252">data</span>&nbsp;<span class="op" id="4417257">=</span>&nbsp;<span class="ident" id="4417259">data</span><span class="op" id="4417263">[</span><span class="ident" id="4417264">casLength</span><span class="op" id="4417273">:</span><span class="op" id="4417274">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417278">m</span><span class="op" id="4417279">.</span><span class="ident" id="4417280">certificateAuthorities</span>&nbsp;<span class="op" id="4417303">=</span>&nbsp;<span class="builtintype" id="4417305">nil</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417310">for</span>&nbsp;<span class="builtinfunc" id="4417314">len</span><span class="op" id="4417317">(</span><span class="ident" id="4417318">cas</span><span class="op" id="4417321">)</span>&nbsp;<span class="op" id="4417323">&gt;</span>&nbsp;<span class="num" id="4417325">0</span>&nbsp;<span class="op" id="4417327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417331">if</span>&nbsp;<span class="builtinfunc" id="4417334">len</span><span class="op" id="4417337">(</span><span class="ident" id="4417338">cas</span><span class="op" id="4417341">)</span>&nbsp;<span class="op" id="4417343">&lt;</span>&nbsp;<span class="num" id="4417345">2</span>&nbsp;<span class="op" id="4417347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417352">return</span>&nbsp;<span class="builtintype" id="4417359">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417371">caLen</span>&nbsp;<span class="op" id="4417377">:=</span>&nbsp;<span class="builtintype" id="4417380">uint16</span><span class="op" id="4417386">(</span><span class="ident" id="4417387">cas</span><span class="op" id="4417390">[</span><span class="num" id="4417391">0</span><span class="op" id="4417392">]</span><span class="op" id="4417393">)</span><span class="op" id="4417394">&lt;&lt;</span><span class="num" id="4417396">8</span>&nbsp;<span class="op" id="4417398">|</span>&nbsp;<span class="builtintype" id="4417400">uint16</span><span class="op" id="4417406">(</span><span class="ident" id="4417407">cas</span><span class="op" id="4417410">[</span><span class="num" id="4417411">1</span><span class="op" id="4417412">]</span><span class="op" id="4417413">)</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417417">cas</span>&nbsp;<span class="op" id="4417421">=</span>&nbsp;<span class="ident" id="4417423">cas</span><span class="op" id="4417426">[</span><span class="num" id="4417427">2</span><span class="op" id="4417428">:</span><span class="op" id="4417429">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417434">if</span>&nbsp;<span class="builtinfunc" id="4417437">len</span><span class="op" id="4417440">(</span><span class="ident" id="4417441">cas</span><span class="op" id="4417444">)</span>&nbsp;<span class="op" id="4417446">&lt;</span>&nbsp;<span class="builtintype" id="4417448">int</span><span class="op" id="4417451">(</span><span class="ident" id="4417452">caLen</span><span class="op" id="4417457">)</span>&nbsp;<span class="op" id="4417459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417464">return</span>&nbsp;<span class="builtintype" id="4417471">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417479">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417484">m</span><span class="op" id="4417485">.</span><span class="ident" id="4417486">certificateAuthorities</span>&nbsp;<span class="op" id="4417509">=</span>&nbsp;<span class="builtinfunc" id="4417511">append</span><span class="op" id="4417517">(</span><span class="ident" id="4417518">m</span><span class="op" id="4417519">.</span><span class="ident" id="4417520">certificateAuthorities</span><span class="op" id="4417542">,</span>&nbsp;<span class="ident" id="4417544">cas</span><span class="op" id="4417547">[</span><span class="op" id="4417548">:</span><span class="ident" id="4417549">caLen</span><span class="op" id="4417554">]</span><span class="op" id="4417555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417559">cas</span>&nbsp;<span class="op" id="4417563">=</span>&nbsp;<span class="ident" id="4417565">cas</span><span class="op" id="4417568">[</span><span class="ident" id="4417569">caLen</span><span class="op" id="4417574">:</span><span class="op" id="4417575">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417581">if</span>&nbsp;<span class="builtinfunc" id="4417584">len</span><span class="op" id="4417587">(</span><span class="ident" id="4417588">data</span><span class="op" id="4417592">)</span>&nbsp;<span class="op" id="4417594">&gt;</span>&nbsp;<span class="num" id="4417596">0</span>&nbsp;<span class="op" id="4417598">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417602">return</span>&nbsp;<span class="builtintype" id="4417609">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417620">return</span>&nbsp;<span class="builtintype" id="4417627">true</span><br>
<span class="lineno"></span><span class="op" id="4417632">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span><span class="keyword" id="4417635">type</span>&nbsp;<span class="ident" id="4417640">certificateVerifyMsg</span>&nbsp;<span class="keyword" id="4417661">struct</span>&nbsp;<span class="op" id="4417668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417671">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417691">[</span><span class="op" id="4417692">]</span><span class="builtintype" id="4417693">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417699">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="4417719">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417725">signatureAndHash</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417745">signatureAndHash</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417763">signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417783">[</span><span class="op" id="4417784">]</span><span class="builtintype" id="4417785">byte</span><br>
<span class="lineno"></span><span class="op" id="4417790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4417793">func</span>&nbsp;<span class="op" id="4417798">(</span><span class="ident" id="4417799">m</span>&nbsp;<span class="op" id="4417801">*</span><span class="ident" id="4417802">certificateVerifyMsg</span><span class="op" id="4417822">)</span>&nbsp;<span class="ident" id="4417824">equal</span><span class="op" id="4417829">(</span><span class="ident" id="4417830">i</span>&nbsp;<span class="keyword" id="4417832">interface</span><span class="op" id="4417841">{</span><span class="op" id="4417842">}</span><span class="op" id="4417843">)</span>&nbsp;<span class="builtintype" id="4417845">bool</span>&nbsp;<span class="op" id="4417850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417853">m1</span><span class="op" id="4417855">,</span>&nbsp;<span class="ident" id="4417857">ok</span>&nbsp;<span class="op" id="4417860">:=</span>&nbsp;<span class="ident" id="4417863">i</span><span class="op" id="4417864">.</span><span class="op" id="4417865">(</span><span class="op" id="4417866">*</span><span class="ident" id="4417867">certificateVerifyMsg</span><span class="op" id="4417887">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417890">if</span>&nbsp;<span class="op" id="4417893">!</span><span class="ident" id="4417894">ok</span>&nbsp;<span class="op" id="4417897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417901">return</span>&nbsp;<span class="builtintype" id="4417908">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4417915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4417919">return</span>&nbsp;<span class="ident" id="4417926">bytes</span><span class="op" id="4417931">.</span><span class="ident" id="4417932">Equal</span><span class="op" id="4417937">(</span><span class="ident" id="4417938">m</span><span class="op" id="4417939">.</span><span class="ident" id="4417940">raw</span><span class="op" id="4417943">,</span>&nbsp;<span class="ident" id="4417945">m1</span><span class="op" id="4417947">.</span><span class="ident" id="4417948">raw</span><span class="op" id="4417951">)</span>&nbsp;<span class="op" id="4417953">&amp;&amp;</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4417958">m</span><span class="op" id="4417959">.</span><span class="ident" id="4417960">hasSignatureAndHash</span>&nbsp;<span class="op" id="4417980">==</span>&nbsp;<span class="ident" id="4417983">m1</span><span class="op" id="4417985">.</span><span class="ident" id="4417986">hasSignatureAndHash</span>&nbsp;<span class="op" id="4418006">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418011">m</span><span class="op" id="4418012">.</span><span class="ident" id="4418013">signatureAndHash</span><span class="op" id="4418029">.</span><span class="ident" id="4418030">hash</span>&nbsp;<span class="op" id="4418035">==</span>&nbsp;<span class="ident" id="4418038">m1</span><span class="op" id="4418040">.</span><span class="ident" id="4418041">signatureAndHash</span><span class="op" id="4418057">.</span><span class="ident" id="4418058">hash</span>&nbsp;<span class="op" id="4418063">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418068">m</span><span class="op" id="4418069">.</span><span class="ident" id="4418070">signatureAndHash</span><span class="op" id="4418086">.</span><span class="ident" id="4418087">signature</span>&nbsp;<span class="op" id="4418097">==</span>&nbsp;<span class="ident" id="4418100">m1</span><span class="op" id="4418102">.</span><span class="ident" id="4418103">signatureAndHash</span><span class="op" id="4418119">.</span><span class="ident" id="4418120">signature</span>&nbsp;<span class="op" id="4418130">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418135">bytes</span><span class="op" id="4418140">.</span><span class="ident" id="4418141">Equal</span><span class="op" id="4418146">(</span><span class="ident" id="4418147">m</span><span class="op" id="4418148">.</span><span class="ident" id="4418149">signature</span><span class="op" id="4418158">,</span>&nbsp;<span class="ident" id="4418160">m1</span><span class="op" id="4418162">.</span><span class="ident" id="4418163">signature</span><span class="op" id="4418172">)</span><br>
<span class="lineno"></span><span class="op" id="4418174">}</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span><span class="keyword" id="4418177">func</span>&nbsp;<span class="op" id="4418182">(</span><span class="ident" id="4418183">m</span>&nbsp;<span class="op" id="4418185">*</span><span class="ident" id="4418186">certificateVerifyMsg</span><span class="op" id="4418206">)</span>&nbsp;<span class="ident" id="4418208">marshal</span><span class="op" id="4418215">(</span><span class="op" id="4418216">)</span>&nbsp;<span class="op" id="4418218">(</span><span class="ident" id="4418219">x</span>&nbsp;<span class="op" id="4418221">[</span><span class="op" id="4418222">]</span><span class="builtintype" id="4418223">byte</span><span class="op" id="4418227">)</span>&nbsp;<span class="op" id="4418229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418232">if</span>&nbsp;<span class="ident" id="4418235">m</span><span class="op" id="4418236">.</span><span class="ident" id="4418237">raw</span>&nbsp;<span class="op" id="4418241">!=</span>&nbsp;<span class="builtintype" id="4418244">nil</span>&nbsp;<span class="op" id="4418248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418252">return</span>&nbsp;<span class="ident" id="4418259">m</span><span class="op" id="4418260">.</span><span class="ident" id="4418261">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418266">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4418270">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418327">siglength</span>&nbsp;<span class="op" id="4418337">:=</span>&nbsp;<span class="builtinfunc" id="4418340">len</span><span class="op" id="4418343">(</span><span class="ident" id="4418344">m</span><span class="op" id="4418345">.</span><span class="ident" id="4418346">signature</span><span class="op" id="4418355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418358">length</span>&nbsp;<span class="op" id="4418365">:=</span>&nbsp;<span class="num" id="4418368">2</span>&nbsp;<span class="op" id="4418370">+</span>&nbsp;<span class="ident" id="4418372">siglength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418383">if</span>&nbsp;<span class="ident" id="4418386">m</span><span class="op" id="4418387">.</span><span class="ident" id="4418388">hasSignatureAndHash</span>&nbsp;<span class="op" id="4418408">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418412">length</span>&nbsp;<span class="op" id="4418419">+=</span>&nbsp;<span class="num" id="4418422">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418428">x</span>&nbsp;<span class="op" id="4418430">=</span>&nbsp;<span class="builtinfunc" id="4418432">make</span><span class="op" id="4418436">(</span><span class="op" id="4418437">[</span><span class="op" id="4418438">]</span><span class="builtintype" id="4418439">byte</span><span class="op" id="4418443">,</span>&nbsp;<span class="num" id="4418445">4</span><span class="op" id="4418446">+</span><span class="ident" id="4418447">length</span><span class="op" id="4418453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418456">x</span><span class="op" id="4418457">[</span><span class="num" id="4418458">0</span><span class="op" id="4418459">]</span>&nbsp;<span class="op" id="4418461">=</span>&nbsp;<span class="ident" id="4418463">typeCertificateVerify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418486">x</span><span class="op" id="4418487">[</span><span class="num" id="4418488">1</span><span class="op" id="4418489">]</span>&nbsp;<span class="op" id="4418491">=</span>&nbsp;<span class="builtintype" id="4418493">uint8</span><span class="op" id="4418498">(</span><span class="ident" id="4418499">length</span>&nbsp;<span class="op" id="4418506">&gt;&gt;</span>&nbsp;<span class="num" id="4418509">16</span><span class="op" id="4418511">)</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418514">x</span><span class="op" id="4418515">[</span><span class="num" id="4418516">2</span><span class="op" id="4418517">]</span>&nbsp;<span class="op" id="4418519">=</span>&nbsp;<span class="builtintype" id="4418521">uint8</span><span class="op" id="4418526">(</span><span class="ident" id="4418527">length</span>&nbsp;<span class="op" id="4418534">&gt;&gt;</span>&nbsp;<span class="num" id="4418537">8</span><span class="op" id="4418538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418541">x</span><span class="op" id="4418542">[</span><span class="num" id="4418543">3</span><span class="op" id="4418544">]</span>&nbsp;<span class="op" id="4418546">=</span>&nbsp;<span class="builtintype" id="4418548">uint8</span><span class="op" id="4418553">(</span><span class="ident" id="4418554">length</span><span class="op" id="4418560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418563">y</span>&nbsp;<span class="op" id="4418565">:=</span>&nbsp;<span class="ident" id="4418568">x</span><span class="op" id="4418569">[</span><span class="num" id="4418570">4</span><span class="op" id="4418571">:</span><span class="op" id="4418572">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418575">if</span>&nbsp;<span class="ident" id="4418578">m</span><span class="op" id="4418579">.</span><span class="ident" id="4418580">hasSignatureAndHash</span>&nbsp;<span class="op" id="4418600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418604">y</span><span class="op" id="4418605">[</span><span class="num" id="4418606">0</span><span class="op" id="4418607">]</span>&nbsp;<span class="op" id="4418609">=</span>&nbsp;<span class="ident" id="4418611">m</span><span class="op" id="4418612">.</span><span class="ident" id="4418613">signatureAndHash</span><span class="op" id="4418629">.</span><span class="ident" id="4418630">hash</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418637">y</span><span class="op" id="4418638">[</span><span class="num" id="4418639">1</span><span class="op" id="4418640">]</span>&nbsp;<span class="op" id="4418642">=</span>&nbsp;<span class="ident" id="4418644">m</span><span class="op" id="4418645">.</span><span class="ident" id="4418646">signatureAndHash</span><span class="op" id="4418662">.</span><span class="ident" id="4418663">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418675">y</span>&nbsp;<span class="op" id="4418677">=</span>&nbsp;<span class="ident" id="4418679">y</span><span class="op" id="4418680">[</span><span class="num" id="4418681">2</span><span class="op" id="4418682">:</span><span class="op" id="4418683">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418689">y</span><span class="op" id="4418690">[</span><span class="num" id="4418691">0</span><span class="op" id="4418692">]</span>&nbsp;<span class="op" id="4418694">=</span>&nbsp;<span class="builtintype" id="4418696">uint8</span><span class="op" id="4418701">(</span><span class="ident" id="4418702">siglength</span>&nbsp;<span class="op" id="4418712">&gt;&gt;</span>&nbsp;<span class="num" id="4418715">8</span><span class="op" id="4418716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418719">y</span><span class="op" id="4418720">[</span><span class="num" id="4418721">1</span><span class="op" id="4418722">]</span>&nbsp;<span class="op" id="4418724">=</span>&nbsp;<span class="builtintype" id="4418726">uint8</span><span class="op" id="4418731">(</span><span class="ident" id="4418732">siglength</span><span class="op" id="4418741">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4418744">copy</span><span class="op" id="4418748">(</span><span class="ident" id="4418749">y</span><span class="op" id="4418750">[</span><span class="num" id="4418751">2</span><span class="op" id="4418752">:</span><span class="op" id="4418753">]</span><span class="op" id="4418754">,</span>&nbsp;<span class="ident" id="4418756">m</span><span class="op" id="4418757">.</span><span class="ident" id="4418758">signature</span><span class="op" id="4418767">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418771">m</span><span class="op" id="4418772">.</span><span class="ident" id="4418773">raw</span>&nbsp;<span class="op" id="4418777">=</span>&nbsp;<span class="ident" id="4418779">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418783">return</span><br>
<span class="lineno">1285</span><span class="op" id="4418790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4418793">func</span>&nbsp;<span class="op" id="4418798">(</span><span class="ident" id="4418799">m</span>&nbsp;<span class="op" id="4418801">*</span><span class="ident" id="4418802">certificateVerifyMsg</span><span class="op" id="4418822">)</span>&nbsp;<span class="ident" id="4418824">unmarshal</span><span class="op" id="4418833">(</span><span class="ident" id="4418834">data</span>&nbsp;<span class="op" id="4418839">[</span><span class="op" id="4418840">]</span><span class="builtintype" id="4418841">byte</span><span class="op" id="4418845">)</span>&nbsp;<span class="builtintype" id="4418847">bool</span>&nbsp;<span class="op" id="4418852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418855">m</span><span class="op" id="4418856">.</span><span class="ident" id="4418857">raw</span>&nbsp;<span class="op" id="4418861">=</span>&nbsp;<span class="ident" id="4418863">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418870">if</span>&nbsp;<span class="builtinfunc" id="4418873">len</span><span class="op" id="4418876">(</span><span class="ident" id="4418877">data</span><span class="op" id="4418881">)</span>&nbsp;<span class="op" id="4418883">&lt;</span>&nbsp;<span class="num" id="4418885">6</span>&nbsp;<span class="op" id="4418887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418891">return</span>&nbsp;<span class="builtintype" id="4418898">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4418905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4418909">length</span>&nbsp;<span class="op" id="4418916">:=</span>&nbsp;<span class="builtintype" id="4418919">uint32</span><span class="op" id="4418925">(</span><span class="ident" id="4418926">data</span><span class="op" id="4418930">[</span><span class="num" id="4418931">1</span><span class="op" id="4418932">]</span><span class="op" id="4418933">)</span><span class="op" id="4418934">&lt;&lt;</span><span class="num" id="4418936">16</span>&nbsp;<span class="op" id="4418939">|</span>&nbsp;<span class="builtintype" id="4418941">uint32</span><span class="op" id="4418947">(</span><span class="ident" id="4418948">data</span><span class="op" id="4418952">[</span><span class="num" id="4418953">2</span><span class="op" id="4418954">]</span><span class="op" id="4418955">)</span><span class="op" id="4418956">&lt;&lt;</span><span class="num" id="4418958">8</span>&nbsp;<span class="op" id="4418960">|</span>&nbsp;<span class="builtintype" id="4418962">uint32</span><span class="op" id="4418968">(</span><span class="ident" id="4418969">data</span><span class="op" id="4418973">[</span><span class="num" id="4418974">3</span><span class="op" id="4418975">]</span><span class="op" id="4418976">)</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4418979">if</span>&nbsp;<span class="builtintype" id="4418982">uint32</span><span class="op" id="4418988">(</span><span class="builtinfunc" id="4418989">len</span><span class="op" id="4418992">(</span><span class="ident" id="4418993">data</span><span class="op" id="4418997">)</span><span class="op" id="4418998">)</span><span class="op" id="4418999">-</span><span class="num" id="4419000">4</span>&nbsp;<span class="op" id="4419002">!=</span>&nbsp;<span class="ident" id="4419005">length</span>&nbsp;<span class="op" id="4419012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419016">return</span>&nbsp;<span class="builtintype" id="4419023">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419034">data</span>&nbsp;<span class="op" id="4419039">=</span>&nbsp;<span class="ident" id="4419041">data</span><span class="op" id="4419045">[</span><span class="num" id="4419046">4</span><span class="op" id="4419047">:</span><span class="op" id="4419048">]</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419051">if</span>&nbsp;<span class="ident" id="4419054">m</span><span class="op" id="4419055">.</span><span class="ident" id="4419056">hasSignatureAndHash</span>&nbsp;<span class="op" id="4419076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419080">m</span><span class="op" id="4419081">.</span><span class="ident" id="4419082">signatureAndHash</span><span class="op" id="4419098">.</span><span class="ident" id="4419099">hash</span>&nbsp;<span class="op" id="4419104">=</span>&nbsp;<span class="ident" id="4419106">data</span><span class="op" id="4419110">[</span><span class="num" id="4419111">0</span><span class="op" id="4419112">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419116">m</span><span class="op" id="4419117">.</span><span class="ident" id="4419118">signatureAndHash</span><span class="op" id="4419134">.</span><span class="ident" id="4419135">signature</span>&nbsp;<span class="op" id="4419145">=</span>&nbsp;<span class="ident" id="4419147">data</span><span class="op" id="4419151">[</span><span class="num" id="4419152">1</span><span class="op" id="4419153">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419157">data</span>&nbsp;<span class="op" id="4419162">=</span>&nbsp;<span class="ident" id="4419164">data</span><span class="op" id="4419168">[</span><span class="num" id="4419169">2</span><span class="op" id="4419170">:</span><span class="op" id="4419171">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419174">}</span><br>
<span class="lineno">1305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419178">if</span>&nbsp;<span class="builtinfunc" id="4419181">len</span><span class="op" id="4419184">(</span><span class="ident" id="4419185">data</span><span class="op" id="4419189">)</span>&nbsp;<span class="op" id="4419191">&lt;</span>&nbsp;<span class="num" id="4419193">2</span>&nbsp;<span class="op" id="4419195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419199">return</span>&nbsp;<span class="builtintype" id="4419206">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419216">siglength</span>&nbsp;<span class="op" id="4419226">:=</span>&nbsp;<span class="builtintype" id="4419229">int</span><span class="op" id="4419232">(</span><span class="ident" id="4419233">data</span><span class="op" id="4419237">[</span><span class="num" id="4419238">0</span><span class="op" id="4419239">]</span><span class="op" id="4419240">)</span><span class="op" id="4419241">&lt;&lt;</span><span class="num" id="4419243">8</span>&nbsp;<span class="op" id="4419245">+</span>&nbsp;<span class="builtintype" id="4419247">int</span><span class="op" id="4419250">(</span><span class="ident" id="4419251">data</span><span class="op" id="4419255">[</span><span class="num" id="4419256">1</span><span class="op" id="4419257">]</span><span class="op" id="4419258">)</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419261">data</span>&nbsp;<span class="op" id="4419266">=</span>&nbsp;<span class="ident" id="4419268">data</span><span class="op" id="4419272">[</span><span class="num" id="4419273">2</span><span class="op" id="4419274">:</span><span class="op" id="4419275">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419278">if</span>&nbsp;<span class="builtinfunc" id="4419281">len</span><span class="op" id="4419284">(</span><span class="ident" id="4419285">data</span><span class="op" id="4419289">)</span>&nbsp;<span class="op" id="4419291">!=</span>&nbsp;<span class="ident" id="4419294">siglength</span>&nbsp;<span class="op" id="4419304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419308">return</span>&nbsp;<span class="builtintype" id="4419315">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419326">m</span><span class="op" id="4419327">.</span><span class="ident" id="4419328">signature</span>&nbsp;<span class="op" id="4419338">=</span>&nbsp;<span class="ident" id="4419340">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419347">return</span>&nbsp;<span class="builtintype" id="4419354">true</span><br>
<span class="lineno"></span><span class="op" id="4419359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1320</span><span class="keyword" id="4419362">type</span>&nbsp;<span class="ident" id="4419367">newSessionTicketMsg</span>&nbsp;<span class="keyword" id="4419387">struct</span>&nbsp;<span class="op" id="4419394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419397">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419404">[</span><span class="op" id="4419405">]</span><span class="builtintype" id="4419406">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419412">ticket</span>&nbsp;<span class="op" id="4419419">[</span><span class="op" id="4419420">]</span><span class="builtintype" id="4419421">byte</span><br>
<span class="lineno"></span><span class="op" id="4419426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span><span class="keyword" id="4419429">func</span>&nbsp;<span class="op" id="4419434">(</span><span class="ident" id="4419435">m</span>&nbsp;<span class="op" id="4419437">*</span><span class="ident" id="4419438">newSessionTicketMsg</span><span class="op" id="4419457">)</span>&nbsp;<span class="ident" id="4419459">equal</span><span class="op" id="4419464">(</span><span class="ident" id="4419465">i</span>&nbsp;<span class="keyword" id="4419467">interface</span><span class="op" id="4419476">{</span><span class="op" id="4419477">}</span><span class="op" id="4419478">)</span>&nbsp;<span class="builtintype" id="4419480">bool</span>&nbsp;<span class="op" id="4419485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419488">m1</span><span class="op" id="4419490">,</span>&nbsp;<span class="ident" id="4419492">ok</span>&nbsp;<span class="op" id="4419495">:=</span>&nbsp;<span class="ident" id="4419498">i</span><span class="op" id="4419499">.</span><span class="op" id="4419500">(</span><span class="op" id="4419501">*</span><span class="ident" id="4419502">newSessionTicketMsg</span><span class="op" id="4419521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419524">if</span>&nbsp;<span class="op" id="4419527">!</span><span class="ident" id="4419528">ok</span>&nbsp;<span class="op" id="4419531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419535">return</span>&nbsp;<span class="builtintype" id="4419542">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419549">}</span><br>
<span class="lineno">1330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419553">return</span>&nbsp;<span class="ident" id="4419560">bytes</span><span class="op" id="4419565">.</span><span class="ident" id="4419566">Equal</span><span class="op" id="4419571">(</span><span class="ident" id="4419572">m</span><span class="op" id="4419573">.</span><span class="ident" id="4419574">raw</span><span class="op" id="4419577">,</span>&nbsp;<span class="ident" id="4419579">m1</span><span class="op" id="4419581">.</span><span class="ident" id="4419582">raw</span><span class="op" id="4419585">)</span>&nbsp;<span class="op" id="4419587">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419592">bytes</span><span class="op" id="4419597">.</span><span class="ident" id="4419598">Equal</span><span class="op" id="4419603">(</span><span class="ident" id="4419604">m</span><span class="op" id="4419605">.</span><span class="ident" id="4419606">ticket</span><span class="op" id="4419612">,</span>&nbsp;<span class="ident" id="4419614">m1</span><span class="op" id="4419616">.</span><span class="ident" id="4419617">ticket</span><span class="op" id="4419623">)</span><br>
<span class="lineno"></span><span class="op" id="4419625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="keyword" id="4419628">func</span>&nbsp;<span class="op" id="4419633">(</span><span class="ident" id="4419634">m</span>&nbsp;<span class="op" id="4419636">*</span><span class="ident" id="4419637">newSessionTicketMsg</span><span class="op" id="4419656">)</span>&nbsp;<span class="ident" id="4419658">marshal</span><span class="op" id="4419665">(</span><span class="op" id="4419666">)</span>&nbsp;<span class="op" id="4419668">(</span><span class="ident" id="4419669">x</span>&nbsp;<span class="op" id="4419671">[</span><span class="op" id="4419672">]</span><span class="builtintype" id="4419673">byte</span><span class="op" id="4419677">)</span>&nbsp;<span class="op" id="4419679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419682">if</span>&nbsp;<span class="ident" id="4419685">m</span><span class="op" id="4419686">.</span><span class="ident" id="4419687">raw</span>&nbsp;<span class="op" id="4419691">!=</span>&nbsp;<span class="builtintype" id="4419694">nil</span>&nbsp;<span class="op" id="4419698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4419702">return</span>&nbsp;<span class="ident" id="4419709">m</span><span class="op" id="4419710">.</span><span class="ident" id="4419711">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4419716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4419720">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5077#section-3.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419775">ticketLen</span>&nbsp;<span class="op" id="4419785">:=</span>&nbsp;<span class="builtinfunc" id="4419788">len</span><span class="op" id="4419791">(</span><span class="ident" id="4419792">m</span><span class="op" id="4419793">.</span><span class="ident" id="4419794">ticket</span><span class="op" id="4419800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419803">length</span>&nbsp;<span class="op" id="4419810">:=</span>&nbsp;<span class="num" id="4419813">2</span>&nbsp;<span class="op" id="4419815">+</span>&nbsp;<span class="num" id="4419817">4</span>&nbsp;<span class="op" id="4419819">+</span>&nbsp;<span class="ident" id="4419821">ticketLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419832">x</span>&nbsp;<span class="op" id="4419834">=</span>&nbsp;<span class="builtinfunc" id="4419836">make</span><span class="op" id="4419840">(</span><span class="op" id="4419841">[</span><span class="op" id="4419842">]</span><span class="builtintype" id="4419843">byte</span><span class="op" id="4419847">,</span>&nbsp;<span class="num" id="4419849">4</span><span class="op" id="4419850">+</span><span class="ident" id="4419851">length</span><span class="op" id="4419857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419860">x</span><span class="op" id="4419861">[</span><span class="num" id="4419862">0</span><span class="op" id="4419863">]</span>&nbsp;<span class="op" id="4419865">=</span>&nbsp;<span class="ident" id="4419867">typeNewSessionTicket</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419889">x</span><span class="op" id="4419890">[</span><span class="num" id="4419891">1</span><span class="op" id="4419892">]</span>&nbsp;<span class="op" id="4419894">=</span>&nbsp;<span class="builtintype" id="4419896">uint8</span><span class="op" id="4419901">(</span><span class="ident" id="4419902">length</span>&nbsp;<span class="op" id="4419909">&gt;&gt;</span>&nbsp;<span class="num" id="4419912">16</span><span class="op" id="4419914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419917">x</span><span class="op" id="4419918">[</span><span class="num" id="4419919">2</span><span class="op" id="4419920">]</span>&nbsp;<span class="op" id="4419922">=</span>&nbsp;<span class="builtintype" id="4419924">uint8</span><span class="op" id="4419929">(</span><span class="ident" id="4419930">length</span>&nbsp;<span class="op" id="4419937">&gt;&gt;</span>&nbsp;<span class="num" id="4419940">8</span><span class="op" id="4419941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419944">x</span><span class="op" id="4419945">[</span><span class="num" id="4419946">3</span><span class="op" id="4419947">]</span>&nbsp;<span class="op" id="4419949">=</span>&nbsp;<span class="builtintype" id="4419951">uint8</span><span class="op" id="4419956">(</span><span class="ident" id="4419957">length</span><span class="op" id="4419963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419966">x</span><span class="op" id="4419967">[</span><span class="num" id="4419968">8</span><span class="op" id="4419969">]</span>&nbsp;<span class="op" id="4419971">=</span>&nbsp;<span class="builtintype" id="4419973">uint8</span><span class="op" id="4419978">(</span><span class="ident" id="4419979">ticketLen</span>&nbsp;<span class="op" id="4419989">&gt;&gt;</span>&nbsp;<span class="num" id="4419992">8</span><span class="op" id="4419993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4419996">x</span><span class="op" id="4419997">[</span><span class="num" id="4419998">9</span><span class="op" id="4419999">]</span>&nbsp;<span class="op" id="4420001">=</span>&nbsp;<span class="builtintype" id="4420003">uint8</span><span class="op" id="4420008">(</span><span class="ident" id="4420009">ticketLen</span><span class="op" id="4420018">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4420021">copy</span><span class="op" id="4420025">(</span><span class="ident" id="4420026">x</span><span class="op" id="4420027">[</span><span class="num" id="4420028">10</span><span class="op" id="4420030">:</span><span class="op" id="4420031">]</span><span class="op" id="4420032">,</span>&nbsp;<span class="ident" id="4420034">m</span><span class="op" id="4420035">.</span><span class="ident" id="4420036">ticket</span><span class="op" id="4420042">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420046">m</span><span class="op" id="4420047">.</span><span class="ident" id="4420048">raw</span>&nbsp;<span class="op" id="4420052">=</span>&nbsp;<span class="ident" id="4420054">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420058">return</span><br>
<span class="lineno">1355</span><span class="op" id="4420065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4420068">func</span>&nbsp;<span class="op" id="4420073">(</span><span class="ident" id="4420074">m</span>&nbsp;<span class="op" id="4420076">*</span><span class="ident" id="4420077">newSessionTicketMsg</span><span class="op" id="4420096">)</span>&nbsp;<span class="ident" id="4420098">unmarshal</span><span class="op" id="4420107">(</span><span class="ident" id="4420108">data</span>&nbsp;<span class="op" id="4420113">[</span><span class="op" id="4420114">]</span><span class="builtintype" id="4420115">byte</span><span class="op" id="4420119">)</span>&nbsp;<span class="builtintype" id="4420121">bool</span>&nbsp;<span class="op" id="4420126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420129">m</span><span class="op" id="4420130">.</span><span class="ident" id="4420131">raw</span>&nbsp;<span class="op" id="4420135">=</span>&nbsp;<span class="ident" id="4420137">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420144">if</span>&nbsp;<span class="builtinfunc" id="4420147">len</span><span class="op" id="4420150">(</span><span class="ident" id="4420151">data</span><span class="op" id="4420155">)</span>&nbsp;<span class="op" id="4420157">&lt;</span>&nbsp;<span class="num" id="4420159">10</span>&nbsp;<span class="op" id="4420162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420166">return</span>&nbsp;<span class="builtintype" id="4420173">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420184">length</span>&nbsp;<span class="op" id="4420191">:=</span>&nbsp;<span class="builtintype" id="4420194">uint32</span><span class="op" id="4420200">(</span><span class="ident" id="4420201">data</span><span class="op" id="4420205">[</span><span class="num" id="4420206">1</span><span class="op" id="4420207">]</span><span class="op" id="4420208">)</span><span class="op" id="4420209">&lt;&lt;</span><span class="num" id="4420211">16</span>&nbsp;<span class="op" id="4420214">|</span>&nbsp;<span class="builtintype" id="4420216">uint32</span><span class="op" id="4420222">(</span><span class="ident" id="4420223">data</span><span class="op" id="4420227">[</span><span class="num" id="4420228">2</span><span class="op" id="4420229">]</span><span class="op" id="4420230">)</span><span class="op" id="4420231">&lt;&lt;</span><span class="num" id="4420233">8</span>&nbsp;<span class="op" id="4420235">|</span>&nbsp;<span class="builtintype" id="4420237">uint32</span><span class="op" id="4420243">(</span><span class="ident" id="4420244">data</span><span class="op" id="4420248">[</span><span class="num" id="4420249">3</span><span class="op" id="4420250">]</span><span class="op" id="4420251">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420254">if</span>&nbsp;<span class="builtintype" id="4420257">uint32</span><span class="op" id="4420263">(</span><span class="builtinfunc" id="4420264">len</span><span class="op" id="4420267">(</span><span class="ident" id="4420268">data</span><span class="op" id="4420272">)</span><span class="op" id="4420273">)</span><span class="op" id="4420274">-</span><span class="num" id="4420275">4</span>&nbsp;<span class="op" id="4420277">!=</span>&nbsp;<span class="ident" id="4420280">length</span>&nbsp;<span class="op" id="4420287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420291">return</span>&nbsp;<span class="builtintype" id="4420298">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420309">ticketLen</span>&nbsp;<span class="op" id="4420319">:=</span>&nbsp;<span class="builtintype" id="4420322">int</span><span class="op" id="4420325">(</span><span class="ident" id="4420326">data</span><span class="op" id="4420330">[</span><span class="num" id="4420331">8</span><span class="op" id="4420332">]</span><span class="op" id="4420333">)</span><span class="op" id="4420334">&lt;&lt;</span><span class="num" id="4420336">8</span>&nbsp;<span class="op" id="4420338">+</span>&nbsp;<span class="builtintype" id="4420340">int</span><span class="op" id="4420343">(</span><span class="ident" id="4420344">data</span><span class="op" id="4420348">[</span><span class="num" id="4420349">9</span><span class="op" id="4420350">]</span><span class="op" id="4420351">)</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420354">if</span>&nbsp;<span class="builtinfunc" id="4420357">len</span><span class="op" id="4420360">(</span><span class="ident" id="4420361">data</span><span class="op" id="4420365">)</span><span class="op" id="4420366">-</span><span class="num" id="4420367">10</span>&nbsp;<span class="op" id="4420370">!=</span>&nbsp;<span class="ident" id="4420373">ticketLen</span>&nbsp;<span class="op" id="4420383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420387">return</span>&nbsp;<span class="builtintype" id="4420394">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4420405">m</span><span class="op" id="4420406">.</span><span class="ident" id="4420407">ticket</span>&nbsp;<span class="op" id="4420414">=</span>&nbsp;<span class="ident" id="4420416">data</span><span class="op" id="4420420">[</span><span class="num" id="4420421">10</span><span class="op" id="4420423">:</span><span class="op" id="4420424">]</span><br>
<span class="lineno">1375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420428">return</span>&nbsp;<span class="builtintype" id="4420435">true</span><br>
<span class="lineno"></span><span class="op" id="4420440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4420443">func</span>&nbsp;<span class="ident" id="4420448">eqUint16s</span><span class="op" id="4420457">(</span><span class="ident" id="4420458">x</span><span class="op" id="4420459">,</span>&nbsp;<span class="ident" id="4420461">y</span>&nbsp;<span class="op" id="4420463">[</span><span class="op" id="4420464">]</span><span class="builtintype" id="4420465">uint16</span><span class="op" id="4420471">)</span>&nbsp;<span class="builtintype" id="4420473">bool</span>&nbsp;<span class="op" id="4420478">{</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420481">if</span>&nbsp;<span class="builtinfunc" id="4420484">len</span><span class="op" id="4420487">(</span><span class="ident" id="4420488">x</span><span class="op" id="4420489">)</span>&nbsp;<span class="op" id="4420491">!=</span>&nbsp;<span class="builtinfunc" id="4420494">len</span><span class="op" id="4420497">(</span><span class="ident" id="4420498">y</span><span class="op" id="4420499">)</span>&nbsp;<span class="op" id="4420501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420505">return</span>&nbsp;<span class="builtintype" id="4420512">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420522">for</span>&nbsp;<span class="ident" id="4420526">i</span><span class="op" id="4420527">,</span>&nbsp;<span class="ident" id="4420529">v</span>&nbsp;<span class="op" id="4420531">:=</span>&nbsp;<span class="keyword" id="4420534">range</span>&nbsp;<span class="ident" id="4420540">x</span>&nbsp;<span class="op" id="4420542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420546">if</span>&nbsp;<span class="ident" id="4420549">y</span><span class="op" id="4420550">[</span><span class="ident" id="4420551">i</span><span class="op" id="4420552">]</span>&nbsp;<span class="op" id="4420554">!=</span>&nbsp;<span class="ident" id="4420557">v</span>&nbsp;<span class="op" id="4420559">{</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420564">return</span>&nbsp;<span class="builtintype" id="4420571">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420585">return</span>&nbsp;<span class="builtintype" id="4420592">true</span><br>
<span class="lineno"></span><span class="op" id="4420597">}</span><br>
<span class="lineno">1390</span><br>
<span class="lineno"></span><span class="keyword" id="4420600">func</span>&nbsp;<span class="ident" id="4420605">eqCurveIDs</span><span class="op" id="4420615">(</span><span class="ident" id="4420616">x</span><span class="op" id="4420617">,</span>&nbsp;<span class="ident" id="4420619">y</span>&nbsp;<span class="op" id="4420621">[</span><span class="op" id="4420622">]</span><span class="ident" id="4420623">CurveID</span><span class="op" id="4420630">)</span>&nbsp;<span class="builtintype" id="4420632">bool</span>&nbsp;<span class="op" id="4420637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420640">if</span>&nbsp;<span class="builtinfunc" id="4420643">len</span><span class="op" id="4420646">(</span><span class="ident" id="4420647">x</span><span class="op" id="4420648">)</span>&nbsp;<span class="op" id="4420650">!=</span>&nbsp;<span class="builtinfunc" id="4420653">len</span><span class="op" id="4420656">(</span><span class="ident" id="4420657">y</span><span class="op" id="4420658">)</span>&nbsp;<span class="op" id="4420660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420664">return</span>&nbsp;<span class="builtintype" id="4420671">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420678">}</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420681">for</span>&nbsp;<span class="ident" id="4420685">i</span><span class="op" id="4420686">,</span>&nbsp;<span class="ident" id="4420688">v</span>&nbsp;<span class="op" id="4420690">:=</span>&nbsp;<span class="keyword" id="4420693">range</span>&nbsp;<span class="ident" id="4420699">x</span>&nbsp;<span class="op" id="4420701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420705">if</span>&nbsp;<span class="ident" id="4420708">y</span><span class="op" id="4420709">[</span><span class="ident" id="4420710">i</span><span class="op" id="4420711">]</span>&nbsp;<span class="op" id="4420713">!=</span>&nbsp;<span class="ident" id="4420716">v</span>&nbsp;<span class="op" id="4420718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420723">return</span>&nbsp;<span class="builtintype" id="4420730">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420741">}</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420744">return</span>&nbsp;<span class="builtintype" id="4420751">true</span><br>
<span class="lineno"></span><span class="op" id="4420756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4420759">func</span>&nbsp;<span class="ident" id="4420764">eqStrings</span><span class="op" id="4420773">(</span><span class="ident" id="4420774">x</span><span class="op" id="4420775">,</span>&nbsp;<span class="ident" id="4420777">y</span>&nbsp;<span class="op" id="4420779">[</span><span class="op" id="4420780">]</span><span class="builtintype" id="4420781">string</span><span class="op" id="4420787">)</span>&nbsp;<span class="builtintype" id="4420789">bool</span>&nbsp;<span class="op" id="4420794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420797">if</span>&nbsp;<span class="builtinfunc" id="4420800">len</span><span class="op" id="4420803">(</span><span class="ident" id="4420804">x</span><span class="op" id="4420805">)</span>&nbsp;<span class="op" id="4420807">!=</span>&nbsp;<span class="builtinfunc" id="4420810">len</span><span class="op" id="4420813">(</span><span class="ident" id="4420814">y</span><span class="op" id="4420815">)</span>&nbsp;<span class="op" id="4420817">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420821">return</span>&nbsp;<span class="builtintype" id="4420828">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420838">for</span>&nbsp;<span class="ident" id="4420842">i</span><span class="op" id="4420843">,</span>&nbsp;<span class="ident" id="4420845">v</span>&nbsp;<span class="op" id="4420847">:=</span>&nbsp;<span class="keyword" id="4420850">range</span>&nbsp;<span class="ident" id="4420856">x</span>&nbsp;<span class="op" id="4420858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420862">if</span>&nbsp;<span class="ident" id="4420865">y</span><span class="op" id="4420866">[</span><span class="ident" id="4420867">i</span><span class="op" id="4420868">]</span>&nbsp;<span class="op" id="4420870">!=</span>&nbsp;<span class="ident" id="4420873">v</span>&nbsp;<span class="op" id="4420875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420880">return</span>&nbsp;<span class="builtintype" id="4420887">false</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420901">return</span>&nbsp;<span class="builtintype" id="4420908">true</span><br>
<span class="lineno"></span><span class="op" id="4420913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1415</span><span class="keyword" id="4420916">func</span>&nbsp;<span class="ident" id="4420921">eqByteSlices</span><span class="op" id="4420933">(</span><span class="ident" id="4420934">x</span><span class="op" id="4420935">,</span>&nbsp;<span class="ident" id="4420937">y</span>&nbsp;<span class="op" id="4420939">[</span><span class="op" id="4420940">]</span><span class="op" id="4420941">[</span><span class="op" id="4420942">]</span><span class="builtintype" id="4420943">byte</span><span class="op" id="4420947">)</span>&nbsp;<span class="builtintype" id="4420949">bool</span>&nbsp;<span class="op" id="4420954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420957">if</span>&nbsp;<span class="builtinfunc" id="4420960">len</span><span class="op" id="4420963">(</span><span class="ident" id="4420964">x</span><span class="op" id="4420965">)</span>&nbsp;<span class="op" id="4420967">!=</span>&nbsp;<span class="builtinfunc" id="4420970">len</span><span class="op" id="4420973">(</span><span class="ident" id="4420974">y</span><span class="op" id="4420975">)</span>&nbsp;<span class="op" id="4420977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420981">return</span>&nbsp;<span class="builtintype" id="4420988">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4420995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4420998">for</span>&nbsp;<span class="ident" id="4421002">i</span><span class="op" id="4421003">,</span>&nbsp;<span class="ident" id="4421005">v</span>&nbsp;<span class="op" id="4421007">:=</span>&nbsp;<span class="keyword" id="4421010">range</span>&nbsp;<span class="ident" id="4421016">x</span>&nbsp;<span class="op" id="4421018">{</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421022">if</span>&nbsp;<span class="op" id="4421025">!</span><span class="ident" id="4421026">bytes</span><span class="op" id="4421031">.</span><span class="ident" id="4421032">Equal</span><span class="op" id="4421037">(</span><span class="ident" id="4421038">v</span><span class="op" id="4421039">,</span>&nbsp;<span class="ident" id="4421041">y</span><span class="op" id="4421042">[</span><span class="ident" id="4421043">i</span><span class="op" id="4421044">]</span><span class="op" id="4421045">)</span>&nbsp;<span class="op" id="4421047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421052">return</span>&nbsp;<span class="builtintype" id="4421059">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4421067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4421070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421073">return</span>&nbsp;<span class="builtintype" id="4421080">true</span><br>
<span class="lineno">1425</span><span class="op" id="4421085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4421088">func</span>&nbsp;<span class="ident" id="4421093">eqSignatureAndHashes</span><span class="op" id="4421113">(</span><span class="ident" id="4421114">x</span><span class="op" id="4421115">,</span>&nbsp;<span class="ident" id="4421117">y</span>&nbsp;<span class="op" id="4421119">[</span><span class="op" id="4421120">]</span><span class="ident" id="4421121">signatureAndHash</span><span class="op" id="4421137">)</span>&nbsp;<span class="builtintype" id="4421139">bool</span>&nbsp;<span class="op" id="4421144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421147">if</span>&nbsp;<span class="builtinfunc" id="4421150">len</span><span class="op" id="4421153">(</span><span class="ident" id="4421154">x</span><span class="op" id="4421155">)</span>&nbsp;<span class="op" id="4421157">!=</span>&nbsp;<span class="builtinfunc" id="4421160">len</span><span class="op" id="4421163">(</span><span class="ident" id="4421164">y</span><span class="op" id="4421165">)</span>&nbsp;<span class="op" id="4421167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421171">return</span>&nbsp;<span class="builtintype" id="4421178">false</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4421185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421188">for</span>&nbsp;<span class="ident" id="4421192">i</span><span class="op" id="4421193">,</span>&nbsp;<span class="ident" id="4421195">v</span>&nbsp;<span class="op" id="4421197">:=</span>&nbsp;<span class="keyword" id="4421200">range</span>&nbsp;<span class="ident" id="4421206">x</span>&nbsp;<span class="op" id="4421208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4421212">v2</span>&nbsp;<span class="op" id="4421215">:=</span>&nbsp;<span class="ident" id="4421218">y</span><span class="op" id="4421219">[</span><span class="ident" id="4421220">i</span><span class="op" id="4421221">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421225">if</span>&nbsp;<span class="ident" id="4421228">v</span><span class="op" id="4421229">.</span><span class="ident" id="4421230">hash</span>&nbsp;<span class="op" id="4421235">!=</span>&nbsp;<span class="ident" id="4421238">v2</span><span class="op" id="4421240">.</span><span class="ident" id="4421241">hash</span>&nbsp;<span class="op" id="4421246">||</span>&nbsp;<span class="ident" id="4421249">v</span><span class="op" id="4421250">.</span><span class="ident" id="4421251">signature</span>&nbsp;<span class="op" id="4421261">!=</span>&nbsp;<span class="ident" id="4421264">v2</span><span class="op" id="4421266">.</span><span class="ident" id="4421267">signature</span>&nbsp;<span class="op" id="4421277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421282">return</span>&nbsp;<span class="builtintype" id="4421289">false</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4421297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4421300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4421303">return</span>&nbsp;<span class="builtintype" id="4421310">true</span><br>
<span class="lineno"></span><span class="op" id="4421315">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
