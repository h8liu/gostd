<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html" class="current">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2329623">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2329678">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2329732">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2329783">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2329853">package</span>&nbsp;<span class="ident" id="2329861">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2329867">import</span>&nbsp;<span class="op" id="2329874">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2329877">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2329886">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2329892">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="2329902">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="2329905">var</span>&nbsp;<span class="ident" id="2329909">typeFiles</span>&nbsp;<span class="op" id="2329919">=</span>&nbsp;<span class="op" id="2329921">[</span><span class="op" id="2329922">]</span><span class="builtintype" id="2329923">string</span><span class="op" id="2329929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2329932">&#34;/etc/mime.types&#34;</span><span class="op" id="2329949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2329952">&#34;/etc/apache2/mime.types&#34;</span><span class="op" id="2329977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2329980">&#34;/etc/apache/mime.types&#34;</span><span class="op" id="2330004">,</span><br>
<span class="lineno"></span><span class="op" id="2330006">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2330009">func</span>&nbsp;<span class="ident" id="2330014">loadMimeFile</span><span class="op" id="2330026">(</span><span class="ident" id="2330027">filename</span>&nbsp;<span class="builtintype" id="2330036">string</span><span class="op" id="2330042">)</span>&nbsp;<span class="op" id="2330044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2330047">f</span><span class="op" id="2330048">,</span>&nbsp;<span class="ident" id="2330050">err</span>&nbsp;<span class="op" id="2330054">:=</span>&nbsp;<span class="ident" id="2330057">os</span><span class="op" id="2330059">.</span><span class="ident" id="2330060">Open</span><span class="op" id="2330064">(</span><span class="ident" id="2330065">filename</span><span class="op" id="2330073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2330076">if</span>&nbsp;<span class="ident" id="2330079">err</span>&nbsp;<span class="op" id="2330083">!=</span>&nbsp;<span class="builtintype" id="2330086">nil</span>&nbsp;<span class="op" id="2330090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2330094">return</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2330102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2330105">defer</span>&nbsp;<span class="ident" id="2330111">f</span><span class="op" id="2330112">.</span><span class="ident" id="2330113">Close</span><span class="op" id="2330118">(</span><span class="op" id="2330119">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2330123">scanner</span>&nbsp;<span class="op" id="2330131">:=</span>&nbsp;<span class="ident" id="2330134">bufio</span><span class="op" id="2330139">.</span><span class="ident" id="2330140">NewScanner</span><span class="op" id="2330150">(</span><span class="ident" id="2330151">f</span><span class="op" id="2330152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2330155">for</span>&nbsp;<span class="ident" id="2330159">scanner</span><span class="op" id="2330166">.</span><span class="ident" id="2330167">Scan</span><span class="op" id="2330171">(</span><span class="op" id="2330172">)</span>&nbsp;<span class="op" id="2330174">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2330178">fields</span>&nbsp;<span class="op" id="2330185">:=</span>&nbsp;<span class="ident" id="2330188">strings</span><span class="op" id="2330195">.</span><span class="ident" id="2330196">Fields</span><span class="op" id="2330202">(</span><span class="ident" id="2330203">scanner</span><span class="op" id="2330210">.</span><span class="ident" id="2330211">Text</span><span class="op" id="2330215">(</span><span class="op" id="2330216">)</span><span class="op" id="2330217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2330221">if</span>&nbsp;<span class="builtinfunc" id="2330224">len</span><span class="op" id="2330227">(</span><span class="ident" id="2330228">fields</span><span class="op" id="2330234">)</span>&nbsp;<span class="op" id="2330236">&lt;=</span>&nbsp;<span class="num" id="2330239">1</span>&nbsp;<span class="op" id="2330241">||</span>&nbsp;<span class="ident" id="2330244">fields</span><span class="op" id="2330250">[</span><span class="num" id="2330251">0</span><span class="op" id="2330252">]</span><span class="op" id="2330253">[</span><span class="num" id="2330254">0</span><span class="op" id="2330255">]</span>&nbsp;<span class="op" id="2330257">==</span>&nbsp;<span class="string" id="2330260">&#39;#&#39;</span>&nbsp;<span class="op" id="2330264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2330269">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2330280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2330284">mimeType</span>&nbsp;<span class="op" id="2330293">:=</span>&nbsp;<span class="ident" id="2330296">fields</span><span class="op" id="2330302">[</span><span class="num" id="2330303">0</span><span class="op" id="2330304">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2330308">for</span>&nbsp;<span class="ident" id="2330312">_</span><span class="op" id="2330313">,</span>&nbsp;<span class="ident" id="2330315">ext</span>&nbsp;<span class="op" id="2330319">:=</span>&nbsp;<span class="keyword" id="2330322">range</span>&nbsp;<span class="ident" id="2330328">fields</span><span class="op" id="2330334">[</span><span class="num" id="2330335">1</span><span class="op" id="2330336">:</span><span class="op" id="2330337">]</span>&nbsp;<span class="op" id="2330339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2330344">if</span>&nbsp;<span class="ident" id="2330347">ext</span><span class="op" id="2330350">[</span><span class="num" id="2330351">0</span><span class="op" id="2330352">]</span>&nbsp;<span class="op" id="2330354">==</span>&nbsp;<span class="string" id="2330357">&#39;#&#39;</span>&nbsp;<span class="op" id="2330361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2330367">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2330376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2330381">setExtensionType</span><span class="op" id="2330397">(</span><span class="string" id="2330398">&#34;.&#34;</span><span class="op" id="2330401">+</span><span class="ident" id="2330402">ext</span><span class="op" id="2330405">,</span>&nbsp;<span class="ident" id="2330407">mimeType</span><span class="op" id="2330415">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2330419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2330422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2330425">if</span>&nbsp;<span class="ident" id="2330428">err</span>&nbsp;<span class="op" id="2330432">:=</span>&nbsp;<span class="ident" id="2330435">scanner</span><span class="op" id="2330442">.</span><span class="ident" id="2330443">Err</span><span class="op" id="2330446">(</span><span class="op" id="2330447">)</span><span class="op" id="2330448">;</span>&nbsp;<span class="ident" id="2330450">err</span>&nbsp;<span class="op" id="2330454">!=</span>&nbsp;<span class="builtintype" id="2330457">nil</span>&nbsp;<span class="op" id="2330461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2330465">panic</span><span class="op" id="2330470">(</span><span class="ident" id="2330471">err</span><span class="op" id="2330474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2330477">}</span><br>
<span class="lineno">45</span><span class="op" id="2330479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2330482">func</span>&nbsp;<span class="ident" id="2330487">initMime</span><span class="op" id="2330495">(</span><span class="op" id="2330496">)</span>&nbsp;<span class="op" id="2330498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2330501">for</span>&nbsp;<span class="ident" id="2330505">_</span><span class="op" id="2330506">,</span>&nbsp;<span class="ident" id="2330508">filename</span>&nbsp;<span class="op" id="2330517">:=</span>&nbsp;<span class="keyword" id="2330520">range</span>&nbsp;<span class="ident" id="2330526">typeFiles</span>&nbsp;<span class="op" id="2330536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2330540">loadMimeFile</span><span class="op" id="2330552">(</span><span class="ident" id="2330553">filename</span><span class="op" id="2330561">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2330564">}</span><br>
<span class="lineno"></span><span class="op" id="2330566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2330569">func</span>&nbsp;<span class="ident" id="2330574">initMimeForTests</span><span class="op" id="2330590">(</span><span class="op" id="2330591">)</span>&nbsp;<span class="keyword" id="2330593">map</span><span class="op" id="2330596">[</span><span class="builtintype" id="2330597">string</span><span class="op" id="2330603">]</span><span class="builtintype" id="2330604">string</span>&nbsp;<span class="op" id="2330611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2330614">typeFiles</span>&nbsp;<span class="op" id="2330624">=</span>&nbsp;<span class="op" id="2330626">[</span><span class="op" id="2330627">]</span><span class="builtintype" id="2330628">string</span><span class="op" id="2330634">{</span><span class="string" id="2330635">&#34;testdata/test.types&#34;</span><span class="op" id="2330656">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2330659">return</span>&nbsp;<span class="keyword" id="2330666">map</span><span class="op" id="2330669">[</span><span class="builtintype" id="2330670">string</span><span class="op" id="2330676">]</span><span class="builtintype" id="2330677">string</span><span class="op" id="2330683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2330687">&#34;.T1&#34;</span><span class="op" id="2330692">:</span>&nbsp;&nbsp;<span class="string" id="2330695">&#34;application/test&#34;</span><span class="op" id="2330713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2330717">&#34;.t2&#34;</span><span class="op" id="2330722">:</span>&nbsp;&nbsp;<span class="string" id="2330725">&#34;text/test;&nbsp;charset=utf-8&#34;</span><span class="op" id="2330751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2330755">&#34;.png&#34;</span><span class="op" id="2330761">:</span>&nbsp;<span class="string" id="2330763">&#34;image/png&#34;</span><span class="op" id="2330774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2330777">}</span><br>
<span class="lineno">60</span><span class="op" id="2330779">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
