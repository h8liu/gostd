<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image/png</h2>
<ul>
<li><a href="/gostd/image/png/paeth.go.html">paeth.go</a></li>
<li><a href="/gostd/image/png/paeth_test.go.html">paeth_test.go</a></li>
<li><a href="/gostd/image/png/reader.go.html">reader.go</a></li>
<li><a href="/gostd/image/png/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/image/png/writer.go.html">writer.go</a></li>
<li><a href="/gostd/image/png/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8471151">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8471206">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8471260">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8471311">package</span>&nbsp;<span class="ident" id="8471319">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8471324">import</span>&nbsp;<span class="op" id="8471331">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8471334">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8471343">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8471350">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8471359">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8471374">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8471387">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8471397">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8471400">func</span>&nbsp;<span class="ident" id="8471405">diff</span><span class="op" id="8471409">(</span><span class="ident" id="8471410">m0</span><span class="op" id="8471412">,</span>&nbsp;<span class="ident" id="8471414">m1</span>&nbsp;<span class="ident" id="8471417">image</span><span class="op" id="8471422">.</span><span class="ident" id="8471423">Image</span><span class="op" id="8471428">)</span>&nbsp;<span class="builtintype" id="8471430">error</span>&nbsp;<span class="op" id="8471436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471439">b0</span><span class="op" id="8471441">,</span>&nbsp;<span class="ident" id="8471443">b1</span>&nbsp;<span class="op" id="8471446">:=</span>&nbsp;<span class="ident" id="8471449">m0</span><span class="op" id="8471451">.</span><span class="ident" id="8471452">Bounds</span><span class="op" id="8471458">(</span><span class="op" id="8471459">)</span><span class="op" id="8471460">,</span>&nbsp;<span class="ident" id="8471462">m1</span><span class="op" id="8471464">.</span><span class="ident" id="8471465">Bounds</span><span class="op" id="8471471">(</span><span class="op" id="8471472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471475">if</span>&nbsp;<span class="op" id="8471478">!</span><span class="ident" id="8471479">b0</span><span class="op" id="8471481">.</span><span class="ident" id="8471482">Size</span><span class="op" id="8471486">(</span><span class="op" id="8471487">)</span><span class="op" id="8471488">.</span><span class="ident" id="8471489">Eq</span><span class="op" id="8471491">(</span><span class="ident" id="8471492">b1</span><span class="op" id="8471494">.</span><span class="ident" id="8471495">Size</span><span class="op" id="8471499">(</span><span class="op" id="8471500">)</span><span class="op" id="8471501">)</span>&nbsp;<span class="op" id="8471503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471507">return</span>&nbsp;<span class="ident" id="8471514">fmt</span><span class="op" id="8471517">.</span><span class="ident" id="8471518">Errorf</span><span class="op" id="8471524">(</span><span class="string" id="8471525">&#34;dimensions&nbsp;differ:&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="8471554">,</span>&nbsp;<span class="ident" id="8471556">b0</span><span class="op" id="8471558">,</span>&nbsp;<span class="ident" id="8471560">b1</span><span class="op" id="8471562">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8471565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471568">dx</span>&nbsp;<span class="op" id="8471571">:=</span>&nbsp;<span class="ident" id="8471574">b1</span><span class="op" id="8471576">.</span><span class="ident" id="8471577">Min</span><span class="op" id="8471580">.</span><span class="ident" id="8471581">X</span>&nbsp;<span class="op" id="8471583">-</span>&nbsp;<span class="ident" id="8471585">b0</span><span class="op" id="8471587">.</span><span class="ident" id="8471588">Min</span><span class="op" id="8471591">.</span><span class="ident" id="8471592">X</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471595">dy</span>&nbsp;<span class="op" id="8471598">:=</span>&nbsp;<span class="ident" id="8471601">b1</span><span class="op" id="8471603">.</span><span class="ident" id="8471604">Min</span><span class="op" id="8471607">.</span><span class="ident" id="8471608">Y</span>&nbsp;<span class="op" id="8471610">-</span>&nbsp;<span class="ident" id="8471612">b0</span><span class="op" id="8471614">.</span><span class="ident" id="8471615">Min</span><span class="op" id="8471618">.</span><span class="ident" id="8471619">Y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471622">for</span>&nbsp;<span class="ident" id="8471626">y</span>&nbsp;<span class="op" id="8471628">:=</span>&nbsp;<span class="ident" id="8471631">b0</span><span class="op" id="8471633">.</span><span class="ident" id="8471634">Min</span><span class="op" id="8471637">.</span><span class="ident" id="8471638">Y</span><span class="op" id="8471639">;</span>&nbsp;<span class="ident" id="8471641">y</span>&nbsp;<span class="op" id="8471643">&lt;</span>&nbsp;<span class="ident" id="8471645">b0</span><span class="op" id="8471647">.</span><span class="ident" id="8471648">Max</span><span class="op" id="8471651">.</span><span class="ident" id="8471652">Y</span><span class="op" id="8471653">;</span>&nbsp;<span class="ident" id="8471655">y</span><span class="op" id="8471656">++</span>&nbsp;<span class="op" id="8471659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471663">for</span>&nbsp;<span class="ident" id="8471667">x</span>&nbsp;<span class="op" id="8471669">:=</span>&nbsp;<span class="ident" id="8471672">b0</span><span class="op" id="8471674">.</span><span class="ident" id="8471675">Min</span><span class="op" id="8471678">.</span><span class="ident" id="8471679">X</span><span class="op" id="8471680">;</span>&nbsp;<span class="ident" id="8471682">x</span>&nbsp;<span class="op" id="8471684">&lt;</span>&nbsp;<span class="ident" id="8471686">b0</span><span class="op" id="8471688">.</span><span class="ident" id="8471689">Max</span><span class="op" id="8471692">.</span><span class="ident" id="8471693">X</span><span class="op" id="8471694">;</span>&nbsp;<span class="ident" id="8471696">x</span><span class="op" id="8471697">++</span>&nbsp;<span class="op" id="8471700">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471705">c0</span>&nbsp;<span class="op" id="8471708">:=</span>&nbsp;<span class="ident" id="8471711">m0</span><span class="op" id="8471713">.</span><span class="ident" id="8471714">At</span><span class="op" id="8471716">(</span><span class="ident" id="8471717">x</span><span class="op" id="8471718">,</span>&nbsp;<span class="ident" id="8471720">y</span><span class="op" id="8471721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471726">c1</span>&nbsp;<span class="op" id="8471729">:=</span>&nbsp;<span class="ident" id="8471732">m1</span><span class="op" id="8471734">.</span><span class="ident" id="8471735">At</span><span class="op" id="8471737">(</span><span class="ident" id="8471738">x</span><span class="op" id="8471739">+</span><span class="ident" id="8471740">dx</span><span class="op" id="8471742">,</span>&nbsp;<span class="ident" id="8471744">y</span><span class="op" id="8471745">+</span><span class="ident" id="8471746">dy</span><span class="op" id="8471748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471753">r0</span><span class="op" id="8471755">,</span>&nbsp;<span class="ident" id="8471757">g0</span><span class="op" id="8471759">,</span>&nbsp;<span class="ident" id="8471761">b0</span><span class="op" id="8471763">,</span>&nbsp;<span class="ident" id="8471765">a0</span>&nbsp;<span class="op" id="8471768">:=</span>&nbsp;<span class="ident" id="8471771">c0</span><span class="op" id="8471773">.</span><span class="ident" id="8471774">RGBA</span><span class="op" id="8471778">(</span><span class="op" id="8471779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8471784">r1</span><span class="op" id="8471786">,</span>&nbsp;<span class="ident" id="8471788">g1</span><span class="op" id="8471790">,</span>&nbsp;<span class="ident" id="8471792">b1</span><span class="op" id="8471794">,</span>&nbsp;<span class="ident" id="8471796">a1</span>&nbsp;<span class="op" id="8471799">:=</span>&nbsp;<span class="ident" id="8471802">c1</span><span class="op" id="8471804">.</span><span class="ident" id="8471805">RGBA</span><span class="op" id="8471809">(</span><span class="op" id="8471810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471815">if</span>&nbsp;<span class="ident" id="8471818">r0</span>&nbsp;<span class="op" id="8471821">!=</span>&nbsp;<span class="ident" id="8471824">r1</span>&nbsp;<span class="op" id="8471827">||</span>&nbsp;<span class="ident" id="8471830">g0</span>&nbsp;<span class="op" id="8471833">!=</span>&nbsp;<span class="ident" id="8471836">g1</span>&nbsp;<span class="op" id="8471839">||</span>&nbsp;<span class="ident" id="8471842">b0</span>&nbsp;<span class="op" id="8471845">!=</span>&nbsp;<span class="ident" id="8471848">b1</span>&nbsp;<span class="op" id="8471851">||</span>&nbsp;<span class="ident" id="8471854">a0</span>&nbsp;<span class="op" id="8471857">!=</span>&nbsp;<span class="ident" id="8471860">a1</span>&nbsp;<span class="op" id="8471863">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471869">return</span>&nbsp;<span class="ident" id="8471876">fmt</span><span class="op" id="8471879">.</span><span class="ident" id="8471880">Errorf</span><span class="op" id="8471886">(</span><span class="string" id="8471887">&#34;colors&nbsp;differ&nbsp;at&nbsp;(%d,&nbsp;%d):&nbsp;%v&nbsp;vs&nbsp;%v&#34;</span><span class="op" id="8471924">,</span>&nbsp;<span class="ident" id="8471926">x</span><span class="op" id="8471927">,</span>&nbsp;<span class="ident" id="8471929">y</span><span class="op" id="8471930">,</span>&nbsp;<span class="ident" id="8471932">c0</span><span class="op" id="8471934">,</span>&nbsp;<span class="ident" id="8471936">c1</span><span class="op" id="8471938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8471943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8471947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8471950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8471953">return</span>&nbsp;<span class="ident" id="8471960">nil</span><br>
<span class="lineno">35</span><span class="op" id="8471964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8471967">func</span>&nbsp;<span class="ident" id="8471972">encodeDecode</span><span class="op" id="8471984">(</span><span class="ident" id="8471985">m</span>&nbsp;<span class="ident" id="8471987">image</span><span class="op" id="8471992">.</span><span class="ident" id="8471993">Image</span><span class="op" id="8471998">)</span>&nbsp;<span class="op" id="8472000">(</span><span class="ident" id="8472001">image</span><span class="op" id="8472006">.</span><span class="ident" id="8472007">Image</span><span class="op" id="8472012">,</span>&nbsp;<span class="builtintype" id="8472014">error</span><span class="op" id="8472019">)</span>&nbsp;<span class="op" id="8472021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472024">var</span>&nbsp;<span class="ident" id="8472028">b</span>&nbsp;<span class="ident" id="8472030">bytes</span><span class="op" id="8472035">.</span><span class="ident" id="8472036">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472044">err</span>&nbsp;<span class="op" id="8472048">:=</span>&nbsp;<span class="ident" id="8472051">Encode</span><span class="op" id="8472057">(</span><span class="op" id="8472058">&amp;</span><span class="ident" id="8472059">b</span><span class="op" id="8472060">,</span>&nbsp;<span class="ident" id="8472062">m</span><span class="op" id="8472063">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472066">if</span>&nbsp;<span class="ident" id="8472069">err</span>&nbsp;<span class="op" id="8472073">!=</span>&nbsp;<span class="ident" id="8472076">nil</span>&nbsp;<span class="op" id="8472080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472084">return</span>&nbsp;<span class="ident" id="8472091">nil</span><span class="op" id="8472094">,</span>&nbsp;<span class="ident" id="8472096">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8472101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472104">return</span>&nbsp;<span class="ident" id="8472111">Decode</span><span class="op" id="8472117">(</span><span class="op" id="8472118">&amp;</span><span class="ident" id="8472119">b</span><span class="op" id="8472120">)</span><br>
<span class="lineno"></span><span class="op" id="8472122">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8472125">func</span>&nbsp;<span class="ident" id="8472130">TestWriter</span><span class="op" id="8472140">(</span><span class="ident" id="8472141">t</span>&nbsp;<span class="op" id="8472143">*</span><span class="ident" id="8472144">testing</span><span class="op" id="8472151">.</span><span class="ident" id="8472152">T</span><span class="op" id="8472153">)</span>&nbsp;<span class="op" id="8472155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8472158">//&nbsp;The&nbsp;filenames&nbsp;variable&nbsp;is&nbsp;declared&nbsp;in&nbsp;reader_test.go.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472216">names</span>&nbsp;<span class="op" id="8472222">:=</span>&nbsp;<span class="ident" id="8472225">filenames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472236">if</span>&nbsp;<span class="ident" id="8472239">testing</span><span class="op" id="8472246">.</span><span class="ident" id="8472247">Short</span><span class="op" id="8472252">(</span><span class="op" id="8472253">)</span>&nbsp;<span class="op" id="8472255">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472259">names</span>&nbsp;<span class="op" id="8472265">=</span>&nbsp;<span class="ident" id="8472267">filenamesShort</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8472283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472286">for</span>&nbsp;<span class="ident" id="8472290">_</span><span class="op" id="8472291">,</span>&nbsp;<span class="ident" id="8472293">fn</span>&nbsp;<span class="op" id="8472296">:=</span>&nbsp;<span class="keyword" id="8472299">range</span>&nbsp;<span class="ident" id="8472305">names</span>&nbsp;<span class="op" id="8472311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472315">qfn</span>&nbsp;<span class="op" id="8472319">:=</span>&nbsp;<span class="string" id="8472322">&#34;testdata/pngsuite/&#34;</span>&nbsp;<span class="op" id="8472343">+</span>&nbsp;<span class="ident" id="8472345">fn</span>&nbsp;<span class="op" id="8472348">+</span>&nbsp;<span class="string" id="8472350">&#34;.png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8472359">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472380">m0</span><span class="op" id="8472382">,</span>&nbsp;<span class="ident" id="8472384">err</span>&nbsp;<span class="op" id="8472388">:=</span>&nbsp;<span class="ident" id="8472391">readPNG</span><span class="op" id="8472398">(</span><span class="ident" id="8472399">qfn</span><span class="op" id="8472402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472406">if</span>&nbsp;<span class="ident" id="8472409">err</span>&nbsp;<span class="op" id="8472413">!=</span>&nbsp;<span class="ident" id="8472416">nil</span>&nbsp;<span class="op" id="8472420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472425">t</span><span class="op" id="8472426">.</span><span class="ident" id="8472427">Error</span><span class="op" id="8472432">(</span><span class="ident" id="8472433">fn</span><span class="op" id="8472435">,</span>&nbsp;<span class="ident" id="8472437">err</span><span class="op" id="8472440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472445">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8472456">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8472460">//&nbsp;Read&nbsp;the&nbsp;image&nbsp;again,&nbsp;encode&nbsp;it,&nbsp;and&nbsp;decode&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472513">m1</span><span class="op" id="8472515">,</span>&nbsp;<span class="ident" id="8472517">err</span>&nbsp;<span class="op" id="8472521">:=</span>&nbsp;<span class="ident" id="8472524">readPNG</span><span class="op" id="8472531">(</span><span class="ident" id="8472532">qfn</span><span class="op" id="8472535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472539">if</span>&nbsp;<span class="ident" id="8472542">err</span>&nbsp;<span class="op" id="8472546">!=</span>&nbsp;<span class="ident" id="8472549">nil</span>&nbsp;<span class="op" id="8472553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472558">t</span><span class="op" id="8472559">.</span><span class="ident" id="8472560">Error</span><span class="op" id="8472565">(</span><span class="ident" id="8472566">fn</span><span class="op" id="8472568">,</span>&nbsp;<span class="ident" id="8472570">err</span><span class="op" id="8472573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472578">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8472587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472591">m2</span><span class="op" id="8472593">,</span>&nbsp;<span class="ident" id="8472595">err</span>&nbsp;<span class="op" id="8472599">:=</span>&nbsp;<span class="ident" id="8472602">encodeDecode</span><span class="op" id="8472614">(</span><span class="ident" id="8472615">m1</span><span class="op" id="8472617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472621">if</span>&nbsp;<span class="ident" id="8472624">err</span>&nbsp;<span class="op" id="8472628">!=</span>&nbsp;<span class="ident" id="8472631">nil</span>&nbsp;<span class="op" id="8472635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472640">t</span><span class="op" id="8472641">.</span><span class="ident" id="8472642">Error</span><span class="op" id="8472647">(</span><span class="ident" id="8472648">fn</span><span class="op" id="8472650">,</span>&nbsp;<span class="ident" id="8472652">err</span><span class="op" id="8472655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472660">return</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8472669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8472673">//&nbsp;Compare&nbsp;the&nbsp;two.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472695">err</span>&nbsp;<span class="op" id="8472699">=</span>&nbsp;<span class="ident" id="8472701">diff</span><span class="op" id="8472705">(</span><span class="ident" id="8472706">m0</span><span class="op" id="8472708">,</span>&nbsp;<span class="ident" id="8472710">m2</span><span class="op" id="8472712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472716">if</span>&nbsp;<span class="ident" id="8472719">err</span>&nbsp;<span class="op" id="8472723">!=</span>&nbsp;<span class="ident" id="8472726">nil</span>&nbsp;<span class="op" id="8472730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472735">t</span><span class="op" id="8472736">.</span><span class="ident" id="8472737">Error</span><span class="op" id="8472742">(</span><span class="ident" id="8472743">fn</span><span class="op" id="8472745">,</span>&nbsp;<span class="ident" id="8472747">err</span><span class="op" id="8472750">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472755">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8472766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8472769">}</span><br>
<span class="lineno"></span><span class="op" id="8472771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="8472774">func</span>&nbsp;<span class="ident" id="8472779">TestWriterLevels</span><span class="op" id="8472795">(</span><span class="ident" id="8472796">t</span>&nbsp;<span class="op" id="8472798">*</span><span class="ident" id="8472799">testing</span><span class="op" id="8472806">.</span><span class="ident" id="8472807">T</span><span class="op" id="8472808">)</span>&nbsp;<span class="op" id="8472810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472813">m</span>&nbsp;<span class="op" id="8472815">:=</span>&nbsp;<span class="ident" id="8472818">image</span><span class="op" id="8472823">.</span><span class="ident" id="8472824">NewNRGBA</span><span class="op" id="8472832">(</span><span class="ident" id="8472833">image</span><span class="op" id="8472838">.</span><span class="ident" id="8472839">Rect</span><span class="op" id="8472843">(</span><span class="num" id="8472844">0</span><span class="op" id="8472845">,</span>&nbsp;<span class="num" id="8472847">0</span><span class="op" id="8472848">,</span>&nbsp;<span class="num" id="8472850">100</span><span class="op" id="8472853">,</span>&nbsp;<span class="num" id="8472855">100</span><span class="op" id="8472858">)</span><span class="op" id="8472859">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472863">var</span>&nbsp;<span class="ident" id="8472867">b1</span><span class="op" id="8472869">,</span>&nbsp;<span class="ident" id="8472871">b2</span>&nbsp;<span class="ident" id="8472874">bytes</span><span class="op" id="8472879">.</span><span class="ident" id="8472880">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8472888">if</span>&nbsp;<span class="ident" id="8472891">err</span>&nbsp;<span class="op" id="8472895">:=</span>&nbsp;<span class="op" id="8472898">(</span><span class="op" id="8472899">&amp;</span><span class="ident" id="8472900">Encoder</span><span class="op" id="8472907">{</span><span class="op" id="8472908">}</span><span class="op" id="8472909">)</span><span class="op" id="8472910">.</span><span class="ident" id="8472911">Encode</span><span class="op" id="8472917">(</span><span class="op" id="8472918">&amp;</span><span class="ident" id="8472919">b1</span><span class="op" id="8472921">,</span>&nbsp;<span class="ident" id="8472923">m</span><span class="op" id="8472924">)</span><span class="op" id="8472925">;</span>&nbsp;<span class="ident" id="8472927">err</span>&nbsp;<span class="op" id="8472931">!=</span>&nbsp;<span class="ident" id="8472934">nil</span>&nbsp;<span class="op" id="8472938">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472942">t</span><span class="op" id="8472943">.</span><span class="ident" id="8472944">Fatal</span><span class="op" id="8472949">(</span><span class="ident" id="8472950">err</span><span class="op" id="8472953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8472956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8472959">noenc</span>&nbsp;<span class="op" id="8472965">:=</span>&nbsp;<span class="op" id="8472968">&amp;</span><span class="ident" id="8472969">Encoder</span><span class="op" id="8472976">{</span><span class="ident" id="8472977">CompressionLevel</span><span class="op" id="8472993">:</span>&nbsp;<span class="ident" id="8472995">NoCompression</span><span class="op" id="8473008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473011">if</span>&nbsp;<span class="ident" id="8473014">err</span>&nbsp;<span class="op" id="8473018">:=</span>&nbsp;<span class="ident" id="8473021">noenc</span><span class="op" id="8473026">.</span><span class="ident" id="8473027">Encode</span><span class="op" id="8473033">(</span><span class="op" id="8473034">&amp;</span><span class="ident" id="8473035">b2</span><span class="op" id="8473037">,</span>&nbsp;<span class="ident" id="8473039">m</span><span class="op" id="8473040">)</span><span class="op" id="8473041">;</span>&nbsp;<span class="ident" id="8473043">err</span>&nbsp;<span class="op" id="8473047">!=</span>&nbsp;<span class="ident" id="8473050">nil</span>&nbsp;<span class="op" id="8473054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473058">t</span><span class="op" id="8473059">.</span><span class="ident" id="8473060">Fatal</span><span class="op" id="8473065">(</span><span class="ident" id="8473066">err</span><span class="op" id="8473069">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8473072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473076">if</span>&nbsp;<span class="ident" id="8473079">b2</span><span class="op" id="8473081">.</span><span class="ident" id="8473082">Len</span><span class="op" id="8473085">(</span><span class="op" id="8473086">)</span>&nbsp;<span class="op" id="8473088">&lt;=</span>&nbsp;<span class="ident" id="8473091">b1</span><span class="op" id="8473093">.</span><span class="ident" id="8473094">Len</span><span class="op" id="8473097">(</span><span class="op" id="8473098">)</span>&nbsp;<span class="op" id="8473100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473104">t</span><span class="op" id="8473105">.</span><span class="ident" id="8473106">Error</span><span class="op" id="8473111">(</span><span class="string" id="8473112">&#34;DefaultCompression&nbsp;encoding&nbsp;was&nbsp;larger&nbsp;than&nbsp;NoCompression&nbsp;encoding&#34;</span><span class="op" id="8473180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8473183">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473186">if</span>&nbsp;<span class="ident" id="8473189">_</span><span class="op" id="8473190">,</span>&nbsp;<span class="ident" id="8473192">err</span>&nbsp;<span class="op" id="8473196">:=</span>&nbsp;<span class="ident" id="8473199">Decode</span><span class="op" id="8473205">(</span><span class="op" id="8473206">&amp;</span><span class="ident" id="8473207">b1</span><span class="op" id="8473209">)</span><span class="op" id="8473210">;</span>&nbsp;<span class="ident" id="8473212">err</span>&nbsp;<span class="op" id="8473216">!=</span>&nbsp;<span class="ident" id="8473219">nil</span>&nbsp;<span class="op" id="8473223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473227">t</span><span class="op" id="8473228">.</span><span class="ident" id="8473229">Error</span><span class="op" id="8473234">(</span><span class="string" id="8473235">&#34;cannot&nbsp;decode&nbsp;DefaultCompression&#34;</span><span class="op" id="8473269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8473272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473275">if</span>&nbsp;<span class="ident" id="8473278">_</span><span class="op" id="8473279">,</span>&nbsp;<span class="ident" id="8473281">err</span>&nbsp;<span class="op" id="8473285">:=</span>&nbsp;<span class="ident" id="8473288">Decode</span><span class="op" id="8473294">(</span><span class="op" id="8473295">&amp;</span><span class="ident" id="8473296">b2</span><span class="op" id="8473298">)</span><span class="op" id="8473299">;</span>&nbsp;<span class="ident" id="8473301">err</span>&nbsp;<span class="op" id="8473305">!=</span>&nbsp;<span class="ident" id="8473308">nil</span>&nbsp;<span class="op" id="8473312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473316">t</span><span class="op" id="8473317">.</span><span class="ident" id="8473318">Error</span><span class="op" id="8473323">(</span><span class="string" id="8473324">&#34;cannot&nbsp;decode&nbsp;NoCompression&#34;</span><span class="op" id="8473353">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8473356">}</span><br>
<span class="lineno"></span><span class="op" id="8473358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8473361">func</span>&nbsp;<span class="ident" id="8473366">TestSubImage</span><span class="op" id="8473378">(</span><span class="ident" id="8473379">t</span>&nbsp;<span class="op" id="8473381">*</span><span class="ident" id="8473382">testing</span><span class="op" id="8473389">.</span><span class="ident" id="8473390">T</span><span class="op" id="8473391">)</span>&nbsp;<span class="op" id="8473393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473396">m0</span>&nbsp;<span class="op" id="8473399">:=</span>&nbsp;<span class="ident" id="8473402">image</span><span class="op" id="8473407">.</span><span class="ident" id="8473408">NewRGBA</span><span class="op" id="8473415">(</span><span class="ident" id="8473416">image</span><span class="op" id="8473421">.</span><span class="ident" id="8473422">Rect</span><span class="op" id="8473426">(</span><span class="num" id="8473427">0</span><span class="op" id="8473428">,</span>&nbsp;<span class="num" id="8473430">0</span><span class="op" id="8473431">,</span>&nbsp;<span class="num" id="8473433">256</span><span class="op" id="8473436">,</span>&nbsp;<span class="num" id="8473438">256</span><span class="op" id="8473441">)</span><span class="op" id="8473442">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473445">for</span>&nbsp;<span class="ident" id="8473449">y</span>&nbsp;<span class="op" id="8473451">:=</span>&nbsp;<span class="num" id="8473454">0</span><span class="op" id="8473455">;</span>&nbsp;<span class="ident" id="8473457">y</span>&nbsp;<span class="op" id="8473459">&lt;</span>&nbsp;<span class="num" id="8473461">256</span><span class="op" id="8473464">;</span>&nbsp;<span class="ident" id="8473466">y</span><span class="op" id="8473467">++</span>&nbsp;<span class="op" id="8473470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473474">for</span>&nbsp;<span class="ident" id="8473478">x</span>&nbsp;<span class="op" id="8473480">:=</span>&nbsp;<span class="num" id="8473483">0</span><span class="op" id="8473484">;</span>&nbsp;<span class="ident" id="8473486">x</span>&nbsp;<span class="op" id="8473488">&lt;</span>&nbsp;<span class="num" id="8473490">256</span><span class="op" id="8473493">;</span>&nbsp;<span class="ident" id="8473495">x</span><span class="op" id="8473496">++</span>&nbsp;<span class="op" id="8473499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473504">m0</span><span class="op" id="8473506">.</span><span class="ident" id="8473507">Set</span><span class="op" id="8473510">(</span><span class="ident" id="8473511">x</span><span class="op" id="8473512">,</span>&nbsp;<span class="ident" id="8473514">y</span><span class="op" id="8473515">,</span>&nbsp;<span class="ident" id="8473517">color</span><span class="op" id="8473522">.</span><span class="ident" id="8473523">RGBA</span><span class="op" id="8473527">{</span><span class="builtintype" id="8473528">uint8</span><span class="op" id="8473533">(</span><span class="ident" id="8473534">x</span><span class="op" id="8473535">)</span><span class="op" id="8473536">,</span>&nbsp;<span class="builtintype" id="8473538">uint8</span><span class="op" id="8473543">(</span><span class="ident" id="8473544">y</span><span class="op" id="8473545">)</span><span class="op" id="8473546">,</span>&nbsp;<span class="num" id="8473548">0</span><span class="op" id="8473549">,</span>&nbsp;<span class="num" id="8473551">255</span><span class="op" id="8473554">}</span><span class="op" id="8473555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8473559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8473562">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473565">m0</span>&nbsp;<span class="op" id="8473568">=</span>&nbsp;<span class="ident" id="8473570">m0</span><span class="op" id="8473572">.</span><span class="ident" id="8473573">SubImage</span><span class="op" id="8473581">(</span><span class="ident" id="8473582">image</span><span class="op" id="8473587">.</span><span class="ident" id="8473588">Rect</span><span class="op" id="8473592">(</span><span class="num" id="8473593">50</span><span class="op" id="8473595">,</span>&nbsp;<span class="num" id="8473597">30</span><span class="op" id="8473599">,</span>&nbsp;<span class="num" id="8473601">250</span><span class="op" id="8473604">,</span>&nbsp;<span class="num" id="8473606">130</span><span class="op" id="8473609">)</span><span class="op" id="8473610">)</span><span class="op" id="8473611">.</span><span class="op" id="8473612">(</span><span class="op" id="8473613">*</span><span class="ident" id="8473614">image</span><span class="op" id="8473619">.</span><span class="ident" id="8473620">RGBA</span><span class="op" id="8473624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473627">m1</span><span class="op" id="8473629">,</span>&nbsp;<span class="ident" id="8473631">err</span>&nbsp;<span class="op" id="8473635">:=</span>&nbsp;<span class="ident" id="8473638">encodeDecode</span><span class="op" id="8473650">(</span><span class="ident" id="8473651">m0</span><span class="op" id="8473653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473656">if</span>&nbsp;<span class="ident" id="8473659">err</span>&nbsp;<span class="op" id="8473663">!=</span>&nbsp;<span class="ident" id="8473666">nil</span>&nbsp;<span class="op" id="8473670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473674">t</span><span class="op" id="8473675">.</span><span class="ident" id="8473676">Error</span><span class="op" id="8473681">(</span><span class="ident" id="8473682">err</span><span class="op" id="8473685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473689">return</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8473697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473700">err</span>&nbsp;<span class="op" id="8473704">=</span>&nbsp;<span class="ident" id="8473706">diff</span><span class="op" id="8473710">(</span><span class="ident" id="8473711">m0</span><span class="op" id="8473713">,</span>&nbsp;<span class="ident" id="8473715">m1</span><span class="op" id="8473717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473720">if</span>&nbsp;<span class="ident" id="8473723">err</span>&nbsp;<span class="op" id="8473727">!=</span>&nbsp;<span class="ident" id="8473730">nil</span>&nbsp;<span class="op" id="8473734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473738">t</span><span class="op" id="8473739">.</span><span class="ident" id="8473740">Error</span><span class="op" id="8473745">(</span><span class="ident" id="8473746">err</span><span class="op" id="8473749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473753">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8473761">}</span><br>
<span class="lineno"></span><span class="op" id="8473763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8473766">func</span>&nbsp;<span class="ident" id="8473771">BenchmarkEncodeGray</span><span class="op" id="8473790">(</span><span class="ident" id="8473791">b</span>&nbsp;<span class="op" id="8473793">*</span><span class="ident" id="8473794">testing</span><span class="op" id="8473801">.</span><span class="ident" id="8473802">B</span><span class="op" id="8473803">)</span>&nbsp;<span class="op" id="8473805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473808">b</span><span class="op" id="8473809">.</span><span class="ident" id="8473810">StopTimer</span><span class="op" id="8473819">(</span><span class="op" id="8473820">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473823">img</span>&nbsp;<span class="op" id="8473827">:=</span>&nbsp;<span class="ident" id="8473830">image</span><span class="op" id="8473835">.</span><span class="ident" id="8473836">NewGray</span><span class="op" id="8473843">(</span><span class="ident" id="8473844">image</span><span class="op" id="8473849">.</span><span class="ident" id="8473850">Rect</span><span class="op" id="8473854">(</span><span class="num" id="8473855">0</span><span class="op" id="8473856">,</span>&nbsp;<span class="num" id="8473858">0</span><span class="op" id="8473859">,</span>&nbsp;<span class="num" id="8473861">640</span><span class="op" id="8473864">,</span>&nbsp;<span class="num" id="8473866">480</span><span class="op" id="8473869">)</span><span class="op" id="8473870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473873">b</span><span class="op" id="8473874">.</span><span class="ident" id="8473875">SetBytes</span><span class="op" id="8473883">(</span><span class="num" id="8473884">640</span>&nbsp;<span class="op" id="8473888">*</span>&nbsp;<span class="num" id="8473890">480</span>&nbsp;<span class="op" id="8473894">*</span>&nbsp;<span class="num" id="8473896">1</span><span class="op" id="8473897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473900">b</span><span class="op" id="8473901">.</span><span class="ident" id="8473902">StartTimer</span><span class="op" id="8473912">(</span><span class="op" id="8473913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8473916">for</span>&nbsp;<span class="ident" id="8473920">i</span>&nbsp;<span class="op" id="8473922">:=</span>&nbsp;<span class="num" id="8473925">0</span><span class="op" id="8473926">;</span>&nbsp;<span class="ident" id="8473928">i</span>&nbsp;<span class="op" id="8473930">&lt;</span>&nbsp;<span class="ident" id="8473932">b</span><span class="op" id="8473933">.</span><span class="ident" id="8473934">N</span><span class="op" id="8473935">;</span>&nbsp;<span class="ident" id="8473937">i</span><span class="op" id="8473938">++</span>&nbsp;<span class="op" id="8473941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8473945">Encode</span><span class="op" id="8473951">(</span><span class="ident" id="8473952">ioutil</span><span class="op" id="8473958">.</span><span class="ident" id="8473959">Discard</span><span class="op" id="8473966">,</span>&nbsp;<span class="ident" id="8473968">img</span><span class="op" id="8473971">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8473974">}</span><br>
<span class="lineno"></span><span class="op" id="8473976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8473979">func</span>&nbsp;<span class="ident" id="8473984">BenchmarkEncodeNRGBOpaque</span><span class="op" id="8474009">(</span><span class="ident" id="8474010">b</span>&nbsp;<span class="op" id="8474012">*</span><span class="ident" id="8474013">testing</span><span class="op" id="8474020">.</span><span class="ident" id="8474021">B</span><span class="op" id="8474022">)</span>&nbsp;<span class="op" id="8474024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474027">b</span><span class="op" id="8474028">.</span><span class="ident" id="8474029">StopTimer</span><span class="op" id="8474038">(</span><span class="op" id="8474039">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474042">img</span>&nbsp;<span class="op" id="8474046">:=</span>&nbsp;<span class="ident" id="8474049">image</span><span class="op" id="8474054">.</span><span class="ident" id="8474055">NewNRGBA</span><span class="op" id="8474063">(</span><span class="ident" id="8474064">image</span><span class="op" id="8474069">.</span><span class="ident" id="8474070">Rect</span><span class="op" id="8474074">(</span><span class="num" id="8474075">0</span><span class="op" id="8474076">,</span>&nbsp;<span class="num" id="8474078">0</span><span class="op" id="8474079">,</span>&nbsp;<span class="num" id="8474081">640</span><span class="op" id="8474084">,</span>&nbsp;<span class="num" id="8474086">480</span><span class="op" id="8474089">)</span><span class="op" id="8474090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8474093">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474148">bo</span>&nbsp;<span class="op" id="8474151">:=</span>&nbsp;<span class="ident" id="8474154">img</span><span class="op" id="8474157">.</span><span class="ident" id="8474158">Bounds</span><span class="op" id="8474164">(</span><span class="op" id="8474165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8474168">for</span>&nbsp;<span class="ident" id="8474172">y</span>&nbsp;<span class="op" id="8474174">:=</span>&nbsp;<span class="ident" id="8474177">bo</span><span class="op" id="8474179">.</span><span class="ident" id="8474180">Min</span><span class="op" id="8474183">.</span><span class="ident" id="8474184">Y</span><span class="op" id="8474185">;</span>&nbsp;<span class="ident" id="8474187">y</span>&nbsp;<span class="op" id="8474189">&lt;</span>&nbsp;<span class="ident" id="8474191">bo</span><span class="op" id="8474193">.</span><span class="ident" id="8474194">Max</span><span class="op" id="8474197">.</span><span class="ident" id="8474198">Y</span><span class="op" id="8474199">;</span>&nbsp;<span class="ident" id="8474201">y</span><span class="op" id="8474202">++</span>&nbsp;<span class="op" id="8474205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8474209">for</span>&nbsp;<span class="ident" id="8474213">x</span>&nbsp;<span class="op" id="8474215">:=</span>&nbsp;<span class="ident" id="8474218">bo</span><span class="op" id="8474220">.</span><span class="ident" id="8474221">Min</span><span class="op" id="8474224">.</span><span class="ident" id="8474225">X</span><span class="op" id="8474226">;</span>&nbsp;<span class="ident" id="8474228">x</span>&nbsp;<span class="op" id="8474230">&lt;</span>&nbsp;<span class="ident" id="8474232">bo</span><span class="op" id="8474234">.</span><span class="ident" id="8474235">Max</span><span class="op" id="8474238">.</span><span class="ident" id="8474239">X</span><span class="op" id="8474240">;</span>&nbsp;<span class="ident" id="8474242">x</span><span class="op" id="8474243">++</span>&nbsp;<span class="op" id="8474246">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474251">img</span><span class="op" id="8474254">.</span><span class="ident" id="8474255">Set</span><span class="op" id="8474258">(</span><span class="ident" id="8474259">x</span><span class="op" id="8474260">,</span>&nbsp;<span class="ident" id="8474262">y</span><span class="op" id="8474263">,</span>&nbsp;<span class="ident" id="8474265">color</span><span class="op" id="8474270">.</span><span class="ident" id="8474271">NRGBA</span><span class="op" id="8474276">{</span><span class="num" id="8474277">0</span><span class="op" id="8474278">,</span>&nbsp;<span class="num" id="8474280">0</span><span class="op" id="8474281">,</span>&nbsp;<span class="num" id="8474283">0</span><span class="op" id="8474284">,</span>&nbsp;<span class="num" id="8474286">255</span><span class="op" id="8474289">}</span><span class="op" id="8474290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8474294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8474297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8474300">if</span>&nbsp;<span class="op" id="8474303">!</span><span class="ident" id="8474304">img</span><span class="op" id="8474307">.</span><span class="ident" id="8474308">Opaque</span><span class="op" id="8474314">(</span><span class="op" id="8474315">)</span>&nbsp;<span class="op" id="8474317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474321">b</span><span class="op" id="8474322">.</span><span class="ident" id="8474323">Fatal</span><span class="op" id="8474328">(</span><span class="string" id="8474329">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="8474358">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8474361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474364">b</span><span class="op" id="8474365">.</span><span class="ident" id="8474366">SetBytes</span><span class="op" id="8474374">(</span><span class="num" id="8474375">640</span>&nbsp;<span class="op" id="8474379">*</span>&nbsp;<span class="num" id="8474381">480</span>&nbsp;<span class="op" id="8474385">*</span>&nbsp;<span class="num" id="8474387">4</span><span class="op" id="8474388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474391">b</span><span class="op" id="8474392">.</span><span class="ident" id="8474393">StartTimer</span><span class="op" id="8474403">(</span><span class="op" id="8474404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8474407">for</span>&nbsp;<span class="ident" id="8474411">i</span>&nbsp;<span class="op" id="8474413">:=</span>&nbsp;<span class="num" id="8474416">0</span><span class="op" id="8474417">;</span>&nbsp;<span class="ident" id="8474419">i</span>&nbsp;<span class="op" id="8474421">&lt;</span>&nbsp;<span class="ident" id="8474423">b</span><span class="op" id="8474424">.</span><span class="ident" id="8474425">N</span><span class="op" id="8474426">;</span>&nbsp;<span class="ident" id="8474428">i</span><span class="op" id="8474429">++</span>&nbsp;<span class="op" id="8474432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474436">Encode</span><span class="op" id="8474442">(</span><span class="ident" id="8474443">ioutil</span><span class="op" id="8474449">.</span><span class="ident" id="8474450">Discard</span><span class="op" id="8474457">,</span>&nbsp;<span class="ident" id="8474459">img</span><span class="op" id="8474462">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8474465">}</span><br>
<span class="lineno"></span><span class="op" id="8474467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8474470">func</span>&nbsp;<span class="ident" id="8474475">BenchmarkEncodeNRGBA</span><span class="op" id="8474495">(</span><span class="ident" id="8474496">b</span>&nbsp;<span class="op" id="8474498">*</span><span class="ident" id="8474499">testing</span><span class="op" id="8474506">.</span><span class="ident" id="8474507">B</span><span class="op" id="8474508">)</span>&nbsp;<span class="op" id="8474510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474513">b</span><span class="op" id="8474514">.</span><span class="ident" id="8474515">StopTimer</span><span class="op" id="8474524">(</span><span class="op" id="8474525">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474528">img</span>&nbsp;<span class="op" id="8474532">:=</span>&nbsp;<span class="ident" id="8474535">image</span><span class="op" id="8474540">.</span><span class="ident" id="8474541">NewNRGBA</span><span class="op" id="8474549">(</span><span class="ident" id="8474550">image</span><span class="op" id="8474555">.</span><span class="ident" id="8474556">Rect</span><span class="op" id="8474560">(</span><span class="num" id="8474561">0</span><span class="op" id="8474562">,</span>&nbsp;<span class="num" id="8474564">0</span><span class="op" id="8474565">,</span>&nbsp;<span class="num" id="8474567">640</span><span class="op" id="8474570">,</span>&nbsp;<span class="num" id="8474572">480</span><span class="op" id="8474575">)</span><span class="op" id="8474576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8474579">if</span>&nbsp;<span class="ident" id="8474582">img</span><span class="op" id="8474585">.</span><span class="ident" id="8474586">Opaque</span><span class="op" id="8474592">(</span><span class="op" id="8474593">)</span>&nbsp;<span class="op" id="8474595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474599">b</span><span class="op" id="8474600">.</span><span class="ident" id="8474601">Fatal</span><span class="op" id="8474606">(</span><span class="string" id="8474607">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="8474640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8474643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474646">b</span><span class="op" id="8474647">.</span><span class="ident" id="8474648">SetBytes</span><span class="op" id="8474656">(</span><span class="num" id="8474657">640</span>&nbsp;<span class="op" id="8474661">*</span>&nbsp;<span class="num" id="8474663">480</span>&nbsp;<span class="op" id="8474667">*</span>&nbsp;<span class="num" id="8474669">4</span><span class="op" id="8474670">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474673">b</span><span class="op" id="8474674">.</span><span class="ident" id="8474675">StartTimer</span><span class="op" id="8474685">(</span><span class="op" id="8474686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8474689">for</span>&nbsp;<span class="ident" id="8474693">i</span>&nbsp;<span class="op" id="8474695">:=</span>&nbsp;<span class="num" id="8474698">0</span><span class="op" id="8474699">;</span>&nbsp;<span class="ident" id="8474701">i</span>&nbsp;<span class="op" id="8474703">&lt;</span>&nbsp;<span class="ident" id="8474705">b</span><span class="op" id="8474706">.</span><span class="ident" id="8474707">N</span><span class="op" id="8474708">;</span>&nbsp;<span class="ident" id="8474710">i</span><span class="op" id="8474711">++</span>&nbsp;<span class="op" id="8474714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474718">Encode</span><span class="op" id="8474724">(</span><span class="ident" id="8474725">ioutil</span><span class="op" id="8474731">.</span><span class="ident" id="8474732">Discard</span><span class="op" id="8474739">,</span>&nbsp;<span class="ident" id="8474741">img</span><span class="op" id="8474744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8474747">}</span><br>
<span class="lineno"></span><span class="op" id="8474749">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="8474752">func</span>&nbsp;<span class="ident" id="8474757">BenchmarkEncodePaletted</span><span class="op" id="8474780">(</span><span class="ident" id="8474781">b</span>&nbsp;<span class="op" id="8474783">*</span><span class="ident" id="8474784">testing</span><span class="op" id="8474791">.</span><span class="ident" id="8474792">B</span><span class="op" id="8474793">)</span>&nbsp;<span class="op" id="8474795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474798">b</span><span class="op" id="8474799">.</span><span class="ident" id="8474800">StopTimer</span><span class="op" id="8474809">(</span><span class="op" id="8474810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474813">img</span>&nbsp;<span class="op" id="8474817">:=</span>&nbsp;<span class="ident" id="8474820">image</span><span class="op" id="8474825">.</span><span class="ident" id="8474826">NewPaletted</span><span class="op" id="8474837">(</span><span class="ident" id="8474838">image</span><span class="op" id="8474843">.</span><span class="ident" id="8474844">Rect</span><span class="op" id="8474848">(</span><span class="num" id="8474849">0</span><span class="op" id="8474850">,</span>&nbsp;<span class="num" id="8474852">0</span><span class="op" id="8474853">,</span>&nbsp;<span class="num" id="8474855">640</span><span class="op" id="8474858">,</span>&nbsp;<span class="num" id="8474860">480</span><span class="op" id="8474863">)</span><span class="op" id="8474864">,</span>&nbsp;<span class="ident" id="8474866">color</span><span class="op" id="8474871">.</span><span class="ident" id="8474872">Palette</span><span class="op" id="8474879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474883">color</span><span class="op" id="8474888">.</span><span class="ident" id="8474889">RGBA</span><span class="op" id="8474893">{</span><span class="num" id="8474894">0</span><span class="op" id="8474895">,</span>&nbsp;<span class="num" id="8474897">0</span><span class="op" id="8474898">,</span>&nbsp;<span class="num" id="8474900">0</span><span class="op" id="8474901">,</span>&nbsp;<span class="num" id="8474903">255</span><span class="op" id="8474906">}</span><span class="op" id="8474907">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474911">color</span><span class="op" id="8474916">.</span><span class="ident" id="8474917">RGBA</span><span class="op" id="8474921">{</span><span class="num" id="8474922">255</span><span class="op" id="8474925">,</span>&nbsp;<span class="num" id="8474927">255</span><span class="op" id="8474930">,</span>&nbsp;<span class="num" id="8474932">255</span><span class="op" id="8474935">,</span>&nbsp;<span class="num" id="8474937">255</span><span class="op" id="8474940">}</span><span class="op" id="8474941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8474944">}</span><span class="op" id="8474945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474948">b</span><span class="op" id="8474949">.</span><span class="ident" id="8474950">SetBytes</span><span class="op" id="8474958">(</span><span class="num" id="8474959">640</span>&nbsp;<span class="op" id="8474963">*</span>&nbsp;<span class="num" id="8474965">480</span>&nbsp;<span class="op" id="8474969">*</span>&nbsp;<span class="num" id="8474971">1</span><span class="op" id="8474972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8474975">b</span><span class="op" id="8474976">.</span><span class="ident" id="8474977">StartTimer</span><span class="op" id="8474987">(</span><span class="op" id="8474988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8474991">for</span>&nbsp;<span class="ident" id="8474995">i</span>&nbsp;<span class="op" id="8474997">:=</span>&nbsp;<span class="num" id="8475000">0</span><span class="op" id="8475001">;</span>&nbsp;<span class="ident" id="8475003">i</span>&nbsp;<span class="op" id="8475005">&lt;</span>&nbsp;<span class="ident" id="8475007">b</span><span class="op" id="8475008">.</span><span class="ident" id="8475009">N</span><span class="op" id="8475010">;</span>&nbsp;<span class="ident" id="8475012">i</span><span class="op" id="8475013">++</span>&nbsp;<span class="op" id="8475016">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475020">Encode</span><span class="op" id="8475026">(</span><span class="ident" id="8475027">ioutil</span><span class="op" id="8475033">.</span><span class="ident" id="8475034">Discard</span><span class="op" id="8475041">,</span>&nbsp;<span class="ident" id="8475043">img</span><span class="op" id="8475046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8475049">}</span><br>
<span class="lineno"></span><span class="op" id="8475051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8475054">func</span>&nbsp;<span class="ident" id="8475059">BenchmarkEncodeRGBOpaque</span><span class="op" id="8475083">(</span><span class="ident" id="8475084">b</span>&nbsp;<span class="op" id="8475086">*</span><span class="ident" id="8475087">testing</span><span class="op" id="8475094">.</span><span class="ident" id="8475095">B</span><span class="op" id="8475096">)</span>&nbsp;<span class="op" id="8475098">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475101">b</span><span class="op" id="8475102">.</span><span class="ident" id="8475103">StopTimer</span><span class="op" id="8475112">(</span><span class="op" id="8475113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475116">img</span>&nbsp;<span class="op" id="8475120">:=</span>&nbsp;<span class="ident" id="8475123">image</span><span class="op" id="8475128">.</span><span class="ident" id="8475129">NewRGBA</span><span class="op" id="8475136">(</span><span class="ident" id="8475137">image</span><span class="op" id="8475142">.</span><span class="ident" id="8475143">Rect</span><span class="op" id="8475147">(</span><span class="num" id="8475148">0</span><span class="op" id="8475149">,</span>&nbsp;<span class="num" id="8475151">0</span><span class="op" id="8475152">,</span>&nbsp;<span class="num" id="8475154">640</span><span class="op" id="8475157">,</span>&nbsp;<span class="num" id="8475159">480</span><span class="op" id="8475162">)</span><span class="op" id="8475163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8475166">//&nbsp;Set&nbsp;all&nbsp;pixels&nbsp;to&nbsp;0xFF&nbsp;alpha&nbsp;to&nbsp;force&nbsp;opaque&nbsp;mode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475221">bo</span>&nbsp;<span class="op" id="8475224">:=</span>&nbsp;<span class="ident" id="8475227">img</span><span class="op" id="8475230">.</span><span class="ident" id="8475231">Bounds</span><span class="op" id="8475237">(</span><span class="op" id="8475238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8475241">for</span>&nbsp;<span class="ident" id="8475245">y</span>&nbsp;<span class="op" id="8475247">:=</span>&nbsp;<span class="ident" id="8475250">bo</span><span class="op" id="8475252">.</span><span class="ident" id="8475253">Min</span><span class="op" id="8475256">.</span><span class="ident" id="8475257">Y</span><span class="op" id="8475258">;</span>&nbsp;<span class="ident" id="8475260">y</span>&nbsp;<span class="op" id="8475262">&lt;</span>&nbsp;<span class="ident" id="8475264">bo</span><span class="op" id="8475266">.</span><span class="ident" id="8475267">Max</span><span class="op" id="8475270">.</span><span class="ident" id="8475271">Y</span><span class="op" id="8475272">;</span>&nbsp;<span class="ident" id="8475274">y</span><span class="op" id="8475275">++</span>&nbsp;<span class="op" id="8475278">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8475282">for</span>&nbsp;<span class="ident" id="8475286">x</span>&nbsp;<span class="op" id="8475288">:=</span>&nbsp;<span class="ident" id="8475291">bo</span><span class="op" id="8475293">.</span><span class="ident" id="8475294">Min</span><span class="op" id="8475297">.</span><span class="ident" id="8475298">X</span><span class="op" id="8475299">;</span>&nbsp;<span class="ident" id="8475301">x</span>&nbsp;<span class="op" id="8475303">&lt;</span>&nbsp;<span class="ident" id="8475305">bo</span><span class="op" id="8475307">.</span><span class="ident" id="8475308">Max</span><span class="op" id="8475311">.</span><span class="ident" id="8475312">X</span><span class="op" id="8475313">;</span>&nbsp;<span class="ident" id="8475315">x</span><span class="op" id="8475316">++</span>&nbsp;<span class="op" id="8475319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475324">img</span><span class="op" id="8475327">.</span><span class="ident" id="8475328">Set</span><span class="op" id="8475331">(</span><span class="ident" id="8475332">x</span><span class="op" id="8475333">,</span>&nbsp;<span class="ident" id="8475335">y</span><span class="op" id="8475336">,</span>&nbsp;<span class="ident" id="8475338">color</span><span class="op" id="8475343">.</span><span class="ident" id="8475344">RGBA</span><span class="op" id="8475348">{</span><span class="num" id="8475349">0</span><span class="op" id="8475350">,</span>&nbsp;<span class="num" id="8475352">0</span><span class="op" id="8475353">,</span>&nbsp;<span class="num" id="8475355">0</span><span class="op" id="8475356">,</span>&nbsp;<span class="num" id="8475358">255</span><span class="op" id="8475361">}</span><span class="op" id="8475362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8475366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8475369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8475372">if</span>&nbsp;<span class="op" id="8475375">!</span><span class="ident" id="8475376">img</span><span class="op" id="8475379">.</span><span class="ident" id="8475380">Opaque</span><span class="op" id="8475386">(</span><span class="op" id="8475387">)</span>&nbsp;<span class="op" id="8475389">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475393">b</span><span class="op" id="8475394">.</span><span class="ident" id="8475395">Fatal</span><span class="op" id="8475400">(</span><span class="string" id="8475401">&#34;expected&nbsp;image&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="8475430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8475433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475436">b</span><span class="op" id="8475437">.</span><span class="ident" id="8475438">SetBytes</span><span class="op" id="8475446">(</span><span class="num" id="8475447">640</span>&nbsp;<span class="op" id="8475451">*</span>&nbsp;<span class="num" id="8475453">480</span>&nbsp;<span class="op" id="8475457">*</span>&nbsp;<span class="num" id="8475459">4</span><span class="op" id="8475460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475463">b</span><span class="op" id="8475464">.</span><span class="ident" id="8475465">StartTimer</span><span class="op" id="8475475">(</span><span class="op" id="8475476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8475479">for</span>&nbsp;<span class="ident" id="8475483">i</span>&nbsp;<span class="op" id="8475485">:=</span>&nbsp;<span class="num" id="8475488">0</span><span class="op" id="8475489">;</span>&nbsp;<span class="ident" id="8475491">i</span>&nbsp;<span class="op" id="8475493">&lt;</span>&nbsp;<span class="ident" id="8475495">b</span><span class="op" id="8475496">.</span><span class="ident" id="8475497">N</span><span class="op" id="8475498">;</span>&nbsp;<span class="ident" id="8475500">i</span><span class="op" id="8475501">++</span>&nbsp;<span class="op" id="8475504">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475508">Encode</span><span class="op" id="8475514">(</span><span class="ident" id="8475515">ioutil</span><span class="op" id="8475521">.</span><span class="ident" id="8475522">Discard</span><span class="op" id="8475529">,</span>&nbsp;<span class="ident" id="8475531">img</span><span class="op" id="8475534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8475537">}</span><br>
<span class="lineno"></span><span class="op" id="8475539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8475542">func</span>&nbsp;<span class="ident" id="8475547">BenchmarkEncodeRGBA</span><span class="op" id="8475566">(</span><span class="ident" id="8475567">b</span>&nbsp;<span class="op" id="8475569">*</span><span class="ident" id="8475570">testing</span><span class="op" id="8475577">.</span><span class="ident" id="8475578">B</span><span class="op" id="8475579">)</span>&nbsp;<span class="op" id="8475581">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475584">b</span><span class="op" id="8475585">.</span><span class="ident" id="8475586">StopTimer</span><span class="op" id="8475595">(</span><span class="op" id="8475596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475599">img</span>&nbsp;<span class="op" id="8475603">:=</span>&nbsp;<span class="ident" id="8475606">image</span><span class="op" id="8475611">.</span><span class="ident" id="8475612">NewRGBA</span><span class="op" id="8475619">(</span><span class="ident" id="8475620">image</span><span class="op" id="8475625">.</span><span class="ident" id="8475626">Rect</span><span class="op" id="8475630">(</span><span class="num" id="8475631">0</span><span class="op" id="8475632">,</span>&nbsp;<span class="num" id="8475634">0</span><span class="op" id="8475635">,</span>&nbsp;<span class="num" id="8475637">640</span><span class="op" id="8475640">,</span>&nbsp;<span class="num" id="8475642">480</span><span class="op" id="8475645">)</span><span class="op" id="8475646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8475649">if</span>&nbsp;<span class="ident" id="8475652">img</span><span class="op" id="8475655">.</span><span class="ident" id="8475656">Opaque</span><span class="op" id="8475662">(</span><span class="op" id="8475663">)</span>&nbsp;<span class="op" id="8475665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475669">b</span><span class="op" id="8475670">.</span><span class="ident" id="8475671">Fatal</span><span class="op" id="8475676">(</span><span class="string" id="8475677">&#34;expected&nbsp;image&nbsp;not&nbsp;to&nbsp;be&nbsp;opaque&#34;</span><span class="op" id="8475710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8475713">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475716">b</span><span class="op" id="8475717">.</span><span class="ident" id="8475718">SetBytes</span><span class="op" id="8475726">(</span><span class="num" id="8475727">640</span>&nbsp;<span class="op" id="8475731">*</span>&nbsp;<span class="num" id="8475733">480</span>&nbsp;<span class="op" id="8475737">*</span>&nbsp;<span class="num" id="8475739">4</span><span class="op" id="8475740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475743">b</span><span class="op" id="8475744">.</span><span class="ident" id="8475745">StartTimer</span><span class="op" id="8475755">(</span><span class="op" id="8475756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8475759">for</span>&nbsp;<span class="ident" id="8475763">i</span>&nbsp;<span class="op" id="8475765">:=</span>&nbsp;<span class="num" id="8475768">0</span><span class="op" id="8475769">;</span>&nbsp;<span class="ident" id="8475771">i</span>&nbsp;<span class="op" id="8475773">&lt;</span>&nbsp;<span class="ident" id="8475775">b</span><span class="op" id="8475776">.</span><span class="ident" id="8475777">N</span><span class="op" id="8475778">;</span>&nbsp;<span class="ident" id="8475780">i</span><span class="op" id="8475781">++</span>&nbsp;<span class="op" id="8475784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8475788">Encode</span><span class="op" id="8475794">(</span><span class="ident" id="8475795">ioutil</span><span class="op" id="8475801">.</span><span class="ident" id="8475802">Discard</span><span class="op" id="8475809">,</span>&nbsp;<span class="ident" id="8475811">img</span><span class="op" id="8475814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8475817">}</span><br>
<span class="lineno">210</span><span class="op" id="8475819">}</span>
</div>
</body>
</html>
