<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html" class="current">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1685932">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1685987">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1686041">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1686092">package</span>&nbsp;<span class="ident" id="1686100">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1686109">//&nbsp;This&nbsp;file&nbsp;contains&nbsp;the&nbsp;implementation&nbsp;of&nbsp;Go&nbsp;select&nbsp;statements.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1686176">import</span>&nbsp;<span class="string" id="1686183">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="1686193">const</span>&nbsp;<span class="op" id="1686199">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1686202">debugSelect</span>&nbsp;<span class="op" id="1686214">=</span>&nbsp;<span class="builtintype" id="1686216">false</span><br>
<span class="lineno"></span><span class="op" id="1686222">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1686225">var</span>&nbsp;<span class="op" id="1686229">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1686232">chansendpc</span>&nbsp;<span class="op" id="1686243">=</span>&nbsp;<span class="ident" id="1686245"><a href="/gostd/runtime/proc.go.html#1675458">funcPC</a></span><span class="op" id="1686251">(</span><span class="ident" id="1686252"><a href="/gostd/runtime/chan.go.html#1494344">chansend</a></span><span class="op" id="1686260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1686263">chanrecvpc</span>&nbsp;<span class="op" id="1686274">=</span>&nbsp;<span class="ident" id="1686276"><a href="/gostd/runtime/proc.go.html#1675458">funcPC</a></span><span class="op" id="1686282">(</span><span class="ident" id="1686283"><a href="/gostd/runtime/chan.go.html#1499791">chanrecv</a></span><span class="op" id="1686291">)</span><br>
<span class="lineno"></span><span class="op" id="1686293">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="1686296">func</span>&nbsp;<span class="ident" id="1686301">selectsize</span><span class="op" id="1686311">(</span><span class="ident" id="1686312">size</span>&nbsp;<span class="builtintype" id="1686317">uintptr</span><span class="op" id="1686324">)</span>&nbsp;<span class="builtintype" id="1686326">uintptr</span>&nbsp;<span class="op" id="1686334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1686337">selsize</span>&nbsp;<span class="op" id="1686345">:=</span>&nbsp;<span class="ident" id="1686348"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1686354">.</span><span class="ident" id="1686355">Sizeof</span><span class="op" id="1686361">(</span><span class="ident" id="1686362"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1686369">{</span><span class="op" id="1686370">}</span><span class="op" id="1686371">)</span>&nbsp;<span class="op" id="1686373">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1686377">(</span><span class="ident" id="1686378"><a href="/gostd/runtime/select.go.html#1686312">size</a></span><span class="op" id="1686382">-</span><span class="num" id="1686383">1</span><span class="op" id="1686384">)</span><span class="op" id="1686385">*</span><span class="ident" id="1686386"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1686392">.</span><span class="ident" id="1686393">Sizeof</span><span class="op" id="1686399">(</span><span class="ident" id="1686400"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1686407">{</span><span class="op" id="1686408">}</span><span class="op" id="1686409">.</span><span class="ident" id="1686410"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797071">scase</a></span><span class="op" id="1686415">[</span><span class="num" id="1686416">0</span><span class="op" id="1686417">]</span><span class="op" id="1686418">)</span>&nbsp;<span class="op" id="1686420">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1686424"><a href="/gostd/runtime/select.go.html#1686312">size</a></span><span class="op" id="1686428">*</span><span class="ident" id="1686429"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1686435">.</span><span class="ident" id="1686436">Sizeof</span><span class="op" id="1686442">(</span><span class="op" id="1686443">*</span><span class="ident" id="1686444"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1686451">{</span><span class="op" id="1686452">}</span><span class="op" id="1686453">.</span><span class="ident" id="1686454"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797052">lockorder</a></span><span class="op" id="1686463">)</span>&nbsp;<span class="op" id="1686465">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1686469"><a href="/gostd/runtime/select.go.html#1686312">size</a></span><span class="op" id="1686473">*</span><span class="ident" id="1686474"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1686480">.</span><span class="ident" id="1686481">Sizeof</span><span class="op" id="1686487">(</span><span class="op" id="1686488">*</span><span class="ident" id="1686489"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1686496">{</span><span class="op" id="1686497">}</span><span class="op" id="1686498">.</span><span class="ident" id="1686499"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797033">pollorder</a></span><span class="op" id="1686508">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1686511">return</span>&nbsp;<span class="ident" id="1686518"><a href="/gostd/runtime/malloc.go.html#1608519">round</a></span><span class="op" id="1686523">(</span><span class="ident" id="1686524"><a href="/gostd/runtime/select.go.html#1686337">selsize</a></span><span class="op" id="1686531">,</span>&nbsp;<span class="ident" id="1686533"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1791837">_Int64Align</a></span><span class="op" id="1686544">)</span><br>
<span class="lineno"></span><span class="op" id="1686546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1686549">func</span>&nbsp;<span class="ident" id="1686554">newselect</span><span class="op" id="1686563">(</span><span class="ident" id="1686564">sel</span>&nbsp;<span class="op" id="1686568">*</span><span class="ident" id="1686569"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1686576">,</span>&nbsp;<span class="ident" id="1686578">selsize</span>&nbsp;<span class="builtintype" id="1686586">int64</span><span class="op" id="1686591">,</span>&nbsp;<span class="ident" id="1686593">size</span>&nbsp;<span class="builtintype" id="1686598">int32</span><span class="op" id="1686603">)</span>&nbsp;<span class="op" id="1686605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1686608">if</span>&nbsp;<span class="ident" id="1686611"><a href="/gostd/runtime/select.go.html#1686578">selsize</a></span>&nbsp;<span class="op" id="1686619">!=</span>&nbsp;<span class="builtintype" id="1686622">int64</span><span class="op" id="1686627">(</span><span class="ident" id="1686628"><a href="/gostd/runtime/select.go.html#1686301">selectsize</a></span><span class="op" id="1686638">(</span><span class="builtintype" id="1686639">uintptr</span><span class="op" id="1686646">(</span><span class="ident" id="1686647"><a href="/gostd/runtime/select.go.html#1686593">size</a></span><span class="op" id="1686651">)</span><span class="op" id="1686652">)</span><span class="op" id="1686653">)</span>&nbsp;<span class="op" id="1686655">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1686659">print</span><span class="op" id="1686664">(</span><span class="string" id="1686665">&#34;runtime:&nbsp;bad&nbsp;select&nbsp;size&nbsp;&#34;</span><span class="op" id="1686692">,</span>&nbsp;<span class="ident" id="1686694"><a href="/gostd/runtime/select.go.html#1686578">selsize</a></span><span class="op" id="1686701">,</span>&nbsp;<span class="string" id="1686703">&#34;,&nbsp;want&nbsp;&#34;</span><span class="op" id="1686712">,</span>&nbsp;<span class="ident" id="1686714"><a href="/gostd/runtime/select.go.html#1686301">selectsize</a></span><span class="op" id="1686724">(</span><span class="builtintype" id="1686725">uintptr</span><span class="op" id="1686732">(</span><span class="ident" id="1686733"><a href="/gostd/runtime/select.go.html#1686593">size</a></span><span class="op" id="1686737">)</span><span class="op" id="1686738">)</span><span class="op" id="1686739">,</span>&nbsp;<span class="string" id="1686741">&#34;\n&#34;</span><span class="op" id="1686745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1686749"><a href="/gostd/runtime/panic.go.html#1664327">gothrow</a></span><span class="op" id="1686756">(</span><span class="string" id="1686757">&#34;bad&nbsp;select&nbsp;size&#34;</span><span class="op" id="1686774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1686777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1686780"><a href="/gostd/runtime/select.go.html#1686564">sel</a></span><span class="op" id="1686783">.</span><span class="ident" id="1686784"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797005">tcase</a></span>&nbsp;<span class="op" id="1686790">=</span>&nbsp;<span class="builtintype" id="1686792">uint16</span><span class="op" id="1686798">(</span><span class="ident" id="1686799"><a href="/gostd/runtime/select.go.html#1686593">size</a></span><span class="op" id="1686803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1686806"><a href="/gostd/runtime/select.go.html#1686564">sel</a></span><span class="op" id="1686809">.</span><span class="ident" id="1686810"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span>&nbsp;<span class="op" id="1686816">=</span>&nbsp;<span class="num" id="1686818">0</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1686821"><a href="/gostd/runtime/select.go.html#1686564">sel</a></span><span class="op" id="1686824">.</span><span class="ident" id="1686825"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797052">lockorder</a></span>&nbsp;<span class="op" id="1686835">=</span>&nbsp;<span class="op" id="1686837">(</span><span class="op" id="1686838">*</span><span class="op" id="1686839">*</span><span class="ident" id="1686840"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796621">hchan</a></span><span class="op" id="1686845">)</span><span class="op" id="1686846">(</span><span class="ident" id="1686847"><a href="/gostd/runtime/stubs.go.html#1738643">add</a></span><span class="op" id="1686850">(</span><span class="ident" id="1686851"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1686857">.</span><span class="ident" id="1686858">Pointer</span><span class="op" id="1686865">(</span><span class="op" id="1686866">&amp;</span><span class="ident" id="1686867"><a href="/gostd/runtime/select.go.html#1686564">sel</a></span><span class="op" id="1686870">.</span><span class="ident" id="1686871"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797071">scase</a></span><span class="op" id="1686876">)</span><span class="op" id="1686877">,</span>&nbsp;<span class="builtintype" id="1686879">uintptr</span><span class="op" id="1686886">(</span><span class="ident" id="1686887"><a href="/gostd/runtime/select.go.html#1686593">size</a></span><span class="op" id="1686891">)</span><span class="op" id="1686892">*</span><span class="ident" id="1686893"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1686899">.</span><span class="ident" id="1686900">Sizeof</span><span class="op" id="1686906">(</span><span class="ident" id="1686907"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1686914">{</span><span class="op" id="1686915">}</span><span class="op" id="1686916">.</span><span class="ident" id="1686917"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797071">scase</a></span><span class="op" id="1686922">[</span><span class="num" id="1686923">0</span><span class="op" id="1686924">]</span><span class="op" id="1686925">)</span><span class="op" id="1686926">)</span><span class="op" id="1686927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1686930"><a href="/gostd/runtime/select.go.html#1686564">sel</a></span><span class="op" id="1686933">.</span><span class="ident" id="1686934"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797033">pollorder</a></span>&nbsp;<span class="op" id="1686944">=</span>&nbsp;<span class="op" id="1686946">(</span><span class="op" id="1686947">*</span><span class="builtintype" id="1686948">uint16</span><span class="op" id="1686954">)</span><span class="op" id="1686955">(</span><span class="ident" id="1686956"><a href="/gostd/runtime/stubs.go.html#1738643">add</a></span><span class="op" id="1686959">(</span><span class="ident" id="1686960"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1686966">.</span><span class="ident" id="1686967">Pointer</span><span class="op" id="1686974">(</span><span class="ident" id="1686975"><a href="/gostd/runtime/select.go.html#1686564">sel</a></span><span class="op" id="1686978">.</span><span class="ident" id="1686979"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797052">lockorder</a></span><span class="op" id="1686988">)</span><span class="op" id="1686989">,</span>&nbsp;<span class="builtintype" id="1686991">uintptr</span><span class="op" id="1686998">(</span><span class="ident" id="1686999"><a href="/gostd/runtime/select.go.html#1686593">size</a></span><span class="op" id="1687003">)</span><span class="op" id="1687004">*</span><span class="ident" id="1687005"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1687011">.</span><span class="ident" id="1687012">Sizeof</span><span class="op" id="1687018">(</span><span class="op" id="1687019">*</span><span class="ident" id="1687020"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1687027">{</span><span class="op" id="1687028">}</span><span class="op" id="1687029">.</span><span class="ident" id="1687030"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797052">lockorder</a></span><span class="op" id="1687039">)</span><span class="op" id="1687040">)</span><span class="op" id="1687041">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1687045">if</span>&nbsp;<span class="ident" id="1687048"><a href="/gostd/runtime/select.go.html#1686202">debugSelect</a></span>&nbsp;<span class="op" id="1687060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1687064">print</span><span class="op" id="1687069">(</span><span class="string" id="1687070">&#34;newselect&nbsp;s=&#34;</span><span class="op" id="1687084">,</span>&nbsp;<span class="ident" id="1687086"><a href="/gostd/runtime/select.go.html#1686564">sel</a></span><span class="op" id="1687089">,</span>&nbsp;<span class="string" id="1687091">&#34;&nbsp;size=&#34;</span><span class="op" id="1687099">,</span>&nbsp;<span class="ident" id="1687101"><a href="/gostd/runtime/select.go.html#1686593">size</a></span><span class="op" id="1687105">,</span>&nbsp;<span class="string" id="1687107">&#34;\n&#34;</span><span class="op" id="1687111">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1687114">}</span><br>
<span class="lineno"></span><span class="op" id="1687116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1687119">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1687132">func</span>&nbsp;<span class="ident" id="1687137">selectsend</span><span class="op" id="1687147">(</span><span class="ident" id="1687148">sel</span>&nbsp;<span class="op" id="1687152">*</span><span class="ident" id="1687153"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1687160">,</span>&nbsp;<span class="ident" id="1687162">c</span>&nbsp;<span class="op" id="1687164">*</span><span class="ident" id="1687165"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796621">hchan</a></span><span class="op" id="1687170">,</span>&nbsp;<span class="ident" id="1687172">elem</span>&nbsp;<span class="ident" id="1687177"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1687183">.</span><span class="ident" id="1687184">Pointer</span><span class="op" id="1687191">)</span>&nbsp;<span class="op" id="1687193">(</span><span class="ident" id="1687194">selected</span>&nbsp;<span class="builtintype" id="1687203">bool</span><span class="op" id="1687207">)</span>&nbsp;<span class="op" id="1687209">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1687212">//&nbsp;nil&nbsp;cases&nbsp;do&nbsp;not&nbsp;compete</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1687241">if</span>&nbsp;<span class="ident" id="1687244"><a href="/gostd/runtime/select.go.html#1687162">c</a></span>&nbsp;<span class="op" id="1687246">!=</span>&nbsp;<span class="builtintype" id="1687249">nil</span>&nbsp;<span class="op" id="1687253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1687257"><a href="/gostd/runtime/select.go.html#1687453">selectsendImpl</a></span><span class="op" id="1687271">(</span><span class="ident" id="1687272"><a href="/gostd/runtime/select.go.html#1687148">sel</a></span><span class="op" id="1687275">,</span>&nbsp;<span class="ident" id="1687277"><a href="/gostd/runtime/select.go.html#1687162">c</a></span><span class="op" id="1687278">,</span>&nbsp;<span class="ident" id="1687280"><a href="/gostd/runtime/stubs.go.html#1746397">getcallerpc</a></span><span class="op" id="1687291">(</span><span class="ident" id="1687292"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1687298">.</span><span class="ident" id="1687299">Pointer</span><span class="op" id="1687306">(</span><span class="op" id="1687307">&amp;</span><span class="ident" id="1687308"><a href="/gostd/runtime/select.go.html#1687148">sel</a></span><span class="op" id="1687311">)</span><span class="op" id="1687312">)</span><span class="op" id="1687313">,</span>&nbsp;<span class="ident" id="1687315"><a href="/gostd/runtime/select.go.html#1687172">elem</a></span><span class="op" id="1687319">,</span>&nbsp;<span class="builtintype" id="1687321">uintptr</span><span class="op" id="1687328">(</span><span class="ident" id="1687329"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1687335">.</span><span class="ident" id="1687336">Pointer</span><span class="op" id="1687343">(</span><span class="op" id="1687344">&amp;</span><span class="ident" id="1687345"><a href="/gostd/runtime/select.go.html#1687194">selected</a></span><span class="op" id="1687353">)</span><span class="op" id="1687354">)</span><span class="op" id="1687355">-</span><span class="builtintype" id="1687356">uintptr</span><span class="op" id="1687363">(</span><span class="ident" id="1687364"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1687370">.</span><span class="ident" id="1687371">Pointer</span><span class="op" id="1687378">(</span><span class="op" id="1687379">&amp;</span><span class="ident" id="1687380"><a href="/gostd/runtime/select.go.html#1687148">sel</a></span><span class="op" id="1687383">)</span><span class="op" id="1687384">)</span><span class="op" id="1687385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1687388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1687391">return</span><br>
<span class="lineno">50</span><span class="op" id="1687398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1687401">//&nbsp;cut&nbsp;in&nbsp;half&nbsp;to&nbsp;give&nbsp;stack&nbsp;a&nbsp;chance&nbsp;to&nbsp;split</span><br>
<span class="lineno"></span><span class="keyword" id="1687448">func</span>&nbsp;<span class="ident" id="1687453">selectsendImpl</span><span class="op" id="1687467">(</span><span class="ident" id="1687468">sel</span>&nbsp;<span class="op" id="1687472">*</span><span class="ident" id="1687473"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1687480">,</span>&nbsp;<span class="ident" id="1687482">c</span>&nbsp;<span class="op" id="1687484">*</span><span class="ident" id="1687485"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796621">hchan</a></span><span class="op" id="1687490">,</span>&nbsp;<span class="ident" id="1687492">pc</span>&nbsp;<span class="builtintype" id="1687495">uintptr</span><span class="op" id="1687502">,</span>&nbsp;<span class="ident" id="1687504">elem</span>&nbsp;<span class="ident" id="1687509"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1687515">.</span><span class="ident" id="1687516">Pointer</span><span class="op" id="1687523">,</span>&nbsp;<span class="ident" id="1687525">so</span>&nbsp;<span class="builtintype" id="1687528">uintptr</span><span class="op" id="1687535">)</span>&nbsp;<span class="op" id="1687537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1687540">i</span>&nbsp;<span class="op" id="1687542">:=</span>&nbsp;<span class="ident" id="1687545"><a href="/gostd/runtime/select.go.html#1687468">sel</a></span><span class="op" id="1687548">.</span><span class="ident" id="1687549"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1687556">if</span>&nbsp;<span class="ident" id="1687559"><a href="/gostd/runtime/select.go.html#1687540">i</a></span>&nbsp;<span class="op" id="1687561">&gt;=</span>&nbsp;<span class="ident" id="1687564"><a href="/gostd/runtime/select.go.html#1687468">sel</a></span><span class="op" id="1687567">.</span><span class="ident" id="1687568"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797005">tcase</a></span>&nbsp;<span class="op" id="1687574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1687578"><a href="/gostd/runtime/panic.go.html#1664327">gothrow</a></span><span class="op" id="1687585">(</span><span class="string" id="1687586">&#34;selectsend:&nbsp;too&nbsp;many&nbsp;cases&#34;</span><span class="op" id="1687614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1687617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1687620"><a href="/gostd/runtime/select.go.html#1687468">sel</a></span><span class="op" id="1687623">.</span><span class="ident" id="1687624"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span>&nbsp;<span class="op" id="1687630">=</span>&nbsp;<span class="ident" id="1687632"><a href="/gostd/runtime/select.go.html#1687540">i</a></span>&nbsp;<span class="op" id="1687634">+</span>&nbsp;<span class="num" id="1687636">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1687639">cas</span>&nbsp;<span class="op" id="1687643">:=</span>&nbsp;<span class="op" id="1687646">(</span><span class="op" id="1687647">*</span><span class="ident" id="1687648"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796857">scase</a></span><span class="op" id="1687653">)</span><span class="op" id="1687654">(</span><span class="ident" id="1687655"><a href="/gostd/runtime/stubs.go.html#1738643">add</a></span><span class="op" id="1687658">(</span><span class="ident" id="1687659"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1687665">.</span><span class="ident" id="1687666">Pointer</span><span class="op" id="1687673">(</span><span class="op" id="1687674">&amp;</span><span class="ident" id="1687675"><a href="/gostd/runtime/select.go.html#1687468">sel</a></span><span class="op" id="1687678">.</span><span class="ident" id="1687679"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797071">scase</a></span><span class="op" id="1687684">)</span><span class="op" id="1687685">,</span>&nbsp;<span class="builtintype" id="1687687">uintptr</span><span class="op" id="1687694">(</span><span class="ident" id="1687695"><a href="/gostd/runtime/select.go.html#1687540">i</a></span><span class="op" id="1687696">)</span><span class="op" id="1687697">*</span><span class="ident" id="1687698"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1687704">.</span><span class="ident" id="1687705">Sizeof</span><span class="op" id="1687711">(</span><span class="ident" id="1687712"><a href="/gostd/runtime/select.go.html#1687468">sel</a></span><span class="op" id="1687715">.</span><span class="ident" id="1687716"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797071">scase</a></span><span class="op" id="1687721">[</span><span class="num" id="1687722">0</span><span class="op" id="1687723">]</span><span class="op" id="1687724">)</span><span class="op" id="1687725">)</span><span class="op" id="1687726">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1687730"><a href="/gostd/runtime/select.go.html#1687639">cas</a></span><span class="op" id="1687733">.</span><span class="ident" id="1687734"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796908">pc</a></span>&nbsp;<span class="op" id="1687737">=</span>&nbsp;<span class="ident" id="1687739"><a href="/gostd/runtime/select.go.html#1687492">pc</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1687743"><a href="/gostd/runtime/select.go.html#1687639">cas</a></span><span class="op" id="1687746">.</span><span class="ident" id="1687747"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796894">_chan</a></span>&nbsp;<span class="op" id="1687753">=</span>&nbsp;<span class="ident" id="1687755"><a href="/gostd/runtime/select.go.html#1687482">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1687758"><a href="/gostd/runtime/select.go.html#1687639">cas</a></span><span class="op" id="1687761">.</span><span class="ident" id="1687762"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796933">so</a></span>&nbsp;<span class="op" id="1687765">=</span>&nbsp;<span class="builtintype" id="1687767">uint16</span><span class="op" id="1687773">(</span><span class="ident" id="1687774"><a href="/gostd/runtime/select.go.html#1687525">so</a></span><span class="op" id="1687776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1687779"><a href="/gostd/runtime/select.go.html#1687639">cas</a></span><span class="op" id="1687782">.</span><span class="ident" id="1687783"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796920">kind</a></span>&nbsp;<span class="op" id="1687788">=</span>&nbsp;<span class="ident" id="1687790"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796815">_CaseSend</a></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1687801"><a href="/gostd/runtime/select.go.html#1687639">cas</a></span><span class="op" id="1687804">.</span><span class="ident" id="1687805"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span>&nbsp;<span class="op" id="1687810">=</span>&nbsp;<span class="ident" id="1687812"><a href="/gostd/runtime/select.go.html#1687504">elem</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1687819">if</span>&nbsp;<span class="ident" id="1687822"><a href="/gostd/runtime/select.go.html#1686202">debugSelect</a></span>&nbsp;<span class="op" id="1687834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1687838">print</span><span class="op" id="1687843">(</span><span class="string" id="1687844">&#34;selectsend&nbsp;s=&#34;</span><span class="op" id="1687859">,</span>&nbsp;<span class="ident" id="1687861"><a href="/gostd/runtime/select.go.html#1687468">sel</a></span><span class="op" id="1687864">,</span>&nbsp;<span class="string" id="1687866">&#34;&nbsp;pc=&#34;</span><span class="op" id="1687872">,</span>&nbsp;<span class="ident" id="1687874"><a href="/gostd/runtime/print1.go.html#1664817">hex</a></span><span class="op" id="1687877">(</span><span class="ident" id="1687878"><a href="/gostd/runtime/select.go.html#1687639">cas</a></span><span class="op" id="1687881">.</span><span class="ident" id="1687882"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796908">pc</a></span><span class="op" id="1687884">)</span><span class="op" id="1687885">,</span>&nbsp;<span class="string" id="1687887">&#34;&nbsp;chan=&#34;</span><span class="op" id="1687895">,</span>&nbsp;<span class="ident" id="1687897"><a href="/gostd/runtime/select.go.html#1687639">cas</a></span><span class="op" id="1687900">.</span><span class="ident" id="1687901"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796894">_chan</a></span><span class="op" id="1687906">,</span>&nbsp;<span class="string" id="1687908">&#34;&nbsp;so=&#34;</span><span class="op" id="1687914">,</span>&nbsp;<span class="ident" id="1687916"><a href="/gostd/runtime/select.go.html#1687639">cas</a></span><span class="op" id="1687919">.</span><span class="ident" id="1687920"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796933">so</a></span><span class="op" id="1687922">,</span>&nbsp;<span class="string" id="1687924">&#34;\n&#34;</span><span class="op" id="1687928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1687931">}</span><br>
<span class="lineno">70</span><span class="op" id="1687933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1687936">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1687949">func</span>&nbsp;<span class="ident" id="1687954">selectrecv</span><span class="op" id="1687964">(</span><span class="ident" id="1687965">sel</span>&nbsp;<span class="op" id="1687969">*</span><span class="ident" id="1687970"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1687977">,</span>&nbsp;<span class="ident" id="1687979">c</span>&nbsp;<span class="op" id="1687981">*</span><span class="ident" id="1687982"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796621">hchan</a></span><span class="op" id="1687987">,</span>&nbsp;<span class="ident" id="1687989">elem</span>&nbsp;<span class="ident" id="1687994"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1688000">.</span><span class="ident" id="1688001">Pointer</span><span class="op" id="1688008">)</span>&nbsp;<span class="op" id="1688010">(</span><span class="ident" id="1688011">selected</span>&nbsp;<span class="builtintype" id="1688020">bool</span><span class="op" id="1688024">)</span>&nbsp;<span class="op" id="1688026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1688029">//&nbsp;nil&nbsp;cases&nbsp;do&nbsp;not&nbsp;compete</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1688058">if</span>&nbsp;<span class="ident" id="1688061"><a href="/gostd/runtime/select.go.html#1687979">c</a></span>&nbsp;<span class="op" id="1688063">!=</span>&nbsp;<span class="builtintype" id="1688066">nil</span>&nbsp;<span class="op" id="1688070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1688074"><a href="/gostd/runtime/select.go.html#1688537">selectrecvImpl</a></span><span class="op" id="1688088">(</span><span class="ident" id="1688089"><a href="/gostd/runtime/select.go.html#1687965">sel</a></span><span class="op" id="1688092">,</span>&nbsp;<span class="ident" id="1688094"><a href="/gostd/runtime/select.go.html#1687979">c</a></span><span class="op" id="1688095">,</span>&nbsp;<span class="ident" id="1688097"><a href="/gostd/runtime/stubs.go.html#1746397">getcallerpc</a></span><span class="op" id="1688108">(</span><span class="ident" id="1688109"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1688115">.</span><span class="ident" id="1688116">Pointer</span><span class="op" id="1688123">(</span><span class="op" id="1688124">&amp;</span><span class="ident" id="1688125"><a href="/gostd/runtime/select.go.html#1687965">sel</a></span><span class="op" id="1688128">)</span><span class="op" id="1688129">)</span><span class="op" id="1688130">,</span>&nbsp;<span class="ident" id="1688132"><a href="/gostd/runtime/select.go.html#1687989">elem</a></span><span class="op" id="1688136">,</span>&nbsp;<span class="builtintype" id="1688138">nil</span><span class="op" id="1688141">,</span>&nbsp;<span class="builtintype" id="1688143">uintptr</span><span class="op" id="1688150">(</span><span class="ident" id="1688151"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1688157">.</span><span class="ident" id="1688158">Pointer</span><span class="op" id="1688165">(</span><span class="op" id="1688166">&amp;</span><span class="ident" id="1688167"><a href="/gostd/runtime/select.go.html#1688011">selected</a></span><span class="op" id="1688175">)</span><span class="op" id="1688176">)</span><span class="op" id="1688177">-</span><span class="builtintype" id="1688178">uintptr</span><span class="op" id="1688185">(</span><span class="ident" id="1688186"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1688192">.</span><span class="ident" id="1688193">Pointer</span><span class="op" id="1688200">(</span><span class="op" id="1688201">&amp;</span><span class="ident" id="1688202"><a href="/gostd/runtime/select.go.html#1687965">sel</a></span><span class="op" id="1688205">)</span><span class="op" id="1688206">)</span><span class="op" id="1688207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1688210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1688213">return</span><br>
<span class="lineno"></span><span class="op" id="1688220">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="1688223">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1688236">func</span>&nbsp;<span class="ident" id="1688241">selectrecv2</span><span class="op" id="1688252">(</span><span class="ident" id="1688253">sel</span>&nbsp;<span class="op" id="1688257">*</span><span class="ident" id="1688258"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1688265">,</span>&nbsp;<span class="ident" id="1688267">c</span>&nbsp;<span class="op" id="1688269">*</span><span class="ident" id="1688270"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796621">hchan</a></span><span class="op" id="1688275">,</span>&nbsp;<span class="ident" id="1688277">elem</span>&nbsp;<span class="ident" id="1688282"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1688288">.</span><span class="ident" id="1688289">Pointer</span><span class="op" id="1688296">,</span>&nbsp;<span class="ident" id="1688298">received</span>&nbsp;<span class="op" id="1688307">*</span><span class="builtintype" id="1688308">bool</span><span class="op" id="1688312">)</span>&nbsp;<span class="op" id="1688314">(</span><span class="ident" id="1688315">selected</span>&nbsp;<span class="builtintype" id="1688324">bool</span><span class="op" id="1688328">)</span>&nbsp;<span class="op" id="1688330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1688333">//&nbsp;nil&nbsp;cases&nbsp;do&nbsp;not&nbsp;compete</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1688362">if</span>&nbsp;<span class="ident" id="1688365"><a href="/gostd/runtime/select.go.html#1688267">c</a></span>&nbsp;<span class="op" id="1688367">!=</span>&nbsp;<span class="builtintype" id="1688370">nil</span>&nbsp;<span class="op" id="1688374">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1688378"><a href="/gostd/runtime/select.go.html#1688537">selectrecvImpl</a></span><span class="op" id="1688392">(</span><span class="ident" id="1688393"><a href="/gostd/runtime/select.go.html#1688253">sel</a></span><span class="op" id="1688396">,</span>&nbsp;<span class="ident" id="1688398"><a href="/gostd/runtime/select.go.html#1688267">c</a></span><span class="op" id="1688399">,</span>&nbsp;<span class="ident" id="1688401"><a href="/gostd/runtime/stubs.go.html#1746397">getcallerpc</a></span><span class="op" id="1688412">(</span><span class="ident" id="1688413"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1688419">.</span><span class="ident" id="1688420">Pointer</span><span class="op" id="1688427">(</span><span class="op" id="1688428">&amp;</span><span class="ident" id="1688429"><a href="/gostd/runtime/select.go.html#1688253">sel</a></span><span class="op" id="1688432">)</span><span class="op" id="1688433">)</span><span class="op" id="1688434">,</span>&nbsp;<span class="ident" id="1688436"><a href="/gostd/runtime/select.go.html#1688277">elem</a></span><span class="op" id="1688440">,</span>&nbsp;<span class="ident" id="1688442"><a href="/gostd/runtime/select.go.html#1688298">received</a></span><span class="op" id="1688450">,</span>&nbsp;<span class="builtintype" id="1688452">uintptr</span><span class="op" id="1688459">(</span><span class="ident" id="1688460"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1688466">.</span><span class="ident" id="1688467">Pointer</span><span class="op" id="1688474">(</span><span class="op" id="1688475">&amp;</span><span class="ident" id="1688476"><a href="/gostd/runtime/select.go.html#1688315">selected</a></span><span class="op" id="1688484">)</span><span class="op" id="1688485">)</span><span class="op" id="1688486">-</span><span class="builtintype" id="1688487">uintptr</span><span class="op" id="1688494">(</span><span class="ident" id="1688495"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1688501">.</span><span class="ident" id="1688502">Pointer</span><span class="op" id="1688509">(</span><span class="op" id="1688510">&amp;</span><span class="ident" id="1688511"><a href="/gostd/runtime/select.go.html#1688253">sel</a></span><span class="op" id="1688514">)</span><span class="op" id="1688515">)</span><span class="op" id="1688516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1688519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1688522">return</span><br>
<span class="lineno"></span><span class="op" id="1688529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="1688532">func</span>&nbsp;<span class="ident" id="1688537">selectrecvImpl</span><span class="op" id="1688551">(</span><span class="ident" id="1688552">sel</span>&nbsp;<span class="op" id="1688556">*</span><span class="ident" id="1688557"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1688564">,</span>&nbsp;<span class="ident" id="1688566">c</span>&nbsp;<span class="op" id="1688568">*</span><span class="ident" id="1688569"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796621">hchan</a></span><span class="op" id="1688574">,</span>&nbsp;<span class="ident" id="1688576">pc</span>&nbsp;<span class="builtintype" id="1688579">uintptr</span><span class="op" id="1688586">,</span>&nbsp;<span class="ident" id="1688588">elem</span>&nbsp;<span class="ident" id="1688593"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1688599">.</span><span class="ident" id="1688600">Pointer</span><span class="op" id="1688607">,</span>&nbsp;<span class="ident" id="1688609">received</span>&nbsp;<span class="op" id="1688618">*</span><span class="builtintype" id="1688619">bool</span><span class="op" id="1688623">,</span>&nbsp;<span class="ident" id="1688625">so</span>&nbsp;<span class="builtintype" id="1688628">uintptr</span><span class="op" id="1688635">)</span>&nbsp;<span class="op" id="1688637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1688640">i</span>&nbsp;<span class="op" id="1688642">:=</span>&nbsp;<span class="ident" id="1688645"><a href="/gostd/runtime/select.go.html#1688552">sel</a></span><span class="op" id="1688648">.</span><span class="ident" id="1688649"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1688656">if</span>&nbsp;<span class="ident" id="1688659"><a href="/gostd/runtime/select.go.html#1688640">i</a></span>&nbsp;<span class="op" id="1688661">&gt;=</span>&nbsp;<span class="ident" id="1688664"><a href="/gostd/runtime/select.go.html#1688552">sel</a></span><span class="op" id="1688667">.</span><span class="ident" id="1688668"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797005">tcase</a></span>&nbsp;<span class="op" id="1688674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1688678"><a href="/gostd/runtime/panic.go.html#1664327">gothrow</a></span><span class="op" id="1688685">(</span><span class="string" id="1688686">&#34;selectrecv:&nbsp;too&nbsp;many&nbsp;cases&#34;</span><span class="op" id="1688714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1688717">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1688720"><a href="/gostd/runtime/select.go.html#1688552">sel</a></span><span class="op" id="1688723">.</span><span class="ident" id="1688724"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span>&nbsp;<span class="op" id="1688730">=</span>&nbsp;<span class="ident" id="1688732"><a href="/gostd/runtime/select.go.html#1688640">i</a></span>&nbsp;<span class="op" id="1688734">+</span>&nbsp;<span class="num" id="1688736">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1688739">cas</span>&nbsp;<span class="op" id="1688743">:=</span>&nbsp;<span class="op" id="1688746">(</span><span class="op" id="1688747">*</span><span class="ident" id="1688748"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796857">scase</a></span><span class="op" id="1688753">)</span><span class="op" id="1688754">(</span><span class="ident" id="1688755"><a href="/gostd/runtime/stubs.go.html#1738643">add</a></span><span class="op" id="1688758">(</span><span class="ident" id="1688759"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1688765">.</span><span class="ident" id="1688766">Pointer</span><span class="op" id="1688773">(</span><span class="op" id="1688774">&amp;</span><span class="ident" id="1688775"><a href="/gostd/runtime/select.go.html#1688552">sel</a></span><span class="op" id="1688778">.</span><span class="ident" id="1688779"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797071">scase</a></span><span class="op" id="1688784">)</span><span class="op" id="1688785">,</span>&nbsp;<span class="builtintype" id="1688787">uintptr</span><span class="op" id="1688794">(</span><span class="ident" id="1688795"><a href="/gostd/runtime/select.go.html#1688640">i</a></span><span class="op" id="1688796">)</span><span class="op" id="1688797">*</span><span class="ident" id="1688798"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1688804">.</span><span class="ident" id="1688805">Sizeof</span><span class="op" id="1688811">(</span><span class="ident" id="1688812"><a href="/gostd/runtime/select.go.html#1688552">sel</a></span><span class="op" id="1688815">.</span><span class="ident" id="1688816"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797071">scase</a></span><span class="op" id="1688821">[</span><span class="num" id="1688822">0</span><span class="op" id="1688823">]</span><span class="op" id="1688824">)</span><span class="op" id="1688825">)</span><span class="op" id="1688826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1688829"><a href="/gostd/runtime/select.go.html#1688739">cas</a></span><span class="op" id="1688832">.</span><span class="ident" id="1688833"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796908">pc</a></span>&nbsp;<span class="op" id="1688836">=</span>&nbsp;<span class="ident" id="1688838"><a href="/gostd/runtime/select.go.html#1688576">pc</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1688842"><a href="/gostd/runtime/select.go.html#1688739">cas</a></span><span class="op" id="1688845">.</span><span class="ident" id="1688846"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796894">_chan</a></span>&nbsp;<span class="op" id="1688852">=</span>&nbsp;<span class="ident" id="1688854"><a href="/gostd/runtime/select.go.html#1688566">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1688857"><a href="/gostd/runtime/select.go.html#1688739">cas</a></span><span class="op" id="1688860">.</span><span class="ident" id="1688861"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796933">so</a></span>&nbsp;<span class="op" id="1688864">=</span>&nbsp;<span class="builtintype" id="1688866">uint16</span><span class="op" id="1688872">(</span><span class="ident" id="1688873"><a href="/gostd/runtime/select.go.html#1688625">so</a></span><span class="op" id="1688875">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1688878"><a href="/gostd/runtime/select.go.html#1688739">cas</a></span><span class="op" id="1688881">.</span><span class="ident" id="1688882"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796920">kind</a></span>&nbsp;<span class="op" id="1688887">=</span>&nbsp;<span class="ident" id="1688889"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796795">_CaseRecv</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1688900"><a href="/gostd/runtime/select.go.html#1688739">cas</a></span><span class="op" id="1688903">.</span><span class="ident" id="1688904"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span>&nbsp;<span class="op" id="1688909">=</span>&nbsp;<span class="ident" id="1688911"><a href="/gostd/runtime/select.go.html#1688588">elem</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1688917"><a href="/gostd/runtime/select.go.html#1688739">cas</a></span><span class="op" id="1688920">.</span><span class="ident" id="1688921"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796944">receivedp</a></span>&nbsp;<span class="op" id="1688931">=</span>&nbsp;<span class="ident" id="1688933"><a href="/gostd/runtime/select.go.html#1688609">received</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1688944">if</span>&nbsp;<span class="ident" id="1688947"><a href="/gostd/runtime/select.go.html#1686202">debugSelect</a></span>&nbsp;<span class="op" id="1688959">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1688963">print</span><span class="op" id="1688968">(</span><span class="string" id="1688969">&#34;selectrecv&nbsp;s=&#34;</span><span class="op" id="1688984">,</span>&nbsp;<span class="ident" id="1688986"><a href="/gostd/runtime/select.go.html#1688552">sel</a></span><span class="op" id="1688989">,</span>&nbsp;<span class="string" id="1688991">&#34;&nbsp;pc=&#34;</span><span class="op" id="1688997">,</span>&nbsp;<span class="ident" id="1688999"><a href="/gostd/runtime/print1.go.html#1664817">hex</a></span><span class="op" id="1689002">(</span><span class="ident" id="1689003"><a href="/gostd/runtime/select.go.html#1688739">cas</a></span><span class="op" id="1689006">.</span><span class="ident" id="1689007"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796908">pc</a></span><span class="op" id="1689009">)</span><span class="op" id="1689010">,</span>&nbsp;<span class="string" id="1689012">&#34;&nbsp;chan=&#34;</span><span class="op" id="1689020">,</span>&nbsp;<span class="ident" id="1689022"><a href="/gostd/runtime/select.go.html#1688739">cas</a></span><span class="op" id="1689025">.</span><span class="ident" id="1689026"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796894">_chan</a></span><span class="op" id="1689031">,</span>&nbsp;<span class="string" id="1689033">&#34;&nbsp;so=&#34;</span><span class="op" id="1689039">,</span>&nbsp;<span class="ident" id="1689041"><a href="/gostd/runtime/select.go.html#1688739">cas</a></span><span class="op" id="1689044">.</span><span class="ident" id="1689045"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796933">so</a></span><span class="op" id="1689047">,</span>&nbsp;<span class="string" id="1689049">&#34;\n&#34;</span><span class="op" id="1689053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1689056">}</span><br>
<span class="lineno"></span><span class="op" id="1689058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1689061">//go:nosplit</span><br>
<span class="lineno">110</span><span class="keyword" id="1689074">func</span>&nbsp;<span class="ident" id="1689079">selectdefault</span><span class="op" id="1689092">(</span><span class="ident" id="1689093">sel</span>&nbsp;<span class="op" id="1689097">*</span><span class="ident" id="1689098"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1689105">)</span>&nbsp;<span class="op" id="1689107">(</span><span class="ident" id="1689108">selected</span>&nbsp;<span class="builtintype" id="1689117">bool</span><span class="op" id="1689121">)</span>&nbsp;<span class="op" id="1689123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689126"><a href="/gostd/runtime/select.go.html#1689266">selectdefaultImpl</a></span><span class="op" id="1689143">(</span><span class="ident" id="1689144"><a href="/gostd/runtime/select.go.html#1689093">sel</a></span><span class="op" id="1689147">,</span>&nbsp;<span class="ident" id="1689149"><a href="/gostd/runtime/stubs.go.html#1746397">getcallerpc</a></span><span class="op" id="1689160">(</span><span class="ident" id="1689161"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1689167">.</span><span class="ident" id="1689168">Pointer</span><span class="op" id="1689175">(</span><span class="op" id="1689176">&amp;</span><span class="ident" id="1689177"><a href="/gostd/runtime/select.go.html#1689093">sel</a></span><span class="op" id="1689180">)</span><span class="op" id="1689181">)</span><span class="op" id="1689182">,</span>&nbsp;<span class="builtintype" id="1689184">uintptr</span><span class="op" id="1689191">(</span><span class="ident" id="1689192"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1689198">.</span><span class="ident" id="1689199">Pointer</span><span class="op" id="1689206">(</span><span class="op" id="1689207">&amp;</span><span class="ident" id="1689208"><a href="/gostd/runtime/select.go.html#1689108">selected</a></span><span class="op" id="1689216">)</span><span class="op" id="1689217">)</span><span class="op" id="1689218">-</span><span class="builtintype" id="1689219">uintptr</span><span class="op" id="1689226">(</span><span class="ident" id="1689227"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1689233">.</span><span class="ident" id="1689234">Pointer</span><span class="op" id="1689241">(</span><span class="op" id="1689242">&amp;</span><span class="ident" id="1689243"><a href="/gostd/runtime/select.go.html#1689093">sel</a></span><span class="op" id="1689246">)</span><span class="op" id="1689247">)</span><span class="op" id="1689248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1689251">return</span><br>
<span class="lineno"></span><span class="op" id="1689258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="1689261">func</span>&nbsp;<span class="ident" id="1689266">selectdefaultImpl</span><span class="op" id="1689283">(</span><span class="ident" id="1689284">sel</span>&nbsp;<span class="op" id="1689288">*</span><span class="ident" id="1689289"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1689296">,</span>&nbsp;<span class="ident" id="1689298">callerpc</span>&nbsp;<span class="builtintype" id="1689307">uintptr</span><span class="op" id="1689314">,</span>&nbsp;<span class="ident" id="1689316">so</span>&nbsp;<span class="builtintype" id="1689319">uintptr</span><span class="op" id="1689326">)</span>&nbsp;<span class="op" id="1689328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689331">i</span>&nbsp;<span class="op" id="1689333">:=</span>&nbsp;<span class="ident" id="1689336"><a href="/gostd/runtime/select.go.html#1689284">sel</a></span><span class="op" id="1689339">.</span><span class="ident" id="1689340"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1689347">if</span>&nbsp;<span class="ident" id="1689350"><a href="/gostd/runtime/select.go.html#1689331">i</a></span>&nbsp;<span class="op" id="1689352">&gt;=</span>&nbsp;<span class="ident" id="1689355"><a href="/gostd/runtime/select.go.html#1689284">sel</a></span><span class="op" id="1689358">.</span><span class="ident" id="1689359"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797005">tcase</a></span>&nbsp;<span class="op" id="1689365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689369"><a href="/gostd/runtime/panic.go.html#1664327">gothrow</a></span><span class="op" id="1689376">(</span><span class="string" id="1689377">&#34;selectdefault:&nbsp;too&nbsp;many&nbsp;cases&#34;</span><span class="op" id="1689408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1689411">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689414"><a href="/gostd/runtime/select.go.html#1689284">sel</a></span><span class="op" id="1689417">.</span><span class="ident" id="1689418"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span>&nbsp;<span class="op" id="1689424">=</span>&nbsp;<span class="ident" id="1689426"><a href="/gostd/runtime/select.go.html#1689331">i</a></span>&nbsp;<span class="op" id="1689428">+</span>&nbsp;<span class="num" id="1689430">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689433">cas</span>&nbsp;<span class="op" id="1689437">:=</span>&nbsp;<span class="op" id="1689440">(</span><span class="op" id="1689441">*</span><span class="ident" id="1689442"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796857">scase</a></span><span class="op" id="1689447">)</span><span class="op" id="1689448">(</span><span class="ident" id="1689449"><a href="/gostd/runtime/stubs.go.html#1738643">add</a></span><span class="op" id="1689452">(</span><span class="ident" id="1689453"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1689459">.</span><span class="ident" id="1689460">Pointer</span><span class="op" id="1689467">(</span><span class="op" id="1689468">&amp;</span><span class="ident" id="1689469"><a href="/gostd/runtime/select.go.html#1689284">sel</a></span><span class="op" id="1689472">.</span><span class="ident" id="1689473"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797071">scase</a></span><span class="op" id="1689478">)</span><span class="op" id="1689479">,</span>&nbsp;<span class="builtintype" id="1689481">uintptr</span><span class="op" id="1689488">(</span><span class="ident" id="1689489"><a href="/gostd/runtime/select.go.html#1689331">i</a></span><span class="op" id="1689490">)</span><span class="op" id="1689491">*</span><span class="ident" id="1689492"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1689498">.</span><span class="ident" id="1689499">Sizeof</span><span class="op" id="1689505">(</span><span class="ident" id="1689506"><a href="/gostd/runtime/select.go.html#1689284">sel</a></span><span class="op" id="1689509">.</span><span class="ident" id="1689510"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797071">scase</a></span><span class="op" id="1689515">[</span><span class="num" id="1689516">0</span><span class="op" id="1689517">]</span><span class="op" id="1689518">)</span><span class="op" id="1689519">)</span><span class="op" id="1689520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689523"><a href="/gostd/runtime/select.go.html#1689433">cas</a></span><span class="op" id="1689526">.</span><span class="ident" id="1689527"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796908">pc</a></span>&nbsp;<span class="op" id="1689530">=</span>&nbsp;<span class="ident" id="1689532"><a href="/gostd/runtime/select.go.html#1689298">callerpc</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689542"><a href="/gostd/runtime/select.go.html#1689433">cas</a></span><span class="op" id="1689545">.</span><span class="ident" id="1689546"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796894">_chan</a></span>&nbsp;<span class="op" id="1689552">=</span>&nbsp;<span class="builtintype" id="1689554">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689559"><a href="/gostd/runtime/select.go.html#1689433">cas</a></span><span class="op" id="1689562">.</span><span class="ident" id="1689563"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796933">so</a></span>&nbsp;<span class="op" id="1689566">=</span>&nbsp;<span class="builtintype" id="1689568">uint16</span><span class="op" id="1689574">(</span><span class="ident" id="1689575"><a href="/gostd/runtime/select.go.html#1689316">so</a></span><span class="op" id="1689577">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689580"><a href="/gostd/runtime/select.go.html#1689433">cas</a></span><span class="op" id="1689583">.</span><span class="ident" id="1689584"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796920">kind</a></span>&nbsp;<span class="op" id="1689589">=</span>&nbsp;<span class="ident" id="1689591"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796835">_CaseDefault</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1689606">if</span>&nbsp;<span class="ident" id="1689609"><a href="/gostd/runtime/select.go.html#1686202">debugSelect</a></span>&nbsp;<span class="op" id="1689621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1689625">print</span><span class="op" id="1689630">(</span><span class="string" id="1689631">&#34;selectdefault&nbsp;s=&#34;</span><span class="op" id="1689649">,</span>&nbsp;<span class="ident" id="1689651"><a href="/gostd/runtime/select.go.html#1689284">sel</a></span><span class="op" id="1689654">,</span>&nbsp;<span class="string" id="1689656">&#34;&nbsp;pc=&#34;</span><span class="op" id="1689662">,</span>&nbsp;<span class="ident" id="1689664"><a href="/gostd/runtime/print1.go.html#1664817">hex</a></span><span class="op" id="1689667">(</span><span class="ident" id="1689668"><a href="/gostd/runtime/select.go.html#1689433">cas</a></span><span class="op" id="1689671">.</span><span class="ident" id="1689672"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796908">pc</a></span><span class="op" id="1689674">)</span><span class="op" id="1689675">,</span>&nbsp;<span class="string" id="1689677">&#34;&nbsp;so=&#34;</span><span class="op" id="1689683">,</span>&nbsp;<span class="ident" id="1689685"><a href="/gostd/runtime/select.go.html#1689433">cas</a></span><span class="op" id="1689688">.</span><span class="ident" id="1689689"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796933">so</a></span><span class="op" id="1689691">,</span>&nbsp;<span class="string" id="1689693">&#34;\n&#34;</span><span class="op" id="1689697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1689700">}</span><br>
<span class="lineno">130</span><span class="op" id="1689702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1689705">func</span>&nbsp;<span class="ident" id="1689710">sellock</span><span class="op" id="1689717">(</span><span class="ident" id="1689718">sel</span>&nbsp;<span class="op" id="1689722">*</span><span class="ident" id="1689723"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1689730">)</span>&nbsp;<span class="op" id="1689732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689735">lockslice</span>&nbsp;<span class="op" id="1689745">:=</span>&nbsp;<span class="ident" id="1689748"><a href="/gostd/runtime/slice.go.html#1713356">sliceStruct</a></span><span class="op" id="1689759">{</span><span class="ident" id="1689760"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1689766">.</span><span class="ident" id="1689767">Pointer</span><span class="op" id="1689774">(</span><span class="ident" id="1689775"><a href="/gostd/runtime/select.go.html#1689718">sel</a></span><span class="op" id="1689778">.</span><span class="ident" id="1689779"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797052">lockorder</a></span><span class="op" id="1689788">)</span><span class="op" id="1689789">,</span>&nbsp;<span class="builtintype" id="1689791">int</span><span class="op" id="1689794">(</span><span class="ident" id="1689795"><a href="/gostd/runtime/select.go.html#1689718">sel</a></span><span class="op" id="1689798">.</span><span class="ident" id="1689799"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1689804">)</span><span class="op" id="1689805">,</span>&nbsp;<span class="builtintype" id="1689807">int</span><span class="op" id="1689810">(</span><span class="ident" id="1689811"><a href="/gostd/runtime/select.go.html#1689718">sel</a></span><span class="op" id="1689814">.</span><span class="ident" id="1689815"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1689820">)</span><span class="op" id="1689821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689824">lockorder</span>&nbsp;<span class="op" id="1689834">:=</span>&nbsp;<span class="op" id="1689837">*</span><span class="op" id="1689838">(</span><span class="op" id="1689839">*</span><span class="op" id="1689840">[</span><span class="op" id="1689841">]</span><span class="op" id="1689842">*</span><span class="ident" id="1689843"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796621">hchan</a></span><span class="op" id="1689848">)</span><span class="op" id="1689849">(</span><span class="ident" id="1689850"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1689856">.</span><span class="ident" id="1689857">Pointer</span><span class="op" id="1689864">(</span><span class="op" id="1689865">&amp;</span><span class="ident" id="1689866"><a href="/gostd/runtime/select.go.html#1689735">lockslice</a></span><span class="op" id="1689875">)</span><span class="op" id="1689876">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1689879">var</span>&nbsp;<span class="ident" id="1689883">c</span>&nbsp;<span class="op" id="1689885">*</span><span class="ident" id="1689886"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796621">hchan</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1689893">for</span>&nbsp;<span class="ident" id="1689897">_</span><span class="op" id="1689898">,</span>&nbsp;<span class="ident" id="1689900">c0</span>&nbsp;<span class="op" id="1689903">:=</span>&nbsp;<span class="keyword" id="1689906">range</span>&nbsp;<span class="ident" id="1689912"><a href="/gostd/runtime/select.go.html#1689824">lockorder</a></span>&nbsp;<span class="op" id="1689922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1689926">if</span>&nbsp;<span class="ident" id="1689929"><a href="/gostd/runtime/select.go.html#1689900">c0</a></span>&nbsp;<span class="op" id="1689932">!=</span>&nbsp;<span class="builtintype" id="1689935">nil</span>&nbsp;<span class="op" id="1689939">&amp;&amp;</span>&nbsp;<span class="ident" id="1689942"><a href="/gostd/runtime/select.go.html#1689900">c0</a></span>&nbsp;<span class="op" id="1689945">!=</span>&nbsp;<span class="ident" id="1689948"><a href="/gostd/runtime/select.go.html#1689883">c</a></span>&nbsp;<span class="op" id="1689950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689955"><a href="/gostd/runtime/select.go.html#1689883">c</a></span>&nbsp;<span class="op" id="1689957">=</span>&nbsp;<span class="ident" id="1689959"><a href="/gostd/runtime/select.go.html#1689900">c0</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1689965"><a href="/gostd/runtime/lock_futex.go.html#1585337">lock</a></span><span class="op" id="1689969">(</span><span class="op" id="1689970">&amp;</span><span class="ident" id="1689971"><a href="/gostd/runtime/select.go.html#1689883">c</a></span><span class="op" id="1689972">.</span><span class="ident" id="1689973"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796775">lock</a></span><span class="op" id="1689977">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1689981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1689984">}</span><br>
<span class="lineno"></span><span class="op" id="1689986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1689989">func</span>&nbsp;<span class="ident" id="1689994">selunlock</span><span class="op" id="1690003">(</span><span class="ident" id="1690004">sel</span>&nbsp;<span class="op" id="1690008">*</span><span class="ident" id="1690009"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1690016">)</span>&nbsp;<span class="op" id="1690018">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1690021">//&nbsp;We&nbsp;must&nbsp;be&nbsp;very&nbsp;careful&nbsp;here&nbsp;to&nbsp;not&nbsp;touch&nbsp;sel&nbsp;after&nbsp;we&nbsp;have&nbsp;unlocked</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1690094">//&nbsp;the&nbsp;last&nbsp;lock,&nbsp;because&nbsp;sel&nbsp;can&nbsp;be&nbsp;freed&nbsp;right&nbsp;after&nbsp;the&nbsp;last&nbsp;unlock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1690167">//&nbsp;Consider&nbsp;the&nbsp;following&nbsp;situation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1690205">//&nbsp;First&nbsp;M&nbsp;calls&nbsp;runtime·park()&nbsp;in&nbsp;runtime·selectgo()&nbsp;passing&nbsp;the&nbsp;sel.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1690279">//&nbsp;Once&nbsp;runtime·park()&nbsp;has&nbsp;unlocked&nbsp;the&nbsp;last&nbsp;lock,&nbsp;another&nbsp;M&nbsp;makes</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1690348">//&nbsp;the&nbsp;G&nbsp;that&nbsp;calls&nbsp;select&nbsp;runnable&nbsp;again&nbsp;and&nbsp;schedules&nbsp;it&nbsp;for&nbsp;execution.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1690423">//&nbsp;When&nbsp;the&nbsp;G&nbsp;runs&nbsp;on&nbsp;another&nbsp;M,&nbsp;it&nbsp;locks&nbsp;all&nbsp;the&nbsp;locks&nbsp;and&nbsp;frees&nbsp;sel.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1690495">//&nbsp;Now&nbsp;if&nbsp;the&nbsp;first&nbsp;M&nbsp;touches&nbsp;sel,&nbsp;it&nbsp;will&nbsp;access&nbsp;freed&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690560">n</span>&nbsp;<span class="op" id="1690562">:=</span>&nbsp;<span class="builtintype" id="1690565">int</span><span class="op" id="1690568">(</span><span class="ident" id="1690569"><a href="/gostd/runtime/select.go.html#1690004">sel</a></span><span class="op" id="1690572">.</span><span class="ident" id="1690573"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1690578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690581">r</span>&nbsp;<span class="op" id="1690583">:=</span>&nbsp;<span class="num" id="1690586">0</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690589">lockslice</span>&nbsp;<span class="op" id="1690599">:=</span>&nbsp;<span class="ident" id="1690602"><a href="/gostd/runtime/slice.go.html#1713356">sliceStruct</a></span><span class="op" id="1690613">{</span><span class="ident" id="1690614"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1690620">.</span><span class="ident" id="1690621">Pointer</span><span class="op" id="1690628">(</span><span class="ident" id="1690629"><a href="/gostd/runtime/select.go.html#1690004">sel</a></span><span class="op" id="1690632">.</span><span class="ident" id="1690633"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797052">lockorder</a></span><span class="op" id="1690642">)</span><span class="op" id="1690643">,</span>&nbsp;<span class="ident" id="1690645"><a href="/gostd/runtime/select.go.html#1690560">n</a></span><span class="op" id="1690646">,</span>&nbsp;<span class="ident" id="1690648"><a href="/gostd/runtime/select.go.html#1690560">n</a></span><span class="op" id="1690649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690652">lockorder</span>&nbsp;<span class="op" id="1690662">:=</span>&nbsp;<span class="op" id="1690665">*</span><span class="op" id="1690666">(</span><span class="op" id="1690667">*</span><span class="op" id="1690668">[</span><span class="op" id="1690669">]</span><span class="op" id="1690670">*</span><span class="ident" id="1690671"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796621">hchan</a></span><span class="op" id="1690676">)</span><span class="op" id="1690677">(</span><span class="ident" id="1690678"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1690684">.</span><span class="ident" id="1690685">Pointer</span><span class="op" id="1690692">(</span><span class="op" id="1690693">&amp;</span><span class="ident" id="1690694"><a href="/gostd/runtime/select.go.html#1690589">lockslice</a></span><span class="op" id="1690703">)</span><span class="op" id="1690704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1690707">//&nbsp;skip&nbsp;the&nbsp;default&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690733">if</span>&nbsp;<span class="ident" id="1690736"><a href="/gostd/runtime/select.go.html#1690560">n</a></span>&nbsp;<span class="op" id="1690738">&gt;</span>&nbsp;<span class="num" id="1690740">0</span>&nbsp;<span class="op" id="1690742">&amp;&amp;</span>&nbsp;<span class="ident" id="1690745"><a href="/gostd/runtime/select.go.html#1690652">lockorder</a></span><span class="op" id="1690754">[</span><span class="num" id="1690755">0</span><span class="op" id="1690756">]</span>&nbsp;<span class="op" id="1690758">==</span>&nbsp;<span class="builtintype" id="1690761">nil</span>&nbsp;<span class="op" id="1690765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690769"><a href="/gostd/runtime/select.go.html#1690581">r</a></span>&nbsp;<span class="op" id="1690771">=</span>&nbsp;<span class="num" id="1690773">1</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1690776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690779">for</span>&nbsp;<span class="ident" id="1690783">i</span>&nbsp;<span class="op" id="1690785">:=</span>&nbsp;<span class="ident" id="1690788"><a href="/gostd/runtime/select.go.html#1690560">n</a></span>&nbsp;<span class="op" id="1690790">-</span>&nbsp;<span class="num" id="1690792">1</span><span class="op" id="1690793">;</span>&nbsp;<span class="ident" id="1690795"><a href="/gostd/runtime/select.go.html#1690783">i</a></span>&nbsp;<span class="op" id="1690797">&gt;=</span>&nbsp;<span class="ident" id="1690800"><a href="/gostd/runtime/select.go.html#1690581">r</a></span><span class="op" id="1690801">;</span>&nbsp;<span class="ident" id="1690803"><a href="/gostd/runtime/select.go.html#1690783">i</a></span><span class="op" id="1690804">--</span>&nbsp;<span class="op" id="1690807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690811">c</span>&nbsp;<span class="op" id="1690813">:=</span>&nbsp;<span class="ident" id="1690816"><a href="/gostd/runtime/select.go.html#1690652">lockorder</a></span><span class="op" id="1690825">[</span><span class="ident" id="1690826"><a href="/gostd/runtime/select.go.html#1690783">i</a></span><span class="op" id="1690827">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690831">if</span>&nbsp;<span class="ident" id="1690834"><a href="/gostd/runtime/select.go.html#1690783">i</a></span>&nbsp;<span class="op" id="1690836">&gt;</span>&nbsp;<span class="num" id="1690838">0</span>&nbsp;<span class="op" id="1690840">&amp;&amp;</span>&nbsp;<span class="ident" id="1690843"><a href="/gostd/runtime/select.go.html#1690811">c</a></span>&nbsp;<span class="op" id="1690845">==</span>&nbsp;<span class="ident" id="1690848"><a href="/gostd/runtime/select.go.html#1690652">lockorder</a></span><span class="op" id="1690857">[</span><span class="ident" id="1690858"><a href="/gostd/runtime/select.go.html#1690783">i</a></span><span class="op" id="1690859">-</span><span class="num" id="1690860">1</span><span class="op" id="1690861">]</span>&nbsp;<span class="op" id="1690863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1690868">continue</span>&nbsp;<span class="comment" id="1690877">//&nbsp;will&nbsp;unlock&nbsp;it&nbsp;on&nbsp;the&nbsp;next&nbsp;iteration</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1690919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690923"><a href="/gostd/runtime/lock_futex.go.html#1586629">unlock</a></span><span class="op" id="1690929">(</span><span class="op" id="1690930">&amp;</span><span class="ident" id="1690931"><a href="/gostd/runtime/select.go.html#1690811">c</a></span><span class="op" id="1690932">.</span><span class="ident" id="1690933"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796775">lock</a></span><span class="op" id="1690937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1690940">}</span><br>
<span class="lineno"></span><span class="op" id="1690942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="1690945">func</span>&nbsp;<span class="ident" id="1690950">selparkcommit</span><span class="op" id="1690963">(</span><span class="ident" id="1690964">gp</span>&nbsp;<span class="op" id="1690967">*</span><span class="ident" id="1690968"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1787271">g</a></span><span class="op" id="1690969">,</span>&nbsp;<span class="ident" id="1690971">sel</span>&nbsp;<span class="op" id="1690975">*</span><span class="ident" id="1690976"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1690983">)</span>&nbsp;<span class="builtintype" id="1690985">bool</span>&nbsp;<span class="op" id="1690990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1690993"><a href="/gostd/runtime/select.go.html#1689994">selunlock</a></span><span class="op" id="1691002">(</span><span class="ident" id="1691003"><a href="/gostd/runtime/select.go.html#1690971">sel</a></span><span class="op" id="1691006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1691009">return</span>&nbsp;<span class="builtintype" id="1691016">true</span><br>
<span class="lineno"></span><span class="op" id="1691021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="1691024">func</span>&nbsp;<span class="ident" id="1691029">block</span><span class="op" id="1691034">(</span><span class="op" id="1691035">)</span>&nbsp;<span class="op" id="1691037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1691040"><a href="/gostd/runtime/proc.go.html#1673271">gopark</a></span><span class="op" id="1691046">(</span><span class="builtintype" id="1691047">nil</span><span class="op" id="1691050">,</span>&nbsp;<span class="builtintype" id="1691052">nil</span><span class="op" id="1691055">,</span>&nbsp;<span class="string" id="1691057">&#34;select&nbsp;(no&nbsp;cases)&#34;</span><span class="op" id="1691076">)</span>&nbsp;<span class="comment" id="1691078">//&nbsp;forever</span><br>
<span class="lineno"></span><span class="op" id="1691089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1691092">//&nbsp;overwrites&nbsp;return&nbsp;pc&nbsp;on&nbsp;stack&nbsp;to&nbsp;signal&nbsp;which&nbsp;case&nbsp;of&nbsp;the&nbsp;select</span><br>
<span class="lineno">180</span><span class="comment" id="1691160">//&nbsp;to&nbsp;run,&nbsp;so&nbsp;cannot&nbsp;appear&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;a&nbsp;split&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="1691217">//go:nosplit</span><br>
<span class="lineno"></span><span class="keyword" id="1691230">func</span>&nbsp;<span class="ident" id="1691235">selectgo</span><span class="op" id="1691243">(</span><span class="ident" id="1691244">sel</span>&nbsp;<span class="op" id="1691248">*</span><span class="ident" id="1691249"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1691256">)</span>&nbsp;<span class="op" id="1691258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1691261">pc</span><span class="op" id="1691263">,</span>&nbsp;<span class="ident" id="1691265">offset</span>&nbsp;<span class="op" id="1691272">:=</span>&nbsp;<span class="ident" id="1691275"><a href="/gostd/runtime/select.go.html#1691483">selectgoImpl</a></span><span class="op" id="1691287">(</span><span class="ident" id="1691288"><a href="/gostd/runtime/select.go.html#1691244">sel</a></span><span class="op" id="1691291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1691294">*</span><span class="op" id="1691295">(</span><span class="op" id="1691296">*</span><span class="builtintype" id="1691297">bool</span><span class="op" id="1691301">)</span><span class="op" id="1691302">(</span><span class="ident" id="1691303"><a href="/gostd/runtime/stubs.go.html#1738643">add</a></span><span class="op" id="1691306">(</span><span class="ident" id="1691307"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1691313">.</span><span class="ident" id="1691314">Pointer</span><span class="op" id="1691321">(</span><span class="op" id="1691322">&amp;</span><span class="ident" id="1691323"><a href="/gostd/runtime/select.go.html#1691244">sel</a></span><span class="op" id="1691326">)</span><span class="op" id="1691327">,</span>&nbsp;<span class="builtintype" id="1691329">uintptr</span><span class="op" id="1691336">(</span><span class="ident" id="1691337"><a href="/gostd/runtime/select.go.html#1691265">offset</a></span><span class="op" id="1691343">)</span><span class="op" id="1691344">)</span><span class="op" id="1691345">)</span>&nbsp;<span class="op" id="1691347">=</span>&nbsp;<span class="builtintype" id="1691349">true</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1691355"><a href="/gostd/runtime/stubs.go.html#1745124">setcallerpc</a></span><span class="op" id="1691366">(</span><span class="ident" id="1691367"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1691373">.</span><span class="ident" id="1691374">Pointer</span><span class="op" id="1691381">(</span><span class="op" id="1691382">&amp;</span><span class="ident" id="1691383"><a href="/gostd/runtime/select.go.html#1691244">sel</a></span><span class="op" id="1691386">)</span><span class="op" id="1691387">,</span>&nbsp;<span class="ident" id="1691389"><a href="/gostd/runtime/select.go.html#1691261">pc</a></span><span class="op" id="1691391">)</span><br>
<span class="lineno"></span><span class="op" id="1691393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1691396">//&nbsp;selectgoImpl&nbsp;returns&nbsp;scase.pc&nbsp;and&nbsp;scase.so&nbsp;for&nbsp;the&nbsp;select</span><br>
<span class="lineno"></span><span class="comment" id="1691457">//&nbsp;case&nbsp;which&nbsp;fired.</span><br>
<span class="lineno">190</span><span class="keyword" id="1691478">func</span>&nbsp;<span class="ident" id="1691483">selectgoImpl</span><span class="op" id="1691495">(</span><span class="ident" id="1691496">sel</span>&nbsp;<span class="op" id="1691500">*</span><span class="ident" id="1691501"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1691508">)</span>&nbsp;<span class="op" id="1691510">(</span><span class="builtintype" id="1691511">uintptr</span><span class="op" id="1691518">,</span>&nbsp;<span class="builtintype" id="1691520">uint16</span><span class="op" id="1691526">)</span>&nbsp;<span class="op" id="1691528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1691531">if</span>&nbsp;<span class="ident" id="1691534"><a href="/gostd/runtime/select.go.html#1686202">debugSelect</a></span>&nbsp;<span class="op" id="1691546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1691550">print</span><span class="op" id="1691555">(</span><span class="string" id="1691556">&#34;select:&nbsp;sel=&#34;</span><span class="op" id="1691570">,</span>&nbsp;<span class="ident" id="1691572"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1691575">,</span>&nbsp;<span class="string" id="1691577">&#34;\n&#34;</span><span class="op" id="1691581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1691584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1691588">scaseslice</span>&nbsp;<span class="op" id="1691599">:=</span>&nbsp;<span class="ident" id="1691602"><a href="/gostd/runtime/slice.go.html#1713356">sliceStruct</a></span><span class="op" id="1691613">{</span><span class="ident" id="1691614"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1691620">.</span><span class="ident" id="1691621">Pointer</span><span class="op" id="1691628">(</span><span class="op" id="1691629">&amp;</span><span class="ident" id="1691630"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1691633">.</span><span class="ident" id="1691634"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797071">scase</a></span><span class="op" id="1691639">)</span><span class="op" id="1691640">,</span>&nbsp;<span class="builtintype" id="1691642">int</span><span class="op" id="1691645">(</span><span class="ident" id="1691646"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1691649">.</span><span class="ident" id="1691650"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1691655">)</span><span class="op" id="1691656">,</span>&nbsp;<span class="builtintype" id="1691658">int</span><span class="op" id="1691661">(</span><span class="ident" id="1691662"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1691665">.</span><span class="ident" id="1691666"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1691671">)</span><span class="op" id="1691672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1691675">scases</span>&nbsp;<span class="op" id="1691682">:=</span>&nbsp;<span class="op" id="1691685">*</span><span class="op" id="1691686">(</span><span class="op" id="1691687">*</span><span class="op" id="1691688">[</span><span class="op" id="1691689">]</span><span class="ident" id="1691690"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796857">scase</a></span><span class="op" id="1691695">)</span><span class="op" id="1691696">(</span><span class="ident" id="1691697"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1691703">.</span><span class="ident" id="1691704">Pointer</span><span class="op" id="1691711">(</span><span class="op" id="1691712">&amp;</span><span class="ident" id="1691713"><a href="/gostd/runtime/select.go.html#1691588">scaseslice</a></span><span class="op" id="1691723">)</span><span class="op" id="1691724">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1691728">var</span>&nbsp;<span class="ident" id="1691732">t0</span>&nbsp;<span class="builtintype" id="1691735">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1691742">if</span>&nbsp;<span class="ident" id="1691745"><a href="/gostd/runtime/mprof.go.html#1626211">blockprofilerate</a></span>&nbsp;<span class="op" id="1691762">&gt;</span>&nbsp;<span class="num" id="1691764">0</span>&nbsp;<span class="op" id="1691766">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1691770"><a href="/gostd/runtime/select.go.html#1691732">t0</a></span>&nbsp;<span class="op" id="1691773">=</span>&nbsp;<span class="ident" id="1691775"><a href="/gostd/runtime/stubs.go.html#1744144">cputicks</a></span><span class="op" id="1691783">(</span><span class="op" id="1691784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1691788">for</span>&nbsp;<span class="ident" id="1691792">i</span>&nbsp;<span class="op" id="1691794">:=</span>&nbsp;<span class="num" id="1691797">0</span><span class="op" id="1691798">;</span>&nbsp;<span class="ident" id="1691800"><a href="/gostd/runtime/select.go.html#1691792">i</a></span>&nbsp;<span class="op" id="1691802">&lt;</span>&nbsp;<span class="builtintype" id="1691804">int</span><span class="op" id="1691807">(</span><span class="ident" id="1691808"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1691811">.</span><span class="ident" id="1691812"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1691817">)</span><span class="op" id="1691818">;</span>&nbsp;<span class="ident" id="1691820"><a href="/gostd/runtime/select.go.html#1691792">i</a></span><span class="op" id="1691821">++</span>&nbsp;<span class="op" id="1691824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1691829"><a href="/gostd/runtime/select.go.html#1691675">scases</a></span><span class="op" id="1691835">[</span><span class="ident" id="1691836"><a href="/gostd/runtime/select.go.html#1691792">i</a></span><span class="op" id="1691837">]</span><span class="op" id="1691838">.</span><span class="ident" id="1691839"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796961">releasetime</a></span>&nbsp;<span class="op" id="1691851">=</span>&nbsp;<span class="op" id="1691853">-</span><span class="num" id="1691854">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1691858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1691861">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1691865">//&nbsp;The&nbsp;compiler&nbsp;rewrites&nbsp;selects&nbsp;that&nbsp;statically&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1691920">//&nbsp;only&nbsp;0&nbsp;or&nbsp;1&nbsp;cases&nbsp;plus&nbsp;default&nbsp;into&nbsp;simpler&nbsp;constructs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1691980">//&nbsp;The&nbsp;only&nbsp;way&nbsp;we&nbsp;can&nbsp;end&nbsp;up&nbsp;with&nbsp;such&nbsp;small&nbsp;sel.ncase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1692037">//&nbsp;values&nbsp;here&nbsp;is&nbsp;for&nbsp;a&nbsp;larger&nbsp;select&nbsp;in&nbsp;which&nbsp;most&nbsp;channels</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1692099">//&nbsp;have&nbsp;been&nbsp;nilled&nbsp;out.&nbsp;&nbsp;The&nbsp;general&nbsp;code&nbsp;handles&nbsp;those</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1692157">//&nbsp;cases&nbsp;correctly,&nbsp;and&nbsp;they&nbsp;are&nbsp;rare&nbsp;enough&nbsp;not&nbsp;to&nbsp;bother</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1692217">//&nbsp;optimizing&nbsp;(and&nbsp;needing&nbsp;to&nbsp;test).</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1692256">//&nbsp;generate&nbsp;permuted&nbsp;order</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1692284">pollslice</span>&nbsp;<span class="op" id="1692294">:=</span>&nbsp;<span class="ident" id="1692297"><a href="/gostd/runtime/slice.go.html#1713356">sliceStruct</a></span><span class="op" id="1692308">{</span><span class="ident" id="1692309"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1692315">.</span><span class="ident" id="1692316">Pointer</span><span class="op" id="1692323">(</span><span class="ident" id="1692324"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1692327">.</span><span class="ident" id="1692328"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797033">pollorder</a></span><span class="op" id="1692337">)</span><span class="op" id="1692338">,</span>&nbsp;<span class="builtintype" id="1692340">int</span><span class="op" id="1692343">(</span><span class="ident" id="1692344"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1692347">.</span><span class="ident" id="1692348"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1692353">)</span><span class="op" id="1692354">,</span>&nbsp;<span class="builtintype" id="1692356">int</span><span class="op" id="1692359">(</span><span class="ident" id="1692360"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1692363">.</span><span class="ident" id="1692364"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1692369">)</span><span class="op" id="1692370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1692373">pollorder</span>&nbsp;<span class="op" id="1692383">:=</span>&nbsp;<span class="op" id="1692386">*</span><span class="op" id="1692387">(</span><span class="op" id="1692388">*</span><span class="op" id="1692389">[</span><span class="op" id="1692390">]</span><span class="builtintype" id="1692391">uint16</span><span class="op" id="1692397">)</span><span class="op" id="1692398">(</span><span class="ident" id="1692399"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1692405">.</span><span class="ident" id="1692406">Pointer</span><span class="op" id="1692413">(</span><span class="op" id="1692414">&amp;</span><span class="ident" id="1692415"><a href="/gostd/runtime/select.go.html#1692284">pollslice</a></span><span class="op" id="1692424">)</span><span class="op" id="1692425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1692428">for</span>&nbsp;<span class="ident" id="1692432">i</span>&nbsp;<span class="op" id="1692434">:=</span>&nbsp;<span class="num" id="1692437">0</span><span class="op" id="1692438">;</span>&nbsp;<span class="ident" id="1692440"><a href="/gostd/runtime/select.go.html#1692432">i</a></span>&nbsp;<span class="op" id="1692442">&lt;</span>&nbsp;<span class="builtintype" id="1692444">int</span><span class="op" id="1692447">(</span><span class="ident" id="1692448"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1692451">.</span><span class="ident" id="1692452"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1692457">)</span><span class="op" id="1692458">;</span>&nbsp;<span class="ident" id="1692460"><a href="/gostd/runtime/select.go.html#1692432">i</a></span><span class="op" id="1692461">++</span>&nbsp;<span class="op" id="1692464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1692468"><a href="/gostd/runtime/select.go.html#1692373">pollorder</a></span><span class="op" id="1692477">[</span><span class="ident" id="1692478"><a href="/gostd/runtime/select.go.html#1692432">i</a></span><span class="op" id="1692479">]</span>&nbsp;<span class="op" id="1692481">=</span>&nbsp;<span class="builtintype" id="1692483">uint16</span><span class="op" id="1692489">(</span><span class="ident" id="1692490"><a href="/gostd/runtime/select.go.html#1692432">i</a></span><span class="op" id="1692491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1692494">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1692497">for</span>&nbsp;<span class="ident" id="1692501">i</span>&nbsp;<span class="op" id="1692503">:=</span>&nbsp;<span class="num" id="1692506">1</span><span class="op" id="1692507">;</span>&nbsp;<span class="ident" id="1692509"><a href="/gostd/runtime/select.go.html#1692501">i</a></span>&nbsp;<span class="op" id="1692511">&lt;</span>&nbsp;<span class="builtintype" id="1692513">int</span><span class="op" id="1692516">(</span><span class="ident" id="1692517"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1692520">.</span><span class="ident" id="1692521"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1692526">)</span><span class="op" id="1692527">;</span>&nbsp;<span class="ident" id="1692529"><a href="/gostd/runtime/select.go.html#1692501">i</a></span><span class="op" id="1692530">++</span>&nbsp;<span class="op" id="1692533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1692537">o</span>&nbsp;<span class="op" id="1692539">:=</span>&nbsp;<span class="ident" id="1692542"><a href="/gostd/runtime/select.go.html#1692373">pollorder</a></span><span class="op" id="1692551">[</span><span class="ident" id="1692552"><a href="/gostd/runtime/select.go.html#1692501">i</a></span><span class="op" id="1692553">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1692557">j</span>&nbsp;<span class="op" id="1692559">:=</span>&nbsp;<span class="builtintype" id="1692562">int</span><span class="op" id="1692565">(</span><span class="ident" id="1692566"><a href="/gostd/runtime/stubs.go.html#1742945">fastrand1</a></span><span class="op" id="1692575">(</span><span class="op" id="1692576">)</span><span class="op" id="1692577">)</span>&nbsp;<span class="op" id="1692579">%</span>&nbsp;<span class="op" id="1692581">(</span><span class="ident" id="1692582"><a href="/gostd/runtime/select.go.html#1692501">i</a></span>&nbsp;<span class="op" id="1692584">+</span>&nbsp;<span class="num" id="1692586">1</span><span class="op" id="1692587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1692591"><a href="/gostd/runtime/select.go.html#1692373">pollorder</a></span><span class="op" id="1692600">[</span><span class="ident" id="1692601"><a href="/gostd/runtime/select.go.html#1692501">i</a></span><span class="op" id="1692602">]</span>&nbsp;<span class="op" id="1692604">=</span>&nbsp;<span class="ident" id="1692606"><a href="/gostd/runtime/select.go.html#1692373">pollorder</a></span><span class="op" id="1692615">[</span><span class="ident" id="1692616"><a href="/gostd/runtime/select.go.html#1692557">j</a></span><span class="op" id="1692617">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1692621"><a href="/gostd/runtime/select.go.html#1692373">pollorder</a></span><span class="op" id="1692630">[</span><span class="ident" id="1692631"><a href="/gostd/runtime/select.go.html#1692557">j</a></span><span class="op" id="1692632">]</span>&nbsp;<span class="op" id="1692634">=</span>&nbsp;<span class="ident" id="1692636"><a href="/gostd/runtime/select.go.html#1692537">o</a></span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1692639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1692643">//&nbsp;sort&nbsp;the&nbsp;cases&nbsp;by&nbsp;Hchan&nbsp;address&nbsp;to&nbsp;get&nbsp;the&nbsp;locking&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1692705">//&nbsp;simple&nbsp;heap&nbsp;sort,&nbsp;to&nbsp;guarantee&nbsp;n&nbsp;log&nbsp;n&nbsp;time&nbsp;and&nbsp;constant&nbsp;stack&nbsp;footprint.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1692783">lockslice</span>&nbsp;<span class="op" id="1692793">:=</span>&nbsp;<span class="ident" id="1692796"><a href="/gostd/runtime/slice.go.html#1713356">sliceStruct</a></span><span class="op" id="1692807">{</span><span class="ident" id="1692808"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1692814">.</span><span class="ident" id="1692815">Pointer</span><span class="op" id="1692822">(</span><span class="ident" id="1692823"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1692826">.</span><span class="ident" id="1692827"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797052">lockorder</a></span><span class="op" id="1692836">)</span><span class="op" id="1692837">,</span>&nbsp;<span class="builtintype" id="1692839">int</span><span class="op" id="1692842">(</span><span class="ident" id="1692843"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1692846">.</span><span class="ident" id="1692847"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1692852">)</span><span class="op" id="1692853">,</span>&nbsp;<span class="builtintype" id="1692855">int</span><span class="op" id="1692858">(</span><span class="ident" id="1692859"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1692862">.</span><span class="ident" id="1692863"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1692868">)</span><span class="op" id="1692869">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1692872">lockorder</span>&nbsp;<span class="op" id="1692882">:=</span>&nbsp;<span class="op" id="1692885">*</span><span class="op" id="1692886">(</span><span class="op" id="1692887">*</span><span class="op" id="1692888">[</span><span class="op" id="1692889">]</span><span class="op" id="1692890">*</span><span class="ident" id="1692891"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796621">hchan</a></span><span class="op" id="1692896">)</span><span class="op" id="1692897">(</span><span class="ident" id="1692898"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1692904">.</span><span class="ident" id="1692905">Pointer</span><span class="op" id="1692912">(</span><span class="op" id="1692913">&amp;</span><span class="ident" id="1692914"><a href="/gostd/runtime/select.go.html#1692783">lockslice</a></span><span class="op" id="1692923">)</span><span class="op" id="1692924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1692927">for</span>&nbsp;<span class="ident" id="1692931">i</span>&nbsp;<span class="op" id="1692933">:=</span>&nbsp;<span class="num" id="1692936">0</span><span class="op" id="1692937">;</span>&nbsp;<span class="ident" id="1692939"><a href="/gostd/runtime/select.go.html#1692931">i</a></span>&nbsp;<span class="op" id="1692941">&lt;</span>&nbsp;<span class="builtintype" id="1692943">int</span><span class="op" id="1692946">(</span><span class="ident" id="1692947"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1692950">.</span><span class="ident" id="1692951"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1692956">)</span><span class="op" id="1692957">;</span>&nbsp;<span class="ident" id="1692959"><a href="/gostd/runtime/select.go.html#1692931">i</a></span><span class="op" id="1692960">++</span>&nbsp;<span class="op" id="1692963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1692967">j</span>&nbsp;<span class="op" id="1692969">:=</span>&nbsp;<span class="ident" id="1692972"><a href="/gostd/runtime/select.go.html#1692931">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1692976">c</span>&nbsp;<span class="op" id="1692978">:=</span>&nbsp;<span class="ident" id="1692981"><a href="/gostd/runtime/select.go.html#1691675">scases</a></span><span class="op" id="1692987">[</span><span class="ident" id="1692988"><a href="/gostd/runtime/select.go.html#1692967">j</a></span><span class="op" id="1692989">]</span><span class="op" id="1692990">.</span><span class="ident" id="1692991"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796894">_chan</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1692999">for</span>&nbsp;<span class="ident" id="1693003"><a href="/gostd/runtime/select.go.html#1692967">j</a></span>&nbsp;<span class="op" id="1693005">&gt;</span>&nbsp;<span class="num" id="1693007">0</span>&nbsp;<span class="op" id="1693009">&amp;&amp;</span>&nbsp;<span class="ident" id="1693012"><a href="/gostd/runtime/select.go.html#1692872">lockorder</a></span><span class="op" id="1693021">[</span><span class="op" id="1693022">(</span><span class="ident" id="1693023"><a href="/gostd/runtime/select.go.html#1692967">j</a></span><span class="op" id="1693024">-</span><span class="num" id="1693025">1</span><span class="op" id="1693026">)</span><span class="op" id="1693027">/</span><span class="num" id="1693028">2</span><span class="op" id="1693029">]</span><span class="op" id="1693030">.</span><span class="ident" id="1693031"><a href="/gostd/runtime/select.go.html#1699865">sortkey</a></span><span class="op" id="1693038">(</span><span class="op" id="1693039">)</span>&nbsp;<span class="op" id="1693041">&lt;</span>&nbsp;<span class="ident" id="1693043"><a href="/gostd/runtime/select.go.html#1692976">c</a></span><span class="op" id="1693044">.</span><span class="ident" id="1693045"><a href="/gostd/runtime/select.go.html#1699865">sortkey</a></span><span class="op" id="1693052">(</span><span class="op" id="1693053">)</span>&nbsp;<span class="op" id="1693055">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693060">k</span>&nbsp;<span class="op" id="1693062">:=</span>&nbsp;<span class="op" id="1693065">(</span><span class="ident" id="1693066"><a href="/gostd/runtime/select.go.html#1692967">j</a></span>&nbsp;<span class="op" id="1693068">-</span>&nbsp;<span class="num" id="1693070">1</span><span class="op" id="1693071">)</span>&nbsp;<span class="op" id="1693073">/</span>&nbsp;<span class="num" id="1693075">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693080"><a href="/gostd/runtime/select.go.html#1692872">lockorder</a></span><span class="op" id="1693089">[</span><span class="ident" id="1693090"><a href="/gostd/runtime/select.go.html#1692967">j</a></span><span class="op" id="1693091">]</span>&nbsp;<span class="op" id="1693093">=</span>&nbsp;<span class="ident" id="1693095"><a href="/gostd/runtime/select.go.html#1692872">lockorder</a></span><span class="op" id="1693104">[</span><span class="ident" id="1693105"><a href="/gostd/runtime/select.go.html#1693060">k</a></span><span class="op" id="1693106">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693111"><a href="/gostd/runtime/select.go.html#1692967">j</a></span>&nbsp;<span class="op" id="1693113">=</span>&nbsp;<span class="ident" id="1693115"><a href="/gostd/runtime/select.go.html#1693060">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1693119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693123"><a href="/gostd/runtime/select.go.html#1692872">lockorder</a></span><span class="op" id="1693132">[</span><span class="ident" id="1693133"><a href="/gostd/runtime/select.go.html#1692967">j</a></span><span class="op" id="1693134">]</span>&nbsp;<span class="op" id="1693136">=</span>&nbsp;<span class="ident" id="1693138"><a href="/gostd/runtime/select.go.html#1692976">c</a></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1693141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1693144">for</span>&nbsp;<span class="ident" id="1693148">i</span>&nbsp;<span class="op" id="1693150">:=</span>&nbsp;<span class="builtintype" id="1693153">int</span><span class="op" id="1693156">(</span><span class="ident" id="1693157"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1693160">.</span><span class="ident" id="1693161"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1693166">)</span>&nbsp;<span class="op" id="1693168">-</span>&nbsp;<span class="num" id="1693170">1</span><span class="op" id="1693171">;</span>&nbsp;<span class="ident" id="1693173"><a href="/gostd/runtime/select.go.html#1693148">i</a></span>&nbsp;<span class="op" id="1693175">&gt;=</span>&nbsp;<span class="num" id="1693178">0</span><span class="op" id="1693179">;</span>&nbsp;<span class="ident" id="1693181"><a href="/gostd/runtime/select.go.html#1693148">i</a></span><span class="op" id="1693182">--</span>&nbsp;<span class="op" id="1693185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693189">c</span>&nbsp;<span class="op" id="1693191">:=</span>&nbsp;<span class="ident" id="1693194"><a href="/gostd/runtime/select.go.html#1692872">lockorder</a></span><span class="op" id="1693203">[</span><span class="ident" id="1693204"><a href="/gostd/runtime/select.go.html#1693148">i</a></span><span class="op" id="1693205">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693209"><a href="/gostd/runtime/select.go.html#1692872">lockorder</a></span><span class="op" id="1693218">[</span><span class="ident" id="1693219"><a href="/gostd/runtime/select.go.html#1693148">i</a></span><span class="op" id="1693220">]</span>&nbsp;<span class="op" id="1693222">=</span>&nbsp;<span class="ident" id="1693224"><a href="/gostd/runtime/select.go.html#1692872">lockorder</a></span><span class="op" id="1693233">[</span><span class="num" id="1693234">0</span><span class="op" id="1693235">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693239">j</span>&nbsp;<span class="op" id="1693241">:=</span>&nbsp;<span class="num" id="1693244">0</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1693248">for</span>&nbsp;<span class="op" id="1693252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693257">k</span>&nbsp;<span class="op" id="1693259">:=</span>&nbsp;<span class="ident" id="1693262"><a href="/gostd/runtime/select.go.html#1693239">j</a></span><span class="op" id="1693263">*</span><span class="num" id="1693264">2</span>&nbsp;<span class="op" id="1693266">+</span>&nbsp;<span class="num" id="1693268">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1693273">if</span>&nbsp;<span class="ident" id="1693276"><a href="/gostd/runtime/select.go.html#1693257">k</a></span>&nbsp;<span class="op" id="1693278">&gt;=</span>&nbsp;<span class="ident" id="1693281"><a href="/gostd/runtime/select.go.html#1693148">i</a></span>&nbsp;<span class="op" id="1693283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1693289">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1693298">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1693303">if</span>&nbsp;<span class="ident" id="1693306"><a href="/gostd/runtime/select.go.html#1693257">k</a></span><span class="op" id="1693307">+</span><span class="num" id="1693308">1</span>&nbsp;<span class="op" id="1693310">&lt;</span>&nbsp;<span class="ident" id="1693312"><a href="/gostd/runtime/select.go.html#1693148">i</a></span>&nbsp;<span class="op" id="1693314">&amp;&amp;</span>&nbsp;<span class="ident" id="1693317"><a href="/gostd/runtime/select.go.html#1692872">lockorder</a></span><span class="op" id="1693326">[</span><span class="ident" id="1693327"><a href="/gostd/runtime/select.go.html#1693257">k</a></span><span class="op" id="1693328">]</span><span class="op" id="1693329">.</span><span class="ident" id="1693330"><a href="/gostd/runtime/select.go.html#1699865">sortkey</a></span><span class="op" id="1693337">(</span><span class="op" id="1693338">)</span>&nbsp;<span class="op" id="1693340">&lt;</span>&nbsp;<span class="ident" id="1693342"><a href="/gostd/runtime/select.go.html#1692872">lockorder</a></span><span class="op" id="1693351">[</span><span class="ident" id="1693352"><a href="/gostd/runtime/select.go.html#1693257">k</a></span><span class="op" id="1693353">+</span><span class="num" id="1693354">1</span><span class="op" id="1693355">]</span><span class="op" id="1693356">.</span><span class="ident" id="1693357"><a href="/gostd/runtime/select.go.html#1699865">sortkey</a></span><span class="op" id="1693364">(</span><span class="op" id="1693365">)</span>&nbsp;<span class="op" id="1693367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693373"><a href="/gostd/runtime/select.go.html#1693257">k</a></span><span class="op" id="1693374">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1693380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1693385">if</span>&nbsp;<span class="ident" id="1693388"><a href="/gostd/runtime/select.go.html#1693189">c</a></span><span class="op" id="1693389">.</span><span class="ident" id="1693390"><a href="/gostd/runtime/select.go.html#1699865">sortkey</a></span><span class="op" id="1693397">(</span><span class="op" id="1693398">)</span>&nbsp;<span class="op" id="1693400">&lt;</span>&nbsp;<span class="ident" id="1693402"><a href="/gostd/runtime/select.go.html#1692872">lockorder</a></span><span class="op" id="1693411">[</span><span class="ident" id="1693412"><a href="/gostd/runtime/select.go.html#1693257">k</a></span><span class="op" id="1693413">]</span><span class="op" id="1693414">.</span><span class="ident" id="1693415"><a href="/gostd/runtime/select.go.html#1699865">sortkey</a></span><span class="op" id="1693422">(</span><span class="op" id="1693423">)</span>&nbsp;<span class="op" id="1693425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693431"><a href="/gostd/runtime/select.go.html#1692872">lockorder</a></span><span class="op" id="1693440">[</span><span class="ident" id="1693441"><a href="/gostd/runtime/select.go.html#1693239">j</a></span><span class="op" id="1693442">]</span>&nbsp;<span class="op" id="1693444">=</span>&nbsp;<span class="ident" id="1693446"><a href="/gostd/runtime/select.go.html#1692872">lockorder</a></span><span class="op" id="1693455">[</span><span class="ident" id="1693456"><a href="/gostd/runtime/select.go.html#1693257">k</a></span><span class="op" id="1693457">]</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693463"><a href="/gostd/runtime/select.go.html#1693239">j</a></span>&nbsp;<span class="op" id="1693465">=</span>&nbsp;<span class="ident" id="1693467"><a href="/gostd/runtime/select.go.html#1693257">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1693473">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1693485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1693490">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1693498">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693502"><a href="/gostd/runtime/select.go.html#1692872">lockorder</a></span><span class="op" id="1693511">[</span><span class="ident" id="1693512"><a href="/gostd/runtime/select.go.html#1693239">j</a></span><span class="op" id="1693513">]</span>&nbsp;<span class="op" id="1693515">=</span>&nbsp;<span class="ident" id="1693517"><a href="/gostd/runtime/select.go.html#1693189">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1693520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1693523">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;:=&nbsp;0;&nbsp;i+1&nbsp;&lt;&nbsp;int(sel.ncase);&nbsp;i++&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;lockorder[i].sortkey()&nbsp;&gt;&nbsp;lockorder[i+1].sortkey()&nbsp;{<br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&#34;i=&#34;,&nbsp;i,&nbsp;&#34;&nbsp;x=&#34;,&nbsp;lockorder[i],&nbsp;&#34;&nbsp;y=&#34;,&nbsp;lockorder[i+1],&nbsp;&#34;\n&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gothrow(&#34;select:&nbsp;broken&nbsp;sort&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;*/</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1693745">//&nbsp;lock&nbsp;all&nbsp;the&nbsp;channels&nbsp;involved&nbsp;in&nbsp;the&nbsp;select</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693794"><a href="/gostd/runtime/select.go.html#1689710">sellock</a></span><span class="op" id="1693801">(</span><span class="ident" id="1693802"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1693805">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1693809">var</span>&nbsp;<span class="op" id="1693813">(</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693817">gp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1693824">*</span><span class="ident" id="1693825"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1787271">g</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693829">done</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1693836">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693845">sg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1693852">*</span><span class="ident" id="1693853"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786749">sudog</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693861">c</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1693868">*</span><span class="ident" id="1693869"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796621">hchan</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693877">k</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1693884">*</span><span class="ident" id="1693885"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796857">scase</a></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693893">sglist</span>&nbsp;<span class="op" id="1693900">*</span><span class="ident" id="1693901"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786749">sudog</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1693909">sgnext</span>&nbsp;<span class="op" id="1693916">*</span><span class="ident" id="1693917"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786749">sudog</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1693924">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="1693927">loop</span><span class="op" id="1693931">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1693934">//&nbsp;pass&nbsp;1&nbsp;-&nbsp;look&nbsp;for&nbsp;something&nbsp;already&nbsp;waiting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1693982">var</span>&nbsp;<span class="ident" id="1693986">dfl</span>&nbsp;<span class="op" id="1693990">*</span><span class="ident" id="1693991"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796857">scase</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1693998">var</span>&nbsp;<span class="ident" id="1694002">cas</span>&nbsp;<span class="op" id="1694006">*</span><span class="ident" id="1694007"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796857">scase</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694014">for</span>&nbsp;<span class="ident" id="1694018">i</span>&nbsp;<span class="op" id="1694020">:=</span>&nbsp;<span class="num" id="1694023">0</span><span class="op" id="1694024">;</span>&nbsp;<span class="ident" id="1694026"><a href="/gostd/runtime/select.go.html#1694018">i</a></span>&nbsp;<span class="op" id="1694028">&lt;</span>&nbsp;<span class="builtintype" id="1694030">int</span><span class="op" id="1694033">(</span><span class="ident" id="1694034"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1694037">.</span><span class="ident" id="1694038"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1694043">)</span><span class="op" id="1694044">;</span>&nbsp;<span class="ident" id="1694046"><a href="/gostd/runtime/select.go.html#1694018">i</a></span><span class="op" id="1694047">++</span>&nbsp;<span class="op" id="1694050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1694054"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span>&nbsp;<span class="op" id="1694058">=</span>&nbsp;<span class="op" id="1694060">&amp;</span><span class="ident" id="1694061"><a href="/gostd/runtime/select.go.html#1691675">scases</a></span><span class="op" id="1694067">[</span><span class="ident" id="1694068"><a href="/gostd/runtime/select.go.html#1692373">pollorder</a></span><span class="op" id="1694077">[</span><span class="ident" id="1694078"><a href="/gostd/runtime/select.go.html#1694018">i</a></span><span class="op" id="1694079">]</span><span class="op" id="1694080">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1694084"><a href="/gostd/runtime/select.go.html#1693861">c</a></span>&nbsp;<span class="op" id="1694086">=</span>&nbsp;<span class="ident" id="1694088"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1694091">.</span><span class="ident" id="1694092"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796894">_chan</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694101">switch</span>&nbsp;<span class="ident" id="1694108"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1694111">.</span><span class="ident" id="1694112"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796920">kind</a></span>&nbsp;<span class="op" id="1694117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694121">case</span>&nbsp;<span class="ident" id="1694126"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796795">_CaseRecv</a></span><span class="op" id="1694135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694140">if</span>&nbsp;<span class="ident" id="1694143"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1694144">.</span><span class="ident" id="1694145"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796650">dataqsiz</a></span>&nbsp;<span class="op" id="1694154">&gt;</span>&nbsp;<span class="num" id="1694156">0</span>&nbsp;<span class="op" id="1694158">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694164">if</span>&nbsp;<span class="ident" id="1694167"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1694168">.</span><span class="ident" id="1694169"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796637">qcount</a></span>&nbsp;<span class="op" id="1694176">&gt;</span>&nbsp;<span class="num" id="1694178">0</span>&nbsp;<span class="op" id="1694180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694187">goto</span>&nbsp;<span class="ident" id="1694192"><a href="/gostd/runtime/select.go.html#1697283">asyncrecv</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1694206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1694211">}</span>&nbsp;<span class="keyword" id="1694213">else</span>&nbsp;<span class="op" id="1694218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1694224"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span>&nbsp;<span class="op" id="1694227">=</span>&nbsp;<span class="ident" id="1694229"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1694230">.</span><span class="ident" id="1694231"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796762">sendq</a></span><span class="op" id="1694236">.</span><span class="ident" id="1694237"><a href="/gostd/runtime/chan.go.html#1505850">dequeue</a></span><span class="op" id="1694244">(</span><span class="op" id="1694245">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694251">if</span>&nbsp;<span class="ident" id="1694254"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span>&nbsp;<span class="op" id="1694257">!=</span>&nbsp;<span class="builtintype" id="1694260">nil</span>&nbsp;<span class="op" id="1694264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694271">goto</span>&nbsp;<span class="ident" id="1694276"><a href="/gostd/runtime/select.go.html#1698451">syncrecv</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1694289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1694294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694299">if</span>&nbsp;<span class="ident" id="1694302"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1694303">.</span><span class="ident" id="1694304"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796693">closed</a></span>&nbsp;<span class="op" id="1694311">!=</span>&nbsp;<span class="num" id="1694314">0</span>&nbsp;<span class="op" id="1694316">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694322">goto</span>&nbsp;<span class="ident" id="1694327"><a href="/gostd/runtime/select.go.html#1698986">rclose</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1694337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694342">case</span>&nbsp;<span class="ident" id="1694347"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796815">_CaseSend</a></span><span class="op" id="1694356">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694361">if</span>&nbsp;<span class="ident" id="1694364"><a href="/gostd/runtime/race0.go.html#1676514">raceenabled</a></span>&nbsp;<span class="op" id="1694376">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1694382"><a href="/gostd/runtime/race0.go.html#1677192">racereadpc</a></span><span class="op" id="1694392">(</span><span class="ident" id="1694393"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1694399">.</span><span class="ident" id="1694400">Pointer</span><span class="op" id="1694407">(</span><span class="ident" id="1694408"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1694409">)</span><span class="op" id="1694410">,</span>&nbsp;<span class="ident" id="1694412"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1694415">.</span><span class="ident" id="1694416"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796908">pc</a></span><span class="op" id="1694418">,</span>&nbsp;<span class="ident" id="1694420"><a href="/gostd/runtime/select.go.html#1686232">chansendpc</a></span><span class="op" id="1694430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1694435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694440">if</span>&nbsp;<span class="ident" id="1694443"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1694444">.</span><span class="ident" id="1694445"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796693">closed</a></span>&nbsp;<span class="op" id="1694452">!=</span>&nbsp;<span class="num" id="1694455">0</span>&nbsp;<span class="op" id="1694457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694463">goto</span>&nbsp;<span class="ident" id="1694468"><a href="/gostd/runtime/select.go.html#1699762">sclose</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1694478">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694483">if</span>&nbsp;<span class="ident" id="1694486"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1694487">.</span><span class="ident" id="1694488"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796650">dataqsiz</a></span>&nbsp;<span class="op" id="1694497">&gt;</span>&nbsp;<span class="num" id="1694499">0</span>&nbsp;<span class="op" id="1694501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694507">if</span>&nbsp;<span class="ident" id="1694510"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1694511">.</span><span class="ident" id="1694512"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796637">qcount</a></span>&nbsp;<span class="op" id="1694519">&lt;</span>&nbsp;<span class="ident" id="1694521"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1694522">.</span><span class="ident" id="1694523"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796650">dataqsiz</a></span>&nbsp;<span class="op" id="1694532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694539">goto</span>&nbsp;<span class="ident" id="1694544"><a href="/gostd/runtime/select.go.html#1697949">asyncsend</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1694558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1694563">}</span>&nbsp;<span class="keyword" id="1694565">else</span>&nbsp;<span class="op" id="1694570">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1694576"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span>&nbsp;<span class="op" id="1694579">=</span>&nbsp;<span class="ident" id="1694581"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1694582">.</span><span class="ident" id="1694583"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796749">recvq</a></span><span class="op" id="1694588">.</span><span class="ident" id="1694589"><a href="/gostd/runtime/chan.go.html#1505850">dequeue</a></span><span class="op" id="1694596">(</span><span class="op" id="1694597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694603">if</span>&nbsp;<span class="ident" id="1694606"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span>&nbsp;<span class="op" id="1694609">!=</span>&nbsp;<span class="builtintype" id="1694612">nil</span>&nbsp;<span class="op" id="1694616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694623">goto</span>&nbsp;<span class="ident" id="1694628"><a href="/gostd/runtime/select.go.html#1699230">syncsend</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1694641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1694646">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694651">case</span>&nbsp;<span class="ident" id="1694656"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796835">_CaseDefault</a></span><span class="op" id="1694668">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1694673"><a href="/gostd/runtime/select.go.html#1693986">dfl</a></span>&nbsp;<span class="op" id="1694677">=</span>&nbsp;<span class="ident" id="1694679"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1694685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1694688">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694692">if</span>&nbsp;<span class="ident" id="1694695"><a href="/gostd/runtime/select.go.html#1693986">dfl</a></span>&nbsp;<span class="op" id="1694699">!=</span>&nbsp;<span class="builtintype" id="1694702">nil</span>&nbsp;<span class="op" id="1694706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1694710"><a href="/gostd/runtime/select.go.html#1689994">selunlock</a></span><span class="op" id="1694719">(</span><span class="ident" id="1694720"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1694723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1694727"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span>&nbsp;<span class="op" id="1694731">=</span>&nbsp;<span class="ident" id="1694733"><a href="/gostd/runtime/select.go.html#1693986">dfl</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694739">goto</span>&nbsp;<span class="ident" id="1694744"><a href="/gostd/runtime/select.go.html#1699667">retc</a></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1694750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1694754">//&nbsp;pass&nbsp;2&nbsp;-&nbsp;enqueue&nbsp;on&nbsp;all&nbsp;chans</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1694788"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span>&nbsp;<span class="op" id="1694791">=</span>&nbsp;<span class="ident" id="1694793"><a href="/gostd/runtime/stubs.go.html#1738919">getg</a></span><span class="op" id="1694797">(</span><span class="op" id="1694798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1694801"><a href="/gostd/runtime/select.go.html#1693829">done</a></span>&nbsp;<span class="op" id="1694806">=</span>&nbsp;<span class="num" id="1694808">0</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1694811">for</span>&nbsp;<span class="ident" id="1694815">i</span>&nbsp;<span class="op" id="1694817">:=</span>&nbsp;<span class="num" id="1694820">0</span><span class="op" id="1694821">;</span>&nbsp;<span class="ident" id="1694823"><a href="/gostd/runtime/select.go.html#1694815">i</a></span>&nbsp;<span class="op" id="1694825">&lt;</span>&nbsp;<span class="builtintype" id="1694827">int</span><span class="op" id="1694830">(</span><span class="ident" id="1694831"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1694834">.</span><span class="ident" id="1694835"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1694840">)</span><span class="op" id="1694841">;</span>&nbsp;<span class="ident" id="1694843"><a href="/gostd/runtime/select.go.html#1694815">i</a></span><span class="op" id="1694844">++</span>&nbsp;<span class="op" id="1694847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1694851"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span>&nbsp;<span class="op" id="1694855">=</span>&nbsp;<span class="op" id="1694857">&amp;</span><span class="ident" id="1694858"><a href="/gostd/runtime/select.go.html#1691675">scases</a></span><span class="op" id="1694864">[</span><span class="ident" id="1694865"><a href="/gostd/runtime/select.go.html#1692373">pollorder</a></span><span class="op" id="1694874">[</span><span class="ident" id="1694875"><a href="/gostd/runtime/select.go.html#1694815">i</a></span><span class="op" id="1694876">]</span><span class="op" id="1694877">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1694881"><a href="/gostd/runtime/select.go.html#1693861">c</a></span>&nbsp;<span class="op" id="1694883">=</span>&nbsp;<span class="ident" id="1694885"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1694888">.</span><span class="ident" id="1694889"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796894">_chan</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1694897">sg</span>&nbsp;<span class="op" id="1694900">:=</span>&nbsp;<span class="ident" id="1694903"><a href="/gostd/runtime/proc.go.html#1674038">acquireSudog</a></span><span class="op" id="1694915">(</span><span class="op" id="1694916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1694920"><a href="/gostd/runtime/select.go.html#1694897">sg</a></span><span class="op" id="1694922">.</span><span class="ident" id="1694923"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786765">g</a></span>&nbsp;<span class="op" id="1694925">=</span>&nbsp;<span class="ident" id="1694927"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1694932">//&nbsp;Note:&nbsp;selectdone&nbsp;is&nbsp;adjusted&nbsp;for&nbsp;stack&nbsp;copies&nbsp;in&nbsp;stack.c:adjustsudogs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695007"><a href="/gostd/runtime/select.go.html#1694897">sg</a></span><span class="op" id="1695009">.</span><span class="ident" id="1695010"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786771">selectdone</a></span>&nbsp;<span class="op" id="1695021">=</span>&nbsp;<span class="op" id="1695023">(</span><span class="op" id="1695024">*</span><span class="builtintype" id="1695025">uint32</span><span class="op" id="1695031">)</span><span class="op" id="1695032">(</span><span class="ident" id="1695033"><a href="/gostd/runtime/stubs.go.html#1743320">noescape</a></span><span class="op" id="1695041">(</span><span class="ident" id="1695042"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1695048">.</span><span class="ident" id="1695049">Pointer</span><span class="op" id="1695056">(</span><span class="op" id="1695057">&amp;</span><span class="ident" id="1695058"><a href="/gostd/runtime/select.go.html#1693829">done</a></span><span class="op" id="1695062">)</span><span class="op" id="1695063">)</span><span class="op" id="1695064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695068"><a href="/gostd/runtime/select.go.html#1694897">sg</a></span><span class="op" id="1695070">.</span><span class="ident" id="1695071"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786817">elem</a></span>&nbsp;<span class="op" id="1695076">=</span>&nbsp;<span class="ident" id="1695078"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1695081">.</span><span class="ident" id="1695082"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695089"><a href="/gostd/runtime/select.go.html#1694897">sg</a></span><span class="op" id="1695091">.</span><span class="ident" id="1695092"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786838">releasetime</a></span>&nbsp;<span class="op" id="1695104">=</span>&nbsp;<span class="num" id="1695106">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1695110">if</span>&nbsp;<span class="ident" id="1695113"><a href="/gostd/runtime/select.go.html#1691732">t0</a></span>&nbsp;<span class="op" id="1695116">!=</span>&nbsp;<span class="num" id="1695119">0</span>&nbsp;<span class="op" id="1695121">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695126"><a href="/gostd/runtime/select.go.html#1694897">sg</a></span><span class="op" id="1695128">.</span><span class="ident" id="1695129"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786838">releasetime</a></span>&nbsp;<span class="op" id="1695141">=</span>&nbsp;<span class="op" id="1695143">-</span><span class="num" id="1695144">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1695148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695152"><a href="/gostd/runtime/select.go.html#1694897">sg</a></span><span class="op" id="1695154">.</span><span class="ident" id="1695155"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786873">waitlink</a></span>&nbsp;<span class="op" id="1695164">=</span>&nbsp;<span class="ident" id="1695166"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><span class="op" id="1695168">.</span><span class="ident" id="1695169"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1787771">waiting</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695179"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><span class="op" id="1695181">.</span><span class="ident" id="1695182"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1787771">waiting</a></span>&nbsp;<span class="op" id="1695190">=</span>&nbsp;<span class="ident" id="1695192"><a href="/gostd/runtime/select.go.html#1694897">sg</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1695198">switch</span>&nbsp;<span class="ident" id="1695205"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1695208">.</span><span class="ident" id="1695209"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796920">kind</a></span>&nbsp;<span class="op" id="1695214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1695218">case</span>&nbsp;<span class="ident" id="1695223"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796795">_CaseRecv</a></span><span class="op" id="1695232">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695237"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1695238">.</span><span class="ident" id="1695239"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796749">recvq</a></span><span class="op" id="1695244">.</span><span class="ident" id="1695245"><a href="/gostd/runtime/chan.go.html#1505696">enqueue</a></span><span class="op" id="1695252">(</span><span class="ident" id="1695253"><a href="/gostd/runtime/select.go.html#1694897">sg</a></span><span class="op" id="1695255">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1695260">case</span>&nbsp;<span class="ident" id="1695265"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796815">_CaseSend</a></span><span class="op" id="1695274">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695279"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1695280">.</span><span class="ident" id="1695281"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796762">sendq</a></span><span class="op" id="1695286">.</span><span class="ident" id="1695287"><a href="/gostd/runtime/chan.go.html#1505696">enqueue</a></span><span class="op" id="1695294">(</span><span class="ident" id="1695295"><a href="/gostd/runtime/select.go.html#1694897">sg</a></span><span class="op" id="1695297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1695301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1695304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1695308">//&nbsp;wait&nbsp;for&nbsp;someone&nbsp;to&nbsp;wake&nbsp;us&nbsp;up</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695343"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><span class="op" id="1695345">.</span><span class="ident" id="1695346"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1787421">param</a></span>&nbsp;<span class="op" id="1695352">=</span>&nbsp;<span class="builtintype" id="1695354">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695359"><a href="/gostd/runtime/proc.go.html#1673271">gopark</a></span><span class="op" id="1695365">(</span><span class="ident" id="1695366"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1695372">.</span><span class="ident" id="1695373">Pointer</span><span class="op" id="1695380">(</span><span class="ident" id="1695381"><a href="/gostd/runtime/proc.go.html#1675458">funcPC</a></span><span class="op" id="1695387">(</span><span class="ident" id="1695388"><a href="/gostd/runtime/select.go.html#1690950">selparkcommit</a></span><span class="op" id="1695401">)</span><span class="op" id="1695402">)</span><span class="op" id="1695403">,</span>&nbsp;<span class="ident" id="1695405"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1695411">.</span><span class="ident" id="1695412">Pointer</span><span class="op" id="1695419">(</span><span class="ident" id="1695420"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1695423">)</span><span class="op" id="1695424">,</span>&nbsp;<span class="string" id="1695426">&#34;select&#34;</span><span class="op" id="1695434">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1695438">//&nbsp;someone&nbsp;woke&nbsp;us&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695461"><a href="/gostd/runtime/select.go.html#1689710">sellock</a></span><span class="op" id="1695468">(</span><span class="ident" id="1695469"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1695472">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695475"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span>&nbsp;<span class="op" id="1695478">=</span>&nbsp;<span class="op" id="1695480">(</span><span class="op" id="1695481">*</span><span class="ident" id="1695482"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786749">sudog</a></span><span class="op" id="1695487">)</span><span class="op" id="1695488">(</span><span class="ident" id="1695489"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><span class="op" id="1695491">.</span><span class="ident" id="1695492"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1787421">param</a></span><span class="op" id="1695497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695500"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><span class="op" id="1695502">.</span><span class="ident" id="1695503"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1787421">param</a></span>&nbsp;<span class="op" id="1695509">=</span>&nbsp;<span class="builtintype" id="1695511">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1695517">//&nbsp;pass&nbsp;3&nbsp;-&nbsp;dequeue&nbsp;from&nbsp;unsuccessful&nbsp;chans</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1695562">//&nbsp;otherwise&nbsp;they&nbsp;stack&nbsp;up&nbsp;on&nbsp;quiet&nbsp;channels</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1695608">//&nbsp;record&nbsp;the&nbsp;successful&nbsp;case,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1695648">//&nbsp;We&nbsp;singly-linked&nbsp;up&nbsp;the&nbsp;SudoGs&nbsp;in&nbsp;case&nbsp;order,&nbsp;so&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1695706">//&nbsp;iterating&nbsp;through&nbsp;the&nbsp;linked&nbsp;list&nbsp;they&nbsp;are&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695771"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span>&nbsp;<span class="op" id="1695775">=</span>&nbsp;<span class="builtintype" id="1695777">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1695782"><a href="/gostd/runtime/select.go.html#1693893">sglist</a></span>&nbsp;<span class="op" id="1695789">=</span>&nbsp;<span class="ident" id="1695791"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><span class="op" id="1695793">.</span><span class="ident" id="1695794"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1787771">waiting</a></span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1695803">//&nbsp;Clear&nbsp;all&nbsp;selectdone&nbsp;and&nbsp;elem&nbsp;before&nbsp;unlinking&nbsp;from&nbsp;gp.waiting.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1695871">//&nbsp;They&nbsp;must&nbsp;be&nbsp;cleared&nbsp;before&nbsp;being&nbsp;put&nbsp;back&nbsp;into&nbsp;the&nbsp;sudog&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1695940">//&nbsp;Clear&nbsp;before&nbsp;unlinking,&nbsp;because&nbsp;if&nbsp;a&nbsp;stack&nbsp;copy&nbsp;happens&nbsp;after&nbsp;the&nbsp;unlink,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1696018">//&nbsp;they&nbsp;will&nbsp;not&nbsp;be&nbsp;updated,&nbsp;they&nbsp;will&nbsp;be&nbsp;left&nbsp;pointing&nbsp;to&nbsp;the&nbsp;old&nbsp;stack,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1696093">//&nbsp;which&nbsp;creates&nbsp;dangling&nbsp;pointers,&nbsp;which&nbsp;may&nbsp;be&nbsp;detected&nbsp;by&nbsp;the</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1696159">//&nbsp;garbage&nbsp;collector.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1696182">for</span>&nbsp;<span class="ident" id="1696186">sg1</span>&nbsp;<span class="op" id="1696190">:=</span>&nbsp;<span class="ident" id="1696193"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><span class="op" id="1696195">.</span><span class="ident" id="1696196"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1787771">waiting</a></span><span class="op" id="1696203">;</span>&nbsp;<span class="ident" id="1696205"><a href="/gostd/runtime/select.go.html#1696186">sg1</a></span>&nbsp;<span class="op" id="1696209">!=</span>&nbsp;<span class="builtintype" id="1696212">nil</span><span class="op" id="1696215">;</span>&nbsp;<span class="ident" id="1696217"><a href="/gostd/runtime/select.go.html#1696186">sg1</a></span>&nbsp;<span class="op" id="1696221">=</span>&nbsp;<span class="ident" id="1696223"><a href="/gostd/runtime/select.go.html#1696186">sg1</a></span><span class="op" id="1696226">.</span><span class="ident" id="1696227"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786873">waitlink</a></span>&nbsp;<span class="op" id="1696236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696240"><a href="/gostd/runtime/select.go.html#1696186">sg1</a></span><span class="op" id="1696243">.</span><span class="ident" id="1696244"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786771">selectdone</a></span>&nbsp;<span class="op" id="1696255">=</span>&nbsp;<span class="builtintype" id="1696257">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696263"><a href="/gostd/runtime/select.go.html#1696186">sg1</a></span><span class="op" id="1696266">.</span><span class="ident" id="1696267"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786817">elem</a></span>&nbsp;<span class="op" id="1696272">=</span>&nbsp;<span class="builtintype" id="1696274">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1696279">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696282"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><span class="op" id="1696284">.</span><span class="ident" id="1696285"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1787771">waiting</a></span>&nbsp;<span class="op" id="1696293">=</span>&nbsp;<span class="builtintype" id="1696295">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1696300">for</span>&nbsp;<span class="ident" id="1696304">i</span>&nbsp;<span class="op" id="1696306">:=</span>&nbsp;<span class="builtintype" id="1696309">int</span><span class="op" id="1696312">(</span><span class="ident" id="1696313"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1696316">.</span><span class="ident" id="1696317"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1797019">ncase</a></span><span class="op" id="1696322">)</span>&nbsp;<span class="op" id="1696324">-</span>&nbsp;<span class="num" id="1696326">1</span><span class="op" id="1696327">;</span>&nbsp;<span class="ident" id="1696329"><a href="/gostd/runtime/select.go.html#1696304">i</a></span>&nbsp;<span class="op" id="1696331">&gt;=</span>&nbsp;<span class="num" id="1696334">0</span><span class="op" id="1696335">;</span>&nbsp;<span class="ident" id="1696337"><a href="/gostd/runtime/select.go.html#1696304">i</a></span><span class="op" id="1696338">--</span>&nbsp;<span class="op" id="1696341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696345"><a href="/gostd/runtime/select.go.html#1693877">k</a></span>&nbsp;<span class="op" id="1696347">=</span>&nbsp;<span class="op" id="1696349">&amp;</span><span class="ident" id="1696350"><a href="/gostd/runtime/select.go.html#1691675">scases</a></span><span class="op" id="1696356">[</span><span class="ident" id="1696357"><a href="/gostd/runtime/select.go.html#1692373">pollorder</a></span><span class="op" id="1696366">[</span><span class="ident" id="1696367"><a href="/gostd/runtime/select.go.html#1696304">i</a></span><span class="op" id="1696368">]</span><span class="op" id="1696369">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1696373">if</span>&nbsp;<span class="ident" id="1696376"><a href="/gostd/runtime/select.go.html#1693893">sglist</a></span><span class="op" id="1696382">.</span><span class="ident" id="1696383"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786838">releasetime</a></span>&nbsp;<span class="op" id="1696395">&gt;</span>&nbsp;<span class="num" id="1696397">0</span>&nbsp;<span class="op" id="1696399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696404"><a href="/gostd/runtime/select.go.html#1693877">k</a></span><span class="op" id="1696405">.</span><span class="ident" id="1696406"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796961">releasetime</a></span>&nbsp;<span class="op" id="1696418">=</span>&nbsp;<span class="ident" id="1696420"><a href="/gostd/runtime/select.go.html#1693893">sglist</a></span><span class="op" id="1696426">.</span><span class="ident" id="1696427"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786838">releasetime</a></span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1696441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1696445">if</span>&nbsp;<span class="ident" id="1696448"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span>&nbsp;<span class="op" id="1696451">==</span>&nbsp;<span class="ident" id="1696454"><a href="/gostd/runtime/select.go.html#1693893">sglist</a></span>&nbsp;<span class="op" id="1696461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696466"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span>&nbsp;<span class="op" id="1696470">=</span>&nbsp;<span class="ident" id="1696472"><a href="/gostd/runtime/select.go.html#1693877">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1696476">}</span>&nbsp;<span class="keyword" id="1696478">else</span>&nbsp;<span class="op" id="1696483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696488"><a href="/gostd/runtime/select.go.html#1693861">c</a></span>&nbsp;<span class="op" id="1696490">=</span>&nbsp;<span class="ident" id="1696492"><a href="/gostd/runtime/select.go.html#1693877">k</a></span><span class="op" id="1696493">.</span><span class="ident" id="1696494"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796894">_chan</a></span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1696503">if</span>&nbsp;<span class="ident" id="1696506"><a href="/gostd/runtime/select.go.html#1693877">k</a></span><span class="op" id="1696507">.</span><span class="ident" id="1696508"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796920">kind</a></span>&nbsp;<span class="op" id="1696513">==</span>&nbsp;<span class="ident" id="1696516"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796815">_CaseSend</a></span>&nbsp;<span class="op" id="1696526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696532"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1696533">.</span><span class="ident" id="1696534"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796762">sendq</a></span><span class="op" id="1696539">.</span><span class="ident" id="1696540"><a href="/gostd/runtime/select.go.html#1701326">dequeueSudoG</a></span><span class="op" id="1696552">(</span><span class="ident" id="1696553"><a href="/gostd/runtime/select.go.html#1693893">sglist</a></span><span class="op" id="1696559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1696564">}</span>&nbsp;<span class="keyword" id="1696566">else</span>&nbsp;<span class="op" id="1696571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696577"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1696578">.</span><span class="ident" id="1696579"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796749">recvq</a></span><span class="op" id="1696584">.</span><span class="ident" id="1696585"><a href="/gostd/runtime/select.go.html#1701326">dequeueSudoG</a></span><span class="op" id="1696597">(</span><span class="ident" id="1696598"><a href="/gostd/runtime/select.go.html#1693893">sglist</a></span><span class="op" id="1696604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1696609">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1696613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696617"><a href="/gostd/runtime/select.go.html#1693909">sgnext</a></span>&nbsp;<span class="op" id="1696624">=</span>&nbsp;<span class="ident" id="1696626"><a href="/gostd/runtime/select.go.html#1693893">sglist</a></span><span class="op" id="1696632">.</span><span class="ident" id="1696633"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786873">waitlink</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696644"><a href="/gostd/runtime/select.go.html#1693893">sglist</a></span><span class="op" id="1696650">.</span><span class="ident" id="1696651"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786873">waitlink</a></span>&nbsp;<span class="op" id="1696660">=</span>&nbsp;<span class="builtintype" id="1696662">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696668"><a href="/gostd/runtime/proc.go.html#1674768">releaseSudog</a></span><span class="op" id="1696680">(</span><span class="ident" id="1696681"><a href="/gostd/runtime/select.go.html#1693893">sglist</a></span><span class="op" id="1696687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696691"><a href="/gostd/runtime/select.go.html#1693893">sglist</a></span>&nbsp;<span class="op" id="1696698">=</span>&nbsp;<span class="ident" id="1696700"><a href="/gostd/runtime/select.go.html#1693909">sgnext</a></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1696708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1696712">if</span>&nbsp;<span class="ident" id="1696715"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span>&nbsp;<span class="op" id="1696719">==</span>&nbsp;<span class="builtintype" id="1696722">nil</span>&nbsp;<span class="op" id="1696726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1696730">goto</span>&nbsp;<span class="ident" id="1696735"><a href="/gostd/runtime/select.go.html#1693927">loop</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1696741">}</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696745"><a href="/gostd/runtime/select.go.html#1693861">c</a></span>&nbsp;<span class="op" id="1696747">=</span>&nbsp;<span class="ident" id="1696749"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1696752">.</span><span class="ident" id="1696753"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796894">_chan</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1696761">if</span>&nbsp;<span class="ident" id="1696764"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1696765">.</span><span class="ident" id="1696766"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796650">dataqsiz</a></span>&nbsp;<span class="op" id="1696775">&gt;</span>&nbsp;<span class="num" id="1696777">0</span>&nbsp;<span class="op" id="1696779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1696783"><a href="/gostd/runtime/panic.go.html#1664327">gothrow</a></span><span class="op" id="1696790">(</span><span class="string" id="1696791">&#34;selectgo:&nbsp;shouldn&#39;t&nbsp;happen&#34;</span><span class="op" id="1696819">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1696822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1696826">if</span>&nbsp;<span class="ident" id="1696829"><a href="/gostd/runtime/select.go.html#1686202">debugSelect</a></span>&nbsp;<span class="op" id="1696841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1696845">print</span><span class="op" id="1696850">(</span><span class="string" id="1696851">&#34;wait-return:&nbsp;sel=&#34;</span><span class="op" id="1696870">,</span>&nbsp;<span class="ident" id="1696872"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1696875">,</span>&nbsp;<span class="string" id="1696877">&#34;&nbsp;c=&#34;</span><span class="op" id="1696882">,</span>&nbsp;<span class="ident" id="1696884"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1696885">,</span>&nbsp;<span class="string" id="1696887">&#34;&nbsp;cas=&#34;</span><span class="op" id="1696894">,</span>&nbsp;<span class="ident" id="1696896"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1696899">,</span>&nbsp;<span class="string" id="1696901">&#34;&nbsp;kind=&#34;</span><span class="op" id="1696909">,</span>&nbsp;<span class="ident" id="1696911"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1696914">.</span><span class="ident" id="1696915"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796920">kind</a></span><span class="op" id="1696919">,</span>&nbsp;<span class="string" id="1696921">&#34;\n&#34;</span><span class="op" id="1696925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1696928">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1696932">if</span>&nbsp;<span class="ident" id="1696935"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1696938">.</span><span class="ident" id="1696939"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796920">kind</a></span>&nbsp;<span class="op" id="1696944">==</span>&nbsp;<span class="ident" id="1696947"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796795">_CaseRecv</a></span>&nbsp;<span class="op" id="1696957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1696961">if</span>&nbsp;<span class="ident" id="1696964"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1696967">.</span><span class="ident" id="1696968"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796944">receivedp</a></span>&nbsp;<span class="op" id="1696978">!=</span>&nbsp;<span class="builtintype" id="1696981">nil</span>&nbsp;<span class="op" id="1696985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1696990">*</span><span class="ident" id="1696991"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1696994">.</span><span class="ident" id="1696995"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796944">receivedp</a></span>&nbsp;<span class="op" id="1697005">=</span>&nbsp;<span class="builtintype" id="1697007">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1697014">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1697017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1697021">if</span>&nbsp;<span class="ident" id="1697024"><a href="/gostd/runtime/race0.go.html#1676514">raceenabled</a></span>&nbsp;<span class="op" id="1697036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1697040">if</span>&nbsp;<span class="ident" id="1697043"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1697046">.</span><span class="ident" id="1697047"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796920">kind</a></span>&nbsp;<span class="op" id="1697052">==</span>&nbsp;<span class="ident" id="1697055"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796795">_CaseRecv</a></span>&nbsp;<span class="op" id="1697065">&amp;&amp;</span>&nbsp;<span class="ident" id="1697068"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1697071">.</span><span class="ident" id="1697072"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span>&nbsp;<span class="op" id="1697077">!=</span>&nbsp;<span class="builtintype" id="1697080">nil</span>&nbsp;<span class="op" id="1697084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697089"><a href="/gostd/runtime/race0.go.html#1676712">raceWriteObjectPC</a></span><span class="op" id="1697106">(</span><span class="ident" id="1697107"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697108">.</span><span class="ident" id="1697109"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796708">elemtype</a></span><span class="op" id="1697117">,</span>&nbsp;<span class="ident" id="1697119"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1697122">.</span><span class="ident" id="1697123"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span><span class="op" id="1697127">,</span>&nbsp;<span class="ident" id="1697129"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1697132">.</span><span class="ident" id="1697133"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796908">pc</a></span><span class="op" id="1697135">,</span>&nbsp;<span class="ident" id="1697137"><a href="/gostd/runtime/select.go.html#1686263">chanrecvpc</a></span><span class="op" id="1697147">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1697151">}</span>&nbsp;<span class="keyword" id="1697153">else</span>&nbsp;<span class="keyword" id="1697158">if</span>&nbsp;<span class="ident" id="1697161"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1697164">.</span><span class="ident" id="1697165"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796920">kind</a></span>&nbsp;<span class="op" id="1697170">==</span>&nbsp;<span class="ident" id="1697173"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796815">_CaseSend</a></span>&nbsp;<span class="op" id="1697183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697188"><a href="/gostd/runtime/race0.go.html#1676616">raceReadObjectPC</a></span><span class="op" id="1697204">(</span><span class="ident" id="1697205"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697206">.</span><span class="ident" id="1697207"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796708">elemtype</a></span><span class="op" id="1697215">,</span>&nbsp;<span class="ident" id="1697217"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1697220">.</span><span class="ident" id="1697221"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span><span class="op" id="1697225">,</span>&nbsp;<span class="ident" id="1697227"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1697230">.</span><span class="ident" id="1697231"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796908">pc</a></span><span class="op" id="1697233">,</span>&nbsp;<span class="ident" id="1697235"><a href="/gostd/runtime/select.go.html#1686232">chansendpc</a></span><span class="op" id="1697245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1697249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1697252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697256"><a href="/gostd/runtime/select.go.html#1689994">selunlock</a></span><span class="op" id="1697265">(</span><span class="ident" id="1697266"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1697269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1697272">goto</span>&nbsp;<span class="ident" id="1697277"><a href="/gostd/runtime/select.go.html#1699667">retc</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="1697283">asyncrecv</span><span class="op" id="1697292">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1697295">//&nbsp;can&nbsp;receive&nbsp;from&nbsp;buffer</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1697323">if</span>&nbsp;<span class="ident" id="1697326"><a href="/gostd/runtime/race0.go.html#1676514">raceenabled</a></span>&nbsp;<span class="op" id="1697338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1697342">if</span>&nbsp;<span class="ident" id="1697345"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1697348">.</span><span class="ident" id="1697349"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span>&nbsp;<span class="op" id="1697354">!=</span>&nbsp;<span class="builtintype" id="1697357">nil</span>&nbsp;<span class="op" id="1697361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697366"><a href="/gostd/runtime/race0.go.html#1676712">raceWriteObjectPC</a></span><span class="op" id="1697383">(</span><span class="ident" id="1697384"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697385">.</span><span class="ident" id="1697386"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796708">elemtype</a></span><span class="op" id="1697394">,</span>&nbsp;<span class="ident" id="1697396"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1697399">.</span><span class="ident" id="1697400"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span><span class="op" id="1697404">,</span>&nbsp;<span class="ident" id="1697406"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1697409">.</span><span class="ident" id="1697410"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796908">pc</a></span><span class="op" id="1697412">,</span>&nbsp;<span class="ident" id="1697414"><a href="/gostd/runtime/select.go.html#1686263">chanrecvpc</a></span><span class="op" id="1697424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1697428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697432"><a href="/gostd/runtime/race0.go.html#1677480">raceacquire</a></span><span class="op" id="1697443">(</span><span class="ident" id="1697444"><a href="/gostd/runtime/chan.go.html#1493709">chanbuf</a></span><span class="op" id="1697451">(</span><span class="ident" id="1697452"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697453">,</span>&nbsp;<span class="ident" id="1697455"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697456">.</span><span class="ident" id="1697457"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796737">recvx</a></span><span class="op" id="1697462">)</span><span class="op" id="1697463">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697467"><a href="/gostd/runtime/race0.go.html#1677672">racerelease</a></span><span class="op" id="1697478">(</span><span class="ident" id="1697479"><a href="/gostd/runtime/chan.go.html#1493709">chanbuf</a></span><span class="op" id="1697486">(</span><span class="ident" id="1697487"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697488">,</span>&nbsp;<span class="ident" id="1697490"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697491">.</span><span class="ident" id="1697492"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796737">recvx</a></span><span class="op" id="1697497">)</span><span class="op" id="1697498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1697501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1697504">if</span>&nbsp;<span class="ident" id="1697507"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1697510">.</span><span class="ident" id="1697511"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796944">receivedp</a></span>&nbsp;<span class="op" id="1697521">!=</span>&nbsp;<span class="builtintype" id="1697524">nil</span>&nbsp;<span class="op" id="1697528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1697532">*</span><span class="ident" id="1697533"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1697536">.</span><span class="ident" id="1697537"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796944">receivedp</a></span>&nbsp;<span class="op" id="1697547">=</span>&nbsp;<span class="builtintype" id="1697549">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1697555">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1697558">if</span>&nbsp;<span class="ident" id="1697561"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1697564">.</span><span class="ident" id="1697565"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span>&nbsp;<span class="op" id="1697570">!=</span>&nbsp;<span class="builtintype" id="1697573">nil</span>&nbsp;<span class="op" id="1697577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697581"><a href="/gostd/runtime/stubs.go.html#1742708">memmove</a></span><span class="op" id="1697588">(</span><span class="ident" id="1697589"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1697592">.</span><span class="ident" id="1697593"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span><span class="op" id="1697597">,</span>&nbsp;<span class="ident" id="1697599"><a href="/gostd/runtime/chan.go.html#1493709">chanbuf</a></span><span class="op" id="1697606">(</span><span class="ident" id="1697607"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697608">,</span>&nbsp;<span class="ident" id="1697610"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697611">.</span><span class="ident" id="1697612"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796737">recvx</a></span><span class="op" id="1697617">)</span><span class="op" id="1697618">,</span>&nbsp;<span class="builtintype" id="1697620">uintptr</span><span class="op" id="1697627">(</span><span class="ident" id="1697628"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697629">.</span><span class="ident" id="1697630"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796676">elemsize</a></span><span class="op" id="1697638">)</span><span class="op" id="1697639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1697642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697645"><a href="/gostd/runtime/stubs.go.html#1742585">memclr</a></span><span class="op" id="1697651">(</span><span class="ident" id="1697652"><a href="/gostd/runtime/chan.go.html#1493709">chanbuf</a></span><span class="op" id="1697659">(</span><span class="ident" id="1697660"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697661">,</span>&nbsp;<span class="ident" id="1697663"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697664">.</span><span class="ident" id="1697665"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796737">recvx</a></span><span class="op" id="1697670">)</span><span class="op" id="1697671">,</span>&nbsp;<span class="builtintype" id="1697673">uintptr</span><span class="op" id="1697680">(</span><span class="ident" id="1697681"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697682">.</span><span class="ident" id="1697683"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796676">elemsize</a></span><span class="op" id="1697691">)</span><span class="op" id="1697692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697695"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697696">.</span><span class="ident" id="1697697"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796737">recvx</a></span><span class="op" id="1697702">++</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1697706">if</span>&nbsp;<span class="ident" id="1697709"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697710">.</span><span class="ident" id="1697711"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796737">recvx</a></span>&nbsp;<span class="op" id="1697717">==</span>&nbsp;<span class="ident" id="1697720"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697721">.</span><span class="ident" id="1697722"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796650">dataqsiz</a></span>&nbsp;<span class="op" id="1697731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697735"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697736">.</span><span class="ident" id="1697737"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796737">recvx</a></span>&nbsp;<span class="op" id="1697743">=</span>&nbsp;<span class="num" id="1697745">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1697748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697751"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697752">.</span><span class="ident" id="1697753"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796637">qcount</a></span><span class="op" id="1697759">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697763"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span>&nbsp;<span class="op" id="1697766">=</span>&nbsp;<span class="ident" id="1697768"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1697769">.</span><span class="ident" id="1697770"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796762">sendq</a></span><span class="op" id="1697775">.</span><span class="ident" id="1697776"><a href="/gostd/runtime/chan.go.html#1505850">dequeue</a></span><span class="op" id="1697783">(</span><span class="op" id="1697784">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1697787">if</span>&nbsp;<span class="ident" id="1697790"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span>&nbsp;<span class="op" id="1697793">!=</span>&nbsp;<span class="builtintype" id="1697796">nil</span>&nbsp;<span class="op" id="1697800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697804"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span>&nbsp;<span class="op" id="1697807">=</span>&nbsp;<span class="ident" id="1697809"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1697811">.</span><span class="ident" id="1697812"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786765">g</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697816"><a href="/gostd/runtime/select.go.html#1689994">selunlock</a></span><span class="op" id="1697825">(</span><span class="ident" id="1697826"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1697829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1697833">if</span>&nbsp;<span class="ident" id="1697836"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1697838">.</span><span class="ident" id="1697839"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786838">releasetime</a></span>&nbsp;<span class="op" id="1697851">!=</span>&nbsp;<span class="num" id="1697854">0</span>&nbsp;<span class="op" id="1697856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697861"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1697863">.</span><span class="ident" id="1697864"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786838">releasetime</a></span>&nbsp;<span class="op" id="1697876">=</span>&nbsp;<span class="ident" id="1697878"><a href="/gostd/runtime/stubs.go.html#1744144">cputicks</a></span><span class="op" id="1697886">(</span><span class="op" id="1697887">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1697891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697895"><a href="/gostd/runtime/proc.go.html#1673919">goready</a></span><span class="op" id="1697902">(</span><span class="ident" id="1697903"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><span class="op" id="1697905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1697908">}</span>&nbsp;<span class="keyword" id="1697910">else</span>&nbsp;<span class="op" id="1697915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1697919"><a href="/gostd/runtime/select.go.html#1689994">selunlock</a></span><span class="op" id="1697928">(</span><span class="ident" id="1697929"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1697932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1697935">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1697938">goto</span>&nbsp;<span class="ident" id="1697943"><a href="/gostd/runtime/select.go.html#1699667">retc</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="1697949">asyncsend</span><span class="op" id="1697958">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1697961">//&nbsp;can&nbsp;send&nbsp;to&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1697984">if</span>&nbsp;<span class="ident" id="1697987"><a href="/gostd/runtime/race0.go.html#1676514">raceenabled</a></span>&nbsp;<span class="op" id="1697999">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698003"><a href="/gostd/runtime/race0.go.html#1677480">raceacquire</a></span><span class="op" id="1698014">(</span><span class="ident" id="1698015"><a href="/gostd/runtime/chan.go.html#1493709">chanbuf</a></span><span class="op" id="1698022">(</span><span class="ident" id="1698023"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698024">,</span>&nbsp;<span class="ident" id="1698026"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698027">.</span><span class="ident" id="1698028"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796725">sendx</a></span><span class="op" id="1698033">)</span><span class="op" id="1698034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698038"><a href="/gostd/runtime/race0.go.html#1677672">racerelease</a></span><span class="op" id="1698049">(</span><span class="ident" id="1698050"><a href="/gostd/runtime/chan.go.html#1493709">chanbuf</a></span><span class="op" id="1698057">(</span><span class="ident" id="1698058"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698059">,</span>&nbsp;<span class="ident" id="1698061"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698062">.</span><span class="ident" id="1698063"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796725">sendx</a></span><span class="op" id="1698068">)</span><span class="op" id="1698069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698073"><a href="/gostd/runtime/race0.go.html#1676616">raceReadObjectPC</a></span><span class="op" id="1698089">(</span><span class="ident" id="1698090"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698091">.</span><span class="ident" id="1698092"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796708">elemtype</a></span><span class="op" id="1698100">,</span>&nbsp;<span class="ident" id="1698102"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1698105">.</span><span class="ident" id="1698106"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span><span class="op" id="1698110">,</span>&nbsp;<span class="ident" id="1698112"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1698115">.</span><span class="ident" id="1698116"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796908">pc</a></span><span class="op" id="1698118">,</span>&nbsp;<span class="ident" id="1698120"><a href="/gostd/runtime/select.go.html#1686232">chansendpc</a></span><span class="op" id="1698130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1698133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698136"><a href="/gostd/runtime/stubs.go.html#1742708">memmove</a></span><span class="op" id="1698143">(</span><span class="ident" id="1698144"><a href="/gostd/runtime/chan.go.html#1493709">chanbuf</a></span><span class="op" id="1698151">(</span><span class="ident" id="1698152"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698153">,</span>&nbsp;<span class="ident" id="1698155"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698156">.</span><span class="ident" id="1698157"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796725">sendx</a></span><span class="op" id="1698162">)</span><span class="op" id="1698163">,</span>&nbsp;<span class="ident" id="1698165"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1698168">.</span><span class="ident" id="1698169"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span><span class="op" id="1698173">,</span>&nbsp;<span class="builtintype" id="1698175">uintptr</span><span class="op" id="1698182">(</span><span class="ident" id="1698183"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698184">.</span><span class="ident" id="1698185"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796676">elemsize</a></span><span class="op" id="1698193">)</span><span class="op" id="1698194">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698197"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698198">.</span><span class="ident" id="1698199"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796725">sendx</a></span><span class="op" id="1698204">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1698208">if</span>&nbsp;<span class="ident" id="1698211"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698212">.</span><span class="ident" id="1698213"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796725">sendx</a></span>&nbsp;<span class="op" id="1698219">==</span>&nbsp;<span class="ident" id="1698222"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698223">.</span><span class="ident" id="1698224"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796650">dataqsiz</a></span>&nbsp;<span class="op" id="1698233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698237"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698238">.</span><span class="ident" id="1698239"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796725">sendx</a></span>&nbsp;<span class="op" id="1698245">=</span>&nbsp;<span class="num" id="1698247">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1698250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698253"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698254">.</span><span class="ident" id="1698255"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796637">qcount</a></span><span class="op" id="1698261">++</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698265"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span>&nbsp;<span class="op" id="1698268">=</span>&nbsp;<span class="ident" id="1698270"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698271">.</span><span class="ident" id="1698272"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796749">recvq</a></span><span class="op" id="1698277">.</span><span class="ident" id="1698278"><a href="/gostd/runtime/chan.go.html#1505850">dequeue</a></span><span class="op" id="1698285">(</span><span class="op" id="1698286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1698289">if</span>&nbsp;<span class="ident" id="1698292"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span>&nbsp;<span class="op" id="1698295">!=</span>&nbsp;<span class="builtintype" id="1698298">nil</span>&nbsp;<span class="op" id="1698302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698306"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span>&nbsp;<span class="op" id="1698309">=</span>&nbsp;<span class="ident" id="1698311"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1698313">.</span><span class="ident" id="1698314"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786765">g</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698318"><a href="/gostd/runtime/select.go.html#1689994">selunlock</a></span><span class="op" id="1698327">(</span><span class="ident" id="1698328"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1698331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1698335">if</span>&nbsp;<span class="ident" id="1698338"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1698340">.</span><span class="ident" id="1698341"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786838">releasetime</a></span>&nbsp;<span class="op" id="1698353">!=</span>&nbsp;<span class="num" id="1698356">0</span>&nbsp;<span class="op" id="1698358">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698363"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1698365">.</span><span class="ident" id="1698366"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786838">releasetime</a></span>&nbsp;<span class="op" id="1698378">=</span>&nbsp;<span class="ident" id="1698380"><a href="/gostd/runtime/stubs.go.html#1744144">cputicks</a></span><span class="op" id="1698388">(</span><span class="op" id="1698389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1698393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698397"><a href="/gostd/runtime/proc.go.html#1673919">goready</a></span><span class="op" id="1698404">(</span><span class="ident" id="1698405"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><span class="op" id="1698407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1698410">}</span>&nbsp;<span class="keyword" id="1698412">else</span>&nbsp;<span class="op" id="1698417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698421"><a href="/gostd/runtime/select.go.html#1689994">selunlock</a></span><span class="op" id="1698430">(</span><span class="ident" id="1698431"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1698434">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1698437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1698440">goto</span>&nbsp;<span class="ident" id="1698445"><a href="/gostd/runtime/select.go.html#1699667">retc</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="1698451">syncrecv</span><span class="op" id="1698459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1698462">//&nbsp;can&nbsp;receive&nbsp;from&nbsp;sleeping&nbsp;sender&nbsp;(sg)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1698504">if</span>&nbsp;<span class="ident" id="1698507"><a href="/gostd/runtime/race0.go.html#1676514">raceenabled</a></span>&nbsp;<span class="op" id="1698519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1698523">if</span>&nbsp;<span class="ident" id="1698526"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1698529">.</span><span class="ident" id="1698530"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span>&nbsp;<span class="op" id="1698535">!=</span>&nbsp;<span class="builtintype" id="1698538">nil</span>&nbsp;<span class="op" id="1698542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698547"><a href="/gostd/runtime/race0.go.html#1676712">raceWriteObjectPC</a></span><span class="op" id="1698564">(</span><span class="ident" id="1698565"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698566">.</span><span class="ident" id="1698567"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796708">elemtype</a></span><span class="op" id="1698575">,</span>&nbsp;<span class="ident" id="1698577"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1698580">.</span><span class="ident" id="1698581"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span><span class="op" id="1698585">,</span>&nbsp;<span class="ident" id="1698587"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1698590">.</span><span class="ident" id="1698591"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796908">pc</a></span><span class="op" id="1698593">,</span>&nbsp;<span class="ident" id="1698595"><a href="/gostd/runtime/select.go.html#1686263">chanrecvpc</a></span><span class="op" id="1698605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1698609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698613"><a href="/gostd/runtime/chan.go.html#1506248">racesync</a></span><span class="op" id="1698621">(</span><span class="ident" id="1698622"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698623">,</span>&nbsp;<span class="ident" id="1698625"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1698627">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1698630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698633"><a href="/gostd/runtime/select.go.html#1689994">selunlock</a></span><span class="op" id="1698642">(</span><span class="ident" id="1698643"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1698646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1698649">if</span>&nbsp;<span class="ident" id="1698652"><a href="/gostd/runtime/select.go.html#1686202">debugSelect</a></span>&nbsp;<span class="op" id="1698664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1698668">print</span><span class="op" id="1698673">(</span><span class="string" id="1698674">&#34;syncrecv:&nbsp;sel=&#34;</span><span class="op" id="1698690">,</span>&nbsp;<span class="ident" id="1698692"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1698695">,</span>&nbsp;<span class="string" id="1698697">&#34;&nbsp;c=&#34;</span><span class="op" id="1698702">,</span>&nbsp;<span class="ident" id="1698704"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698705">,</span>&nbsp;<span class="string" id="1698707">&#34;\n&#34;</span><span class="op" id="1698711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1698714">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1698717">if</span>&nbsp;<span class="ident" id="1698720"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1698723">.</span><span class="ident" id="1698724"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796944">receivedp</a></span>&nbsp;<span class="op" id="1698734">!=</span>&nbsp;<span class="builtintype" id="1698737">nil</span>&nbsp;<span class="op" id="1698741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1698745">*</span><span class="ident" id="1698746"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1698749">.</span><span class="ident" id="1698750"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796944">receivedp</a></span>&nbsp;<span class="op" id="1698760">=</span>&nbsp;<span class="builtintype" id="1698762">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1698768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1698771">if</span>&nbsp;<span class="ident" id="1698774"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1698777">.</span><span class="ident" id="1698778"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span>&nbsp;<span class="op" id="1698783">!=</span>&nbsp;<span class="builtintype" id="1698786">nil</span>&nbsp;<span class="op" id="1698790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698794"><a href="/gostd/runtime/stubs.go.html#1742708">memmove</a></span><span class="op" id="1698801">(</span><span class="ident" id="1698802"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1698805">.</span><span class="ident" id="1698806"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span><span class="op" id="1698810">,</span>&nbsp;<span class="ident" id="1698812"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1698814">.</span><span class="ident" id="1698815"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786817">elem</a></span><span class="op" id="1698819">,</span>&nbsp;<span class="builtintype" id="1698821">uintptr</span><span class="op" id="1698828">(</span><span class="ident" id="1698829"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1698830">.</span><span class="ident" id="1698831"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796676">elemsize</a></span><span class="op" id="1698839">)</span><span class="op" id="1698840">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1698843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698846"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1698848">.</span><span class="ident" id="1698849"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786817">elem</a></span>&nbsp;<span class="op" id="1698854">=</span>&nbsp;<span class="builtintype" id="1698856">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698861"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span>&nbsp;<span class="op" id="1698864">=</span>&nbsp;<span class="ident" id="1698866"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1698868">.</span><span class="ident" id="1698869"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786765">g</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698872"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><span class="op" id="1698874">.</span><span class="ident" id="1698875"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1787421">param</a></span>&nbsp;<span class="op" id="1698881">=</span>&nbsp;<span class="ident" id="1698883"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1698889">.</span><span class="ident" id="1698890">Pointer</span><span class="op" id="1698897">(</span><span class="ident" id="1698898"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1698900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1698903">if</span>&nbsp;<span class="ident" id="1698906"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1698908">.</span><span class="ident" id="1698909"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786838">releasetime</a></span>&nbsp;<span class="op" id="1698921">!=</span>&nbsp;<span class="num" id="1698924">0</span>&nbsp;<span class="op" id="1698926">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698930"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1698932">.</span><span class="ident" id="1698933"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786838">releasetime</a></span>&nbsp;<span class="op" id="1698945">=</span>&nbsp;<span class="ident" id="1698947"><a href="/gostd/runtime/stubs.go.html#1744144">cputicks</a></span><span class="op" id="1698955">(</span><span class="op" id="1698956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1698959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1698962"><a href="/gostd/runtime/proc.go.html#1673919">goready</a></span><span class="op" id="1698969">(</span><span class="ident" id="1698970"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><span class="op" id="1698972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1698975">goto</span>&nbsp;<span class="ident" id="1698980"><a href="/gostd/runtime/select.go.html#1699667">retc</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span><span class="ident" id="1698986">rclose</span><span class="op" id="1698992">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1698995">//&nbsp;read&nbsp;at&nbsp;end&nbsp;of&nbsp;closed&nbsp;channel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1699029"><a href="/gostd/runtime/select.go.html#1689994">selunlock</a></span><span class="op" id="1699038">(</span><span class="ident" id="1699039"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1699042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1699045">if</span>&nbsp;<span class="ident" id="1699048"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1699051">.</span><span class="ident" id="1699052"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796944">receivedp</a></span>&nbsp;<span class="op" id="1699062">!=</span>&nbsp;<span class="builtintype" id="1699065">nil</span>&nbsp;<span class="op" id="1699069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1699073">*</span><span class="ident" id="1699074"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1699077">.</span><span class="ident" id="1699078"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796944">receivedp</a></span>&nbsp;<span class="op" id="1699088">=</span>&nbsp;<span class="builtintype" id="1699090">false</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1699097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1699100">if</span>&nbsp;<span class="ident" id="1699103"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1699106">.</span><span class="ident" id="1699107"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span>&nbsp;<span class="op" id="1699112">!=</span>&nbsp;<span class="builtintype" id="1699115">nil</span>&nbsp;<span class="op" id="1699119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1699123"><a href="/gostd/runtime/stubs.go.html#1742585">memclr</a></span><span class="op" id="1699129">(</span><span class="ident" id="1699130"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1699133">.</span><span class="ident" id="1699134"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span><span class="op" id="1699138">,</span>&nbsp;<span class="builtintype" id="1699140">uintptr</span><span class="op" id="1699147">(</span><span class="ident" id="1699148"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1699149">.</span><span class="ident" id="1699150"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796676">elemsize</a></span><span class="op" id="1699158">)</span><span class="op" id="1699159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1699162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1699165">if</span>&nbsp;<span class="ident" id="1699168"><a href="/gostd/runtime/race0.go.html#1676514">raceenabled</a></span>&nbsp;<span class="op" id="1699180">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1699184"><a href="/gostd/runtime/race0.go.html#1677480">raceacquire</a></span><span class="op" id="1699195">(</span><span class="ident" id="1699196"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1699202">.</span><span class="ident" id="1699203">Pointer</span><span class="op" id="1699210">(</span><span class="ident" id="1699211"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1699212">)</span><span class="op" id="1699213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1699216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1699219">goto</span>&nbsp;<span class="ident" id="1699224"><a href="/gostd/runtime/select.go.html#1699667">retc</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="1699230">syncsend</span><span class="op" id="1699238">:</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1699241">//&nbsp;can&nbsp;send&nbsp;to&nbsp;sleeping&nbsp;receiver&nbsp;(sg)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1699280">if</span>&nbsp;<span class="ident" id="1699283"><a href="/gostd/runtime/race0.go.html#1676514">raceenabled</a></span>&nbsp;<span class="op" id="1699295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1699299"><a href="/gostd/runtime/race0.go.html#1676616">raceReadObjectPC</a></span><span class="op" id="1699315">(</span><span class="ident" id="1699316"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1699317">.</span><span class="ident" id="1699318"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796708">elemtype</a></span><span class="op" id="1699326">,</span>&nbsp;<span class="ident" id="1699328"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1699331">.</span><span class="ident" id="1699332"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span><span class="op" id="1699336">,</span>&nbsp;<span class="ident" id="1699338"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1699341">.</span><span class="ident" id="1699342"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796908">pc</a></span><span class="op" id="1699344">,</span>&nbsp;<span class="ident" id="1699346"><a href="/gostd/runtime/select.go.html#1686232">chansendpc</a></span><span class="op" id="1699356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1699360"><a href="/gostd/runtime/chan.go.html#1506248">racesync</a></span><span class="op" id="1699368">(</span><span class="ident" id="1699369"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1699370">,</span>&nbsp;<span class="ident" id="1699372"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1699374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1699377">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1699380"><a href="/gostd/runtime/select.go.html#1689994">selunlock</a></span><span class="op" id="1699389">(</span><span class="ident" id="1699390"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1699393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1699396">if</span>&nbsp;<span class="ident" id="1699399"><a href="/gostd/runtime/select.go.html#1686202">debugSelect</a></span>&nbsp;<span class="op" id="1699411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1699415">print</span><span class="op" id="1699420">(</span><span class="string" id="1699421">&#34;syncsend:&nbsp;sel=&#34;</span><span class="op" id="1699437">,</span>&nbsp;<span class="ident" id="1699439"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1699442">,</span>&nbsp;<span class="string" id="1699444">&#34;&nbsp;c=&#34;</span><span class="op" id="1699449">,</span>&nbsp;<span class="ident" id="1699451"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1699452">,</span>&nbsp;<span class="string" id="1699454">&#34;\n&#34;</span><span class="op" id="1699458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1699461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1699464">if</span>&nbsp;<span class="ident" id="1699467"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1699469">.</span><span class="ident" id="1699470"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786817">elem</a></span>&nbsp;<span class="op" id="1699475">!=</span>&nbsp;<span class="builtintype" id="1699478">nil</span>&nbsp;<span class="op" id="1699482">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1699486"><a href="/gostd/runtime/stubs.go.html#1742708">memmove</a></span><span class="op" id="1699493">(</span><span class="ident" id="1699494"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1699496">.</span><span class="ident" id="1699497"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786817">elem</a></span><span class="op" id="1699501">,</span>&nbsp;<span class="ident" id="1699503"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1699506">.</span><span class="ident" id="1699507"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796873">elem</a></span><span class="op" id="1699511">,</span>&nbsp;<span class="builtintype" id="1699513">uintptr</span><span class="op" id="1699520">(</span><span class="ident" id="1699521"><a href="/gostd/runtime/select.go.html#1693861">c</a></span><span class="op" id="1699522">.</span><span class="ident" id="1699523"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796676">elemsize</a></span><span class="op" id="1699531">)</span><span class="op" id="1699532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1699535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1699538"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1699540">.</span><span class="ident" id="1699541"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786817">elem</a></span>&nbsp;<span class="op" id="1699546">=</span>&nbsp;<span class="builtintype" id="1699548">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1699553"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span>&nbsp;<span class="op" id="1699556">=</span>&nbsp;<span class="ident" id="1699558"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1699560">.</span><span class="ident" id="1699561"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786765">g</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1699564"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><span class="op" id="1699566">.</span><span class="ident" id="1699567"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1787421">param</a></span>&nbsp;<span class="op" id="1699573">=</span>&nbsp;<span class="ident" id="1699575"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1699581">.</span><span class="ident" id="1699582">Pointer</span><span class="op" id="1699589">(</span><span class="ident" id="1699590"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1699592">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1699595">if</span>&nbsp;<span class="ident" id="1699598"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1699600">.</span><span class="ident" id="1699601"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786838">releasetime</a></span>&nbsp;<span class="op" id="1699613">!=</span>&nbsp;<span class="num" id="1699616">0</span>&nbsp;<span class="op" id="1699618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1699622"><a href="/gostd/runtime/select.go.html#1693845">sg</a></span><span class="op" id="1699624">.</span><span class="ident" id="1699625"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786838">releasetime</a></span>&nbsp;<span class="op" id="1699637">=</span>&nbsp;<span class="ident" id="1699639"><a href="/gostd/runtime/stubs.go.html#1744144">cputicks</a></span><span class="op" id="1699647">(</span><span class="op" id="1699648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1699651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1699654"><a href="/gostd/runtime/proc.go.html#1673919">goready</a></span><span class="op" id="1699661">(</span><span class="ident" id="1699662"><a href="/gostd/runtime/select.go.html#1693817">gp</a></span><span class="op" id="1699664">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">565</span><span class="ident" id="1699667">retc</span><span class="op" id="1699671">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1699674">if</span>&nbsp;<span class="ident" id="1699677"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1699680">.</span><span class="ident" id="1699681"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796961">releasetime</a></span>&nbsp;<span class="op" id="1699693">&gt;</span>&nbsp;<span class="num" id="1699695">0</span>&nbsp;<span class="op" id="1699697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1699701"><a href="/gostd/runtime/mprof.go.html#1626994">blockevent</a></span><span class="op" id="1699711">(</span><span class="ident" id="1699712"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1699715">.</span><span class="ident" id="1699716"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796961">releasetime</a></span><span class="op" id="1699727">-</span><span class="ident" id="1699728"><a href="/gostd/runtime/select.go.html#1691732">t0</a></span><span class="op" id="1699730">,</span>&nbsp;<span class="num" id="1699732">2</span><span class="op" id="1699733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1699736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1699739">return</span>&nbsp;<span class="ident" id="1699746"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1699749">.</span><span class="ident" id="1699750"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796908">pc</a></span><span class="op" id="1699752">,</span>&nbsp;<span class="ident" id="1699754"><a href="/gostd/runtime/select.go.html#1694002">cas</a></span><span class="op" id="1699757">.</span><span class="ident" id="1699758"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796933">so</a></span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="ident" id="1699762">sclose</span><span class="op" id="1699768">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1699771">//&nbsp;send&nbsp;on&nbsp;closed&nbsp;channel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1699798"><a href="/gostd/runtime/select.go.html#1689994">selunlock</a></span><span class="op" id="1699807">(</span><span class="ident" id="1699808"><a href="/gostd/runtime/select.go.html#1691496">sel</a></span><span class="op" id="1699811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1699814">panic</span><span class="op" id="1699819">(</span><span class="string" id="1699820">&#34;send&nbsp;on&nbsp;closed&nbsp;channel&#34;</span><span class="op" id="1699844">)</span><br>
<span class="lineno">575</span><span class="op" id="1699846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1699849">func</span>&nbsp;<span class="op" id="1699854">(</span><span class="ident" id="1699855">c</span>&nbsp;<span class="op" id="1699857">*</span><span class="ident" id="1699858"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796621">hchan</a></span><span class="op" id="1699863">)</span>&nbsp;<span class="ident" id="1699865">sortkey</span><span class="op" id="1699872">(</span><span class="op" id="1699873">)</span>&nbsp;<span class="builtintype" id="1699875">uintptr</span>&nbsp;<span class="op" id="1699883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1699886">//&nbsp;TODO(khr):&nbsp;if&nbsp;we&nbsp;have&nbsp;a&nbsp;moving&nbsp;garbage&nbsp;collector,&nbsp;we&#39;ll&nbsp;need&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1699954">//&nbsp;change&nbsp;this&nbsp;function.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1699980">return</span>&nbsp;<span class="builtintype" id="1699987">uintptr</span><span class="op" id="1699994">(</span><span class="ident" id="1699995"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1700001">.</span><span class="ident" id="1700002">Pointer</span><span class="op" id="1700009">(</span><span class="ident" id="1700010"><a href="/gostd/runtime/select.go.html#1699855">c</a></span><span class="op" id="1700011">)</span><span class="op" id="1700012">)</span><br>
<span class="lineno"></span><span class="op" id="1700014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1700017">//&nbsp;A&nbsp;runtimeSelect&nbsp;is&nbsp;a&nbsp;single&nbsp;case&nbsp;passed&nbsp;to&nbsp;rselect.</span><br>
<span class="lineno"></span><span class="comment" id="1700072">//&nbsp;This&nbsp;must&nbsp;match&nbsp;../reflect/value.go:/runtimeSelect</span><br>
<span class="lineno">585</span><span class="keyword" id="1700126">type</span>&nbsp;<span class="ident" id="1700131">runtimeSelect</span>&nbsp;<span class="keyword" id="1700145">struct</span>&nbsp;<span class="op" id="1700152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700155">dir</span>&nbsp;<span class="ident" id="1700159"><a href="/gostd/runtime/select.go.html#1700399">selectDir</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700170">typ</span>&nbsp;<span class="ident" id="1700174"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1700180">.</span><span class="ident" id="1700181">Pointer</span>&nbsp;<span class="comment" id="1700189">//&nbsp;channel&nbsp;type&nbsp;(not&nbsp;used&nbsp;here)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700222">ch</span>&nbsp;&nbsp;<span class="op" id="1700226">*</span><span class="ident" id="1700227"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796621">hchan</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1700241">//&nbsp;channel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700253">val</span>&nbsp;<span class="ident" id="1700257"><a href="/gostd/runtime/select.go.html#1686183">unsafe</a></span><span class="op" id="1700263">.</span><span class="ident" id="1700264">Pointer</span>&nbsp;<span class="comment" id="1700272">//&nbsp;ptr&nbsp;to&nbsp;data&nbsp;(SendDir)&nbsp;or&nbsp;ptr&nbsp;to&nbsp;receive&nbsp;buffer&nbsp;(RecvDir)</span><br>
<span class="lineno">590</span><span class="op" id="1700332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1700335">//&nbsp;These&nbsp;values&nbsp;must&nbsp;match&nbsp;../reflect/value.go:/SelectDir.</span><br>
<span class="lineno"></span><span class="keyword" id="1700394">type</span>&nbsp;<span class="ident" id="1700399">selectDir</span>&nbsp;<span class="builtintype" id="1700409">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="keyword" id="1700414">const</span>&nbsp;<span class="op" id="1700420">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700423">_</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700437"><a href="/gostd/runtime/select.go.html#1700399">selectDir</a></span>&nbsp;<span class="op" id="1700447">=</span>&nbsp;<span class="ident" id="1700449">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700455">selectSend</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1700479">//&nbsp;case&nbsp;Chan&nbsp;&lt;-&nbsp;Send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700501">selectRecv</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1700525">//&nbsp;case&nbsp;&lt;-Chan:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700542">selectDefault</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1700566">//&nbsp;default</span><br>
<span class="lineno">600</span><span class="op" id="1700577">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1700580">func</span>&nbsp;<span class="ident" id="1700585">reflect_rselect</span><span class="op" id="1700600">(</span><span class="ident" id="1700601">cases</span>&nbsp;<span class="op" id="1700607">[</span><span class="op" id="1700608">]</span><span class="ident" id="1700609"><a href="/gostd/runtime/select.go.html#1700131">runtimeSelect</a></span><span class="op" id="1700622">)</span>&nbsp;<span class="op" id="1700624">(</span><span class="ident" id="1700625">chosen</span>&nbsp;<span class="builtintype" id="1700632">int</span><span class="op" id="1700635">,</span>&nbsp;<span class="ident" id="1700637">recvOK</span>&nbsp;<span class="builtintype" id="1700644">bool</span><span class="op" id="1700648">)</span>&nbsp;<span class="op" id="1700650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1700653">//&nbsp;flagNoScan&nbsp;is&nbsp;safe&nbsp;here,&nbsp;because&nbsp;all&nbsp;objects&nbsp;are&nbsp;also&nbsp;referenced&nbsp;from&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700734">size</span>&nbsp;<span class="op" id="1700739">:=</span>&nbsp;<span class="ident" id="1700742"><a href="/gostd/runtime/select.go.html#1686301">selectsize</a></span><span class="op" id="1700752">(</span><span class="builtintype" id="1700753">uintptr</span><span class="op" id="1700760">(</span><span class="builtinfunc" id="1700761">len</span><span class="op" id="1700764">(</span><span class="ident" id="1700765"><a href="/gostd/runtime/select.go.html#1700601">cases</a></span><span class="op" id="1700770">)</span><span class="op" id="1700771">)</span><span class="op" id="1700772">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700775">sel</span>&nbsp;<span class="op" id="1700779">:=</span>&nbsp;<span class="op" id="1700782">(</span><span class="op" id="1700783">*</span><span class="ident" id="1700784"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796987">_select</a></span><span class="op" id="1700791">)</span><span class="op" id="1700792">(</span><span class="ident" id="1700793"><a href="/gostd/runtime/malloc.go.html#1589627">mallocgc</a></span><span class="op" id="1700801">(</span><span class="ident" id="1700802"><a href="/gostd/runtime/select.go.html#1700734">size</a></span><span class="op" id="1700806">,</span>&nbsp;<span class="builtintype" id="1700808">nil</span><span class="op" id="1700811">,</span>&nbsp;<span class="ident" id="1700813"><a href="/gostd/runtime/malloc.go.html#1588855">flagNoScan</a></span><span class="op" id="1700823">)</span><span class="op" id="1700824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700827"><a href="/gostd/runtime/select.go.html#1686554">newselect</a></span><span class="op" id="1700836">(</span><span class="ident" id="1700837"><a href="/gostd/runtime/select.go.html#1700775">sel</a></span><span class="op" id="1700840">,</span>&nbsp;<span class="builtintype" id="1700842">int64</span><span class="op" id="1700847">(</span><span class="ident" id="1700848"><a href="/gostd/runtime/select.go.html#1700734">size</a></span><span class="op" id="1700852">)</span><span class="op" id="1700853">,</span>&nbsp;<span class="builtintype" id="1700855">int32</span><span class="op" id="1700860">(</span><span class="builtinfunc" id="1700861">len</span><span class="op" id="1700864">(</span><span class="ident" id="1700865"><a href="/gostd/runtime/select.go.html#1700601">cases</a></span><span class="op" id="1700870">)</span><span class="op" id="1700871">)</span><span class="op" id="1700872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700875">r</span>&nbsp;<span class="op" id="1700877">:=</span>&nbsp;<span class="builtinfunc" id="1700880">new</span><span class="op" id="1700883">(</span><span class="builtintype" id="1700884">bool</span><span class="op" id="1700888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1700891">for</span>&nbsp;<span class="ident" id="1700895">i</span>&nbsp;<span class="op" id="1700897">:=</span>&nbsp;<span class="keyword" id="1700900">range</span>&nbsp;<span class="ident" id="1700906"><a href="/gostd/runtime/select.go.html#1700601">cases</a></span>&nbsp;<span class="op" id="1700912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700916">rc</span>&nbsp;<span class="op" id="1700919">:=</span>&nbsp;<span class="op" id="1700922">&amp;</span><span class="ident" id="1700923"><a href="/gostd/runtime/select.go.html#1700601">cases</a></span><span class="op" id="1700928">[</span><span class="ident" id="1700929"><a href="/gostd/runtime/select.go.html#1700895">i</a></span><span class="op" id="1700930">]</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1700934">switch</span>&nbsp;<span class="ident" id="1700941"><a href="/gostd/runtime/select.go.html#1700916">rc</a></span><span class="op" id="1700943">.</span><span class="ident" id="1700944"><a href="/gostd/runtime/select.go.html#1700155">dir</a></span>&nbsp;<span class="op" id="1700948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1700952">case</span>&nbsp;<span class="ident" id="1700957"><a href="/gostd/runtime/select.go.html#1700542">selectDefault</a></span><span class="op" id="1700970">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1700975"><a href="/gostd/runtime/select.go.html#1689266">selectdefaultImpl</a></span><span class="op" id="1700992">(</span><span class="ident" id="1700993"><a href="/gostd/runtime/select.go.html#1700775">sel</a></span><span class="op" id="1700996">,</span>&nbsp;<span class="builtintype" id="1700998">uintptr</span><span class="op" id="1701005">(</span><span class="ident" id="1701006"><a href="/gostd/runtime/select.go.html#1700895">i</a></span><span class="op" id="1701007">)</span><span class="op" id="1701008">,</span>&nbsp;<span class="num" id="1701010">0</span><span class="op" id="1701011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1701015">case</span>&nbsp;<span class="ident" id="1701020"><a href="/gostd/runtime/select.go.html#1700455">selectSend</a></span><span class="op" id="1701030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1701035">if</span>&nbsp;<span class="ident" id="1701038"><a href="/gostd/runtime/select.go.html#1700916">rc</a></span><span class="op" id="1701040">.</span><span class="ident" id="1701041"><a href="/gostd/runtime/select.go.html#1700222">ch</a></span>&nbsp;<span class="op" id="1701044">==</span>&nbsp;<span class="builtintype" id="1701047">nil</span>&nbsp;<span class="op" id="1701051">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1701057">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1701066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1701071"><a href="/gostd/runtime/select.go.html#1687453">selectsendImpl</a></span><span class="op" id="1701085">(</span><span class="ident" id="1701086"><a href="/gostd/runtime/select.go.html#1700775">sel</a></span><span class="op" id="1701089">,</span>&nbsp;<span class="ident" id="1701091"><a href="/gostd/runtime/select.go.html#1700916">rc</a></span><span class="op" id="1701093">.</span><span class="ident" id="1701094"><a href="/gostd/runtime/select.go.html#1700222">ch</a></span><span class="op" id="1701096">,</span>&nbsp;<span class="builtintype" id="1701098">uintptr</span><span class="op" id="1701105">(</span><span class="ident" id="1701106"><a href="/gostd/runtime/select.go.html#1700895">i</a></span><span class="op" id="1701107">)</span><span class="op" id="1701108">,</span>&nbsp;<span class="ident" id="1701110"><a href="/gostd/runtime/select.go.html#1700916">rc</a></span><span class="op" id="1701112">.</span><span class="ident" id="1701113"><a href="/gostd/runtime/select.go.html#1700253">val</a></span><span class="op" id="1701116">,</span>&nbsp;<span class="num" id="1701118">0</span><span class="op" id="1701119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1701123">case</span>&nbsp;<span class="ident" id="1701128"><a href="/gostd/runtime/select.go.html#1700501">selectRecv</a></span><span class="op" id="1701138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1701143">if</span>&nbsp;<span class="ident" id="1701146"><a href="/gostd/runtime/select.go.html#1700916">rc</a></span><span class="op" id="1701148">.</span><span class="ident" id="1701149"><a href="/gostd/runtime/select.go.html#1700222">ch</a></span>&nbsp;<span class="op" id="1701152">==</span>&nbsp;<span class="builtintype" id="1701155">nil</span>&nbsp;<span class="op" id="1701159">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1701165">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1701174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1701179"><a href="/gostd/runtime/select.go.html#1688537">selectrecvImpl</a></span><span class="op" id="1701193">(</span><span class="ident" id="1701194"><a href="/gostd/runtime/select.go.html#1700775">sel</a></span><span class="op" id="1701197">,</span>&nbsp;<span class="ident" id="1701199"><a href="/gostd/runtime/select.go.html#1700916">rc</a></span><span class="op" id="1701201">.</span><span class="ident" id="1701202"><a href="/gostd/runtime/select.go.html#1700222">ch</a></span><span class="op" id="1701204">,</span>&nbsp;<span class="builtintype" id="1701206">uintptr</span><span class="op" id="1701213">(</span><span class="ident" id="1701214"><a href="/gostd/runtime/select.go.html#1700895">i</a></span><span class="op" id="1701215">)</span><span class="op" id="1701216">,</span>&nbsp;<span class="ident" id="1701218"><a href="/gostd/runtime/select.go.html#1700916">rc</a></span><span class="op" id="1701220">.</span><span class="ident" id="1701221"><a href="/gostd/runtime/select.go.html#1700253">val</a></span><span class="op" id="1701224">,</span>&nbsp;<span class="ident" id="1701226"><a href="/gostd/runtime/select.go.html#1700875">r</a></span><span class="op" id="1701227">,</span>&nbsp;<span class="num" id="1701229">0</span><span class="op" id="1701230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1701234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1701237">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1701241">pc</span><span class="op" id="1701243">,</span>&nbsp;<span class="ident" id="1701245">_</span>&nbsp;<span class="op" id="1701247">:=</span>&nbsp;<span class="ident" id="1701250"><a href="/gostd/runtime/select.go.html#1691483">selectgoImpl</a></span><span class="op" id="1701262">(</span><span class="ident" id="1701263"><a href="/gostd/runtime/select.go.html#1700775">sel</a></span><span class="op" id="1701266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1701269"><a href="/gostd/runtime/select.go.html#1700625">chosen</a></span>&nbsp;<span class="op" id="1701276">=</span>&nbsp;<span class="builtintype" id="1701278">int</span><span class="op" id="1701281">(</span><span class="ident" id="1701282"><a href="/gostd/runtime/select.go.html#1701241">pc</a></span><span class="op" id="1701284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1701287"><a href="/gostd/runtime/select.go.html#1700637">recvOK</a></span>&nbsp;<span class="op" id="1701294">=</span>&nbsp;<span class="op" id="1701296">*</span><span class="ident" id="1701297"><a href="/gostd/runtime/select.go.html#1700875">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1701300">return</span><br>
<span class="lineno">630</span><span class="op" id="1701307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1701310">func</span>&nbsp;<span class="op" id="1701315">(</span><span class="ident" id="1701316">q</span>&nbsp;<span class="op" id="1701318">*</span><span class="ident" id="1701319"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796571">waitq</a></span><span class="op" id="1701324">)</span>&nbsp;<span class="ident" id="1701326">dequeueSudoG</span><span class="op" id="1701338">(</span><span class="ident" id="1701339">s</span>&nbsp;<span class="op" id="1701341">*</span><span class="ident" id="1701342"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786749">sudog</a></span><span class="op" id="1701347">)</span>&nbsp;<span class="op" id="1701349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1701352">var</span>&nbsp;<span class="ident" id="1701356">prevsgp</span>&nbsp;<span class="op" id="1701364">*</span><span class="ident" id="1701365"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786749">sudog</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1701372">l</span>&nbsp;<span class="op" id="1701374">:=</span>&nbsp;<span class="op" id="1701377">&amp;</span><span class="ident" id="1701378"><a href="/gostd/runtime/select.go.html#1701316">q</a></span><span class="op" id="1701379">.</span><span class="ident" id="1701380"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796587">first</a></span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1701387">for</span>&nbsp;<span class="op" id="1701391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1701395">sgp</span>&nbsp;<span class="op" id="1701399">:=</span>&nbsp;<span class="op" id="1701402">*</span><span class="ident" id="1701403"><a href="/gostd/runtime/select.go.html#1701372">l</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1701407">if</span>&nbsp;<span class="ident" id="1701410"><a href="/gostd/runtime/select.go.html#1701395">sgp</a></span>&nbsp;<span class="op" id="1701414">==</span>&nbsp;<span class="builtintype" id="1701417">nil</span>&nbsp;<span class="op" id="1701421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1701426">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1701435">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1701439">if</span>&nbsp;<span class="ident" id="1701442"><a href="/gostd/runtime/select.go.html#1701395">sgp</a></span>&nbsp;<span class="op" id="1701446">==</span>&nbsp;<span class="ident" id="1701449"><a href="/gostd/runtime/select.go.html#1701339">s</a></span>&nbsp;<span class="op" id="1701451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1701456">*</span><span class="ident" id="1701457"><a href="/gostd/runtime/select.go.html#1701372">l</a></span>&nbsp;<span class="op" id="1701459">=</span>&nbsp;<span class="ident" id="1701461"><a href="/gostd/runtime/select.go.html#1701395">sgp</a></span><span class="op" id="1701464">.</span><span class="ident" id="1701465"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786791">next</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1701473">if</span>&nbsp;<span class="ident" id="1701476"><a href="/gostd/runtime/select.go.html#1701316">q</a></span><span class="op" id="1701477">.</span><span class="ident" id="1701478"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796601">last</a></span>&nbsp;<span class="op" id="1701483">==</span>&nbsp;<span class="ident" id="1701486"><a href="/gostd/runtime/select.go.html#1701395">sgp</a></span>&nbsp;<span class="op" id="1701490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1701496"><a href="/gostd/runtime/select.go.html#1701316">q</a></span><span class="op" id="1701497">.</span><span class="ident" id="1701498"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1796601">last</a></span>&nbsp;<span class="op" id="1701503">=</span>&nbsp;<span class="ident" id="1701505"><a href="/gostd/runtime/select.go.html#1701356">prevsgp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1701516">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1701521"><a href="/gostd/runtime/select.go.html#1701339">s</a></span><span class="op" id="1701522">.</span><span class="ident" id="1701523"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786791">next</a></span>&nbsp;<span class="op" id="1701528">=</span>&nbsp;<span class="builtintype" id="1701530">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1701537">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1701546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1701550"><a href="/gostd/runtime/select.go.html#1701372">l</a></span>&nbsp;<span class="op" id="1701552">=</span>&nbsp;<span class="op" id="1701554">&amp;</span><span class="ident" id="1701555"><a href="/gostd/runtime/select.go.html#1701395">sgp</a></span><span class="op" id="1701558">.</span><span class="ident" id="1701559"><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html#1786791">next</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1701566"><a href="/gostd/runtime/select.go.html#1701356">prevsgp</a></span>&nbsp;<span class="op" id="1701574">=</span>&nbsp;<span class="ident" id="1701576"><a href="/gostd/runtime/select.go.html#1701395">sgp</a></span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1701581">}</span><br>
<span class="lineno"></span><span class="op" id="1701583">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
