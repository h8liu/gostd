<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4453040">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4453095">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4453149">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4453200">package</span>&nbsp;<span class="ident" id="4453208">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4453218">import</span>&nbsp;<span class="op" id="4453225">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4453228">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4453235">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4453241">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4453254">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4453271">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4453279">&#34;text/template&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4453296">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="4453318">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4453321">//&nbsp;Template&nbsp;is&nbsp;a&nbsp;specialized&nbsp;Template&nbsp;from&nbsp;&#34;text/template&#34;&nbsp;that&nbsp;produces&nbsp;a&nbsp;safe</span><br>
<span class="lineno"></span><span class="comment" id="4453401">//&nbsp;HTML&nbsp;document&nbsp;fragment.</span><br>
<span class="lineno"></span><span class="keyword" id="4453428">type</span>&nbsp;<span class="ident" id="4453433">Template</span>&nbsp;<span class="keyword" id="4453442">struct</span>&nbsp;<span class="op" id="4453449">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453452">//&nbsp;Sticky&nbsp;error&nbsp;if&nbsp;escaping&nbsp;fails.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453488">escapeErr</span>&nbsp;<span class="builtintype" id="4453498">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453505">//&nbsp;We&nbsp;could&nbsp;embed&nbsp;the&nbsp;text/template&nbsp;field,&nbsp;but&nbsp;it&#39;s&nbsp;safer&nbsp;not&nbsp;to&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453579">//&nbsp;we&nbsp;need&nbsp;to&nbsp;keep&nbsp;our&nbsp;version&nbsp;of&nbsp;the&nbsp;name&nbsp;space&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453648">//&nbsp;template&#39;s&nbsp;in&nbsp;sync.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453672">text</span>&nbsp;<span class="op" id="4453677">*</span><span class="ident" id="4453678">template</span><span class="op" id="4453686">.</span><span class="ident" id="4453687">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4453697">//&nbsp;The&nbsp;underlying&nbsp;template&#39;s&nbsp;parse&nbsp;tree,&nbsp;updated&nbsp;to&nbsp;be&nbsp;HTML-safe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4453764">Tree</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4453775">*</span><span class="ident" id="4453776">parse</span><span class="op" id="4453781">.</span><span class="ident" id="4453782">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4453788">*</span><span class="ident" id="4453789">nameSpace</span>&nbsp;<span class="comment" id="4453799">//&nbsp;common&nbsp;to&nbsp;all&nbsp;associated&nbsp;templates</span><br>
<span class="lineno"></span><span class="op" id="4453837">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4453840">//&nbsp;escapeOK&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value&nbsp;used&nbsp;to&nbsp;indicate&nbsp;valid&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="keyword" id="4453905">var</span>&nbsp;<span class="ident" id="4453909">escapeOK</span>&nbsp;<span class="op" id="4453918">=</span>&nbsp;<span class="ident" id="4453920">fmt</span><span class="op" id="4453923">.</span><span class="ident" id="4453924">Errorf</span><span class="op" id="4453930">(</span><span class="string" id="4453931">&#34;template&nbsp;escaped&nbsp;correctly&#34;</span><span class="op" id="4453959">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4453962">//&nbsp;nameSpace&nbsp;is&nbsp;the&nbsp;data&nbsp;structure&nbsp;shared&nbsp;by&nbsp;all&nbsp;templates&nbsp;in&nbsp;an&nbsp;association.</span><br>
<span class="lineno">35</span><span class="keyword" id="4454040">type</span>&nbsp;<span class="ident" id="4454045">nameSpace</span>&nbsp;<span class="keyword" id="4454055">struct</span>&nbsp;<span class="op" id="4454062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454065">mu</span>&nbsp;&nbsp;<span class="ident" id="4454069">sync</span><span class="op" id="4454073">.</span><span class="ident" id="4454074">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454081">set</span>&nbsp;<span class="keyword" id="4454085">map</span><span class="op" id="4454088">[</span><span class="builtintype" id="4454089">string</span><span class="op" id="4454095">]</span><span class="op" id="4454096">*</span><span class="ident" id="4454097">Template</span><br>
<span class="lineno"></span><span class="op" id="4454106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4454109">//&nbsp;Templates&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;templates&nbsp;associated&nbsp;with&nbsp;t,&nbsp;including&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="4454186">//&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="4454197">func</span>&nbsp;<span class="op" id="4454202">(</span><span class="ident" id="4454203">t</span>&nbsp;<span class="op" id="4454205">*</span><span class="ident" id="4454206">Template</span><span class="op" id="4454214">)</span>&nbsp;<span class="ident" id="4454216">Templates</span><span class="op" id="4454225">(</span><span class="op" id="4454226">)</span>&nbsp;<span class="op" id="4454228">[</span><span class="op" id="4454229">]</span><span class="op" id="4454230">*</span><span class="ident" id="4454231">Template</span>&nbsp;<span class="op" id="4454240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454243">ns</span>&nbsp;<span class="op" id="4454246">:=</span>&nbsp;<span class="ident" id="4454249">t</span><span class="op" id="4454250">.</span><span class="ident" id="4454251">nameSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454262">ns</span><span class="op" id="4454264">.</span><span class="ident" id="4454265">mu</span><span class="op" id="4454267">.</span><span class="ident" id="4454268">Lock</span><span class="op" id="4454272">(</span><span class="op" id="4454273">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454276">defer</span>&nbsp;<span class="ident" id="4454282">ns</span><span class="op" id="4454284">.</span><span class="ident" id="4454285">mu</span><span class="op" id="4454287">.</span><span class="ident" id="4454288">Unlock</span><span class="op" id="4454294">(</span><span class="op" id="4454295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4454298">//&nbsp;Return&nbsp;a&nbsp;slice&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454345">m</span>&nbsp;<span class="op" id="4454347">:=</span>&nbsp;<span class="builtinfunc" id="4454350">make</span><span class="op" id="4454354">(</span><span class="op" id="4454355">[</span><span class="op" id="4454356">]</span><span class="op" id="4454357">*</span><span class="ident" id="4454358">Template</span><span class="op" id="4454366">,</span>&nbsp;<span class="num" id="4454368">0</span><span class="op" id="4454369">,</span>&nbsp;<span class="builtinfunc" id="4454371">len</span><span class="op" id="4454374">(</span><span class="ident" id="4454375">ns</span><span class="op" id="4454377">.</span><span class="ident" id="4454378">set</span><span class="op" id="4454381">)</span><span class="op" id="4454382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454385">for</span>&nbsp;<span class="ident" id="4454389">_</span><span class="op" id="4454390">,</span>&nbsp;<span class="ident" id="4454392">v</span>&nbsp;<span class="op" id="4454394">:=</span>&nbsp;<span class="keyword" id="4454397">range</span>&nbsp;<span class="ident" id="4454403">ns</span><span class="op" id="4454405">.</span><span class="ident" id="4454406">set</span>&nbsp;<span class="op" id="4454410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454414">m</span>&nbsp;<span class="op" id="4454416">=</span>&nbsp;<span class="builtinfunc" id="4454418">append</span><span class="op" id="4454424">(</span><span class="ident" id="4454425">m</span><span class="op" id="4454426">,</span>&nbsp;<span class="ident" id="4454428">v</span><span class="op" id="4454429">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4454432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454435">return</span>&nbsp;<span class="ident" id="4454442">m</span><br>
<span class="lineno"></span><span class="op" id="4454444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4454447">//&nbsp;escape&nbsp;escapes&nbsp;all&nbsp;associated&nbsp;templates.</span><br>
<span class="lineno">55</span><span class="keyword" id="4454491">func</span>&nbsp;<span class="op" id="4454496">(</span><span class="ident" id="4454497">t</span>&nbsp;<span class="op" id="4454499">*</span><span class="ident" id="4454500">Template</span><span class="op" id="4454508">)</span>&nbsp;<span class="ident" id="4454510">escape</span><span class="op" id="4454516">(</span><span class="op" id="4454517">)</span>&nbsp;<span class="builtintype" id="4454519">error</span>&nbsp;<span class="op" id="4454525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4454528">t</span><span class="op" id="4454529">.</span><span class="ident" id="4454530">nameSpace</span><span class="op" id="4454539">.</span><span class="ident" id="4454540">mu</span><span class="op" id="4454542">.</span><span class="ident" id="4454543">Lock</span><span class="op" id="4454547">(</span><span class="op" id="4454548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454551">defer</span>&nbsp;<span class="ident" id="4454557">t</span><span class="op" id="4454558">.</span><span class="ident" id="4454559">nameSpace</span><span class="op" id="4454568">.</span><span class="ident" id="4454569">mu</span><span class="op" id="4454571">.</span><span class="ident" id="4454572">Unlock</span><span class="op" id="4454578">(</span><span class="op" id="4454579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454582">if</span>&nbsp;<span class="ident" id="4454585">t</span><span class="op" id="4454586">.</span><span class="ident" id="4454587">escapeErr</span>&nbsp;<span class="op" id="4454597">==</span>&nbsp;<span class="ident" id="4454600">nil</span>&nbsp;<span class="op" id="4454604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454608">if</span>&nbsp;<span class="ident" id="4454611">err</span>&nbsp;<span class="op" id="4454615">:=</span>&nbsp;<span class="ident" id="4454618">escapeTemplate</span><span class="op" id="4454632">(</span><span class="ident" id="4454633">t</span><span class="op" id="4454634">,</span>&nbsp;<span class="ident" id="4454636">t</span><span class="op" id="4454637">.</span><span class="ident" id="4454638">text</span><span class="op" id="4454642">.</span><span class="ident" id="4454643">Root</span><span class="op" id="4454647">,</span>&nbsp;<span class="ident" id="4454649">t</span><span class="op" id="4454650">.</span><span class="ident" id="4454651">Name</span><span class="op" id="4454655">(</span><span class="op" id="4454656">)</span><span class="op" id="4454657">)</span><span class="op" id="4454658">;</span>&nbsp;<span class="ident" id="4454660">err</span>&nbsp;<span class="op" id="4454664">!=</span>&nbsp;<span class="ident" id="4454667">nil</span>&nbsp;<span class="op" id="4454671">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454676">return</span>&nbsp;<span class="ident" id="4454683">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4454689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4454692">}</span>&nbsp;<span class="keyword" id="4454694">else</span>&nbsp;<span class="keyword" id="4454699">if</span>&nbsp;<span class="ident" id="4454702">t</span><span class="op" id="4454703">.</span><span class="ident" id="4454704">escapeErr</span>&nbsp;<span class="op" id="4454714">!=</span>&nbsp;<span class="ident" id="4454717">escapeOK</span>&nbsp;<span class="op" id="4454726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454730">return</span>&nbsp;<span class="ident" id="4454737">t</span><span class="op" id="4454738">.</span><span class="ident" id="4454739">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4454750">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4454753">return</span>&nbsp;<span class="ident" id="4454760">nil</span><br>
<span class="lineno"></span><span class="op" id="4454764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4454767">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="4454834">//&nbsp;writing&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">70</span><span class="comment" id="4454863">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="4454931">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4455004">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4455026">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="4455076">func</span>&nbsp;<span class="op" id="4455081">(</span><span class="ident" id="4455082">t</span>&nbsp;<span class="op" id="4455084">*</span><span class="ident" id="4455085">Template</span><span class="op" id="4455093">)</span>&nbsp;<span class="ident" id="4455095">Execute</span><span class="op" id="4455102">(</span><span class="ident" id="4455103">wr</span>&nbsp;<span class="ident" id="4455106">io</span><span class="op" id="4455108">.</span><span class="ident" id="4455109">Writer</span><span class="op" id="4455115">,</span>&nbsp;<span class="ident" id="4455117">data</span>&nbsp;<span class="keyword" id="4455122">interface</span><span class="op" id="4455131">{</span><span class="op" id="4455132">}</span><span class="op" id="4455133">)</span>&nbsp;<span class="builtintype" id="4455135">error</span>&nbsp;<span class="op" id="4455141">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455144">if</span>&nbsp;<span class="ident" id="4455147">err</span>&nbsp;<span class="op" id="4455151">:=</span>&nbsp;<span class="ident" id="4455154">t</span><span class="op" id="4455155">.</span><span class="ident" id="4455156">escape</span><span class="op" id="4455162">(</span><span class="op" id="4455163">)</span><span class="op" id="4455164">;</span>&nbsp;<span class="ident" id="4455166">err</span>&nbsp;<span class="op" id="4455170">!=</span>&nbsp;<span class="ident" id="4455173">nil</span>&nbsp;<span class="op" id="4455177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455181">return</span>&nbsp;<span class="ident" id="4455188">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4455193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455196">return</span>&nbsp;<span class="ident" id="4455203">t</span><span class="op" id="4455204">.</span><span class="ident" id="4455205">text</span><span class="op" id="4455209">.</span><span class="ident" id="4455210">Execute</span><span class="op" id="4455217">(</span><span class="ident" id="4455218">wr</span><span class="op" id="4455220">,</span>&nbsp;<span class="ident" id="4455222">data</span><span class="op" id="4455226">)</span><br>
<span class="lineno"></span><span class="op" id="4455228">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4455231">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4455308">//&nbsp;name&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="4455374">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="4455442">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno">85</span><span class="comment" id="4455515">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4455537">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="4455587">func</span>&nbsp;<span class="op" id="4455592">(</span><span class="ident" id="4455593">t</span>&nbsp;<span class="op" id="4455595">*</span><span class="ident" id="4455596">Template</span><span class="op" id="4455604">)</span>&nbsp;<span class="ident" id="4455606">ExecuteTemplate</span><span class="op" id="4455621">(</span><span class="ident" id="4455622">wr</span>&nbsp;<span class="ident" id="4455625">io</span><span class="op" id="4455627">.</span><span class="ident" id="4455628">Writer</span><span class="op" id="4455634">,</span>&nbsp;<span class="ident" id="4455636">name</span>&nbsp;<span class="builtintype" id="4455641">string</span><span class="op" id="4455647">,</span>&nbsp;<span class="ident" id="4455649">data</span>&nbsp;<span class="keyword" id="4455654">interface</span><span class="op" id="4455663">{</span><span class="op" id="4455664">}</span><span class="op" id="4455665">)</span>&nbsp;<span class="builtintype" id="4455667">error</span>&nbsp;<span class="op" id="4455673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4455676">tmpl</span><span class="op" id="4455680">,</span>&nbsp;<span class="ident" id="4455682">err</span>&nbsp;<span class="op" id="4455686">:=</span>&nbsp;<span class="ident" id="4455689">t</span><span class="op" id="4455690">.</span><span class="ident" id="4455691">lookupAndEscapeTemplate</span><span class="op" id="4455714">(</span><span class="ident" id="4455715">name</span><span class="op" id="4455719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455722">if</span>&nbsp;<span class="ident" id="4455725">err</span>&nbsp;<span class="op" id="4455729">!=</span>&nbsp;<span class="ident" id="4455732">nil</span>&nbsp;<span class="op" id="4455736">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455740">return</span>&nbsp;<span class="ident" id="4455747">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4455752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4455755">return</span>&nbsp;<span class="ident" id="4455762">tmpl</span><span class="op" id="4455766">.</span><span class="ident" id="4455767">text</span><span class="op" id="4455771">.</span><span class="ident" id="4455772">Execute</span><span class="op" id="4455779">(</span><span class="ident" id="4455780">wr</span><span class="op" id="4455782">,</span>&nbsp;<span class="ident" id="4455784">data</span><span class="op" id="4455788">)</span><br>
<span class="lineno"></span><span class="op" id="4455790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="4455793">//&nbsp;lookupAndEscapeTemplate&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="4455869">//&nbsp;is&nbsp;escaped,&nbsp;or&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be.&nbsp;It&nbsp;returns&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="4455942">//&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4455955">func</span>&nbsp;<span class="op" id="4455960">(</span><span class="ident" id="4455961">t</span>&nbsp;<span class="op" id="4455963">*</span><span class="ident" id="4455964">Template</span><span class="op" id="4455972">)</span>&nbsp;<span class="ident" id="4455974">lookupAndEscapeTemplate</span><span class="op" id="4455997">(</span><span class="ident" id="4455998">name</span>&nbsp;<span class="builtintype" id="4456003">string</span><span class="op" id="4456009">)</span>&nbsp;<span class="op" id="4456011">(</span><span class="ident" id="4456012">tmpl</span>&nbsp;<span class="op" id="4456017">*</span><span class="ident" id="4456018">Template</span><span class="op" id="4456026">,</span>&nbsp;<span class="ident" id="4456028">err</span>&nbsp;<span class="builtintype" id="4456032">error</span><span class="op" id="4456037">)</span>&nbsp;<span class="op" id="4456039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456042">t</span><span class="op" id="4456043">.</span><span class="ident" id="4456044">nameSpace</span><span class="op" id="4456053">.</span><span class="ident" id="4456054">mu</span><span class="op" id="4456056">.</span><span class="ident" id="4456057">Lock</span><span class="op" id="4456061">(</span><span class="op" id="4456062">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456065">defer</span>&nbsp;<span class="ident" id="4456071">t</span><span class="op" id="4456072">.</span><span class="ident" id="4456073">nameSpace</span><span class="op" id="4456082">.</span><span class="ident" id="4456083">mu</span><span class="op" id="4456085">.</span><span class="ident" id="4456086">Unlock</span><span class="op" id="4456092">(</span><span class="op" id="4456093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456096">tmpl</span>&nbsp;<span class="op" id="4456101">=</span>&nbsp;<span class="ident" id="4456103">t</span><span class="op" id="4456104">.</span><span class="ident" id="4456105">set</span><span class="op" id="4456108">[</span><span class="ident" id="4456109">name</span><span class="op" id="4456113">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456116">if</span>&nbsp;<span class="ident" id="4456119">tmpl</span>&nbsp;<span class="op" id="4456124">==</span>&nbsp;<span class="ident" id="4456127">nil</span>&nbsp;<span class="op" id="4456131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456135">return</span>&nbsp;<span class="ident" id="4456142">nil</span><span class="op" id="4456145">,</span>&nbsp;<span class="ident" id="4456147">fmt</span><span class="op" id="4456150">.</span><span class="ident" id="4456151">Errorf</span><span class="op" id="4456157">(</span><span class="string" id="4456158">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;undefined&#34;</span><span class="op" id="4456190">,</span>&nbsp;<span class="ident" id="4456192">name</span><span class="op" id="4456196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456199">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456202">if</span>&nbsp;<span class="ident" id="4456205">tmpl</span><span class="op" id="4456209">.</span><span class="ident" id="4456210">escapeErr</span>&nbsp;<span class="op" id="4456220">!=</span>&nbsp;<span class="ident" id="4456223">nil</span>&nbsp;<span class="op" id="4456227">&amp;&amp;</span>&nbsp;<span class="ident" id="4456230">tmpl</span><span class="op" id="4456234">.</span><span class="ident" id="4456235">escapeErr</span>&nbsp;<span class="op" id="4456245">!=</span>&nbsp;<span class="ident" id="4456248">escapeOK</span>&nbsp;<span class="op" id="4456257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456261">return</span>&nbsp;<span class="ident" id="4456268">nil</span><span class="op" id="4456271">,</span>&nbsp;<span class="ident" id="4456273">tmpl</span><span class="op" id="4456277">.</span><span class="ident" id="4456278">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456292">if</span>&nbsp;<span class="ident" id="4456295">tmpl</span><span class="op" id="4456299">.</span><span class="ident" id="4456300">text</span><span class="op" id="4456304">.</span><span class="ident" id="4456305">Tree</span>&nbsp;<span class="op" id="4456310">==</span>&nbsp;<span class="ident" id="4456313">nil</span>&nbsp;<span class="op" id="4456317">||</span>&nbsp;<span class="ident" id="4456320">tmpl</span><span class="op" id="4456324">.</span><span class="ident" id="4456325">text</span><span class="op" id="4456329">.</span><span class="ident" id="4456330">Root</span>&nbsp;<span class="op" id="4456335">==</span>&nbsp;<span class="ident" id="4456338">nil</span>&nbsp;<span class="op" id="4456342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456346">return</span>&nbsp;<span class="ident" id="4456353">nil</span><span class="op" id="4456356">,</span>&nbsp;<span class="ident" id="4456358">fmt</span><span class="op" id="4456361">.</span><span class="ident" id="4456362">Errorf</span><span class="op" id="4456368">(</span><span class="string" id="4456369">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;template&#34;</span><span class="op" id="4456414">,</span>&nbsp;<span class="ident" id="4456416">name</span><span class="op" id="4456420">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456426">if</span>&nbsp;<span class="ident" id="4456429">t</span><span class="op" id="4456430">.</span><span class="ident" id="4456431">text</span><span class="op" id="4456435">.</span><span class="ident" id="4456436">Lookup</span><span class="op" id="4456442">(</span><span class="ident" id="4456443">name</span><span class="op" id="4456447">)</span>&nbsp;<span class="op" id="4456449">==</span>&nbsp;<span class="ident" id="4456452">nil</span>&nbsp;<span class="op" id="4456456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4456460">panic</span><span class="op" id="4456465">(</span><span class="string" id="4456466">&#34;html/template&nbsp;internal&nbsp;error:&nbsp;template&nbsp;escaping&nbsp;out&nbsp;of&nbsp;sync&#34;</span><span class="op" id="4456527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456533">if</span>&nbsp;<span class="ident" id="4456536">tmpl</span><span class="op" id="4456540">.</span><span class="ident" id="4456541">escapeErr</span>&nbsp;<span class="op" id="4456551">==</span>&nbsp;<span class="ident" id="4456554">nil</span>&nbsp;<span class="op" id="4456558">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4456562">err</span>&nbsp;<span class="op" id="4456566">=</span>&nbsp;<span class="ident" id="4456568">escapeTemplate</span><span class="op" id="4456582">(</span><span class="ident" id="4456583">tmpl</span><span class="op" id="4456587">,</span>&nbsp;<span class="ident" id="4456589">tmpl</span><span class="op" id="4456593">.</span><span class="ident" id="4456594">text</span><span class="op" id="4456598">.</span><span class="ident" id="4456599">Root</span><span class="op" id="4456603">,</span>&nbsp;<span class="ident" id="4456605">name</span><span class="op" id="4456609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4456612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4456615">return</span>&nbsp;<span class="ident" id="4456622">tmpl</span><span class="op" id="4456626">,</span>&nbsp;<span class="ident" id="4456628">err</span><br>
<span class="lineno"></span><span class="op" id="4456632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="4456635">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;string&nbsp;into&nbsp;a&nbsp;template.&nbsp;Nested&nbsp;template&nbsp;definitions</span><br>
<span class="lineno"></span><span class="comment" id="4456705">//&nbsp;will&nbsp;be&nbsp;associated&nbsp;with&nbsp;the&nbsp;top-level&nbsp;template&nbsp;t.&nbsp;Parse&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4456771">//&nbsp;called&nbsp;multiple&nbsp;times&nbsp;to&nbsp;parse&nbsp;definitions&nbsp;of&nbsp;templates&nbsp;to&nbsp;associate</span><br>
<span class="lineno"></span><span class="comment" id="4456843">//&nbsp;with&nbsp;t.&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;if&nbsp;a&nbsp;resulting&nbsp;template&nbsp;is&nbsp;non-empty&nbsp;(contains</span><br>
<span class="lineno"></span><span class="comment" id="4456916">//&nbsp;content&nbsp;other&nbsp;than&nbsp;template&nbsp;definitions)&nbsp;and&nbsp;would&nbsp;replace&nbsp;a</span><br>
<span class="lineno">125</span><span class="comment" id="4456980">//&nbsp;non-empty&nbsp;template&nbsp;with&nbsp;the&nbsp;same&nbsp;name.&nbsp;&nbsp;(In&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;Parse</span><br>
<span class="lineno"></span><span class="comment" id="4457051">//&nbsp;with&nbsp;the&nbsp;same&nbsp;receiver&nbsp;template,&nbsp;only&nbsp;one&nbsp;call&nbsp;can&nbsp;contain&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="4457118">//&nbsp;other&nbsp;than&nbsp;space,&nbsp;comments,&nbsp;and&nbsp;template&nbsp;definitions.)</span><br>
<span class="lineno"></span><span class="keyword" id="4457176">func</span>&nbsp;<span class="op" id="4457181">(</span><span class="ident" id="4457182">t</span>&nbsp;<span class="op" id="4457184">*</span><span class="ident" id="4457185">Template</span><span class="op" id="4457193">)</span>&nbsp;<span class="ident" id="4457195">Parse</span><span class="op" id="4457200">(</span><span class="ident" id="4457201">src</span>&nbsp;<span class="builtintype" id="4457205">string</span><span class="op" id="4457211">)</span>&nbsp;<span class="op" id="4457213">(</span><span class="op" id="4457214">*</span><span class="ident" id="4457215">Template</span><span class="op" id="4457223">,</span>&nbsp;<span class="builtintype" id="4457225">error</span><span class="op" id="4457230">)</span>&nbsp;<span class="op" id="4457232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457235">t</span><span class="op" id="4457236">.</span><span class="ident" id="4457237">nameSpace</span><span class="op" id="4457246">.</span><span class="ident" id="4457247">mu</span><span class="op" id="4457249">.</span><span class="ident" id="4457250">Lock</span><span class="op" id="4457254">(</span><span class="op" id="4457255">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457258">t</span><span class="op" id="4457259">.</span><span class="ident" id="4457260">escapeErr</span>&nbsp;<span class="op" id="4457270">=</span>&nbsp;<span class="ident" id="4457272">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457277">t</span><span class="op" id="4457278">.</span><span class="ident" id="4457279">nameSpace</span><span class="op" id="4457288">.</span><span class="ident" id="4457289">mu</span><span class="op" id="4457291">.</span><span class="ident" id="4457292">Unlock</span><span class="op" id="4457298">(</span><span class="op" id="4457299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457302">ret</span><span class="op" id="4457305">,</span>&nbsp;<span class="ident" id="4457307">err</span>&nbsp;<span class="op" id="4457311">:=</span>&nbsp;<span class="ident" id="4457314">t</span><span class="op" id="4457315">.</span><span class="ident" id="4457316">text</span><span class="op" id="4457320">.</span><span class="ident" id="4457321">Parse</span><span class="op" id="4457326">(</span><span class="ident" id="4457327">src</span><span class="op" id="4457330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457333">if</span>&nbsp;<span class="ident" id="4457336">err</span>&nbsp;<span class="op" id="4457340">!=</span>&nbsp;<span class="ident" id="4457343">nil</span>&nbsp;<span class="op" id="4457347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457351">return</span>&nbsp;<span class="ident" id="4457358">nil</span><span class="op" id="4457361">,</span>&nbsp;<span class="ident" id="4457363">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4457368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457371">//&nbsp;In&nbsp;general,&nbsp;all&nbsp;the&nbsp;named&nbsp;templates&nbsp;might&nbsp;have&nbsp;changed&nbsp;underfoot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457441">//&nbsp;Regardless,&nbsp;some&nbsp;new&nbsp;ones&nbsp;may&nbsp;have&nbsp;been&nbsp;defined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457494">//&nbsp;The&nbsp;template.Template&nbsp;set&nbsp;has&nbsp;been&nbsp;updated;&nbsp;update&nbsp;ours.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457555">t</span><span class="op" id="4457556">.</span><span class="ident" id="4457557">nameSpace</span><span class="op" id="4457566">.</span><span class="ident" id="4457567">mu</span><span class="op" id="4457569">.</span><span class="ident" id="4457570">Lock</span><span class="op" id="4457574">(</span><span class="op" id="4457575">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457578">defer</span>&nbsp;<span class="ident" id="4457584">t</span><span class="op" id="4457585">.</span><span class="ident" id="4457586">nameSpace</span><span class="op" id="4457595">.</span><span class="ident" id="4457596">mu</span><span class="op" id="4457598">.</span><span class="ident" id="4457599">Unlock</span><span class="op" id="4457605">(</span><span class="op" id="4457606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457609">for</span>&nbsp;<span class="ident" id="4457613">_</span><span class="op" id="4457614">,</span>&nbsp;<span class="ident" id="4457616">v</span>&nbsp;<span class="op" id="4457618">:=</span>&nbsp;<span class="keyword" id="4457621">range</span>&nbsp;<span class="ident" id="4457627">ret</span><span class="op" id="4457630">.</span><span class="ident" id="4457631">Templates</span><span class="op" id="4457640">(</span><span class="op" id="4457641">)</span>&nbsp;<span class="op" id="4457643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457647">name</span>&nbsp;<span class="op" id="4457652">:=</span>&nbsp;<span class="ident" id="4457655">v</span><span class="op" id="4457656">.</span><span class="ident" id="4457657">Name</span><span class="op" id="4457661">(</span><span class="op" id="4457662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457666">tmpl</span>&nbsp;<span class="op" id="4457671">:=</span>&nbsp;<span class="ident" id="4457674">t</span><span class="op" id="4457675">.</span><span class="ident" id="4457676">set</span><span class="op" id="4457679">[</span><span class="ident" id="4457680">name</span><span class="op" id="4457684">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457688">if</span>&nbsp;<span class="ident" id="4457691">tmpl</span>&nbsp;<span class="op" id="4457696">==</span>&nbsp;<span class="ident" id="4457699">nil</span>&nbsp;<span class="op" id="4457703">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457708">tmpl</span>&nbsp;<span class="op" id="4457713">=</span>&nbsp;<span class="ident" id="4457715">t</span><span class="op" id="4457716">.</span><span class="builtinfunc" id="4457717">new</span><span class="op" id="4457720">(</span><span class="ident" id="4457721">name</span><span class="op" id="4457725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4457729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4457733">//&nbsp;Restore&nbsp;our&nbsp;record&nbsp;of&nbsp;this&nbsp;text/template&nbsp;to&nbsp;its&nbsp;unescaped&nbsp;original&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457812">tmpl</span><span class="op" id="4457816">.</span><span class="ident" id="4457817">escapeErr</span>&nbsp;<span class="op" id="4457827">=</span>&nbsp;<span class="ident" id="4457829">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457835">tmpl</span><span class="op" id="4457839">.</span><span class="ident" id="4457840">text</span>&nbsp;<span class="op" id="4457845">=</span>&nbsp;<span class="ident" id="4457847">v</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4457851">tmpl</span><span class="op" id="4457855">.</span><span class="ident" id="4457856">Tree</span>&nbsp;<span class="op" id="4457861">=</span>&nbsp;<span class="ident" id="4457863">v</span><span class="op" id="4457864">.</span><span class="ident" id="4457865">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4457871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4457874">return</span>&nbsp;<span class="ident" id="4457881">t</span><span class="op" id="4457882">,</span>&nbsp;<span class="ident" id="4457884">nil</span><br>
<span class="lineno"></span><span class="op" id="4457888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="4457891">//&nbsp;AddParseTree&nbsp;creates&nbsp;a&nbsp;new&nbsp;template&nbsp;with&nbsp;the&nbsp;name&nbsp;and&nbsp;parse&nbsp;tree</span><br>
<span class="lineno"></span><span class="comment" id="4457959">//&nbsp;and&nbsp;associates&nbsp;it&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="4457988">//</span><br>
<span class="lineno"></span><span class="comment" id="4457991">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="4458046">func</span>&nbsp;<span class="op" id="4458051">(</span><span class="ident" id="4458052">t</span>&nbsp;<span class="op" id="4458054">*</span><span class="ident" id="4458055">Template</span><span class="op" id="4458063">)</span>&nbsp;<span class="ident" id="4458065">AddParseTree</span><span class="op" id="4458077">(</span><span class="ident" id="4458078">name</span>&nbsp;<span class="builtintype" id="4458083">string</span><span class="op" id="4458089">,</span>&nbsp;<span class="ident" id="4458091">tree</span>&nbsp;<span class="op" id="4458096">*</span><span class="ident" id="4458097">parse</span><span class="op" id="4458102">.</span><span class="ident" id="4458103">Tree</span><span class="op" id="4458107">)</span>&nbsp;<span class="op" id="4458109">(</span><span class="op" id="4458110">*</span><span class="ident" id="4458111">Template</span><span class="op" id="4458119">,</span>&nbsp;<span class="builtintype" id="4458121">error</span><span class="op" id="4458126">)</span>&nbsp;<span class="op" id="4458128">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458131">t</span><span class="op" id="4458132">.</span><span class="ident" id="4458133">nameSpace</span><span class="op" id="4458142">.</span><span class="ident" id="4458143">mu</span><span class="op" id="4458145">.</span><span class="ident" id="4458146">Lock</span><span class="op" id="4458150">(</span><span class="op" id="4458151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4458154">defer</span>&nbsp;<span class="ident" id="4458160">t</span><span class="op" id="4458161">.</span><span class="ident" id="4458162">nameSpace</span><span class="op" id="4458171">.</span><span class="ident" id="4458172">mu</span><span class="op" id="4458174">.</span><span class="ident" id="4458175">Unlock</span><span class="op" id="4458181">(</span><span class="op" id="4458182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4458185">if</span>&nbsp;<span class="ident" id="4458188">t</span><span class="op" id="4458189">.</span><span class="ident" id="4458190">escapeErr</span>&nbsp;<span class="op" id="4458200">!=</span>&nbsp;<span class="ident" id="4458203">nil</span>&nbsp;<span class="op" id="4458207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4458211">return</span>&nbsp;<span class="ident" id="4458218">nil</span><span class="op" id="4458221">,</span>&nbsp;<span class="ident" id="4458223">fmt</span><span class="op" id="4458226">.</span><span class="ident" id="4458227">Errorf</span><span class="op" id="4458233">(</span><span class="string" id="4458234">&#34;html/template:&nbsp;cannot&nbsp;AddParseTree&nbsp;to&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="4458298">,</span>&nbsp;<span class="ident" id="4458300">t</span><span class="op" id="4458301">.</span><span class="ident" id="4458302">Name</span><span class="op" id="4458306">(</span><span class="op" id="4458307">)</span><span class="op" id="4458308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4458311">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458314">text</span><span class="op" id="4458318">,</span>&nbsp;<span class="ident" id="4458320">err</span>&nbsp;<span class="op" id="4458324">:=</span>&nbsp;<span class="ident" id="4458327">t</span><span class="op" id="4458328">.</span><span class="ident" id="4458329">text</span><span class="op" id="4458333">.</span><span class="ident" id="4458334">AddParseTree</span><span class="op" id="4458346">(</span><span class="ident" id="4458347">name</span><span class="op" id="4458351">,</span>&nbsp;<span class="ident" id="4458353">tree</span><span class="op" id="4458357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4458360">if</span>&nbsp;<span class="ident" id="4458363">err</span>&nbsp;<span class="op" id="4458367">!=</span>&nbsp;<span class="ident" id="4458370">nil</span>&nbsp;<span class="op" id="4458374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4458378">return</span>&nbsp;<span class="ident" id="4458385">nil</span><span class="op" id="4458388">,</span>&nbsp;<span class="ident" id="4458390">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4458395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458398">ret</span>&nbsp;<span class="op" id="4458402">:=</span>&nbsp;<span class="op" id="4458405">&amp;</span><span class="ident" id="4458406">Template</span><span class="op" id="4458414">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458418">nil</span><span class="op" id="4458421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458425">text</span><span class="op" id="4458429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458433">text</span><span class="op" id="4458437">.</span><span class="ident" id="4458438">Tree</span><span class="op" id="4458442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458446">t</span><span class="op" id="4458447">.</span><span class="ident" id="4458448">nameSpace</span><span class="op" id="4458457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4458460">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4458463">t</span><span class="op" id="4458464">.</span><span class="ident" id="4458465">set</span><span class="op" id="4458468">[</span><span class="ident" id="4458469">name</span><span class="op" id="4458473">]</span>&nbsp;<span class="op" id="4458475">=</span>&nbsp;<span class="ident" id="4458477">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4458482">return</span>&nbsp;<span class="ident" id="4458489">ret</span><span class="op" id="4458492">,</span>&nbsp;<span class="ident" id="4458494">nil</span><br>
<span class="lineno"></span><span class="op" id="4458498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4458501">//&nbsp;Clone&nbsp;returns&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;the&nbsp;template,&nbsp;including&nbsp;all&nbsp;associated</span><br>
<span class="lineno">180</span><span class="comment" id="4458572">//&nbsp;templates.&nbsp;The&nbsp;actual&nbsp;representation&nbsp;is&nbsp;not&nbsp;copied,&nbsp;but&nbsp;the&nbsp;name&nbsp;space&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4458649">//&nbsp;associated&nbsp;templates&nbsp;is,&nbsp;so&nbsp;further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add</span><br>
<span class="lineno"></span><span class="comment" id="4458724">//&nbsp;templates&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&nbsp;Clone&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;prepare</span><br>
<span class="lineno"></span><span class="comment" id="4458803">//&nbsp;common&nbsp;templates&nbsp;and&nbsp;use&nbsp;them&nbsp;with&nbsp;variant&nbsp;definitions&nbsp;for&nbsp;other&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="4458881">//&nbsp;by&nbsp;adding&nbsp;the&nbsp;variants&nbsp;after&nbsp;the&nbsp;clone&nbsp;is&nbsp;made.</span><br>
<span class="lineno">185</span><span class="comment" id="4458932">//</span><br>
<span class="lineno"></span><span class="comment" id="4458935">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="4458990">func</span>&nbsp;<span class="op" id="4458995">(</span><span class="ident" id="4458996">t</span>&nbsp;<span class="op" id="4458998">*</span><span class="ident" id="4458999">Template</span><span class="op" id="4459007">)</span>&nbsp;<span class="ident" id="4459009">Clone</span><span class="op" id="4459014">(</span><span class="op" id="4459015">)</span>&nbsp;<span class="op" id="4459017">(</span><span class="op" id="4459018">*</span><span class="ident" id="4459019">Template</span><span class="op" id="4459027">,</span>&nbsp;<span class="builtintype" id="4459029">error</span><span class="op" id="4459034">)</span>&nbsp;<span class="op" id="4459036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459039">t</span><span class="op" id="4459040">.</span><span class="ident" id="4459041">nameSpace</span><span class="op" id="4459050">.</span><span class="ident" id="4459051">mu</span><span class="op" id="4459053">.</span><span class="ident" id="4459054">Lock</span><span class="op" id="4459058">(</span><span class="op" id="4459059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4459062">defer</span>&nbsp;<span class="ident" id="4459068">t</span><span class="op" id="4459069">.</span><span class="ident" id="4459070">nameSpace</span><span class="op" id="4459079">.</span><span class="ident" id="4459080">mu</span><span class="op" id="4459082">.</span><span class="ident" id="4459083">Unlock</span><span class="op" id="4459089">(</span><span class="op" id="4459090">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4459093">if</span>&nbsp;<span class="ident" id="4459096">t</span><span class="op" id="4459097">.</span><span class="ident" id="4459098">escapeErr</span>&nbsp;<span class="op" id="4459108">!=</span>&nbsp;<span class="ident" id="4459111">nil</span>&nbsp;<span class="op" id="4459115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4459119">return</span>&nbsp;<span class="ident" id="4459126">nil</span><span class="op" id="4459129">,</span>&nbsp;<span class="ident" id="4459131">fmt</span><span class="op" id="4459134">.</span><span class="ident" id="4459135">Errorf</span><span class="op" id="4459141">(</span><span class="string" id="4459142">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="4459196">,</span>&nbsp;<span class="ident" id="4459198">t</span><span class="op" id="4459199">.</span><span class="ident" id="4459200">Name</span><span class="op" id="4459204">(</span><span class="op" id="4459205">)</span><span class="op" id="4459206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4459209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459212">textClone</span><span class="op" id="4459221">,</span>&nbsp;<span class="ident" id="4459223">err</span>&nbsp;<span class="op" id="4459227">:=</span>&nbsp;<span class="ident" id="4459230">t</span><span class="op" id="4459231">.</span><span class="ident" id="4459232">text</span><span class="op" id="4459236">.</span><span class="ident" id="4459237">Clone</span><span class="op" id="4459242">(</span><span class="op" id="4459243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4459246">if</span>&nbsp;<span class="ident" id="4459249">err</span>&nbsp;<span class="op" id="4459253">!=</span>&nbsp;<span class="ident" id="4459256">nil</span>&nbsp;<span class="op" id="4459260">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4459264">return</span>&nbsp;<span class="ident" id="4459271">nil</span><span class="op" id="4459274">,</span>&nbsp;<span class="ident" id="4459276">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4459281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459284">ret</span>&nbsp;<span class="op" id="4459288">:=</span>&nbsp;<span class="op" id="4459291">&amp;</span><span class="ident" id="4459292">Template</span><span class="op" id="4459300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459304">nil</span><span class="op" id="4459307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459311">textClone</span><span class="op" id="4459320">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459324">textClone</span><span class="op" id="4459333">.</span><span class="ident" id="4459334">Tree</span><span class="op" id="4459338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4459342">&amp;</span><span class="ident" id="4459343">nameSpace</span><span class="op" id="4459352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459357">set</span><span class="op" id="4459360">:</span>&nbsp;<span class="builtinfunc" id="4459362">make</span><span class="op" id="4459366">(</span><span class="keyword" id="4459367">map</span><span class="op" id="4459370">[</span><span class="builtintype" id="4459371">string</span><span class="op" id="4459377">]</span><span class="op" id="4459378">*</span><span class="ident" id="4459379">Template</span><span class="op" id="4459387">)</span><span class="op" id="4459388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4459392">}</span><span class="op" id="4459393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4459396">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4459399">for</span>&nbsp;<span class="ident" id="4459403">_</span><span class="op" id="4459404">,</span>&nbsp;<span class="ident" id="4459406">x</span>&nbsp;<span class="op" id="4459408">:=</span>&nbsp;<span class="keyword" id="4459411">range</span>&nbsp;<span class="ident" id="4459417">textClone</span><span class="op" id="4459426">.</span><span class="ident" id="4459427">Templates</span><span class="op" id="4459436">(</span><span class="op" id="4459437">)</span>&nbsp;<span class="op" id="4459439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459443">name</span>&nbsp;<span class="op" id="4459448">:=</span>&nbsp;<span class="ident" id="4459451">x</span><span class="op" id="4459452">.</span><span class="ident" id="4459453">Name</span><span class="op" id="4459457">(</span><span class="op" id="4459458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459462">src</span>&nbsp;<span class="op" id="4459466">:=</span>&nbsp;<span class="ident" id="4459469">t</span><span class="op" id="4459470">.</span><span class="ident" id="4459471">set</span><span class="op" id="4459474">[</span><span class="ident" id="4459475">name</span><span class="op" id="4459479">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4459483">if</span>&nbsp;<span class="ident" id="4459486">src</span>&nbsp;<span class="op" id="4459490">==</span>&nbsp;<span class="ident" id="4459493">nil</span>&nbsp;<span class="op" id="4459497">||</span>&nbsp;<span class="ident" id="4459500">src</span><span class="op" id="4459503">.</span><span class="ident" id="4459504">escapeErr</span>&nbsp;<span class="op" id="4459514">!=</span>&nbsp;<span class="ident" id="4459517">nil</span>&nbsp;<span class="op" id="4459521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4459526">return</span>&nbsp;<span class="ident" id="4459533">nil</span><span class="op" id="4459536">,</span>&nbsp;<span class="ident" id="4459538">fmt</span><span class="op" id="4459541">.</span><span class="ident" id="4459542">Errorf</span><span class="op" id="4459548">(</span><span class="string" id="4459549">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="4459603">,</span>&nbsp;<span class="ident" id="4459605">t</span><span class="op" id="4459606">.</span><span class="ident" id="4459607">Name</span><span class="op" id="4459611">(</span><span class="op" id="4459612">)</span><span class="op" id="4459613">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4459617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459621">x</span><span class="op" id="4459622">.</span><span class="ident" id="4459623">Tree</span>&nbsp;<span class="op" id="4459628">=</span>&nbsp;<span class="ident" id="4459630">x</span><span class="op" id="4459631">.</span><span class="ident" id="4459632">Tree</span><span class="op" id="4459636">.</span><span class="ident" id="4459637">Copy</span><span class="op" id="4459641">(</span><span class="op" id="4459642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459646">ret</span><span class="op" id="4459649">.</span><span class="ident" id="4459650">set</span><span class="op" id="4459653">[</span><span class="ident" id="4459654">name</span><span class="op" id="4459658">]</span>&nbsp;<span class="op" id="4459660">=</span>&nbsp;<span class="op" id="4459662">&amp;</span><span class="ident" id="4459663">Template</span><span class="op" id="4459671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459676">nil</span><span class="op" id="4459679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459684">x</span><span class="op" id="4459685">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459690">x</span><span class="op" id="4459691">.</span><span class="ident" id="4459692">Tree</span><span class="op" id="4459696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459701">ret</span><span class="op" id="4459704">.</span><span class="ident" id="4459705">nameSpace</span><span class="op" id="4459714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4459718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4459721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4459724">return</span>&nbsp;<span class="ident" id="4459731">ret</span><span class="op" id="4459734">,</span>&nbsp;<span class="ident" id="4459736">nil</span><br>
<span class="lineno">220</span><span class="op" id="4459740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4459743">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4459801">func</span>&nbsp;<span class="ident" id="4459806">New</span><span class="op" id="4459809">(</span><span class="ident" id="4459810">name</span>&nbsp;<span class="builtintype" id="4459815">string</span><span class="op" id="4459821">)</span>&nbsp;<span class="op" id="4459823">*</span><span class="ident" id="4459824">Template</span>&nbsp;<span class="op" id="4459833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459836">tmpl</span>&nbsp;<span class="op" id="4459841">:=</span>&nbsp;<span class="op" id="4459844">&amp;</span><span class="ident" id="4459845">Template</span><span class="op" id="4459853">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459857">nil</span><span class="op" id="4459860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459864">template</span><span class="op" id="4459872">.</span><span class="ident" id="4459873">New</span><span class="op" id="4459876">(</span><span class="ident" id="4459877">name</span><span class="op" id="4459881">)</span><span class="op" id="4459882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459886">nil</span><span class="op" id="4459889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4459893">&amp;</span><span class="ident" id="4459894">nameSpace</span><span class="op" id="4459903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459908">set</span><span class="op" id="4459911">:</span>&nbsp;<span class="builtinfunc" id="4459913">make</span><span class="op" id="4459917">(</span><span class="keyword" id="4459918">map</span><span class="op" id="4459921">[</span><span class="builtintype" id="4459922">string</span><span class="op" id="4459928">]</span><span class="op" id="4459929">*</span><span class="ident" id="4459930">Template</span><span class="op" id="4459938">)</span><span class="op" id="4459939">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4459943">}</span><span class="op" id="4459944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4459947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4459950">tmpl</span><span class="op" id="4459954">.</span><span class="ident" id="4459955">set</span><span class="op" id="4459958">[</span><span class="ident" id="4459959">name</span><span class="op" id="4459963">]</span>&nbsp;<span class="op" id="4459965">=</span>&nbsp;<span class="ident" id="4459967">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4459973">return</span>&nbsp;<span class="ident" id="4459980">tmpl</span><br>
<span class="lineno"></span><span class="op" id="4459985">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="4459988">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4460055">//&nbsp;and&nbsp;with&nbsp;the&nbsp;same&nbsp;delimiters.&nbsp;The&nbsp;association,&nbsp;which&nbsp;is&nbsp;transitive,</span><br>
<span class="lineno"></span><span class="comment" id="4460126">//&nbsp;allows&nbsp;one&nbsp;template&nbsp;to&nbsp;invoke&nbsp;another&nbsp;with&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4460195">func</span>&nbsp;<span class="op" id="4460200">(</span><span class="ident" id="4460201">t</span>&nbsp;<span class="op" id="4460203">*</span><span class="ident" id="4460204">Template</span><span class="op" id="4460212">)</span>&nbsp;<span class="ident" id="4460214">New</span><span class="op" id="4460217">(</span><span class="ident" id="4460218">name</span>&nbsp;<span class="builtintype" id="4460223">string</span><span class="op" id="4460229">)</span>&nbsp;<span class="op" id="4460231">*</span><span class="ident" id="4460232">Template</span>&nbsp;<span class="op" id="4460241">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460244">t</span><span class="op" id="4460245">.</span><span class="ident" id="4460246">nameSpace</span><span class="op" id="4460255">.</span><span class="ident" id="4460256">mu</span><span class="op" id="4460258">.</span><span class="ident" id="4460259">Lock</span><span class="op" id="4460263">(</span><span class="op" id="4460264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4460267">defer</span>&nbsp;<span class="ident" id="4460273">t</span><span class="op" id="4460274">.</span><span class="ident" id="4460275">nameSpace</span><span class="op" id="4460284">.</span><span class="ident" id="4460285">mu</span><span class="op" id="4460287">.</span><span class="ident" id="4460288">Unlock</span><span class="op" id="4460294">(</span><span class="op" id="4460295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4460298">return</span>&nbsp;<span class="ident" id="4460305">t</span><span class="op" id="4460306">.</span><span class="builtinfunc" id="4460307">new</span><span class="op" id="4460310">(</span><span class="ident" id="4460311">name</span><span class="op" id="4460315">)</span><br>
<span class="lineno"></span><span class="op" id="4460317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="4460320">//&nbsp;new&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;New,&nbsp;without&nbsp;the&nbsp;lock.</span><br>
<span class="lineno"></span><span class="keyword" id="4460375">func</span>&nbsp;<span class="op" id="4460380">(</span><span class="ident" id="4460381">t</span>&nbsp;<span class="op" id="4460383">*</span><span class="ident" id="4460384">Template</span><span class="op" id="4460392">)</span>&nbsp;<span class="builtinfunc" id="4460394">new</span><span class="op" id="4460397">(</span><span class="ident" id="4460398">name</span>&nbsp;<span class="builtintype" id="4460403">string</span><span class="op" id="4460409">)</span>&nbsp;<span class="op" id="4460411">*</span><span class="ident" id="4460412">Template</span>&nbsp;<span class="op" id="4460421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460424">tmpl</span>&nbsp;<span class="op" id="4460429">:=</span>&nbsp;<span class="op" id="4460432">&amp;</span><span class="ident" id="4460433">Template</span><span class="op" id="4460441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460445">nil</span><span class="op" id="4460448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460452">t</span><span class="op" id="4460453">.</span><span class="ident" id="4460454">text</span><span class="op" id="4460458">.</span><span class="ident" id="4460459">New</span><span class="op" id="4460462">(</span><span class="ident" id="4460463">name</span><span class="op" id="4460467">)</span><span class="op" id="4460468">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460472">nil</span><span class="op" id="4460475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460479">t</span><span class="op" id="4460480">.</span><span class="ident" id="4460481">nameSpace</span><span class="op" id="4460490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4460493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4460496">tmpl</span><span class="op" id="4460500">.</span><span class="ident" id="4460501">set</span><span class="op" id="4460504">[</span><span class="ident" id="4460505">name</span><span class="op" id="4460509">]</span>&nbsp;<span class="op" id="4460511">=</span>&nbsp;<span class="ident" id="4460513">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4460519">return</span>&nbsp;<span class="ident" id="4460526">tmpl</span><br>
<span class="lineno">255</span><span class="op" id="4460531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4460534">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4460576">func</span>&nbsp;<span class="op" id="4460581">(</span><span class="ident" id="4460582">t</span>&nbsp;<span class="op" id="4460584">*</span><span class="ident" id="4460585">Template</span><span class="op" id="4460593">)</span>&nbsp;<span class="ident" id="4460595">Name</span><span class="op" id="4460599">(</span><span class="op" id="4460600">)</span>&nbsp;<span class="builtintype" id="4460602">string</span>&nbsp;<span class="op" id="4460609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4460612">return</span>&nbsp;<span class="ident" id="4460619">t</span><span class="op" id="4460620">.</span><span class="ident" id="4460621">text</span><span class="op" id="4460625">.</span><span class="ident" id="4460626">Name</span><span class="op" id="4460630">(</span><span class="op" id="4460631">)</span><br>
<span class="lineno">260</span><span class="op" id="4460633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4460636">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4460705">//&nbsp;functions.&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two</span><br>
<span class="lineno"></span><span class="comment" id="4460780">//&nbsp;return&nbsp;values&nbsp;of&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the</span><br>
<span class="lineno">265</span><span class="comment" id="4460854">//&nbsp;second&nbsp;(error)&nbsp;argument&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution</span><br>
<span class="lineno"></span><span class="comment" id="4460930">//&nbsp;terminates&nbsp;and&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.&nbsp;FuncMap&nbsp;has&nbsp;the&nbsp;same&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4461007">//&nbsp;as&nbsp;FuncMap&nbsp;in&nbsp;&#34;text/template&#34;,&nbsp;copied&nbsp;here&nbsp;so&nbsp;clients&nbsp;need&nbsp;not&nbsp;import</span><br>
<span class="lineno"></span><span class="comment" id="4461080">//&nbsp;&#34;text/template&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4461100">type</span>&nbsp;<span class="ident" id="4461105">FuncMap</span>&nbsp;<span class="keyword" id="4461113">map</span><span class="op" id="4461116">[</span><span class="builtintype" id="4461117">string</span><span class="op" id="4461123">]</span><span class="keyword" id="4461124">interface</span><span class="op" id="4461133">{</span><span class="op" id="4461134">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="4461137">//&nbsp;Funcs&nbsp;adds&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;argument&nbsp;map&nbsp;to&nbsp;the&nbsp;template&#39;s&nbsp;function&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="4461216">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;a&nbsp;value&nbsp;in&nbsp;the&nbsp;map&nbsp;is&nbsp;not&nbsp;a&nbsp;function&nbsp;with&nbsp;appropriate&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="4461293">//&nbsp;type.&nbsp;However,&nbsp;it&nbsp;is&nbsp;legal&nbsp;to&nbsp;overwrite&nbsp;elements&nbsp;of&nbsp;the&nbsp;map.&nbsp;The&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="4461368">//&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">275</span><span class="keyword" id="4461419">func</span>&nbsp;<span class="op" id="4461424">(</span><span class="ident" id="4461425">t</span>&nbsp;<span class="op" id="4461427">*</span><span class="ident" id="4461428">Template</span><span class="op" id="4461436">)</span>&nbsp;<span class="ident" id="4461438">Funcs</span><span class="op" id="4461443">(</span><span class="ident" id="4461444">funcMap</span>&nbsp;<span class="ident" id="4461452">FuncMap</span><span class="op" id="4461459">)</span>&nbsp;<span class="op" id="4461461">*</span><span class="ident" id="4461462">Template</span>&nbsp;<span class="op" id="4461471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461474">t</span><span class="op" id="4461475">.</span><span class="ident" id="4461476">text</span><span class="op" id="4461480">.</span><span class="ident" id="4461481">Funcs</span><span class="op" id="4461486">(</span><span class="ident" id="4461487">template</span><span class="op" id="4461495">.</span><span class="ident" id="4461496">FuncMap</span><span class="op" id="4461503">(</span><span class="ident" id="4461504">funcMap</span><span class="op" id="4461511">)</span><span class="op" id="4461512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4461515">return</span>&nbsp;<span class="ident" id="4461522">t</span><br>
<span class="lineno"></span><span class="op" id="4461524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="comment" id="4461527">//&nbsp;Delims&nbsp;sets&nbsp;the&nbsp;action&nbsp;delimiters&nbsp;to&nbsp;the&nbsp;specified&nbsp;strings,&nbsp;to&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4461604">//&nbsp;subsequent&nbsp;calls&nbsp;to&nbsp;Parse,&nbsp;ParseFiles,&nbsp;or&nbsp;ParseGlob.&nbsp;Nested&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="4461676">//&nbsp;definitions&nbsp;will&nbsp;inherit&nbsp;the&nbsp;settings.&nbsp;An&nbsp;empty&nbsp;delimiter&nbsp;stands&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4461752">//&nbsp;corresponding&nbsp;default:&nbsp;{{&nbsp;or&nbsp;}}.</span><br>
<span class="lineno"></span><span class="comment" id="4461788">//&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">285</span><span class="keyword" id="4461850">func</span>&nbsp;<span class="op" id="4461855">(</span><span class="ident" id="4461856">t</span>&nbsp;<span class="op" id="4461858">*</span><span class="ident" id="4461859">Template</span><span class="op" id="4461867">)</span>&nbsp;<span class="ident" id="4461869">Delims</span><span class="op" id="4461875">(</span><span class="ident" id="4461876">left</span><span class="op" id="4461880">,</span>&nbsp;<span class="ident" id="4461882">right</span>&nbsp;<span class="builtintype" id="4461888">string</span><span class="op" id="4461894">)</span>&nbsp;<span class="op" id="4461896">*</span><span class="ident" id="4461897">Template</span>&nbsp;<span class="op" id="4461906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4461909">t</span><span class="op" id="4461910">.</span><span class="ident" id="4461911">text</span><span class="op" id="4461915">.</span><span class="ident" id="4461916">Delims</span><span class="op" id="4461922">(</span><span class="ident" id="4461923">left</span><span class="op" id="4461927">,</span>&nbsp;<span class="ident" id="4461929">right</span><span class="op" id="4461934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4461937">return</span>&nbsp;<span class="ident" id="4461944">t</span><br>
<span class="lineno"></span><span class="op" id="4461946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="comment" id="4461949">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;that&nbsp;is&nbsp;associated&nbsp;with&nbsp;t,</span><br>
<span class="lineno"></span><span class="comment" id="4462027">//&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4462067">func</span>&nbsp;<span class="op" id="4462072">(</span><span class="ident" id="4462073">t</span>&nbsp;<span class="op" id="4462075">*</span><span class="ident" id="4462076">Template</span><span class="op" id="4462084">)</span>&nbsp;<span class="ident" id="4462086">Lookup</span><span class="op" id="4462092">(</span><span class="ident" id="4462093">name</span>&nbsp;<span class="builtintype" id="4462098">string</span><span class="op" id="4462104">)</span>&nbsp;<span class="op" id="4462106">*</span><span class="ident" id="4462107">Template</span>&nbsp;<span class="op" id="4462116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4462119">t</span><span class="op" id="4462120">.</span><span class="ident" id="4462121">nameSpace</span><span class="op" id="4462130">.</span><span class="ident" id="4462131">mu</span><span class="op" id="4462133">.</span><span class="ident" id="4462134">Lock</span><span class="op" id="4462138">(</span><span class="op" id="4462139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462142">defer</span>&nbsp;<span class="ident" id="4462148">t</span><span class="op" id="4462149">.</span><span class="ident" id="4462150">nameSpace</span><span class="op" id="4462159">.</span><span class="ident" id="4462160">mu</span><span class="op" id="4462162">.</span><span class="ident" id="4462163">Unlock</span><span class="op" id="4462169">(</span><span class="op" id="4462170">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462173">return</span>&nbsp;<span class="ident" id="4462180">t</span><span class="op" id="4462181">.</span><span class="ident" id="4462182">set</span><span class="op" id="4462185">[</span><span class="ident" id="4462186">name</span><span class="op" id="4462190">]</span><br>
<span class="lineno"></span><span class="op" id="4462192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4462195">//&nbsp;Must&nbsp;is&nbsp;a&nbsp;helper&nbsp;that&nbsp;wraps&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;returning&nbsp;(*Template,&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="4462276">//&nbsp;and&nbsp;panics&nbsp;if&nbsp;the&nbsp;error&nbsp;is&nbsp;non-nil.&nbsp;It&nbsp;is&nbsp;intended&nbsp;for&nbsp;use&nbsp;in&nbsp;variable&nbsp;initializations</span><br>
<span class="lineno">300</span><span class="comment" id="4462366">//&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4462377">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;t&nbsp;=&nbsp;template.Must(template.New(&#34;name&#34;).Parse(&#34;html&#34;))</span><br>
<span class="lineno"></span><span class="keyword" id="4462438">func</span>&nbsp;<span class="ident" id="4462443">Must</span><span class="op" id="4462447">(</span><span class="ident" id="4462448">t</span>&nbsp;<span class="op" id="4462450">*</span><span class="ident" id="4462451">Template</span><span class="op" id="4462459">,</span>&nbsp;<span class="ident" id="4462461">err</span>&nbsp;<span class="builtintype" id="4462465">error</span><span class="op" id="4462470">)</span>&nbsp;<span class="op" id="4462472">*</span><span class="ident" id="4462473">Template</span>&nbsp;<span class="op" id="4462482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462485">if</span>&nbsp;<span class="ident" id="4462488">err</span>&nbsp;<span class="op" id="4462492">!=</span>&nbsp;<span class="ident" id="4462495">nil</span>&nbsp;<span class="op" id="4462499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4462503">panic</span><span class="op" id="4462508">(</span><span class="ident" id="4462509">err</span><span class="op" id="4462512">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4462515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462518">return</span>&nbsp;<span class="ident" id="4462525">t</span><br>
<span class="lineno"></span><span class="op" id="4462527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4462530">//&nbsp;ParseFiles&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from</span><br>
<span class="lineno">310</span><span class="comment" id="4462608">//&nbsp;the&nbsp;named&nbsp;files.&nbsp;The&nbsp;returned&nbsp;template&#39;s&nbsp;name&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4462687">//&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the&nbsp;first&nbsp;file.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="4462760">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;*Template&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4462832">func</span>&nbsp;<span class="ident" id="4462837">ParseFiles</span><span class="op" id="4462847">(</span><span class="ident" id="4462848">filenames</span>&nbsp;<span class="op" id="4462858">...</span><span class="builtintype" id="4462861">string</span><span class="op" id="4462867">)</span>&nbsp;<span class="op" id="4462869">(</span><span class="op" id="4462870">*</span><span class="ident" id="4462871">Template</span><span class="op" id="4462879">,</span>&nbsp;<span class="builtintype" id="4462881">error</span><span class="op" id="4462886">)</span>&nbsp;<span class="op" id="4462888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4462891">return</span>&nbsp;<span class="ident" id="4462898">parseFiles</span><span class="op" id="4462908">(</span><span class="ident" id="4462909">nil</span><span class="op" id="4462912">,</span>&nbsp;<span class="ident" id="4462914">filenames</span><span class="op" id="4462923">...</span><span class="op" id="4462926">)</span><br>
<span class="lineno">315</span><span class="op" id="4462928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4462931">//&nbsp;ParseFiles&nbsp;parses&nbsp;the&nbsp;named&nbsp;files&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4463012">//&nbsp;t.&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;template&nbsp;is&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="4463086">//&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;t.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno">320</span><span class="keyword" id="4463141">func</span>&nbsp;<span class="op" id="4463146">(</span><span class="ident" id="4463147">t</span>&nbsp;<span class="op" id="4463149">*</span><span class="ident" id="4463150">Template</span><span class="op" id="4463158">)</span>&nbsp;<span class="ident" id="4463160">ParseFiles</span><span class="op" id="4463170">(</span><span class="ident" id="4463171">filenames</span>&nbsp;<span class="op" id="4463181">...</span><span class="builtintype" id="4463184">string</span><span class="op" id="4463190">)</span>&nbsp;<span class="op" id="4463192">(</span><span class="op" id="4463193">*</span><span class="ident" id="4463194">Template</span><span class="op" id="4463202">,</span>&nbsp;<span class="builtintype" id="4463204">error</span><span class="op" id="4463209">)</span>&nbsp;<span class="op" id="4463211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4463214">return</span>&nbsp;<span class="ident" id="4463221">parseFiles</span><span class="op" id="4463231">(</span><span class="ident" id="4463232">t</span><span class="op" id="4463233">,</span>&nbsp;<span class="ident" id="4463235">filenames</span><span class="op" id="4463244">...</span><span class="op" id="4463247">)</span><br>
<span class="lineno"></span><span class="op" id="4463249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4463252">//&nbsp;parseFiles&nbsp;is&nbsp;the&nbsp;helper&nbsp;for&nbsp;the&nbsp;method&nbsp;and&nbsp;function.&nbsp;If&nbsp;the&nbsp;argument</span><br>
<span class="lineno">325</span><span class="comment" id="4463325">//&nbsp;template&nbsp;is&nbsp;nil,&nbsp;it&nbsp;is&nbsp;created&nbsp;from&nbsp;the&nbsp;first&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4463380">func</span>&nbsp;<span class="ident" id="4463385">parseFiles</span><span class="op" id="4463395">(</span><span class="ident" id="4463396">t</span>&nbsp;<span class="op" id="4463398">*</span><span class="ident" id="4463399">Template</span><span class="op" id="4463407">,</span>&nbsp;<span class="ident" id="4463409">filenames</span>&nbsp;<span class="op" id="4463419">...</span><span class="builtintype" id="4463422">string</span><span class="op" id="4463428">)</span>&nbsp;<span class="op" id="4463430">(</span><span class="op" id="4463431">*</span><span class="ident" id="4463432">Template</span><span class="op" id="4463440">,</span>&nbsp;<span class="builtintype" id="4463442">error</span><span class="op" id="4463447">)</span>&nbsp;<span class="op" id="4463449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4463452">if</span>&nbsp;<span class="builtinfunc" id="4463455">len</span><span class="op" id="4463458">(</span><span class="ident" id="4463459">filenames</span><span class="op" id="4463468">)</span>&nbsp;<span class="op" id="4463470">==</span>&nbsp;<span class="num" id="4463473">0</span>&nbsp;<span class="op" id="4463475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4463479">//&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem,&nbsp;but&nbsp;be&nbsp;consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4463525">return</span>&nbsp;<span class="ident" id="4463532">nil</span><span class="op" id="4463535">,</span>&nbsp;<span class="ident" id="4463537">fmt</span><span class="op" id="4463540">.</span><span class="ident" id="4463541">Errorf</span><span class="op" id="4463547">(</span><span class="string" id="4463548">&#34;html/template:&nbsp;no&nbsp;files&nbsp;named&nbsp;in&nbsp;call&nbsp;to&nbsp;ParseFiles&#34;</span><span class="op" id="4463601">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4463604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4463607">for</span>&nbsp;<span class="ident" id="4463611">_</span><span class="op" id="4463612">,</span>&nbsp;<span class="ident" id="4463614">filename</span>&nbsp;<span class="op" id="4463623">:=</span>&nbsp;<span class="keyword" id="4463626">range</span>&nbsp;<span class="ident" id="4463632">filenames</span>&nbsp;<span class="op" id="4463642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463646">b</span><span class="op" id="4463647">,</span>&nbsp;<span class="ident" id="4463649">err</span>&nbsp;<span class="op" id="4463653">:=</span>&nbsp;<span class="ident" id="4463656">ioutil</span><span class="op" id="4463662">.</span><span class="ident" id="4463663">ReadFile</span><span class="op" id="4463671">(</span><span class="ident" id="4463672">filename</span><span class="op" id="4463680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4463684">if</span>&nbsp;<span class="ident" id="4463687">err</span>&nbsp;<span class="op" id="4463691">!=</span>&nbsp;<span class="ident" id="4463694">nil</span>&nbsp;<span class="op" id="4463698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4463703">return</span>&nbsp;<span class="ident" id="4463710">nil</span><span class="op" id="4463713">,</span>&nbsp;<span class="ident" id="4463715">err</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4463721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463725">s</span>&nbsp;<span class="op" id="4463727">:=</span>&nbsp;<span class="builtintype" id="4463730">string</span><span class="op" id="4463736">(</span><span class="ident" id="4463737">b</span><span class="op" id="4463738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4463742">name</span>&nbsp;<span class="op" id="4463747">:=</span>&nbsp;<span class="ident" id="4463750">filepath</span><span class="op" id="4463758">.</span><span class="ident" id="4463759">Base</span><span class="op" id="4463763">(</span><span class="ident" id="4463764">filename</span><span class="op" id="4463772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4463776">//&nbsp;First&nbsp;template&nbsp;becomes&nbsp;return&nbsp;value&nbsp;if&nbsp;not&nbsp;already&nbsp;defined,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4463841">//&nbsp;and&nbsp;we&nbsp;use&nbsp;that&nbsp;one&nbsp;for&nbsp;subsequent&nbsp;New&nbsp;calls&nbsp;to&nbsp;associate</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4463904">//&nbsp;all&nbsp;the&nbsp;templates&nbsp;together.&nbsp;Also,&nbsp;if&nbsp;this&nbsp;file&nbsp;has&nbsp;the&nbsp;same&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4463974">//&nbsp;as&nbsp;t,&nbsp;this&nbsp;file&nbsp;becomes&nbsp;the&nbsp;contents&nbsp;of&nbsp;t,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4464025">//&nbsp;&nbsp;t,&nbsp;err&nbsp;:=&nbsp;New(name).Funcs(xxx).ParseFiles(name)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4464079">//&nbsp;works.&nbsp;Otherwise&nbsp;we&nbsp;create&nbsp;a&nbsp;new&nbsp;template&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464145">var</span>&nbsp;<span class="ident" id="4464149">tmpl</span>&nbsp;<span class="op" id="4464154">*</span><span class="ident" id="4464155">Template</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464166">if</span>&nbsp;<span class="ident" id="4464169">t</span>&nbsp;<span class="op" id="4464171">==</span>&nbsp;<span class="ident" id="4464174">nil</span>&nbsp;<span class="op" id="4464178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464183">t</span>&nbsp;<span class="op" id="4464185">=</span>&nbsp;<span class="ident" id="4464187">New</span><span class="op" id="4464190">(</span><span class="ident" id="4464191">name</span><span class="op" id="4464195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464203">if</span>&nbsp;<span class="ident" id="4464206">name</span>&nbsp;<span class="op" id="4464211">==</span>&nbsp;<span class="ident" id="4464214">t</span><span class="op" id="4464215">.</span><span class="ident" id="4464216">Name</span><span class="op" id="4464220">(</span><span class="op" id="4464221">)</span>&nbsp;<span class="op" id="4464223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464228">tmpl</span>&nbsp;<span class="op" id="4464233">=</span>&nbsp;<span class="ident" id="4464235">t</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464239">}</span>&nbsp;<span class="keyword" id="4464241">else</span>&nbsp;<span class="op" id="4464246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464251">tmpl</span>&nbsp;<span class="op" id="4464256">=</span>&nbsp;<span class="ident" id="4464258">t</span><span class="op" id="4464259">.</span><span class="ident" id="4464260">New</span><span class="op" id="4464263">(</span><span class="ident" id="4464264">name</span><span class="op" id="4464268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4464276">_</span><span class="op" id="4464277">,</span>&nbsp;<span class="ident" id="4464279">err</span>&nbsp;<span class="op" id="4464283">=</span>&nbsp;<span class="ident" id="4464285">tmpl</span><span class="op" id="4464289">.</span><span class="ident" id="4464290">Parse</span><span class="op" id="4464295">(</span><span class="ident" id="4464296">s</span><span class="op" id="4464297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464301">if</span>&nbsp;<span class="ident" id="4464304">err</span>&nbsp;<span class="op" id="4464308">!=</span>&nbsp;<span class="ident" id="4464311">nil</span>&nbsp;<span class="op" id="4464315">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464320">return</span>&nbsp;<span class="ident" id="4464327">nil</span><span class="op" id="4464330">,</span>&nbsp;<span class="ident" id="4464332">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4464341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464344">return</span>&nbsp;<span class="ident" id="4464351">t</span><span class="op" id="4464352">,</span>&nbsp;<span class="ident" id="4464354">nil</span><br>
<span class="lineno"></span><span class="op" id="4464358">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="4464361">//&nbsp;ParseGlob&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4464442">//&nbsp;files&nbsp;identified&nbsp;by&nbsp;the&nbsp;pattern,&nbsp;which&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4464518">//&nbsp;returned&nbsp;template&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4464594">//&nbsp;first&nbsp;file&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.&nbsp;ParseGlob&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling</span><br>
<span class="lineno">365</span><span class="comment" id="4464667">//&nbsp;ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="keyword" id="4464728">func</span>&nbsp;<span class="ident" id="4464733">ParseGlob</span><span class="op" id="4464742">(</span><span class="ident" id="4464743">pattern</span>&nbsp;<span class="builtintype" id="4464751">string</span><span class="op" id="4464757">)</span>&nbsp;<span class="op" id="4464759">(</span><span class="op" id="4464760">*</span><span class="ident" id="4464761">Template</span><span class="op" id="4464769">,</span>&nbsp;<span class="builtintype" id="4464771">error</span><span class="op" id="4464776">)</span>&nbsp;<span class="op" id="4464778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4464781">return</span>&nbsp;<span class="ident" id="4464788">parseGlob</span><span class="op" id="4464797">(</span><span class="ident" id="4464798">nil</span><span class="op" id="4464801">,</span>&nbsp;<span class="ident" id="4464803">pattern</span><span class="op" id="4464810">)</span><br>
<span class="lineno"></span><span class="op" id="4464812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="comment" id="4464815">//&nbsp;ParseGlob&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;in&nbsp;the&nbsp;files&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4464891">//&nbsp;pattern&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with&nbsp;t.&nbsp;The&nbsp;pattern&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4464964">//&nbsp;processed&nbsp;by&nbsp;filepath.Glob&nbsp;and&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;ParseGlob&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4465041">//&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;t.ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4465117">//&nbsp;pattern.</span><br>
<span class="lineno">375</span><span class="keyword" id="4465129">func</span>&nbsp;<span class="op" id="4465134">(</span><span class="ident" id="4465135">t</span>&nbsp;<span class="op" id="4465137">*</span><span class="ident" id="4465138">Template</span><span class="op" id="4465146">)</span>&nbsp;<span class="ident" id="4465148">ParseGlob</span><span class="op" id="4465157">(</span><span class="ident" id="4465158">pattern</span>&nbsp;<span class="builtintype" id="4465166">string</span><span class="op" id="4465172">)</span>&nbsp;<span class="op" id="4465174">(</span><span class="op" id="4465175">*</span><span class="ident" id="4465176">Template</span><span class="op" id="4465184">,</span>&nbsp;<span class="builtintype" id="4465186">error</span><span class="op" id="4465191">)</span>&nbsp;<span class="op" id="4465193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465196">return</span>&nbsp;<span class="ident" id="4465203">parseGlob</span><span class="op" id="4465212">(</span><span class="ident" id="4465213">t</span><span class="op" id="4465214">,</span>&nbsp;<span class="ident" id="4465216">pattern</span><span class="op" id="4465223">)</span><br>
<span class="lineno"></span><span class="op" id="4465225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4465228">//&nbsp;parseGlob&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;function&nbsp;and&nbsp;method&nbsp;ParseGlob.</span><br>
<span class="lineno">380</span><span class="keyword" id="4465301">func</span>&nbsp;<span class="ident" id="4465306">parseGlob</span><span class="op" id="4465315">(</span><span class="ident" id="4465316">t</span>&nbsp;<span class="op" id="4465318">*</span><span class="ident" id="4465319">Template</span><span class="op" id="4465327">,</span>&nbsp;<span class="ident" id="4465329">pattern</span>&nbsp;<span class="builtintype" id="4465337">string</span><span class="op" id="4465343">)</span>&nbsp;<span class="op" id="4465345">(</span><span class="op" id="4465346">*</span><span class="ident" id="4465347">Template</span><span class="op" id="4465355">,</span>&nbsp;<span class="builtintype" id="4465357">error</span><span class="op" id="4465362">)</span>&nbsp;<span class="op" id="4465364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4465367">filenames</span><span class="op" id="4465376">,</span>&nbsp;<span class="ident" id="4465378">err</span>&nbsp;<span class="op" id="4465382">:=</span>&nbsp;<span class="ident" id="4465385">filepath</span><span class="op" id="4465393">.</span><span class="ident" id="4465394">Glob</span><span class="op" id="4465398">(</span><span class="ident" id="4465399">pattern</span><span class="op" id="4465406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465409">if</span>&nbsp;<span class="ident" id="4465412">err</span>&nbsp;<span class="op" id="4465416">!=</span>&nbsp;<span class="ident" id="4465419">nil</span>&nbsp;<span class="op" id="4465423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465427">return</span>&nbsp;<span class="ident" id="4465434">nil</span><span class="op" id="4465437">,</span>&nbsp;<span class="ident" id="4465439">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4465444">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465447">if</span>&nbsp;<span class="builtinfunc" id="4465450">len</span><span class="op" id="4465453">(</span><span class="ident" id="4465454">filenames</span><span class="op" id="4465463">)</span>&nbsp;<span class="op" id="4465465">==</span>&nbsp;<span class="num" id="4465468">0</span>&nbsp;<span class="op" id="4465470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465474">return</span>&nbsp;<span class="ident" id="4465481">nil</span><span class="op" id="4465484">,</span>&nbsp;<span class="ident" id="4465486">fmt</span><span class="op" id="4465489">.</span><span class="ident" id="4465490">Errorf</span><span class="op" id="4465496">(</span><span class="string" id="4465497">&#34;html/template:&nbsp;pattern&nbsp;matches&nbsp;no&nbsp;files:&nbsp;%#q&#34;</span><span class="op" id="4465543">,</span>&nbsp;<span class="ident" id="4465545">pattern</span><span class="op" id="4465552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4465555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4465558">return</span>&nbsp;<span class="ident" id="4465565">parseFiles</span><span class="op" id="4465575">(</span><span class="ident" id="4465576">t</span><span class="op" id="4465577">,</span>&nbsp;<span class="ident" id="4465579">filenames</span><span class="op" id="4465588">...</span><span class="op" id="4465591">)</span><br>
<span class="lineno"></span><span class="op" id="4465593">}</span>
</div>
</body>
</html>
