<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8051222">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8051277">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8051331">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8051382">package</span>&nbsp;<span class="ident" id="8051390">subtle</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8051398">import</span>&nbsp;<span class="op" id="8051405">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8051408">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8051419">&#34;testing/quick&#34;</span><br>
<span class="lineno">10</span><span class="op" id="8051435">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8051438">type</span>&nbsp;<span class="ident" id="8051443">TestConstantTimeCompareStruct</span>&nbsp;<span class="keyword" id="8051473">struct</span>&nbsp;<span class="op" id="8051480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8051483">a</span><span class="op" id="8051484">,</span>&nbsp;<span class="ident" id="8051486">b</span>&nbsp;<span class="op" id="8051488">[</span><span class="op" id="8051489">]</span><span class="builtintype" id="8051490">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8051496">out</span>&nbsp;&nbsp;<span class="builtintype" id="8051501">int</span><br>
<span class="lineno">15</span><span class="op" id="8051505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8051508">var</span>&nbsp;<span class="ident" id="8051512">testConstantTimeCompareData</span>&nbsp;<span class="op" id="8051540">=</span>&nbsp;<span class="op" id="8051542">[</span><span class="op" id="8051543">]</span><span class="ident" id="8051544"><a href="/crypto/subtle/constant_time_test.go.html#8051443">TestConstantTimeCompareStruct</a></span><span class="op" id="8051573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051576">{</span><span class="op" id="8051577">[</span><span class="op" id="8051578">]</span><span class="builtintype" id="8051579">byte</span><span class="op" id="8051583">{</span><span class="op" id="8051584">}</span><span class="op" id="8051585">,</span>&nbsp;<span class="op" id="8051587">[</span><span class="op" id="8051588">]</span><span class="builtintype" id="8051589">byte</span><span class="op" id="8051593">{</span><span class="op" id="8051594">}</span><span class="op" id="8051595">,</span>&nbsp;<span class="num" id="8051597">1</span><span class="op" id="8051598">}</span><span class="op" id="8051599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051602">{</span><span class="op" id="8051603">[</span><span class="op" id="8051604">]</span><span class="builtintype" id="8051605">byte</span><span class="op" id="8051609">{</span><span class="num" id="8051610">0x11</span><span class="op" id="8051614">}</span><span class="op" id="8051615">,</span>&nbsp;<span class="op" id="8051617">[</span><span class="op" id="8051618">]</span><span class="builtintype" id="8051619">byte</span><span class="op" id="8051623">{</span><span class="num" id="8051624">0x11</span><span class="op" id="8051628">}</span><span class="op" id="8051629">,</span>&nbsp;<span class="num" id="8051631">1</span><span class="op" id="8051632">}</span><span class="op" id="8051633">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051636">{</span><span class="op" id="8051637">[</span><span class="op" id="8051638">]</span><span class="builtintype" id="8051639">byte</span><span class="op" id="8051643">{</span><span class="num" id="8051644">0x12</span><span class="op" id="8051648">}</span><span class="op" id="8051649">,</span>&nbsp;<span class="op" id="8051651">[</span><span class="op" id="8051652">]</span><span class="builtintype" id="8051653">byte</span><span class="op" id="8051657">{</span><span class="num" id="8051658">0x11</span><span class="op" id="8051662">}</span><span class="op" id="8051663">,</span>&nbsp;<span class="num" id="8051665">0</span><span class="op" id="8051666">}</span><span class="op" id="8051667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051670">{</span><span class="op" id="8051671">[</span><span class="op" id="8051672">]</span><span class="builtintype" id="8051673">byte</span><span class="op" id="8051677">{</span><span class="num" id="8051678">0x11</span><span class="op" id="8051682">}</span><span class="op" id="8051683">,</span>&nbsp;<span class="op" id="8051685">[</span><span class="op" id="8051686">]</span><span class="builtintype" id="8051687">byte</span><span class="op" id="8051691">{</span><span class="num" id="8051692">0x11</span><span class="op" id="8051696">,</span>&nbsp;<span class="num" id="8051698">0x12</span><span class="op" id="8051702">}</span><span class="op" id="8051703">,</span>&nbsp;<span class="num" id="8051705">0</span><span class="op" id="8051706">}</span><span class="op" id="8051707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051710">{</span><span class="op" id="8051711">[</span><span class="op" id="8051712">]</span><span class="builtintype" id="8051713">byte</span><span class="op" id="8051717">{</span><span class="num" id="8051718">0x11</span><span class="op" id="8051722">,</span>&nbsp;<span class="num" id="8051724">0x12</span><span class="op" id="8051728">}</span><span class="op" id="8051729">,</span>&nbsp;<span class="op" id="8051731">[</span><span class="op" id="8051732">]</span><span class="builtintype" id="8051733">byte</span><span class="op" id="8051737">{</span><span class="num" id="8051738">0x11</span><span class="op" id="8051742">}</span><span class="op" id="8051743">,</span>&nbsp;<span class="num" id="8051745">0</span><span class="op" id="8051746">}</span><span class="op" id="8051747">,</span><br>
<span class="lineno"></span><span class="op" id="8051749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="8051752">func</span>&nbsp;<span class="ident" id="8051757">TestConstantTimeCompare</span><span class="op" id="8051780">(</span><span class="ident" id="8051781">t</span>&nbsp;<span class="op" id="8051783">*</span><span class="ident" id="8051784"><a href="/crypto/subtle/constant_time_test.go.html#8051408">testing</a></span><span class="op" id="8051791">.</span><span class="ident" id="8051792">T</span><span class="op" id="8051793">)</span>&nbsp;<span class="op" id="8051795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8051798">for</span>&nbsp;<span class="ident" id="8051802">i</span><span class="op" id="8051803">,</span>&nbsp;<span class="ident" id="8051805">test</span>&nbsp;<span class="op" id="8051810">:=</span>&nbsp;<span class="keyword" id="8051813">range</span>&nbsp;<span class="ident" id="8051819"><a href="/crypto/subtle/constant_time_test.go.html#8051512">testConstantTimeCompareData</a></span>&nbsp;<span class="op" id="8051847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8051851">if</span>&nbsp;<span class="ident" id="8051854">r</span>&nbsp;<span class="op" id="8051856">:=</span>&nbsp;<span class="ident" id="8051859"><a href="/crypto/subtle/constant_time.go.html#4084024">ConstantTimeCompare</a></span><span class="op" id="8051878">(</span><span class="ident" id="8051879"><a href="/crypto/subtle/constant_time_test.go.html#8051805">test</a></span><span class="op" id="8051883">.</span><span class="ident" id="8051884">a</span><span class="op" id="8051885">,</span>&nbsp;<span class="ident" id="8051887"><a href="/crypto/subtle/constant_time_test.go.html#8051805">test</a></span><span class="op" id="8051891">.</span><span class="ident" id="8051892">b</span><span class="op" id="8051893">)</span><span class="op" id="8051894">;</span>&nbsp;<span class="ident" id="8051896"><a href="/crypto/subtle/constant_time_test.go.html#8051854">r</a></span>&nbsp;<span class="op" id="8051898">!=</span>&nbsp;<span class="ident" id="8051901"><a href="/crypto/subtle/constant_time_test.go.html#8051805">test</a></span><span class="op" id="8051905">.</span><span class="ident" id="8051906">out</span>&nbsp;<span class="op" id="8051910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8051915"><a href="/crypto/subtle/constant_time_test.go.html#8051781">t</a></span><span class="op" id="8051916">.</span><span class="ident" id="8051917">Errorf</span><span class="op" id="8051923">(</span><span class="string" id="8051924">&#34;#%d&nbsp;bad&nbsp;result&nbsp;(got&nbsp;%x,&nbsp;want&nbsp;%x)&#34;</span><span class="op" id="8051958">,</span>&nbsp;<span class="ident" id="8051960"><a href="/crypto/subtle/constant_time_test.go.html#8051802">i</a></span><span class="op" id="8051961">,</span>&nbsp;<span class="ident" id="8051963"><a href="/crypto/subtle/constant_time_test.go.html#8051854">r</a></span><span class="op" id="8051964">,</span>&nbsp;<span class="ident" id="8051966"><a href="/crypto/subtle/constant_time_test.go.html#8051805">test</a></span><span class="op" id="8051970">.</span><span class="ident" id="8051971">out</span><span class="op" id="8051974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051978">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8051981">}</span><br>
<span class="lineno"></span><span class="op" id="8051983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8051986">type</span>&nbsp;<span class="ident" id="8051991">TestConstantTimeByteEqStruct</span>&nbsp;<span class="keyword" id="8052020">struct</span>&nbsp;<span class="op" id="8052027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052030">a</span><span class="op" id="8052031">,</span>&nbsp;<span class="ident" id="8052033">b</span>&nbsp;<span class="builtintype" id="8052035">uint8</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052042">out</span>&nbsp;&nbsp;<span class="builtintype" id="8052047">int</span><br>
<span class="lineno"></span><span class="op" id="8052051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8052054">var</span>&nbsp;<span class="ident" id="8052058">testConstandTimeByteEqData</span>&nbsp;<span class="op" id="8052085">=</span>&nbsp;<span class="op" id="8052087">[</span><span class="op" id="8052088">]</span><span class="ident" id="8052089"><a href="/crypto/subtle/constant_time_test.go.html#8051991">TestConstantTimeByteEqStruct</a></span><span class="op" id="8052117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052120">{</span><span class="num" id="8052121">0</span><span class="op" id="8052122">,</span>&nbsp;<span class="num" id="8052124">0</span><span class="op" id="8052125">,</span>&nbsp;<span class="num" id="8052127">1</span><span class="op" id="8052128">}</span><span class="op" id="8052129">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052132">{</span><span class="num" id="8052133">0</span><span class="op" id="8052134">,</span>&nbsp;<span class="num" id="8052136">1</span><span class="op" id="8052137">,</span>&nbsp;<span class="num" id="8052139">0</span><span class="op" id="8052140">}</span><span class="op" id="8052141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052144">{</span><span class="num" id="8052145">1</span><span class="op" id="8052146">,</span>&nbsp;<span class="num" id="8052148">0</span><span class="op" id="8052149">,</span>&nbsp;<span class="num" id="8052151">0</span><span class="op" id="8052152">}</span><span class="op" id="8052153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052156">{</span><span class="num" id="8052157">0xff</span><span class="op" id="8052161">,</span>&nbsp;<span class="num" id="8052163">0xff</span><span class="op" id="8052167">,</span>&nbsp;<span class="num" id="8052169">1</span><span class="op" id="8052170">}</span><span class="op" id="8052171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052174">{</span><span class="num" id="8052175">0xff</span><span class="op" id="8052179">,</span>&nbsp;<span class="num" id="8052181">0xfe</span><span class="op" id="8052185">,</span>&nbsp;<span class="num" id="8052187">0</span><span class="op" id="8052188">}</span><span class="op" id="8052189">,</span><br>
<span class="lineno"></span><span class="op" id="8052191">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8052194">func</span>&nbsp;<span class="ident" id="8052199">byteEq</span><span class="op" id="8052205">(</span><span class="ident" id="8052206">a</span><span class="op" id="8052207">,</span>&nbsp;<span class="ident" id="8052209">b</span>&nbsp;<span class="builtintype" id="8052211">uint8</span><span class="op" id="8052216">)</span>&nbsp;<span class="builtintype" id="8052218">int</span>&nbsp;<span class="op" id="8052222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052225">if</span>&nbsp;<span class="ident" id="8052228"><a href="/crypto/subtle/constant_time_test.go.html#8052206">a</a></span>&nbsp;<span class="op" id="8052230">==</span>&nbsp;<span class="ident" id="8052233"><a href="/crypto/subtle/constant_time_test.go.html#8052209">b</a></span>&nbsp;<span class="op" id="8052235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052239">return</span>&nbsp;<span class="num" id="8052246">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052249">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052252">return</span>&nbsp;<span class="num" id="8052259">0</span><br>
<span class="lineno"></span><span class="op" id="8052261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8052264">func</span>&nbsp;<span class="ident" id="8052269">TestConstantTimeByteEq</span><span class="op" id="8052291">(</span><span class="ident" id="8052292">t</span>&nbsp;<span class="op" id="8052294">*</span><span class="ident" id="8052295"><a href="/crypto/subtle/constant_time_test.go.html#8051408">testing</a></span><span class="op" id="8052302">.</span><span class="ident" id="8052303">T</span><span class="op" id="8052304">)</span>&nbsp;<span class="op" id="8052306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052309">for</span>&nbsp;<span class="ident" id="8052313">i</span><span class="op" id="8052314">,</span>&nbsp;<span class="ident" id="8052316">test</span>&nbsp;<span class="op" id="8052321">:=</span>&nbsp;<span class="keyword" id="8052324">range</span>&nbsp;<span class="ident" id="8052330"><a href="/crypto/subtle/constant_time_test.go.html#8052058">testConstandTimeByteEqData</a></span>&nbsp;<span class="op" id="8052357">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052361">if</span>&nbsp;<span class="ident" id="8052364">r</span>&nbsp;<span class="op" id="8052366">:=</span>&nbsp;<span class="ident" id="8052369"><a href="/crypto/subtle/constant_time.go.html#4084456">ConstantTimeByteEq</a></span><span class="op" id="8052387">(</span><span class="ident" id="8052388"><a href="/crypto/subtle/constant_time_test.go.html#8052316">test</a></span><span class="op" id="8052392">.</span><span class="ident" id="8052393">a</span><span class="op" id="8052394">,</span>&nbsp;<span class="ident" id="8052396"><a href="/crypto/subtle/constant_time_test.go.html#8052316">test</a></span><span class="op" id="8052400">.</span><span class="ident" id="8052401">b</span><span class="op" id="8052402">)</span><span class="op" id="8052403">;</span>&nbsp;<span class="ident" id="8052405"><a href="/crypto/subtle/constant_time_test.go.html#8052364">r</a></span>&nbsp;<span class="op" id="8052407">!=</span>&nbsp;<span class="ident" id="8052410"><a href="/crypto/subtle/constant_time_test.go.html#8052316">test</a></span><span class="op" id="8052414">.</span><span class="ident" id="8052415">out</span>&nbsp;<span class="op" id="8052419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052424"><a href="/crypto/subtle/constant_time_test.go.html#8052292">t</a></span><span class="op" id="8052425">.</span><span class="ident" id="8052426">Errorf</span><span class="op" id="8052432">(</span><span class="string" id="8052433">&#34;#%d&nbsp;bad&nbsp;result&nbsp;(got&nbsp;%x,&nbsp;want&nbsp;%x)&#34;</span><span class="op" id="8052467">,</span>&nbsp;<span class="ident" id="8052469"><a href="/crypto/subtle/constant_time_test.go.html#8052313">i</a></span><span class="op" id="8052470">,</span>&nbsp;<span class="ident" id="8052472"><a href="/crypto/subtle/constant_time_test.go.html#8052364">r</a></span><span class="op" id="8052473">,</span>&nbsp;<span class="ident" id="8052475"><a href="/crypto/subtle/constant_time_test.go.html#8052316">test</a></span><span class="op" id="8052479">.</span><span class="ident" id="8052480">out</span><span class="op" id="8052483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052493">err</span>&nbsp;<span class="op" id="8052497">:=</span>&nbsp;<span class="ident" id="8052500"><a href="/crypto/subtle/constant_time_test.go.html#8051419">quick</a></span><span class="op" id="8052505">.</span><span class="ident" id="8052506">CheckEqual</span><span class="op" id="8052516">(</span><span class="ident" id="8052517"><a href="/crypto/subtle/constant_time.go.html#4084456">ConstantTimeByteEq</a></span><span class="op" id="8052535">,</span>&nbsp;<span class="ident" id="8052537"><a href="/crypto/subtle/constant_time_test.go.html#8052199">byteEq</a></span><span class="op" id="8052543">,</span>&nbsp;<span class="ident" id="8052545">nil</span><span class="op" id="8052548">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052551">if</span>&nbsp;<span class="ident" id="8052554"><a href="/crypto/subtle/constant_time_test.go.html#8052493">err</a></span>&nbsp;<span class="op" id="8052558">!=</span>&nbsp;<span class="ident" id="8052561">nil</span>&nbsp;<span class="op" id="8052565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052569"><a href="/crypto/subtle/constant_time_test.go.html#8052292">t</a></span><span class="op" id="8052570">.</span><span class="ident" id="8052571">Error</span><span class="op" id="8052576">(</span><span class="ident" id="8052577"><a href="/crypto/subtle/constant_time_test.go.html#8052493">err</a></span><span class="op" id="8052580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052583">}</span><br>
<span class="lineno"></span><span class="op" id="8052585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="8052588">func</span>&nbsp;<span class="ident" id="8052593">eq</span><span class="op" id="8052595">(</span><span class="ident" id="8052596">a</span><span class="op" id="8052597">,</span>&nbsp;<span class="ident" id="8052599">b</span>&nbsp;<span class="builtintype" id="8052601">int32</span><span class="op" id="8052606">)</span>&nbsp;<span class="builtintype" id="8052608">int</span>&nbsp;<span class="op" id="8052612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052615">if</span>&nbsp;<span class="ident" id="8052618"><a href="/crypto/subtle/constant_time_test.go.html#8052596">a</a></span>&nbsp;<span class="op" id="8052620">==</span>&nbsp;<span class="ident" id="8052623"><a href="/crypto/subtle/constant_time_test.go.html#8052599">b</a></span>&nbsp;<span class="op" id="8052625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052629">return</span>&nbsp;<span class="num" id="8052636">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052642">return</span>&nbsp;<span class="num" id="8052649">0</span><br>
<span class="lineno">70</span><span class="op" id="8052651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8052654">func</span>&nbsp;<span class="ident" id="8052659">TestConstantTimeEq</span><span class="op" id="8052677">(</span><span class="ident" id="8052678">t</span>&nbsp;<span class="op" id="8052680">*</span><span class="ident" id="8052681"><a href="/crypto/subtle/constant_time_test.go.html#8051408">testing</a></span><span class="op" id="8052688">.</span><span class="ident" id="8052689">T</span><span class="op" id="8052690">)</span>&nbsp;<span class="op" id="8052692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052695">err</span>&nbsp;<span class="op" id="8052699">:=</span>&nbsp;<span class="ident" id="8052702"><a href="/crypto/subtle/constant_time_test.go.html#8051419">quick</a></span><span class="op" id="8052707">.</span><span class="ident" id="8052708">CheckEqual</span><span class="op" id="8052718">(</span><span class="ident" id="8052719"><a href="/crypto/subtle/constant_time.go.html#4084626">ConstantTimeEq</a></span><span class="op" id="8052733">,</span>&nbsp;<span class="ident" id="8052735"><a href="/crypto/subtle/constant_time_test.go.html#8052593">eq</a></span><span class="op" id="8052737">,</span>&nbsp;<span class="ident" id="8052739">nil</span><span class="op" id="8052742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052745">if</span>&nbsp;<span class="ident" id="8052748"><a href="/crypto/subtle/constant_time_test.go.html#8052695">err</a></span>&nbsp;<span class="op" id="8052752">!=</span>&nbsp;<span class="ident" id="8052755">nil</span>&nbsp;<span class="op" id="8052759">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052763"><a href="/crypto/subtle/constant_time_test.go.html#8052678">t</a></span><span class="op" id="8052764">.</span><span class="ident" id="8052765">Error</span><span class="op" id="8052770">(</span><span class="ident" id="8052771"><a href="/crypto/subtle/constant_time_test.go.html#8052695">err</a></span><span class="op" id="8052774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052777">}</span><br>
<span class="lineno"></span><span class="op" id="8052779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8052782">func</span>&nbsp;<span class="ident" id="8052787">makeCopy</span><span class="op" id="8052795">(</span><span class="ident" id="8052796">v</span>&nbsp;<span class="builtintype" id="8052798">int</span><span class="op" id="8052801">,</span>&nbsp;<span class="ident" id="8052803">x</span><span class="op" id="8052804">,</span>&nbsp;<span class="ident" id="8052806">y</span>&nbsp;<span class="op" id="8052808">[</span><span class="op" id="8052809">]</span><span class="builtintype" id="8052810">byte</span><span class="op" id="8052814">)</span>&nbsp;<span class="op" id="8052816">[</span><span class="op" id="8052817">]</span><span class="builtintype" id="8052818">byte</span>&nbsp;<span class="op" id="8052823">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052826">if</span>&nbsp;<span class="builtinfunc" id="8052829">len</span><span class="op" id="8052832">(</span><span class="ident" id="8052833"><a href="/crypto/subtle/constant_time_test.go.html#8052803">x</a></span><span class="op" id="8052834">)</span>&nbsp;<span class="op" id="8052836">&gt;</span>&nbsp;<span class="builtinfunc" id="8052838">len</span><span class="op" id="8052841">(</span><span class="ident" id="8052842"><a href="/crypto/subtle/constant_time_test.go.html#8052806">y</a></span><span class="op" id="8052843">)</span>&nbsp;<span class="op" id="8052845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052849"><a href="/crypto/subtle/constant_time_test.go.html#8052803">x</a></span>&nbsp;<span class="op" id="8052851">=</span>&nbsp;<span class="ident" id="8052853"><a href="/crypto/subtle/constant_time_test.go.html#8052803">x</a></span><span class="op" id="8052854">[</span><span class="num" id="8052855">0</span><span class="op" id="8052856">:</span><span class="builtinfunc" id="8052857">len</span><span class="op" id="8052860">(</span><span class="ident" id="8052861"><a href="/crypto/subtle/constant_time_test.go.html#8052806">y</a></span><span class="op" id="8052862">)</span><span class="op" id="8052863">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052866">}</span>&nbsp;<span class="keyword" id="8052868">else</span>&nbsp;<span class="op" id="8052873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8052877"><a href="/crypto/subtle/constant_time_test.go.html#8052806">y</a></span>&nbsp;<span class="op" id="8052879">=</span>&nbsp;<span class="ident" id="8052881"><a href="/crypto/subtle/constant_time_test.go.html#8052806">y</a></span><span class="op" id="8052882">[</span><span class="num" id="8052883">0</span><span class="op" id="8052884">:</span><span class="builtinfunc" id="8052885">len</span><span class="op" id="8052888">(</span><span class="ident" id="8052889"><a href="/crypto/subtle/constant_time_test.go.html#8052803">x</a></span><span class="op" id="8052890">)</span><span class="op" id="8052891">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052894">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052897">if</span>&nbsp;<span class="ident" id="8052900"><a href="/crypto/subtle/constant_time_test.go.html#8052796">v</a></span>&nbsp;<span class="op" id="8052902">==</span>&nbsp;<span class="num" id="8052905">1</span>&nbsp;<span class="op" id="8052907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8052911">copy</span><span class="op" id="8052915">(</span><span class="ident" id="8052916"><a href="/crypto/subtle/constant_time_test.go.html#8052803">x</a></span><span class="op" id="8052917">,</span>&nbsp;<span class="ident" id="8052919"><a href="/crypto/subtle/constant_time_test.go.html#8052806">y</a></span><span class="op" id="8052920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8052923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052926">return</span>&nbsp;<span class="ident" id="8052933"><a href="/crypto/subtle/constant_time_test.go.html#8052803">x</a></span><br>
<span class="lineno"></span><span class="op" id="8052935">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="8052938">func</span>&nbsp;<span class="ident" id="8052943">constantTimeCopyWrapper</span><span class="op" id="8052966">(</span><span class="ident" id="8052967">v</span>&nbsp;<span class="builtintype" id="8052969">int</span><span class="op" id="8052972">,</span>&nbsp;<span class="ident" id="8052974">x</span><span class="op" id="8052975">,</span>&nbsp;<span class="ident" id="8052977">y</span>&nbsp;<span class="op" id="8052979">[</span><span class="op" id="8052980">]</span><span class="builtintype" id="8052981">byte</span><span class="op" id="8052985">)</span>&nbsp;<span class="op" id="8052987">[</span><span class="op" id="8052988">]</span><span class="builtintype" id="8052989">byte</span>&nbsp;<span class="op" id="8052994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8052997">if</span>&nbsp;<span class="builtinfunc" id="8053000">len</span><span class="op" id="8053003">(</span><span class="ident" id="8053004"><a href="/crypto/subtle/constant_time_test.go.html#8052974">x</a></span><span class="op" id="8053005">)</span>&nbsp;<span class="op" id="8053007">&gt;</span>&nbsp;<span class="builtinfunc" id="8053009">len</span><span class="op" id="8053012">(</span><span class="ident" id="8053013"><a href="/crypto/subtle/constant_time_test.go.html#8052977">y</a></span><span class="op" id="8053014">)</span>&nbsp;<span class="op" id="8053016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053020"><a href="/crypto/subtle/constant_time_test.go.html#8052974">x</a></span>&nbsp;<span class="op" id="8053022">=</span>&nbsp;<span class="ident" id="8053024"><a href="/crypto/subtle/constant_time_test.go.html#8052974">x</a></span><span class="op" id="8053025">[</span><span class="num" id="8053026">0</span><span class="op" id="8053027">:</span><span class="builtinfunc" id="8053028">len</span><span class="op" id="8053031">(</span><span class="ident" id="8053032"><a href="/crypto/subtle/constant_time_test.go.html#8052977">y</a></span><span class="op" id="8053033">)</span><span class="op" id="8053034">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053037">}</span>&nbsp;<span class="keyword" id="8053039">else</span>&nbsp;<span class="op" id="8053044">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053048"><a href="/crypto/subtle/constant_time_test.go.html#8052977">y</a></span>&nbsp;<span class="op" id="8053050">=</span>&nbsp;<span class="ident" id="8053052"><a href="/crypto/subtle/constant_time_test.go.html#8052977">y</a></span><span class="op" id="8053053">[</span><span class="num" id="8053054">0</span><span class="op" id="8053055">:</span><span class="builtinfunc" id="8053056">len</span><span class="op" id="8053059">(</span><span class="ident" id="8053060"><a href="/crypto/subtle/constant_time_test.go.html#8052974">x</a></span><span class="op" id="8053061">)</span><span class="op" id="8053062">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053068"><a href="/crypto/subtle/constant_time_test.go.html#8052967">v</a></span>&nbsp;<span class="op" id="8053070">&amp;=</span>&nbsp;<span class="num" id="8053073">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053076"><a href="/crypto/subtle/constant_time.go.html#4084949">ConstantTimeCopy</a></span><span class="op" id="8053092">(</span><span class="ident" id="8053093"><a href="/crypto/subtle/constant_time_test.go.html#8052967">v</a></span><span class="op" id="8053094">,</span>&nbsp;<span class="ident" id="8053096"><a href="/crypto/subtle/constant_time_test.go.html#8052974">x</a></span><span class="op" id="8053097">,</span>&nbsp;<span class="ident" id="8053099"><a href="/crypto/subtle/constant_time_test.go.html#8052977">y</a></span><span class="op" id="8053100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8053103">return</span>&nbsp;<span class="ident" id="8053110"><a href="/crypto/subtle/constant_time_test.go.html#8052974">x</a></span><br>
<span class="lineno">100</span><span class="op" id="8053112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8053115">func</span>&nbsp;<span class="ident" id="8053120">TestConstantTimeCopy</span><span class="op" id="8053140">(</span><span class="ident" id="8053141">t</span>&nbsp;<span class="op" id="8053143">*</span><span class="ident" id="8053144"><a href="/crypto/subtle/constant_time_test.go.html#8051408">testing</a></span><span class="op" id="8053151">.</span><span class="ident" id="8053152">T</span><span class="op" id="8053153">)</span>&nbsp;<span class="op" id="8053155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053158">err</span>&nbsp;<span class="op" id="8053162">:=</span>&nbsp;<span class="ident" id="8053165"><a href="/crypto/subtle/constant_time_test.go.html#8051419">quick</a></span><span class="op" id="8053170">.</span><span class="ident" id="8053171">CheckEqual</span><span class="op" id="8053181">(</span><span class="ident" id="8053182"><a href="/crypto/subtle/constant_time_test.go.html#8052943">constantTimeCopyWrapper</a></span><span class="op" id="8053205">,</span>&nbsp;<span class="ident" id="8053207"><a href="/crypto/subtle/constant_time_test.go.html#8052787">makeCopy</a></span><span class="op" id="8053215">,</span>&nbsp;<span class="ident" id="8053217">nil</span><span class="op" id="8053220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8053223">if</span>&nbsp;<span class="ident" id="8053226"><a href="/crypto/subtle/constant_time_test.go.html#8053158">err</a></span>&nbsp;<span class="op" id="8053230">!=</span>&nbsp;<span class="ident" id="8053233">nil</span>&nbsp;<span class="op" id="8053237">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053241"><a href="/crypto/subtle/constant_time_test.go.html#8053141">t</a></span><span class="op" id="8053242">.</span><span class="ident" id="8053243">Error</span><span class="op" id="8053248">(</span><span class="ident" id="8053249"><a href="/crypto/subtle/constant_time_test.go.html#8053158">err</a></span><span class="op" id="8053252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053255">}</span><br>
<span class="lineno"></span><span class="op" id="8053257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8053260">var</span>&nbsp;<span class="ident" id="8053264">lessOrEqTests</span>&nbsp;<span class="op" id="8053278">=</span>&nbsp;<span class="op" id="8053280">[</span><span class="op" id="8053281">]</span><span class="keyword" id="8053282">struct</span>&nbsp;<span class="op" id="8053289">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053292">x</span><span class="op" id="8053293">,</span>&nbsp;<span class="ident" id="8053295">y</span><span class="op" id="8053296">,</span>&nbsp;<span class="ident" id="8053298">result</span>&nbsp;<span class="builtintype" id="8053305">int</span><br>
<span class="lineno"></span><span class="op" id="8053309">}</span><span class="op" id="8053310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053313">{</span><span class="num" id="8053314">0</span><span class="op" id="8053315">,</span>&nbsp;<span class="num" id="8053317">0</span><span class="op" id="8053318">,</span>&nbsp;<span class="num" id="8053320">1</span><span class="op" id="8053321">}</span><span class="op" id="8053322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053325">{</span><span class="num" id="8053326">1</span><span class="op" id="8053327">,</span>&nbsp;<span class="num" id="8053329">0</span><span class="op" id="8053330">,</span>&nbsp;<span class="num" id="8053332">0</span><span class="op" id="8053333">}</span><span class="op" id="8053334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053337">{</span><span class="num" id="8053338">0</span><span class="op" id="8053339">,</span>&nbsp;<span class="num" id="8053341">1</span><span class="op" id="8053342">,</span>&nbsp;<span class="num" id="8053344">1</span><span class="op" id="8053345">}</span><span class="op" id="8053346">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053349">{</span><span class="num" id="8053350">10</span><span class="op" id="8053352">,</span>&nbsp;<span class="num" id="8053354">20</span><span class="op" id="8053356">,</span>&nbsp;<span class="num" id="8053358">1</span><span class="op" id="8053359">}</span><span class="op" id="8053360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053363">{</span><span class="num" id="8053364">20</span><span class="op" id="8053366">,</span>&nbsp;<span class="num" id="8053368">10</span><span class="op" id="8053370">,</span>&nbsp;<span class="num" id="8053372">0</span><span class="op" id="8053373">}</span><span class="op" id="8053374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053377">{</span><span class="num" id="8053378">10</span><span class="op" id="8053380">,</span>&nbsp;<span class="num" id="8053382">10</span><span class="op" id="8053384">,</span>&nbsp;<span class="num" id="8053386">1</span><span class="op" id="8053387">}</span><span class="op" id="8053388">,</span><br>
<span class="lineno"></span><span class="op" id="8053390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="8053393">func</span>&nbsp;<span class="ident" id="8053398">TestConstantTimeLessOrEq</span><span class="op" id="8053422">(</span><span class="ident" id="8053423">t</span>&nbsp;<span class="op" id="8053425">*</span><span class="ident" id="8053426"><a href="/crypto/subtle/constant_time_test.go.html#8051408">testing</a></span><span class="op" id="8053433">.</span><span class="ident" id="8053434">T</span><span class="op" id="8053435">)</span>&nbsp;<span class="op" id="8053437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8053440">for</span>&nbsp;<span class="ident" id="8053444">i</span><span class="op" id="8053445">,</span>&nbsp;<span class="ident" id="8053447">test</span>&nbsp;<span class="op" id="8053452">:=</span>&nbsp;<span class="keyword" id="8053455">range</span>&nbsp;<span class="ident" id="8053461"><a href="/crypto/subtle/constant_time_test.go.html#8053264">lessOrEqTests</a></span>&nbsp;<span class="op" id="8053475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053479">result</span>&nbsp;<span class="op" id="8053486">:=</span>&nbsp;<span class="ident" id="8053489"><a href="/crypto/subtle/constant_time.go.html#4085315">ConstantTimeLessOrEq</a></span><span class="op" id="8053509">(</span><span class="ident" id="8053510"><a href="/crypto/subtle/constant_time_test.go.html#8053447">test</a></span><span class="op" id="8053514">.</span><span class="ident" id="8053515">x</span><span class="op" id="8053516">,</span>&nbsp;<span class="ident" id="8053518"><a href="/crypto/subtle/constant_time_test.go.html#8053447">test</a></span><span class="op" id="8053522">.</span><span class="ident" id="8053523">y</span><span class="op" id="8053524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8053528">if</span>&nbsp;<span class="ident" id="8053531"><a href="/crypto/subtle/constant_time_test.go.html#8053479">result</a></span>&nbsp;<span class="op" id="8053538">!=</span>&nbsp;<span class="ident" id="8053541"><a href="/crypto/subtle/constant_time_test.go.html#8053447">test</a></span><span class="op" id="8053545">.</span><span class="ident" id="8053546">result</span>&nbsp;<span class="op" id="8053553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8053558"><a href="/crypto/subtle/constant_time_test.go.html#8053423">t</a></span><span class="op" id="8053559">.</span><span class="ident" id="8053560">Errorf</span><span class="op" id="8053566">(</span><span class="string" id="8053567">&#34;#%d:&nbsp;%d&nbsp;&lt;=&nbsp;%d&nbsp;gave&nbsp;%d,&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8053603">,</span>&nbsp;<span class="ident" id="8053605"><a href="/crypto/subtle/constant_time_test.go.html#8053444">i</a></span><span class="op" id="8053606">,</span>&nbsp;<span class="ident" id="8053608"><a href="/crypto/subtle/constant_time_test.go.html#8053447">test</a></span><span class="op" id="8053612">.</span><span class="ident" id="8053613">x</span><span class="op" id="8053614">,</span>&nbsp;<span class="ident" id="8053616"><a href="/crypto/subtle/constant_time_test.go.html#8053447">test</a></span><span class="op" id="8053620">.</span><span class="ident" id="8053621">y</span><span class="op" id="8053622">,</span>&nbsp;<span class="ident" id="8053624"><a href="/crypto/subtle/constant_time_test.go.html#8053479">result</a></span><span class="op" id="8053630">,</span>&nbsp;<span class="ident" id="8053632"><a href="/crypto/subtle/constant_time_test.go.html#8053447">test</a></span><span class="op" id="8053636">.</span><span class="ident" id="8053637">result</span><span class="op" id="8053643">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8053650">}</span><br>
<span class="lineno"></span><span class="op" id="8053652">}</span>
</div>
</body>
</html>
