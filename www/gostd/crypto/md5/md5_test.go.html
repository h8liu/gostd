<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/md5</h2>
<ul>
<li><a href="/gostd/crypto/md5/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5.go.html">md5.go</a></li>
<li><a href="/gostd/crypto/md5/md5_test.go.html">md5_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5block.go.html">md5block.go</a></li>
<li><a href="/gostd/crypto/md5/md5block_decl.go.html">md5block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7022846">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7022901">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7022955">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7023006">package</span>&nbsp;<span class="ident" id="7023014">md5</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7023019">import</span>&nbsp;<span class="op" id="7023026">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7023029">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7023044">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7023051">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7023057">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7023068">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="7023077">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="7023080">type</span>&nbsp;<span class="ident" id="7023085">md5Test</span>&nbsp;<span class="keyword" id="7023093">struct</span>&nbsp;<span class="op" id="7023100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023103">out</span>&nbsp;<span class="builtintype" id="7023107">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7023115">in</span>&nbsp;&nbsp;<span class="builtintype" id="7023119">string</span><br>
<span class="lineno"></span><span class="op" id="7023126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7023129">var</span>&nbsp;<span class="ident" id="7023133">golden</span>&nbsp;<span class="op" id="7023140">=</span>&nbsp;<span class="op" id="7023142">[</span><span class="op" id="7023143">]</span><span class="ident" id="7023144">md5Test</span><span class="op" id="7023151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023154">{</span><span class="string" id="7023155">&#34;d41d8cd98f00b204e9800998ecf8427e&#34;</span><span class="op" id="7023189">,</span>&nbsp;<span class="string" id="7023191">&#34;&#34;</span><span class="op" id="7023193">}</span><span class="op" id="7023194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023197">{</span><span class="string" id="7023198">&#34;0cc175b9c0f1b6a831c399e269772661&#34;</span><span class="op" id="7023232">,</span>&nbsp;<span class="string" id="7023234">&#34;a&#34;</span><span class="op" id="7023237">}</span><span class="op" id="7023238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023241">{</span><span class="string" id="7023242">&#34;187ef4436122d1cc2f40dc2b92f0eba0&#34;</span><span class="op" id="7023276">,</span>&nbsp;<span class="string" id="7023278">&#34;ab&#34;</span><span class="op" id="7023282">}</span><span class="op" id="7023283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023286">{</span><span class="string" id="7023287">&#34;900150983cd24fb0d6963f7d28e17f72&#34;</span><span class="op" id="7023321">,</span>&nbsp;<span class="string" id="7023323">&#34;abc&#34;</span><span class="op" id="7023328">}</span><span class="op" id="7023329">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023332">{</span><span class="string" id="7023333">&#34;e2fc714c4727ee9395f324cd2e7f331f&#34;</span><span class="op" id="7023367">,</span>&nbsp;<span class="string" id="7023369">&#34;abcd&#34;</span><span class="op" id="7023375">}</span><span class="op" id="7023376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023379">{</span><span class="string" id="7023380">&#34;ab56b4d92b40713acc5af89985d4b786&#34;</span><span class="op" id="7023414">,</span>&nbsp;<span class="string" id="7023416">&#34;abcde&#34;</span><span class="op" id="7023423">}</span><span class="op" id="7023424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023427">{</span><span class="string" id="7023428">&#34;e80b5017098950fc58aad83c8c14978e&#34;</span><span class="op" id="7023462">,</span>&nbsp;<span class="string" id="7023464">&#34;abcdef&#34;</span><span class="op" id="7023472">}</span><span class="op" id="7023473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023476">{</span><span class="string" id="7023477">&#34;7ac66c0f148de9519b8bd264312c4d64&#34;</span><span class="op" id="7023511">,</span>&nbsp;<span class="string" id="7023513">&#34;abcdefg&#34;</span><span class="op" id="7023522">}</span><span class="op" id="7023523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023526">{</span><span class="string" id="7023527">&#34;e8dc4081b13434b45189a720b77b6818&#34;</span><span class="op" id="7023561">,</span>&nbsp;<span class="string" id="7023563">&#34;abcdefgh&#34;</span><span class="op" id="7023573">}</span><span class="op" id="7023574">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023577">{</span><span class="string" id="7023578">&#34;8aa99b1f439ff71293e95357bac6fd94&#34;</span><span class="op" id="7023612">,</span>&nbsp;<span class="string" id="7023614">&#34;abcdefghi&#34;</span><span class="op" id="7023625">}</span><span class="op" id="7023626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023629">{</span><span class="string" id="7023630">&#34;a925576942e94b2ef57a066101b48876&#34;</span><span class="op" id="7023664">,</span>&nbsp;<span class="string" id="7023666">&#34;abcdefghij&#34;</span><span class="op" id="7023678">}</span><span class="op" id="7023679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023682">{</span><span class="string" id="7023683">&#34;d747fc1719c7eacb84058196cfe56d57&#34;</span><span class="op" id="7023717">,</span>&nbsp;<span class="string" id="7023719">&#34;Discard&nbsp;medicine&nbsp;more&nbsp;than&nbsp;two&nbsp;years&nbsp;old.&#34;</span><span class="op" id="7023762">}</span><span class="op" id="7023763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023766">{</span><span class="string" id="7023767">&#34;bff2dcb37ef3a44ba43ab144768ca837&#34;</span><span class="op" id="7023801">,</span>&nbsp;<span class="string" id="7023803">&#34;He&nbsp;who&nbsp;has&nbsp;a&nbsp;shady&nbsp;past&nbsp;knows&nbsp;that&nbsp;nice&nbsp;guys&nbsp;finish&nbsp;last.&#34;</span><span class="op" id="7023862">}</span><span class="op" id="7023863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023866">{</span><span class="string" id="7023867">&#34;0441015ecb54a7342d017ed1bcfdbea5&#34;</span><span class="op" id="7023901">,</span>&nbsp;<span class="string" id="7023903">&#34;I&nbsp;wouldn&#39;t&nbsp;marry&nbsp;him&nbsp;with&nbsp;a&nbsp;ten&nbsp;foot&nbsp;pole.&#34;</span><span class="op" id="7023947">}</span><span class="op" id="7023948">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7023951">{</span><span class="string" id="7023952">&#34;9e3cac8e9e9757a60c3ea391130d3689&#34;</span><span class="op" id="7023986">,</span>&nbsp;<span class="string" id="7023988">&#34;Free!&nbsp;Free!/A&nbsp;trip/to&nbsp;Mars/for&nbsp;900/empty&nbsp;jars/Burma&nbsp;Shave&#34;</span><span class="op" id="7024047">}</span><span class="op" id="7024048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024051">{</span><span class="string" id="7024052">&#34;a0f04459b031f916a59a35cc482dc039&#34;</span><span class="op" id="7024086">,</span>&nbsp;<span class="string" id="7024088">&#34;The&nbsp;days&nbsp;of&nbsp;the&nbsp;digital&nbsp;watch&nbsp;are&nbsp;numbered.&nbsp;&nbsp;-Tom&nbsp;Stoppard&#34;</span><span class="op" id="7024148">}</span><span class="op" id="7024149">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024152">{</span><span class="string" id="7024153">&#34;e7a48e0fe884faf31475d2a04b1362cc&#34;</span><span class="op" id="7024187">,</span>&nbsp;<span class="string" id="7024189">&#34;Nepal&nbsp;premier&nbsp;won&#39;t&nbsp;resign.&#34;</span><span class="op" id="7024218">}</span><span class="op" id="7024219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024222">{</span><span class="string" id="7024223">&#34;637d2fe925c07c113800509964fb0e06&#34;</span><span class="op" id="7024257">,</span>&nbsp;<span class="string" id="7024259">&#34;For&nbsp;every&nbsp;action&nbsp;there&nbsp;is&nbsp;an&nbsp;equal&nbsp;and&nbsp;opposite&nbsp;government&nbsp;program.&#34;</span><span class="op" id="7024328">}</span><span class="op" id="7024329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024332">{</span><span class="string" id="7024333">&#34;834a8d18d5c6562119cf4c7f5086cb71&#34;</span><span class="op" id="7024367">,</span>&nbsp;<span class="string" id="7024369">&#34;His&nbsp;money&nbsp;is&nbsp;twice&nbsp;tainted:&nbsp;&#39;taint&nbsp;yours&nbsp;and&nbsp;&#39;taint&nbsp;mine.&#34;</span><span class="op" id="7024428">}</span><span class="op" id="7024429">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024432">{</span><span class="string" id="7024433">&#34;de3a4d2fd6c73ec2db2abad23b444281&#34;</span><span class="op" id="7024467">,</span>&nbsp;<span class="string" id="7024469">&#34;There&nbsp;is&nbsp;no&nbsp;reason&nbsp;for&nbsp;any&nbsp;individual&nbsp;to&nbsp;have&nbsp;a&nbsp;computer&nbsp;in&nbsp;their&nbsp;home.&nbsp;-Ken&nbsp;Olsen,&nbsp;1977&#34;</span><span class="op" id="7024559">}</span><span class="op" id="7024560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024563">{</span><span class="string" id="7024564">&#34;acf203f997e2cf74ea3aff86985aefaf&#34;</span><span class="op" id="7024598">,</span>&nbsp;<span class="string" id="7024600">&#34;It&#39;s&nbsp;a&nbsp;tiny&nbsp;change&nbsp;to&nbsp;the&nbsp;code&nbsp;and&nbsp;not&nbsp;completely&nbsp;disgusting.&nbsp;-&nbsp;Bob&nbsp;Manchek&#34;</span><span class="op" id="7024677">}</span><span class="op" id="7024678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024681">{</span><span class="string" id="7024682">&#34;e1c1384cb4d2221dfdd7c795a4222c9a&#34;</span><span class="op" id="7024716">,</span>&nbsp;<span class="string" id="7024718">&#34;size:&nbsp;&nbsp;a.out:&nbsp;&nbsp;bad&nbsp;magic&#34;</span><span class="op" id="7024744">}</span><span class="op" id="7024745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024748">{</span><span class="string" id="7024749">&#34;c90f3ddecc54f34228c063d7525bf644&#34;</span><span class="op" id="7024783">,</span>&nbsp;<span class="string" id="7024785">&#34;The&nbsp;major&nbsp;problem&nbsp;is&nbsp;with&nbsp;sendmail.&nbsp;&nbsp;-Mark&nbsp;Horton&#34;</span><span class="op" id="7024836">}</span><span class="op" id="7024837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024840">{</span><span class="string" id="7024841">&#34;cdf7ab6c1fd49bd9933c43f3ea5af185&#34;</span><span class="op" id="7024875">,</span>&nbsp;<span class="string" id="7024877">&#34;Give&nbsp;me&nbsp;a&nbsp;rock,&nbsp;paper&nbsp;and&nbsp;scissors&nbsp;and&nbsp;I&nbsp;will&nbsp;move&nbsp;the&nbsp;world.&nbsp;&nbsp;CCFestoon&#34;</span><span class="op" id="7024951">}</span><span class="op" id="7024952">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7024955">{</span><span class="string" id="7024956">&#34;83bc85234942fc883c063cbd7f0ad5d0&#34;</span><span class="op" id="7024990">,</span>&nbsp;<span class="string" id="7024992">&#34;If&nbsp;the&nbsp;enemy&nbsp;is&nbsp;within&nbsp;range,&nbsp;then&nbsp;so&nbsp;are&nbsp;you.&#34;</span><span class="op" id="7025040">}</span><span class="op" id="7025041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025044">{</span><span class="string" id="7025045">&#34;277cbe255686b48dd7e8f389394d9299&#34;</span><span class="op" id="7025079">,</span>&nbsp;<span class="string" id="7025081">&#34;It&#39;s&nbsp;well&nbsp;we&nbsp;cannot&nbsp;hear&nbsp;the&nbsp;screams/That&nbsp;we&nbsp;create&nbsp;in&nbsp;others&#39;&nbsp;dreams.&#34;</span><span class="op" id="7025153">}</span><span class="op" id="7025154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025157">{</span><span class="string" id="7025158">&#34;fd3fb0a7ffb8af16603f3d3af98f8e1f&#34;</span><span class="op" id="7025192">,</span>&nbsp;<span class="string" id="7025194">&#34;You&nbsp;remind&nbsp;me&nbsp;of&nbsp;a&nbsp;TV&nbsp;show,&nbsp;but&nbsp;that&#39;s&nbsp;all&nbsp;right:&nbsp;I&nbsp;watch&nbsp;it&nbsp;anyway.&#34;</span><span class="op" id="7025264">}</span><span class="op" id="7025265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025268">{</span><span class="string" id="7025269">&#34;469b13a78ebf297ecda64d4723655154&#34;</span><span class="op" id="7025303">,</span>&nbsp;<span class="string" id="7025305">&#34;C&nbsp;is&nbsp;as&nbsp;portable&nbsp;as&nbsp;Stonehedge!!&#34;</span><span class="op" id="7025339">}</span><span class="op" id="7025340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025343">{</span><span class="string" id="7025344">&#34;63eb3a2f466410104731c4b037600110&#34;</span><span class="op" id="7025378">,</span>&nbsp;<span class="string" id="7025380">&#34;Even&nbsp;if&nbsp;I&nbsp;could&nbsp;be&nbsp;Shakespeare,&nbsp;I&nbsp;think&nbsp;I&nbsp;should&nbsp;still&nbsp;choose&nbsp;to&nbsp;be&nbsp;Faraday.&nbsp;-&nbsp;A.&nbsp;Huxley&#34;</span><span class="op" id="7025470">}</span><span class="op" id="7025471">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025474">{</span><span class="string" id="7025475">&#34;72c2ed7592debca1c90fc0100f931a2f&#34;</span><span class="op" id="7025509">,</span>&nbsp;<span class="string" id="7025511">&#34;The&nbsp;fugacity&nbsp;of&nbsp;a&nbsp;constituent&nbsp;in&nbsp;a&nbsp;mixture&nbsp;of&nbsp;gases&nbsp;at&nbsp;a&nbsp;given&nbsp;temperature&nbsp;is&nbsp;proportional&nbsp;to&nbsp;its&nbsp;mole&nbsp;fraction.&nbsp;&nbsp;Lewis-Randall&nbsp;Rule&#34;</span><span class="op" id="7025645">}</span><span class="op" id="7025646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025649">{</span><span class="string" id="7025650">&#34;132f7619d33b523b1d9e5bd8e0928355&#34;</span><span class="op" id="7025684">,</span>&nbsp;<span class="string" id="7025686">&#34;How&nbsp;can&nbsp;you&nbsp;write&nbsp;a&nbsp;big&nbsp;system&nbsp;without&nbsp;C++?&nbsp;&nbsp;-Paul&nbsp;Glick&#34;</span><span class="op" id="7025744">}</span><span class="op" id="7025745">,</span><br>
<span class="lineno"></span><span class="op" id="7025747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7025750">func</span>&nbsp;<span class="ident" id="7025755">TestGolden</span><span class="op" id="7025765">(</span><span class="ident" id="7025766">t</span>&nbsp;<span class="op" id="7025768">*</span><span class="ident" id="7025769">testing</span><span class="op" id="7025776">.</span><span class="ident" id="7025777">T</span><span class="op" id="7025778">)</span>&nbsp;<span class="op" id="7025780">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7025783">for</span>&nbsp;<span class="ident" id="7025787">i</span>&nbsp;<span class="op" id="7025789">:=</span>&nbsp;<span class="num" id="7025792">0</span><span class="op" id="7025793">;</span>&nbsp;<span class="ident" id="7025795">i</span>&nbsp;<span class="op" id="7025797">&lt;</span>&nbsp;<span class="builtinfunc" id="7025799">len</span><span class="op" id="7025802">(</span><span class="ident" id="7025803">golden</span><span class="op" id="7025809">)</span><span class="op" id="7025810">;</span>&nbsp;<span class="ident" id="7025812">i</span><span class="op" id="7025813">++</span>&nbsp;<span class="op" id="7025816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7025820">g</span>&nbsp;<span class="op" id="7025822">:=</span>&nbsp;<span class="ident" id="7025825">golden</span><span class="op" id="7025831">[</span><span class="ident" id="7025832">i</span><span class="op" id="7025833">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7025837">s</span>&nbsp;<span class="op" id="7025839">:=</span>&nbsp;<span class="ident" id="7025842">fmt</span><span class="op" id="7025845">.</span><span class="ident" id="7025846">Sprintf</span><span class="op" id="7025853">(</span><span class="string" id="7025854">&#34;%x&#34;</span><span class="op" id="7025858">,</span>&nbsp;<span class="ident" id="7025860">Sum</span><span class="op" id="7025863">(</span><span class="op" id="7025864">[</span><span class="op" id="7025865">]</span><span class="builtintype" id="7025866">byte</span><span class="op" id="7025870">(</span><span class="ident" id="7025871">g</span><span class="op" id="7025872">.</span><span class="ident" id="7025873">in</span><span class="op" id="7025875">)</span><span class="op" id="7025876">)</span><span class="op" id="7025877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7025881">if</span>&nbsp;<span class="ident" id="7025884">s</span>&nbsp;<span class="op" id="7025886">!=</span>&nbsp;<span class="ident" id="7025889">g</span><span class="op" id="7025890">.</span><span class="ident" id="7025891">out</span>&nbsp;<span class="op" id="7025895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7025900">t</span><span class="op" id="7025901">.</span><span class="ident" id="7025902">Fatalf</span><span class="op" id="7025908">(</span><span class="string" id="7025909">&#34;Sum&nbsp;function:&nbsp;md5(%s)&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7025945">,</span>&nbsp;<span class="ident" id="7025947">g</span><span class="op" id="7025948">.</span><span class="ident" id="7025949">in</span><span class="op" id="7025951">,</span>&nbsp;<span class="ident" id="7025953">s</span><span class="op" id="7025954">,</span>&nbsp;<span class="ident" id="7025956">g</span><span class="op" id="7025957">.</span><span class="ident" id="7025958">out</span><span class="op" id="7025961">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7025965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7025969">c</span>&nbsp;<span class="op" id="7025971">:=</span>&nbsp;<span class="ident" id="7025974">New</span><span class="op" id="7025977">(</span><span class="op" id="7025978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7025982">buf</span>&nbsp;<span class="op" id="7025986">:=</span>&nbsp;<span class="builtinfunc" id="7025989">make</span><span class="op" id="7025993">(</span><span class="op" id="7025994">[</span><span class="op" id="7025995">]</span><span class="builtintype" id="7025996">byte</span><span class="op" id="7026000">,</span>&nbsp;<span class="builtinfunc" id="7026002">len</span><span class="op" id="7026005">(</span><span class="ident" id="7026006">g</span><span class="op" id="7026007">.</span><span class="ident" id="7026008">in</span><span class="op" id="7026010">)</span><span class="op" id="7026011">+</span><span class="num" id="7026012">4</span><span class="op" id="7026013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7026017">for</span>&nbsp;<span class="ident" id="7026021">j</span>&nbsp;<span class="op" id="7026023">:=</span>&nbsp;<span class="num" id="7026026">0</span><span class="op" id="7026027">;</span>&nbsp;<span class="ident" id="7026029">j</span>&nbsp;<span class="op" id="7026031">&lt;</span>&nbsp;<span class="num" id="7026033">3</span><span class="op" id="7026034">+</span><span class="num" id="7026035">4</span><span class="op" id="7026036">;</span>&nbsp;<span class="ident" id="7026038">j</span><span class="op" id="7026039">++</span>&nbsp;<span class="op" id="7026042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7026047">if</span>&nbsp;<span class="ident" id="7026050">j</span>&nbsp;<span class="op" id="7026052">&lt;</span>&nbsp;<span class="num" id="7026054">2</span>&nbsp;<span class="op" id="7026056">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026062">io</span><span class="op" id="7026064">.</span><span class="ident" id="7026065">WriteString</span><span class="op" id="7026076">(</span><span class="ident" id="7026077">c</span><span class="op" id="7026078">,</span>&nbsp;<span class="ident" id="7026080">g</span><span class="op" id="7026081">.</span><span class="ident" id="7026082">in</span><span class="op" id="7026084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026089">}</span>&nbsp;<span class="keyword" id="7026091">else</span>&nbsp;<span class="keyword" id="7026096">if</span>&nbsp;<span class="ident" id="7026099">j</span>&nbsp;<span class="op" id="7026101">==</span>&nbsp;<span class="num" id="7026104">2</span>&nbsp;<span class="op" id="7026106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026112">io</span><span class="op" id="7026114">.</span><span class="ident" id="7026115">WriteString</span><span class="op" id="7026126">(</span><span class="ident" id="7026127">c</span><span class="op" id="7026128">,</span>&nbsp;<span class="ident" id="7026130">g</span><span class="op" id="7026131">.</span><span class="ident" id="7026132">in</span><span class="op" id="7026134">[</span><span class="num" id="7026135">0</span><span class="op" id="7026136">:</span><span class="builtinfunc" id="7026137">len</span><span class="op" id="7026140">(</span><span class="ident" id="7026141">g</span><span class="op" id="7026142">.</span><span class="ident" id="7026143">in</span><span class="op" id="7026145">)</span><span class="op" id="7026146">/</span><span class="num" id="7026147">2</span><span class="op" id="7026148">]</span><span class="op" id="7026149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026155">c</span><span class="op" id="7026156">.</span><span class="ident" id="7026157">Sum</span><span class="op" id="7026160">(</span><span class="ident" id="7026161">nil</span><span class="op" id="7026164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026170">io</span><span class="op" id="7026172">.</span><span class="ident" id="7026173">WriteString</span><span class="op" id="7026184">(</span><span class="ident" id="7026185">c</span><span class="op" id="7026186">,</span>&nbsp;<span class="ident" id="7026188">g</span><span class="op" id="7026189">.</span><span class="ident" id="7026190">in</span><span class="op" id="7026192">[</span><span class="builtinfunc" id="7026193">len</span><span class="op" id="7026196">(</span><span class="ident" id="7026197">g</span><span class="op" id="7026198">.</span><span class="ident" id="7026199">in</span><span class="op" id="7026201">)</span><span class="op" id="7026202">/</span><span class="num" id="7026203">2</span><span class="op" id="7026204">:</span><span class="op" id="7026205">]</span><span class="op" id="7026206">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026211">}</span>&nbsp;<span class="keyword" id="7026213">else</span>&nbsp;<span class="keyword" id="7026218">if</span>&nbsp;<span class="ident" id="7026221">j</span>&nbsp;<span class="op" id="7026223">&gt;</span>&nbsp;<span class="num" id="7026225">2</span>&nbsp;<span class="op" id="7026227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7026233">//&nbsp;test&nbsp;unaligned&nbsp;write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026261">buf</span>&nbsp;<span class="op" id="7026265">=</span>&nbsp;<span class="ident" id="7026267">buf</span><span class="op" id="7026270">[</span><span class="num" id="7026271">1</span><span class="op" id="7026272">:</span><span class="op" id="7026273">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7026279">copy</span><span class="op" id="7026283">(</span><span class="ident" id="7026284">buf</span><span class="op" id="7026287">,</span>&nbsp;<span class="ident" id="7026289">g</span><span class="op" id="7026290">.</span><span class="ident" id="7026291">in</span><span class="op" id="7026293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026299">c</span><span class="op" id="7026300">.</span><span class="ident" id="7026301">Write</span><span class="op" id="7026306">(</span><span class="ident" id="7026307">buf</span><span class="op" id="7026310">[</span><span class="op" id="7026311">:</span><span class="builtinfunc" id="7026312">len</span><span class="op" id="7026315">(</span><span class="ident" id="7026316">g</span><span class="op" id="7026317">.</span><span class="ident" id="7026318">in</span><span class="op" id="7026320">)</span><span class="op" id="7026321">]</span><span class="op" id="7026322">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026332">s</span>&nbsp;<span class="op" id="7026334">:=</span>&nbsp;<span class="ident" id="7026337">fmt</span><span class="op" id="7026340">.</span><span class="ident" id="7026341">Sprintf</span><span class="op" id="7026348">(</span><span class="string" id="7026349">&#34;%x&#34;</span><span class="op" id="7026353">,</span>&nbsp;<span class="ident" id="7026355">c</span><span class="op" id="7026356">.</span><span class="ident" id="7026357">Sum</span><span class="op" id="7026360">(</span><span class="ident" id="7026361">nil</span><span class="op" id="7026364">)</span><span class="op" id="7026365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7026370">if</span>&nbsp;<span class="ident" id="7026373">s</span>&nbsp;<span class="op" id="7026375">!=</span>&nbsp;<span class="ident" id="7026378">g</span><span class="op" id="7026379">.</span><span class="ident" id="7026380">out</span>&nbsp;<span class="op" id="7026384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026390">t</span><span class="op" id="7026391">.</span><span class="ident" id="7026392">Fatalf</span><span class="op" id="7026398">(</span><span class="string" id="7026399">&#34;md5[%d](%s)&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7026425">,</span>&nbsp;<span class="ident" id="7026427">j</span><span class="op" id="7026428">,</span>&nbsp;<span class="ident" id="7026430">g</span><span class="op" id="7026431">.</span><span class="ident" id="7026432">in</span><span class="op" id="7026434">,</span>&nbsp;<span class="ident" id="7026436">s</span><span class="op" id="7026437">,</span>&nbsp;<span class="ident" id="7026439">g</span><span class="op" id="7026440">.</span><span class="ident" id="7026441">out</span><span class="op" id="7026444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026449">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026454">c</span><span class="op" id="7026455">.</span><span class="ident" id="7026456">Reset</span><span class="op" id="7026461">(</span><span class="op" id="7026462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026469">}</span><br>
<span class="lineno"></span><span class="op" id="7026471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="7026474">func</span>&nbsp;<span class="ident" id="7026479">TestLarge</span><span class="op" id="7026488">(</span><span class="ident" id="7026489">t</span>&nbsp;<span class="op" id="7026491">*</span><span class="ident" id="7026492">testing</span><span class="op" id="7026499">.</span><span class="ident" id="7026500">T</span><span class="op" id="7026501">)</span>&nbsp;<span class="op" id="7026503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7026506">const</span>&nbsp;<span class="ident" id="7026512">N</span>&nbsp;<span class="op" id="7026514">=</span>&nbsp;<span class="num" id="7026516">10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026523">ok</span>&nbsp;<span class="op" id="7026526">:=</span>&nbsp;<span class="string" id="7026529">&#34;2bb571599a4180e1d542f76904adc3df&#34;</span>&nbsp;<span class="comment" id="7026564">//&nbsp;md5sum&nbsp;of&nbsp;&#34;0123456789&#34;&nbsp;*&nbsp;1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026598">block</span>&nbsp;<span class="op" id="7026604">:=</span>&nbsp;<span class="builtinfunc" id="7026607">make</span><span class="op" id="7026611">(</span><span class="op" id="7026612">[</span><span class="op" id="7026613">]</span><span class="builtintype" id="7026614">byte</span><span class="op" id="7026618">,</span>&nbsp;<span class="num" id="7026620">10004</span><span class="op" id="7026625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026628">c</span>&nbsp;<span class="op" id="7026630">:=</span>&nbsp;<span class="ident" id="7026633">New</span><span class="op" id="7026636">(</span><span class="op" id="7026637">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7026640">for</span>&nbsp;<span class="ident" id="7026644">offset</span>&nbsp;<span class="op" id="7026651">:=</span>&nbsp;<span class="num" id="7026654">0</span><span class="op" id="7026655">;</span>&nbsp;<span class="ident" id="7026657">offset</span>&nbsp;<span class="op" id="7026664">&lt;</span>&nbsp;<span class="num" id="7026666">4</span><span class="op" id="7026667">;</span>&nbsp;<span class="ident" id="7026669">offset</span><span class="op" id="7026675">++</span>&nbsp;<span class="op" id="7026678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7026682">for</span>&nbsp;<span class="ident" id="7026686">i</span>&nbsp;<span class="op" id="7026688">:=</span>&nbsp;<span class="num" id="7026691">0</span><span class="op" id="7026692">;</span>&nbsp;<span class="ident" id="7026694">i</span>&nbsp;<span class="op" id="7026696">&lt;</span>&nbsp;<span class="ident" id="7026698">N</span><span class="op" id="7026699">;</span>&nbsp;<span class="ident" id="7026701">i</span><span class="op" id="7026702">++</span>&nbsp;<span class="op" id="7026705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026710">block</span><span class="op" id="7026715">[</span><span class="ident" id="7026716">offset</span><span class="op" id="7026722">+</span><span class="ident" id="7026723">i</span><span class="op" id="7026724">]</span>&nbsp;<span class="op" id="7026726">=</span>&nbsp;<span class="string" id="7026728">&#39;0&#39;</span>&nbsp;<span class="op" id="7026732">+</span>&nbsp;<span class="builtintype" id="7026734">byte</span><span class="op" id="7026738">(</span><span class="ident" id="7026739">i</span><span class="op" id="7026740">%</span><span class="num" id="7026741">10</span><span class="op" id="7026743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7026751">for</span>&nbsp;<span class="ident" id="7026755">blockSize</span>&nbsp;<span class="op" id="7026765">:=</span>&nbsp;<span class="num" id="7026768">10</span><span class="op" id="7026770">;</span>&nbsp;<span class="ident" id="7026772">blockSize</span>&nbsp;<span class="op" id="7026782">&lt;=</span>&nbsp;<span class="ident" id="7026785">N</span><span class="op" id="7026786">;</span>&nbsp;<span class="ident" id="7026788">blockSize</span>&nbsp;<span class="op" id="7026798">*=</span>&nbsp;<span class="num" id="7026801">10</span>&nbsp;<span class="op" id="7026804">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026809">blocks</span>&nbsp;<span class="op" id="7026816">:=</span>&nbsp;<span class="ident" id="7026819">N</span>&nbsp;<span class="op" id="7026821">/</span>&nbsp;<span class="ident" id="7026823">blockSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026836">b</span>&nbsp;<span class="op" id="7026838">:=</span>&nbsp;<span class="ident" id="7026841">block</span><span class="op" id="7026846">[</span><span class="ident" id="7026847">offset</span>&nbsp;<span class="op" id="7026854">:</span>&nbsp;<span class="ident" id="7026856">offset</span><span class="op" id="7026862">+</span><span class="ident" id="7026863">blockSize</span><span class="op" id="7026872">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026877">c</span><span class="op" id="7026878">.</span><span class="ident" id="7026879">Reset</span><span class="op" id="7026884">(</span><span class="op" id="7026885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7026890">for</span>&nbsp;<span class="ident" id="7026894">i</span>&nbsp;<span class="op" id="7026896">:=</span>&nbsp;<span class="num" id="7026899">0</span><span class="op" id="7026900">;</span>&nbsp;<span class="ident" id="7026902">i</span>&nbsp;<span class="op" id="7026904">&lt;</span>&nbsp;<span class="ident" id="7026906">blocks</span><span class="op" id="7026912">;</span>&nbsp;<span class="ident" id="7026914">i</span><span class="op" id="7026915">++</span>&nbsp;<span class="op" id="7026918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026924">c</span><span class="op" id="7026925">.</span><span class="ident" id="7026926">Write</span><span class="op" id="7026931">(</span><span class="ident" id="7026932">b</span><span class="op" id="7026933">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7026938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026943">s</span>&nbsp;<span class="op" id="7026945">:=</span>&nbsp;<span class="ident" id="7026948">fmt</span><span class="op" id="7026951">.</span><span class="ident" id="7026952">Sprintf</span><span class="op" id="7026959">(</span><span class="string" id="7026960">&#34;%x&#34;</span><span class="op" id="7026964">,</span>&nbsp;<span class="ident" id="7026966">c</span><span class="op" id="7026967">.</span><span class="ident" id="7026968">Sum</span><span class="op" id="7026971">(</span><span class="ident" id="7026972">nil</span><span class="op" id="7026975">)</span><span class="op" id="7026976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7026981">if</span>&nbsp;<span class="ident" id="7026984">s</span>&nbsp;<span class="op" id="7026986">!=</span>&nbsp;<span class="ident" id="7026989">ok</span>&nbsp;<span class="op" id="7026992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7026998">t</span><span class="op" id="7026999">.</span><span class="ident" id="7027000">Fatalf</span><span class="op" id="7027006">(</span><span class="string" id="7027007">&#34;md5&nbsp;TestLarge&nbsp;offset=%d,&nbsp;blockSize=%d&nbsp;=&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7027059">,</span>&nbsp;<span class="ident" id="7027061">offset</span><span class="op" id="7027067">,</span>&nbsp;<span class="ident" id="7027069">blockSize</span><span class="op" id="7027078">,</span>&nbsp;<span class="ident" id="7027080">s</span><span class="op" id="7027081">,</span>&nbsp;<span class="ident" id="7027083">ok</span><span class="op" id="7027085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027090">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027097">}</span><br>
<span class="lineno"></span><span class="op" id="7027099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7027102">//&nbsp;Tests&nbsp;that&nbsp;blockGeneric&nbsp;(pure&nbsp;Go)&nbsp;and&nbsp;block&nbsp;(in&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;arm)&nbsp;match.</span><br>
<span class="lineno">110</span><span class="keyword" id="7027190">func</span>&nbsp;<span class="ident" id="7027195">TestBlockGeneric</span><span class="op" id="7027211">(</span><span class="ident" id="7027212">t</span>&nbsp;<span class="op" id="7027214">*</span><span class="ident" id="7027215">testing</span><span class="op" id="7027222">.</span><span class="ident" id="7027223">T</span><span class="op" id="7027224">)</span>&nbsp;<span class="op" id="7027226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027229">gen</span><span class="op" id="7027232">,</span>&nbsp;<span class="ident" id="7027234">asm</span>&nbsp;<span class="op" id="7027238">:=</span>&nbsp;<span class="ident" id="7027241">New</span><span class="op" id="7027244">(</span><span class="op" id="7027245">)</span><span class="op" id="7027246">.</span><span class="op" id="7027247">(</span><span class="op" id="7027248">*</span><span class="ident" id="7027249">digest</span><span class="op" id="7027255">)</span><span class="op" id="7027256">,</span>&nbsp;<span class="ident" id="7027258">New</span><span class="op" id="7027261">(</span><span class="op" id="7027262">)</span><span class="op" id="7027263">.</span><span class="op" id="7027264">(</span><span class="op" id="7027265">*</span><span class="ident" id="7027266">digest</span><span class="op" id="7027272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027275">buf</span>&nbsp;<span class="op" id="7027279">:=</span>&nbsp;<span class="builtinfunc" id="7027282">make</span><span class="op" id="7027286">(</span><span class="op" id="7027287">[</span><span class="op" id="7027288">]</span><span class="builtintype" id="7027289">byte</span><span class="op" id="7027293">,</span>&nbsp;<span class="ident" id="7027295">BlockSize</span><span class="op" id="7027304">*</span><span class="num" id="7027305">20</span><span class="op" id="7027307">)</span>&nbsp;<span class="comment" id="7027309">//&nbsp;arbitrary&nbsp;factor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027330">rand</span><span class="op" id="7027334">.</span><span class="ident" id="7027335">Read</span><span class="op" id="7027339">(</span><span class="ident" id="7027340">buf</span><span class="op" id="7027343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027346">blockGeneric</span><span class="op" id="7027358">(</span><span class="ident" id="7027359">gen</span><span class="op" id="7027362">,</span>&nbsp;<span class="ident" id="7027364">buf</span><span class="op" id="7027367">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027370">block</span><span class="op" id="7027375">(</span><span class="ident" id="7027376">asm</span><span class="op" id="7027379">,</span>&nbsp;<span class="ident" id="7027381">buf</span><span class="op" id="7027384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7027387">if</span>&nbsp;<span class="op" id="7027390">*</span><span class="ident" id="7027391">gen</span>&nbsp;<span class="op" id="7027395">!=</span>&nbsp;<span class="op" id="7027398">*</span><span class="ident" id="7027399">asm</span>&nbsp;<span class="op" id="7027403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027407">t</span><span class="op" id="7027408">.</span><span class="ident" id="7027409">Error</span><span class="op" id="7027414">(</span><span class="string" id="7027415">&#34;block&nbsp;and&nbsp;blockGeneric&nbsp;resulted&nbsp;in&nbsp;different&nbsp;states&#34;</span><span class="op" id="7027468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027471">}</span><br>
<span class="lineno"></span><span class="op" id="7027473">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7027476">var</span>&nbsp;<span class="ident" id="7027480">bench</span>&nbsp;<span class="op" id="7027486">=</span>&nbsp;<span class="ident" id="7027488">New</span><span class="op" id="7027491">(</span><span class="op" id="7027492">)</span><br>
<span class="lineno"></span><span class="keyword" id="7027494">var</span>&nbsp;<span class="ident" id="7027498">buf</span>&nbsp;<span class="op" id="7027502">=</span>&nbsp;<span class="builtinfunc" id="7027504">make</span><span class="op" id="7027508">(</span><span class="op" id="7027509">[</span><span class="op" id="7027510">]</span><span class="builtintype" id="7027511">byte</span><span class="op" id="7027515">,</span>&nbsp;<span class="num" id="7027517">8192</span><span class="op" id="7027521">+</span><span class="num" id="7027522">1</span><span class="op" id="7027523">)</span><br>
<span class="lineno"></span><span class="keyword" id="7027525">var</span>&nbsp;<span class="ident" id="7027529">sum</span>&nbsp;<span class="op" id="7027533">=</span>&nbsp;<span class="builtinfunc" id="7027535">make</span><span class="op" id="7027539">(</span><span class="op" id="7027540">[</span><span class="op" id="7027541">]</span><span class="builtintype" id="7027542">byte</span><span class="op" id="7027546">,</span>&nbsp;<span class="ident" id="7027548">bench</span><span class="op" id="7027553">.</span><span class="ident" id="7027554">Size</span><span class="op" id="7027558">(</span><span class="op" id="7027559">)</span><span class="op" id="7027560">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="7027563">func</span>&nbsp;<span class="ident" id="7027568">benchmarkSize</span><span class="op" id="7027581">(</span><span class="ident" id="7027582">b</span>&nbsp;<span class="op" id="7027584">*</span><span class="ident" id="7027585">testing</span><span class="op" id="7027592">.</span><span class="ident" id="7027593">B</span><span class="op" id="7027594">,</span>&nbsp;<span class="ident" id="7027596">size</span>&nbsp;<span class="builtintype" id="7027601">int</span><span class="op" id="7027604">,</span>&nbsp;<span class="ident" id="7027606">unaligned</span>&nbsp;<span class="builtintype" id="7027616">bool</span><span class="op" id="7027620">)</span>&nbsp;<span class="op" id="7027622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027625">b</span><span class="op" id="7027626">.</span><span class="ident" id="7027627">SetBytes</span><span class="op" id="7027635">(</span><span class="ident" id="7027636">int64</span><span class="op" id="7027641">(</span><span class="ident" id="7027642">size</span><span class="op" id="7027646">)</span><span class="op" id="7027647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027650">buf</span>&nbsp;<span class="op" id="7027654">:=</span>&nbsp;<span class="ident" id="7027657">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7027662">if</span>&nbsp;<span class="ident" id="7027665">unaligned</span>&nbsp;<span class="op" id="7027675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7027679">if</span>&nbsp;<span class="builtintype" id="7027682">uintptr</span><span class="op" id="7027689">(</span><span class="ident" id="7027690">unsafe</span><span class="op" id="7027696">.</span><span class="ident" id="7027697">Pointer</span><span class="op" id="7027704">(</span><span class="op" id="7027705">&amp;</span><span class="ident" id="7027706">buf</span><span class="op" id="7027709">[</span><span class="num" id="7027710">0</span><span class="op" id="7027711">]</span><span class="op" id="7027712">)</span><span class="op" id="7027713">)</span><span class="op" id="7027714">&amp;</span><span class="op" id="7027715">(</span><span class="ident" id="7027716">unsafe</span><span class="op" id="7027722">.</span><span class="ident" id="7027723">Alignof</span><span class="op" id="7027730">(</span><span class="builtintype" id="7027731">uint32</span><span class="op" id="7027737">(</span><span class="num" id="7027738">0</span><span class="op" id="7027739">)</span><span class="op" id="7027740">)</span><span class="op" id="7027741">-</span><span class="num" id="7027742">1</span><span class="op" id="7027743">)</span>&nbsp;<span class="op" id="7027745">==</span>&nbsp;<span class="num" id="7027748">0</span>&nbsp;<span class="op" id="7027750">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027755">buf</span>&nbsp;<span class="op" id="7027759">=</span>&nbsp;<span class="ident" id="7027761">buf</span><span class="op" id="7027764">[</span><span class="num" id="7027765">1</span><span class="op" id="7027766">:</span><span class="op" id="7027767">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027777">b</span><span class="op" id="7027778">.</span><span class="ident" id="7027779">ResetTimer</span><span class="op" id="7027789">(</span><span class="op" id="7027790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7027793">for</span>&nbsp;<span class="ident" id="7027797">i</span>&nbsp;<span class="op" id="7027799">:=</span>&nbsp;<span class="num" id="7027802">0</span><span class="op" id="7027803">;</span>&nbsp;<span class="ident" id="7027805">i</span>&nbsp;<span class="op" id="7027807">&lt;</span>&nbsp;<span class="ident" id="7027809">b</span><span class="op" id="7027810">.</span><span class="ident" id="7027811">N</span><span class="op" id="7027812">;</span>&nbsp;<span class="ident" id="7027814">i</span><span class="op" id="7027815">++</span>&nbsp;<span class="op" id="7027818">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027822">bench</span><span class="op" id="7027827">.</span><span class="ident" id="7027828">Reset</span><span class="op" id="7027833">(</span><span class="op" id="7027834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027838">bench</span><span class="op" id="7027843">.</span><span class="ident" id="7027844">Write</span><span class="op" id="7027849">(</span><span class="ident" id="7027850">buf</span><span class="op" id="7027853">[</span><span class="op" id="7027854">:</span><span class="ident" id="7027855">size</span><span class="op" id="7027859">]</span><span class="op" id="7027860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027864">bench</span><span class="op" id="7027869">.</span><span class="ident" id="7027870">Sum</span><span class="op" id="7027873">(</span><span class="ident" id="7027874">sum</span><span class="op" id="7027877">[</span><span class="op" id="7027878">:</span><span class="num" id="7027879">0</span><span class="op" id="7027880">]</span><span class="op" id="7027881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7027884">}</span><br>
<span class="lineno"></span><span class="op" id="7027886">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7027889">func</span>&nbsp;<span class="ident" id="7027894">BenchmarkHash8Bytes</span><span class="op" id="7027913">(</span><span class="ident" id="7027914">b</span>&nbsp;<span class="op" id="7027916">*</span><span class="ident" id="7027917">testing</span><span class="op" id="7027924">.</span><span class="ident" id="7027925">B</span><span class="op" id="7027926">)</span>&nbsp;<span class="op" id="7027928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027931">benchmarkSize</span><span class="op" id="7027944">(</span><span class="ident" id="7027945">b</span><span class="op" id="7027946">,</span>&nbsp;<span class="num" id="7027948">8</span><span class="op" id="7027949">,</span>&nbsp;<span class="builtintype" id="7027951">false</span><span class="op" id="7027956">)</span><br>
<span class="lineno"></span><span class="op" id="7027958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="keyword" id="7027961">func</span>&nbsp;<span class="ident" id="7027966">BenchmarkHash1K</span><span class="op" id="7027981">(</span><span class="ident" id="7027982">b</span>&nbsp;<span class="op" id="7027984">*</span><span class="ident" id="7027985">testing</span><span class="op" id="7027992">.</span><span class="ident" id="7027993">B</span><span class="op" id="7027994">)</span>&nbsp;<span class="op" id="7027996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7027999">benchmarkSize</span><span class="op" id="7028012">(</span><span class="ident" id="7028013">b</span><span class="op" id="7028014">,</span>&nbsp;<span class="num" id="7028016">1024</span><span class="op" id="7028020">,</span>&nbsp;<span class="builtintype" id="7028022">false</span><span class="op" id="7028027">)</span><br>
<span class="lineno"></span><span class="op" id="7028029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7028032">func</span>&nbsp;<span class="ident" id="7028037">BenchmarkHash8K</span><span class="op" id="7028052">(</span><span class="ident" id="7028053">b</span>&nbsp;<span class="op" id="7028055">*</span><span class="ident" id="7028056">testing</span><span class="op" id="7028063">.</span><span class="ident" id="7028064">B</span><span class="op" id="7028065">)</span>&nbsp;<span class="op" id="7028067">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7028070">benchmarkSize</span><span class="op" id="7028083">(</span><span class="ident" id="7028084">b</span><span class="op" id="7028085">,</span>&nbsp;<span class="num" id="7028087">8192</span><span class="op" id="7028091">,</span>&nbsp;<span class="builtintype" id="7028093">false</span><span class="op" id="7028098">)</span><br>
<span class="lineno"></span><span class="op" id="7028100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7028103">func</span>&nbsp;<span class="ident" id="7028108">BenchmarkHash8BytesUnaligned</span><span class="op" id="7028136">(</span><span class="ident" id="7028137">b</span>&nbsp;<span class="op" id="7028139">*</span><span class="ident" id="7028140">testing</span><span class="op" id="7028147">.</span><span class="ident" id="7028148">B</span><span class="op" id="7028149">)</span>&nbsp;<span class="op" id="7028151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7028154">benchmarkSize</span><span class="op" id="7028167">(</span><span class="ident" id="7028168">b</span><span class="op" id="7028169">,</span>&nbsp;<span class="num" id="7028171">8</span><span class="op" id="7028172">,</span>&nbsp;<span class="builtintype" id="7028174">true</span><span class="op" id="7028178">)</span><br>
<span class="lineno">155</span><span class="op" id="7028180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7028183">func</span>&nbsp;<span class="ident" id="7028188">BenchmarkHash1KUnaligned</span><span class="op" id="7028212">(</span><span class="ident" id="7028213">b</span>&nbsp;<span class="op" id="7028215">*</span><span class="ident" id="7028216">testing</span><span class="op" id="7028223">.</span><span class="ident" id="7028224">B</span><span class="op" id="7028225">)</span>&nbsp;<span class="op" id="7028227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7028230">benchmarkSize</span><span class="op" id="7028243">(</span><span class="ident" id="7028244">b</span><span class="op" id="7028245">,</span>&nbsp;<span class="num" id="7028247">1024</span><span class="op" id="7028251">,</span>&nbsp;<span class="builtintype" id="7028253">true</span><span class="op" id="7028257">)</span><br>
<span class="lineno"></span><span class="op" id="7028259">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="7028262">func</span>&nbsp;<span class="ident" id="7028267">BenchmarkHash8KUnaligned</span><span class="op" id="7028291">(</span><span class="ident" id="7028292">b</span>&nbsp;<span class="op" id="7028294">*</span><span class="ident" id="7028295">testing</span><span class="op" id="7028302">.</span><span class="ident" id="7028303">B</span><span class="op" id="7028304">)</span>&nbsp;<span class="op" id="7028306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7028309">benchmarkSize</span><span class="op" id="7028322">(</span><span class="ident" id="7028323">b</span><span class="op" id="7028324">,</span>&nbsp;<span class="num" id="7028326">8192</span><span class="op" id="7028330">,</span>&nbsp;<span class="builtintype" id="7028332">true</span><span class="op" id="7028336">)</span><br>
<span class="lineno"></span><span class="op" id="7028338">}</span>
</div>
</body>
</html>
