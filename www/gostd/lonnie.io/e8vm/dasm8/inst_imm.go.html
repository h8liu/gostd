<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/dasm8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/dasm.go.html">dasm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/line.go.html">line.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/dasm8/reg.go.html">reg.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="5537054">package</span>&nbsp;<span class="ident" id="5537062">dasm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5537069">import</span>&nbsp;<span class="op" id="5537076">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5537079">&#34;fmt&#34;</span><br>
<span class="lineno">5</span><span class="op" id="5537085">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5537088">var</span>&nbsp;<span class="op" id="5537092">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537095">opImsMap</span>&nbsp;<span class="op" id="5537104">=</span>&nbsp;<span class="keyword" id="5537106">map</span><span class="op" id="5537109">[</span><span class="builtintype" id="5537110">uint32</span><span class="op" id="5537116">]</span><span class="builtintype" id="5537117">string</span><span class="op" id="5537123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5537127">1</span><span class="op" id="5537128">:</span>&nbsp;<span class="string" id="5537130">&#34;addi&#34;</span><span class="op" id="5537136">,</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5537140">2</span><span class="op" id="5537141">:</span>&nbsp;<span class="string" id="5537143">&#34;slti&#34;</span><span class="op" id="5537149">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5537152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537156">opMemMap</span>&nbsp;<span class="op" id="5537165">=</span>&nbsp;<span class="keyword" id="5537167">map</span><span class="op" id="5537170">[</span><span class="builtintype" id="5537171">uint32</span><span class="op" id="5537177">]</span><span class="builtintype" id="5537178">string</span><span class="op" id="5537184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5537188">6</span><span class="op" id="5537189">:</span>&nbsp;&nbsp;<span class="string" id="5537192">&#34;lw&#34;</span><span class="op" id="5537196">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5537200">7</span><span class="op" id="5537201">:</span>&nbsp;&nbsp;<span class="string" id="5537204">&#34;lb&#34;</span><span class="op" id="5537208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5537212">8</span><span class="op" id="5537213">:</span>&nbsp;&nbsp;<span class="string" id="5537216">&#34;lbu&#34;</span><span class="op" id="5537221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5537225">9</span><span class="op" id="5537226">:</span>&nbsp;&nbsp;<span class="string" id="5537229">&#34;sw&#34;</span><span class="op" id="5537233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5537237">10</span><span class="op" id="5537239">:</span>&nbsp;<span class="string" id="5537241">&#34;sb&#34;</span><span class="op" id="5537245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5537248">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537252">opImuMap</span>&nbsp;<span class="op" id="5537261">=</span>&nbsp;<span class="keyword" id="5537263">map</span><span class="op" id="5537266">[</span><span class="builtintype" id="5537267">uint32</span><span class="op" id="5537273">]</span><span class="builtintype" id="5537274">string</span><span class="op" id="5537280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5537284">3</span><span class="op" id="5537285">:</span>&nbsp;<span class="string" id="5537287">&#34;andi&#34;</span><span class="op" id="5537293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5537297">4</span><span class="op" id="5537298">:</span>&nbsp;<span class="string" id="5537300">&#34;ori&#34;</span><span class="op" id="5537305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5537308">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537312">opImu2Map</span>&nbsp;<span class="op" id="5537322">=</span>&nbsp;<span class="keyword" id="5537324">map</span><span class="op" id="5537327">[</span><span class="builtintype" id="5537328">uint32</span><span class="op" id="5537334">]</span><span class="builtintype" id="5537335">string</span><span class="op" id="5537341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="5537345">5</span><span class="op" id="5537346">:</span>&nbsp;<span class="string" id="5537348">&#34;lui&#34;</span><span class="op" id="5537353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5537356">}</span><br>
<span class="lineno"></span><span class="op" id="5537358">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="5537361">func</span>&nbsp;<span class="ident" id="5537366">instImm</span><span class="op" id="5537373">(</span><span class="ident" id="5537374">addr</span>&nbsp;<span class="builtintype" id="5537379">uint32</span><span class="op" id="5537385">,</span>&nbsp;<span class="ident" id="5537387">in</span>&nbsp;<span class="builtintype" id="5537390">uint32</span><span class="op" id="5537396">)</span>&nbsp;<span class="op" id="5537398">*</span><span class="ident" id="5537399">Line</span>&nbsp;<span class="op" id="5537404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537407">op</span>&nbsp;<span class="op" id="5537410">:=</span>&nbsp;<span class="op" id="5537413">(</span><span class="ident" id="5537414">in</span>&nbsp;<span class="op" id="5537417">&gt;&gt;</span>&nbsp;<span class="num" id="5537420">24</span><span class="op" id="5537422">)</span>&nbsp;<span class="op" id="5537424">&amp;</span>&nbsp;<span class="num" id="5537426">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537432">dest</span>&nbsp;<span class="op" id="5537437">:=</span>&nbsp;<span class="ident" id="5537440">regStr</span><span class="op" id="5537446">(</span><span class="op" id="5537447">(</span><span class="ident" id="5537448">in</span>&nbsp;<span class="op" id="5537451">&gt;&gt;</span>&nbsp;<span class="num" id="5537454">21</span><span class="op" id="5537456">)</span>&nbsp;<span class="op" id="5537458">&amp;</span>&nbsp;<span class="num" id="5537460">0x7</span><span class="op" id="5537463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537466">src</span>&nbsp;<span class="op" id="5537470">:=</span>&nbsp;<span class="ident" id="5537473">regStr</span><span class="op" id="5537479">(</span><span class="op" id="5537480">(</span><span class="ident" id="5537481">in</span>&nbsp;<span class="op" id="5537484">&gt;&gt;</span>&nbsp;<span class="num" id="5537487">18</span><span class="op" id="5537489">)</span>&nbsp;<span class="op" id="5537491">&amp;</span>&nbsp;<span class="num" id="5537493">0x7</span><span class="op" id="5537496">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537499">imu</span>&nbsp;<span class="op" id="5537503">:=</span>&nbsp;<span class="ident" id="5537506">in</span>&nbsp;<span class="op" id="5537509">&amp;</span>&nbsp;<span class="num" id="5537511">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537519">ims</span>&nbsp;<span class="op" id="5537523">:=</span>&nbsp;<span class="builtintype" id="5537526">int32</span><span class="op" id="5537531">(</span><span class="ident" id="5537532">imu</span><span class="op" id="5537535">&lt;&lt;</span><span class="num" id="5537537">16</span><span class="op" id="5537539">)</span>&nbsp;<span class="op" id="5537541">&gt;&gt;</span>&nbsp;<span class="num" id="5537544">16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5537549">var</span>&nbsp;<span class="ident" id="5537553">s</span>&nbsp;<span class="builtintype" id="5537555">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5537563">if</span>&nbsp;<span class="ident" id="5537566">opStr</span><span class="op" id="5537571">,</span>&nbsp;<span class="ident" id="5537573">found</span>&nbsp;<span class="op" id="5537579">:=</span>&nbsp;<span class="ident" id="5537582">opImsMap</span><span class="op" id="5537590">[</span><span class="ident" id="5537591">op</span><span class="op" id="5537593">]</span><span class="op" id="5537594">;</span>&nbsp;<span class="ident" id="5537596">found</span>&nbsp;<span class="op" id="5537602">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537606">s</span>&nbsp;<span class="op" id="5537608">=</span>&nbsp;<span class="ident" id="5537610">fmt</span><span class="op" id="5537613">.</span><span class="ident" id="5537614">Sprintf</span><span class="op" id="5537621">(</span><span class="string" id="5537622">&#34;%s&nbsp;%s&nbsp;%s&nbsp;%d&#34;</span><span class="op" id="5537635">,</span>&nbsp;<span class="ident" id="5537637">opStr</span><span class="op" id="5537642">,</span>&nbsp;<span class="ident" id="5537644">dest</span><span class="op" id="5537648">,</span>&nbsp;<span class="ident" id="5537650">src</span><span class="op" id="5537653">,</span>&nbsp;<span class="ident" id="5537655">ims</span><span class="op" id="5537658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5537661">}</span>&nbsp;<span class="keyword" id="5537663">else</span>&nbsp;<span class="keyword" id="5537668">if</span>&nbsp;<span class="ident" id="5537671">opStr</span><span class="op" id="5537676">,</span>&nbsp;<span class="ident" id="5537678">found</span>&nbsp;<span class="op" id="5537684">:=</span>&nbsp;<span class="ident" id="5537687">opMemMap</span><span class="op" id="5537695">[</span><span class="ident" id="5537696">op</span><span class="op" id="5537698">]</span><span class="op" id="5537699">;</span>&nbsp;<span class="ident" id="5537701">found</span>&nbsp;<span class="op" id="5537707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5537711">if</span>&nbsp;<span class="ident" id="5537714">ims</span>&nbsp;<span class="op" id="5537718">==</span>&nbsp;<span class="num" id="5537721">0</span>&nbsp;<span class="op" id="5537723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537728">s</span>&nbsp;<span class="op" id="5537730">=</span>&nbsp;<span class="ident" id="5537732">fmt</span><span class="op" id="5537735">.</span><span class="ident" id="5537736">Sprintf</span><span class="op" id="5537743">(</span><span class="string" id="5537744">&#34;%s&nbsp;%s&nbsp;%s&#34;</span><span class="op" id="5537754">,</span>&nbsp;<span class="ident" id="5537756">opStr</span><span class="op" id="5537761">,</span>&nbsp;<span class="ident" id="5537763">dest</span><span class="op" id="5537767">,</span>&nbsp;<span class="ident" id="5537769">src</span><span class="op" id="5537772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5537776">}</span>&nbsp;<span class="keyword" id="5537778">else</span>&nbsp;<span class="op" id="5537783">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537788">s</span>&nbsp;<span class="op" id="5537790">=</span>&nbsp;<span class="ident" id="5537792">fmt</span><span class="op" id="5537795">.</span><span class="ident" id="5537796">Sprintf</span><span class="op" id="5537803">(</span><span class="string" id="5537804">&#34;%s&nbsp;%s&nbsp;%s&nbsp;%d&#34;</span><span class="op" id="5537817">,</span>&nbsp;<span class="ident" id="5537819">opStr</span><span class="op" id="5537824">,</span>&nbsp;<span class="ident" id="5537826">dest</span><span class="op" id="5537830">,</span>&nbsp;<span class="ident" id="5537832">src</span><span class="op" id="5537835">,</span>&nbsp;<span class="ident" id="5537837">ims</span><span class="op" id="5537840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5537844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5537847">}</span>&nbsp;<span class="keyword" id="5537849">else</span>&nbsp;<span class="keyword" id="5537854">if</span>&nbsp;<span class="ident" id="5537857">opStr</span><span class="op" id="5537862">,</span>&nbsp;<span class="ident" id="5537864">found</span>&nbsp;<span class="op" id="5537870">:=</span>&nbsp;<span class="ident" id="5537873">opImuMap</span><span class="op" id="5537881">[</span><span class="ident" id="5537882">op</span><span class="op" id="5537884">]</span><span class="op" id="5537885">;</span>&nbsp;<span class="ident" id="5537887">found</span>&nbsp;<span class="op" id="5537893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5537897">s</span>&nbsp;<span class="op" id="5537899">=</span>&nbsp;<span class="ident" id="5537901">fmt</span><span class="op" id="5537904">.</span><span class="ident" id="5537905">Sprintf</span><span class="op" id="5537912">(</span><span class="string" id="5537913">&#34;%s&nbsp;%s&nbsp;%s&nbsp;0x%04x&#34;</span><span class="op" id="5537930">,</span>&nbsp;<span class="ident" id="5537932">opStr</span><span class="op" id="5537937">,</span>&nbsp;<span class="ident" id="5537939">dest</span><span class="op" id="5537943">,</span>&nbsp;<span class="ident" id="5537945">src</span><span class="op" id="5537948">,</span>&nbsp;<span class="ident" id="5537950">imu</span><span class="op" id="5537953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5537956">}</span>&nbsp;<span class="keyword" id="5537958">else</span>&nbsp;<span class="keyword" id="5537963">if</span>&nbsp;<span class="ident" id="5537966">opStr</span><span class="op" id="5537971">,</span>&nbsp;<span class="ident" id="5537973">found</span>&nbsp;<span class="op" id="5537979">:=</span>&nbsp;<span class="ident" id="5537982">opImu2Map</span><span class="op" id="5537991">[</span><span class="ident" id="5537992">op</span><span class="op" id="5537994">]</span><span class="op" id="5537995">;</span>&nbsp;<span class="ident" id="5537997">found</span>&nbsp;<span class="op" id="5538003">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538007">s</span>&nbsp;<span class="op" id="5538009">=</span>&nbsp;<span class="ident" id="5538011">fmt</span><span class="op" id="5538014">.</span><span class="ident" id="5538015">Sprintf</span><span class="op" id="5538022">(</span><span class="string" id="5538023">&#34;%s&nbsp;%s&nbsp;0x%04x&#34;</span><span class="op" id="5538037">,</span>&nbsp;<span class="ident" id="5538039">opStr</span><span class="op" id="5538044">,</span>&nbsp;<span class="ident" id="5538046">dest</span><span class="op" id="5538050">,</span>&nbsp;<span class="ident" id="5538052">imu</span><span class="op" id="5538055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5538058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538062">ret</span>&nbsp;<span class="op" id="5538066">:=</span>&nbsp;<span class="ident" id="5538069">newLine</span><span class="op" id="5538076">(</span><span class="ident" id="5538077">addr</span><span class="op" id="5538081">,</span>&nbsp;<span class="ident" id="5538083">in</span><span class="op" id="5538085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5538088">ret</span><span class="op" id="5538091">.</span><span class="ident" id="5538092">Str</span>&nbsp;<span class="op" id="5538096">=</span>&nbsp;<span class="ident" id="5538098">s</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5538102">return</span>&nbsp;<span class="ident" id="5538109">ret</span><br>
<span class="lineno"></span><span class="op" id="5538113">}</span>
</div>
</body>
</html>
