<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7577313">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7577368">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7577422">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7577473">package</span>&nbsp;<span class="ident" id="7577481">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7577486">import</span>&nbsp;<span class="op" id="7577493">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7577496">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7577506">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="7577509">//&nbsp;See&nbsp;const.go&nbsp;for&nbsp;overview&nbsp;of&nbsp;math&nbsp;here.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7577553">//&nbsp;Test&nbsp;that&nbsp;powx&nbsp;is&nbsp;initialized&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="comment" id="7577597">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;it&nbsp;too.)</span><br>
<span class="lineno">15</span><span class="keyword" id="7577642">func</span>&nbsp;<span class="ident" id="7577647">TestPowx</span><span class="op" id="7577655">(</span><span class="ident" id="7577656">t</span>&nbsp;<span class="op" id="7577658">*</span><span class="ident" id="7577659">testing</span><span class="op" id="7577666">.</span><span class="ident" id="7577667">T</span><span class="op" id="7577668">)</span>&nbsp;<span class="op" id="7577670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7577673">p</span>&nbsp;<span class="op" id="7577675">:=</span>&nbsp;<span class="num" id="7577678">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7577681">for</span>&nbsp;<span class="ident" id="7577685">i</span>&nbsp;<span class="op" id="7577687">:=</span>&nbsp;<span class="num" id="7577690">0</span><span class="op" id="7577691">;</span>&nbsp;<span class="ident" id="7577693">i</span>&nbsp;<span class="op" id="7577695">&lt;</span>&nbsp;<span class="builtinfunc" id="7577697">len</span><span class="op" id="7577700">(</span><span class="ident" id="7577701">powx</span><span class="op" id="7577705">)</span><span class="op" id="7577706">;</span>&nbsp;<span class="ident" id="7577708">i</span><span class="op" id="7577709">++</span>&nbsp;<span class="op" id="7577712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7577716">if</span>&nbsp;<span class="ident" id="7577719">powx</span><span class="op" id="7577723">[</span><span class="ident" id="7577724">i</span><span class="op" id="7577725">]</span>&nbsp;<span class="op" id="7577727">!=</span>&nbsp;<span class="builtintype" id="7577730">byte</span><span class="op" id="7577734">(</span><span class="ident" id="7577735">p</span><span class="op" id="7577736">)</span>&nbsp;<span class="op" id="7577738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7577743">t</span><span class="op" id="7577744">.</span><span class="ident" id="7577745">Errorf</span><span class="op" id="7577751">(</span><span class="string" id="7577752">&#34;powx[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7577778">,</span>&nbsp;<span class="ident" id="7577780">i</span><span class="op" id="7577781">,</span>&nbsp;<span class="ident" id="7577783">powx</span><span class="op" id="7577787">[</span><span class="ident" id="7577788">i</span><span class="op" id="7577789">]</span><span class="op" id="7577790">,</span>&nbsp;<span class="ident" id="7577792">p</span><span class="op" id="7577793">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7577797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7577801">p</span>&nbsp;<span class="op" id="7577803">&lt;&lt;=</span>&nbsp;<span class="num" id="7577807">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7577811">if</span>&nbsp;<span class="ident" id="7577814">p</span><span class="op" id="7577815">&amp;</span><span class="num" id="7577816">0x100</span>&nbsp;<span class="op" id="7577822">!=</span>&nbsp;<span class="num" id="7577825">0</span>&nbsp;<span class="op" id="7577827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7577832">p</span>&nbsp;<span class="op" id="7577834">^=</span>&nbsp;<span class="ident" id="7577837">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7577844">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7577847">}</span><br>
<span class="lineno"></span><span class="op" id="7577849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7577852">//&nbsp;Multiply&nbsp;b&nbsp;and&nbsp;c&nbsp;as&nbsp;GF(2)&nbsp;polynomials&nbsp;modulo&nbsp;poly</span><br>
<span class="lineno"></span><span class="keyword" id="7577905">func</span>&nbsp;<span class="ident" id="7577910">mul</span><span class="op" id="7577913">(</span><span class="ident" id="7577914">b</span><span class="op" id="7577915">,</span>&nbsp;<span class="ident" id="7577917">c</span>&nbsp;<span class="builtintype" id="7577919">uint32</span><span class="op" id="7577925">)</span>&nbsp;<span class="builtintype" id="7577927">uint32</span>&nbsp;<span class="op" id="7577934">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7577937">i</span>&nbsp;<span class="op" id="7577939">:=</span>&nbsp;<span class="ident" id="7577942">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7577945">j</span>&nbsp;<span class="op" id="7577947">:=</span>&nbsp;<span class="ident" id="7577950">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7577953">s</span>&nbsp;<span class="op" id="7577955">:=</span>&nbsp;<span class="builtintype" id="7577958">uint32</span><span class="op" id="7577964">(</span><span class="num" id="7577965">0</span><span class="op" id="7577966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7577969">for</span>&nbsp;<span class="ident" id="7577973">k</span>&nbsp;<span class="op" id="7577975">:=</span>&nbsp;<span class="builtintype" id="7577978">uint32</span><span class="op" id="7577984">(</span><span class="num" id="7577985">1</span><span class="op" id="7577986">)</span><span class="op" id="7577987">;</span>&nbsp;<span class="ident" id="7577989">k</span>&nbsp;<span class="op" id="7577991">&lt;</span>&nbsp;<span class="num" id="7577993">0x100</span>&nbsp;<span class="op" id="7577999">&amp;&amp;</span>&nbsp;<span class="ident" id="7578002">j</span>&nbsp;<span class="op" id="7578004">!=</span>&nbsp;<span class="num" id="7578007">0</span><span class="op" id="7578008">;</span>&nbsp;<span class="ident" id="7578010">k</span>&nbsp;<span class="op" id="7578012">&lt;&lt;=</span>&nbsp;<span class="num" id="7578016">1</span>&nbsp;<span class="op" id="7578018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7578022">//&nbsp;Invariant:&nbsp;k&nbsp;==&nbsp;1&lt;&lt;n,&nbsp;i&nbsp;==&nbsp;b&nbsp;*&nbsp;x‚Åø</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7578064">if</span>&nbsp;<span class="ident" id="7578067">j</span><span class="op" id="7578068">&amp;</span><span class="ident" id="7578069">k</span>&nbsp;<span class="op" id="7578071">!=</span>&nbsp;<span class="num" id="7578074">0</span>&nbsp;<span class="op" id="7578076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7578081">//&nbsp;s&nbsp;+=&nbsp;i&nbsp;in&nbsp;GF(2);&nbsp;xor&nbsp;in&nbsp;binary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578118">s</span>&nbsp;<span class="op" id="7578120">^=</span>&nbsp;<span class="ident" id="7578123">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578128">j</span>&nbsp;<span class="op" id="7578130">^=</span>&nbsp;<span class="ident" id="7578133">k</span>&nbsp;<span class="comment" id="7578135">//&nbsp;turn&nbsp;off&nbsp;bit&nbsp;to&nbsp;end&nbsp;loop&nbsp;early</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7578176">//&nbsp;i&nbsp;*=&nbsp;x&nbsp;in&nbsp;GF(2)&nbsp;modulo&nbsp;the&nbsp;polynomial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578219">i</span>&nbsp;<span class="op" id="7578221">&lt;&lt;=</span>&nbsp;<span class="num" id="7578225">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7578229">if</span>&nbsp;<span class="ident" id="7578232">i</span><span class="op" id="7578233">&amp;</span><span class="num" id="7578234">0x100</span>&nbsp;<span class="op" id="7578240">!=</span>&nbsp;<span class="num" id="7578243">0</span>&nbsp;<span class="op" id="7578245">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578250">i</span>&nbsp;<span class="op" id="7578252">^=</span>&nbsp;<span class="ident" id="7578255">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7578268">return</span>&nbsp;<span class="ident" id="7578275">s</span><br>
<span class="lineno"></span><span class="op" id="7578277">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="7578280">//&nbsp;Test&nbsp;all&nbsp;mul&nbsp;inputs&nbsp;against&nbsp;bit-by-bit&nbsp;n¬≤&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="7578337">func</span>&nbsp;<span class="ident" id="7578342">TestMul</span><span class="op" id="7578349">(</span><span class="ident" id="7578350">t</span>&nbsp;<span class="op" id="7578352">*</span><span class="ident" id="7578353">testing</span><span class="op" id="7578360">.</span><span class="ident" id="7578361">T</span><span class="op" id="7578362">)</span>&nbsp;<span class="op" id="7578364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7578367">for</span>&nbsp;<span class="ident" id="7578371">i</span>&nbsp;<span class="op" id="7578373">:=</span>&nbsp;<span class="builtintype" id="7578376">uint32</span><span class="op" id="7578382">(</span><span class="num" id="7578383">0</span><span class="op" id="7578384">)</span><span class="op" id="7578385">;</span>&nbsp;<span class="ident" id="7578387">i</span>&nbsp;<span class="op" id="7578389">&lt;</span>&nbsp;<span class="num" id="7578391">256</span><span class="op" id="7578394">;</span>&nbsp;<span class="ident" id="7578396">i</span><span class="op" id="7578397">++</span>&nbsp;<span class="op" id="7578400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7578404">for</span>&nbsp;<span class="ident" id="7578408">j</span>&nbsp;<span class="op" id="7578410">:=</span>&nbsp;<span class="builtintype" id="7578413">uint32</span><span class="op" id="7578419">(</span><span class="num" id="7578420">0</span><span class="op" id="7578421">)</span><span class="op" id="7578422">;</span>&nbsp;<span class="ident" id="7578424">j</span>&nbsp;<span class="op" id="7578426">&lt;</span>&nbsp;<span class="num" id="7578428">256</span><span class="op" id="7578431">;</span>&nbsp;<span class="ident" id="7578433">j</span><span class="op" id="7578434">++</span>&nbsp;<span class="op" id="7578437">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7578442">//&nbsp;Multiply&nbsp;i,&nbsp;j&nbsp;bit&nbsp;by&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578474">s</span>&nbsp;<span class="op" id="7578476">:=</span>&nbsp;<span class="builtintype" id="7578479">uint8</span><span class="op" id="7578484">(</span><span class="num" id="7578485">0</span><span class="op" id="7578486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7578491">for</span>&nbsp;<span class="ident" id="7578495">k</span>&nbsp;<span class="op" id="7578497">:=</span>&nbsp;<span class="builtintype" id="7578500">uint</span><span class="op" id="7578504">(</span><span class="num" id="7578505">0</span><span class="op" id="7578506">)</span><span class="op" id="7578507">;</span>&nbsp;<span class="ident" id="7578509">k</span>&nbsp;<span class="op" id="7578511">&lt;</span>&nbsp;<span class="num" id="7578513">8</span><span class="op" id="7578514">;</span>&nbsp;<span class="ident" id="7578516">k</span><span class="op" id="7578517">++</span>&nbsp;<span class="op" id="7578520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7578526">for</span>&nbsp;<span class="ident" id="7578530">l</span>&nbsp;<span class="op" id="7578532">:=</span>&nbsp;<span class="builtintype" id="7578535">uint</span><span class="op" id="7578539">(</span><span class="num" id="7578540">0</span><span class="op" id="7578541">)</span><span class="op" id="7578542">;</span>&nbsp;<span class="ident" id="7578544">l</span>&nbsp;<span class="op" id="7578546">&lt;</span>&nbsp;<span class="num" id="7578548">8</span><span class="op" id="7578549">;</span>&nbsp;<span class="ident" id="7578551">l</span><span class="op" id="7578552">++</span>&nbsp;<span class="op" id="7578555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7578562">if</span>&nbsp;<span class="ident" id="7578565">i</span><span class="op" id="7578566">&amp;</span><span class="op" id="7578567">(</span><span class="num" id="7578568">1</span><span class="op" id="7578569">&lt;&lt;</span><span class="ident" id="7578571">k</span><span class="op" id="7578572">)</span>&nbsp;<span class="op" id="7578574">!=</span>&nbsp;<span class="num" id="7578577">0</span>&nbsp;<span class="op" id="7578579">&amp;&amp;</span>&nbsp;<span class="ident" id="7578582">j</span><span class="op" id="7578583">&amp;</span><span class="op" id="7578584">(</span><span class="num" id="7578585">1</span><span class="op" id="7578586">&lt;&lt;</span><span class="ident" id="7578588">l</span><span class="op" id="7578589">)</span>&nbsp;<span class="op" id="7578591">!=</span>&nbsp;<span class="num" id="7578594">0</span>&nbsp;<span class="op" id="7578596">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578604">s</span>&nbsp;<span class="op" id="7578606">^=</span>&nbsp;<span class="ident" id="7578609">powx</span><span class="op" id="7578613">[</span><span class="ident" id="7578614">k</span><span class="op" id="7578615">+</span><span class="ident" id="7578616">l</span><span class="op" id="7578617">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7578640">if</span>&nbsp;<span class="ident" id="7578643">x</span>&nbsp;<span class="op" id="7578645">:=</span>&nbsp;<span class="ident" id="7578648">mul</span><span class="op" id="7578651">(</span><span class="ident" id="7578652">i</span><span class="op" id="7578653">,</span>&nbsp;<span class="ident" id="7578655">j</span><span class="op" id="7578656">)</span><span class="op" id="7578657">;</span>&nbsp;<span class="ident" id="7578659">x</span>&nbsp;<span class="op" id="7578661">!=</span>&nbsp;<span class="builtintype" id="7578664">uint32</span><span class="op" id="7578670">(</span><span class="ident" id="7578671">s</span><span class="op" id="7578672">)</span>&nbsp;<span class="op" id="7578674">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7578680">t</span><span class="op" id="7578681">.</span><span class="ident" id="7578682">Fatalf</span><span class="op" id="7578688">(</span><span class="string" id="7578689">&#34;mul(%#x,&nbsp;%#x)&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7578720">,</span>&nbsp;<span class="ident" id="7578722">i</span><span class="op" id="7578723">,</span>&nbsp;<span class="ident" id="7578725">j</span><span class="op" id="7578726">,</span>&nbsp;<span class="ident" id="7578728">x</span><span class="op" id="7578729">,</span>&nbsp;<span class="ident" id="7578731">s</span><span class="op" id="7578732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7578744">}</span><br>
<span class="lineno"></span><span class="op" id="7578746">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="7578749">//&nbsp;Check&nbsp;that&nbsp;S-boxes&nbsp;are&nbsp;inverses&nbsp;of&nbsp;each&nbsp;other.</span><br>
<span class="lineno"></span><span class="comment" id="7578799">//&nbsp;They&nbsp;have&nbsp;more&nbsp;structure&nbsp;that&nbsp;we&nbsp;could&nbsp;test,</span><br>
<span class="lineno"></span><span class="comment" id="7578847">//&nbsp;but&nbsp;if&nbsp;this&nbsp;sanity&nbsp;check&nbsp;passes,&nbsp;we&#39;ll&nbsp;assume</span><br>
<span class="lineno"></span><span class="comment" id="7578896">//&nbsp;the&nbsp;cut&nbsp;and&nbsp;paste&nbsp;from&nbsp;the&nbsp;FIPS&nbsp;PDF&nbsp;worked.</span><br>
<span class="lineno">75</span><span class="keyword" id="7578943">func</span>&nbsp;<span class="ident" id="7578948">TestSboxes</span><span class="op" id="7578958">(</span><span class="ident" id="7578959">t</span>&nbsp;<span class="op" id="7578961">*</span><span class="ident" id="7578962">testing</span><span class="op" id="7578969">.</span><span class="ident" id="7578970">T</span><span class="op" id="7578971">)</span>&nbsp;<span class="op" id="7578973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7578976">for</span>&nbsp;<span class="ident" id="7578980">i</span>&nbsp;<span class="op" id="7578982">:=</span>&nbsp;<span class="num" id="7578985">0</span><span class="op" id="7578986">;</span>&nbsp;<span class="ident" id="7578988">i</span>&nbsp;<span class="op" id="7578990">&lt;</span>&nbsp;<span class="num" id="7578992">256</span><span class="op" id="7578995">;</span>&nbsp;<span class="ident" id="7578997">i</span><span class="op" id="7578998">++</span>&nbsp;<span class="op" id="7579001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579005">if</span>&nbsp;<span class="ident" id="7579008">j</span>&nbsp;<span class="op" id="7579010">:=</span>&nbsp;<span class="ident" id="7579013">sbox0</span><span class="op" id="7579018">[</span><span class="ident" id="7579019">sbox1</span><span class="op" id="7579024">[</span><span class="ident" id="7579025">i</span><span class="op" id="7579026">]</span><span class="op" id="7579027">]</span><span class="op" id="7579028">;</span>&nbsp;<span class="ident" id="7579030">j</span>&nbsp;<span class="op" id="7579032">!=</span>&nbsp;<span class="builtintype" id="7579035">byte</span><span class="op" id="7579039">(</span><span class="ident" id="7579040">i</span><span class="op" id="7579041">)</span>&nbsp;<span class="op" id="7579043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579048">t</span><span class="op" id="7579049">.</span><span class="ident" id="7579050">Errorf</span><span class="op" id="7579056">(</span><span class="string" id="7579057">&#34;sbox0[sbox1[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="7579082">,</span>&nbsp;<span class="ident" id="7579084">i</span><span class="op" id="7579085">,</span>&nbsp;<span class="ident" id="7579087">j</span><span class="op" id="7579088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7579092">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579096">if</span>&nbsp;<span class="ident" id="7579099">j</span>&nbsp;<span class="op" id="7579101">:=</span>&nbsp;<span class="ident" id="7579104">sbox1</span><span class="op" id="7579109">[</span><span class="ident" id="7579110">sbox0</span><span class="op" id="7579115">[</span><span class="ident" id="7579116">i</span><span class="op" id="7579117">]</span><span class="op" id="7579118">]</span><span class="op" id="7579119">;</span>&nbsp;<span class="ident" id="7579121">j</span>&nbsp;<span class="op" id="7579123">!=</span>&nbsp;<span class="builtintype" id="7579126">byte</span><span class="op" id="7579130">(</span><span class="ident" id="7579131">i</span><span class="op" id="7579132">)</span>&nbsp;<span class="op" id="7579134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579139">t</span><span class="op" id="7579140">.</span><span class="ident" id="7579141">Errorf</span><span class="op" id="7579147">(</span><span class="string" id="7579148">&#34;sbox1[sbox0[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="7579173">,</span>&nbsp;<span class="ident" id="7579175">i</span><span class="op" id="7579176">,</span>&nbsp;<span class="ident" id="7579178">j</span><span class="op" id="7579179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7579183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7579186">}</span><br>
<span class="lineno"></span><span class="op" id="7579188">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="7579191">//&nbsp;Test&nbsp;that&nbsp;encryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno"></span><span class="comment" id="7579235">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="7579282">func</span>&nbsp;<span class="ident" id="7579287">TestTe</span><span class="op" id="7579293">(</span><span class="ident" id="7579294">t</span>&nbsp;<span class="op" id="7579296">*</span><span class="ident" id="7579297">testing</span><span class="op" id="7579304">.</span><span class="ident" id="7579305">T</span><span class="op" id="7579306">)</span>&nbsp;<span class="op" id="7579308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579311">for</span>&nbsp;<span class="ident" id="7579315">i</span>&nbsp;<span class="op" id="7579317">:=</span>&nbsp;<span class="num" id="7579320">0</span><span class="op" id="7579321">;</span>&nbsp;<span class="ident" id="7579323">i</span>&nbsp;<span class="op" id="7579325">&lt;</span>&nbsp;<span class="num" id="7579327">256</span><span class="op" id="7579330">;</span>&nbsp;<span class="ident" id="7579332">i</span><span class="op" id="7579333">++</span>&nbsp;<span class="op" id="7579336">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579340">s</span>&nbsp;<span class="op" id="7579342">:=</span>&nbsp;<span class="builtintype" id="7579345">uint32</span><span class="op" id="7579351">(</span><span class="ident" id="7579352">sbox0</span><span class="op" id="7579357">[</span><span class="ident" id="7579358">i</span><span class="op" id="7579359">]</span><span class="op" id="7579360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579364">s2</span>&nbsp;<span class="op" id="7579367">:=</span>&nbsp;<span class="ident" id="7579370">mul</span><span class="op" id="7579373">(</span><span class="ident" id="7579374">s</span><span class="op" id="7579375">,</span>&nbsp;<span class="num" id="7579377">2</span><span class="op" id="7579378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579382">s3</span>&nbsp;<span class="op" id="7579385">:=</span>&nbsp;<span class="ident" id="7579388">mul</span><span class="op" id="7579391">(</span><span class="ident" id="7579392">s</span><span class="op" id="7579393">,</span>&nbsp;<span class="num" id="7579395">3</span><span class="op" id="7579396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579400">w</span>&nbsp;<span class="op" id="7579402">:=</span>&nbsp;<span class="ident" id="7579405">s2</span><span class="op" id="7579407">&lt;&lt;</span><span class="num" id="7579409">24</span>&nbsp;<span class="op" id="7579412">|</span>&nbsp;<span class="ident" id="7579414">s</span><span class="op" id="7579415">&lt;&lt;</span><span class="num" id="7579417">16</span>&nbsp;<span class="op" id="7579420">|</span>&nbsp;<span class="ident" id="7579422">s</span><span class="op" id="7579423">&lt;&lt;</span><span class="num" id="7579425">8</span>&nbsp;<span class="op" id="7579427">|</span>&nbsp;<span class="ident" id="7579429">s3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579434">te</span>&nbsp;<span class="op" id="7579437">:=</span>&nbsp;<span class="op" id="7579440">[</span><span class="op" id="7579441">]</span><span class="op" id="7579442">[</span><span class="num" id="7579443">256</span><span class="op" id="7579446">]</span><span class="builtintype" id="7579447">uint32</span><span class="op" id="7579453">{</span><span class="ident" id="7579454">te0</span><span class="op" id="7579457">,</span>&nbsp;<span class="ident" id="7579459">te1</span><span class="op" id="7579462">,</span>&nbsp;<span class="ident" id="7579464">te2</span><span class="op" id="7579467">,</span>&nbsp;<span class="ident" id="7579469">te3</span><span class="op" id="7579472">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579476">for</span>&nbsp;<span class="ident" id="7579480">j</span>&nbsp;<span class="op" id="7579482">:=</span>&nbsp;<span class="num" id="7579485">0</span><span class="op" id="7579486">;</span>&nbsp;<span class="ident" id="7579488">j</span>&nbsp;<span class="op" id="7579490">&lt;</span>&nbsp;<span class="num" id="7579492">4</span><span class="op" id="7579493">;</span>&nbsp;<span class="ident" id="7579495">j</span><span class="op" id="7579496">++</span>&nbsp;<span class="op" id="7579499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579504">if</span>&nbsp;<span class="ident" id="7579507">x</span>&nbsp;<span class="op" id="7579509">:=</span>&nbsp;<span class="ident" id="7579512">te</span><span class="op" id="7579514">[</span><span class="ident" id="7579515">j</span><span class="op" id="7579516">]</span><span class="op" id="7579517">[</span><span class="ident" id="7579518">i</span><span class="op" id="7579519">]</span><span class="op" id="7579520">;</span>&nbsp;<span class="ident" id="7579522">x</span>&nbsp;<span class="op" id="7579524">!=</span>&nbsp;<span class="ident" id="7579527">w</span>&nbsp;<span class="op" id="7579529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579535">t</span><span class="op" id="7579536">.</span><span class="ident" id="7579537">Fatalf</span><span class="op" id="7579543">(</span><span class="string" id="7579544">&#34;te[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7579572">,</span>&nbsp;<span class="ident" id="7579574">j</span><span class="op" id="7579575">,</span>&nbsp;<span class="ident" id="7579577">i</span><span class="op" id="7579578">,</span>&nbsp;<span class="ident" id="7579580">x</span><span class="op" id="7579581">,</span>&nbsp;<span class="ident" id="7579583">w</span><span class="op" id="7579584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7579589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579594">w</span>&nbsp;<span class="op" id="7579596">=</span>&nbsp;<span class="ident" id="7579598">w</span><span class="op" id="7579599">&lt;&lt;</span><span class="num" id="7579601">24</span>&nbsp;<span class="op" id="7579604">|</span>&nbsp;<span class="ident" id="7579606">w</span><span class="op" id="7579607">&gt;&gt;</span><span class="num" id="7579609">8</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7579613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7579616">}</span><br>
<span class="lineno"></span><span class="op" id="7579618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7579621">//&nbsp;Test&nbsp;that&nbsp;decryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno">105</span><span class="comment" id="7579665">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="7579712">func</span>&nbsp;<span class="ident" id="7579717">TestTd</span><span class="op" id="7579723">(</span><span class="ident" id="7579724">t</span>&nbsp;<span class="op" id="7579726">*</span><span class="ident" id="7579727">testing</span><span class="op" id="7579734">.</span><span class="ident" id="7579735">T</span><span class="op" id="7579736">)</span>&nbsp;<span class="op" id="7579738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579741">for</span>&nbsp;<span class="ident" id="7579745">i</span>&nbsp;<span class="op" id="7579747">:=</span>&nbsp;<span class="num" id="7579750">0</span><span class="op" id="7579751">;</span>&nbsp;<span class="ident" id="7579753">i</span>&nbsp;<span class="op" id="7579755">&lt;</span>&nbsp;<span class="num" id="7579757">256</span><span class="op" id="7579760">;</span>&nbsp;<span class="ident" id="7579762">i</span><span class="op" id="7579763">++</span>&nbsp;<span class="op" id="7579766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579770">s</span>&nbsp;<span class="op" id="7579772">:=</span>&nbsp;<span class="builtintype" id="7579775">uint32</span><span class="op" id="7579781">(</span><span class="ident" id="7579782">sbox1</span><span class="op" id="7579787">[</span><span class="ident" id="7579788">i</span><span class="op" id="7579789">]</span><span class="op" id="7579790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579794">s9</span>&nbsp;<span class="op" id="7579797">:=</span>&nbsp;<span class="ident" id="7579800">mul</span><span class="op" id="7579803">(</span><span class="ident" id="7579804">s</span><span class="op" id="7579805">,</span>&nbsp;<span class="num" id="7579807">0x9</span><span class="op" id="7579810">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579814">sb</span>&nbsp;<span class="op" id="7579817">:=</span>&nbsp;<span class="ident" id="7579820">mul</span><span class="op" id="7579823">(</span><span class="ident" id="7579824">s</span><span class="op" id="7579825">,</span>&nbsp;<span class="num" id="7579827">0xb</span><span class="op" id="7579830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579834">sd</span>&nbsp;<span class="op" id="7579837">:=</span>&nbsp;<span class="ident" id="7579840">mul</span><span class="op" id="7579843">(</span><span class="ident" id="7579844">s</span><span class="op" id="7579845">,</span>&nbsp;<span class="num" id="7579847">0xd</span><span class="op" id="7579850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579854">se</span>&nbsp;<span class="op" id="7579857">:=</span>&nbsp;<span class="ident" id="7579860">mul</span><span class="op" id="7579863">(</span><span class="ident" id="7579864">s</span><span class="op" id="7579865">,</span>&nbsp;<span class="num" id="7579867">0xe</span><span class="op" id="7579870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579874">w</span>&nbsp;<span class="op" id="7579876">:=</span>&nbsp;<span class="ident" id="7579879">se</span><span class="op" id="7579881">&lt;&lt;</span><span class="num" id="7579883">24</span>&nbsp;<span class="op" id="7579886">|</span>&nbsp;<span class="ident" id="7579888">s9</span><span class="op" id="7579890">&lt;&lt;</span><span class="num" id="7579892">16</span>&nbsp;<span class="op" id="7579895">|</span>&nbsp;<span class="ident" id="7579897">sd</span><span class="op" id="7579899">&lt;&lt;</span><span class="num" id="7579901">8</span>&nbsp;<span class="op" id="7579903">|</span>&nbsp;<span class="ident" id="7579905">sb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7579910">td</span>&nbsp;<span class="op" id="7579913">:=</span>&nbsp;<span class="op" id="7579916">[</span><span class="op" id="7579917">]</span><span class="op" id="7579918">[</span><span class="num" id="7579919">256</span><span class="op" id="7579922">]</span><span class="builtintype" id="7579923">uint32</span><span class="op" id="7579929">{</span><span class="ident" id="7579930">td0</span><span class="op" id="7579933">,</span>&nbsp;<span class="ident" id="7579935">td1</span><span class="op" id="7579938">,</span>&nbsp;<span class="ident" id="7579940">td2</span><span class="op" id="7579943">,</span>&nbsp;<span class="ident" id="7579945">td3</span><span class="op" id="7579948">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579952">for</span>&nbsp;<span class="ident" id="7579956">j</span>&nbsp;<span class="op" id="7579958">:=</span>&nbsp;<span class="num" id="7579961">0</span><span class="op" id="7579962">;</span>&nbsp;<span class="ident" id="7579964">j</span>&nbsp;<span class="op" id="7579966">&lt;</span>&nbsp;<span class="num" id="7579968">4</span><span class="op" id="7579969">;</span>&nbsp;<span class="ident" id="7579971">j</span><span class="op" id="7579972">++</span>&nbsp;<span class="op" id="7579975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7579980">if</span>&nbsp;<span class="ident" id="7579983">x</span>&nbsp;<span class="op" id="7579985">:=</span>&nbsp;<span class="ident" id="7579988">td</span><span class="op" id="7579990">[</span><span class="ident" id="7579991">j</span><span class="op" id="7579992">]</span><span class="op" id="7579993">[</span><span class="ident" id="7579994">i</span><span class="op" id="7579995">]</span><span class="op" id="7579996">;</span>&nbsp;<span class="ident" id="7579998">x</span>&nbsp;<span class="op" id="7580000">!=</span>&nbsp;<span class="ident" id="7580003">w</span>&nbsp;<span class="op" id="7580005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580011">t</span><span class="op" id="7580012">.</span><span class="ident" id="7580013">Fatalf</span><span class="op" id="7580019">(</span><span class="string" id="7580020">&#34;td[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7580048">,</span>&nbsp;<span class="ident" id="7580050">j</span><span class="op" id="7580051">,</span>&nbsp;<span class="ident" id="7580053">i</span><span class="op" id="7580054">,</span>&nbsp;<span class="ident" id="7580056">x</span><span class="op" id="7580057">,</span>&nbsp;<span class="ident" id="7580059">w</span><span class="op" id="7580060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580070">w</span>&nbsp;<span class="op" id="7580072">=</span>&nbsp;<span class="ident" id="7580074">w</span><span class="op" id="7580075">&lt;&lt;</span><span class="num" id="7580077">24</span>&nbsp;<span class="op" id="7580080">|</span>&nbsp;<span class="ident" id="7580082">w</span><span class="op" id="7580083">&gt;&gt;</span><span class="num" id="7580085">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580092">}</span><br>
<span class="lineno"></span><span class="op" id="7580094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7580097">//&nbsp;Test&nbsp;vectors&nbsp;are&nbsp;from&nbsp;FIPS&nbsp;197:</span><br>
<span class="lineno">125</span><span class="comment" id="7580132">//&nbsp;&nbsp;&nbsp;&nbsphttp://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7580200">//&nbsp;Appendix&nbsp;A&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Key&nbsp;expansion&nbsp;examples</span><br>
<span class="lineno"></span><span class="keyword" id="7580250">type</span>&nbsp;<span class="ident" id="7580255">KeyTest</span>&nbsp;<span class="keyword" id="7580263">struct</span>&nbsp;<span class="op" id="7580270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580273">key</span>&nbsp;<span class="op" id="7580277">[</span><span class="op" id="7580278">]</span><span class="builtintype" id="7580279">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580285">enc</span>&nbsp;<span class="op" id="7580289">[</span><span class="op" id="7580290">]</span><span class="builtintype" id="7580291">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7580299">dec</span>&nbsp;<span class="op" id="7580303">[</span><span class="op" id="7580304">]</span><span class="builtintype" id="7580305">uint32</span>&nbsp;<span class="comment" id="7580312">//&nbsp;decryption&nbsp;expansion;&nbsp;not&nbsp;in&nbsp;FIPS&nbsp;197,&nbsp;computed&nbsp;from&nbsp;C&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="op" id="7580386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7580389">var</span>&nbsp;<span class="ident" id="7580393">keyTests</span>&nbsp;<span class="op" id="7580402">=</span>&nbsp;<span class="op" id="7580404">[</span><span class="op" id="7580405">]</span><span class="ident" id="7580406">KeyTest</span><span class="op" id="7580413">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7580420">//&nbsp;A.1.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;128-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580465">[</span><span class="op" id="7580466">]</span><span class="builtintype" id="7580467">byte</span><span class="op" id="7580471">{</span><span class="num" id="7580472">0x2b</span><span class="op" id="7580476">,</span>&nbsp;<span class="num" id="7580478">0x7e</span><span class="op" id="7580482">,</span>&nbsp;<span class="num" id="7580484">0x15</span><span class="op" id="7580488">,</span>&nbsp;<span class="num" id="7580490">0x16</span><span class="op" id="7580494">,</span>&nbsp;<span class="num" id="7580496">0x28</span><span class="op" id="7580500">,</span>&nbsp;<span class="num" id="7580502">0xae</span><span class="op" id="7580506">,</span>&nbsp;<span class="num" id="7580508">0xd2</span><span class="op" id="7580512">,</span>&nbsp;<span class="num" id="7580514">0xa6</span><span class="op" id="7580518">,</span>&nbsp;<span class="num" id="7580520">0xab</span><span class="op" id="7580524">,</span>&nbsp;<span class="num" id="7580526">0xf7</span><span class="op" id="7580530">,</span>&nbsp;<span class="num" id="7580532">0x15</span><span class="op" id="7580536">,</span>&nbsp;<span class="num" id="7580538">0x88</span><span class="op" id="7580542">,</span>&nbsp;<span class="num" id="7580544">0x09</span><span class="op" id="7580548">,</span>&nbsp;<span class="num" id="7580550">0xcf</span><span class="op" id="7580554">,</span>&nbsp;<span class="num" id="7580556">0x4f</span><span class="op" id="7580560">,</span>&nbsp;<span class="num" id="7580562">0x3c</span><span class="op" id="7580566">}</span><span class="op" id="7580567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7580571">[</span><span class="op" id="7580572">]</span><span class="builtintype" id="7580573">uint32</span><span class="op" id="7580579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7580584">0x2b7e1516</span><span class="op" id="7580594">,</span>&nbsp;<span class="num" id="7580596">0x28aed2a6</span><span class="op" id="7580606">,</span>&nbsp;<span class="num" id="7580608">0xabf71588</span><span class="op" id="7580618">,</span>&nbsp;<span class="num" id="7580620">0x09cf4f3c</span><span class="op" id="7580630">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7580635">0xa0fafe17</span><span class="op" id="7580645">,</span>&nbsp;<span class="num" id="7580647">0x88542cb1</span><span class="op" id="7580657">,</span>&nbsp;<span class="num" id="7580659">0x23a33939</span><span class="op" id="7580669">,</span>&nbsp;<span class="num" id="7580671">0x2a6c7605</span><span class="op" id="7580681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7580686">0xf2c295f2</span><span class="op" id="7580696">,</span>&nbsp;<span class="num" id="7580698">0x7a96b943</span><span class="op" id="7580708">,</span>&nbsp;<span class="num" id="7580710">0x5935807a</span><span class="op" id="7580720">,</span>&nbsp;<span class="num" id="7580722">0x7359f67f</span><span class="op" id="7580732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7580737">0x3d80477d</span><span class="op" id="7580747">,</span>&nbsp;<span class="num" id="7580749">0x4716fe3e</span><span class="op" id="7580759">,</span>&nbsp;<span class="num" id="7580761">0x1e237e44</span><span class="op" id="7580771">,</span>&nbsp;<span class="num" id="7580773">0x6d7a883b</span><span class="op" id="7580783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7580788">0xef44a541</span><span class="op" id="7580798">,</span>&nbsp;<span class="num" id="7580800">0xa8525b7f</span><span class="op" id="7580810">,</span>&nbsp;<span class="num" id="7580812">0xb671253b</span><span class="op" id="7580822">,</span>&nbsp;<span class="num" id="7580824">0xdb0bad00</span><span class="op" id="7580834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7580839">0xd4d1c6f8</span><span class="op" id="7580849">,</span>&nbsp;<span class="num" id="7580851">0x7c839d87</span><span class="op" id="7580861">,</span>&nbsp;<span class="num" id="7580863">0xcaf2b8bc</span><span class="op" id="7580873">,</span>&nbsp;<span class="num" id="7580875">0x11f915bc</span><span class="op" id="7580885">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7580890">0x6d88a37a</span><span class="op" id="7580900">,</span>&nbsp;<span class="num" id="7580902">0x110b3efd</span><span class="op" id="7580912">,</span>&nbsp;<span class="num" id="7580914">0xdbf98641</span><span class="op" id="7580924">,</span>&nbsp;<span class="num" id="7580926">0xca0093fd</span><span class="op" id="7580936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7580941">0x4e54f70e</span><span class="op" id="7580951">,</span>&nbsp;<span class="num" id="7580953">0x5f5fc9f3</span><span class="op" id="7580963">,</span>&nbsp;<span class="num" id="7580965">0x84a64fb2</span><span class="op" id="7580975">,</span>&nbsp;<span class="num" id="7580977">0x4ea6dc4f</span><span class="op" id="7580987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7580992">0xead27321</span><span class="op" id="7581002">,</span>&nbsp;<span class="num" id="7581004">0xb58dbad2</span><span class="op" id="7581014">,</span>&nbsp;<span class="num" id="7581016">0x312bf560</span><span class="op" id="7581026">,</span>&nbsp;<span class="num" id="7581028">0x7f8d292f</span><span class="op" id="7581038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581043">0xac7766f3</span><span class="op" id="7581053">,</span>&nbsp;<span class="num" id="7581055">0x19fadc21</span><span class="op" id="7581065">,</span>&nbsp;<span class="num" id="7581067">0x28d12941</span><span class="op" id="7581077">,</span>&nbsp;<span class="num" id="7581079">0x575c006e</span><span class="op" id="7581089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581094">0xd014f9a8</span><span class="op" id="7581104">,</span>&nbsp;<span class="num" id="7581106">0xc9ee2589</span><span class="op" id="7581116">,</span>&nbsp;<span class="num" id="7581118">0xe13f0cc8</span><span class="op" id="7581128">,</span>&nbsp;<span class="num" id="7581130">0xb6630ca6</span><span class="op" id="7581140">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581144">}</span><span class="op" id="7581145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581149">[</span><span class="op" id="7581150">]</span><span class="builtintype" id="7581151">uint32</span><span class="op" id="7581157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581162">0xd014f9a8</span><span class="op" id="7581172">,</span>&nbsp;<span class="num" id="7581174">0xc9ee2589</span><span class="op" id="7581184">,</span>&nbsp;<span class="num" id="7581186">0xe13f0cc8</span><span class="op" id="7581196">,</span>&nbsp;<span class="num" id="7581198">0xb6630ca6</span><span class="op" id="7581208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581213">0xc7b5a63</span><span class="op" id="7581222">,</span>&nbsp;<span class="num" id="7581224">0x1319eafe</span><span class="op" id="7581234">,</span>&nbsp;<span class="num" id="7581236">0xb0398890</span><span class="op" id="7581246">,</span>&nbsp;<span class="num" id="7581248">0x664cfbb4</span><span class="op" id="7581258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581263">0xdf7d925a</span><span class="op" id="7581273">,</span>&nbsp;<span class="num" id="7581275">0x1f62b09d</span><span class="op" id="7581285">,</span>&nbsp;<span class="num" id="7581287">0xa320626e</span><span class="op" id="7581297">,</span>&nbsp;<span class="num" id="7581299">0xd6757324</span><span class="op" id="7581309">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581314">0x12c07647</span><span class="op" id="7581324">,</span>&nbsp;<span class="num" id="7581326">0xc01f22c7</span><span class="op" id="7581336">,</span>&nbsp;<span class="num" id="7581338">0xbc42d2f3</span><span class="op" id="7581348">,</span>&nbsp;<span class="num" id="7581350">0x7555114a</span><span class="op" id="7581360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581365">0x6efcd876</span><span class="op" id="7581375">,</span>&nbsp;<span class="num" id="7581377">0xd2df5480</span><span class="op" id="7581387">,</span>&nbsp;<span class="num" id="7581389">0x7c5df034</span><span class="op" id="7581399">,</span>&nbsp;<span class="num" id="7581401">0xc917c3b9</span><span class="op" id="7581411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581416">0x6ea30afc</span><span class="op" id="7581426">,</span>&nbsp;<span class="num" id="7581428">0xbc238cf6</span><span class="op" id="7581438">,</span>&nbsp;<span class="num" id="7581440">0xae82a4b4</span><span class="op" id="7581450">,</span>&nbsp;<span class="num" id="7581452">0xb54a338d</span><span class="op" id="7581462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581467">0x90884413</span><span class="op" id="7581477">,</span>&nbsp;<span class="num" id="7581479">0xd280860a</span><span class="op" id="7581489">,</span>&nbsp;<span class="num" id="7581491">0x12a12842</span><span class="op" id="7581501">,</span>&nbsp;<span class="num" id="7581503">0x1bc89739</span><span class="op" id="7581513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581518">0x7c1f13f7</span><span class="op" id="7581528">,</span>&nbsp;<span class="num" id="7581530">0x4208c219</span><span class="op" id="7581540">,</span>&nbsp;<span class="num" id="7581542">0xc021ae48</span><span class="op" id="7581552">,</span>&nbsp;<span class="num" id="7581554">0x969bf7b</span><span class="op" id="7581563">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581568">0xcc7505eb</span><span class="op" id="7581578">,</span>&nbsp;<span class="num" id="7581580">0x3e17d1ee</span><span class="op" id="7581590">,</span>&nbsp;<span class="num" id="7581592">0x82296c51</span><span class="op" id="7581602">,</span>&nbsp;<span class="num" id="7581604">0xc9481133</span><span class="op" id="7581614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581619">0x2b3708a7</span><span class="op" id="7581629">,</span>&nbsp;<span class="num" id="7581631">0xf262d405</span><span class="op" id="7581641">,</span>&nbsp;<span class="num" id="7581643">0xbc3ebdbf</span><span class="op" id="7581653">,</span>&nbsp;<span class="num" id="7581655">0x4b617d62</span><span class="op" id="7581665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581670">0x2b7e1516</span><span class="op" id="7581680">,</span>&nbsp;<span class="num" id="7581682">0x28aed2a6</span><span class="op" id="7581692">,</span>&nbsp;<span class="num" id="7581694">0xabf71588</span><span class="op" id="7581704">,</span>&nbsp;<span class="num" id="7581706">0x9cf4f3c</span><span class="op" id="7581715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581719">}</span><span class="op" id="7581720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581723">}</span><span class="op" id="7581724">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7581731">//&nbsp;A.2.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;192-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581776">[</span><span class="op" id="7581777">]</span><span class="builtintype" id="7581778">byte</span><span class="op" id="7581782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581787">0x8e</span><span class="op" id="7581791">,</span>&nbsp;<span class="num" id="7581793">0x73</span><span class="op" id="7581797">,</span>&nbsp;<span class="num" id="7581799">0xb0</span><span class="op" id="7581803">,</span>&nbsp;<span class="num" id="7581805">0xf7</span><span class="op" id="7581809">,</span>&nbsp;<span class="num" id="7581811">0xda</span><span class="op" id="7581815">,</span>&nbsp;<span class="num" id="7581817">0x0e</span><span class="op" id="7581821">,</span>&nbsp;<span class="num" id="7581823">0x64</span><span class="op" id="7581827">,</span>&nbsp;<span class="num" id="7581829">0x52</span><span class="op" id="7581833">,</span>&nbsp;<span class="num" id="7581835">0xc8</span><span class="op" id="7581839">,</span>&nbsp;<span class="num" id="7581841">0x10</span><span class="op" id="7581845">,</span>&nbsp;<span class="num" id="7581847">0xf3</span><span class="op" id="7581851">,</span>&nbsp;<span class="num" id="7581853">0x2b</span><span class="op" id="7581857">,</span>&nbsp;<span class="num" id="7581859">0x80</span><span class="op" id="7581863">,</span>&nbsp;<span class="num" id="7581865">0x90</span><span class="op" id="7581869">,</span>&nbsp;<span class="num" id="7581871">0x79</span><span class="op" id="7581875">,</span>&nbsp;<span class="num" id="7581877">0xe5</span><span class="op" id="7581881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581886">0x62</span><span class="op" id="7581890">,</span>&nbsp;<span class="num" id="7581892">0xf8</span><span class="op" id="7581896">,</span>&nbsp;<span class="num" id="7581898">0xea</span><span class="op" id="7581902">,</span>&nbsp;<span class="num" id="7581904">0xd2</span><span class="op" id="7581908">,</span>&nbsp;<span class="num" id="7581910">0x52</span><span class="op" id="7581914">,</span>&nbsp;<span class="num" id="7581916">0x2c</span><span class="op" id="7581920">,</span>&nbsp;<span class="num" id="7581922">0x6b</span><span class="op" id="7581926">,</span>&nbsp;<span class="num" id="7581928">0x7b</span><span class="op" id="7581932">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581936">}</span><span class="op" id="7581937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7581941">[</span><span class="op" id="7581942">]</span><span class="builtintype" id="7581943">uint32</span><span class="op" id="7581949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7581954">0x8e73b0f7</span><span class="op" id="7581964">,</span>&nbsp;<span class="num" id="7581966">0xda0e6452</span><span class="op" id="7581976">,</span>&nbsp;<span class="num" id="7581978">0xc810f32b</span><span class="op" id="7581988">,</span>&nbsp;<span class="num" id="7581990">0x809079e5</span><span class="op" id="7582000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582005">0x62f8ead2</span><span class="op" id="7582015">,</span>&nbsp;<span class="num" id="7582017">0x522c6b7b</span><span class="op" id="7582027">,</span>&nbsp;<span class="num" id="7582029">0xfe0c91f7</span><span class="op" id="7582039">,</span>&nbsp;<span class="num" id="7582041">0x2402f5a5</span><span class="op" id="7582051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582056">0xec12068e</span><span class="op" id="7582066">,</span>&nbsp;<span class="num" id="7582068">0x6c827f6b</span><span class="op" id="7582078">,</span>&nbsp;<span class="num" id="7582080">0x0e7a95b9</span><span class="op" id="7582090">,</span>&nbsp;<span class="num" id="7582092">0x5c56fec2</span><span class="op" id="7582102">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582107">0x4db7b4bd</span><span class="op" id="7582117">,</span>&nbsp;<span class="num" id="7582119">0x69b54118</span><span class="op" id="7582129">,</span>&nbsp;<span class="num" id="7582131">0x85a74796</span><span class="op" id="7582141">,</span>&nbsp;<span class="num" id="7582143">0xe92538fd</span><span class="op" id="7582153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582158">0xe75fad44</span><span class="op" id="7582168">,</span>&nbsp;<span class="num" id="7582170">0xbb095386</span><span class="op" id="7582180">,</span>&nbsp;<span class="num" id="7582182">0x485af057</span><span class="op" id="7582192">,</span>&nbsp;<span class="num" id="7582194">0x21efb14f</span><span class="op" id="7582204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582209">0xa448f6d9</span><span class="op" id="7582219">,</span>&nbsp;<span class="num" id="7582221">0x4d6dce24</span><span class="op" id="7582231">,</span>&nbsp;<span class="num" id="7582233">0xaa326360</span><span class="op" id="7582243">,</span>&nbsp;<span class="num" id="7582245">0x113b30e6</span><span class="op" id="7582255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582260">0xa25e7ed5</span><span class="op" id="7582270">,</span>&nbsp;<span class="num" id="7582272">0x83b1cf9a</span><span class="op" id="7582282">,</span>&nbsp;<span class="num" id="7582284">0x27f93943</span><span class="op" id="7582294">,</span>&nbsp;<span class="num" id="7582296">0x6a94f767</span><span class="op" id="7582306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582311">0xc0a69407</span><span class="op" id="7582321">,</span>&nbsp;<span class="num" id="7582323">0xd19da4e1</span><span class="op" id="7582333">,</span>&nbsp;<span class="num" id="7582335">0xec1786eb</span><span class="op" id="7582345">,</span>&nbsp;<span class="num" id="7582347">0x6fa64971</span><span class="op" id="7582357">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582362">0x485f7032</span><span class="op" id="7582372">,</span>&nbsp;<span class="num" id="7582374">0x22cb8755</span><span class="op" id="7582384">,</span>&nbsp;<span class="num" id="7582386">0xe26d1352</span><span class="op" id="7582396">,</span>&nbsp;<span class="num" id="7582398">0x33f0b7b3</span><span class="op" id="7582408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582413">0x40beeb28</span><span class="op" id="7582423">,</span>&nbsp;<span class="num" id="7582425">0x2f18a259</span><span class="op" id="7582435">,</span>&nbsp;<span class="num" id="7582437">0x6747d26b</span><span class="op" id="7582447">,</span>&nbsp;<span class="num" id="7582449">0x458c553e</span><span class="op" id="7582459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582464">0xa7e1466c</span><span class="op" id="7582474">,</span>&nbsp;<span class="num" id="7582476">0x9411f1df</span><span class="op" id="7582486">,</span>&nbsp;<span class="num" id="7582488">0x821f750a</span><span class="op" id="7582498">,</span>&nbsp;<span class="num" id="7582500">0xad07d753</span><span class="op" id="7582510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582515">0xca400538</span><span class="op" id="7582525">,</span>&nbsp;<span class="num" id="7582527">0x8fcc5006</span><span class="op" id="7582537">,</span>&nbsp;<span class="num" id="7582539">0x282d166a</span><span class="op" id="7582549">,</span>&nbsp;<span class="num" id="7582551">0xbc3ce7b5</span><span class="op" id="7582561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582566">0xe98ba06f</span><span class="op" id="7582576">,</span>&nbsp;<span class="num" id="7582578">0x448c773c</span><span class="op" id="7582588">,</span>&nbsp;<span class="num" id="7582590">0x8ecc7204</span><span class="op" id="7582600">,</span>&nbsp;<span class="num" id="7582602">0x01002202</span><span class="op" id="7582612">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582616">}</span><span class="op" id="7582617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7582621">nil</span><span class="op" id="7582624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582627">}</span><span class="op" id="7582628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7582635">//&nbsp;A.3.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;256-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582680">[</span><span class="op" id="7582681">]</span><span class="builtintype" id="7582682">byte</span><span class="op" id="7582686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582691">0x60</span><span class="op" id="7582695">,</span>&nbsp;<span class="num" id="7582697">0x3d</span><span class="op" id="7582701">,</span>&nbsp;<span class="num" id="7582703">0xeb</span><span class="op" id="7582707">,</span>&nbsp;<span class="num" id="7582709">0x10</span><span class="op" id="7582713">,</span>&nbsp;<span class="num" id="7582715">0x15</span><span class="op" id="7582719">,</span>&nbsp;<span class="num" id="7582721">0xca</span><span class="op" id="7582725">,</span>&nbsp;<span class="num" id="7582727">0x71</span><span class="op" id="7582731">,</span>&nbsp;<span class="num" id="7582733">0xbe</span><span class="op" id="7582737">,</span>&nbsp;<span class="num" id="7582739">0x2b</span><span class="op" id="7582743">,</span>&nbsp;<span class="num" id="7582745">0x73</span><span class="op" id="7582749">,</span>&nbsp;<span class="num" id="7582751">0xae</span><span class="op" id="7582755">,</span>&nbsp;<span class="num" id="7582757">0xf0</span><span class="op" id="7582761">,</span>&nbsp;<span class="num" id="7582763">0x85</span><span class="op" id="7582767">,</span>&nbsp;<span class="num" id="7582769">0x7d</span><span class="op" id="7582773">,</span>&nbsp;<span class="num" id="7582775">0x77</span><span class="op" id="7582779">,</span>&nbsp;<span class="num" id="7582781">0x81</span><span class="op" id="7582785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582790">0x1f</span><span class="op" id="7582794">,</span>&nbsp;<span class="num" id="7582796">0x35</span><span class="op" id="7582800">,</span>&nbsp;<span class="num" id="7582802">0x2c</span><span class="op" id="7582806">,</span>&nbsp;<span class="num" id="7582808">0x07</span><span class="op" id="7582812">,</span>&nbsp;<span class="num" id="7582814">0x3b</span><span class="op" id="7582818">,</span>&nbsp;<span class="num" id="7582820">0x61</span><span class="op" id="7582824">,</span>&nbsp;<span class="num" id="7582826">0x08</span><span class="op" id="7582830">,</span>&nbsp;<span class="num" id="7582832">0xd7</span><span class="op" id="7582836">,</span>&nbsp;<span class="num" id="7582838">0x2d</span><span class="op" id="7582842">,</span>&nbsp;<span class="num" id="7582844">0x98</span><span class="op" id="7582848">,</span>&nbsp;<span class="num" id="7582850">0x10</span><span class="op" id="7582854">,</span>&nbsp;<span class="num" id="7582856">0xa3</span><span class="op" id="7582860">,</span>&nbsp;<span class="num" id="7582862">0x09</span><span class="op" id="7582866">,</span>&nbsp;<span class="num" id="7582868">0x14</span><span class="op" id="7582872">,</span>&nbsp;<span class="num" id="7582874">0xdf</span><span class="op" id="7582878">,</span>&nbsp;<span class="num" id="7582880">0xf4</span><span class="op" id="7582884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582888">}</span><span class="op" id="7582889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7582893">[</span><span class="op" id="7582894">]</span><span class="builtintype" id="7582895">uint32</span><span class="op" id="7582901">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582906">0x603deb10</span><span class="op" id="7582916">,</span>&nbsp;<span class="num" id="7582918">0x15ca71be</span><span class="op" id="7582928">,</span>&nbsp;<span class="num" id="7582930">0x2b73aef0</span><span class="op" id="7582940">,</span>&nbsp;<span class="num" id="7582942">0x857d7781</span><span class="op" id="7582952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7582957">0x1f352c07</span><span class="op" id="7582967">,</span>&nbsp;<span class="num" id="7582969">0x3b6108d7</span><span class="op" id="7582979">,</span>&nbsp;<span class="num" id="7582981">0x2d9810a3</span><span class="op" id="7582991">,</span>&nbsp;<span class="num" id="7582993">0x0914dff4</span><span class="op" id="7583003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7583008">0x9ba35411</span><span class="op" id="7583018">,</span>&nbsp;<span class="num" id="7583020">0x8e6925af</span><span class="op" id="7583030">,</span>&nbsp;<span class="num" id="7583032">0xa51a8b5f</span><span class="op" id="7583042">,</span>&nbsp;<span class="num" id="7583044">0x2067fcde</span><span class="op" id="7583054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7583059">0xa8b09c1a</span><span class="op" id="7583069">,</span>&nbsp;<span class="num" id="7583071">0x93d194cd</span><span class="op" id="7583081">,</span>&nbsp;<span class="num" id="7583083">0xbe49846e</span><span class="op" id="7583093">,</span>&nbsp;<span class="num" id="7583095">0xb75d5b9a</span><span class="op" id="7583105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7583110">0xd59aecb8</span><span class="op" id="7583120">,</span>&nbsp;<span class="num" id="7583122">0x5bf3c917</span><span class="op" id="7583132">,</span>&nbsp;<span class="num" id="7583134">0xfee94248</span><span class="op" id="7583144">,</span>&nbsp;<span class="num" id="7583146">0xde8ebe96</span><span class="op" id="7583156">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7583161">0xb5a9328a</span><span class="op" id="7583171">,</span>&nbsp;<span class="num" id="7583173">0x2678a647</span><span class="op" id="7583183">,</span>&nbsp;<span class="num" id="7583185">0x98312229</span><span class="op" id="7583195">,</span>&nbsp;<span class="num" id="7583197">0x2f6c79b3</span><span class="op" id="7583207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7583212">0x812c81ad</span><span class="op" id="7583222">,</span>&nbsp;<span class="num" id="7583224">0xdadf48ba</span><span class="op" id="7583234">,</span>&nbsp;<span class="num" id="7583236">0x24360af2</span><span class="op" id="7583246">,</span>&nbsp;<span class="num" id="7583248">0xfab8b464</span><span class="op" id="7583258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7583263">0x98c5bfc9</span><span class="op" id="7583273">,</span>&nbsp;<span class="num" id="7583275">0xbebd198e</span><span class="op" id="7583285">,</span>&nbsp;<span class="num" id="7583287">0x268c3ba7</span><span class="op" id="7583297">,</span>&nbsp;<span class="num" id="7583299">0x09e04214</span><span class="op" id="7583309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7583314">0x68007bac</span><span class="op" id="7583324">,</span>&nbsp;<span class="num" id="7583326">0xb2df3316</span><span class="op" id="7583336">,</span>&nbsp;<span class="num" id="7583338">0x96e939e4</span><span class="op" id="7583348">,</span>&nbsp;<span class="num" id="7583350">0x6c518d80</span><span class="op" id="7583360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7583365">0xc814e204</span><span class="op" id="7583375">,</span>&nbsp;<span class="num" id="7583377">0x76a9fb8a</span><span class="op" id="7583387">,</span>&nbsp;<span class="num" id="7583389">0x5025c02d</span><span class="op" id="7583399">,</span>&nbsp;<span class="num" id="7583401">0x59c58239</span><span class="op" id="7583411">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7583416">0xde136967</span><span class="op" id="7583426">,</span>&nbsp;<span class="num" id="7583428">0x6ccc5a71</span><span class="op" id="7583438">,</span>&nbsp;<span class="num" id="7583440">0xfa256395</span><span class="op" id="7583450">,</span>&nbsp;<span class="num" id="7583452">0x9674ee15</span><span class="op" id="7583462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7583467">0x5886ca5d</span><span class="op" id="7583477">,</span>&nbsp;<span class="num" id="7583479">0x2e2f31d7</span><span class="op" id="7583489">,</span>&nbsp;<span class="num" id="7583491">0x7e0af1fa</span><span class="op" id="7583501">,</span>&nbsp;<span class="num" id="7583503">0x27cf73c3</span><span class="op" id="7583513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7583518">0x749c47ab</span><span class="op" id="7583528">,</span>&nbsp;<span class="num" id="7583530">0x18501dda</span><span class="op" id="7583540">,</span>&nbsp;<span class="num" id="7583542">0xe2757e4f</span><span class="op" id="7583552">,</span>&nbsp;<span class="num" id="7583554">0x7401905a</span><span class="op" id="7583564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7583569">0xcafaaae3</span><span class="op" id="7583579">,</span>&nbsp;<span class="num" id="7583581">0xe4d59b34</span><span class="op" id="7583591">,</span>&nbsp;<span class="num" id="7583593">0x9adf6ace</span><span class="op" id="7583603">,</span>&nbsp;<span class="num" id="7583605">0xbd10190d</span><span class="op" id="7583615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7583620">0xfe4890d1</span><span class="op" id="7583630">,</span>&nbsp;<span class="num" id="7583632">0xe6188d0b</span><span class="op" id="7583642">,</span>&nbsp;<span class="num" id="7583644">0x046df344</span><span class="op" id="7583654">,</span>&nbsp;<span class="num" id="7583656">0x706c631e</span><span class="op" id="7583666">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7583670">}</span><span class="op" id="7583671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7583675">nil</span><span class="op" id="7583678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7583681">}</span><span class="op" id="7583682">,</span><br>
<span class="lineno"></span><span class="op" id="7583684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="7583687">//&nbsp;Test&nbsp;key&nbsp;expansion&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7583736">func</span>&nbsp;<span class="ident" id="7583741">TestExpandKey</span><span class="op" id="7583754">(</span><span class="ident" id="7583755">t</span>&nbsp;<span class="op" id="7583757">*</span><span class="ident" id="7583758">testing</span><span class="op" id="7583765">.</span><span class="ident" id="7583766">T</span><span class="op" id="7583767">)</span>&nbsp;<span class="op" id="7583769">{</span><br>
<span class="lineno"></span><span class="ident" id="7583771">L</span><span class="op" id="7583772">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583775">for</span>&nbsp;<span class="ident" id="7583779">i</span><span class="op" id="7583780">,</span>&nbsp;<span class="ident" id="7583782">tt</span>&nbsp;<span class="op" id="7583785">:=</span>&nbsp;<span class="keyword" id="7583788">range</span>&nbsp;<span class="ident" id="7583794">keyTests</span>&nbsp;<span class="op" id="7583803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7583807">enc</span>&nbsp;<span class="op" id="7583811">:=</span>&nbsp;<span class="builtinfunc" id="7583814">make</span><span class="op" id="7583818">(</span><span class="op" id="7583819">[</span><span class="op" id="7583820">]</span><span class="builtintype" id="7583821">uint32</span><span class="op" id="7583827">,</span>&nbsp;<span class="builtinfunc" id="7583829">len</span><span class="op" id="7583832">(</span><span class="ident" id="7583833">tt</span><span class="op" id="7583835">.</span><span class="ident" id="7583836">enc</span><span class="op" id="7583839">)</span><span class="op" id="7583840">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583844">var</span>&nbsp;<span class="ident" id="7583848">dec</span>&nbsp;<span class="op" id="7583852">[</span><span class="op" id="7583853">]</span><span class="builtintype" id="7583854">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7583863">if</span>&nbsp;<span class="ident" id="7583866">tt</span><span class="op" id="7583868">.</span><span class="ident" id="7583869">dec</span>&nbsp;<span class="op" id="7583873">!=</span>&nbsp;<span class="ident" id="7583876">nil</span>&nbsp;<span class="op" id="7583880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7583885">dec</span>&nbsp;<span class="op" id="7583889">=</span>&nbsp;<span class="builtinfunc" id="7583891">make</span><span class="op" id="7583895">(</span><span class="op" id="7583896">[</span><span class="op" id="7583897">]</span><span class="builtintype" id="7583898">uint32</span><span class="op" id="7583904">,</span>&nbsp;<span class="builtinfunc" id="7583906">len</span><span class="op" id="7583909">(</span><span class="ident" id="7583910">tt</span><span class="op" id="7583912">.</span><span class="ident" id="7583913">dec</span><span class="op" id="7583916">)</span><span class="op" id="7583917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7583921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7583925">//&nbsp;This&nbsp;test&nbsp;could&nbsp;only&nbsp;test&nbsp;Go&nbsp;version&nbsp;of&nbsp;expandKey&nbsp;because&nbsp;asm</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7583992">//&nbsp;version&nbsp;might&nbsp;use&nbsp;different&nbsp;memory&nbsp;layout&nbsp;for&nbsp;expanded&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7584057">//&nbsp;This&nbsp;is&nbsp;OK&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;expanded&nbsp;keys&nbsp;to&nbsp;the&nbsp;outside</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7584126">expandKeyGo</span><span class="op" id="7584137">(</span><span class="ident" id="7584138">tt</span><span class="op" id="7584140">.</span><span class="ident" id="7584141">key</span><span class="op" id="7584144">,</span>&nbsp;<span class="ident" id="7584146">enc</span><span class="op" id="7584149">,</span>&nbsp;<span class="ident" id="7584151">dec</span><span class="op" id="7584154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584158">for</span>&nbsp;<span class="ident" id="7584162">j</span><span class="op" id="7584163">,</span>&nbsp;<span class="ident" id="7584165">v</span>&nbsp;<span class="op" id="7584167">:=</span>&nbsp;<span class="keyword" id="7584170">range</span>&nbsp;<span class="ident" id="7584176">enc</span>&nbsp;<span class="op" id="7584180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584185">if</span>&nbsp;<span class="ident" id="7584188">v</span>&nbsp;<span class="op" id="7584190">!=</span>&nbsp;<span class="ident" id="7584193">tt</span><span class="op" id="7584195">.</span><span class="ident" id="7584196">enc</span><span class="op" id="7584199">[</span><span class="ident" id="7584200">j</span><span class="op" id="7584201">]</span>&nbsp;<span class="op" id="7584203">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7584209">t</span><span class="op" id="7584210">.</span><span class="ident" id="7584211">Errorf</span><span class="op" id="7584217">(</span><span class="string" id="7584218">&#34;key&nbsp;%d:&nbsp;enc[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7584251">,</span>&nbsp;<span class="ident" id="7584253">i</span><span class="op" id="7584254">,</span>&nbsp;<span class="ident" id="7584256">j</span><span class="op" id="7584257">,</span>&nbsp;<span class="ident" id="7584259">v</span><span class="op" id="7584260">,</span>&nbsp;<span class="ident" id="7584262">tt</span><span class="op" id="7584264">.</span><span class="ident" id="7584265">enc</span><span class="op" id="7584268">[</span><span class="ident" id="7584269">j</span><span class="op" id="7584270">]</span><span class="op" id="7584271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584277">continue</span>&nbsp;<span class="ident" id="7584286">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584299">if</span>&nbsp;<span class="ident" id="7584302">dec</span>&nbsp;<span class="op" id="7584306">!=</span>&nbsp;<span class="ident" id="7584309">nil</span>&nbsp;<span class="op" id="7584313">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584318">for</span>&nbsp;<span class="ident" id="7584322">j</span><span class="op" id="7584323">,</span>&nbsp;<span class="ident" id="7584325">v</span>&nbsp;<span class="op" id="7584327">:=</span>&nbsp;<span class="keyword" id="7584330">range</span>&nbsp;<span class="ident" id="7584336">dec</span>&nbsp;<span class="op" id="7584340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584346">if</span>&nbsp;<span class="ident" id="7584349">v</span>&nbsp;<span class="op" id="7584351">!=</span>&nbsp;<span class="ident" id="7584354">tt</span><span class="op" id="7584356">.</span><span class="ident" id="7584357">dec</span><span class="op" id="7584360">[</span><span class="ident" id="7584361">j</span><span class="op" id="7584362">]</span>&nbsp;<span class="op" id="7584364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7584371">t</span><span class="op" id="7584372">.</span><span class="ident" id="7584373">Errorf</span><span class="op" id="7584379">(</span><span class="string" id="7584380">&#34;key&nbsp;%d:&nbsp;dec[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7584413">,</span>&nbsp;<span class="ident" id="7584415">i</span><span class="op" id="7584416">,</span>&nbsp;<span class="ident" id="7584418">j</span><span class="op" id="7584419">,</span>&nbsp;<span class="ident" id="7584421">v</span><span class="op" id="7584422">,</span>&nbsp;<span class="ident" id="7584424">tt</span><span class="op" id="7584426">.</span><span class="ident" id="7584427">dec</span><span class="op" id="7584430">[</span><span class="ident" id="7584431">j</span><span class="op" id="7584432">]</span><span class="op" id="7584433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7584440">continue</span>&nbsp;<span class="ident" id="7584449">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584455">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584467">}</span><br>
<span class="lineno"></span><span class="op" id="7584469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="7584472">//&nbsp;Appendix&nbsp;B,&nbsp;C&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Cipher&nbsp;examples,&nbsp;Example&nbsp;vectors.</span><br>
<span class="lineno"></span><span class="keyword" id="7584536">type</span>&nbsp;<span class="ident" id="7584541">CryptTest</span>&nbsp;<span class="keyword" id="7584551">struct</span>&nbsp;<span class="op" id="7584558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7584561">key</span>&nbsp;<span class="op" id="7584565">[</span><span class="op" id="7584566">]</span><span class="builtintype" id="7584567">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7584573">in</span>&nbsp;&nbsp;<span class="op" id="7584577">[</span><span class="op" id="7584578">]</span><span class="builtintype" id="7584579">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7584585">out</span>&nbsp;<span class="op" id="7584589">[</span><span class="op" id="7584590">]</span><span class="builtintype" id="7584591">byte</span><br>
<span class="lineno">250</span><span class="op" id="7584596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7584599">var</span>&nbsp;<span class="ident" id="7584603">encryptTests</span>&nbsp;<span class="op" id="7584616">=</span>&nbsp;<span class="op" id="7584618">[</span><span class="op" id="7584619">]</span><span class="ident" id="7584620">CryptTest</span><span class="op" id="7584629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7584636">//&nbsp;Appendix&nbsp;B.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584653">[</span><span class="op" id="7584654">]</span><span class="builtintype" id="7584655">byte</span><span class="op" id="7584659">{</span><span class="num" id="7584660">0x2b</span><span class="op" id="7584664">,</span>&nbsp;<span class="num" id="7584666">0x7e</span><span class="op" id="7584670">,</span>&nbsp;<span class="num" id="7584672">0x15</span><span class="op" id="7584676">,</span>&nbsp;<span class="num" id="7584678">0x16</span><span class="op" id="7584682">,</span>&nbsp;<span class="num" id="7584684">0x28</span><span class="op" id="7584688">,</span>&nbsp;<span class="num" id="7584690">0xae</span><span class="op" id="7584694">,</span>&nbsp;<span class="num" id="7584696">0xd2</span><span class="op" id="7584700">,</span>&nbsp;<span class="num" id="7584702">0xa6</span><span class="op" id="7584706">,</span>&nbsp;<span class="num" id="7584708">0xab</span><span class="op" id="7584712">,</span>&nbsp;<span class="num" id="7584714">0xf7</span><span class="op" id="7584718">,</span>&nbsp;<span class="num" id="7584720">0x15</span><span class="op" id="7584724">,</span>&nbsp;<span class="num" id="7584726">0x88</span><span class="op" id="7584730">,</span>&nbsp;<span class="num" id="7584732">0x09</span><span class="op" id="7584736">,</span>&nbsp;<span class="num" id="7584738">0xcf</span><span class="op" id="7584742">,</span>&nbsp;<span class="num" id="7584744">0x4f</span><span class="op" id="7584748">,</span>&nbsp;<span class="num" id="7584750">0x3c</span><span class="op" id="7584754">}</span><span class="op" id="7584755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584759">[</span><span class="op" id="7584760">]</span><span class="builtintype" id="7584761">byte</span><span class="op" id="7584765">{</span><span class="num" id="7584766">0x32</span><span class="op" id="7584770">,</span>&nbsp;<span class="num" id="7584772">0x43</span><span class="op" id="7584776">,</span>&nbsp;<span class="num" id="7584778">0xf6</span><span class="op" id="7584782">,</span>&nbsp;<span class="num" id="7584784">0xa8</span><span class="op" id="7584788">,</span>&nbsp;<span class="num" id="7584790">0x88</span><span class="op" id="7584794">,</span>&nbsp;<span class="num" id="7584796">0x5a</span><span class="op" id="7584800">,</span>&nbsp;<span class="num" id="7584802">0x30</span><span class="op" id="7584806">,</span>&nbsp;<span class="num" id="7584808">0x8d</span><span class="op" id="7584812">,</span>&nbsp;<span class="num" id="7584814">0x31</span><span class="op" id="7584818">,</span>&nbsp;<span class="num" id="7584820">0x31</span><span class="op" id="7584824">,</span>&nbsp;<span class="num" id="7584826">0x98</span><span class="op" id="7584830">,</span>&nbsp;<span class="num" id="7584832">0xa2</span><span class="op" id="7584836">,</span>&nbsp;<span class="num" id="7584838">0xe0</span><span class="op" id="7584842">,</span>&nbsp;<span class="num" id="7584844">0x37</span><span class="op" id="7584848">,</span>&nbsp;<span class="num" id="7584850">0x07</span><span class="op" id="7584854">,</span>&nbsp;<span class="num" id="7584856">0x34</span><span class="op" id="7584860">}</span><span class="op" id="7584861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584865">[</span><span class="op" id="7584866">]</span><span class="builtintype" id="7584867">byte</span><span class="op" id="7584871">{</span><span class="num" id="7584872">0x39</span><span class="op" id="7584876">,</span>&nbsp;<span class="num" id="7584878">0x25</span><span class="op" id="7584882">,</span>&nbsp;<span class="num" id="7584884">0x84</span><span class="op" id="7584888">,</span>&nbsp;<span class="num" id="7584890">0x1d</span><span class="op" id="7584894">,</span>&nbsp;<span class="num" id="7584896">0x02</span><span class="op" id="7584900">,</span>&nbsp;<span class="num" id="7584902">0xdc</span><span class="op" id="7584906">,</span>&nbsp;<span class="num" id="7584908">0x09</span><span class="op" id="7584912">,</span>&nbsp;<span class="num" id="7584914">0xfb</span><span class="op" id="7584918">,</span>&nbsp;<span class="num" id="7584920">0xdc</span><span class="op" id="7584924">,</span>&nbsp;<span class="num" id="7584926">0x11</span><span class="op" id="7584930">,</span>&nbsp;<span class="num" id="7584932">0x85</span><span class="op" id="7584936">,</span>&nbsp;<span class="num" id="7584938">0x97</span><span class="op" id="7584942">,</span>&nbsp;<span class="num" id="7584944">0x19</span><span class="op" id="7584948">,</span>&nbsp;<span class="num" id="7584950">0x6a</span><span class="op" id="7584954">,</span>&nbsp;<span class="num" id="7584956">0x0b</span><span class="op" id="7584960">,</span>&nbsp;<span class="num" id="7584962">0x32</span><span class="op" id="7584966">}</span><span class="op" id="7584967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584970">}</span><span class="op" id="7584971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7584974">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7584978">//&nbsp;Appendix&nbsp;C.1.&nbsp;&nbsp;AES-128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585006">[</span><span class="op" id="7585007">]</span><span class="builtintype" id="7585008">byte</span><span class="op" id="7585012">{</span><span class="num" id="7585013">0x00</span><span class="op" id="7585017">,</span>&nbsp;<span class="num" id="7585019">0x01</span><span class="op" id="7585023">,</span>&nbsp;<span class="num" id="7585025">0x02</span><span class="op" id="7585029">,</span>&nbsp;<span class="num" id="7585031">0x03</span><span class="op" id="7585035">,</span>&nbsp;<span class="num" id="7585037">0x04</span><span class="op" id="7585041">,</span>&nbsp;<span class="num" id="7585043">0x05</span><span class="op" id="7585047">,</span>&nbsp;<span class="num" id="7585049">0x06</span><span class="op" id="7585053">,</span>&nbsp;<span class="num" id="7585055">0x07</span><span class="op" id="7585059">,</span>&nbsp;<span class="num" id="7585061">0x08</span><span class="op" id="7585065">,</span>&nbsp;<span class="num" id="7585067">0x09</span><span class="op" id="7585071">,</span>&nbsp;<span class="num" id="7585073">0x0a</span><span class="op" id="7585077">,</span>&nbsp;<span class="num" id="7585079">0x0b</span><span class="op" id="7585083">,</span>&nbsp;<span class="num" id="7585085">0x0c</span><span class="op" id="7585089">,</span>&nbsp;<span class="num" id="7585091">0x0d</span><span class="op" id="7585095">,</span>&nbsp;<span class="num" id="7585097">0x0e</span><span class="op" id="7585101">,</span>&nbsp;<span class="num" id="7585103">0x0f</span><span class="op" id="7585107">}</span><span class="op" id="7585108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585112">[</span><span class="op" id="7585113">]</span><span class="builtintype" id="7585114">byte</span><span class="op" id="7585118">{</span><span class="num" id="7585119">0x00</span><span class="op" id="7585123">,</span>&nbsp;<span class="num" id="7585125">0x11</span><span class="op" id="7585129">,</span>&nbsp;<span class="num" id="7585131">0x22</span><span class="op" id="7585135">,</span>&nbsp;<span class="num" id="7585137">0x33</span><span class="op" id="7585141">,</span>&nbsp;<span class="num" id="7585143">0x44</span><span class="op" id="7585147">,</span>&nbsp;<span class="num" id="7585149">0x55</span><span class="op" id="7585153">,</span>&nbsp;<span class="num" id="7585155">0x66</span><span class="op" id="7585159">,</span>&nbsp;<span class="num" id="7585161">0x77</span><span class="op" id="7585165">,</span>&nbsp;<span class="num" id="7585167">0x88</span><span class="op" id="7585171">,</span>&nbsp;<span class="num" id="7585173">0x99</span><span class="op" id="7585177">,</span>&nbsp;<span class="num" id="7585179">0xaa</span><span class="op" id="7585183">,</span>&nbsp;<span class="num" id="7585185">0xbb</span><span class="op" id="7585189">,</span>&nbsp;<span class="num" id="7585191">0xcc</span><span class="op" id="7585195">,</span>&nbsp;<span class="num" id="7585197">0xdd</span><span class="op" id="7585201">,</span>&nbsp;<span class="num" id="7585203">0xee</span><span class="op" id="7585207">,</span>&nbsp;<span class="num" id="7585209">0xff</span><span class="op" id="7585213">}</span><span class="op" id="7585214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585218">[</span><span class="op" id="7585219">]</span><span class="builtintype" id="7585220">byte</span><span class="op" id="7585224">{</span><span class="num" id="7585225">0x69</span><span class="op" id="7585229">,</span>&nbsp;<span class="num" id="7585231">0xc4</span><span class="op" id="7585235">,</span>&nbsp;<span class="num" id="7585237">0xe0</span><span class="op" id="7585241">,</span>&nbsp;<span class="num" id="7585243">0xd8</span><span class="op" id="7585247">,</span>&nbsp;<span class="num" id="7585249">0x6a</span><span class="op" id="7585253">,</span>&nbsp;<span class="num" id="7585255">0x7b</span><span class="op" id="7585259">,</span>&nbsp;<span class="num" id="7585261">0x04</span><span class="op" id="7585265">,</span>&nbsp;<span class="num" id="7585267">0x30</span><span class="op" id="7585271">,</span>&nbsp;<span class="num" id="7585273">0xd8</span><span class="op" id="7585277">,</span>&nbsp;<span class="num" id="7585279">0xcd</span><span class="op" id="7585283">,</span>&nbsp;<span class="num" id="7585285">0xb7</span><span class="op" id="7585289">,</span>&nbsp;<span class="num" id="7585291">0x80</span><span class="op" id="7585295">,</span>&nbsp;<span class="num" id="7585297">0x70</span><span class="op" id="7585301">,</span>&nbsp;<span class="num" id="7585303">0xb4</span><span class="op" id="7585307">,</span>&nbsp;<span class="num" id="7585309">0xc5</span><span class="op" id="7585313">,</span>&nbsp;<span class="num" id="7585315">0x5a</span><span class="op" id="7585319">}</span><span class="op" id="7585320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585323">}</span><span class="op" id="7585324">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7585331">//&nbsp;Appendix&nbsp;C.2.&nbsp;&nbsp;AES-192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585359">[</span><span class="op" id="7585360">]</span><span class="builtintype" id="7585361">byte</span><span class="op" id="7585365">{</span><span class="num" id="7585366">0x00</span><span class="op" id="7585370">,</span>&nbsp;<span class="num" id="7585372">0x01</span><span class="op" id="7585376">,</span>&nbsp;<span class="num" id="7585378">0x02</span><span class="op" id="7585382">,</span>&nbsp;<span class="num" id="7585384">0x03</span><span class="op" id="7585388">,</span>&nbsp;<span class="num" id="7585390">0x04</span><span class="op" id="7585394">,</span>&nbsp;<span class="num" id="7585396">0x05</span><span class="op" id="7585400">,</span>&nbsp;<span class="num" id="7585402">0x06</span><span class="op" id="7585406">,</span>&nbsp;<span class="num" id="7585408">0x07</span><span class="op" id="7585412">,</span>&nbsp;<span class="num" id="7585414">0x08</span><span class="op" id="7585418">,</span>&nbsp;<span class="num" id="7585420">0x09</span><span class="op" id="7585424">,</span>&nbsp;<span class="num" id="7585426">0x0a</span><span class="op" id="7585430">,</span>&nbsp;<span class="num" id="7585432">0x0b</span><span class="op" id="7585436">,</span>&nbsp;<span class="num" id="7585438">0x0c</span><span class="op" id="7585442">,</span>&nbsp;<span class="num" id="7585444">0x0d</span><span class="op" id="7585448">,</span>&nbsp;<span class="num" id="7585450">0x0e</span><span class="op" id="7585454">,</span>&nbsp;<span class="num" id="7585456">0x0f</span><span class="op" id="7585460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7585465">0x10</span><span class="op" id="7585469">,</span>&nbsp;<span class="num" id="7585471">0x11</span><span class="op" id="7585475">,</span>&nbsp;<span class="num" id="7585477">0x12</span><span class="op" id="7585481">,</span>&nbsp;<span class="num" id="7585483">0x13</span><span class="op" id="7585487">,</span>&nbsp;<span class="num" id="7585489">0x14</span><span class="op" id="7585493">,</span>&nbsp;<span class="num" id="7585495">0x15</span><span class="op" id="7585499">,</span>&nbsp;<span class="num" id="7585501">0x16</span><span class="op" id="7585505">,</span>&nbsp;<span class="num" id="7585507">0x17</span><span class="op" id="7585511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585515">}</span><span class="op" id="7585516">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585520">[</span><span class="op" id="7585521">]</span><span class="builtintype" id="7585522">byte</span><span class="op" id="7585526">{</span><span class="num" id="7585527">0x00</span><span class="op" id="7585531">,</span>&nbsp;<span class="num" id="7585533">0x11</span><span class="op" id="7585537">,</span>&nbsp;<span class="num" id="7585539">0x22</span><span class="op" id="7585543">,</span>&nbsp;<span class="num" id="7585545">0x33</span><span class="op" id="7585549">,</span>&nbsp;<span class="num" id="7585551">0x44</span><span class="op" id="7585555">,</span>&nbsp;<span class="num" id="7585557">0x55</span><span class="op" id="7585561">,</span>&nbsp;<span class="num" id="7585563">0x66</span><span class="op" id="7585567">,</span>&nbsp;<span class="num" id="7585569">0x77</span><span class="op" id="7585573">,</span>&nbsp;<span class="num" id="7585575">0x88</span><span class="op" id="7585579">,</span>&nbsp;<span class="num" id="7585581">0x99</span><span class="op" id="7585585">,</span>&nbsp;<span class="num" id="7585587">0xaa</span><span class="op" id="7585591">,</span>&nbsp;<span class="num" id="7585593">0xbb</span><span class="op" id="7585597">,</span>&nbsp;<span class="num" id="7585599">0xcc</span><span class="op" id="7585603">,</span>&nbsp;<span class="num" id="7585605">0xdd</span><span class="op" id="7585609">,</span>&nbsp;<span class="num" id="7585611">0xee</span><span class="op" id="7585615">,</span>&nbsp;<span class="num" id="7585617">0xff</span><span class="op" id="7585621">}</span><span class="op" id="7585622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585626">[</span><span class="op" id="7585627">]</span><span class="builtintype" id="7585628">byte</span><span class="op" id="7585632">{</span><span class="num" id="7585633">0xdd</span><span class="op" id="7585637">,</span>&nbsp;<span class="num" id="7585639">0xa9</span><span class="op" id="7585643">,</span>&nbsp;<span class="num" id="7585645">0x7c</span><span class="op" id="7585649">,</span>&nbsp;<span class="num" id="7585651">0xa4</span><span class="op" id="7585655">,</span>&nbsp;<span class="num" id="7585657">0x86</span><span class="op" id="7585661">,</span>&nbsp;<span class="num" id="7585663">0x4c</span><span class="op" id="7585667">,</span>&nbsp;<span class="num" id="7585669">0xdf</span><span class="op" id="7585673">,</span>&nbsp;<span class="num" id="7585675">0xe0</span><span class="op" id="7585679">,</span>&nbsp;<span class="num" id="7585681">0x6e</span><span class="op" id="7585685">,</span>&nbsp;<span class="num" id="7585687">0xaf</span><span class="op" id="7585691">,</span>&nbsp;<span class="num" id="7585693">0x70</span><span class="op" id="7585697">,</span>&nbsp;<span class="num" id="7585699">0xa0</span><span class="op" id="7585703">,</span>&nbsp;<span class="num" id="7585705">0xec</span><span class="op" id="7585709">,</span>&nbsp;<span class="num" id="7585711">0x0d</span><span class="op" id="7585715">,</span>&nbsp;<span class="num" id="7585717">0x71</span><span class="op" id="7585721">,</span>&nbsp;<span class="num" id="7585723">0x91</span><span class="op" id="7585727">}</span><span class="op" id="7585728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585731">}</span><span class="op" id="7585732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7585739">//&nbsp;Appendix&nbsp;C.3.&nbsp;&nbsp;AES-256</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585767">[</span><span class="op" id="7585768">]</span><span class="builtintype" id="7585769">byte</span><span class="op" id="7585773">{</span><span class="num" id="7585774">0x00</span><span class="op" id="7585778">,</span>&nbsp;<span class="num" id="7585780">0x01</span><span class="op" id="7585784">,</span>&nbsp;<span class="num" id="7585786">0x02</span><span class="op" id="7585790">,</span>&nbsp;<span class="num" id="7585792">0x03</span><span class="op" id="7585796">,</span>&nbsp;<span class="num" id="7585798">0x04</span><span class="op" id="7585802">,</span>&nbsp;<span class="num" id="7585804">0x05</span><span class="op" id="7585808">,</span>&nbsp;<span class="num" id="7585810">0x06</span><span class="op" id="7585814">,</span>&nbsp;<span class="num" id="7585816">0x07</span><span class="op" id="7585820">,</span>&nbsp;<span class="num" id="7585822">0x08</span><span class="op" id="7585826">,</span>&nbsp;<span class="num" id="7585828">0x09</span><span class="op" id="7585832">,</span>&nbsp;<span class="num" id="7585834">0x0a</span><span class="op" id="7585838">,</span>&nbsp;<span class="num" id="7585840">0x0b</span><span class="op" id="7585844">,</span>&nbsp;<span class="num" id="7585846">0x0c</span><span class="op" id="7585850">,</span>&nbsp;<span class="num" id="7585852">0x0d</span><span class="op" id="7585856">,</span>&nbsp;<span class="num" id="7585858">0x0e</span><span class="op" id="7585862">,</span>&nbsp;<span class="num" id="7585864">0x0f</span><span class="op" id="7585868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7585873">0x10</span><span class="op" id="7585877">,</span>&nbsp;<span class="num" id="7585879">0x11</span><span class="op" id="7585883">,</span>&nbsp;<span class="num" id="7585885">0x12</span><span class="op" id="7585889">,</span>&nbsp;<span class="num" id="7585891">0x13</span><span class="op" id="7585895">,</span>&nbsp;<span class="num" id="7585897">0x14</span><span class="op" id="7585901">,</span>&nbsp;<span class="num" id="7585903">0x15</span><span class="op" id="7585907">,</span>&nbsp;<span class="num" id="7585909">0x16</span><span class="op" id="7585913">,</span>&nbsp;<span class="num" id="7585915">0x17</span><span class="op" id="7585919">,</span>&nbsp;<span class="num" id="7585921">0x18</span><span class="op" id="7585925">,</span>&nbsp;<span class="num" id="7585927">0x19</span><span class="op" id="7585931">,</span>&nbsp;<span class="num" id="7585933">0x1a</span><span class="op" id="7585937">,</span>&nbsp;<span class="num" id="7585939">0x1b</span><span class="op" id="7585943">,</span>&nbsp;<span class="num" id="7585945">0x1c</span><span class="op" id="7585949">,</span>&nbsp;<span class="num" id="7585951">0x1d</span><span class="op" id="7585955">,</span>&nbsp;<span class="num" id="7585957">0x1e</span><span class="op" id="7585961">,</span>&nbsp;<span class="num" id="7585963">0x1f</span><span class="op" id="7585967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585971">}</span><span class="op" id="7585972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7585976">[</span><span class="op" id="7585977">]</span><span class="builtintype" id="7585978">byte</span><span class="op" id="7585982">{</span><span class="num" id="7585983">0x00</span><span class="op" id="7585987">,</span>&nbsp;<span class="num" id="7585989">0x11</span><span class="op" id="7585993">,</span>&nbsp;<span class="num" id="7585995">0x22</span><span class="op" id="7585999">,</span>&nbsp;<span class="num" id="7586001">0x33</span><span class="op" id="7586005">,</span>&nbsp;<span class="num" id="7586007">0x44</span><span class="op" id="7586011">,</span>&nbsp;<span class="num" id="7586013">0x55</span><span class="op" id="7586017">,</span>&nbsp;<span class="num" id="7586019">0x66</span><span class="op" id="7586023">,</span>&nbsp;<span class="num" id="7586025">0x77</span><span class="op" id="7586029">,</span>&nbsp;<span class="num" id="7586031">0x88</span><span class="op" id="7586035">,</span>&nbsp;<span class="num" id="7586037">0x99</span><span class="op" id="7586041">,</span>&nbsp;<span class="num" id="7586043">0xaa</span><span class="op" id="7586047">,</span>&nbsp;<span class="num" id="7586049">0xbb</span><span class="op" id="7586053">,</span>&nbsp;<span class="num" id="7586055">0xcc</span><span class="op" id="7586059">,</span>&nbsp;<span class="num" id="7586061">0xdd</span><span class="op" id="7586065">,</span>&nbsp;<span class="num" id="7586067">0xee</span><span class="op" id="7586071">,</span>&nbsp;<span class="num" id="7586073">0xff</span><span class="op" id="7586077">}</span><span class="op" id="7586078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7586082">[</span><span class="op" id="7586083">]</span><span class="builtintype" id="7586084">byte</span><span class="op" id="7586088">{</span><span class="num" id="7586089">0x8e</span><span class="op" id="7586093">,</span>&nbsp;<span class="num" id="7586095">0xa2</span><span class="op" id="7586099">,</span>&nbsp;<span class="num" id="7586101">0xb7</span><span class="op" id="7586105">,</span>&nbsp;<span class="num" id="7586107">0xca</span><span class="op" id="7586111">,</span>&nbsp;<span class="num" id="7586113">0x51</span><span class="op" id="7586117">,</span>&nbsp;<span class="num" id="7586119">0x67</span><span class="op" id="7586123">,</span>&nbsp;<span class="num" id="7586125">0x45</span><span class="op" id="7586129">,</span>&nbsp;<span class="num" id="7586131">0xbf</span><span class="op" id="7586135">,</span>&nbsp;<span class="num" id="7586137">0xea</span><span class="op" id="7586141">,</span>&nbsp;<span class="num" id="7586143">0xfc</span><span class="op" id="7586147">,</span>&nbsp;<span class="num" id="7586149">0x49</span><span class="op" id="7586153">,</span>&nbsp;<span class="num" id="7586155">0x90</span><span class="op" id="7586159">,</span>&nbsp;<span class="num" id="7586161">0x4b</span><span class="op" id="7586165">,</span>&nbsp;<span class="num" id="7586167">0x49</span><span class="op" id="7586171">,</span>&nbsp;<span class="num" id="7586173">0x60</span><span class="op" id="7586177">,</span>&nbsp;<span class="num" id="7586179">0x89</span><span class="op" id="7586183">}</span><span class="op" id="7586184">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7586187">}</span><span class="op" id="7586188">,</span><br>
<span class="lineno"></span><span class="op" id="7586190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7586193">//&nbsp;Test&nbsp;encryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7586241">func</span>&nbsp;<span class="ident" id="7586246">TestEncryptBlock</span><span class="op" id="7586262">(</span><span class="ident" id="7586263">t</span>&nbsp;<span class="op" id="7586265">*</span><span class="ident" id="7586266">testing</span><span class="op" id="7586273">.</span><span class="ident" id="7586274">T</span><span class="op" id="7586275">)</span>&nbsp;<span class="op" id="7586277">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586280">for</span>&nbsp;<span class="ident" id="7586284">i</span><span class="op" id="7586285">,</span>&nbsp;<span class="ident" id="7586287">tt</span>&nbsp;<span class="op" id="7586290">:=</span>&nbsp;<span class="keyword" id="7586293">range</span>&nbsp;<span class="ident" id="7586299">encryptTests</span>&nbsp;<span class="op" id="7586312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586316">n</span>&nbsp;<span class="op" id="7586318">:=</span>&nbsp;<span class="builtinfunc" id="7586321">len</span><span class="op" id="7586324">(</span><span class="ident" id="7586325">tt</span><span class="op" id="7586327">.</span><span class="ident" id="7586328">key</span><span class="op" id="7586331">)</span>&nbsp;<span class="op" id="7586333">+</span>&nbsp;<span class="num" id="7586335">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586340">enc</span>&nbsp;<span class="op" id="7586344">:=</span>&nbsp;<span class="builtinfunc" id="7586347">make</span><span class="op" id="7586351">(</span><span class="op" id="7586352">[</span><span class="op" id="7586353">]</span><span class="builtintype" id="7586354">uint32</span><span class="op" id="7586360">,</span>&nbsp;<span class="ident" id="7586362">n</span><span class="op" id="7586363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586367">dec</span>&nbsp;<span class="op" id="7586371">:=</span>&nbsp;<span class="builtinfunc" id="7586374">make</span><span class="op" id="7586378">(</span><span class="op" id="7586379">[</span><span class="op" id="7586380">]</span><span class="builtintype" id="7586381">uint32</span><span class="op" id="7586387">,</span>&nbsp;<span class="ident" id="7586389">n</span><span class="op" id="7586390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586394">expandKey</span><span class="op" id="7586403">(</span><span class="ident" id="7586404">tt</span><span class="op" id="7586406">.</span><span class="ident" id="7586407">key</span><span class="op" id="7586410">,</span>&nbsp;<span class="ident" id="7586412">enc</span><span class="op" id="7586415">,</span>&nbsp;<span class="ident" id="7586417">dec</span><span class="op" id="7586420">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586424">out</span>&nbsp;<span class="op" id="7586428">:=</span>&nbsp;<span class="builtinfunc" id="7586431">make</span><span class="op" id="7586435">(</span><span class="op" id="7586436">[</span><span class="op" id="7586437">]</span><span class="builtintype" id="7586438">byte</span><span class="op" id="7586442">,</span>&nbsp;<span class="builtinfunc" id="7586444">len</span><span class="op" id="7586447">(</span><span class="ident" id="7586448">tt</span><span class="op" id="7586450">.</span><span class="ident" id="7586451">in</span><span class="op" id="7586453">)</span><span class="op" id="7586454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586458">encryptBlock</span><span class="op" id="7586470">(</span><span class="ident" id="7586471">enc</span><span class="op" id="7586474">,</span>&nbsp;<span class="ident" id="7586476">out</span><span class="op" id="7586479">,</span>&nbsp;<span class="ident" id="7586481">tt</span><span class="op" id="7586483">.</span><span class="ident" id="7586484">in</span><span class="op" id="7586486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586490">for</span>&nbsp;<span class="ident" id="7586494">j</span><span class="op" id="7586495">,</span>&nbsp;<span class="ident" id="7586497">v</span>&nbsp;<span class="op" id="7586499">:=</span>&nbsp;<span class="keyword" id="7586502">range</span>&nbsp;<span class="ident" id="7586508">out</span>&nbsp;<span class="op" id="7586512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586517">if</span>&nbsp;<span class="ident" id="7586520">v</span>&nbsp;<span class="op" id="7586522">!=</span>&nbsp;<span class="ident" id="7586525">tt</span><span class="op" id="7586527">.</span><span class="ident" id="7586528">out</span><span class="op" id="7586531">[</span><span class="ident" id="7586532">j</span><span class="op" id="7586533">]</span>&nbsp;<span class="op" id="7586535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586541">t</span><span class="op" id="7586542">.</span><span class="ident" id="7586543">Errorf</span><span class="op" id="7586549">(</span><span class="string" id="7586550">&#34;encryptBlock&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7586592">,</span>&nbsp;<span class="ident" id="7586594">i</span><span class="op" id="7586595">,</span>&nbsp;<span class="ident" id="7586597">j</span><span class="op" id="7586598">,</span>&nbsp;<span class="ident" id="7586600">v</span><span class="op" id="7586601">,</span>&nbsp;<span class="ident" id="7586603">tt</span><span class="op" id="7586605">.</span><span class="ident" id="7586606">out</span><span class="op" id="7586609">[</span><span class="ident" id="7586610">j</span><span class="op" id="7586611">]</span><span class="op" id="7586612">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586618">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7586627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7586631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7586634">}</span><br>
<span class="lineno"></span><span class="op" id="7586636">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="7586639">//&nbsp;Test&nbsp;decryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7586687">func</span>&nbsp;<span class="ident" id="7586692">TestDecryptBlock</span><span class="op" id="7586708">(</span><span class="ident" id="7586709">t</span>&nbsp;<span class="op" id="7586711">*</span><span class="ident" id="7586712">testing</span><span class="op" id="7586719">.</span><span class="ident" id="7586720">T</span><span class="op" id="7586721">)</span>&nbsp;<span class="op" id="7586723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586726">for</span>&nbsp;<span class="ident" id="7586730">i</span><span class="op" id="7586731">,</span>&nbsp;<span class="ident" id="7586733">tt</span>&nbsp;<span class="op" id="7586736">:=</span>&nbsp;<span class="keyword" id="7586739">range</span>&nbsp;<span class="ident" id="7586745">encryptTests</span>&nbsp;<span class="op" id="7586758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586762">n</span>&nbsp;<span class="op" id="7586764">:=</span>&nbsp;<span class="builtinfunc" id="7586767">len</span><span class="op" id="7586770">(</span><span class="ident" id="7586771">tt</span><span class="op" id="7586773">.</span><span class="ident" id="7586774">key</span><span class="op" id="7586777">)</span>&nbsp;<span class="op" id="7586779">+</span>&nbsp;<span class="num" id="7586781">28</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586786">enc</span>&nbsp;<span class="op" id="7586790">:=</span>&nbsp;<span class="builtinfunc" id="7586793">make</span><span class="op" id="7586797">(</span><span class="op" id="7586798">[</span><span class="op" id="7586799">]</span><span class="builtintype" id="7586800">uint32</span><span class="op" id="7586806">,</span>&nbsp;<span class="ident" id="7586808">n</span><span class="op" id="7586809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586813">dec</span>&nbsp;<span class="op" id="7586817">:=</span>&nbsp;<span class="builtinfunc" id="7586820">make</span><span class="op" id="7586824">(</span><span class="op" id="7586825">[</span><span class="op" id="7586826">]</span><span class="builtintype" id="7586827">uint32</span><span class="op" id="7586833">,</span>&nbsp;<span class="ident" id="7586835">n</span><span class="op" id="7586836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586840">expandKey</span><span class="op" id="7586849">(</span><span class="ident" id="7586850">tt</span><span class="op" id="7586852">.</span><span class="ident" id="7586853">key</span><span class="op" id="7586856">,</span>&nbsp;<span class="ident" id="7586858">enc</span><span class="op" id="7586861">,</span>&nbsp;<span class="ident" id="7586863">dec</span><span class="op" id="7586866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586870">plain</span>&nbsp;<span class="op" id="7586876">:=</span>&nbsp;<span class="builtinfunc" id="7586879">make</span><span class="op" id="7586883">(</span><span class="op" id="7586884">[</span><span class="op" id="7586885">]</span><span class="builtintype" id="7586886">byte</span><span class="op" id="7586890">,</span>&nbsp;<span class="builtinfunc" id="7586892">len</span><span class="op" id="7586895">(</span><span class="ident" id="7586896">tt</span><span class="op" id="7586898">.</span><span class="ident" id="7586899">in</span><span class="op" id="7586901">)</span><span class="op" id="7586902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586906">decryptBlock</span><span class="op" id="7586918">(</span><span class="ident" id="7586919">dec</span><span class="op" id="7586922">,</span>&nbsp;<span class="ident" id="7586924">plain</span><span class="op" id="7586929">,</span>&nbsp;<span class="ident" id="7586931">tt</span><span class="op" id="7586933">.</span><span class="ident" id="7586934">out</span><span class="op" id="7586937">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586941">for</span>&nbsp;<span class="ident" id="7586945">j</span><span class="op" id="7586946">,</span>&nbsp;<span class="ident" id="7586948">v</span>&nbsp;<span class="op" id="7586950">:=</span>&nbsp;<span class="keyword" id="7586953">range</span>&nbsp;<span class="ident" id="7586959">plain</span>&nbsp;<span class="op" id="7586965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7586970">if</span>&nbsp;<span class="ident" id="7586973">v</span>&nbsp;<span class="op" id="7586975">!=</span>&nbsp;<span class="ident" id="7586978">tt</span><span class="op" id="7586980">.</span><span class="ident" id="7586981">in</span><span class="op" id="7586983">[</span><span class="ident" id="7586984">j</span><span class="op" id="7586985">]</span>&nbsp;<span class="op" id="7586987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7586993">t</span><span class="op" id="7586994">.</span><span class="ident" id="7586995">Errorf</span><span class="op" id="7587001">(</span><span class="string" id="7587002">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7587046">,</span>&nbsp;<span class="ident" id="7587048">i</span><span class="op" id="7587049">,</span>&nbsp;<span class="ident" id="7587051">j</span><span class="op" id="7587052">,</span>&nbsp;<span class="ident" id="7587054">v</span><span class="op" id="7587055">,</span>&nbsp;<span class="ident" id="7587057">tt</span><span class="op" id="7587059">.</span><span class="ident" id="7587060">in</span><span class="op" id="7587062">[</span><span class="ident" id="7587063">j</span><span class="op" id="7587064">]</span><span class="op" id="7587065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587071">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587080">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587087">}</span><br>
<span class="lineno"></span><span class="op" id="7587089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7587092">//&nbsp;Test&nbsp;Cipher&nbsp;Encrypt&nbsp;method&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno">320</span><span class="keyword" id="7587149">func</span>&nbsp;<span class="ident" id="7587154">TestCipherEncrypt</span><span class="op" id="7587171">(</span><span class="ident" id="7587172">t</span>&nbsp;<span class="op" id="7587174">*</span><span class="ident" id="7587175">testing</span><span class="op" id="7587182">.</span><span class="ident" id="7587183">T</span><span class="op" id="7587184">)</span>&nbsp;<span class="op" id="7587186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587189">for</span>&nbsp;<span class="ident" id="7587193">i</span><span class="op" id="7587194">,</span>&nbsp;<span class="ident" id="7587196">tt</span>&nbsp;<span class="op" id="7587199">:=</span>&nbsp;<span class="keyword" id="7587202">range</span>&nbsp;<span class="ident" id="7587208">encryptTests</span>&nbsp;<span class="op" id="7587221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587225">c</span><span class="op" id="7587226">,</span>&nbsp;<span class="ident" id="7587228">err</span>&nbsp;<span class="op" id="7587232">:=</span>&nbsp;<span class="ident" id="7587235">NewCipher</span><span class="op" id="7587244">(</span><span class="ident" id="7587245">tt</span><span class="op" id="7587247">.</span><span class="ident" id="7587248">key</span><span class="op" id="7587251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587255">if</span>&nbsp;<span class="ident" id="7587258">err</span>&nbsp;<span class="op" id="7587262">!=</span>&nbsp;<span class="ident" id="7587265">nil</span>&nbsp;<span class="op" id="7587269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587274">t</span><span class="op" id="7587275">.</span><span class="ident" id="7587276">Errorf</span><span class="op" id="7587282">(</span><span class="string" id="7587283">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="7587309">,</span>&nbsp;<span class="builtinfunc" id="7587311">len</span><span class="op" id="7587314">(</span><span class="ident" id="7587315">tt</span><span class="op" id="7587317">.</span><span class="ident" id="7587318">key</span><span class="op" id="7587321">)</span><span class="op" id="7587322">,</span>&nbsp;<span class="ident" id="7587324">err</span><span class="op" id="7587327">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587332">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587347">out</span>&nbsp;<span class="op" id="7587351">:=</span>&nbsp;<span class="builtinfunc" id="7587354">make</span><span class="op" id="7587358">(</span><span class="op" id="7587359">[</span><span class="op" id="7587360">]</span><span class="builtintype" id="7587361">byte</span><span class="op" id="7587365">,</span>&nbsp;<span class="builtinfunc" id="7587367">len</span><span class="op" id="7587370">(</span><span class="ident" id="7587371">tt</span><span class="op" id="7587373">.</span><span class="ident" id="7587374">in</span><span class="op" id="7587376">)</span><span class="op" id="7587377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587381">c</span><span class="op" id="7587382">.</span><span class="ident" id="7587383">Encrypt</span><span class="op" id="7587390">(</span><span class="ident" id="7587391">out</span><span class="op" id="7587394">,</span>&nbsp;<span class="ident" id="7587396">tt</span><span class="op" id="7587398">.</span><span class="ident" id="7587399">in</span><span class="op" id="7587401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587405">for</span>&nbsp;<span class="ident" id="7587409">j</span><span class="op" id="7587410">,</span>&nbsp;<span class="ident" id="7587412">v</span>&nbsp;<span class="op" id="7587414">:=</span>&nbsp;<span class="keyword" id="7587417">range</span>&nbsp;<span class="ident" id="7587423">out</span>&nbsp;<span class="op" id="7587427">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587432">if</span>&nbsp;<span class="ident" id="7587435">v</span>&nbsp;<span class="op" id="7587437">!=</span>&nbsp;<span class="ident" id="7587440">tt</span><span class="op" id="7587442">.</span><span class="ident" id="7587443">out</span><span class="op" id="7587446">[</span><span class="ident" id="7587447">j</span><span class="op" id="7587448">]</span>&nbsp;<span class="op" id="7587450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587456">t</span><span class="op" id="7587457">.</span><span class="ident" id="7587458">Errorf</span><span class="op" id="7587464">(</span><span class="string" id="7587465">&#34;Cipher.Encrypt&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7587509">,</span>&nbsp;<span class="ident" id="7587511">i</span><span class="op" id="7587512">,</span>&nbsp;<span class="ident" id="7587514">j</span><span class="op" id="7587515">,</span>&nbsp;<span class="ident" id="7587517">v</span><span class="op" id="7587518">,</span>&nbsp;<span class="ident" id="7587520">tt</span><span class="op" id="7587522">.</span><span class="ident" id="7587523">out</span><span class="op" id="7587526">[</span><span class="ident" id="7587527">j</span><span class="op" id="7587528">]</span><span class="op" id="7587529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587535">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587548">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587551">}</span><br>
<span class="lineno"></span><span class="op" id="7587553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7587556">//&nbsp;Test&nbsp;Cipher&nbsp;Decrypt&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="7587606">func</span>&nbsp;<span class="ident" id="7587611">TestCipherDecrypt</span><span class="op" id="7587628">(</span><span class="ident" id="7587629">t</span>&nbsp;<span class="op" id="7587631">*</span><span class="ident" id="7587632">testing</span><span class="op" id="7587639">.</span><span class="ident" id="7587640">T</span><span class="op" id="7587641">)</span>&nbsp;<span class="op" id="7587643">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587646">for</span>&nbsp;<span class="ident" id="7587650">i</span><span class="op" id="7587651">,</span>&nbsp;<span class="ident" id="7587653">tt</span>&nbsp;<span class="op" id="7587656">:=</span>&nbsp;<span class="keyword" id="7587659">range</span>&nbsp;<span class="ident" id="7587665">encryptTests</span>&nbsp;<span class="op" id="7587678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587682">c</span><span class="op" id="7587683">,</span>&nbsp;<span class="ident" id="7587685">err</span>&nbsp;<span class="op" id="7587689">:=</span>&nbsp;<span class="ident" id="7587692">NewCipher</span><span class="op" id="7587701">(</span><span class="ident" id="7587702">tt</span><span class="op" id="7587704">.</span><span class="ident" id="7587705">key</span><span class="op" id="7587708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587712">if</span>&nbsp;<span class="ident" id="7587715">err</span>&nbsp;<span class="op" id="7587719">!=</span>&nbsp;<span class="ident" id="7587722">nil</span>&nbsp;<span class="op" id="7587726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587731">t</span><span class="op" id="7587732">.</span><span class="ident" id="7587733">Errorf</span><span class="op" id="7587739">(</span><span class="string" id="7587740">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="7587766">,</span>&nbsp;<span class="builtinfunc" id="7587768">len</span><span class="op" id="7587771">(</span><span class="ident" id="7587772">tt</span><span class="op" id="7587774">.</span><span class="ident" id="7587775">key</span><span class="op" id="7587778">)</span><span class="op" id="7587779">,</span>&nbsp;<span class="ident" id="7587781">err</span><span class="op" id="7587784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587789">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7587800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587804">plain</span>&nbsp;<span class="op" id="7587810">:=</span>&nbsp;<span class="builtinfunc" id="7587813">make</span><span class="op" id="7587817">(</span><span class="op" id="7587818">[</span><span class="op" id="7587819">]</span><span class="builtintype" id="7587820">byte</span><span class="op" id="7587824">,</span>&nbsp;<span class="builtinfunc" id="7587826">len</span><span class="op" id="7587829">(</span><span class="ident" id="7587830">tt</span><span class="op" id="7587832">.</span><span class="ident" id="7587833">in</span><span class="op" id="7587835">)</span><span class="op" id="7587836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587840">c</span><span class="op" id="7587841">.</span><span class="ident" id="7587842">Decrypt</span><span class="op" id="7587849">(</span><span class="ident" id="7587850">plain</span><span class="op" id="7587855">,</span>&nbsp;<span class="ident" id="7587857">tt</span><span class="op" id="7587859">.</span><span class="ident" id="7587860">out</span><span class="op" id="7587863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587867">for</span>&nbsp;<span class="ident" id="7587871">j</span><span class="op" id="7587872">,</span>&nbsp;<span class="ident" id="7587874">v</span>&nbsp;<span class="op" id="7587876">:=</span>&nbsp;<span class="keyword" id="7587879">range</span>&nbsp;<span class="ident" id="7587885">plain</span>&nbsp;<span class="op" id="7587891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587896">if</span>&nbsp;<span class="ident" id="7587899">v</span>&nbsp;<span class="op" id="7587901">!=</span>&nbsp;<span class="ident" id="7587904">tt</span><span class="op" id="7587906">.</span><span class="ident" id="7587907">in</span><span class="op" id="7587909">[</span><span class="ident" id="7587910">j</span><span class="op" id="7587911">]</span>&nbsp;<span class="op" id="7587913">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7587919">t</span><span class="op" id="7587920">.</span><span class="ident" id="7587921">Errorf</span><span class="op" id="7587927">(</span><span class="string" id="7587928">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="7587972">,</span>&nbsp;<span class="ident" id="7587974">i</span><span class="op" id="7587975">,</span>&nbsp;<span class="ident" id="7587977">j</span><span class="op" id="7587978">,</span>&nbsp;<span class="ident" id="7587980">v</span><span class="op" id="7587981">,</span>&nbsp;<span class="ident" id="7587983">tt</span><span class="op" id="7587985">.</span><span class="ident" id="7587986">in</span><span class="op" id="7587988">[</span><span class="ident" id="7587989">j</span><span class="op" id="7587990">]</span><span class="op" id="7587991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7587997">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588013">}</span><br>
<span class="lineno">355</span><span class="op" id="7588015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7588018">//&nbsp;Test&nbsp;short&nbsp;input/output.</span><br>
<span class="lineno"></span><span class="comment" id="7588046">//&nbsp;Assembly&nbsp;used&nbsp;to&nbsp;not&nbsp;notice.</span><br>
<span class="lineno"></span><span class="comment" id="7588078">//&nbsp;See&nbsp;issue&nbsp;7928.</span><br>
<span class="lineno">360</span><span class="keyword" id="7588097">func</span>&nbsp;<span class="ident" id="7588102">TestShortBlocks</span><span class="op" id="7588117">(</span><span class="ident" id="7588118">t</span>&nbsp;<span class="op" id="7588120">*</span><span class="ident" id="7588121">testing</span><span class="op" id="7588128">.</span><span class="ident" id="7588129">T</span><span class="op" id="7588130">)</span>&nbsp;<span class="op" id="7588132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588135">bytes</span>&nbsp;<span class="op" id="7588141">:=</span>&nbsp;<span class="keyword" id="7588144">func</span><span class="op" id="7588148">(</span><span class="ident" id="7588149">n</span>&nbsp;<span class="builtintype" id="7588151">int</span><span class="op" id="7588154">)</span>&nbsp;<span class="op" id="7588156">[</span><span class="op" id="7588157">]</span><span class="builtintype" id="7588158">byte</span>&nbsp;<span class="op" id="7588163">{</span>&nbsp;<span class="keyword" id="7588165">return</span>&nbsp;<span class="builtinfunc" id="7588172">make</span><span class="op" id="7588176">(</span><span class="op" id="7588177">[</span><span class="op" id="7588178">]</span><span class="builtintype" id="7588179">byte</span><span class="op" id="7588183">,</span>&nbsp;<span class="ident" id="7588185">n</span><span class="op" id="7588186">)</span>&nbsp;<span class="op" id="7588188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588192">c</span><span class="op" id="7588193">,</span>&nbsp;<span class="ident" id="7588195">_</span>&nbsp;<span class="op" id="7588197">:=</span>&nbsp;<span class="ident" id="7588200">NewCipher</span><span class="op" id="7588209">(</span><span class="ident" id="7588210">bytes</span><span class="op" id="7588215">(</span><span class="num" id="7588216">16</span><span class="op" id="7588218">)</span><span class="op" id="7588219">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588223">mustPanic</span><span class="op" id="7588232">(</span><span class="ident" id="7588233">t</span><span class="op" id="7588234">,</span>&nbsp;<span class="string" id="7588236">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7588270">,</span>&nbsp;<span class="keyword" id="7588272">func</span><span class="op" id="7588276">(</span><span class="op" id="7588277">)</span>&nbsp;<span class="op" id="7588279">{</span>&nbsp;<span class="ident" id="7588281">c</span><span class="op" id="7588282">.</span><span class="ident" id="7588283">Encrypt</span><span class="op" id="7588290">(</span><span class="ident" id="7588291">bytes</span><span class="op" id="7588296">(</span><span class="num" id="7588297">1</span><span class="op" id="7588298">)</span><span class="op" id="7588299">,</span>&nbsp;<span class="ident" id="7588301">bytes</span><span class="op" id="7588306">(</span><span class="num" id="7588307">1</span><span class="op" id="7588308">)</span><span class="op" id="7588309">)</span>&nbsp;<span class="op" id="7588311">}</span><span class="op" id="7588312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588315">mustPanic</span><span class="op" id="7588324">(</span><span class="ident" id="7588325">t</span><span class="op" id="7588326">,</span>&nbsp;<span class="string" id="7588328">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7588362">,</span>&nbsp;<span class="keyword" id="7588364">func</span><span class="op" id="7588368">(</span><span class="op" id="7588369">)</span>&nbsp;<span class="op" id="7588371">{</span>&nbsp;<span class="ident" id="7588373">c</span><span class="op" id="7588374">.</span><span class="ident" id="7588375">Decrypt</span><span class="op" id="7588382">(</span><span class="ident" id="7588383">bytes</span><span class="op" id="7588388">(</span><span class="num" id="7588389">1</span><span class="op" id="7588390">)</span><span class="op" id="7588391">,</span>&nbsp;<span class="ident" id="7588393">bytes</span><span class="op" id="7588398">(</span><span class="num" id="7588399">1</span><span class="op" id="7588400">)</span><span class="op" id="7588401">)</span>&nbsp;<span class="op" id="7588403">}</span><span class="op" id="7588404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588407">mustPanic</span><span class="op" id="7588416">(</span><span class="ident" id="7588417">t</span><span class="op" id="7588418">,</span>&nbsp;<span class="string" id="7588420">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7588454">,</span>&nbsp;<span class="keyword" id="7588456">func</span><span class="op" id="7588460">(</span><span class="op" id="7588461">)</span>&nbsp;<span class="op" id="7588463">{</span>&nbsp;<span class="ident" id="7588465">c</span><span class="op" id="7588466">.</span><span class="ident" id="7588467">Encrypt</span><span class="op" id="7588474">(</span><span class="ident" id="7588475">bytes</span><span class="op" id="7588480">(</span><span class="num" id="7588481">100</span><span class="op" id="7588484">)</span><span class="op" id="7588485">,</span>&nbsp;<span class="ident" id="7588487">bytes</span><span class="op" id="7588492">(</span><span class="num" id="7588493">1</span><span class="op" id="7588494">)</span><span class="op" id="7588495">)</span>&nbsp;<span class="op" id="7588497">}</span><span class="op" id="7588498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588501">mustPanic</span><span class="op" id="7588510">(</span><span class="ident" id="7588511">t</span><span class="op" id="7588512">,</span>&nbsp;<span class="string" id="7588514">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7588548">,</span>&nbsp;<span class="keyword" id="7588550">func</span><span class="op" id="7588554">(</span><span class="op" id="7588555">)</span>&nbsp;<span class="op" id="7588557">{</span>&nbsp;<span class="ident" id="7588559">c</span><span class="op" id="7588560">.</span><span class="ident" id="7588561">Decrypt</span><span class="op" id="7588568">(</span><span class="ident" id="7588569">bytes</span><span class="op" id="7588574">(</span><span class="num" id="7588575">100</span><span class="op" id="7588578">)</span><span class="op" id="7588579">,</span>&nbsp;<span class="ident" id="7588581">bytes</span><span class="op" id="7588586">(</span><span class="num" id="7588587">1</span><span class="op" id="7588588">)</span><span class="op" id="7588589">)</span>&nbsp;<span class="op" id="7588591">}</span><span class="op" id="7588592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588595">mustPanic</span><span class="op" id="7588604">(</span><span class="ident" id="7588605">t</span><span class="op" id="7588606">,</span>&nbsp;<span class="string" id="7588608">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7588643">,</span>&nbsp;<span class="keyword" id="7588645">func</span><span class="op" id="7588649">(</span><span class="op" id="7588650">)</span>&nbsp;<span class="op" id="7588652">{</span>&nbsp;<span class="ident" id="7588654">c</span><span class="op" id="7588655">.</span><span class="ident" id="7588656">Encrypt</span><span class="op" id="7588663">(</span><span class="ident" id="7588664">bytes</span><span class="op" id="7588669">(</span><span class="num" id="7588670">1</span><span class="op" id="7588671">)</span><span class="op" id="7588672">,</span>&nbsp;<span class="ident" id="7588674">bytes</span><span class="op" id="7588679">(</span><span class="num" id="7588680">100</span><span class="op" id="7588683">)</span><span class="op" id="7588684">)</span>&nbsp;<span class="op" id="7588686">}</span><span class="op" id="7588687">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588690">mustPanic</span><span class="op" id="7588699">(</span><span class="ident" id="7588700">t</span><span class="op" id="7588701">,</span>&nbsp;<span class="string" id="7588703">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="7588738">,</span>&nbsp;<span class="keyword" id="7588740">func</span><span class="op" id="7588744">(</span><span class="op" id="7588745">)</span>&nbsp;<span class="op" id="7588747">{</span>&nbsp;<span class="ident" id="7588749">c</span><span class="op" id="7588750">.</span><span class="ident" id="7588751">Decrypt</span><span class="op" id="7588758">(</span><span class="ident" id="7588759">bytes</span><span class="op" id="7588764">(</span><span class="num" id="7588765">1</span><span class="op" id="7588766">)</span><span class="op" id="7588767">,</span>&nbsp;<span class="ident" id="7588769">bytes</span><span class="op" id="7588774">(</span><span class="num" id="7588775">100</span><span class="op" id="7588778">)</span><span class="op" id="7588779">)</span>&nbsp;<span class="op" id="7588781">}</span><span class="op" id="7588782">)</span><br>
<span class="lineno"></span><span class="op" id="7588784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7588787">func</span>&nbsp;<span class="ident" id="7588792">mustPanic</span><span class="op" id="7588801">(</span><span class="ident" id="7588802">t</span>&nbsp;<span class="op" id="7588804">*</span><span class="ident" id="7588805">testing</span><span class="op" id="7588812">.</span><span class="ident" id="7588813">T</span><span class="op" id="7588814">,</span>&nbsp;<span class="ident" id="7588816">msg</span>&nbsp;<span class="builtintype" id="7588820">string</span><span class="op" id="7588826">,</span>&nbsp;<span class="ident" id="7588828">f</span>&nbsp;<span class="keyword" id="7588830">func</span><span class="op" id="7588834">(</span><span class="op" id="7588835">)</span><span class="op" id="7588836">)</span>&nbsp;<span class="op" id="7588838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588841">defer</span>&nbsp;<span class="keyword" id="7588847">func</span><span class="op" id="7588851">(</span><span class="op" id="7588852">)</span>&nbsp;<span class="op" id="7588854">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588858">err</span>&nbsp;<span class="op" id="7588862">:=</span>&nbsp;<span class="builtinfunc" id="7588865">recover</span><span class="op" id="7588872">(</span><span class="op" id="7588873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7588877">if</span>&nbsp;<span class="ident" id="7588880">err</span>&nbsp;<span class="op" id="7588884">==</span>&nbsp;<span class="ident" id="7588887">nil</span>&nbsp;<span class="op" id="7588891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588896">t</span><span class="op" id="7588897">.</span><span class="ident" id="7588898">Errorf</span><span class="op" id="7588904">(</span><span class="string" id="7588905">&#34;function&nbsp;did&nbsp;not&nbsp;panic,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="7588940">,</span>&nbsp;<span class="ident" id="7588942">msg</span><span class="op" id="7588945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7588949">}</span>&nbsp;<span class="keyword" id="7588951">else</span>&nbsp;<span class="keyword" id="7588956">if</span>&nbsp;<span class="ident" id="7588959">err</span>&nbsp;<span class="op" id="7588963">!=</span>&nbsp;<span class="ident" id="7588966">msg</span>&nbsp;<span class="op" id="7588970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7588975">t</span><span class="op" id="7588976">.</span><span class="ident" id="7588977">Errorf</span><span class="op" id="7588983">(</span><span class="string" id="7588984">&#34;got&nbsp;panic&nbsp;%v,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="7589009">,</span>&nbsp;<span class="ident" id="7589011">err</span><span class="op" id="7589014">,</span>&nbsp;<span class="ident" id="7589016">msg</span><span class="op" id="7589019">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589026">}</span><span class="op" id="7589027">(</span><span class="op" id="7589028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589031">f</span><span class="op" id="7589032">(</span><span class="op" id="7589033">)</span><br>
<span class="lineno"></span><span class="op" id="7589035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="7589038">func</span>&nbsp;<span class="ident" id="7589043">BenchmarkEncrypt</span><span class="op" id="7589059">(</span><span class="ident" id="7589060">b</span>&nbsp;<span class="op" id="7589062">*</span><span class="ident" id="7589063">testing</span><span class="op" id="7589070">.</span><span class="ident" id="7589071">B</span><span class="op" id="7589072">)</span>&nbsp;<span class="op" id="7589074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589077">tt</span>&nbsp;<span class="op" id="7589080">:=</span>&nbsp;<span class="ident" id="7589083">encryptTests</span><span class="op" id="7589095">[</span><span class="num" id="7589096">0</span><span class="op" id="7589097">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589100">c</span><span class="op" id="7589101">,</span>&nbsp;<span class="ident" id="7589103">err</span>&nbsp;<span class="op" id="7589107">:=</span>&nbsp;<span class="ident" id="7589110">NewCipher</span><span class="op" id="7589119">(</span><span class="ident" id="7589120">tt</span><span class="op" id="7589122">.</span><span class="ident" id="7589123">key</span><span class="op" id="7589126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589129">if</span>&nbsp;<span class="ident" id="7589132">err</span>&nbsp;<span class="op" id="7589136">!=</span>&nbsp;<span class="ident" id="7589139">nil</span>&nbsp;<span class="op" id="7589143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589147">b</span><span class="op" id="7589148">.</span><span class="ident" id="7589149">Fatal</span><span class="op" id="7589154">(</span><span class="string" id="7589155">&#34;NewCipher:&#34;</span><span class="op" id="7589167">,</span>&nbsp;<span class="ident" id="7589169">err</span><span class="op" id="7589172">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589178">out</span>&nbsp;<span class="op" id="7589182">:=</span>&nbsp;<span class="builtinfunc" id="7589185">make</span><span class="op" id="7589189">(</span><span class="op" id="7589190">[</span><span class="op" id="7589191">]</span><span class="builtintype" id="7589192">byte</span><span class="op" id="7589196">,</span>&nbsp;<span class="builtinfunc" id="7589198">len</span><span class="op" id="7589201">(</span><span class="ident" id="7589202">tt</span><span class="op" id="7589204">.</span><span class="ident" id="7589205">in</span><span class="op" id="7589207">)</span><span class="op" id="7589208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589211">b</span><span class="op" id="7589212">.</span><span class="ident" id="7589213">SetBytes</span><span class="op" id="7589221">(</span><span class="ident" id="7589222">int64</span><span class="op" id="7589227">(</span><span class="builtinfunc" id="7589228">len</span><span class="op" id="7589231">(</span><span class="ident" id="7589232">out</span><span class="op" id="7589235">)</span><span class="op" id="7589236">)</span><span class="op" id="7589237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589240">b</span><span class="op" id="7589241">.</span><span class="ident" id="7589242">ResetTimer</span><span class="op" id="7589252">(</span><span class="op" id="7589253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589256">for</span>&nbsp;<span class="ident" id="7589260">i</span>&nbsp;<span class="op" id="7589262">:=</span>&nbsp;<span class="num" id="7589265">0</span><span class="op" id="7589266">;</span>&nbsp;<span class="ident" id="7589268">i</span>&nbsp;<span class="op" id="7589270">&lt;</span>&nbsp;<span class="ident" id="7589272">b</span><span class="op" id="7589273">.</span><span class="ident" id="7589274">N</span><span class="op" id="7589275">;</span>&nbsp;<span class="ident" id="7589277">i</span><span class="op" id="7589278">++</span>&nbsp;<span class="op" id="7589281">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589285">c</span><span class="op" id="7589286">.</span><span class="ident" id="7589287">Encrypt</span><span class="op" id="7589294">(</span><span class="ident" id="7589295">out</span><span class="op" id="7589298">,</span>&nbsp;<span class="ident" id="7589300">tt</span><span class="op" id="7589302">.</span><span class="ident" id="7589303">in</span><span class="op" id="7589305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589308">}</span><br>
<span class="lineno"></span><span class="op" id="7589310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7589313">func</span>&nbsp;<span class="ident" id="7589318">BenchmarkDecrypt</span><span class="op" id="7589334">(</span><span class="ident" id="7589335">b</span>&nbsp;<span class="op" id="7589337">*</span><span class="ident" id="7589338">testing</span><span class="op" id="7589345">.</span><span class="ident" id="7589346">B</span><span class="op" id="7589347">)</span>&nbsp;<span class="op" id="7589349">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589352">tt</span>&nbsp;<span class="op" id="7589355">:=</span>&nbsp;<span class="ident" id="7589358">encryptTests</span><span class="op" id="7589370">[</span><span class="num" id="7589371">0</span><span class="op" id="7589372">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589375">c</span><span class="op" id="7589376">,</span>&nbsp;<span class="ident" id="7589378">err</span>&nbsp;<span class="op" id="7589382">:=</span>&nbsp;<span class="ident" id="7589385">NewCipher</span><span class="op" id="7589394">(</span><span class="ident" id="7589395">tt</span><span class="op" id="7589397">.</span><span class="ident" id="7589398">key</span><span class="op" id="7589401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589404">if</span>&nbsp;<span class="ident" id="7589407">err</span>&nbsp;<span class="op" id="7589411">!=</span>&nbsp;<span class="ident" id="7589414">nil</span>&nbsp;<span class="op" id="7589418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589422">b</span><span class="op" id="7589423">.</span><span class="ident" id="7589424">Fatal</span><span class="op" id="7589429">(</span><span class="string" id="7589430">&#34;NewCipher:&#34;</span><span class="op" id="7589442">,</span>&nbsp;<span class="ident" id="7589444">err</span><span class="op" id="7589447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589450">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589453">out</span>&nbsp;<span class="op" id="7589457">:=</span>&nbsp;<span class="builtinfunc" id="7589460">make</span><span class="op" id="7589464">(</span><span class="op" id="7589465">[</span><span class="op" id="7589466">]</span><span class="builtintype" id="7589467">byte</span><span class="op" id="7589471">,</span>&nbsp;<span class="builtinfunc" id="7589473">len</span><span class="op" id="7589476">(</span><span class="ident" id="7589477">tt</span><span class="op" id="7589479">.</span><span class="ident" id="7589480">out</span><span class="op" id="7589483">)</span><span class="op" id="7589484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589487">b</span><span class="op" id="7589488">.</span><span class="ident" id="7589489">SetBytes</span><span class="op" id="7589497">(</span><span class="ident" id="7589498">int64</span><span class="op" id="7589503">(</span><span class="builtinfunc" id="7589504">len</span><span class="op" id="7589507">(</span><span class="ident" id="7589508">out</span><span class="op" id="7589511">)</span><span class="op" id="7589512">)</span><span class="op" id="7589513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589516">b</span><span class="op" id="7589517">.</span><span class="ident" id="7589518">ResetTimer</span><span class="op" id="7589528">(</span><span class="op" id="7589529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589532">for</span>&nbsp;<span class="ident" id="7589536">i</span>&nbsp;<span class="op" id="7589538">:=</span>&nbsp;<span class="num" id="7589541">0</span><span class="op" id="7589542">;</span>&nbsp;<span class="ident" id="7589544">i</span>&nbsp;<span class="op" id="7589546">&lt;</span>&nbsp;<span class="ident" id="7589548">b</span><span class="op" id="7589549">.</span><span class="ident" id="7589550">N</span><span class="op" id="7589551">;</span>&nbsp;<span class="ident" id="7589553">i</span><span class="op" id="7589554">++</span>&nbsp;<span class="op" id="7589557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589561">c</span><span class="op" id="7589562">.</span><span class="ident" id="7589563">Decrypt</span><span class="op" id="7589570">(</span><span class="ident" id="7589571">out</span><span class="op" id="7589574">,</span>&nbsp;<span class="ident" id="7589576">tt</span><span class="op" id="7589578">.</span><span class="ident" id="7589579">out</span><span class="op" id="7589582">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589585">}</span><br>
<span class="lineno"></span><span class="op" id="7589587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7589590">func</span>&nbsp;<span class="ident" id="7589595">BenchmarkExpand</span><span class="op" id="7589610">(</span><span class="ident" id="7589611">b</span>&nbsp;<span class="op" id="7589613">*</span><span class="ident" id="7589614">testing</span><span class="op" id="7589621">.</span><span class="ident" id="7589622">B</span><span class="op" id="7589623">)</span>&nbsp;<span class="op" id="7589625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589628">tt</span>&nbsp;<span class="op" id="7589631">:=</span>&nbsp;<span class="ident" id="7589634">encryptTests</span><span class="op" id="7589646">[</span><span class="num" id="7589647">0</span><span class="op" id="7589648">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589651">n</span>&nbsp;<span class="op" id="7589653">:=</span>&nbsp;<span class="builtinfunc" id="7589656">len</span><span class="op" id="7589659">(</span><span class="ident" id="7589660">tt</span><span class="op" id="7589662">.</span><span class="ident" id="7589663">key</span><span class="op" id="7589666">)</span>&nbsp;<span class="op" id="7589668">+</span>&nbsp;<span class="num" id="7589670">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589674">c</span>&nbsp;<span class="op" id="7589676">:=</span>&nbsp;<span class="op" id="7589679">&amp;</span><span class="ident" id="7589680">aesCipher</span><span class="op" id="7589689">{</span><span class="builtinfunc" id="7589690">make</span><span class="op" id="7589694">(</span><span class="op" id="7589695">[</span><span class="op" id="7589696">]</span><span class="builtintype" id="7589697">uint32</span><span class="op" id="7589703">,</span>&nbsp;<span class="ident" id="7589705">n</span><span class="op" id="7589706">)</span><span class="op" id="7589707">,</span>&nbsp;<span class="builtinfunc" id="7589709">make</span><span class="op" id="7589713">(</span><span class="op" id="7589714">[</span><span class="op" id="7589715">]</span><span class="builtintype" id="7589716">uint32</span><span class="op" id="7589722">,</span>&nbsp;<span class="ident" id="7589724">n</span><span class="op" id="7589725">)</span><span class="op" id="7589726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589729">b</span><span class="op" id="7589730">.</span><span class="ident" id="7589731">ResetTimer</span><span class="op" id="7589741">(</span><span class="op" id="7589742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7589745">for</span>&nbsp;<span class="ident" id="7589749">i</span>&nbsp;<span class="op" id="7589751">:=</span>&nbsp;<span class="num" id="7589754">0</span><span class="op" id="7589755">;</span>&nbsp;<span class="ident" id="7589757">i</span>&nbsp;<span class="op" id="7589759">&lt;</span>&nbsp;<span class="ident" id="7589761">b</span><span class="op" id="7589762">.</span><span class="ident" id="7589763">N</span><span class="op" id="7589764">;</span>&nbsp;<span class="ident" id="7589766">i</span><span class="op" id="7589767">++</span>&nbsp;<span class="op" id="7589770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7589774">expandKey</span><span class="op" id="7589783">(</span><span class="ident" id="7589784">tt</span><span class="op" id="7589786">.</span><span class="ident" id="7589787">key</span><span class="op" id="7589790">,</span>&nbsp;<span class="ident" id="7589792">c</span><span class="op" id="7589793">.</span><span class="ident" id="7589794">enc</span><span class="op" id="7589797">,</span>&nbsp;<span class="ident" id="7589799">c</span><span class="op" id="7589800">.</span><span class="ident" id="7589801">dec</span><span class="op" id="7589804">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7589807">}</span><br>
<span class="lineno"></span><span class="op" id="7589809">}</span>
</div>
</body>
</html>
