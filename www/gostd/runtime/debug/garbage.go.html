<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html" class="current">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5839118">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5839174">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5839228">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5839279">package</span>&nbsp;<span class="ident" id="5839287">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5839294">import</span>&nbsp;<span class="op" id="5839301">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5839304">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5839315">&#34;sort&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5839323">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="5839330">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5839333">//&nbsp;GCStats&nbsp;collect&nbsp;information&nbsp;about&nbsp;recent&nbsp;garbage&nbsp;collections.</span><br>
<span class="lineno"></span><span class="keyword" id="5839398">type</span>&nbsp;<span class="ident" id="5839403">GCStats</span>&nbsp;<span class="keyword" id="5839411">struct</span>&nbsp;<span class="op" id="5839418">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5839421">LastGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839436">time</span><span class="op" id="5839440">.</span><span class="ident" id="5839441">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5839452">//&nbsp;time&nbsp;of&nbsp;last&nbsp;collection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5839480">NumGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839495">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5839511">//&nbsp;number&nbsp;of&nbsp;garbage&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5839545">PauseTotal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5839560">time</span><span class="op" id="5839564">.</span><span class="ident" id="5839565">Duration</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5839576">//&nbsp;total&nbsp;pause&nbsp;for&nbsp;all&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5839612">Pause</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839627">[</span><span class="op" id="5839628">]</span><span class="ident" id="5839629">time</span><span class="op" id="5839633">.</span><span class="ident" id="5839634">Duration</span>&nbsp;<span class="comment" id="5839643">//&nbsp;pause&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5839680">PauseEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5839695">[</span><span class="op" id="5839696">]</span><span class="ident" id="5839697">time</span><span class="op" id="5839701">.</span><span class="ident" id="5839702">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5839711">//&nbsp;pause&nbsp;end&nbsp;times&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5839758">PauseQuantiles</span>&nbsp;<span class="op" id="5839773">[</span><span class="op" id="5839774">]</span><span class="ident" id="5839775">time</span><span class="op" id="5839779">.</span><span class="ident" id="5839780">Duration</span><br>
<span class="lineno"></span><span class="op" id="5839789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5839792">//&nbsp;ReadGCStats&nbsp;reads&nbsp;statistics&nbsp;about&nbsp;garbage&nbsp;collection&nbsp;into&nbsp;stats.</span><br>
<span class="lineno"></span><span class="comment" id="5839861">//&nbsp;The&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;pause&nbsp;history&nbsp;is&nbsp;system-dependent;</span><br>
<span class="lineno">25</span><span class="comment" id="5839928">//&nbsp;stats.Pause&nbsp;slice&nbsp;will&nbsp;be&nbsp;reused&nbsp;if&nbsp;large&nbsp;enough,&nbsp;reallocated&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="5840004">//&nbsp;ReadGCStats&nbsp;may&nbsp;use&nbsp;the&nbsp;full&nbsp;capacity&nbsp;of&nbsp;the&nbsp;stats.Pause&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="5840071">//&nbsp;If&nbsp;stats.PauseQuantiles&nbsp;is&nbsp;non-empty,&nbsp;ReadGCStats&nbsp;fills&nbsp;it&nbsp;with&nbsp;quantiles</span><br>
<span class="lineno"></span><span class="comment" id="5840148">//&nbsp;summarizing&nbsp;the&nbsp;distribution&nbsp;of&nbsp;pause&nbsp;time.&nbsp;For&nbsp;example,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="5840211">//&nbsp;len(stats.PauseQuantiles)&nbsp;is&nbsp;5,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with&nbsp;the&nbsp;minimum,</span><br>
<span class="lineno">30</span><span class="comment" id="5840282">//&nbsp;25%,&nbsp;50%,&nbsp;75%,&nbsp;and&nbsp;maximum&nbsp;pause&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="5840325">func</span>&nbsp;<span class="ident" id="5840330">ReadGCStats</span><span class="op" id="5840341">(</span><span class="ident" id="5840342">stats</span>&nbsp;<span class="op" id="5840348">*</span><span class="ident" id="5840349">GCStats</span><span class="op" id="5840356">)</span>&nbsp;<span class="op" id="5840358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5840361">//&nbsp;Create&nbsp;a&nbsp;buffer&nbsp;with&nbsp;space&nbsp;for&nbsp;at&nbsp;least&nbsp;two&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5840423">//&nbsp;pause&nbsp;history&nbsp;tracked&nbsp;by&nbsp;the&nbsp;runtime.&nbsp;One&nbsp;will&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5840486">//&nbsp;to&nbsp;the&nbsp;caller&nbsp;and&nbsp;the&nbsp;other&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;transfer&nbsp;buffer</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5840550">//&nbsp;for&nbsp;end&nbsp;times&nbsp;history&nbsp;and&nbsp;as&nbsp;a&nbsp;temporary&nbsp;buffer&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5840606">//&nbsp;computing&nbsp;quantiles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840631">const</span>&nbsp;<span class="ident" id="5840637">maxPause</span>&nbsp;<span class="op" id="5840646">=</span>&nbsp;<span class="builtinfunc" id="5840648">len</span><span class="op" id="5840651">(</span><span class="op" id="5840652">(</span><span class="op" id="5840653">(</span><span class="op" id="5840654">*</span><span class="ident" id="5840655">runtime</span><span class="op" id="5840662">.</span><span class="ident" id="5840663">MemStats</span><span class="op" id="5840671">)</span><span class="op" id="5840672">(</span><span class="ident" id="5840673">nil</span><span class="op" id="5840676">)</span><span class="op" id="5840677">)</span><span class="op" id="5840678">.</span><span class="ident" id="5840679">PauseNs</span><span class="op" id="5840686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5840689">if</span>&nbsp;<span class="builtinfunc" id="5840692">cap</span><span class="op" id="5840695">(</span><span class="ident" id="5840696">stats</span><span class="op" id="5840701">.</span><span class="ident" id="5840702">Pause</span><span class="op" id="5840707">)</span>&nbsp;<span class="op" id="5840709">&lt;</span>&nbsp;<span class="num" id="5840711">2</span><span class="op" id="5840712">*</span><span class="ident" id="5840713">maxPause</span><span class="op" id="5840721">+</span><span class="num" id="5840722">3</span>&nbsp;<span class="op" id="5840724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5840728">stats</span><span class="op" id="5840733">.</span><span class="ident" id="5840734">Pause</span>&nbsp;<span class="op" id="5840740">=</span>&nbsp;<span class="builtinfunc" id="5840742">make</span><span class="op" id="5840746">(</span><span class="op" id="5840747">[</span><span class="op" id="5840748">]</span><span class="ident" id="5840749">time</span><span class="op" id="5840753">.</span><span class="ident" id="5840754">Duration</span><span class="op" id="5840762">,</span>&nbsp;<span class="num" id="5840764">2</span><span class="op" id="5840765">*</span><span class="ident" id="5840766">maxPause</span><span class="op" id="5840774">+</span><span class="num" id="5840775">3</span><span class="op" id="5840776">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5840779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5840783">//&nbsp;readGCStats&nbsp;fills&nbsp;in&nbsp;the&nbsp;pause&nbsp;and&nbsp;end&nbsp;times&nbsp;histories&nbsp;(up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5840849">//&nbsp;maxPause&nbsp;entries)&nbsp;and&nbsp;then&nbsp;three&nbsp;more:&nbsp;Unix&nbsp;ns&nbsp;time&nbsp;of&nbsp;last&nbsp;GC,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5840917">//&nbsp;number&nbsp;of&nbsp;GC,&nbsp;and&nbsp;total&nbsp;pause&nbsp;time&nbsp;in&nbsp;nanoseconds.&nbsp;Here&nbsp;we</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5840980">//&nbsp;depend&nbsp;on&nbsp;the&nbsp;fact&nbsp;that&nbsp;time.Duration&#39;s&nbsp;native&nbsp;unit&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5841039">//&nbsp;nanoseconds,&nbsp;so&nbsp;the&nbsp;pauses&nbsp;and&nbsp;the&nbsp;total&nbsp;pause&nbsp;time&nbsp;do&nbsp;not&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5841107">//&nbsp;any&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841127">readGCStats</span><span class="op" id="5841138">(</span><span class="op" id="5841139">&amp;</span><span class="ident" id="5841140">stats</span><span class="op" id="5841145">.</span><span class="ident" id="5841146">Pause</span><span class="op" id="5841151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841154">n</span>&nbsp;<span class="op" id="5841156">:=</span>&nbsp;<span class="builtinfunc" id="5841159">len</span><span class="op" id="5841162">(</span><span class="ident" id="5841163">stats</span><span class="op" id="5841168">.</span><span class="ident" id="5841169">Pause</span><span class="op" id="5841174">)</span>&nbsp;<span class="op" id="5841176">-</span>&nbsp;<span class="num" id="5841178">3</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841181">stats</span><span class="op" id="5841186">.</span><span class="ident" id="5841187">LastGC</span>&nbsp;<span class="op" id="5841194">=</span>&nbsp;<span class="ident" id="5841196">time</span><span class="op" id="5841200">.</span><span class="ident" id="5841201">Unix</span><span class="op" id="5841205">(</span><span class="num" id="5841206">0</span><span class="op" id="5841207">,</span>&nbsp;<span class="ident" id="5841209">int64</span><span class="op" id="5841214">(</span><span class="ident" id="5841215">stats</span><span class="op" id="5841220">.</span><span class="ident" id="5841221">Pause</span><span class="op" id="5841226">[</span><span class="ident" id="5841227">n</span><span class="op" id="5841228">]</span><span class="op" id="5841229">)</span><span class="op" id="5841230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841233">stats</span><span class="op" id="5841238">.</span><span class="ident" id="5841239">NumGC</span>&nbsp;<span class="op" id="5841245">=</span>&nbsp;<span class="ident" id="5841247">int64</span><span class="op" id="5841252">(</span><span class="ident" id="5841253">stats</span><span class="op" id="5841258">.</span><span class="ident" id="5841259">Pause</span><span class="op" id="5841264">[</span><span class="ident" id="5841265">n</span><span class="op" id="5841266">+</span><span class="num" id="5841267">1</span><span class="op" id="5841268">]</span><span class="op" id="5841269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841272">stats</span><span class="op" id="5841277">.</span><span class="ident" id="5841278">PauseTotal</span>&nbsp;<span class="op" id="5841289">=</span>&nbsp;<span class="ident" id="5841291">stats</span><span class="op" id="5841296">.</span><span class="ident" id="5841297">Pause</span><span class="op" id="5841302">[</span><span class="ident" id="5841303">n</span><span class="op" id="5841304">+</span><span class="num" id="5841305">2</span><span class="op" id="5841306">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841309">n</span>&nbsp;<span class="op" id="5841311">/=</span>&nbsp;<span class="num" id="5841314">2</span>&nbsp;<span class="comment" id="5841316">//&nbsp;buffer&nbsp;holds&nbsp;pauses&nbsp;and&nbsp;end&nbsp;times</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841354">stats</span><span class="op" id="5841359">.</span><span class="ident" id="5841360">Pause</span>&nbsp;<span class="op" id="5841366">=</span>&nbsp;<span class="ident" id="5841368">stats</span><span class="op" id="5841373">.</span><span class="ident" id="5841374">Pause</span><span class="op" id="5841379">[</span><span class="op" id="5841380">:</span><span class="ident" id="5841381">n</span><span class="op" id="5841382">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5841386">if</span>&nbsp;<span class="builtinfunc" id="5841389">cap</span><span class="op" id="5841392">(</span><span class="ident" id="5841393">stats</span><span class="op" id="5841398">.</span><span class="ident" id="5841399">PauseEnd</span><span class="op" id="5841407">)</span>&nbsp;<span class="op" id="5841409">&lt;</span>&nbsp;<span class="ident" id="5841411">maxPause</span>&nbsp;<span class="op" id="5841420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841424">stats</span><span class="op" id="5841429">.</span><span class="ident" id="5841430">PauseEnd</span>&nbsp;<span class="op" id="5841439">=</span>&nbsp;<span class="builtinfunc" id="5841441">make</span><span class="op" id="5841445">(</span><span class="op" id="5841446">[</span><span class="op" id="5841447">]</span><span class="ident" id="5841448">time</span><span class="op" id="5841452">.</span><span class="ident" id="5841453">Time</span><span class="op" id="5841457">,</span>&nbsp;<span class="num" id="5841459">0</span><span class="op" id="5841460">,</span>&nbsp;<span class="ident" id="5841462">maxPause</span><span class="op" id="5841470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5841473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841476">stats</span><span class="op" id="5841481">.</span><span class="ident" id="5841482">PauseEnd</span>&nbsp;<span class="op" id="5841491">=</span>&nbsp;<span class="ident" id="5841493">stats</span><span class="op" id="5841498">.</span><span class="ident" id="5841499">PauseEnd</span><span class="op" id="5841507">[</span><span class="op" id="5841508">:</span><span class="num" id="5841509">0</span><span class="op" id="5841510">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5841513">for</span>&nbsp;<span class="ident" id="5841517">_</span><span class="op" id="5841518">,</span>&nbsp;<span class="ident" id="5841520">ns</span>&nbsp;<span class="op" id="5841523">:=</span>&nbsp;<span class="keyword" id="5841526">range</span>&nbsp;<span class="ident" id="5841532">stats</span><span class="op" id="5841537">.</span><span class="ident" id="5841538">Pause</span><span class="op" id="5841543">[</span><span class="ident" id="5841544">n</span>&nbsp;<span class="op" id="5841546">:</span>&nbsp;<span class="ident" id="5841548">n</span><span class="op" id="5841549">+</span><span class="ident" id="5841550">n</span><span class="op" id="5841551">]</span>&nbsp;<span class="op" id="5841553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841557">stats</span><span class="op" id="5841562">.</span><span class="ident" id="5841563">PauseEnd</span>&nbsp;<span class="op" id="5841572">=</span>&nbsp;<span class="builtinfunc" id="5841574">append</span><span class="op" id="5841580">(</span><span class="ident" id="5841581">stats</span><span class="op" id="5841586">.</span><span class="ident" id="5841587">PauseEnd</span><span class="op" id="5841595">,</span>&nbsp;<span class="ident" id="5841597">time</span><span class="op" id="5841601">.</span><span class="ident" id="5841602">Unix</span><span class="op" id="5841606">(</span><span class="num" id="5841607">0</span><span class="op" id="5841608">,</span>&nbsp;<span class="ident" id="5841610">int64</span><span class="op" id="5841615">(</span><span class="ident" id="5841616">ns</span><span class="op" id="5841618">)</span><span class="op" id="5841619">)</span><span class="op" id="5841620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5841623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5841627">if</span>&nbsp;<span class="builtinfunc" id="5841630">len</span><span class="op" id="5841633">(</span><span class="ident" id="5841634">stats</span><span class="op" id="5841639">.</span><span class="ident" id="5841640">PauseQuantiles</span><span class="op" id="5841654">)</span>&nbsp;<span class="op" id="5841656">&gt;</span>&nbsp;<span class="num" id="5841658">0</span>&nbsp;<span class="op" id="5841660">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5841664">if</span>&nbsp;<span class="ident" id="5841667">n</span>&nbsp;<span class="op" id="5841669">==</span>&nbsp;<span class="num" id="5841672">0</span>&nbsp;<span class="op" id="5841674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5841679">for</span>&nbsp;<span class="ident" id="5841683">i</span>&nbsp;<span class="op" id="5841685">:=</span>&nbsp;<span class="keyword" id="5841688">range</span>&nbsp;<span class="ident" id="5841694">stats</span><span class="op" id="5841699">.</span><span class="ident" id="5841700">PauseQuantiles</span>&nbsp;<span class="op" id="5841715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841721">stats</span><span class="op" id="5841726">.</span><span class="ident" id="5841727">PauseQuantiles</span><span class="op" id="5841741">[</span><span class="ident" id="5841742">i</span><span class="op" id="5841743">]</span>&nbsp;<span class="op" id="5841745">=</span>&nbsp;<span class="num" id="5841747">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5841752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5841756">}</span>&nbsp;<span class="keyword" id="5841758">else</span>&nbsp;<span class="op" id="5841763">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5841768">//&nbsp;There&#39;s&nbsp;room&nbsp;for&nbsp;a&nbsp;second&nbsp;copy&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;stats.Pause.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5841833">//&nbsp;See&nbsp;the&nbsp;allocation&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841886">sorted</span>&nbsp;<span class="op" id="5841893">:=</span>&nbsp;<span class="ident" id="5841896">stats</span><span class="op" id="5841901">.</span><span class="ident" id="5841902">Pause</span><span class="op" id="5841907">[</span><span class="ident" id="5841908">n</span>&nbsp;<span class="op" id="5841910">:</span>&nbsp;<span class="ident" id="5841912">n</span><span class="op" id="5841913">+</span><span class="ident" id="5841914">n</span><span class="op" id="5841915">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5841920">copy</span><span class="op" id="5841924">(</span><span class="ident" id="5841925">sorted</span><span class="op" id="5841931">,</span>&nbsp;<span class="ident" id="5841933">stats</span><span class="op" id="5841938">.</span><span class="ident" id="5841939">Pause</span><span class="op" id="5841944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841949">sort</span><span class="op" id="5841953">.</span><span class="ident" id="5841954">Sort</span><span class="op" id="5841958">(</span><span class="ident" id="5841959">byDuration</span><span class="op" id="5841969">(</span><span class="ident" id="5841970">sorted</span><span class="op" id="5841976">)</span><span class="op" id="5841977">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5841982">nq</span>&nbsp;<span class="op" id="5841985">:=</span>&nbsp;<span class="builtinfunc" id="5841988">len</span><span class="op" id="5841991">(</span><span class="ident" id="5841992">stats</span><span class="op" id="5841997">.</span><span class="ident" id="5841998">PauseQuantiles</span><span class="op" id="5842012">)</span>&nbsp;<span class="op" id="5842014">-</span>&nbsp;<span class="num" id="5842016">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5842021">for</span>&nbsp;<span class="ident" id="5842025">i</span>&nbsp;<span class="op" id="5842027">:=</span>&nbsp;<span class="num" id="5842030">0</span><span class="op" id="5842031">;</span>&nbsp;<span class="ident" id="5842033">i</span>&nbsp;<span class="op" id="5842035">&lt;</span>&nbsp;<span class="ident" id="5842037">nq</span><span class="op" id="5842039">;</span>&nbsp;<span class="ident" id="5842041">i</span><span class="op" id="5842042">++</span>&nbsp;<span class="op" id="5842045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5842051">stats</span><span class="op" id="5842056">.</span><span class="ident" id="5842057">PauseQuantiles</span><span class="op" id="5842071">[</span><span class="ident" id="5842072">i</span><span class="op" id="5842073">]</span>&nbsp;<span class="op" id="5842075">=</span>&nbsp;<span class="ident" id="5842077">sorted</span><span class="op" id="5842083">[</span><span class="builtinfunc" id="5842084">len</span><span class="op" id="5842087">(</span><span class="ident" id="5842088">sorted</span><span class="op" id="5842094">)</span><span class="op" id="5842095">*</span><span class="ident" id="5842096">i</span><span class="op" id="5842097">/</span><span class="ident" id="5842098">nq</span><span class="op" id="5842100">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5842105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5842110">stats</span><span class="op" id="5842115">.</span><span class="ident" id="5842116">PauseQuantiles</span><span class="op" id="5842130">[</span><span class="ident" id="5842131">nq</span><span class="op" id="5842133">]</span>&nbsp;<span class="op" id="5842135">=</span>&nbsp;<span class="ident" id="5842137">sorted</span><span class="op" id="5842143">[</span><span class="builtinfunc" id="5842144">len</span><span class="op" id="5842147">(</span><span class="ident" id="5842148">sorted</span><span class="op" id="5842154">)</span><span class="op" id="5842155">-</span><span class="num" id="5842156">1</span><span class="op" id="5842157">]</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5842161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5842164">}</span><br>
<span class="lineno"></span><span class="op" id="5842166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5842169">type</span>&nbsp;<span class="ident" id="5842174">byDuration</span>&nbsp;<span class="op" id="5842185">[</span><span class="op" id="5842186">]</span><span class="ident" id="5842187">time</span><span class="op" id="5842191">.</span><span class="ident" id="5842192">Duration</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="5842202">func</span>&nbsp;<span class="op" id="5842207">(</span><span class="ident" id="5842208">x</span>&nbsp;<span class="ident" id="5842210">byDuration</span><span class="op" id="5842220">)</span>&nbsp;<span class="ident" id="5842222">Len</span><span class="op" id="5842225">(</span><span class="op" id="5842226">)</span>&nbsp;<span class="builtintype" id="5842228">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5842242">{</span>&nbsp;<span class="keyword" id="5842244">return</span>&nbsp;<span class="builtinfunc" id="5842251">len</span><span class="op" id="5842254">(</span><span class="ident" id="5842255">x</span><span class="op" id="5842256">)</span>&nbsp;<span class="op" id="5842258">}</span><br>
<span class="lineno"></span><span class="keyword" id="5842260">func</span>&nbsp;<span class="op" id="5842265">(</span><span class="ident" id="5842266">x</span>&nbsp;<span class="ident" id="5842268">byDuration</span><span class="op" id="5842278">)</span>&nbsp;<span class="ident" id="5842280">Swap</span><span class="op" id="5842284">(</span><span class="ident" id="5842285">i</span><span class="op" id="5842286">,</span>&nbsp;<span class="ident" id="5842288">j</span>&nbsp;<span class="builtintype" id="5842290">int</span><span class="op" id="5842293">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5842300">{</span>&nbsp;<span class="ident" id="5842302">x</span><span class="op" id="5842303">[</span><span class="ident" id="5842304">i</span><span class="op" id="5842305">]</span><span class="op" id="5842306">,</span>&nbsp;<span class="ident" id="5842308">x</span><span class="op" id="5842309">[</span><span class="ident" id="5842310">j</span><span class="op" id="5842311">]</span>&nbsp;<span class="op" id="5842313">=</span>&nbsp;<span class="ident" id="5842315">x</span><span class="op" id="5842316">[</span><span class="ident" id="5842317">j</span><span class="op" id="5842318">]</span><span class="op" id="5842319">,</span>&nbsp;<span class="ident" id="5842321">x</span><span class="op" id="5842322">[</span><span class="ident" id="5842323">i</span><span class="op" id="5842324">]</span>&nbsp;<span class="op" id="5842326">}</span><br>
<span class="lineno"></span><span class="keyword" id="5842328">func</span>&nbsp;<span class="op" id="5842333">(</span><span class="ident" id="5842334">x</span>&nbsp;<span class="ident" id="5842336">byDuration</span><span class="op" id="5842346">)</span>&nbsp;<span class="ident" id="5842348">Less</span><span class="op" id="5842352">(</span><span class="ident" id="5842353">i</span><span class="op" id="5842354">,</span>&nbsp;<span class="ident" id="5842356">j</span>&nbsp;<span class="builtintype" id="5842358">int</span><span class="op" id="5842361">)</span>&nbsp;<span class="builtintype" id="5842363">bool</span>&nbsp;<span class="op" id="5842368">{</span>&nbsp;<span class="keyword" id="5842370">return</span>&nbsp;<span class="ident" id="5842377">x</span><span class="op" id="5842378">[</span><span class="ident" id="5842379">i</span><span class="op" id="5842380">]</span>&nbsp;<span class="op" id="5842382">&lt;</span>&nbsp;<span class="ident" id="5842384">x</span><span class="op" id="5842385">[</span><span class="ident" id="5842386">j</span><span class="op" id="5842387">]</span>&nbsp;<span class="op" id="5842389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="5842392">//&nbsp;SetGCPercent&nbsp;sets&nbsp;the&nbsp;garbage&nbsp;collection&nbsp;target&nbsp;percentage:</span><br>
<span class="lineno"></span><span class="comment" id="5842455">//&nbsp;a&nbsp;collection&nbsp;is&nbsp;triggered&nbsp;when&nbsp;the&nbsp;ratio&nbsp;of&nbsp;freshly&nbsp;allocated&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="5842525">//&nbsp;to&nbsp;live&nbsp;data&nbsp;remaining&nbsp;after&nbsp;the&nbsp;previous&nbsp;collection&nbsp;reaches&nbsp;this&nbsp;percentage.</span><br>
<span class="lineno"></span><span class="comment" id="5842606">//&nbsp;SetGCPercent&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5842652">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;GOGC&nbsp;environment&nbsp;variable</span><br>
<span class="lineno">95</span><span class="comment" id="5842721">//&nbsp;at&nbsp;startup,&nbsp;or&nbsp;100&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="5842771">//&nbsp;A&nbsp;negative&nbsp;percentage&nbsp;disables&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span><span class="keyword" id="5842825">func</span>&nbsp;<span class="ident" id="5842830">SetGCPercent</span><span class="op" id="5842842">(</span><span class="ident" id="5842843">percent</span>&nbsp;<span class="builtintype" id="5842851">int</span><span class="op" id="5842854">)</span>&nbsp;<span class="builtintype" id="5842856">int</span>&nbsp;<span class="op" id="5842860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5842863">old</span>&nbsp;<span class="op" id="5842867">:=</span>&nbsp;<span class="ident" id="5842870">setGCPercent</span><span class="op" id="5842882">(</span><span class="builtintype" id="5842883">int32</span><span class="op" id="5842888">(</span><span class="ident" id="5842889">percent</span><span class="op" id="5842896">)</span><span class="op" id="5842897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5842900">runtime</span><span class="op" id="5842907">.</span><span class="ident" id="5842908">GC</span><span class="op" id="5842910">(</span><span class="op" id="5842911">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5842914">return</span>&nbsp;<span class="builtintype" id="5842921">int</span><span class="op" id="5842924">(</span><span class="ident" id="5842925">old</span><span class="op" id="5842928">)</span><br>
<span class="lineno"></span><span class="op" id="5842930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5842933">//&nbsp;FreeOSMemory&nbsp;forces&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;followed&nbsp;by&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5842992">//&nbsp;attempt&nbsp;to&nbsp;return&nbsp;as&nbsp;much&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system</span><br>
<span class="lineno">105</span><span class="comment" id="5843052">//&nbsp;as&nbsp;possible.&nbsp;(Even&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;called,&nbsp;the&nbsp;runtime&nbsp;gradually</span><br>
<span class="lineno"></span><span class="comment" id="5843119">//&nbsp;returns&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system&nbsp;in&nbsp;a&nbsp;background&nbsp;task.)</span><br>
<span class="lineno"></span><span class="keyword" id="5843184">func</span>&nbsp;<span class="ident" id="5843189">FreeOSMemory</span><span class="op" id="5843201">(</span><span class="op" id="5843202">)</span>&nbsp;<span class="op" id="5843204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5843207">freeOSMemory</span><span class="op" id="5843219">(</span><span class="op" id="5843220">)</span><br>
<span class="lineno"></span><span class="op" id="5843222">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5843225">//&nbsp;SetMaxStack&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;amount&nbsp;of&nbsp;memory&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5843279">//&nbsp;can&nbsp;be&nbsp;used&nbsp;by&nbsp;a&nbsp;single&nbsp;goroutine&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5843323">//&nbsp;If&nbsp;any&nbsp;goroutine&nbsp;exceeds&nbsp;this&nbsp;limit&nbsp;while&nbsp;growing&nbsp;its&nbsp;stack,</span><br>
<span class="lineno"></span><span class="comment" id="5843387">//&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno">115</span><span class="comment" id="5843411">//&nbsp;SetMaxStack&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5843456">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;1&nbsp;GB&nbsp;on&nbsp;64-bit&nbsp;systems,&nbsp;250&nbsp;MB&nbsp;on&nbsp;32-bit&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="5843532">//</span><br>
<span class="lineno"></span><span class="comment" id="5843535">//&nbsp;SetMaxStack&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5843599">//&nbsp;goroutines&nbsp;that&nbsp;enter&nbsp;an&nbsp;infinite&nbsp;recursion.&nbsp;It&nbsp;only&nbsp;limits&nbsp;future</span><br>
<span class="lineno">120</span><span class="comment" id="5843669">//&nbsp;stack&nbsp;growth.</span><br>
<span class="lineno"></span><span class="keyword" id="5843686">func</span>&nbsp;<span class="ident" id="5843691">SetMaxStack</span><span class="op" id="5843702">(</span><span class="ident" id="5843703">bytes</span>&nbsp;<span class="builtintype" id="5843709">int</span><span class="op" id="5843712">)</span>&nbsp;<span class="builtintype" id="5843714">int</span>&nbsp;<span class="op" id="5843718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5843721">return</span>&nbsp;<span class="ident" id="5843728">setMaxStack</span><span class="op" id="5843739">(</span><span class="ident" id="5843740">bytes</span><span class="op" id="5843745">)</span><br>
<span class="lineno"></span><span class="op" id="5843747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5843750">//&nbsp;SetMaxThreads&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span><span class="comment" id="5843811">//&nbsp;threads&nbsp;that&nbsp;the&nbsp;Go&nbsp;program&nbsp;can&nbsp;use.&nbsp;If&nbsp;it&nbsp;attempts&nbsp;to&nbsp;use&nbsp;more&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="5843883">//&nbsp;this&nbsp;many,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="comment" id="5843918">//&nbsp;SetMaxThreads&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5843965">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;10,000&nbsp;threads.</span><br>
<span class="lineno">130</span><span class="comment" id="5844007">//</span><br>
<span class="lineno"></span><span class="comment" id="5844010">//&nbsp;The&nbsp;limit&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;operating&nbsp;system&nbsp;threads,&nbsp;not&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="5844087">//&nbsp;of&nbsp;goroutines.&nbsp;A&nbsp;Go&nbsp;program&nbsp;creates&nbsp;a&nbsp;new&nbsp;thread&nbsp;only&nbsp;when&nbsp;a&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="5844161">//&nbsp;is&nbsp;ready&nbsp;to&nbsp;run&nbsp;but&nbsp;all&nbsp;the&nbsp;existing&nbsp;threads&nbsp;are&nbsp;blocked&nbsp;in&nbsp;system&nbsp;calls,&nbsp;cgo&nbsp;calls,</span><br>
<span class="lineno"></span><span class="comment" id="5844249">//&nbsp;or&nbsp;are&nbsp;locked&nbsp;to&nbsp;other&nbsp;goroutines&nbsp;due&nbsp;to&nbsp;use&nbsp;of&nbsp;runtime.LockOSThread.</span><br>
<span class="lineno">135</span><span class="comment" id="5844322">//</span><br>
<span class="lineno"></span><span class="comment" id="5844325">//&nbsp;SetMaxThreads&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5844391">//&nbsp;programs&nbsp;that&nbsp;create&nbsp;an&nbsp;unbounded&nbsp;number&nbsp;of&nbsp;threads.&nbsp;The&nbsp;idea&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5844459">//&nbsp;to&nbsp;take&nbsp;down&nbsp;the&nbsp;program&nbsp;before&nbsp;it&nbsp;takes&nbsp;down&nbsp;the&nbsp;operating&nbsp;system.</span><br>
<span class="lineno"></span><span class="keyword" id="5844530">func</span>&nbsp;<span class="ident" id="5844535">SetMaxThreads</span><span class="op" id="5844548">(</span><span class="ident" id="5844549">threads</span>&nbsp;<span class="builtintype" id="5844557">int</span><span class="op" id="5844560">)</span>&nbsp;<span class="builtintype" id="5844562">int</span>&nbsp;<span class="op" id="5844566">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5844569">return</span>&nbsp;<span class="ident" id="5844576">setMaxThreads</span><span class="op" id="5844589">(</span><span class="ident" id="5844590">threads</span><span class="op" id="5844597">)</span><br>
<span class="lineno"></span><span class="op" id="5844599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5844602">//&nbsp;SetPanicOnFault&nbsp;controls&nbsp;the&nbsp;runtime&#39;s&nbsp;behavior&nbsp;when&nbsp;a&nbsp;program&nbsp;faults</span><br>
<span class="lineno"></span><span class="comment" id="5844675">//&nbsp;at&nbsp;an&nbsp;unexpected&nbsp;(non-nil)&nbsp;address.&nbsp;Such&nbsp;faults&nbsp;are&nbsp;typically&nbsp;caused&nbsp;by</span><br>
<span class="lineno">145</span><span class="comment" id="5844750">//&nbsp;bugs&nbsp;such&nbsp;as&nbsp;runtime&nbsp;memory&nbsp;corruption,&nbsp;so&nbsp;the&nbsp;default&nbsp;response&nbsp;is&nbsp;to&nbsp;crash</span><br>
<span class="lineno"></span><span class="comment" id="5844829">//&nbsp;the&nbsp;program.&nbsp;Programs&nbsp;working&nbsp;with&nbsp;memory-mapped&nbsp;files&nbsp;or&nbsp;unsafe</span><br>
<span class="lineno"></span><span class="comment" id="5844897">//&nbsp;manipulation&nbsp;of&nbsp;memory&nbsp;may&nbsp;cause&nbsp;faults&nbsp;at&nbsp;non-nil&nbsp;addresses&nbsp;in&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="5844969">//&nbsp;dramatic&nbsp;situations;&nbsp;SetPanicOnFault&nbsp;allows&nbsp;such&nbsp;programs&nbsp;to&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="5845041">//&nbsp;that&nbsp;the&nbsp;runtime&nbsp;trigger&nbsp;only&nbsp;a&nbsp;panic,&nbsp;not&nbsp;a&nbsp;crash.</span><br>
<span class="lineno">150</span><span class="comment" id="5845096">//&nbsp;SetPanicOnFault&nbsp;applies&nbsp;only&nbsp;to&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span><span class="comment" id="5845154">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="keyword" id="5845190">func</span>&nbsp;<span class="ident" id="5845195">SetPanicOnFault</span><span class="op" id="5845210">(</span><span class="ident" id="5845211">enabled</span>&nbsp;<span class="builtintype" id="5845219">bool</span><span class="op" id="5845223">)</span>&nbsp;<span class="builtintype" id="5845225">bool</span>&nbsp;<span class="op" id="5845230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5845233">return</span>&nbsp;<span class="ident" id="5845240">setPanicOnFault</span><span class="op" id="5845255">(</span><span class="ident" id="5845256">enabled</span><span class="op" id="5845263">)</span><br>
<span class="lineno"></span><span class="op" id="5845265">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5845268">//&nbsp;WriteHeapDump&nbsp;writes&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;heap&nbsp;and&nbsp;the&nbsp;objects&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5845337">//&nbsp;it&nbsp;to&nbsp;the&nbsp;given&nbsp;file&nbsp;descriptor.</span><br>
<span class="lineno"></span><span class="comment" id="5845373">//&nbsp;The&nbsp;heap&nbsp;dump&nbsp;format&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://golang.org/s/go13heapdump.</span><br>
<span class="lineno"></span><span class="keyword" id="5845445">func</span>&nbsp;<span class="ident" id="5845450">WriteHeapDump</span><span class="op" id="5845463">(</span><span class="ident" id="5845464">fd</span>&nbsp;<span class="builtintype" id="5845467">uintptr</span><span class="op" id="5845474">)</span>
</div>
</body>
</html>
