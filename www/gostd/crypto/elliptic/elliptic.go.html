<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4435352">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4435407">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4435461">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4435512">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="4435587">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="4435598">package</span>&nbsp;<span class="ident" id="4435606">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4435616">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="4435691">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="4435766">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="4435846">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4435921">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4435995">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4436060">import</span>&nbsp;<span class="op" id="4436067">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4436070">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4436076">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4436088">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="4436095">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4436098">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="4436162">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="4436223">type</span>&nbsp;<span class="ident" id="4436228">Curve</span>&nbsp;<span class="keyword" id="4436234">interface</span>&nbsp;<span class="op" id="4436244">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436247">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436296">Params</span><span class="op" id="4436302">(</span><span class="op" id="4436303">)</span>&nbsp;<span class="op" id="4436305">*</span><span class="ident" id="4436306">CurveParams</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436319">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436384">IsOnCurve</span><span class="op" id="4436393">(</span><span class="ident" id="4436394">x</span><span class="op" id="4436395">,</span>&nbsp;<span class="ident" id="4436397">y</span>&nbsp;<span class="op" id="4436399">*</span><span class="ident" id="4436400">big</span><span class="op" id="4436403">.</span><span class="ident" id="4436404">Int</span><span class="op" id="4436407">)</span>&nbsp;<span class="builtintype" id="4436409">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436415">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436462">Add</span><span class="op" id="4436465">(</span><span class="ident" id="4436466">x1</span><span class="op" id="4436468">,</span>&nbsp;<span class="ident" id="4436470">y1</span><span class="op" id="4436472">,</span>&nbsp;<span class="ident" id="4436474">x2</span><span class="op" id="4436476">,</span>&nbsp;<span class="ident" id="4436478">y2</span>&nbsp;<span class="op" id="4436481">*</span><span class="ident" id="4436482">big</span><span class="op" id="4436485">.</span><span class="ident" id="4436486">Int</span><span class="op" id="4436489">)</span>&nbsp;<span class="op" id="4436491">(</span><span class="ident" id="4436492">x</span><span class="op" id="4436493">,</span>&nbsp;<span class="ident" id="4436495">y</span>&nbsp;<span class="op" id="4436497">*</span><span class="ident" id="4436498">big</span><span class="op" id="4436501">.</span><span class="ident" id="4436502">Int</span><span class="op" id="4436505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436508">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436535">Double</span><span class="op" id="4436541">(</span><span class="ident" id="4436542">x1</span><span class="op" id="4436544">,</span>&nbsp;<span class="ident" id="4436546">y1</span>&nbsp;<span class="op" id="4436549">*</span><span class="ident" id="4436550">big</span><span class="op" id="4436553">.</span><span class="ident" id="4436554">Int</span><span class="op" id="4436557">)</span>&nbsp;<span class="op" id="4436559">(</span><span class="ident" id="4436560">x</span><span class="op" id="4436561">,</span>&nbsp;<span class="ident" id="4436563">y</span>&nbsp;<span class="op" id="4436565">*</span><span class="ident" id="4436566">big</span><span class="op" id="4436569">.</span><span class="ident" id="4436570">Int</span><span class="op" id="4436573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436576">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436649">ScalarMult</span><span class="op" id="4436659">(</span><span class="ident" id="4436660">x1</span><span class="op" id="4436662">,</span>&nbsp;<span class="ident" id="4436664">y1</span>&nbsp;<span class="op" id="4436667">*</span><span class="ident" id="4436668">big</span><span class="op" id="4436671">.</span><span class="ident" id="4436672">Int</span><span class="op" id="4436675">,</span>&nbsp;<span class="ident" id="4436677">k</span>&nbsp;<span class="op" id="4436679">[</span><span class="op" id="4436680">]</span><span class="builtintype" id="4436681">byte</span><span class="op" id="4436685">)</span>&nbsp;<span class="op" id="4436687">(</span><span class="ident" id="4436688">x</span><span class="op" id="4436689">,</span>&nbsp;<span class="ident" id="4436691">y</span>&nbsp;<span class="op" id="4436693">*</span><span class="ident" id="4436694">big</span><span class="op" id="4436697">.</span><span class="ident" id="4436698">Int</span><span class="op" id="4436701">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436704">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4436775">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4436819">ScalarBaseMult</span><span class="op" id="4436833">(</span><span class="ident" id="4436834">k</span>&nbsp;<span class="op" id="4436836">[</span><span class="op" id="4436837">]</span><span class="builtintype" id="4436838">byte</span><span class="op" id="4436842">)</span>&nbsp;<span class="op" id="4436844">(</span><span class="ident" id="4436845">x</span><span class="op" id="4436846">,</span>&nbsp;<span class="ident" id="4436848">y</span>&nbsp;<span class="op" id="4436850">*</span><span class="ident" id="4436851">big</span><span class="op" id="4436854">.</span><span class="ident" id="4436855">Int</span><span class="op" id="4436858">)</span><br>
<span class="lineno"></span><span class="op" id="4436860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4436863">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="4436941">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="4436998">type</span>&nbsp;<span class="ident" id="4437003">CurveParams</span>&nbsp;<span class="keyword" id="4437015">struct</span>&nbsp;<span class="op" id="4437022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437025">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4437033">*</span><span class="ident" id="4437034">big</span><span class="op" id="4437037">.</span><span class="ident" id="4437038">Int</span>&nbsp;<span class="comment" id="4437042">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437080">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4437088">*</span><span class="ident" id="4437089">big</span><span class="op" id="4437092">.</span><span class="ident" id="4437093">Int</span>&nbsp;<span class="comment" id="4437097">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437129">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4437137">*</span><span class="ident" id="4437138">big</span><span class="op" id="4437141">.</span><span class="ident" id="4437142">Int</span>&nbsp;<span class="comment" id="4437146">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437185">Gx</span><span class="op" id="4437187">,</span>&nbsp;<span class="ident" id="4437189">Gy</span>&nbsp;&nbsp;<span class="op" id="4437193">*</span><span class="ident" id="4437194">big</span><span class="op" id="4437197">.</span><span class="ident" id="4437198">Int</span>&nbsp;<span class="comment" id="4437202">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437230">BitSize</span>&nbsp;<span class="builtintype" id="4437238">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4437247">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="4437283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4437286">func</span>&nbsp;<span class="op" id="4437291">(</span><span class="ident" id="4437292">curve</span>&nbsp;<span class="op" id="4437298">*</span><span class="ident" id="4437299">CurveParams</span><span class="op" id="4437310">)</span>&nbsp;<span class="ident" id="4437312">Params</span><span class="op" id="4437318">(</span><span class="op" id="4437319">)</span>&nbsp;<span class="op" id="4437321">*</span><span class="ident" id="4437322">CurveParams</span>&nbsp;<span class="op" id="4437334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437337">return</span>&nbsp;<span class="ident" id="4437344">curve</span><br>
<span class="lineno"></span><span class="op" id="4437350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4437353">func</span>&nbsp;<span class="op" id="4437358">(</span><span class="ident" id="4437359">curve</span>&nbsp;<span class="op" id="4437365">*</span><span class="ident" id="4437366">CurveParams</span><span class="op" id="4437377">)</span>&nbsp;<span class="ident" id="4437379">IsOnCurve</span><span class="op" id="4437388">(</span><span class="ident" id="4437389">x</span><span class="op" id="4437390">,</span>&nbsp;<span class="ident" id="4437392">y</span>&nbsp;<span class="op" id="4437394">*</span><span class="ident" id="4437395">big</span><span class="op" id="4437398">.</span><span class="ident" id="4437399">Int</span><span class="op" id="4437402">)</span>&nbsp;<span class="builtintype" id="4437404">bool</span>&nbsp;<span class="op" id="4437409">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4437412">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437435">y2</span>&nbsp;<span class="op" id="4437438">:=</span>&nbsp;<span class="builtinfunc" id="4437441">new</span><span class="op" id="4437444">(</span><span class="ident" id="4437445">big</span><span class="op" id="4437448">.</span><span class="ident" id="4437449">Int</span><span class="op" id="4437452">)</span><span class="op" id="4437453">.</span><span class="ident" id="4437454">Mul</span><span class="op" id="4437457">(</span><span class="ident" id="4437458">y</span><span class="op" id="4437459">,</span>&nbsp;<span class="ident" id="4437461">y</span><span class="op" id="4437462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437465">y2</span><span class="op" id="4437467">.</span><span class="ident" id="4437468">Mod</span><span class="op" id="4437471">(</span><span class="ident" id="4437472">y2</span><span class="op" id="4437474">,</span>&nbsp;<span class="ident" id="4437476">curve</span><span class="op" id="4437481">.</span><span class="ident" id="4437482">P</span><span class="op" id="4437483">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437487">x3</span>&nbsp;<span class="op" id="4437490">:=</span>&nbsp;<span class="builtinfunc" id="4437493">new</span><span class="op" id="4437496">(</span><span class="ident" id="4437497">big</span><span class="op" id="4437500">.</span><span class="ident" id="4437501">Int</span><span class="op" id="4437504">)</span><span class="op" id="4437505">.</span><span class="ident" id="4437506">Mul</span><span class="op" id="4437509">(</span><span class="ident" id="4437510">x</span><span class="op" id="4437511">,</span>&nbsp;<span class="ident" id="4437513">x</span><span class="op" id="4437514">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437517">x3</span><span class="op" id="4437519">.</span><span class="ident" id="4437520">Mul</span><span class="op" id="4437523">(</span><span class="ident" id="4437524">x3</span><span class="op" id="4437526">,</span>&nbsp;<span class="ident" id="4437528">x</span><span class="op" id="4437529">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437533">threeX</span>&nbsp;<span class="op" id="4437540">:=</span>&nbsp;<span class="builtinfunc" id="4437543">new</span><span class="op" id="4437546">(</span><span class="ident" id="4437547">big</span><span class="op" id="4437550">.</span><span class="ident" id="4437551">Int</span><span class="op" id="4437554">)</span><span class="op" id="4437555">.</span><span class="ident" id="4437556">Lsh</span><span class="op" id="4437559">(</span><span class="ident" id="4437560">x</span><span class="op" id="4437561">,</span>&nbsp;<span class="num" id="4437563">1</span><span class="op" id="4437564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437567">threeX</span><span class="op" id="4437573">.</span><span class="ident" id="4437574">Add</span><span class="op" id="4437577">(</span><span class="ident" id="4437578">threeX</span><span class="op" id="4437584">,</span>&nbsp;<span class="ident" id="4437586">x</span><span class="op" id="4437587">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437591">x3</span><span class="op" id="4437593">.</span><span class="ident" id="4437594">Sub</span><span class="op" id="4437597">(</span><span class="ident" id="4437598">x3</span><span class="op" id="4437600">,</span>&nbsp;<span class="ident" id="4437602">threeX</span><span class="op" id="4437608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437611">x3</span><span class="op" id="4437613">.</span><span class="ident" id="4437614">Add</span><span class="op" id="4437617">(</span><span class="ident" id="4437618">x3</span><span class="op" id="4437620">,</span>&nbsp;<span class="ident" id="4437622">curve</span><span class="op" id="4437627">.</span><span class="ident" id="4437628">B</span><span class="op" id="4437629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437632">x3</span><span class="op" id="4437634">.</span><span class="ident" id="4437635">Mod</span><span class="op" id="4437638">(</span><span class="ident" id="4437639">x3</span><span class="op" id="4437641">,</span>&nbsp;<span class="ident" id="4437643">curve</span><span class="op" id="4437648">.</span><span class="ident" id="4437649">P</span><span class="op" id="4437650">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437654">return</span>&nbsp;<span class="ident" id="4437661">x3</span><span class="op" id="4437663">.</span><span class="ident" id="4437664">Cmp</span><span class="op" id="4437667">(</span><span class="ident" id="4437668">y2</span><span class="op" id="4437670">)</span>&nbsp;<span class="op" id="4437672">==</span>&nbsp;<span class="num" id="4437675">0</span><br>
<span class="lineno">70</span><span class="op" id="4437677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4437680">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4437759">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="4437839">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="4437891">func</span>&nbsp;<span class="ident" id="4437896">zForAffine</span><span class="op" id="4437906">(</span><span class="ident" id="4437907">x</span><span class="op" id="4437908">,</span>&nbsp;<span class="ident" id="4437910">y</span>&nbsp;<span class="op" id="4437912">*</span><span class="ident" id="4437913">big</span><span class="op" id="4437916">.</span><span class="ident" id="4437917">Int</span><span class="op" id="4437920">)</span>&nbsp;<span class="op" id="4437922">*</span><span class="ident" id="4437923">big</span><span class="op" id="4437926">.</span><span class="ident" id="4437927">Int</span>&nbsp;<span class="op" id="4437931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437934">z</span>&nbsp;<span class="op" id="4437936">:=</span>&nbsp;<span class="builtinfunc" id="4437939">new</span><span class="op" id="4437942">(</span><span class="ident" id="4437943">big</span><span class="op" id="4437946">.</span><span class="ident" id="4437947">Int</span><span class="op" id="4437950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4437953">if</span>&nbsp;<span class="ident" id="4437956">x</span><span class="op" id="4437957">.</span><span class="ident" id="4437958">Sign</span><span class="op" id="4437962">(</span><span class="op" id="4437963">)</span>&nbsp;<span class="op" id="4437965">!=</span>&nbsp;<span class="num" id="4437968">0</span>&nbsp;<span class="op" id="4437970">||</span>&nbsp;<span class="ident" id="4437973">y</span><span class="op" id="4437974">.</span><span class="ident" id="4437975">Sign</span><span class="op" id="4437979">(</span><span class="op" id="4437980">)</span>&nbsp;<span class="op" id="4437982">!=</span>&nbsp;<span class="num" id="4437985">0</span>&nbsp;<span class="op" id="4437987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4437991">z</span><span class="op" id="4437992">.</span><span class="ident" id="4437993">SetInt64</span><span class="op" id="4438001">(</span><span class="num" id="4438002">1</span><span class="op" id="4438003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438006">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438009">return</span>&nbsp;<span class="ident" id="4438016">z</span><br>
<span class="lineno"></span><span class="op" id="4438018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4438021">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4438099">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="4438156">func</span>&nbsp;<span class="op" id="4438161">(</span><span class="ident" id="4438162">curve</span>&nbsp;<span class="op" id="4438168">*</span><span class="ident" id="4438169">CurveParams</span><span class="op" id="4438180">)</span>&nbsp;<span class="ident" id="4438182">affineFromJacobian</span><span class="op" id="4438200">(</span><span class="ident" id="4438201">x</span><span class="op" id="4438202">,</span>&nbsp;<span class="ident" id="4438204">y</span><span class="op" id="4438205">,</span>&nbsp;<span class="ident" id="4438207">z</span>&nbsp;<span class="op" id="4438209">*</span><span class="ident" id="4438210">big</span><span class="op" id="4438213">.</span><span class="ident" id="4438214">Int</span><span class="op" id="4438217">)</span>&nbsp;<span class="op" id="4438219">(</span><span class="ident" id="4438220">xOut</span><span class="op" id="4438224">,</span>&nbsp;<span class="ident" id="4438226">yOut</span>&nbsp;<span class="op" id="4438231">*</span><span class="ident" id="4438232">big</span><span class="op" id="4438235">.</span><span class="ident" id="4438236">Int</span><span class="op" id="4438239">)</span>&nbsp;<span class="op" id="4438241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438244">if</span>&nbsp;<span class="ident" id="4438247">z</span><span class="op" id="4438248">.</span><span class="ident" id="4438249">Sign</span><span class="op" id="4438253">(</span><span class="op" id="4438254">)</span>&nbsp;<span class="op" id="4438256">==</span>&nbsp;<span class="num" id="4438259">0</span>&nbsp;<span class="op" id="4438261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438265">return</span>&nbsp;<span class="builtinfunc" id="4438272">new</span><span class="op" id="4438275">(</span><span class="ident" id="4438276">big</span><span class="op" id="4438279">.</span><span class="ident" id="4438280">Int</span><span class="op" id="4438283">)</span><span class="op" id="4438284">,</span>&nbsp;<span class="builtinfunc" id="4438286">new</span><span class="op" id="4438289">(</span><span class="ident" id="4438290">big</span><span class="op" id="4438293">.</span><span class="ident" id="4438294">Int</span><span class="op" id="4438297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4438300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438304">zinv</span>&nbsp;<span class="op" id="4438309">:=</span>&nbsp;<span class="builtinfunc" id="4438312">new</span><span class="op" id="4438315">(</span><span class="ident" id="4438316">big</span><span class="op" id="4438319">.</span><span class="ident" id="4438320">Int</span><span class="op" id="4438323">)</span><span class="op" id="4438324">.</span><span class="ident" id="4438325">ModInverse</span><span class="op" id="4438335">(</span><span class="ident" id="4438336">z</span><span class="op" id="4438337">,</span>&nbsp;<span class="ident" id="4438339">curve</span><span class="op" id="4438344">.</span><span class="ident" id="4438345">P</span><span class="op" id="4438346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438349">zinvsq</span>&nbsp;<span class="op" id="4438356">:=</span>&nbsp;<span class="builtinfunc" id="4438359">new</span><span class="op" id="4438362">(</span><span class="ident" id="4438363">big</span><span class="op" id="4438366">.</span><span class="ident" id="4438367">Int</span><span class="op" id="4438370">)</span><span class="op" id="4438371">.</span><span class="ident" id="4438372">Mul</span><span class="op" id="4438375">(</span><span class="ident" id="4438376">zinv</span><span class="op" id="4438380">,</span>&nbsp;<span class="ident" id="4438382">zinv</span><span class="op" id="4438386">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438390">xOut</span>&nbsp;<span class="op" id="4438395">=</span>&nbsp;<span class="builtinfunc" id="4438397">new</span><span class="op" id="4438400">(</span><span class="ident" id="4438401">big</span><span class="op" id="4438404">.</span><span class="ident" id="4438405">Int</span><span class="op" id="4438408">)</span><span class="op" id="4438409">.</span><span class="ident" id="4438410">Mul</span><span class="op" id="4438413">(</span><span class="ident" id="4438414">x</span><span class="op" id="4438415">,</span>&nbsp;<span class="ident" id="4438417">zinvsq</span><span class="op" id="4438423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438426">xOut</span><span class="op" id="4438430">.</span><span class="ident" id="4438431">Mod</span><span class="op" id="4438434">(</span><span class="ident" id="4438435">xOut</span><span class="op" id="4438439">,</span>&nbsp;<span class="ident" id="4438441">curve</span><span class="op" id="4438446">.</span><span class="ident" id="4438447">P</span><span class="op" id="4438448">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438451">zinvsq</span><span class="op" id="4438457">.</span><span class="ident" id="4438458">Mul</span><span class="op" id="4438461">(</span><span class="ident" id="4438462">zinvsq</span><span class="op" id="4438468">,</span>&nbsp;<span class="ident" id="4438470">zinv</span><span class="op" id="4438474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438477">yOut</span>&nbsp;<span class="op" id="4438482">=</span>&nbsp;<span class="builtinfunc" id="4438484">new</span><span class="op" id="4438487">(</span><span class="ident" id="4438488">big</span><span class="op" id="4438491">.</span><span class="ident" id="4438492">Int</span><span class="op" id="4438495">)</span><span class="op" id="4438496">.</span><span class="ident" id="4438497">Mul</span><span class="op" id="4438500">(</span><span class="ident" id="4438501">y</span><span class="op" id="4438502">,</span>&nbsp;<span class="ident" id="4438504">zinvsq</span><span class="op" id="4438510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438513">yOut</span><span class="op" id="4438517">.</span><span class="ident" id="4438518">Mod</span><span class="op" id="4438521">(</span><span class="ident" id="4438522">yOut</span><span class="op" id="4438526">,</span>&nbsp;<span class="ident" id="4438528">curve</span><span class="op" id="4438533">.</span><span class="ident" id="4438534">P</span><span class="op" id="4438535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438538">return</span><br>
<span class="lineno"></span><span class="op" id="4438545">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4438548">func</span>&nbsp;<span class="op" id="4438553">(</span><span class="ident" id="4438554">curve</span>&nbsp;<span class="op" id="4438560">*</span><span class="ident" id="4438561">CurveParams</span><span class="op" id="4438572">)</span>&nbsp;<span class="ident" id="4438574">Add</span><span class="op" id="4438577">(</span><span class="ident" id="4438578">x1</span><span class="op" id="4438580">,</span>&nbsp;<span class="ident" id="4438582">y1</span><span class="op" id="4438584">,</span>&nbsp;<span class="ident" id="4438586">x2</span><span class="op" id="4438588">,</span>&nbsp;<span class="ident" id="4438590">y2</span>&nbsp;<span class="op" id="4438593">*</span><span class="ident" id="4438594">big</span><span class="op" id="4438597">.</span><span class="ident" id="4438598">Int</span><span class="op" id="4438601">)</span>&nbsp;<span class="op" id="4438603">(</span><span class="op" id="4438604">*</span><span class="ident" id="4438605">big</span><span class="op" id="4438608">.</span><span class="ident" id="4438609">Int</span><span class="op" id="4438612">,</span>&nbsp;<span class="op" id="4438614">*</span><span class="ident" id="4438615">big</span><span class="op" id="4438618">.</span><span class="ident" id="4438619">Int</span><span class="op" id="4438622">)</span>&nbsp;<span class="op" id="4438624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438627">z1</span>&nbsp;<span class="op" id="4438630">:=</span>&nbsp;<span class="ident" id="4438633">zForAffine</span><span class="op" id="4438643">(</span><span class="ident" id="4438644">x1</span><span class="op" id="4438646">,</span>&nbsp;<span class="ident" id="4438648">y1</span><span class="op" id="4438650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4438653">z2</span>&nbsp;<span class="op" id="4438656">:=</span>&nbsp;<span class="ident" id="4438659">zForAffine</span><span class="op" id="4438669">(</span><span class="ident" id="4438670">x2</span><span class="op" id="4438672">,</span>&nbsp;<span class="ident" id="4438674">y2</span><span class="op" id="4438676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4438679">return</span>&nbsp;<span class="ident" id="4438686">curve</span><span class="op" id="4438691">.</span><span class="ident" id="4438692">affineFromJacobian</span><span class="op" id="4438710">(</span><span class="ident" id="4438711">curve</span><span class="op" id="4438716">.</span><span class="ident" id="4438717">addJacobian</span><span class="op" id="4438728">(</span><span class="ident" id="4438729">x1</span><span class="op" id="4438731">,</span>&nbsp;<span class="ident" id="4438733">y1</span><span class="op" id="4438735">,</span>&nbsp;<span class="ident" id="4438737">z1</span><span class="op" id="4438739">,</span>&nbsp;<span class="ident" id="4438741">x2</span><span class="op" id="4438743">,</span>&nbsp;<span class="ident" id="4438745">y2</span><span class="op" id="4438747">,</span>&nbsp;<span class="ident" id="4438749">z2</span><span class="op" id="4438751">)</span><span class="op" id="4438752">)</span><br>
<span class="lineno">105</span><span class="op" id="4438754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4438757">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4438831">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4438893">func</span>&nbsp;<span class="op" id="4438898">(</span><span class="ident" id="4438899">curve</span>&nbsp;<span class="op" id="4438905">*</span><span class="ident" id="4438906">CurveParams</span><span class="op" id="4438917">)</span>&nbsp;<span class="ident" id="4438919">addJacobian</span><span class="op" id="4438930">(</span><span class="ident" id="4438931">x1</span><span class="op" id="4438933">,</span>&nbsp;<span class="ident" id="4438935">y1</span><span class="op" id="4438937">,</span>&nbsp;<span class="ident" id="4438939">z1</span><span class="op" id="4438941">,</span>&nbsp;<span class="ident" id="4438943">x2</span><span class="op" id="4438945">,</span>&nbsp;<span class="ident" id="4438947">y2</span><span class="op" id="4438949">,</span>&nbsp;<span class="ident" id="4438951">z2</span>&nbsp;<span class="op" id="4438954">*</span><span class="ident" id="4438955">big</span><span class="op" id="4438958">.</span><span class="ident" id="4438959">Int</span><span class="op" id="4438962">)</span>&nbsp;<span class="op" id="4438964">(</span><span class="op" id="4438965">*</span><span class="ident" id="4438966">big</span><span class="op" id="4438969">.</span><span class="ident" id="4438970">Int</span><span class="op" id="4438973">,</span>&nbsp;<span class="op" id="4438975">*</span><span class="ident" id="4438976">big</span><span class="op" id="4438979">.</span><span class="ident" id="4438980">Int</span><span class="op" id="4438983">,</span>&nbsp;<span class="op" id="4438985">*</span><span class="ident" id="4438986">big</span><span class="op" id="4438989">.</span><span class="ident" id="4438990">Int</span><span class="op" id="4438993">)</span>&nbsp;<span class="op" id="4438995">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4438998">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439088">x3</span><span class="op" id="4439090">,</span>&nbsp;<span class="ident" id="4439092">y3</span><span class="op" id="4439094">,</span>&nbsp;<span class="ident" id="4439096">z3</span>&nbsp;<span class="op" id="4439099">:=</span>&nbsp;<span class="builtinfunc" id="4439102">new</span><span class="op" id="4439105">(</span><span class="ident" id="4439106">big</span><span class="op" id="4439109">.</span><span class="ident" id="4439110">Int</span><span class="op" id="4439113">)</span><span class="op" id="4439114">,</span>&nbsp;<span class="builtinfunc" id="4439116">new</span><span class="op" id="4439119">(</span><span class="ident" id="4439120">big</span><span class="op" id="4439123">.</span><span class="ident" id="4439124">Int</span><span class="op" id="4439127">)</span><span class="op" id="4439128">,</span>&nbsp;<span class="builtinfunc" id="4439130">new</span><span class="op" id="4439133">(</span><span class="ident" id="4439134">big</span><span class="op" id="4439137">.</span><span class="ident" id="4439138">Int</span><span class="op" id="4439141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439144">if</span>&nbsp;<span class="ident" id="4439147">z1</span><span class="op" id="4439149">.</span><span class="ident" id="4439150">Sign</span><span class="op" id="4439154">(</span><span class="op" id="4439155">)</span>&nbsp;<span class="op" id="4439157">==</span>&nbsp;<span class="num" id="4439160">0</span>&nbsp;<span class="op" id="4439162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439166">x3</span><span class="op" id="4439168">.</span><span class="ident" id="4439169">Set</span><span class="op" id="4439172">(</span><span class="ident" id="4439173">x2</span><span class="op" id="4439175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439179">y3</span><span class="op" id="4439181">.</span><span class="ident" id="4439182">Set</span><span class="op" id="4439185">(</span><span class="ident" id="4439186">y2</span><span class="op" id="4439188">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439192">z3</span><span class="op" id="4439194">.</span><span class="ident" id="4439195">Set</span><span class="op" id="4439198">(</span><span class="ident" id="4439199">z2</span><span class="op" id="4439201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439205">return</span>&nbsp;<span class="ident" id="4439212">x3</span><span class="op" id="4439214">,</span>&nbsp;<span class="ident" id="4439216">y3</span><span class="op" id="4439218">,</span>&nbsp;<span class="ident" id="4439220">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439227">if</span>&nbsp;<span class="ident" id="4439230">z2</span><span class="op" id="4439232">.</span><span class="ident" id="4439233">Sign</span><span class="op" id="4439237">(</span><span class="op" id="4439238">)</span>&nbsp;<span class="op" id="4439240">==</span>&nbsp;<span class="num" id="4439243">0</span>&nbsp;<span class="op" id="4439245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439249">x3</span><span class="op" id="4439251">.</span><span class="ident" id="4439252">Set</span><span class="op" id="4439255">(</span><span class="ident" id="4439256">x1</span><span class="op" id="4439258">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439262">y3</span><span class="op" id="4439264">.</span><span class="ident" id="4439265">Set</span><span class="op" id="4439268">(</span><span class="ident" id="4439269">y1</span><span class="op" id="4439271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439275">z3</span><span class="op" id="4439277">.</span><span class="ident" id="4439278">Set</span><span class="op" id="4439281">(</span><span class="ident" id="4439282">z1</span><span class="op" id="4439284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439288">return</span>&nbsp;<span class="ident" id="4439295">x3</span><span class="op" id="4439297">,</span>&nbsp;<span class="ident" id="4439299">y3</span><span class="op" id="4439301">,</span>&nbsp;<span class="ident" id="4439303">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439311">z1z1</span>&nbsp;<span class="op" id="4439316">:=</span>&nbsp;<span class="builtinfunc" id="4439319">new</span><span class="op" id="4439322">(</span><span class="ident" id="4439323">big</span><span class="op" id="4439326">.</span><span class="ident" id="4439327">Int</span><span class="op" id="4439330">)</span><span class="op" id="4439331">.</span><span class="ident" id="4439332">Mul</span><span class="op" id="4439335">(</span><span class="ident" id="4439336">z1</span><span class="op" id="4439338">,</span>&nbsp;<span class="ident" id="4439340">z1</span><span class="op" id="4439342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439345">z1z1</span><span class="op" id="4439349">.</span><span class="ident" id="4439350">Mod</span><span class="op" id="4439353">(</span><span class="ident" id="4439354">z1z1</span><span class="op" id="4439358">,</span>&nbsp;<span class="ident" id="4439360">curve</span><span class="op" id="4439365">.</span><span class="ident" id="4439366">P</span><span class="op" id="4439367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439370">z2z2</span>&nbsp;<span class="op" id="4439375">:=</span>&nbsp;<span class="builtinfunc" id="4439378">new</span><span class="op" id="4439381">(</span><span class="ident" id="4439382">big</span><span class="op" id="4439385">.</span><span class="ident" id="4439386">Int</span><span class="op" id="4439389">)</span><span class="op" id="4439390">.</span><span class="ident" id="4439391">Mul</span><span class="op" id="4439394">(</span><span class="ident" id="4439395">z2</span><span class="op" id="4439397">,</span>&nbsp;<span class="ident" id="4439399">z2</span><span class="op" id="4439401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439404">z2z2</span><span class="op" id="4439408">.</span><span class="ident" id="4439409">Mod</span><span class="op" id="4439412">(</span><span class="ident" id="4439413">z2z2</span><span class="op" id="4439417">,</span>&nbsp;<span class="ident" id="4439419">curve</span><span class="op" id="4439424">.</span><span class="ident" id="4439425">P</span><span class="op" id="4439426">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439430">u1</span>&nbsp;<span class="op" id="4439433">:=</span>&nbsp;<span class="builtinfunc" id="4439436">new</span><span class="op" id="4439439">(</span><span class="ident" id="4439440">big</span><span class="op" id="4439443">.</span><span class="ident" id="4439444">Int</span><span class="op" id="4439447">)</span><span class="op" id="4439448">.</span><span class="ident" id="4439449">Mul</span><span class="op" id="4439452">(</span><span class="ident" id="4439453">x1</span><span class="op" id="4439455">,</span>&nbsp;<span class="ident" id="4439457">z2z2</span><span class="op" id="4439461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439464">u1</span><span class="op" id="4439466">.</span><span class="ident" id="4439467">Mod</span><span class="op" id="4439470">(</span><span class="ident" id="4439471">u1</span><span class="op" id="4439473">,</span>&nbsp;<span class="ident" id="4439475">curve</span><span class="op" id="4439480">.</span><span class="ident" id="4439481">P</span><span class="op" id="4439482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439485">u2</span>&nbsp;<span class="op" id="4439488">:=</span>&nbsp;<span class="builtinfunc" id="4439491">new</span><span class="op" id="4439494">(</span><span class="ident" id="4439495">big</span><span class="op" id="4439498">.</span><span class="ident" id="4439499">Int</span><span class="op" id="4439502">)</span><span class="op" id="4439503">.</span><span class="ident" id="4439504">Mul</span><span class="op" id="4439507">(</span><span class="ident" id="4439508">x2</span><span class="op" id="4439510">,</span>&nbsp;<span class="ident" id="4439512">z1z1</span><span class="op" id="4439516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439519">u2</span><span class="op" id="4439521">.</span><span class="ident" id="4439522">Mod</span><span class="op" id="4439525">(</span><span class="ident" id="4439526">u2</span><span class="op" id="4439528">,</span>&nbsp;<span class="ident" id="4439530">curve</span><span class="op" id="4439535">.</span><span class="ident" id="4439536">P</span><span class="op" id="4439537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439540">h</span>&nbsp;<span class="op" id="4439542">:=</span>&nbsp;<span class="builtinfunc" id="4439545">new</span><span class="op" id="4439548">(</span><span class="ident" id="4439549">big</span><span class="op" id="4439552">.</span><span class="ident" id="4439553">Int</span><span class="op" id="4439556">)</span><span class="op" id="4439557">.</span><span class="ident" id="4439558">Sub</span><span class="op" id="4439561">(</span><span class="ident" id="4439562">u2</span><span class="op" id="4439564">,</span>&nbsp;<span class="ident" id="4439566">u1</span><span class="op" id="4439568">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439571">xEqual</span>&nbsp;<span class="op" id="4439578">:=</span>&nbsp;<span class="ident" id="4439581">h</span><span class="op" id="4439582">.</span><span class="ident" id="4439583">Sign</span><span class="op" id="4439587">(</span><span class="op" id="4439588">)</span>&nbsp;<span class="op" id="4439590">==</span>&nbsp;<span class="num" id="4439593">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439596">if</span>&nbsp;<span class="ident" id="4439599">h</span><span class="op" id="4439600">.</span><span class="ident" id="4439601">Sign</span><span class="op" id="4439605">(</span><span class="op" id="4439606">)</span>&nbsp;<span class="op" id="4439608">==</span>&nbsp;<span class="op" id="4439611">-</span><span class="num" id="4439612">1</span>&nbsp;<span class="op" id="4439614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439618">h</span><span class="op" id="4439619">.</span><span class="ident" id="4439620">Add</span><span class="op" id="4439623">(</span><span class="ident" id="4439624">h</span><span class="op" id="4439625">,</span>&nbsp;<span class="ident" id="4439627">curve</span><span class="op" id="4439632">.</span><span class="ident" id="4439633">P</span><span class="op" id="4439634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439640">i</span>&nbsp;<span class="op" id="4439642">:=</span>&nbsp;<span class="builtinfunc" id="4439645">new</span><span class="op" id="4439648">(</span><span class="ident" id="4439649">big</span><span class="op" id="4439652">.</span><span class="ident" id="4439653">Int</span><span class="op" id="4439656">)</span><span class="op" id="4439657">.</span><span class="ident" id="4439658">Lsh</span><span class="op" id="4439661">(</span><span class="ident" id="4439662">h</span><span class="op" id="4439663">,</span>&nbsp;<span class="num" id="4439665">1</span><span class="op" id="4439666">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439669">i</span><span class="op" id="4439670">.</span><span class="ident" id="4439671">Mul</span><span class="op" id="4439674">(</span><span class="ident" id="4439675">i</span><span class="op" id="4439676">,</span>&nbsp;<span class="ident" id="4439678">i</span><span class="op" id="4439679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439682">j</span>&nbsp;<span class="op" id="4439684">:=</span>&nbsp;<span class="builtinfunc" id="4439687">new</span><span class="op" id="4439690">(</span><span class="ident" id="4439691">big</span><span class="op" id="4439694">.</span><span class="ident" id="4439695">Int</span><span class="op" id="4439698">)</span><span class="op" id="4439699">.</span><span class="ident" id="4439700">Mul</span><span class="op" id="4439703">(</span><span class="ident" id="4439704">h</span><span class="op" id="4439705">,</span>&nbsp;<span class="ident" id="4439707">i</span><span class="op" id="4439708">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439712">s1</span>&nbsp;<span class="op" id="4439715">:=</span>&nbsp;<span class="builtinfunc" id="4439718">new</span><span class="op" id="4439721">(</span><span class="ident" id="4439722">big</span><span class="op" id="4439725">.</span><span class="ident" id="4439726">Int</span><span class="op" id="4439729">)</span><span class="op" id="4439730">.</span><span class="ident" id="4439731">Mul</span><span class="op" id="4439734">(</span><span class="ident" id="4439735">y1</span><span class="op" id="4439737">,</span>&nbsp;<span class="ident" id="4439739">z2</span><span class="op" id="4439741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439744">s1</span><span class="op" id="4439746">.</span><span class="ident" id="4439747">Mul</span><span class="op" id="4439750">(</span><span class="ident" id="4439751">s1</span><span class="op" id="4439753">,</span>&nbsp;<span class="ident" id="4439755">z2z2</span><span class="op" id="4439759">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439762">s1</span><span class="op" id="4439764">.</span><span class="ident" id="4439765">Mod</span><span class="op" id="4439768">(</span><span class="ident" id="4439769">s1</span><span class="op" id="4439771">,</span>&nbsp;<span class="ident" id="4439773">curve</span><span class="op" id="4439778">.</span><span class="ident" id="4439779">P</span><span class="op" id="4439780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439783">s2</span>&nbsp;<span class="op" id="4439786">:=</span>&nbsp;<span class="builtinfunc" id="4439789">new</span><span class="op" id="4439792">(</span><span class="ident" id="4439793">big</span><span class="op" id="4439796">.</span><span class="ident" id="4439797">Int</span><span class="op" id="4439800">)</span><span class="op" id="4439801">.</span><span class="ident" id="4439802">Mul</span><span class="op" id="4439805">(</span><span class="ident" id="4439806">y2</span><span class="op" id="4439808">,</span>&nbsp;<span class="ident" id="4439810">z1</span><span class="op" id="4439812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439815">s2</span><span class="op" id="4439817">.</span><span class="ident" id="4439818">Mul</span><span class="op" id="4439821">(</span><span class="ident" id="4439822">s2</span><span class="op" id="4439824">,</span>&nbsp;<span class="ident" id="4439826">z1z1</span><span class="op" id="4439830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439833">s2</span><span class="op" id="4439835">.</span><span class="ident" id="4439836">Mod</span><span class="op" id="4439839">(</span><span class="ident" id="4439840">s2</span><span class="op" id="4439842">,</span>&nbsp;<span class="ident" id="4439844">curve</span><span class="op" id="4439849">.</span><span class="ident" id="4439850">P</span><span class="op" id="4439851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439854">r</span>&nbsp;<span class="op" id="4439856">:=</span>&nbsp;<span class="builtinfunc" id="4439859">new</span><span class="op" id="4439862">(</span><span class="ident" id="4439863">big</span><span class="op" id="4439866">.</span><span class="ident" id="4439867">Int</span><span class="op" id="4439870">)</span><span class="op" id="4439871">.</span><span class="ident" id="4439872">Sub</span><span class="op" id="4439875">(</span><span class="ident" id="4439876">s2</span><span class="op" id="4439878">,</span>&nbsp;<span class="ident" id="4439880">s1</span><span class="op" id="4439882">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439885">if</span>&nbsp;<span class="ident" id="4439888">r</span><span class="op" id="4439889">.</span><span class="ident" id="4439890">Sign</span><span class="op" id="4439894">(</span><span class="op" id="4439895">)</span>&nbsp;<span class="op" id="4439897">==</span>&nbsp;<span class="op" id="4439900">-</span><span class="num" id="4439901">1</span>&nbsp;<span class="op" id="4439903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439907">r</span><span class="op" id="4439908">.</span><span class="ident" id="4439909">Add</span><span class="op" id="4439912">(</span><span class="ident" id="4439913">r</span><span class="op" id="4439914">,</span>&nbsp;<span class="ident" id="4439916">curve</span><span class="op" id="4439921">.</span><span class="ident" id="4439922">P</span><span class="op" id="4439923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4439926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4439929">yEqual</span>&nbsp;<span class="op" id="4439936">:=</span>&nbsp;<span class="ident" id="4439939">r</span><span class="op" id="4439940">.</span><span class="ident" id="4439941">Sign</span><span class="op" id="4439945">(</span><span class="op" id="4439946">)</span>&nbsp;<span class="op" id="4439948">==</span>&nbsp;<span class="num" id="4439951">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439954">if</span>&nbsp;<span class="ident" id="4439957">xEqual</span>&nbsp;<span class="op" id="4439964">&amp;&amp;</span>&nbsp;<span class="ident" id="4439967">yEqual</span>&nbsp;<span class="op" id="4439974">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4439978">return</span>&nbsp;<span class="ident" id="4439985">curve</span><span class="op" id="4439990">.</span><span class="ident" id="4439991">doubleJacobian</span><span class="op" id="4440005">(</span><span class="ident" id="4440006">x1</span><span class="op" id="4440008">,</span>&nbsp;<span class="ident" id="4440010">y1</span><span class="op" id="4440012">,</span>&nbsp;<span class="ident" id="4440014">z1</span><span class="op" id="4440016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4440019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440022">r</span><span class="op" id="4440023">.</span><span class="ident" id="4440024">Lsh</span><span class="op" id="4440027">(</span><span class="ident" id="4440028">r</span><span class="op" id="4440029">,</span>&nbsp;<span class="num" id="4440031">1</span><span class="op" id="4440032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440035">v</span>&nbsp;<span class="op" id="4440037">:=</span>&nbsp;<span class="builtinfunc" id="4440040">new</span><span class="op" id="4440043">(</span><span class="ident" id="4440044">big</span><span class="op" id="4440047">.</span><span class="ident" id="4440048">Int</span><span class="op" id="4440051">)</span><span class="op" id="4440052">.</span><span class="ident" id="4440053">Mul</span><span class="op" id="4440056">(</span><span class="ident" id="4440057">u1</span><span class="op" id="4440059">,</span>&nbsp;<span class="ident" id="4440061">i</span><span class="op" id="4440062">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440066">x3</span><span class="op" id="4440068">.</span><span class="ident" id="4440069">Set</span><span class="op" id="4440072">(</span><span class="ident" id="4440073">r</span><span class="op" id="4440074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440077">x3</span><span class="op" id="4440079">.</span><span class="ident" id="4440080">Mul</span><span class="op" id="4440083">(</span><span class="ident" id="4440084">x3</span><span class="op" id="4440086">,</span>&nbsp;<span class="ident" id="4440088">x3</span><span class="op" id="4440090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440093">x3</span><span class="op" id="4440095">.</span><span class="ident" id="4440096">Sub</span><span class="op" id="4440099">(</span><span class="ident" id="4440100">x3</span><span class="op" id="4440102">,</span>&nbsp;<span class="ident" id="4440104">j</span><span class="op" id="4440105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440108">x3</span><span class="op" id="4440110">.</span><span class="ident" id="4440111">Sub</span><span class="op" id="4440114">(</span><span class="ident" id="4440115">x3</span><span class="op" id="4440117">,</span>&nbsp;<span class="ident" id="4440119">v</span><span class="op" id="4440120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440123">x3</span><span class="op" id="4440125">.</span><span class="ident" id="4440126">Sub</span><span class="op" id="4440129">(</span><span class="ident" id="4440130">x3</span><span class="op" id="4440132">,</span>&nbsp;<span class="ident" id="4440134">v</span><span class="op" id="4440135">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440138">x3</span><span class="op" id="4440140">.</span><span class="ident" id="4440141">Mod</span><span class="op" id="4440144">(</span><span class="ident" id="4440145">x3</span><span class="op" id="4440147">,</span>&nbsp;<span class="ident" id="4440149">curve</span><span class="op" id="4440154">.</span><span class="ident" id="4440155">P</span><span class="op" id="4440156">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440160">y3</span><span class="op" id="4440162">.</span><span class="ident" id="4440163">Set</span><span class="op" id="4440166">(</span><span class="ident" id="4440167">r</span><span class="op" id="4440168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440171">v</span><span class="op" id="4440172">.</span><span class="ident" id="4440173">Sub</span><span class="op" id="4440176">(</span><span class="ident" id="4440177">v</span><span class="op" id="4440178">,</span>&nbsp;<span class="ident" id="4440180">x3</span><span class="op" id="4440182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440185">y3</span><span class="op" id="4440187">.</span><span class="ident" id="4440188">Mul</span><span class="op" id="4440191">(</span><span class="ident" id="4440192">y3</span><span class="op" id="4440194">,</span>&nbsp;<span class="ident" id="4440196">v</span><span class="op" id="4440197">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440200">s1</span><span class="op" id="4440202">.</span><span class="ident" id="4440203">Mul</span><span class="op" id="4440206">(</span><span class="ident" id="4440207">s1</span><span class="op" id="4440209">,</span>&nbsp;<span class="ident" id="4440211">j</span><span class="op" id="4440212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440215">s1</span><span class="op" id="4440217">.</span><span class="ident" id="4440218">Lsh</span><span class="op" id="4440221">(</span><span class="ident" id="4440222">s1</span><span class="op" id="4440224">,</span>&nbsp;<span class="num" id="4440226">1</span><span class="op" id="4440227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440230">y3</span><span class="op" id="4440232">.</span><span class="ident" id="4440233">Sub</span><span class="op" id="4440236">(</span><span class="ident" id="4440237">y3</span><span class="op" id="4440239">,</span>&nbsp;<span class="ident" id="4440241">s1</span><span class="op" id="4440243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440246">y3</span><span class="op" id="4440248">.</span><span class="ident" id="4440249">Mod</span><span class="op" id="4440252">(</span><span class="ident" id="4440253">y3</span><span class="op" id="4440255">,</span>&nbsp;<span class="ident" id="4440257">curve</span><span class="op" id="4440262">.</span><span class="ident" id="4440263">P</span><span class="op" id="4440264">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440268">z3</span><span class="op" id="4440270">.</span><span class="ident" id="4440271">Add</span><span class="op" id="4440274">(</span><span class="ident" id="4440275">z1</span><span class="op" id="4440277">,</span>&nbsp;<span class="ident" id="4440279">z2</span><span class="op" id="4440281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440284">z3</span><span class="op" id="4440286">.</span><span class="ident" id="4440287">Mul</span><span class="op" id="4440290">(</span><span class="ident" id="4440291">z3</span><span class="op" id="4440293">,</span>&nbsp;<span class="ident" id="4440295">z3</span><span class="op" id="4440297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440300">z3</span><span class="op" id="4440302">.</span><span class="ident" id="4440303">Sub</span><span class="op" id="4440306">(</span><span class="ident" id="4440307">z3</span><span class="op" id="4440309">,</span>&nbsp;<span class="ident" id="4440311">z1z1</span><span class="op" id="4440315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440318">z3</span><span class="op" id="4440320">.</span><span class="ident" id="4440321">Sub</span><span class="op" id="4440324">(</span><span class="ident" id="4440325">z3</span><span class="op" id="4440327">,</span>&nbsp;<span class="ident" id="4440329">z2z2</span><span class="op" id="4440333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440336">z3</span><span class="op" id="4440338">.</span><span class="ident" id="4440339">Mul</span><span class="op" id="4440342">(</span><span class="ident" id="4440343">z3</span><span class="op" id="4440345">,</span>&nbsp;<span class="ident" id="4440347">h</span><span class="op" id="4440348">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440351">z3</span><span class="op" id="4440353">.</span><span class="ident" id="4440354">Mod</span><span class="op" id="4440357">(</span><span class="ident" id="4440358">z3</span><span class="op" id="4440360">,</span>&nbsp;<span class="ident" id="4440362">curve</span><span class="op" id="4440367">.</span><span class="ident" id="4440368">P</span><span class="op" id="4440369">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440373">return</span>&nbsp;<span class="ident" id="4440380">x3</span><span class="op" id="4440382">,</span>&nbsp;<span class="ident" id="4440384">y3</span><span class="op" id="4440386">,</span>&nbsp;<span class="ident" id="4440388">z3</span><br>
<span class="lineno"></span><span class="op" id="4440391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4440394">func</span>&nbsp;<span class="op" id="4440399">(</span><span class="ident" id="4440400">curve</span>&nbsp;<span class="op" id="4440406">*</span><span class="ident" id="4440407">CurveParams</span><span class="op" id="4440418">)</span>&nbsp;<span class="ident" id="4440420">Double</span><span class="op" id="4440426">(</span><span class="ident" id="4440427">x1</span><span class="op" id="4440429">,</span>&nbsp;<span class="ident" id="4440431">y1</span>&nbsp;<span class="op" id="4440434">*</span><span class="ident" id="4440435">big</span><span class="op" id="4440438">.</span><span class="ident" id="4440439">Int</span><span class="op" id="4440442">)</span>&nbsp;<span class="op" id="4440444">(</span><span class="op" id="4440445">*</span><span class="ident" id="4440446">big</span><span class="op" id="4440449">.</span><span class="ident" id="4440450">Int</span><span class="op" id="4440453">,</span>&nbsp;<span class="op" id="4440455">*</span><span class="ident" id="4440456">big</span><span class="op" id="4440459">.</span><span class="ident" id="4440460">Int</span><span class="op" id="4440463">)</span>&nbsp;<span class="op" id="4440465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440468">z1</span>&nbsp;<span class="op" id="4440471">:=</span>&nbsp;<span class="ident" id="4440474">zForAffine</span><span class="op" id="4440484">(</span><span class="ident" id="4440485">x1</span><span class="op" id="4440487">,</span>&nbsp;<span class="ident" id="4440489">y1</span><span class="op" id="4440491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4440494">return</span>&nbsp;<span class="ident" id="4440501">curve</span><span class="op" id="4440506">.</span><span class="ident" id="4440507">affineFromJacobian</span><span class="op" id="4440525">(</span><span class="ident" id="4440526">curve</span><span class="op" id="4440531">.</span><span class="ident" id="4440532">doubleJacobian</span><span class="op" id="4440546">(</span><span class="ident" id="4440547">x1</span><span class="op" id="4440549">,</span>&nbsp;<span class="ident" id="4440551">y1</span><span class="op" id="4440553">,</span>&nbsp;<span class="ident" id="4440555">z1</span><span class="op" id="4440557">)</span><span class="op" id="4440558">)</span><br>
<span class="lineno"></span><span class="op" id="4440560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4440563">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4440635">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4440681">func</span>&nbsp;<span class="op" id="4440686">(</span><span class="ident" id="4440687">curve</span>&nbsp;<span class="op" id="4440693">*</span><span class="ident" id="4440694">CurveParams</span><span class="op" id="4440705">)</span>&nbsp;<span class="ident" id="4440707">doubleJacobian</span><span class="op" id="4440721">(</span><span class="ident" id="4440722">x</span><span class="op" id="4440723">,</span>&nbsp;<span class="ident" id="4440725">y</span><span class="op" id="4440726">,</span>&nbsp;<span class="ident" id="4440728">z</span>&nbsp;<span class="op" id="4440730">*</span><span class="ident" id="4440731">big</span><span class="op" id="4440734">.</span><span class="ident" id="4440735">Int</span><span class="op" id="4440738">)</span>&nbsp;<span class="op" id="4440740">(</span><span class="op" id="4440741">*</span><span class="ident" id="4440742">big</span><span class="op" id="4440745">.</span><span class="ident" id="4440746">Int</span><span class="op" id="4440749">,</span>&nbsp;<span class="op" id="4440751">*</span><span class="ident" id="4440752">big</span><span class="op" id="4440755">.</span><span class="ident" id="4440756">Int</span><span class="op" id="4440759">,</span>&nbsp;<span class="op" id="4440761">*</span><span class="ident" id="4440762">big</span><span class="op" id="4440765">.</span><span class="ident" id="4440766">Int</span><span class="op" id="4440769">)</span>&nbsp;<span class="op" id="4440771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4440774">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440863">delta</span>&nbsp;<span class="op" id="4440869">:=</span>&nbsp;<span class="builtinfunc" id="4440872">new</span><span class="op" id="4440875">(</span><span class="ident" id="4440876">big</span><span class="op" id="4440879">.</span><span class="ident" id="4440880">Int</span><span class="op" id="4440883">)</span><span class="op" id="4440884">.</span><span class="ident" id="4440885">Mul</span><span class="op" id="4440888">(</span><span class="ident" id="4440889">z</span><span class="op" id="4440890">,</span>&nbsp;<span class="ident" id="4440892">z</span><span class="op" id="4440893">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440896">delta</span><span class="op" id="4440901">.</span><span class="ident" id="4440902">Mod</span><span class="op" id="4440905">(</span><span class="ident" id="4440906">delta</span><span class="op" id="4440911">,</span>&nbsp;<span class="ident" id="4440913">curve</span><span class="op" id="4440918">.</span><span class="ident" id="4440919">P</span><span class="op" id="4440920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440923">gamma</span>&nbsp;<span class="op" id="4440929">:=</span>&nbsp;<span class="builtinfunc" id="4440932">new</span><span class="op" id="4440935">(</span><span class="ident" id="4440936">big</span><span class="op" id="4440939">.</span><span class="ident" id="4440940">Int</span><span class="op" id="4440943">)</span><span class="op" id="4440944">.</span><span class="ident" id="4440945">Mul</span><span class="op" id="4440948">(</span><span class="ident" id="4440949">y</span><span class="op" id="4440950">,</span>&nbsp;<span class="ident" id="4440952">y</span><span class="op" id="4440953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440956">gamma</span><span class="op" id="4440961">.</span><span class="ident" id="4440962">Mod</span><span class="op" id="4440965">(</span><span class="ident" id="4440966">gamma</span><span class="op" id="4440971">,</span>&nbsp;<span class="ident" id="4440973">curve</span><span class="op" id="4440978">.</span><span class="ident" id="4440979">P</span><span class="op" id="4440980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4440983">alpha</span>&nbsp;<span class="op" id="4440989">:=</span>&nbsp;<span class="builtinfunc" id="4440992">new</span><span class="op" id="4440995">(</span><span class="ident" id="4440996">big</span><span class="op" id="4440999">.</span><span class="ident" id="4441000">Int</span><span class="op" id="4441003">)</span><span class="op" id="4441004">.</span><span class="ident" id="4441005">Sub</span><span class="op" id="4441008">(</span><span class="ident" id="4441009">x</span><span class="op" id="4441010">,</span>&nbsp;<span class="ident" id="4441012">delta</span><span class="op" id="4441017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441020">if</span>&nbsp;<span class="ident" id="4441023">alpha</span><span class="op" id="4441028">.</span><span class="ident" id="4441029">Sign</span><span class="op" id="4441033">(</span><span class="op" id="4441034">)</span>&nbsp;<span class="op" id="4441036">==</span>&nbsp;<span class="op" id="4441039">-</span><span class="num" id="4441040">1</span>&nbsp;<span class="op" id="4441042">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441046">alpha</span><span class="op" id="4441051">.</span><span class="ident" id="4441052">Add</span><span class="op" id="4441055">(</span><span class="ident" id="4441056">alpha</span><span class="op" id="4441061">,</span>&nbsp;<span class="ident" id="4441063">curve</span><span class="op" id="4441068">.</span><span class="ident" id="4441069">P</span><span class="op" id="4441070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441076">alpha2</span>&nbsp;<span class="op" id="4441083">:=</span>&nbsp;<span class="builtinfunc" id="4441086">new</span><span class="op" id="4441089">(</span><span class="ident" id="4441090">big</span><span class="op" id="4441093">.</span><span class="ident" id="4441094">Int</span><span class="op" id="4441097">)</span><span class="op" id="4441098">.</span><span class="ident" id="4441099">Add</span><span class="op" id="4441102">(</span><span class="ident" id="4441103">x</span><span class="op" id="4441104">,</span>&nbsp;<span class="ident" id="4441106">delta</span><span class="op" id="4441111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441114">alpha</span><span class="op" id="4441119">.</span><span class="ident" id="4441120">Mul</span><span class="op" id="4441123">(</span><span class="ident" id="4441124">alpha</span><span class="op" id="4441129">,</span>&nbsp;<span class="ident" id="4441131">alpha2</span><span class="op" id="4441137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441140">alpha2</span><span class="op" id="4441146">.</span><span class="ident" id="4441147">Set</span><span class="op" id="4441150">(</span><span class="ident" id="4441151">alpha</span><span class="op" id="4441156">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441159">alpha</span><span class="op" id="4441164">.</span><span class="ident" id="4441165">Lsh</span><span class="op" id="4441168">(</span><span class="ident" id="4441169">alpha</span><span class="op" id="4441174">,</span>&nbsp;<span class="num" id="4441176">1</span><span class="op" id="4441177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441180">alpha</span><span class="op" id="4441185">.</span><span class="ident" id="4441186">Add</span><span class="op" id="4441189">(</span><span class="ident" id="4441190">alpha</span><span class="op" id="4441195">,</span>&nbsp;<span class="ident" id="4441197">alpha2</span><span class="op" id="4441203">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441207">beta</span>&nbsp;<span class="op" id="4441212">:=</span>&nbsp;<span class="ident" id="4441215">alpha2</span><span class="op" id="4441221">.</span><span class="ident" id="4441222">Mul</span><span class="op" id="4441225">(</span><span class="ident" id="4441226">x</span><span class="op" id="4441227">,</span>&nbsp;<span class="ident" id="4441229">gamma</span><span class="op" id="4441234">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441238">x3</span>&nbsp;<span class="op" id="4441241">:=</span>&nbsp;<span class="builtinfunc" id="4441244">new</span><span class="op" id="4441247">(</span><span class="ident" id="4441248">big</span><span class="op" id="4441251">.</span><span class="ident" id="4441252">Int</span><span class="op" id="4441255">)</span><span class="op" id="4441256">.</span><span class="ident" id="4441257">Mul</span><span class="op" id="4441260">(</span><span class="ident" id="4441261">alpha</span><span class="op" id="4441266">,</span>&nbsp;<span class="ident" id="4441268">alpha</span><span class="op" id="4441273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441276">beta8</span>&nbsp;<span class="op" id="4441282">:=</span>&nbsp;<span class="builtinfunc" id="4441285">new</span><span class="op" id="4441288">(</span><span class="ident" id="4441289">big</span><span class="op" id="4441292">.</span><span class="ident" id="4441293">Int</span><span class="op" id="4441296">)</span><span class="op" id="4441297">.</span><span class="ident" id="4441298">Lsh</span><span class="op" id="4441301">(</span><span class="ident" id="4441302">beta</span><span class="op" id="4441306">,</span>&nbsp;<span class="num" id="4441308">3</span><span class="op" id="4441309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441312">x3</span><span class="op" id="4441314">.</span><span class="ident" id="4441315">Sub</span><span class="op" id="4441318">(</span><span class="ident" id="4441319">x3</span><span class="op" id="4441321">,</span>&nbsp;<span class="ident" id="4441323">beta8</span><span class="op" id="4441328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441331">for</span>&nbsp;<span class="ident" id="4441335">x3</span><span class="op" id="4441337">.</span><span class="ident" id="4441338">Sign</span><span class="op" id="4441342">(</span><span class="op" id="4441343">)</span>&nbsp;<span class="op" id="4441345">==</span>&nbsp;<span class="op" id="4441348">-</span><span class="num" id="4441349">1</span>&nbsp;<span class="op" id="4441351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441355">x3</span><span class="op" id="4441357">.</span><span class="ident" id="4441358">Add</span><span class="op" id="4441361">(</span><span class="ident" id="4441362">x3</span><span class="op" id="4441364">,</span>&nbsp;<span class="ident" id="4441366">curve</span><span class="op" id="4441371">.</span><span class="ident" id="4441372">P</span><span class="op" id="4441373">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441379">x3</span><span class="op" id="4441381">.</span><span class="ident" id="4441382">Mod</span><span class="op" id="4441385">(</span><span class="ident" id="4441386">x3</span><span class="op" id="4441388">,</span>&nbsp;<span class="ident" id="4441390">curve</span><span class="op" id="4441395">.</span><span class="ident" id="4441396">P</span><span class="op" id="4441397">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441401">z3</span>&nbsp;<span class="op" id="4441404">:=</span>&nbsp;<span class="builtinfunc" id="4441407">new</span><span class="op" id="4441410">(</span><span class="ident" id="4441411">big</span><span class="op" id="4441414">.</span><span class="ident" id="4441415">Int</span><span class="op" id="4441418">)</span><span class="op" id="4441419">.</span><span class="ident" id="4441420">Add</span><span class="op" id="4441423">(</span><span class="ident" id="4441424">y</span><span class="op" id="4441425">,</span>&nbsp;<span class="ident" id="4441427">z</span><span class="op" id="4441428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441431">z3</span><span class="op" id="4441433">.</span><span class="ident" id="4441434">Mul</span><span class="op" id="4441437">(</span><span class="ident" id="4441438">z3</span><span class="op" id="4441440">,</span>&nbsp;<span class="ident" id="4441442">z3</span><span class="op" id="4441444">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441447">z3</span><span class="op" id="4441449">.</span><span class="ident" id="4441450">Sub</span><span class="op" id="4441453">(</span><span class="ident" id="4441454">z3</span><span class="op" id="4441456">,</span>&nbsp;<span class="ident" id="4441458">gamma</span><span class="op" id="4441463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441466">if</span>&nbsp;<span class="ident" id="4441469">z3</span><span class="op" id="4441471">.</span><span class="ident" id="4441472">Sign</span><span class="op" id="4441476">(</span><span class="op" id="4441477">)</span>&nbsp;<span class="op" id="4441479">==</span>&nbsp;<span class="op" id="4441482">-</span><span class="num" id="4441483">1</span>&nbsp;<span class="op" id="4441485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441489">z3</span><span class="op" id="4441491">.</span><span class="ident" id="4441492">Add</span><span class="op" id="4441495">(</span><span class="ident" id="4441496">z3</span><span class="op" id="4441498">,</span>&nbsp;<span class="ident" id="4441500">curve</span><span class="op" id="4441505">.</span><span class="ident" id="4441506">P</span><span class="op" id="4441507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441513">z3</span><span class="op" id="4441515">.</span><span class="ident" id="4441516">Sub</span><span class="op" id="4441519">(</span><span class="ident" id="4441520">z3</span><span class="op" id="4441522">,</span>&nbsp;<span class="ident" id="4441524">delta</span><span class="op" id="4441529">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441532">if</span>&nbsp;<span class="ident" id="4441535">z3</span><span class="op" id="4441537">.</span><span class="ident" id="4441538">Sign</span><span class="op" id="4441542">(</span><span class="op" id="4441543">)</span>&nbsp;<span class="op" id="4441545">==</span>&nbsp;<span class="op" id="4441548">-</span><span class="num" id="4441549">1</span>&nbsp;<span class="op" id="4441551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441555">z3</span><span class="op" id="4441557">.</span><span class="ident" id="4441558">Add</span><span class="op" id="4441561">(</span><span class="ident" id="4441562">z3</span><span class="op" id="4441564">,</span>&nbsp;<span class="ident" id="4441566">curve</span><span class="op" id="4441571">.</span><span class="ident" id="4441572">P</span><span class="op" id="4441573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441579">z3</span><span class="op" id="4441581">.</span><span class="ident" id="4441582">Mod</span><span class="op" id="4441585">(</span><span class="ident" id="4441586">z3</span><span class="op" id="4441588">,</span>&nbsp;<span class="ident" id="4441590">curve</span><span class="op" id="4441595">.</span><span class="ident" id="4441596">P</span><span class="op" id="4441597">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441601">beta</span><span class="op" id="4441605">.</span><span class="ident" id="4441606">Lsh</span><span class="op" id="4441609">(</span><span class="ident" id="4441610">beta</span><span class="op" id="4441614">,</span>&nbsp;<span class="num" id="4441616">2</span><span class="op" id="4441617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441620">beta</span><span class="op" id="4441624">.</span><span class="ident" id="4441625">Sub</span><span class="op" id="4441628">(</span><span class="ident" id="4441629">beta</span><span class="op" id="4441633">,</span>&nbsp;<span class="ident" id="4441635">x3</span><span class="op" id="4441637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441640">if</span>&nbsp;<span class="ident" id="4441643">beta</span><span class="op" id="4441647">.</span><span class="ident" id="4441648">Sign</span><span class="op" id="4441652">(</span><span class="op" id="4441653">)</span>&nbsp;<span class="op" id="4441655">==</span>&nbsp;<span class="op" id="4441658">-</span><span class="num" id="4441659">1</span>&nbsp;<span class="op" id="4441661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441665">beta</span><span class="op" id="4441669">.</span><span class="ident" id="4441670">Add</span><span class="op" id="4441673">(</span><span class="ident" id="4441674">beta</span><span class="op" id="4441678">,</span>&nbsp;<span class="ident" id="4441680">curve</span><span class="op" id="4441685">.</span><span class="ident" id="4441686">P</span><span class="op" id="4441687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441690">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441693">y3</span>&nbsp;<span class="op" id="4441696">:=</span>&nbsp;<span class="ident" id="4441699">alpha</span><span class="op" id="4441704">.</span><span class="ident" id="4441705">Mul</span><span class="op" id="4441708">(</span><span class="ident" id="4441709">alpha</span><span class="op" id="4441714">,</span>&nbsp;<span class="ident" id="4441716">beta</span><span class="op" id="4441720">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441724">gamma</span><span class="op" id="4441729">.</span><span class="ident" id="4441730">Mul</span><span class="op" id="4441733">(</span><span class="ident" id="4441734">gamma</span><span class="op" id="4441739">,</span>&nbsp;<span class="ident" id="4441741">gamma</span><span class="op" id="4441746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441749">gamma</span><span class="op" id="4441754">.</span><span class="ident" id="4441755">Lsh</span><span class="op" id="4441758">(</span><span class="ident" id="4441759">gamma</span><span class="op" id="4441764">,</span>&nbsp;<span class="num" id="4441766">3</span><span class="op" id="4441767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441770">gamma</span><span class="op" id="4441775">.</span><span class="ident" id="4441776">Mod</span><span class="op" id="4441779">(</span><span class="ident" id="4441780">gamma</span><span class="op" id="4441785">,</span>&nbsp;<span class="ident" id="4441787">curve</span><span class="op" id="4441792">.</span><span class="ident" id="4441793">P</span><span class="op" id="4441794">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441798">y3</span><span class="op" id="4441800">.</span><span class="ident" id="4441801">Sub</span><span class="op" id="4441804">(</span><span class="ident" id="4441805">y3</span><span class="op" id="4441807">,</span>&nbsp;<span class="ident" id="4441809">gamma</span><span class="op" id="4441814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441817">if</span>&nbsp;<span class="ident" id="4441820">y3</span><span class="op" id="4441822">.</span><span class="ident" id="4441823">Sign</span><span class="op" id="4441827">(</span><span class="op" id="4441828">)</span>&nbsp;<span class="op" id="4441830">==</span>&nbsp;<span class="op" id="4441833">-</span><span class="num" id="4441834">1</span>&nbsp;<span class="op" id="4441836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441840">y3</span><span class="op" id="4441842">.</span><span class="ident" id="4441843">Add</span><span class="op" id="4441846">(</span><span class="ident" id="4441847">y3</span><span class="op" id="4441849">,</span>&nbsp;<span class="ident" id="4441851">curve</span><span class="op" id="4441856">.</span><span class="ident" id="4441857">P</span><span class="op" id="4441858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4441861">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441864">y3</span><span class="op" id="4441866">.</span><span class="ident" id="4441867">Mod</span><span class="op" id="4441870">(</span><span class="ident" id="4441871">y3</span><span class="op" id="4441873">,</span>&nbsp;<span class="ident" id="4441875">curve</span><span class="op" id="4441880">.</span><span class="ident" id="4441881">P</span><span class="op" id="4441882">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4441886">return</span>&nbsp;<span class="ident" id="4441893">x3</span><span class="op" id="4441895">,</span>&nbsp;<span class="ident" id="4441897">y3</span><span class="op" id="4441899">,</span>&nbsp;<span class="ident" id="4441901">z3</span><br>
<span class="lineno"></span><span class="op" id="4441904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="4441907">func</span>&nbsp;<span class="op" id="4441912">(</span><span class="ident" id="4441913">curve</span>&nbsp;<span class="op" id="4441919">*</span><span class="ident" id="4441920">CurveParams</span><span class="op" id="4441931">)</span>&nbsp;<span class="ident" id="4441933">ScalarMult</span><span class="op" id="4441943">(</span><span class="ident" id="4441944">Bx</span><span class="op" id="4441946">,</span>&nbsp;<span class="ident" id="4441948">By</span>&nbsp;<span class="op" id="4441951">*</span><span class="ident" id="4441952">big</span><span class="op" id="4441955">.</span><span class="ident" id="4441956">Int</span><span class="op" id="4441959">,</span>&nbsp;<span class="ident" id="4441961">k</span>&nbsp;<span class="op" id="4441963">[</span><span class="op" id="4441964">]</span><span class="builtintype" id="4441965">byte</span><span class="op" id="4441969">)</span>&nbsp;<span class="op" id="4441971">(</span><span class="op" id="4441972">*</span><span class="ident" id="4441973">big</span><span class="op" id="4441976">.</span><span class="ident" id="4441977">Int</span><span class="op" id="4441980">,</span>&nbsp;<span class="op" id="4441982">*</span><span class="ident" id="4441983">big</span><span class="op" id="4441986">.</span><span class="ident" id="4441987">Int</span><span class="op" id="4441990">)</span>&nbsp;<span class="op" id="4441992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4441995">Bz</span>&nbsp;<span class="op" id="4441998">:=</span>&nbsp;<span class="builtinfunc" id="4442001">new</span><span class="op" id="4442004">(</span><span class="ident" id="4442005">big</span><span class="op" id="4442008">.</span><span class="ident" id="4442009">Int</span><span class="op" id="4442012">)</span><span class="op" id="4442013">.</span><span class="ident" id="4442014">SetInt64</span><span class="op" id="4442022">(</span><span class="num" id="4442023">1</span><span class="op" id="4442024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442027">x</span><span class="op" id="4442028">,</span>&nbsp;<span class="ident" id="4442030">y</span><span class="op" id="4442031">,</span>&nbsp;<span class="ident" id="4442033">z</span>&nbsp;<span class="op" id="4442035">:=</span>&nbsp;<span class="builtinfunc" id="4442038">new</span><span class="op" id="4442041">(</span><span class="ident" id="4442042">big</span><span class="op" id="4442045">.</span><span class="ident" id="4442046">Int</span><span class="op" id="4442049">)</span><span class="op" id="4442050">,</span>&nbsp;<span class="builtinfunc" id="4442052">new</span><span class="op" id="4442055">(</span><span class="ident" id="4442056">big</span><span class="op" id="4442059">.</span><span class="ident" id="4442060">Int</span><span class="op" id="4442063">)</span><span class="op" id="4442064">,</span>&nbsp;<span class="builtinfunc" id="4442066">new</span><span class="op" id="4442069">(</span><span class="ident" id="4442070">big</span><span class="op" id="4442073">.</span><span class="ident" id="4442074">Int</span><span class="op" id="4442077">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442081">for</span>&nbsp;<span class="ident" id="4442085">_</span><span class="op" id="4442086">,</span>&nbsp;<span class="builtintype" id="4442088">byte</span>&nbsp;<span class="op" id="4442093">:=</span>&nbsp;<span class="keyword" id="4442096">range</span>&nbsp;<span class="ident" id="4442102">k</span>&nbsp;<span class="op" id="4442104">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442108">for</span>&nbsp;<span class="ident" id="4442112">bitNum</span>&nbsp;<span class="op" id="4442119">:=</span>&nbsp;<span class="num" id="4442122">0</span><span class="op" id="4442123">;</span>&nbsp;<span class="ident" id="4442125">bitNum</span>&nbsp;<span class="op" id="4442132">&lt;</span>&nbsp;<span class="num" id="4442134">8</span><span class="op" id="4442135">;</span>&nbsp;<span class="ident" id="4442137">bitNum</span><span class="op" id="4442143">++</span>&nbsp;<span class="op" id="4442146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442151">x</span><span class="op" id="4442152">,</span>&nbsp;<span class="ident" id="4442154">y</span><span class="op" id="4442155">,</span>&nbsp;<span class="ident" id="4442157">z</span>&nbsp;<span class="op" id="4442159">=</span>&nbsp;<span class="ident" id="4442161">curve</span><span class="op" id="4442166">.</span><span class="ident" id="4442167">doubleJacobian</span><span class="op" id="4442181">(</span><span class="ident" id="4442182">x</span><span class="op" id="4442183">,</span>&nbsp;<span class="ident" id="4442185">y</span><span class="op" id="4442186">,</span>&nbsp;<span class="ident" id="4442188">z</span><span class="op" id="4442189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442194">if</span>&nbsp;<span class="builtintype" id="4442197">byte</span><span class="op" id="4442201">&amp;</span><span class="num" id="4442202">0x80</span>&nbsp;<span class="op" id="4442207">==</span>&nbsp;<span class="num" id="4442210">0x80</span>&nbsp;<span class="op" id="4442215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442221">x</span><span class="op" id="4442222">,</span>&nbsp;<span class="ident" id="4442224">y</span><span class="op" id="4442225">,</span>&nbsp;<span class="ident" id="4442227">z</span>&nbsp;<span class="op" id="4442229">=</span>&nbsp;<span class="ident" id="4442231">curve</span><span class="op" id="4442236">.</span><span class="ident" id="4442237">addJacobian</span><span class="op" id="4442248">(</span><span class="ident" id="4442249">Bx</span><span class="op" id="4442251">,</span>&nbsp;<span class="ident" id="4442253">By</span><span class="op" id="4442255">,</span>&nbsp;<span class="ident" id="4442257">Bz</span><span class="op" id="4442259">,</span>&nbsp;<span class="ident" id="4442261">x</span><span class="op" id="4442262">,</span>&nbsp;<span class="ident" id="4442264">y</span><span class="op" id="4442265">,</span>&nbsp;<span class="ident" id="4442267">z</span><span class="op" id="4442268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442273">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4442278">byte</span>&nbsp;<span class="op" id="4442283">&lt;&lt;=</span>&nbsp;<span class="num" id="4442287">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442298">return</span>&nbsp;<span class="ident" id="4442305">curve</span><span class="op" id="4442310">.</span><span class="ident" id="4442311">affineFromJacobian</span><span class="op" id="4442329">(</span><span class="ident" id="4442330">x</span><span class="op" id="4442331">,</span>&nbsp;<span class="ident" id="4442333">y</span><span class="op" id="4442334">,</span>&nbsp;<span class="ident" id="4442336">z</span><span class="op" id="4442337">)</span><br>
<span class="lineno">265</span><span class="op" id="4442339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4442342">func</span>&nbsp;<span class="op" id="4442347">(</span><span class="ident" id="4442348">curve</span>&nbsp;<span class="op" id="4442354">*</span><span class="ident" id="4442355">CurveParams</span><span class="op" id="4442366">)</span>&nbsp;<span class="ident" id="4442368">ScalarBaseMult</span><span class="op" id="4442382">(</span><span class="ident" id="4442383">k</span>&nbsp;<span class="op" id="4442385">[</span><span class="op" id="4442386">]</span><span class="builtintype" id="4442387">byte</span><span class="op" id="4442391">)</span>&nbsp;<span class="op" id="4442393">(</span><span class="op" id="4442394">*</span><span class="ident" id="4442395">big</span><span class="op" id="4442398">.</span><span class="ident" id="4442399">Int</span><span class="op" id="4442402">,</span>&nbsp;<span class="op" id="4442404">*</span><span class="ident" id="4442405">big</span><span class="op" id="4442408">.</span><span class="ident" id="4442409">Int</span><span class="op" id="4442412">)</span>&nbsp;<span class="op" id="4442414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442417">return</span>&nbsp;<span class="ident" id="4442424">curve</span><span class="op" id="4442429">.</span><span class="ident" id="4442430">ScalarMult</span><span class="op" id="4442440">(</span><span class="ident" id="4442441">curve</span><span class="op" id="4442446">.</span><span class="ident" id="4442447">Gx</span><span class="op" id="4442449">,</span>&nbsp;<span class="ident" id="4442451">curve</span><span class="op" id="4442456">.</span><span class="ident" id="4442457">Gy</span><span class="op" id="4442459">,</span>&nbsp;<span class="ident" id="4442461">k</span><span class="op" id="4442462">)</span><br>
<span class="lineno"></span><span class="op" id="4442464">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="4442467">var</span>&nbsp;<span class="ident" id="4442471">mask</span>&nbsp;<span class="op" id="4442476">=</span>&nbsp;<span class="op" id="4442478">[</span><span class="op" id="4442479">]</span><span class="builtintype" id="4442480">byte</span><span class="op" id="4442484">{</span><span class="num" id="4442485">0xff</span><span class="op" id="4442489">,</span>&nbsp;<span class="num" id="4442491">0x1</span><span class="op" id="4442494">,</span>&nbsp;<span class="num" id="4442496">0x3</span><span class="op" id="4442499">,</span>&nbsp;<span class="num" id="4442501">0x7</span><span class="op" id="4442504">,</span>&nbsp;<span class="num" id="4442506">0xf</span><span class="op" id="4442509">,</span>&nbsp;<span class="num" id="4442511">0x1f</span><span class="op" id="4442515">,</span>&nbsp;<span class="num" id="4442517">0x3f</span><span class="op" id="4442521">,</span>&nbsp;<span class="num" id="4442523">0x7f</span><span class="op" id="4442527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4442530">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4442599">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="4442667">func</span>&nbsp;<span class="ident" id="4442672">GenerateKey</span><span class="op" id="4442683">(</span><span class="ident" id="4442684">curve</span>&nbsp;<span class="ident" id="4442690">Curve</span><span class="op" id="4442695">,</span>&nbsp;<span class="ident" id="4442697">rand</span>&nbsp;<span class="ident" id="4442702">io</span><span class="op" id="4442704">.</span><span class="ident" id="4442705">Reader</span><span class="op" id="4442711">)</span>&nbsp;<span class="op" id="4442713">(</span><span class="ident" id="4442714">priv</span>&nbsp;<span class="op" id="4442719">[</span><span class="op" id="4442720">]</span><span class="builtintype" id="4442721">byte</span><span class="op" id="4442725">,</span>&nbsp;<span class="ident" id="4442727">x</span><span class="op" id="4442728">,</span>&nbsp;<span class="ident" id="4442730">y</span>&nbsp;<span class="op" id="4442732">*</span><span class="ident" id="4442733">big</span><span class="op" id="4442736">.</span><span class="ident" id="4442737">Int</span><span class="op" id="4442740">,</span>&nbsp;<span class="ident" id="4442742">err</span>&nbsp;<span class="builtintype" id="4442746">error</span><span class="op" id="4442751">)</span>&nbsp;<span class="op" id="4442753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442756">bitSize</span>&nbsp;<span class="op" id="4442764">:=</span>&nbsp;<span class="ident" id="4442767">curve</span><span class="op" id="4442772">.</span><span class="ident" id="4442773">Params</span><span class="op" id="4442779">(</span><span class="op" id="4442780">)</span><span class="op" id="4442781">.</span><span class="ident" id="4442782">BitSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442791">byteLen</span>&nbsp;<span class="op" id="4442799">:=</span>&nbsp;<span class="op" id="4442802">(</span><span class="ident" id="4442803">bitSize</span>&nbsp;<span class="op" id="4442811">+</span>&nbsp;<span class="num" id="4442813">7</span><span class="op" id="4442814">)</span>&nbsp;<span class="op" id="4442816">&gt;&gt;</span>&nbsp;<span class="num" id="4442819">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442822">priv</span>&nbsp;<span class="op" id="4442827">=</span>&nbsp;<span class="builtinfunc" id="4442829">make</span><span class="op" id="4442833">(</span><span class="op" id="4442834">[</span><span class="op" id="4442835">]</span><span class="builtintype" id="4442836">byte</span><span class="op" id="4442840">,</span>&nbsp;<span class="ident" id="4442842">byteLen</span><span class="op" id="4442849">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442853">for</span>&nbsp;<span class="ident" id="4442857">x</span>&nbsp;<span class="op" id="4442859">==</span>&nbsp;<span class="ident" id="4442862">nil</span>&nbsp;<span class="op" id="4442866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4442870">_</span><span class="op" id="4442871">,</span>&nbsp;<span class="ident" id="4442873">err</span>&nbsp;<span class="op" id="4442877">=</span>&nbsp;<span class="ident" id="4442879">io</span><span class="op" id="4442881">.</span><span class="ident" id="4442882">ReadFull</span><span class="op" id="4442890">(</span><span class="ident" id="4442891">rand</span><span class="op" id="4442895">,</span>&nbsp;<span class="ident" id="4442897">priv</span><span class="op" id="4442901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442905">if</span>&nbsp;<span class="ident" id="4442908">err</span>&nbsp;<span class="op" id="4442912">!=</span>&nbsp;<span class="ident" id="4442915">nil</span>&nbsp;<span class="op" id="4442919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4442924">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4442933">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4442937">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4443011">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443065">priv</span><span class="op" id="4443069">[</span><span class="num" id="4443070">0</span><span class="op" id="4443071">]</span>&nbsp;<span class="op" id="4443073">&amp;=</span>&nbsp;<span class="ident" id="4443076">mask</span><span class="op" id="4443080">[</span><span class="ident" id="4443081">bitSize</span><span class="op" id="4443088">%</span><span class="num" id="4443089">8</span><span class="op" id="4443090">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4443094">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4443166">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443223">priv</span><span class="op" id="4443227">[</span><span class="num" id="4443228">1</span><span class="op" id="4443229">]</span>&nbsp;<span class="op" id="4443231">^=</span>&nbsp;<span class="num" id="4443234">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443241">x</span><span class="op" id="4443242">,</span>&nbsp;<span class="ident" id="4443244">y</span>&nbsp;<span class="op" id="4443246">=</span>&nbsp;<span class="ident" id="4443248">curve</span><span class="op" id="4443253">.</span><span class="ident" id="4443254">ScalarBaseMult</span><span class="op" id="4443268">(</span><span class="ident" id="4443269">priv</span><span class="op" id="4443273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443279">return</span><br>
<span class="lineno"></span><span class="op" id="4443286">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="4443289">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="4443373">func</span>&nbsp;<span class="ident" id="4443378">Marshal</span><span class="op" id="4443385">(</span><span class="ident" id="4443386">curve</span>&nbsp;<span class="ident" id="4443392">Curve</span><span class="op" id="4443397">,</span>&nbsp;<span class="ident" id="4443399">x</span><span class="op" id="4443400">,</span>&nbsp;<span class="ident" id="4443402">y</span>&nbsp;<span class="op" id="4443404">*</span><span class="ident" id="4443405">big</span><span class="op" id="4443408">.</span><span class="ident" id="4443409">Int</span><span class="op" id="4443412">)</span>&nbsp;<span class="op" id="4443414">[</span><span class="op" id="4443415">]</span><span class="builtintype" id="4443416">byte</span>&nbsp;<span class="op" id="4443421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443424">byteLen</span>&nbsp;<span class="op" id="4443432">:=</span>&nbsp;<span class="op" id="4443435">(</span><span class="ident" id="4443436">curve</span><span class="op" id="4443441">.</span><span class="ident" id="4443442">Params</span><span class="op" id="4443448">(</span><span class="op" id="4443449">)</span><span class="op" id="4443450">.</span><span class="ident" id="4443451">BitSize</span>&nbsp;<span class="op" id="4443459">+</span>&nbsp;<span class="num" id="4443461">7</span><span class="op" id="4443462">)</span>&nbsp;<span class="op" id="4443464">&gt;&gt;</span>&nbsp;<span class="num" id="4443467">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443471">ret</span>&nbsp;<span class="op" id="4443475">:=</span>&nbsp;<span class="builtinfunc" id="4443478">make</span><span class="op" id="4443482">(</span><span class="op" id="4443483">[</span><span class="op" id="4443484">]</span><span class="builtintype" id="4443485">byte</span><span class="op" id="4443489">,</span>&nbsp;<span class="num" id="4443491">1</span><span class="op" id="4443492">+</span><span class="num" id="4443493">2</span><span class="op" id="4443494">*</span><span class="ident" id="4443495">byteLen</span><span class="op" id="4443502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443505">ret</span><span class="op" id="4443508">[</span><span class="num" id="4443509">0</span><span class="op" id="4443510">]</span>&nbsp;<span class="op" id="4443512">=</span>&nbsp;<span class="num" id="4443514">4</span>&nbsp;<span class="comment" id="4443516">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443540">xBytes</span>&nbsp;<span class="op" id="4443547">:=</span>&nbsp;<span class="ident" id="4443550">x</span><span class="op" id="4443551">.</span><span class="ident" id="4443552">Bytes</span><span class="op" id="4443557">(</span><span class="op" id="4443558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4443561">copy</span><span class="op" id="4443565">(</span><span class="ident" id="4443566">ret</span><span class="op" id="4443569">[</span><span class="num" id="4443570">1</span><span class="op" id="4443571">+</span><span class="ident" id="4443572">byteLen</span><span class="op" id="4443579">-</span><span class="builtinfunc" id="4443580">len</span><span class="op" id="4443583">(</span><span class="ident" id="4443584">xBytes</span><span class="op" id="4443590">)</span><span class="op" id="4443591">:</span><span class="op" id="4443592">]</span><span class="op" id="4443593">,</span>&nbsp;<span class="ident" id="4443595">xBytes</span><span class="op" id="4443601">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443604">yBytes</span>&nbsp;<span class="op" id="4443611">:=</span>&nbsp;<span class="ident" id="4443614">y</span><span class="op" id="4443615">.</span><span class="ident" id="4443616">Bytes</span><span class="op" id="4443621">(</span><span class="op" id="4443622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4443625">copy</span><span class="op" id="4443629">(</span><span class="ident" id="4443630">ret</span><span class="op" id="4443633">[</span><span class="num" id="4443634">1</span><span class="op" id="4443635">+</span><span class="num" id="4443636">2</span><span class="op" id="4443637">*</span><span class="ident" id="4443638">byteLen</span><span class="op" id="4443645">-</span><span class="builtinfunc" id="4443646">len</span><span class="op" id="4443649">(</span><span class="ident" id="4443650">yBytes</span><span class="op" id="4443656">)</span><span class="op" id="4443657">:</span><span class="op" id="4443658">]</span><span class="op" id="4443659">,</span>&nbsp;<span class="ident" id="4443661">yBytes</span><span class="op" id="4443667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443670">return</span>&nbsp;<span class="ident" id="4443677">ret</span><br>
<span class="lineno"></span><span class="op" id="4443681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4443684">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4443776">func</span>&nbsp;<span class="ident" id="4443781">Unmarshal</span><span class="op" id="4443790">(</span><span class="ident" id="4443791">curve</span>&nbsp;<span class="ident" id="4443797">Curve</span><span class="op" id="4443802">,</span>&nbsp;<span class="ident" id="4443804">data</span>&nbsp;<span class="op" id="4443809">[</span><span class="op" id="4443810">]</span><span class="builtintype" id="4443811">byte</span><span class="op" id="4443815">)</span>&nbsp;<span class="op" id="4443817">(</span><span class="ident" id="4443818">x</span><span class="op" id="4443819">,</span>&nbsp;<span class="ident" id="4443821">y</span>&nbsp;<span class="op" id="4443823">*</span><span class="ident" id="4443824">big</span><span class="op" id="4443827">.</span><span class="ident" id="4443828">Int</span><span class="op" id="4443831">)</span>&nbsp;<span class="op" id="4443833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443836">byteLen</span>&nbsp;<span class="op" id="4443844">:=</span>&nbsp;<span class="op" id="4443847">(</span><span class="ident" id="4443848">curve</span><span class="op" id="4443853">.</span><span class="ident" id="4443854">Params</span><span class="op" id="4443860">(</span><span class="op" id="4443861">)</span><span class="op" id="4443862">.</span><span class="ident" id="4443863">BitSize</span>&nbsp;<span class="op" id="4443871">+</span>&nbsp;<span class="num" id="4443873">7</span><span class="op" id="4443874">)</span>&nbsp;<span class="op" id="4443876">&gt;&gt;</span>&nbsp;<span class="num" id="4443879">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443882">if</span>&nbsp;<span class="builtinfunc" id="4443885">len</span><span class="op" id="4443888">(</span><span class="ident" id="4443889">data</span><span class="op" id="4443893">)</span>&nbsp;<span class="op" id="4443895">!=</span>&nbsp;<span class="num" id="4443898">1</span><span class="op" id="4443899">+</span><span class="num" id="4443900">2</span><span class="op" id="4443901">*</span><span class="ident" id="4443902">byteLen</span>&nbsp;<span class="op" id="4443910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443914">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443925">if</span>&nbsp;<span class="ident" id="4443928">data</span><span class="op" id="4443932">[</span><span class="num" id="4443933">0</span><span class="op" id="4443934">]</span>&nbsp;<span class="op" id="4443936">!=</span>&nbsp;<span class="num" id="4443939">4</span>&nbsp;<span class="op" id="4443941">{</span>&nbsp;<span class="comment" id="4443943">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4443966">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4443974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4443977">x</span>&nbsp;<span class="op" id="4443979">=</span>&nbsp;<span class="builtinfunc" id="4443981">new</span><span class="op" id="4443984">(</span><span class="ident" id="4443985">big</span><span class="op" id="4443988">.</span><span class="ident" id="4443989">Int</span><span class="op" id="4443992">)</span><span class="op" id="4443993">.</span><span class="ident" id="4443994">SetBytes</span><span class="op" id="4444002">(</span><span class="ident" id="4444003">data</span><span class="op" id="4444007">[</span><span class="num" id="4444008">1</span>&nbsp;<span class="op" id="4444010">:</span>&nbsp;<span class="num" id="4444012">1</span><span class="op" id="4444013">+</span><span class="ident" id="4444014">byteLen</span><span class="op" id="4444021">]</span><span class="op" id="4444022">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444025">y</span>&nbsp;<span class="op" id="4444027">=</span>&nbsp;<span class="builtinfunc" id="4444029">new</span><span class="op" id="4444032">(</span><span class="ident" id="4444033">big</span><span class="op" id="4444036">.</span><span class="ident" id="4444037">Int</span><span class="op" id="4444040">)</span><span class="op" id="4444041">.</span><span class="ident" id="4444042">SetBytes</span><span class="op" id="4444050">(</span><span class="ident" id="4444051">data</span><span class="op" id="4444055">[</span><span class="num" id="4444056">1</span><span class="op" id="4444057">+</span><span class="ident" id="4444058">byteLen</span><span class="op" id="4444065">:</span><span class="op" id="4444066">]</span><span class="op" id="4444067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4444070">return</span><br>
<span class="lineno"></span><span class="op" id="4444077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4444080">var</span>&nbsp;<span class="ident" id="4444084">initonce</span>&nbsp;<span class="ident" id="4444093">sync</span><span class="op" id="4444097">.</span><span class="ident" id="4444098">Once</span><br>
<span class="lineno">325</span><span class="keyword" id="4444103">var</span>&nbsp;<span class="ident" id="4444107">p384</span>&nbsp;<span class="op" id="4444112">*</span><span class="ident" id="4444113">CurveParams</span><br>
<span class="lineno"></span><span class="keyword" id="4444125">var</span>&nbsp;<span class="ident" id="4444129">p521</span>&nbsp;<span class="op" id="4444134">*</span><span class="ident" id="4444135">CurveParams</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4444148">func</span>&nbsp;<span class="ident" id="4444153">initAll</span><span class="op" id="4444160">(</span><span class="op" id="4444161">)</span>&nbsp;<span class="op" id="4444163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444166">initP224</span><span class="op" id="4444174">(</span><span class="op" id="4444175">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444178">initP256</span><span class="op" id="4444186">(</span><span class="op" id="4444187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444190">initP384</span><span class="op" id="4444198">(</span><span class="op" id="4444199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444202">initP521</span><span class="op" id="4444210">(</span><span class="op" id="4444211">)</span><br>
<span class="lineno"></span><span class="op" id="4444213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="4444216">func</span>&nbsp;<span class="ident" id="4444221">initP384</span><span class="op" id="4444229">(</span><span class="op" id="4444230">)</span>&nbsp;<span class="op" id="4444232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4444235">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444269">p384</span>&nbsp;<span class="op" id="4444274">=</span>&nbsp;<span class="builtinfunc" id="4444276">new</span><span class="op" id="4444279">(</span><span class="ident" id="4444280">CurveParams</span><span class="op" id="4444291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444294">p384</span><span class="op" id="4444298">.</span><span class="ident" id="4444299">P</span><span class="op" id="4444300">,</span>&nbsp;<span class="ident" id="4444302">_</span>&nbsp;<span class="op" id="4444304">=</span>&nbsp;<span class="builtinfunc" id="4444306">new</span><span class="op" id="4444309">(</span><span class="ident" id="4444310">big</span><span class="op" id="4444313">.</span><span class="ident" id="4444314">Int</span><span class="op" id="4444317">)</span><span class="op" id="4444318">.</span><span class="ident" id="4444319">SetString</span><span class="op" id="4444328">(</span><span class="string" id="4444329">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="4444447">,</span>&nbsp;<span class="num" id="4444449">10</span><span class="op" id="4444451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444454">p384</span><span class="op" id="4444458">.</span><span class="ident" id="4444459">N</span><span class="op" id="4444460">,</span>&nbsp;<span class="ident" id="4444462">_</span>&nbsp;<span class="op" id="4444464">=</span>&nbsp;<span class="builtinfunc" id="4444466">new</span><span class="op" id="4444469">(</span><span class="ident" id="4444470">big</span><span class="op" id="4444473">.</span><span class="ident" id="4444474">Int</span><span class="op" id="4444477">)</span><span class="op" id="4444478">.</span><span class="ident" id="4444479">SetString</span><span class="op" id="4444488">(</span><span class="string" id="4444489">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="4444607">,</span>&nbsp;<span class="num" id="4444609">10</span><span class="op" id="4444611">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444614">p384</span><span class="op" id="4444618">.</span><span class="ident" id="4444619">B</span><span class="op" id="4444620">,</span>&nbsp;<span class="ident" id="4444622">_</span>&nbsp;<span class="op" id="4444624">=</span>&nbsp;<span class="builtinfunc" id="4444626">new</span><span class="op" id="4444629">(</span><span class="ident" id="4444630">big</span><span class="op" id="4444633">.</span><span class="ident" id="4444634">Int</span><span class="op" id="4444637">)</span><span class="op" id="4444638">.</span><span class="ident" id="4444639">SetString</span><span class="op" id="4444648">(</span><span class="string" id="4444649">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="4444747">,</span>&nbsp;<span class="num" id="4444749">16</span><span class="op" id="4444751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444754">p384</span><span class="op" id="4444758">.</span><span class="ident" id="4444759">Gx</span><span class="op" id="4444761">,</span>&nbsp;<span class="ident" id="4444763">_</span>&nbsp;<span class="op" id="4444765">=</span>&nbsp;<span class="builtinfunc" id="4444767">new</span><span class="op" id="4444770">(</span><span class="ident" id="4444771">big</span><span class="op" id="4444774">.</span><span class="ident" id="4444775">Int</span><span class="op" id="4444778">)</span><span class="op" id="4444779">.</span><span class="ident" id="4444780">SetString</span><span class="op" id="4444789">(</span><span class="string" id="4444790">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="4444888">,</span>&nbsp;<span class="num" id="4444890">16</span><span class="op" id="4444892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4444895">p384</span><span class="op" id="4444899">.</span><span class="ident" id="4444900">Gy</span><span class="op" id="4444902">,</span>&nbsp;<span class="ident" id="4444904">_</span>&nbsp;<span class="op" id="4444906">=</span>&nbsp;<span class="builtinfunc" id="4444908">new</span><span class="op" id="4444911">(</span><span class="ident" id="4444912">big</span><span class="op" id="4444915">.</span><span class="ident" id="4444916">Int</span><span class="op" id="4444919">)</span><span class="op" id="4444920">.</span><span class="ident" id="4444921">SetString</span><span class="op" id="4444930">(</span><span class="string" id="4444931">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="4445029">,</span>&nbsp;<span class="num" id="4445031">16</span><span class="op" id="4445033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445036">p384</span><span class="op" id="4445040">.</span><span class="ident" id="4445041">BitSize</span>&nbsp;<span class="op" id="4445049">=</span>&nbsp;<span class="num" id="4445051">384</span><br>
<span class="lineno"></span><span class="op" id="4445055">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="4445058">func</span>&nbsp;<span class="ident" id="4445063">initP521</span><span class="op" id="4445071">(</span><span class="op" id="4445072">)</span>&nbsp;<span class="op" id="4445074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4445077">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445111">p521</span>&nbsp;<span class="op" id="4445116">=</span>&nbsp;<span class="builtinfunc" id="4445118">new</span><span class="op" id="4445121">(</span><span class="ident" id="4445122">CurveParams</span><span class="op" id="4445133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445136">p521</span><span class="op" id="4445140">.</span><span class="ident" id="4445141">P</span><span class="op" id="4445142">,</span>&nbsp;<span class="ident" id="4445144">_</span>&nbsp;<span class="op" id="4445146">=</span>&nbsp;<span class="builtinfunc" id="4445148">new</span><span class="op" id="4445151">(</span><span class="ident" id="4445152">big</span><span class="op" id="4445155">.</span><span class="ident" id="4445156">Int</span><span class="op" id="4445159">)</span><span class="op" id="4445160">.</span><span class="ident" id="4445161">SetString</span><span class="op" id="4445170">(</span><span class="string" id="4445171">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="4445330">,</span>&nbsp;<span class="num" id="4445332">10</span><span class="op" id="4445334">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445337">p521</span><span class="op" id="4445341">.</span><span class="ident" id="4445342">N</span><span class="op" id="4445343">,</span>&nbsp;<span class="ident" id="4445345">_</span>&nbsp;<span class="op" id="4445347">=</span>&nbsp;<span class="builtinfunc" id="4445349">new</span><span class="op" id="4445352">(</span><span class="ident" id="4445353">big</span><span class="op" id="4445356">.</span><span class="ident" id="4445357">Int</span><span class="op" id="4445360">)</span><span class="op" id="4445361">.</span><span class="ident" id="4445362">SetString</span><span class="op" id="4445371">(</span><span class="string" id="4445372">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="4445531">,</span>&nbsp;<span class="num" id="4445533">10</span><span class="op" id="4445535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445538">p521</span><span class="op" id="4445542">.</span><span class="ident" id="4445543">B</span><span class="op" id="4445544">,</span>&nbsp;<span class="ident" id="4445546">_</span>&nbsp;<span class="op" id="4445548">=</span>&nbsp;<span class="builtinfunc" id="4445550">new</span><span class="op" id="4445553">(</span><span class="ident" id="4445554">big</span><span class="op" id="4445557">.</span><span class="ident" id="4445558">Int</span><span class="op" id="4445561">)</span><span class="op" id="4445562">.</span><span class="ident" id="4445563">SetString</span><span class="op" id="4445572">(</span><span class="string" id="4445573">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="4445706">,</span>&nbsp;<span class="num" id="4445708">16</span><span class="op" id="4445710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445713">p521</span><span class="op" id="4445717">.</span><span class="ident" id="4445718">Gx</span><span class="op" id="4445720">,</span>&nbsp;<span class="ident" id="4445722">_</span>&nbsp;<span class="op" id="4445724">=</span>&nbsp;<span class="builtinfunc" id="4445726">new</span><span class="op" id="4445729">(</span><span class="ident" id="4445730">big</span><span class="op" id="4445733">.</span><span class="ident" id="4445734">Int</span><span class="op" id="4445737">)</span><span class="op" id="4445738">.</span><span class="ident" id="4445739">SetString</span><span class="op" id="4445748">(</span><span class="string" id="4445749">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="4445881">,</span>&nbsp;<span class="num" id="4445883">16</span><span class="op" id="4445885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4445888">p521</span><span class="op" id="4445892">.</span><span class="ident" id="4445893">Gy</span><span class="op" id="4445895">,</span>&nbsp;<span class="ident" id="4445897">_</span>&nbsp;<span class="op" id="4445899">=</span>&nbsp;<span class="builtinfunc" id="4445901">new</span><span class="op" id="4445904">(</span><span class="ident" id="4445905">big</span><span class="op" id="4445908">.</span><span class="ident" id="4445909">Int</span><span class="op" id="4445912">)</span><span class="op" id="4445913">.</span><span class="ident" id="4445914">SetString</span><span class="op" id="4445923">(</span><span class="string" id="4445924">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="4446057">,</span>&nbsp;<span class="num" id="4446059">16</span><span class="op" id="4446061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446064">p521</span><span class="op" id="4446068">.</span><span class="ident" id="4446069">BitSize</span>&nbsp;<span class="op" id="4446077">=</span>&nbsp;<span class="num" id="4446079">521</span><br>
<span class="lineno">355</span><span class="op" id="4446083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4446086">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="4446165">func</span>&nbsp;<span class="ident" id="4446170">P256</span><span class="op" id="4446174">(</span><span class="op" id="4446175">)</span>&nbsp;<span class="ident" id="4446177">Curve</span>&nbsp;<span class="op" id="4446183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446186">initonce</span><span class="op" id="4446194">.</span><span class="ident" id="4446195">Do</span><span class="op" id="4446197">(</span><span class="ident" id="4446198">initAll</span><span class="op" id="4446205">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446208">return</span>&nbsp;<span class="ident" id="4446215">p256</span><br>
<span class="lineno"></span><span class="op" id="4446220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4446223">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="4446302">func</span>&nbsp;<span class="ident" id="4446307">P384</span><span class="op" id="4446311">(</span><span class="op" id="4446312">)</span>&nbsp;<span class="ident" id="4446314">Curve</span>&nbsp;<span class="op" id="4446320">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446323">initonce</span><span class="op" id="4446331">.</span><span class="ident" id="4446332">Do</span><span class="op" id="4446334">(</span><span class="ident" id="4446335">initAll</span><span class="op" id="4446342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446345">return</span>&nbsp;<span class="ident" id="4446352">p384</span><br>
<span class="lineno"></span><span class="op" id="4446357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4446360">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="4446439">func</span>&nbsp;<span class="ident" id="4446444">P521</span><span class="op" id="4446448">(</span><span class="op" id="4446449">)</span>&nbsp;<span class="ident" id="4446451">Curve</span>&nbsp;<span class="op" id="4446457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4446460">initonce</span><span class="op" id="4446468">.</span><span class="ident" id="4446469">Do</span><span class="op" id="4446471">(</span><span class="ident" id="4446472">initAll</span><span class="op" id="4446479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4446482">return</span>&nbsp;<span class="ident" id="4446489">p521</span><br>
<span class="lineno"></span><span class="op" id="4446494">}</span>
</div>
</body>
</html>
