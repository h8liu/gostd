<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html" class="current">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2745257">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2745312">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2745366">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2745417">package</span>&nbsp;<span class="ident" id="2745425">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2745431">import</span>&nbsp;<span class="op" id="2745438">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2745441">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2745449">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2745459">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2745462">//&nbsp;A&nbsp;Location&nbsp;maps&nbsp;time&nbsp;instants&nbsp;to&nbsp;the&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2745528">//&nbsp;Typically,&nbsp;the&nbsp;Location&nbsp;represents&nbsp;the&nbsp;collection&nbsp;of&nbsp;time&nbsp;offsets</span><br>
<span class="lineno"></span><span class="comment" id="2745597">//&nbsp;in&nbsp;use&nbsp;in&nbsp;a&nbsp;geographical&nbsp;area,&nbsp;such&nbsp;as&nbsp;CEST&nbsp;and&nbsp;CET&nbsp;for&nbsp;central&nbsp;Europe.</span><br>
<span class="lineno">15</span><span class="keyword" id="2745672">type</span>&nbsp;<span class="ident" id="2745677">Location</span>&nbsp;<span class="keyword" id="2745686">struct</span>&nbsp;<span class="op" id="2745693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2745696">name</span>&nbsp;<span class="builtintype" id="2745701">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2745709">zone</span>&nbsp;<span class="op" id="2745714">[</span><span class="op" id="2745715">]</span><span class="ident" id="2745716">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2745722">tx</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2745727">[</span><span class="op" id="2745728">]</span><span class="ident" id="2745729">zoneTrans</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2745741">//&nbsp;Most&nbsp;lookups&nbsp;will&nbsp;be&nbsp;for&nbsp;the&nbsp;current&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2745788">//&nbsp;To&nbsp;avoid&nbsp;the&nbsp;binary&nbsp;search&nbsp;through&nbsp;tx,&nbsp;keep&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2745838">//&nbsp;static&nbsp;one-element&nbsp;cache&nbsp;that&nbsp;gives&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2745890">//&nbsp;zone&nbsp;for&nbsp;the&nbsp;time&nbsp;when&nbsp;the&nbsp;Location&nbsp;was&nbsp;created.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2745943">//&nbsp;if&nbsp;cacheStart&nbsp;&lt;=&nbsp;t&nbsp;&lt;=&nbsp;cacheEnd,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2745979">//&nbsp;lookup&nbsp;can&nbsp;return&nbsp;cacheZone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2746012">//&nbsp;The&nbsp;units&nbsp;for&nbsp;cacheStart&nbsp;and&nbsp;cacheEnd&nbsp;are&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2746066">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC,&nbsp;to&nbsp;match&nbsp;the&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2746119">//&nbsp;to&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2746134">cacheStart</span>&nbsp;<span class="ident" id="2746145">int64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2746152">cacheEnd</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2746163">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2746170">cacheZone</span>&nbsp;&nbsp;<span class="op" id="2746181">*</span><span class="ident" id="2746182">zone</span><br>
<span class="lineno"></span><span class="op" id="2746187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2746190">//&nbsp;A&nbsp;zone&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;such&nbsp;as&nbsp;CEST&nbsp;or&nbsp;CET.</span><br>
<span class="lineno">35</span><span class="keyword" id="2746251">type</span>&nbsp;<span class="ident" id="2746256">zone</span>&nbsp;<span class="keyword" id="2746261">struct</span>&nbsp;<span class="op" id="2746268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2746271">name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2746278">string</span>&nbsp;<span class="comment" id="2746285">//&nbsp;abbreviated&nbsp;name,&nbsp;&#34;CET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2746313">offset</span>&nbsp;<span class="builtintype" id="2746320">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2746327">//&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2746351">isDST</span>&nbsp;&nbsp;<span class="builtintype" id="2746358">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2746365">//&nbsp;is&nbsp;this&nbsp;zone&nbsp;Daylight&nbsp;Savings&nbsp;Time?</span><br>
<span class="lineno"></span><span class="op" id="2746404">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="2746407">//&nbsp;A&nbsp;zoneTrans&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2746464">type</span>&nbsp;<span class="ident" id="2746469">zoneTrans</span>&nbsp;<span class="keyword" id="2746479">struct</span>&nbsp;<span class="op" id="2746486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2746489">when</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2746502">int64</span>&nbsp;<span class="comment" id="2746508">//&nbsp;transition&nbsp;time,&nbsp;in&nbsp;seconds&nbsp;since&nbsp;1970&nbsp;GMT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2746555">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2746568">uint8</span>&nbsp;<span class="comment" id="2746574">//&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;zone&nbsp;that&nbsp;goes&nbsp;into&nbsp;effect&nbsp;at&nbsp;that&nbsp;time</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2746635">isstd</span><span class="op" id="2746640">,</span>&nbsp;<span class="ident" id="2746642">isutc</span>&nbsp;<span class="builtintype" id="2746648">bool</span>&nbsp;&nbsp;<span class="comment" id="2746654">//&nbsp;ignored&nbsp;-&nbsp;no&nbsp;idea&nbsp;what&nbsp;these&nbsp;mean</span><br>
<span class="lineno"></span><span class="op" id="2746691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2746694">//&nbsp;alpha&nbsp;and&nbsp;omega&nbsp;are&nbsp;the&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;time&nbsp;for&nbsp;zone</span><br>
<span class="lineno"></span><span class="comment" id="2746756">//&nbsp;transitions.</span><br>
<span class="lineno">50</span><span class="keyword" id="2746772">const</span>&nbsp;<span class="op" id="2746778">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2746781">alpha</span>&nbsp;<span class="op" id="2746787">=</span>&nbsp;<span class="op" id="2746789">-</span><span class="num" id="2746790">1</span>&nbsp;<span class="op" id="2746792">&lt;&lt;</span>&nbsp;<span class="num" id="2746795">63</span>&nbsp;&nbsp;<span class="comment" id="2746799">//&nbsp;math.MinInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2746817">omega</span>&nbsp;<span class="op" id="2746823">=</span>&nbsp;<span class="num" id="2746825">1</span><span class="op" id="2746826">&lt;&lt;</span><span class="num" id="2746828">63</span>&nbsp;<span class="op" id="2746831">-</span>&nbsp;<span class="num" id="2746833">1</span>&nbsp;<span class="comment" id="2746835">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span><span class="op" id="2746852">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="2746855">//&nbsp;UTC&nbsp;represents&nbsp;Universal&nbsp;Coordinated&nbsp;Time&nbsp;(UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2746907">var</span>&nbsp;<span class="ident" id="2746911">UTC</span>&nbsp;<span class="op" id="2746915">*</span><span class="ident" id="2746916">Location</span>&nbsp;<span class="op" id="2746925">=</span>&nbsp;<span class="op" id="2746927">&amp;</span><span class="ident" id="2746928">utcLoc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2746936">//&nbsp;utcLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;get&nbsp;can&nbsp;refer&nbsp;to&nbsp;&amp;utcLoc</span><br>
<span class="lineno"></span><span class="comment" id="2746991">//&nbsp;and&nbsp;ensure&nbsp;that&nbsp;it&nbsp;never&nbsp;returns&nbsp;a&nbsp;nil&nbsp;*Location,</span><br>
<span class="lineno">60</span><span class="comment" id="2747044">//&nbsp;even&nbsp;if&nbsp;a&nbsp;badly&nbsp;behaved&nbsp;client&nbsp;has&nbsp;changed&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2747095">var</span>&nbsp;<span class="ident" id="2747099">utcLoc</span>&nbsp;<span class="op" id="2747106">=</span>&nbsp;<span class="ident" id="2747108">Location</span><span class="op" id="2747116">{</span><span class="ident" id="2747117">name</span><span class="op" id="2747121">:</span>&nbsp;<span class="string" id="2747123">&#34;UTC&#34;</span><span class="op" id="2747128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2747131">//&nbsp;Local&nbsp;represents&nbsp;the&nbsp;system&#39;s&nbsp;local&nbsp;time&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2747181">var</span>&nbsp;<span class="ident" id="2747185">Local</span>&nbsp;<span class="op" id="2747191">*</span><span class="ident" id="2747192">Location</span>&nbsp;<span class="op" id="2747201">=</span>&nbsp;<span class="op" id="2747203">&amp;</span><span class="ident" id="2747204">localLoc</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="2747214">//&nbsp;localLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;initLocal&nbsp;can&nbsp;initialize</span><br>
<span class="lineno"></span><span class="comment" id="2747271">//&nbsp;it&nbsp;even&nbsp;if&nbsp;a&nbsp;client&nbsp;has&nbsp;changed&nbsp;Local.</span><br>
<span class="lineno"></span><span class="keyword" id="2747313">var</span>&nbsp;<span class="ident" id="2747317">localLoc</span>&nbsp;<span class="ident" id="2747326">Location</span><br>
<span class="lineno"></span><span class="keyword" id="2747335">var</span>&nbsp;<span class="ident" id="2747339">localOnce</span>&nbsp;<span class="ident" id="2747349">sync</span><span class="op" id="2747353">.</span><span class="ident" id="2747354">Once</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2747360">func</span>&nbsp;<span class="op" id="2747365">(</span><span class="ident" id="2747366">l</span>&nbsp;<span class="op" id="2747368">*</span><span class="ident" id="2747369">Location</span><span class="op" id="2747377">)</span>&nbsp;<span class="ident" id="2747379">get</span><span class="op" id="2747382">(</span><span class="op" id="2747383">)</span>&nbsp;<span class="op" id="2747385">*</span><span class="ident" id="2747386">Location</span>&nbsp;<span class="op" id="2747395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2747398">if</span>&nbsp;<span class="ident" id="2747401">l</span>&nbsp;<span class="op" id="2747403">==</span>&nbsp;<span class="builtintype" id="2747406">nil</span>&nbsp;<span class="op" id="2747410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2747414">return</span>&nbsp;<span class="op" id="2747421">&amp;</span><span class="ident" id="2747422">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2747430">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2747433">if</span>&nbsp;<span class="ident" id="2747436">l</span>&nbsp;<span class="op" id="2747438">==</span>&nbsp;<span class="op" id="2747441">&amp;</span><span class="ident" id="2747442">localLoc</span>&nbsp;<span class="op" id="2747451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2747455">localOnce</span><span class="op" id="2747464">.</span><span class="ident" id="2747465">Do</span><span class="op" id="2747467">(</span><span class="ident" id="2747468">initLocal</span><span class="op" id="2747477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2747480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2747483">return</span>&nbsp;<span class="ident" id="2747490">l</span><br>
<span class="lineno"></span><span class="op" id="2747492">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2747495">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;descriptive&nbsp;name&nbsp;for&nbsp;the&nbsp;time&nbsp;zone&nbsp;information,</span><br>
<span class="lineno"></span><span class="comment" id="2747563">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;argument&nbsp;to&nbsp;LoadLocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2747613">func</span>&nbsp;<span class="op" id="2747618">(</span><span class="ident" id="2747619">l</span>&nbsp;<span class="op" id="2747621">*</span><span class="ident" id="2747622">Location</span><span class="op" id="2747630">)</span>&nbsp;<span class="ident" id="2747632">String</span><span class="op" id="2747638">(</span><span class="op" id="2747639">)</span>&nbsp;<span class="builtintype" id="2747641">string</span>&nbsp;<span class="op" id="2747648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2747651">return</span>&nbsp;<span class="ident" id="2747658">l</span><span class="op" id="2747659">.</span><span class="ident" id="2747660">get</span><span class="op" id="2747663">(</span><span class="op" id="2747664">)</span><span class="op" id="2747665">.</span><span class="ident" id="2747666">name</span><br>
<span class="lineno">85</span><span class="op" id="2747671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2747674">//&nbsp;FixedZone&nbsp;returns&nbsp;a&nbsp;Location&nbsp;that&nbsp;always&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="2747723">//&nbsp;the&nbsp;given&nbsp;zone&nbsp;name&nbsp;and&nbsp;offset&nbsp;(seconds&nbsp;east&nbsp;of&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2747780">func</span>&nbsp;<span class="ident" id="2747785">FixedZone</span><span class="op" id="2747794">(</span><span class="ident" id="2747795">name</span>&nbsp;<span class="builtintype" id="2747800">string</span><span class="op" id="2747806">,</span>&nbsp;<span class="ident" id="2747808">offset</span>&nbsp;<span class="builtintype" id="2747815">int</span><span class="op" id="2747818">)</span>&nbsp;<span class="op" id="2747820">*</span><span class="ident" id="2747821">Location</span>&nbsp;<span class="op" id="2747830">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2747833">l</span>&nbsp;<span class="op" id="2747835">:=</span>&nbsp;<span class="op" id="2747838">&amp;</span><span class="ident" id="2747839">Location</span><span class="op" id="2747847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2747851">name</span><span class="op" id="2747855">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2747863">name</span><span class="op" id="2747867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2747871">zone</span><span class="op" id="2747875">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2747883">[</span><span class="op" id="2747884">]</span><span class="ident" id="2747885">zone</span><span class="op" id="2747889">{</span><span class="op" id="2747890">{</span><span class="ident" id="2747891">name</span><span class="op" id="2747895">,</span>&nbsp;<span class="ident" id="2747897">offset</span><span class="op" id="2747903">,</span>&nbsp;<span class="builtintype" id="2747905">false</span><span class="op" id="2747910">}</span><span class="op" id="2747911">}</span><span class="op" id="2747912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2747916">tx</span><span class="op" id="2747918">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2747928">[</span><span class="op" id="2747929">]</span><span class="ident" id="2747930">zoneTrans</span><span class="op" id="2747939">{</span><span class="op" id="2747940">{</span><span class="ident" id="2747941">alpha</span><span class="op" id="2747946">,</span>&nbsp;<span class="num" id="2747948">0</span><span class="op" id="2747949">,</span>&nbsp;<span class="builtintype" id="2747951">false</span><span class="op" id="2747956">,</span>&nbsp;<span class="builtintype" id="2747958">false</span><span class="op" id="2747963">}</span><span class="op" id="2747964">}</span><span class="op" id="2747965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2747969">cacheStart</span><span class="op" id="2747979">:</span>&nbsp;<span class="ident" id="2747981">alpha</span><span class="op" id="2747986">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2747990">cacheEnd</span><span class="op" id="2747998">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2748002">omega</span><span class="op" id="2748007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2748010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748013">l</span><span class="op" id="2748014">.</span><span class="ident" id="2748015">cacheZone</span>&nbsp;<span class="op" id="2748025">=</span>&nbsp;<span class="op" id="2748027">&amp;</span><span class="ident" id="2748028">l</span><span class="op" id="2748029">.</span><span class="ident" id="2748030">zone</span><span class="op" id="2748034">[</span><span class="num" id="2748035">0</span><span class="op" id="2748036">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2748039">return</span>&nbsp;<span class="ident" id="2748046">l</span><br>
<span class="lineno"></span><span class="op" id="2748048">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2748051">//&nbsp;lookup&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2748114">//&nbsp;instant&nbsp;in&nbsp;time&nbsp;expressed&nbsp;as&nbsp;seconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2748190">//</span><br>
<span class="lineno"></span><span class="comment" id="2748193">//&nbsp;The&nbsp;returned&nbsp;information&nbsp;gives&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;),</span><br>
<span class="lineno">105</span><span class="comment" id="2748265">//&nbsp;the&nbsp;start&nbsp;and&nbsp;end&nbsp;times&nbsp;bracketing&nbsp;sec&nbsp;when&nbsp;that&nbsp;zone&nbsp;is&nbsp;in&nbsp;effect,</span><br>
<span class="lineno"></span><span class="comment" id="2748336">//&nbsp;the&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC&nbsp;(such&nbsp;as&nbsp;-5*60*60),&nbsp;and&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="2748405">//&nbsp;the&nbsp;daylight&nbsp;savings&nbsp;is&nbsp;being&nbsp;observed&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2748461">func</span>&nbsp;<span class="op" id="2748466">(</span><span class="ident" id="2748467">l</span>&nbsp;<span class="op" id="2748469">*</span><span class="ident" id="2748470">Location</span><span class="op" id="2748478">)</span>&nbsp;<span class="ident" id="2748480">lookup</span><span class="op" id="2748486">(</span><span class="ident" id="2748487">sec</span>&nbsp;<span class="ident" id="2748491">int64</span><span class="op" id="2748496">)</span>&nbsp;<span class="op" id="2748498">(</span><span class="ident" id="2748499">name</span>&nbsp;<span class="builtintype" id="2748504">string</span><span class="op" id="2748510">,</span>&nbsp;<span class="ident" id="2748512">offset</span>&nbsp;<span class="builtintype" id="2748519">int</span><span class="op" id="2748522">,</span>&nbsp;<span class="ident" id="2748524">isDST</span>&nbsp;<span class="builtintype" id="2748530">bool</span><span class="op" id="2748534">,</span>&nbsp;<span class="ident" id="2748536">start</span><span class="op" id="2748541">,</span>&nbsp;<span class="ident" id="2748543">end</span>&nbsp;<span class="ident" id="2748547">int64</span><span class="op" id="2748552">)</span>&nbsp;<span class="op" id="2748554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748557">l</span>&nbsp;<span class="op" id="2748559">=</span>&nbsp;<span class="ident" id="2748561">l</span><span class="op" id="2748562">.</span><span class="ident" id="2748563">get</span><span class="op" id="2748566">(</span><span class="op" id="2748567">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2748571">if</span>&nbsp;<span class="builtinfunc" id="2748574">len</span><span class="op" id="2748577">(</span><span class="ident" id="2748578">l</span><span class="op" id="2748579">.</span><span class="ident" id="2748580">zone</span><span class="op" id="2748584">)</span>&nbsp;<span class="op" id="2748586">==</span>&nbsp;<span class="num" id="2748589">0</span>&nbsp;<span class="op" id="2748591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748595">name</span>&nbsp;<span class="op" id="2748600">=</span>&nbsp;<span class="string" id="2748602">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748610">offset</span>&nbsp;<span class="op" id="2748617">=</span>&nbsp;<span class="num" id="2748619">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748623">isDST</span>&nbsp;<span class="op" id="2748629">=</span>&nbsp;<span class="builtintype" id="2748631">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748639">start</span>&nbsp;<span class="op" id="2748645">=</span>&nbsp;<span class="ident" id="2748647">alpha</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748655">end</span>&nbsp;<span class="op" id="2748659">=</span>&nbsp;<span class="ident" id="2748661">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2748669">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2748677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2748681">if</span>&nbsp;<span class="ident" id="2748684">zone</span>&nbsp;<span class="op" id="2748689">:=</span>&nbsp;<span class="ident" id="2748692">l</span><span class="op" id="2748693">.</span><span class="ident" id="2748694">cacheZone</span><span class="op" id="2748703">;</span>&nbsp;<span class="ident" id="2748705">zone</span>&nbsp;<span class="op" id="2748710">!=</span>&nbsp;<span class="builtintype" id="2748713">nil</span>&nbsp;<span class="op" id="2748717">&amp;&amp;</span>&nbsp;<span class="ident" id="2748720">l</span><span class="op" id="2748721">.</span><span class="ident" id="2748722">cacheStart</span>&nbsp;<span class="op" id="2748733">&lt;=</span>&nbsp;<span class="ident" id="2748736">sec</span>&nbsp;<span class="op" id="2748740">&amp;&amp;</span>&nbsp;<span class="ident" id="2748743">sec</span>&nbsp;<span class="op" id="2748747">&lt;</span>&nbsp;<span class="ident" id="2748749">l</span><span class="op" id="2748750">.</span><span class="ident" id="2748751">cacheEnd</span>&nbsp;<span class="op" id="2748760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748764">name</span>&nbsp;<span class="op" id="2748769">=</span>&nbsp;<span class="ident" id="2748771">zone</span><span class="op" id="2748775">.</span><span class="ident" id="2748776">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748783">offset</span>&nbsp;<span class="op" id="2748790">=</span>&nbsp;<span class="ident" id="2748792">zone</span><span class="op" id="2748796">.</span><span class="ident" id="2748797">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748806">isDST</span>&nbsp;<span class="op" id="2748812">=</span>&nbsp;<span class="ident" id="2748814">zone</span><span class="op" id="2748818">.</span><span class="ident" id="2748819">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748827">start</span>&nbsp;<span class="op" id="2748833">=</span>&nbsp;<span class="ident" id="2748835">l</span><span class="op" id="2748836">.</span><span class="ident" id="2748837">cacheStart</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748850">end</span>&nbsp;<span class="op" id="2748854">=</span>&nbsp;<span class="ident" id="2748856">l</span><span class="op" id="2748857">.</span><span class="ident" id="2748858">cacheEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2748869">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2748877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2748881">if</span>&nbsp;<span class="builtinfunc" id="2748884">len</span><span class="op" id="2748887">(</span><span class="ident" id="2748888">l</span><span class="op" id="2748889">.</span><span class="ident" id="2748890">tx</span><span class="op" id="2748892">)</span>&nbsp;<span class="op" id="2748894">==</span>&nbsp;<span class="num" id="2748897">0</span>&nbsp;<span class="op" id="2748899">||</span>&nbsp;<span class="ident" id="2748902">sec</span>&nbsp;<span class="op" id="2748906">&lt;</span>&nbsp;<span class="ident" id="2748908">l</span><span class="op" id="2748909">.</span><span class="ident" id="2748910">tx</span><span class="op" id="2748912">[</span><span class="num" id="2748913">0</span><span class="op" id="2748914">]</span><span class="op" id="2748915">.</span><span class="ident" id="2748916">when</span>&nbsp;<span class="op" id="2748921">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748925">zone</span>&nbsp;<span class="op" id="2748930">:=</span>&nbsp;<span class="op" id="2748933">&amp;</span><span class="ident" id="2748934">l</span><span class="op" id="2748935">.</span><span class="ident" id="2748936">zone</span><span class="op" id="2748940">[</span><span class="ident" id="2748941">l</span><span class="op" id="2748942">.</span><span class="ident" id="2748943">lookupFirstZone</span><span class="op" id="2748958">(</span><span class="op" id="2748959">)</span><span class="op" id="2748960">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748964">name</span>&nbsp;<span class="op" id="2748969">=</span>&nbsp;<span class="ident" id="2748971">zone</span><span class="op" id="2748975">.</span><span class="ident" id="2748976">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2748983">offset</span>&nbsp;<span class="op" id="2748990">=</span>&nbsp;<span class="ident" id="2748992">zone</span><span class="op" id="2748996">.</span><span class="ident" id="2748997">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749006">isDST</span>&nbsp;<span class="op" id="2749012">=</span>&nbsp;<span class="ident" id="2749014">zone</span><span class="op" id="2749018">.</span><span class="ident" id="2749019">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749027">start</span>&nbsp;<span class="op" id="2749033">=</span>&nbsp;<span class="ident" id="2749035">alpha</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2749043">if</span>&nbsp;<span class="builtinfunc" id="2749046">len</span><span class="op" id="2749049">(</span><span class="ident" id="2749050">l</span><span class="op" id="2749051">.</span><span class="ident" id="2749052">tx</span><span class="op" id="2749054">)</span>&nbsp;<span class="op" id="2749056">&gt;</span>&nbsp;<span class="num" id="2749058">0</span>&nbsp;<span class="op" id="2749060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749065">end</span>&nbsp;<span class="op" id="2749069">=</span>&nbsp;<span class="ident" id="2749071">l</span><span class="op" id="2749072">.</span><span class="ident" id="2749073">tx</span><span class="op" id="2749075">[</span><span class="num" id="2749076">0</span><span class="op" id="2749077">]</span><span class="op" id="2749078">.</span><span class="ident" id="2749079">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2749086">}</span>&nbsp;<span class="keyword" id="2749088">else</span>&nbsp;<span class="op" id="2749093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749098">end</span>&nbsp;<span class="op" id="2749102">=</span>&nbsp;<span class="ident" id="2749104">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2749112">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2749116">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2749124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2749128">//&nbsp;Binary&nbsp;search&nbsp;for&nbsp;entry&nbsp;with&nbsp;largest&nbsp;time&nbsp;&lt;=&nbsp;sec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2749182">//&nbsp;Not&nbsp;using&nbsp;sort.Search&nbsp;to&nbsp;avoid&nbsp;dependencies.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749231">tx</span>&nbsp;<span class="op" id="2749234">:=</span>&nbsp;<span class="ident" id="2749237">l</span><span class="op" id="2749238">.</span><span class="ident" id="2749239">tx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749243">end</span>&nbsp;<span class="op" id="2749247">=</span>&nbsp;<span class="ident" id="2749249">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749256">lo</span>&nbsp;<span class="op" id="2749259">:=</span>&nbsp;<span class="num" id="2749262">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749265">hi</span>&nbsp;<span class="op" id="2749268">:=</span>&nbsp;<span class="builtinfunc" id="2749271">len</span><span class="op" id="2749274">(</span><span class="ident" id="2749275">tx</span><span class="op" id="2749277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2749280">for</span>&nbsp;<span class="ident" id="2749284">hi</span><span class="op" id="2749286">-</span><span class="ident" id="2749287">lo</span>&nbsp;<span class="op" id="2749290">&gt;</span>&nbsp;<span class="num" id="2749292">1</span>&nbsp;<span class="op" id="2749294">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749298">m</span>&nbsp;<span class="op" id="2749300">:=</span>&nbsp;<span class="ident" id="2749303">lo</span>&nbsp;<span class="op" id="2749306">+</span>&nbsp;<span class="op" id="2749308">(</span><span class="ident" id="2749309">hi</span><span class="op" id="2749311">-</span><span class="ident" id="2749312">lo</span><span class="op" id="2749314">)</span><span class="op" id="2749315">/</span><span class="num" id="2749316">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749320">lim</span>&nbsp;<span class="op" id="2749324">:=</span>&nbsp;<span class="ident" id="2749327">tx</span><span class="op" id="2749329">[</span><span class="ident" id="2749330">m</span><span class="op" id="2749331">]</span><span class="op" id="2749332">.</span><span class="ident" id="2749333">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2749340">if</span>&nbsp;<span class="ident" id="2749343">sec</span>&nbsp;<span class="op" id="2749347">&lt;</span>&nbsp;<span class="ident" id="2749349">lim</span>&nbsp;<span class="op" id="2749353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749358">end</span>&nbsp;<span class="op" id="2749362">=</span>&nbsp;<span class="ident" id="2749364">lim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749371">hi</span>&nbsp;<span class="op" id="2749374">=</span>&nbsp;<span class="ident" id="2749376">m</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2749380">}</span>&nbsp;<span class="keyword" id="2749382">else</span>&nbsp;<span class="op" id="2749387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749392">lo</span>&nbsp;<span class="op" id="2749395">=</span>&nbsp;<span class="ident" id="2749397">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2749401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2749404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749407">zone</span>&nbsp;<span class="op" id="2749412">:=</span>&nbsp;<span class="op" id="2749415">&amp;</span><span class="ident" id="2749416">l</span><span class="op" id="2749417">.</span><span class="ident" id="2749418">zone</span><span class="op" id="2749422">[</span><span class="ident" id="2749423">tx</span><span class="op" id="2749425">[</span><span class="ident" id="2749426">lo</span><span class="op" id="2749428">]</span><span class="op" id="2749429">.</span><span class="ident" id="2749430">index</span><span class="op" id="2749435">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749438">name</span>&nbsp;<span class="op" id="2749443">=</span>&nbsp;<span class="ident" id="2749445">zone</span><span class="op" id="2749449">.</span><span class="ident" id="2749450">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749456">offset</span>&nbsp;<span class="op" id="2749463">=</span>&nbsp;<span class="ident" id="2749465">zone</span><span class="op" id="2749469">.</span><span class="ident" id="2749470">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749478">isDST</span>&nbsp;<span class="op" id="2749484">=</span>&nbsp;<span class="ident" id="2749486">zone</span><span class="op" id="2749490">.</span><span class="ident" id="2749491">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2749498">start</span>&nbsp;<span class="op" id="2749504">=</span>&nbsp;<span class="ident" id="2749506">tx</span><span class="op" id="2749508">[</span><span class="ident" id="2749509">lo</span><span class="op" id="2749511">]</span><span class="op" id="2749512">.</span><span class="ident" id="2749513">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2749519">//&nbsp;end&nbsp;=&nbsp;maintained&nbsp;during&nbsp;the&nbsp;search</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2749558">return</span><br>
<span class="lineno"></span><span class="op" id="2749565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2749568">//&nbsp;lookupFirstZone&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;time&nbsp;zone&nbsp;to&nbsp;use&nbsp;for&nbsp;times</span><br>
<span class="lineno"></span><span class="comment" id="2749639">//&nbsp;before&nbsp;the&nbsp;first&nbsp;transition&nbsp;time,&nbsp;or&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;transition</span><br>
<span class="lineno">170</span><span class="comment" id="2749708">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2749718">//</span><br>
<span class="lineno"></span><span class="comment" id="2749721">//&nbsp;The&nbsp;reference&nbsp;implementation&nbsp;in&nbsp;localtime.c&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2749773">//&nbsp;http://www.iana.org/time-zones/repository/releases/tzcode2013g.tar.gz</span><br>
<span class="lineno"></span><span class="comment" id="2749846">//&nbsp;implements&nbsp;the&nbsp;following&nbsp;algorithm&nbsp;for&nbsp;these&nbsp;cases:</span><br>
<span class="lineno">175</span><span class="comment" id="2749901">//&nbsp;1)&nbsp;If&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;unused&nbsp;by&nbsp;the&nbsp;transitions,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2749963">//&nbsp;2)&nbsp;Otherwise,&nbsp;if&nbsp;there&nbsp;are&nbsp;transition&nbsp;times,&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2750025">//&nbsp;&nbsp;&nbsp;&nbsp;transition&nbsp;is&nbsp;to&nbsp;a&nbsp;zone&nbsp;in&nbsp;daylight&nbsp;time,&nbsp;find&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2750088">//&nbsp;&nbsp;&nbsp;&nbsp;non-daylight-time&nbsp;zone&nbsp;before&nbsp;and&nbsp;closest&nbsp;to&nbsp;the&nbsp;first&nbsp;transition</span><br>
<span class="lineno"></span><span class="comment" id="2750160">//&nbsp;&nbsp;&nbsp;&nbsp;zone.</span><br>
<span class="lineno">180</span><span class="comment" id="2750172">//&nbsp;3)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone&nbsp;that&nbsp;is&nbsp;not&nbsp;daylight&nbsp;time,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2750238">//&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment" id="2750258">//&nbsp;4)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2750295">func</span>&nbsp;<span class="op" id="2750300">(</span><span class="ident" id="2750301">l</span>&nbsp;<span class="op" id="2750303">*</span><span class="ident" id="2750304">Location</span><span class="op" id="2750312">)</span>&nbsp;<span class="ident" id="2750314">lookupFirstZone</span><span class="op" id="2750329">(</span><span class="op" id="2750330">)</span>&nbsp;<span class="builtintype" id="2750332">int</span>&nbsp;<span class="op" id="2750336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2750339">//&nbsp;Case&nbsp;1.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2750351">if</span>&nbsp;<span class="op" id="2750354">!</span><span class="ident" id="2750355">l</span><span class="op" id="2750356">.</span><span class="ident" id="2750357">firstZoneUsed</span><span class="op" id="2750370">(</span><span class="op" id="2750371">)</span>&nbsp;<span class="op" id="2750373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2750377">return</span>&nbsp;<span class="num" id="2750384">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2750387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2750391">//&nbsp;Case&nbsp;2.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2750403">if</span>&nbsp;<span class="builtinfunc" id="2750406">len</span><span class="op" id="2750409">(</span><span class="ident" id="2750410">l</span><span class="op" id="2750411">.</span><span class="ident" id="2750412">tx</span><span class="op" id="2750414">)</span>&nbsp;<span class="op" id="2750416">&gt;</span>&nbsp;<span class="num" id="2750418">0</span>&nbsp;<span class="op" id="2750420">&amp;&amp;</span>&nbsp;<span class="ident" id="2750423">l</span><span class="op" id="2750424">.</span><span class="ident" id="2750425">zone</span><span class="op" id="2750429">[</span><span class="ident" id="2750430">l</span><span class="op" id="2750431">.</span><span class="ident" id="2750432">tx</span><span class="op" id="2750434">[</span><span class="num" id="2750435">0</span><span class="op" id="2750436">]</span><span class="op" id="2750437">.</span><span class="ident" id="2750438">index</span><span class="op" id="2750443">]</span><span class="op" id="2750444">.</span><span class="ident" id="2750445">isDST</span>&nbsp;<span class="op" id="2750451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2750455">for</span>&nbsp;<span class="ident" id="2750459">zi</span>&nbsp;<span class="op" id="2750462">:=</span>&nbsp;<span class="builtintype" id="2750465">int</span><span class="op" id="2750468">(</span><span class="ident" id="2750469">l</span><span class="op" id="2750470">.</span><span class="ident" id="2750471">tx</span><span class="op" id="2750473">[</span><span class="num" id="2750474">0</span><span class="op" id="2750475">]</span><span class="op" id="2750476">.</span><span class="ident" id="2750477">index</span><span class="op" id="2750482">)</span>&nbsp;<span class="op" id="2750484">-</span>&nbsp;<span class="num" id="2750486">1</span><span class="op" id="2750487">;</span>&nbsp;<span class="ident" id="2750489">zi</span>&nbsp;<span class="op" id="2750492">&gt;=</span>&nbsp;<span class="num" id="2750495">0</span><span class="op" id="2750496">;</span>&nbsp;<span class="ident" id="2750498">zi</span><span class="op" id="2750500">--</span>&nbsp;<span class="op" id="2750503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2750508">if</span>&nbsp;<span class="op" id="2750511">!</span><span class="ident" id="2750512">l</span><span class="op" id="2750513">.</span><span class="ident" id="2750514">zone</span><span class="op" id="2750518">[</span><span class="ident" id="2750519">zi</span><span class="op" id="2750521">]</span><span class="op" id="2750522">.</span><span class="ident" id="2750523">isDST</span>&nbsp;<span class="op" id="2750529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2750535">return</span>&nbsp;<span class="ident" id="2750542">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2750548">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2750552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2750555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2750559">//&nbsp;Case&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2750571">for</span>&nbsp;<span class="ident" id="2750575">zi</span>&nbsp;<span class="op" id="2750578">:=</span>&nbsp;<span class="keyword" id="2750581">range</span>&nbsp;<span class="ident" id="2750587">l</span><span class="op" id="2750588">.</span><span class="ident" id="2750589">zone</span>&nbsp;<span class="op" id="2750594">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2750598">if</span>&nbsp;<span class="op" id="2750601">!</span><span class="ident" id="2750602">l</span><span class="op" id="2750603">.</span><span class="ident" id="2750604">zone</span><span class="op" id="2750608">[</span><span class="ident" id="2750609">zi</span><span class="op" id="2750611">]</span><span class="op" id="2750612">.</span><span class="ident" id="2750613">isDST</span>&nbsp;<span class="op" id="2750619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2750624">return</span>&nbsp;<span class="ident" id="2750631">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2750636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2750639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2750643">//&nbsp;Case&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2750655">return</span>&nbsp;<span class="num" id="2750662">0</span><br>
<span class="lineno"></span><span class="op" id="2750664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2750667">//&nbsp;firstZoneUsed&nbsp;returns&nbsp;whether&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;used&nbsp;by&nbsp;some</span><br>
<span class="lineno">210</span><span class="comment" id="2750731">//&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2750746">func</span>&nbsp;<span class="op" id="2750751">(</span><span class="ident" id="2750752">l</span>&nbsp;<span class="op" id="2750754">*</span><span class="ident" id="2750755">Location</span><span class="op" id="2750763">)</span>&nbsp;<span class="ident" id="2750765">firstZoneUsed</span><span class="op" id="2750778">(</span><span class="op" id="2750779">)</span>&nbsp;<span class="builtintype" id="2750781">bool</span>&nbsp;<span class="op" id="2750786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2750789">for</span>&nbsp;<span class="ident" id="2750793">_</span><span class="op" id="2750794">,</span>&nbsp;<span class="ident" id="2750796">tx</span>&nbsp;<span class="op" id="2750799">:=</span>&nbsp;<span class="keyword" id="2750802">range</span>&nbsp;<span class="ident" id="2750808">l</span><span class="op" id="2750809">.</span><span class="ident" id="2750810">tx</span>&nbsp;<span class="op" id="2750813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2750817">if</span>&nbsp;<span class="ident" id="2750820">tx</span><span class="op" id="2750822">.</span><span class="ident" id="2750823">index</span>&nbsp;<span class="op" id="2750829">==</span>&nbsp;<span class="num" id="2750832">0</span>&nbsp;<span class="op" id="2750834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2750839">return</span>&nbsp;<span class="builtintype" id="2750846">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2750853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2750856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2750859">return</span>&nbsp;<span class="builtintype" id="2750866">false</span><br>
<span class="lineno"></span><span class="op" id="2750872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2750875">//&nbsp;lookupName&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2750934">//&nbsp;the&nbsp;given&nbsp;name&nbsp;(such&nbsp;as&nbsp;&#34;EST&#34;)&nbsp;at&nbsp;the&nbsp;given&nbsp;pseudo-Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2750998">//&nbsp;(what&nbsp;the&nbsp;given&nbsp;time&nbsp;of&nbsp;day&nbsp;would&nbsp;be&nbsp;in&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2751047">func</span>&nbsp;<span class="op" id="2751052">(</span><span class="ident" id="2751053">l</span>&nbsp;<span class="op" id="2751055">*</span><span class="ident" id="2751056">Location</span><span class="op" id="2751064">)</span>&nbsp;<span class="ident" id="2751066">lookupName</span><span class="op" id="2751076">(</span><span class="ident" id="2751077">name</span>&nbsp;<span class="builtintype" id="2751082">string</span><span class="op" id="2751088">,</span>&nbsp;<span class="ident" id="2751090">unix</span>&nbsp;<span class="ident" id="2751095">int64</span><span class="op" id="2751100">)</span>&nbsp;<span class="op" id="2751102">(</span><span class="ident" id="2751103">offset</span>&nbsp;<span class="builtintype" id="2751110">int</span><span class="op" id="2751113">,</span>&nbsp;<span class="ident" id="2751115">isDST</span>&nbsp;<span class="builtintype" id="2751121">bool</span><span class="op" id="2751125">,</span>&nbsp;<span class="ident" id="2751127">ok</span>&nbsp;<span class="builtintype" id="2751130">bool</span><span class="op" id="2751134">)</span>&nbsp;<span class="op" id="2751136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2751139">l</span>&nbsp;<span class="op" id="2751141">=</span>&nbsp;<span class="ident" id="2751143">l</span><span class="op" id="2751144">.</span><span class="ident" id="2751145">get</span><span class="op" id="2751148">(</span><span class="op" id="2751149">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2751153">//&nbsp;First&nbsp;try&nbsp;for&nbsp;a&nbsp;zone&nbsp;with&nbsp;the&nbsp;right&nbsp;name&nbsp;that&nbsp;was&nbsp;actually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2751216">//&nbsp;in&nbsp;effect&nbsp;at&nbsp;the&nbsp;given&nbsp;time.&nbsp;(In&nbsp;Sydney,&nbsp;Australia,&nbsp;both&nbsp;standard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2751286">//&nbsp;and&nbsp;daylight-savings&nbsp;time&nbsp;are&nbsp;abbreviated&nbsp;&#34;EST&#34;.&nbsp;Using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2751349">//&nbsp;offset&nbsp;helps&nbsp;us&nbsp;pick&nbsp;the&nbsp;right&nbsp;one&nbsp;for&nbsp;the&nbsp;given&nbsp;time.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2751408">//&nbsp;It&#39;s&nbsp;not&nbsp;perfect:&nbsp;during&nbsp;the&nbsp;backward&nbsp;transition&nbsp;we&nbsp;might&nbsp;pick</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2751475">//&nbsp;either&nbsp;one.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2751492">for</span>&nbsp;<span class="ident" id="2751496">i</span>&nbsp;<span class="op" id="2751498">:=</span>&nbsp;<span class="keyword" id="2751501">range</span>&nbsp;<span class="ident" id="2751507">l</span><span class="op" id="2751508">.</span><span class="ident" id="2751509">zone</span>&nbsp;<span class="op" id="2751514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2751518">zone</span>&nbsp;<span class="op" id="2751523">:=</span>&nbsp;<span class="op" id="2751526">&amp;</span><span class="ident" id="2751527">l</span><span class="op" id="2751528">.</span><span class="ident" id="2751529">zone</span><span class="op" id="2751533">[</span><span class="ident" id="2751534">i</span><span class="op" id="2751535">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2751539">if</span>&nbsp;<span class="ident" id="2751542">zone</span><span class="op" id="2751546">.</span><span class="ident" id="2751547">name</span>&nbsp;<span class="op" id="2751552">==</span>&nbsp;<span class="ident" id="2751555">name</span>&nbsp;<span class="op" id="2751560">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2751565">nam</span><span class="op" id="2751568">,</span>&nbsp;<span class="ident" id="2751570">offset</span><span class="op" id="2751576">,</span>&nbsp;<span class="ident" id="2751578">isDST</span><span class="op" id="2751583">,</span>&nbsp;<span class="ident" id="2751585">_</span><span class="op" id="2751586">,</span>&nbsp;<span class="ident" id="2751588">_</span>&nbsp;<span class="op" id="2751590">:=</span>&nbsp;<span class="ident" id="2751593">l</span><span class="op" id="2751594">.</span><span class="ident" id="2751595">lookup</span><span class="op" id="2751601">(</span><span class="ident" id="2751602">unix</span>&nbsp;<span class="op" id="2751607">-</span>&nbsp;<span class="ident" id="2751609">int64</span><span class="op" id="2751614">(</span><span class="ident" id="2751615">zone</span><span class="op" id="2751619">.</span><span class="ident" id="2751620">offset</span><span class="op" id="2751626">)</span><span class="op" id="2751627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2751632">if</span>&nbsp;<span class="ident" id="2751635">nam</span>&nbsp;<span class="op" id="2751639">==</span>&nbsp;<span class="ident" id="2751642">zone</span><span class="op" id="2751646">.</span><span class="ident" id="2751647">name</span>&nbsp;<span class="op" id="2751652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2751658">return</span>&nbsp;<span class="ident" id="2751665">offset</span><span class="op" id="2751671">,</span>&nbsp;<span class="ident" id="2751673">isDST</span><span class="op" id="2751678">,</span>&nbsp;<span class="builtintype" id="2751680">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2751688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2751692">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2751695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2751699">//&nbsp;Otherwise&nbsp;fall&nbsp;back&nbsp;to&nbsp;an&nbsp;ordinary&nbsp;name&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2751750">for</span>&nbsp;<span class="ident" id="2751754">i</span>&nbsp;<span class="op" id="2751756">:=</span>&nbsp;<span class="keyword" id="2751759">range</span>&nbsp;<span class="ident" id="2751765">l</span><span class="op" id="2751766">.</span><span class="ident" id="2751767">zone</span>&nbsp;<span class="op" id="2751772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2751776">zone</span>&nbsp;<span class="op" id="2751781">:=</span>&nbsp;<span class="op" id="2751784">&amp;</span><span class="ident" id="2751785">l</span><span class="op" id="2751786">.</span><span class="ident" id="2751787">zone</span><span class="op" id="2751791">[</span><span class="ident" id="2751792">i</span><span class="op" id="2751793">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2751797">if</span>&nbsp;<span class="ident" id="2751800">zone</span><span class="op" id="2751804">.</span><span class="ident" id="2751805">name</span>&nbsp;<span class="op" id="2751810">==</span>&nbsp;<span class="ident" id="2751813">name</span>&nbsp;<span class="op" id="2751818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2751823">return</span>&nbsp;<span class="ident" id="2751830">zone</span><span class="op" id="2751834">.</span><span class="ident" id="2751835">offset</span><span class="op" id="2751841">,</span>&nbsp;<span class="ident" id="2751843">zone</span><span class="op" id="2751847">.</span><span class="ident" id="2751848">isDST</span><span class="op" id="2751853">,</span>&nbsp;<span class="builtintype" id="2751855">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2751862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2751865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2751869">//&nbsp;Otherwise,&nbsp;give&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2751893">return</span><br>
<span class="lineno"></span><span class="op" id="2751900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2751903">//&nbsp;NOTE(rsc):&nbsp;Eventually&nbsp;we&nbsp;will&nbsp;need&nbsp;to&nbsp;accept&nbsp;the&nbsp;POSIX&nbsp;TZ&nbsp;environment</span><br>
<span class="lineno">255</span><span class="comment" id="2751976">//&nbsp;syntax&nbsp;too,&nbsp;but&nbsp;I&nbsp;don&#39;t&nbsp;feel&nbsp;like&nbsp;implementing&nbsp;it&nbsp;today.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2752037">var</span>&nbsp;<span class="ident" id="2752041">zoneinfo</span><span class="op" id="2752049">,</span>&nbsp;<span class="ident" id="2752051">_</span>&nbsp;<span class="op" id="2752053">=</span>&nbsp;<span class="ident" id="2752055">syscall</span><span class="op" id="2752062">.</span><span class="ident" id="2752063">Getenv</span><span class="op" id="2752069">(</span><span class="string" id="2752070">&#34;ZONEINFO&#34;</span><span class="op" id="2752080">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2752083">//&nbsp;LoadLocation&nbsp;returns&nbsp;the&nbsp;Location&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno">260</span><span class="comment" id="2752141">//</span><br>
<span class="lineno"></span><span class="comment" id="2752144">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;&#34;&nbsp;or&nbsp;&#34;UTC&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2752201">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;Local&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;Local.</span><br>
<span class="lineno"></span><span class="comment" id="2752256">//</span><br>
<span class="lineno"></span><span class="comment" id="2752259">//&nbsp;Otherwise,&nbsp;the&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;a&nbsp;location&nbsp;name&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;file</span><br>
<span class="lineno">265</span><span class="comment" id="2752337">//&nbsp;in&nbsp;the&nbsp;IANA&nbsp;Time&nbsp;Zone&nbsp;database,&nbsp;such&nbsp;as&nbsp;&#34;America/New_York&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2752400">//</span><br>
<span class="lineno"></span><span class="comment" id="2752403">//&nbsp;The&nbsp;time&nbsp;zone&nbsp;database&nbsp;needed&nbsp;by&nbsp;LoadLocation&nbsp;may&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2752463">//&nbsp;present&nbsp;on&nbsp;all&nbsp;systems,&nbsp;especially&nbsp;non-Unix&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="2752519">//&nbsp;LoadLocation&nbsp;looks&nbsp;in&nbsp;the&nbsp;directory&nbsp;or&nbsp;uncompressed&nbsp;zip&nbsp;file</span><br>
<span class="lineno">270</span><span class="comment" id="2752583">//&nbsp;named&nbsp;by&nbsp;the&nbsp;ZONEINFO&nbsp;environment&nbsp;variable,&nbsp;if&nbsp;any,&nbsp;then&nbsp;looks&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2752652">//&nbsp;known&nbsp;installation&nbsp;locations&nbsp;on&nbsp;Unix&nbsp;systems,</span><br>
<span class="lineno"></span><span class="comment" id="2752701">//&nbsp;and&nbsp;finally&nbsp;looks&nbsp;in&nbsp;$GOROOT/lib/time/zoneinfo.zip.</span><br>
<span class="lineno"></span><span class="keyword" id="2752756">func</span>&nbsp;<span class="ident" id="2752761">LoadLocation</span><span class="op" id="2752773">(</span><span class="ident" id="2752774">name</span>&nbsp;<span class="builtintype" id="2752779">string</span><span class="op" id="2752785">)</span>&nbsp;<span class="op" id="2752787">(</span><span class="op" id="2752788">*</span><span class="ident" id="2752789">Location</span><span class="op" id="2752797">,</span>&nbsp;<span class="builtintype" id="2752799">error</span><span class="op" id="2752804">)</span>&nbsp;<span class="op" id="2752806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2752809">if</span>&nbsp;<span class="ident" id="2752812">name</span>&nbsp;<span class="op" id="2752817">==</span>&nbsp;<span class="string" id="2752820">&#34;&#34;</span>&nbsp;<span class="op" id="2752823">||</span>&nbsp;<span class="ident" id="2752826">name</span>&nbsp;<span class="op" id="2752831">==</span>&nbsp;<span class="string" id="2752834">&#34;UTC&#34;</span>&nbsp;<span class="op" id="2752840">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2752844">return</span>&nbsp;<span class="ident" id="2752851">UTC</span><span class="op" id="2752854">,</span>&nbsp;<span class="builtintype" id="2752856">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2752861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2752864">if</span>&nbsp;<span class="ident" id="2752867">name</span>&nbsp;<span class="op" id="2752872">==</span>&nbsp;<span class="string" id="2752875">&#34;Local&#34;</span>&nbsp;<span class="op" id="2752883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2752887">return</span>&nbsp;<span class="ident" id="2752894">Local</span><span class="op" id="2752899">,</span>&nbsp;<span class="builtintype" id="2752901">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2752906">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2752909">if</span>&nbsp;<span class="ident" id="2752912">zoneinfo</span>&nbsp;<span class="op" id="2752921">!=</span>&nbsp;<span class="string" id="2752924">&#34;&#34;</span>&nbsp;<span class="op" id="2752927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2752931">if</span>&nbsp;<span class="ident" id="2752934">z</span><span class="op" id="2752935">,</span>&nbsp;<span class="ident" id="2752937">err</span>&nbsp;<span class="op" id="2752941">:=</span>&nbsp;<span class="ident" id="2752944">loadZoneFile</span><span class="op" id="2752956">(</span><span class="ident" id="2752957">zoneinfo</span><span class="op" id="2752965">,</span>&nbsp;<span class="ident" id="2752967">name</span><span class="op" id="2752971">)</span><span class="op" id="2752972">;</span>&nbsp;<span class="ident" id="2752974">err</span>&nbsp;<span class="op" id="2752978">==</span>&nbsp;<span class="builtintype" id="2752981">nil</span>&nbsp;<span class="op" id="2752985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2752990">z</span><span class="op" id="2752991">.</span><span class="ident" id="2752992">name</span>&nbsp;<span class="op" id="2752997">=</span>&nbsp;<span class="ident" id="2752999">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2753007">return</span>&nbsp;<span class="ident" id="2753014">z</span><span class="op" id="2753015">,</span>&nbsp;<span class="builtintype" id="2753017">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2753023">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2753026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2753029">return</span>&nbsp;<span class="ident" id="2753036">loadLocation</span><span class="op" id="2753048">(</span><span class="ident" id="2753049">name</span><span class="op" id="2753053">)</span><br>
<span class="lineno"></span><span class="op" id="2753055">}</span>
</div>
</body>
</html>
