<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3348791">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3348846">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3348900">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3348951">//&nbsp;Read&nbsp;static&nbsp;host/IP&nbsp;entries&nbsp;from&nbsp;/etc/hosts.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3349000">package</span>&nbsp;<span class="ident" id="3349008">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3349013">import</span>&nbsp;<span class="op" id="3349020">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3349023">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3349031">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3349038">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3349041">const</span>&nbsp;<span class="ident" id="3349047">cacheMaxAge</span>&nbsp;<span class="op" id="3349059">=</span>&nbsp;<span class="num" id="3349061">5</span>&nbsp;<span class="op" id="3349063">*</span>&nbsp;<span class="ident" id="3349065">time</span><span class="op" id="3349069">.</span><span class="ident" id="3349070">Minute</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3349078">//&nbsp;hostsPath&nbsp;points&nbsp;to&nbsp;the&nbsp;file&nbsp;with&nbsp;static&nbsp;IP/address&nbsp;entries.</span><br>
<span class="lineno"></span><span class="keyword" id="3349142">var</span>&nbsp;<span class="ident" id="3349146">hostsPath</span>&nbsp;<span class="op" id="3349156">=</span>&nbsp;<span class="string" id="3349158">&#34;/etc/hosts&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3349172">//&nbsp;Simple&nbsp;cache.</span><br>
<span class="lineno">20</span><span class="keyword" id="3349189">var</span>&nbsp;<span class="ident" id="3349193">hosts</span>&nbsp;<span class="keyword" id="3349199">struct</span>&nbsp;<span class="op" id="3349206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349209">sync</span><span class="op" id="3349213">.</span><span class="ident" id="3349214">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349221">byName</span>&nbsp;<span class="keyword" id="3349228">map</span><span class="op" id="3349231">[</span><span class="builtintype" id="3349232">string</span><span class="op" id="3349238">]</span><span class="op" id="3349239">[</span><span class="op" id="3349240">]</span><span class="builtintype" id="3349241">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349249">byAddr</span>&nbsp;<span class="keyword" id="3349256">map</span><span class="op" id="3349259">[</span><span class="builtintype" id="3349260">string</span><span class="op" id="3349266">]</span><span class="op" id="3349267">[</span><span class="op" id="3349268">]</span><span class="builtintype" id="3349269">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349277">expire</span>&nbsp;<span class="ident" id="3349284">time</span><span class="op" id="3349288">.</span><span class="ident" id="3349289">Time</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349295">path</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3349302">string</span><br>
<span class="lineno"></span><span class="op" id="3349309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3349312">func</span>&nbsp;<span class="ident" id="3349317">readHosts</span><span class="op" id="3349326">(</span><span class="op" id="3349327">)</span>&nbsp;<span class="op" id="3349329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349332">now</span>&nbsp;<span class="op" id="3349336">:=</span>&nbsp;<span class="ident" id="3349339">time</span><span class="op" id="3349343">.</span><span class="ident" id="3349344">Now</span><span class="op" id="3349347">(</span><span class="op" id="3349348">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349351">hp</span>&nbsp;<span class="op" id="3349354">:=</span>&nbsp;<span class="ident" id="3349357">hostsPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3349368">if</span>&nbsp;<span class="builtinfunc" id="3349371">len</span><span class="op" id="3349374">(</span><span class="ident" id="3349375">hosts</span><span class="op" id="3349380">.</span><span class="ident" id="3349381">byName</span><span class="op" id="3349387">)</span>&nbsp;<span class="op" id="3349389">==</span>&nbsp;<span class="num" id="3349392">0</span>&nbsp;<span class="op" id="3349394">||</span>&nbsp;<span class="ident" id="3349397">now</span><span class="op" id="3349400">.</span><span class="ident" id="3349401">After</span><span class="op" id="3349406">(</span><span class="ident" id="3349407">hosts</span><span class="op" id="3349412">.</span><span class="ident" id="3349413">expire</span><span class="op" id="3349419">)</span>&nbsp;<span class="op" id="3349421">||</span>&nbsp;<span class="ident" id="3349424">hosts</span><span class="op" id="3349429">.</span><span class="ident" id="3349430">path</span>&nbsp;<span class="op" id="3349435">!=</span>&nbsp;<span class="ident" id="3349438">hp</span>&nbsp;<span class="op" id="3349441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349445">hs</span>&nbsp;<span class="op" id="3349448">:=</span>&nbsp;<span class="builtinfunc" id="3349451">make</span><span class="op" id="3349455">(</span><span class="keyword" id="3349456">map</span><span class="op" id="3349459">[</span><span class="builtintype" id="3349460">string</span><span class="op" id="3349466">]</span><span class="op" id="3349467">[</span><span class="op" id="3349468">]</span><span class="builtintype" id="3349469">string</span><span class="op" id="3349475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349479">is</span>&nbsp;<span class="op" id="3349482">:=</span>&nbsp;<span class="builtinfunc" id="3349485">make</span><span class="op" id="3349489">(</span><span class="keyword" id="3349490">map</span><span class="op" id="3349493">[</span><span class="builtintype" id="3349494">string</span><span class="op" id="3349500">]</span><span class="op" id="3349501">[</span><span class="op" id="3349502">]</span><span class="builtintype" id="3349503">string</span><span class="op" id="3349509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3349513">var</span>&nbsp;<span class="ident" id="3349517">file</span>&nbsp;<span class="op" id="3349522">*</span><span class="ident" id="3349523">file</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3349530">if</span>&nbsp;<span class="ident" id="3349533">file</span><span class="op" id="3349537">,</span>&nbsp;<span class="ident" id="3349539">_</span>&nbsp;<span class="op" id="3349541">=</span>&nbsp;<span class="ident" id="3349543">open</span><span class="op" id="3349547">(</span><span class="ident" id="3349548">hp</span><span class="op" id="3349550">)</span><span class="op" id="3349551">;</span>&nbsp;<span class="ident" id="3349553">file</span>&nbsp;<span class="op" id="3349558">==</span>&nbsp;<span class="ident" id="3349561">nil</span>&nbsp;<span class="op" id="3349565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3349570">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3349579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3349583">for</span>&nbsp;<span class="ident" id="3349587">line</span><span class="op" id="3349591">,</span>&nbsp;<span class="ident" id="3349593">ok</span>&nbsp;<span class="op" id="3349596">:=</span>&nbsp;<span class="ident" id="3349599">file</span><span class="op" id="3349603">.</span><span class="ident" id="3349604">readLine</span><span class="op" id="3349612">(</span><span class="op" id="3349613">)</span><span class="op" id="3349614">;</span>&nbsp;<span class="ident" id="3349616">ok</span><span class="op" id="3349618">;</span>&nbsp;<span class="ident" id="3349620">line</span><span class="op" id="3349624">,</span>&nbsp;<span class="ident" id="3349626">ok</span>&nbsp;<span class="op" id="3349629">=</span>&nbsp;<span class="ident" id="3349631">file</span><span class="op" id="3349635">.</span><span class="ident" id="3349636">readLine</span><span class="op" id="3349644">(</span><span class="op" id="3349645">)</span>&nbsp;<span class="op" id="3349647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3349652">if</span>&nbsp;<span class="ident" id="3349655">i</span>&nbsp;<span class="op" id="3349657">:=</span>&nbsp;<span class="ident" id="3349660">byteIndex</span><span class="op" id="3349669">(</span><span class="ident" id="3349670">line</span><span class="op" id="3349674">,</span>&nbsp;<span class="string" id="3349676">&#39;#&#39;</span><span class="op" id="3349679">)</span><span class="op" id="3349680">;</span>&nbsp;<span class="ident" id="3349682">i</span>&nbsp;<span class="op" id="3349684">&gt;=</span>&nbsp;<span class="num" id="3349687">0</span>&nbsp;<span class="op" id="3349689">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3349695">//&nbsp;Discard&nbsp;comments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349720">line</span>&nbsp;<span class="op" id="3349725">=</span>&nbsp;<span class="ident" id="3349727">line</span><span class="op" id="3349731">[</span><span class="num" id="3349732">0</span><span class="op" id="3349733">:</span><span class="ident" id="3349734">i</span><span class="op" id="3349735">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3349740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349745">f</span>&nbsp;<span class="op" id="3349747">:=</span>&nbsp;<span class="ident" id="3349750">getFields</span><span class="op" id="3349759">(</span><span class="ident" id="3349760">line</span><span class="op" id="3349764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3349769">if</span>&nbsp;<span class="builtinfunc" id="3349772">len</span><span class="op" id="3349775">(</span><span class="ident" id="3349776">f</span><span class="op" id="3349777">)</span>&nbsp;<span class="op" id="3349779">&lt;</span>&nbsp;<span class="num" id="3349781">2</span>&nbsp;<span class="op" id="3349783">||</span>&nbsp;<span class="ident" id="3349786">ParseIP</span><span class="op" id="3349793">(</span><span class="ident" id="3349794">f</span><span class="op" id="3349795">[</span><span class="num" id="3349796">0</span><span class="op" id="3349797">]</span><span class="op" id="3349798">)</span>&nbsp;<span class="op" id="3349800">==</span>&nbsp;<span class="ident" id="3349803">nil</span>&nbsp;<span class="op" id="3349807">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3349813">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3349825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3349830">for</span>&nbsp;<span class="ident" id="3349834">i</span>&nbsp;<span class="op" id="3349836">:=</span>&nbsp;<span class="num" id="3349839">1</span><span class="op" id="3349840">;</span>&nbsp;<span class="ident" id="3349842">i</span>&nbsp;<span class="op" id="3349844">&lt;</span>&nbsp;<span class="builtinfunc" id="3349846">len</span><span class="op" id="3349849">(</span><span class="ident" id="3349850">f</span><span class="op" id="3349851">)</span><span class="op" id="3349852">;</span>&nbsp;<span class="ident" id="3349854">i</span><span class="op" id="3349855">++</span>&nbsp;<span class="op" id="3349858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349864">h</span>&nbsp;<span class="op" id="3349866">:=</span>&nbsp;<span class="ident" id="3349869">f</span><span class="op" id="3349870">[</span><span class="ident" id="3349871">i</span><span class="op" id="3349872">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349878">hs</span><span class="op" id="3349880">[</span><span class="ident" id="3349881">h</span><span class="op" id="3349882">]</span>&nbsp;<span class="op" id="3349884">=</span>&nbsp;<span class="builtinfunc" id="3349886">append</span><span class="op" id="3349892">(</span><span class="ident" id="3349893">hs</span><span class="op" id="3349895">[</span><span class="ident" id="3349896">h</span><span class="op" id="3349897">]</span><span class="op" id="3349898">,</span>&nbsp;<span class="ident" id="3349900">f</span><span class="op" id="3349901">[</span><span class="num" id="3349902">0</span><span class="op" id="3349903">]</span><span class="op" id="3349904">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349910">is</span><span class="op" id="3349912">[</span><span class="ident" id="3349913">f</span><span class="op" id="3349914">[</span><span class="num" id="3349915">0</span><span class="op" id="3349916">]</span><span class="op" id="3349917">]</span>&nbsp;<span class="op" id="3349919">=</span>&nbsp;<span class="builtinfunc" id="3349921">append</span><span class="op" id="3349927">(</span><span class="ident" id="3349928">is</span><span class="op" id="3349930">[</span><span class="ident" id="3349931">f</span><span class="op" id="3349932">[</span><span class="num" id="3349933">0</span><span class="op" id="3349934">]</span><span class="op" id="3349935">]</span><span class="op" id="3349936">,</span>&nbsp;<span class="ident" id="3349938">h</span><span class="op" id="3349939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3349944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3349948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3349952">//&nbsp;Update&nbsp;the&nbsp;data&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3349980">hosts</span><span class="op" id="3349985">.</span><span class="ident" id="3349986">expire</span>&nbsp;<span class="op" id="3349993">=</span>&nbsp;<span class="ident" id="3349995">now</span><span class="op" id="3349998">.</span><span class="ident" id="3349999">Add</span><span class="op" id="3350002">(</span><span class="ident" id="3350003">cacheMaxAge</span><span class="op" id="3350014">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3350018">hosts</span><span class="op" id="3350023">.</span><span class="ident" id="3350024">path</span>&nbsp;<span class="op" id="3350029">=</span>&nbsp;<span class="ident" id="3350031">hp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3350036">hosts</span><span class="op" id="3350041">.</span><span class="ident" id="3350042">byName</span>&nbsp;<span class="op" id="3350049">=</span>&nbsp;<span class="ident" id="3350051">hs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3350056">hosts</span><span class="op" id="3350061">.</span><span class="ident" id="3350062">byAddr</span>&nbsp;<span class="op" id="3350069">=</span>&nbsp;<span class="ident" id="3350071">is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3350076">file</span><span class="op" id="3350080">.</span><span class="builtinfunc" id="3350081">close</span><span class="op" id="3350086">(</span><span class="op" id="3350087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3350090">}</span><br>
<span class="lineno">60</span><span class="op" id="3350092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3350095">//&nbsp;lookupStaticHost&nbsp;looks&nbsp;up&nbsp;the&nbsp;addresses&nbsp;for&nbsp;the&nbsp;given&nbsp;host&nbsp;from&nbsp;/etc/hosts.</span><br>
<span class="lineno"></span><span class="keyword" id="3350174">func</span>&nbsp;<span class="ident" id="3350179">lookupStaticHost</span><span class="op" id="3350195">(</span><span class="ident" id="3350196">host</span>&nbsp;<span class="builtintype" id="3350201">string</span><span class="op" id="3350207">)</span>&nbsp;<span class="op" id="3350209">[</span><span class="op" id="3350210">]</span><span class="builtintype" id="3350211">string</span>&nbsp;<span class="op" id="3350218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3350221">hosts</span><span class="op" id="3350226">.</span><span class="ident" id="3350227">Lock</span><span class="op" id="3350231">(</span><span class="op" id="3350232">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3350235">defer</span>&nbsp;<span class="ident" id="3350241">hosts</span><span class="op" id="3350246">.</span><span class="ident" id="3350247">Unlock</span><span class="op" id="3350253">(</span><span class="op" id="3350254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3350257">readHosts</span><span class="op" id="3350266">(</span><span class="op" id="3350267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3350270">if</span>&nbsp;<span class="builtinfunc" id="3350273">len</span><span class="op" id="3350276">(</span><span class="ident" id="3350277">hosts</span><span class="op" id="3350282">.</span><span class="ident" id="3350283">byName</span><span class="op" id="3350289">)</span>&nbsp;<span class="op" id="3350291">!=</span>&nbsp;<span class="num" id="3350294">0</span>&nbsp;<span class="op" id="3350296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3350300">if</span>&nbsp;<span class="ident" id="3350303">ips</span><span class="op" id="3350306">,</span>&nbsp;<span class="ident" id="3350308">ok</span>&nbsp;<span class="op" id="3350311">:=</span>&nbsp;<span class="ident" id="3350314">hosts</span><span class="op" id="3350319">.</span><span class="ident" id="3350320">byName</span><span class="op" id="3350326">[</span><span class="ident" id="3350327">host</span><span class="op" id="3350331">]</span><span class="op" id="3350332">;</span>&nbsp;<span class="ident" id="3350334">ok</span>&nbsp;<span class="op" id="3350337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3350342">return</span>&nbsp;<span class="ident" id="3350349">ips</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3350355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3350358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3350361">return</span>&nbsp;<span class="ident" id="3350368">nil</span><br>
<span class="lineno"></span><span class="op" id="3350372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="3350375">//&nbsp;lookupStaticAddr&nbsp;looks&nbsp;up&nbsp;the&nbsp;hosts&nbsp;for&nbsp;the&nbsp;given&nbsp;address&nbsp;from&nbsp;/etc/hosts.</span><br>
<span class="lineno"></span><span class="keyword" id="3350453">func</span>&nbsp;<span class="ident" id="3350458">lookupStaticAddr</span><span class="op" id="3350474">(</span><span class="ident" id="3350475">addr</span>&nbsp;<span class="builtintype" id="3350480">string</span><span class="op" id="3350486">)</span>&nbsp;<span class="op" id="3350488">[</span><span class="op" id="3350489">]</span><span class="builtintype" id="3350490">string</span>&nbsp;<span class="op" id="3350497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3350500">hosts</span><span class="op" id="3350505">.</span><span class="ident" id="3350506">Lock</span><span class="op" id="3350510">(</span><span class="op" id="3350511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3350514">defer</span>&nbsp;<span class="ident" id="3350520">hosts</span><span class="op" id="3350525">.</span><span class="ident" id="3350526">Unlock</span><span class="op" id="3350532">(</span><span class="op" id="3350533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3350536">readHosts</span><span class="op" id="3350545">(</span><span class="op" id="3350546">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3350549">if</span>&nbsp;<span class="builtinfunc" id="3350552">len</span><span class="op" id="3350555">(</span><span class="ident" id="3350556">hosts</span><span class="op" id="3350561">.</span><span class="ident" id="3350562">byAddr</span><span class="op" id="3350568">)</span>&nbsp;<span class="op" id="3350570">!=</span>&nbsp;<span class="num" id="3350573">0</span>&nbsp;<span class="op" id="3350575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3350579">if</span>&nbsp;<span class="ident" id="3350582">hosts</span><span class="op" id="3350587">,</span>&nbsp;<span class="ident" id="3350589">ok</span>&nbsp;<span class="op" id="3350592">:=</span>&nbsp;<span class="ident" id="3350595">hosts</span><span class="op" id="3350600">.</span><span class="ident" id="3350601">byAddr</span><span class="op" id="3350607">[</span><span class="ident" id="3350608">addr</span><span class="op" id="3350612">]</span><span class="op" id="3350613">;</span>&nbsp;<span class="ident" id="3350615">ok</span>&nbsp;<span class="op" id="3350618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3350623">return</span>&nbsp;<span class="ident" id="3350630">hosts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3350638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3350641">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3350644">return</span>&nbsp;<span class="ident" id="3350651">nil</span><br>
<span class="lineno"></span><span class="op" id="3350655">}</span>
</div>
</body>
</html>
