<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment">//&nbsp;These&nbsp;examples&nbsp;demonstrate&nbsp;more&nbsp;intricate&nbsp;uses&nbsp;of&nbsp;the&nbsp;flag&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword">package</span>&nbsp;<span class="ident">flag_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">import</span>&nbsp;<span class="op">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Example&nbsp;1:&nbsp;A&nbsp;single&nbsp;string&nbsp;flag&nbsp;called&nbsp;&#34;species&#34;&nbsp;with&nbsp;default&nbsp;value&nbsp;&#34;gopher&#34;.</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">species</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">flag</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="string">&#34;species&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;gopher&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;the&nbsp;species&nbsp;we&nbsp;are&nbsp;studying&#34;</span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Example&nbsp;2:&nbsp;Two&nbsp;flags&nbsp;sharing&nbsp;a&nbsp;variable,&nbsp;so&nbsp;we&nbsp;can&nbsp;have&nbsp;a&nbsp;shorthand.</span><br>
<span class="lineno">20</span><span class="comment">//&nbsp;The&nbsp;order&nbsp;of&nbsp;initialization&nbsp;is&nbsp;undefined,&nbsp;so&nbsp;make&nbsp;sure&nbsp;both&nbsp;use&nbsp;the</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;same&nbsp;default&nbsp;value.&nbsp;They&nbsp;must&nbsp;be&nbsp;set&nbsp;up&nbsp;with&nbsp;an&nbsp;init&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">gopherType</span>&nbsp;<span class="builtintype">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">init</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">const</span>&nbsp;<span class="op">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">defaultGopher</span>&nbsp;<span class="op">=</span>&nbsp;<span class="string">&#34;pocket&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">usage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="string">&#34;the&nbsp;variety&nbsp;of&nbsp;gopher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">flag</span><span class="op">.</span><span class="ident">StringVar</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">gopherType</span><span class="op">,</span>&nbsp;<span class="string">&#34;gopher_type&#34;</span><span class="op">,</span>&nbsp;<span class="ident">defaultGopher</span><span class="op">,</span>&nbsp;<span class="ident">usage</span><span class="op">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">flag</span><span class="op">.</span><span class="ident">StringVar</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">gopherType</span><span class="op">,</span>&nbsp;<span class="string">&#34;g&#34;</span><span class="op">,</span>&nbsp;<span class="ident">defaultGopher</span><span class="op">,</span>&nbsp;<span class="ident">usage</span><span class="op">+</span><span class="string">&#34;&nbsp;(shorthand)&#34;</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Example&nbsp;3:&nbsp;A&nbsp;user-defined&nbsp;flag&nbsp;type,&nbsp;a&nbsp;slice&nbsp;of&nbsp;durations.</span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">interval</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="ident">time</span><span class="op">.</span><span class="ident">Duration</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;String&nbsp;is&nbsp;the&nbsp;method&nbsp;to&nbsp;format&nbsp;the&nbsp;flag&#39;s&nbsp;value,&nbsp;part&nbsp;of&nbsp;the&nbsp;flag.Value&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;The&nbsp;String&nbsp;method&#39;s&nbsp;output&nbsp;will&nbsp;be&nbsp;used&nbsp;in&nbsp;diagnostics.</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">i</span>&nbsp;<span class="op">*</span><span class="ident">interval</span><span class="op">)</span>&nbsp;<span class="ident">String</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="builtintype">string</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">fmt</span><span class="op">.</span><span class="ident">Sprint</span><span class="op">(</span><span class="op">*</span><span class="ident">i</span><span class="op">)</span><br>
<span class="lineno">40</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Set&nbsp;is&nbsp;the&nbsp;method&nbsp;to&nbsp;set&nbsp;the&nbsp;flag&nbsp;value,&nbsp;part&nbsp;of&nbsp;the&nbsp;flag.Value&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Set&#39;s&nbsp;argument&nbsp;is&nbsp;a&nbsp;string&nbsp;to&nbsp;be&nbsp;parsed&nbsp;to&nbsp;set&nbsp;the&nbsp;flag.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;It&#39;s&nbsp;a&nbsp;comma-separated&nbsp;list,&nbsp;so&nbsp;we&nbsp;split&nbsp;it.</span><br>
<span class="lineno">45</span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">i</span>&nbsp;<span class="op">*</span><span class="ident">interval</span><span class="op">)</span>&nbsp;<span class="ident">Set</span><span class="op">(</span><span class="ident">value</span>&nbsp;<span class="builtintype">string</span><span class="op">)</span>&nbsp;<span class="builtintype">error</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;If&nbsp;we&nbsp;wanted&nbsp;to&nbsp;allow&nbsp;the&nbsp;flag&nbsp;to&nbsp;be&nbsp;set&nbsp;multiple&nbsp;times,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;accumulating&nbsp;values,&nbsp;we&nbsp;would&nbsp;delete&nbsp;this&nbsp;if&nbsp;statement.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;That&nbsp;would&nbsp;permit&nbsp;usages&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp-deltaT&nbsp;10s&nbsp;-deltaT&nbsp;15s</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;and&nbsp;other&nbsp;combinations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="op">*</span><span class="ident">i</span><span class="op">)</span>&nbsp;<span class="op">&gt;</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">errors</span><span class="op">.</span><span class="ident">New</span><span class="op">(</span><span class="string">&#34;interval&nbsp;flag&nbsp;already&nbsp;set&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">dt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">strings</span><span class="op">.</span><span class="ident">Split</span><span class="op">(</span><span class="ident">value</span><span class="op">,</span>&nbsp;<span class="string">&#34;,&#34;</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">duration</span><span class="op">,</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">time</span><span class="op">.</span><span class="ident">ParseDuration</span><span class="op">(</span><span class="ident">dt</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">*</span><span class="ident">i</span>&nbsp;<span class="op">=</span>&nbsp;<span class="builtinfunc">append</span><span class="op">(</span><span class="op">*</span><span class="ident">i</span><span class="op">,</span>&nbsp;<span class="ident">duration</span><span class="op">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">nil</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Define&nbsp;a&nbsp;flag&nbsp;to&nbsp;accumulate&nbsp;durations.&nbsp;Because&nbsp;it&nbsp;has&nbsp;a&nbsp;special&nbsp;type,</span><br>
<span class="lineno">65</span><span class="comment">//&nbsp;we&nbsp;need&nbsp;to&nbsp;use&nbsp;the&nbsp;Var&nbsp;function&nbsp;and&nbsp;therefore&nbsp;create&nbsp;the&nbsp;flag&nbsp;during</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;init.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">intervalFlag</span>&nbsp;<span class="ident">interval</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword">func</span>&nbsp;<span class="ident">init</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Tie&nbsp;the&nbsp;command-line&nbsp;flag&nbsp;to&nbsp;the&nbsp;intervalFlag&nbsp;variable&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;set&nbsp;a&nbsp;usage&nbsp;message.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">flag</span><span class="op">.</span><span class="ident">Var</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">intervalFlag</span><span class="op">,</span>&nbsp;<span class="string">&#34;deltaT&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;comma-separated&nbsp;list&nbsp;of&nbsp;intervals&nbsp;to&nbsp;use&nbsp;between&nbsp;events&#34;</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">Example</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;All&nbsp;the&nbsp;interesting&nbsp;pieces&nbsp;are&nbsp;with&nbsp;the&nbsp;variables&nbsp;declared&nbsp;above,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;to&nbsp;enable&nbsp;the&nbsp;flag&nbsp;package&nbsp;to&nbsp;see&nbsp;the&nbsp;flags&nbsp;defined&nbsp;there,&nbsp;one&nbsp;must</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;execute,&nbsp;typically&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;main&nbsp;(not&nbsp;init!):</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;&nbsp;&nbsp;&nbspflag.Parse()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;We&nbsp;don&#39;t&nbsp;run&nbsp;it&nbsp;here&nbsp;because&nbsp;this&nbsp;is&nbsp;not&nbsp;a&nbsp;main&nbsp;function&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;the&nbsp;testing&nbsp;suite&nbsp;has&nbsp;already&nbsp;parsed&nbsp;the&nbsp;flags.</span><br>
<span class="lineno"></span><span class="op">}</span>
</div>
</body>
</html>
