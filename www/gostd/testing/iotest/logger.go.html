<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html" class="current">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5848774">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5848829">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5848883">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5848934">package</span>&nbsp;<span class="ident" id="5848942">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5848950">import</span>&nbsp;<span class="op" id="5848957">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5848960">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5848966">&#34;log&#34;</span><br>
<span class="lineno">10</span><span class="op" id="5848972">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5848975">type</span>&nbsp;<span class="ident" id="5848980">writeLogger</span>&nbsp;<span class="keyword" id="5848992">struct</span>&nbsp;<span class="op" id="5848999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849002">prefix</span>&nbsp;<span class="builtintype" id="5849009">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849017">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5849024">io</span><span class="op" id="5849026">.</span><span class="ident" id="5849027">Writer</span><br>
<span class="lineno">15</span><span class="op" id="5849034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5849037">func</span>&nbsp;<span class="op" id="5849042">(</span><span class="ident" id="5849043">l</span>&nbsp;<span class="op" id="5849045">*</span><span class="ident" id="5849046">writeLogger</span><span class="op" id="5849057">)</span>&nbsp;<span class="ident" id="5849059">Write</span><span class="op" id="5849064">(</span><span class="ident" id="5849065">p</span>&nbsp;<span class="op" id="5849067">[</span><span class="op" id="5849068">]</span><span class="builtintype" id="5849069">byte</span><span class="op" id="5849073">)</span>&nbsp;<span class="op" id="5849075">(</span><span class="ident" id="5849076">n</span>&nbsp;<span class="builtintype" id="5849078">int</span><span class="op" id="5849081">,</span>&nbsp;<span class="ident" id="5849083">err</span>&nbsp;<span class="builtintype" id="5849087">error</span><span class="op" id="5849092">)</span>&nbsp;<span class="op" id="5849094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849097">n</span><span class="op" id="5849098">,</span>&nbsp;<span class="ident" id="5849100">err</span>&nbsp;<span class="op" id="5849104">=</span>&nbsp;<span class="ident" id="5849106">l</span><span class="op" id="5849107">.</span><span class="ident" id="5849108">w</span><span class="op" id="5849109">.</span><span class="ident" id="5849110">Write</span><span class="op" id="5849115">(</span><span class="ident" id="5849116">p</span><span class="op" id="5849117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849120">if</span>&nbsp;<span class="ident" id="5849123">err</span>&nbsp;<span class="op" id="5849127">!=</span>&nbsp;<span class="ident" id="5849130">nil</span>&nbsp;<span class="op" id="5849134">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849138">log</span><span class="op" id="5849141">.</span><span class="ident" id="5849142">Printf</span><span class="op" id="5849148">(</span><span class="string" id="5849149">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="5849160">,</span>&nbsp;<span class="ident" id="5849162">l</span><span class="op" id="5849163">.</span><span class="ident" id="5849164">prefix</span><span class="op" id="5849170">,</span>&nbsp;<span class="ident" id="5849172">p</span><span class="op" id="5849173">[</span><span class="num" id="5849174">0</span><span class="op" id="5849175">:</span><span class="ident" id="5849176">n</span><span class="op" id="5849177">]</span><span class="op" id="5849178">,</span>&nbsp;<span class="ident" id="5849180">err</span><span class="op" id="5849183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849186">}</span>&nbsp;<span class="keyword" id="5849188">else</span>&nbsp;<span class="op" id="5849193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849197">log</span><span class="op" id="5849200">.</span><span class="ident" id="5849201">Printf</span><span class="op" id="5849207">(</span><span class="string" id="5849208">&#34;%s&nbsp;%x&#34;</span><span class="op" id="5849215">,</span>&nbsp;<span class="ident" id="5849217">l</span><span class="op" id="5849218">.</span><span class="ident" id="5849219">prefix</span><span class="op" id="5849225">,</span>&nbsp;<span class="ident" id="5849227">p</span><span class="op" id="5849228">[</span><span class="num" id="5849229">0</span><span class="op" id="5849230">:</span><span class="ident" id="5849231">n</span><span class="op" id="5849232">]</span><span class="op" id="5849233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849239">return</span><br>
<span class="lineno">25</span><span class="op" id="5849246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5849249">//&nbsp;NewWriteLogger&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that&nbsp;behaves&nbsp;like&nbsp;w&nbsp;except</span><br>
<span class="lineno"></span><span class="comment" id="5849311">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Printf)&nbsp;each&nbsp;write&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5849376">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno">30</span><span class="keyword" id="5849433">func</span>&nbsp;<span class="ident" id="5849438">NewWriteLogger</span><span class="op" id="5849452">(</span><span class="ident" id="5849453">prefix</span>&nbsp;<span class="builtintype" id="5849460">string</span><span class="op" id="5849466">,</span>&nbsp;<span class="ident" id="5849468">w</span>&nbsp;<span class="ident" id="5849470">io</span><span class="op" id="5849472">.</span><span class="ident" id="5849473">Writer</span><span class="op" id="5849479">)</span>&nbsp;<span class="ident" id="5849481">io</span><span class="op" id="5849483">.</span><span class="ident" id="5849484">Writer</span>&nbsp;<span class="op" id="5849491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849494">return</span>&nbsp;<span class="op" id="5849501">&amp;</span><span class="ident" id="5849502">writeLogger</span><span class="op" id="5849513">{</span><span class="ident" id="5849514">prefix</span><span class="op" id="5849520">,</span>&nbsp;<span class="ident" id="5849522">w</span><span class="op" id="5849523">}</span><br>
<span class="lineno"></span><span class="op" id="5849525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5849528">type</span>&nbsp;<span class="ident" id="5849533">readLogger</span>&nbsp;<span class="keyword" id="5849544">struct</span>&nbsp;<span class="op" id="5849551">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849554">prefix</span>&nbsp;<span class="builtintype" id="5849561">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849569">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5849576">io</span><span class="op" id="5849578">.</span><span class="ident" id="5849579">Reader</span><br>
<span class="lineno"></span><span class="op" id="5849586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5849589">func</span>&nbsp;<span class="op" id="5849594">(</span><span class="ident" id="5849595">l</span>&nbsp;<span class="op" id="5849597">*</span><span class="ident" id="5849598">readLogger</span><span class="op" id="5849608">)</span>&nbsp;<span class="ident" id="5849610">Read</span><span class="op" id="5849614">(</span><span class="ident" id="5849615">p</span>&nbsp;<span class="op" id="5849617">[</span><span class="op" id="5849618">]</span><span class="builtintype" id="5849619">byte</span><span class="op" id="5849623">)</span>&nbsp;<span class="op" id="5849625">(</span><span class="ident" id="5849626">n</span>&nbsp;<span class="builtintype" id="5849628">int</span><span class="op" id="5849631">,</span>&nbsp;<span class="ident" id="5849633">err</span>&nbsp;<span class="builtintype" id="5849637">error</span><span class="op" id="5849642">)</span>&nbsp;<span class="op" id="5849644">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849647">n</span><span class="op" id="5849648">,</span>&nbsp;<span class="ident" id="5849650">err</span>&nbsp;<span class="op" id="5849654">=</span>&nbsp;<span class="ident" id="5849656">l</span><span class="op" id="5849657">.</span><span class="ident" id="5849658">r</span><span class="op" id="5849659">.</span><span class="ident" id="5849660">Read</span><span class="op" id="5849664">(</span><span class="ident" id="5849665">p</span><span class="op" id="5849666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849669">if</span>&nbsp;<span class="ident" id="5849672">err</span>&nbsp;<span class="op" id="5849676">!=</span>&nbsp;<span class="ident" id="5849679">nil</span>&nbsp;<span class="op" id="5849683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849687">log</span><span class="op" id="5849690">.</span><span class="ident" id="5849691">Printf</span><span class="op" id="5849697">(</span><span class="string" id="5849698">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="5849709">,</span>&nbsp;<span class="ident" id="5849711">l</span><span class="op" id="5849712">.</span><span class="ident" id="5849713">prefix</span><span class="op" id="5849719">,</span>&nbsp;<span class="ident" id="5849721">p</span><span class="op" id="5849722">[</span><span class="num" id="5849723">0</span><span class="op" id="5849724">:</span><span class="ident" id="5849725">n</span><span class="op" id="5849726">]</span><span class="op" id="5849727">,</span>&nbsp;<span class="ident" id="5849729">err</span><span class="op" id="5849732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849735">}</span>&nbsp;<span class="keyword" id="5849737">else</span>&nbsp;<span class="op" id="5849742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849746">log</span><span class="op" id="5849749">.</span><span class="ident" id="5849750">Printf</span><span class="op" id="5849756">(</span><span class="string" id="5849757">&#34;%s&nbsp;%x&#34;</span><span class="op" id="5849764">,</span>&nbsp;<span class="ident" id="5849766">l</span><span class="op" id="5849767">.</span><span class="ident" id="5849768">prefix</span><span class="op" id="5849774">,</span>&nbsp;<span class="ident" id="5849776">p</span><span class="op" id="5849777">[</span><span class="num" id="5849778">0</span><span class="op" id="5849779">:</span><span class="ident" id="5849780">n</span><span class="op" id="5849781">]</span><span class="op" id="5849782">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849788">return</span><br>
<span class="lineno"></span><span class="op" id="5849795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5849798">//&nbsp;NewReadLogger&nbsp;returns&nbsp;a&nbsp;reader&nbsp;that&nbsp;behaves&nbsp;like&nbsp;r&nbsp;except</span><br>
<span class="lineno">50</span><span class="comment" id="5849859">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Print)&nbsp;each&nbsp;read&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5849922">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno"></span><span class="keyword" id="5849979">func</span>&nbsp;<span class="ident" id="5849984">NewReadLogger</span><span class="op" id="5849997">(</span><span class="ident" id="5849998">prefix</span>&nbsp;<span class="builtintype" id="5850005">string</span><span class="op" id="5850011">,</span>&nbsp;<span class="ident" id="5850013">r</span>&nbsp;<span class="ident" id="5850015">io</span><span class="op" id="5850017">.</span><span class="ident" id="5850018">Reader</span><span class="op" id="5850024">)</span>&nbsp;<span class="ident" id="5850026">io</span><span class="op" id="5850028">.</span><span class="ident" id="5850029">Reader</span>&nbsp;<span class="op" id="5850036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5850039">return</span>&nbsp;<span class="op" id="5850046">&amp;</span><span class="ident" id="5850047">readLogger</span><span class="op" id="5850057">{</span><span class="ident" id="5850058">prefix</span><span class="op" id="5850064">,</span>&nbsp;<span class="ident" id="5850066">r</span><span class="op" id="5850067">}</span><br>
<span class="lineno"></span><span class="op" id="5850069">}</span>
</div>
</body>
</html>
