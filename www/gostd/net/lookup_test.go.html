<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html" class="current">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6655223">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6655278">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6655332">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6655383">//&nbsp;TODO&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;use&nbsp;a&nbsp;mock&nbsp;DNS&nbsp;server,&nbsp;to&nbsp;eliminate</span><br>
<span class="lineno"></span><span class="comment" id="6655447">//&nbsp;external&nbsp;dependencies.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6655474">package</span>&nbsp;<span class="ident" id="6655482">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="6655487">import</span>&nbsp;<span class="op" id="6655494">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6655497">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6655505">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6655516">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6655526">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6655529">var</span>&nbsp;<span class="ident" id="6655533">testExternal</span>&nbsp;<span class="op" id="6655546">=</span>&nbsp;<span class="ident" id="6655548">flag</span><span class="op" id="6655552">.</span><span class="ident" id="6655553">Bool</span><span class="op" id="6655557">(</span><span class="string" id="6655558">&#34;external&#34;</span><span class="op" id="6655568">,</span>&nbsp;<span class="builtintype" id="6655570">true</span><span class="op" id="6655574">,</span>&nbsp;<span class="string" id="6655576">&#34;allow&nbsp;use&nbsp;of&nbsp;external&nbsp;networks&nbsp;during&nbsp;long&nbsp;test&#34;</span><span class="op" id="6655625">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6655628">var</span>&nbsp;<span class="ident" id="6655632">lookupGoogleSRVTests</span>&nbsp;<span class="op" id="6655653">=</span>&nbsp;<span class="op" id="6655655">[</span><span class="op" id="6655656">]</span><span class="keyword" id="6655657">struct</span>&nbsp;<span class="op" id="6655664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655667">service</span><span class="op" id="6655674">,</span>&nbsp;<span class="ident" id="6655676">proto</span><span class="op" id="6655681">,</span>&nbsp;<span class="ident" id="6655683">name</span>&nbsp;<span class="builtintype" id="6655688">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655696">cname</span><span class="op" id="6655701">,</span>&nbsp;<span class="ident" id="6655703">target</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6655717">string</span><br>
<span class="lineno"></span><span class="op" id="6655724">}</span><span class="op" id="6655725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6655732">&#34;xmpp-server&#34;</span><span class="op" id="6655745">,</span>&nbsp;<span class="string" id="6655747">&#34;tcp&#34;</span><span class="op" id="6655752">,</span>&nbsp;<span class="string" id="6655754">&#34;google.com&#34;</span><span class="op" id="6655766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6655770">&#34;.google.com&#34;</span><span class="op" id="6655783">,</span>&nbsp;<span class="string" id="6655785">&#34;.google.com&#34;</span><span class="op" id="6655798">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655801">}</span><span class="op" id="6655802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6655809">&#34;&#34;</span><span class="op" id="6655811">,</span>&nbsp;<span class="string" id="6655813">&#34;&#34;</span><span class="op" id="6655815">,</span>&nbsp;<span class="string" id="6655817">&#34;_xmpp-server._tcp.google.com&#34;</span><span class="op" id="6655847">,</span>&nbsp;<span class="comment" id="6655849">//&nbsp;non-standard&nbsp;back&nbsp;door</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6655877">&#34;.google.com&#34;</span><span class="op" id="6655890">,</span>&nbsp;<span class="string" id="6655892">&#34;.google.com&#34;</span><span class="op" id="6655905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655908">}</span><span class="op" id="6655909">,</span><br>
<span class="lineno">30</span><span class="op" id="6655911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6655914">func</span>&nbsp;<span class="ident" id="6655919">TestLookupGoogleSRV</span><span class="op" id="6655938">(</span><span class="ident" id="6655939">t</span>&nbsp;<span class="op" id="6655941">*</span><span class="ident" id="6655942">testing</span><span class="op" id="6655949">.</span><span class="ident" id="6655950">T</span><span class="op" id="6655951">)</span>&nbsp;<span class="op" id="6655953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655956">if</span>&nbsp;<span class="ident" id="6655959">testing</span><span class="op" id="6655966">.</span><span class="ident" id="6655967">Short</span><span class="op" id="6655972">(</span><span class="op" id="6655973">)</span>&nbsp;<span class="op" id="6655975">||</span>&nbsp;<span class="op" id="6655978">!</span><span class="op" id="6655979">*</span><span class="ident" id="6655980">testExternal</span>&nbsp;<span class="op" id="6655993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655997">t</span><span class="op" id="6655998">.</span><span class="ident" id="6655999">Skip</span><span class="op" id="6656003">(</span><span class="string" id="6656004">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6656045">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656052">for</span>&nbsp;<span class="ident" id="6656056">_</span><span class="op" id="6656057">,</span>&nbsp;<span class="ident" id="6656059">tt</span>&nbsp;<span class="op" id="6656062">:=</span>&nbsp;<span class="keyword" id="6656065">range</span>&nbsp;<span class="ident" id="6656071">lookupGoogleSRVTests</span>&nbsp;<span class="op" id="6656092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656096">cname</span><span class="op" id="6656101">,</span>&nbsp;<span class="ident" id="6656103">srvs</span><span class="op" id="6656107">,</span>&nbsp;<span class="ident" id="6656109">err</span>&nbsp;<span class="op" id="6656113">:=</span>&nbsp;<span class="ident" id="6656116">LookupSRV</span><span class="op" id="6656125">(</span><span class="ident" id="6656126">tt</span><span class="op" id="6656128">.</span><span class="ident" id="6656129">service</span><span class="op" id="6656136">,</span>&nbsp;<span class="ident" id="6656138">tt</span><span class="op" id="6656140">.</span><span class="ident" id="6656141">proto</span><span class="op" id="6656146">,</span>&nbsp;<span class="ident" id="6656148">tt</span><span class="op" id="6656150">.</span><span class="ident" id="6656151">name</span><span class="op" id="6656155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656159">if</span>&nbsp;<span class="ident" id="6656162">err</span>&nbsp;<span class="op" id="6656166">!=</span>&nbsp;<span class="ident" id="6656169">nil</span>&nbsp;<span class="op" id="6656173">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656178">t</span><span class="op" id="6656179">.</span><span class="ident" id="6656180">Fatal</span><span class="op" id="6656185">(</span><span class="ident" id="6656186">err</span><span class="op" id="6656189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656197">if</span>&nbsp;<span class="builtinfunc" id="6656200">len</span><span class="op" id="6656203">(</span><span class="ident" id="6656204">srvs</span><span class="op" id="6656208">)</span>&nbsp;<span class="op" id="6656210">==</span>&nbsp;<span class="num" id="6656213">0</span>&nbsp;<span class="op" id="6656215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656220">t</span><span class="op" id="6656221">.</span><span class="ident" id="6656222">Error</span><span class="op" id="6656227">(</span><span class="string" id="6656228">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6656243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656247">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656251">if</span>&nbsp;<span class="op" id="6656254">!</span><span class="ident" id="6656255">strings</span><span class="op" id="6656262">.</span><span class="ident" id="6656263">Contains</span><span class="op" id="6656271">(</span><span class="ident" id="6656272">cname</span><span class="op" id="6656277">,</span>&nbsp;<span class="ident" id="6656279">tt</span><span class="op" id="6656281">.</span><span class="ident" id="6656282">cname</span><span class="op" id="6656287">)</span>&nbsp;<span class="op" id="6656289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656294">t</span><span class="op" id="6656295">.</span><span class="ident" id="6656296">Errorf</span><span class="op" id="6656302">(</span><span class="string" id="6656303">&#34;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6656320">,</span>&nbsp;<span class="ident" id="6656322">cname</span><span class="op" id="6656327">,</span>&nbsp;<span class="ident" id="6656329">tt</span><span class="op" id="6656331">.</span><span class="ident" id="6656332">cname</span><span class="op" id="6656337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656345">for</span>&nbsp;<span class="ident" id="6656349">_</span><span class="op" id="6656350">,</span>&nbsp;<span class="ident" id="6656352">srv</span>&nbsp;<span class="op" id="6656356">:=</span>&nbsp;<span class="keyword" id="6656359">range</span>&nbsp;<span class="ident" id="6656365">srvs</span>&nbsp;<span class="op" id="6656370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656375">if</span>&nbsp;<span class="op" id="6656378">!</span><span class="ident" id="6656379">strings</span><span class="op" id="6656386">.</span><span class="ident" id="6656387">Contains</span><span class="op" id="6656395">(</span><span class="ident" id="6656396">srv</span><span class="op" id="6656399">.</span><span class="ident" id="6656400">Target</span><span class="op" id="6656406">,</span>&nbsp;<span class="ident" id="6656408">tt</span><span class="op" id="6656410">.</span><span class="ident" id="6656411">target</span><span class="op" id="6656417">)</span>&nbsp;<span class="op" id="6656419">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656425">t</span><span class="op" id="6656426">.</span><span class="ident" id="6656427">Errorf</span><span class="op" id="6656433">(</span><span class="string" id="6656434">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;%q&#34;</span><span class="op" id="6656471">,</span>&nbsp;<span class="ident" id="6656473">srv</span><span class="op" id="6656476">,</span>&nbsp;<span class="ident" id="6656478">tt</span><span class="op" id="6656480">.</span><span class="ident" id="6656481">target</span><span class="op" id="6656487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656499">}</span><br>
<span class="lineno"></span><span class="op" id="6656501">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="6656504">func</span>&nbsp;<span class="ident" id="6656509">TestLookupGmailMX</span><span class="op" id="6656526">(</span><span class="ident" id="6656527">t</span>&nbsp;<span class="op" id="6656529">*</span><span class="ident" id="6656530">testing</span><span class="op" id="6656537">.</span><span class="ident" id="6656538">T</span><span class="op" id="6656539">)</span>&nbsp;<span class="op" id="6656541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656544">if</span>&nbsp;<span class="ident" id="6656547">testing</span><span class="op" id="6656554">.</span><span class="ident" id="6656555">Short</span><span class="op" id="6656560">(</span><span class="op" id="6656561">)</span>&nbsp;<span class="op" id="6656563">||</span>&nbsp;<span class="op" id="6656566">!</span><span class="op" id="6656567">*</span><span class="ident" id="6656568">testExternal</span>&nbsp;<span class="op" id="6656581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656585">t</span><span class="op" id="6656586">.</span><span class="ident" id="6656587">Skip</span><span class="op" id="6656591">(</span><span class="string" id="6656592">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6656633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656636">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656640">mxs</span><span class="op" id="6656643">,</span>&nbsp;<span class="ident" id="6656645">err</span>&nbsp;<span class="op" id="6656649">:=</span>&nbsp;<span class="ident" id="6656652">LookupMX</span><span class="op" id="6656660">(</span><span class="string" id="6656661">&#34;gmail.com&#34;</span><span class="op" id="6656672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656675">if</span>&nbsp;<span class="ident" id="6656678">err</span>&nbsp;<span class="op" id="6656682">!=</span>&nbsp;<span class="ident" id="6656685">nil</span>&nbsp;<span class="op" id="6656689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656693">t</span><span class="op" id="6656694">.</span><span class="ident" id="6656695">Fatal</span><span class="op" id="6656700">(</span><span class="ident" id="6656701">err</span><span class="op" id="6656704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656707">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656710">if</span>&nbsp;<span class="builtinfunc" id="6656713">len</span><span class="op" id="6656716">(</span><span class="ident" id="6656717">mxs</span><span class="op" id="6656720">)</span>&nbsp;<span class="op" id="6656722">==</span>&nbsp;<span class="num" id="6656725">0</span>&nbsp;<span class="op" id="6656727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656731">t</span><span class="op" id="6656732">.</span><span class="ident" id="6656733">Error</span><span class="op" id="6656738">(</span><span class="string" id="6656739">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6656754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656760">for</span>&nbsp;<span class="ident" id="6656764">_</span><span class="op" id="6656765">,</span>&nbsp;<span class="ident" id="6656767">mx</span>&nbsp;<span class="op" id="6656770">:=</span>&nbsp;<span class="keyword" id="6656773">range</span>&nbsp;<span class="ident" id="6656779">mxs</span>&nbsp;<span class="op" id="6656783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656787">if</span>&nbsp;<span class="op" id="6656790">!</span><span class="ident" id="6656791">strings</span><span class="op" id="6656798">.</span><span class="ident" id="6656799">Contains</span><span class="op" id="6656807">(</span><span class="ident" id="6656808">mx</span><span class="op" id="6656810">.</span><span class="ident" id="6656811">Host</span><span class="op" id="6656815">,</span>&nbsp;<span class="string" id="6656817">&#34;.google.com&#34;</span><span class="op" id="6656830">)</span>&nbsp;<span class="op" id="6656832">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656837">t</span><span class="op" id="6656838">.</span><span class="ident" id="6656839">Errorf</span><span class="op" id="6656845">(</span><span class="string" id="6656846">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.google.com.&#34;</span><span class="op" id="6656893">,</span>&nbsp;<span class="ident" id="6656895">mx</span><span class="op" id="6656897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656904">}</span><br>
<span class="lineno"></span><span class="op" id="6656906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="6656909">func</span>&nbsp;<span class="ident" id="6656914">TestLookupGmailNS</span><span class="op" id="6656931">(</span><span class="ident" id="6656932">t</span>&nbsp;<span class="op" id="6656934">*</span><span class="ident" id="6656935">testing</span><span class="op" id="6656942">.</span><span class="ident" id="6656943">T</span><span class="op" id="6656944">)</span>&nbsp;<span class="op" id="6656946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656949">if</span>&nbsp;<span class="ident" id="6656952">testing</span><span class="op" id="6656959">.</span><span class="ident" id="6656960">Short</span><span class="op" id="6656965">(</span><span class="op" id="6656966">)</span>&nbsp;<span class="op" id="6656968">||</span>&nbsp;<span class="op" id="6656971">!</span><span class="op" id="6656972">*</span><span class="ident" id="6656973">testExternal</span>&nbsp;<span class="op" id="6656986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656990">t</span><span class="op" id="6656991">.</span><span class="ident" id="6656992">Skip</span><span class="op" id="6656996">(</span><span class="string" id="6656997">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6657038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657045">nss</span><span class="op" id="6657048">,</span>&nbsp;<span class="ident" id="6657050">err</span>&nbsp;<span class="op" id="6657054">:=</span>&nbsp;<span class="ident" id="6657057">LookupNS</span><span class="op" id="6657065">(</span><span class="string" id="6657066">&#34;gmail.com&#34;</span><span class="op" id="6657077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657080">if</span>&nbsp;<span class="ident" id="6657083">err</span>&nbsp;<span class="op" id="6657087">!=</span>&nbsp;<span class="ident" id="6657090">nil</span>&nbsp;<span class="op" id="6657094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657098">t</span><span class="op" id="6657099">.</span><span class="ident" id="6657100">Fatal</span><span class="op" id="6657105">(</span><span class="ident" id="6657106">err</span><span class="op" id="6657109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657115">if</span>&nbsp;<span class="builtinfunc" id="6657118">len</span><span class="op" id="6657121">(</span><span class="ident" id="6657122">nss</span><span class="op" id="6657125">)</span>&nbsp;<span class="op" id="6657127">==</span>&nbsp;<span class="num" id="6657130">0</span>&nbsp;<span class="op" id="6657132">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657136">t</span><span class="op" id="6657137">.</span><span class="ident" id="6657138">Error</span><span class="op" id="6657143">(</span><span class="string" id="6657144">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6657159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657165">for</span>&nbsp;<span class="ident" id="6657169">_</span><span class="op" id="6657170">,</span>&nbsp;<span class="ident" id="6657172">ns</span>&nbsp;<span class="op" id="6657175">:=</span>&nbsp;<span class="keyword" id="6657178">range</span>&nbsp;<span class="ident" id="6657184">nss</span>&nbsp;<span class="op" id="6657188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657192">if</span>&nbsp;<span class="op" id="6657195">!</span><span class="ident" id="6657196">strings</span><span class="op" id="6657203">.</span><span class="ident" id="6657204">Contains</span><span class="op" id="6657212">(</span><span class="ident" id="6657213">ns</span><span class="op" id="6657215">.</span><span class="ident" id="6657216">Host</span><span class="op" id="6657220">,</span>&nbsp;<span class="string" id="6657222">&#34;.google.com&#34;</span><span class="op" id="6657235">)</span>&nbsp;<span class="op" id="6657237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657242">t</span><span class="op" id="6657243">.</span><span class="ident" id="6657244">Errorf</span><span class="op" id="6657250">(</span><span class="string" id="6657251">&#34;got&nbsp;%v;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.google.com.&#34;</span><span class="op" id="6657298">,</span>&nbsp;<span class="ident" id="6657300">ns</span><span class="op" id="6657302">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657309">}</span><br>
<span class="lineno"></span><span class="op" id="6657311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6657314">func</span>&nbsp;<span class="ident" id="6657319">TestLookupGmailTXT</span><span class="op" id="6657337">(</span><span class="ident" id="6657338">t</span>&nbsp;<span class="op" id="6657340">*</span><span class="ident" id="6657341">testing</span><span class="op" id="6657348">.</span><span class="ident" id="6657349">T</span><span class="op" id="6657350">)</span>&nbsp;<span class="op" id="6657352">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657355">if</span>&nbsp;<span class="ident" id="6657358">testing</span><span class="op" id="6657365">.</span><span class="ident" id="6657366">Short</span><span class="op" id="6657371">(</span><span class="op" id="6657372">)</span>&nbsp;<span class="op" id="6657374">||</span>&nbsp;<span class="op" id="6657377">!</span><span class="op" id="6657378">*</span><span class="ident" id="6657379">testExternal</span>&nbsp;<span class="op" id="6657392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657396">t</span><span class="op" id="6657397">.</span><span class="ident" id="6657398">Skip</span><span class="op" id="6657402">(</span><span class="string" id="6657403">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6657444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657451">txts</span><span class="op" id="6657455">,</span>&nbsp;<span class="ident" id="6657457">err</span>&nbsp;<span class="op" id="6657461">:=</span>&nbsp;<span class="ident" id="6657464">LookupTXT</span><span class="op" id="6657473">(</span><span class="string" id="6657474">&#34;gmail.com&#34;</span><span class="op" id="6657485">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657488">if</span>&nbsp;<span class="ident" id="6657491">err</span>&nbsp;<span class="op" id="6657495">!=</span>&nbsp;<span class="ident" id="6657498">nil</span>&nbsp;<span class="op" id="6657502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657506">t</span><span class="op" id="6657507">.</span><span class="ident" id="6657508">Fatal</span><span class="op" id="6657513">(</span><span class="ident" id="6657514">err</span><span class="op" id="6657517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657523">if</span>&nbsp;<span class="builtinfunc" id="6657526">len</span><span class="op" id="6657529">(</span><span class="ident" id="6657530">txts</span><span class="op" id="6657534">)</span>&nbsp;<span class="op" id="6657536">==</span>&nbsp;<span class="num" id="6657539">0</span>&nbsp;<span class="op" id="6657541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657545">t</span><span class="op" id="6657546">.</span><span class="ident" id="6657547">Error</span><span class="op" id="6657552">(</span><span class="string" id="6657553">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6657568">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657574">for</span>&nbsp;<span class="ident" id="6657578">_</span><span class="op" id="6657579">,</span>&nbsp;<span class="ident" id="6657581">txt</span>&nbsp;<span class="op" id="6657585">:=</span>&nbsp;<span class="keyword" id="6657588">range</span>&nbsp;<span class="ident" id="6657594">txts</span>&nbsp;<span class="op" id="6657599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657603">if</span>&nbsp;<span class="op" id="6657606">!</span><span class="ident" id="6657607">strings</span><span class="op" id="6657614">.</span><span class="ident" id="6657615">Contains</span><span class="op" id="6657623">(</span><span class="ident" id="6657624">txt</span><span class="op" id="6657627">,</span>&nbsp;<span class="string" id="6657629">&#34;spf&#34;</span><span class="op" id="6657634">)</span>&nbsp;<span class="op" id="6657636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657641">t</span><span class="op" id="6657642">.</span><span class="ident" id="6657643">Errorf</span><span class="op" id="6657649">(</span><span class="string" id="6657650">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;spf&nbsp;record&#34;</span><span class="op" id="6657677">,</span>&nbsp;<span class="ident" id="6657679">txt</span><span class="op" id="6657682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657686">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657689">}</span><br>
<span class="lineno"></span><span class="op" id="6657691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6657694">var</span>&nbsp;<span class="ident" id="6657698">lookupGooglePublicDNSAddrs</span>&nbsp;<span class="op" id="6657725">=</span>&nbsp;<span class="op" id="6657727">[</span><span class="op" id="6657728">]</span><span class="keyword" id="6657729">struct</span>&nbsp;<span class="op" id="6657736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657739">addr</span>&nbsp;<span class="builtintype" id="6657744">string</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6657752">name</span>&nbsp;<span class="builtintype" id="6657757">string</span><br>
<span class="lineno"></span><span class="op" id="6657764">}</span><span class="op" id="6657765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657768">{</span><span class="string" id="6657769">&#34;8.8.8.8&#34;</span><span class="op" id="6657778">,</span>&nbsp;<span class="string" id="6657780">&#34;.google.com.&#34;</span><span class="op" id="6657794">}</span><span class="op" id="6657795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657798">{</span><span class="string" id="6657799">&#34;8.8.4.4&#34;</span><span class="op" id="6657808">,</span>&nbsp;<span class="string" id="6657810">&#34;.google.com.&#34;</span><span class="op" id="6657824">}</span><span class="op" id="6657825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657828">{</span><span class="string" id="6657829">&#34;2001:4860:4860::8888&#34;</span><span class="op" id="6657851">,</span>&nbsp;<span class="string" id="6657853">&#34;.google.com.&#34;</span><span class="op" id="6657867">}</span><span class="op" id="6657868">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6657871">{</span><span class="string" id="6657872">&#34;2001:4860:4860::8844&#34;</span><span class="op" id="6657894">,</span>&nbsp;<span class="string" id="6657896">&#34;.google.com.&#34;</span><span class="op" id="6657910">}</span><span class="op" id="6657911">,</span><br>
<span class="lineno"></span><span class="op" id="6657913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6657916">func</span>&nbsp;<span class="ident" id="6657921">TestLookupGooglePublicDNSAddr</span><span class="op" id="6657950">(</span><span class="ident" id="6657951">t</span>&nbsp;<span class="op" id="6657953">*</span><span class="ident" id="6657954">testing</span><span class="op" id="6657961">.</span><span class="ident" id="6657962">T</span><span class="op" id="6657963">)</span>&nbsp;<span class="op" id="6657965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6657968">if</span>&nbsp;<span class="ident" id="6657971">testing</span><span class="op" id="6657978">.</span><span class="ident" id="6657979">Short</span><span class="op" id="6657984">(</span><span class="op" id="6657985">)</span>&nbsp;<span class="op" id="6657987">||</span>&nbsp;<span class="op" id="6657990">!</span><span class="op" id="6657991">*</span><span class="ident" id="6657992">testExternal</span>&nbsp;<span class="op" id="6658005">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658009">t</span><span class="op" id="6658010">.</span><span class="ident" id="6658011">Skip</span><span class="op" id="6658015">(</span><span class="string" id="6658016">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6658057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658064">for</span>&nbsp;<span class="ident" id="6658068">_</span><span class="op" id="6658069">,</span>&nbsp;<span class="ident" id="6658071">tt</span>&nbsp;<span class="op" id="6658074">:=</span>&nbsp;<span class="keyword" id="6658077">range</span>&nbsp;<span class="ident" id="6658083">lookupGooglePublicDNSAddrs</span>&nbsp;<span class="op" id="6658110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658114">names</span><span class="op" id="6658119">,</span>&nbsp;<span class="ident" id="6658121">err</span>&nbsp;<span class="op" id="6658125">:=</span>&nbsp;<span class="ident" id="6658128">LookupAddr</span><span class="op" id="6658138">(</span><span class="ident" id="6658139">tt</span><span class="op" id="6658141">.</span><span class="ident" id="6658142">addr</span><span class="op" id="6658146">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658150">if</span>&nbsp;<span class="ident" id="6658153">err</span>&nbsp;<span class="op" id="6658157">!=</span>&nbsp;<span class="ident" id="6658160">nil</span>&nbsp;<span class="op" id="6658164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658169">t</span><span class="op" id="6658170">.</span><span class="ident" id="6658171">Fatal</span><span class="op" id="6658176">(</span><span class="ident" id="6658177">err</span><span class="op" id="6658180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658184">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658188">if</span>&nbsp;<span class="builtinfunc" id="6658191">len</span><span class="op" id="6658194">(</span><span class="ident" id="6658195">names</span><span class="op" id="6658200">)</span>&nbsp;<span class="op" id="6658202">==</span>&nbsp;<span class="num" id="6658205">0</span>&nbsp;<span class="op" id="6658207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658212">t</span><span class="op" id="6658213">.</span><span class="ident" id="6658214">Error</span><span class="op" id="6658219">(</span><span class="string" id="6658220">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6658235">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658243">for</span>&nbsp;<span class="ident" id="6658247">_</span><span class="op" id="6658248">,</span>&nbsp;<span class="ident" id="6658250">name</span>&nbsp;<span class="op" id="6658255">:=</span>&nbsp;<span class="keyword" id="6658258">range</span>&nbsp;<span class="ident" id="6658264">names</span>&nbsp;<span class="op" id="6658270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658275">if</span>&nbsp;<span class="op" id="6658278">!</span><span class="ident" id="6658279">strings</span><span class="op" id="6658286">.</span><span class="ident" id="6658287">HasSuffix</span><span class="op" id="6658296">(</span><span class="ident" id="6658297">name</span><span class="op" id="6658301">,</span>&nbsp;<span class="ident" id="6658303">tt</span><span class="op" id="6658305">.</span><span class="ident" id="6658306">name</span><span class="op" id="6658310">)</span>&nbsp;<span class="op" id="6658312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658318">t</span><span class="op" id="6658319">.</span><span class="ident" id="6658320">Errorf</span><span class="op" id="6658326">(</span><span class="string" id="6658327">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;%q&#34;</span><span class="op" id="6658364">,</span>&nbsp;<span class="ident" id="6658366">name</span><span class="op" id="6658370">,</span>&nbsp;<span class="ident" id="6658372">tt</span><span class="op" id="6658374">.</span><span class="ident" id="6658375">name</span><span class="op" id="6658379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658384">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658391">}</span><br>
<span class="lineno"></span><span class="op" id="6658393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6658396">func</span>&nbsp;<span class="ident" id="6658401">TestLookupIANACNAME</span><span class="op" id="6658420">(</span><span class="ident" id="6658421">t</span>&nbsp;<span class="op" id="6658423">*</span><span class="ident" id="6658424">testing</span><span class="op" id="6658431">.</span><span class="ident" id="6658432">T</span><span class="op" id="6658433">)</span>&nbsp;<span class="op" id="6658435">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658438">if</span>&nbsp;<span class="ident" id="6658441">testing</span><span class="op" id="6658448">.</span><span class="ident" id="6658449">Short</span><span class="op" id="6658454">(</span><span class="op" id="6658455">)</span>&nbsp;<span class="op" id="6658457">||</span>&nbsp;<span class="op" id="6658460">!</span><span class="op" id="6658461">*</span><span class="ident" id="6658462">testExternal</span>&nbsp;<span class="op" id="6658475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658479">t</span><span class="op" id="6658480">.</span><span class="ident" id="6658481">Skip</span><span class="op" id="6658485">(</span><span class="string" id="6658486">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6658527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658534">cname</span><span class="op" id="6658539">,</span>&nbsp;<span class="ident" id="6658541">err</span>&nbsp;<span class="op" id="6658545">:=</span>&nbsp;<span class="ident" id="6658548">LookupCNAME</span><span class="op" id="6658559">(</span><span class="string" id="6658560">&#34;www.iana.org&#34;</span><span class="op" id="6658574">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658577">if</span>&nbsp;<span class="ident" id="6658580">err</span>&nbsp;<span class="op" id="6658584">!=</span>&nbsp;<span class="ident" id="6658587">nil</span>&nbsp;<span class="op" id="6658591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658595">t</span><span class="op" id="6658596">.</span><span class="ident" id="6658597">Fatal</span><span class="op" id="6658602">(</span><span class="ident" id="6658603">err</span><span class="op" id="6658606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658612">if</span>&nbsp;<span class="op" id="6658615">!</span><span class="ident" id="6658616">strings</span><span class="op" id="6658623">.</span><span class="ident" id="6658624">HasSuffix</span><span class="op" id="6658633">(</span><span class="ident" id="6658634">cname</span><span class="op" id="6658639">,</span>&nbsp;<span class="string" id="6658641">&#34;.icann.org.&#34;</span><span class="op" id="6658654">)</span>&nbsp;<span class="op" id="6658656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658660">t</span><span class="op" id="6658661">.</span><span class="ident" id="6658662">Errorf</span><span class="op" id="6658668">(</span><span class="string" id="6658669">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;record&nbsp;containing&nbsp;.icann.org.&#34;</span><span class="op" id="6658715">,</span>&nbsp;<span class="ident" id="6658717">cname</span><span class="op" id="6658722">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658725">}</span><br>
<span class="lineno"></span><span class="op" id="6658727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6658730">func</span>&nbsp;<span class="ident" id="6658735">TestLookupGoogleHost</span><span class="op" id="6658755">(</span><span class="ident" id="6658756">t</span>&nbsp;<span class="op" id="6658758">*</span><span class="ident" id="6658759">testing</span><span class="op" id="6658766">.</span><span class="ident" id="6658767">T</span><span class="op" id="6658768">)</span>&nbsp;<span class="op" id="6658770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658773">if</span>&nbsp;<span class="ident" id="6658776">testing</span><span class="op" id="6658783">.</span><span class="ident" id="6658784">Short</span><span class="op" id="6658789">(</span><span class="op" id="6658790">)</span>&nbsp;<span class="op" id="6658792">||</span>&nbsp;<span class="op" id="6658795">!</span><span class="op" id="6658796">*</span><span class="ident" id="6658797">testExternal</span>&nbsp;<span class="op" id="6658810">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658814">t</span><span class="op" id="6658815">.</span><span class="ident" id="6658816">Skip</span><span class="op" id="6658820">(</span><span class="string" id="6658821">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6658862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658869">addrs</span><span class="op" id="6658874">,</span>&nbsp;<span class="ident" id="6658876">err</span>&nbsp;<span class="op" id="6658880">:=</span>&nbsp;<span class="ident" id="6658883">LookupHost</span><span class="op" id="6658893">(</span><span class="string" id="6658894">&#34;google.com&#34;</span><span class="op" id="6658906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658909">if</span>&nbsp;<span class="ident" id="6658912">err</span>&nbsp;<span class="op" id="6658916">!=</span>&nbsp;<span class="ident" id="6658919">nil</span>&nbsp;<span class="op" id="6658923">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658927">t</span><span class="op" id="6658928">.</span><span class="ident" id="6658929">Fatal</span><span class="op" id="6658934">(</span><span class="ident" id="6658935">err</span><span class="op" id="6658938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658944">if</span>&nbsp;<span class="builtinfunc" id="6658947">len</span><span class="op" id="6658950">(</span><span class="ident" id="6658951">addrs</span><span class="op" id="6658956">)</span>&nbsp;<span class="op" id="6658958">==</span>&nbsp;<span class="num" id="6658961">0</span>&nbsp;<span class="op" id="6658963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6658967">t</span><span class="op" id="6658968">.</span><span class="ident" id="6658969">Error</span><span class="op" id="6658974">(</span><span class="string" id="6658975">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6658990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6658993">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6658996">for</span>&nbsp;<span class="ident" id="6659000">_</span><span class="op" id="6659001">,</span>&nbsp;<span class="ident" id="6659003">addr</span>&nbsp;<span class="op" id="6659008">:=</span>&nbsp;<span class="keyword" id="6659011">range</span>&nbsp;<span class="ident" id="6659017">addrs</span>&nbsp;<span class="op" id="6659023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659027">if</span>&nbsp;<span class="ident" id="6659030">ParseIP</span><span class="op" id="6659037">(</span><span class="ident" id="6659038">addr</span><span class="op" id="6659042">)</span>&nbsp;<span class="op" id="6659044">==</span>&nbsp;<span class="ident" id="6659047">nil</span>&nbsp;<span class="op" id="6659051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659056">t</span><span class="op" id="6659057">.</span><span class="ident" id="6659058">Errorf</span><span class="op" id="6659064">(</span><span class="string" id="6659065">&#34;got&nbsp;%q;&nbsp;want&nbsp;a&nbsp;literal&nbsp;ip&nbsp;address&#34;</span><span class="op" id="6659100">,</span>&nbsp;<span class="ident" id="6659102">addr</span><span class="op" id="6659106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659113">}</span><br>
<span class="lineno">175</span><span class="op" id="6659115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6659118">func</span>&nbsp;<span class="ident" id="6659123">TestLookupGoogleIP</span><span class="op" id="6659141">(</span><span class="ident" id="6659142">t</span>&nbsp;<span class="op" id="6659144">*</span><span class="ident" id="6659145">testing</span><span class="op" id="6659152">.</span><span class="ident" id="6659153">T</span><span class="op" id="6659154">)</span>&nbsp;<span class="op" id="6659156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659159">if</span>&nbsp;<span class="ident" id="6659162">testing</span><span class="op" id="6659169">.</span><span class="ident" id="6659170">Short</span><span class="op" id="6659175">(</span><span class="op" id="6659176">)</span>&nbsp;<span class="op" id="6659178">||</span>&nbsp;<span class="op" id="6659181">!</span><span class="op" id="6659182">*</span><span class="ident" id="6659183">testExternal</span>&nbsp;<span class="op" id="6659196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659200">t</span><span class="op" id="6659201">.</span><span class="ident" id="6659202">Skip</span><span class="op" id="6659206">(</span><span class="string" id="6659207">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6659248">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659255">ips</span><span class="op" id="6659258">,</span>&nbsp;<span class="ident" id="6659260">err</span>&nbsp;<span class="op" id="6659264">:=</span>&nbsp;<span class="ident" id="6659267">LookupIP</span><span class="op" id="6659275">(</span><span class="string" id="6659276">&#34;google.com&#34;</span><span class="op" id="6659288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659291">if</span>&nbsp;<span class="ident" id="6659294">err</span>&nbsp;<span class="op" id="6659298">!=</span>&nbsp;<span class="ident" id="6659301">nil</span>&nbsp;<span class="op" id="6659305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659309">t</span><span class="op" id="6659310">.</span><span class="ident" id="6659311">Fatal</span><span class="op" id="6659316">(</span><span class="ident" id="6659317">err</span><span class="op" id="6659320">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659326">if</span>&nbsp;<span class="builtinfunc" id="6659329">len</span><span class="op" id="6659332">(</span><span class="ident" id="6659333">ips</span><span class="op" id="6659336">)</span>&nbsp;<span class="op" id="6659338">==</span>&nbsp;<span class="num" id="6659341">0</span>&nbsp;<span class="op" id="6659343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659347">t</span><span class="op" id="6659348">.</span><span class="ident" id="6659349">Error</span><span class="op" id="6659354">(</span><span class="string" id="6659355">&#34;got&nbsp;no&nbsp;record&#34;</span><span class="op" id="6659370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659376">for</span>&nbsp;<span class="ident" id="6659380">_</span><span class="op" id="6659381">,</span>&nbsp;<span class="ident" id="6659383">ip</span>&nbsp;<span class="op" id="6659386">:=</span>&nbsp;<span class="keyword" id="6659389">range</span>&nbsp;<span class="ident" id="6659395">ips</span>&nbsp;<span class="op" id="6659399">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6659403">if</span>&nbsp;<span class="ident" id="6659406">ip</span><span class="op" id="6659408">.</span><span class="ident" id="6659409">To4</span><span class="op" id="6659412">(</span><span class="op" id="6659413">)</span>&nbsp;<span class="op" id="6659415">==</span>&nbsp;<span class="ident" id="6659418">nil</span>&nbsp;<span class="op" id="6659422">&amp;&amp;</span>&nbsp;<span class="ident" id="6659425">ip</span><span class="op" id="6659427">.</span><span class="ident" id="6659428">To16</span><span class="op" id="6659432">(</span><span class="op" id="6659433">)</span>&nbsp;<span class="op" id="6659435">==</span>&nbsp;<span class="ident" id="6659438">nil</span>&nbsp;<span class="op" id="6659442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659447">t</span><span class="op" id="6659448">.</span><span class="ident" id="6659449">Errorf</span><span class="op" id="6659455">(</span><span class="string" id="6659456">&#34;got&nbsp;%v;&nbsp;want&nbsp;an&nbsp;ip&nbsp;address&#34;</span><span class="op" id="6659484">,</span>&nbsp;<span class="ident" id="6659486">ip</span><span class="op" id="6659488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659495">}</span><br>
<span class="lineno"></span><span class="op" id="6659497">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="6659500">var</span>&nbsp;<span class="ident" id="6659504">revAddrTests</span>&nbsp;<span class="op" id="6659517">=</span>&nbsp;<span class="op" id="6659519">[</span><span class="op" id="6659520">]</span><span class="keyword" id="6659521">struct</span>&nbsp;<span class="op" id="6659528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659531">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6659541">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659549">Reverse</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6659559">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6659567">ErrPrefix</span>&nbsp;<span class="builtintype" id="6659577">string</span><br>
<span class="lineno">200</span><span class="op" id="6659584">}</span><span class="op" id="6659585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659588">{</span><span class="string" id="6659589">&#34;1.2.3.4&#34;</span><span class="op" id="6659598">,</span>&nbsp;<span class="string" id="6659600">&#34;4.3.2.1.in-addr.arpa.&#34;</span><span class="op" id="6659623">,</span>&nbsp;<span class="string" id="6659625">&#34;&#34;</span><span class="op" id="6659627">}</span><span class="op" id="6659628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659631">{</span><span class="string" id="6659632">&#34;245.110.36.114&#34;</span><span class="op" id="6659648">,</span>&nbsp;<span class="string" id="6659650">&#34;114.36.110.245.in-addr.arpa.&#34;</span><span class="op" id="6659680">,</span>&nbsp;<span class="string" id="6659682">&#34;&#34;</span><span class="op" id="6659684">}</span><span class="op" id="6659685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659688">{</span><span class="string" id="6659689">&#34;::ffff:12.34.56.78&#34;</span><span class="op" id="6659709">,</span>&nbsp;<span class="string" id="6659711">&#34;78.56.34.12.in-addr.arpa.&#34;</span><span class="op" id="6659738">,</span>&nbsp;<span class="string" id="6659740">&#34;&#34;</span><span class="op" id="6659742">}</span><span class="op" id="6659743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659746">{</span><span class="string" id="6659747">&#34;::1&#34;</span><span class="op" id="6659752">,</span>&nbsp;<span class="string" id="6659754">&#34;1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa.&#34;</span><span class="op" id="6659829">,</span>&nbsp;<span class="string" id="6659831">&#34;&#34;</span><span class="op" id="6659833">}</span><span class="op" id="6659834">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659837">{</span><span class="string" id="6659838">&#34;1::&#34;</span><span class="op" id="6659843">,</span>&nbsp;<span class="string" id="6659845">&#34;0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.1.0.0.0.ip6.arpa.&#34;</span><span class="op" id="6659920">,</span>&nbsp;<span class="string" id="6659922">&#34;&#34;</span><span class="op" id="6659924">}</span><span class="op" id="6659925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6659928">{</span><span class="string" id="6659929">&#34;1234:567::89a:bcde&#34;</span><span class="op" id="6659949">,</span>&nbsp;<span class="string" id="6659951">&#34;e.d.c.b.a.9.8.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.7.6.5.0.4.3.2.1.ip6.arpa.&#34;</span><span class="op" id="6660026">,</span>&nbsp;<span class="string" id="6660028">&#34;&#34;</span><span class="op" id="6660030">}</span><span class="op" id="6660031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660034">{</span><span class="string" id="6660035">&#34;1234:567:fefe:bcbc:adad:9e4a:89a:bcde&#34;</span><span class="op" id="6660074">,</span>&nbsp;<span class="string" id="6660076">&#34;e.d.c.b.a.9.8.0.a.4.e.9.d.a.d.a.c.b.c.b.e.f.e.f.7.6.5.0.4.3.2.1.ip6.arpa.&#34;</span><span class="op" id="6660151">,</span>&nbsp;<span class="string" id="6660153">&#34;&#34;</span><span class="op" id="6660155">}</span><span class="op" id="6660156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660159">{</span><span class="string" id="6660160">&#34;1.2.3&#34;</span><span class="op" id="6660167">,</span>&nbsp;<span class="string" id="6660169">&#34;&#34;</span><span class="op" id="6660171">,</span>&nbsp;<span class="string" id="6660173">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="6660195">}</span><span class="op" id="6660196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660199">{</span><span class="string" id="6660200">&#34;1.2.3.4.5&#34;</span><span class="op" id="6660211">,</span>&nbsp;<span class="string" id="6660213">&#34;&#34;</span><span class="op" id="6660215">,</span>&nbsp;<span class="string" id="6660217">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="6660239">}</span><span class="op" id="6660240">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660243">{</span><span class="string" id="6660244">&#34;1234:567:bcbca::89a:bcde&#34;</span><span class="op" id="6660270">,</span>&nbsp;<span class="string" id="6660272">&#34;&#34;</span><span class="op" id="6660274">,</span>&nbsp;<span class="string" id="6660276">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="6660298">}</span><span class="op" id="6660299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660302">{</span><span class="string" id="6660303">&#34;1234:567::bcbc:adad::89a:bcde&#34;</span><span class="op" id="6660334">,</span>&nbsp;<span class="string" id="6660336">&#34;&#34;</span><span class="op" id="6660338">,</span>&nbsp;<span class="string" id="6660340">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="6660362">}</span><span class="op" id="6660363">,</span><br>
<span class="lineno"></span><span class="op" id="6660365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6660368">func</span>&nbsp;<span class="ident" id="6660373">TestReverseAddress</span><span class="op" id="6660391">(</span><span class="ident" id="6660392">t</span>&nbsp;<span class="op" id="6660394">*</span><span class="ident" id="6660395">testing</span><span class="op" id="6660402">.</span><span class="ident" id="6660403">T</span><span class="op" id="6660404">)</span>&nbsp;<span class="op" id="6660406">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660409">for</span>&nbsp;<span class="ident" id="6660413">i</span><span class="op" id="6660414">,</span>&nbsp;<span class="ident" id="6660416">tt</span>&nbsp;<span class="op" id="6660419">:=</span>&nbsp;<span class="keyword" id="6660422">range</span>&nbsp;<span class="ident" id="6660428">revAddrTests</span>&nbsp;<span class="op" id="6660441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660445">a</span><span class="op" id="6660446">,</span>&nbsp;<span class="ident" id="6660448">err</span>&nbsp;<span class="op" id="6660452">:=</span>&nbsp;<span class="ident" id="6660455">reverseaddr</span><span class="op" id="6660466">(</span><span class="ident" id="6660467">tt</span><span class="op" id="6660469">.</span><span class="ident" id="6660470">Addr</span><span class="op" id="6660474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660478">if</span>&nbsp;<span class="builtinfunc" id="6660481">len</span><span class="op" id="6660484">(</span><span class="ident" id="6660485">tt</span><span class="op" id="6660487">.</span><span class="ident" id="6660488">ErrPrefix</span><span class="op" id="6660497">)</span>&nbsp;<span class="op" id="6660499">&gt;</span>&nbsp;<span class="num" id="6660501">0</span>&nbsp;<span class="op" id="6660503">&amp;&amp;</span>&nbsp;<span class="ident" id="6660506">err</span>&nbsp;<span class="op" id="6660510">==</span>&nbsp;<span class="ident" id="6660513">nil</span>&nbsp;<span class="op" id="6660517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660522">t</span><span class="op" id="6660523">.</span><span class="ident" id="6660524">Errorf</span><span class="op" id="6660530">(</span><span class="string" id="6660531">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;&lt;nil&gt;&nbsp;(error)&#34;</span><span class="op" id="6660568">,</span>&nbsp;<span class="ident" id="6660570">i</span><span class="op" id="6660571">,</span>&nbsp;<span class="ident" id="6660573">tt</span><span class="op" id="6660575">.</span><span class="ident" id="6660576">ErrPrefix</span><span class="op" id="6660585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660590">continue</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660605">if</span>&nbsp;<span class="builtinfunc" id="6660608">len</span><span class="op" id="6660611">(</span><span class="ident" id="6660612">tt</span><span class="op" id="6660614">.</span><span class="ident" id="6660615">ErrPrefix</span><span class="op" id="6660624">)</span>&nbsp;<span class="op" id="6660626">==</span>&nbsp;<span class="num" id="6660629">0</span>&nbsp;<span class="op" id="6660631">&amp;&amp;</span>&nbsp;<span class="ident" id="6660634">err</span>&nbsp;<span class="op" id="6660638">!=</span>&nbsp;<span class="ident" id="6660641">nil</span>&nbsp;<span class="op" id="6660645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660650">t</span><span class="op" id="6660651">.</span><span class="ident" id="6660652">Errorf</span><span class="op" id="6660658">(</span><span class="string" id="6660659">&#34;#%d:&nbsp;expected&nbsp;&lt;nil&gt;,&nbsp;got&nbsp;%q&nbsp;(error)&#34;</span><span class="op" id="6660696">,</span>&nbsp;<span class="ident" id="6660698">i</span><span class="op" id="6660699">,</span>&nbsp;<span class="ident" id="6660701">err</span><span class="op" id="6660704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660712">if</span>&nbsp;<span class="ident" id="6660715">err</span>&nbsp;<span class="op" id="6660719">!=</span>&nbsp;<span class="ident" id="6660722">nil</span>&nbsp;<span class="op" id="6660726">&amp;&amp;</span>&nbsp;<span class="ident" id="6660729">err</span><span class="op" id="6660732">.</span><span class="op" id="6660733">(</span><span class="op" id="6660734">*</span><span class="ident" id="6660735">DNSError</span><span class="op" id="6660743">)</span><span class="op" id="6660744">.</span><span class="ident" id="6660745">Err</span>&nbsp;<span class="op" id="6660749">!=</span>&nbsp;<span class="ident" id="6660752">tt</span><span class="op" id="6660754">.</span><span class="ident" id="6660755">ErrPrefix</span>&nbsp;<span class="op" id="6660765">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660770">t</span><span class="op" id="6660771">.</span><span class="ident" id="6660772">Errorf</span><span class="op" id="6660778">(</span><span class="string" id="6660779">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;%q&nbsp;(mismatched&nbsp;error)&#34;</span><span class="op" id="6660824">,</span>&nbsp;<span class="ident" id="6660826">i</span><span class="op" id="6660827">,</span>&nbsp;<span class="ident" id="6660829">tt</span><span class="op" id="6660831">.</span><span class="ident" id="6660832">ErrPrefix</span><span class="op" id="6660841">,</span>&nbsp;<span class="ident" id="6660843">err</span><span class="op" id="6660846">.</span><span class="op" id="6660847">(</span><span class="op" id="6660848">*</span><span class="ident" id="6660849">DNSError</span><span class="op" id="6660857">)</span><span class="op" id="6660858">.</span><span class="ident" id="6660859">Err</span><span class="op" id="6660862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6660870">if</span>&nbsp;<span class="ident" id="6660873">a</span>&nbsp;<span class="op" id="6660875">!=</span>&nbsp;<span class="ident" id="6660878">tt</span><span class="op" id="6660880">.</span><span class="ident" id="6660881">Reverse</span>&nbsp;<span class="op" id="6660889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6660894">t</span><span class="op" id="6660895">.</span><span class="ident" id="6660896">Errorf</span><span class="op" id="6660902">(</span><span class="string" id="6660903">&#34;#%d:&nbsp;expected&nbsp;%q,&nbsp;got&nbsp;%q&nbsp;(reverse&nbsp;address)&#34;</span><span class="op" id="6660947">,</span>&nbsp;<span class="ident" id="6660949">i</span><span class="op" id="6660950">,</span>&nbsp;<span class="ident" id="6660952">tt</span><span class="op" id="6660954">.</span><span class="ident" id="6660955">Reverse</span><span class="op" id="6660962">,</span>&nbsp;<span class="ident" id="6660964">a</span><span class="op" id="6660965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660969">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6660972">}</span><br>
<span class="lineno"></span><span class="op" id="6660974">}</span>
</div>
</body>
</html>
