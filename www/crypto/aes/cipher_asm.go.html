<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3671460">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3671515">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3671569">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3671620">//&nbsp;+build&nbsp;amd64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3671637">package</span>&nbsp;<span class="ident" id="3671645">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3671650">//&nbsp;defined&nbsp;in&nbsp;asm_$GOARCH.s</span><br>
<span class="lineno">10</span><span class="keyword" id="3671678">func</span>&nbsp;<span class="ident" id="3671683">hasAsm</span><span class="op" id="3671689">(</span><span class="op" id="3671690">)</span>&nbsp;<span class="builtintype" id="3671692">bool</span><br>
<span class="lineno"></span><span class="keyword" id="3671697">func</span>&nbsp;<span class="ident" id="3671702">encryptBlockAsm</span><span class="op" id="3671717">(</span><span class="ident" id="3671718">nr</span>&nbsp;<span class="builtintype" id="3671721">int</span><span class="op" id="3671724">,</span>&nbsp;<span class="ident" id="3671726">xk</span>&nbsp;<span class="op" id="3671729">*</span><span class="builtintype" id="3671730">uint32</span><span class="op" id="3671736">,</span>&nbsp;<span class="ident" id="3671738">dst</span><span class="op" id="3671741">,</span>&nbsp;<span class="ident" id="3671743">src</span>&nbsp;<span class="op" id="3671747">*</span><span class="builtintype" id="3671748">byte</span><span class="op" id="3671752">)</span><br>
<span class="lineno"></span><span class="keyword" id="3671754">func</span>&nbsp;<span class="ident" id="3671759">decryptBlockAsm</span><span class="op" id="3671774">(</span><span class="ident" id="3671775">nr</span>&nbsp;<span class="builtintype" id="3671778">int</span><span class="op" id="3671781">,</span>&nbsp;<span class="ident" id="3671783">xk</span>&nbsp;<span class="op" id="3671786">*</span><span class="builtintype" id="3671787">uint32</span><span class="op" id="3671793">,</span>&nbsp;<span class="ident" id="3671795">dst</span><span class="op" id="3671798">,</span>&nbsp;<span class="ident" id="3671800">src</span>&nbsp;<span class="op" id="3671804">*</span><span class="builtintype" id="3671805">byte</span><span class="op" id="3671809">)</span><br>
<span class="lineno"></span><span class="keyword" id="3671811">func</span>&nbsp;<span class="ident" id="3671816">expandKeyAsm</span><span class="op" id="3671828">(</span><span class="ident" id="3671829">nr</span>&nbsp;<span class="builtintype" id="3671832">int</span><span class="op" id="3671835">,</span>&nbsp;<span class="ident" id="3671837">key</span>&nbsp;<span class="op" id="3671841">*</span><span class="builtintype" id="3671842">byte</span><span class="op" id="3671846">,</span>&nbsp;<span class="ident" id="3671848">enc</span>&nbsp;<span class="op" id="3671852">*</span><span class="builtintype" id="3671853">uint32</span><span class="op" id="3671859">,</span>&nbsp;<span class="ident" id="3671861">dec</span>&nbsp;<span class="op" id="3671865">*</span><span class="builtintype" id="3671866">uint32</span><span class="op" id="3671872">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3671875">var</span>&nbsp;<span class="ident" id="3671879">useAsm</span>&nbsp;<span class="op" id="3671886">=</span>&nbsp;<span class="ident" id="3671888"><a href="/crypto/aes/cipher_asm.go.html#3671683">hasAsm</a></span><span class="op" id="3671894">(</span><span class="op" id="3671895">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3671898">func</span>&nbsp;<span class="ident" id="3671903">encryptBlock</span><span class="op" id="3671915">(</span><span class="ident" id="3671916">xk</span>&nbsp;<span class="op" id="3671919">[</span><span class="op" id="3671920">]</span><span class="builtintype" id="3671921">uint32</span><span class="op" id="3671927">,</span>&nbsp;<span class="ident" id="3671929">dst</span><span class="op" id="3671932">,</span>&nbsp;<span class="ident" id="3671934">src</span>&nbsp;<span class="op" id="3671938">[</span><span class="op" id="3671939">]</span><span class="builtintype" id="3671940">byte</span><span class="op" id="3671944">)</span>&nbsp;<span class="op" id="3671946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3671949">if</span>&nbsp;<span class="ident" id="3671952"><a href="/crypto/aes/cipher_asm.go.html#3671879">useAsm</a></span>&nbsp;<span class="op" id="3671959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3671963"><a href="/crypto/aes/cipher_asm.go.html#3671702">encryptBlockAsm</a></span><span class="op" id="3671978">(</span><span class="builtinfunc" id="3671979">len</span><span class="op" id="3671982">(</span><span class="ident" id="3671983"><a href="/crypto/aes/cipher_asm.go.html#3671916">xk</a></span><span class="op" id="3671985">)</span><span class="op" id="3671986">/</span><span class="num" id="3671987">4</span><span class="op" id="3671988">-</span><span class="num" id="3671989">1</span><span class="op" id="3671990">,</span>&nbsp;<span class="op" id="3671992">&amp;</span><span class="ident" id="3671993"><a href="/crypto/aes/cipher_asm.go.html#3671916">xk</a></span><span class="op" id="3671995">[</span><span class="num" id="3671996">0</span><span class="op" id="3671997">]</span><span class="op" id="3671998">,</span>&nbsp;<span class="op" id="3672000">&amp;</span><span class="ident" id="3672001"><a href="/crypto/aes/cipher_asm.go.html#3671929">dst</a></span><span class="op" id="3672004">[</span><span class="num" id="3672005">0</span><span class="op" id="3672006">]</span><span class="op" id="3672007">,</span>&nbsp;<span class="op" id="3672009">&amp;</span><span class="ident" id="3672010"><a href="/crypto/aes/cipher_asm.go.html#3671934">src</a></span><span class="op" id="3672013">[</span><span class="num" id="3672014">0</span><span class="op" id="3672015">]</span><span class="op" id="3672016">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3672019">}</span>&nbsp;<span class="keyword" id="3672021">else</span>&nbsp;<span class="op" id="3672026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3672030"><a href="/crypto/aes/block.go.html#3664493">encryptBlockGo</a></span><span class="op" id="3672044">(</span><span class="ident" id="3672045"><a href="/crypto/aes/cipher_asm.go.html#3671916">xk</a></span><span class="op" id="3672047">,</span>&nbsp;<span class="ident" id="3672049"><a href="/crypto/aes/cipher_asm.go.html#3671929">dst</a></span><span class="op" id="3672052">,</span>&nbsp;<span class="ident" id="3672054"><a href="/crypto/aes/cipher_asm.go.html#3671934">src</a></span><span class="op" id="3672057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3672060">}</span><br>
<span class="lineno"></span><span class="op" id="3672062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3672065">func</span>&nbsp;<span class="ident" id="3672070">decryptBlock</span><span class="op" id="3672082">(</span><span class="ident" id="3672083">xk</span>&nbsp;<span class="op" id="3672086">[</span><span class="op" id="3672087">]</span><span class="builtintype" id="3672088">uint32</span><span class="op" id="3672094">,</span>&nbsp;<span class="ident" id="3672096">dst</span><span class="op" id="3672099">,</span>&nbsp;<span class="ident" id="3672101">src</span>&nbsp;<span class="op" id="3672105">[</span><span class="op" id="3672106">]</span><span class="builtintype" id="3672107">byte</span><span class="op" id="3672111">)</span>&nbsp;<span class="op" id="3672113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672116">if</span>&nbsp;<span class="ident" id="3672119"><a href="/crypto/aes/cipher_asm.go.html#3671879">useAsm</a></span>&nbsp;<span class="op" id="3672126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3672130"><a href="/crypto/aes/cipher_asm.go.html#3671759">decryptBlockAsm</a></span><span class="op" id="3672145">(</span><span class="builtinfunc" id="3672146">len</span><span class="op" id="3672149">(</span><span class="ident" id="3672150"><a href="/crypto/aes/cipher_asm.go.html#3672083">xk</a></span><span class="op" id="3672152">)</span><span class="op" id="3672153">/</span><span class="num" id="3672154">4</span><span class="op" id="3672155">-</span><span class="num" id="3672156">1</span><span class="op" id="3672157">,</span>&nbsp;<span class="op" id="3672159">&amp;</span><span class="ident" id="3672160"><a href="/crypto/aes/cipher_asm.go.html#3672083">xk</a></span><span class="op" id="3672162">[</span><span class="num" id="3672163">0</span><span class="op" id="3672164">]</span><span class="op" id="3672165">,</span>&nbsp;<span class="op" id="3672167">&amp;</span><span class="ident" id="3672168"><a href="/crypto/aes/cipher_asm.go.html#3672096">dst</a></span><span class="op" id="3672171">[</span><span class="num" id="3672172">0</span><span class="op" id="3672173">]</span><span class="op" id="3672174">,</span>&nbsp;<span class="op" id="3672176">&amp;</span><span class="ident" id="3672177"><a href="/crypto/aes/cipher_asm.go.html#3672101">src</a></span><span class="op" id="3672180">[</span><span class="num" id="3672181">0</span><span class="op" id="3672182">]</span><span class="op" id="3672183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3672186">}</span>&nbsp;<span class="keyword" id="3672188">else</span>&nbsp;<span class="op" id="3672193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3672197"><a href="/crypto/aes/block.go.html#3666652">decryptBlockGo</a></span><span class="op" id="3672211">(</span><span class="ident" id="3672212"><a href="/crypto/aes/cipher_asm.go.html#3672083">xk</a></span><span class="op" id="3672214">,</span>&nbsp;<span class="ident" id="3672216"><a href="/crypto/aes/cipher_asm.go.html#3672096">dst</a></span><span class="op" id="3672219">,</span>&nbsp;<span class="ident" id="3672221"><a href="/crypto/aes/cipher_asm.go.html#3672101">src</a></span><span class="op" id="3672224">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3672227">}</span><br>
<span class="lineno"></span><span class="op" id="3672229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3672232">func</span>&nbsp;<span class="ident" id="3672237">expandKey</span><span class="op" id="3672246">(</span><span class="ident" id="3672247">key</span>&nbsp;<span class="op" id="3672251">[</span><span class="op" id="3672252">]</span><span class="builtintype" id="3672253">byte</span><span class="op" id="3672257">,</span>&nbsp;<span class="ident" id="3672259">enc</span><span class="op" id="3672262">,</span>&nbsp;<span class="ident" id="3672264">dec</span>&nbsp;<span class="op" id="3672268">[</span><span class="op" id="3672269">]</span><span class="builtintype" id="3672270">uint32</span><span class="op" id="3672276">)</span>&nbsp;<span class="op" id="3672278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672281">if</span>&nbsp;<span class="ident" id="3672284"><a href="/crypto/aes/cipher_asm.go.html#3671879">useAsm</a></span>&nbsp;<span class="op" id="3672291">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3672295">rounds</span>&nbsp;<span class="op" id="3672302">:=</span>&nbsp;<span class="num" id="3672305">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672310">switch</span>&nbsp;<span class="builtinfunc" id="3672317">len</span><span class="op" id="3672320">(</span><span class="ident" id="3672321"><a href="/crypto/aes/cipher_asm.go.html#3672247">key</a></span><span class="op" id="3672324">)</span>&nbsp;<span class="op" id="3672326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672330">case</span>&nbsp;<span class="num" id="3672335">128</span>&nbsp;<span class="op" id="3672339">/</span>&nbsp;<span class="num" id="3672341">8</span><span class="op" id="3672342">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3672347"><a href="/crypto/aes/cipher_asm.go.html#3672295">rounds</a></span>&nbsp;<span class="op" id="3672354">=</span>&nbsp;<span class="num" id="3672356">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672361">case</span>&nbsp;<span class="num" id="3672366">192</span>&nbsp;<span class="op" id="3672370">/</span>&nbsp;<span class="num" id="3672372">8</span><span class="op" id="3672373">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3672378"><a href="/crypto/aes/cipher_asm.go.html#3672295">rounds</a></span>&nbsp;<span class="op" id="3672385">=</span>&nbsp;<span class="num" id="3672387">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3672392">case</span>&nbsp;<span class="num" id="3672397">256</span>&nbsp;<span class="op" id="3672401">/</span>&nbsp;<span class="num" id="3672403">8</span><span class="op" id="3672404">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3672409"><a href="/crypto/aes/cipher_asm.go.html#3672295">rounds</a></span>&nbsp;<span class="op" id="3672416">=</span>&nbsp;<span class="num" id="3672418">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3672423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3672427"><a href="/crypto/aes/cipher_asm.go.html#3671816">expandKeyAsm</a></span><span class="op" id="3672439">(</span><span class="ident" id="3672440"><a href="/crypto/aes/cipher_asm.go.html#3672295">rounds</a></span><span class="op" id="3672446">,</span>&nbsp;<span class="op" id="3672448">&amp;</span><span class="ident" id="3672449"><a href="/crypto/aes/cipher_asm.go.html#3672247">key</a></span><span class="op" id="3672452">[</span><span class="num" id="3672453">0</span><span class="op" id="3672454">]</span><span class="op" id="3672455">,</span>&nbsp;<span class="op" id="3672457">&amp;</span><span class="ident" id="3672458"><a href="/crypto/aes/cipher_asm.go.html#3672259">enc</a></span><span class="op" id="3672461">[</span><span class="num" id="3672462">0</span><span class="op" id="3672463">]</span><span class="op" id="3672464">,</span>&nbsp;<span class="op" id="3672466">&amp;</span><span class="ident" id="3672467"><a href="/crypto/aes/cipher_asm.go.html#3672264">dec</a></span><span class="op" id="3672470">[</span><span class="num" id="3672471">0</span><span class="op" id="3672472">]</span><span class="op" id="3672473">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3672476">}</span>&nbsp;<span class="keyword" id="3672478">else</span>&nbsp;<span class="op" id="3672483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3672487"><a href="/crypto/aes/block.go.html#3669092">expandKeyGo</a></span><span class="op" id="3672498">(</span><span class="ident" id="3672499"><a href="/crypto/aes/cipher_asm.go.html#3672247">key</a></span><span class="op" id="3672502">,</span>&nbsp;<span class="ident" id="3672504"><a href="/crypto/aes/cipher_asm.go.html#3672259">enc</a></span><span class="op" id="3672507">,</span>&nbsp;<span class="ident" id="3672509"><a href="/crypto/aes/cipher_asm.go.html#3672264">dec</a></span><span class="op" id="3672512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3672515">}</span><br>
<span class="lineno"></span><span class="op" id="3672517">}</span>
</div>
</body>
</html>
