<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>reflect</h2>
<ul>
<li><a href="/gostd/reflect/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/reflect/deepequal.go.html">deepequal.go</a></li>
<li><a href="/gostd/reflect/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/reflect/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/reflect/makefunc.go.html">makefunc.go</a></li>
<li><a href="/gostd/reflect/set_test.go.html">set_test.go</a></li>
<li><a href="/gostd/reflect/tostring_test.go.html">tostring_test.go</a></li>
<li><a href="/gostd/reflect/type.go.html" class="current">type.go</a></li>
<li><a href="/gostd/reflect/value.go.html">value.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2673997">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2674052">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2674106">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2674157">//&nbsp;Package&nbsp;reflect&nbsp;implements&nbsp;run-time&nbsp;reflection,&nbsp;allowing&nbsp;a&nbsp;program&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2674230">//&nbsp;manipulate&nbsp;objects&nbsp;with&nbsp;arbitrary&nbsp;types.&nbsp;&nbsp;The&nbsp;typical&nbsp;use&nbsp;is&nbsp;to&nbsp;take&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2674310">//&nbsp;with&nbsp;static&nbsp;type&nbsp;interface{}&nbsp;and&nbsp;extract&nbsp;its&nbsp;dynamic&nbsp;type&nbsp;information&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2674386">//&nbsp;calling&nbsp;TypeOf,&nbsp;which&nbsp;returns&nbsp;a&nbsp;Type.</span><br>
<span class="lineno"></span><span class="comment" id="2674427">//</span><br>
<span class="lineno">10</span><span class="comment" id="2674430">//&nbsp;A&nbsp;call&nbsp;to&nbsp;ValueOf&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;the&nbsp;run-time&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="2674499">//&nbsp;Zero&nbsp;takes&nbsp;a&nbsp;Type&nbsp;and&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;a&nbsp;zero&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2674566">//&nbsp;for&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2674584">//</span><br>
<span class="lineno"></span><span class="comment" id="2674587">//&nbsp;See&nbsp;&#34;The&nbsp;Laws&nbsp;of&nbsp;Reflection&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;reflection&nbsp;in&nbsp;Go:</span><br>
<span class="lineno">15</span><span class="comment" id="2674660">//&nbsp;http://golang.org/doc/articles/laws_of_reflection.html</span><br>
<span class="lineno"></span><span class="keyword" id="2674718">package</span>&nbsp;<span class="ident" id="2674726">reflect</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2674735">import</span>&nbsp;<span class="op" id="2674742">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2674745">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2674756">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2674767">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2674775">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2674784">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2674787">//&nbsp;Type&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2674831">//</span><br>
<span class="lineno"></span><span class="comment" id="2674834">//&nbsp;Not&nbsp;all&nbsp;methods&nbsp;apply&nbsp;to&nbsp;all&nbsp;kinds&nbsp;of&nbsp;types.&nbsp;&nbsp;Restrictions,</span><br>
<span class="lineno"></span><span class="comment" id="2674897">//&nbsp;if&nbsp;any,&nbsp;are&nbsp;noted&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;each&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2674956">//&nbsp;Use&nbsp;the&nbsp;Kind&nbsp;method&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;before</span><br>
<span class="lineno">30</span><span class="comment" id="2675015">//&nbsp;calling&nbsp;kind-specific&nbsp;methods.&nbsp;&nbsp;Calling&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="2675067">//&nbsp;inappropriate&nbsp;to&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;causes&nbsp;a&nbsp;run-time&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="2675129">type</span>&nbsp;<span class="ident" id="2675134">Type</span>&nbsp;<span class="keyword" id="2675139">interface</span>&nbsp;<span class="op" id="2675149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675152">//&nbsp;Methods&nbsp;applicable&nbsp;to&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675190">//&nbsp;Align&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675245">//&nbsp;this&nbsp;type&nbsp;when&nbsp;allocated&nbsp;in&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2675285">Align</span><span class="op" id="2675290">(</span><span class="op" id="2675291">)</span>&nbsp;<span class="builtintype" id="2675293">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675299">//&nbsp;FieldAlign&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675359">//&nbsp;this&nbsp;type&nbsp;when&nbsp;used&nbsp;as&nbsp;a&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2675407">FieldAlign</span><span class="op" id="2675417">(</span><span class="op" id="2675418">)</span>&nbsp;<span class="builtintype" id="2675420">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675426">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675487">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumMethod()).</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675544">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675548">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675622">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675691">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675695">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675765">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2675834">Method</span><span class="op" id="2675840">(</span><span class="builtintype" id="2675841">int</span><span class="op" id="2675844">)</span>&nbsp;<span class="ident" id="2675846">Method</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675855">//&nbsp;MethodByName&nbsp;returns&nbsp;the&nbsp;method&nbsp;with&nbsp;that&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675920">//&nbsp;method&nbsp;set&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;method&nbsp;was&nbsp;found.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675985">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675989">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2676063">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2676132">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2676136">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2676206">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2676275">MethodByName</span><span class="op" id="2676287">(</span><span class="builtintype" id="2676288">string</span><span class="op" id="2676294">)</span>&nbsp;<span class="op" id="2676296">(</span><span class="ident" id="2676297">Method</span><span class="op" id="2676303">,</span>&nbsp;<span class="builtintype" id="2676305">bool</span><span class="op" id="2676309">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2676313">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2676383">NumMethod</span><span class="op" id="2676392">(</span><span class="op" id="2676393">)</span>&nbsp;<span class="builtintype" id="2676395">int</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2676401">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;type&#39;s&nbsp;name&nbsp;within&nbsp;its&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2676454">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;string&nbsp;for&nbsp;unnamed&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2676504">Name</span><span class="op" id="2676508">(</span><span class="op" id="2676509">)</span>&nbsp;<span class="builtintype" id="2676511">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2676520">//&nbsp;PkgPath&nbsp;returns&nbsp;a&nbsp;named&nbsp;type&#39;s&nbsp;package&nbsp;path,&nbsp;that&nbsp;is,&nbsp;the&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2676594">//&nbsp;that&nbsp;uniquely&nbsp;identifies&nbsp;the&nbsp;package,&nbsp;such&nbsp;as&nbsp;&#34;encoding/base64&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2676663">//&nbsp;If&nbsp;the&nbsp;type&nbsp;was&nbsp;predeclared&nbsp;(string,&nbsp;error)&nbsp;or&nbsp;unnamed&nbsp;(*T,&nbsp;struct{},&nbsp;[]int),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2676745">//&nbsp;the&nbsp;package&nbsp;path&nbsp;will&nbsp;be&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2676792">PkgPath</span><span class="op" id="2676799">(</span><span class="op" id="2676800">)</span>&nbsp;<span class="builtintype" id="2676802">string</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2676811">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;needed&nbsp;to&nbsp;store</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2676864">//&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;given&nbsp;type;&nbsp;it&nbsp;is&nbsp;analogous&nbsp;to&nbsp;unsafe.Sizeof.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2676929">Size</span><span class="op" id="2676933">(</span><span class="op" id="2676934">)</span>&nbsp;<span class="builtintype" id="2676936">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2676946">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677002">//&nbsp;The&nbsp;string&nbsp;representation&nbsp;may&nbsp;use&nbsp;shortened&nbsp;package&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677064">//&nbsp;(e.g.,&nbsp;base64&nbsp;instead&nbsp;of&nbsp;&#34;encoding/base64&#34;)&nbsp;and&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677123">//&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique&nbsp;among&nbsp;types.&nbsp;&nbsp;To&nbsp;test&nbsp;for&nbsp;equality,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677187">//&nbsp;compare&nbsp;the&nbsp;Types&nbsp;directly.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2677219">String</span><span class="op" id="2677225">(</span><span class="op" id="2677226">)</span>&nbsp;<span class="builtintype" id="2677228">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677237">//&nbsp;Kind&nbsp;returns&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2677286">Kind</span><span class="op" id="2677290">(</span><span class="op" id="2677291">)</span>&nbsp;<span class="ident" id="2677293">Kind</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677300">//&nbsp;Implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2677373">Implements</span><span class="op" id="2677383">(</span><span class="ident" id="2677384">u</span>&nbsp;<span class="ident" id="2677386">Type</span><span class="op" id="2677390">)</span>&nbsp;<span class="builtintype" id="2677392">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677399">//&nbsp;AssignableTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;assignable&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2677477">AssignableTo</span><span class="op" id="2677489">(</span><span class="ident" id="2677490">u</span>&nbsp;<span class="ident" id="2677492">Type</span><span class="op" id="2677496">)</span>&nbsp;<span class="builtintype" id="2677498">bool</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677505">//&nbsp;ConvertibleTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;convertible&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2677585">ConvertibleTo</span><span class="op" id="2677598">(</span><span class="ident" id="2677599">u</span>&nbsp;<span class="ident" id="2677601">Type</span><span class="op" id="2677605">)</span>&nbsp;<span class="builtintype" id="2677607">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677614">//&nbsp;Comparable&nbsp;returns&nbsp;true&nbsp;if&nbsp;values&nbsp;of&nbsp;this&nbsp;type&nbsp;are&nbsp;comparable.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2677681">Comparable</span><span class="op" id="2677691">(</span><span class="op" id="2677692">)</span>&nbsp;<span class="builtintype" id="2677694">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677701">//&nbsp;Methods&nbsp;applicable&nbsp;only&nbsp;to&nbsp;some&nbsp;types,&nbsp;depending&nbsp;on&nbsp;Kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677763">//&nbsp;The&nbsp;methods&nbsp;allowed&nbsp;for&nbsp;each&nbsp;kind&nbsp;are:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677806">//</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677810">//&nbsp;&nbsp;&nbsp;&nbsp;Int*,&nbsp;Uint*,&nbsp;Float*,&nbsp;Complex*:&nbsp;Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677850">//&nbsp;&nbsp;&nbsp;&nbsp;Array:&nbsp;Elem,&nbsp;Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677871">//&nbsp;&nbsp;&nbsp;&nbsp;Chan:&nbsp;ChanDir,&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677895">//&nbsp;&nbsp;&nbsp;&nbsp;Func:&nbsp;In,&nbsp;NumIn,&nbsp;Out,&nbsp;NumOut,&nbsp;IsVariadic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677941">//&nbsp;&nbsp;&nbsp;&nbsp;Map:&nbsp;Key,&nbsp;Elem</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677960">//&nbsp;&nbsp;&nbsp;&nbsp;Ptr:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677974">//&nbsp;&nbsp;&nbsp;&nbsp;Slice:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2677990">//&nbsp;&nbsp;&nbsp;&nbsp;Struct:&nbsp;Field,&nbsp;FieldByIndex,&nbsp;FieldByName,&nbsp;FieldByNameFunc,&nbsp;NumField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678063">//&nbsp;Bits&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;type&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678110">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678161">//&nbsp;sized&nbsp;or&nbsp;unsized&nbsp;Int,&nbsp;Uint,&nbsp;Float,&nbsp;or&nbsp;Complex&nbsp;kinds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2678218">Bits</span><span class="op" id="2678222">(</span><span class="op" id="2678223">)</span>&nbsp;<span class="builtintype" id="2678225">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678231">//&nbsp;ChanDir&nbsp;returns&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678279">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2678325">ChanDir</span><span class="op" id="2678332">(</span><span class="op" id="2678333">)</span>&nbsp;<span class="ident" id="2678335">ChanDir</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678345">//&nbsp;IsVariadic&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;final&nbsp;input&nbsp;parameter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678416">//&nbsp;is&nbsp;a&nbsp;&#34;...&#34;&nbsp;parameter.&nbsp;&nbsp;If&nbsp;so,&nbsp;t.In(t.NumIn()&nbsp;-&nbsp;1)&nbsp;returns&nbsp;the&nbsp;parameter&#39;s</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678494">//&nbsp;implicit&nbsp;actual&nbsp;type&nbsp;[]T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678524">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678528">//&nbsp;For&nbsp;concreteness,&nbsp;if&nbsp;t&nbsp;represents&nbsp;func(x&nbsp;int,&nbsp;y&nbsp;...&nbsp;float64),&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678599">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678603">//&nbsp;&nbsp;&nbsp;&nbsp;t.NumIn()&nbsp;==&nbsp;2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678622">//&nbsp;&nbsp;&nbsp;&nbsp;t.In(0)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;int&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678664">//&nbsp;&nbsp;&nbsp;&nbsp;t.In(1)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;[]float64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678712">//&nbsp;&nbsp;&nbsp;&nbsp;t.IsVariadic()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678739">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678743">//&nbsp;IsVariadic&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2678797">IsVariadic</span><span class="op" id="2678807">(</span><span class="op" id="2678808">)</span>&nbsp;<span class="builtintype" id="2678810">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678817">//&nbsp;Elem&nbsp;returns&nbsp;a&nbsp;type&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678857">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Chan,&nbsp;Map,&nbsp;Ptr,&nbsp;or&nbsp;Slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2678930">Elem</span><span class="op" id="2678934">(</span><span class="op" id="2678935">)</span>&nbsp;<span class="ident" id="2678937">Type</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678944">//&nbsp;Field&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2678990">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679038">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumField()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2679094">Field</span><span class="op" id="2679099">(</span><span class="ident" id="2679100">i</span>&nbsp;<span class="builtintype" id="2679102">int</span><span class="op" id="2679105">)</span>&nbsp;<span class="ident" id="2679107">StructField</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679121">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679177">//&nbsp;to&nbsp;the&nbsp;index&nbsp;sequence.&nbsp;&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679239">//&nbsp;successively&nbsp;for&nbsp;each&nbsp;index&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679274">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2679322">FieldByIndex</span><span class="op" id="2679334">(</span><span class="ident" id="2679335">index</span>&nbsp;<span class="op" id="2679341">[</span><span class="op" id="2679342">]</span><span class="builtintype" id="2679343">int</span><span class="op" id="2679346">)</span>&nbsp;<span class="ident" id="2679348">StructField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679362">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679423">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2679476">FieldByName</span><span class="op" id="2679487">(</span><span class="ident" id="2679488">name</span>&nbsp;<span class="builtintype" id="2679493">string</span><span class="op" id="2679499">)</span>&nbsp;<span class="op" id="2679501">(</span><span class="ident" id="2679502">StructField</span><span class="op" id="2679513">,</span>&nbsp;<span class="builtintype" id="2679515">bool</span><span class="op" id="2679519">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679523">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;first&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679586">//&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679652">//&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2679677">FieldByNameFunc</span><span class="op" id="2679692">(</span><span class="ident" id="2679693">match</span>&nbsp;<span class="keyword" id="2679699">func</span><span class="op" id="2679703">(</span><span class="builtintype" id="2679704">string</span><span class="op" id="2679710">)</span>&nbsp;<span class="builtintype" id="2679712">bool</span><span class="op" id="2679716">)</span>&nbsp;<span class="op" id="2679718">(</span><span class="ident" id="2679719">StructField</span><span class="op" id="2679730">,</span>&nbsp;<span class="builtintype" id="2679732">bool</span><span class="op" id="2679736">)</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679740">//&nbsp;In&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;input&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679807">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679853">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumIn()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2679906">In</span><span class="op" id="2679908">(</span><span class="ident" id="2679909">i</span>&nbsp;<span class="builtintype" id="2679911">int</span><span class="op" id="2679914">)</span>&nbsp;<span class="ident" id="2679916">Type</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679923">//&nbsp;Key&nbsp;returns&nbsp;a&nbsp;map&nbsp;type&#39;s&nbsp;key&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2679962">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2680007">Key</span><span class="op" id="2680010">(</span><span class="op" id="2680011">)</span>&nbsp;<span class="ident" id="2680013">Type</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2680020">//&nbsp;Len&nbsp;returns&nbsp;an&nbsp;array&nbsp;type&#39;s&nbsp;length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2680060">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2680107">Len</span><span class="op" id="2680110">(</span><span class="op" id="2680111">)</span>&nbsp;<span class="builtintype" id="2680113">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2680119">//&nbsp;NumField&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;field&nbsp;count.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2680169">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2680217">NumField</span><span class="op" id="2680225">(</span><span class="op" id="2680226">)</span>&nbsp;<span class="builtintype" id="2680228">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2680234">//&nbsp;NumIn&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;input&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2680293">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2680339">NumIn</span><span class="op" id="2680344">(</span><span class="op" id="2680345">)</span>&nbsp;<span class="builtintype" id="2680347">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2680353">//&nbsp;NumOut&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;output&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2680414">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2680460">NumOut</span><span class="op" id="2680466">(</span><span class="op" id="2680467">)</span>&nbsp;<span class="builtintype" id="2680469">int</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2680475">//&nbsp;Out&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;output&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2680544">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2680590">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumOut()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2680644">Out</span><span class="op" id="2680647">(</span><span class="ident" id="2680648">i</span>&nbsp;<span class="builtintype" id="2680650">int</span><span class="op" id="2680653">)</span>&nbsp;<span class="ident" id="2680655">Type</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2680662">common</span><span class="op" id="2680668">(</span><span class="op" id="2680669">)</span>&nbsp;<span class="op" id="2680671">*</span><span class="ident" id="2680672">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2680679">uncommon</span><span class="op" id="2680687">(</span><span class="op" id="2680688">)</span>&nbsp;<span class="op" id="2680690">*</span><span class="ident" id="2680691">uncommonType</span><br>
<span class="lineno"></span><span class="op" id="2680704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="2680707">//&nbsp;BUG(rsc):&nbsp;FieldByName&nbsp;and&nbsp;related&nbsp;functions&nbsp;consider&nbsp;struct&nbsp;field&nbsp;names&nbsp;to&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span><span class="comment" id="2680794">//&nbsp;if&nbsp;the&nbsp;names&nbsp;are&nbsp;equal,&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;unexported&nbsp;names&nbsp;originating</span><br>
<span class="lineno"></span><span class="comment" id="2680867">//&nbsp;in&nbsp;different&nbsp;packages.&nbsp;The&nbsp;practical&nbsp;effect&nbsp;of&nbsp;this&nbsp;is&nbsp;that&nbsp;the&nbsp;result&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2680944">//&nbsp;t.FieldByName(&#34;x&#34;)&nbsp;is&nbsp;not&nbsp;well&nbsp;defined&nbsp;if&nbsp;the&nbsp;struct&nbsp;type&nbsp;t&nbsp;contains</span><br>
<span class="lineno"></span><span class="comment" id="2681016">//&nbsp;multiple&nbsp;fields&nbsp;named&nbsp;x&nbsp;(embedded&nbsp;from&nbsp;different&nbsp;packages).</span><br>
<span class="lineno">200</span><span class="comment" id="2681079">//&nbsp;FieldByName&nbsp;may&nbsp;return&nbsp;one&nbsp;of&nbsp;the&nbsp;fields&nbsp;named&nbsp;x&nbsp;or&nbsp;may&nbsp;report&nbsp;that&nbsp;there&nbsp;are&nbsp;none.</span><br>
<span class="lineno"></span><span class="comment" id="2681166">//&nbsp;See&nbsp;golang.org/issue/4876&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2681214">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;These&nbsp;data&nbsp;structures&nbsp;are&nbsp;known&nbsp;to&nbsp;the&nbsp;compiler&nbsp;(../../cmd/gc/reflect.c).<br>
<span class="lineno">205</span>&nbsp;*&nbsp;A&nbsp;few&nbsp;are&nbsp;known&nbsp;to&nbsp;../runtime/type.go&nbsp;to&nbsp;convey&nbsp;to&nbsp;debuggers.<br>
<span class="lineno"></span>&nbsp;*&nbsp;They&nbsp;are&nbsp;also&nbsp;known&nbsp;to&nbsp;../runtime/type.h.<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2681409">//&nbsp;A&nbsp;Kind&nbsp;represents&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;type&nbsp;that&nbsp;a&nbsp;Type&nbsp;represents.</span><br>
<span class="lineno">210</span><span class="comment" id="2681480">//&nbsp;The&nbsp;zero&nbsp;Kind&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;kind.</span><br>
<span class="lineno"></span><span class="keyword" id="2681518">type</span>&nbsp;<span class="ident" id="2681523">Kind</span>&nbsp;<span class="builtintype" id="2681528">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2681534">const</span>&nbsp;<span class="op" id="2681540">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681543">Invalid</span>&nbsp;<span class="ident" id="2681551">Kind</span>&nbsp;<span class="op" id="2681556">=</span>&nbsp;<span class="ident" id="2681558">iota</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681564">Bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681570">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681575">Int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681581">Int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681588">Int32</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681595">Int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681602">Uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681608">Uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681615">Uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681623">Uint32</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681631">Uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681639">Uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681648">Float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681657">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681666">Complex64</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681677">Complex128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681689">Array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681696">Chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681702">Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681708">Interface</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681719">Map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681724">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681729">Slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681736">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681744">Struct</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2681752">UnsafePointer</span><br>
<span class="lineno"></span><span class="op" id="2681766">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2681769">//&nbsp;rtype&nbsp;is&nbsp;the&nbsp;common&nbsp;implementation&nbsp;of&nbsp;most&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="2681823">//&nbsp;It&nbsp;is&nbsp;embedded&nbsp;in&nbsp;other,&nbsp;public&nbsp;struct&nbsp;types,&nbsp;but&nbsp;always</span><br>
<span class="lineno">245</span><span class="comment" id="2681883">//&nbsp;with&nbsp;a&nbsp;unique&nbsp;tag&nbsp;like&nbsp;`reflect:&#34;array&#34;`&nbsp;or&nbsp;`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="2681946">//&nbsp;so&nbsp;that&nbsp;code&nbsp;cannot&nbsp;convert&nbsp;from,&nbsp;say,&nbsp;*arrayType&nbsp;to&nbsp;*ptrType.</span><br>
<span class="lineno"></span><span class="keyword" id="2682012">type</span>&nbsp;<span class="ident" id="2682017">rtype</span>&nbsp;<span class="keyword" id="2682023">struct</span>&nbsp;<span class="op" id="2682030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2682033">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2682047">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2682056">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2682070">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2682088">//&nbsp;hash&nbsp;of&nbsp;type;&nbsp;avoids&nbsp;computation&nbsp;in&nbsp;hash&nbsp;tables</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2682140">_</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2682154">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2682172">//&nbsp;unused/padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2682191">align</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2682205">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2682223">//&nbsp;alignment&nbsp;of&nbsp;variable&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2682264">fieldAlign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2682278">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2682296">//&nbsp;alignment&nbsp;of&nbsp;struct&nbsp;field&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2682341">kind</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2682355">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2682373">//&nbsp;enumeration&nbsp;for&nbsp;C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2682395">alg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2682409">*</span><span class="ident" id="2682410">typeAlg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2682427">//&nbsp;algorithm&nbsp;table&nbsp;(../runtime/runtime.h:/Alg)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2682475">gc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2682489">[</span><span class="num" id="2682490">2</span><span class="op" id="2682491">]</span><span class="ident" id="2682492">unsafe</span><span class="op" id="2682498">.</span><span class="ident" id="2682499">Pointer</span>&nbsp;<span class="comment" id="2682507">//&nbsp;garbage&nbsp;collection&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2682535">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2682549">*</span><span class="builtintype" id="2682550">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2682567">//&nbsp;string&nbsp;form;&nbsp;unnecessary&nbsp;but&nbsp;undeniably&nbsp;useful</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2682618">*</span><span class="ident" id="2682619">uncommonType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2682650">//&nbsp;(relatively)&nbsp;uncommon&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2682683">ptrToThis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2682697">*</span><span class="ident" id="2682698">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2682715">//&nbsp;type&nbsp;for&nbsp;pointer&nbsp;to&nbsp;this&nbsp;type,&nbsp;if&nbsp;used&nbsp;in&nbsp;binary&nbsp;or&nbsp;has&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2682783">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2682797">unsafe</span><span class="op" id="2682803">.</span><span class="ident" id="2682804">Pointer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2682815">//&nbsp;pointer&nbsp;to&nbsp;zero&nbsp;value</span><br>
<span class="lineno">260</span><span class="op" id="2682840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2682843">type</span>&nbsp;<span class="ident" id="2682848">typeAlg</span>&nbsp;<span class="keyword" id="2682856">struct</span>&nbsp;<span class="op" id="2682863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2682866">//&nbsp;function&nbsp;for&nbsp;hashing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2682912">//&nbsp;(ptr&nbsp;to&nbsp;object,&nbsp;size,&nbsp;seed)&nbsp;-&gt;&nbsp;hash</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2682952">hash</span>&nbsp;<span class="keyword" id="2682957">func</span><span class="op" id="2682961">(</span><span class="ident" id="2682962">unsafe</span><span class="op" id="2682968">.</span><span class="ident" id="2682969">Pointer</span><span class="op" id="2682976">,</span>&nbsp;<span class="builtintype" id="2682978">uintptr</span><span class="op" id="2682985">,</span>&nbsp;<span class="builtintype" id="2682987">uintptr</span><span class="op" id="2682994">)</span>&nbsp;<span class="builtintype" id="2682996">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2683005">//&nbsp;function&nbsp;for&nbsp;comparing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2683053">//&nbsp;(ptr&nbsp;to&nbsp;object&nbsp;A,&nbsp;ptr&nbsp;to&nbsp;object&nbsp;B,&nbsp;size)&nbsp;-&gt;&nbsp;==?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2683105">equal</span>&nbsp;<span class="keyword" id="2683111">func</span><span class="op" id="2683115">(</span><span class="ident" id="2683116">unsafe</span><span class="op" id="2683122">.</span><span class="ident" id="2683123">Pointer</span><span class="op" id="2683130">,</span>&nbsp;<span class="ident" id="2683132">unsafe</span><span class="op" id="2683138">.</span><span class="ident" id="2683139">Pointer</span><span class="op" id="2683146">,</span>&nbsp;<span class="builtintype" id="2683148">uintptr</span><span class="op" id="2683155">)</span>&nbsp;<span class="builtintype" id="2683157">bool</span><br>
<span class="lineno"></span><span class="op" id="2683162">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="2683165">//&nbsp;Method&nbsp;on&nbsp;non-interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2683197">type</span>&nbsp;<span class="ident" id="2683202">method</span>&nbsp;<span class="keyword" id="2683209">struct</span>&nbsp;<span class="op" id="2683216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2683219">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2683227">*</span><span class="builtintype" id="2683228">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2683242">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2683261">pkgPath</span>&nbsp;<span class="op" id="2683269">*</span><span class="builtintype" id="2683270">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2683284">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2683334">mtyp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2683342">*</span><span class="ident" id="2683343">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2683357">//&nbsp;method&nbsp;type&nbsp;(without&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2683392">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2683400">*</span><span class="ident" id="2683401">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2683415">//&nbsp;.(*FuncType)&nbsp;underneath&nbsp;(with&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2683459">ifn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2683467">unsafe</span><span class="op" id="2683473">.</span><span class="ident" id="2683474">Pointer</span>&nbsp;<span class="comment" id="2683482">//&nbsp;fn&nbsp;used&nbsp;in&nbsp;interface&nbsp;call&nbsp;(one-word&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2683532">tfn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2683540">unsafe</span><span class="op" id="2683546">.</span><span class="ident" id="2683547">Pointer</span>&nbsp;<span class="comment" id="2683555">//&nbsp;fn&nbsp;used&nbsp;for&nbsp;normal&nbsp;method&nbsp;call</span><br>
<span class="lineno"></span><span class="op" id="2683589">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="2683592">//&nbsp;uncommonType&nbsp;is&nbsp;present&nbsp;only&nbsp;for&nbsp;types&nbsp;with&nbsp;names&nbsp;or&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="2683656">//&nbsp;(if&nbsp;T&nbsp;is&nbsp;a&nbsp;named&nbsp;type,&nbsp;the&nbsp;uncommonTypes&nbsp;for&nbsp;T&nbsp;and&nbsp;*T&nbsp;have&nbsp;methods).</span><br>
<span class="lineno"></span><span class="comment" id="2683728">//&nbsp;Using&nbsp;a&nbsp;pointer&nbsp;to&nbsp;this&nbsp;struct&nbsp;reduces&nbsp;the&nbsp;overall&nbsp;size&nbsp;required</span><br>
<span class="lineno"></span><span class="comment" id="2683796">//&nbsp;to&nbsp;describe&nbsp;an&nbsp;unnamed&nbsp;type&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno">285</span><span class="keyword" id="2683844">type</span>&nbsp;<span class="ident" id="2683849">uncommonType</span>&nbsp;<span class="keyword" id="2683862">struct</span>&nbsp;<span class="op" id="2683869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2683872">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2683880">*</span><span class="builtintype" id="2683881">string</span>&nbsp;&nbsp;<span class="comment" id="2683889">//&nbsp;name&nbsp;of&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2683906">pkgPath</span>&nbsp;<span class="op" id="2683914">*</span><span class="builtintype" id="2683915">string</span>&nbsp;&nbsp;<span class="comment" id="2683923">//&nbsp;import&nbsp;path;&nbsp;nil&nbsp;for&nbsp;built-in&nbsp;types&nbsp;like&nbsp;int,&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2683980">methods</span>&nbsp;<span class="op" id="2683988">[</span><span class="op" id="2683989">]</span><span class="ident" id="2683990">method</span>&nbsp;<span class="comment" id="2683997">//&nbsp;methods&nbsp;associated&nbsp;with&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2684029">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="2684032">//&nbsp;ChanDir&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno"></span><span class="keyword" id="2684082">type</span>&nbsp;<span class="ident" id="2684087">ChanDir</span>&nbsp;<span class="builtintype" id="2684095">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2684100">const</span>&nbsp;<span class="op" id="2684106">(</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684109">RecvDir</span>&nbsp;<span class="ident" id="2684117">ChanDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2684137">=</span>&nbsp;<span class="num" id="2684139">1</span>&nbsp;<span class="op" id="2684141">&lt;&lt;</span>&nbsp;<span class="ident" id="2684144">iota</span>&nbsp;<span class="comment" id="2684149">//&nbsp;&lt;-chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684160">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2684200">//&nbsp;chan&lt;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684211">BothDir</span>&nbsp;<span class="op" id="2684219">=</span>&nbsp;<span class="ident" id="2684221">RecvDir</span>&nbsp;<span class="op" id="2684229">|</span>&nbsp;<span class="ident" id="2684231">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2684251">//&nbsp;chan</span><br>
<span class="lineno"></span><span class="op" id="2684259">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="2684262">//&nbsp;arrayType&nbsp;represents&nbsp;a&nbsp;fixed&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2684306">type</span>&nbsp;<span class="ident" id="2684311">arrayType</span>&nbsp;<span class="keyword" id="2684321">struct</span>&nbsp;<span class="op" id="2684328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684331">rtype</span>&nbsp;<span class="string" id="2684337">`reflect:&#34;array&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684356">elem</span>&nbsp;&nbsp;<span class="op" id="2684362">*</span><span class="ident" id="2684363">rtype</span>&nbsp;<span class="comment" id="2684369">//&nbsp;array&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684392">slice</span>&nbsp;<span class="op" id="2684398">*</span><span class="ident" id="2684399">rtype</span>&nbsp;<span class="comment" id="2684405">//&nbsp;slice&nbsp;type</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2684420">len</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2684426">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2684434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2684437">//&nbsp;chanType&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2684476">type</span>&nbsp;<span class="ident" id="2684481">chanType</span>&nbsp;<span class="keyword" id="2684490">struct</span>&nbsp;<span class="op" id="2684497">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684500">rtype</span>&nbsp;<span class="string" id="2684506">`reflect:&#34;chan&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684524">elem</span>&nbsp;&nbsp;<span class="op" id="2684530">*</span><span class="ident" id="2684531">rtype</span>&nbsp;&nbsp;<span class="comment" id="2684538">//&nbsp;channel&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684563">dir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2684569">uintptr</span>&nbsp;<span class="comment" id="2684577">//&nbsp;channel&nbsp;direction&nbsp;(ChanDir)</span><br>
<span class="lineno"></span><span class="op" id="2684608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2684611">//&nbsp;funcType&nbsp;represents&nbsp;a&nbsp;function&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2684651">type</span>&nbsp;<span class="ident" id="2684656">funcType</span>&nbsp;<span class="keyword" id="2684665">struct</span>&nbsp;<span class="op" id="2684672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684675">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2684685">`reflect:&#34;func&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684703">dotdotdot</span>&nbsp;<span class="builtintype" id="2684713">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2684722">//&nbsp;last&nbsp;input&nbsp;parameter&nbsp;is&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684754">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2684764">[</span><span class="op" id="2684765">]</span><span class="op" id="2684766">*</span><span class="ident" id="2684767">rtype</span>&nbsp;<span class="comment" id="2684773">//&nbsp;input&nbsp;parameter&nbsp;types</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684799">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2684809">[</span><span class="op" id="2684810">]</span><span class="op" id="2684811">*</span><span class="ident" id="2684812">rtype</span>&nbsp;<span class="comment" id="2684818">//&nbsp;output&nbsp;parameter&nbsp;types</span><br>
<span class="lineno"></span><span class="op" id="2684844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2684847">//&nbsp;imethod&nbsp;represents&nbsp;a&nbsp;method&nbsp;on&nbsp;an&nbsp;interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2684899">type</span>&nbsp;<span class="ident" id="2684904">imethod</span>&nbsp;<span class="keyword" id="2684912">struct</span>&nbsp;<span class="op" id="2684919">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684922">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2684930">*</span><span class="builtintype" id="2684931">string</span>&nbsp;<span class="comment" id="2684938">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2684957">pkgPath</span>&nbsp;<span class="op" id="2684965">*</span><span class="builtintype" id="2684966">string</span>&nbsp;<span class="comment" id="2684973">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685023">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2685031">*</span><span class="ident" id="2685032">rtype</span>&nbsp;&nbsp;<span class="comment" id="2685039">//&nbsp;.(*FuncType)&nbsp;underneath</span><br>
<span class="lineno"></span><span class="op" id="2685066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="comment" id="2685069">//&nbsp;interfaceType&nbsp;represents&nbsp;an&nbsp;interface&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2685116">type</span>&nbsp;<span class="ident" id="2685121">interfaceType</span>&nbsp;<span class="keyword" id="2685135">struct</span>&nbsp;<span class="op" id="2685142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685145">rtype</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2685153">`reflect:&#34;interface&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685176">methods</span>&nbsp;<span class="op" id="2685184">[</span><span class="op" id="2685185">]</span><span class="ident" id="2685186">imethod</span>&nbsp;<span class="comment" id="2685194">//&nbsp;sorted&nbsp;by&nbsp;hash</span><br>
<span class="lineno"></span><span class="op" id="2685212">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="comment" id="2685215">//&nbsp;mapType&nbsp;represents&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2685249">type</span>&nbsp;<span class="ident" id="2685254">mapType</span>&nbsp;<span class="keyword" id="2685262">struct</span>&nbsp;<span class="op" id="2685269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685272">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2685286">`reflect:&#34;map&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685303">key</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2685317">*</span><span class="ident" id="2685318">rtype</span>&nbsp;<span class="comment" id="2685324">//&nbsp;map&nbsp;key&nbsp;type</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685341">elem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2685355">*</span><span class="ident" id="2685356">rtype</span>&nbsp;<span class="comment" id="2685362">//&nbsp;map&nbsp;element&nbsp;(value)&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685391">bucket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2685405">*</span><span class="ident" id="2685406">rtype</span>&nbsp;<span class="comment" id="2685412">//&nbsp;internal&nbsp;bucket&nbsp;structure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685442">hmap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2685456">*</span><span class="ident" id="2685457">rtype</span>&nbsp;<span class="comment" id="2685463">//&nbsp;internal&nbsp;map&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685487">keysize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2685501">uint8</span>&nbsp;&nbsp;<span class="comment" id="2685508">//&nbsp;size&nbsp;of&nbsp;key&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685529">indirectkey</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2685543">uint8</span>&nbsp;&nbsp;<span class="comment" id="2685550">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;key&nbsp;instead&nbsp;of&nbsp;key&nbsp;itself</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685593">valuesize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2685607">uint8</span>&nbsp;&nbsp;<span class="comment" id="2685614">//&nbsp;size&nbsp;of&nbsp;value&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685637">indirectvalue</span>&nbsp;<span class="builtintype" id="2685651">uint8</span>&nbsp;&nbsp;<span class="comment" id="2685658">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;value&nbsp;instead&nbsp;of&nbsp;value&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685705">bucketsize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2685719">uint16</span>&nbsp;<span class="comment" id="2685726">//&nbsp;size&nbsp;of&nbsp;bucket</span><br>
<span class="lineno"></span><span class="op" id="2685744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="2685747">//&nbsp;ptrType&nbsp;represents&nbsp;a&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2685785">type</span>&nbsp;<span class="ident" id="2685790">ptrType</span>&nbsp;<span class="keyword" id="2685798">struct</span>&nbsp;<span class="op" id="2685805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685808">rtype</span>&nbsp;<span class="string" id="2685814">`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685831">elem</span>&nbsp;&nbsp;<span class="op" id="2685837">*</span><span class="ident" id="2685838">rtype</span>&nbsp;<span class="comment" id="2685844">//&nbsp;pointer&nbsp;element&nbsp;(pointed&nbsp;at)&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2685881">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2685884">//&nbsp;sliceType&nbsp;represents&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2685922">type</span>&nbsp;<span class="ident" id="2685927">sliceType</span>&nbsp;<span class="keyword" id="2685937">struct</span>&nbsp;<span class="op" id="2685944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685947">rtype</span>&nbsp;<span class="string" id="2685953">`reflect:&#34;slice&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685972">elem</span>&nbsp;&nbsp;<span class="op" id="2685978">*</span><span class="ident" id="2685979">rtype</span>&nbsp;<span class="comment" id="2685985">//&nbsp;slice&nbsp;element&nbsp;type</span><br>
<span class="lineno">360</span><span class="op" id="2686007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2686010">//&nbsp;Struct&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="2686026">type</span>&nbsp;<span class="ident" id="2686031">structField</span>&nbsp;<span class="keyword" id="2686043">struct</span>&nbsp;<span class="op" id="2686050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2686053">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2686061">*</span><span class="builtintype" id="2686062">string</span>&nbsp;<span class="comment" id="2686069">//&nbsp;nil&nbsp;for&nbsp;embedded&nbsp;fields</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2686097">pkgPath</span>&nbsp;<span class="op" id="2686105">*</span><span class="builtintype" id="2686106">string</span>&nbsp;<span class="comment" id="2686113">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2686163">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2686171">*</span><span class="ident" id="2686172">rtype</span>&nbsp;&nbsp;<span class="comment" id="2686179">//&nbsp;type&nbsp;of&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2686197">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2686205">*</span><span class="builtintype" id="2686206">string</span>&nbsp;<span class="comment" id="2686213">//&nbsp;nil&nbsp;if&nbsp;no&nbsp;tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2686231">offset</span>&nbsp;&nbsp;<span class="builtintype" id="2686239">uintptr</span>&nbsp;<span class="comment" id="2686247">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;field&nbsp;within&nbsp;struct</span><br>
<span class="lineno"></span><span class="op" id="2686285">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="2686288">//&nbsp;structType&nbsp;represents&nbsp;a&nbsp;struct&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2686328">type</span>&nbsp;<span class="ident" id="2686333">structType</span>&nbsp;<span class="keyword" id="2686344">struct</span>&nbsp;<span class="op" id="2686351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2686354">rtype</span>&nbsp;&nbsp;<span class="string" id="2686361">`reflect:&#34;struct&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2686381">fields</span>&nbsp;<span class="op" id="2686388">[</span><span class="op" id="2686389">]</span><span class="ident" id="2686390">structField</span>&nbsp;<span class="comment" id="2686402">//&nbsp;sorted&nbsp;by&nbsp;offset</span><br>
<span class="lineno">375</span><span class="op" id="2686422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2686425">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;knows&nbsp;the&nbsp;exact&nbsp;layout&nbsp;of&nbsp;all&nbsp;the&nbsp;data&nbsp;structures&nbsp;above.<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;does&nbsp;not&nbsp;know&nbsp;about&nbsp;the&nbsp;data&nbsp;structures&nbsp;and&nbsp;methods&nbsp;below.<br>
<span class="lineno">380</span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2686581">//&nbsp;Method&nbsp;represents&nbsp;a&nbsp;single&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2686619">type</span>&nbsp;<span class="ident" id="2686624">Method</span>&nbsp;<span class="keyword" id="2686631">struct</span>&nbsp;<span class="op" id="2686638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2686641">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;method&nbsp;name.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2686670">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2686743">//&nbsp;method&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;method&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2686813">//&nbsp;The&nbsp;combination&nbsp;of&nbsp;PkgPath&nbsp;and&nbsp;Name&nbsp;uniquely&nbsp;identifies&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2686882">//&nbsp;in&nbsp;a&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2686903">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2686964">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2686972">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2686980">PkgPath</span>&nbsp;<span class="builtintype" id="2686988">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2686997">Type</span>&nbsp;&nbsp;<span class="ident" id="2687003">Type</span>&nbsp;&nbsp;<span class="comment" id="2687009">//&nbsp;method&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687025">Func</span>&nbsp;&nbsp;<span class="ident" id="2687031">Value</span>&nbsp;<span class="comment" id="2687037">//&nbsp;func&nbsp;with&nbsp;receiver&nbsp;as&nbsp;first&nbsp;argument</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687078">Index</span>&nbsp;<span class="builtintype" id="2687084">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2687090">//&nbsp;index&nbsp;for&nbsp;Type.Method</span><br>
<span class="lineno"></span><span class="op" id="2687115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2687118">const</span>&nbsp;<span class="op" id="2687124">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687127">kindDirectIface</span>&nbsp;<span class="op" id="2687143">=</span>&nbsp;<span class="num" id="2687145">1</span>&nbsp;<span class="op" id="2687147">&lt;&lt;</span>&nbsp;<span class="num" id="2687150">5</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687153">kindGCProg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2687169">=</span>&nbsp;<span class="num" id="2687171">1</span>&nbsp;<span class="op" id="2687173">&lt;&lt;</span>&nbsp;<span class="num" id="2687176">6</span>&nbsp;<span class="comment" id="2687178">//&nbsp;Type.gc&nbsp;points&nbsp;to&nbsp;GC&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687211">kindNoPointers</span>&nbsp;&nbsp;<span class="op" id="2687227">=</span>&nbsp;<span class="num" id="2687229">1</span>&nbsp;<span class="op" id="2687231">&lt;&lt;</span>&nbsp;<span class="num" id="2687234">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687237">kindMask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2687253">=</span>&nbsp;<span class="op" id="2687255">(</span><span class="num" id="2687256">1</span>&nbsp;<span class="op" id="2687258">&lt;&lt;</span>&nbsp;<span class="num" id="2687261">5</span><span class="op" id="2687262">)</span>&nbsp;<span class="op" id="2687264">-</span>&nbsp;<span class="num" id="2687266">1</span><br>
<span class="lineno"></span><span class="op" id="2687268">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="keyword" id="2687271">func</span>&nbsp;<span class="op" id="2687276">(</span><span class="ident" id="2687277">k</span>&nbsp;<span class="ident" id="2687279">Kind</span><span class="op" id="2687283">)</span>&nbsp;<span class="ident" id="2687285">String</span><span class="op" id="2687291">(</span><span class="op" id="2687292">)</span>&nbsp;<span class="builtintype" id="2687294">string</span>&nbsp;<span class="op" id="2687301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2687304">if</span>&nbsp;<span class="builtintype" id="2687307">int</span><span class="op" id="2687310">(</span><span class="ident" id="2687311">k</span><span class="op" id="2687312">)</span>&nbsp;<span class="op" id="2687314">&lt;</span>&nbsp;<span class="builtinfunc" id="2687316">len</span><span class="op" id="2687319">(</span><span class="ident" id="2687320">kindNames</span><span class="op" id="2687329">)</span>&nbsp;<span class="op" id="2687331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2687335">return</span>&nbsp;<span class="ident" id="2687342">kindNames</span><span class="op" id="2687351">[</span><span class="ident" id="2687352">k</span><span class="op" id="2687353">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2687356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2687359">return</span>&nbsp;<span class="string" id="2687366">&#34;kind&#34;</span>&nbsp;<span class="op" id="2687373">+</span>&nbsp;<span class="ident" id="2687375">strconv</span><span class="op" id="2687382">.</span><span class="ident" id="2687383">Itoa</span><span class="op" id="2687387">(</span><span class="builtintype" id="2687388">int</span><span class="op" id="2687391">(</span><span class="ident" id="2687392">k</span><span class="op" id="2687393">)</span><span class="op" id="2687394">)</span><br>
<span class="lineno">410</span><span class="op" id="2687396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2687399">var</span>&nbsp;<span class="ident" id="2687403">kindNames</span>&nbsp;<span class="op" id="2687413">=</span>&nbsp;<span class="op" id="2687415">[</span><span class="op" id="2687416">]</span><span class="builtintype" id="2687417">string</span><span class="op" id="2687423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687426">Invalid</span><span class="op" id="2687433">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687441">&#34;invalid&#34;</span><span class="op" id="2687450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687453">Bool</span><span class="op" id="2687457">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687468">&#34;bool&#34;</span><span class="op" id="2687474">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687477">Int</span><span class="op" id="2687480">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687492">&#34;int&#34;</span><span class="op" id="2687497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687500">Int8</span><span class="op" id="2687504">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687515">&#34;int8&#34;</span><span class="op" id="2687521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687524">Int16</span><span class="op" id="2687529">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687539">&#34;int16&#34;</span><span class="op" id="2687546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687549">Int32</span><span class="op" id="2687554">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687564">&#34;int32&#34;</span><span class="op" id="2687571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687574">Int64</span><span class="op" id="2687579">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687589">&#34;int64&#34;</span><span class="op" id="2687596">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687599">Uint</span><span class="op" id="2687603">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687614">&#34;uint&#34;</span><span class="op" id="2687620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687623">Uint8</span><span class="op" id="2687628">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687638">&#34;uint8&#34;</span><span class="op" id="2687645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687648">Uint16</span><span class="op" id="2687654">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687663">&#34;uint16&#34;</span><span class="op" id="2687671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687674">Uint32</span><span class="op" id="2687680">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687689">&#34;uint32&#34;</span><span class="op" id="2687697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687700">Uint64</span><span class="op" id="2687706">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687715">&#34;uint64&#34;</span><span class="op" id="2687723">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687726">Uintptr</span><span class="op" id="2687733">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687741">&#34;uintptr&#34;</span><span class="op" id="2687750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687753">Float32</span><span class="op" id="2687760">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687768">&#34;float32&#34;</span><span class="op" id="2687777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687780">Float64</span><span class="op" id="2687787">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687795">&#34;float64&#34;</span><span class="op" id="2687804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687807">Complex64</span><span class="op" id="2687816">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687822">&#34;complex64&#34;</span><span class="op" id="2687833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687836">Complex128</span><span class="op" id="2687846">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687851">&#34;complex128&#34;</span><span class="op" id="2687863">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687866">Array</span><span class="op" id="2687871">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687881">&#34;array&#34;</span><span class="op" id="2687888">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687891">Chan</span><span class="op" id="2687895">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687906">&#34;chan&#34;</span><span class="op" id="2687912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687915">Func</span><span class="op" id="2687919">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687930">&#34;func&#34;</span><span class="op" id="2687936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687939">Interface</span><span class="op" id="2687948">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687954">&#34;interface&#34;</span><span class="op" id="2687965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687968">Map</span><span class="op" id="2687971">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2687983">&#34;map&#34;</span><span class="op" id="2687988">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2687991">Ptr</span><span class="op" id="2687994">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2688006">&#34;ptr&#34;</span><span class="op" id="2688011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2688014">Slice</span><span class="op" id="2688019">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2688029">&#34;slice&#34;</span><span class="op" id="2688036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2688039">String</span><span class="op" id="2688045">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2688054">&#34;string&#34;</span><span class="op" id="2688062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2688065">Struct</span><span class="op" id="2688071">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2688080">&#34;struct&#34;</span><span class="op" id="2688088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2688091">UnsafePointer</span><span class="op" id="2688104">:</span>&nbsp;<span class="string" id="2688106">&#34;unsafe.Pointer&#34;</span><span class="op" id="2688122">,</span><br>
<span class="lineno">440</span><span class="op" id="2688124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2688127">func</span>&nbsp;<span class="op" id="2688132">(</span><span class="ident" id="2688133">t</span>&nbsp;<span class="op" id="2688135">*</span><span class="ident" id="2688136">uncommonType</span><span class="op" id="2688148">)</span>&nbsp;<span class="ident" id="2688150">uncommon</span><span class="op" id="2688158">(</span><span class="op" id="2688159">)</span>&nbsp;<span class="op" id="2688161">*</span><span class="ident" id="2688162">uncommonType</span>&nbsp;<span class="op" id="2688175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2688178">return</span>&nbsp;<span class="ident" id="2688185">t</span><br>
<span class="lineno"></span><span class="op" id="2688187">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="2688190">func</span>&nbsp;<span class="op" id="2688195">(</span><span class="ident" id="2688196">t</span>&nbsp;<span class="op" id="2688198">*</span><span class="ident" id="2688199">uncommonType</span><span class="op" id="2688211">)</span>&nbsp;<span class="ident" id="2688213">PkgPath</span><span class="op" id="2688220">(</span><span class="op" id="2688221">)</span>&nbsp;<span class="builtintype" id="2688223">string</span>&nbsp;<span class="op" id="2688230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2688233">if</span>&nbsp;<span class="ident" id="2688236">t</span>&nbsp;<span class="op" id="2688238">==</span>&nbsp;<span class="builtintype" id="2688241">nil</span>&nbsp;<span class="op" id="2688245">||</span>&nbsp;<span class="ident" id="2688248">t</span><span class="op" id="2688249">.</span><span class="ident" id="2688250">pkgPath</span>&nbsp;<span class="op" id="2688258">==</span>&nbsp;<span class="builtintype" id="2688261">nil</span>&nbsp;<span class="op" id="2688265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2688269">return</span>&nbsp;<span class="string" id="2688276">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2688280">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2688283">return</span>&nbsp;<span class="op" id="2688290">*</span><span class="ident" id="2688291">t</span><span class="op" id="2688292">.</span><span class="ident" id="2688293">pkgPath</span><br>
<span class="lineno"></span><span class="op" id="2688301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2688304">func</span>&nbsp;<span class="op" id="2688309">(</span><span class="ident" id="2688310">t</span>&nbsp;<span class="op" id="2688312">*</span><span class="ident" id="2688313">uncommonType</span><span class="op" id="2688325">)</span>&nbsp;<span class="ident" id="2688327">Name</span><span class="op" id="2688331">(</span><span class="op" id="2688332">)</span>&nbsp;<span class="builtintype" id="2688334">string</span>&nbsp;<span class="op" id="2688341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2688344">if</span>&nbsp;<span class="ident" id="2688347">t</span>&nbsp;<span class="op" id="2688349">==</span>&nbsp;<span class="builtintype" id="2688352">nil</span>&nbsp;<span class="op" id="2688356">||</span>&nbsp;<span class="ident" id="2688359">t</span><span class="op" id="2688360">.</span><span class="ident" id="2688361">name</span>&nbsp;<span class="op" id="2688366">==</span>&nbsp;<span class="builtintype" id="2688369">nil</span>&nbsp;<span class="op" id="2688373">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2688377">return</span>&nbsp;<span class="string" id="2688384">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2688388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2688391">return</span>&nbsp;<span class="op" id="2688398">*</span><span class="ident" id="2688399">t</span><span class="op" id="2688400">.</span><span class="ident" id="2688401">name</span><br>
<span class="lineno"></span><span class="op" id="2688406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="2688409">func</span>&nbsp;<span class="op" id="2688414">(</span><span class="ident" id="2688415">t</span>&nbsp;<span class="op" id="2688417">*</span><span class="ident" id="2688418">rtype</span><span class="op" id="2688423">)</span>&nbsp;<span class="ident" id="2688425">String</span><span class="op" id="2688431">(</span><span class="op" id="2688432">)</span>&nbsp;<span class="builtintype" id="2688434">string</span>&nbsp;<span class="op" id="2688441">{</span>&nbsp;<span class="keyword" id="2688443">return</span>&nbsp;<span class="op" id="2688450">*</span><span class="ident" id="2688451">t</span><span class="op" id="2688452">.</span><span class="builtintype" id="2688453">string</span>&nbsp;<span class="op" id="2688460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2688463">func</span>&nbsp;<span class="op" id="2688468">(</span><span class="ident" id="2688469">t</span>&nbsp;<span class="op" id="2688471">*</span><span class="ident" id="2688472">rtype</span><span class="op" id="2688477">)</span>&nbsp;<span class="ident" id="2688479">Size</span><span class="op" id="2688483">(</span><span class="op" id="2688484">)</span>&nbsp;<span class="builtintype" id="2688486">uintptr</span>&nbsp;<span class="op" id="2688494">{</span>&nbsp;<span class="keyword" id="2688496">return</span>&nbsp;<span class="ident" id="2688503">t</span><span class="op" id="2688504">.</span><span class="ident" id="2688505">size</span>&nbsp;<span class="op" id="2688510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2688513">func</span>&nbsp;<span class="op" id="2688518">(</span><span class="ident" id="2688519">t</span>&nbsp;<span class="op" id="2688521">*</span><span class="ident" id="2688522">rtype</span><span class="op" id="2688527">)</span>&nbsp;<span class="ident" id="2688529">Bits</span><span class="op" id="2688533">(</span><span class="op" id="2688534">)</span>&nbsp;<span class="builtintype" id="2688536">int</span>&nbsp;<span class="op" id="2688540">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2688543">if</span>&nbsp;<span class="ident" id="2688546">t</span>&nbsp;<span class="op" id="2688548">==</span>&nbsp;<span class="builtintype" id="2688551">nil</span>&nbsp;<span class="op" id="2688555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2688559">panic</span><span class="op" id="2688564">(</span><span class="string" id="2688565">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;nil&nbsp;Type&#34;</span><span class="op" id="2688592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2688595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2688598">k</span>&nbsp;<span class="op" id="2688600">:=</span>&nbsp;<span class="ident" id="2688603">t</span><span class="op" id="2688604">.</span><span class="ident" id="2688605">Kind</span><span class="op" id="2688609">(</span><span class="op" id="2688610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2688613">if</span>&nbsp;<span class="ident" id="2688616">k</span>&nbsp;<span class="op" id="2688618">&lt;</span>&nbsp;<span class="ident" id="2688620">Int</span>&nbsp;<span class="op" id="2688624">||</span>&nbsp;<span class="ident" id="2688627">k</span>&nbsp;<span class="op" id="2688629">&gt;</span>&nbsp;<span class="ident" id="2688631">Complex128</span>&nbsp;<span class="op" id="2688642">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2688646">panic</span><span class="op" id="2688651">(</span><span class="string" id="2688652">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;non-arithmetic&nbsp;Type&nbsp;&#34;</span>&nbsp;<span class="op" id="2688692">+</span>&nbsp;<span class="ident" id="2688694">t</span><span class="op" id="2688695">.</span><span class="ident" id="2688696">String</span><span class="op" id="2688702">(</span><span class="op" id="2688703">)</span><span class="op" id="2688704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2688707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2688710">return</span>&nbsp;<span class="builtintype" id="2688717">int</span><span class="op" id="2688720">(</span><span class="ident" id="2688721">t</span><span class="op" id="2688722">.</span><span class="ident" id="2688723">size</span><span class="op" id="2688727">)</span>&nbsp;<span class="op" id="2688729">*</span>&nbsp;<span class="num" id="2688731">8</span><br>
<span class="lineno"></span><span class="op" id="2688733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="2688736">func</span>&nbsp;<span class="op" id="2688741">(</span><span class="ident" id="2688742">t</span>&nbsp;<span class="op" id="2688744">*</span><span class="ident" id="2688745">rtype</span><span class="op" id="2688750">)</span>&nbsp;<span class="ident" id="2688752">Align</span><span class="op" id="2688757">(</span><span class="op" id="2688758">)</span>&nbsp;<span class="builtintype" id="2688760">int</span>&nbsp;<span class="op" id="2688764">{</span>&nbsp;<span class="keyword" id="2688766">return</span>&nbsp;<span class="builtintype" id="2688773">int</span><span class="op" id="2688776">(</span><span class="ident" id="2688777">t</span><span class="op" id="2688778">.</span><span class="ident" id="2688779">align</span><span class="op" id="2688784">)</span>&nbsp;<span class="op" id="2688786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2688789">func</span>&nbsp;<span class="op" id="2688794">(</span><span class="ident" id="2688795">t</span>&nbsp;<span class="op" id="2688797">*</span><span class="ident" id="2688798">rtype</span><span class="op" id="2688803">)</span>&nbsp;<span class="ident" id="2688805">FieldAlign</span><span class="op" id="2688815">(</span><span class="op" id="2688816">)</span>&nbsp;<span class="builtintype" id="2688818">int</span>&nbsp;<span class="op" id="2688822">{</span>&nbsp;<span class="keyword" id="2688824">return</span>&nbsp;<span class="builtintype" id="2688831">int</span><span class="op" id="2688834">(</span><span class="ident" id="2688835">t</span><span class="op" id="2688836">.</span><span class="ident" id="2688837">fieldAlign</span><span class="op" id="2688847">)</span>&nbsp;<span class="op" id="2688849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2688852">func</span>&nbsp;<span class="op" id="2688857">(</span><span class="ident" id="2688858">t</span>&nbsp;<span class="op" id="2688860">*</span><span class="ident" id="2688861">rtype</span><span class="op" id="2688866">)</span>&nbsp;<span class="ident" id="2688868">Kind</span><span class="op" id="2688872">(</span><span class="op" id="2688873">)</span>&nbsp;<span class="ident" id="2688875">Kind</span>&nbsp;<span class="op" id="2688880">{</span>&nbsp;<span class="keyword" id="2688882">return</span>&nbsp;<span class="ident" id="2688889">Kind</span><span class="op" id="2688893">(</span><span class="ident" id="2688894">t</span><span class="op" id="2688895">.</span><span class="ident" id="2688896">kind</span>&nbsp;<span class="op" id="2688901">&amp;</span>&nbsp;<span class="ident" id="2688903">kindMask</span><span class="op" id="2688911">)</span>&nbsp;<span class="op" id="2688913">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="keyword" id="2688916">func</span>&nbsp;<span class="op" id="2688921">(</span><span class="ident" id="2688922">t</span>&nbsp;<span class="op" id="2688924">*</span><span class="ident" id="2688925">rtype</span><span class="op" id="2688930">)</span>&nbsp;<span class="ident" id="2688932">pointers</span><span class="op" id="2688940">(</span><span class="op" id="2688941">)</span>&nbsp;<span class="builtintype" id="2688943">bool</span>&nbsp;<span class="op" id="2688948">{</span>&nbsp;<span class="keyword" id="2688950">return</span>&nbsp;<span class="ident" id="2688957">t</span><span class="op" id="2688958">.</span><span class="ident" id="2688959">kind</span><span class="op" id="2688963">&amp;</span><span class="ident" id="2688964">kindNoPointers</span>&nbsp;<span class="op" id="2688979">==</span>&nbsp;<span class="num" id="2688982">0</span>&nbsp;<span class="op" id="2688984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2688987">func</span>&nbsp;<span class="op" id="2688992">(</span><span class="ident" id="2688993">t</span>&nbsp;<span class="op" id="2688995">*</span><span class="ident" id="2688996">rtype</span><span class="op" id="2689001">)</span>&nbsp;<span class="ident" id="2689003">common</span><span class="op" id="2689009">(</span><span class="op" id="2689010">)</span>&nbsp;<span class="op" id="2689012">*</span><span class="ident" id="2689013">rtype</span>&nbsp;<span class="op" id="2689019">{</span>&nbsp;<span class="keyword" id="2689021">return</span>&nbsp;<span class="ident" id="2689028">t</span>&nbsp;<span class="op" id="2689030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2689033">func</span>&nbsp;<span class="op" id="2689038">(</span><span class="ident" id="2689039">t</span>&nbsp;<span class="op" id="2689041">*</span><span class="ident" id="2689042">uncommonType</span><span class="op" id="2689054">)</span>&nbsp;<span class="ident" id="2689056">Method</span><span class="op" id="2689062">(</span><span class="ident" id="2689063">i</span>&nbsp;<span class="builtintype" id="2689065">int</span><span class="op" id="2689068">)</span>&nbsp;<span class="op" id="2689070">(</span><span class="ident" id="2689071">m</span>&nbsp;<span class="ident" id="2689073">Method</span><span class="op" id="2689079">)</span>&nbsp;<span class="op" id="2689081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689084">if</span>&nbsp;<span class="ident" id="2689087">t</span>&nbsp;<span class="op" id="2689089">==</span>&nbsp;<span class="builtintype" id="2689092">nil</span>&nbsp;<span class="op" id="2689096">||</span>&nbsp;<span class="ident" id="2689099">i</span>&nbsp;<span class="op" id="2689101">&lt;</span>&nbsp;<span class="num" id="2689103">0</span>&nbsp;<span class="op" id="2689105">||</span>&nbsp;<span class="ident" id="2689108">i</span>&nbsp;<span class="op" id="2689110">&gt;=</span>&nbsp;<span class="builtinfunc" id="2689113">len</span><span class="op" id="2689116">(</span><span class="ident" id="2689117">t</span><span class="op" id="2689118">.</span><span class="ident" id="2689119">methods</span><span class="op" id="2689126">)</span>&nbsp;<span class="op" id="2689128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2689132">panic</span><span class="op" id="2689137">(</span><span class="string" id="2689138">&#34;reflect:&nbsp;Method&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="2689174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2689177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2689180">p</span>&nbsp;<span class="op" id="2689182">:=</span>&nbsp;<span class="op" id="2689185">&amp;</span><span class="ident" id="2689186">t</span><span class="op" id="2689187">.</span><span class="ident" id="2689188">methods</span><span class="op" id="2689195">[</span><span class="ident" id="2689196">i</span><span class="op" id="2689197">]</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689200">if</span>&nbsp;<span class="ident" id="2689203">p</span><span class="op" id="2689204">.</span><span class="ident" id="2689205">name</span>&nbsp;<span class="op" id="2689210">!=</span>&nbsp;<span class="builtintype" id="2689213">nil</span>&nbsp;<span class="op" id="2689217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2689221">m</span><span class="op" id="2689222">.</span><span class="ident" id="2689223">Name</span>&nbsp;<span class="op" id="2689228">=</span>&nbsp;<span class="op" id="2689230">*</span><span class="ident" id="2689231">p</span><span class="op" id="2689232">.</span><span class="ident" id="2689233">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2689239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2689242">fl</span>&nbsp;<span class="op" id="2689245">:=</span>&nbsp;<span class="ident" id="2689248">flag</span><span class="op" id="2689252">(</span><span class="ident" id="2689253">Func</span><span class="op" id="2689257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689260">if</span>&nbsp;<span class="ident" id="2689263">p</span><span class="op" id="2689264">.</span><span class="ident" id="2689265">pkgPath</span>&nbsp;<span class="op" id="2689273">!=</span>&nbsp;<span class="builtintype" id="2689276">nil</span>&nbsp;<span class="op" id="2689280">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2689284">m</span><span class="op" id="2689285">.</span><span class="ident" id="2689286">PkgPath</span>&nbsp;<span class="op" id="2689294">=</span>&nbsp;<span class="op" id="2689296">*</span><span class="ident" id="2689297">p</span><span class="op" id="2689298">.</span><span class="ident" id="2689299">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2689309">fl</span>&nbsp;<span class="op" id="2689312">|=</span>&nbsp;<span class="ident" id="2689315">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2689323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2689326">mt</span>&nbsp;<span class="op" id="2689329">:=</span>&nbsp;<span class="ident" id="2689332">p</span><span class="op" id="2689333">.</span><span class="ident" id="2689334">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2689339">m</span><span class="op" id="2689340">.</span><span class="ident" id="2689341">Type</span>&nbsp;<span class="op" id="2689346">=</span>&nbsp;<span class="ident" id="2689348">mt</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2689352">fn</span>&nbsp;<span class="op" id="2689355">:=</span>&nbsp;<span class="ident" id="2689358">unsafe</span><span class="op" id="2689364">.</span><span class="ident" id="2689365">Pointer</span><span class="op" id="2689372">(</span><span class="op" id="2689373">&amp;</span><span class="ident" id="2689374">p</span><span class="op" id="2689375">.</span><span class="ident" id="2689376">tfn</span><span class="op" id="2689379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2689382">m</span><span class="op" id="2689383">.</span><span class="ident" id="2689384">Func</span>&nbsp;<span class="op" id="2689389">=</span>&nbsp;<span class="ident" id="2689391">Value</span><span class="op" id="2689396">{</span><span class="ident" id="2689397">mt</span><span class="op" id="2689399">,</span>&nbsp;<span class="ident" id="2689401">fn</span><span class="op" id="2689403">,</span>&nbsp;<span class="ident" id="2689405">fl</span><span class="op" id="2689407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2689410">m</span><span class="op" id="2689411">.</span><span class="ident" id="2689412">Index</span>&nbsp;<span class="op" id="2689418">=</span>&nbsp;<span class="ident" id="2689420">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689423">return</span><br>
<span class="lineno"></span><span class="op" id="2689430">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="2689433">func</span>&nbsp;<span class="op" id="2689438">(</span><span class="ident" id="2689439">t</span>&nbsp;<span class="op" id="2689441">*</span><span class="ident" id="2689442">uncommonType</span><span class="op" id="2689454">)</span>&nbsp;<span class="ident" id="2689456">NumMethod</span><span class="op" id="2689465">(</span><span class="op" id="2689466">)</span>&nbsp;<span class="builtintype" id="2689468">int</span>&nbsp;<span class="op" id="2689472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689475">if</span>&nbsp;<span class="ident" id="2689478">t</span>&nbsp;<span class="op" id="2689480">==</span>&nbsp;<span class="builtintype" id="2689483">nil</span>&nbsp;<span class="op" id="2689487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689491">return</span>&nbsp;<span class="num" id="2689498">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2689501">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689504">return</span>&nbsp;<span class="builtinfunc" id="2689511">len</span><span class="op" id="2689514">(</span><span class="ident" id="2689515">t</span><span class="op" id="2689516">.</span><span class="ident" id="2689517">methods</span><span class="op" id="2689524">)</span><br>
<span class="lineno"></span><span class="op" id="2689526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2689529">func</span>&nbsp;<span class="op" id="2689534">(</span><span class="ident" id="2689535">t</span>&nbsp;<span class="op" id="2689537">*</span><span class="ident" id="2689538">uncommonType</span><span class="op" id="2689550">)</span>&nbsp;<span class="ident" id="2689552">MethodByName</span><span class="op" id="2689564">(</span><span class="ident" id="2689565">name</span>&nbsp;<span class="builtintype" id="2689570">string</span><span class="op" id="2689576">)</span>&nbsp;<span class="op" id="2689578">(</span><span class="ident" id="2689579">m</span>&nbsp;<span class="ident" id="2689581">Method</span><span class="op" id="2689587">,</span>&nbsp;<span class="ident" id="2689589">ok</span>&nbsp;<span class="builtintype" id="2689592">bool</span><span class="op" id="2689596">)</span>&nbsp;<span class="op" id="2689598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689601">if</span>&nbsp;<span class="ident" id="2689604">t</span>&nbsp;<span class="op" id="2689606">==</span>&nbsp;<span class="builtintype" id="2689609">nil</span>&nbsp;<span class="op" id="2689613">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689617">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2689625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689628">var</span>&nbsp;<span class="ident" id="2689632">p</span>&nbsp;<span class="op" id="2689634">*</span><span class="ident" id="2689635">method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689643">for</span>&nbsp;<span class="ident" id="2689647">i</span>&nbsp;<span class="op" id="2689649">:=</span>&nbsp;<span class="keyword" id="2689652">range</span>&nbsp;<span class="ident" id="2689658">t</span><span class="op" id="2689659">.</span><span class="ident" id="2689660">methods</span>&nbsp;<span class="op" id="2689668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2689672">p</span>&nbsp;<span class="op" id="2689674">=</span>&nbsp;<span class="op" id="2689676">&amp;</span><span class="ident" id="2689677">t</span><span class="op" id="2689678">.</span><span class="ident" id="2689679">methods</span><span class="op" id="2689686">[</span><span class="ident" id="2689687">i</span><span class="op" id="2689688">]</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689692">if</span>&nbsp;<span class="ident" id="2689695">p</span><span class="op" id="2689696">.</span><span class="ident" id="2689697">name</span>&nbsp;<span class="op" id="2689702">!=</span>&nbsp;<span class="builtintype" id="2689705">nil</span>&nbsp;<span class="op" id="2689709">&amp;&amp;</span>&nbsp;<span class="op" id="2689712">*</span><span class="ident" id="2689713">p</span><span class="op" id="2689714">.</span><span class="ident" id="2689715">name</span>&nbsp;<span class="op" id="2689720">==</span>&nbsp;<span class="ident" id="2689723">name</span>&nbsp;<span class="op" id="2689728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689733">return</span>&nbsp;<span class="ident" id="2689740">t</span><span class="op" id="2689741">.</span><span class="ident" id="2689742">Method</span><span class="op" id="2689748">(</span><span class="ident" id="2689749">i</span><span class="op" id="2689750">)</span><span class="op" id="2689751">,</span>&nbsp;<span class="builtintype" id="2689753">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2689760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2689763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689766">return</span><br>
<span class="lineno">525</span><span class="op" id="2689773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2689776">//&nbsp;TODO(rsc):&nbsp;6g&nbsp;supplies&nbsp;these,&nbsp;but&nbsp;they&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2689826">//&nbsp;as&nbsp;efficient&nbsp;as&nbsp;they&nbsp;could&nbsp;be:&nbsp;they&nbsp;have&nbsp;commonType</span><br>
<span class="lineno"></span><span class="comment" id="2689881">//&nbsp;as&nbsp;the&nbsp;receiver&nbsp;instead&nbsp;of&nbsp;*rtype.</span><br>
<span class="lineno">530</span><span class="keyword" id="2689919">func</span>&nbsp;<span class="op" id="2689924">(</span><span class="ident" id="2689925">t</span>&nbsp;<span class="op" id="2689927">*</span><span class="ident" id="2689928">rtype</span><span class="op" id="2689933">)</span>&nbsp;<span class="ident" id="2689935">NumMethod</span><span class="op" id="2689944">(</span><span class="op" id="2689945">)</span>&nbsp;<span class="builtintype" id="2689947">int</span>&nbsp;<span class="op" id="2689951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2689954">if</span>&nbsp;<span class="ident" id="2689957">t</span><span class="op" id="2689958">.</span><span class="ident" id="2689959">Kind</span><span class="op" id="2689963">(</span><span class="op" id="2689964">)</span>&nbsp;<span class="op" id="2689966">==</span>&nbsp;<span class="ident" id="2689969">Interface</span>&nbsp;<span class="op" id="2689979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2689983">tt</span>&nbsp;<span class="op" id="2689986">:=</span>&nbsp;<span class="op" id="2689989">(</span><span class="op" id="2689990">*</span><span class="ident" id="2689991">interfaceType</span><span class="op" id="2690004">)</span><span class="op" id="2690005">(</span><span class="ident" id="2690006">unsafe</span><span class="op" id="2690012">.</span><span class="ident" id="2690013">Pointer</span><span class="op" id="2690020">(</span><span class="ident" id="2690021">t</span><span class="op" id="2690022">)</span><span class="op" id="2690023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690027">return</span>&nbsp;<span class="ident" id="2690034">tt</span><span class="op" id="2690036">.</span><span class="ident" id="2690037">NumMethod</span><span class="op" id="2690046">(</span><span class="op" id="2690047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2690050">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690053">return</span>&nbsp;<span class="ident" id="2690060">t</span><span class="op" id="2690061">.</span><span class="ident" id="2690062">uncommonType</span><span class="op" id="2690074">.</span><span class="ident" id="2690075">NumMethod</span><span class="op" id="2690084">(</span><span class="op" id="2690085">)</span><br>
<span class="lineno"></span><span class="op" id="2690087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2690090">func</span>&nbsp;<span class="op" id="2690095">(</span><span class="ident" id="2690096">t</span>&nbsp;<span class="op" id="2690098">*</span><span class="ident" id="2690099">rtype</span><span class="op" id="2690104">)</span>&nbsp;<span class="ident" id="2690106">Method</span><span class="op" id="2690112">(</span><span class="ident" id="2690113">i</span>&nbsp;<span class="builtintype" id="2690115">int</span><span class="op" id="2690118">)</span>&nbsp;<span class="op" id="2690120">(</span><span class="ident" id="2690121">m</span>&nbsp;<span class="ident" id="2690123">Method</span><span class="op" id="2690129">)</span>&nbsp;<span class="op" id="2690131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690134">if</span>&nbsp;<span class="ident" id="2690137">t</span><span class="op" id="2690138">.</span><span class="ident" id="2690139">Kind</span><span class="op" id="2690143">(</span><span class="op" id="2690144">)</span>&nbsp;<span class="op" id="2690146">==</span>&nbsp;<span class="ident" id="2690149">Interface</span>&nbsp;<span class="op" id="2690159">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2690163">tt</span>&nbsp;<span class="op" id="2690166">:=</span>&nbsp;<span class="op" id="2690169">(</span><span class="op" id="2690170">*</span><span class="ident" id="2690171">interfaceType</span><span class="op" id="2690184">)</span><span class="op" id="2690185">(</span><span class="ident" id="2690186">unsafe</span><span class="op" id="2690192">.</span><span class="ident" id="2690193">Pointer</span><span class="op" id="2690200">(</span><span class="ident" id="2690201">t</span><span class="op" id="2690202">)</span><span class="op" id="2690203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690207">return</span>&nbsp;<span class="ident" id="2690214">tt</span><span class="op" id="2690216">.</span><span class="ident" id="2690217">Method</span><span class="op" id="2690223">(</span><span class="ident" id="2690224">i</span><span class="op" id="2690225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2690228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690231">return</span>&nbsp;<span class="ident" id="2690238">t</span><span class="op" id="2690239">.</span><span class="ident" id="2690240">uncommonType</span><span class="op" id="2690252">.</span><span class="ident" id="2690253">Method</span><span class="op" id="2690259">(</span><span class="ident" id="2690260">i</span><span class="op" id="2690261">)</span><br>
<span class="lineno"></span><span class="op" id="2690263">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="keyword" id="2690266">func</span>&nbsp;<span class="op" id="2690271">(</span><span class="ident" id="2690272">t</span>&nbsp;<span class="op" id="2690274">*</span><span class="ident" id="2690275">rtype</span><span class="op" id="2690280">)</span>&nbsp;<span class="ident" id="2690282">MethodByName</span><span class="op" id="2690294">(</span><span class="ident" id="2690295">name</span>&nbsp;<span class="builtintype" id="2690300">string</span><span class="op" id="2690306">)</span>&nbsp;<span class="op" id="2690308">(</span><span class="ident" id="2690309">m</span>&nbsp;<span class="ident" id="2690311">Method</span><span class="op" id="2690317">,</span>&nbsp;<span class="ident" id="2690319">ok</span>&nbsp;<span class="builtintype" id="2690322">bool</span><span class="op" id="2690326">)</span>&nbsp;<span class="op" id="2690328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690331">if</span>&nbsp;<span class="ident" id="2690334">t</span><span class="op" id="2690335">.</span><span class="ident" id="2690336">Kind</span><span class="op" id="2690340">(</span><span class="op" id="2690341">)</span>&nbsp;<span class="op" id="2690343">==</span>&nbsp;<span class="ident" id="2690346">Interface</span>&nbsp;<span class="op" id="2690356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2690360">tt</span>&nbsp;<span class="op" id="2690363">:=</span>&nbsp;<span class="op" id="2690366">(</span><span class="op" id="2690367">*</span><span class="ident" id="2690368">interfaceType</span><span class="op" id="2690381">)</span><span class="op" id="2690382">(</span><span class="ident" id="2690383">unsafe</span><span class="op" id="2690389">.</span><span class="ident" id="2690390">Pointer</span><span class="op" id="2690397">(</span><span class="ident" id="2690398">t</span><span class="op" id="2690399">)</span><span class="op" id="2690400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690404">return</span>&nbsp;<span class="ident" id="2690411">tt</span><span class="op" id="2690413">.</span><span class="ident" id="2690414">MethodByName</span><span class="op" id="2690426">(</span><span class="ident" id="2690427">name</span><span class="op" id="2690431">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2690434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690437">return</span>&nbsp;<span class="ident" id="2690444">t</span><span class="op" id="2690445">.</span><span class="ident" id="2690446">uncommonType</span><span class="op" id="2690458">.</span><span class="ident" id="2690459">MethodByName</span><span class="op" id="2690471">(</span><span class="ident" id="2690472">name</span><span class="op" id="2690476">)</span><br>
<span class="lineno"></span><span class="op" id="2690478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2690481">func</span>&nbsp;<span class="op" id="2690486">(</span><span class="ident" id="2690487">t</span>&nbsp;<span class="op" id="2690489">*</span><span class="ident" id="2690490">rtype</span><span class="op" id="2690495">)</span>&nbsp;<span class="ident" id="2690497">PkgPath</span><span class="op" id="2690504">(</span><span class="op" id="2690505">)</span>&nbsp;<span class="builtintype" id="2690507">string</span>&nbsp;<span class="op" id="2690514">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690517">return</span>&nbsp;<span class="ident" id="2690524">t</span><span class="op" id="2690525">.</span><span class="ident" id="2690526">uncommonType</span><span class="op" id="2690538">.</span><span class="ident" id="2690539">PkgPath</span><span class="op" id="2690546">(</span><span class="op" id="2690547">)</span><br>
<span class="lineno"></span><span class="op" id="2690549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2690552">func</span>&nbsp;<span class="op" id="2690557">(</span><span class="ident" id="2690558">t</span>&nbsp;<span class="op" id="2690560">*</span><span class="ident" id="2690561">rtype</span><span class="op" id="2690566">)</span>&nbsp;<span class="ident" id="2690568">Name</span><span class="op" id="2690572">(</span><span class="op" id="2690573">)</span>&nbsp;<span class="builtintype" id="2690575">string</span>&nbsp;<span class="op" id="2690582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690585">return</span>&nbsp;<span class="ident" id="2690592">t</span><span class="op" id="2690593">.</span><span class="ident" id="2690594">uncommonType</span><span class="op" id="2690606">.</span><span class="ident" id="2690607">Name</span><span class="op" id="2690611">(</span><span class="op" id="2690612">)</span><br>
<span class="lineno">560</span><span class="op" id="2690614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2690617">func</span>&nbsp;<span class="op" id="2690622">(</span><span class="ident" id="2690623">t</span>&nbsp;<span class="op" id="2690625">*</span><span class="ident" id="2690626">rtype</span><span class="op" id="2690631">)</span>&nbsp;<span class="ident" id="2690633">ChanDir</span><span class="op" id="2690640">(</span><span class="op" id="2690641">)</span>&nbsp;<span class="ident" id="2690643">ChanDir</span>&nbsp;<span class="op" id="2690651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690654">if</span>&nbsp;<span class="ident" id="2690657">t</span><span class="op" id="2690658">.</span><span class="ident" id="2690659">Kind</span><span class="op" id="2690663">(</span><span class="op" id="2690664">)</span>&nbsp;<span class="op" id="2690666">!=</span>&nbsp;<span class="ident" id="2690669">Chan</span>&nbsp;<span class="op" id="2690674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2690678">panic</span><span class="op" id="2690683">(</span><span class="string" id="2690684">&#34;reflect:&nbsp;ChanDir&nbsp;of&nbsp;non-chan&nbsp;type&#34;</span><span class="op" id="2690719">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2690722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2690725">tt</span>&nbsp;<span class="op" id="2690728">:=</span>&nbsp;<span class="op" id="2690731">(</span><span class="op" id="2690732">*</span><span class="ident" id="2690733">chanType</span><span class="op" id="2690741">)</span><span class="op" id="2690742">(</span><span class="ident" id="2690743">unsafe</span><span class="op" id="2690749">.</span><span class="ident" id="2690750">Pointer</span><span class="op" id="2690757">(</span><span class="ident" id="2690758">t</span><span class="op" id="2690759">)</span><span class="op" id="2690760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690763">return</span>&nbsp;<span class="ident" id="2690770">ChanDir</span><span class="op" id="2690777">(</span><span class="ident" id="2690778">tt</span><span class="op" id="2690780">.</span><span class="ident" id="2690781">dir</span><span class="op" id="2690784">)</span><br>
<span class="lineno"></span><span class="op" id="2690786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="keyword" id="2690789">func</span>&nbsp;<span class="op" id="2690794">(</span><span class="ident" id="2690795">t</span>&nbsp;<span class="op" id="2690797">*</span><span class="ident" id="2690798">rtype</span><span class="op" id="2690803">)</span>&nbsp;<span class="ident" id="2690805">IsVariadic</span><span class="op" id="2690815">(</span><span class="op" id="2690816">)</span>&nbsp;<span class="builtintype" id="2690818">bool</span>&nbsp;<span class="op" id="2690823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690826">if</span>&nbsp;<span class="ident" id="2690829">t</span><span class="op" id="2690830">.</span><span class="ident" id="2690831">Kind</span><span class="op" id="2690835">(</span><span class="op" id="2690836">)</span>&nbsp;<span class="op" id="2690838">!=</span>&nbsp;<span class="ident" id="2690841">Func</span>&nbsp;<span class="op" id="2690846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2690850">panic</span><span class="op" id="2690855">(</span><span class="string" id="2690856">&#34;reflect:&nbsp;IsVariadic&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2690894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2690897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2690900">tt</span>&nbsp;<span class="op" id="2690903">:=</span>&nbsp;<span class="op" id="2690906">(</span><span class="op" id="2690907">*</span><span class="ident" id="2690908">funcType</span><span class="op" id="2690916">)</span><span class="op" id="2690917">(</span><span class="ident" id="2690918">unsafe</span><span class="op" id="2690924">.</span><span class="ident" id="2690925">Pointer</span><span class="op" id="2690932">(</span><span class="ident" id="2690933">t</span><span class="op" id="2690934">)</span><span class="op" id="2690935">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690938">return</span>&nbsp;<span class="ident" id="2690945">tt</span><span class="op" id="2690947">.</span><span class="ident" id="2690948">dotdotdot</span><br>
<span class="lineno"></span><span class="op" id="2690958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2690961">func</span>&nbsp;<span class="op" id="2690966">(</span><span class="ident" id="2690967">t</span>&nbsp;<span class="op" id="2690969">*</span><span class="ident" id="2690970">rtype</span><span class="op" id="2690975">)</span>&nbsp;<span class="ident" id="2690977">Elem</span><span class="op" id="2690981">(</span><span class="op" id="2690982">)</span>&nbsp;<span class="ident" id="2690984">Type</span>&nbsp;<span class="op" id="2690989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2690992">switch</span>&nbsp;<span class="ident" id="2690999">t</span><span class="op" id="2691000">.</span><span class="ident" id="2691001">Kind</span><span class="op" id="2691005">(</span><span class="op" id="2691006">)</span>&nbsp;<span class="op" id="2691008">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691011">case</span>&nbsp;<span class="ident" id="2691016">Array</span><span class="op" id="2691021">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2691025">tt</span>&nbsp;<span class="op" id="2691028">:=</span>&nbsp;<span class="op" id="2691031">(</span><span class="op" id="2691032">*</span><span class="ident" id="2691033">arrayType</span><span class="op" id="2691042">)</span><span class="op" id="2691043">(</span><span class="ident" id="2691044">unsafe</span><span class="op" id="2691050">.</span><span class="ident" id="2691051">Pointer</span><span class="op" id="2691058">(</span><span class="ident" id="2691059">t</span><span class="op" id="2691060">)</span><span class="op" id="2691061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691065">return</span>&nbsp;<span class="ident" id="2691072">toType</span><span class="op" id="2691078">(</span><span class="ident" id="2691079">tt</span><span class="op" id="2691081">.</span><span class="ident" id="2691082">elem</span><span class="op" id="2691086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691089">case</span>&nbsp;<span class="ident" id="2691094">Chan</span><span class="op" id="2691098">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2691102">tt</span>&nbsp;<span class="op" id="2691105">:=</span>&nbsp;<span class="op" id="2691108">(</span><span class="op" id="2691109">*</span><span class="ident" id="2691110">chanType</span><span class="op" id="2691118">)</span><span class="op" id="2691119">(</span><span class="ident" id="2691120">unsafe</span><span class="op" id="2691126">.</span><span class="ident" id="2691127">Pointer</span><span class="op" id="2691134">(</span><span class="ident" id="2691135">t</span><span class="op" id="2691136">)</span><span class="op" id="2691137">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691141">return</span>&nbsp;<span class="ident" id="2691148">toType</span><span class="op" id="2691154">(</span><span class="ident" id="2691155">tt</span><span class="op" id="2691157">.</span><span class="ident" id="2691158">elem</span><span class="op" id="2691162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691165">case</span>&nbsp;<span class="ident" id="2691170">Map</span><span class="op" id="2691173">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2691177">tt</span>&nbsp;<span class="op" id="2691180">:=</span>&nbsp;<span class="op" id="2691183">(</span><span class="op" id="2691184">*</span><span class="ident" id="2691185">mapType</span><span class="op" id="2691192">)</span><span class="op" id="2691193">(</span><span class="ident" id="2691194">unsafe</span><span class="op" id="2691200">.</span><span class="ident" id="2691201">Pointer</span><span class="op" id="2691208">(</span><span class="ident" id="2691209">t</span><span class="op" id="2691210">)</span><span class="op" id="2691211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691215">return</span>&nbsp;<span class="ident" id="2691222">toType</span><span class="op" id="2691228">(</span><span class="ident" id="2691229">tt</span><span class="op" id="2691231">.</span><span class="ident" id="2691232">elem</span><span class="op" id="2691236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691239">case</span>&nbsp;<span class="ident" id="2691244">Ptr</span><span class="op" id="2691247">:</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2691251">tt</span>&nbsp;<span class="op" id="2691254">:=</span>&nbsp;<span class="op" id="2691257">(</span><span class="op" id="2691258">*</span><span class="ident" id="2691259">ptrType</span><span class="op" id="2691266">)</span><span class="op" id="2691267">(</span><span class="ident" id="2691268">unsafe</span><span class="op" id="2691274">.</span><span class="ident" id="2691275">Pointer</span><span class="op" id="2691282">(</span><span class="ident" id="2691283">t</span><span class="op" id="2691284">)</span><span class="op" id="2691285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691289">return</span>&nbsp;<span class="ident" id="2691296">toType</span><span class="op" id="2691302">(</span><span class="ident" id="2691303">tt</span><span class="op" id="2691305">.</span><span class="ident" id="2691306">elem</span><span class="op" id="2691310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691313">case</span>&nbsp;<span class="ident" id="2691318">Slice</span><span class="op" id="2691323">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2691327">tt</span>&nbsp;<span class="op" id="2691330">:=</span>&nbsp;<span class="op" id="2691333">(</span><span class="op" id="2691334">*</span><span class="ident" id="2691335">sliceType</span><span class="op" id="2691344">)</span><span class="op" id="2691345">(</span><span class="ident" id="2691346">unsafe</span><span class="op" id="2691352">.</span><span class="ident" id="2691353">Pointer</span><span class="op" id="2691360">(</span><span class="ident" id="2691361">t</span><span class="op" id="2691362">)</span><span class="op" id="2691363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691367">return</span>&nbsp;<span class="ident" id="2691374">toType</span><span class="op" id="2691380">(</span><span class="ident" id="2691381">tt</span><span class="op" id="2691383">.</span><span class="ident" id="2691384">elem</span><span class="op" id="2691388">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2691391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2691394">panic</span><span class="op" id="2691399">(</span><span class="string" id="2691400">&#34;reflect:&nbsp;Elem&nbsp;of&nbsp;invalid&nbsp;type&#34;</span><span class="op" id="2691431">)</span><br>
<span class="lineno"></span><span class="op" id="2691433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2691436">func</span>&nbsp;<span class="op" id="2691441">(</span><span class="ident" id="2691442">t</span>&nbsp;<span class="op" id="2691444">*</span><span class="ident" id="2691445">rtype</span><span class="op" id="2691450">)</span>&nbsp;<span class="ident" id="2691452">Field</span><span class="op" id="2691457">(</span><span class="ident" id="2691458">i</span>&nbsp;<span class="builtintype" id="2691460">int</span><span class="op" id="2691463">)</span>&nbsp;<span class="ident" id="2691465">StructField</span>&nbsp;<span class="op" id="2691477">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691480">if</span>&nbsp;<span class="ident" id="2691483">t</span><span class="op" id="2691484">.</span><span class="ident" id="2691485">Kind</span><span class="op" id="2691489">(</span><span class="op" id="2691490">)</span>&nbsp;<span class="op" id="2691492">!=</span>&nbsp;<span class="ident" id="2691495">Struct</span>&nbsp;<span class="op" id="2691502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2691506">panic</span><span class="op" id="2691511">(</span><span class="string" id="2691512">&#34;reflect:&nbsp;Field&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2691547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2691550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2691553">tt</span>&nbsp;<span class="op" id="2691556">:=</span>&nbsp;<span class="op" id="2691559">(</span><span class="op" id="2691560">*</span><span class="ident" id="2691561">structType</span><span class="op" id="2691571">)</span><span class="op" id="2691572">(</span><span class="ident" id="2691573">unsafe</span><span class="op" id="2691579">.</span><span class="ident" id="2691580">Pointer</span><span class="op" id="2691587">(</span><span class="ident" id="2691588">t</span><span class="op" id="2691589">)</span><span class="op" id="2691590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691593">return</span>&nbsp;<span class="ident" id="2691600">tt</span><span class="op" id="2691602">.</span><span class="ident" id="2691603">Field</span><span class="op" id="2691608">(</span><span class="ident" id="2691609">i</span><span class="op" id="2691610">)</span><br>
<span class="lineno">605</span><span class="op" id="2691612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2691615">func</span>&nbsp;<span class="op" id="2691620">(</span><span class="ident" id="2691621">t</span>&nbsp;<span class="op" id="2691623">*</span><span class="ident" id="2691624">rtype</span><span class="op" id="2691629">)</span>&nbsp;<span class="ident" id="2691631">FieldByIndex</span><span class="op" id="2691643">(</span><span class="ident" id="2691644">index</span>&nbsp;<span class="op" id="2691650">[</span><span class="op" id="2691651">]</span><span class="builtintype" id="2691652">int</span><span class="op" id="2691655">)</span>&nbsp;<span class="ident" id="2691657">StructField</span>&nbsp;<span class="op" id="2691669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691672">if</span>&nbsp;<span class="ident" id="2691675">t</span><span class="op" id="2691676">.</span><span class="ident" id="2691677">Kind</span><span class="op" id="2691681">(</span><span class="op" id="2691682">)</span>&nbsp;<span class="op" id="2691684">!=</span>&nbsp;<span class="ident" id="2691687">Struct</span>&nbsp;<span class="op" id="2691694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2691698">panic</span><span class="op" id="2691703">(</span><span class="string" id="2691704">&#34;reflect:&nbsp;FieldByIndex&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2691746">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2691749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2691752">tt</span>&nbsp;<span class="op" id="2691755">:=</span>&nbsp;<span class="op" id="2691758">(</span><span class="op" id="2691759">*</span><span class="ident" id="2691760">structType</span><span class="op" id="2691770">)</span><span class="op" id="2691771">(</span><span class="ident" id="2691772">unsafe</span><span class="op" id="2691778">.</span><span class="ident" id="2691779">Pointer</span><span class="op" id="2691786">(</span><span class="ident" id="2691787">t</span><span class="op" id="2691788">)</span><span class="op" id="2691789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691792">return</span>&nbsp;<span class="ident" id="2691799">tt</span><span class="op" id="2691801">.</span><span class="ident" id="2691802">FieldByIndex</span><span class="op" id="2691814">(</span><span class="ident" id="2691815">index</span><span class="op" id="2691820">)</span><br>
<span class="lineno"></span><span class="op" id="2691822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="2691825">func</span>&nbsp;<span class="op" id="2691830">(</span><span class="ident" id="2691831">t</span>&nbsp;<span class="op" id="2691833">*</span><span class="ident" id="2691834">rtype</span><span class="op" id="2691839">)</span>&nbsp;<span class="ident" id="2691841">FieldByName</span><span class="op" id="2691852">(</span><span class="ident" id="2691853">name</span>&nbsp;<span class="builtintype" id="2691858">string</span><span class="op" id="2691864">)</span>&nbsp;<span class="op" id="2691866">(</span><span class="ident" id="2691867">StructField</span><span class="op" id="2691878">,</span>&nbsp;<span class="builtintype" id="2691880">bool</span><span class="op" id="2691884">)</span>&nbsp;<span class="op" id="2691886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2691889">if</span>&nbsp;<span class="ident" id="2691892">t</span><span class="op" id="2691893">.</span><span class="ident" id="2691894">Kind</span><span class="op" id="2691898">(</span><span class="op" id="2691899">)</span>&nbsp;<span class="op" id="2691901">!=</span>&nbsp;<span class="ident" id="2691904">Struct</span>&nbsp;<span class="op" id="2691911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2691915">panic</span><span class="op" id="2691920">(</span><span class="string" id="2691921">&#34;reflect:&nbsp;FieldByName&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2691962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2691965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2691968">tt</span>&nbsp;<span class="op" id="2691971">:=</span>&nbsp;<span class="op" id="2691974">(</span><span class="op" id="2691975">*</span><span class="ident" id="2691976">structType</span><span class="op" id="2691986">)</span><span class="op" id="2691987">(</span><span class="ident" id="2691988">unsafe</span><span class="op" id="2691994">.</span><span class="ident" id="2691995">Pointer</span><span class="op" id="2692002">(</span><span class="ident" id="2692003">t</span><span class="op" id="2692004">)</span><span class="op" id="2692005">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2692008">return</span>&nbsp;<span class="ident" id="2692015">tt</span><span class="op" id="2692017">.</span><span class="ident" id="2692018">FieldByName</span><span class="op" id="2692029">(</span><span class="ident" id="2692030">name</span><span class="op" id="2692034">)</span><br>
<span class="lineno"></span><span class="op" id="2692036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2692039">func</span>&nbsp;<span class="op" id="2692044">(</span><span class="ident" id="2692045">t</span>&nbsp;<span class="op" id="2692047">*</span><span class="ident" id="2692048">rtype</span><span class="op" id="2692053">)</span>&nbsp;<span class="ident" id="2692055">FieldByNameFunc</span><span class="op" id="2692070">(</span><span class="ident" id="2692071">match</span>&nbsp;<span class="keyword" id="2692077">func</span><span class="op" id="2692081">(</span><span class="builtintype" id="2692082">string</span><span class="op" id="2692088">)</span>&nbsp;<span class="builtintype" id="2692090">bool</span><span class="op" id="2692094">)</span>&nbsp;<span class="op" id="2692096">(</span><span class="ident" id="2692097">StructField</span><span class="op" id="2692108">,</span>&nbsp;<span class="builtintype" id="2692110">bool</span><span class="op" id="2692114">)</span>&nbsp;<span class="op" id="2692116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2692119">if</span>&nbsp;<span class="ident" id="2692122">t</span><span class="op" id="2692123">.</span><span class="ident" id="2692124">Kind</span><span class="op" id="2692128">(</span><span class="op" id="2692129">)</span>&nbsp;<span class="op" id="2692131">!=</span>&nbsp;<span class="ident" id="2692134">Struct</span>&nbsp;<span class="op" id="2692141">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2692145">panic</span><span class="op" id="2692150">(</span><span class="string" id="2692151">&#34;reflect:&nbsp;FieldByNameFunc&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2692196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2692199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2692202">tt</span>&nbsp;<span class="op" id="2692205">:=</span>&nbsp;<span class="op" id="2692208">(</span><span class="op" id="2692209">*</span><span class="ident" id="2692210">structType</span><span class="op" id="2692220">)</span><span class="op" id="2692221">(</span><span class="ident" id="2692222">unsafe</span><span class="op" id="2692228">.</span><span class="ident" id="2692229">Pointer</span><span class="op" id="2692236">(</span><span class="ident" id="2692237">t</span><span class="op" id="2692238">)</span><span class="op" id="2692239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2692242">return</span>&nbsp;<span class="ident" id="2692249">tt</span><span class="op" id="2692251">.</span><span class="ident" id="2692252">FieldByNameFunc</span><span class="op" id="2692267">(</span><span class="ident" id="2692268">match</span><span class="op" id="2692273">)</span><br>
<span class="lineno"></span><span class="op" id="2692275">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="2692278">func</span>&nbsp;<span class="op" id="2692283">(</span><span class="ident" id="2692284">t</span>&nbsp;<span class="op" id="2692286">*</span><span class="ident" id="2692287">rtype</span><span class="op" id="2692292">)</span>&nbsp;<span class="ident" id="2692294">In</span><span class="op" id="2692296">(</span><span class="ident" id="2692297">i</span>&nbsp;<span class="builtintype" id="2692299">int</span><span class="op" id="2692302">)</span>&nbsp;<span class="ident" id="2692304">Type</span>&nbsp;<span class="op" id="2692309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2692312">if</span>&nbsp;<span class="ident" id="2692315">t</span><span class="op" id="2692316">.</span><span class="ident" id="2692317">Kind</span><span class="op" id="2692321">(</span><span class="op" id="2692322">)</span>&nbsp;<span class="op" id="2692324">!=</span>&nbsp;<span class="ident" id="2692327">Func</span>&nbsp;<span class="op" id="2692332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2692336">panic</span><span class="op" id="2692341">(</span><span class="string" id="2692342">&#34;reflect:&nbsp;In&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2692372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2692375">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2692378">tt</span>&nbsp;<span class="op" id="2692381">:=</span>&nbsp;<span class="op" id="2692384">(</span><span class="op" id="2692385">*</span><span class="ident" id="2692386">funcType</span><span class="op" id="2692394">)</span><span class="op" id="2692395">(</span><span class="ident" id="2692396">unsafe</span><span class="op" id="2692402">.</span><span class="ident" id="2692403">Pointer</span><span class="op" id="2692410">(</span><span class="ident" id="2692411">t</span><span class="op" id="2692412">)</span><span class="op" id="2692413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2692416">return</span>&nbsp;<span class="ident" id="2692423">toType</span><span class="op" id="2692429">(</span><span class="ident" id="2692430">tt</span><span class="op" id="2692432">.</span><span class="ident" id="2692433">in</span><span class="op" id="2692435">[</span><span class="ident" id="2692436">i</span><span class="op" id="2692437">]</span><span class="op" id="2692438">)</span><br>
<span class="lineno"></span><span class="op" id="2692440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2692443">func</span>&nbsp;<span class="op" id="2692448">(</span><span class="ident" id="2692449">t</span>&nbsp;<span class="op" id="2692451">*</span><span class="ident" id="2692452">rtype</span><span class="op" id="2692457">)</span>&nbsp;<span class="ident" id="2692459">Key</span><span class="op" id="2692462">(</span><span class="op" id="2692463">)</span>&nbsp;<span class="ident" id="2692465">Type</span>&nbsp;<span class="op" id="2692470">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2692473">if</span>&nbsp;<span class="ident" id="2692476">t</span><span class="op" id="2692477">.</span><span class="ident" id="2692478">Kind</span><span class="op" id="2692482">(</span><span class="op" id="2692483">)</span>&nbsp;<span class="op" id="2692485">!=</span>&nbsp;<span class="ident" id="2692488">Map</span>&nbsp;<span class="op" id="2692492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2692496">panic</span><span class="op" id="2692501">(</span><span class="string" id="2692502">&#34;reflect:&nbsp;Key&nbsp;of&nbsp;non-map&nbsp;type&#34;</span><span class="op" id="2692532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2692535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2692538">tt</span>&nbsp;<span class="op" id="2692541">:=</span>&nbsp;<span class="op" id="2692544">(</span><span class="op" id="2692545">*</span><span class="ident" id="2692546">mapType</span><span class="op" id="2692553">)</span><span class="op" id="2692554">(</span><span class="ident" id="2692555">unsafe</span><span class="op" id="2692561">.</span><span class="ident" id="2692562">Pointer</span><span class="op" id="2692569">(</span><span class="ident" id="2692570">t</span><span class="op" id="2692571">)</span><span class="op" id="2692572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2692575">return</span>&nbsp;<span class="ident" id="2692582">toType</span><span class="op" id="2692588">(</span><span class="ident" id="2692589">tt</span><span class="op" id="2692591">.</span><span class="ident" id="2692592">key</span><span class="op" id="2692595">)</span><br>
<span class="lineno">645</span><span class="op" id="2692597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2692600">func</span>&nbsp;<span class="op" id="2692605">(</span><span class="ident" id="2692606">t</span>&nbsp;<span class="op" id="2692608">*</span><span class="ident" id="2692609">rtype</span><span class="op" id="2692614">)</span>&nbsp;<span class="ident" id="2692616">Len</span><span class="op" id="2692619">(</span><span class="op" id="2692620">)</span>&nbsp;<span class="builtintype" id="2692622">int</span>&nbsp;<span class="op" id="2692626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2692629">if</span>&nbsp;<span class="ident" id="2692632">t</span><span class="op" id="2692633">.</span><span class="ident" id="2692634">Kind</span><span class="op" id="2692638">(</span><span class="op" id="2692639">)</span>&nbsp;<span class="op" id="2692641">!=</span>&nbsp;<span class="ident" id="2692644">Array</span>&nbsp;<span class="op" id="2692650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2692654">panic</span><span class="op" id="2692659">(</span><span class="string" id="2692660">&#34;reflect:&nbsp;Len&nbsp;of&nbsp;non-array&nbsp;type&#34;</span><span class="op" id="2692692">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2692695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2692698">tt</span>&nbsp;<span class="op" id="2692701">:=</span>&nbsp;<span class="op" id="2692704">(</span><span class="op" id="2692705">*</span><span class="ident" id="2692706">arrayType</span><span class="op" id="2692715">)</span><span class="op" id="2692716">(</span><span class="ident" id="2692717">unsafe</span><span class="op" id="2692723">.</span><span class="ident" id="2692724">Pointer</span><span class="op" id="2692731">(</span><span class="ident" id="2692732">t</span><span class="op" id="2692733">)</span><span class="op" id="2692734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2692737">return</span>&nbsp;<span class="builtintype" id="2692744">int</span><span class="op" id="2692747">(</span><span class="ident" id="2692748">tt</span><span class="op" id="2692750">.</span><span class="builtinfunc" id="2692751">len</span><span class="op" id="2692754">)</span><br>
<span class="lineno"></span><span class="op" id="2692756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="2692759">func</span>&nbsp;<span class="op" id="2692764">(</span><span class="ident" id="2692765">t</span>&nbsp;<span class="op" id="2692767">*</span><span class="ident" id="2692768">rtype</span><span class="op" id="2692773">)</span>&nbsp;<span class="ident" id="2692775">NumField</span><span class="op" id="2692783">(</span><span class="op" id="2692784">)</span>&nbsp;<span class="builtintype" id="2692786">int</span>&nbsp;<span class="op" id="2692790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2692793">if</span>&nbsp;<span class="ident" id="2692796">t</span><span class="op" id="2692797">.</span><span class="ident" id="2692798">Kind</span><span class="op" id="2692802">(</span><span class="op" id="2692803">)</span>&nbsp;<span class="op" id="2692805">!=</span>&nbsp;<span class="ident" id="2692808">Struct</span>&nbsp;<span class="op" id="2692815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2692819">panic</span><span class="op" id="2692824">(</span><span class="string" id="2692825">&#34;reflect:&nbsp;NumField&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2692863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2692866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2692869">tt</span>&nbsp;<span class="op" id="2692872">:=</span>&nbsp;<span class="op" id="2692875">(</span><span class="op" id="2692876">*</span><span class="ident" id="2692877">structType</span><span class="op" id="2692887">)</span><span class="op" id="2692888">(</span><span class="ident" id="2692889">unsafe</span><span class="op" id="2692895">.</span><span class="ident" id="2692896">Pointer</span><span class="op" id="2692903">(</span><span class="ident" id="2692904">t</span><span class="op" id="2692905">)</span><span class="op" id="2692906">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2692909">return</span>&nbsp;<span class="builtinfunc" id="2692916">len</span><span class="op" id="2692919">(</span><span class="ident" id="2692920">tt</span><span class="op" id="2692922">.</span><span class="ident" id="2692923">fields</span><span class="op" id="2692929">)</span><br>
<span class="lineno"></span><span class="op" id="2692931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2692934">func</span>&nbsp;<span class="op" id="2692939">(</span><span class="ident" id="2692940">t</span>&nbsp;<span class="op" id="2692942">*</span><span class="ident" id="2692943">rtype</span><span class="op" id="2692948">)</span>&nbsp;<span class="ident" id="2692950">NumIn</span><span class="op" id="2692955">(</span><span class="op" id="2692956">)</span>&nbsp;<span class="builtintype" id="2692958">int</span>&nbsp;<span class="op" id="2692962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2692965">if</span>&nbsp;<span class="ident" id="2692968">t</span><span class="op" id="2692969">.</span><span class="ident" id="2692970">Kind</span><span class="op" id="2692974">(</span><span class="op" id="2692975">)</span>&nbsp;<span class="op" id="2692977">!=</span>&nbsp;<span class="ident" id="2692980">Func</span>&nbsp;<span class="op" id="2692985">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2692989">panic</span><span class="op" id="2692994">(</span><span class="string" id="2692995">&#34;reflect:&nbsp;NumIn&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2693028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2693031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2693034">tt</span>&nbsp;<span class="op" id="2693037">:=</span>&nbsp;<span class="op" id="2693040">(</span><span class="op" id="2693041">*</span><span class="ident" id="2693042">funcType</span><span class="op" id="2693050">)</span><span class="op" id="2693051">(</span><span class="ident" id="2693052">unsafe</span><span class="op" id="2693058">.</span><span class="ident" id="2693059">Pointer</span><span class="op" id="2693066">(</span><span class="ident" id="2693067">t</span><span class="op" id="2693068">)</span><span class="op" id="2693069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693072">return</span>&nbsp;<span class="builtinfunc" id="2693079">len</span><span class="op" id="2693082">(</span><span class="ident" id="2693083">tt</span><span class="op" id="2693085">.</span><span class="ident" id="2693086">in</span><span class="op" id="2693088">)</span><br>
<span class="lineno"></span><span class="op" id="2693090">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="2693093">func</span>&nbsp;<span class="op" id="2693098">(</span><span class="ident" id="2693099">t</span>&nbsp;<span class="op" id="2693101">*</span><span class="ident" id="2693102">rtype</span><span class="op" id="2693107">)</span>&nbsp;<span class="ident" id="2693109">NumOut</span><span class="op" id="2693115">(</span><span class="op" id="2693116">)</span>&nbsp;<span class="builtintype" id="2693118">int</span>&nbsp;<span class="op" id="2693122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693125">if</span>&nbsp;<span class="ident" id="2693128">t</span><span class="op" id="2693129">.</span><span class="ident" id="2693130">Kind</span><span class="op" id="2693134">(</span><span class="op" id="2693135">)</span>&nbsp;<span class="op" id="2693137">!=</span>&nbsp;<span class="ident" id="2693140">Func</span>&nbsp;<span class="op" id="2693145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2693149">panic</span><span class="op" id="2693154">(</span><span class="string" id="2693155">&#34;reflect:&nbsp;NumOut&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2693189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2693192">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2693195">tt</span>&nbsp;<span class="op" id="2693198">:=</span>&nbsp;<span class="op" id="2693201">(</span><span class="op" id="2693202">*</span><span class="ident" id="2693203">funcType</span><span class="op" id="2693211">)</span><span class="op" id="2693212">(</span><span class="ident" id="2693213">unsafe</span><span class="op" id="2693219">.</span><span class="ident" id="2693220">Pointer</span><span class="op" id="2693227">(</span><span class="ident" id="2693228">t</span><span class="op" id="2693229">)</span><span class="op" id="2693230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693233">return</span>&nbsp;<span class="builtinfunc" id="2693240">len</span><span class="op" id="2693243">(</span><span class="ident" id="2693244">tt</span><span class="op" id="2693246">.</span><span class="ident" id="2693247">out</span><span class="op" id="2693250">)</span><br>
<span class="lineno"></span><span class="op" id="2693252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2693255">func</span>&nbsp;<span class="op" id="2693260">(</span><span class="ident" id="2693261">t</span>&nbsp;<span class="op" id="2693263">*</span><span class="ident" id="2693264">rtype</span><span class="op" id="2693269">)</span>&nbsp;<span class="ident" id="2693271">Out</span><span class="op" id="2693274">(</span><span class="ident" id="2693275">i</span>&nbsp;<span class="builtintype" id="2693277">int</span><span class="op" id="2693280">)</span>&nbsp;<span class="ident" id="2693282">Type</span>&nbsp;<span class="op" id="2693287">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693290">if</span>&nbsp;<span class="ident" id="2693293">t</span><span class="op" id="2693294">.</span><span class="ident" id="2693295">Kind</span><span class="op" id="2693299">(</span><span class="op" id="2693300">)</span>&nbsp;<span class="op" id="2693302">!=</span>&nbsp;<span class="ident" id="2693305">Func</span>&nbsp;<span class="op" id="2693310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2693314">panic</span><span class="op" id="2693319">(</span><span class="string" id="2693320">&#34;reflect:&nbsp;Out&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2693351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2693354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2693357">tt</span>&nbsp;<span class="op" id="2693360">:=</span>&nbsp;<span class="op" id="2693363">(</span><span class="op" id="2693364">*</span><span class="ident" id="2693365">funcType</span><span class="op" id="2693373">)</span><span class="op" id="2693374">(</span><span class="ident" id="2693375">unsafe</span><span class="op" id="2693381">.</span><span class="ident" id="2693382">Pointer</span><span class="op" id="2693389">(</span><span class="ident" id="2693390">t</span><span class="op" id="2693391">)</span><span class="op" id="2693392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693395">return</span>&nbsp;<span class="ident" id="2693402">toType</span><span class="op" id="2693408">(</span><span class="ident" id="2693409">tt</span><span class="op" id="2693411">.</span><span class="ident" id="2693412">out</span><span class="op" id="2693415">[</span><span class="ident" id="2693416">i</span><span class="op" id="2693417">]</span><span class="op" id="2693418">)</span><br>
<span class="lineno">685</span><span class="op" id="2693420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2693423">func</span>&nbsp;<span class="op" id="2693428">(</span><span class="ident" id="2693429">d</span>&nbsp;<span class="ident" id="2693431">ChanDir</span><span class="op" id="2693438">)</span>&nbsp;<span class="ident" id="2693440">String</span><span class="op" id="2693446">(</span><span class="op" id="2693447">)</span>&nbsp;<span class="builtintype" id="2693449">string</span>&nbsp;<span class="op" id="2693456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693459">switch</span>&nbsp;<span class="ident" id="2693466">d</span>&nbsp;<span class="op" id="2693468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693471">case</span>&nbsp;<span class="ident" id="2693476">SendDir</span><span class="op" id="2693483">:</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693487">return</span>&nbsp;<span class="string" id="2693494">&#34;chan&lt;-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693504">case</span>&nbsp;<span class="ident" id="2693509">RecvDir</span><span class="op" id="2693516">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693520">return</span>&nbsp;<span class="string" id="2693527">&#34;&lt;-chan&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693537">case</span>&nbsp;<span class="ident" id="2693542">BothDir</span><span class="op" id="2693549">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693553">return</span>&nbsp;<span class="string" id="2693560">&#34;chan&#34;</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2693568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693571">return</span>&nbsp;<span class="string" id="2693578">&#34;ChanDir&#34;</span>&nbsp;<span class="op" id="2693588">+</span>&nbsp;<span class="ident" id="2693590">strconv</span><span class="op" id="2693597">.</span><span class="ident" id="2693598">Itoa</span><span class="op" id="2693602">(</span><span class="builtintype" id="2693603">int</span><span class="op" id="2693606">(</span><span class="ident" id="2693607">d</span><span class="op" id="2693608">)</span><span class="op" id="2693609">)</span><br>
<span class="lineno"></span><span class="op" id="2693611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2693614">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">700</span><span class="keyword" id="2693674">func</span>&nbsp;<span class="op" id="2693679">(</span><span class="ident" id="2693680">t</span>&nbsp;<span class="op" id="2693682">*</span><span class="ident" id="2693683">interfaceType</span><span class="op" id="2693696">)</span>&nbsp;<span class="ident" id="2693698">Method</span><span class="op" id="2693704">(</span><span class="ident" id="2693705">i</span>&nbsp;<span class="builtintype" id="2693707">int</span><span class="op" id="2693710">)</span>&nbsp;<span class="op" id="2693712">(</span><span class="ident" id="2693713">m</span>&nbsp;<span class="ident" id="2693715">Method</span><span class="op" id="2693721">)</span>&nbsp;<span class="op" id="2693723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693726">if</span>&nbsp;<span class="ident" id="2693729">i</span>&nbsp;<span class="op" id="2693731">&lt;</span>&nbsp;<span class="num" id="2693733">0</span>&nbsp;<span class="op" id="2693735">||</span>&nbsp;<span class="ident" id="2693738">i</span>&nbsp;<span class="op" id="2693740">&gt;=</span>&nbsp;<span class="builtinfunc" id="2693743">len</span><span class="op" id="2693746">(</span><span class="ident" id="2693747">t</span><span class="op" id="2693748">.</span><span class="ident" id="2693749">methods</span><span class="op" id="2693756">)</span>&nbsp;<span class="op" id="2693758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693762">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2693770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2693773">p</span>&nbsp;<span class="op" id="2693775">:=</span>&nbsp;<span class="op" id="2693778">&amp;</span><span class="ident" id="2693779">t</span><span class="op" id="2693780">.</span><span class="ident" id="2693781">methods</span><span class="op" id="2693788">[</span><span class="ident" id="2693789">i</span><span class="op" id="2693790">]</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2693793">m</span><span class="op" id="2693794">.</span><span class="ident" id="2693795">Name</span>&nbsp;<span class="op" id="2693800">=</span>&nbsp;<span class="op" id="2693802">*</span><span class="ident" id="2693803">p</span><span class="op" id="2693804">.</span><span class="ident" id="2693805">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693811">if</span>&nbsp;<span class="ident" id="2693814">p</span><span class="op" id="2693815">.</span><span class="ident" id="2693816">pkgPath</span>&nbsp;<span class="op" id="2693824">!=</span>&nbsp;<span class="builtintype" id="2693827">nil</span>&nbsp;<span class="op" id="2693831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2693835">m</span><span class="op" id="2693836">.</span><span class="ident" id="2693837">PkgPath</span>&nbsp;<span class="op" id="2693845">=</span>&nbsp;<span class="op" id="2693847">*</span><span class="ident" id="2693848">p</span><span class="op" id="2693849">.</span><span class="ident" id="2693850">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2693859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2693862">m</span><span class="op" id="2693863">.</span><span class="ident" id="2693864">Type</span>&nbsp;<span class="op" id="2693869">=</span>&nbsp;<span class="ident" id="2693871">toType</span><span class="op" id="2693877">(</span><span class="ident" id="2693878">p</span><span class="op" id="2693879">.</span><span class="ident" id="2693880">typ</span><span class="op" id="2693883">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2693886">m</span><span class="op" id="2693887">.</span><span class="ident" id="2693888">Index</span>&nbsp;<span class="op" id="2693894">=</span>&nbsp;<span class="ident" id="2693896">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2693899">return</span><br>
<span class="lineno"></span><span class="op" id="2693906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2693909">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;interface&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">715</span><span class="keyword" id="2693988">func</span>&nbsp;<span class="op" id="2693993">(</span><span class="ident" id="2693994">t</span>&nbsp;<span class="op" id="2693996">*</span><span class="ident" id="2693997">interfaceType</span><span class="op" id="2694010">)</span>&nbsp;<span class="ident" id="2694012">NumMethod</span><span class="op" id="2694021">(</span><span class="op" id="2694022">)</span>&nbsp;<span class="builtintype" id="2694024">int</span>&nbsp;<span class="op" id="2694028">{</span>&nbsp;<span class="keyword" id="2694030">return</span>&nbsp;<span class="builtinfunc" id="2694037">len</span><span class="op" id="2694040">(</span><span class="ident" id="2694041">t</span><span class="op" id="2694042">.</span><span class="ident" id="2694043">methods</span><span class="op" id="2694050">)</span>&nbsp;<span class="op" id="2694052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2694055">//&nbsp;MethodByName&nbsp;method&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="2694124">func</span>&nbsp;<span class="op" id="2694129">(</span><span class="ident" id="2694130">t</span>&nbsp;<span class="op" id="2694132">*</span><span class="ident" id="2694133">interfaceType</span><span class="op" id="2694146">)</span>&nbsp;<span class="ident" id="2694148">MethodByName</span><span class="op" id="2694160">(</span><span class="ident" id="2694161">name</span>&nbsp;<span class="builtintype" id="2694166">string</span><span class="op" id="2694172">)</span>&nbsp;<span class="op" id="2694174">(</span><span class="ident" id="2694175">m</span>&nbsp;<span class="ident" id="2694177">Method</span><span class="op" id="2694183">,</span>&nbsp;<span class="ident" id="2694185">ok</span>&nbsp;<span class="builtintype" id="2694188">bool</span><span class="op" id="2694192">)</span>&nbsp;<span class="op" id="2694194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2694197">if</span>&nbsp;<span class="ident" id="2694200">t</span>&nbsp;<span class="op" id="2694202">==</span>&nbsp;<span class="builtintype" id="2694205">nil</span>&nbsp;<span class="op" id="2694209">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2694213">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2694221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2694224">var</span>&nbsp;<span class="ident" id="2694228">p</span>&nbsp;<span class="op" id="2694230">*</span><span class="ident" id="2694231">imethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2694240">for</span>&nbsp;<span class="ident" id="2694244">i</span>&nbsp;<span class="op" id="2694246">:=</span>&nbsp;<span class="keyword" id="2694249">range</span>&nbsp;<span class="ident" id="2694255">t</span><span class="op" id="2694256">.</span><span class="ident" id="2694257">methods</span>&nbsp;<span class="op" id="2694265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2694269">p</span>&nbsp;<span class="op" id="2694271">=</span>&nbsp;<span class="op" id="2694273">&amp;</span><span class="ident" id="2694274">t</span><span class="op" id="2694275">.</span><span class="ident" id="2694276">methods</span><span class="op" id="2694283">[</span><span class="ident" id="2694284">i</span><span class="op" id="2694285">]</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2694289">if</span>&nbsp;<span class="op" id="2694292">*</span><span class="ident" id="2694293">p</span><span class="op" id="2694294">.</span><span class="ident" id="2694295">name</span>&nbsp;<span class="op" id="2694300">==</span>&nbsp;<span class="ident" id="2694303">name</span>&nbsp;<span class="op" id="2694308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2694313">return</span>&nbsp;<span class="ident" id="2694320">t</span><span class="op" id="2694321">.</span><span class="ident" id="2694322">Method</span><span class="op" id="2694328">(</span><span class="ident" id="2694329">i</span><span class="op" id="2694330">)</span><span class="op" id="2694331">,</span>&nbsp;<span class="builtintype" id="2694333">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2694340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2694343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2694346">return</span><br>
<span class="lineno">730</span><span class="op" id="2694353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2694356">//&nbsp;A&nbsp;StructField&nbsp;describes&nbsp;a&nbsp;single&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="2694411">type</span>&nbsp;<span class="ident" id="2694416">StructField</span>&nbsp;<span class="keyword" id="2694428">struct</span>&nbsp;<span class="op" id="2694435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2694438">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2694466">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2694539">//&nbsp;field&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2694607">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2694668">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2694676">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2694684">PkgPath</span>&nbsp;<span class="builtintype" id="2694692">string</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2694701">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2694711">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2694721">//&nbsp;field&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2694736">Tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2694746">StructTag</span>&nbsp;<span class="comment" id="2694756">//&nbsp;field&nbsp;tag&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2694777">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2694787">uintptr</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2694797">//&nbsp;offset&nbsp;within&nbsp;struct,&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2694832">Index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2694842">[</span><span class="op" id="2694843">]</span><span class="builtintype" id="2694844">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2694852">//&nbsp;index&nbsp;sequence&nbsp;for&nbsp;Type.FieldByIndex</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2694893">Anonymous</span>&nbsp;<span class="builtintype" id="2694903">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2694913">//&nbsp;is&nbsp;an&nbsp;embedded&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="2694937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2694940">//&nbsp;A&nbsp;StructTag&nbsp;is&nbsp;the&nbsp;tag&nbsp;string&nbsp;in&nbsp;a&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="2694992">//</span><br>
<span class="lineno">750</span><span class="comment" id="2694995">//&nbsp;By&nbsp;convention,&nbsp;tag&nbsp;strings&nbsp;are&nbsp;a&nbsp;concatenation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2695048">//&nbsp;optionally&nbsp;space-separated&nbsp;key:&#34;value&#34;&nbsp;pairs.</span><br>
<span class="lineno"></span><span class="comment" id="2695097">//&nbsp;Each&nbsp;key&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of&nbsp;non-control</span><br>
<span class="lineno"></span><span class="comment" id="2695157">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;space&nbsp;(U+0020&nbsp;&#39;&nbsp;&#39;),&nbsp;quote&nbsp;(U+0022&nbsp;&#39;&#34;&#39;),</span><br>
<span class="lineno"></span><span class="comment" id="2695222">//&nbsp;and&nbsp;colon&nbsp;(U+003A&nbsp;&#39;:&#39;).&nbsp;&nbsp;Each&nbsp;value&nbsp;is&nbsp;quoted&nbsp;using&nbsp;U+0022&nbsp;&#39;&#34;&#39;</span><br>
<span class="lineno">755</span><span class="comment" id="2695288">//&nbsp;characters&nbsp;and&nbsp;Go&nbsp;string&nbsp;literal&nbsp;syntax.</span><br>
<span class="lineno"></span><span class="keyword" id="2695332">type</span>&nbsp;<span class="ident" id="2695337">StructTag</span>&nbsp;<span class="builtintype" id="2695347">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2695355">//&nbsp;Get&nbsp;returns&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;key&nbsp;in&nbsp;the&nbsp;tag&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2695419">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;key&nbsp;in&nbsp;the&nbsp;tag,&nbsp;Get&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno">760</span><span class="comment" id="2695488">//&nbsp;If&nbsp;the&nbsp;tag&nbsp;does&nbsp;not&nbsp;have&nbsp;the&nbsp;conventional&nbsp;format,&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2695551">//&nbsp;returned&nbsp;by&nbsp;Get&nbsp;is&nbsp;unspecified.</span><br>
<span class="lineno"></span><span class="keyword" id="2695586">func</span>&nbsp;<span class="op" id="2695591">(</span><span class="ident" id="2695592">tag</span>&nbsp;<span class="ident" id="2695596">StructTag</span><span class="op" id="2695605">)</span>&nbsp;<span class="ident" id="2695607">Get</span><span class="op" id="2695610">(</span><span class="ident" id="2695611">key</span>&nbsp;<span class="builtintype" id="2695615">string</span><span class="op" id="2695621">)</span>&nbsp;<span class="builtintype" id="2695623">string</span>&nbsp;<span class="op" id="2695630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2695633">for</span>&nbsp;<span class="ident" id="2695637">tag</span>&nbsp;<span class="op" id="2695641">!=</span>&nbsp;<span class="string" id="2695644">&#34;&#34;</span>&nbsp;<span class="op" id="2695647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2695651">//&nbsp;skip&nbsp;leading&nbsp;space</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2695675">i</span>&nbsp;<span class="op" id="2695677">:=</span>&nbsp;<span class="num" id="2695680">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2695684">for</span>&nbsp;<span class="ident" id="2695688">i</span>&nbsp;<span class="op" id="2695690">&lt;</span>&nbsp;<span class="builtinfunc" id="2695692">len</span><span class="op" id="2695695">(</span><span class="ident" id="2695696">tag</span><span class="op" id="2695699">)</span>&nbsp;<span class="op" id="2695701">&amp;&amp;</span>&nbsp;<span class="ident" id="2695704">tag</span><span class="op" id="2695707">[</span><span class="ident" id="2695708">i</span><span class="op" id="2695709">]</span>&nbsp;<span class="op" id="2695711">==</span>&nbsp;<span class="string" id="2695714">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2695718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2695723">i</span><span class="op" id="2695724">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2695729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2695733">tag</span>&nbsp;<span class="op" id="2695737">=</span>&nbsp;<span class="ident" id="2695739">tag</span><span class="op" id="2695742">[</span><span class="ident" id="2695743">i</span><span class="op" id="2695744">:</span><span class="op" id="2695745">]</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2695749">if</span>&nbsp;<span class="ident" id="2695752">tag</span>&nbsp;<span class="op" id="2695756">==</span>&nbsp;<span class="string" id="2695759">&#34;&#34;</span>&nbsp;<span class="op" id="2695762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2695767">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2695775">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2695780">//&nbsp;scan&nbsp;to&nbsp;colon.</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2695800">//&nbsp;a&nbsp;space&nbsp;or&nbsp;a&nbsp;quote&nbsp;is&nbsp;a&nbsp;syntax&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2695842">i</span>&nbsp;<span class="op" id="2695844">=</span>&nbsp;<span class="num" id="2695846">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2695850">for</span>&nbsp;<span class="ident" id="2695854">i</span>&nbsp;<span class="op" id="2695856">&lt;</span>&nbsp;<span class="builtinfunc" id="2695858">len</span><span class="op" id="2695861">(</span><span class="ident" id="2695862">tag</span><span class="op" id="2695865">)</span>&nbsp;<span class="op" id="2695867">&amp;&amp;</span>&nbsp;<span class="ident" id="2695870">tag</span><span class="op" id="2695873">[</span><span class="ident" id="2695874">i</span><span class="op" id="2695875">]</span>&nbsp;<span class="op" id="2695877">!=</span>&nbsp;<span class="string" id="2695880">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2695884">&amp;&amp;</span>&nbsp;<span class="ident" id="2695887">tag</span><span class="op" id="2695890">[</span><span class="ident" id="2695891">i</span><span class="op" id="2695892">]</span>&nbsp;<span class="op" id="2695894">!=</span>&nbsp;<span class="string" id="2695897">&#39;:&#39;</span>&nbsp;<span class="op" id="2695901">&amp;&amp;</span>&nbsp;<span class="ident" id="2695904">tag</span><span class="op" id="2695907">[</span><span class="ident" id="2695908">i</span><span class="op" id="2695909">]</span>&nbsp;<span class="op" id="2695911">!=</span>&nbsp;<span class="string" id="2695914">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2695918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2695923">i</span><span class="op" id="2695924">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2695929">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2695933">if</span>&nbsp;<span class="ident" id="2695936">i</span><span class="op" id="2695937">+</span><span class="num" id="2695938">1</span>&nbsp;<span class="op" id="2695940">&gt;=</span>&nbsp;<span class="builtinfunc" id="2695943">len</span><span class="op" id="2695946">(</span><span class="ident" id="2695947">tag</span><span class="op" id="2695950">)</span>&nbsp;<span class="op" id="2695952">||</span>&nbsp;<span class="ident" id="2695955">tag</span><span class="op" id="2695958">[</span><span class="ident" id="2695959">i</span><span class="op" id="2695960">]</span>&nbsp;<span class="op" id="2695962">!=</span>&nbsp;<span class="string" id="2695965">&#39;:&#39;</span>&nbsp;<span class="op" id="2695969">||</span>&nbsp;<span class="ident" id="2695972">tag</span><span class="op" id="2695975">[</span><span class="ident" id="2695976">i</span><span class="op" id="2695977">+</span><span class="num" id="2695978">1</span><span class="op" id="2695979">]</span>&nbsp;<span class="op" id="2695981">!=</span>&nbsp;<span class="string" id="2695984">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2695988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2695993">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2696001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696005">name</span>&nbsp;<span class="op" id="2696010">:=</span>&nbsp;<span class="builtintype" id="2696013">string</span><span class="op" id="2696019">(</span><span class="ident" id="2696020">tag</span><span class="op" id="2696023">[</span><span class="op" id="2696024">:</span><span class="ident" id="2696025">i</span><span class="op" id="2696026">]</span><span class="op" id="2696027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696031">tag</span>&nbsp;<span class="op" id="2696035">=</span>&nbsp;<span class="ident" id="2696037">tag</span><span class="op" id="2696040">[</span><span class="ident" id="2696041">i</span><span class="op" id="2696042">+</span><span class="num" id="2696043">1</span><span class="op" id="2696044">:</span><span class="op" id="2696045">]</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2696050">//&nbsp;scan&nbsp;quoted&nbsp;string&nbsp;to&nbsp;find&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696088">i</span>&nbsp;<span class="op" id="2696090">=</span>&nbsp;<span class="num" id="2696092">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2696096">for</span>&nbsp;<span class="ident" id="2696100">i</span>&nbsp;<span class="op" id="2696102">&lt;</span>&nbsp;<span class="builtinfunc" id="2696104">len</span><span class="op" id="2696107">(</span><span class="ident" id="2696108">tag</span><span class="op" id="2696111">)</span>&nbsp;<span class="op" id="2696113">&amp;&amp;</span>&nbsp;<span class="ident" id="2696116">tag</span><span class="op" id="2696119">[</span><span class="ident" id="2696120">i</span><span class="op" id="2696121">]</span>&nbsp;<span class="op" id="2696123">!=</span>&nbsp;<span class="string" id="2696126">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2696130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2696135">if</span>&nbsp;<span class="ident" id="2696138">tag</span><span class="op" id="2696141">[</span><span class="ident" id="2696142">i</span><span class="op" id="2696143">]</span>&nbsp;<span class="op" id="2696145">==</span>&nbsp;<span class="string" id="2696148">&#39;\\&#39;</span>&nbsp;<span class="op" id="2696153">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696159">i</span><span class="op" id="2696160">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2696166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696171">i</span><span class="op" id="2696172">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2696177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2696181">if</span>&nbsp;<span class="ident" id="2696184">i</span>&nbsp;<span class="op" id="2696186">&gt;=</span>&nbsp;<span class="builtinfunc" id="2696189">len</span><span class="op" id="2696192">(</span><span class="ident" id="2696193">tag</span><span class="op" id="2696196">)</span>&nbsp;<span class="op" id="2696198">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2696203">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2696211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696215">qvalue</span>&nbsp;<span class="op" id="2696222">:=</span>&nbsp;<span class="builtintype" id="2696225">string</span><span class="op" id="2696231">(</span><span class="ident" id="2696232">tag</span><span class="op" id="2696235">[</span><span class="op" id="2696236">:</span><span class="ident" id="2696237">i</span><span class="op" id="2696238">+</span><span class="num" id="2696239">1</span><span class="op" id="2696240">]</span><span class="op" id="2696241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696245">tag</span>&nbsp;<span class="op" id="2696249">=</span>&nbsp;<span class="ident" id="2696251">tag</span><span class="op" id="2696254">[</span><span class="ident" id="2696255">i</span><span class="op" id="2696256">+</span><span class="num" id="2696257">1</span><span class="op" id="2696258">:</span><span class="op" id="2696259">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2696264">if</span>&nbsp;<span class="ident" id="2696267">key</span>&nbsp;<span class="op" id="2696271">==</span>&nbsp;<span class="ident" id="2696274">name</span>&nbsp;<span class="op" id="2696279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696284">value</span><span class="op" id="2696289">,</span>&nbsp;<span class="ident" id="2696291">_</span>&nbsp;<span class="op" id="2696293">:=</span>&nbsp;<span class="ident" id="2696296">strconv</span><span class="op" id="2696303">.</span><span class="ident" id="2696304">Unquote</span><span class="op" id="2696311">(</span><span class="ident" id="2696312">qvalue</span><span class="op" id="2696318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2696323">return</span>&nbsp;<span class="ident" id="2696330">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2696338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2696341">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2696344">return</span>&nbsp;<span class="string" id="2696351">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2696354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2696357">//&nbsp;Field&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="2696397">func</span>&nbsp;<span class="op" id="2696402">(</span><span class="ident" id="2696403">t</span>&nbsp;<span class="op" id="2696405">*</span><span class="ident" id="2696406">structType</span><span class="op" id="2696416">)</span>&nbsp;<span class="ident" id="2696418">Field</span><span class="op" id="2696423">(</span><span class="ident" id="2696424">i</span>&nbsp;<span class="builtintype" id="2696426">int</span><span class="op" id="2696429">)</span>&nbsp;<span class="op" id="2696431">(</span><span class="ident" id="2696432">f</span>&nbsp;<span class="ident" id="2696434">StructField</span><span class="op" id="2696445">)</span>&nbsp;<span class="op" id="2696447">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2696450">if</span>&nbsp;<span class="ident" id="2696453">i</span>&nbsp;<span class="op" id="2696455">&lt;</span>&nbsp;<span class="num" id="2696457">0</span>&nbsp;<span class="op" id="2696459">||</span>&nbsp;<span class="ident" id="2696462">i</span>&nbsp;<span class="op" id="2696464">&gt;=</span>&nbsp;<span class="builtinfunc" id="2696467">len</span><span class="op" id="2696470">(</span><span class="ident" id="2696471">t</span><span class="op" id="2696472">.</span><span class="ident" id="2696473">fields</span><span class="op" id="2696479">)</span>&nbsp;<span class="op" id="2696481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2696485">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2696493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696496">p</span>&nbsp;<span class="op" id="2696498">:=</span>&nbsp;<span class="op" id="2696501">&amp;</span><span class="ident" id="2696502">t</span><span class="op" id="2696503">.</span><span class="ident" id="2696504">fields</span><span class="op" id="2696510">[</span><span class="ident" id="2696511">i</span><span class="op" id="2696512">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696515">f</span><span class="op" id="2696516">.</span><span class="ident" id="2696517">Type</span>&nbsp;<span class="op" id="2696522">=</span>&nbsp;<span class="ident" id="2696524">toType</span><span class="op" id="2696530">(</span><span class="ident" id="2696531">p</span><span class="op" id="2696532">.</span><span class="ident" id="2696533">typ</span><span class="op" id="2696536">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2696539">if</span>&nbsp;<span class="ident" id="2696542">p</span><span class="op" id="2696543">.</span><span class="ident" id="2696544">name</span>&nbsp;<span class="op" id="2696549">!=</span>&nbsp;<span class="builtintype" id="2696552">nil</span>&nbsp;<span class="op" id="2696556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696560">f</span><span class="op" id="2696561">.</span><span class="ident" id="2696562">Name</span>&nbsp;<span class="op" id="2696567">=</span>&nbsp;<span class="op" id="2696569">*</span><span class="ident" id="2696570">p</span><span class="op" id="2696571">.</span><span class="ident" id="2696572">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2696578">}</span>&nbsp;<span class="keyword" id="2696580">else</span>&nbsp;<span class="op" id="2696585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696589">t</span>&nbsp;<span class="op" id="2696591">:=</span>&nbsp;<span class="ident" id="2696594">f</span><span class="op" id="2696595">.</span><span class="ident" id="2696596">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2696603">if</span>&nbsp;<span class="ident" id="2696606">t</span><span class="op" id="2696607">.</span><span class="ident" id="2696608">Kind</span><span class="op" id="2696612">(</span><span class="op" id="2696613">)</span>&nbsp;<span class="op" id="2696615">==</span>&nbsp;<span class="ident" id="2696618">Ptr</span>&nbsp;<span class="op" id="2696622">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696627">t</span>&nbsp;<span class="op" id="2696629">=</span>&nbsp;<span class="ident" id="2696631">t</span><span class="op" id="2696632">.</span><span class="ident" id="2696633">Elem</span><span class="op" id="2696637">(</span><span class="op" id="2696638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2696642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696646">f</span><span class="op" id="2696647">.</span><span class="ident" id="2696648">Name</span>&nbsp;<span class="op" id="2696653">=</span>&nbsp;<span class="ident" id="2696655">t</span><span class="op" id="2696656">.</span><span class="ident" id="2696657">Name</span><span class="op" id="2696661">(</span><span class="op" id="2696662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696666">f</span><span class="op" id="2696667">.</span><span class="ident" id="2696668">Anonymous</span>&nbsp;<span class="op" id="2696678">=</span>&nbsp;<span class="builtintype" id="2696680">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2696686">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2696689">if</span>&nbsp;<span class="ident" id="2696692">p</span><span class="op" id="2696693">.</span><span class="ident" id="2696694">pkgPath</span>&nbsp;<span class="op" id="2696702">!=</span>&nbsp;<span class="builtintype" id="2696705">nil</span>&nbsp;<span class="op" id="2696709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696713">f</span><span class="op" id="2696714">.</span><span class="ident" id="2696715">PkgPath</span>&nbsp;<span class="op" id="2696723">=</span>&nbsp;<span class="op" id="2696725">*</span><span class="ident" id="2696726">p</span><span class="op" id="2696727">.</span><span class="ident" id="2696728">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2696737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2696740">if</span>&nbsp;<span class="ident" id="2696743">p</span><span class="op" id="2696744">.</span><span class="ident" id="2696745">tag</span>&nbsp;<span class="op" id="2696749">!=</span>&nbsp;<span class="builtintype" id="2696752">nil</span>&nbsp;<span class="op" id="2696756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696760">f</span><span class="op" id="2696761">.</span><span class="ident" id="2696762">Tag</span>&nbsp;<span class="op" id="2696766">=</span>&nbsp;<span class="ident" id="2696768">StructTag</span><span class="op" id="2696777">(</span><span class="op" id="2696778">*</span><span class="ident" id="2696779">p</span><span class="op" id="2696780">.</span><span class="ident" id="2696781">tag</span><span class="op" id="2696784">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2696787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2696790">f</span><span class="op" id="2696791">.</span><span class="ident" id="2696792">Offset</span>&nbsp;<span class="op" id="2696799">=</span>&nbsp;<span class="ident" id="2696801">p</span><span class="op" id="2696802">.</span><span class="ident" id="2696803">offset</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2696812">//&nbsp;NOTE(rsc):&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;allocation&nbsp;in&nbsp;the&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2696872">//&nbsp;presented&nbsp;by&nbsp;a&nbsp;reflect.Type.&nbsp;&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;avoid,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2696933">//&nbsp;at&nbsp;least&nbsp;in&nbsp;the&nbsp;common&nbsp;cases,&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2696992">//&nbsp;that&nbsp;misbehaving&nbsp;clients&nbsp;of&nbsp;reflect&nbsp;cannot&nbsp;affect&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2697052">//&nbsp;uses&nbsp;of&nbsp;reflect.&nbsp;&nbsp;One&nbsp;possibility&nbsp;is&nbsp;CL&nbsp;5371098,&nbsp;but&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2697112">//&nbsp;postponed&nbsp;that&nbsp;ugliness&nbsp;until&nbsp;there&nbsp;is&nbsp;a&nbsp;demonstrated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2697170">//&nbsp;need&nbsp;for&nbsp;the&nbsp;performance.&nbsp;&nbsp;This&nbsp;is&nbsp;issue&nbsp;2320.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2697221">f</span><span class="op" id="2697222">.</span><span class="ident" id="2697223">Index</span>&nbsp;<span class="op" id="2697229">=</span>&nbsp;<span class="op" id="2697231">[</span><span class="op" id="2697232">]</span><span class="builtintype" id="2697233">int</span><span class="op" id="2697236">{</span><span class="ident" id="2697237">i</span><span class="op" id="2697238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2697241">return</span><br>
<span class="lineno"></span><span class="op" id="2697248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2697251">//&nbsp;TODO(gri):&nbsp;Should&nbsp;there&nbsp;be&nbsp;an&nbsp;error/bool&nbsp;indicator&nbsp;if&nbsp;the&nbsp;index</span><br>
<span class="lineno">845</span><span class="comment" id="2697318">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;wrong&nbsp;for&nbsp;FieldByIndex?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2697360">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="2697425">func</span>&nbsp;<span class="op" id="2697430">(</span><span class="ident" id="2697431">t</span>&nbsp;<span class="op" id="2697433">*</span><span class="ident" id="2697434">structType</span><span class="op" id="2697444">)</span>&nbsp;<span class="ident" id="2697446">FieldByIndex</span><span class="op" id="2697458">(</span><span class="ident" id="2697459">index</span>&nbsp;<span class="op" id="2697465">[</span><span class="op" id="2697466">]</span><span class="builtintype" id="2697467">int</span><span class="op" id="2697470">)</span>&nbsp;<span class="op" id="2697472">(</span><span class="ident" id="2697473">f</span>&nbsp;<span class="ident" id="2697475">StructField</span><span class="op" id="2697486">)</span>&nbsp;<span class="op" id="2697488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2697491">f</span><span class="op" id="2697492">.</span><span class="ident" id="2697493">Type</span>&nbsp;<span class="op" id="2697498">=</span>&nbsp;<span class="ident" id="2697500">toType</span><span class="op" id="2697506">(</span><span class="op" id="2697507">&amp;</span><span class="ident" id="2697508">t</span><span class="op" id="2697509">.</span><span class="ident" id="2697510">rtype</span><span class="op" id="2697515">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2697518">for</span>&nbsp;<span class="ident" id="2697522">i</span><span class="op" id="2697523">,</span>&nbsp;<span class="ident" id="2697525">x</span>&nbsp;<span class="op" id="2697527">:=</span>&nbsp;<span class="keyword" id="2697530">range</span>&nbsp;<span class="ident" id="2697536">index</span>&nbsp;<span class="op" id="2697542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2697546">if</span>&nbsp;<span class="ident" id="2697549">i</span>&nbsp;<span class="op" id="2697551">&gt;</span>&nbsp;<span class="num" id="2697553">0</span>&nbsp;<span class="op" id="2697555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2697560">ft</span>&nbsp;<span class="op" id="2697563">:=</span>&nbsp;<span class="ident" id="2697566">f</span><span class="op" id="2697567">.</span><span class="ident" id="2697568">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2697576">if</span>&nbsp;<span class="ident" id="2697579">ft</span><span class="op" id="2697581">.</span><span class="ident" id="2697582">Kind</span><span class="op" id="2697586">(</span><span class="op" id="2697587">)</span>&nbsp;<span class="op" id="2697589">==</span>&nbsp;<span class="ident" id="2697592">Ptr</span>&nbsp;<span class="op" id="2697596">&amp;&amp;</span>&nbsp;<span class="ident" id="2697599">ft</span><span class="op" id="2697601">.</span><span class="ident" id="2697602">Elem</span><span class="op" id="2697606">(</span><span class="op" id="2697607">)</span><span class="op" id="2697608">.</span><span class="ident" id="2697609">Kind</span><span class="op" id="2697613">(</span><span class="op" id="2697614">)</span>&nbsp;<span class="op" id="2697616">==</span>&nbsp;<span class="ident" id="2697619">Struct</span>&nbsp;<span class="op" id="2697626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2697632">ft</span>&nbsp;<span class="op" id="2697635">=</span>&nbsp;<span class="ident" id="2697637">ft</span><span class="op" id="2697639">.</span><span class="ident" id="2697640">Elem</span><span class="op" id="2697644">(</span><span class="op" id="2697645">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2697650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2697655">f</span><span class="op" id="2697656">.</span><span class="ident" id="2697657">Type</span>&nbsp;<span class="op" id="2697662">=</span>&nbsp;<span class="ident" id="2697664">ft</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2697669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2697673">f</span>&nbsp;<span class="op" id="2697675">=</span>&nbsp;<span class="ident" id="2697677">f</span><span class="op" id="2697678">.</span><span class="ident" id="2697679">Type</span><span class="op" id="2697683">.</span><span class="ident" id="2697684">Field</span><span class="op" id="2697689">(</span><span class="ident" id="2697690">x</span><span class="op" id="2697691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2697694">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2697697">return</span><br>
<span class="lineno"></span><span class="op" id="2697704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2697707">//&nbsp;A&nbsp;fieldScan&nbsp;represents&nbsp;an&nbsp;item&nbsp;on&nbsp;the&nbsp;fieldByNameFunc&nbsp;scan&nbsp;work&nbsp;list.</span><br>
<span class="lineno"></span><span class="keyword" id="2697780">type</span>&nbsp;<span class="ident" id="2697785">fieldScan</span>&nbsp;<span class="keyword" id="2697795">struct</span>&nbsp;<span class="op" id="2697802">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2697805">typ</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2697811">*</span><span class="ident" id="2697812">structType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2697824">index</span>&nbsp;<span class="op" id="2697830">[</span><span class="op" id="2697831">]</span><span class="builtintype" id="2697832">int</span><br>
<span class="lineno"></span><span class="op" id="2697836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2697839">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;that&nbsp;satisfies&nbsp;the</span><br>
<span class="lineno">870</span><span class="comment" id="2697914">//&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2697982">func</span>&nbsp;<span class="op" id="2697987">(</span><span class="ident" id="2697988">t</span>&nbsp;<span class="op" id="2697990">*</span><span class="ident" id="2697991">structType</span><span class="op" id="2698001">)</span>&nbsp;<span class="ident" id="2698003">FieldByNameFunc</span><span class="op" id="2698018">(</span><span class="ident" id="2698019">match</span>&nbsp;<span class="keyword" id="2698025">func</span><span class="op" id="2698029">(</span><span class="builtintype" id="2698030">string</span><span class="op" id="2698036">)</span>&nbsp;<span class="builtintype" id="2698038">bool</span><span class="op" id="2698042">)</span>&nbsp;<span class="op" id="2698044">(</span><span class="ident" id="2698045">result</span>&nbsp;<span class="ident" id="2698052">StructField</span><span class="op" id="2698063">,</span>&nbsp;<span class="ident" id="2698065">ok</span>&nbsp;<span class="builtintype" id="2698068">bool</span><span class="op" id="2698072">)</span>&nbsp;<span class="op" id="2698074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2698077">//&nbsp;This&nbsp;uses&nbsp;the&nbsp;same&nbsp;condition&nbsp;that&nbsp;the&nbsp;Go&nbsp;language&nbsp;does:&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;unique&nbsp;instance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2698169">//&nbsp;of&nbsp;the&nbsp;match&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;instances&nbsp;of&nbsp;a&nbsp;match&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2698260">//&nbsp;same&nbsp;depth,&nbsp;they&nbsp;annihilate&nbsp;each&nbsp;other&nbsp;and&nbsp;inhibit&nbsp;any&nbsp;possible&nbsp;match&nbsp;at&nbsp;a&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2698352">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth&nbsp;first&nbsp;search,&nbsp;one&nbsp;depth&nbsp;level&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2698423">//&nbsp;The&nbsp;current&nbsp;and&nbsp;next&nbsp;slices&nbsp;are&nbsp;work&nbsp;queues:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2698472">//&nbsp;current&nbsp;lists&nbsp;the&nbsp;fields&nbsp;to&nbsp;visit&nbsp;on&nbsp;this&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2698531">//&nbsp;and&nbsp;next&nbsp;lists&nbsp;the&nbsp;fields&nbsp;on&nbsp;the&nbsp;next&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2698586">current</span>&nbsp;<span class="op" id="2698594">:=</span>&nbsp;<span class="op" id="2698597">[</span><span class="op" id="2698598">]</span><span class="ident" id="2698599">fieldScan</span><span class="op" id="2698608">{</span><span class="op" id="2698609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2698612">next</span>&nbsp;<span class="op" id="2698617">:=</span>&nbsp;<span class="op" id="2698620">[</span><span class="op" id="2698621">]</span><span class="ident" id="2698622">fieldScan</span><span class="op" id="2698631">{</span><span class="op" id="2698632">{</span><span class="ident" id="2698633">typ</span><span class="op" id="2698636">:</span>&nbsp;<span class="ident" id="2698638">t</span><span class="op" id="2698639">}</span><span class="op" id="2698640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2698644">//&nbsp;nextCount&nbsp;records&nbsp;the&nbsp;number&nbsp;of&nbsp;times&nbsp;an&nbsp;embedded&nbsp;type&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2698712">//&nbsp;encountered&nbsp;and&nbsp;considered&nbsp;for&nbsp;queueing&nbsp;in&nbsp;the&nbsp;&#39;next&#39;&nbsp;slice.</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2698777">//&nbsp;We&nbsp;only&nbsp;queue&nbsp;the&nbsp;first&nbsp;one,&nbsp;but&nbsp;we&nbsp;increment&nbsp;the&nbsp;count&nbsp;on&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2698846">//&nbsp;If&nbsp;a&nbsp;struct&nbsp;type&nbsp;T&nbsp;can&nbsp;be&nbsp;reached&nbsp;more&nbsp;than&nbsp;once&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2698923">//&nbsp;then&nbsp;it&nbsp;annihilates&nbsp;itself&nbsp;and&nbsp;need&nbsp;not&nbsp;be&nbsp;considered&nbsp;at&nbsp;all&nbsp;when&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2698996">//&nbsp;process&nbsp;that&nbsp;next&nbsp;depth&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2699031">var</span>&nbsp;<span class="ident" id="2699035">nextCount</span>&nbsp;<span class="keyword" id="2699045">map</span><span class="op" id="2699048">[</span><span class="op" id="2699049">*</span><span class="ident" id="2699050">structType</span><span class="op" id="2699060">]</span><span class="builtintype" id="2699061">int</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2699067">//&nbsp;visited&nbsp;records&nbsp;the&nbsp;structs&nbsp;that&nbsp;have&nbsp;been&nbsp;considered&nbsp;already.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2699134">//&nbsp;Embedded&nbsp;pointer&nbsp;fields&nbsp;can&nbsp;create&nbsp;cycles&nbsp;in&nbsp;the&nbsp;graph&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2699196">//&nbsp;reachable&nbsp;embedded&nbsp;types;&nbsp;visited&nbsp;avoids&nbsp;following&nbsp;those&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2699265">//&nbsp;It&nbsp;also&nbsp;avoids&nbsp;duplicated&nbsp;effort:&nbsp;if&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;the&nbsp;field&nbsp;in&nbsp;an</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2699337">//&nbsp;embedded&nbsp;type&nbsp;T&nbsp;at&nbsp;level&nbsp;2,&nbsp;we&nbsp;won&#39;t&nbsp;find&nbsp;it&nbsp;in&nbsp;one&nbsp;at&nbsp;level&nbsp;4&nbsp;either.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2699412">visited</span>&nbsp;<span class="op" id="2699420">:=</span>&nbsp;<span class="keyword" id="2699423">map</span><span class="op" id="2699426">[</span><span class="op" id="2699427">*</span><span class="ident" id="2699428">structType</span><span class="op" id="2699438">]</span><span class="builtintype" id="2699439">bool</span><span class="op" id="2699443">{</span><span class="op" id="2699444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2699448">for</span>&nbsp;<span class="builtinfunc" id="2699452">len</span><span class="op" id="2699455">(</span><span class="ident" id="2699456">next</span><span class="op" id="2699460">)</span>&nbsp;<span class="op" id="2699462">&gt;</span>&nbsp;<span class="num" id="2699464">0</span>&nbsp;<span class="op" id="2699466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2699470">current</span><span class="op" id="2699477">,</span>&nbsp;<span class="ident" id="2699479">next</span>&nbsp;<span class="op" id="2699484">=</span>&nbsp;<span class="ident" id="2699486">next</span><span class="op" id="2699490">,</span>&nbsp;<span class="ident" id="2699492">current</span><span class="op" id="2699499">[</span><span class="op" id="2699500">:</span><span class="num" id="2699501">0</span><span class="op" id="2699502">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2699506">count</span>&nbsp;<span class="op" id="2699512">:=</span>&nbsp;<span class="ident" id="2699515">nextCount</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2699527">nextCount</span>&nbsp;<span class="op" id="2699537">=</span>&nbsp;<span class="builtintype" id="2699539">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2699546">//&nbsp;Process&nbsp;all&nbsp;the&nbsp;fields&nbsp;at&nbsp;this&nbsp;depth,&nbsp;now&nbsp;listed&nbsp;in&nbsp;&#39;current&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2699614">//&nbsp;The&nbsp;loop&nbsp;queues&nbsp;embedded&nbsp;fields&nbsp;found&nbsp;in&nbsp;&#39;next&#39;,&nbsp;for&nbsp;processing&nbsp;during&nbsp;the&nbsp;next</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2699699">//&nbsp;iteration.&nbsp;The&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;current&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2699774">//&nbsp;in&nbsp;&#39;count&#39;;&nbsp;the&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;next&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded&nbsp;in&nbsp;&#39;nextCount&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2699863">for</span>&nbsp;<span class="ident" id="2699867">_</span><span class="op" id="2699868">,</span>&nbsp;<span class="ident" id="2699870">scan</span>&nbsp;<span class="op" id="2699875">:=</span>&nbsp;<span class="keyword" id="2699878">range</span>&nbsp;<span class="ident" id="2699884">current</span>&nbsp;<span class="op" id="2699892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2699897">t</span>&nbsp;<span class="op" id="2699899">:=</span>&nbsp;<span class="ident" id="2699902">scan</span><span class="op" id="2699906">.</span><span class="ident" id="2699907">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2699914">if</span>&nbsp;<span class="ident" id="2699917">visited</span><span class="op" id="2699924">[</span><span class="ident" id="2699925">t</span><span class="op" id="2699926">]</span>&nbsp;<span class="op" id="2699928">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2699934">//&nbsp;We&#39;ve&nbsp;looked&nbsp;through&nbsp;this&nbsp;type&nbsp;before,&nbsp;at&nbsp;a&nbsp;higher&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2699999">//&nbsp;That&nbsp;higher&nbsp;level&nbsp;would&nbsp;shadow&nbsp;the&nbsp;lower&nbsp;level&nbsp;we&#39;re&nbsp;now&nbsp;at,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2700067">//&nbsp;so&nbsp;this&nbsp;one&nbsp;can&#39;t&nbsp;be&nbsp;useful&nbsp;to&nbsp;us.&nbsp;Ignore&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2700120">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2700132">}</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2700137">visited</span><span class="op" id="2700144">[</span><span class="ident" id="2700145">t</span><span class="op" id="2700146">]</span>&nbsp;<span class="op" id="2700148">=</span>&nbsp;<span class="builtintype" id="2700150">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2700158">for</span>&nbsp;<span class="ident" id="2700162">i</span>&nbsp;<span class="op" id="2700164">:=</span>&nbsp;<span class="keyword" id="2700167">range</span>&nbsp;<span class="ident" id="2700173">t</span><span class="op" id="2700174">.</span><span class="ident" id="2700175">fields</span>&nbsp;<span class="op" id="2700182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2700188">f</span>&nbsp;<span class="op" id="2700190">:=</span>&nbsp;<span class="op" id="2700193">&amp;</span><span class="ident" id="2700194">t</span><span class="op" id="2700195">.</span><span class="ident" id="2700196">fields</span><span class="op" id="2700202">[</span><span class="ident" id="2700203">i</span><span class="op" id="2700204">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2700210">//&nbsp;Find&nbsp;name&nbsp;and&nbsp;type&nbsp;for&nbsp;field&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2700249">var</span>&nbsp;<span class="ident" id="2700253">fname</span>&nbsp;<span class="builtintype" id="2700259">string</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2700270">var</span>&nbsp;<span class="ident" id="2700274">ntyp</span>&nbsp;<span class="op" id="2700279">*</span><span class="ident" id="2700280">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2700290">if</span>&nbsp;<span class="ident" id="2700293">f</span><span class="op" id="2700294">.</span><span class="ident" id="2700295">name</span>&nbsp;<span class="op" id="2700300">!=</span>&nbsp;<span class="builtintype" id="2700303">nil</span>&nbsp;<span class="op" id="2700307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2700314">fname</span>&nbsp;<span class="op" id="2700320">=</span>&nbsp;<span class="op" id="2700322">*</span><span class="ident" id="2700323">f</span><span class="op" id="2700324">.</span><span class="ident" id="2700325">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2700334">}</span>&nbsp;<span class="keyword" id="2700336">else</span>&nbsp;<span class="op" id="2700341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2700348">//&nbsp;Anonymous&nbsp;field&nbsp;of&nbsp;type&nbsp;T&nbsp;or&nbsp;*T.</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2700389">//&nbsp;Name&nbsp;taken&nbsp;from&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2700419">ntyp</span>&nbsp;<span class="op" id="2700424">=</span>&nbsp;<span class="ident" id="2700426">f</span><span class="op" id="2700427">.</span><span class="ident" id="2700428">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2700437">if</span>&nbsp;<span class="ident" id="2700440">ntyp</span><span class="op" id="2700444">.</span><span class="ident" id="2700445">Kind</span><span class="op" id="2700449">(</span><span class="op" id="2700450">)</span>&nbsp;<span class="op" id="2700452">==</span>&nbsp;<span class="ident" id="2700455">Ptr</span>&nbsp;<span class="op" id="2700459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2700467">ntyp</span>&nbsp;<span class="op" id="2700472">=</span>&nbsp;<span class="ident" id="2700474">ntyp</span><span class="op" id="2700478">.</span><span class="ident" id="2700479">Elem</span><span class="op" id="2700483">(</span><span class="op" id="2700484">)</span><span class="op" id="2700485">.</span><span class="ident" id="2700486">common</span><span class="op" id="2700492">(</span><span class="op" id="2700493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2700500">}</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2700507">fname</span>&nbsp;<span class="op" id="2700513">=</span>&nbsp;<span class="ident" id="2700515">ntyp</span><span class="op" id="2700519">.</span><span class="ident" id="2700520">Name</span><span class="op" id="2700524">(</span><span class="op" id="2700525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2700531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2700538">//&nbsp;Does&nbsp;it&nbsp;match?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2700560">if</span>&nbsp;<span class="ident" id="2700563">match</span><span class="op" id="2700568">(</span><span class="ident" id="2700569">fname</span><span class="op" id="2700574">)</span>&nbsp;<span class="op" id="2700576">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2700583">//&nbsp;Potential&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2700607">if</span>&nbsp;<span class="ident" id="2700610">count</span><span class="op" id="2700615">[</span><span class="ident" id="2700616">t</span><span class="op" id="2700617">]</span>&nbsp;<span class="op" id="2700619">&gt;</span>&nbsp;<span class="num" id="2700621">1</span>&nbsp;<span class="op" id="2700623">||</span>&nbsp;<span class="ident" id="2700626">ok</span>&nbsp;<span class="op" id="2700629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2700637">//&nbsp;Name&nbsp;appeared&nbsp;multiple&nbsp;times&nbsp;at&nbsp;this&nbsp;level:&nbsp;annihilate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2700702">return</span>&nbsp;<span class="ident" id="2700709">StructField</span><span class="op" id="2700720">{</span><span class="op" id="2700721">}</span><span class="op" id="2700722">,</span>&nbsp;<span class="builtintype" id="2700724">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2700735">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2700742">result</span>&nbsp;<span class="op" id="2700749">=</span>&nbsp;<span class="ident" id="2700751">t</span><span class="op" id="2700752">.</span><span class="ident" id="2700753">Field</span><span class="op" id="2700758">(</span><span class="ident" id="2700759">i</span><span class="op" id="2700760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2700767">result</span><span class="op" id="2700773">.</span><span class="ident" id="2700774">Index</span>&nbsp;<span class="op" id="2700780">=</span>&nbsp;<span class="builtintype" id="2700782">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2700791">result</span><span class="op" id="2700797">.</span><span class="ident" id="2700798">Index</span>&nbsp;<span class="op" id="2700804">=</span>&nbsp;<span class="builtinfunc" id="2700806">append</span><span class="op" id="2700812">(</span><span class="ident" id="2700813">result</span><span class="op" id="2700819">.</span><span class="ident" id="2700820">Index</span><span class="op" id="2700825">,</span>&nbsp;<span class="ident" id="2700827">scan</span><span class="op" id="2700831">.</span><span class="ident" id="2700832">index</span><span class="op" id="2700837">...</span><span class="op" id="2700840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2700847">result</span><span class="op" id="2700853">.</span><span class="ident" id="2700854">Index</span>&nbsp;<span class="op" id="2700860">=</span>&nbsp;<span class="builtinfunc" id="2700862">append</span><span class="op" id="2700868">(</span><span class="ident" id="2700869">result</span><span class="op" id="2700875">.</span><span class="ident" id="2700876">Index</span><span class="op" id="2700881">,</span>&nbsp;<span class="ident" id="2700883">i</span><span class="op" id="2700884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2700891">ok</span>&nbsp;<span class="op" id="2700894">=</span>&nbsp;<span class="builtintype" id="2700896">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2700906">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2700919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2700926">//&nbsp;Queue&nbsp;embedded&nbsp;struct&nbsp;fields&nbsp;for&nbsp;processing&nbsp;with&nbsp;next&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2700994">//&nbsp;but&nbsp;only&nbsp;if&nbsp;we&nbsp;haven&#39;t&nbsp;seen&nbsp;a&nbsp;match&nbsp;yet&nbsp;at&nbsp;this&nbsp;level&nbsp;and&nbsp;only</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2701064">//&nbsp;if&nbsp;the&nbsp;embedded&nbsp;types&nbsp;haven&#39;t&nbsp;already&nbsp;been&nbsp;queued.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2701122">if</span>&nbsp;<span class="ident" id="2701125">ok</span>&nbsp;<span class="op" id="2701128">||</span>&nbsp;<span class="ident" id="2701131">ntyp</span>&nbsp;<span class="op" id="2701136">==</span>&nbsp;<span class="builtintype" id="2701139">nil</span>&nbsp;<span class="op" id="2701143">||</span>&nbsp;<span class="ident" id="2701146">ntyp</span><span class="op" id="2701150">.</span><span class="ident" id="2701151">Kind</span><span class="op" id="2701155">(</span><span class="op" id="2701156">)</span>&nbsp;<span class="op" id="2701158">!=</span>&nbsp;<span class="ident" id="2701161">Struct</span>&nbsp;<span class="op" id="2701168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2701175">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2701188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2701194">styp</span>&nbsp;<span class="op" id="2701199">:=</span>&nbsp;<span class="op" id="2701202">(</span><span class="op" id="2701203">*</span><span class="ident" id="2701204">structType</span><span class="op" id="2701214">)</span><span class="op" id="2701215">(</span><span class="ident" id="2701216">unsafe</span><span class="op" id="2701222">.</span><span class="ident" id="2701223">Pointer</span><span class="op" id="2701230">(</span><span class="ident" id="2701231">ntyp</span><span class="op" id="2701235">)</span><span class="op" id="2701236">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2701242">if</span>&nbsp;<span class="ident" id="2701245">nextCount</span><span class="op" id="2701254">[</span><span class="ident" id="2701255">styp</span><span class="op" id="2701259">]</span>&nbsp;<span class="op" id="2701261">&gt;</span>&nbsp;<span class="num" id="2701263">0</span>&nbsp;<span class="op" id="2701265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2701272">nextCount</span><span class="op" id="2701281">[</span><span class="ident" id="2701282">styp</span><span class="op" id="2701286">]</span>&nbsp;<span class="op" id="2701288">=</span>&nbsp;<span class="num" id="2701290">2</span>&nbsp;<span class="comment" id="2701292">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2701330">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2701343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2701349">if</span>&nbsp;<span class="ident" id="2701352">nextCount</span>&nbsp;<span class="op" id="2701362">==</span>&nbsp;<span class="builtintype" id="2701365">nil</span>&nbsp;<span class="op" id="2701369">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2701376">nextCount</span>&nbsp;<span class="op" id="2701386">=</span>&nbsp;<span class="keyword" id="2701388">map</span><span class="op" id="2701391">[</span><span class="op" id="2701392">*</span><span class="ident" id="2701393">structType</span><span class="op" id="2701403">]</span><span class="builtintype" id="2701404">int</span><span class="op" id="2701407">{</span><span class="op" id="2701408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2701414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2701420">nextCount</span><span class="op" id="2701429">[</span><span class="ident" id="2701430">styp</span><span class="op" id="2701434">]</span>&nbsp;<span class="op" id="2701436">=</span>&nbsp;<span class="num" id="2701438">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2701444">if</span>&nbsp;<span class="ident" id="2701447">count</span><span class="op" id="2701452">[</span><span class="ident" id="2701453">t</span><span class="op" id="2701454">]</span>&nbsp;<span class="op" id="2701456">&gt;</span>&nbsp;<span class="num" id="2701458">1</span>&nbsp;<span class="op" id="2701460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2701467">nextCount</span><span class="op" id="2701476">[</span><span class="ident" id="2701477">styp</span><span class="op" id="2701481">]</span>&nbsp;<span class="op" id="2701483">=</span>&nbsp;<span class="num" id="2701485">2</span>&nbsp;<span class="comment" id="2701487">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2701524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2701530">var</span>&nbsp;<span class="ident" id="2701534">index</span>&nbsp;<span class="op" id="2701540">[</span><span class="op" id="2701541">]</span><span class="builtintype" id="2701542">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2701550">index</span>&nbsp;<span class="op" id="2701556">=</span>&nbsp;<span class="builtinfunc" id="2701558">append</span><span class="op" id="2701564">(</span><span class="ident" id="2701565">index</span><span class="op" id="2701570">,</span>&nbsp;<span class="ident" id="2701572">scan</span><span class="op" id="2701576">.</span><span class="ident" id="2701577">index</span><span class="op" id="2701582">...</span><span class="op" id="2701585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2701591">index</span>&nbsp;<span class="op" id="2701597">=</span>&nbsp;<span class="builtinfunc" id="2701599">append</span><span class="op" id="2701605">(</span><span class="ident" id="2701606">index</span><span class="op" id="2701611">,</span>&nbsp;<span class="ident" id="2701613">i</span><span class="op" id="2701614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2701620">next</span>&nbsp;<span class="op" id="2701625">=</span>&nbsp;<span class="builtinfunc" id="2701627">append</span><span class="op" id="2701633">(</span><span class="ident" id="2701634">next</span><span class="op" id="2701638">,</span>&nbsp;<span class="ident" id="2701640">fieldScan</span><span class="op" id="2701649">{</span><span class="ident" id="2701650">styp</span><span class="op" id="2701654">,</span>&nbsp;<span class="ident" id="2701656">index</span><span class="op" id="2701661">}</span><span class="op" id="2701662">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2701667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2701671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2701675">if</span>&nbsp;<span class="ident" id="2701678">ok</span>&nbsp;<span class="op" id="2701681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2701686">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2701694">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2701697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2701700">return</span><br>
<span class="lineno"></span><span class="op" id="2701707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2701710">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">980</span><span class="comment" id="2701770">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2701823">func</span>&nbsp;<span class="op" id="2701828">(</span><span class="ident" id="2701829">t</span>&nbsp;<span class="op" id="2701831">*</span><span class="ident" id="2701832">structType</span><span class="op" id="2701842">)</span>&nbsp;<span class="ident" id="2701844">FieldByName</span><span class="op" id="2701855">(</span><span class="ident" id="2701856">name</span>&nbsp;<span class="builtintype" id="2701861">string</span><span class="op" id="2701867">)</span>&nbsp;<span class="op" id="2701869">(</span><span class="ident" id="2701870">f</span>&nbsp;<span class="ident" id="2701872">StructField</span><span class="op" id="2701883">,</span>&nbsp;<span class="ident" id="2701885">present</span>&nbsp;<span class="builtintype" id="2701893">bool</span><span class="op" id="2701897">)</span>&nbsp;<span class="op" id="2701899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2701902">//&nbsp;Quick&nbsp;check&nbsp;for&nbsp;top-level&nbsp;name,&nbsp;or&nbsp;struct&nbsp;without&nbsp;anonymous&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2701974">hasAnon</span>&nbsp;<span class="op" id="2701982">:=</span>&nbsp;<span class="builtintype" id="2701985">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2701992">if</span>&nbsp;<span class="ident" id="2701995">name</span>&nbsp;<span class="op" id="2702000">!=</span>&nbsp;<span class="string" id="2702003">&#34;&#34;</span>&nbsp;<span class="op" id="2702006">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2702010">for</span>&nbsp;<span class="ident" id="2702014">i</span>&nbsp;<span class="op" id="2702016">:=</span>&nbsp;<span class="keyword" id="2702019">range</span>&nbsp;<span class="ident" id="2702025">t</span><span class="op" id="2702026">.</span><span class="ident" id="2702027">fields</span>&nbsp;<span class="op" id="2702034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2702039">tf</span>&nbsp;<span class="op" id="2702042">:=</span>&nbsp;<span class="op" id="2702045">&amp;</span><span class="ident" id="2702046">t</span><span class="op" id="2702047">.</span><span class="ident" id="2702048">fields</span><span class="op" id="2702054">[</span><span class="ident" id="2702055">i</span><span class="op" id="2702056">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2702061">if</span>&nbsp;<span class="ident" id="2702064">tf</span><span class="op" id="2702066">.</span><span class="ident" id="2702067">name</span>&nbsp;<span class="op" id="2702072">==</span>&nbsp;<span class="builtintype" id="2702075">nil</span>&nbsp;<span class="op" id="2702079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2702085">hasAnon</span>&nbsp;<span class="op" id="2702093">=</span>&nbsp;<span class="builtintype" id="2702095">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2702104">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2702116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2702121">if</span>&nbsp;<span class="op" id="2702124">*</span><span class="ident" id="2702125">tf</span><span class="op" id="2702127">.</span><span class="ident" id="2702128">name</span>&nbsp;<span class="op" id="2702133">==</span>&nbsp;<span class="ident" id="2702136">name</span>&nbsp;<span class="op" id="2702141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2702147">return</span>&nbsp;<span class="ident" id="2702154">t</span><span class="op" id="2702155">.</span><span class="ident" id="2702156">Field</span><span class="op" id="2702161">(</span><span class="ident" id="2702162">i</span><span class="op" id="2702163">)</span><span class="op" id="2702164">,</span>&nbsp;<span class="builtintype" id="2702166">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2702174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2702178">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2702181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2702184">if</span>&nbsp;<span class="op" id="2702187">!</span><span class="ident" id="2702188">hasAnon</span>&nbsp;<span class="op" id="2702196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2702200">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2702208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2702211">return</span>&nbsp;<span class="ident" id="2702218">t</span><span class="op" id="2702219">.</span><span class="ident" id="2702220">FieldByNameFunc</span><span class="op" id="2702235">(</span><span class="keyword" id="2702236">func</span><span class="op" id="2702240">(</span><span class="ident" id="2702241">s</span>&nbsp;<span class="builtintype" id="2702243">string</span><span class="op" id="2702249">)</span>&nbsp;<span class="builtintype" id="2702251">bool</span>&nbsp;<span class="op" id="2702256">{</span>&nbsp;<span class="keyword" id="2702258">return</span>&nbsp;<span class="ident" id="2702265">s</span>&nbsp;<span class="op" id="2702267">==</span>&nbsp;<span class="ident" id="2702270">name</span>&nbsp;<span class="op" id="2702275">}</span><span class="op" id="2702276">)</span><br>
<span class="lineno">1000</span><span class="op" id="2702278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2702281">//&nbsp;TypeOf&nbsp;returns&nbsp;the&nbsp;reflection&nbsp;Type&nbsp;of&nbsp;the&nbsp;value&nbsp;in&nbsp;the&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="2702352">//&nbsp;TypeOf(nil)&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2702380">func</span>&nbsp;<span class="ident" id="2702385">TypeOf</span><span class="op" id="2702391">(</span><span class="ident" id="2702392">i</span>&nbsp;<span class="keyword" id="2702394">interface</span><span class="op" id="2702403">{</span><span class="op" id="2702404">}</span><span class="op" id="2702405">)</span>&nbsp;<span class="ident" id="2702407">Type</span>&nbsp;<span class="op" id="2702412">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2702415">eface</span>&nbsp;<span class="op" id="2702421">:=</span>&nbsp;<span class="op" id="2702424">*</span><span class="op" id="2702425">(</span><span class="op" id="2702426">*</span><span class="ident" id="2702427">emptyInterface</span><span class="op" id="2702441">)</span><span class="op" id="2702442">(</span><span class="ident" id="2702443">unsafe</span><span class="op" id="2702449">.</span><span class="ident" id="2702450">Pointer</span><span class="op" id="2702457">(</span><span class="op" id="2702458">&amp;</span><span class="ident" id="2702459">i</span><span class="op" id="2702460">)</span><span class="op" id="2702461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2702464">return</span>&nbsp;<span class="ident" id="2702471">toType</span><span class="op" id="2702477">(</span><span class="ident" id="2702478">eface</span><span class="op" id="2702483">.</span><span class="ident" id="2702484">typ</span><span class="op" id="2702487">)</span><br>
<span class="lineno"></span><span class="op" id="2702489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2702492">//&nbsp;ptrMap&nbsp;is&nbsp;the&nbsp;cache&nbsp;for&nbsp;PtrTo.</span><br>
<span class="lineno">1010</span><span class="keyword" id="2702526">var</span>&nbsp;<span class="ident" id="2702530">ptrMap</span>&nbsp;<span class="keyword" id="2702537">struct</span>&nbsp;<span class="op" id="2702544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2702547">sync</span><span class="op" id="2702551">.</span><span class="ident" id="2702552">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2702561">m</span>&nbsp;<span class="keyword" id="2702563">map</span><span class="op" id="2702566">[</span><span class="op" id="2702567">*</span><span class="ident" id="2702568">rtype</span><span class="op" id="2702573">]</span><span class="op" id="2702574">*</span><span class="ident" id="2702575">ptrType</span><br>
<span class="lineno"></span><span class="op" id="2702583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1015</span><span class="comment" id="2702586">//&nbsp;PtrTo&nbsp;returns&nbsp;the&nbsp;pointer&nbsp;type&nbsp;with&nbsp;element&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2702636">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;type&nbsp;Foo,&nbsp;PtrTo(t)&nbsp;represents&nbsp;*Foo.</span><br>
<span class="lineno"></span><span class="keyword" id="2702704">func</span>&nbsp;<span class="ident" id="2702709">PtrTo</span><span class="op" id="2702714">(</span><span class="ident" id="2702715">t</span>&nbsp;<span class="ident" id="2702717">Type</span><span class="op" id="2702721">)</span>&nbsp;<span class="ident" id="2702723">Type</span>&nbsp;<span class="op" id="2702728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2702731">return</span>&nbsp;<span class="ident" id="2702738">t</span><span class="op" id="2702739">.</span><span class="op" id="2702740">(</span><span class="op" id="2702741">*</span><span class="ident" id="2702742">rtype</span><span class="op" id="2702747">)</span><span class="op" id="2702748">.</span><span class="ident" id="2702749">ptrTo</span><span class="op" id="2702754">(</span><span class="op" id="2702755">)</span><br>
<span class="lineno"></span><span class="op" id="2702757">}</span><br>
<span class="lineno">1020</span><br>
<span class="lineno"></span><span class="keyword" id="2702760">func</span>&nbsp;<span class="op" id="2702765">(</span><span class="ident" id="2702766">t</span>&nbsp;<span class="op" id="2702768">*</span><span class="ident" id="2702769">rtype</span><span class="op" id="2702774">)</span>&nbsp;<span class="ident" id="2702776">ptrTo</span><span class="op" id="2702781">(</span><span class="op" id="2702782">)</span>&nbsp;<span class="op" id="2702784">*</span><span class="ident" id="2702785">rtype</span>&nbsp;<span class="op" id="2702791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2702794">if</span>&nbsp;<span class="ident" id="2702797">p</span>&nbsp;<span class="op" id="2702799">:=</span>&nbsp;<span class="ident" id="2702802">t</span><span class="op" id="2702803">.</span><span class="ident" id="2702804">ptrToThis</span><span class="op" id="2702813">;</span>&nbsp;<span class="ident" id="2702815">p</span>&nbsp;<span class="op" id="2702817">!=</span>&nbsp;<span class="builtintype" id="2702820">nil</span>&nbsp;<span class="op" id="2702824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2702828">return</span>&nbsp;<span class="ident" id="2702835">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2702838">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2702842">//&nbsp;Otherwise,&nbsp;synthesize&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2702873">//&nbsp;This&nbsp;only&nbsp;happens&nbsp;for&nbsp;pointers&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2702925">//&nbsp;We&nbsp;keep&nbsp;the&nbsp;mapping&nbsp;in&nbsp;a&nbsp;map&nbsp;on&nbsp;the&nbsp;side,&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2702979">//&nbsp;this&nbsp;operation&nbsp;is&nbsp;rare&nbsp;and&nbsp;a&nbsp;separate&nbsp;map&nbsp;lets&nbsp;us&nbsp;keep</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2703038">//&nbsp;the&nbsp;type&nbsp;structures&nbsp;in&nbsp;read-only&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703083">ptrMap</span><span class="op" id="2703089">.</span><span class="ident" id="2703090">RLock</span><span class="op" id="2703095">(</span><span class="op" id="2703096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2703099">if</span>&nbsp;<span class="ident" id="2703102">m</span>&nbsp;<span class="op" id="2703104">:=</span>&nbsp;<span class="ident" id="2703107">ptrMap</span><span class="op" id="2703113">.</span><span class="ident" id="2703114">m</span><span class="op" id="2703115">;</span>&nbsp;<span class="ident" id="2703117">m</span>&nbsp;<span class="op" id="2703119">!=</span>&nbsp;<span class="builtintype" id="2703122">nil</span>&nbsp;<span class="op" id="2703126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2703130">if</span>&nbsp;<span class="ident" id="2703133">p</span>&nbsp;<span class="op" id="2703135">:=</span>&nbsp;<span class="ident" id="2703138">m</span><span class="op" id="2703139">[</span><span class="ident" id="2703140">t</span><span class="op" id="2703141">]</span><span class="op" id="2703142">;</span>&nbsp;<span class="ident" id="2703144">p</span>&nbsp;<span class="op" id="2703146">!=</span>&nbsp;<span class="builtintype" id="2703149">nil</span>&nbsp;<span class="op" id="2703153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703158">ptrMap</span><span class="op" id="2703164">.</span><span class="ident" id="2703165">RUnlock</span><span class="op" id="2703172">(</span><span class="op" id="2703173">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2703178">return</span>&nbsp;<span class="op" id="2703185">&amp;</span><span class="ident" id="2703186">p</span><span class="op" id="2703187">.</span><span class="ident" id="2703188">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2703196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2703199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703202">ptrMap</span><span class="op" id="2703208">.</span><span class="ident" id="2703209">RUnlock</span><span class="op" id="2703216">(</span><span class="op" id="2703217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703220">ptrMap</span><span class="op" id="2703226">.</span><span class="ident" id="2703227">Lock</span><span class="op" id="2703231">(</span><span class="op" id="2703232">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2703235">if</span>&nbsp;<span class="ident" id="2703238">ptrMap</span><span class="op" id="2703244">.</span><span class="ident" id="2703245">m</span>&nbsp;<span class="op" id="2703247">==</span>&nbsp;<span class="builtintype" id="2703250">nil</span>&nbsp;<span class="op" id="2703254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703258">ptrMap</span><span class="op" id="2703264">.</span><span class="ident" id="2703265">m</span>&nbsp;<span class="op" id="2703267">=</span>&nbsp;<span class="builtinfunc" id="2703269">make</span><span class="op" id="2703273">(</span><span class="keyword" id="2703274">map</span><span class="op" id="2703277">[</span><span class="op" id="2703278">*</span><span class="ident" id="2703279">rtype</span><span class="op" id="2703284">]</span><span class="op" id="2703285">*</span><span class="ident" id="2703286">ptrType</span><span class="op" id="2703293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2703296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703299">p</span>&nbsp;<span class="op" id="2703301">:=</span>&nbsp;<span class="ident" id="2703304">ptrMap</span><span class="op" id="2703310">.</span><span class="ident" id="2703311">m</span><span class="op" id="2703312">[</span><span class="ident" id="2703313">t</span><span class="op" id="2703314">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2703317">if</span>&nbsp;<span class="ident" id="2703320">p</span>&nbsp;<span class="op" id="2703322">!=</span>&nbsp;<span class="builtintype" id="2703325">nil</span>&nbsp;<span class="op" id="2703329">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2703333">//&nbsp;some&nbsp;other&nbsp;goroutine&nbsp;won&nbsp;the&nbsp;race&nbsp;and&nbsp;created&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703387">ptrMap</span><span class="op" id="2703393">.</span><span class="ident" id="2703394">Unlock</span><span class="op" id="2703400">(</span><span class="op" id="2703401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2703405">return</span>&nbsp;<span class="op" id="2703412">&amp;</span><span class="ident" id="2703413">p</span><span class="op" id="2703414">.</span><span class="ident" id="2703415">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2703422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2703426">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;ptrType&nbsp;starting&nbsp;with&nbsp;the&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2703481">//&nbsp;of&nbsp;an&nbsp;*unsafe.Pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703508">p</span>&nbsp;<span class="op" id="2703510">=</span>&nbsp;<span class="builtinfunc" id="2703512">new</span><span class="op" id="2703515">(</span><span class="ident" id="2703516">ptrType</span><span class="op" id="2703523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2703526">var</span>&nbsp;<span class="ident" id="2703530">iptr</span>&nbsp;<span class="keyword" id="2703535">interface</span><span class="op" id="2703544">{</span><span class="op" id="2703545">}</span>&nbsp;<span class="op" id="2703547">=</span>&nbsp;<span class="op" id="2703549">(</span><span class="op" id="2703550">*</span><span class="ident" id="2703551">unsafe</span><span class="op" id="2703557">.</span><span class="ident" id="2703558">Pointer</span><span class="op" id="2703565">)</span><span class="op" id="2703566">(</span><span class="builtintype" id="2703567">nil</span><span class="op" id="2703570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703573">prototype</span>&nbsp;<span class="op" id="2703583">:=</span>&nbsp;<span class="op" id="2703586">*</span><span class="op" id="2703587">(</span><span class="op" id="2703588">*</span><span class="op" id="2703589">*</span><span class="ident" id="2703590">ptrType</span><span class="op" id="2703597">)</span><span class="op" id="2703598">(</span><span class="ident" id="2703599">unsafe</span><span class="op" id="2703605">.</span><span class="ident" id="2703606">Pointer</span><span class="op" id="2703613">(</span><span class="op" id="2703614">&amp;</span><span class="ident" id="2703615">iptr</span><span class="op" id="2703619">)</span><span class="op" id="2703620">)</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2703623">*</span><span class="ident" id="2703624">p</span>&nbsp;<span class="op" id="2703626">=</span>&nbsp;<span class="op" id="2703628">*</span><span class="ident" id="2703629">prototype</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703641">s</span>&nbsp;<span class="op" id="2703643">:=</span>&nbsp;<span class="string" id="2703646">&#34;*&#34;</span>&nbsp;<span class="op" id="2703650">+</span>&nbsp;<span class="op" id="2703652">*</span><span class="ident" id="2703653">t</span><span class="op" id="2703654">.</span><span class="builtintype" id="2703655">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703663">p</span><span class="op" id="2703664">.</span><span class="builtintype" id="2703665">string</span>&nbsp;<span class="op" id="2703672">=</span>&nbsp;<span class="op" id="2703674">&amp;</span><span class="ident" id="2703675">s</span><br>
<span class="lineno"></span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2703679">//&nbsp;For&nbsp;the&nbsp;type&nbsp;structures&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary,&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2703735">//&nbsp;compiler&nbsp;provides&nbsp;a&nbsp;good&nbsp;hash&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2703784">//&nbsp;Create&nbsp;a&nbsp;good&nbsp;hash&nbsp;for&nbsp;the&nbsp;new&nbsp;string&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2703835">//&nbsp;the&nbsp;FNV-1&nbsp;hash&#39;s&nbsp;mixing&nbsp;function&nbsp;to&nbsp;combine&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2703887">//&nbsp;old&nbsp;hash&nbsp;and&nbsp;the&nbsp;new&nbsp;&#34;*&#34;.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703917">p</span><span class="op" id="2703918">.</span><span class="ident" id="2703919">hash</span>&nbsp;<span class="op" id="2703924">=</span>&nbsp;<span class="ident" id="2703926">fnv1</span><span class="op" id="2703930">(</span><span class="ident" id="2703931">t</span><span class="op" id="2703932">.</span><span class="ident" id="2703933">hash</span><span class="op" id="2703937">,</span>&nbsp;<span class="string" id="2703939">&#39;*&#39;</span><span class="op" id="2703942">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703946">p</span><span class="op" id="2703947">.</span><span class="ident" id="2703948">uncommonType</span>&nbsp;<span class="op" id="2703961">=</span>&nbsp;<span class="builtintype" id="2703963">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703968">p</span><span class="op" id="2703969">.</span><span class="ident" id="2703970">ptrToThis</span>&nbsp;<span class="op" id="2703980">=</span>&nbsp;<span class="builtintype" id="2703982">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2703987">p</span><span class="op" id="2703988">.</span><span class="ident" id="2703989">zero</span>&nbsp;<span class="op" id="2703994">=</span>&nbsp;<span class="ident" id="2703996">unsafe</span><span class="op" id="2704002">.</span><span class="ident" id="2704003">Pointer</span><span class="op" id="2704010">(</span><span class="op" id="2704011">&amp;</span><span class="builtinfunc" id="2704012">make</span><span class="op" id="2704016">(</span><span class="op" id="2704017">[</span><span class="op" id="2704018">]</span><span class="builtintype" id="2704019">byte</span><span class="op" id="2704023">,</span>&nbsp;<span class="ident" id="2704025">p</span><span class="op" id="2704026">.</span><span class="ident" id="2704027">size</span><span class="op" id="2704031">)</span><span class="op" id="2704032">[</span><span class="num" id="2704033">0</span><span class="op" id="2704034">]</span><span class="op" id="2704035">)</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2704038">p</span><span class="op" id="2704039">.</span><span class="ident" id="2704040">elem</span>&nbsp;<span class="op" id="2704045">=</span>&nbsp;<span class="ident" id="2704047">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2704051">ptrMap</span><span class="op" id="2704057">.</span><span class="ident" id="2704058">m</span><span class="op" id="2704059">[</span><span class="ident" id="2704060">t</span><span class="op" id="2704061">]</span>&nbsp;<span class="op" id="2704063">=</span>&nbsp;<span class="ident" id="2704065">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2704068">ptrMap</span><span class="op" id="2704074">.</span><span class="ident" id="2704075">Unlock</span><span class="op" id="2704081">(</span><span class="op" id="2704082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2704085">return</span>&nbsp;<span class="op" id="2704092">&amp;</span><span class="ident" id="2704093">p</span><span class="op" id="2704094">.</span><span class="ident" id="2704095">rtype</span><br>
<span class="lineno">1075</span><span class="op" id="2704101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2704104">//&nbsp;fnv1&nbsp;incorporates&nbsp;the&nbsp;list&nbsp;of&nbsp;bytes&nbsp;into&nbsp;the&nbsp;hash&nbsp;x&nbsp;using&nbsp;the&nbsp;FNV-1&nbsp;hash&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="2704190">func</span>&nbsp;<span class="ident" id="2704195">fnv1</span><span class="op" id="2704199">(</span><span class="ident" id="2704200">x</span>&nbsp;<span class="builtintype" id="2704202">uint32</span><span class="op" id="2704208">,</span>&nbsp;<span class="ident" id="2704210">list</span>&nbsp;<span class="op" id="2704215">...</span><span class="builtintype" id="2704218">byte</span><span class="op" id="2704222">)</span>&nbsp;<span class="builtintype" id="2704224">uint32</span>&nbsp;<span class="op" id="2704231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2704234">for</span>&nbsp;<span class="ident" id="2704238">_</span><span class="op" id="2704239">,</span>&nbsp;<span class="ident" id="2704241">b</span>&nbsp;<span class="op" id="2704243">:=</span>&nbsp;<span class="keyword" id="2704246">range</span>&nbsp;<span class="ident" id="2704252">list</span>&nbsp;<span class="op" id="2704257">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2704261">x</span>&nbsp;<span class="op" id="2704263">=</span>&nbsp;<span class="ident" id="2704265">x</span><span class="op" id="2704266">*</span><span class="num" id="2704267">16777619</span>&nbsp;<span class="op" id="2704276">^</span>&nbsp;<span class="builtintype" id="2704278">uint32</span><span class="op" id="2704284">(</span><span class="ident" id="2704285">b</span><span class="op" id="2704286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2704289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2704292">return</span>&nbsp;<span class="ident" id="2704299">x</span><br>
<span class="lineno"></span><span class="op" id="2704301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1085</span><span class="keyword" id="2704304">func</span>&nbsp;<span class="op" id="2704309">(</span><span class="ident" id="2704310">t</span>&nbsp;<span class="op" id="2704312">*</span><span class="ident" id="2704313">rtype</span><span class="op" id="2704318">)</span>&nbsp;<span class="ident" id="2704320">Implements</span><span class="op" id="2704330">(</span><span class="ident" id="2704331">u</span>&nbsp;<span class="ident" id="2704333">Type</span><span class="op" id="2704337">)</span>&nbsp;<span class="builtintype" id="2704339">bool</span>&nbsp;<span class="op" id="2704344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2704347">if</span>&nbsp;<span class="ident" id="2704350">u</span>&nbsp;<span class="op" id="2704352">==</span>&nbsp;<span class="builtintype" id="2704355">nil</span>&nbsp;<span class="op" id="2704359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2704363">panic</span><span class="op" id="2704368">(</span><span class="string" id="2704369">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2704414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2704417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2704420">if</span>&nbsp;<span class="ident" id="2704423">u</span><span class="op" id="2704424">.</span><span class="ident" id="2704425">Kind</span><span class="op" id="2704429">(</span><span class="op" id="2704430">)</span>&nbsp;<span class="op" id="2704432">!=</span>&nbsp;<span class="ident" id="2704435">Interface</span>&nbsp;<span class="op" id="2704445">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2704449">panic</span><span class="op" id="2704454">(</span><span class="string" id="2704455">&#34;reflect:&nbsp;non-interface&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2704510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2704513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2704516">return</span>&nbsp;<span class="ident" id="2704523">implements</span><span class="op" id="2704533">(</span><span class="ident" id="2704534">u</span><span class="op" id="2704535">.</span><span class="op" id="2704536">(</span><span class="op" id="2704537">*</span><span class="ident" id="2704538">rtype</span><span class="op" id="2704543">)</span><span class="op" id="2704544">,</span>&nbsp;<span class="ident" id="2704546">t</span><span class="op" id="2704547">)</span><br>
<span class="lineno"></span><span class="op" id="2704549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span><span class="keyword" id="2704552">func</span>&nbsp;<span class="op" id="2704557">(</span><span class="ident" id="2704558">t</span>&nbsp;<span class="op" id="2704560">*</span><span class="ident" id="2704561">rtype</span><span class="op" id="2704566">)</span>&nbsp;<span class="ident" id="2704568">AssignableTo</span><span class="op" id="2704580">(</span><span class="ident" id="2704581">u</span>&nbsp;<span class="ident" id="2704583">Type</span><span class="op" id="2704587">)</span>&nbsp;<span class="builtintype" id="2704589">bool</span>&nbsp;<span class="op" id="2704594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2704597">if</span>&nbsp;<span class="ident" id="2704600">u</span>&nbsp;<span class="op" id="2704602">==</span>&nbsp;<span class="builtintype" id="2704605">nil</span>&nbsp;<span class="op" id="2704609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2704613">panic</span><span class="op" id="2704618">(</span><span class="string" id="2704619">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.AssignableTo&#34;</span><span class="op" id="2704666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2704669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2704672">uu</span>&nbsp;<span class="op" id="2704675">:=</span>&nbsp;<span class="ident" id="2704678">u</span><span class="op" id="2704679">.</span><span class="op" id="2704680">(</span><span class="op" id="2704681">*</span><span class="ident" id="2704682">rtype</span><span class="op" id="2704687">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2704690">return</span>&nbsp;<span class="ident" id="2704697">directlyAssignable</span><span class="op" id="2704715">(</span><span class="ident" id="2704716">uu</span><span class="op" id="2704718">,</span>&nbsp;<span class="ident" id="2704720">t</span><span class="op" id="2704721">)</span>&nbsp;<span class="op" id="2704723">||</span>&nbsp;<span class="ident" id="2704726">implements</span><span class="op" id="2704736">(</span><span class="ident" id="2704737">uu</span><span class="op" id="2704739">,</span>&nbsp;<span class="ident" id="2704741">t</span><span class="op" id="2704742">)</span><br>
<span class="lineno"></span><span class="op" id="2704744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2704747">func</span>&nbsp;<span class="op" id="2704752">(</span><span class="ident" id="2704753">t</span>&nbsp;<span class="op" id="2704755">*</span><span class="ident" id="2704756">rtype</span><span class="op" id="2704761">)</span>&nbsp;<span class="ident" id="2704763">ConvertibleTo</span><span class="op" id="2704776">(</span><span class="ident" id="2704777">u</span>&nbsp;<span class="ident" id="2704779">Type</span><span class="op" id="2704783">)</span>&nbsp;<span class="builtintype" id="2704785">bool</span>&nbsp;<span class="op" id="2704790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2704793">if</span>&nbsp;<span class="ident" id="2704796">u</span>&nbsp;<span class="op" id="2704798">==</span>&nbsp;<span class="builtintype" id="2704801">nil</span>&nbsp;<span class="op" id="2704805">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2704809">panic</span><span class="op" id="2704814">(</span><span class="string" id="2704815">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.ConvertibleTo&#34;</span><span class="op" id="2704863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2704866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2704869">uu</span>&nbsp;<span class="op" id="2704872">:=</span>&nbsp;<span class="ident" id="2704875">u</span><span class="op" id="2704876">.</span><span class="op" id="2704877">(</span><span class="op" id="2704878">*</span><span class="ident" id="2704879">rtype</span><span class="op" id="2704884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2704887">return</span>&nbsp;<span class="ident" id="2704894">convertOp</span><span class="op" id="2704903">(</span><span class="ident" id="2704904">uu</span><span class="op" id="2704906">,</span>&nbsp;<span class="ident" id="2704908">t</span><span class="op" id="2704909">)</span>&nbsp;<span class="op" id="2704911">!=</span>&nbsp;<span class="builtintype" id="2704914">nil</span><br>
<span class="lineno"></span><span class="op" id="2704918">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span><span class="keyword" id="2704921">func</span>&nbsp;<span class="op" id="2704926">(</span><span class="ident" id="2704927">t</span>&nbsp;<span class="op" id="2704929">*</span><span class="ident" id="2704930">rtype</span><span class="op" id="2704935">)</span>&nbsp;<span class="ident" id="2704937">Comparable</span><span class="op" id="2704947">(</span><span class="op" id="2704948">)</span>&nbsp;<span class="builtintype" id="2704950">bool</span>&nbsp;<span class="op" id="2704955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2704958">return</span>&nbsp;<span class="ident" id="2704965">t</span><span class="op" id="2704966">.</span><span class="ident" id="2704967">alg</span>&nbsp;<span class="op" id="2704971">!=</span>&nbsp;<span class="builtintype" id="2704974">nil</span>&nbsp;<span class="op" id="2704978">&amp;&amp;</span>&nbsp;<span class="ident" id="2704981">t</span><span class="op" id="2704982">.</span><span class="ident" id="2704983">alg</span><span class="op" id="2704986">.</span><span class="ident" id="2704987">equal</span>&nbsp;<span class="op" id="2704993">!=</span>&nbsp;<span class="builtintype" id="2704996">nil</span><br>
<span class="lineno"></span><span class="op" id="2705000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2705003">//&nbsp;implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;V&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="keyword" id="2705077">func</span>&nbsp;<span class="ident" id="2705082">implements</span><span class="op" id="2705092">(</span><span class="ident" id="2705093">T</span><span class="op" id="2705094">,</span>&nbsp;<span class="ident" id="2705096">V</span>&nbsp;<span class="op" id="2705098">*</span><span class="ident" id="2705099">rtype</span><span class="op" id="2705104">)</span>&nbsp;<span class="builtintype" id="2705106">bool</span>&nbsp;<span class="op" id="2705111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2705114">if</span>&nbsp;<span class="ident" id="2705117">T</span><span class="op" id="2705118">.</span><span class="ident" id="2705119">Kind</span><span class="op" id="2705123">(</span><span class="op" id="2705124">)</span>&nbsp;<span class="op" id="2705126">!=</span>&nbsp;<span class="ident" id="2705129">Interface</span>&nbsp;<span class="op" id="2705139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2705143">return</span>&nbsp;<span class="builtintype" id="2705150">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2705157">}</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2705160">t</span>&nbsp;<span class="op" id="2705162">:=</span>&nbsp;<span class="op" id="2705165">(</span><span class="op" id="2705166">*</span><span class="ident" id="2705167">interfaceType</span><span class="op" id="2705180">)</span><span class="op" id="2705181">(</span><span class="ident" id="2705182">unsafe</span><span class="op" id="2705188">.</span><span class="ident" id="2705189">Pointer</span><span class="op" id="2705196">(</span><span class="ident" id="2705197">T</span><span class="op" id="2705198">)</span><span class="op" id="2705199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2705202">if</span>&nbsp;<span class="builtinfunc" id="2705205">len</span><span class="op" id="2705208">(</span><span class="ident" id="2705209">t</span><span class="op" id="2705210">.</span><span class="ident" id="2705211">methods</span><span class="op" id="2705218">)</span>&nbsp;<span class="op" id="2705220">==</span>&nbsp;<span class="num" id="2705223">0</span>&nbsp;<span class="op" id="2705225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2705229">return</span>&nbsp;<span class="builtintype" id="2705236">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2705242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2705246">//&nbsp;The&nbsp;same&nbsp;algorithm&nbsp;applies&nbsp;in&nbsp;both&nbsp;cases,&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2705300">//&nbsp;method&nbsp;tables&nbsp;for&nbsp;an&nbsp;interface&nbsp;type&nbsp;and&nbsp;a&nbsp;concrete&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2705360">//&nbsp;are&nbsp;different,&nbsp;so&nbsp;the&nbsp;code&nbsp;is&nbsp;duplicated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2705406">//&nbsp;In&nbsp;both&nbsp;cases&nbsp;the&nbsp;algorithm&nbsp;is&nbsp;a&nbsp;linear&nbsp;scan&nbsp;over&nbsp;the&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2705468">//&nbsp;lists&nbsp;-&nbsp;T&#39;s&nbsp;methods&nbsp;and&nbsp;V&#39;s&nbsp;methods&nbsp;-&nbsp;simultaneously.</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2705526">//&nbsp;Since&nbsp;method&nbsp;tables&nbsp;are&nbsp;stored&nbsp;in&nbsp;a&nbsp;unique&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2705586">//&nbsp;(alphabetical,&nbsp;with&nbsp;no&nbsp;duplicate&nbsp;method&nbsp;names),&nbsp;the&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2705647">//&nbsp;through&nbsp;V&#39;s&nbsp;methods&nbsp;must&nbsp;hit&nbsp;a&nbsp;match&nbsp;for&nbsp;each&nbsp;of&nbsp;T&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2705704">//&nbsp;methods&nbsp;along&nbsp;the&nbsp;way,&nbsp;or&nbsp;else&nbsp;V&nbsp;does&nbsp;not&nbsp;implement&nbsp;T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2705763">//&nbsp;This&nbsp;lets&nbsp;us&nbsp;run&nbsp;the&nbsp;scan&nbsp;in&nbsp;overall&nbsp;linear&nbsp;time&nbsp;instead&nbsp;of</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2705827">//&nbsp;the&nbsp;quadratic&nbsp;time&nbsp;&nbsp;a&nbsp;naive&nbsp;search&nbsp;would&nbsp;require.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2705881">//&nbsp;See&nbsp;also&nbsp;../runtime/iface.c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2705914">if</span>&nbsp;<span class="ident" id="2705917">V</span><span class="op" id="2705918">.</span><span class="ident" id="2705919">Kind</span><span class="op" id="2705923">(</span><span class="op" id="2705924">)</span>&nbsp;<span class="op" id="2705926">==</span>&nbsp;<span class="ident" id="2705929">Interface</span>&nbsp;<span class="op" id="2705939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2705943">v</span>&nbsp;<span class="op" id="2705945">:=</span>&nbsp;<span class="op" id="2705948">(</span><span class="op" id="2705949">*</span><span class="ident" id="2705950">interfaceType</span><span class="op" id="2705963">)</span><span class="op" id="2705964">(</span><span class="ident" id="2705965">unsafe</span><span class="op" id="2705971">.</span><span class="ident" id="2705972">Pointer</span><span class="op" id="2705979">(</span><span class="ident" id="2705980">V</span><span class="op" id="2705981">)</span><span class="op" id="2705982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2705986">i</span>&nbsp;<span class="op" id="2705988">:=</span>&nbsp;<span class="num" id="2705991">0</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2705995">for</span>&nbsp;<span class="ident" id="2705999">j</span>&nbsp;<span class="op" id="2706001">:=</span>&nbsp;<span class="num" id="2706004">0</span><span class="op" id="2706005">;</span>&nbsp;<span class="ident" id="2706007">j</span>&nbsp;<span class="op" id="2706009">&lt;</span>&nbsp;<span class="builtinfunc" id="2706011">len</span><span class="op" id="2706014">(</span><span class="ident" id="2706015">v</span><span class="op" id="2706016">.</span><span class="ident" id="2706017">methods</span><span class="op" id="2706024">)</span><span class="op" id="2706025">;</span>&nbsp;<span class="ident" id="2706027">j</span><span class="op" id="2706028">++</span>&nbsp;<span class="op" id="2706031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2706036">tm</span>&nbsp;<span class="op" id="2706039">:=</span>&nbsp;<span class="op" id="2706042">&amp;</span><span class="ident" id="2706043">t</span><span class="op" id="2706044">.</span><span class="ident" id="2706045">methods</span><span class="op" id="2706052">[</span><span class="ident" id="2706053">i</span><span class="op" id="2706054">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2706059">vm</span>&nbsp;<span class="op" id="2706062">:=</span>&nbsp;<span class="op" id="2706065">&amp;</span><span class="ident" id="2706066">v</span><span class="op" id="2706067">.</span><span class="ident" id="2706068">methods</span><span class="op" id="2706075">[</span><span class="ident" id="2706076">j</span><span class="op" id="2706077">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2706082">if</span>&nbsp;<span class="ident" id="2706085">vm</span><span class="op" id="2706087">.</span><span class="ident" id="2706088">name</span>&nbsp;<span class="op" id="2706093">==</span>&nbsp;<span class="ident" id="2706096">tm</span><span class="op" id="2706098">.</span><span class="ident" id="2706099">name</span>&nbsp;<span class="op" id="2706104">&amp;&amp;</span>&nbsp;<span class="ident" id="2706107">vm</span><span class="op" id="2706109">.</span><span class="ident" id="2706110">pkgPath</span>&nbsp;<span class="op" id="2706118">==</span>&nbsp;<span class="ident" id="2706121">tm</span><span class="op" id="2706123">.</span><span class="ident" id="2706124">pkgPath</span>&nbsp;<span class="op" id="2706132">&amp;&amp;</span>&nbsp;<span class="ident" id="2706135">vm</span><span class="op" id="2706137">.</span><span class="ident" id="2706138">typ</span>&nbsp;<span class="op" id="2706142">==</span>&nbsp;<span class="ident" id="2706145">tm</span><span class="op" id="2706147">.</span><span class="ident" id="2706148">typ</span>&nbsp;<span class="op" id="2706152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2706158">if</span>&nbsp;<span class="ident" id="2706161">i</span><span class="op" id="2706162">++</span><span class="op" id="2706164">;</span>&nbsp;<span class="ident" id="2706166">i</span>&nbsp;<span class="op" id="2706168">&gt;=</span>&nbsp;<span class="builtinfunc" id="2706171">len</span><span class="op" id="2706174">(</span><span class="ident" id="2706175">t</span><span class="op" id="2706176">.</span><span class="ident" id="2706177">methods</span><span class="op" id="2706184">)</span>&nbsp;<span class="op" id="2706186">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2706193">return</span>&nbsp;<span class="builtintype" id="2706200">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2706209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2706214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2706218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2706222">return</span>&nbsp;<span class="builtintype" id="2706229">false</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2706236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2706240">v</span>&nbsp;<span class="op" id="2706242">:=</span>&nbsp;<span class="ident" id="2706245">V</span><span class="op" id="2706246">.</span><span class="ident" id="2706247">uncommon</span><span class="op" id="2706255">(</span><span class="op" id="2706256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2706259">if</span>&nbsp;<span class="ident" id="2706262">v</span>&nbsp;<span class="op" id="2706264">==</span>&nbsp;<span class="builtintype" id="2706267">nil</span>&nbsp;<span class="op" id="2706271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2706275">return</span>&nbsp;<span class="builtintype" id="2706282">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2706289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2706292">i</span>&nbsp;<span class="op" id="2706294">:=</span>&nbsp;<span class="num" id="2706297">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2706300">for</span>&nbsp;<span class="ident" id="2706304">j</span>&nbsp;<span class="op" id="2706306">:=</span>&nbsp;<span class="num" id="2706309">0</span><span class="op" id="2706310">;</span>&nbsp;<span class="ident" id="2706312">j</span>&nbsp;<span class="op" id="2706314">&lt;</span>&nbsp;<span class="builtinfunc" id="2706316">len</span><span class="op" id="2706319">(</span><span class="ident" id="2706320">v</span><span class="op" id="2706321">.</span><span class="ident" id="2706322">methods</span><span class="op" id="2706329">)</span><span class="op" id="2706330">;</span>&nbsp;<span class="ident" id="2706332">j</span><span class="op" id="2706333">++</span>&nbsp;<span class="op" id="2706336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2706340">tm</span>&nbsp;<span class="op" id="2706343">:=</span>&nbsp;<span class="op" id="2706346">&amp;</span><span class="ident" id="2706347">t</span><span class="op" id="2706348">.</span><span class="ident" id="2706349">methods</span><span class="op" id="2706356">[</span><span class="ident" id="2706357">i</span><span class="op" id="2706358">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2706362">vm</span>&nbsp;<span class="op" id="2706365">:=</span>&nbsp;<span class="op" id="2706368">&amp;</span><span class="ident" id="2706369">v</span><span class="op" id="2706370">.</span><span class="ident" id="2706371">methods</span><span class="op" id="2706378">[</span><span class="ident" id="2706379">j</span><span class="op" id="2706380">]</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2706384">if</span>&nbsp;<span class="ident" id="2706387">vm</span><span class="op" id="2706389">.</span><span class="ident" id="2706390">name</span>&nbsp;<span class="op" id="2706395">==</span>&nbsp;<span class="ident" id="2706398">tm</span><span class="op" id="2706400">.</span><span class="ident" id="2706401">name</span>&nbsp;<span class="op" id="2706406">&amp;&amp;</span>&nbsp;<span class="ident" id="2706409">vm</span><span class="op" id="2706411">.</span><span class="ident" id="2706412">pkgPath</span>&nbsp;<span class="op" id="2706420">==</span>&nbsp;<span class="ident" id="2706423">tm</span><span class="op" id="2706425">.</span><span class="ident" id="2706426">pkgPath</span>&nbsp;<span class="op" id="2706434">&amp;&amp;</span>&nbsp;<span class="ident" id="2706437">vm</span><span class="op" id="2706439">.</span><span class="ident" id="2706440">mtyp</span>&nbsp;<span class="op" id="2706445">==</span>&nbsp;<span class="ident" id="2706448">tm</span><span class="op" id="2706450">.</span><span class="ident" id="2706451">typ</span>&nbsp;<span class="op" id="2706455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2706460">if</span>&nbsp;<span class="ident" id="2706463">i</span><span class="op" id="2706464">++</span><span class="op" id="2706466">;</span>&nbsp;<span class="ident" id="2706468">i</span>&nbsp;<span class="op" id="2706470">&gt;=</span>&nbsp;<span class="builtinfunc" id="2706473">len</span><span class="op" id="2706476">(</span><span class="ident" id="2706477">t</span><span class="op" id="2706478">.</span><span class="ident" id="2706479">methods</span><span class="op" id="2706486">)</span>&nbsp;<span class="op" id="2706488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2706494">return</span>&nbsp;<span class="builtintype" id="2706501">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2706509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2706513">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2706516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2706519">return</span>&nbsp;<span class="builtintype" id="2706526">false</span><br>
<span class="lineno"></span><span class="op" id="2706532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2706535">//&nbsp;directlyAssignable&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;x&nbsp;of&nbsp;type&nbsp;V&nbsp;can&nbsp;be&nbsp;directly</span><br>
<span class="lineno">1170</span><span class="comment" id="2706609">//&nbsp;assigned&nbsp;(using&nbsp;memmove)&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="comment" id="2706659">//&nbsp;http://golang.org/doc/go_spec.html#Assignability</span><br>
<span class="lineno"></span><span class="comment" id="2706711">//&nbsp;Ignoring&nbsp;the&nbsp;interface&nbsp;rules&nbsp;(implemented&nbsp;elsewhere)</span><br>
<span class="lineno"></span><span class="comment" id="2706767">//&nbsp;and&nbsp;the&nbsp;ideal&nbsp;constant&nbsp;rules&nbsp;(no&nbsp;ideal&nbsp;constants&nbsp;at&nbsp;run&nbsp;time).</span><br>
<span class="lineno"></span><span class="keyword" id="2706833">func</span>&nbsp;<span class="ident" id="2706838">directlyAssignable</span><span class="op" id="2706856">(</span><span class="ident" id="2706857">T</span><span class="op" id="2706858">,</span>&nbsp;<span class="ident" id="2706860">V</span>&nbsp;<span class="op" id="2706862">*</span><span class="ident" id="2706863">rtype</span><span class="op" id="2706868">)</span>&nbsp;<span class="builtintype" id="2706870">bool</span>&nbsp;<span class="op" id="2706875">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2706878">//&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;is&nbsp;identical&nbsp;to&nbsp;T?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2706912">if</span>&nbsp;<span class="ident" id="2706915">T</span>&nbsp;<span class="op" id="2706917">==</span>&nbsp;<span class="ident" id="2706920">V</span>&nbsp;<span class="op" id="2706922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2706926">return</span>&nbsp;<span class="builtintype" id="2706933">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2706939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2706943">//&nbsp;Otherwise&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;be&nbsp;unnamed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2706997">//&nbsp;and&nbsp;they&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707035">if</span>&nbsp;<span class="ident" id="2707038">T</span><span class="op" id="2707039">.</span><span class="ident" id="2707040">Name</span><span class="op" id="2707044">(</span><span class="op" id="2707045">)</span>&nbsp;<span class="op" id="2707047">!=</span>&nbsp;<span class="string" id="2707050">&#34;&#34;</span>&nbsp;<span class="op" id="2707053">&amp;&amp;</span>&nbsp;<span class="ident" id="2707056">V</span><span class="op" id="2707057">.</span><span class="ident" id="2707058">Name</span><span class="op" id="2707062">(</span><span class="op" id="2707063">)</span>&nbsp;<span class="op" id="2707065">!=</span>&nbsp;<span class="string" id="2707068">&#34;&#34;</span>&nbsp;<span class="op" id="2707071">||</span>&nbsp;<span class="ident" id="2707074">T</span><span class="op" id="2707075">.</span><span class="ident" id="2707076">Kind</span><span class="op" id="2707080">(</span><span class="op" id="2707081">)</span>&nbsp;<span class="op" id="2707083">!=</span>&nbsp;<span class="ident" id="2707086">V</span><span class="op" id="2707087">.</span><span class="ident" id="2707088">Kind</span><span class="op" id="2707092">(</span><span class="op" id="2707093">)</span>&nbsp;<span class="op" id="2707095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707099">return</span>&nbsp;<span class="builtintype" id="2707106">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2707113">}</span><br>
<span class="lineno">1185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2707117">//&nbsp;x&#39;s&nbsp;type&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;&nbsp;have&nbsp;identical&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707177">return</span>&nbsp;<span class="ident" id="2707184">haveIdenticalUnderlyingType</span><span class="op" id="2707211">(</span><span class="ident" id="2707212">T</span><span class="op" id="2707213">,</span>&nbsp;<span class="ident" id="2707215">V</span><span class="op" id="2707216">)</span><br>
<span class="lineno"></span><span class="op" id="2707218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1190</span><span class="keyword" id="2707221">func</span>&nbsp;<span class="ident" id="2707226">haveIdenticalUnderlyingType</span><span class="op" id="2707253">(</span><span class="ident" id="2707254">T</span><span class="op" id="2707255">,</span>&nbsp;<span class="ident" id="2707257">V</span>&nbsp;<span class="op" id="2707259">*</span><span class="ident" id="2707260">rtype</span><span class="op" id="2707265">)</span>&nbsp;<span class="builtintype" id="2707267">bool</span>&nbsp;<span class="op" id="2707272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707275">if</span>&nbsp;<span class="ident" id="2707278">T</span>&nbsp;<span class="op" id="2707280">==</span>&nbsp;<span class="ident" id="2707283">V</span>&nbsp;<span class="op" id="2707285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707289">return</span>&nbsp;<span class="builtintype" id="2707296">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2707302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2707306">kind</span>&nbsp;<span class="op" id="2707311">:=</span>&nbsp;<span class="ident" id="2707314">T</span><span class="op" id="2707315">.</span><span class="ident" id="2707316">Kind</span><span class="op" id="2707320">(</span><span class="op" id="2707321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707324">if</span>&nbsp;<span class="ident" id="2707327">kind</span>&nbsp;<span class="op" id="2707332">!=</span>&nbsp;<span class="ident" id="2707335">V</span><span class="op" id="2707336">.</span><span class="ident" id="2707337">Kind</span><span class="op" id="2707341">(</span><span class="op" id="2707342">)</span>&nbsp;<span class="op" id="2707344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707348">return</span>&nbsp;<span class="builtintype" id="2707355">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2707362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2707366">//&nbsp;Non-composite&nbsp;types&nbsp;of&nbsp;equal&nbsp;kind&nbsp;have&nbsp;same&nbsp;underlying&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2707430">//&nbsp;(the&nbsp;predefined&nbsp;instance&nbsp;of&nbsp;the&nbsp;type).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707473">if</span>&nbsp;<span class="ident" id="2707476">Bool</span>&nbsp;<span class="op" id="2707481">&lt;=</span>&nbsp;<span class="ident" id="2707484">kind</span>&nbsp;<span class="op" id="2707489">&amp;&amp;</span>&nbsp;<span class="ident" id="2707492">kind</span>&nbsp;<span class="op" id="2707497">&lt;=</span>&nbsp;<span class="ident" id="2707500">Complex128</span>&nbsp;<span class="op" id="2707511">||</span>&nbsp;<span class="ident" id="2707514">kind</span>&nbsp;<span class="op" id="2707519">==</span>&nbsp;<span class="ident" id="2707522">String</span>&nbsp;<span class="op" id="2707529">||</span>&nbsp;<span class="ident" id="2707532">kind</span>&nbsp;<span class="op" id="2707537">==</span>&nbsp;<span class="ident" id="2707540">UnsafePointer</span>&nbsp;<span class="op" id="2707554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707558">return</span>&nbsp;<span class="builtintype" id="2707565">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2707571">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2707575">//&nbsp;Composite&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707596">switch</span>&nbsp;<span class="ident" id="2707603">kind</span>&nbsp;<span class="op" id="2707608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707611">case</span>&nbsp;<span class="ident" id="2707616">Array</span><span class="op" id="2707621">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707625">return</span>&nbsp;<span class="ident" id="2707632">T</span><span class="op" id="2707633">.</span><span class="ident" id="2707634">Elem</span><span class="op" id="2707638">(</span><span class="op" id="2707639">)</span>&nbsp;<span class="op" id="2707641">==</span>&nbsp;<span class="ident" id="2707644">V</span><span class="op" id="2707645">.</span><span class="ident" id="2707646">Elem</span><span class="op" id="2707650">(</span><span class="op" id="2707651">)</span>&nbsp;<span class="op" id="2707653">&amp;&amp;</span>&nbsp;<span class="ident" id="2707656">T</span><span class="op" id="2707657">.</span><span class="ident" id="2707658">Len</span><span class="op" id="2707661">(</span><span class="op" id="2707662">)</span>&nbsp;<span class="op" id="2707664">==</span>&nbsp;<span class="ident" id="2707667">V</span><span class="op" id="2707668">.</span><span class="ident" id="2707669">Len</span><span class="op" id="2707672">(</span><span class="op" id="2707673">)</span><br>
<span class="lineno">1210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707677">case</span>&nbsp;<span class="ident" id="2707682">Chan</span><span class="op" id="2707686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2707690">//&nbsp;Special&nbsp;case:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2707709">//&nbsp;x&nbsp;is&nbsp;a&nbsp;bidirectional&nbsp;channel&nbsp;value,&nbsp;T&nbsp;is&nbsp;a&nbsp;channel&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2707771">//&nbsp;and&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;and&nbsp;T&nbsp;have&nbsp;identical&nbsp;element&nbsp;types.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707827">if</span>&nbsp;<span class="ident" id="2707830">V</span><span class="op" id="2707831">.</span><span class="ident" id="2707832">ChanDir</span><span class="op" id="2707839">(</span><span class="op" id="2707840">)</span>&nbsp;<span class="op" id="2707842">==</span>&nbsp;<span class="ident" id="2707845">BothDir</span>&nbsp;<span class="op" id="2707853">&amp;&amp;</span>&nbsp;<span class="ident" id="2707856">T</span><span class="op" id="2707857">.</span><span class="ident" id="2707858">Elem</span><span class="op" id="2707862">(</span><span class="op" id="2707863">)</span>&nbsp;<span class="op" id="2707865">==</span>&nbsp;<span class="ident" id="2707868">V</span><span class="op" id="2707869">.</span><span class="ident" id="2707870">Elem</span><span class="op" id="2707874">(</span><span class="op" id="2707875">)</span>&nbsp;<span class="op" id="2707877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707882">return</span>&nbsp;<span class="builtintype" id="2707889">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2707896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2707901">//&nbsp;Otherwise&nbsp;continue&nbsp;test&nbsp;for&nbsp;identical&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2707961">return</span>&nbsp;<span class="ident" id="2707968">V</span><span class="op" id="2707969">.</span><span class="ident" id="2707970">ChanDir</span><span class="op" id="2707977">(</span><span class="op" id="2707978">)</span>&nbsp;<span class="op" id="2707980">==</span>&nbsp;<span class="ident" id="2707983">T</span><span class="op" id="2707984">.</span><span class="ident" id="2707985">ChanDir</span><span class="op" id="2707992">(</span><span class="op" id="2707993">)</span>&nbsp;<span class="op" id="2707995">&amp;&amp;</span>&nbsp;<span class="ident" id="2707998">T</span><span class="op" id="2707999">.</span><span class="ident" id="2708000">Elem</span><span class="op" id="2708004">(</span><span class="op" id="2708005">)</span>&nbsp;<span class="op" id="2708007">==</span>&nbsp;<span class="ident" id="2708010">V</span><span class="op" id="2708011">.</span><span class="ident" id="2708012">Elem</span><span class="op" id="2708016">(</span><span class="op" id="2708017">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708021">case</span>&nbsp;<span class="ident" id="2708026">Func</span><span class="op" id="2708030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2708034">t</span>&nbsp;<span class="op" id="2708036">:=</span>&nbsp;<span class="op" id="2708039">(</span><span class="op" id="2708040">*</span><span class="ident" id="2708041">funcType</span><span class="op" id="2708049">)</span><span class="op" id="2708050">(</span><span class="ident" id="2708051">unsafe</span><span class="op" id="2708057">.</span><span class="ident" id="2708058">Pointer</span><span class="op" id="2708065">(</span><span class="ident" id="2708066">T</span><span class="op" id="2708067">)</span><span class="op" id="2708068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2708072">v</span>&nbsp;<span class="op" id="2708074">:=</span>&nbsp;<span class="op" id="2708077">(</span><span class="op" id="2708078">*</span><span class="ident" id="2708079">funcType</span><span class="op" id="2708087">)</span><span class="op" id="2708088">(</span><span class="ident" id="2708089">unsafe</span><span class="op" id="2708095">.</span><span class="ident" id="2708096">Pointer</span><span class="op" id="2708103">(</span><span class="ident" id="2708104">V</span><span class="op" id="2708105">)</span><span class="op" id="2708106">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708110">if</span>&nbsp;<span class="ident" id="2708113">t</span><span class="op" id="2708114">.</span><span class="ident" id="2708115">dotdotdot</span>&nbsp;<span class="op" id="2708125">!=</span>&nbsp;<span class="ident" id="2708128">v</span><span class="op" id="2708129">.</span><span class="ident" id="2708130">dotdotdot</span>&nbsp;<span class="op" id="2708140">||</span>&nbsp;<span class="builtinfunc" id="2708143">len</span><span class="op" id="2708146">(</span><span class="ident" id="2708147">t</span><span class="op" id="2708148">.</span><span class="ident" id="2708149">in</span><span class="op" id="2708151">)</span>&nbsp;<span class="op" id="2708153">!=</span>&nbsp;<span class="builtinfunc" id="2708156">len</span><span class="op" id="2708159">(</span><span class="ident" id="2708160">v</span><span class="op" id="2708161">.</span><span class="ident" id="2708162">in</span><span class="op" id="2708164">)</span>&nbsp;<span class="op" id="2708166">||</span>&nbsp;<span class="builtinfunc" id="2708169">len</span><span class="op" id="2708172">(</span><span class="ident" id="2708173">t</span><span class="op" id="2708174">.</span><span class="ident" id="2708175">out</span><span class="op" id="2708178">)</span>&nbsp;<span class="op" id="2708180">!=</span>&nbsp;<span class="builtinfunc" id="2708183">len</span><span class="op" id="2708186">(</span><span class="ident" id="2708187">v</span><span class="op" id="2708188">.</span><span class="ident" id="2708189">out</span><span class="op" id="2708192">)</span>&nbsp;<span class="op" id="2708194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708199">return</span>&nbsp;<span class="builtintype" id="2708206">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2708214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708218">for</span>&nbsp;<span class="ident" id="2708222">i</span><span class="op" id="2708223">,</span>&nbsp;<span class="ident" id="2708225">typ</span>&nbsp;<span class="op" id="2708229">:=</span>&nbsp;<span class="keyword" id="2708232">range</span>&nbsp;<span class="ident" id="2708238">t</span><span class="op" id="2708239">.</span><span class="ident" id="2708240">in</span>&nbsp;<span class="op" id="2708243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708248">if</span>&nbsp;<span class="ident" id="2708251">typ</span>&nbsp;<span class="op" id="2708255">!=</span>&nbsp;<span class="ident" id="2708258">v</span><span class="op" id="2708259">.</span><span class="ident" id="2708260">in</span><span class="op" id="2708262">[</span><span class="ident" id="2708263">i</span><span class="op" id="2708264">]</span>&nbsp;<span class="op" id="2708266">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708272">return</span>&nbsp;<span class="builtintype" id="2708279">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2708288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2708292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708296">for</span>&nbsp;<span class="ident" id="2708300">i</span><span class="op" id="2708301">,</span>&nbsp;<span class="ident" id="2708303">typ</span>&nbsp;<span class="op" id="2708307">:=</span>&nbsp;<span class="keyword" id="2708310">range</span>&nbsp;<span class="ident" id="2708316">t</span><span class="op" id="2708317">.</span><span class="ident" id="2708318">out</span>&nbsp;<span class="op" id="2708322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708327">if</span>&nbsp;<span class="ident" id="2708330">typ</span>&nbsp;<span class="op" id="2708334">!=</span>&nbsp;<span class="ident" id="2708337">v</span><span class="op" id="2708338">.</span><span class="ident" id="2708339">out</span><span class="op" id="2708342">[</span><span class="ident" id="2708343">i</span><span class="op" id="2708344">]</span>&nbsp;<span class="op" id="2708346">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708352">return</span>&nbsp;<span class="builtintype" id="2708359">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2708368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2708372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708376">return</span>&nbsp;<span class="builtintype" id="2708383">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708390">case</span>&nbsp;<span class="ident" id="2708395">Interface</span><span class="op" id="2708404">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2708408">t</span>&nbsp;<span class="op" id="2708410">:=</span>&nbsp;<span class="op" id="2708413">(</span><span class="op" id="2708414">*</span><span class="ident" id="2708415">interfaceType</span><span class="op" id="2708428">)</span><span class="op" id="2708429">(</span><span class="ident" id="2708430">unsafe</span><span class="op" id="2708436">.</span><span class="ident" id="2708437">Pointer</span><span class="op" id="2708444">(</span><span class="ident" id="2708445">T</span><span class="op" id="2708446">)</span><span class="op" id="2708447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2708451">v</span>&nbsp;<span class="op" id="2708453">:=</span>&nbsp;<span class="op" id="2708456">(</span><span class="op" id="2708457">*</span><span class="ident" id="2708458">interfaceType</span><span class="op" id="2708471">)</span><span class="op" id="2708472">(</span><span class="ident" id="2708473">unsafe</span><span class="op" id="2708479">.</span><span class="ident" id="2708480">Pointer</span><span class="op" id="2708487">(</span><span class="ident" id="2708488">V</span><span class="op" id="2708489">)</span><span class="op" id="2708490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708494">if</span>&nbsp;<span class="builtinfunc" id="2708497">len</span><span class="op" id="2708500">(</span><span class="ident" id="2708501">t</span><span class="op" id="2708502">.</span><span class="ident" id="2708503">methods</span><span class="op" id="2708510">)</span>&nbsp;<span class="op" id="2708512">==</span>&nbsp;<span class="num" id="2708515">0</span>&nbsp;<span class="op" id="2708517">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2708520">len</span><span class="op" id="2708523">(</span><span class="ident" id="2708524">v</span><span class="op" id="2708525">.</span><span class="ident" id="2708526">methods</span><span class="op" id="2708533">)</span>&nbsp;<span class="op" id="2708535">==</span>&nbsp;<span class="num" id="2708538">0</span>&nbsp;<span class="op" id="2708540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708545">return</span>&nbsp;<span class="builtintype" id="2708552">true</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2708559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2708563">//&nbsp;Might&nbsp;have&nbsp;the&nbsp;same&nbsp;methods&nbsp;but&nbsp;still</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2708606">//&nbsp;need&nbsp;a&nbsp;run&nbsp;time&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708639">return</span>&nbsp;<span class="builtintype" id="2708646">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708654">case</span>&nbsp;<span class="ident" id="2708659">Map</span><span class="op" id="2708662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708666">return</span>&nbsp;<span class="ident" id="2708673">T</span><span class="op" id="2708674">.</span><span class="ident" id="2708675">Key</span><span class="op" id="2708678">(</span><span class="op" id="2708679">)</span>&nbsp;<span class="op" id="2708681">==</span>&nbsp;<span class="ident" id="2708684">V</span><span class="op" id="2708685">.</span><span class="ident" id="2708686">Key</span><span class="op" id="2708689">(</span><span class="op" id="2708690">)</span>&nbsp;<span class="op" id="2708692">&amp;&amp;</span>&nbsp;<span class="ident" id="2708695">T</span><span class="op" id="2708696">.</span><span class="ident" id="2708697">Elem</span><span class="op" id="2708701">(</span><span class="op" id="2708702">)</span>&nbsp;<span class="op" id="2708704">==</span>&nbsp;<span class="ident" id="2708707">V</span><span class="op" id="2708708">.</span><span class="ident" id="2708709">Elem</span><span class="op" id="2708713">(</span><span class="op" id="2708714">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708718">case</span>&nbsp;<span class="ident" id="2708723">Ptr</span><span class="op" id="2708726">,</span>&nbsp;<span class="ident" id="2708728">Slice</span><span class="op" id="2708733">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708737">return</span>&nbsp;<span class="ident" id="2708744">T</span><span class="op" id="2708745">.</span><span class="ident" id="2708746">Elem</span><span class="op" id="2708750">(</span><span class="op" id="2708751">)</span>&nbsp;<span class="op" id="2708753">==</span>&nbsp;<span class="ident" id="2708756">V</span><span class="op" id="2708757">.</span><span class="ident" id="2708758">Elem</span><span class="op" id="2708762">(</span><span class="op" id="2708763">)</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708767">case</span>&nbsp;<span class="ident" id="2708772">Struct</span><span class="op" id="2708778">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2708782">t</span>&nbsp;<span class="op" id="2708784">:=</span>&nbsp;<span class="op" id="2708787">(</span><span class="op" id="2708788">*</span><span class="ident" id="2708789">structType</span><span class="op" id="2708799">)</span><span class="op" id="2708800">(</span><span class="ident" id="2708801">unsafe</span><span class="op" id="2708807">.</span><span class="ident" id="2708808">Pointer</span><span class="op" id="2708815">(</span><span class="ident" id="2708816">T</span><span class="op" id="2708817">)</span><span class="op" id="2708818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2708822">v</span>&nbsp;<span class="op" id="2708824">:=</span>&nbsp;<span class="op" id="2708827">(</span><span class="op" id="2708828">*</span><span class="ident" id="2708829">structType</span><span class="op" id="2708839">)</span><span class="op" id="2708840">(</span><span class="ident" id="2708841">unsafe</span><span class="op" id="2708847">.</span><span class="ident" id="2708848">Pointer</span><span class="op" id="2708855">(</span><span class="ident" id="2708856">V</span><span class="op" id="2708857">)</span><span class="op" id="2708858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708862">if</span>&nbsp;<span class="builtinfunc" id="2708865">len</span><span class="op" id="2708868">(</span><span class="ident" id="2708869">t</span><span class="op" id="2708870">.</span><span class="ident" id="2708871">fields</span><span class="op" id="2708877">)</span>&nbsp;<span class="op" id="2708879">!=</span>&nbsp;<span class="builtinfunc" id="2708882">len</span><span class="op" id="2708885">(</span><span class="ident" id="2708886">v</span><span class="op" id="2708887">.</span><span class="ident" id="2708888">fields</span><span class="op" id="2708894">)</span>&nbsp;<span class="op" id="2708896">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708901">return</span>&nbsp;<span class="builtintype" id="2708908">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2708916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708920">for</span>&nbsp;<span class="ident" id="2708924">i</span>&nbsp;<span class="op" id="2708926">:=</span>&nbsp;<span class="keyword" id="2708929">range</span>&nbsp;<span class="ident" id="2708935">t</span><span class="op" id="2708936">.</span><span class="ident" id="2708937">fields</span>&nbsp;<span class="op" id="2708944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2708949">tf</span>&nbsp;<span class="op" id="2708952">:=</span>&nbsp;<span class="op" id="2708955">&amp;</span><span class="ident" id="2708956">t</span><span class="op" id="2708957">.</span><span class="ident" id="2708958">fields</span><span class="op" id="2708964">[</span><span class="ident" id="2708965">i</span><span class="op" id="2708966">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2708971">vf</span>&nbsp;<span class="op" id="2708974">:=</span>&nbsp;<span class="op" id="2708977">&amp;</span><span class="ident" id="2708978">v</span><span class="op" id="2708979">.</span><span class="ident" id="2708980">fields</span><span class="op" id="2708986">[</span><span class="ident" id="2708987">i</span><span class="op" id="2708988">]</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2708993">if</span>&nbsp;<span class="ident" id="2708996">tf</span><span class="op" id="2708998">.</span><span class="ident" id="2708999">name</span>&nbsp;<span class="op" id="2709004">!=</span>&nbsp;<span class="ident" id="2709007">vf</span><span class="op" id="2709009">.</span><span class="ident" id="2709010">name</span>&nbsp;<span class="op" id="2709015">&amp;&amp;</span>&nbsp;<span class="op" id="2709018">(</span><span class="ident" id="2709019">tf</span><span class="op" id="2709021">.</span><span class="ident" id="2709022">name</span>&nbsp;<span class="op" id="2709027">==</span>&nbsp;<span class="builtintype" id="2709030">nil</span>&nbsp;<span class="op" id="2709034">||</span>&nbsp;<span class="ident" id="2709037">vf</span><span class="op" id="2709039">.</span><span class="ident" id="2709040">name</span>&nbsp;<span class="op" id="2709045">==</span>&nbsp;<span class="builtintype" id="2709048">nil</span>&nbsp;<span class="op" id="2709052">||</span>&nbsp;<span class="op" id="2709055">*</span><span class="ident" id="2709056">tf</span><span class="op" id="2709058">.</span><span class="ident" id="2709059">name</span>&nbsp;<span class="op" id="2709064">!=</span>&nbsp;<span class="op" id="2709067">*</span><span class="ident" id="2709068">vf</span><span class="op" id="2709070">.</span><span class="ident" id="2709071">name</span><span class="op" id="2709075">)</span>&nbsp;<span class="op" id="2709077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2709083">return</span>&nbsp;<span class="builtintype" id="2709090">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2709099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2709104">if</span>&nbsp;<span class="ident" id="2709107">tf</span><span class="op" id="2709109">.</span><span class="ident" id="2709110">pkgPath</span>&nbsp;<span class="op" id="2709118">!=</span>&nbsp;<span class="ident" id="2709121">vf</span><span class="op" id="2709123">.</span><span class="ident" id="2709124">pkgPath</span>&nbsp;<span class="op" id="2709132">&amp;&amp;</span>&nbsp;<span class="op" id="2709135">(</span><span class="ident" id="2709136">tf</span><span class="op" id="2709138">.</span><span class="ident" id="2709139">pkgPath</span>&nbsp;<span class="op" id="2709147">==</span>&nbsp;<span class="builtintype" id="2709150">nil</span>&nbsp;<span class="op" id="2709154">||</span>&nbsp;<span class="ident" id="2709157">vf</span><span class="op" id="2709159">.</span><span class="ident" id="2709160">pkgPath</span>&nbsp;<span class="op" id="2709168">==</span>&nbsp;<span class="builtintype" id="2709171">nil</span>&nbsp;<span class="op" id="2709175">||</span>&nbsp;<span class="op" id="2709178">*</span><span class="ident" id="2709179">tf</span><span class="op" id="2709181">.</span><span class="ident" id="2709182">pkgPath</span>&nbsp;<span class="op" id="2709190">!=</span>&nbsp;<span class="op" id="2709193">*</span><span class="ident" id="2709194">vf</span><span class="op" id="2709196">.</span><span class="ident" id="2709197">pkgPath</span><span class="op" id="2709204">)</span>&nbsp;<span class="op" id="2709206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2709212">return</span>&nbsp;<span class="builtintype" id="2709219">false</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2709228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2709233">if</span>&nbsp;<span class="ident" id="2709236">tf</span><span class="op" id="2709238">.</span><span class="ident" id="2709239">typ</span>&nbsp;<span class="op" id="2709243">!=</span>&nbsp;<span class="ident" id="2709246">vf</span><span class="op" id="2709248">.</span><span class="ident" id="2709249">typ</span>&nbsp;<span class="op" id="2709253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2709259">return</span>&nbsp;<span class="builtintype" id="2709266">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2709275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2709280">if</span>&nbsp;<span class="ident" id="2709283">tf</span><span class="op" id="2709285">.</span><span class="ident" id="2709286">tag</span>&nbsp;<span class="op" id="2709290">!=</span>&nbsp;<span class="ident" id="2709293">vf</span><span class="op" id="2709295">.</span><span class="ident" id="2709296">tag</span>&nbsp;<span class="op" id="2709300">&amp;&amp;</span>&nbsp;<span class="op" id="2709303">(</span><span class="ident" id="2709304">tf</span><span class="op" id="2709306">.</span><span class="ident" id="2709307">tag</span>&nbsp;<span class="op" id="2709311">==</span>&nbsp;<span class="builtintype" id="2709314">nil</span>&nbsp;<span class="op" id="2709318">||</span>&nbsp;<span class="ident" id="2709321">vf</span><span class="op" id="2709323">.</span><span class="ident" id="2709324">tag</span>&nbsp;<span class="op" id="2709328">==</span>&nbsp;<span class="builtintype" id="2709331">nil</span>&nbsp;<span class="op" id="2709335">||</span>&nbsp;<span class="op" id="2709338">*</span><span class="ident" id="2709339">tf</span><span class="op" id="2709341">.</span><span class="ident" id="2709342">tag</span>&nbsp;<span class="op" id="2709346">!=</span>&nbsp;<span class="op" id="2709349">*</span><span class="ident" id="2709350">vf</span><span class="op" id="2709352">.</span><span class="ident" id="2709353">tag</span><span class="op" id="2709356">)</span>&nbsp;<span class="op" id="2709358">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2709364">return</span>&nbsp;<span class="builtintype" id="2709371">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2709380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2709385">if</span>&nbsp;<span class="ident" id="2709388">tf</span><span class="op" id="2709390">.</span><span class="ident" id="2709391">offset</span>&nbsp;<span class="op" id="2709398">!=</span>&nbsp;<span class="ident" id="2709401">vf</span><span class="op" id="2709403">.</span><span class="ident" id="2709404">offset</span>&nbsp;<span class="op" id="2709411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2709417">return</span>&nbsp;<span class="builtintype" id="2709424">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2709433">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2709437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2709441">return</span>&nbsp;<span class="builtintype" id="2709448">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2709454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2709458">return</span>&nbsp;<span class="builtintype" id="2709465">false</span><br>
<span class="lineno">1285</span><span class="op" id="2709471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2709474">//&nbsp;typelinks&nbsp;is&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="comment" id="2709522">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;&#39;typelink&#39;&nbsp;information&nbsp;in&nbsp;the&nbsp;binary,</span><br>
<span class="lineno"></span><span class="comment" id="2709593">//&nbsp;which&nbsp;is&nbsp;to&nbsp;say&nbsp;a&nbsp;slice&nbsp;of&nbsp;known&nbsp;types,&nbsp;sorted&nbsp;by&nbsp;string.</span><br>
<span class="lineno">1290</span><span class="comment" id="2709654">//&nbsp;Note&nbsp;that&nbsp;strings&nbsp;are&nbsp;not&nbsp;unique&nbsp;identifiers&nbsp;for&nbsp;types:</span><br>
<span class="lineno"></span><span class="comment" id="2709713">//&nbsp;there&nbsp;can&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;with&nbsp;a&nbsp;given&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2709764">//&nbsp;Only&nbsp;types&nbsp;we&nbsp;might&nbsp;want&nbsp;to&nbsp;look&nbsp;up&nbsp;are&nbsp;included:</span><br>
<span class="lineno"></span><span class="comment" id="2709817">//&nbsp;channels,&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;arrays.</span><br>
<span class="lineno"></span><span class="keyword" id="2709856">func</span>&nbsp;<span class="ident" id="2709861">typelinks</span><span class="op" id="2709870">(</span><span class="op" id="2709871">)</span>&nbsp;<span class="op" id="2709873">[</span><span class="op" id="2709874">]</span><span class="op" id="2709875">*</span><span class="ident" id="2709876">rtype</span><br>
<span class="lineno">1295</span><br>
<span class="lineno"></span><span class="comment" id="2709883">//&nbsp;typesByString&nbsp;returns&nbsp;the&nbsp;subslice&nbsp;of&nbsp;typelinks()&nbsp;whose&nbsp;elements&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2709956">//&nbsp;the&nbsp;given&nbsp;string&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="2709992">//&nbsp;It&nbsp;may&nbsp;be&nbsp;empty&nbsp;(no&nbsp;known&nbsp;types&nbsp;with&nbsp;that&nbsp;string)&nbsp;or&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2710057">//&nbsp;multiple&nbsp;elements&nbsp;(multiple&nbsp;types&nbsp;with&nbsp;that&nbsp;string).</span><br>
<span class="lineno">1300</span><span class="keyword" id="2710113">func</span>&nbsp;<span class="ident" id="2710118">typesByString</span><span class="op" id="2710131">(</span><span class="ident" id="2710132">s</span>&nbsp;<span class="builtintype" id="2710134">string</span><span class="op" id="2710140">)</span>&nbsp;<span class="op" id="2710142">[</span><span class="op" id="2710143">]</span><span class="op" id="2710144">*</span><span class="ident" id="2710145">rtype</span>&nbsp;<span class="op" id="2710151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2710154">typ</span>&nbsp;<span class="op" id="2710158">:=</span>&nbsp;<span class="ident" id="2710161">typelinks</span><span class="op" id="2710170">(</span><span class="op" id="2710171">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2710175">//&nbsp;We&nbsp;are&nbsp;looking&nbsp;for&nbsp;the&nbsp;first&nbsp;index&nbsp;i&nbsp;where&nbsp;the&nbsp;string&nbsp;becomes&nbsp;&gt;=&nbsp;s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2710247">//&nbsp;This&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;sort.Search,&nbsp;with&nbsp;f(h)&nbsp;replaced&nbsp;by&nbsp;(*typ[h].string&nbsp;&gt;=&nbsp;s).</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2710327">i</span><span class="op" id="2710328">,</span>&nbsp;<span class="ident" id="2710330">j</span>&nbsp;<span class="op" id="2710332">:=</span>&nbsp;<span class="num" id="2710335">0</span><span class="op" id="2710336">,</span>&nbsp;<span class="builtinfunc" id="2710338">len</span><span class="op" id="2710341">(</span><span class="ident" id="2710342">typ</span><span class="op" id="2710345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2710348">for</span>&nbsp;<span class="ident" id="2710352">i</span>&nbsp;<span class="op" id="2710354">&lt;</span>&nbsp;<span class="ident" id="2710356">j</span>&nbsp;<span class="op" id="2710358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2710362">h</span>&nbsp;<span class="op" id="2710364">:=</span>&nbsp;<span class="ident" id="2710367">i</span>&nbsp;<span class="op" id="2710369">+</span>&nbsp;<span class="op" id="2710371">(</span><span class="ident" id="2710372">j</span><span class="op" id="2710373">-</span><span class="ident" id="2710374">i</span><span class="op" id="2710375">)</span><span class="op" id="2710376">/</span><span class="num" id="2710377">2</span>&nbsp;<span class="comment" id="2710379">//&nbsp;avoid&nbsp;overflow&nbsp;when&nbsp;computing&nbsp;h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2710416">//&nbsp;i&nbsp;≤&nbsp;h&nbsp;&lt;&nbsp;j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2710433">if</span>&nbsp;<span class="op" id="2710436">!</span><span class="op" id="2710437">(</span><span class="op" id="2710438">*</span><span class="ident" id="2710439">typ</span><span class="op" id="2710442">[</span><span class="ident" id="2710443">h</span><span class="op" id="2710444">]</span><span class="op" id="2710445">.</span><span class="builtintype" id="2710446">string</span>&nbsp;<span class="op" id="2710453">&gt;=</span>&nbsp;<span class="ident" id="2710456">s</span><span class="op" id="2710457">)</span>&nbsp;<span class="op" id="2710459">{</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2710464">i</span>&nbsp;<span class="op" id="2710466">=</span>&nbsp;<span class="ident" id="2710468">h</span>&nbsp;<span class="op" id="2710470">+</span>&nbsp;<span class="num" id="2710472">1</span>&nbsp;<span class="comment" id="2710474">//&nbsp;preserves&nbsp;f(i-1)&nbsp;==&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2710505">}</span>&nbsp;<span class="keyword" id="2710507">else</span>&nbsp;<span class="op" id="2710512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2710517">j</span>&nbsp;<span class="op" id="2710519">=</span>&nbsp;<span class="ident" id="2710521">h</span>&nbsp;<span class="comment" id="2710523">//&nbsp;preserves&nbsp;f(j)&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2710551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2710554">}</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2710557">//&nbsp;i&nbsp;==&nbsp;j,&nbsp;f(i-1)&nbsp;==&nbsp;false,&nbsp;and&nbsp;f(j)&nbsp;(=&nbsp;f(i))&nbsp;==&nbsp;true&nbsp;&nbsp;=&gt;&nbsp;&nbsp;answer&nbsp;is&nbsp;i.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2710631">//&nbsp;Having&nbsp;found&nbsp;the&nbsp;first,&nbsp;linear&nbsp;scan&nbsp;forward&nbsp;to&nbsp;find&nbsp;the&nbsp;last.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2710697">//&nbsp;We&nbsp;could&nbsp;do&nbsp;a&nbsp;second&nbsp;binary&nbsp;search,&nbsp;but&nbsp;the&nbsp;caller&nbsp;is&nbsp;going</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2710761">//&nbsp;to&nbsp;do&nbsp;a&nbsp;linear&nbsp;scan&nbsp;anyway.</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2710793">j</span>&nbsp;<span class="op" id="2710795">=</span>&nbsp;<span class="ident" id="2710797">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2710800">for</span>&nbsp;<span class="ident" id="2710804">j</span>&nbsp;<span class="op" id="2710806">&lt;</span>&nbsp;<span class="builtinfunc" id="2710808">len</span><span class="op" id="2710811">(</span><span class="ident" id="2710812">typ</span><span class="op" id="2710815">)</span>&nbsp;<span class="op" id="2710817">&amp;&amp;</span>&nbsp;<span class="op" id="2710820">*</span><span class="ident" id="2710821">typ</span><span class="op" id="2710824">[</span><span class="ident" id="2710825">j</span><span class="op" id="2710826">]</span><span class="op" id="2710827">.</span><span class="builtintype" id="2710828">string</span>&nbsp;<span class="op" id="2710835">==</span>&nbsp;<span class="ident" id="2710838">s</span>&nbsp;<span class="op" id="2710840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2710844">j</span><span class="op" id="2710845">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2710849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2710853">//&nbsp;This&nbsp;slice&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;string&nbsp;is&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2710910">return</span>&nbsp;<span class="ident" id="2710917">typ</span><span class="op" id="2710920">[</span><span class="ident" id="2710921">i</span><span class="op" id="2710922">:</span><span class="ident" id="2710923">j</span><span class="op" id="2710924">]</span><br>
<span class="lineno"></span><span class="op" id="2710926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2710929">//&nbsp;The&nbsp;lookupCache&nbsp;caches&nbsp;ChanOf,&nbsp;MapOf,&nbsp;and&nbsp;SliceOf&nbsp;lookups.</span><br>
<span class="lineno">1330</span><span class="keyword" id="2710991">var</span>&nbsp;<span class="ident" id="2710995">lookupCache</span>&nbsp;<span class="keyword" id="2711007">struct</span>&nbsp;<span class="op" id="2711014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2711017">sync</span><span class="op" id="2711021">.</span><span class="ident" id="2711022">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2711031">m</span>&nbsp;<span class="keyword" id="2711033">map</span><span class="op" id="2711036">[</span><span class="ident" id="2711037">cacheKey</span><span class="op" id="2711045">]</span><span class="op" id="2711046">*</span><span class="ident" id="2711047">rtype</span><br>
<span class="lineno"></span><span class="op" id="2711053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="comment" id="2711056">//&nbsp;A&nbsp;cacheKey&nbsp;is&nbsp;the&nbsp;key&nbsp;for&nbsp;use&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2711109">//&nbsp;Four&nbsp;values&nbsp;describe&nbsp;any&nbsp;of&nbsp;the&nbsp;types&nbsp;we&nbsp;are&nbsp;looking&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="2711170">//&nbsp;type&nbsp;kind,&nbsp;one&nbsp;or&nbsp;two&nbsp;subtypes,&nbsp;and&nbsp;an&nbsp;extra&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="2711227">type</span>&nbsp;<span class="ident" id="2711232">cacheKey</span>&nbsp;<span class="keyword" id="2711241">struct</span>&nbsp;<span class="op" id="2711248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2711251">kind</span>&nbsp;&nbsp;<span class="ident" id="2711257">Kind</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2711263">t1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2711269">*</span><span class="ident" id="2711270">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2711277">t2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2711283">*</span><span class="ident" id="2711284">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2711291">extra</span>&nbsp;<span class="builtintype" id="2711297">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2711305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1345</span><span class="comment" id="2711308">//&nbsp;cacheGet&nbsp;looks&nbsp;for&nbsp;a&nbsp;type&nbsp;under&nbsp;the&nbsp;key&nbsp;k&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2711373">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;one,&nbsp;it&nbsp;returns&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2711415">//&nbsp;If&nbsp;not,&nbsp;it&nbsp;returns&nbsp;nil&nbsp;with&nbsp;the&nbsp;cache&nbsp;locked.</span><br>
<span class="lineno"></span><span class="comment" id="2711464">//&nbsp;The&nbsp;caller&nbsp;is&nbsp;expected&nbsp;to&nbsp;use&nbsp;cachePut&nbsp;to&nbsp;unlock&nbsp;the&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="2711527">func</span>&nbsp;<span class="ident" id="2711532">cacheGet</span><span class="op" id="2711540">(</span><span class="ident" id="2711541">k</span>&nbsp;<span class="ident" id="2711543">cacheKey</span><span class="op" id="2711551">)</span>&nbsp;<span class="ident" id="2711553">Type</span>&nbsp;<span class="op" id="2711558">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2711561">lookupCache</span><span class="op" id="2711572">.</span><span class="ident" id="2711573">RLock</span><span class="op" id="2711578">(</span><span class="op" id="2711579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2711582">t</span>&nbsp;<span class="op" id="2711584">:=</span>&nbsp;<span class="ident" id="2711587">lookupCache</span><span class="op" id="2711598">.</span><span class="ident" id="2711599">m</span><span class="op" id="2711600">[</span><span class="ident" id="2711601">k</span><span class="op" id="2711602">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2711605">lookupCache</span><span class="op" id="2711616">.</span><span class="ident" id="2711617">RUnlock</span><span class="op" id="2711624">(</span><span class="op" id="2711625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2711628">if</span>&nbsp;<span class="ident" id="2711631">t</span>&nbsp;<span class="op" id="2711633">!=</span>&nbsp;<span class="builtintype" id="2711636">nil</span>&nbsp;<span class="op" id="2711640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2711644">return</span>&nbsp;<span class="ident" id="2711651">t</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2711654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2711658">lookupCache</span><span class="op" id="2711669">.</span><span class="ident" id="2711670">Lock</span><span class="op" id="2711674">(</span><span class="op" id="2711675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2711678">t</span>&nbsp;<span class="op" id="2711680">=</span>&nbsp;<span class="ident" id="2711682">lookupCache</span><span class="op" id="2711693">.</span><span class="ident" id="2711694">m</span><span class="op" id="2711695">[</span><span class="ident" id="2711696">k</span><span class="op" id="2711697">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2711700">if</span>&nbsp;<span class="ident" id="2711703">t</span>&nbsp;<span class="op" id="2711705">!=</span>&nbsp;<span class="builtintype" id="2711708">nil</span>&nbsp;<span class="op" id="2711712">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2711716">lookupCache</span><span class="op" id="2711727">.</span><span class="ident" id="2711728">Unlock</span><span class="op" id="2711734">(</span><span class="op" id="2711735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2711739">return</span>&nbsp;<span class="ident" id="2711746">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2711749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2711753">if</span>&nbsp;<span class="ident" id="2711756">lookupCache</span><span class="op" id="2711767">.</span><span class="ident" id="2711768">m</span>&nbsp;<span class="op" id="2711770">==</span>&nbsp;<span class="builtintype" id="2711773">nil</span>&nbsp;<span class="op" id="2711777">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2711781">lookupCache</span><span class="op" id="2711792">.</span><span class="ident" id="2711793">m</span>&nbsp;<span class="op" id="2711795">=</span>&nbsp;<span class="builtinfunc" id="2711797">make</span><span class="op" id="2711801">(</span><span class="keyword" id="2711802">map</span><span class="op" id="2711805">[</span><span class="ident" id="2711806">cacheKey</span><span class="op" id="2711814">]</span><span class="op" id="2711815">*</span><span class="ident" id="2711816">rtype</span><span class="op" id="2711821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2711824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2711828">return</span>&nbsp;<span class="builtintype" id="2711835">nil</span><br>
<span class="lineno"></span><span class="op" id="2711839">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="2711842">//&nbsp;cachePut&nbsp;stores&nbsp;the&nbsp;given&nbsp;type&nbsp;in&nbsp;the&nbsp;cache,&nbsp;unlocks&nbsp;the&nbsp;cache,</span><br>
<span class="lineno"></span><span class="comment" id="2711909">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type.&nbsp;It&nbsp;is&nbsp;expected&nbsp;that&nbsp;the&nbsp;cache&nbsp;is&nbsp;locked</span><br>
<span class="lineno"></span><span class="comment" id="2711974">//&nbsp;because&nbsp;cacheGet&nbsp;returned&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2712008">func</span>&nbsp;<span class="ident" id="2712013">cachePut</span><span class="op" id="2712021">(</span><span class="ident" id="2712022">k</span>&nbsp;<span class="ident" id="2712024">cacheKey</span><span class="op" id="2712032">,</span>&nbsp;<span class="ident" id="2712034">t</span>&nbsp;<span class="op" id="2712036">*</span><span class="ident" id="2712037">rtype</span><span class="op" id="2712042">)</span>&nbsp;<span class="ident" id="2712044">Type</span>&nbsp;<span class="op" id="2712049">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2712052">lookupCache</span><span class="op" id="2712063">.</span><span class="ident" id="2712064">m</span><span class="op" id="2712065">[</span><span class="ident" id="2712066">k</span><span class="op" id="2712067">]</span>&nbsp;<span class="op" id="2712069">=</span>&nbsp;<span class="ident" id="2712071">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2712074">lookupCache</span><span class="op" id="2712085">.</span><span class="ident" id="2712086">Unlock</span><span class="op" id="2712092">(</span><span class="op" id="2712093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2712096">return</span>&nbsp;<span class="ident" id="2712103">t</span><br>
<span class="lineno"></span><span class="op" id="2712105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span><span class="comment" id="2712108">//&nbsp;ChanOf&nbsp;returns&nbsp;the&nbsp;channel&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;direction&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2712186">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ChanOf(RecvDir,&nbsp;t)&nbsp;represents&nbsp;&lt;-chan&nbsp;int.</span><br>
<span class="lineno"></span><span class="comment" id="2712265">//</span><br>
<span class="lineno"></span><span class="comment" id="2712268">//&nbsp;The&nbsp;gc&nbsp;runtime&nbsp;imposes&nbsp;a&nbsp;limit&nbsp;of&nbsp;64&nbsp;kB&nbsp;on&nbsp;channel&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2712337">//&nbsp;If&nbsp;t&#39;s&nbsp;size&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;exceeds&nbsp;this&nbsp;limit,&nbsp;ChanOf&nbsp;panics.</span><br>
<span class="lineno">1385</span><span class="keyword" id="2712402">func</span>&nbsp;<span class="ident" id="2712407">ChanOf</span><span class="op" id="2712413">(</span><span class="ident" id="2712414">dir</span>&nbsp;<span class="ident" id="2712418">ChanDir</span><span class="op" id="2712425">,</span>&nbsp;<span class="ident" id="2712427">t</span>&nbsp;<span class="ident" id="2712429">Type</span><span class="op" id="2712433">)</span>&nbsp;<span class="ident" id="2712435">Type</span>&nbsp;<span class="op" id="2712440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2712443">typ</span>&nbsp;<span class="op" id="2712447">:=</span>&nbsp;<span class="ident" id="2712450">t</span><span class="op" id="2712451">.</span><span class="op" id="2712452">(</span><span class="op" id="2712453">*</span><span class="ident" id="2712454">rtype</span><span class="op" id="2712459">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2712463">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2712482">ckey</span>&nbsp;<span class="op" id="2712487">:=</span>&nbsp;<span class="ident" id="2712490">cacheKey</span><span class="op" id="2712498">{</span><span class="ident" id="2712499">Chan</span><span class="op" id="2712503">,</span>&nbsp;<span class="ident" id="2712505">typ</span><span class="op" id="2712508">,</span>&nbsp;<span class="builtintype" id="2712510">nil</span><span class="op" id="2712513">,</span>&nbsp;<span class="builtintype" id="2712515">uintptr</span><span class="op" id="2712522">(</span><span class="ident" id="2712523">dir</span><span class="op" id="2712526">)</span><span class="op" id="2712527">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2712530">if</span>&nbsp;<span class="ident" id="2712533">ch</span>&nbsp;<span class="op" id="2712536">:=</span>&nbsp;<span class="ident" id="2712539">cacheGet</span><span class="op" id="2712547">(</span><span class="ident" id="2712548">ckey</span><span class="op" id="2712552">)</span><span class="op" id="2712553">;</span>&nbsp;<span class="ident" id="2712555">ch</span>&nbsp;<span class="op" id="2712558">!=</span>&nbsp;<span class="builtintype" id="2712561">nil</span>&nbsp;<span class="op" id="2712565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2712569">return</span>&nbsp;<span class="ident" id="2712576">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2712580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2712584">//&nbsp;This&nbsp;restriction&nbsp;is&nbsp;imposed&nbsp;by&nbsp;the&nbsp;gc&nbsp;compiler&nbsp;and&nbsp;the&nbsp;runtime.</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2712652">if</span>&nbsp;<span class="ident" id="2712655">typ</span><span class="op" id="2712658">.</span><span class="ident" id="2712659">size</span>&nbsp;<span class="op" id="2712664">&gt;=</span>&nbsp;<span class="num" id="2712667">1</span><span class="op" id="2712668">&lt;&lt;</span><span class="num" id="2712670">16</span>&nbsp;<span class="op" id="2712673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2712677">lookupCache</span><span class="op" id="2712688">.</span><span class="ident" id="2712689">Unlock</span><span class="op" id="2712695">(</span><span class="op" id="2712696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2712700">panic</span><span class="op" id="2712705">(</span><span class="string" id="2712706">&#34;reflect.ChanOf:&nbsp;element&nbsp;size&nbsp;too&nbsp;large&#34;</span><span class="op" id="2712746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2712749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2712753">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2712778">//&nbsp;TODO:&nbsp;Precedence&nbsp;when&nbsp;constructing&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2712825">var</span>&nbsp;<span class="ident" id="2712829">s</span>&nbsp;<span class="builtintype" id="2712831">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2712839">switch</span>&nbsp;<span class="ident" id="2712846">dir</span>&nbsp;<span class="op" id="2712850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2712853">default</span><span class="op" id="2712860">:</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2712864">lookupCache</span><span class="op" id="2712875">.</span><span class="ident" id="2712876">Unlock</span><span class="op" id="2712882">(</span><span class="op" id="2712883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2712887">panic</span><span class="op" id="2712892">(</span><span class="string" id="2712893">&#34;reflect.ChanOf:&nbsp;invalid&nbsp;dir&#34;</span><span class="op" id="2712922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2712925">case</span>&nbsp;<span class="ident" id="2712930">SendDir</span><span class="op" id="2712937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2712941">s</span>&nbsp;<span class="op" id="2712943">=</span>&nbsp;<span class="string" id="2712945">&#34;chan&lt;-&nbsp;&#34;</span>&nbsp;<span class="op" id="2712955">+</span>&nbsp;<span class="op" id="2712957">*</span><span class="ident" id="2712958">typ</span><span class="op" id="2712961">.</span><span class="builtintype" id="2712962">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2712970">case</span>&nbsp;<span class="ident" id="2712975">RecvDir</span><span class="op" id="2712982">:</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2712986">s</span>&nbsp;<span class="op" id="2712988">=</span>&nbsp;<span class="string" id="2712990">&#34;&lt;-chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2713000">+</span>&nbsp;<span class="op" id="2713002">*</span><span class="ident" id="2713003">typ</span><span class="op" id="2713006">.</span><span class="builtintype" id="2713007">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2713015">case</span>&nbsp;<span class="ident" id="2713020">BothDir</span><span class="op" id="2713027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713031">s</span>&nbsp;<span class="op" id="2713033">=</span>&nbsp;<span class="string" id="2713035">&#34;chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2713043">+</span>&nbsp;<span class="op" id="2713045">*</span><span class="ident" id="2713046">typ</span><span class="op" id="2713049">.</span><span class="builtintype" id="2713050">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2713058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2713061">for</span>&nbsp;<span class="ident" id="2713065">_</span><span class="op" id="2713066">,</span>&nbsp;<span class="ident" id="2713068">tt</span>&nbsp;<span class="op" id="2713071">:=</span>&nbsp;<span class="keyword" id="2713074">range</span>&nbsp;<span class="ident" id="2713080">typesByString</span><span class="op" id="2713093">(</span><span class="ident" id="2713094">s</span><span class="op" id="2713095">)</span>&nbsp;<span class="op" id="2713097">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713101">ch</span>&nbsp;<span class="op" id="2713104">:=</span>&nbsp;<span class="op" id="2713107">(</span><span class="op" id="2713108">*</span><span class="ident" id="2713109">chanType</span><span class="op" id="2713117">)</span><span class="op" id="2713118">(</span><span class="ident" id="2713119">unsafe</span><span class="op" id="2713125">.</span><span class="ident" id="2713126">Pointer</span><span class="op" id="2713133">(</span><span class="ident" id="2713134">tt</span><span class="op" id="2713136">)</span><span class="op" id="2713137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2713141">if</span>&nbsp;<span class="ident" id="2713144">ch</span><span class="op" id="2713146">.</span><span class="ident" id="2713147">elem</span>&nbsp;<span class="op" id="2713152">==</span>&nbsp;<span class="ident" id="2713155">typ</span>&nbsp;<span class="op" id="2713159">&amp;&amp;</span>&nbsp;<span class="ident" id="2713162">ch</span><span class="op" id="2713164">.</span><span class="ident" id="2713165">dir</span>&nbsp;<span class="op" id="2713169">==</span>&nbsp;<span class="builtintype" id="2713172">uintptr</span><span class="op" id="2713179">(</span><span class="ident" id="2713180">dir</span><span class="op" id="2713183">)</span>&nbsp;<span class="op" id="2713185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2713190">return</span>&nbsp;<span class="ident" id="2713197">cachePut</span><span class="op" id="2713205">(</span><span class="ident" id="2713206">ckey</span><span class="op" id="2713210">,</span>&nbsp;<span class="ident" id="2713212">tt</span><span class="op" id="2713214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2713218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2713221">}</span><br>
<span class="lineno">1420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2713225">//&nbsp;Make&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2713250">var</span>&nbsp;<span class="ident" id="2713254">ichan</span>&nbsp;<span class="keyword" id="2713260">interface</span><span class="op" id="2713269">{</span><span class="op" id="2713270">}</span>&nbsp;<span class="op" id="2713272">=</span>&nbsp;<span class="op" id="2713274">(</span><span class="keyword" id="2713275">chan</span>&nbsp;<span class="ident" id="2713280">unsafe</span><span class="op" id="2713286">.</span><span class="ident" id="2713287">Pointer</span><span class="op" id="2713294">)</span><span class="op" id="2713295">(</span><span class="builtintype" id="2713296">nil</span><span class="op" id="2713299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713302">prototype</span>&nbsp;<span class="op" id="2713312">:=</span>&nbsp;<span class="op" id="2713315">*</span><span class="op" id="2713316">(</span><span class="op" id="2713317">*</span><span class="op" id="2713318">*</span><span class="ident" id="2713319">chanType</span><span class="op" id="2713327">)</span><span class="op" id="2713328">(</span><span class="ident" id="2713329">unsafe</span><span class="op" id="2713335">.</span><span class="ident" id="2713336">Pointer</span><span class="op" id="2713343">(</span><span class="op" id="2713344">&amp;</span><span class="ident" id="2713345">ichan</span><span class="op" id="2713350">)</span><span class="op" id="2713351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713354">ch</span>&nbsp;<span class="op" id="2713357">:=</span>&nbsp;<span class="builtinfunc" id="2713360">new</span><span class="op" id="2713363">(</span><span class="ident" id="2713364">chanType</span><span class="op" id="2713372">)</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2713375">*</span><span class="ident" id="2713376">ch</span>&nbsp;<span class="op" id="2713379">=</span>&nbsp;<span class="op" id="2713381">*</span><span class="ident" id="2713382">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713393">ch</span><span class="op" id="2713395">.</span><span class="builtintype" id="2713396">string</span>&nbsp;<span class="op" id="2713403">=</span>&nbsp;<span class="op" id="2713405">&amp;</span><span class="ident" id="2713406">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713409">ch</span><span class="op" id="2713411">.</span><span class="ident" id="2713412">hash</span>&nbsp;<span class="op" id="2713417">=</span>&nbsp;<span class="ident" id="2713419">fnv1</span><span class="op" id="2713423">(</span><span class="ident" id="2713424">typ</span><span class="op" id="2713427">.</span><span class="ident" id="2713428">hash</span><span class="op" id="2713432">,</span>&nbsp;<span class="string" id="2713434">&#39;c&#39;</span><span class="op" id="2713437">,</span>&nbsp;<span class="builtintype" id="2713439">byte</span><span class="op" id="2713443">(</span><span class="ident" id="2713444">dir</span><span class="op" id="2713447">)</span><span class="op" id="2713448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713451">ch</span><span class="op" id="2713453">.</span><span class="ident" id="2713454">elem</span>&nbsp;<span class="op" id="2713459">=</span>&nbsp;<span class="ident" id="2713461">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713466">ch</span><span class="op" id="2713468">.</span><span class="ident" id="2713469">uncommonType</span>&nbsp;<span class="op" id="2713482">=</span>&nbsp;<span class="builtintype" id="2713484">nil</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713489">ch</span><span class="op" id="2713491">.</span><span class="ident" id="2713492">ptrToThis</span>&nbsp;<span class="op" id="2713502">=</span>&nbsp;<span class="builtintype" id="2713504">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713509">ch</span><span class="op" id="2713511">.</span><span class="ident" id="2713512">zero</span>&nbsp;<span class="op" id="2713517">=</span>&nbsp;<span class="ident" id="2713519">unsafe</span><span class="op" id="2713525">.</span><span class="ident" id="2713526">Pointer</span><span class="op" id="2713533">(</span><span class="op" id="2713534">&amp;</span><span class="builtinfunc" id="2713535">make</span><span class="op" id="2713539">(</span><span class="op" id="2713540">[</span><span class="op" id="2713541">]</span><span class="builtintype" id="2713542">byte</span><span class="op" id="2713546">,</span>&nbsp;<span class="ident" id="2713548">ch</span><span class="op" id="2713550">.</span><span class="ident" id="2713551">size</span><span class="op" id="2713555">)</span><span class="op" id="2713556">[</span><span class="num" id="2713557">0</span><span class="op" id="2713558">]</span><span class="op" id="2713559">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2713563">return</span>&nbsp;<span class="ident" id="2713570">cachePut</span><span class="op" id="2713578">(</span><span class="ident" id="2713579">ckey</span><span class="op" id="2713583">,</span>&nbsp;<span class="op" id="2713585">&amp;</span><span class="ident" id="2713586">ch</span><span class="op" id="2713588">.</span><span class="ident" id="2713589">rtype</span><span class="op" id="2713594">)</span><br>
<span class="lineno"></span><span class="op" id="2713596">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="keyword" id="2713599">func</span>&nbsp;<span class="ident" id="2713604">ismapkey</span><span class="op" id="2713612">(</span><span class="op" id="2713613">*</span><span class="ident" id="2713614">rtype</span><span class="op" id="2713619">)</span>&nbsp;<span class="builtintype" id="2713621">bool</span>&nbsp;<span class="comment" id="2713626">//&nbsp;implemented&nbsp;in&nbsp;runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2713653">//&nbsp;MapOf&nbsp;returns&nbsp;the&nbsp;map&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;key&nbsp;and&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2713721">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;k&nbsp;represents&nbsp;int&nbsp;and&nbsp;e&nbsp;represents&nbsp;string,</span><br>
<span class="lineno">1440</span><span class="comment" id="2713782">//&nbsp;MapOf(k,&nbsp;e)&nbsp;represents&nbsp;map[int]string.</span><br>
<span class="lineno"></span><span class="comment" id="2713824">//</span><br>
<span class="lineno"></span><span class="comment" id="2713827">//&nbsp;If&nbsp;the&nbsp;key&nbsp;type&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;map&nbsp;key&nbsp;type&nbsp;(that&nbsp;is,&nbsp;if&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2713895">//&nbsp;not&nbsp;implement&nbsp;Go&#39;s&nbsp;==&nbsp;operator),&nbsp;MapOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="keyword" id="2713945">func</span>&nbsp;<span class="ident" id="2713950">MapOf</span><span class="op" id="2713955">(</span><span class="ident" id="2713956">key</span><span class="op" id="2713959">,</span>&nbsp;<span class="ident" id="2713961">elem</span>&nbsp;<span class="ident" id="2713966">Type</span><span class="op" id="2713970">)</span>&nbsp;<span class="ident" id="2713972">Type</span>&nbsp;<span class="op" id="2713977">{</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713980">ktyp</span>&nbsp;<span class="op" id="2713985">:=</span>&nbsp;<span class="ident" id="2713988">key</span><span class="op" id="2713991">.</span><span class="op" id="2713992">(</span><span class="op" id="2713993">*</span><span class="ident" id="2713994">rtype</span><span class="op" id="2713999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714002">etyp</span>&nbsp;<span class="op" id="2714007">:=</span>&nbsp;<span class="ident" id="2714010">elem</span><span class="op" id="2714014">.</span><span class="op" id="2714015">(</span><span class="op" id="2714016">*</span><span class="ident" id="2714017">rtype</span><span class="op" id="2714022">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2714026">if</span>&nbsp;<span class="op" id="2714029">!</span><span class="ident" id="2714030">ismapkey</span><span class="op" id="2714038">(</span><span class="ident" id="2714039">ktyp</span><span class="op" id="2714043">)</span>&nbsp;<span class="op" id="2714045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2714049">panic</span><span class="op" id="2714054">(</span><span class="string" id="2714055">&#34;reflect.MapOf:&nbsp;invalid&nbsp;key&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="2714090">+</span>&nbsp;<span class="ident" id="2714092">ktyp</span><span class="op" id="2714096">.</span><span class="ident" id="2714097">String</span><span class="op" id="2714103">(</span><span class="op" id="2714104">)</span><span class="op" id="2714105">)</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2714108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2714112">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714131">ckey</span>&nbsp;<span class="op" id="2714136">:=</span>&nbsp;<span class="ident" id="2714139">cacheKey</span><span class="op" id="2714147">{</span><span class="ident" id="2714148">Map</span><span class="op" id="2714151">,</span>&nbsp;<span class="ident" id="2714153">ktyp</span><span class="op" id="2714157">,</span>&nbsp;<span class="ident" id="2714159">etyp</span><span class="op" id="2714163">,</span>&nbsp;<span class="num" id="2714165">0</span><span class="op" id="2714166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2714169">if</span>&nbsp;<span class="ident" id="2714172">mt</span>&nbsp;<span class="op" id="2714175">:=</span>&nbsp;<span class="ident" id="2714178">cacheGet</span><span class="op" id="2714186">(</span><span class="ident" id="2714187">ckey</span><span class="op" id="2714191">)</span><span class="op" id="2714192">;</span>&nbsp;<span class="ident" id="2714194">mt</span>&nbsp;<span class="op" id="2714197">!=</span>&nbsp;<span class="builtintype" id="2714200">nil</span>&nbsp;<span class="op" id="2714204">{</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2714208">return</span>&nbsp;<span class="ident" id="2714215">mt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2714219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2714223">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714248">s</span>&nbsp;<span class="op" id="2714250">:=</span>&nbsp;<span class="string" id="2714253">&#34;map[&#34;</span>&nbsp;<span class="op" id="2714260">+</span>&nbsp;<span class="op" id="2714262">*</span><span class="ident" id="2714263">ktyp</span><span class="op" id="2714267">.</span><span class="builtintype" id="2714268">string</span>&nbsp;<span class="op" id="2714275">+</span>&nbsp;<span class="string" id="2714277">&#34;]&#34;</span>&nbsp;<span class="op" id="2714281">+</span>&nbsp;<span class="op" id="2714283">*</span><span class="ident" id="2714284">etyp</span><span class="op" id="2714288">.</span><span class="builtintype" id="2714289">string</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2714297">for</span>&nbsp;<span class="ident" id="2714301">_</span><span class="op" id="2714302">,</span>&nbsp;<span class="ident" id="2714304">tt</span>&nbsp;<span class="op" id="2714307">:=</span>&nbsp;<span class="keyword" id="2714310">range</span>&nbsp;<span class="ident" id="2714316">typesByString</span><span class="op" id="2714329">(</span><span class="ident" id="2714330">s</span><span class="op" id="2714331">)</span>&nbsp;<span class="op" id="2714333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714337">mt</span>&nbsp;<span class="op" id="2714340">:=</span>&nbsp;<span class="op" id="2714343">(</span><span class="op" id="2714344">*</span><span class="ident" id="2714345">mapType</span><span class="op" id="2714352">)</span><span class="op" id="2714353">(</span><span class="ident" id="2714354">unsafe</span><span class="op" id="2714360">.</span><span class="ident" id="2714361">Pointer</span><span class="op" id="2714368">(</span><span class="ident" id="2714369">tt</span><span class="op" id="2714371">)</span><span class="op" id="2714372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2714376">if</span>&nbsp;<span class="ident" id="2714379">mt</span><span class="op" id="2714381">.</span><span class="ident" id="2714382">key</span>&nbsp;<span class="op" id="2714386">==</span>&nbsp;<span class="ident" id="2714389">ktyp</span>&nbsp;<span class="op" id="2714394">&amp;&amp;</span>&nbsp;<span class="ident" id="2714397">mt</span><span class="op" id="2714399">.</span><span class="ident" id="2714400">elem</span>&nbsp;<span class="op" id="2714405">==</span>&nbsp;<span class="ident" id="2714408">etyp</span>&nbsp;<span class="op" id="2714413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2714418">return</span>&nbsp;<span class="ident" id="2714425">cachePut</span><span class="op" id="2714433">(</span><span class="ident" id="2714434">ckey</span><span class="op" id="2714438">,</span>&nbsp;<span class="ident" id="2714440">tt</span><span class="op" id="2714442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2714446">}</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2714449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2714453">//&nbsp;Make&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2714474">var</span>&nbsp;<span class="ident" id="2714478">imap</span>&nbsp;<span class="keyword" id="2714483">interface</span><span class="op" id="2714492">{</span><span class="op" id="2714493">}</span>&nbsp;<span class="op" id="2714495">=</span>&nbsp;<span class="op" id="2714497">(</span><span class="keyword" id="2714498">map</span><span class="op" id="2714501">[</span><span class="ident" id="2714502">unsafe</span><span class="op" id="2714508">.</span><span class="ident" id="2714509">Pointer</span><span class="op" id="2714516">]</span><span class="ident" id="2714517">unsafe</span><span class="op" id="2714523">.</span><span class="ident" id="2714524">Pointer</span><span class="op" id="2714531">)</span><span class="op" id="2714532">(</span><span class="builtintype" id="2714533">nil</span><span class="op" id="2714536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714539">prototype</span>&nbsp;<span class="op" id="2714549">:=</span>&nbsp;<span class="op" id="2714552">*</span><span class="op" id="2714553">(</span><span class="op" id="2714554">*</span><span class="op" id="2714555">*</span><span class="ident" id="2714556">mapType</span><span class="op" id="2714563">)</span><span class="op" id="2714564">(</span><span class="ident" id="2714565">unsafe</span><span class="op" id="2714571">.</span><span class="ident" id="2714572">Pointer</span><span class="op" id="2714579">(</span><span class="op" id="2714580">&amp;</span><span class="ident" id="2714581">imap</span><span class="op" id="2714585">)</span><span class="op" id="2714586">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714589">mt</span>&nbsp;<span class="op" id="2714592">:=</span>&nbsp;<span class="builtinfunc" id="2714595">new</span><span class="op" id="2714598">(</span><span class="ident" id="2714599">mapType</span><span class="op" id="2714606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2714609">*</span><span class="ident" id="2714610">mt</span>&nbsp;<span class="op" id="2714613">=</span>&nbsp;<span class="op" id="2714615">*</span><span class="ident" id="2714616">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714627">mt</span><span class="op" id="2714629">.</span><span class="builtintype" id="2714630">string</span>&nbsp;<span class="op" id="2714637">=</span>&nbsp;<span class="op" id="2714639">&amp;</span><span class="ident" id="2714640">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714643">mt</span><span class="op" id="2714645">.</span><span class="ident" id="2714646">hash</span>&nbsp;<span class="op" id="2714651">=</span>&nbsp;<span class="ident" id="2714653">fnv1</span><span class="op" id="2714657">(</span><span class="ident" id="2714658">etyp</span><span class="op" id="2714662">.</span><span class="ident" id="2714663">hash</span><span class="op" id="2714667">,</span>&nbsp;<span class="string" id="2714669">&#39;m&#39;</span><span class="op" id="2714672">,</span>&nbsp;<span class="builtintype" id="2714674">byte</span><span class="op" id="2714678">(</span><span class="ident" id="2714679">ktyp</span><span class="op" id="2714683">.</span><span class="ident" id="2714684">hash</span><span class="op" id="2714688">&gt;&gt;</span><span class="num" id="2714690">24</span><span class="op" id="2714692">)</span><span class="op" id="2714693">,</span>&nbsp;<span class="builtintype" id="2714695">byte</span><span class="op" id="2714699">(</span><span class="ident" id="2714700">ktyp</span><span class="op" id="2714704">.</span><span class="ident" id="2714705">hash</span><span class="op" id="2714709">&gt;&gt;</span><span class="num" id="2714711">16</span><span class="op" id="2714713">)</span><span class="op" id="2714714">,</span>&nbsp;<span class="builtintype" id="2714716">byte</span><span class="op" id="2714720">(</span><span class="ident" id="2714721">ktyp</span><span class="op" id="2714725">.</span><span class="ident" id="2714726">hash</span><span class="op" id="2714730">&gt;&gt;</span><span class="num" id="2714732">8</span><span class="op" id="2714733">)</span><span class="op" id="2714734">,</span>&nbsp;<span class="builtintype" id="2714736">byte</span><span class="op" id="2714740">(</span><span class="ident" id="2714741">ktyp</span><span class="op" id="2714745">.</span><span class="ident" id="2714746">hash</span><span class="op" id="2714750">)</span><span class="op" id="2714751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714754">mt</span><span class="op" id="2714756">.</span><span class="ident" id="2714757">key</span>&nbsp;<span class="op" id="2714761">=</span>&nbsp;<span class="ident" id="2714763">ktyp</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714769">mt</span><span class="op" id="2714771">.</span><span class="ident" id="2714772">elem</span>&nbsp;<span class="op" id="2714777">=</span>&nbsp;<span class="ident" id="2714779">etyp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714785">mt</span><span class="op" id="2714787">.</span><span class="ident" id="2714788">bucket</span>&nbsp;<span class="op" id="2714795">=</span>&nbsp;<span class="ident" id="2714797">bucketOf</span><span class="op" id="2714805">(</span><span class="ident" id="2714806">ktyp</span><span class="op" id="2714810">,</span>&nbsp;<span class="ident" id="2714812">etyp</span><span class="op" id="2714816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2714819">if</span>&nbsp;<span class="ident" id="2714822">ktyp</span><span class="op" id="2714826">.</span><span class="ident" id="2714827">size</span>&nbsp;<span class="op" id="2714832">&gt;</span>&nbsp;<span class="ident" id="2714834">maxKeySize</span>&nbsp;<span class="op" id="2714845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714849">mt</span><span class="op" id="2714851">.</span><span class="ident" id="2714852">keysize</span>&nbsp;<span class="op" id="2714860">=</span>&nbsp;<span class="builtintype" id="2714862">uint8</span><span class="op" id="2714867">(</span><span class="ident" id="2714868">ptrSize</span><span class="op" id="2714875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714879">mt</span><span class="op" id="2714881">.</span><span class="ident" id="2714882">indirectkey</span>&nbsp;<span class="op" id="2714894">=</span>&nbsp;<span class="num" id="2714896">1</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2714899">}</span>&nbsp;<span class="keyword" id="2714901">else</span>&nbsp;<span class="op" id="2714906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714910">mt</span><span class="op" id="2714912">.</span><span class="ident" id="2714913">keysize</span>&nbsp;<span class="op" id="2714921">=</span>&nbsp;<span class="builtintype" id="2714923">uint8</span><span class="op" id="2714928">(</span><span class="ident" id="2714929">ktyp</span><span class="op" id="2714933">.</span><span class="ident" id="2714934">size</span><span class="op" id="2714938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714942">mt</span><span class="op" id="2714944">.</span><span class="ident" id="2714945">indirectkey</span>&nbsp;<span class="op" id="2714957">=</span>&nbsp;<span class="num" id="2714959">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2714962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2714965">if</span>&nbsp;<span class="ident" id="2714968">etyp</span><span class="op" id="2714972">.</span><span class="ident" id="2714973">size</span>&nbsp;<span class="op" id="2714978">&gt;</span>&nbsp;<span class="ident" id="2714980">maxValSize</span>&nbsp;<span class="op" id="2714991">{</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714995">mt</span><span class="op" id="2714997">.</span><span class="ident" id="2714998">valuesize</span>&nbsp;<span class="op" id="2715008">=</span>&nbsp;<span class="builtintype" id="2715010">uint8</span><span class="op" id="2715015">(</span><span class="ident" id="2715016">ptrSize</span><span class="op" id="2715023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715027">mt</span><span class="op" id="2715029">.</span><span class="ident" id="2715030">indirectvalue</span>&nbsp;<span class="op" id="2715044">=</span>&nbsp;<span class="num" id="2715046">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2715049">}</span>&nbsp;<span class="keyword" id="2715051">else</span>&nbsp;<span class="op" id="2715056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715060">mt</span><span class="op" id="2715062">.</span><span class="ident" id="2715063">valuesize</span>&nbsp;<span class="op" id="2715073">=</span>&nbsp;<span class="builtintype" id="2715075">uint8</span><span class="op" id="2715080">(</span><span class="ident" id="2715081">etyp</span><span class="op" id="2715085">.</span><span class="ident" id="2715086">size</span><span class="op" id="2715090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715094">mt</span><span class="op" id="2715096">.</span><span class="ident" id="2715097">indirectvalue</span>&nbsp;<span class="op" id="2715111">=</span>&nbsp;<span class="num" id="2715113">0</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2715116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715119">mt</span><span class="op" id="2715121">.</span><span class="ident" id="2715122">bucketsize</span>&nbsp;<span class="op" id="2715133">=</span>&nbsp;<span class="builtintype" id="2715135">uint16</span><span class="op" id="2715141">(</span><span class="ident" id="2715142">mt</span><span class="op" id="2715144">.</span><span class="ident" id="2715145">bucket</span><span class="op" id="2715151">.</span><span class="ident" id="2715152">size</span><span class="op" id="2715156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715159">mt</span><span class="op" id="2715161">.</span><span class="ident" id="2715162">uncommonType</span>&nbsp;<span class="op" id="2715175">=</span>&nbsp;<span class="builtintype" id="2715177">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715182">mt</span><span class="op" id="2715184">.</span><span class="ident" id="2715185">ptrToThis</span>&nbsp;<span class="op" id="2715195">=</span>&nbsp;<span class="builtintype" id="2715197">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715202">mt</span><span class="op" id="2715204">.</span><span class="ident" id="2715205">zero</span>&nbsp;<span class="op" id="2715210">=</span>&nbsp;<span class="ident" id="2715212">unsafe</span><span class="op" id="2715218">.</span><span class="ident" id="2715219">Pointer</span><span class="op" id="2715226">(</span><span class="op" id="2715227">&amp;</span><span class="builtinfunc" id="2715228">make</span><span class="op" id="2715232">(</span><span class="op" id="2715233">[</span><span class="op" id="2715234">]</span><span class="builtintype" id="2715235">byte</span><span class="op" id="2715239">,</span>&nbsp;<span class="ident" id="2715241">mt</span><span class="op" id="2715243">.</span><span class="ident" id="2715244">size</span><span class="op" id="2715248">)</span><span class="op" id="2715249">[</span><span class="num" id="2715250">0</span><span class="op" id="2715251">]</span><span class="op" id="2715252">)</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2715256">return</span>&nbsp;<span class="ident" id="2715263">cachePut</span><span class="op" id="2715271">(</span><span class="ident" id="2715272">ckey</span><span class="op" id="2715276">,</span>&nbsp;<span class="op" id="2715278">&amp;</span><span class="ident" id="2715279">mt</span><span class="op" id="2715281">.</span><span class="ident" id="2715282">rtype</span><span class="op" id="2715287">)</span><br>
<span class="lineno"></span><span class="op" id="2715289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2715292">//&nbsp;gcProg&nbsp;is&nbsp;a&nbsp;helper&nbsp;type&nbsp;for&nbsp;generatation&nbsp;of&nbsp;GC&nbsp;pointer&nbsp;info.</span><br>
<span class="lineno">1500</span><span class="keyword" id="2715356">type</span>&nbsp;<span class="ident" id="2715361">gcProg</span>&nbsp;<span class="keyword" id="2715368">struct</span>&nbsp;<span class="op" id="2715375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715378">gc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2715383">[</span><span class="op" id="2715384">]</span><span class="builtintype" id="2715385">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715391">size</span>&nbsp;<span class="builtintype" id="2715396">uintptr</span>&nbsp;<span class="comment" id="2715404">//&nbsp;size&nbsp;of&nbsp;type&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><span class="op" id="2715429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1505</span><span class="keyword" id="2715432">func</span>&nbsp;<span class="op" id="2715437">(</span><span class="ident" id="2715438">gc</span>&nbsp;<span class="op" id="2715441">*</span><span class="ident" id="2715442">gcProg</span><span class="op" id="2715448">)</span>&nbsp;<span class="builtinfunc" id="2715450">append</span><span class="op" id="2715456">(</span><span class="ident" id="2715457">v</span>&nbsp;<span class="builtintype" id="2715459">byte</span><span class="op" id="2715463">)</span>&nbsp;<span class="op" id="2715465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715468">gc</span><span class="op" id="2715470">.</span><span class="ident" id="2715471">align</span><span class="op" id="2715476">(</span><span class="ident" id="2715477">unsafe</span><span class="op" id="2715483">.</span><span class="ident" id="2715484">Sizeof</span><span class="op" id="2715490">(</span><span class="builtintype" id="2715491">uintptr</span><span class="op" id="2715498">(</span><span class="num" id="2715499">0</span><span class="op" id="2715500">)</span><span class="op" id="2715501">)</span><span class="op" id="2715502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715505">gc</span><span class="op" id="2715507">.</span><span class="ident" id="2715508">appendWord</span><span class="op" id="2715518">(</span><span class="ident" id="2715519">v</span><span class="op" id="2715520">)</span><br>
<span class="lineno"></span><span class="op" id="2715522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1510</span><span class="comment" id="2715525">//&nbsp;Appends&nbsp;t&#39;s&nbsp;type&nbsp;info&nbsp;to&nbsp;the&nbsp;current&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2715574">func</span>&nbsp;<span class="op" id="2715579">(</span><span class="ident" id="2715580">gc</span>&nbsp;<span class="op" id="2715583">*</span><span class="ident" id="2715584">gcProg</span><span class="op" id="2715590">)</span>&nbsp;<span class="ident" id="2715592">appendProg</span><span class="op" id="2715602">(</span><span class="ident" id="2715603">t</span>&nbsp;<span class="op" id="2715605">*</span><span class="ident" id="2715606">rtype</span><span class="op" id="2715611">)</span>&nbsp;<span class="op" id="2715613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715616">gc</span><span class="op" id="2715618">.</span><span class="ident" id="2715619">align</span><span class="op" id="2715624">(</span><span class="builtintype" id="2715625">uintptr</span><span class="op" id="2715632">(</span><span class="ident" id="2715633">t</span><span class="op" id="2715634">.</span><span class="ident" id="2715635">align</span><span class="op" id="2715640">)</span><span class="op" id="2715641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2715644">if</span>&nbsp;<span class="op" id="2715647">!</span><span class="ident" id="2715648">t</span><span class="op" id="2715649">.</span><span class="ident" id="2715650">pointers</span><span class="op" id="2715658">(</span><span class="op" id="2715659">)</span>&nbsp;<span class="op" id="2715661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715665">gc</span><span class="op" id="2715667">.</span><span class="ident" id="2715668">size</span>&nbsp;<span class="op" id="2715673">+=</span>&nbsp;<span class="ident" id="2715676">t</span><span class="op" id="2715677">.</span><span class="ident" id="2715678">size</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2715685">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2715693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2715696">switch</span>&nbsp;<span class="ident" id="2715703">t</span><span class="op" id="2715704">.</span><span class="ident" id="2715705">Kind</span><span class="op" id="2715709">(</span><span class="op" id="2715710">)</span>&nbsp;<span class="op" id="2715712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2715715">default</span><span class="op" id="2715722">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2715726">panic</span><span class="op" id="2715731">(</span><span class="string" id="2715732">&#34;reflect:&nbsp;non-pointer&nbsp;type&nbsp;marked&nbsp;as&nbsp;having&nbsp;pointers&#34;</span><span class="op" id="2715785">)</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2715788">case</span>&nbsp;<span class="ident" id="2715793">Ptr</span><span class="op" id="2715796">,</span>&nbsp;<span class="ident" id="2715798">UnsafePointer</span><span class="op" id="2715811">,</span>&nbsp;<span class="ident" id="2715813">Chan</span><span class="op" id="2715817">,</span>&nbsp;<span class="ident" id="2715819">Func</span><span class="op" id="2715823">,</span>&nbsp;<span class="ident" id="2715825">Map</span><span class="op" id="2715828">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715832">gc</span><span class="op" id="2715834">.</span><span class="ident" id="2715835">appendWord</span><span class="op" id="2715845">(</span><span class="ident" id="2715846">bitsPointer</span><span class="op" id="2715857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2715860">case</span>&nbsp;<span class="ident" id="2715865">Slice</span><span class="op" id="2715870">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715874">gc</span><span class="op" id="2715876">.</span><span class="ident" id="2715877">appendWord</span><span class="op" id="2715887">(</span><span class="ident" id="2715888">bitsPointer</span><span class="op" id="2715899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715903">gc</span><span class="op" id="2715905">.</span><span class="ident" id="2715906">appendWord</span><span class="op" id="2715916">(</span><span class="ident" id="2715917">bitsScalar</span><span class="op" id="2715927">)</span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715931">gc</span><span class="op" id="2715933">.</span><span class="ident" id="2715934">appendWord</span><span class="op" id="2715944">(</span><span class="ident" id="2715945">bitsScalar</span><span class="op" id="2715955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2715958">case</span>&nbsp;<span class="ident" id="2715963">String</span><span class="op" id="2715969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715973">gc</span><span class="op" id="2715975">.</span><span class="ident" id="2715976">appendWord</span><span class="op" id="2715986">(</span><span class="ident" id="2715987">bitsPointer</span><span class="op" id="2715998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716002">gc</span><span class="op" id="2716004">.</span><span class="ident" id="2716005">appendWord</span><span class="op" id="2716015">(</span><span class="ident" id="2716016">bitsScalar</span><span class="op" id="2716026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2716029">case</span>&nbsp;<span class="ident" id="2716034">Array</span><span class="op" id="2716039">:</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716043">c</span>&nbsp;<span class="op" id="2716045">:=</span>&nbsp;<span class="ident" id="2716048">t</span><span class="op" id="2716049">.</span><span class="ident" id="2716050">Len</span><span class="op" id="2716053">(</span><span class="op" id="2716054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716058">e</span>&nbsp;<span class="op" id="2716060">:=</span>&nbsp;<span class="ident" id="2716063">t</span><span class="op" id="2716064">.</span><span class="ident" id="2716065">Elem</span><span class="op" id="2716069">(</span><span class="op" id="2716070">)</span><span class="op" id="2716071">.</span><span class="ident" id="2716072">common</span><span class="op" id="2716078">(</span><span class="op" id="2716079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2716083">for</span>&nbsp;<span class="ident" id="2716087">i</span>&nbsp;<span class="op" id="2716089">:=</span>&nbsp;<span class="num" id="2716092">0</span><span class="op" id="2716093">;</span>&nbsp;<span class="ident" id="2716095">i</span>&nbsp;<span class="op" id="2716097">&lt;</span>&nbsp;<span class="ident" id="2716099">c</span><span class="op" id="2716100">;</span>&nbsp;<span class="ident" id="2716102">i</span><span class="op" id="2716103">++</span>&nbsp;<span class="op" id="2716106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716111">gc</span><span class="op" id="2716113">.</span><span class="ident" id="2716114">appendProg</span><span class="op" id="2716124">(</span><span class="ident" id="2716125">e</span><span class="op" id="2716126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2716130">}</span><br>
<span class="lineno">1535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2716133">case</span>&nbsp;<span class="ident" id="2716138">Interface</span><span class="op" id="2716147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716151">gc</span><span class="op" id="2716153">.</span><span class="ident" id="2716154">appendWord</span><span class="op" id="2716164">(</span><span class="ident" id="2716165">bitsMultiWord</span><span class="op" id="2716178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2716182">if</span>&nbsp;<span class="ident" id="2716185">t</span><span class="op" id="2716186">.</span><span class="ident" id="2716187">NumMethod</span><span class="op" id="2716196">(</span><span class="op" id="2716197">)</span>&nbsp;<span class="op" id="2716199">==</span>&nbsp;<span class="num" id="2716202">0</span>&nbsp;<span class="op" id="2716204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716209">gc</span><span class="op" id="2716211">.</span><span class="ident" id="2716212">appendWord</span><span class="op" id="2716222">(</span><span class="ident" id="2716223">bitsEface</span><span class="op" id="2716232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2716236">}</span>&nbsp;<span class="keyword" id="2716238">else</span>&nbsp;<span class="op" id="2716243">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716248">gc</span><span class="op" id="2716250">.</span><span class="ident" id="2716251">appendWord</span><span class="op" id="2716261">(</span><span class="ident" id="2716262">bitsIface</span><span class="op" id="2716271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2716275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2716278">case</span>&nbsp;<span class="ident" id="2716283">Struct</span><span class="op" id="2716289">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716293">c</span>&nbsp;<span class="op" id="2716295">:=</span>&nbsp;<span class="ident" id="2716298">t</span><span class="op" id="2716299">.</span><span class="ident" id="2716300">NumField</span><span class="op" id="2716308">(</span><span class="op" id="2716309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2716313">for</span>&nbsp;<span class="ident" id="2716317">i</span>&nbsp;<span class="op" id="2716319">:=</span>&nbsp;<span class="num" id="2716322">0</span><span class="op" id="2716323">;</span>&nbsp;<span class="ident" id="2716325">i</span>&nbsp;<span class="op" id="2716327">&lt;</span>&nbsp;<span class="ident" id="2716329">c</span><span class="op" id="2716330">;</span>&nbsp;<span class="ident" id="2716332">i</span><span class="op" id="2716333">++</span>&nbsp;<span class="op" id="2716336">{</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716341">gc</span><span class="op" id="2716343">.</span><span class="ident" id="2716344">appendProg</span><span class="op" id="2716354">(</span><span class="ident" id="2716355">t</span><span class="op" id="2716356">.</span><span class="ident" id="2716357">Field</span><span class="op" id="2716362">(</span><span class="ident" id="2716363">i</span><span class="op" id="2716364">)</span><span class="op" id="2716365">.</span><span class="ident" id="2716366">Type</span><span class="op" id="2716370">.</span><span class="ident" id="2716371">common</span><span class="op" id="2716377">(</span><span class="op" id="2716378">)</span><span class="op" id="2716379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2716383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716387">gc</span><span class="op" id="2716389">.</span><span class="ident" id="2716390">align</span><span class="op" id="2716395">(</span><span class="builtintype" id="2716396">uintptr</span><span class="op" id="2716403">(</span><span class="ident" id="2716404">t</span><span class="op" id="2716405">.</span><span class="ident" id="2716406">align</span><span class="op" id="2716411">)</span><span class="op" id="2716412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2716415">}</span><br>
<span class="lineno"></span><span class="op" id="2716417">}</span><br>
<span class="lineno">1550</span><br>
<span class="lineno"></span><span class="keyword" id="2716420">func</span>&nbsp;<span class="op" id="2716425">(</span><span class="ident" id="2716426">gc</span>&nbsp;<span class="op" id="2716429">*</span><span class="ident" id="2716430">gcProg</span><span class="op" id="2716436">)</span>&nbsp;<span class="ident" id="2716438">appendWord</span><span class="op" id="2716448">(</span><span class="ident" id="2716449">v</span>&nbsp;<span class="builtintype" id="2716451">byte</span><span class="op" id="2716455">)</span>&nbsp;<span class="op" id="2716457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716460">ptrsize</span>&nbsp;<span class="op" id="2716468">:=</span>&nbsp;<span class="ident" id="2716471">unsafe</span><span class="op" id="2716477">.</span><span class="ident" id="2716478">Sizeof</span><span class="op" id="2716484">(</span><span class="builtintype" id="2716485">uintptr</span><span class="op" id="2716492">(</span><span class="num" id="2716493">0</span><span class="op" id="2716494">)</span><span class="op" id="2716495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2716498">if</span>&nbsp;<span class="ident" id="2716501">gc</span><span class="op" id="2716503">.</span><span class="ident" id="2716504">size</span><span class="op" id="2716508">%</span><span class="ident" id="2716509">ptrsize</span>&nbsp;<span class="op" id="2716517">!=</span>&nbsp;<span class="num" id="2716520">0</span>&nbsp;<span class="op" id="2716522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2716526">panic</span><span class="op" id="2716531">(</span><span class="string" id="2716532">&#34;reflect:&nbsp;unaligned&nbsp;GC&nbsp;program&#34;</span><span class="op" id="2716563">)</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2716566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716569">nptr</span>&nbsp;<span class="op" id="2716574">:=</span>&nbsp;<span class="ident" id="2716577">gc</span><span class="op" id="2716579">.</span><span class="ident" id="2716580">size</span>&nbsp;<span class="op" id="2716585">/</span>&nbsp;<span class="ident" id="2716587">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2716596">for</span>&nbsp;<span class="builtintype" id="2716600">uintptr</span><span class="op" id="2716607">(</span><span class="builtinfunc" id="2716608">len</span><span class="op" id="2716611">(</span><span class="ident" id="2716612">gc</span><span class="op" id="2716614">.</span><span class="ident" id="2716615">gc</span><span class="op" id="2716617">)</span><span class="op" id="2716618">)</span>&nbsp;<span class="op" id="2716620">&lt;</span>&nbsp;<span class="ident" id="2716622">nptr</span><span class="op" id="2716626">/</span><span class="num" id="2716627">2</span><span class="op" id="2716628">+</span><span class="num" id="2716629">1</span>&nbsp;<span class="op" id="2716631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716635">gc</span><span class="op" id="2716637">.</span><span class="ident" id="2716638">gc</span>&nbsp;<span class="op" id="2716641">=</span>&nbsp;<span class="builtinfunc" id="2716643">append</span><span class="op" id="2716649">(</span><span class="ident" id="2716650">gc</span><span class="op" id="2716652">.</span><span class="ident" id="2716653">gc</span><span class="op" id="2716655">,</span>&nbsp;<span class="num" id="2716657">0x44</span><span class="op" id="2716661">)</span>&nbsp;<span class="comment" id="2716663">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2716678">}</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716681">gc</span><span class="op" id="2716683">.</span><span class="ident" id="2716684">gc</span><span class="op" id="2716686">[</span><span class="ident" id="2716687">nptr</span><span class="op" id="2716691">/</span><span class="num" id="2716692">2</span><span class="op" id="2716693">]</span>&nbsp;<span class="op" id="2716695">&amp;=</span>&nbsp;<span class="op" id="2716698">^</span><span class="op" id="2716699">(</span><span class="num" id="2716700">3</span>&nbsp;<span class="op" id="2716702">&lt;&lt;</span>&nbsp;<span class="op" id="2716705">(</span><span class="op" id="2716706">(</span><span class="ident" id="2716707">nptr</span><span class="op" id="2716711">%</span><span class="num" id="2716712">2</span><span class="op" id="2716713">)</span><span class="op" id="2716714">*</span><span class="num" id="2716715">4</span>&nbsp;<span class="op" id="2716717">+</span>&nbsp;<span class="num" id="2716719">2</span><span class="op" id="2716720">)</span><span class="op" id="2716721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716724">gc</span><span class="op" id="2716726">.</span><span class="ident" id="2716727">gc</span><span class="op" id="2716729">[</span><span class="ident" id="2716730">nptr</span><span class="op" id="2716734">/</span><span class="num" id="2716735">2</span><span class="op" id="2716736">]</span>&nbsp;<span class="op" id="2716738">|=</span>&nbsp;<span class="ident" id="2716741">v</span>&nbsp;<span class="op" id="2716743">&lt;&lt;</span>&nbsp;<span class="op" id="2716746">(</span><span class="op" id="2716747">(</span><span class="ident" id="2716748">nptr</span><span class="op" id="2716752">%</span><span class="num" id="2716753">2</span><span class="op" id="2716754">)</span><span class="op" id="2716755">*</span><span class="num" id="2716756">4</span>&nbsp;<span class="op" id="2716758">+</span>&nbsp;<span class="num" id="2716760">2</span><span class="op" id="2716761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716764">gc</span><span class="op" id="2716766">.</span><span class="ident" id="2716767">size</span>&nbsp;<span class="op" id="2716772">+=</span>&nbsp;<span class="ident" id="2716775">ptrsize</span><br>
<span class="lineno"></span><span class="op" id="2716783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="keyword" id="2716786">func</span>&nbsp;<span class="op" id="2716791">(</span><span class="ident" id="2716792">gc</span>&nbsp;<span class="op" id="2716795">*</span><span class="ident" id="2716796">gcProg</span><span class="op" id="2716802">)</span>&nbsp;<span class="ident" id="2716804">finalize</span><span class="op" id="2716812">(</span><span class="op" id="2716813">)</span>&nbsp;<span class="ident" id="2716815">unsafe</span><span class="op" id="2716821">.</span><span class="ident" id="2716822">Pointer</span>&nbsp;<span class="op" id="2716830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2716833">if</span>&nbsp;<span class="ident" id="2716836">gc</span><span class="op" id="2716838">.</span><span class="ident" id="2716839">size</span>&nbsp;<span class="op" id="2716844">==</span>&nbsp;<span class="num" id="2716847">0</span>&nbsp;<span class="op" id="2716849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2716853">return</span>&nbsp;<span class="builtintype" id="2716860">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2716865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716868">ptrsize</span>&nbsp;<span class="op" id="2716876">:=</span>&nbsp;<span class="ident" id="2716879">unsafe</span><span class="op" id="2716885">.</span><span class="ident" id="2716886">Sizeof</span><span class="op" id="2716892">(</span><span class="builtintype" id="2716893">uintptr</span><span class="op" id="2716900">(</span><span class="num" id="2716901">0</span><span class="op" id="2716902">)</span><span class="op" id="2716903">)</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716906">gc</span><span class="op" id="2716908">.</span><span class="ident" id="2716909">align</span><span class="op" id="2716914">(</span><span class="ident" id="2716915">ptrsize</span><span class="op" id="2716922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716925">nptr</span>&nbsp;<span class="op" id="2716930">:=</span>&nbsp;<span class="ident" id="2716933">gc</span><span class="op" id="2716935">.</span><span class="ident" id="2716936">size</span>&nbsp;<span class="op" id="2716941">/</span>&nbsp;<span class="ident" id="2716943">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2716952">for</span>&nbsp;<span class="builtintype" id="2716956">uintptr</span><span class="op" id="2716963">(</span><span class="builtinfunc" id="2716964">len</span><span class="op" id="2716967">(</span><span class="ident" id="2716968">gc</span><span class="op" id="2716970">.</span><span class="ident" id="2716971">gc</span><span class="op" id="2716973">)</span><span class="op" id="2716974">)</span>&nbsp;<span class="op" id="2716976">&lt;</span>&nbsp;<span class="ident" id="2716978">nptr</span><span class="op" id="2716982">/</span><span class="num" id="2716983">2</span><span class="op" id="2716984">+</span><span class="num" id="2716985">1</span>&nbsp;<span class="op" id="2716987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2716991">gc</span><span class="op" id="2716993">.</span><span class="ident" id="2716994">gc</span>&nbsp;<span class="op" id="2716997">=</span>&nbsp;<span class="builtinfunc" id="2716999">append</span><span class="op" id="2717005">(</span><span class="ident" id="2717006">gc</span><span class="op" id="2717008">.</span><span class="ident" id="2717009">gc</span><span class="op" id="2717011">,</span>&nbsp;<span class="num" id="2717013">0x44</span><span class="op" id="2717017">)</span>&nbsp;<span class="comment" id="2717019">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2717034">}</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2717037">//&nbsp;If&nbsp;number&nbsp;of&nbsp;words&nbsp;is&nbsp;odd,&nbsp;repeat&nbsp;the&nbsp;mask&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2717091">//&nbsp;Compiler&nbsp;does&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2717119">if</span>&nbsp;<span class="ident" id="2717122">nptr</span><span class="op" id="2717126">%</span><span class="num" id="2717127">2</span>&nbsp;<span class="op" id="2717129">!=</span>&nbsp;<span class="num" id="2717132">0</span>&nbsp;<span class="op" id="2717134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2717138">for</span>&nbsp;<span class="ident" id="2717142">i</span>&nbsp;<span class="op" id="2717144">:=</span>&nbsp;<span class="builtintype" id="2717147">uintptr</span><span class="op" id="2717154">(</span><span class="num" id="2717155">0</span><span class="op" id="2717156">)</span><span class="op" id="2717157">;</span>&nbsp;<span class="ident" id="2717159">i</span>&nbsp;<span class="op" id="2717161">&lt;</span>&nbsp;<span class="ident" id="2717163">nptr</span><span class="op" id="2717167">;</span>&nbsp;<span class="ident" id="2717169">i</span><span class="op" id="2717170">++</span>&nbsp;<span class="op" id="2717173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2717178">gc</span><span class="op" id="2717180">.</span><span class="ident" id="2717181">appendWord</span><span class="op" id="2717191">(</span><span class="ident" id="2717192">extractGCWord</span><span class="op" id="2717205">(</span><span class="ident" id="2717206">gc</span><span class="op" id="2717208">.</span><span class="ident" id="2717209">gc</span><span class="op" id="2717211">,</span>&nbsp;<span class="ident" id="2717213">i</span><span class="op" id="2717214">)</span><span class="op" id="2717215">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2717219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2717222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2717225">return</span>&nbsp;<span class="ident" id="2717232">unsafe</span><span class="op" id="2717238">.</span><span class="ident" id="2717239">Pointer</span><span class="op" id="2717246">(</span><span class="op" id="2717247">&amp;</span><span class="ident" id="2717248">gc</span><span class="op" id="2717250">.</span><span class="ident" id="2717251">gc</span><span class="op" id="2717253">[</span><span class="num" id="2717254">0</span><span class="op" id="2717255">]</span><span class="op" id="2717256">)</span><br>
<span class="lineno"></span><span class="op" id="2717258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span><span class="keyword" id="2717261">func</span>&nbsp;<span class="ident" id="2717266">extractGCWord</span><span class="op" id="2717279">(</span><span class="ident" id="2717280">gc</span>&nbsp;<span class="op" id="2717283">[</span><span class="op" id="2717284">]</span><span class="builtintype" id="2717285">byte</span><span class="op" id="2717289">,</span>&nbsp;<span class="ident" id="2717291">i</span>&nbsp;<span class="builtintype" id="2717293">uintptr</span><span class="op" id="2717300">)</span>&nbsp;<span class="builtintype" id="2717302">byte</span>&nbsp;<span class="op" id="2717307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2717310">return</span>&nbsp;<span class="op" id="2717317">(</span><span class="ident" id="2717318">gc</span><span class="op" id="2717320">[</span><span class="ident" id="2717321">i</span><span class="op" id="2717322">/</span><span class="num" id="2717323">2</span><span class="op" id="2717324">]</span>&nbsp;<span class="op" id="2717326">&gt;&gt;</span>&nbsp;<span class="op" id="2717329">(</span><span class="op" id="2717330">(</span><span class="ident" id="2717331">i</span><span class="op" id="2717332">%</span><span class="num" id="2717333">2</span><span class="op" id="2717334">)</span><span class="op" id="2717335">*</span><span class="num" id="2717336">4</span>&nbsp;<span class="op" id="2717338">+</span>&nbsp;<span class="num" id="2717340">2</span><span class="op" id="2717341">)</span><span class="op" id="2717342">)</span>&nbsp;<span class="op" id="2717344">&amp;</span>&nbsp;<span class="num" id="2717346">3</span><br>
<span class="lineno"></span><span class="op" id="2717348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2717351">func</span>&nbsp;<span class="op" id="2717356">(</span><span class="ident" id="2717357">gc</span>&nbsp;<span class="op" id="2717360">*</span><span class="ident" id="2717361">gcProg</span><span class="op" id="2717367">)</span>&nbsp;<span class="ident" id="2717369">align</span><span class="op" id="2717374">(</span><span class="ident" id="2717375">a</span>&nbsp;<span class="builtintype" id="2717377">uintptr</span><span class="op" id="2717384">)</span>&nbsp;<span class="op" id="2717386">{</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2717389">gc</span><span class="op" id="2717391">.</span><span class="ident" id="2717392">size</span>&nbsp;<span class="op" id="2717397">=</span>&nbsp;<span class="ident" id="2717399">align</span><span class="op" id="2717404">(</span><span class="ident" id="2717405">gc</span><span class="op" id="2717407">.</span><span class="ident" id="2717408">size</span><span class="op" id="2717412">,</span>&nbsp;<span class="ident" id="2717414">a</span><span class="op" id="2717415">)</span><br>
<span class="lineno"></span><span class="op" id="2717417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2717420">//&nbsp;These&nbsp;constants&nbsp;must&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/mgc0.h.</span><br>
<span class="lineno"></span><span class="keyword" id="2717481">const</span>&nbsp;<span class="op" id="2717487">(</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2717490">bitsScalar</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2717504">=</span>&nbsp;<span class="num" id="2717506">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2717509">bitsPointer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2717523">=</span>&nbsp;<span class="num" id="2717525">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2717528">bitsMultiWord</span>&nbsp;<span class="op" id="2717542">=</span>&nbsp;<span class="num" id="2717544">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2717548">bitsIface</span>&nbsp;<span class="op" id="2717558">=</span>&nbsp;<span class="num" id="2717560">2</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2717563">bitsEface</span>&nbsp;<span class="op" id="2717573">=</span>&nbsp;<span class="num" id="2717575">3</span><br>
<span class="lineno"></span><span class="op" id="2717577">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2717580">//&nbsp;Make&nbsp;sure&nbsp;these&nbsp;routines&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../../runtime/hashmap.go!</span><br>
<span class="lineno"></span><span class="comment" id="2717652">//&nbsp;These&nbsp;types&nbsp;exist&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno">1605</span><span class="comment" id="2717724">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2717799">//&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2717830">const</span>&nbsp;<span class="op" id="2717836">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2717839">bucketSize</span>&nbsp;<span class="op" id="2717850">=</span>&nbsp;<span class="num" id="2717852">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2717855">maxKeySize</span>&nbsp;<span class="op" id="2717866">=</span>&nbsp;<span class="num" id="2717868">128</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2717873">maxValSize</span>&nbsp;<span class="op" id="2717884">=</span>&nbsp;<span class="num" id="2717886">128</span><br>
<span class="lineno"></span><span class="op" id="2717890">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2717893">func</span>&nbsp;<span class="ident" id="2717898">bucketOf</span><span class="op" id="2717906">(</span><span class="ident" id="2717907">ktyp</span><span class="op" id="2717911">,</span>&nbsp;<span class="ident" id="2717913">etyp</span>&nbsp;<span class="op" id="2717918">*</span><span class="ident" id="2717919">rtype</span><span class="op" id="2717924">)</span>&nbsp;<span class="op" id="2717926">*</span><span class="ident" id="2717927">rtype</span>&nbsp;<span class="op" id="2717933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2717936">if</span>&nbsp;<span class="ident" id="2717939">ktyp</span><span class="op" id="2717943">.</span><span class="ident" id="2717944">size</span>&nbsp;<span class="op" id="2717949">&gt;</span>&nbsp;<span class="ident" id="2717951">maxKeySize</span>&nbsp;<span class="op" id="2717962">{</span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2717966">ktyp</span>&nbsp;<span class="op" id="2717971">=</span>&nbsp;<span class="ident" id="2717973">PtrTo</span><span class="op" id="2717978">(</span><span class="ident" id="2717979">ktyp</span><span class="op" id="2717983">)</span><span class="op" id="2717984">.</span><span class="op" id="2717985">(</span><span class="op" id="2717986">*</span><span class="ident" id="2717987">rtype</span><span class="op" id="2717992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2717995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2717998">if</span>&nbsp;<span class="ident" id="2718001">etyp</span><span class="op" id="2718005">.</span><span class="ident" id="2718006">size</span>&nbsp;<span class="op" id="2718011">&gt;</span>&nbsp;<span class="ident" id="2718013">maxValSize</span>&nbsp;<span class="op" id="2718024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718028">etyp</span>&nbsp;<span class="op" id="2718033">=</span>&nbsp;<span class="ident" id="2718035">PtrTo</span><span class="op" id="2718040">(</span><span class="ident" id="2718041">etyp</span><span class="op" id="2718045">)</span><span class="op" id="2718046">.</span><span class="op" id="2718047">(</span><span class="op" id="2718048">*</span><span class="ident" id="2718049">rtype</span><span class="op" id="2718054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2718057">}</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718060">ptrsize</span>&nbsp;<span class="op" id="2718068">:=</span>&nbsp;<span class="ident" id="2718071">unsafe</span><span class="op" id="2718077">.</span><span class="ident" id="2718078">Sizeof</span><span class="op" id="2718084">(</span><span class="builtintype" id="2718085">uintptr</span><span class="op" id="2718092">(</span><span class="num" id="2718093">0</span><span class="op" id="2718094">)</span><span class="op" id="2718095">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2718099">var</span>&nbsp;<span class="ident" id="2718103">gc</span>&nbsp;<span class="ident" id="2718106">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2718114">//&nbsp;topbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2718126">for</span>&nbsp;<span class="ident" id="2718130">i</span>&nbsp;<span class="op" id="2718132">:=</span>&nbsp;<span class="num" id="2718135">0</span><span class="op" id="2718136">;</span>&nbsp;<span class="ident" id="2718138">i</span>&nbsp;<span class="op" id="2718140">&lt;</span>&nbsp;<span class="builtintype" id="2718142">int</span><span class="op" id="2718145">(</span><span class="ident" id="2718146">bucketSize</span><span class="op" id="2718156">*</span><span class="ident" id="2718157">unsafe</span><span class="op" id="2718163">.</span><span class="ident" id="2718164">Sizeof</span><span class="op" id="2718170">(</span><span class="builtintype" id="2718171">uint8</span><span class="op" id="2718176">(</span><span class="num" id="2718177">0</span><span class="op" id="2718178">)</span><span class="op" id="2718179">)</span><span class="op" id="2718180">/</span><span class="ident" id="2718181">ptrsize</span><span class="op" id="2718188">)</span><span class="op" id="2718189">;</span>&nbsp;<span class="ident" id="2718191">i</span><span class="op" id="2718192">++</span>&nbsp;<span class="op" id="2718195">{</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718199">gc</span><span class="op" id="2718201">.</span><span class="builtinfunc" id="2718202">append</span><span class="op" id="2718208">(</span><span class="ident" id="2718209">bitsScalar</span><span class="op" id="2718219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2718222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718225">gc</span><span class="op" id="2718227">.</span><span class="builtinfunc" id="2718228">append</span><span class="op" id="2718234">(</span><span class="ident" id="2718235">bitsPointer</span><span class="op" id="2718246">)</span>&nbsp;<span class="comment" id="2718248">//&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2718261">if</span>&nbsp;<span class="ident" id="2718264">runtime</span><span class="op" id="2718271">.</span><span class="ident" id="2718272">GOARCH</span>&nbsp;<span class="op" id="2718279">==</span>&nbsp;<span class="string" id="2718282">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2718293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718297">gc</span><span class="op" id="2718299">.</span><span class="builtinfunc" id="2718300">append</span><span class="op" id="2718306">(</span><span class="ident" id="2718307">bitsScalar</span><span class="op" id="2718317">)</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2718320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2718323">//&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2718332">for</span>&nbsp;<span class="ident" id="2718336">i</span>&nbsp;<span class="op" id="2718338">:=</span>&nbsp;<span class="num" id="2718341">0</span><span class="op" id="2718342">;</span>&nbsp;<span class="ident" id="2718344">i</span>&nbsp;<span class="op" id="2718346">&lt;</span>&nbsp;<span class="ident" id="2718348">bucketSize</span><span class="op" id="2718358">;</span>&nbsp;<span class="ident" id="2718360">i</span><span class="op" id="2718361">++</span>&nbsp;<span class="op" id="2718364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718368">gc</span><span class="op" id="2718370">.</span><span class="ident" id="2718371">appendProg</span><span class="op" id="2718381">(</span><span class="ident" id="2718382">ktyp</span><span class="op" id="2718386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2718389">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2718392">//&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2718403">for</span>&nbsp;<span class="ident" id="2718407">i</span>&nbsp;<span class="op" id="2718409">:=</span>&nbsp;<span class="num" id="2718412">0</span><span class="op" id="2718413">;</span>&nbsp;<span class="ident" id="2718415">i</span>&nbsp;<span class="op" id="2718417">&lt;</span>&nbsp;<span class="ident" id="2718419">bucketSize</span><span class="op" id="2718429">;</span>&nbsp;<span class="ident" id="2718431">i</span><span class="op" id="2718432">++</span>&nbsp;<span class="op" id="2718435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718439">gc</span><span class="op" id="2718441">.</span><span class="ident" id="2718442">appendProg</span><span class="op" id="2718452">(</span><span class="ident" id="2718453">etyp</span><span class="op" id="2718457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2718460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718464">b</span>&nbsp;<span class="op" id="2718466">:=</span>&nbsp;<span class="builtinfunc" id="2718469">new</span><span class="op" id="2718472">(</span><span class="ident" id="2718473">rtype</span><span class="op" id="2718478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718481">b</span><span class="op" id="2718482">.</span><span class="ident" id="2718483">size</span>&nbsp;<span class="op" id="2718488">=</span>&nbsp;<span class="ident" id="2718490">gc</span><span class="op" id="2718492">.</span><span class="ident" id="2718493">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718499">b</span><span class="op" id="2718500">.</span><span class="ident" id="2718501">gc</span><span class="op" id="2718503">[</span><span class="num" id="2718504">0</span><span class="op" id="2718505">]</span>&nbsp;<span class="op" id="2718507">=</span>&nbsp;<span class="ident" id="2718509">gc</span><span class="op" id="2718511">.</span><span class="ident" id="2718512">finalize</span><span class="op" id="2718520">(</span><span class="op" id="2718521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718524">s</span>&nbsp;<span class="op" id="2718526">:=</span>&nbsp;<span class="string" id="2718529">&#34;bucket(&#34;</span>&nbsp;<span class="op" id="2718539">+</span>&nbsp;<span class="op" id="2718541">*</span><span class="ident" id="2718542">ktyp</span><span class="op" id="2718546">.</span><span class="builtintype" id="2718547">string</span>&nbsp;<span class="op" id="2718554">+</span>&nbsp;<span class="string" id="2718556">&#34;,&#34;</span>&nbsp;<span class="op" id="2718560">+</span>&nbsp;<span class="op" id="2718562">*</span><span class="ident" id="2718563">etyp</span><span class="op" id="2718567">.</span><span class="builtintype" id="2718568">string</span>&nbsp;<span class="op" id="2718575">+</span>&nbsp;<span class="string" id="2718577">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718582">b</span><span class="op" id="2718583">.</span><span class="builtintype" id="2718584">string</span>&nbsp;<span class="op" id="2718591">=</span>&nbsp;<span class="op" id="2718593">&amp;</span><span class="ident" id="2718594">s</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2718597">return</span>&nbsp;<span class="ident" id="2718604">b</span><br>
<span class="lineno"></span><span class="op" id="2718606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2718609">//&nbsp;SliceOf&nbsp;returns&nbsp;the&nbsp;slice&nbsp;type&nbsp;with&nbsp;element&nbsp;type&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2718664">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;SliceOf(t)&nbsp;represents&nbsp;[]int.</span><br>
<span class="lineno">1650</span><span class="keyword" id="2718730">func</span>&nbsp;<span class="ident" id="2718735">SliceOf</span><span class="op" id="2718742">(</span><span class="ident" id="2718743">t</span>&nbsp;<span class="ident" id="2718745">Type</span><span class="op" id="2718749">)</span>&nbsp;<span class="ident" id="2718751">Type</span>&nbsp;<span class="op" id="2718756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718759">typ</span>&nbsp;<span class="op" id="2718763">:=</span>&nbsp;<span class="ident" id="2718766">t</span><span class="op" id="2718767">.</span><span class="op" id="2718768">(</span><span class="op" id="2718769">*</span><span class="ident" id="2718770">rtype</span><span class="op" id="2718775">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2718779">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718798">ckey</span>&nbsp;<span class="op" id="2718803">:=</span>&nbsp;<span class="ident" id="2718806">cacheKey</span><span class="op" id="2718814">{</span><span class="ident" id="2718815">Slice</span><span class="op" id="2718820">,</span>&nbsp;<span class="ident" id="2718822">typ</span><span class="op" id="2718825">,</span>&nbsp;<span class="builtintype" id="2718827">nil</span><span class="op" id="2718830">,</span>&nbsp;<span class="num" id="2718832">0</span><span class="op" id="2718833">}</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2718836">if</span>&nbsp;<span class="ident" id="2718839">slice</span>&nbsp;<span class="op" id="2718845">:=</span>&nbsp;<span class="ident" id="2718848">cacheGet</span><span class="op" id="2718856">(</span><span class="ident" id="2718857">ckey</span><span class="op" id="2718861">)</span><span class="op" id="2718862">;</span>&nbsp;<span class="ident" id="2718864">slice</span>&nbsp;<span class="op" id="2718870">!=</span>&nbsp;<span class="builtintype" id="2718873">nil</span>&nbsp;<span class="op" id="2718877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2718881">return</span>&nbsp;<span class="ident" id="2718888">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2718895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2718899">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718924">s</span>&nbsp;<span class="op" id="2718926">:=</span>&nbsp;<span class="string" id="2718929">&#34;[]&#34;</span>&nbsp;<span class="op" id="2718934">+</span>&nbsp;<span class="op" id="2718936">*</span><span class="ident" id="2718937">typ</span><span class="op" id="2718940">.</span><span class="builtintype" id="2718941">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2718949">for</span>&nbsp;<span class="ident" id="2718953">_</span><span class="op" id="2718954">,</span>&nbsp;<span class="ident" id="2718956">tt</span>&nbsp;<span class="op" id="2718959">:=</span>&nbsp;<span class="keyword" id="2718962">range</span>&nbsp;<span class="ident" id="2718968">typesByString</span><span class="op" id="2718981">(</span><span class="ident" id="2718982">s</span><span class="op" id="2718983">)</span>&nbsp;<span class="op" id="2718985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718989">slice</span>&nbsp;<span class="op" id="2718995">:=</span>&nbsp;<span class="op" id="2718998">(</span><span class="op" id="2718999">*</span><span class="ident" id="2719000">sliceType</span><span class="op" id="2719009">)</span><span class="op" id="2719010">(</span><span class="ident" id="2719011">unsafe</span><span class="op" id="2719017">.</span><span class="ident" id="2719018">Pointer</span><span class="op" id="2719025">(</span><span class="ident" id="2719026">tt</span><span class="op" id="2719028">)</span><span class="op" id="2719029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2719033">if</span>&nbsp;<span class="ident" id="2719036">slice</span><span class="op" id="2719041">.</span><span class="ident" id="2719042">elem</span>&nbsp;<span class="op" id="2719047">==</span>&nbsp;<span class="ident" id="2719050">typ</span>&nbsp;<span class="op" id="2719054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2719059">return</span>&nbsp;<span class="ident" id="2719066">cachePut</span><span class="op" id="2719074">(</span><span class="ident" id="2719075">ckey</span><span class="op" id="2719079">,</span>&nbsp;<span class="ident" id="2719081">tt</span><span class="op" id="2719083">)</span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2719087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2719090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2719094">//&nbsp;Make&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2719117">var</span>&nbsp;<span class="ident" id="2719121">islice</span>&nbsp;<span class="keyword" id="2719128">interface</span><span class="op" id="2719137">{</span><span class="op" id="2719138">}</span>&nbsp;<span class="op" id="2719140">=</span>&nbsp;<span class="op" id="2719142">(</span><span class="op" id="2719143">[</span><span class="op" id="2719144">]</span><span class="ident" id="2719145">unsafe</span><span class="op" id="2719151">.</span><span class="ident" id="2719152">Pointer</span><span class="op" id="2719159">)</span><span class="op" id="2719160">(</span><span class="builtintype" id="2719161">nil</span><span class="op" id="2719164">)</span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719167">prototype</span>&nbsp;<span class="op" id="2719177">:=</span>&nbsp;<span class="op" id="2719180">*</span><span class="op" id="2719181">(</span><span class="op" id="2719182">*</span><span class="op" id="2719183">*</span><span class="ident" id="2719184">sliceType</span><span class="op" id="2719193">)</span><span class="op" id="2719194">(</span><span class="ident" id="2719195">unsafe</span><span class="op" id="2719201">.</span><span class="ident" id="2719202">Pointer</span><span class="op" id="2719209">(</span><span class="op" id="2719210">&amp;</span><span class="ident" id="2719211">islice</span><span class="op" id="2719217">)</span><span class="op" id="2719218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719221">slice</span>&nbsp;<span class="op" id="2719227">:=</span>&nbsp;<span class="builtinfunc" id="2719230">new</span><span class="op" id="2719233">(</span><span class="ident" id="2719234">sliceType</span><span class="op" id="2719243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2719246">*</span><span class="ident" id="2719247">slice</span>&nbsp;<span class="op" id="2719253">=</span>&nbsp;<span class="op" id="2719255">*</span><span class="ident" id="2719256">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719267">slice</span><span class="op" id="2719272">.</span><span class="builtintype" id="2719273">string</span>&nbsp;<span class="op" id="2719280">=</span>&nbsp;<span class="op" id="2719282">&amp;</span><span class="ident" id="2719283">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719286">slice</span><span class="op" id="2719291">.</span><span class="ident" id="2719292">hash</span>&nbsp;<span class="op" id="2719297">=</span>&nbsp;<span class="ident" id="2719299">fnv1</span><span class="op" id="2719303">(</span><span class="ident" id="2719304">typ</span><span class="op" id="2719307">.</span><span class="ident" id="2719308">hash</span><span class="op" id="2719312">,</span>&nbsp;<span class="string" id="2719314">&#39;[&#39;</span><span class="op" id="2719317">)</span><br>
<span class="lineno">1675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719320">slice</span><span class="op" id="2719325">.</span><span class="ident" id="2719326">elem</span>&nbsp;<span class="op" id="2719331">=</span>&nbsp;<span class="ident" id="2719333">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719338">slice</span><span class="op" id="2719343">.</span><span class="ident" id="2719344">uncommonType</span>&nbsp;<span class="op" id="2719357">=</span>&nbsp;<span class="builtintype" id="2719359">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719364">slice</span><span class="op" id="2719369">.</span><span class="ident" id="2719370">ptrToThis</span>&nbsp;<span class="op" id="2719380">=</span>&nbsp;<span class="builtintype" id="2719382">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719387">slice</span><span class="op" id="2719392">.</span><span class="ident" id="2719393">zero</span>&nbsp;<span class="op" id="2719398">=</span>&nbsp;<span class="ident" id="2719400">unsafe</span><span class="op" id="2719406">.</span><span class="ident" id="2719407">Pointer</span><span class="op" id="2719414">(</span><span class="op" id="2719415">&amp;</span><span class="builtinfunc" id="2719416">make</span><span class="op" id="2719420">(</span><span class="op" id="2719421">[</span><span class="op" id="2719422">]</span><span class="builtintype" id="2719423">byte</span><span class="op" id="2719427">,</span>&nbsp;<span class="ident" id="2719429">slice</span><span class="op" id="2719434">.</span><span class="ident" id="2719435">size</span><span class="op" id="2719439">)</span><span class="op" id="2719440">[</span><span class="num" id="2719441">0</span><span class="op" id="2719442">]</span><span class="op" id="2719443">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2719447">return</span>&nbsp;<span class="ident" id="2719454">cachePut</span><span class="op" id="2719462">(</span><span class="ident" id="2719463">ckey</span><span class="op" id="2719467">,</span>&nbsp;<span class="op" id="2719469">&amp;</span><span class="ident" id="2719470">slice</span><span class="op" id="2719475">.</span><span class="ident" id="2719476">rtype</span><span class="op" id="2719481">)</span><br>
<span class="lineno"></span><span class="op" id="2719483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2719486">//&nbsp;ArrayOf&nbsp;returns&nbsp;the&nbsp;array&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;count&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2719559">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ArrayOf(5,&nbsp;t)&nbsp;represents&nbsp;[5]int.</span><br>
<span class="lineno">1685</span><span class="comment" id="2719629">//</span><br>
<span class="lineno"></span><span class="comment" id="2719632">//&nbsp;If&nbsp;the&nbsp;resulting&nbsp;type&nbsp;would&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;available&nbsp;address&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="2719707">//&nbsp;ArrayOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2719726">//</span><br>
<span class="lineno"></span><span class="comment" id="2719729">//&nbsp;TODO(rsc):&nbsp;Unexported&nbsp;for&nbsp;now.&nbsp;Export&nbsp;once&nbsp;the&nbsp;alg&nbsp;field&nbsp;is&nbsp;set&nbsp;correctly</span><br>
<span class="lineno">1690</span><span class="comment" id="2719806">//&nbsp;for&nbsp;the&nbsp;type.&nbsp;This&nbsp;may&nbsp;require&nbsp;significant&nbsp;work.</span><br>
<span class="lineno"></span><span class="comment" id="2719858">//</span><br>
<span class="lineno"></span><span class="comment" id="2719861">//&nbsp;TODO(rsc):&nbsp;TestArrayOf&nbsp;is&nbsp;also&nbsp;disabled.&nbsp;Re-enable.</span><br>
<span class="lineno"></span><span class="keyword" id="2719916">func</span>&nbsp;<span class="ident" id="2719921">arrayOf</span><span class="op" id="2719928">(</span><span class="ident" id="2719929">count</span>&nbsp;<span class="builtintype" id="2719935">int</span><span class="op" id="2719938">,</span>&nbsp;<span class="ident" id="2719940">elem</span>&nbsp;<span class="ident" id="2719945">Type</span><span class="op" id="2719949">)</span>&nbsp;<span class="ident" id="2719951">Type</span>&nbsp;<span class="op" id="2719956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719959">typ</span>&nbsp;<span class="op" id="2719963">:=</span>&nbsp;<span class="ident" id="2719966">elem</span><span class="op" id="2719970">.</span><span class="op" id="2719971">(</span><span class="op" id="2719972">*</span><span class="ident" id="2719973">rtype</span><span class="op" id="2719978">)</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719981">slice</span>&nbsp;<span class="op" id="2719987">:=</span>&nbsp;<span class="ident" id="2719990">SliceOf</span><span class="op" id="2719997">(</span><span class="ident" id="2719998">elem</span><span class="op" id="2720002">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2720006">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720025">ckey</span>&nbsp;<span class="op" id="2720030">:=</span>&nbsp;<span class="ident" id="2720033">cacheKey</span><span class="op" id="2720041">{</span><span class="ident" id="2720042">Array</span><span class="op" id="2720047">,</span>&nbsp;<span class="ident" id="2720049">typ</span><span class="op" id="2720052">,</span>&nbsp;<span class="builtintype" id="2720054">nil</span><span class="op" id="2720057">,</span>&nbsp;<span class="builtintype" id="2720059">uintptr</span><span class="op" id="2720066">(</span><span class="ident" id="2720067">count</span><span class="op" id="2720072">)</span><span class="op" id="2720073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2720076">if</span>&nbsp;<span class="ident" id="2720079">slice</span>&nbsp;<span class="op" id="2720085">:=</span>&nbsp;<span class="ident" id="2720088">cacheGet</span><span class="op" id="2720096">(</span><span class="ident" id="2720097">ckey</span><span class="op" id="2720101">)</span><span class="op" id="2720102">;</span>&nbsp;<span class="ident" id="2720104">slice</span>&nbsp;<span class="op" id="2720110">!=</span>&nbsp;<span class="builtintype" id="2720113">nil</span>&nbsp;<span class="op" id="2720117">{</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2720121">return</span>&nbsp;<span class="ident" id="2720128">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2720135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2720139">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720164">s</span>&nbsp;<span class="op" id="2720166">:=</span>&nbsp;<span class="string" id="2720169">&#34;[&#34;</span>&nbsp;<span class="op" id="2720173">+</span>&nbsp;<span class="ident" id="2720175">strconv</span><span class="op" id="2720182">.</span><span class="ident" id="2720183">Itoa</span><span class="op" id="2720187">(</span><span class="ident" id="2720188">count</span><span class="op" id="2720193">)</span>&nbsp;<span class="op" id="2720195">+</span>&nbsp;<span class="string" id="2720197">&#34;]&#34;</span>&nbsp;<span class="op" id="2720201">+</span>&nbsp;<span class="op" id="2720203">*</span><span class="ident" id="2720204">typ</span><span class="op" id="2720207">.</span><span class="builtintype" id="2720208">string</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2720216">for</span>&nbsp;<span class="ident" id="2720220">_</span><span class="op" id="2720221">,</span>&nbsp;<span class="ident" id="2720223">tt</span>&nbsp;<span class="op" id="2720226">:=</span>&nbsp;<span class="keyword" id="2720229">range</span>&nbsp;<span class="ident" id="2720235">typesByString</span><span class="op" id="2720248">(</span><span class="ident" id="2720249">s</span><span class="op" id="2720250">)</span>&nbsp;<span class="op" id="2720252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720256">slice</span>&nbsp;<span class="op" id="2720262">:=</span>&nbsp;<span class="op" id="2720265">(</span><span class="op" id="2720266">*</span><span class="ident" id="2720267">sliceType</span><span class="op" id="2720276">)</span><span class="op" id="2720277">(</span><span class="ident" id="2720278">unsafe</span><span class="op" id="2720284">.</span><span class="ident" id="2720285">Pointer</span><span class="op" id="2720292">(</span><span class="ident" id="2720293">tt</span><span class="op" id="2720295">)</span><span class="op" id="2720296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2720300">if</span>&nbsp;<span class="ident" id="2720303">slice</span><span class="op" id="2720308">.</span><span class="ident" id="2720309">elem</span>&nbsp;<span class="op" id="2720314">==</span>&nbsp;<span class="ident" id="2720317">typ</span>&nbsp;<span class="op" id="2720321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2720326">return</span>&nbsp;<span class="ident" id="2720333">cachePut</span><span class="op" id="2720341">(</span><span class="ident" id="2720342">ckey</span><span class="op" id="2720346">,</span>&nbsp;<span class="ident" id="2720348">tt</span><span class="op" id="2720350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2720354">}</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2720357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2720361">//&nbsp;Make&nbsp;an&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2720385">var</span>&nbsp;<span class="ident" id="2720389">iarray</span>&nbsp;<span class="keyword" id="2720396">interface</span><span class="op" id="2720405">{</span><span class="op" id="2720406">}</span>&nbsp;<span class="op" id="2720408">=</span>&nbsp;<span class="op" id="2720410">[</span><span class="num" id="2720411">1</span><span class="op" id="2720412">]</span><span class="ident" id="2720413">unsafe</span><span class="op" id="2720419">.</span><span class="ident" id="2720420">Pointer</span><span class="op" id="2720427">{</span><span class="op" id="2720428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720431">prototype</span>&nbsp;<span class="op" id="2720441">:=</span>&nbsp;<span class="op" id="2720444">*</span><span class="op" id="2720445">(</span><span class="op" id="2720446">*</span><span class="op" id="2720447">*</span><span class="ident" id="2720448">arrayType</span><span class="op" id="2720457">)</span><span class="op" id="2720458">(</span><span class="ident" id="2720459">unsafe</span><span class="op" id="2720465">.</span><span class="ident" id="2720466">Pointer</span><span class="op" id="2720473">(</span><span class="op" id="2720474">&amp;</span><span class="ident" id="2720475">iarray</span><span class="op" id="2720481">)</span><span class="op" id="2720482">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720485">array</span>&nbsp;<span class="op" id="2720491">:=</span>&nbsp;<span class="builtinfunc" id="2720494">new</span><span class="op" id="2720497">(</span><span class="ident" id="2720498">arrayType</span><span class="op" id="2720507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2720510">*</span><span class="ident" id="2720511">array</span>&nbsp;<span class="op" id="2720517">=</span>&nbsp;<span class="op" id="2720519">*</span><span class="ident" id="2720520">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2720531">//&nbsp;TODO:&nbsp;Set&nbsp;extra&nbsp;kind&nbsp;bits&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720572">array</span><span class="op" id="2720577">.</span><span class="builtintype" id="2720578">string</span>&nbsp;<span class="op" id="2720585">=</span>&nbsp;<span class="op" id="2720587">&amp;</span><span class="ident" id="2720588">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720591">array</span><span class="op" id="2720596">.</span><span class="ident" id="2720597">hash</span>&nbsp;<span class="op" id="2720602">=</span>&nbsp;<span class="ident" id="2720604">fnv1</span><span class="op" id="2720608">(</span><span class="ident" id="2720609">typ</span><span class="op" id="2720612">.</span><span class="ident" id="2720613">hash</span><span class="op" id="2720617">,</span>&nbsp;<span class="string" id="2720619">&#39;[&#39;</span><span class="op" id="2720622">)</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2720625">for</span>&nbsp;<span class="ident" id="2720629">n</span>&nbsp;<span class="op" id="2720631">:=</span>&nbsp;<span class="builtintype" id="2720634">uint32</span><span class="op" id="2720640">(</span><span class="ident" id="2720641">count</span><span class="op" id="2720646">)</span><span class="op" id="2720647">;</span>&nbsp;<span class="ident" id="2720649">n</span>&nbsp;<span class="op" id="2720651">&gt;</span>&nbsp;<span class="num" id="2720653">0</span><span class="op" id="2720654">;</span>&nbsp;<span class="ident" id="2720656">n</span>&nbsp;<span class="op" id="2720658">&gt;&gt;=</span>&nbsp;<span class="num" id="2720662">8</span>&nbsp;<span class="op" id="2720664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720668">array</span><span class="op" id="2720673">.</span><span class="ident" id="2720674">hash</span>&nbsp;<span class="op" id="2720679">=</span>&nbsp;<span class="ident" id="2720681">fnv1</span><span class="op" id="2720685">(</span><span class="ident" id="2720686">array</span><span class="op" id="2720691">.</span><span class="ident" id="2720692">hash</span><span class="op" id="2720696">,</span>&nbsp;<span class="builtintype" id="2720698">byte</span><span class="op" id="2720702">(</span><span class="ident" id="2720703">n</span><span class="op" id="2720704">)</span><span class="op" id="2720705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2720708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720711">array</span><span class="op" id="2720716">.</span><span class="ident" id="2720717">hash</span>&nbsp;<span class="op" id="2720722">=</span>&nbsp;<span class="ident" id="2720724">fnv1</span><span class="op" id="2720728">(</span><span class="ident" id="2720729">array</span><span class="op" id="2720734">.</span><span class="ident" id="2720735">hash</span><span class="op" id="2720739">,</span>&nbsp;<span class="string" id="2720741">&#39;]&#39;</span><span class="op" id="2720744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720747">array</span><span class="op" id="2720752">.</span><span class="ident" id="2720753">elem</span>&nbsp;<span class="op" id="2720758">=</span>&nbsp;<span class="ident" id="2720760">typ</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720765">max</span>&nbsp;<span class="op" id="2720769">:=</span>&nbsp;<span class="op" id="2720772">^</span><span class="builtintype" id="2720773">uintptr</span><span class="op" id="2720780">(</span><span class="num" id="2720781">0</span><span class="op" id="2720782">)</span>&nbsp;<span class="op" id="2720784">/</span>&nbsp;<span class="ident" id="2720786">typ</span><span class="op" id="2720789">.</span><span class="ident" id="2720790">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2720796">if</span>&nbsp;<span class="builtintype" id="2720799">uintptr</span><span class="op" id="2720806">(</span><span class="ident" id="2720807">count</span><span class="op" id="2720812">)</span>&nbsp;<span class="op" id="2720814">&gt;</span>&nbsp;<span class="ident" id="2720816">max</span>&nbsp;<span class="op" id="2720820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2720824">panic</span><span class="op" id="2720829">(</span><span class="string" id="2720830">&#34;reflect.ArrayOf:&nbsp;array&nbsp;size&nbsp;would&nbsp;exceed&nbsp;virtual&nbsp;address&nbsp;space&#34;</span><span class="op" id="2720894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2720897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720900">array</span><span class="op" id="2720905">.</span><span class="ident" id="2720906">size</span>&nbsp;<span class="op" id="2720911">=</span>&nbsp;<span class="ident" id="2720913">typ</span><span class="op" id="2720916">.</span><span class="ident" id="2720917">size</span>&nbsp;<span class="op" id="2720922">*</span>&nbsp;<span class="builtintype" id="2720924">uintptr</span><span class="op" id="2720931">(</span><span class="ident" id="2720932">count</span><span class="op" id="2720937">)</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720940">array</span><span class="op" id="2720945">.</span><span class="ident" id="2720946">align</span>&nbsp;<span class="op" id="2720952">=</span>&nbsp;<span class="ident" id="2720954">typ</span><span class="op" id="2720957">.</span><span class="ident" id="2720958">align</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720965">array</span><span class="op" id="2720970">.</span><span class="ident" id="2720971">fieldAlign</span>&nbsp;<span class="op" id="2720982">=</span>&nbsp;<span class="ident" id="2720984">typ</span><span class="op" id="2720987">.</span><span class="ident" id="2720988">fieldAlign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2721000">//&nbsp;TODO:&nbsp;array.alg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2721020">//&nbsp;TODO:&nbsp;array.gc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2721039">//&nbsp;TODO:</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721049">array</span><span class="op" id="2721054">.</span><span class="ident" id="2721055">uncommonType</span>&nbsp;<span class="op" id="2721068">=</span>&nbsp;<span class="builtintype" id="2721070">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721075">array</span><span class="op" id="2721080">.</span><span class="ident" id="2721081">ptrToThis</span>&nbsp;<span class="op" id="2721091">=</span>&nbsp;<span class="builtintype" id="2721093">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721098">array</span><span class="op" id="2721103">.</span><span class="ident" id="2721104">zero</span>&nbsp;<span class="op" id="2721109">=</span>&nbsp;<span class="ident" id="2721111">unsafe</span><span class="op" id="2721117">.</span><span class="ident" id="2721118">Pointer</span><span class="op" id="2721125">(</span><span class="op" id="2721126">&amp;</span><span class="builtinfunc" id="2721127">make</span><span class="op" id="2721131">(</span><span class="op" id="2721132">[</span><span class="op" id="2721133">]</span><span class="builtintype" id="2721134">byte</span><span class="op" id="2721138">,</span>&nbsp;<span class="ident" id="2721140">array</span><span class="op" id="2721145">.</span><span class="ident" id="2721146">size</span><span class="op" id="2721150">)</span><span class="op" id="2721151">[</span><span class="num" id="2721152">0</span><span class="op" id="2721153">]</span><span class="op" id="2721154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721157">array</span><span class="op" id="2721162">.</span><span class="builtinfunc" id="2721163">len</span>&nbsp;<span class="op" id="2721167">=</span>&nbsp;<span class="builtintype" id="2721169">uintptr</span><span class="op" id="2721176">(</span><span class="ident" id="2721177">count</span><span class="op" id="2721182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721185">array</span><span class="op" id="2721190">.</span><span class="ident" id="2721191">slice</span>&nbsp;<span class="op" id="2721197">=</span>&nbsp;<span class="ident" id="2721199">slice</span><span class="op" id="2721204">.</span><span class="op" id="2721205">(</span><span class="op" id="2721206">*</span><span class="ident" id="2721207">rtype</span><span class="op" id="2721212">)</span><br>
<span class="lineno">1740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2721216">return</span>&nbsp;<span class="ident" id="2721223">cachePut</span><span class="op" id="2721231">(</span><span class="ident" id="2721232">ckey</span><span class="op" id="2721236">,</span>&nbsp;<span class="op" id="2721238">&amp;</span><span class="ident" id="2721239">array</span><span class="op" id="2721244">.</span><span class="ident" id="2721245">rtype</span><span class="op" id="2721250">)</span><br>
<span class="lineno"></span><span class="op" id="2721252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2721255">//&nbsp;toType&nbsp;converts&nbsp;from&nbsp;a&nbsp;*rtype&nbsp;to&nbsp;a&nbsp;Type&nbsp;that&nbsp;can&nbsp;be&nbsp;returned</span><br>
<span class="lineno">1745</span><span class="comment" id="2721319">//&nbsp;to&nbsp;the&nbsp;client&nbsp;of&nbsp;package&nbsp;reflect.&nbsp;In&nbsp;gc,&nbsp;the&nbsp;only&nbsp;concern&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2721388">//&nbsp;a&nbsp;nil&nbsp;*rtype&nbsp;must&nbsp;be&nbsp;replaced&nbsp;by&nbsp;a&nbsp;nil&nbsp;Type,&nbsp;but&nbsp;in&nbsp;gccgo&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2721454">//&nbsp;function&nbsp;takes&nbsp;care&nbsp;of&nbsp;ensuring&nbsp;that&nbsp;multiple&nbsp;*rtype&nbsp;for&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2721523">//&nbsp;type&nbsp;are&nbsp;coalesced&nbsp;into&nbsp;a&nbsp;single&nbsp;Type.</span><br>
<span class="lineno"></span><span class="keyword" id="2721565">func</span>&nbsp;<span class="ident" id="2721570">toType</span><span class="op" id="2721576">(</span><span class="ident" id="2721577">t</span>&nbsp;<span class="op" id="2721579">*</span><span class="ident" id="2721580">rtype</span><span class="op" id="2721585">)</span>&nbsp;<span class="ident" id="2721587">Type</span>&nbsp;<span class="op" id="2721592">{</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2721595">if</span>&nbsp;<span class="ident" id="2721598">t</span>&nbsp;<span class="op" id="2721600">==</span>&nbsp;<span class="builtintype" id="2721603">nil</span>&nbsp;<span class="op" id="2721607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2721611">return</span>&nbsp;<span class="builtintype" id="2721618">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2721623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2721626">return</span>&nbsp;<span class="ident" id="2721633">t</span><br>
<span class="lineno"></span><span class="op" id="2721635">}</span><br>
<span class="lineno">1755</span><br>
<span class="lineno"></span><span class="keyword" id="2721638">type</span>&nbsp;<span class="ident" id="2721643">layoutKey</span>&nbsp;<span class="keyword" id="2721653">struct</span>&nbsp;<span class="op" id="2721660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721663">t</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2721668">*</span><span class="ident" id="2721669">rtype</span>&nbsp;<span class="comment" id="2721675">//&nbsp;function&nbsp;signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721698">rcvr</span>&nbsp;<span class="op" id="2721703">*</span><span class="ident" id="2721704">rtype</span>&nbsp;<span class="comment" id="2721710">//&nbsp;receiver&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;none</span><br>
<span class="lineno"></span><span class="op" id="2721743">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span><span class="keyword" id="2721746">type</span>&nbsp;<span class="ident" id="2721751">layoutType</span>&nbsp;<span class="keyword" id="2721762">struct</span>&nbsp;<span class="op" id="2721769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721772">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2721782">*</span><span class="ident" id="2721783">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721790">argSize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2721800">uintptr</span>&nbsp;<span class="comment" id="2721808">//&nbsp;size&nbsp;of&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721830">retOffset</span>&nbsp;<span class="builtintype" id="2721840">uintptr</span>&nbsp;<span class="comment" id="2721848">//&nbsp;offset&nbsp;of&nbsp;return&nbsp;values.</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721877">stack</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2721887">*</span><span class="ident" id="2721888">bitVector</span><br>
<span class="lineno"></span><span class="op" id="2721898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2721901">var</span>&nbsp;<span class="ident" id="2721905">layoutCache</span>&nbsp;<span class="keyword" id="2721917">struct</span>&nbsp;<span class="op" id="2721924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721927">sync</span><span class="op" id="2721931">.</span><span class="ident" id="2721932">RWMutex</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721941">m</span>&nbsp;<span class="keyword" id="2721943">map</span><span class="op" id="2721946">[</span><span class="ident" id="2721947">layoutKey</span><span class="op" id="2721956">]</span><span class="ident" id="2721957">layoutType</span><br>
<span class="lineno"></span><span class="op" id="2721968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2721971">//&nbsp;funcLayout&nbsp;computes&nbsp;a&nbsp;struct&nbsp;type&nbsp;representing&nbsp;the&nbsp;layout&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2722039">//&nbsp;function&nbsp;arguments&nbsp;and&nbsp;return&nbsp;values&nbsp;for&nbsp;the&nbsp;function&nbsp;type&nbsp;t.</span><br>
<span class="lineno">1775</span><span class="comment" id="2722104">//&nbsp;If&nbsp;rcvr&nbsp;!=&nbsp;nil,&nbsp;rcvr&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="2722164">//&nbsp;The&nbsp;returned&nbsp;type&nbsp;exists&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2722243">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2722311">//&nbsp;the&nbsp;name&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2722351">func</span>&nbsp;<span class="ident" id="2722356">funcLayout</span><span class="op" id="2722366">(</span><span class="ident" id="2722367">t</span>&nbsp;<span class="op" id="2722369">*</span><span class="ident" id="2722370">rtype</span><span class="op" id="2722375">,</span>&nbsp;<span class="ident" id="2722377">rcvr</span>&nbsp;<span class="op" id="2722382">*</span><span class="ident" id="2722383">rtype</span><span class="op" id="2722388">)</span>&nbsp;<span class="op" id="2722390">(</span><span class="ident" id="2722391">frametype</span>&nbsp;<span class="op" id="2722401">*</span><span class="ident" id="2722402">rtype</span><span class="op" id="2722407">,</span>&nbsp;<span class="ident" id="2722409">argSize</span><span class="op" id="2722416">,</span>&nbsp;<span class="ident" id="2722418">retOffset</span>&nbsp;<span class="builtintype" id="2722428">uintptr</span><span class="op" id="2722435">,</span>&nbsp;<span class="ident" id="2722437">stack</span>&nbsp;<span class="op" id="2722443">*</span><span class="ident" id="2722444">bitVector</span><span class="op" id="2722453">)</span>&nbsp;<span class="op" id="2722455">{</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2722458">if</span>&nbsp;<span class="ident" id="2722461">t</span><span class="op" id="2722462">.</span><span class="ident" id="2722463">Kind</span><span class="op" id="2722467">(</span><span class="op" id="2722468">)</span>&nbsp;<span class="op" id="2722470">!=</span>&nbsp;<span class="ident" id="2722473">Func</span>&nbsp;<span class="op" id="2722478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2722482">panic</span><span class="op" id="2722487">(</span><span class="string" id="2722488">&#34;reflect:&nbsp;funcLayout&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2722526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2722529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2722532">if</span>&nbsp;<span class="ident" id="2722535">rcvr</span>&nbsp;<span class="op" id="2722540">!=</span>&nbsp;<span class="builtintype" id="2722543">nil</span>&nbsp;<span class="op" id="2722547">&amp;&amp;</span>&nbsp;<span class="ident" id="2722550">rcvr</span><span class="op" id="2722554">.</span><span class="ident" id="2722555">Kind</span><span class="op" id="2722559">(</span><span class="op" id="2722560">)</span>&nbsp;<span class="op" id="2722562">==</span>&nbsp;<span class="ident" id="2722565">Interface</span>&nbsp;<span class="op" id="2722575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2722579">panic</span><span class="op" id="2722584">(</span><span class="string" id="2722585">&#34;reflect:&nbsp;funcLayout&nbsp;with&nbsp;interface&nbsp;receiver&nbsp;&#34;</span>&nbsp;<span class="op" id="2722632">+</span>&nbsp;<span class="ident" id="2722634">rcvr</span><span class="op" id="2722638">.</span><span class="ident" id="2722639">String</span><span class="op" id="2722645">(</span><span class="op" id="2722646">)</span><span class="op" id="2722647">)</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2722650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722653">k</span>&nbsp;<span class="op" id="2722655">:=</span>&nbsp;<span class="ident" id="2722658">layoutKey</span><span class="op" id="2722667">{</span><span class="ident" id="2722668">t</span><span class="op" id="2722669">,</span>&nbsp;<span class="ident" id="2722671">rcvr</span><span class="op" id="2722675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722678">layoutCache</span><span class="op" id="2722689">.</span><span class="ident" id="2722690">RLock</span><span class="op" id="2722695">(</span><span class="op" id="2722696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2722699">if</span>&nbsp;<span class="ident" id="2722702">x</span>&nbsp;<span class="op" id="2722704">:=</span>&nbsp;<span class="ident" id="2722707">layoutCache</span><span class="op" id="2722718">.</span><span class="ident" id="2722719">m</span><span class="op" id="2722720">[</span><span class="ident" id="2722721">k</span><span class="op" id="2722722">]</span><span class="op" id="2722723">;</span>&nbsp;<span class="ident" id="2722725">x</span><span class="op" id="2722726">.</span><span class="ident" id="2722727">t</span>&nbsp;<span class="op" id="2722729">!=</span>&nbsp;<span class="builtintype" id="2722732">nil</span>&nbsp;<span class="op" id="2722736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722740">layoutCache</span><span class="op" id="2722751">.</span><span class="ident" id="2722752">RUnlock</span><span class="op" id="2722759">(</span><span class="op" id="2722760">)</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2722764">return</span>&nbsp;<span class="ident" id="2722771">x</span><span class="op" id="2722772">.</span><span class="ident" id="2722773">t</span><span class="op" id="2722774">,</span>&nbsp;<span class="ident" id="2722776">x</span><span class="op" id="2722777">.</span><span class="ident" id="2722778">argSize</span><span class="op" id="2722785">,</span>&nbsp;<span class="ident" id="2722787">x</span><span class="op" id="2722788">.</span><span class="ident" id="2722789">retOffset</span><span class="op" id="2722798">,</span>&nbsp;<span class="ident" id="2722800">x</span><span class="op" id="2722801">.</span><span class="ident" id="2722802">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2722809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722812">layoutCache</span><span class="op" id="2722823">.</span><span class="ident" id="2722824">RUnlock</span><span class="op" id="2722831">(</span><span class="op" id="2722832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722835">layoutCache</span><span class="op" id="2722846">.</span><span class="ident" id="2722847">Lock</span><span class="op" id="2722851">(</span><span class="op" id="2722852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2722855">if</span>&nbsp;<span class="ident" id="2722858">x</span>&nbsp;<span class="op" id="2722860">:=</span>&nbsp;<span class="ident" id="2722863">layoutCache</span><span class="op" id="2722874">.</span><span class="ident" id="2722875">m</span><span class="op" id="2722876">[</span><span class="ident" id="2722877">k</span><span class="op" id="2722878">]</span><span class="op" id="2722879">;</span>&nbsp;<span class="ident" id="2722881">x</span><span class="op" id="2722882">.</span><span class="ident" id="2722883">t</span>&nbsp;<span class="op" id="2722885">!=</span>&nbsp;<span class="builtintype" id="2722888">nil</span>&nbsp;<span class="op" id="2722892">{</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722896">layoutCache</span><span class="op" id="2722907">.</span><span class="ident" id="2722908">Unlock</span><span class="op" id="2722914">(</span><span class="op" id="2722915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2722919">return</span>&nbsp;<span class="ident" id="2722926">x</span><span class="op" id="2722927">.</span><span class="ident" id="2722928">t</span><span class="op" id="2722929">,</span>&nbsp;<span class="ident" id="2722931">x</span><span class="op" id="2722932">.</span><span class="ident" id="2722933">argSize</span><span class="op" id="2722940">,</span>&nbsp;<span class="ident" id="2722942">x</span><span class="op" id="2722943">.</span><span class="ident" id="2722944">retOffset</span><span class="op" id="2722953">,</span>&nbsp;<span class="ident" id="2722955">x</span><span class="op" id="2722956">.</span><span class="ident" id="2722957">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2722964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722968">tt</span>&nbsp;<span class="op" id="2722971">:=</span>&nbsp;<span class="op" id="2722974">(</span><span class="op" id="2722975">*</span><span class="ident" id="2722976">funcType</span><span class="op" id="2722984">)</span><span class="op" id="2722985">(</span><span class="ident" id="2722986">unsafe</span><span class="op" id="2722992">.</span><span class="ident" id="2722993">Pointer</span><span class="op" id="2723000">(</span><span class="ident" id="2723001">t</span><span class="op" id="2723002">)</span><span class="op" id="2723003">)</span><br>
<span class="lineno">1800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2723007">//&nbsp;compute&nbsp;gc&nbsp;program&nbsp;&amp;&nbsp;stack&nbsp;bitmap&nbsp;for&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723059">stack</span>&nbsp;<span class="op" id="2723065">=</span>&nbsp;<span class="builtinfunc" id="2723067">new</span><span class="op" id="2723070">(</span><span class="ident" id="2723071">bitVector</span><span class="op" id="2723080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2723083">var</span>&nbsp;<span class="ident" id="2723087">gc</span>&nbsp;<span class="ident" id="2723090">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2723098">var</span>&nbsp;<span class="ident" id="2723102">offset</span>&nbsp;<span class="builtintype" id="2723109">uintptr</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2723118">if</span>&nbsp;<span class="ident" id="2723121">rcvr</span>&nbsp;<span class="op" id="2723126">!=</span>&nbsp;<span class="builtintype" id="2723129">nil</span>&nbsp;<span class="op" id="2723133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2723137">//&nbsp;Reflect&nbsp;uses&nbsp;the&nbsp;&#34;interface&#34;&nbsp;calling&nbsp;convention&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2723194">//&nbsp;methods,&nbsp;where&nbsp;receivers&nbsp;take&nbsp;one&nbsp;word&nbsp;of&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2723250">//&nbsp;space&nbsp;no&nbsp;matter&nbsp;how&nbsp;big&nbsp;they&nbsp;actually&nbsp;are.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2723298">if</span>&nbsp;<span class="ident" id="2723301">ifaceIndir</span><span class="op" id="2723311">(</span><span class="ident" id="2723312">rcvr</span><span class="op" id="2723316">)</span>&nbsp;<span class="op" id="2723318">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2723323">//&nbsp;we&nbsp;pass&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723364">gc</span><span class="op" id="2723366">.</span><span class="builtinfunc" id="2723367">append</span><span class="op" id="2723373">(</span><span class="ident" id="2723374">bitsPointer</span><span class="op" id="2723385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723390">stack</span><span class="op" id="2723395">.</span><span class="ident" id="2723396">append2</span><span class="op" id="2723403">(</span><span class="ident" id="2723404">bitsPointer</span><span class="op" id="2723415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2723419">}</span>&nbsp;<span class="keyword" id="2723421">else</span>&nbsp;<span class="keyword" id="2723426">if</span>&nbsp;<span class="ident" id="2723429">rcvr</span><span class="op" id="2723433">.</span><span class="ident" id="2723434">pointers</span><span class="op" id="2723442">(</span><span class="op" id="2723443">)</span>&nbsp;<span class="op" id="2723445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2723450">//&nbsp;rcvr&nbsp;is&nbsp;a&nbsp;one-word&nbsp;pointer&nbsp;object.&nbsp;&nbsp;Its&nbsp;gc&nbsp;program</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2723507">//&nbsp;is&nbsp;just&nbsp;what&nbsp;we&nbsp;need&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723540">gc</span><span class="op" id="2723542">.</span><span class="builtinfunc" id="2723543">append</span><span class="op" id="2723549">(</span><span class="ident" id="2723550">bitsPointer</span><span class="op" id="2723561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723566">stack</span><span class="op" id="2723571">.</span><span class="ident" id="2723572">append2</span><span class="op" id="2723579">(</span><span class="ident" id="2723580">bitsPointer</span><span class="op" id="2723591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2723595">}</span>&nbsp;<span class="keyword" id="2723597">else</span>&nbsp;<span class="op" id="2723602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723607">gc</span><span class="op" id="2723609">.</span><span class="builtinfunc" id="2723610">append</span><span class="op" id="2723616">(</span><span class="ident" id="2723617">bitsScalar</span><span class="op" id="2723627">)</span><br>
<span class="lineno">1820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723632">stack</span><span class="op" id="2723637">.</span><span class="ident" id="2723638">append2</span><span class="op" id="2723645">(</span><span class="ident" id="2723646">bitsScalar</span><span class="op" id="2723656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2723660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723664">offset</span>&nbsp;<span class="op" id="2723671">+=</span>&nbsp;<span class="ident" id="2723674">ptrSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2723683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2723686">for</span>&nbsp;<span class="ident" id="2723690">_</span><span class="op" id="2723691">,</span>&nbsp;<span class="ident" id="2723693">arg</span>&nbsp;<span class="op" id="2723697">:=</span>&nbsp;<span class="keyword" id="2723700">range</span>&nbsp;<span class="ident" id="2723706">tt</span><span class="op" id="2723708">.</span><span class="ident" id="2723709">in</span>&nbsp;<span class="op" id="2723712">{</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723716">gc</span><span class="op" id="2723718">.</span><span class="ident" id="2723719">appendProg</span><span class="op" id="2723729">(</span><span class="ident" id="2723730">arg</span><span class="op" id="2723733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723737">addTypeBits</span><span class="op" id="2723748">(</span><span class="ident" id="2723749">stack</span><span class="op" id="2723754">,</span>&nbsp;<span class="op" id="2723756">&amp;</span><span class="ident" id="2723757">offset</span><span class="op" id="2723763">,</span>&nbsp;<span class="ident" id="2723765">arg</span><span class="op" id="2723768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2723771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723774">argSize</span>&nbsp;<span class="op" id="2723782">=</span>&nbsp;<span class="ident" id="2723784">gc</span><span class="op" id="2723786">.</span><span class="ident" id="2723787">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2723793">if</span>&nbsp;<span class="ident" id="2723796">runtime</span><span class="op" id="2723803">.</span><span class="ident" id="2723804">GOARCH</span>&nbsp;<span class="op" id="2723811">==</span>&nbsp;<span class="string" id="2723814">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2723825">{</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723829">gc</span><span class="op" id="2723831">.</span><span class="ident" id="2723832">align</span><span class="op" id="2723837">(</span><span class="num" id="2723838">8</span><span class="op" id="2723839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2723842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723845">gc</span><span class="op" id="2723847">.</span><span class="ident" id="2723848">align</span><span class="op" id="2723853">(</span><span class="ident" id="2723854">ptrSize</span><span class="op" id="2723861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723864">retOffset</span>&nbsp;<span class="op" id="2723874">=</span>&nbsp;<span class="ident" id="2723876">gc</span><span class="op" id="2723878">.</span><span class="ident" id="2723879">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2723885">for</span>&nbsp;<span class="ident" id="2723889">_</span><span class="op" id="2723890">,</span>&nbsp;<span class="ident" id="2723892">res</span>&nbsp;<span class="op" id="2723896">:=</span>&nbsp;<span class="keyword" id="2723899">range</span>&nbsp;<span class="ident" id="2723905">tt</span><span class="op" id="2723907">.</span><span class="ident" id="2723908">out</span>&nbsp;<span class="op" id="2723912">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723916">gc</span><span class="op" id="2723918">.</span><span class="ident" id="2723919">appendProg</span><span class="op" id="2723929">(</span><span class="ident" id="2723930">res</span><span class="op" id="2723933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2723937">//&nbsp;stack&nbsp;map&nbsp;does&nbsp;not&nbsp;need&nbsp;result&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2723977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723980">gc</span><span class="op" id="2723982">.</span><span class="ident" id="2723983">align</span><span class="op" id="2723988">(</span><span class="ident" id="2723989">ptrSize</span><span class="op" id="2723996">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2724000">//&nbsp;build&nbsp;dummy&nbsp;rtype&nbsp;holding&nbsp;gc&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724041">x</span>&nbsp;<span class="op" id="2724043">:=</span>&nbsp;<span class="builtinfunc" id="2724046">new</span><span class="op" id="2724049">(</span><span class="ident" id="2724050">rtype</span><span class="op" id="2724055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724058">x</span><span class="op" id="2724059">.</span><span class="ident" id="2724060">size</span>&nbsp;<span class="op" id="2724065">=</span>&nbsp;<span class="ident" id="2724067">gc</span><span class="op" id="2724069">.</span><span class="ident" id="2724070">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724076">x</span><span class="op" id="2724077">.</span><span class="ident" id="2724078">gc</span><span class="op" id="2724080">[</span><span class="num" id="2724081">0</span><span class="op" id="2724082">]</span>&nbsp;<span class="op" id="2724084">=</span>&nbsp;<span class="ident" id="2724086">gc</span><span class="op" id="2724088">.</span><span class="ident" id="2724089">finalize</span><span class="op" id="2724097">(</span><span class="op" id="2724098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2724101">var</span>&nbsp;<span class="ident" id="2724105">s</span>&nbsp;<span class="builtintype" id="2724107">string</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2724115">if</span>&nbsp;<span class="ident" id="2724118">rcvr</span>&nbsp;<span class="op" id="2724123">!=</span>&nbsp;<span class="builtintype" id="2724126">nil</span>&nbsp;<span class="op" id="2724130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724134">s</span>&nbsp;<span class="op" id="2724136">=</span>&nbsp;<span class="string" id="2724138">&#34;methodargs(&#34;</span>&nbsp;<span class="op" id="2724152">+</span>&nbsp;<span class="op" id="2724154">*</span><span class="ident" id="2724155">rcvr</span><span class="op" id="2724159">.</span><span class="builtintype" id="2724160">string</span>&nbsp;<span class="op" id="2724167">+</span>&nbsp;<span class="string" id="2724169">&#34;)(&#34;</span>&nbsp;<span class="op" id="2724174">+</span>&nbsp;<span class="op" id="2724176">*</span><span class="ident" id="2724177">t</span><span class="op" id="2724178">.</span><span class="builtintype" id="2724179">string</span>&nbsp;<span class="op" id="2724186">+</span>&nbsp;<span class="string" id="2724188">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2724193">}</span>&nbsp;<span class="keyword" id="2724195">else</span>&nbsp;<span class="op" id="2724200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724204">s</span>&nbsp;<span class="op" id="2724206">=</span>&nbsp;<span class="string" id="2724208">&#34;funcargs(&#34;</span>&nbsp;<span class="op" id="2724220">+</span>&nbsp;<span class="op" id="2724222">*</span><span class="ident" id="2724223">t</span><span class="op" id="2724224">.</span><span class="builtintype" id="2724225">string</span>&nbsp;<span class="op" id="2724232">+</span>&nbsp;<span class="string" id="2724234">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2724239">}</span><br>
<span class="lineno">1850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724242">x</span><span class="op" id="2724243">.</span><span class="builtintype" id="2724244">string</span>&nbsp;<span class="op" id="2724251">=</span>&nbsp;<span class="op" id="2724253">&amp;</span><span class="ident" id="2724254">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2724258">//&nbsp;cache&nbsp;result&nbsp;for&nbsp;future&nbsp;callers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2724294">if</span>&nbsp;<span class="ident" id="2724297">layoutCache</span><span class="op" id="2724308">.</span><span class="ident" id="2724309">m</span>&nbsp;<span class="op" id="2724311">==</span>&nbsp;<span class="builtintype" id="2724314">nil</span>&nbsp;<span class="op" id="2724318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724322">layoutCache</span><span class="op" id="2724333">.</span><span class="ident" id="2724334">m</span>&nbsp;<span class="op" id="2724336">=</span>&nbsp;<span class="builtinfunc" id="2724338">make</span><span class="op" id="2724342">(</span><span class="keyword" id="2724343">map</span><span class="op" id="2724346">[</span><span class="ident" id="2724347">layoutKey</span><span class="op" id="2724356">]</span><span class="ident" id="2724357">layoutType</span><span class="op" id="2724367">)</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2724370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724373">layoutCache</span><span class="op" id="2724384">.</span><span class="ident" id="2724385">m</span><span class="op" id="2724386">[</span><span class="ident" id="2724387">k</span><span class="op" id="2724388">]</span>&nbsp;<span class="op" id="2724390">=</span>&nbsp;<span class="ident" id="2724392">layoutType</span><span class="op" id="2724402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724406">t</span><span class="op" id="2724407">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724417">x</span><span class="op" id="2724418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724422">argSize</span><span class="op" id="2724429">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2724433">argSize</span><span class="op" id="2724440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724444">retOffset</span><span class="op" id="2724453">:</span>&nbsp;<span class="ident" id="2724455">retOffset</span><span class="op" id="2724464">,</span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724468">stack</span><span class="op" id="2724473">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724479">stack</span><span class="op" id="2724484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2724487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724490">layoutCache</span><span class="op" id="2724501">.</span><span class="ident" id="2724502">Unlock</span><span class="op" id="2724508">(</span><span class="op" id="2724509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2724512">return</span>&nbsp;<span class="ident" id="2724519">x</span><span class="op" id="2724520">,</span>&nbsp;<span class="ident" id="2724522">argSize</span><span class="op" id="2724529">,</span>&nbsp;<span class="ident" id="2724531">retOffset</span><span class="op" id="2724540">,</span>&nbsp;<span class="ident" id="2724542">stack</span><br>
<span class="lineno"></span><span class="op" id="2724548">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span><span class="comment" id="2724551">//&nbsp;ifaceIndir&nbsp;reports&nbsp;whether&nbsp;t&nbsp;is&nbsp;stored&nbsp;indirectly&nbsp;in&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="2724627">func</span>&nbsp;<span class="ident" id="2724632">ifaceIndir</span><span class="op" id="2724642">(</span><span class="ident" id="2724643">t</span>&nbsp;<span class="op" id="2724645">*</span><span class="ident" id="2724646">rtype</span><span class="op" id="2724651">)</span>&nbsp;<span class="builtintype" id="2724653">bool</span>&nbsp;<span class="op" id="2724658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2724661">return</span>&nbsp;<span class="ident" id="2724668">t</span><span class="op" id="2724669">.</span><span class="ident" id="2724670">kind</span><span class="op" id="2724674">&amp;</span><span class="ident" id="2724675">kindDirectIface</span>&nbsp;<span class="op" id="2724691">==</span>&nbsp;<span class="num" id="2724694">0</span><br>
<span class="lineno"></span><span class="op" id="2724696">}</span><br>
<span class="lineno">1870</span><br>
<span class="lineno"></span><span class="comment" id="2724699">//&nbsp;Layout&nbsp;matches&nbsp;runtime.BitVector&nbsp;(well&nbsp;enough).</span><br>
<span class="lineno"></span><span class="keyword" id="2724750">type</span>&nbsp;<span class="ident" id="2724755">bitVector</span>&nbsp;<span class="keyword" id="2724765">struct</span>&nbsp;<span class="op" id="2724772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724775">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2724780">uint32</span>&nbsp;<span class="comment" id="2724787">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724806">data</span>&nbsp;<span class="op" id="2724811">[</span><span class="op" id="2724812">]</span><span class="builtintype" id="2724813">byte</span><br>
<span class="lineno">1875</span><span class="op" id="2724818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2724821">//&nbsp;append&nbsp;a&nbsp;bit&nbsp;pair&nbsp;to&nbsp;the&nbsp;bitmap.</span><br>
<span class="lineno"></span><span class="keyword" id="2724857">func</span>&nbsp;<span class="op" id="2724862">(</span><span class="ident" id="2724863">bv</span>&nbsp;<span class="op" id="2724866">*</span><span class="ident" id="2724867">bitVector</span><span class="op" id="2724876">)</span>&nbsp;<span class="ident" id="2724878">append2</span><span class="op" id="2724885">(</span><span class="ident" id="2724886">bits</span>&nbsp;<span class="builtintype" id="2724891">uint8</span><span class="op" id="2724896">)</span>&nbsp;<span class="op" id="2724898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2724901">//&nbsp;assume&nbsp;bv.n&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;2,&nbsp;since&nbsp;append2&nbsp;is&nbsp;the&nbsp;only&nbsp;operation.</span><br>
<span class="lineno">1880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2724974">if</span>&nbsp;<span class="ident" id="2724977">bv</span><span class="op" id="2724979">.</span><span class="ident" id="2724980">n</span><span class="op" id="2724981">%</span><span class="num" id="2724982">8</span>&nbsp;<span class="op" id="2724984">==</span>&nbsp;<span class="num" id="2724987">0</span>&nbsp;<span class="op" id="2724989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724993">bv</span><span class="op" id="2724995">.</span><span class="ident" id="2724996">data</span>&nbsp;<span class="op" id="2725001">=</span>&nbsp;<span class="builtinfunc" id="2725003">append</span><span class="op" id="2725009">(</span><span class="ident" id="2725010">bv</span><span class="op" id="2725012">.</span><span class="ident" id="2725013">data</span><span class="op" id="2725017">,</span>&nbsp;<span class="num" id="2725019">0</span><span class="op" id="2725020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2725023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725026">bv</span><span class="op" id="2725028">.</span><span class="ident" id="2725029">data</span><span class="op" id="2725033">[</span><span class="ident" id="2725034">bv</span><span class="op" id="2725036">.</span><span class="ident" id="2725037">n</span><span class="op" id="2725038">/</span><span class="num" id="2725039">8</span><span class="op" id="2725040">]</span>&nbsp;<span class="op" id="2725042">|=</span>&nbsp;<span class="ident" id="2725045">bits</span>&nbsp;<span class="op" id="2725050">&lt;&lt;</span>&nbsp;<span class="op" id="2725053">(</span><span class="ident" id="2725054">bv</span><span class="op" id="2725056">.</span><span class="ident" id="2725057">n</span>&nbsp;<span class="op" id="2725059">%</span>&nbsp;<span class="num" id="2725061">8</span><span class="op" id="2725062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725065">bv</span><span class="op" id="2725067">.</span><span class="ident" id="2725068">n</span>&nbsp;<span class="op" id="2725070">+=</span>&nbsp;<span class="num" id="2725073">2</span><br>
<span class="lineno">1885</span><span class="op" id="2725075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2725078">func</span>&nbsp;<span class="ident" id="2725083">addTypeBits</span><span class="op" id="2725094">(</span><span class="ident" id="2725095">bv</span>&nbsp;<span class="op" id="2725098">*</span><span class="ident" id="2725099">bitVector</span><span class="op" id="2725108">,</span>&nbsp;<span class="ident" id="2725110">offset</span>&nbsp;<span class="op" id="2725117">*</span><span class="builtintype" id="2725118">uintptr</span><span class="op" id="2725125">,</span>&nbsp;<span class="ident" id="2725127">t</span>&nbsp;<span class="op" id="2725129">*</span><span class="ident" id="2725130">rtype</span><span class="op" id="2725135">)</span>&nbsp;<span class="op" id="2725137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2725140">*</span><span class="ident" id="2725141">offset</span>&nbsp;<span class="op" id="2725148">=</span>&nbsp;<span class="ident" id="2725150">align</span><span class="op" id="2725155">(</span><span class="op" id="2725156">*</span><span class="ident" id="2725157">offset</span><span class="op" id="2725163">,</span>&nbsp;<span class="builtintype" id="2725165">uintptr</span><span class="op" id="2725172">(</span><span class="ident" id="2725173">t</span><span class="op" id="2725174">.</span><span class="ident" id="2725175">align</span><span class="op" id="2725180">)</span><span class="op" id="2725181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2725184">if</span>&nbsp;<span class="ident" id="2725187">t</span><span class="op" id="2725188">.</span><span class="ident" id="2725189">kind</span><span class="op" id="2725193">&amp;</span><span class="ident" id="2725194">kindNoPointers</span>&nbsp;<span class="op" id="2725209">!=</span>&nbsp;<span class="num" id="2725212">0</span>&nbsp;<span class="op" id="2725214">{</span><br>
<span class="lineno">1890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2725218">*</span><span class="ident" id="2725219">offset</span>&nbsp;<span class="op" id="2725226">+=</span>&nbsp;<span class="ident" id="2725229">t</span><span class="op" id="2725230">.</span><span class="ident" id="2725231">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2725238">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2725246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2725250">switch</span>&nbsp;<span class="ident" id="2725257">Kind</span><span class="op" id="2725261">(</span><span class="ident" id="2725262">t</span><span class="op" id="2725263">.</span><span class="ident" id="2725264">kind</span>&nbsp;<span class="op" id="2725269">&amp;</span>&nbsp;<span class="ident" id="2725271">kindMask</span><span class="op" id="2725279">)</span>&nbsp;<span class="op" id="2725281">{</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2725284">case</span>&nbsp;<span class="ident" id="2725289">Chan</span><span class="op" id="2725293">,</span>&nbsp;<span class="ident" id="2725295">Func</span><span class="op" id="2725299">,</span>&nbsp;<span class="ident" id="2725301">Map</span><span class="op" id="2725304">,</span>&nbsp;<span class="ident" id="2725306">Ptr</span><span class="op" id="2725309">,</span>&nbsp;<span class="ident" id="2725311">Slice</span><span class="op" id="2725316">,</span>&nbsp;<span class="ident" id="2725318">String</span><span class="op" id="2725324">,</span>&nbsp;<span class="ident" id="2725326">UnsafePointer</span><span class="op" id="2725339">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2725343">//&nbsp;1&nbsp;pointer&nbsp;at&nbsp;start&nbsp;of&nbsp;representation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2725385">for</span>&nbsp;<span class="ident" id="2725389">bv</span><span class="op" id="2725391">.</span><span class="ident" id="2725392">n</span>&nbsp;<span class="op" id="2725394">&lt;</span>&nbsp;<span class="num" id="2725396">2</span><span class="op" id="2725397">*</span><span class="builtintype" id="2725398">uint32</span><span class="op" id="2725404">(</span><span class="op" id="2725405">*</span><span class="ident" id="2725406">offset</span><span class="op" id="2725412">/</span><span class="builtintype" id="2725413">uintptr</span><span class="op" id="2725420">(</span><span class="ident" id="2725421">ptrSize</span><span class="op" id="2725428">)</span><span class="op" id="2725429">)</span>&nbsp;<span class="op" id="2725431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725436">bv</span><span class="op" id="2725438">.</span><span class="ident" id="2725439">append2</span><span class="op" id="2725446">(</span><span class="ident" id="2725447">bitsScalar</span><span class="op" id="2725457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2725461">}</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725465">bv</span><span class="op" id="2725467">.</span><span class="ident" id="2725468">append2</span><span class="op" id="2725475">(</span><span class="ident" id="2725476">bitsPointer</span><span class="op" id="2725487">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2725491">case</span>&nbsp;<span class="ident" id="2725496">Interface</span><span class="op" id="2725505">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2725509">//&nbsp;2&nbsp;pointers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2725525">for</span>&nbsp;<span class="ident" id="2725529">bv</span><span class="op" id="2725531">.</span><span class="ident" id="2725532">n</span>&nbsp;<span class="op" id="2725534">&lt;</span>&nbsp;<span class="num" id="2725536">2</span><span class="op" id="2725537">*</span><span class="builtintype" id="2725538">uint32</span><span class="op" id="2725544">(</span><span class="op" id="2725545">*</span><span class="ident" id="2725546">offset</span><span class="op" id="2725552">/</span><span class="builtintype" id="2725553">uintptr</span><span class="op" id="2725560">(</span><span class="ident" id="2725561">ptrSize</span><span class="op" id="2725568">)</span><span class="op" id="2725569">)</span>&nbsp;<span class="op" id="2725571">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725576">bv</span><span class="op" id="2725578">.</span><span class="ident" id="2725579">append2</span><span class="op" id="2725586">(</span><span class="ident" id="2725587">bitsScalar</span><span class="op" id="2725597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2725601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725605">bv</span><span class="op" id="2725607">.</span><span class="ident" id="2725608">append2</span><span class="op" id="2725615">(</span><span class="ident" id="2725616">bitsPointer</span><span class="op" id="2725627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725631">bv</span><span class="op" id="2725633">.</span><span class="ident" id="2725634">append2</span><span class="op" id="2725641">(</span><span class="ident" id="2725642">bitsPointer</span><span class="op" id="2725653">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2725657">case</span>&nbsp;<span class="ident" id="2725662">Array</span><span class="op" id="2725667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2725671">//&nbsp;repeat&nbsp;inner&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725694">tt</span>&nbsp;<span class="op" id="2725697">:=</span>&nbsp;<span class="op" id="2725700">(</span><span class="op" id="2725701">*</span><span class="ident" id="2725702">arrayType</span><span class="op" id="2725711">)</span><span class="op" id="2725712">(</span><span class="ident" id="2725713">unsafe</span><span class="op" id="2725719">.</span><span class="ident" id="2725720">Pointer</span><span class="op" id="2725727">(</span><span class="ident" id="2725728">t</span><span class="op" id="2725729">)</span><span class="op" id="2725730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2725734">for</span>&nbsp;<span class="ident" id="2725738">i</span>&nbsp;<span class="op" id="2725740">:=</span>&nbsp;<span class="num" id="2725743">0</span><span class="op" id="2725744">;</span>&nbsp;<span class="ident" id="2725746">i</span>&nbsp;<span class="op" id="2725748">&lt;</span>&nbsp;<span class="builtintype" id="2725750">int</span><span class="op" id="2725753">(</span><span class="ident" id="2725754">tt</span><span class="op" id="2725756">.</span><span class="builtinfunc" id="2725757">len</span><span class="op" id="2725760">)</span><span class="op" id="2725761">;</span>&nbsp;<span class="ident" id="2725763">i</span><span class="op" id="2725764">++</span>&nbsp;<span class="op" id="2725767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725772">addTypeBits</span><span class="op" id="2725783">(</span><span class="ident" id="2725784">bv</span><span class="op" id="2725786">,</span>&nbsp;<span class="ident" id="2725788">offset</span><span class="op" id="2725794">,</span>&nbsp;<span class="ident" id="2725796">tt</span><span class="op" id="2725798">.</span><span class="ident" id="2725799">elem</span><span class="op" id="2725803">)</span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2725807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2725811">case</span>&nbsp;<span class="ident" id="2725816">Struct</span><span class="op" id="2725822">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2725826">//&nbsp;apply&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725844">tt</span>&nbsp;<span class="op" id="2725847">:=</span>&nbsp;<span class="op" id="2725850">(</span><span class="op" id="2725851">*</span><span class="ident" id="2725852">structType</span><span class="op" id="2725862">)</span><span class="op" id="2725863">(</span><span class="ident" id="2725864">unsafe</span><span class="op" id="2725870">.</span><span class="ident" id="2725871">Pointer</span><span class="op" id="2725878">(</span><span class="ident" id="2725879">t</span><span class="op" id="2725880">)</span><span class="op" id="2725881">)</span><br>
<span class="lineno">1920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725885">start</span>&nbsp;<span class="op" id="2725891">:=</span>&nbsp;<span class="op" id="2725894">*</span><span class="ident" id="2725895">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2725904">for</span>&nbsp;<span class="ident" id="2725908">i</span>&nbsp;<span class="op" id="2725910">:=</span>&nbsp;<span class="keyword" id="2725913">range</span>&nbsp;<span class="ident" id="2725919">tt</span><span class="op" id="2725921">.</span><span class="ident" id="2725922">fields</span>&nbsp;<span class="op" id="2725929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725934">f</span>&nbsp;<span class="op" id="2725936">:=</span>&nbsp;<span class="op" id="2725939">&amp;</span><span class="ident" id="2725940">tt</span><span class="op" id="2725942">.</span><span class="ident" id="2725943">fields</span><span class="op" id="2725949">[</span><span class="ident" id="2725950">i</span><span class="op" id="2725951">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725956">off</span>&nbsp;<span class="op" id="2725960">:=</span>&nbsp;<span class="ident" id="2725963">start</span>&nbsp;<span class="op" id="2725969">+</span>&nbsp;<span class="ident" id="2725971">f</span><span class="op" id="2725972">.</span><span class="ident" id="2725973">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725983">addTypeBits</span><span class="op" id="2725994">(</span><span class="ident" id="2725995">bv</span><span class="op" id="2725997">,</span>&nbsp;<span class="op" id="2725999">&amp;</span><span class="ident" id="2726000">off</span><span class="op" id="2726003">,</span>&nbsp;<span class="ident" id="2726005">f</span><span class="op" id="2726006">.</span><span class="ident" id="2726007">typ</span><span class="op" id="2726010">)</span><br>
<span class="lineno">1925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2726014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2726017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2726021">*</span><span class="ident" id="2726022">offset</span>&nbsp;<span class="op" id="2726029">+=</span>&nbsp;<span class="ident" id="2726032">t</span><span class="op" id="2726033">.</span><span class="ident" id="2726034">size</span><br>
<span class="lineno"></span><span class="op" id="2726039">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
