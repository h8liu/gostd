<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/plan9obj</h2>
<ul>
<li><a href="/gostd/debug/plan9obj/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/plan9obj/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/plan9obj/plan9obj.go.html">plan9obj.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6375217">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6375273">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6375327">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6375378">//&nbsp;Package&nbsp;plan9obj&nbsp;implements&nbsp;access&nbsp;to&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="6375446">package</span>&nbsp;<span class="ident" id="6375454">plan9obj</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6375464">import</span>&nbsp;<span class="op" id="6375471">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6375474">&#34;encoding/binary&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6375493">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6375503">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6375510">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6375516">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="6375521">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6375524">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6375579">type</span>&nbsp;<span class="ident" id="6375584">FileHeader</span>&nbsp;<span class="keyword" id="6375595">struct</span>&nbsp;<span class="op" id="6375602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6375605">Magic</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6375617">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6375625">Bss</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6375637">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6375645">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6375657">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6375665">PtrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6375677">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6375682">LoadAddress</span>&nbsp;<span class="ident" id="6375694">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6375702">HdrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6375714">uint64</span><br>
<span class="lineno"></span><span class="op" id="6375721">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="6375724">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6375772">type</span>&nbsp;<span class="ident" id="6375777">File</span>&nbsp;<span class="keyword" id="6375782">struct</span>&nbsp;<span class="op" id="6375789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6375792">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6375804">Sections</span>&nbsp;<span class="op" id="6375813">[</span><span class="op" id="6375814">]</span><span class="op" id="6375815">*</span><span class="ident" id="6375816">Section</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6375825">closer</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6375834">io</span><span class="op" id="6375836">.</span><span class="ident" id="6375837">Closer</span><br>
<span class="lineno"></span><span class="op" id="6375844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6375847">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="comment" id="6375915">//&nbsp;This&nbsp;structure&nbsp;doesn&#39;t&nbsp;exist&nbsp;on-disk,&nbsp;but&nbsp;eases&nbsp;navigation</span><br>
<span class="lineno">35</span><span class="comment" id="6375977">//&nbsp;through&nbsp;the&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6376005">type</span>&nbsp;<span class="ident" id="6376010">SectionHeader</span>&nbsp;<span class="keyword" id="6376024">struct</span>&nbsp;<span class="op" id="6376031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6376034">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6376041">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6376049">Size</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6376056">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6376064">Offset</span>&nbsp;<span class="builtintype" id="6376071">uint32</span><br>
<span class="lineno">40</span><span class="op" id="6376078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6376081">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6376146">type</span>&nbsp;<span class="ident" id="6376151">Section</span>&nbsp;<span class="keyword" id="6376159">struct</span>&nbsp;<span class="op" id="6376166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6376169">SectionHeader</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6376185">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6376223">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6376263">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6376298">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6376346">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6376396">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6376420">io</span><span class="op" id="6376422">.</span><span class="ident" id="6376423">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6376433">sr</span>&nbsp;<span class="op" id="6376436">*</span><span class="ident" id="6376437">io</span><span class="op" id="6376439">.</span><span class="ident" id="6376440">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6376454">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="6376457">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6376525">func</span>&nbsp;<span class="op" id="6376530">(</span><span class="ident" id="6376531">s</span>&nbsp;<span class="op" id="6376533">*</span><span class="ident" id="6376534">Section</span><span class="op" id="6376541">)</span>&nbsp;<span class="ident" id="6376543">Data</span><span class="op" id="6376547">(</span><span class="op" id="6376548">)</span>&nbsp;<span class="op" id="6376550">(</span><span class="op" id="6376551">[</span><span class="op" id="6376552">]</span><span class="builtintype" id="6376553">byte</span><span class="op" id="6376557">,</span>&nbsp;<span class="builtintype" id="6376559">error</span><span class="op" id="6376564">)</span>&nbsp;<span class="op" id="6376566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6376569">dat</span>&nbsp;<span class="op" id="6376573">:=</span>&nbsp;<span class="builtinfunc" id="6376576">make</span><span class="op" id="6376580">(</span><span class="op" id="6376581">[</span><span class="op" id="6376582">]</span><span class="builtintype" id="6376583">byte</span><span class="op" id="6376587">,</span>&nbsp;<span class="ident" id="6376589">s</span><span class="op" id="6376590">.</span><span class="ident" id="6376591">sr</span><span class="op" id="6376593">.</span><span class="ident" id="6376594">Size</span><span class="op" id="6376598">(</span><span class="op" id="6376599">)</span><span class="op" id="6376600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6376603">n</span><span class="op" id="6376604">,</span>&nbsp;<span class="ident" id="6376606">err</span>&nbsp;<span class="op" id="6376610">:=</span>&nbsp;<span class="ident" id="6376613">s</span><span class="op" id="6376614">.</span><span class="ident" id="6376615">sr</span><span class="op" id="6376617">.</span><span class="ident" id="6376618">ReadAt</span><span class="op" id="6376624">(</span><span class="ident" id="6376625">dat</span><span class="op" id="6376628">,</span>&nbsp;<span class="num" id="6376630">0</span><span class="op" id="6376631">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6376634">if</span>&nbsp;<span class="ident" id="6376637">n</span>&nbsp;<span class="op" id="6376639">==</span>&nbsp;<span class="builtinfunc" id="6376642">len</span><span class="op" id="6376645">(</span><span class="ident" id="6376646">dat</span><span class="op" id="6376649">)</span>&nbsp;<span class="op" id="6376651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6376655">err</span>&nbsp;<span class="op" id="6376659">=</span>&nbsp;<span class="ident" id="6376661">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6376666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6376669">return</span>&nbsp;<span class="ident" id="6376676">dat</span><span class="op" id="6376679">[</span><span class="num" id="6376680">0</span><span class="op" id="6376681">:</span><span class="ident" id="6376682">n</span><span class="op" id="6376683">]</span><span class="op" id="6376684">,</span>&nbsp;<span class="ident" id="6376686">err</span><br>
<span class="lineno"></span><span class="op" id="6376690">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="6376693">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6376760">func</span>&nbsp;<span class="op" id="6376765">(</span><span class="ident" id="6376766">s</span>&nbsp;<span class="op" id="6376768">*</span><span class="ident" id="6376769">Section</span><span class="op" id="6376776">)</span>&nbsp;<span class="ident" id="6376778">Open</span><span class="op" id="6376782">(</span><span class="op" id="6376783">)</span>&nbsp;<span class="ident" id="6376785">io</span><span class="op" id="6376787">.</span><span class="ident" id="6376788">ReadSeeker</span>&nbsp;<span class="op" id="6376799">{</span>&nbsp;<span class="keyword" id="6376801">return</span>&nbsp;<span class="ident" id="6376808">io</span><span class="op" id="6376810">.</span><span class="ident" id="6376811">NewSectionReader</span><span class="op" id="6376827">(</span><span class="ident" id="6376828">s</span><span class="op" id="6376829">.</span><span class="ident" id="6376830">sr</span><span class="op" id="6376832">,</span>&nbsp;<span class="num" id="6376834">0</span><span class="op" id="6376835">,</span>&nbsp;<span class="num" id="6376837">1</span><span class="op" id="6376838">&lt;&lt;</span><span class="num" id="6376840">63</span><span class="op" id="6376842">-</span><span class="num" id="6376843">1</span><span class="op" id="6376844">)</span>&nbsp;<span class="op" id="6376846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6376849">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno">70</span><span class="keyword" id="6376921">type</span>&nbsp;<span class="ident" id="6376926">Sym</span>&nbsp;<span class="keyword" id="6376930">struct</span>&nbsp;<span class="op" id="6376937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6376940">Value</span>&nbsp;<span class="ident" id="6376946">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6376954">Type</span>&nbsp;&nbsp;<span class="builtintype" id="6376960">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6376966">Name</span>&nbsp;&nbsp;<span class="builtintype" id="6376972">string</span><br>
<span class="lineno"></span><span class="op" id="6376979">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="6376982">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="6377013">//&nbsp;formatError&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;operations&nbsp;if&nbsp;the&nbsp;data&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="6377076">//&nbsp;not&nbsp;have&nbsp;the&nbsp;correct&nbsp;format&nbsp;for&nbsp;an&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6377127">type</span>&nbsp;<span class="ident" id="6377132">formatError</span>&nbsp;<span class="keyword" id="6377144">struct</span>&nbsp;<span class="op" id="6377151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6377154">off</span>&nbsp;<span class="builtintype" id="6377158">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6377163">msg</span>&nbsp;<span class="builtintype" id="6377167">string</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6377175">val</span>&nbsp;<span class="keyword" id="6377179">interface</span><span class="op" id="6377188">{</span><span class="op" id="6377189">}</span><br>
<span class="lineno"></span><span class="op" id="6377191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6377194">func</span>&nbsp;<span class="op" id="6377199">(</span><span class="ident" id="6377200">e</span>&nbsp;<span class="op" id="6377202">*</span><span class="ident" id="6377203">formatError</span><span class="op" id="6377214">)</span>&nbsp;<span class="ident" id="6377216">Error</span><span class="op" id="6377221">(</span><span class="op" id="6377222">)</span>&nbsp;<span class="builtintype" id="6377224">string</span>&nbsp;<span class="op" id="6377231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6377234">msg</span>&nbsp;<span class="op" id="6377238">:=</span>&nbsp;<span class="ident" id="6377241">e</span><span class="op" id="6377242">.</span><span class="ident" id="6377243">msg</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6377248">if</span>&nbsp;<span class="ident" id="6377251">e</span><span class="op" id="6377252">.</span><span class="ident" id="6377253">val</span>&nbsp;<span class="op" id="6377257">!=</span>&nbsp;<span class="ident" id="6377260">nil</span>&nbsp;<span class="op" id="6377264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6377268">msg</span>&nbsp;<span class="op" id="6377272">+=</span>&nbsp;<span class="ident" id="6377275">fmt</span><span class="op" id="6377278">.</span><span class="ident" id="6377279">Sprintf</span><span class="op" id="6377286">(</span><span class="string" id="6377287">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="6377294">,</span>&nbsp;<span class="ident" id="6377296">e</span><span class="op" id="6377297">.</span><span class="ident" id="6377298">val</span><span class="op" id="6377301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6377304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6377307">msg</span>&nbsp;<span class="op" id="6377311">+=</span>&nbsp;<span class="ident" id="6377314">fmt</span><span class="op" id="6377317">.</span><span class="ident" id="6377318">Sprintf</span><span class="op" id="6377325">(</span><span class="string" id="6377326">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="6377350">,</span>&nbsp;<span class="ident" id="6377352">e</span><span class="op" id="6377353">.</span><span class="ident" id="6377354">off</span><span class="op" id="6377357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6377360">return</span>&nbsp;<span class="ident" id="6377367">msg</span><br>
<span class="lineno">95</span><span class="op" id="6377371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6377374">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="6377467">func</span>&nbsp;<span class="ident" id="6377472">Open</span><span class="op" id="6377476">(</span><span class="ident" id="6377477">name</span>&nbsp;<span class="builtintype" id="6377482">string</span><span class="op" id="6377488">)</span>&nbsp;<span class="op" id="6377490">(</span><span class="op" id="6377491">*</span><span class="ident" id="6377492">File</span><span class="op" id="6377496">,</span>&nbsp;<span class="builtintype" id="6377498">error</span><span class="op" id="6377503">)</span>&nbsp;<span class="op" id="6377505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6377508">f</span><span class="op" id="6377509">,</span>&nbsp;<span class="ident" id="6377511">err</span>&nbsp;<span class="op" id="6377515">:=</span>&nbsp;<span class="ident" id="6377518">os</span><span class="op" id="6377520">.</span><span class="ident" id="6377521">Open</span><span class="op" id="6377525">(</span><span class="ident" id="6377526">name</span><span class="op" id="6377530">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6377533">if</span>&nbsp;<span class="ident" id="6377536">err</span>&nbsp;<span class="op" id="6377540">!=</span>&nbsp;<span class="ident" id="6377543">nil</span>&nbsp;<span class="op" id="6377547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6377551">return</span>&nbsp;<span class="ident" id="6377558">nil</span><span class="op" id="6377561">,</span>&nbsp;<span class="ident" id="6377563">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6377568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6377571">ff</span><span class="op" id="6377573">,</span>&nbsp;<span class="ident" id="6377575">err</span>&nbsp;<span class="op" id="6377579">:=</span>&nbsp;<span class="ident" id="6377582">NewFile</span><span class="op" id="6377589">(</span><span class="ident" id="6377590">f</span><span class="op" id="6377591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6377594">if</span>&nbsp;<span class="ident" id="6377597">err</span>&nbsp;<span class="op" id="6377601">!=</span>&nbsp;<span class="ident" id="6377604">nil</span>&nbsp;<span class="op" id="6377608">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6377612">f</span><span class="op" id="6377613">.</span><span class="ident" id="6377614">Close</span><span class="op" id="6377619">(</span><span class="op" id="6377620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6377624">return</span>&nbsp;<span class="ident" id="6377631">nil</span><span class="op" id="6377634">,</span>&nbsp;<span class="ident" id="6377636">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6377641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6377644">ff</span><span class="op" id="6377646">.</span><span class="ident" id="6377647">closer</span>&nbsp;<span class="op" id="6377654">=</span>&nbsp;<span class="ident" id="6377656">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6377659">return</span>&nbsp;<span class="ident" id="6377666">ff</span><span class="op" id="6377668">,</span>&nbsp;<span class="ident" id="6377670">nil</span><br>
<span class="lineno">110</span><span class="op" id="6377674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6377677">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="6377703">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="6377770">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno">115</span><span class="keyword" id="6377794">func</span>&nbsp;<span class="op" id="6377799">(</span><span class="ident" id="6377800">f</span>&nbsp;<span class="op" id="6377802">*</span><span class="ident" id="6377803">File</span><span class="op" id="6377807">)</span>&nbsp;<span class="ident" id="6377809">Close</span><span class="op" id="6377814">(</span><span class="op" id="6377815">)</span>&nbsp;<span class="builtintype" id="6377817">error</span>&nbsp;<span class="op" id="6377823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6377826">var</span>&nbsp;<span class="ident" id="6377830">err</span>&nbsp;<span class="builtintype" id="6377834">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6377841">if</span>&nbsp;<span class="ident" id="6377844">f</span><span class="op" id="6377845">.</span><span class="ident" id="6377846">closer</span>&nbsp;<span class="op" id="6377853">!=</span>&nbsp;<span class="ident" id="6377856">nil</span>&nbsp;<span class="op" id="6377860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6377864">err</span>&nbsp;<span class="op" id="6377868">=</span>&nbsp;<span class="ident" id="6377870">f</span><span class="op" id="6377871">.</span><span class="ident" id="6377872">closer</span><span class="op" id="6377878">.</span><span class="ident" id="6377879">Close</span><span class="op" id="6377884">(</span><span class="op" id="6377885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6377889">f</span><span class="op" id="6377890">.</span><span class="ident" id="6377891">closer</span>&nbsp;<span class="op" id="6377898">=</span>&nbsp;<span class="ident" id="6377900">nil</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6377905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6377908">return</span>&nbsp;<span class="ident" id="6377915">err</span><br>
<span class="lineno"></span><span class="op" id="6377919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6377922">func</span>&nbsp;<span class="ident" id="6377927">parseMagic</span><span class="op" id="6377937">(</span><span class="ident" id="6377938">magic</span>&nbsp;<span class="op" id="6377944">[</span><span class="op" id="6377945">]</span><span class="builtintype" id="6377946">byte</span><span class="op" id="6377950">)</span>&nbsp;<span class="op" id="6377952">(</span><span class="builtintype" id="6377953">uint32</span><span class="op" id="6377959">,</span>&nbsp;<span class="builtintype" id="6377961">error</span><span class="op" id="6377966">)</span>&nbsp;<span class="op" id="6377968">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6377971">m</span>&nbsp;<span class="op" id="6377973">:=</span>&nbsp;<span class="ident" id="6377976">binary</span><span class="op" id="6377982">.</span><span class="ident" id="6377983">BigEndian</span><span class="op" id="6377992">.</span><span class="ident" id="6377993">Uint32</span><span class="op" id="6377999">(</span><span class="ident" id="6378000">magic</span><span class="op" id="6378005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6378008">switch</span>&nbsp;<span class="ident" id="6378015">m</span>&nbsp;<span class="op" id="6378017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6378020">case</span>&nbsp;<span class="ident" id="6378025">Magic386</span><span class="op" id="6378033">,</span>&nbsp;<span class="ident" id="6378035">MagicAMD64</span><span class="op" id="6378045">,</span>&nbsp;<span class="ident" id="6378047">MagicARM</span><span class="op" id="6378055">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6378059">return</span>&nbsp;<span class="ident" id="6378066">m</span><span class="op" id="6378067">,</span>&nbsp;<span class="ident" id="6378069">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6378074">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6378077">return</span>&nbsp;<span class="num" id="6378084">0</span><span class="op" id="6378085">,</span>&nbsp;<span class="op" id="6378087">&amp;</span><span class="ident" id="6378088">formatError</span><span class="op" id="6378099">{</span><span class="num" id="6378100">0</span><span class="op" id="6378101">,</span>&nbsp;<span class="string" id="6378103">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6378121">,</span>&nbsp;<span class="ident" id="6378123">magic</span><span class="op" id="6378128">}</span><br>
<span class="lineno"></span><span class="op" id="6378130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6378133">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="6378218">//&nbsp;The&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno">135</span><span class="keyword" id="6378291">func</span>&nbsp;<span class="ident" id="6378296">NewFile</span><span class="op" id="6378303">(</span><span class="ident" id="6378304">r</span>&nbsp;<span class="ident" id="6378306">io</span><span class="op" id="6378308">.</span><span class="ident" id="6378309">ReaderAt</span><span class="op" id="6378317">)</span>&nbsp;<span class="op" id="6378319">(</span><span class="op" id="6378320">*</span><span class="ident" id="6378321">File</span><span class="op" id="6378325">,</span>&nbsp;<span class="builtintype" id="6378327">error</span><span class="op" id="6378332">)</span>&nbsp;<span class="op" id="6378334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6378337">sr</span>&nbsp;<span class="op" id="6378340">:=</span>&nbsp;<span class="ident" id="6378343">io</span><span class="op" id="6378345">.</span><span class="ident" id="6378346">NewSectionReader</span><span class="op" id="6378362">(</span><span class="ident" id="6378363">r</span><span class="op" id="6378364">,</span>&nbsp;<span class="num" id="6378366">0</span><span class="op" id="6378367">,</span>&nbsp;<span class="num" id="6378369">1</span><span class="op" id="6378370">&lt;&lt;</span><span class="num" id="6378372">63</span><span class="op" id="6378374">-</span><span class="num" id="6378375">1</span><span class="op" id="6378376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6378379">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;Plan&nbsp;9&nbsp;magic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6378412">var</span>&nbsp;<span class="ident" id="6378416">magic</span>&nbsp;<span class="op" id="6378422">[</span><span class="num" id="6378423">4</span><span class="op" id="6378424">]</span><span class="builtintype" id="6378425">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6378431">if</span>&nbsp;<span class="ident" id="6378434">_</span><span class="op" id="6378435">,</span>&nbsp;<span class="ident" id="6378437">err</span>&nbsp;<span class="op" id="6378441">:=</span>&nbsp;<span class="ident" id="6378444">r</span><span class="op" id="6378445">.</span><span class="ident" id="6378446">ReadAt</span><span class="op" id="6378452">(</span><span class="ident" id="6378453">magic</span><span class="op" id="6378458">[</span><span class="op" id="6378459">:</span><span class="op" id="6378460">]</span><span class="op" id="6378461">,</span>&nbsp;<span class="num" id="6378463">0</span><span class="op" id="6378464">)</span><span class="op" id="6378465">;</span>&nbsp;<span class="ident" id="6378467">err</span>&nbsp;<span class="op" id="6378471">!=</span>&nbsp;<span class="ident" id="6378474">nil</span>&nbsp;<span class="op" id="6378478">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6378482">return</span>&nbsp;<span class="ident" id="6378489">nil</span><span class="op" id="6378492">,</span>&nbsp;<span class="ident" id="6378494">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6378499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6378502">_</span><span class="op" id="6378503">,</span>&nbsp;<span class="ident" id="6378505">err</span>&nbsp;<span class="op" id="6378509">:=</span>&nbsp;<span class="ident" id="6378512">parseMagic</span><span class="op" id="6378522">(</span><span class="ident" id="6378523">magic</span><span class="op" id="6378528">[</span><span class="op" id="6378529">:</span><span class="op" id="6378530">]</span><span class="op" id="6378531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6378534">if</span>&nbsp;<span class="ident" id="6378537">err</span>&nbsp;<span class="op" id="6378541">!=</span>&nbsp;<span class="ident" id="6378544">nil</span>&nbsp;<span class="op" id="6378548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6378552">return</span>&nbsp;<span class="ident" id="6378559">nil</span><span class="op" id="6378562">,</span>&nbsp;<span class="ident" id="6378564">err</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6378569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6378573">ph</span>&nbsp;<span class="op" id="6378576">:=</span>&nbsp;<span class="builtinfunc" id="6378579">new</span><span class="op" id="6378582">(</span><span class="ident" id="6378583">prog</span><span class="op" id="6378587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6378590">if</span>&nbsp;<span class="ident" id="6378593">err</span>&nbsp;<span class="op" id="6378597">:=</span>&nbsp;<span class="ident" id="6378600">binary</span><span class="op" id="6378606">.</span><span class="ident" id="6378607">Read</span><span class="op" id="6378611">(</span><span class="ident" id="6378612">sr</span><span class="op" id="6378614">,</span>&nbsp;<span class="ident" id="6378616">binary</span><span class="op" id="6378622">.</span><span class="ident" id="6378623">BigEndian</span><span class="op" id="6378632">,</span>&nbsp;<span class="ident" id="6378634">ph</span><span class="op" id="6378636">)</span><span class="op" id="6378637">;</span>&nbsp;<span class="ident" id="6378639">err</span>&nbsp;<span class="op" id="6378643">!=</span>&nbsp;<span class="ident" id="6378646">nil</span>&nbsp;<span class="op" id="6378650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6378654">return</span>&nbsp;<span class="ident" id="6378661">nil</span><span class="op" id="6378664">,</span>&nbsp;<span class="ident" id="6378666">err</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6378671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6378675">f</span>&nbsp;<span class="op" id="6378677">:=</span>&nbsp;<span class="op" id="6378680">&amp;</span><span class="ident" id="6378681">File</span><span class="op" id="6378685">{</span><span class="ident" id="6378686">FileHeader</span><span class="op" id="6378696">:</span>&nbsp;<span class="ident" id="6378698">FileHeader</span><span class="op" id="6378708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6378712">Magic</span><span class="op" id="6378717">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378725">ph</span><span class="op" id="6378727">.</span><span class="ident" id="6378728">Magic</span><span class="op" id="6378733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6378737">Bss</span><span class="op" id="6378740">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378750">ph</span><span class="op" id="6378752">.</span><span class="ident" id="6378753">Bss</span><span class="op" id="6378756">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6378760">Entry</span><span class="op" id="6378765">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6378773">uint64</span><span class="op" id="6378779">(</span><span class="ident" id="6378780">ph</span><span class="op" id="6378782">.</span><span class="ident" id="6378783">Entry</span><span class="op" id="6378788">)</span><span class="op" id="6378789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6378793">PtrSize</span><span class="op" id="6378800">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6378806">4</span><span class="op" id="6378807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6378811">LoadAddress</span><span class="op" id="6378822">:</span>&nbsp;<span class="num" id="6378824">0x1000</span><span class="op" id="6378830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6378834">HdrSize</span><span class="op" id="6378841">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6378847">4</span>&nbsp;<span class="op" id="6378849">*</span>&nbsp;<span class="num" id="6378851">8</span><span class="op" id="6378852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6378855">}</span><span class="op" id="6378856">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6378860">if</span>&nbsp;<span class="ident" id="6378863">ph</span><span class="op" id="6378865">.</span><span class="ident" id="6378866">Magic</span><span class="op" id="6378871">&amp;</span><span class="ident" id="6378872">Magic64</span>&nbsp;<span class="op" id="6378880">!=</span>&nbsp;<span class="num" id="6378883">0</span>&nbsp;<span class="op" id="6378885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6378889">if</span>&nbsp;<span class="ident" id="6378892">err</span>&nbsp;<span class="op" id="6378896">:=</span>&nbsp;<span class="ident" id="6378899">binary</span><span class="op" id="6378905">.</span><span class="ident" id="6378906">Read</span><span class="op" id="6378910">(</span><span class="ident" id="6378911">sr</span><span class="op" id="6378913">,</span>&nbsp;<span class="ident" id="6378915">binary</span><span class="op" id="6378921">.</span><span class="ident" id="6378922">BigEndian</span><span class="op" id="6378931">,</span>&nbsp;<span class="op" id="6378933">&amp;</span><span class="ident" id="6378934">f</span><span class="op" id="6378935">.</span><span class="ident" id="6378936">Entry</span><span class="op" id="6378941">)</span><span class="op" id="6378942">;</span>&nbsp;<span class="ident" id="6378944">err</span>&nbsp;<span class="op" id="6378948">!=</span>&nbsp;<span class="ident" id="6378951">nil</span>&nbsp;<span class="op" id="6378955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6378960">return</span>&nbsp;<span class="ident" id="6378967">nil</span><span class="op" id="6378970">,</span>&nbsp;<span class="ident" id="6378972">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6378978">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6378982">f</span><span class="op" id="6378983">.</span><span class="ident" id="6378984">PtrSize</span>&nbsp;<span class="op" id="6378992">=</span>&nbsp;<span class="num" id="6378994">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6378998">f</span><span class="op" id="6378999">.</span><span class="ident" id="6379000">LoadAddress</span>&nbsp;<span class="op" id="6379012">=</span>&nbsp;<span class="num" id="6379014">0x200000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379025">f</span><span class="op" id="6379026">.</span><span class="ident" id="6379027">HdrSize</span>&nbsp;<span class="op" id="6379035">+=</span>&nbsp;<span class="num" id="6379038">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6379041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6379045">var</span>&nbsp;<span class="ident" id="6379049">sects</span>&nbsp;<span class="op" id="6379055">=</span>&nbsp;<span class="op" id="6379057">[</span><span class="op" id="6379058">]</span><span class="keyword" id="6379059">struct</span>&nbsp;<span class="op" id="6379066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379070">name</span>&nbsp;<span class="builtintype" id="6379075">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379084">size</span>&nbsp;<span class="builtintype" id="6379089">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6379097">}</span><span class="op" id="6379098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6379102">{</span><span class="string" id="6379103">&#34;text&#34;</span><span class="op" id="6379109">,</span>&nbsp;<span class="ident" id="6379111">ph</span><span class="op" id="6379113">.</span><span class="ident" id="6379114">Text</span><span class="op" id="6379118">}</span><span class="op" id="6379119">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6379123">{</span><span class="string" id="6379124">&#34;data&#34;</span><span class="op" id="6379130">,</span>&nbsp;<span class="ident" id="6379132">ph</span><span class="op" id="6379134">.</span><span class="ident" id="6379135">Data</span><span class="op" id="6379139">}</span><span class="op" id="6379140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6379144">{</span><span class="string" id="6379145">&#34;syms&#34;</span><span class="op" id="6379151">,</span>&nbsp;<span class="ident" id="6379153">ph</span><span class="op" id="6379155">.</span><span class="ident" id="6379156">Syms</span><span class="op" id="6379160">}</span><span class="op" id="6379161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6379165">{</span><span class="string" id="6379166">&#34;spsz&#34;</span><span class="op" id="6379172">,</span>&nbsp;<span class="ident" id="6379174">ph</span><span class="op" id="6379176">.</span><span class="ident" id="6379177">Spsz</span><span class="op" id="6379181">}</span><span class="op" id="6379182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6379186">{</span><span class="string" id="6379187">&#34;pcsz&#34;</span><span class="op" id="6379193">,</span>&nbsp;<span class="ident" id="6379195">ph</span><span class="op" id="6379197">.</span><span class="ident" id="6379198">Pcsz</span><span class="op" id="6379202">}</span><span class="op" id="6379203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6379206">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379210">f</span><span class="op" id="6379211">.</span><span class="ident" id="6379212">Sections</span>&nbsp;<span class="op" id="6379221">=</span>&nbsp;<span class="builtinfunc" id="6379223">make</span><span class="op" id="6379227">(</span><span class="op" id="6379228">[</span><span class="op" id="6379229">]</span><span class="op" id="6379230">*</span><span class="ident" id="6379231">Section</span><span class="op" id="6379238">,</span>&nbsp;<span class="num" id="6379240">5</span><span class="op" id="6379241">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379245">off</span>&nbsp;<span class="op" id="6379249">:=</span>&nbsp;<span class="builtintype" id="6379252">uint32</span><span class="op" id="6379258">(</span><span class="ident" id="6379259">f</span><span class="op" id="6379260">.</span><span class="ident" id="6379261">HdrSize</span><span class="op" id="6379268">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6379272">for</span>&nbsp;<span class="ident" id="6379276">i</span><span class="op" id="6379277">,</span>&nbsp;<span class="ident" id="6379279">sect</span>&nbsp;<span class="op" id="6379284">:=</span>&nbsp;<span class="keyword" id="6379287">range</span>&nbsp;<span class="ident" id="6379293">sects</span>&nbsp;<span class="op" id="6379299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379303">s</span>&nbsp;<span class="op" id="6379305">:=</span>&nbsp;<span class="builtinfunc" id="6379308">new</span><span class="op" id="6379311">(</span><span class="ident" id="6379312">Section</span><span class="op" id="6379319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379323">s</span><span class="op" id="6379324">.</span><span class="ident" id="6379325">SectionHeader</span>&nbsp;<span class="op" id="6379339">=</span>&nbsp;<span class="ident" id="6379341">SectionHeader</span><span class="op" id="6379354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379359">Name</span><span class="op" id="6379363">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6379367">sect</span><span class="op" id="6379371">.</span><span class="ident" id="6379372">name</span><span class="op" id="6379376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379381">Size</span><span class="op" id="6379385">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6379389">sect</span><span class="op" id="6379393">.</span><span class="ident" id="6379394">size</span><span class="op" id="6379398">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379403">Offset</span><span class="op" id="6379409">:</span>&nbsp;<span class="ident" id="6379411">off</span><span class="op" id="6379414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6379418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379422">off</span>&nbsp;<span class="op" id="6379426">+=</span>&nbsp;<span class="ident" id="6379429">sect</span><span class="op" id="6379433">.</span><span class="ident" id="6379434">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379441">s</span><span class="op" id="6379442">.</span><span class="ident" id="6379443">sr</span>&nbsp;<span class="op" id="6379446">=</span>&nbsp;<span class="ident" id="6379448">io</span><span class="op" id="6379450">.</span><span class="ident" id="6379451">NewSectionReader</span><span class="op" id="6379467">(</span><span class="ident" id="6379468">r</span><span class="op" id="6379469">,</span>&nbsp;<span class="ident" id="6379471">int64</span><span class="op" id="6379476">(</span><span class="ident" id="6379477">s</span><span class="op" id="6379478">.</span><span class="ident" id="6379479">Offset</span><span class="op" id="6379485">)</span><span class="op" id="6379486">,</span>&nbsp;<span class="ident" id="6379488">int64</span><span class="op" id="6379493">(</span><span class="ident" id="6379494">s</span><span class="op" id="6379495">.</span><span class="ident" id="6379496">Size</span><span class="op" id="6379500">)</span><span class="op" id="6379501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379505">s</span><span class="op" id="6379506">.</span><span class="ident" id="6379507">ReaderAt</span>&nbsp;<span class="op" id="6379516">=</span>&nbsp;<span class="ident" id="6379518">s</span><span class="op" id="6379519">.</span><span class="ident" id="6379520">sr</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379525">f</span><span class="op" id="6379526">.</span><span class="ident" id="6379527">Sections</span><span class="op" id="6379535">[</span><span class="ident" id="6379536">i</span><span class="op" id="6379537">]</span>&nbsp;<span class="op" id="6379539">=</span>&nbsp;<span class="ident" id="6379541">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6379544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6379548">return</span>&nbsp;<span class="ident" id="6379555">f</span><span class="op" id="6379556">,</span>&nbsp;<span class="ident" id="6379558">nil</span><br>
<span class="lineno"></span><span class="op" id="6379562">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="6379565">func</span>&nbsp;<span class="ident" id="6379570">walksymtab</span><span class="op" id="6379580">(</span><span class="ident" id="6379581">data</span>&nbsp;<span class="op" id="6379586">[</span><span class="op" id="6379587">]</span><span class="builtintype" id="6379588">byte</span><span class="op" id="6379592">,</span>&nbsp;<span class="ident" id="6379594">ptrsz</span>&nbsp;<span class="builtintype" id="6379600">int</span><span class="op" id="6379603">,</span>&nbsp;<span class="ident" id="6379605">fn</span>&nbsp;<span class="keyword" id="6379608">func</span><span class="op" id="6379612">(</span><span class="ident" id="6379613">sym</span><span class="op" id="6379616">)</span>&nbsp;<span class="builtintype" id="6379618">error</span><span class="op" id="6379623">)</span>&nbsp;<span class="builtintype" id="6379625">error</span>&nbsp;<span class="op" id="6379631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6379634">var</span>&nbsp;<span class="ident" id="6379638">order</span>&nbsp;<span class="ident" id="6379644">binary</span><span class="op" id="6379650">.</span><span class="ident" id="6379651">ByteOrder</span>&nbsp;<span class="op" id="6379661">=</span>&nbsp;<span class="ident" id="6379663">binary</span><span class="op" id="6379669">.</span><span class="ident" id="6379670">BigEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6379681">var</span>&nbsp;<span class="ident" id="6379685">s</span>&nbsp;<span class="ident" id="6379687">sym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379692">p</span>&nbsp;<span class="op" id="6379694">:=</span>&nbsp;<span class="ident" id="6379697">data</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6379703">for</span>&nbsp;<span class="builtinfunc" id="6379707">len</span><span class="op" id="6379710">(</span><span class="ident" id="6379711">p</span><span class="op" id="6379712">)</span>&nbsp;<span class="op" id="6379714">&gt;=</span>&nbsp;<span class="num" id="6379717">4</span>&nbsp;<span class="op" id="6379719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6379723">//&nbsp;Symbol&nbsp;type,&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6379748">if</span>&nbsp;<span class="builtinfunc" id="6379751">len</span><span class="op" id="6379754">(</span><span class="ident" id="6379755">p</span><span class="op" id="6379756">)</span>&nbsp;<span class="op" id="6379758">&lt;</span>&nbsp;<span class="ident" id="6379760">ptrsz</span>&nbsp;<span class="op" id="6379766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6379771">return</span>&nbsp;<span class="op" id="6379778">&amp;</span><span class="ident" id="6379779">formatError</span><span class="op" id="6379790">{</span><span class="builtinfunc" id="6379791">len</span><span class="op" id="6379794">(</span><span class="ident" id="6379795">data</span><span class="op" id="6379799">)</span><span class="op" id="6379800">,</span>&nbsp;<span class="string" id="6379802">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6379818">,</span>&nbsp;<span class="ident" id="6379820">nil</span><span class="op" id="6379823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6379827">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6379831">//&nbsp;fixed-width&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6379854">if</span>&nbsp;<span class="ident" id="6379857">ptrsz</span>&nbsp;<span class="op" id="6379863">==</span>&nbsp;<span class="num" id="6379866">8</span>&nbsp;<span class="op" id="6379868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379873">s</span><span class="op" id="6379874">.</span><span class="ident" id="6379875">value</span>&nbsp;<span class="op" id="6379881">=</span>&nbsp;<span class="ident" id="6379883">order</span><span class="op" id="6379888">.</span><span class="ident" id="6379889">Uint64</span><span class="op" id="6379895">(</span><span class="ident" id="6379896">p</span><span class="op" id="6379897">[</span><span class="num" id="6379898">0</span><span class="op" id="6379899">:</span><span class="num" id="6379900">8</span><span class="op" id="6379901">]</span><span class="op" id="6379902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379907">p</span>&nbsp;<span class="op" id="6379909">=</span>&nbsp;<span class="ident" id="6379911">p</span><span class="op" id="6379912">[</span><span class="num" id="6379913">8</span><span class="op" id="6379914">:</span><span class="op" id="6379915">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6379919">}</span>&nbsp;<span class="keyword" id="6379921">else</span>&nbsp;<span class="op" id="6379926">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379931">s</span><span class="op" id="6379932">.</span><span class="ident" id="6379933">value</span>&nbsp;<span class="op" id="6379939">=</span>&nbsp;<span class="ident" id="6379941">uint64</span><span class="op" id="6379947">(</span><span class="ident" id="6379948">order</span><span class="op" id="6379953">.</span><span class="ident" id="6379954">Uint32</span><span class="op" id="6379960">(</span><span class="ident" id="6379961">p</span><span class="op" id="6379962">[</span><span class="num" id="6379963">0</span><span class="op" id="6379964">:</span><span class="num" id="6379965">4</span><span class="op" id="6379966">]</span><span class="op" id="6379967">)</span><span class="op" id="6379968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6379973">p</span>&nbsp;<span class="op" id="6379975">=</span>&nbsp;<span class="ident" id="6379977">p</span><span class="op" id="6379978">[</span><span class="num" id="6379979">4</span><span class="op" id="6379980">:</span><span class="op" id="6379981">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6379985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6379990">var</span>&nbsp;<span class="ident" id="6379994">typ</span>&nbsp;<span class="builtintype" id="6379998">byte</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380005">typ</span>&nbsp;<span class="op" id="6380009">=</span>&nbsp;<span class="ident" id="6380011">p</span><span class="op" id="6380012">[</span><span class="num" id="6380013">0</span><span class="op" id="6380014">]</span>&nbsp;<span class="op" id="6380016">&amp;</span>&nbsp;<span class="num" id="6380018">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380025">s</span><span class="op" id="6380026">.</span><span class="ident" id="6380027">typ</span>&nbsp;<span class="op" id="6380031">=</span>&nbsp;<span class="ident" id="6380033">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380039">p</span>&nbsp;<span class="op" id="6380041">=</span>&nbsp;<span class="ident" id="6380043">p</span><span class="op" id="6380044">[</span><span class="num" id="6380045">1</span><span class="op" id="6380046">:</span><span class="op" id="6380047">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6380052">//&nbsp;Name.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380063">var</span>&nbsp;<span class="ident" id="6380067">i</span>&nbsp;<span class="builtintype" id="6380069">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380075">var</span>&nbsp;<span class="ident" id="6380079">nnul</span>&nbsp;<span class="builtintype" id="6380084">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380090">for</span>&nbsp;<span class="ident" id="6380094">i</span>&nbsp;<span class="op" id="6380096">=</span>&nbsp;<span class="num" id="6380098">0</span><span class="op" id="6380099">;</span>&nbsp;<span class="ident" id="6380101">i</span>&nbsp;<span class="op" id="6380103">&lt;</span>&nbsp;<span class="builtinfunc" id="6380105">len</span><span class="op" id="6380108">(</span><span class="ident" id="6380109">p</span><span class="op" id="6380110">)</span><span class="op" id="6380111">;</span>&nbsp;<span class="ident" id="6380113">i</span><span class="op" id="6380114">++</span>&nbsp;<span class="op" id="6380117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380122">if</span>&nbsp;<span class="ident" id="6380125">p</span><span class="op" id="6380126">[</span><span class="ident" id="6380127">i</span><span class="op" id="6380128">]</span>&nbsp;<span class="op" id="6380130">==</span>&nbsp;<span class="num" id="6380133">0</span>&nbsp;<span class="op" id="6380135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380141">nnul</span>&nbsp;<span class="op" id="6380146">=</span>&nbsp;<span class="num" id="6380148">1</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380154">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6380163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6380167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380171">switch</span>&nbsp;<span class="ident" id="6380178">typ</span>&nbsp;<span class="op" id="6380182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380186">case</span>&nbsp;<span class="string" id="6380191">&#39;z&#39;</span><span class="op" id="6380194">,</span>&nbsp;<span class="string" id="6380196">&#39;Z&#39;</span><span class="op" id="6380199">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380204">p</span>&nbsp;<span class="op" id="6380206">=</span>&nbsp;<span class="ident" id="6380208">p</span><span class="op" id="6380209">[</span><span class="ident" id="6380210">i</span><span class="op" id="6380211">+</span><span class="ident" id="6380212">nnul</span><span class="op" id="6380216">:</span><span class="op" id="6380217">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380222">for</span>&nbsp;<span class="ident" id="6380226">i</span>&nbsp;<span class="op" id="6380228">=</span>&nbsp;<span class="num" id="6380230">0</span><span class="op" id="6380231">;</span>&nbsp;<span class="ident" id="6380233">i</span><span class="op" id="6380234">+</span><span class="num" id="6380235">2</span>&nbsp;<span class="op" id="6380237">&lt;=</span>&nbsp;<span class="builtinfunc" id="6380240">len</span><span class="op" id="6380243">(</span><span class="ident" id="6380244">p</span><span class="op" id="6380245">)</span><span class="op" id="6380246">;</span>&nbsp;<span class="ident" id="6380248">i</span>&nbsp;<span class="op" id="6380250">+=</span>&nbsp;<span class="num" id="6380253">2</span>&nbsp;<span class="op" id="6380255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380261">if</span>&nbsp;<span class="ident" id="6380264">p</span><span class="op" id="6380265">[</span><span class="ident" id="6380266">i</span><span class="op" id="6380267">]</span>&nbsp;<span class="op" id="6380269">==</span>&nbsp;<span class="num" id="6380272">0</span>&nbsp;<span class="op" id="6380274">&amp;&amp;</span>&nbsp;<span class="ident" id="6380277">p</span><span class="op" id="6380278">[</span><span class="ident" id="6380279">i</span><span class="op" id="6380280">+</span><span class="num" id="6380281">1</span><span class="op" id="6380282">]</span>&nbsp;<span class="op" id="6380284">==</span>&nbsp;<span class="num" id="6380287">0</span>&nbsp;<span class="op" id="6380289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380296">nnul</span>&nbsp;<span class="op" id="6380301">=</span>&nbsp;<span class="num" id="6380303">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380310">break</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6380320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6380325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6380329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380333">if</span>&nbsp;<span class="builtinfunc" id="6380336">len</span><span class="op" id="6380339">(</span><span class="ident" id="6380340">p</span><span class="op" id="6380341">)</span>&nbsp;<span class="op" id="6380343">&lt;</span>&nbsp;<span class="ident" id="6380345">i</span><span class="op" id="6380346">+</span><span class="ident" id="6380347">nnul</span>&nbsp;<span class="op" id="6380352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380357">return</span>&nbsp;<span class="op" id="6380364">&amp;</span><span class="ident" id="6380365">formatError</span><span class="op" id="6380376">{</span><span class="builtinfunc" id="6380377">len</span><span class="op" id="6380380">(</span><span class="ident" id="6380381">data</span><span class="op" id="6380385">)</span><span class="op" id="6380386">,</span>&nbsp;<span class="string" id="6380388">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6380404">,</span>&nbsp;<span class="ident" id="6380406">nil</span><span class="op" id="6380409">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6380413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380417">s</span><span class="op" id="6380418">.</span><span class="ident" id="6380419">name</span>&nbsp;<span class="op" id="6380424">=</span>&nbsp;<span class="ident" id="6380426">p</span><span class="op" id="6380427">[</span><span class="num" id="6380428">0</span><span class="op" id="6380429">:</span><span class="ident" id="6380430">i</span><span class="op" id="6380431">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380435">i</span>&nbsp;<span class="op" id="6380437">+=</span>&nbsp;<span class="ident" id="6380440">nnul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380447">p</span>&nbsp;<span class="op" id="6380449">=</span>&nbsp;<span class="ident" id="6380451">p</span><span class="op" id="6380452">[</span><span class="ident" id="6380453">i</span><span class="op" id="6380454">:</span><span class="op" id="6380455">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380460">fn</span><span class="op" id="6380462">(</span><span class="ident" id="6380463">s</span><span class="op" id="6380464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6380467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380470">return</span>&nbsp;<span class="ident" id="6380477">nil</span><br>
<span class="lineno"></span><span class="op" id="6380481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="6380484">//&nbsp;NewTable&nbsp;decodes&nbsp;the&nbsp;Go&nbsp;symbol&nbsp;table&nbsp;in&nbsp;data,</span><br>
<span class="lineno"></span><span class="comment" id="6380533">//&nbsp;returning&nbsp;an&nbsp;in-memory&nbsp;representation.</span><br>
<span class="lineno"></span><span class="keyword" id="6380575">func</span>&nbsp;<span class="ident" id="6380580">newTable</span><span class="op" id="6380588">(</span><span class="ident" id="6380589">symtab</span>&nbsp;<span class="op" id="6380596">[</span><span class="op" id="6380597">]</span><span class="builtintype" id="6380598">byte</span><span class="op" id="6380602">,</span>&nbsp;<span class="ident" id="6380604">ptrsz</span>&nbsp;<span class="builtintype" id="6380610">int</span><span class="op" id="6380613">)</span>&nbsp;<span class="op" id="6380615">(</span><span class="op" id="6380616">[</span><span class="op" id="6380617">]</span><span class="ident" id="6380618">Sym</span><span class="op" id="6380621">,</span>&nbsp;<span class="builtintype" id="6380623">error</span><span class="op" id="6380628">)</span>&nbsp;<span class="op" id="6380630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380633">var</span>&nbsp;<span class="ident" id="6380637">n</span>&nbsp;<span class="builtintype" id="6380639">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380644">err</span>&nbsp;<span class="op" id="6380648">:=</span>&nbsp;<span class="ident" id="6380651">walksymtab</span><span class="op" id="6380661">(</span><span class="ident" id="6380662">symtab</span><span class="op" id="6380668">,</span>&nbsp;<span class="ident" id="6380670">ptrsz</span><span class="op" id="6380675">,</span>&nbsp;<span class="keyword" id="6380677">func</span><span class="op" id="6380681">(</span><span class="ident" id="6380682">s</span>&nbsp;<span class="ident" id="6380684">sym</span><span class="op" id="6380687">)</span>&nbsp;<span class="builtintype" id="6380689">error</span>&nbsp;<span class="op" id="6380695">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380699">n</span><span class="op" id="6380700">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380705">return</span>&nbsp;<span class="ident" id="6380712">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6380717">}</span><span class="op" id="6380718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380721">if</span>&nbsp;<span class="ident" id="6380724">err</span>&nbsp;<span class="op" id="6380728">!=</span>&nbsp;<span class="ident" id="6380731">nil</span>&nbsp;<span class="op" id="6380735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380739">return</span>&nbsp;<span class="ident" id="6380746">nil</span><span class="op" id="6380749">,</span>&nbsp;<span class="ident" id="6380751">err</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6380756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380760">fname</span>&nbsp;<span class="op" id="6380766">:=</span>&nbsp;<span class="builtinfunc" id="6380769">make</span><span class="op" id="6380773">(</span><span class="keyword" id="6380774">map</span><span class="op" id="6380777">[</span><span class="builtintype" id="6380778">uint16</span><span class="op" id="6380784">]</span><span class="builtintype" id="6380785">string</span><span class="op" id="6380791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380794">syms</span>&nbsp;<span class="op" id="6380799">:=</span>&nbsp;<span class="builtinfunc" id="6380802">make</span><span class="op" id="6380806">(</span><span class="op" id="6380807">[</span><span class="op" id="6380808">]</span><span class="ident" id="6380809">Sym</span><span class="op" id="6380812">,</span>&nbsp;<span class="num" id="6380814">0</span><span class="op" id="6380815">,</span>&nbsp;<span class="ident" id="6380817">n</span><span class="op" id="6380818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380821">err</span>&nbsp;<span class="op" id="6380825">=</span>&nbsp;<span class="ident" id="6380827">walksymtab</span><span class="op" id="6380837">(</span><span class="ident" id="6380838">symtab</span><span class="op" id="6380844">,</span>&nbsp;<span class="ident" id="6380846">ptrsz</span><span class="op" id="6380851">,</span>&nbsp;<span class="keyword" id="6380853">func</span><span class="op" id="6380857">(</span><span class="ident" id="6380858">s</span>&nbsp;<span class="ident" id="6380860">sym</span><span class="op" id="6380863">)</span>&nbsp;<span class="builtintype" id="6380865">error</span>&nbsp;<span class="op" id="6380871">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380875">n</span>&nbsp;<span class="op" id="6380877">:=</span>&nbsp;<span class="builtinfunc" id="6380880">len</span><span class="op" id="6380883">(</span><span class="ident" id="6380884">syms</span><span class="op" id="6380888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380892">syms</span>&nbsp;<span class="op" id="6380897">=</span>&nbsp;<span class="ident" id="6380899">syms</span><span class="op" id="6380903">[</span><span class="num" id="6380904">0</span>&nbsp;<span class="op" id="6380906">:</span>&nbsp;<span class="ident" id="6380908">n</span><span class="op" id="6380909">+</span><span class="num" id="6380910">1</span><span class="op" id="6380911">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380915">ts</span>&nbsp;<span class="op" id="6380918">:=</span>&nbsp;<span class="op" id="6380921">&amp;</span><span class="ident" id="6380922">syms</span><span class="op" id="6380926">[</span><span class="ident" id="6380927">n</span><span class="op" id="6380928">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380932">ts</span><span class="op" id="6380934">.</span><span class="ident" id="6380935">Type</span>&nbsp;<span class="op" id="6380940">=</span>&nbsp;<span class="builtintype" id="6380942">rune</span><span class="op" id="6380946">(</span><span class="ident" id="6380947">s</span><span class="op" id="6380948">.</span><span class="ident" id="6380949">typ</span><span class="op" id="6380952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6380956">ts</span><span class="op" id="6380958">.</span><span class="ident" id="6380959">Value</span>&nbsp;<span class="op" id="6380965">=</span>&nbsp;<span class="ident" id="6380967">s</span><span class="op" id="6380968">.</span><span class="ident" id="6380969">value</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380977">switch</span>&nbsp;<span class="ident" id="6380984">s</span><span class="op" id="6380985">.</span><span class="ident" id="6380986">typ</span>&nbsp;<span class="op" id="6380990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6380994">default</span><span class="op" id="6381001">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6381006">ts</span><span class="op" id="6381008">.</span><span class="ident" id="6381009">Name</span>&nbsp;<span class="op" id="6381014">=</span>&nbsp;<span class="builtintype" id="6381016">string</span><span class="op" id="6381022">(</span><span class="ident" id="6381023">s</span><span class="op" id="6381024">.</span><span class="ident" id="6381025">name</span><span class="op" id="6381029">[</span><span class="op" id="6381030">:</span><span class="op" id="6381031">]</span><span class="op" id="6381032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381036">case</span>&nbsp;<span class="string" id="6381041">&#39;z&#39;</span><span class="op" id="6381044">,</span>&nbsp;<span class="string" id="6381046">&#39;Z&#39;</span><span class="op" id="6381049">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381054">for</span>&nbsp;<span class="ident" id="6381058">i</span>&nbsp;<span class="op" id="6381060">:=</span>&nbsp;<span class="num" id="6381063">0</span><span class="op" id="6381064">;</span>&nbsp;<span class="ident" id="6381066">i</span>&nbsp;<span class="op" id="6381068">&lt;</span>&nbsp;<span class="builtinfunc" id="6381070">len</span><span class="op" id="6381073">(</span><span class="ident" id="6381074">s</span><span class="op" id="6381075">.</span><span class="ident" id="6381076">name</span><span class="op" id="6381080">)</span><span class="op" id="6381081">;</span>&nbsp;<span class="ident" id="6381083">i</span>&nbsp;<span class="op" id="6381085">+=</span>&nbsp;<span class="num" id="6381088">2</span>&nbsp;<span class="op" id="6381090">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6381096">eltIdx</span>&nbsp;<span class="op" id="6381103">:=</span>&nbsp;<span class="ident" id="6381106">binary</span><span class="op" id="6381112">.</span><span class="ident" id="6381113">BigEndian</span><span class="op" id="6381122">.</span><span class="ident" id="6381123">Uint16</span><span class="op" id="6381129">(</span><span class="ident" id="6381130">s</span><span class="op" id="6381131">.</span><span class="ident" id="6381132">name</span><span class="op" id="6381136">[</span><span class="ident" id="6381137">i</span>&nbsp;<span class="op" id="6381139">:</span>&nbsp;<span class="ident" id="6381141">i</span><span class="op" id="6381142">+</span><span class="num" id="6381143">2</span><span class="op" id="6381144">]</span><span class="op" id="6381145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6381151">elt</span><span class="op" id="6381154">,</span>&nbsp;<span class="ident" id="6381156">ok</span>&nbsp;<span class="op" id="6381159">:=</span>&nbsp;<span class="ident" id="6381162">fname</span><span class="op" id="6381167">[</span><span class="ident" id="6381168">eltIdx</span><span class="op" id="6381174">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381180">if</span>&nbsp;<span class="op" id="6381183">!</span><span class="ident" id="6381184">ok</span>&nbsp;<span class="op" id="6381187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381194">return</span>&nbsp;<span class="op" id="6381201">&amp;</span><span class="ident" id="6381202">formatError</span><span class="op" id="6381213">{</span><span class="op" id="6381214">-</span><span class="num" id="6381215">1</span><span class="op" id="6381216">,</span>&nbsp;<span class="string" id="6381218">&#34;bad&nbsp;filename&nbsp;code&#34;</span><span class="op" id="6381237">,</span>&nbsp;<span class="ident" id="6381239">eltIdx</span><span class="op" id="6381245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6381251">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381257">if</span>&nbsp;<span class="ident" id="6381260">n</span>&nbsp;<span class="op" id="6381262">:=</span>&nbsp;<span class="builtinfunc" id="6381265">len</span><span class="op" id="6381268">(</span><span class="ident" id="6381269">ts</span><span class="op" id="6381271">.</span><span class="ident" id="6381272">Name</span><span class="op" id="6381276">)</span><span class="op" id="6381277">;</span>&nbsp;<span class="ident" id="6381279">n</span>&nbsp;<span class="op" id="6381281">&gt;</span>&nbsp;<span class="num" id="6381283">0</span>&nbsp;<span class="op" id="6381285">&amp;&amp;</span>&nbsp;<span class="ident" id="6381288">ts</span><span class="op" id="6381290">.</span><span class="ident" id="6381291">Name</span><span class="op" id="6381295">[</span><span class="ident" id="6381296">n</span><span class="op" id="6381297">-</span><span class="num" id="6381298">1</span><span class="op" id="6381299">]</span>&nbsp;<span class="op" id="6381301">!=</span>&nbsp;<span class="string" id="6381304">&#39;/&#39;</span>&nbsp;<span class="op" id="6381308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6381315">ts</span><span class="op" id="6381317">.</span><span class="ident" id="6381318">Name</span>&nbsp;<span class="op" id="6381323">+=</span>&nbsp;<span class="string" id="6381326">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6381334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6381340">ts</span><span class="op" id="6381342">.</span><span class="ident" id="6381343">Name</span>&nbsp;<span class="op" id="6381348">+=</span>&nbsp;<span class="ident" id="6381351">elt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6381358">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6381362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381366">switch</span>&nbsp;<span class="ident" id="6381373">s</span><span class="op" id="6381374">.</span><span class="ident" id="6381375">typ</span>&nbsp;<span class="op" id="6381379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381383">case</span>&nbsp;<span class="string" id="6381388">&#39;f&#39;</span><span class="op" id="6381391">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6381396">fname</span><span class="op" id="6381401">[</span><span class="builtintype" id="6381402">uint16</span><span class="op" id="6381408">(</span><span class="ident" id="6381409">s</span><span class="op" id="6381410">.</span><span class="ident" id="6381411">value</span><span class="op" id="6381416">)</span><span class="op" id="6381417">]</span>&nbsp;<span class="op" id="6381419">=</span>&nbsp;<span class="ident" id="6381421">ts</span><span class="op" id="6381423">.</span><span class="ident" id="6381424">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6381431">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381435">return</span>&nbsp;<span class="ident" id="6381442">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6381447">}</span><span class="op" id="6381448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381451">if</span>&nbsp;<span class="ident" id="6381454">err</span>&nbsp;<span class="op" id="6381458">!=</span>&nbsp;<span class="ident" id="6381461">nil</span>&nbsp;<span class="op" id="6381465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381469">return</span>&nbsp;<span class="ident" id="6381476">nil</span><span class="op" id="6381479">,</span>&nbsp;<span class="ident" id="6381481">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6381486">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381490">return</span>&nbsp;<span class="ident" id="6381497">syms</span><span class="op" id="6381501">,</span>&nbsp;<span class="ident" id="6381503">nil</span><br>
<span class="lineno"></span><span class="op" id="6381507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6381510">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.</span><br>
<span class="lineno">305</span><span class="keyword" id="6381553">func</span>&nbsp;<span class="op" id="6381558">(</span><span class="ident" id="6381559">f</span>&nbsp;<span class="op" id="6381561">*</span><span class="ident" id="6381562">File</span><span class="op" id="6381566">)</span>&nbsp;<span class="ident" id="6381568">Symbols</span><span class="op" id="6381575">(</span><span class="op" id="6381576">)</span>&nbsp;<span class="op" id="6381578">(</span><span class="op" id="6381579">[</span><span class="op" id="6381580">]</span><span class="ident" id="6381581">Sym</span><span class="op" id="6381584">,</span>&nbsp;<span class="builtintype" id="6381586">error</span><span class="op" id="6381591">)</span>&nbsp;<span class="op" id="6381593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6381596">symtabSection</span>&nbsp;<span class="op" id="6381610">:=</span>&nbsp;<span class="ident" id="6381613">f</span><span class="op" id="6381614">.</span><span class="ident" id="6381615">Section</span><span class="op" id="6381622">(</span><span class="string" id="6381623">&#34;syms&#34;</span><span class="op" id="6381629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381632">if</span>&nbsp;<span class="ident" id="6381635">symtabSection</span>&nbsp;<span class="op" id="6381649">==</span>&nbsp;<span class="ident" id="6381652">nil</span>&nbsp;<span class="op" id="6381656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381660">return</span>&nbsp;<span class="ident" id="6381667">nil</span><span class="op" id="6381670">,</span>&nbsp;<span class="ident" id="6381672">errors</span><span class="op" id="6381678">.</span><span class="ident" id="6381679">New</span><span class="op" id="6381682">(</span><span class="string" id="6381683">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6381702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6381705">}</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6381709">symtab</span><span class="op" id="6381715">,</span>&nbsp;<span class="ident" id="6381717">err</span>&nbsp;<span class="op" id="6381721">:=</span>&nbsp;<span class="ident" id="6381724">symtabSection</span><span class="op" id="6381737">.</span><span class="ident" id="6381738">Data</span><span class="op" id="6381742">(</span><span class="op" id="6381743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381746">if</span>&nbsp;<span class="ident" id="6381749">err</span>&nbsp;<span class="op" id="6381753">!=</span>&nbsp;<span class="ident" id="6381756">nil</span>&nbsp;<span class="op" id="6381760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381764">return</span>&nbsp;<span class="ident" id="6381771">nil</span><span class="op" id="6381774">,</span>&nbsp;<span class="ident" id="6381776">errors</span><span class="op" id="6381782">.</span><span class="ident" id="6381783">New</span><span class="op" id="6381786">(</span><span class="string" id="6381787">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6381815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6381818">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381822">return</span>&nbsp;<span class="ident" id="6381829">newTable</span><span class="op" id="6381837">(</span><span class="ident" id="6381838">symtab</span><span class="op" id="6381844">,</span>&nbsp;<span class="ident" id="6381846">f</span><span class="op" id="6381847">.</span><span class="ident" id="6381848">PtrSize</span><span class="op" id="6381855">)</span><br>
<span class="lineno"></span><span class="op" id="6381857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6381860">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno">320</span><span class="comment" id="6381928">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="6381947">func</span>&nbsp;<span class="op" id="6381952">(</span><span class="ident" id="6381953">f</span>&nbsp;<span class="op" id="6381955">*</span><span class="ident" id="6381956">File</span><span class="op" id="6381960">)</span>&nbsp;<span class="ident" id="6381962">Section</span><span class="op" id="6381969">(</span><span class="ident" id="6381970">name</span>&nbsp;<span class="builtintype" id="6381975">string</span><span class="op" id="6381981">)</span>&nbsp;<span class="op" id="6381983">*</span><span class="ident" id="6381984">Section</span>&nbsp;<span class="op" id="6381992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6381995">for</span>&nbsp;<span class="ident" id="6381999">_</span><span class="op" id="6382000">,</span>&nbsp;<span class="ident" id="6382002">s</span>&nbsp;<span class="op" id="6382004">:=</span>&nbsp;<span class="keyword" id="6382007">range</span>&nbsp;<span class="ident" id="6382013">f</span><span class="op" id="6382014">.</span><span class="ident" id="6382015">Sections</span>&nbsp;<span class="op" id="6382024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6382028">if</span>&nbsp;<span class="ident" id="6382031">s</span><span class="op" id="6382032">.</span><span class="ident" id="6382033">Name</span>&nbsp;<span class="op" id="6382038">==</span>&nbsp;<span class="ident" id="6382041">name</span>&nbsp;<span class="op" id="6382046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6382051">return</span>&nbsp;<span class="ident" id="6382058">s</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6382062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6382065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6382068">return</span>&nbsp;<span class="ident" id="6382075">nil</span><br>
<span class="lineno"></span><span class="op" id="6382079">}</span>
</div>
</body>
</html>
