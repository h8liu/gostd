<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7406600">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7406655">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7406709">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7406760">package</span>&nbsp;<span class="ident" id="7406768">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7406773">import</span>&nbsp;<span class="op" id="7406780">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7406783">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7406791">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7406798">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7406804">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7406815">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7406826">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7406836">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="7406839">//&nbsp;If&nbsp;an&nbsp;IPv6&nbsp;tunnel&nbsp;is&nbsp;running,&nbsp;we&nbsp;can&nbsp;try&nbsp;dialing&nbsp;a&nbsp;real&nbsp;IPv6&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="7406912">var</span>&nbsp;<span class="ident" id="7406916">testIPv6</span>&nbsp;<span class="op" id="7406925">=</span>&nbsp;<span class="ident" id="7406927">flag</span><span class="op" id="7406931">.</span><span class="ident" id="7406932">Bool</span><span class="op" id="7406936">(</span><span class="string" id="7406937">&#34;ipv6&#34;</span><span class="op" id="7406943">,</span>&nbsp;<span class="ident" id="7406945">false</span><span class="op" id="7406950">,</span>&nbsp;<span class="string" id="7406952">&#34;assume&nbsp;ipv6&nbsp;tunnel&nbsp;is&nbsp;present&#34;</span><span class="op" id="7406983">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7406986">func</span>&nbsp;<span class="ident" id="7406991">TestResolveGoogle</span><span class="op" id="7407008">(</span><span class="ident" id="7407009">t</span>&nbsp;<span class="op" id="7407011">*</span><span class="ident" id="7407012">testing</span><span class="op" id="7407019">.</span><span class="ident" id="7407020">T</span><span class="op" id="7407021">)</span>&nbsp;<span class="op" id="7407023">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407026">if</span>&nbsp;<span class="ident" id="7407029">testing</span><span class="op" id="7407036">.</span><span class="ident" id="7407037">Short</span><span class="op" id="7407042">(</span><span class="op" id="7407043">)</span>&nbsp;<span class="op" id="7407045">||</span>&nbsp;<span class="op" id="7407048">!</span><span class="op" id="7407049">*</span><span class="ident" id="7407050">testExternal</span>&nbsp;<span class="op" id="7407063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407067">t</span><span class="op" id="7407068">.</span><span class="ident" id="7407069">Skip</span><span class="op" id="7407073">(</span><span class="string" id="7407074">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7407115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407122">for</span>&nbsp;<span class="ident" id="7407126">_</span><span class="op" id="7407127">,</span>&nbsp;<span class="ident" id="7407129">network</span>&nbsp;<span class="op" id="7407137">:=</span>&nbsp;<span class="keyword" id="7407140">range</span>&nbsp;<span class="op" id="7407146">[</span><span class="op" id="7407147">]</span><span class="builtintype" id="7407148">string</span><span class="op" id="7407154">{</span><span class="string" id="7407155">&#34;tcp&#34;</span><span class="op" id="7407160">,</span>&nbsp;<span class="string" id="7407162">&#34;tcp4&#34;</span><span class="op" id="7407168">,</span>&nbsp;<span class="string" id="7407170">&#34;tcp6&#34;</span><span class="op" id="7407176">}</span>&nbsp;<span class="op" id="7407178">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407182">addr</span><span class="op" id="7407186">,</span>&nbsp;<span class="ident" id="7407188">err</span>&nbsp;<span class="op" id="7407192">:=</span>&nbsp;<span class="ident" id="7407195">ResolveTCPAddr</span><span class="op" id="7407209">(</span><span class="ident" id="7407210">network</span><span class="op" id="7407217">,</span>&nbsp;<span class="string" id="7407219">&#34;www.google.com:http&#34;</span><span class="op" id="7407240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407244">if</span>&nbsp;<span class="ident" id="7407247">err</span>&nbsp;<span class="op" id="7407251">!=</span>&nbsp;<span class="ident" id="7407254">nil</span>&nbsp;<span class="op" id="7407258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407263">if</span>&nbsp;<span class="op" id="7407266">(</span><span class="ident" id="7407267">network</span>&nbsp;<span class="op" id="7407275">==</span>&nbsp;<span class="string" id="7407278">&#34;tcp&#34;</span>&nbsp;<span class="op" id="7407284">||</span>&nbsp;<span class="ident" id="7407287">network</span>&nbsp;<span class="op" id="7407295">==</span>&nbsp;<span class="string" id="7407298">&#34;tcp4&#34;</span><span class="op" id="7407304">)</span>&nbsp;<span class="op" id="7407306">&amp;&amp;</span>&nbsp;<span class="op" id="7407309">!</span><span class="ident" id="7407310">supportsIPv4</span>&nbsp;<span class="op" id="7407323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407329">t</span><span class="op" id="7407330">.</span><span class="ident" id="7407331">Logf</span><span class="op" id="7407335">(</span><span class="string" id="7407336">&#34;ipv4&nbsp;is&nbsp;not&nbsp;supported:&nbsp;%v&#34;</span><span class="op" id="7407363">,</span>&nbsp;<span class="ident" id="7407365">err</span><span class="op" id="7407368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407373">}</span>&nbsp;<span class="keyword" id="7407375">else</span>&nbsp;<span class="keyword" id="7407380">if</span>&nbsp;<span class="ident" id="7407383">network</span>&nbsp;<span class="op" id="7407391">==</span>&nbsp;<span class="string" id="7407394">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="7407401">&amp;&amp;</span>&nbsp;<span class="op" id="7407404">!</span><span class="ident" id="7407405">supportsIPv6</span>&nbsp;<span class="op" id="7407418">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407424">t</span><span class="op" id="7407425">.</span><span class="ident" id="7407426">Logf</span><span class="op" id="7407430">(</span><span class="string" id="7407431">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported:&nbsp;%v&#34;</span><span class="op" id="7407458">,</span>&nbsp;<span class="ident" id="7407460">err</span><span class="op" id="7407463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407468">}</span>&nbsp;<span class="keyword" id="7407470">else</span>&nbsp;<span class="op" id="7407475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407481">t</span><span class="op" id="7407482">.</span><span class="ident" id="7407483">Errorf</span><span class="op" id="7407489">(</span><span class="string" id="7407490">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7407517">,</span>&nbsp;<span class="ident" id="7407519">err</span><span class="op" id="7407522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407532">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407547">if</span>&nbsp;<span class="op" id="7407550">(</span><span class="ident" id="7407551">network</span>&nbsp;<span class="op" id="7407559">==</span>&nbsp;<span class="string" id="7407562">&#34;tcp&#34;</span>&nbsp;<span class="op" id="7407568">||</span>&nbsp;<span class="ident" id="7407571">network</span>&nbsp;<span class="op" id="7407579">==</span>&nbsp;<span class="string" id="7407582">&#34;tcp4&#34;</span><span class="op" id="7407588">)</span>&nbsp;<span class="op" id="7407590">&amp;&amp;</span>&nbsp;<span class="ident" id="7407593">addr</span><span class="op" id="7407597">.</span><span class="ident" id="7407598">IP</span><span class="op" id="7407600">.</span><span class="ident" id="7407601">To4</span><span class="op" id="7407604">(</span><span class="op" id="7407605">)</span>&nbsp;<span class="op" id="7407607">==</span>&nbsp;<span class="ident" id="7407610">nil</span>&nbsp;<span class="op" id="7407614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407619">t</span><span class="op" id="7407620">.</span><span class="ident" id="7407621">Errorf</span><span class="op" id="7407627">(</span><span class="string" id="7407628">&#34;got&nbsp;%v;&nbsp;expected&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;on&nbsp;%v&#34;</span><span class="op" id="7407668">,</span>&nbsp;<span class="ident" id="7407670">addr</span><span class="op" id="7407674">,</span>&nbsp;<span class="ident" id="7407676">network</span><span class="op" id="7407683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407687">}</span>&nbsp;<span class="keyword" id="7407689">else</span>&nbsp;<span class="keyword" id="7407694">if</span>&nbsp;<span class="ident" id="7407697">network</span>&nbsp;<span class="op" id="7407705">==</span>&nbsp;<span class="string" id="7407708">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="7407715">&amp;&amp;</span>&nbsp;<span class="op" id="7407718">(</span><span class="ident" id="7407719">addr</span><span class="op" id="7407723">.</span><span class="ident" id="7407724">IP</span><span class="op" id="7407726">.</span><span class="ident" id="7407727">To16</span><span class="op" id="7407731">(</span><span class="op" id="7407732">)</span>&nbsp;<span class="op" id="7407734">==</span>&nbsp;<span class="ident" id="7407737">nil</span>&nbsp;<span class="op" id="7407741">||</span>&nbsp;<span class="ident" id="7407744">addr</span><span class="op" id="7407748">.</span><span class="ident" id="7407749">IP</span><span class="op" id="7407751">.</span><span class="ident" id="7407752">To4</span><span class="op" id="7407755">(</span><span class="op" id="7407756">)</span>&nbsp;<span class="op" id="7407758">!=</span>&nbsp;<span class="ident" id="7407761">nil</span><span class="op" id="7407764">)</span>&nbsp;<span class="op" id="7407766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407771">t</span><span class="op" id="7407772">.</span><span class="ident" id="7407773">Errorf</span><span class="op" id="7407779">(</span><span class="string" id="7407780">&#34;got&nbsp;%v;&nbsp;expected&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;on&nbsp;%v&#34;</span><span class="op" id="7407820">,</span>&nbsp;<span class="ident" id="7407822">addr</span><span class="op" id="7407826">,</span>&nbsp;<span class="ident" id="7407828">network</span><span class="op" id="7407835">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407842">}</span><br>
<span class="lineno"></span><span class="op" id="7407844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7407847">func</span>&nbsp;<span class="ident" id="7407852">TestDialGoogle</span><span class="op" id="7407866">(</span><span class="ident" id="7407867">t</span>&nbsp;<span class="op" id="7407869">*</span><span class="ident" id="7407870">testing</span><span class="op" id="7407877">.</span><span class="ident" id="7407878">T</span><span class="op" id="7407879">)</span>&nbsp;<span class="op" id="7407881">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7407884">if</span>&nbsp;<span class="ident" id="7407887">testing</span><span class="op" id="7407894">.</span><span class="ident" id="7407895">Short</span><span class="op" id="7407900">(</span><span class="op" id="7407901">)</span>&nbsp;<span class="op" id="7407903">||</span>&nbsp;<span class="op" id="7407906">!</span><span class="op" id="7407907">*</span><span class="ident" id="7407908">testExternal</span>&nbsp;<span class="op" id="7407921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407925">t</span><span class="op" id="7407926">.</span><span class="ident" id="7407927">Skip</span><span class="op" id="7407931">(</span><span class="string" id="7407932">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7407973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7407976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7407980">d</span>&nbsp;<span class="op" id="7407982">:=</span>&nbsp;<span class="op" id="7407985">&amp;</span><span class="ident" id="7407986">Dialer</span><span class="op" id="7407992">{</span><span class="ident" id="7407993">DualStack</span><span class="op" id="7408002">:</span>&nbsp;<span class="ident" id="7408004">true</span><span class="op" id="7408008">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7408011">for</span>&nbsp;<span class="ident" id="7408015">_</span><span class="op" id="7408016">,</span>&nbsp;<span class="ident" id="7408018">network</span>&nbsp;<span class="op" id="7408026">:=</span>&nbsp;<span class="keyword" id="7408029">range</span>&nbsp;<span class="op" id="7408035">[</span><span class="op" id="7408036">]</span><span class="builtintype" id="7408037">string</span><span class="op" id="7408043">{</span><span class="string" id="7408044">&#34;tcp&#34;</span><span class="op" id="7408049">,</span>&nbsp;<span class="string" id="7408051">&#34;tcp4&#34;</span><span class="op" id="7408057">,</span>&nbsp;<span class="string" id="7408059">&#34;tcp6&#34;</span><span class="op" id="7408065">}</span>&nbsp;<span class="op" id="7408067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7408071">if</span>&nbsp;<span class="ident" id="7408074">network</span>&nbsp;<span class="op" id="7408082">==</span>&nbsp;<span class="string" id="7408085">&#34;tcp&#34;</span>&nbsp;<span class="op" id="7408091">&amp;&amp;</span>&nbsp;<span class="op" id="7408094">!</span><span class="ident" id="7408095">supportsIPv4</span>&nbsp;<span class="op" id="7408108">&amp;&amp;</span>&nbsp;<span class="op" id="7408111">!</span><span class="ident" id="7408112">supportsIPv6</span>&nbsp;<span class="op" id="7408125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408130">t</span><span class="op" id="7408131">.</span><span class="ident" id="7408132">Logf</span><span class="op" id="7408136">(</span><span class="string" id="7408137">&#34;skipping&nbsp;test;&nbsp;both&nbsp;ipv4&nbsp;and&nbsp;ipv6&nbsp;are&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7408190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7408195">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7408206">}</span>&nbsp;<span class="keyword" id="7408208">else</span>&nbsp;<span class="keyword" id="7408213">if</span>&nbsp;<span class="ident" id="7408216">network</span>&nbsp;<span class="op" id="7408224">==</span>&nbsp;<span class="string" id="7408227">&#34;tcp4&#34;</span>&nbsp;<span class="op" id="7408234">&amp;&amp;</span>&nbsp;<span class="op" id="7408237">!</span><span class="ident" id="7408238">supportsIPv4</span>&nbsp;<span class="op" id="7408251">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408256">t</span><span class="op" id="7408257">.</span><span class="ident" id="7408258">Logf</span><span class="op" id="7408262">(</span><span class="string" id="7408263">&#34;skipping&nbsp;test;&nbsp;ipv4&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7408301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7408306">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7408317">}</span>&nbsp;<span class="keyword" id="7408319">else</span>&nbsp;<span class="keyword" id="7408324">if</span>&nbsp;<span class="ident" id="7408327">network</span>&nbsp;<span class="op" id="7408335">==</span>&nbsp;<span class="string" id="7408338">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="7408345">&amp;&amp;</span>&nbsp;<span class="op" id="7408348">!</span><span class="ident" id="7408349">supportsIPv6</span>&nbsp;<span class="op" id="7408362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408367">t</span><span class="op" id="7408368">.</span><span class="ident" id="7408369">Logf</span><span class="op" id="7408373">(</span><span class="string" id="7408374">&#34;skipping&nbsp;test;&nbsp;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7408412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7408417">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7408428">}</span>&nbsp;<span class="keyword" id="7408430">else</span>&nbsp;<span class="keyword" id="7408435">if</span>&nbsp;<span class="ident" id="7408438">network</span>&nbsp;<span class="op" id="7408446">==</span>&nbsp;<span class="string" id="7408449">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="7408456">&amp;&amp;</span>&nbsp;<span class="op" id="7408459">!</span><span class="op" id="7408460">*</span><span class="ident" id="7408461">testIPv6</span>&nbsp;<span class="op" id="7408470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408475">t</span><span class="op" id="7408476">.</span><span class="ident" id="7408477">Logf</span><span class="op" id="7408481">(</span><span class="string" id="7408482">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-ipv6&nbsp;to&nbsp;enable&#34;</span><span class="op" id="7408518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7408523">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7408534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7408538">if</span>&nbsp;<span class="ident" id="7408541">c</span><span class="op" id="7408542">,</span>&nbsp;<span class="ident" id="7408544">err</span>&nbsp;<span class="op" id="7408548">:=</span>&nbsp;<span class="ident" id="7408551">d</span><span class="op" id="7408552">.</span><span class="ident" id="7408553">Dial</span><span class="op" id="7408557">(</span><span class="ident" id="7408558">network</span><span class="op" id="7408565">,</span>&nbsp;<span class="string" id="7408567">&#34;www.google.com:http&#34;</span><span class="op" id="7408588">)</span><span class="op" id="7408589">;</span>&nbsp;<span class="ident" id="7408591">err</span>&nbsp;<span class="op" id="7408595">!=</span>&nbsp;<span class="ident" id="7408598">nil</span>&nbsp;<span class="op" id="7408602">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408607">t</span><span class="op" id="7408608">.</span><span class="ident" id="7408609">Errorf</span><span class="op" id="7408615">(</span><span class="string" id="7408616">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7408633">,</span>&nbsp;<span class="ident" id="7408635">err</span><span class="op" id="7408638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7408642">}</span>&nbsp;<span class="keyword" id="7408644">else</span>&nbsp;<span class="op" id="7408649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408654">c</span><span class="op" id="7408655">.</span><span class="ident" id="7408656">Close</span><span class="op" id="7408661">(</span><span class="op" id="7408662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7408666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7408669">}</span><br>
<span class="lineno">70</span><span class="op" id="7408671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7408674">//&nbsp;fd&nbsp;is&nbsp;already&nbsp;connected&nbsp;to&nbsp;the&nbsp;destination,&nbsp;port&nbsp;80.</span><br>
<span class="lineno"></span><span class="comment" id="7408730">//&nbsp;Run&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;to&nbsp;fetch&nbsp;the&nbsp;appropriate&nbsp;page.</span><br>
<span class="lineno"></span><span class="keyword" id="7408784">func</span>&nbsp;<span class="ident" id="7408789">fetchGoogle</span><span class="op" id="7408800">(</span><span class="ident" id="7408801">t</span>&nbsp;<span class="op" id="7408803">*</span><span class="ident" id="7408804">testing</span><span class="op" id="7408811">.</span><span class="ident" id="7408812">T</span><span class="op" id="7408813">,</span>&nbsp;<span class="ident" id="7408815">fd</span>&nbsp;<span class="ident" id="7408818">Conn</span><span class="op" id="7408822">,</span>&nbsp;<span class="ident" id="7408824">network</span><span class="op" id="7408831">,</span>&nbsp;<span class="ident" id="7408833">addr</span>&nbsp;<span class="builtintype" id="7408838">string</span><span class="op" id="7408844">)</span>&nbsp;<span class="op" id="7408846">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408849">req</span>&nbsp;<span class="op" id="7408853">:=</span>&nbsp;<span class="op" id="7408856">[</span><span class="op" id="7408857">]</span><span class="builtintype" id="7408858">byte</span><span class="op" id="7408862">(</span><span class="string" id="7408863">&#34;GET&nbsp;/robots.txt&nbsp;HTTP/1.0\r\nHost:&nbsp;www.google.com\r\n\r\n&#34;</span><span class="op" id="7408921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408924">n</span><span class="op" id="7408925">,</span>&nbsp;<span class="ident" id="7408927">err</span>&nbsp;<span class="op" id="7408931">:=</span>&nbsp;<span class="ident" id="7408934">fd</span><span class="op" id="7408936">.</span><span class="ident" id="7408937">Write</span><span class="op" id="7408942">(</span><span class="ident" id="7408943">req</span><span class="op" id="7408946">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408950">buf</span>&nbsp;<span class="op" id="7408954">:=</span>&nbsp;<span class="builtinfunc" id="7408957">make</span><span class="op" id="7408961">(</span><span class="op" id="7408962">[</span><span class="op" id="7408963">]</span><span class="builtintype" id="7408964">byte</span><span class="op" id="7408968">,</span>&nbsp;<span class="num" id="7408970">1000</span><span class="op" id="7408974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7408977">n</span><span class="op" id="7408978">,</span>&nbsp;<span class="ident" id="7408980">err</span>&nbsp;<span class="op" id="7408984">=</span>&nbsp;<span class="ident" id="7408986">io</span><span class="op" id="7408988">.</span><span class="ident" id="7408989">ReadFull</span><span class="op" id="7408997">(</span><span class="ident" id="7408998">fd</span><span class="op" id="7409000">,</span>&nbsp;<span class="ident" id="7409002">buf</span><span class="op" id="7409005">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7409009">if</span>&nbsp;<span class="ident" id="7409012">n</span>&nbsp;<span class="op" id="7409014">&lt;</span>&nbsp;<span class="num" id="7409016">1000</span>&nbsp;<span class="op" id="7409021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7409025">t</span><span class="op" id="7409026">.</span><span class="ident" id="7409027">Errorf</span><span class="op" id="7409033">(</span><span class="string" id="7409034">&#34;fetchGoogle:&nbsp;short&nbsp;HTTP&nbsp;read&nbsp;from&nbsp;%s&nbsp;%s&nbsp;-&nbsp;%v&#34;</span><span class="op" id="7409080">,</span>&nbsp;<span class="ident" id="7409082">network</span><span class="op" id="7409089">,</span>&nbsp;<span class="ident" id="7409091">addr</span><span class="op" id="7409095">,</span>&nbsp;<span class="ident" id="7409097">err</span><span class="op" id="7409100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7409104">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409112">}</span><br>
<span class="lineno">85</span><span class="op" id="7409114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7409117">func</span>&nbsp;<span class="ident" id="7409122">doDial</span><span class="op" id="7409128">(</span><span class="ident" id="7409129">t</span>&nbsp;<span class="op" id="7409131">*</span><span class="ident" id="7409132">testing</span><span class="op" id="7409139">.</span><span class="ident" id="7409140">T</span><span class="op" id="7409141">,</span>&nbsp;<span class="ident" id="7409143">network</span><span class="op" id="7409150">,</span>&nbsp;<span class="ident" id="7409152">addr</span>&nbsp;<span class="builtintype" id="7409157">string</span><span class="op" id="7409163">)</span>&nbsp;<span class="op" id="7409165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7409168">fd</span><span class="op" id="7409170">,</span>&nbsp;<span class="ident" id="7409172">err</span>&nbsp;<span class="op" id="7409176">:=</span>&nbsp;<span class="ident" id="7409179">Dial</span><span class="op" id="7409183">(</span><span class="ident" id="7409184">network</span><span class="op" id="7409191">,</span>&nbsp;<span class="ident" id="7409193">addr</span><span class="op" id="7409197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7409200">if</span>&nbsp;<span class="ident" id="7409203">err</span>&nbsp;<span class="op" id="7409207">!=</span>&nbsp;<span class="ident" id="7409210">nil</span>&nbsp;<span class="op" id="7409214">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7409218">t</span><span class="op" id="7409219">.</span><span class="ident" id="7409220">Errorf</span><span class="op" id="7409226">(</span><span class="string" id="7409227">&#34;Dial(%q,&nbsp;%q,&nbsp;%q)&nbsp;=&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="7409253">,</span>&nbsp;<span class="ident" id="7409255">network</span><span class="op" id="7409262">,</span>&nbsp;<span class="string" id="7409264">&#34;&#34;</span><span class="op" id="7409266">,</span>&nbsp;<span class="ident" id="7409268">addr</span><span class="op" id="7409272">,</span>&nbsp;<span class="ident" id="7409274">err</span><span class="op" id="7409277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7409281">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7409292">fetchGoogle</span><span class="op" id="7409303">(</span><span class="ident" id="7409304">t</span><span class="op" id="7409305">,</span>&nbsp;<span class="ident" id="7409307">fd</span><span class="op" id="7409309">,</span>&nbsp;<span class="ident" id="7409311">network</span><span class="op" id="7409318">,</span>&nbsp;<span class="ident" id="7409320">addr</span><span class="op" id="7409324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7409327">fd</span><span class="op" id="7409329">.</span><span class="ident" id="7409330">Close</span><span class="op" id="7409335">(</span><span class="op" id="7409336">)</span><br>
<span class="lineno">95</span><span class="op" id="7409338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7409341">var</span>&nbsp;<span class="ident" id="7409345">googleaddrsipv4</span>&nbsp;<span class="op" id="7409361">=</span>&nbsp;<span class="op" id="7409363">[</span><span class="op" id="7409364">]</span><span class="builtintype" id="7409365">string</span><span class="op" id="7409371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409374">&#34;%d.%d.%d.%d:80&#34;</span><span class="op" id="7409390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409393">&#34;www.google.com:80&#34;</span><span class="op" id="7409412">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409415">&#34;%d.%d.%d.%d:http&#34;</span><span class="op" id="7409433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409436">&#34;www.google.com:http&#34;</span><span class="op" id="7409457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409460">&#34;%03d.%03d.%03d.%03d:0080&#34;</span><span class="op" id="7409486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409489">&#34;[::ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="7409514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409517">&#34;[::ffff:%02x%02x:%02x%02x]:80&#34;</span><span class="op" id="7409548">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409551">&#34;[0:0:0:0:0000:ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="7409587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409590">&#34;[0:0:0:0:000000:ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="7409628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7409631">&#34;[0:0:0:0::ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="7409663">,</span><br>
<span class="lineno"></span><span class="op" id="7409665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7409668">func</span>&nbsp;<span class="ident" id="7409673">TestDialGoogleIPv4</span><span class="op" id="7409691">(</span><span class="ident" id="7409692">t</span>&nbsp;<span class="op" id="7409694">*</span><span class="ident" id="7409695">testing</span><span class="op" id="7409702">.</span><span class="ident" id="7409703">T</span><span class="op" id="7409704">)</span>&nbsp;<span class="op" id="7409706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7409709">if</span>&nbsp;<span class="ident" id="7409712">testing</span><span class="op" id="7409719">.</span><span class="ident" id="7409720">Short</span><span class="op" id="7409725">(</span><span class="op" id="7409726">)</span>&nbsp;<span class="op" id="7409728">||</span>&nbsp;<span class="op" id="7409731">!</span><span class="op" id="7409732">*</span><span class="ident" id="7409733">testExternal</span>&nbsp;<span class="op" id="7409746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7409750">t</span><span class="op" id="7409751">.</span><span class="ident" id="7409752">Skip</span><span class="op" id="7409756">(</span><span class="string" id="7409757">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7409798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7409805">//&nbsp;Insert&nbsp;an&nbsp;actual&nbsp;IPv4&nbsp;address&nbsp;for&nbsp;google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7409854">//&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7409874">addrs</span><span class="op" id="7409879">,</span>&nbsp;<span class="ident" id="7409881">err</span>&nbsp;<span class="op" id="7409885">:=</span>&nbsp;<span class="ident" id="7409888">LookupIP</span><span class="op" id="7409896">(</span><span class="string" id="7409897">&#34;www.google.com&#34;</span><span class="op" id="7409913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7409916">if</span>&nbsp;<span class="ident" id="7409919">err</span>&nbsp;<span class="op" id="7409923">!=</span>&nbsp;<span class="ident" id="7409926">nil</span>&nbsp;<span class="op" id="7409930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7409934">t</span><span class="op" id="7409935">.</span><span class="ident" id="7409936">Fatalf</span><span class="op" id="7409942">(</span><span class="string" id="7409943">&#34;lookup&nbsp;www.google.com:&nbsp;%v&#34;</span><span class="op" id="7409970">,</span>&nbsp;<span class="ident" id="7409972">err</span><span class="op" id="7409975">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7409978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7409981">var</span>&nbsp;<span class="ident" id="7409985">ip</span>&nbsp;<span class="ident" id="7409988">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7409992">for</span>&nbsp;<span class="ident" id="7409996">_</span><span class="op" id="7409997">,</span>&nbsp;<span class="ident" id="7409999">addr</span>&nbsp;<span class="op" id="7410004">:=</span>&nbsp;<span class="keyword" id="7410007">range</span>&nbsp;<span class="ident" id="7410013">addrs</span>&nbsp;<span class="op" id="7410019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7410023">if</span>&nbsp;<span class="ident" id="7410026">x</span>&nbsp;<span class="op" id="7410028">:=</span>&nbsp;<span class="ident" id="7410031">addr</span><span class="op" id="7410035">.</span><span class="ident" id="7410036">To4</span><span class="op" id="7410039">(</span><span class="op" id="7410040">)</span><span class="op" id="7410041">;</span>&nbsp;<span class="ident" id="7410043">x</span>&nbsp;<span class="op" id="7410045">!=</span>&nbsp;<span class="ident" id="7410048">nil</span>&nbsp;<span class="op" id="7410052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7410057">ip</span>&nbsp;<span class="op" id="7410060">=</span>&nbsp;<span class="ident" id="7410062">x</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7410067">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7410081">if</span>&nbsp;<span class="ident" id="7410084">ip</span>&nbsp;<span class="op" id="7410087">==</span>&nbsp;<span class="ident" id="7410090">nil</span>&nbsp;<span class="op" id="7410094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7410098">t</span><span class="op" id="7410099">.</span><span class="ident" id="7410100">Fatalf</span><span class="op" id="7410106">(</span><span class="string" id="7410107">&#34;no&nbsp;IPv4&nbsp;addresses&nbsp;for&nbsp;www.google.com&#34;</span><span class="op" id="7410145">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7410152">for</span>&nbsp;<span class="ident" id="7410156">i</span><span class="op" id="7410157">,</span>&nbsp;<span class="ident" id="7410159">s</span>&nbsp;<span class="op" id="7410161">:=</span>&nbsp;<span class="keyword" id="7410164">range</span>&nbsp;<span class="ident" id="7410170">googleaddrsipv4</span>&nbsp;<span class="op" id="7410186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7410190">if</span>&nbsp;<span class="ident" id="7410193">strings</span><span class="op" id="7410200">.</span><span class="ident" id="7410201">Contains</span><span class="op" id="7410209">(</span><span class="ident" id="7410210">s</span><span class="op" id="7410211">,</span>&nbsp;<span class="string" id="7410213">&#34;%&#34;</span><span class="op" id="7410216">)</span>&nbsp;<span class="op" id="7410218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7410223">googleaddrsipv4</span><span class="op" id="7410238">[</span><span class="ident" id="7410239">i</span><span class="op" id="7410240">]</span>&nbsp;<span class="op" id="7410242">=</span>&nbsp;<span class="ident" id="7410244">fmt</span><span class="op" id="7410247">.</span><span class="ident" id="7410248">Sprintf</span><span class="op" id="7410255">(</span><span class="ident" id="7410256">s</span><span class="op" id="7410257">,</span>&nbsp;<span class="ident" id="7410259">ip</span><span class="op" id="7410261">[</span><span class="num" id="7410262">0</span><span class="op" id="7410263">]</span><span class="op" id="7410264">,</span>&nbsp;<span class="ident" id="7410266">ip</span><span class="op" id="7410268">[</span><span class="num" id="7410269">1</span><span class="op" id="7410270">]</span><span class="op" id="7410271">,</span>&nbsp;<span class="ident" id="7410273">ip</span><span class="op" id="7410275">[</span><span class="num" id="7410276">2</span><span class="op" id="7410277">]</span><span class="op" id="7410278">,</span>&nbsp;<span class="ident" id="7410280">ip</span><span class="op" id="7410282">[</span><span class="num" id="7410283">3</span><span class="op" id="7410284">]</span><span class="op" id="7410285">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7410296">for</span>&nbsp;<span class="ident" id="7410300">i</span>&nbsp;<span class="op" id="7410302">:=</span>&nbsp;<span class="num" id="7410305">0</span><span class="op" id="7410306">;</span>&nbsp;<span class="ident" id="7410308">i</span>&nbsp;<span class="op" id="7410310">&lt;</span>&nbsp;<span class="builtinfunc" id="7410312">len</span><span class="op" id="7410315">(</span><span class="ident" id="7410316">googleaddrsipv4</span><span class="op" id="7410331">)</span><span class="op" id="7410332">;</span>&nbsp;<span class="ident" id="7410334">i</span><span class="op" id="7410335">++</span>&nbsp;<span class="op" id="7410338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7410342">addr</span>&nbsp;<span class="op" id="7410347">:=</span>&nbsp;<span class="ident" id="7410350">googleaddrsipv4</span><span class="op" id="7410365">[</span><span class="ident" id="7410366">i</span><span class="op" id="7410367">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7410371">if</span>&nbsp;<span class="ident" id="7410374">addr</span>&nbsp;<span class="op" id="7410379">==</span>&nbsp;<span class="string" id="7410382">&#34;&#34;</span>&nbsp;<span class="op" id="7410385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7410390">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7410405">t</span><span class="op" id="7410406">.</span><span class="ident" id="7410407">Logf</span><span class="op" id="7410411">(</span><span class="string" id="7410412">&#34;--&nbsp;%s&nbsp;--&#34;</span><span class="op" id="7410422">,</span>&nbsp;<span class="ident" id="7410424">addr</span><span class="op" id="7410428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7410432">doDial</span><span class="op" id="7410438">(</span><span class="ident" id="7410439">t</span><span class="op" id="7410440">,</span>&nbsp;<span class="string" id="7410442">&#34;tcp&#34;</span><span class="op" id="7410447">,</span>&nbsp;<span class="ident" id="7410449">addr</span><span class="op" id="7410453">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7410457">if</span>&nbsp;<span class="ident" id="7410460">addr</span><span class="op" id="7410464">[</span><span class="num" id="7410465">0</span><span class="op" id="7410466">]</span>&nbsp;<span class="op" id="7410468">!=</span>&nbsp;<span class="string" id="7410471">&#39;[&#39;</span>&nbsp;<span class="op" id="7410475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7410480">doDial</span><span class="op" id="7410486">(</span><span class="ident" id="7410487">t</span><span class="op" id="7410488">,</span>&nbsp;<span class="string" id="7410490">&#34;tcp4&#34;</span><span class="op" id="7410496">,</span>&nbsp;<span class="ident" id="7410498">addr</span><span class="op" id="7410502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7410507">if</span>&nbsp;<span class="ident" id="7410510">supportsIPv6</span>&nbsp;<span class="op" id="7410523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7410529">//&nbsp;make&nbsp;sure&nbsp;syscall.SocketDisableIPv6&nbsp;flag&nbsp;works.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7410584">syscall</span><span class="op" id="7410591">.</span><span class="ident" id="7410592">SocketDisableIPv6</span>&nbsp;<span class="op" id="7410610">=</span>&nbsp;<span class="ident" id="7410612">true</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7410621">doDial</span><span class="op" id="7410627">(</span><span class="ident" id="7410628">t</span><span class="op" id="7410629">,</span>&nbsp;<span class="string" id="7410631">&#34;tcp&#34;</span><span class="op" id="7410636">,</span>&nbsp;<span class="ident" id="7410638">addr</span><span class="op" id="7410642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7410648">doDial</span><span class="op" id="7410654">(</span><span class="ident" id="7410655">t</span><span class="op" id="7410656">,</span>&nbsp;<span class="string" id="7410658">&#34;tcp4&#34;</span><span class="op" id="7410664">,</span>&nbsp;<span class="ident" id="7410666">addr</span><span class="op" id="7410670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7410676">syscall</span><span class="op" id="7410683">.</span><span class="ident" id="7410684">SocketDisableIPv6</span>&nbsp;<span class="op" id="7410702">=</span>&nbsp;<span class="ident" id="7410704">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410717">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7410720">}</span><br>
<span class="lineno"></span><span class="op" id="7410722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7410725">var</span>&nbsp;<span class="ident" id="7410729">googleaddrsipv6</span>&nbsp;<span class="op" id="7410745">=</span>&nbsp;<span class="op" id="7410747">[</span><span class="op" id="7410748">]</span><span class="builtintype" id="7410749">string</span><span class="op" id="7410755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7410758">&#34;[%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:80&#34;</span><span class="op" id="7410836">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7410839">&#34;ipv6.google.com:80&#34;</span><span class="op" id="7410859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7410862">&#34;[%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:http&#34;</span><span class="op" id="7410942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7410945">&#34;ipv6.google.com:http&#34;</span><span class="op" id="7410967">,</span><br>
<span class="lineno"></span><span class="op" id="7410969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="7410972">func</span>&nbsp;<span class="ident" id="7410977">TestDialGoogleIPv6</span><span class="op" id="7410995">(</span><span class="ident" id="7410996">t</span>&nbsp;<span class="op" id="7410998">*</span><span class="ident" id="7410999">testing</span><span class="op" id="7411006">.</span><span class="ident" id="7411007">T</span><span class="op" id="7411008">)</span>&nbsp;<span class="op" id="7411010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411013">if</span>&nbsp;<span class="ident" id="7411016">testing</span><span class="op" id="7411023">.</span><span class="ident" id="7411024">Short</span><span class="op" id="7411029">(</span><span class="op" id="7411030">)</span>&nbsp;<span class="op" id="7411032">||</span>&nbsp;<span class="op" id="7411035">!</span><span class="op" id="7411036">*</span><span class="ident" id="7411037">testExternal</span>&nbsp;<span class="op" id="7411050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411054">t</span><span class="op" id="7411055">.</span><span class="ident" id="7411056">Skip</span><span class="op" id="7411060">(</span><span class="string" id="7411061">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="7411102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7411108">//&nbsp;Only&nbsp;run&nbsp;tcp6&nbsp;if&nbsp;the&nbsp;kernel&nbsp;will&nbsp;take&nbsp;it.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411154">if</span>&nbsp;<span class="op" id="7411157">!</span><span class="ident" id="7411158">supportsIPv6</span>&nbsp;<span class="op" id="7411171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411175">t</span><span class="op" id="7411176">.</span><span class="ident" id="7411177">Skip</span><span class="op" id="7411181">(</span><span class="string" id="7411182">&#34;skipping&nbsp;test;&nbsp;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7411220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411226">if</span>&nbsp;<span class="op" id="7411229">!</span><span class="op" id="7411230">*</span><span class="ident" id="7411231">testIPv6</span>&nbsp;<span class="op" id="7411240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411244">t</span><span class="op" id="7411245">.</span><span class="ident" id="7411246">Skip</span><span class="op" id="7411250">(</span><span class="string" id="7411251">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-ipv6&nbsp;to&nbsp;enable&#34;</span><span class="op" id="7411287">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7411294">//&nbsp;Insert&nbsp;an&nbsp;actual&nbsp;IPv6&nbsp;address&nbsp;for&nbsp;ipv6.google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7411348">//&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411368">addrs</span><span class="op" id="7411373">,</span>&nbsp;<span class="ident" id="7411375">err</span>&nbsp;<span class="op" id="7411379">:=</span>&nbsp;<span class="ident" id="7411382">LookupIP</span><span class="op" id="7411390">(</span><span class="string" id="7411391">&#34;ipv6.google.com&#34;</span><span class="op" id="7411408">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411411">if</span>&nbsp;<span class="ident" id="7411414">err</span>&nbsp;<span class="op" id="7411418">!=</span>&nbsp;<span class="ident" id="7411421">nil</span>&nbsp;<span class="op" id="7411425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411429">t</span><span class="op" id="7411430">.</span><span class="ident" id="7411431">Fatalf</span><span class="op" id="7411437">(</span><span class="string" id="7411438">&#34;lookup&nbsp;ipv6.google.com:&nbsp;%v&#34;</span><span class="op" id="7411466">,</span>&nbsp;<span class="ident" id="7411468">err</span><span class="op" id="7411471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411477">var</span>&nbsp;<span class="ident" id="7411481">ip</span>&nbsp;<span class="ident" id="7411484">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411488">for</span>&nbsp;<span class="ident" id="7411492">_</span><span class="op" id="7411493">,</span>&nbsp;<span class="ident" id="7411495">addr</span>&nbsp;<span class="op" id="7411500">:=</span>&nbsp;<span class="keyword" id="7411503">range</span>&nbsp;<span class="ident" id="7411509">addrs</span>&nbsp;<span class="op" id="7411515">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411519">if</span>&nbsp;<span class="ident" id="7411522">x</span>&nbsp;<span class="op" id="7411524">:=</span>&nbsp;<span class="ident" id="7411527">addr</span><span class="op" id="7411531">.</span><span class="ident" id="7411532">To16</span><span class="op" id="7411536">(</span><span class="op" id="7411537">)</span><span class="op" id="7411538">;</span>&nbsp;<span class="ident" id="7411540">x</span>&nbsp;<span class="op" id="7411542">!=</span>&nbsp;<span class="ident" id="7411545">nil</span>&nbsp;<span class="op" id="7411549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411554">ip</span>&nbsp;<span class="op" id="7411557">=</span>&nbsp;<span class="ident" id="7411559">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411564">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411575">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411578">if</span>&nbsp;<span class="ident" id="7411581">ip</span>&nbsp;<span class="op" id="7411584">==</span>&nbsp;<span class="ident" id="7411587">nil</span>&nbsp;<span class="op" id="7411591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411595">t</span><span class="op" id="7411596">.</span><span class="ident" id="7411597">Fatalf</span><span class="op" id="7411603">(</span><span class="string" id="7411604">&#34;no&nbsp;IPv6&nbsp;addresses&nbsp;for&nbsp;ipv6.google.com&#34;</span><span class="op" id="7411643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411650">for</span>&nbsp;<span class="ident" id="7411654">i</span><span class="op" id="7411655">,</span>&nbsp;<span class="ident" id="7411657">s</span>&nbsp;<span class="op" id="7411659">:=</span>&nbsp;<span class="keyword" id="7411662">range</span>&nbsp;<span class="ident" id="7411668">googleaddrsipv6</span>&nbsp;<span class="op" id="7411684">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411688">if</span>&nbsp;<span class="ident" id="7411691">strings</span><span class="op" id="7411698">.</span><span class="ident" id="7411699">Contains</span><span class="op" id="7411707">(</span><span class="ident" id="7411708">s</span><span class="op" id="7411709">,</span>&nbsp;<span class="string" id="7411711">&#34;%&#34;</span><span class="op" id="7411714">)</span>&nbsp;<span class="op" id="7411716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411721">googleaddrsipv6</span><span class="op" id="7411736">[</span><span class="ident" id="7411737">i</span><span class="op" id="7411738">]</span>&nbsp;<span class="op" id="7411740">=</span>&nbsp;<span class="ident" id="7411742">fmt</span><span class="op" id="7411745">.</span><span class="ident" id="7411746">Sprintf</span><span class="op" id="7411753">(</span><span class="ident" id="7411754">s</span><span class="op" id="7411755">,</span>&nbsp;<span class="ident" id="7411757">ip</span><span class="op" id="7411759">[</span><span class="num" id="7411760">0</span><span class="op" id="7411761">]</span><span class="op" id="7411762">,</span>&nbsp;<span class="ident" id="7411764">ip</span><span class="op" id="7411766">[</span><span class="num" id="7411767">1</span><span class="op" id="7411768">]</span><span class="op" id="7411769">,</span>&nbsp;<span class="ident" id="7411771">ip</span><span class="op" id="7411773">[</span><span class="num" id="7411774">2</span><span class="op" id="7411775">]</span><span class="op" id="7411776">,</span>&nbsp;<span class="ident" id="7411778">ip</span><span class="op" id="7411780">[</span><span class="num" id="7411781">3</span><span class="op" id="7411782">]</span><span class="op" id="7411783">,</span>&nbsp;<span class="ident" id="7411785">ip</span><span class="op" id="7411787">[</span><span class="num" id="7411788">4</span><span class="op" id="7411789">]</span><span class="op" id="7411790">,</span>&nbsp;<span class="ident" id="7411792">ip</span><span class="op" id="7411794">[</span><span class="num" id="7411795">5</span><span class="op" id="7411796">]</span><span class="op" id="7411797">,</span>&nbsp;<span class="ident" id="7411799">ip</span><span class="op" id="7411801">[</span><span class="num" id="7411802">6</span><span class="op" id="7411803">]</span><span class="op" id="7411804">,</span>&nbsp;<span class="ident" id="7411806">ip</span><span class="op" id="7411808">[</span><span class="num" id="7411809">7</span><span class="op" id="7411810">]</span><span class="op" id="7411811">,</span>&nbsp;<span class="ident" id="7411813">ip</span><span class="op" id="7411815">[</span><span class="num" id="7411816">8</span><span class="op" id="7411817">]</span><span class="op" id="7411818">,</span>&nbsp;<span class="ident" id="7411820">ip</span><span class="op" id="7411822">[</span><span class="num" id="7411823">9</span><span class="op" id="7411824">]</span><span class="op" id="7411825">,</span>&nbsp;<span class="ident" id="7411827">ip</span><span class="op" id="7411829">[</span><span class="num" id="7411830">10</span><span class="op" id="7411832">]</span><span class="op" id="7411833">,</span>&nbsp;<span class="ident" id="7411835">ip</span><span class="op" id="7411837">[</span><span class="num" id="7411838">11</span><span class="op" id="7411840">]</span><span class="op" id="7411841">,</span>&nbsp;<span class="ident" id="7411843">ip</span><span class="op" id="7411845">[</span><span class="num" id="7411846">12</span><span class="op" id="7411848">]</span><span class="op" id="7411849">,</span>&nbsp;<span class="ident" id="7411851">ip</span><span class="op" id="7411853">[</span><span class="num" id="7411854">13</span><span class="op" id="7411856">]</span><span class="op" id="7411857">,</span>&nbsp;<span class="ident" id="7411859">ip</span><span class="op" id="7411861">[</span><span class="num" id="7411862">14</span><span class="op" id="7411864">]</span><span class="op" id="7411865">,</span>&nbsp;<span class="ident" id="7411867">ip</span><span class="op" id="7411869">[</span><span class="num" id="7411870">15</span><span class="op" id="7411872">]</span><span class="op" id="7411873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411884">for</span>&nbsp;<span class="ident" id="7411888">i</span>&nbsp;<span class="op" id="7411890">:=</span>&nbsp;<span class="num" id="7411893">0</span><span class="op" id="7411894">;</span>&nbsp;<span class="ident" id="7411896">i</span>&nbsp;<span class="op" id="7411898">&lt;</span>&nbsp;<span class="builtinfunc" id="7411900">len</span><span class="op" id="7411903">(</span><span class="ident" id="7411904">googleaddrsipv6</span><span class="op" id="7411919">)</span><span class="op" id="7411920">;</span>&nbsp;<span class="ident" id="7411922">i</span><span class="op" id="7411923">++</span>&nbsp;<span class="op" id="7411926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411930">addr</span>&nbsp;<span class="op" id="7411935">:=</span>&nbsp;<span class="ident" id="7411938">googleaddrsipv6</span><span class="op" id="7411953">[</span><span class="ident" id="7411954">i</span><span class="op" id="7411955">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411959">if</span>&nbsp;<span class="ident" id="7411962">addr</span>&nbsp;<span class="op" id="7411967">==</span>&nbsp;<span class="string" id="7411970">&#34;&#34;</span>&nbsp;<span class="op" id="7411973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7411978">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7411989">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7411993">t</span><span class="op" id="7411994">.</span><span class="ident" id="7411995">Logf</span><span class="op" id="7411999">(</span><span class="string" id="7412000">&#34;--&nbsp;%s&nbsp;--&#34;</span><span class="op" id="7412010">,</span>&nbsp;<span class="ident" id="7412012">addr</span><span class="op" id="7412016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412020">doDial</span><span class="op" id="7412026">(</span><span class="ident" id="7412027">t</span><span class="op" id="7412028">,</span>&nbsp;<span class="string" id="7412030">&#34;tcp&#34;</span><span class="op" id="7412035">,</span>&nbsp;<span class="ident" id="7412037">addr</span><span class="op" id="7412041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7412045">doDial</span><span class="op" id="7412051">(</span><span class="ident" id="7412052">t</span><span class="op" id="7412053">,</span>&nbsp;<span class="string" id="7412055">&#34;tcp6&#34;</span><span class="op" id="7412061">,</span>&nbsp;<span class="ident" id="7412063">addr</span><span class="op" id="7412067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7412070">}</span><br>
<span class="lineno"></span><span class="op" id="7412072">}</span>
</div>
</body>
</html>
