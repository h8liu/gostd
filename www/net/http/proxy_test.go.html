<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7424976">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7425031">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7425085">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7425136">package</span>&nbsp;<span class="ident" id="7425144">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7425150">import</span>&nbsp;<span class="op" id="7425157">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7425160">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7425171">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7425177">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7425187">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7425190">//&nbsp;TODO(mattn):</span><br>
<span class="lineno"></span><span class="comment" id="7425206">//&nbsp;&nbsp;&nbsp;&nbsptest&nbsp;ProxyAuth</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7425225">var</span>&nbsp;<span class="ident" id="7425229">UseProxyTests</span>&nbsp;<span class="op" id="7425243">=</span>&nbsp;<span class="op" id="7425245">[</span><span class="op" id="7425246">]</span><span class="keyword" id="7425247">struct</span>&nbsp;<span class="op" id="7425254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7425257">host</span>&nbsp;&nbsp;<span class="builtintype" id="7425263">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7425271">match</span>&nbsp;<span class="builtintype" id="7425277">bool</span><br>
<span class="lineno"></span><span class="op" id="7425282">}</span><span class="op" id="7425283">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7425286">//&nbsp;Never&nbsp;proxy&nbsp;localhost:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7425313">{</span><span class="string" id="7425314">&#34;localhost:80&#34;</span><span class="op" id="7425328">,</span>&nbsp;<span class="ident" id="7425330">false</span><span class="op" id="7425335">}</span><span class="op" id="7425336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7425339">{</span><span class="string" id="7425340">&#34;127.0.0.1&#34;</span><span class="op" id="7425351">,</span>&nbsp;<span class="ident" id="7425353">false</span><span class="op" id="7425358">}</span><span class="op" id="7425359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7425362">{</span><span class="string" id="7425363">&#34;127.0.0.2&#34;</span><span class="op" id="7425374">,</span>&nbsp;<span class="ident" id="7425376">false</span><span class="op" id="7425381">}</span><span class="op" id="7425382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7425385">{</span><span class="string" id="7425386">&#34;[::1]&#34;</span><span class="op" id="7425393">,</span>&nbsp;<span class="ident" id="7425395">false</span><span class="op" id="7425400">}</span><span class="op" id="7425401">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7425404">{</span><span class="string" id="7425405">&#34;[::2]&#34;</span><span class="op" id="7425412">,</span>&nbsp;<span class="ident" id="7425414">true</span><span class="op" id="7425418">}</span><span class="op" id="7425419">,</span>&nbsp;<span class="comment" id="7425421">//&nbsp;not&nbsp;a&nbsp;loopback&nbsp;address</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7425449">{</span><span class="string" id="7425450">&#34;barbaz.net&#34;</span><span class="op" id="7425462">,</span>&nbsp;<span class="ident" id="7425464">false</span><span class="op" id="7425469">}</span><span class="op" id="7425470">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7425476">//&nbsp;match&nbsp;as&nbsp;.barbaz.net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7425501">{</span><span class="string" id="7425502">&#34;foobar.com&#34;</span><span class="op" id="7425514">,</span>&nbsp;<span class="ident" id="7425516">false</span><span class="op" id="7425521">}</span><span class="op" id="7425522">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7425528">//&nbsp;have&nbsp;a&nbsp;port&nbsp;but&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7425554">{</span><span class="string" id="7425555">&#34;foofoobar.com&#34;</span><span class="op" id="7425570">,</span>&nbsp;<span class="ident" id="7425572">true</span><span class="op" id="7425576">}</span><span class="op" id="7425577">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7425581">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;foobar.com</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7425619">{</span><span class="string" id="7425620">&#34;baz.com&#34;</span><span class="op" id="7425629">,</span>&nbsp;<span class="ident" id="7425631">true</span><span class="op" id="7425635">}</span><span class="op" id="7425636">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7425646">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;barbaz.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7425684">{</span><span class="string" id="7425685">&#34;localhost.net&#34;</span><span class="op" id="7425700">,</span>&nbsp;<span class="ident" id="7425702">true</span><span class="op" id="7425706">}</span><span class="op" id="7425707">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7425711">//&nbsp;not&nbsp;match&nbsp;as&nbsp;suffix&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7425746">{</span><span class="string" id="7425747">&#34;local.localhost&#34;</span><span class="op" id="7425764">,</span>&nbsp;<span class="ident" id="7425766">true</span><span class="op" id="7425770">}</span><span class="op" id="7425771">,</span>&nbsp;<span class="comment" id="7425773">//&nbsp;not&nbsp;match&nbsp;as&nbsp;prefix&nbsp;as&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7425808">{</span><span class="string" id="7425809">&#34;barbarbaz.net&#34;</span><span class="op" id="7425824">,</span>&nbsp;<span class="ident" id="7425826">true</span><span class="op" id="7425830">}</span><span class="op" id="7425831">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7425835">//&nbsp;not&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;have&nbsp;a&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7425877">{</span><span class="string" id="7425878">&#34;www.foobar.com&#34;</span><span class="op" id="7425894">,</span>&nbsp;<span class="ident" id="7425896">false</span><span class="op" id="7425901">}</span><span class="op" id="7425902">,</span>&nbsp;<span class="comment" id="7425904">//&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;includes&nbsp;&#34;foobar.com&#34;</span><br>
<span class="lineno">35</span><span class="op" id="7425952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7425955">func</span>&nbsp;<span class="ident" id="7425960">TestUseProxy</span><span class="op" id="7425972">(</span><span class="ident" id="7425973">t</span>&nbsp;<span class="op" id="7425975">*</span><span class="ident" id="7425976"><a href="/net/http/proxy_test.go.html#7425177">testing</a></span><span class="op" id="7425983">.</span><span class="ident" id="7425984">T</span><span class="op" id="7425985">)</span>&nbsp;<span class="op" id="7425987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7425990"><a href="/net/http/proxy_test.go.html#7426964">ResetProxyEnv</a></span><span class="op" id="7426003">(</span><span class="op" id="7426004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7426007"><a href="/net/http/proxy_test.go.html#7425171">os</a></span><span class="op" id="7426009">.</span><span class="ident" id="7426010">Setenv</span><span class="op" id="7426016">(</span><span class="string" id="7426017">&#34;NO_PROXY&#34;</span><span class="op" id="7426027">,</span>&nbsp;<span class="string" id="7426029">&#34;foobar.com,&nbsp;.barbaz.net&#34;</span><span class="op" id="7426054">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7426057">for</span>&nbsp;<span class="ident" id="7426061">_</span><span class="op" id="7426062">,</span>&nbsp;<span class="ident" id="7426064">test</span>&nbsp;<span class="op" id="7426069">:=</span>&nbsp;<span class="keyword" id="7426072">range</span>&nbsp;<span class="ident" id="7426078"><a href="/net/http/proxy_test.go.html#7425229">UseProxyTests</a></span>&nbsp;<span class="op" id="7426092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7426096">if</span>&nbsp;<span class="ident" id="7426099"><a href="/net/http/transport.go.html#3932992">useProxy</a></span><span class="op" id="7426107">(</span><span class="ident" id="7426108"><a href="/net/http/proxy_test.go.html#7426064">test</a></span><span class="op" id="7426112">.</span><span class="ident" id="7426113">host</span><span class="op" id="7426117">+</span><span class="string" id="7426118">&#34;:80&#34;</span><span class="op" id="7426123">)</span>&nbsp;<span class="op" id="7426125">!=</span>&nbsp;<span class="ident" id="7426128"><a href="/net/http/proxy_test.go.html#7426064">test</a></span><span class="op" id="7426132">.</span><span class="ident" id="7426133">match</span>&nbsp;<span class="op" id="7426139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7426144"><a href="/net/http/proxy_test.go.html#7425973">t</a></span><span class="op" id="7426145">.</span><span class="ident" id="7426146">Errorf</span><span class="op" id="7426152">(</span><span class="string" id="7426153">&#34;useProxy(%v)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7426181">,</span>&nbsp;<span class="ident" id="7426183"><a href="/net/http/proxy_test.go.html#7426064">test</a></span><span class="op" id="7426187">.</span><span class="ident" id="7426188">host</span><span class="op" id="7426192">,</span>&nbsp;<span class="op" id="7426194">!</span><span class="ident" id="7426195"><a href="/net/http/proxy_test.go.html#7426064">test</a></span><span class="op" id="7426199">.</span><span class="ident" id="7426200">match</span><span class="op" id="7426205">,</span>&nbsp;<span class="ident" id="7426207"><a href="/net/http/proxy_test.go.html#7426064">test</a></span><span class="op" id="7426211">.</span><span class="ident" id="7426212">match</span><span class="op" id="7426217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7426221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7426224">}</span><br>
<span class="lineno">45</span><span class="op" id="7426226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7426229">var</span>&nbsp;<span class="ident" id="7426233">cacheKeysTests</span>&nbsp;<span class="op" id="7426248">=</span>&nbsp;<span class="op" id="7426250">[</span><span class="op" id="7426251">]</span><span class="keyword" id="7426252">struct</span>&nbsp;<span class="op" id="7426259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7426262">proxy</span>&nbsp;&nbsp;<span class="builtintype" id="7426269">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7426277">scheme</span>&nbsp;<span class="builtintype" id="7426284">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7426292">addr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7426299">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7426307">key</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7426314">string</span><br>
<span class="lineno"></span><span class="op" id="7426321">}</span><span class="op" id="7426322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7426325">{</span><span class="string" id="7426326">&#34;&#34;</span><span class="op" id="7426328">,</span>&nbsp;<span class="string" id="7426330">&#34;http&#34;</span><span class="op" id="7426336">,</span>&nbsp;<span class="string" id="7426338">&#34;foo.com&#34;</span><span class="op" id="7426347">,</span>&nbsp;<span class="string" id="7426349">&#34;|http|foo.com&#34;</span><span class="op" id="7426364">}</span><span class="op" id="7426365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7426368">{</span><span class="string" id="7426369">&#34;&#34;</span><span class="op" id="7426371">,</span>&nbsp;<span class="string" id="7426373">&#34;https&#34;</span><span class="op" id="7426380">,</span>&nbsp;<span class="string" id="7426382">&#34;foo.com&#34;</span><span class="op" id="7426391">,</span>&nbsp;<span class="string" id="7426393">&#34;|https|foo.com&#34;</span><span class="op" id="7426409">}</span><span class="op" id="7426410">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7426413">{</span><span class="string" id="7426414">&#34;http://foo.com&#34;</span><span class="op" id="7426430">,</span>&nbsp;<span class="string" id="7426432">&#34;http&#34;</span><span class="op" id="7426438">,</span>&nbsp;<span class="string" id="7426440">&#34;foo.com&#34;</span><span class="op" id="7426449">,</span>&nbsp;<span class="string" id="7426451">&#34;http://foo.com|http|&#34;</span><span class="op" id="7426473">}</span><span class="op" id="7426474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7426477">{</span><span class="string" id="7426478">&#34;http://foo.com&#34;</span><span class="op" id="7426494">,</span>&nbsp;<span class="string" id="7426496">&#34;https&#34;</span><span class="op" id="7426503">,</span>&nbsp;<span class="string" id="7426505">&#34;foo.com&#34;</span><span class="op" id="7426514">,</span>&nbsp;<span class="string" id="7426516">&#34;http://foo.com|https|foo.com&#34;</span><span class="op" id="7426546">}</span><span class="op" id="7426547">,</span><br>
<span class="lineno"></span><span class="op" id="7426549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7426552">func</span>&nbsp;<span class="ident" id="7426557">TestCacheKeys</span><span class="op" id="7426570">(</span><span class="ident" id="7426571">t</span>&nbsp;<span class="op" id="7426573">*</span><span class="ident" id="7426574"><a href="/net/http/proxy_test.go.html#7425177">testing</a></span><span class="op" id="7426581">.</span><span class="ident" id="7426582">T</span><span class="op" id="7426583">)</span>&nbsp;<span class="op" id="7426585">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7426588">for</span>&nbsp;<span class="ident" id="7426592">_</span><span class="op" id="7426593">,</span>&nbsp;<span class="ident" id="7426595">tt</span>&nbsp;<span class="op" id="7426598">:=</span>&nbsp;<span class="keyword" id="7426601">range</span>&nbsp;<span class="ident" id="7426607"><a href="/net/http/proxy_test.go.html#7426233">cacheKeysTests</a></span>&nbsp;<span class="op" id="7426622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7426626">var</span>&nbsp;<span class="ident" id="7426630">proxy</span>&nbsp;<span class="op" id="7426636">*</span><span class="ident" id="7426637"><a href="/net/http/proxy_test.go.html#7425160">url</a></span><span class="op" id="7426640">.</span><span class="ident" id="7426641">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7426647">if</span>&nbsp;<span class="ident" id="7426650"><a href="/net/http/proxy_test.go.html#7426595">tt</a></span><span class="op" id="7426652">.</span><span class="ident" id="7426653">proxy</span>&nbsp;<span class="op" id="7426659">!=</span>&nbsp;<span class="string" id="7426662">&#34;&#34;</span>&nbsp;<span class="op" id="7426665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7426670">u</span><span class="op" id="7426671">,</span>&nbsp;<span class="ident" id="7426673">err</span>&nbsp;<span class="op" id="7426677">:=</span>&nbsp;<span class="ident" id="7426680"><a href="/net/http/proxy_test.go.html#7425160">url</a></span><span class="op" id="7426683">.</span><span class="ident" id="7426684">Parse</span><span class="op" id="7426689">(</span><span class="ident" id="7426690"><a href="/net/http/proxy_test.go.html#7426595">tt</a></span><span class="op" id="7426692">.</span><span class="ident" id="7426693">proxy</span><span class="op" id="7426698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7426703">if</span>&nbsp;<span class="ident" id="7426706"><a href="/net/http/proxy_test.go.html#7426673">err</a></span>&nbsp;<span class="op" id="7426710">!=</span>&nbsp;<span class="ident" id="7426713">nil</span>&nbsp;<span class="op" id="7426717">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7426723"><a href="/net/http/proxy_test.go.html#7426571">t</a></span><span class="op" id="7426724">.</span><span class="ident" id="7426725">Fatal</span><span class="op" id="7426730">(</span><span class="ident" id="7426731"><a href="/net/http/proxy_test.go.html#7426673">err</a></span><span class="op" id="7426734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7426739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7426744"><a href="/net/http/proxy_test.go.html#7426630">proxy</a></span>&nbsp;<span class="op" id="7426750">=</span>&nbsp;<span class="ident" id="7426752"><a href="/net/http/proxy_test.go.html#7426670">u</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7426756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7426760">cm</span>&nbsp;<span class="op" id="7426763">:=</span>&nbsp;<span class="ident" id="7426766"><a href="/net/http/transport.go.html#3934637">connectMethod</a></span><span class="op" id="7426779">{</span><span class="ident" id="7426780"><a href="/net/http/proxy_test.go.html#7426630">proxy</a></span><span class="op" id="7426785">,</span>&nbsp;<span class="ident" id="7426787"><a href="/net/http/proxy_test.go.html#7426595">tt</a></span><span class="op" id="7426789">.</span><span class="ident" id="7426790">scheme</span><span class="op" id="7426796">,</span>&nbsp;<span class="ident" id="7426798"><a href="/net/http/proxy_test.go.html#7426595">tt</a></span><span class="op" id="7426800">.</span><span class="ident" id="7426801">addr</span><span class="op" id="7426805">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7426809">if</span>&nbsp;<span class="ident" id="7426812">got</span>&nbsp;<span class="op" id="7426816">:=</span>&nbsp;<span class="ident" id="7426819"><a href="/net/http/proxy_test.go.html#7426760">cm</a></span><span class="op" id="7426821">.</span><span class="ident" id="7426822">key</span><span class="op" id="7426825">(</span><span class="op" id="7426826">)</span><span class="op" id="7426827">.</span><span class="ident" id="7426828">String</span><span class="op" id="7426834">(</span><span class="op" id="7426835">)</span><span class="op" id="7426836">;</span>&nbsp;<span class="ident" id="7426838"><a href="/net/http/proxy_test.go.html#7426812">got</a></span>&nbsp;<span class="op" id="7426842">!=</span>&nbsp;<span class="ident" id="7426845"><a href="/net/http/proxy_test.go.html#7426595">tt</a></span><span class="op" id="7426847">.</span><span class="ident" id="7426848">key</span>&nbsp;<span class="op" id="7426852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7426857"><a href="/net/http/proxy_test.go.html#7426571">t</a></span><span class="op" id="7426858">.</span><span class="ident" id="7426859">Fatalf</span><span class="op" id="7426865">(</span><span class="string" id="7426866">&#34;{%q,&nbsp;%q,&nbsp;%q}&nbsp;cache&nbsp;key&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7426904">,</span>&nbsp;<span class="ident" id="7426906"><a href="/net/http/proxy_test.go.html#7426595">tt</a></span><span class="op" id="7426908">.</span><span class="ident" id="7426909">proxy</span><span class="op" id="7426914">,</span>&nbsp;<span class="ident" id="7426916"><a href="/net/http/proxy_test.go.html#7426595">tt</a></span><span class="op" id="7426918">.</span><span class="ident" id="7426919">scheme</span><span class="op" id="7426925">,</span>&nbsp;<span class="ident" id="7426927"><a href="/net/http/proxy_test.go.html#7426595">tt</a></span><span class="op" id="7426929">.</span><span class="ident" id="7426930">addr</span><span class="op" id="7426934">,</span>&nbsp;<span class="ident" id="7426936"><a href="/net/http/proxy_test.go.html#7426812">got</a></span><span class="op" id="7426939">,</span>&nbsp;<span class="ident" id="7426941"><a href="/net/http/proxy_test.go.html#7426595">tt</a></span><span class="op" id="7426943">.</span><span class="ident" id="7426944">key</span><span class="op" id="7426947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7426951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7426954">}</span><br>
<span class="lineno"></span><span class="op" id="7426956">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="7426959">func</span>&nbsp;<span class="ident" id="7426964">ResetProxyEnv</span><span class="op" id="7426977">(</span><span class="op" id="7426978">)</span>&nbsp;<span class="op" id="7426980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7426983">for</span>&nbsp;<span class="ident" id="7426987">_</span><span class="op" id="7426988">,</span>&nbsp;<span class="ident" id="7426990">v</span>&nbsp;<span class="op" id="7426992">:=</span>&nbsp;<span class="keyword" id="7426995">range</span>&nbsp;<span class="op" id="7427001">[</span><span class="op" id="7427002">]</span><span class="builtintype" id="7427003">string</span><span class="op" id="7427009">{</span><span class="string" id="7427010">&#34;HTTP_PROXY&#34;</span><span class="op" id="7427022">,</span>&nbsp;<span class="string" id="7427024">&#34;http_proxy&#34;</span><span class="op" id="7427036">,</span>&nbsp;<span class="string" id="7427038">&#34;NO_PROXY&#34;</span><span class="op" id="7427048">,</span>&nbsp;<span class="string" id="7427050">&#34;no_proxy&#34;</span><span class="op" id="7427060">}</span>&nbsp;<span class="op" id="7427062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7427066"><a href="/net/http/proxy_test.go.html#7425171">os</a></span><span class="op" id="7427068">.</span><span class="ident" id="7427069">Setenv</span><span class="op" id="7427075">(</span><span class="ident" id="7427076"><a href="/net/http/proxy_test.go.html#7426990">v</a></span><span class="op" id="7427077">,</span>&nbsp;<span class="string" id="7427079">&#34;&#34;</span><span class="op" id="7427081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7427084">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7427087"><a href="/net/http/export_test.go.html#7417262">ResetCachedEnvironment</a></span><span class="op" id="7427109">(</span><span class="op" id="7427110">)</span><br>
<span class="lineno"></span><span class="op" id="7427112">}</span>
</div>
</body>
</html>
