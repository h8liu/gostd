<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2006186">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2006241">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2006295">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2006346">package</span>&nbsp;<span class="ident" id="2006354">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2006363">import</span>&nbsp;<span class="string" id="2006370">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2006380">//&nbsp;Note:&nbsp;the&nbsp;MemStats&nbsp;struct&nbsp;should&nbsp;be&nbsp;kept&nbsp;in&nbsp;sync&nbsp;with</span><br>
<span class="lineno">10</span><span class="comment" id="2006437">//&nbsp;struct&nbsp;MStats&nbsp;in&nbsp;malloc.h</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2006467">//&nbsp;A&nbsp;MemStats&nbsp;records&nbsp;statistics&nbsp;about&nbsp;the&nbsp;memory&nbsp;allocator.</span><br>
<span class="lineno"></span><span class="keyword" id="2006528">type</span>&nbsp;<span class="ident" id="2006533">MemStats</span>&nbsp;<span class="keyword" id="2006542">struct</span>&nbsp;<span class="op" id="2006549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006552">//&nbsp;General&nbsp;statistics.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006576">Alloc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2006587">uint64</span>&nbsp;<span class="comment" id="2006594">//&nbsp;bytes&nbsp;allocated&nbsp;and&nbsp;still&nbsp;in&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006631">TotalAlloc</span>&nbsp;<span class="ident" id="2006642">uint64</span>&nbsp;<span class="comment" id="2006649">//&nbsp;bytes&nbsp;allocated&nbsp;(even&nbsp;if&nbsp;freed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006685">Sys</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2006696">uint64</span>&nbsp;<span class="comment" id="2006703">//&nbsp;bytes&nbsp;obtained&nbsp;from&nbsp;system&nbsp;(sum&nbsp;of&nbsp;XxxSys&nbsp;below)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006756">Lookups</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2006767">uint64</span>&nbsp;<span class="comment" id="2006774">//&nbsp;number&nbsp;of&nbsp;pointer&nbsp;lookups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006804">Mallocs</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2006815">uint64</span>&nbsp;<span class="comment" id="2006822">//&nbsp;number&nbsp;of&nbsp;mallocs</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006844">Frees</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2006855">uint64</span>&nbsp;<span class="comment" id="2006862">//&nbsp;number&nbsp;of&nbsp;frees</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2006883">//&nbsp;Main&nbsp;allocation&nbsp;heap&nbsp;statistics.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006920">HeapAlloc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2006933">uint64</span>&nbsp;<span class="comment" id="2006940">//&nbsp;bytes&nbsp;allocated&nbsp;and&nbsp;still&nbsp;in&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2006977">HeapSys</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2006990">uint64</span>&nbsp;<span class="comment" id="2006997">//&nbsp;bytes&nbsp;obtained&nbsp;from&nbsp;system</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007028">HeapIdle</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2007041">uint64</span>&nbsp;<span class="comment" id="2007048">//&nbsp;bytes&nbsp;in&nbsp;idle&nbsp;spans</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007072">HeapInuse</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2007085">uint64</span>&nbsp;<span class="comment" id="2007092">//&nbsp;bytes&nbsp;in&nbsp;non-idle&nbsp;span</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007119">HeapReleased</span>&nbsp;<span class="ident" id="2007132">uint64</span>&nbsp;<span class="comment" id="2007139">//&nbsp;bytes&nbsp;released&nbsp;to&nbsp;the&nbsp;OS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007168">HeapObjects</span>&nbsp;&nbsp;<span class="ident" id="2007181">uint64</span>&nbsp;<span class="comment" id="2007188">//&nbsp;total&nbsp;number&nbsp;of&nbsp;allocated&nbsp;objects</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007227">//&nbsp;Low-level&nbsp;fixed-size&nbsp;structure&nbsp;allocator&nbsp;statistics.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007284">//&nbsp;&nbsp;&nbsp;&nbspInuse&nbsp;is&nbsp;bytes&nbsp;used&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007313">//&nbsp;&nbsp;&nbsp;&nbspSys&nbsp;is&nbsp;bytes&nbsp;obtained&nbsp;from&nbsp;system.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007352">StackInuse</span>&nbsp;&nbsp;<span class="ident" id="2007364">uint64</span>&nbsp;<span class="comment" id="2007371">//&nbsp;bytes&nbsp;used&nbsp;by&nbsp;stack&nbsp;allocator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007405">StackSys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2007417">uint64</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007425">MSpanInuse</span>&nbsp;&nbsp;<span class="ident" id="2007437">uint64</span>&nbsp;<span class="comment" id="2007444">//&nbsp;mspan&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007465">MSpanSys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2007477">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007485">MCacheInuse</span>&nbsp;<span class="ident" id="2007497">uint64</span>&nbsp;<span class="comment" id="2007504">//&nbsp;mcache&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007526">MCacheSys</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2007538">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007546">BuckHashSys</span>&nbsp;<span class="ident" id="2007558">uint64</span>&nbsp;<span class="comment" id="2007565">//&nbsp;profiling&nbsp;bucket&nbsp;hash&nbsp;table</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007597">GCSys</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2007609">uint64</span>&nbsp;<span class="comment" id="2007616">//&nbsp;GC&nbsp;metadata</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007632">OtherSys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2007644">uint64</span>&nbsp;<span class="comment" id="2007651">//&nbsp;other&nbsp;system&nbsp;allocations</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2007681">//&nbsp;Garbage&nbsp;collector&nbsp;statistics.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007715">NextGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2007728">uint64</span>&nbsp;<span class="comment" id="2007735">//&nbsp;next&nbsp;collection&nbsp;will&nbsp;happen&nbsp;when&nbsp;HeapAlloc&nbsp;â‰¥&nbsp;this&nbsp;amount</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007798">LastGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2007811">uint64</span>&nbsp;<span class="comment" id="2007818">//&nbsp;end&nbsp;time&nbsp;of&nbsp;last&nbsp;collection&nbsp;(nanoseconds&nbsp;since&nbsp;1970)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007875">PauseTotalNs</span>&nbsp;<span class="ident" id="2007888">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2007896">PauseNs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2007909">[</span><span class="num" id="2007910">256</span><span class="op" id="2007913">]</span><span class="ident" id="2007914">uint64</span>&nbsp;<span class="comment" id="2007921">//&nbsp;circular&nbsp;buffer&nbsp;of&nbsp;recent&nbsp;GC&nbsp;pause&nbsp;durations,&nbsp;most&nbsp;recent&nbsp;at&nbsp;[(NumGC+255)%256]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008004">PauseEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2008017">[</span><span class="num" id="2008018">256</span><span class="op" id="2008021">]</span><span class="ident" id="2008022">uint64</span>&nbsp;<span class="comment" id="2008029">//&nbsp;circular&nbsp;buffer&nbsp;of&nbsp;recent&nbsp;GC&nbsp;pause&nbsp;end&nbsp;times</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008078">NumGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2008091">uint32</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008099">EnableGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2008112">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008118">DebugGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2008131">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2008138">//&nbsp;Per-size&nbsp;allocation&nbsp;statistics.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2008174">//&nbsp;61&nbsp;is&nbsp;NumSizeClasses&nbsp;in&nbsp;the&nbsp;C&nbsp;code.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008214">BySize</span>&nbsp;<span class="op" id="2008221">[</span><span class="num" id="2008222">61</span><span class="op" id="2008224">]</span><span class="keyword" id="2008225">struct</span>&nbsp;<span class="op" id="2008232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008236">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2008244">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008253">Mallocs</span>&nbsp;<span class="ident" id="2008261">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008270">Frees</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2008278">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2008286">}</span><br>
<span class="lineno">60</span><span class="op" id="2008288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2008291">var</span>&nbsp;<span class="ident" id="2008295">sizeof_C_MStats</span>&nbsp;<span class="builtintype" id="2008311">uintptr</span>&nbsp;<span class="comment" id="2008319">//&nbsp;filled&nbsp;in&nbsp;by&nbsp;malloc.goc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2008347">func</span>&nbsp;<span class="ident" id="2008352">init</span><span class="op" id="2008356">(</span><span class="op" id="2008357">)</span>&nbsp;<span class="op" id="2008359">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2008362">var</span>&nbsp;<span class="ident" id="2008366">memStats</span>&nbsp;<span class="ident" id="2008375"><a href="/runtime/mem.go.html#2006533">MemStats</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2008385">if</span>&nbsp;<span class="ident" id="2008388"><a href="/runtime/mem.go.html#2008295">sizeof_C_MStats</a></span>&nbsp;<span class="op" id="2008404">!=</span>&nbsp;<span class="ident" id="2008407"><a href="/runtime/mem.go.html#2006370">unsafe</a></span><span class="op" id="2008413">.</span><span class="ident" id="2008414">Sizeof</span><span class="op" id="2008420">(</span><span class="ident" id="2008421"><a href="/runtime/mem.go.html#2008366">memStats</a></span><span class="op" id="2008429">)</span>&nbsp;<span class="op" id="2008431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2008435">println</span><span class="op" id="2008442">(</span><span class="ident" id="2008443"><a href="/runtime/mem.go.html#2008295">sizeof_C_MStats</a></span><span class="op" id="2008458">,</span>&nbsp;<span class="ident" id="2008460"><a href="/runtime/mem.go.html#2006370">unsafe</a></span><span class="op" id="2008466">.</span><span class="ident" id="2008467">Sizeof</span><span class="op" id="2008473">(</span><span class="ident" id="2008474"><a href="/runtime/mem.go.html#2008366">memStats</a></span><span class="op" id="2008482">)</span><span class="op" id="2008483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008487"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="2008494">(</span><span class="string" id="2008495">&#34;MStats&nbsp;vs&nbsp;MemStatsType&nbsp;size&nbsp;mismatch&#34;</span><span class="op" id="2008533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2008536">}</span><br>
<span class="lineno">70</span><span class="op" id="2008538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2008541">//&nbsp;ReadMemStats&nbsp;populates&nbsp;m&nbsp;with&nbsp;memory&nbsp;allocator&nbsp;statistics.</span><br>
<span class="lineno"></span><span class="keyword" id="2008603">func</span>&nbsp;<span class="ident" id="2008608">ReadMemStats</span><span class="op" id="2008620">(</span><span class="ident" id="2008621">m</span>&nbsp;<span class="op" id="2008623">*</span><span class="ident" id="2008624"><a href="/runtime/mem.go.html#2006533">MemStats</a></span><span class="op" id="2008632">)</span>&nbsp;<span class="op" id="2008634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2008637">//&nbsp;Have&nbsp;to&nbsp;acquire&nbsp;worldsema&nbsp;to&nbsp;stop&nbsp;the&nbsp;world,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2008686">//&nbsp;because&nbsp;stoptheworld&nbsp;can&nbsp;only&nbsp;be&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2008731">//&nbsp;one&nbsp;goroutine&nbsp;at&nbsp;a&nbsp;time,&nbsp;and&nbsp;there&nbsp;might&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2008779">//&nbsp;a&nbsp;pending&nbsp;garbage&nbsp;collection&nbsp;already&nbsp;calling&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008832"><a href="/runtime/sema.go.html#2096000">semacquire</a></span><span class="op" id="2008842">(</span><span class="op" id="2008843">&amp;</span><span class="ident" id="2008844"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2184696">worldsema</a></span><span class="op" id="2008853">,</span>&nbsp;<span class="builtintype" id="2008855">false</span><span class="op" id="2008860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008863">gp</span>&nbsp;<span class="op" id="2008866">:=</span>&nbsp;<span class="ident" id="2008869"><a href="/runtime/stubs.go.html#2132021">getg</a></span><span class="op" id="2008873">(</span><span class="op" id="2008874">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008877"><a href="/runtime/mem.go.html#2008863">gp</a></span><span class="op" id="2008879">.</span><span class="ident" id="2008880">m</span><span class="op" id="2008881">.</span><span class="ident" id="2008882">gcing</span>&nbsp;<span class="op" id="2008888">=</span>&nbsp;<span class="num" id="2008890">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008893"><a href="/runtime/stubs.go.html#2134137">onM</a></span><span class="op" id="2008896">(</span><span class="ident" id="2008897"><a href="/runtime/stubs.go.html#2135896">stoptheworld</a></span><span class="op" id="2008909">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008913"><a href="/runtime/mem.go.html#2008863">gp</a></span><span class="op" id="2008915">.</span><span class="ident" id="2008916">m</span><span class="op" id="2008917">.</span><span class="ident" id="2008918">ptrarg</span><span class="op" id="2008924">[</span><span class="num" id="2008925">0</span><span class="op" id="2008926">]</span>&nbsp;<span class="op" id="2008928">=</span>&nbsp;<span class="ident" id="2008930"><a href="/runtime/stubs.go.html#2136422">noescape</a></span><span class="op" id="2008938">(</span><span class="ident" id="2008939"><a href="/runtime/mem.go.html#2006370">unsafe</a></span><span class="op" id="2008945">.</span><span class="ident" id="2008946">Pointer</span><span class="op" id="2008953">(</span><span class="ident" id="2008954"><a href="/runtime/mem.go.html#2008621">m</a></span><span class="op" id="2008955">)</span><span class="op" id="2008956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008959"><a href="/runtime/stubs.go.html#2134137">onM</a></span><span class="op" id="2008962">(</span><span class="ident" id="2008963"><a href="/runtime/stubs.go.html#2135568">readmemstats_m</a></span><span class="op" id="2008977">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008981"><a href="/runtime/mem.go.html#2008863">gp</a></span><span class="op" id="2008983">.</span><span class="ident" id="2008984">m</span><span class="op" id="2008985">.</span><span class="ident" id="2008986">gcing</span>&nbsp;<span class="op" id="2008992">=</span>&nbsp;<span class="num" id="2008994">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2008997"><a href="/runtime/mem.go.html#2008863">gp</a></span><span class="op" id="2008999">.</span><span class="ident" id="2009000">m</span><span class="op" id="2009001">.</span><span class="ident" id="2009002">locks</span><span class="op" id="2009007">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009011"><a href="/runtime/sema.go.html#2097084">semrelease</a></span><span class="op" id="2009021">(</span><span class="op" id="2009022">&amp;</span><span class="ident" id="2009023"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2184696">worldsema</a></span><span class="op" id="2009032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009035"><a href="/runtime/stubs.go.html#2134137">onM</a></span><span class="op" id="2009038">(</span><span class="ident" id="2009039"><a href="/runtime/stubs.go.html#2135875">starttheworld</a></span><span class="op" id="2009052">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009055"><a href="/runtime/mem.go.html#2008863">gp</a></span><span class="op" id="2009057">.</span><span class="ident" id="2009058">m</span><span class="op" id="2009059">.</span><span class="ident" id="2009060">locks</span><span class="op" id="2009065">--</span><br>
<span class="lineno"></span><span class="op" id="2009068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2009071">//&nbsp;Implementation&nbsp;of&nbsp;runtime/debug.WriteHeapDump</span><br>
<span class="lineno"></span><span class="keyword" id="2009120">func</span>&nbsp;<span class="ident" id="2009125">writeHeapDump</span><span class="op" id="2009138">(</span><span class="ident" id="2009139">fd</span>&nbsp;<span class="builtintype" id="2009142">uintptr</span><span class="op" id="2009149">)</span>&nbsp;<span class="op" id="2009151">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009154"><a href="/runtime/sema.go.html#2096000">semacquire</a></span><span class="op" id="2009164">(</span><span class="op" id="2009165">&amp;</span><span class="ident" id="2009166"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2184696">worldsema</a></span><span class="op" id="2009175">,</span>&nbsp;<span class="builtintype" id="2009177">false</span><span class="op" id="2009182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009185">gp</span>&nbsp;<span class="op" id="2009188">:=</span>&nbsp;<span class="ident" id="2009191"><a href="/runtime/stubs.go.html#2132021">getg</a></span><span class="op" id="2009195">(</span><span class="op" id="2009196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009199"><a href="/runtime/mem.go.html#2009185">gp</a></span><span class="op" id="2009201">.</span><span class="ident" id="2009202">m</span><span class="op" id="2009203">.</span><span class="ident" id="2009204">gcing</span>&nbsp;<span class="op" id="2009210">=</span>&nbsp;<span class="num" id="2009212">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009215"><a href="/runtime/stubs.go.html#2134137">onM</a></span><span class="op" id="2009218">(</span><span class="ident" id="2009219"><a href="/runtime/stubs.go.html#2135896">stoptheworld</a></span><span class="op" id="2009231">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009235"><a href="/runtime/mem.go.html#2009185">gp</a></span><span class="op" id="2009237">.</span><span class="ident" id="2009238">m</span><span class="op" id="2009239">.</span><span class="ident" id="2009240">scalararg</span><span class="op" id="2009249">[</span><span class="num" id="2009250">0</span><span class="op" id="2009251">]</span>&nbsp;<span class="op" id="2009253">=</span>&nbsp;<span class="ident" id="2009255"><a href="/runtime/mem.go.html#2009139">fd</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009259"><a href="/runtime/stubs.go.html#2134137">onM</a></span><span class="op" id="2009262">(</span><span class="ident" id="2009263"><a href="/runtime/stubs.go.html#2135590">writeheapdump_m</a></span><span class="op" id="2009278">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009282"><a href="/runtime/mem.go.html#2009185">gp</a></span><span class="op" id="2009284">.</span><span class="ident" id="2009285">m</span><span class="op" id="2009286">.</span><span class="ident" id="2009287">gcing</span>&nbsp;<span class="op" id="2009293">=</span>&nbsp;<span class="num" id="2009295">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009298"><a href="/runtime/mem.go.html#2009185">gp</a></span><span class="op" id="2009300">.</span><span class="ident" id="2009301">m</span><span class="op" id="2009302">.</span><span class="ident" id="2009303">locks</span><span class="op" id="2009308">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009312"><a href="/runtime/sema.go.html#2097084">semrelease</a></span><span class="op" id="2009322">(</span><span class="op" id="2009323">&amp;</span><span class="ident" id="2009324"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2184696">worldsema</a></span><span class="op" id="2009333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009336"><a href="/runtime/stubs.go.html#2134137">onM</a></span><span class="op" id="2009339">(</span><span class="ident" id="2009340"><a href="/runtime/stubs.go.html#2135875">starttheworld</a></span><span class="op" id="2009353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2009356"><a href="/runtime/mem.go.html#2009185">gp</a></span><span class="op" id="2009358">.</span><span class="ident" id="2009359">m</span><span class="op" id="2009360">.</span><span class="ident" id="2009361">locks</span><span class="op" id="2009366">--</span><br>
<span class="lineno"></span><span class="op" id="2009369">}</span>
</div>
</body>
</html>
