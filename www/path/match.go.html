<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3860388">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3860443">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3860497">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3860548">package</span>&nbsp;<span class="ident" id="3860556">path</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3860562">import</span>&nbsp;<span class="op" id="3860569">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3860572">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3860582">&#34;strings&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3860593">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3860608">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3860611">//&nbsp;ErrBadPattern&nbsp;indicates&nbsp;a&nbsp;globbing&nbsp;pattern&nbsp;was&nbsp;malformed.</span><br>
<span class="lineno"></span><span class="keyword" id="3860672">var</span>&nbsp;<span class="ident" id="3860676">ErrBadPattern</span>&nbsp;<span class="op" id="3860690">=</span>&nbsp;<span class="ident" id="3860692">errors</span><span class="op" id="3860698">.</span><span class="ident" id="3860699">New</span><span class="op" id="3860702">(</span><span class="string" id="3860703">&#34;syntax&nbsp;error&nbsp;in&nbsp;pattern&#34;</span><span class="op" id="3860728">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3860731">//&nbsp;Match&nbsp;returns&nbsp;true&nbsp;if&nbsp;name&nbsp;matches&nbsp;the&nbsp;shell&nbsp;file&nbsp;name&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="comment" id="3860798">//&nbsp;The&nbsp;pattern&nbsp;syntax&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="3860824">//</span><br>
<span class="lineno"></span><span class="comment" id="3860827">//&nbsp;&nbsp;&nbsp;&nbsppattern:</span><br>
<span class="lineno">20</span><span class="comment" id="3860839">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp{&nbsp;term&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3860852">//&nbsp;&nbsp;&nbsp;&nbspterm:</span><br>
<span class="lineno"></span><span class="comment" id="3860861">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#39;*&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;any&nbsp;sequence&nbsp;of&nbsp;non-/&nbsp;characters</span><br>
<span class="lineno"></span><span class="comment" id="3860918">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#39;?&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;any&nbsp;single&nbsp;non-/&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="3860969">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#39;[&#39;&nbsp;[&nbsp;&#39;^&#39;&nbsp;]&nbsp;{&nbsp;character-range&nbsp;}&nbsp;&#39;]&#39;</span><br>
<span class="lineno">25</span><span class="comment" id="3861009">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;character&nbsp;class&nbsp;(must&nbsp;be&nbsp;non-empty)</span><br>
<span class="lineno"></span><span class="comment" id="3861061">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c&nbsp;(c&nbsp;!=&nbsp;&#39;*&#39;,&nbsp;&#39;?&#39;,&nbsp;&#39;\\&#39;,&nbsp;&#39;[&#39;)</span><br>
<span class="lineno"></span><span class="comment" id="3861124">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#39;\\&#39;&nbsp;c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c</span><br>
<span class="lineno"></span><span class="comment" id="3861160">//</span><br>
<span class="lineno"></span><span class="comment" id="3861163">//&nbsp;&nbsp;&nbsp;&nbspcharacter-range:</span><br>
<span class="lineno">30</span><span class="comment" id="3861183">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c&nbsp;(c&nbsp;!=&nbsp;&#39;\\&#39;,&nbsp;&#39;-&#39;,&nbsp;&#39;]&#39;)</span><br>
<span class="lineno"></span><span class="comment" id="3861241">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#39;\\&#39;&nbsp;c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c</span><br>
<span class="lineno"></span><span class="comment" id="3861277">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsplo&nbsp;&#39;-&#39;&nbsp;hi&nbsp;&nbsp;&nbsp;matches&nbsp;character&nbsp;c&nbsp;for&nbsp;lo&nbsp;&lt;=&nbsp;c&nbsp;&lt;=&nbsp;hi</span><br>
<span class="lineno"></span><span class="comment" id="3861331">//</span><br>
<span class="lineno"></span><span class="comment" id="3861334">//&nbsp;Match&nbsp;requires&nbsp;pattern&nbsp;to&nbsp;match&nbsp;all&nbsp;of&nbsp;name,&nbsp;not&nbsp;just&nbsp;a&nbsp;substring.</span><br>
<span class="lineno">35</span><span class="comment" id="3861404">//&nbsp;The&nbsp;only&nbsp;possible&nbsp;returned&nbsp;error&nbsp;is&nbsp;ErrBadPattern,&nbsp;when&nbsp;pattern</span><br>
<span class="lineno"></span><span class="comment" id="3861471">//&nbsp;is&nbsp;malformed.</span><br>
<span class="lineno"></span><span class="comment" id="3861488">//</span><br>
<span class="lineno"></span><span class="keyword" id="3861491">func</span>&nbsp;<span class="ident" id="3861496">Match</span><span class="op" id="3861501">(</span><span class="ident" id="3861502">pattern</span><span class="op" id="3861509">,</span>&nbsp;<span class="ident" id="3861511">name</span>&nbsp;<span class="builtintype" id="3861516">string</span><span class="op" id="3861522">)</span>&nbsp;<span class="op" id="3861524">(</span><span class="ident" id="3861525">matched</span>&nbsp;<span class="builtintype" id="3861533">bool</span><span class="op" id="3861537">,</span>&nbsp;<span class="ident" id="3861539">err</span>&nbsp;<span class="builtintype" id="3861543">error</span><span class="op" id="3861548">)</span>&nbsp;<span class="op" id="3861550">{</span><br>
<span class="lineno"></span><span class="ident" id="3861552">Pattern</span><span class="op" id="3861559">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861562">for</span>&nbsp;<span class="builtinfunc" id="3861566">len</span><span class="op" id="3861569">(</span><span class="ident" id="3861570">pattern</span><span class="op" id="3861577">)</span>&nbsp;<span class="op" id="3861579">&gt;</span>&nbsp;<span class="num" id="3861581">0</span>&nbsp;<span class="op" id="3861583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861587">var</span>&nbsp;<span class="ident" id="3861591">star</span>&nbsp;<span class="builtintype" id="3861596">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861603">var</span>&nbsp;<span class="ident" id="3861607">chunk</span>&nbsp;<span class="builtintype" id="3861613">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861622">star</span><span class="op" id="3861626">,</span>&nbsp;<span class="ident" id="3861628">chunk</span><span class="op" id="3861633">,</span>&nbsp;<span class="ident" id="3861635">pattern</span>&nbsp;<span class="op" id="3861643">=</span>&nbsp;<span class="ident" id="3861645">scanChunk</span><span class="op" id="3861654">(</span><span class="ident" id="3861655">pattern</span><span class="op" id="3861662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861666">if</span>&nbsp;<span class="ident" id="3861669">star</span>&nbsp;<span class="op" id="3861674">&amp;&amp;</span>&nbsp;<span class="ident" id="3861677">chunk</span>&nbsp;<span class="op" id="3861683">==</span>&nbsp;<span class="string" id="3861686">&#34;&#34;</span>&nbsp;<span class="op" id="3861689">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861694">//&nbsp;Trailing&nbsp;*&nbsp;matches&nbsp;rest&nbsp;of&nbsp;string&nbsp;unless&nbsp;it&nbsp;has&nbsp;a&nbsp;/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3861753">return</span>&nbsp;<span class="ident" id="3861760">strings</span><span class="op" id="3861767">.</span><span class="ident" id="3861768">Index</span><span class="op" id="3861773">(</span><span class="ident" id="3861774">name</span><span class="op" id="3861778">,</span>&nbsp;<span class="string" id="3861780">&#34;/&#34;</span><span class="op" id="3861783">)</span>&nbsp;<span class="op" id="3861785">&lt;</span>&nbsp;<span class="num" id="3861787">0</span><span class="op" id="3861788">,</span>&nbsp;<span class="ident" id="3861790">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3861796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861800">//&nbsp;Look&nbsp;for&nbsp;match&nbsp;at&nbsp;current&nbsp;position.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3861841">t</span><span class="op" id="3861842">,</span>&nbsp;<span class="ident" id="3861844">ok</span><span class="op" id="3861846">,</span>&nbsp;<span class="ident" id="3861848">err</span>&nbsp;<span class="op" id="3861852">:=</span>&nbsp;<span class="ident" id="3861855">matchChunk</span><span class="op" id="3861865">(</span><span class="ident" id="3861866">chunk</span><span class="op" id="3861871">,</span>&nbsp;<span class="ident" id="3861873">name</span><span class="op" id="3861877">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861881">//&nbsp;if&nbsp;we&#39;re&nbsp;the&nbsp;last&nbsp;chunk,&nbsp;make&nbsp;sure&nbsp;we&#39;ve&nbsp;exhausted&nbsp;the&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3861946">//&nbsp;otherwise&nbsp;we&#39;ll&nbsp;give&nbsp;a&nbsp;false&nbsp;result&nbsp;even&nbsp;if&nbsp;we&nbsp;could&nbsp;still&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3862016">//&nbsp;using&nbsp;the&nbsp;star</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862036">if</span>&nbsp;<span class="ident" id="3862039">ok</span>&nbsp;<span class="op" id="3862042">&amp;&amp;</span>&nbsp;<span class="op" id="3862045">(</span><span class="builtinfunc" id="3862046">len</span><span class="op" id="3862049">(</span><span class="ident" id="3862050">t</span><span class="op" id="3862051">)</span>&nbsp;<span class="op" id="3862053">==</span>&nbsp;<span class="num" id="3862056">0</span>&nbsp;<span class="op" id="3862058">||</span>&nbsp;<span class="builtinfunc" id="3862061">len</span><span class="op" id="3862064">(</span><span class="ident" id="3862065">pattern</span><span class="op" id="3862072">)</span>&nbsp;<span class="op" id="3862074">&gt;</span>&nbsp;<span class="num" id="3862076">0</span><span class="op" id="3862077">)</span>&nbsp;<span class="op" id="3862079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3862084">name</span>&nbsp;<span class="op" id="3862089">=</span>&nbsp;<span class="ident" id="3862091">t</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862096">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862111">if</span>&nbsp;<span class="ident" id="3862114">err</span>&nbsp;<span class="op" id="3862118">!=</span>&nbsp;<span class="ident" id="3862121">nil</span>&nbsp;<span class="op" id="3862125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862130">return</span>&nbsp;<span class="ident" id="3862137">false</span><span class="op" id="3862142">,</span>&nbsp;<span class="ident" id="3862144">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862150">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862154">if</span>&nbsp;<span class="ident" id="3862157">star</span>&nbsp;<span class="op" id="3862162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3862167">//&nbsp;Look&nbsp;for&nbsp;match&nbsp;skipping&nbsp;i+1&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3862208">//&nbsp;Cannot&nbsp;skip&nbsp;/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862229">for</span>&nbsp;<span class="ident" id="3862233">i</span>&nbsp;<span class="op" id="3862235">:=</span>&nbsp;<span class="num" id="3862238">0</span><span class="op" id="3862239">;</span>&nbsp;<span class="ident" id="3862241">i</span>&nbsp;<span class="op" id="3862243">&lt;</span>&nbsp;<span class="builtinfunc" id="3862245">len</span><span class="op" id="3862248">(</span><span class="ident" id="3862249">name</span><span class="op" id="3862253">)</span>&nbsp;<span class="op" id="3862255">&amp;&amp;</span>&nbsp;<span class="ident" id="3862258">name</span><span class="op" id="3862262">[</span><span class="ident" id="3862263">i</span><span class="op" id="3862264">]</span>&nbsp;<span class="op" id="3862266">!=</span>&nbsp;<span class="string" id="3862269">&#39;/&#39;</span><span class="op" id="3862272">;</span>&nbsp;<span class="ident" id="3862274">i</span><span class="op" id="3862275">++</span>&nbsp;<span class="op" id="3862278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3862284">t</span><span class="op" id="3862285">,</span>&nbsp;<span class="ident" id="3862287">ok</span><span class="op" id="3862289">,</span>&nbsp;<span class="ident" id="3862291">err</span>&nbsp;<span class="op" id="3862295">:=</span>&nbsp;<span class="ident" id="3862298">matchChunk</span><span class="op" id="3862308">(</span><span class="ident" id="3862309">chunk</span><span class="op" id="3862314">,</span>&nbsp;<span class="ident" id="3862316">name</span><span class="op" id="3862320">[</span><span class="ident" id="3862321">i</span><span class="op" id="3862322">+</span><span class="num" id="3862323">1</span><span class="op" id="3862324">:</span><span class="op" id="3862325">]</span><span class="op" id="3862326">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862332">if</span>&nbsp;<span class="ident" id="3862335">ok</span>&nbsp;<span class="op" id="3862338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3862345">//&nbsp;if&nbsp;we&#39;re&nbsp;the&nbsp;last&nbsp;chunk,&nbsp;make&nbsp;sure&nbsp;we&nbsp;exhausted&nbsp;the&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862410">if</span>&nbsp;<span class="builtinfunc" id="3862413">len</span><span class="op" id="3862416">(</span><span class="ident" id="3862417">pattern</span><span class="op" id="3862424">)</span>&nbsp;<span class="op" id="3862426">==</span>&nbsp;<span class="num" id="3862429">0</span>&nbsp;<span class="op" id="3862431">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3862434">len</span><span class="op" id="3862437">(</span><span class="ident" id="3862438">t</span><span class="op" id="3862439">)</span>&nbsp;<span class="op" id="3862441">&gt;</span>&nbsp;<span class="num" id="3862443">0</span>&nbsp;<span class="op" id="3862445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862453">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862467">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3862474">name</span>&nbsp;<span class="op" id="3862479">=</span>&nbsp;<span class="ident" id="3862481">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862488">continue</span>&nbsp;<span class="ident" id="3862497">Pattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862515">if</span>&nbsp;<span class="ident" id="3862518">err</span>&nbsp;<span class="op" id="3862522">!=</span>&nbsp;<span class="ident" id="3862525">nil</span>&nbsp;<span class="op" id="3862529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862536">return</span>&nbsp;<span class="ident" id="3862543">false</span><span class="op" id="3862548">,</span>&nbsp;<span class="ident" id="3862550">err</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862571">return</span>&nbsp;<span class="ident" id="3862578">false</span><span class="op" id="3862583">,</span>&nbsp;<span class="ident" id="3862585">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862590">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862593">return</span>&nbsp;<span class="builtinfunc" id="3862600">len</span><span class="op" id="3862603">(</span><span class="ident" id="3862604">name</span><span class="op" id="3862608">)</span>&nbsp;<span class="op" id="3862610">==</span>&nbsp;<span class="num" id="3862613">0</span><span class="op" id="3862614">,</span>&nbsp;<span class="ident" id="3862616">nil</span><br>
<span class="lineno"></span><span class="op" id="3862620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3862623">//&nbsp;scanChunk&nbsp;gets&nbsp;the&nbsp;next&nbsp;segment&nbsp;of&nbsp;pattern,&nbsp;which&nbsp;is&nbsp;a&nbsp;non-star&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="3862697">//&nbsp;possibly&nbsp;preceded&nbsp;by&nbsp;a&nbsp;star.</span><br>
<span class="lineno">85</span><span class="keyword" id="3862729">func</span>&nbsp;<span class="ident" id="3862734">scanChunk</span><span class="op" id="3862743">(</span><span class="ident" id="3862744">pattern</span>&nbsp;<span class="builtintype" id="3862752">string</span><span class="op" id="3862758">)</span>&nbsp;<span class="op" id="3862760">(</span><span class="ident" id="3862761">star</span>&nbsp;<span class="builtintype" id="3862766">bool</span><span class="op" id="3862770">,</span>&nbsp;<span class="ident" id="3862772">chunk</span><span class="op" id="3862777">,</span>&nbsp;<span class="ident" id="3862779">rest</span>&nbsp;<span class="builtintype" id="3862784">string</span><span class="op" id="3862790">)</span>&nbsp;<span class="op" id="3862792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862795">for</span>&nbsp;<span class="builtinfunc" id="3862799">len</span><span class="op" id="3862802">(</span><span class="ident" id="3862803">pattern</span><span class="op" id="3862810">)</span>&nbsp;<span class="op" id="3862812">&gt;</span>&nbsp;<span class="num" id="3862814">0</span>&nbsp;<span class="op" id="3862816">&amp;&amp;</span>&nbsp;<span class="ident" id="3862819">pattern</span><span class="op" id="3862826">[</span><span class="num" id="3862827">0</span><span class="op" id="3862828">]</span>&nbsp;<span class="op" id="3862830">==</span>&nbsp;<span class="string" id="3862833">&#39;*&#39;</span>&nbsp;<span class="op" id="3862837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3862841">pattern</span>&nbsp;<span class="op" id="3862849">=</span>&nbsp;<span class="ident" id="3862851">pattern</span><span class="op" id="3862858">[</span><span class="num" id="3862859">1</span><span class="op" id="3862860">:</span><span class="op" id="3862861">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3862865">star</span>&nbsp;<span class="op" id="3862870">=</span>&nbsp;<span class="ident" id="3862872">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3862878">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3862881">inrange</span>&nbsp;<span class="op" id="3862889">:=</span>&nbsp;<span class="ident" id="3862892">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862899">var</span>&nbsp;<span class="ident" id="3862903">i</span>&nbsp;<span class="builtintype" id="3862905">int</span><br>
<span class="lineno"></span><span class="ident" id="3862909">Scan</span><span class="op" id="3862913">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862916">for</span>&nbsp;<span class="ident" id="3862920">i</span>&nbsp;<span class="op" id="3862922">=</span>&nbsp;<span class="num" id="3862924">0</span><span class="op" id="3862925">;</span>&nbsp;<span class="ident" id="3862927">i</span>&nbsp;<span class="op" id="3862929">&lt;</span>&nbsp;<span class="builtinfunc" id="3862931">len</span><span class="op" id="3862934">(</span><span class="ident" id="3862935">pattern</span><span class="op" id="3862942">)</span><span class="op" id="3862943">;</span>&nbsp;<span class="ident" id="3862945">i</span><span class="op" id="3862946">++</span>&nbsp;<span class="op" id="3862949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862953">switch</span>&nbsp;<span class="ident" id="3862960">pattern</span><span class="op" id="3862967">[</span><span class="ident" id="3862968">i</span><span class="op" id="3862969">]</span>&nbsp;<span class="op" id="3862971">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3862975">case</span>&nbsp;<span class="string" id="3862980">&#39;\\&#39;</span><span class="op" id="3862984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3862989">//&nbsp;error&nbsp;check&nbsp;handled&nbsp;in&nbsp;matchChunk:&nbsp;bad&nbsp;pattern.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863043">if</span>&nbsp;<span class="ident" id="3863046">i</span><span class="op" id="3863047">+</span><span class="num" id="3863048">1</span>&nbsp;<span class="op" id="3863050">&lt;</span>&nbsp;<span class="builtinfunc" id="3863052">len</span><span class="op" id="3863055">(</span><span class="ident" id="3863056">pattern</span><span class="op" id="3863063">)</span>&nbsp;<span class="op" id="3863065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863071">i</span><span class="op" id="3863072">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863078">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863082">case</span>&nbsp;<span class="string" id="3863087">&#39;[&#39;</span><span class="op" id="3863090">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863095">inrange</span>&nbsp;<span class="op" id="3863103">=</span>&nbsp;<span class="ident" id="3863105">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863112">case</span>&nbsp;<span class="string" id="3863117">&#39;]&#39;</span><span class="op" id="3863120">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863125">inrange</span>&nbsp;<span class="op" id="3863133">=</span>&nbsp;<span class="ident" id="3863135">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863143">case</span>&nbsp;<span class="string" id="3863148">&#39;*&#39;</span><span class="op" id="3863151">:</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863156">if</span>&nbsp;<span class="op" id="3863159">!</span><span class="ident" id="3863160">inrange</span>&nbsp;<span class="op" id="3863168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863174">break</span>&nbsp;<span class="ident" id="3863180">Scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863195">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863198">return</span>&nbsp;<span class="ident" id="3863205">star</span><span class="op" id="3863209">,</span>&nbsp;<span class="ident" id="3863211">pattern</span><span class="op" id="3863218">[</span><span class="num" id="3863219">0</span><span class="op" id="3863220">:</span><span class="ident" id="3863221">i</span><span class="op" id="3863222">]</span><span class="op" id="3863223">,</span>&nbsp;<span class="ident" id="3863225">pattern</span><span class="op" id="3863232">[</span><span class="ident" id="3863233">i</span><span class="op" id="3863234">:</span><span class="op" id="3863235">]</span><br>
<span class="lineno"></span><span class="op" id="3863237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3863240">//&nbsp;matchChunk&nbsp;checks&nbsp;whether&nbsp;chunk&nbsp;matches&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="3863303">//&nbsp;If&nbsp;so,&nbsp;it&nbsp;returns&nbsp;the&nbsp;remainder&nbsp;of&nbsp;s&nbsp;(after&nbsp;the&nbsp;match).</span><br>
<span class="lineno">115</span><span class="comment" id="3863362">//&nbsp;Chunk&nbsp;is&nbsp;all&nbsp;single-character&nbsp;operators:&nbsp;literals,&nbsp;char&nbsp;classes,&nbsp;and&nbsp;?.</span><br>
<span class="lineno"></span><span class="keyword" id="3863437">func</span>&nbsp;<span class="ident" id="3863442">matchChunk</span><span class="op" id="3863452">(</span><span class="ident" id="3863453">chunk</span><span class="op" id="3863458">,</span>&nbsp;<span class="ident" id="3863460">s</span>&nbsp;<span class="builtintype" id="3863462">string</span><span class="op" id="3863468">)</span>&nbsp;<span class="op" id="3863470">(</span><span class="ident" id="3863471">rest</span>&nbsp;<span class="builtintype" id="3863476">string</span><span class="op" id="3863482">,</span>&nbsp;<span class="ident" id="3863484">ok</span>&nbsp;<span class="builtintype" id="3863487">bool</span><span class="op" id="3863491">,</span>&nbsp;<span class="ident" id="3863493">err</span>&nbsp;<span class="builtintype" id="3863497">error</span><span class="op" id="3863502">)</span>&nbsp;<span class="op" id="3863504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863507">for</span>&nbsp;<span class="builtinfunc" id="3863511">len</span><span class="op" id="3863514">(</span><span class="ident" id="3863515">chunk</span><span class="op" id="3863520">)</span>&nbsp;<span class="op" id="3863522">&gt;</span>&nbsp;<span class="num" id="3863524">0</span>&nbsp;<span class="op" id="3863526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863530">if</span>&nbsp;<span class="builtinfunc" id="3863533">len</span><span class="op" id="3863536">(</span><span class="ident" id="3863537">s</span><span class="op" id="3863538">)</span>&nbsp;<span class="op" id="3863540">==</span>&nbsp;<span class="num" id="3863543">0</span>&nbsp;<span class="op" id="3863545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863550">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863563">switch</span>&nbsp;<span class="ident" id="3863570">chunk</span><span class="op" id="3863575">[</span><span class="num" id="3863576">0</span><span class="op" id="3863577">]</span>&nbsp;<span class="op" id="3863579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863583">case</span>&nbsp;<span class="string" id="3863588">&#39;[&#39;</span><span class="op" id="3863591">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863596">//&nbsp;character&nbsp;class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863618">r</span><span class="op" id="3863619">,</span>&nbsp;<span class="ident" id="3863621">n</span>&nbsp;<span class="op" id="3863623">:=</span>&nbsp;<span class="ident" id="3863626">utf8</span><span class="op" id="3863630">.</span><span class="ident" id="3863631">DecodeRuneInString</span><span class="op" id="3863649">(</span><span class="ident" id="3863650">s</span><span class="op" id="3863651">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863656">s</span>&nbsp;<span class="op" id="3863658">=</span>&nbsp;<span class="ident" id="3863660">s</span><span class="op" id="3863661">[</span><span class="ident" id="3863662">n</span><span class="op" id="3863663">:</span><span class="op" id="3863664">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863669">chunk</span>&nbsp;<span class="op" id="3863675">=</span>&nbsp;<span class="ident" id="3863677">chunk</span><span class="op" id="3863682">[</span><span class="num" id="3863683">1</span><span class="op" id="3863684">:</span><span class="op" id="3863685">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863690">//&nbsp;possibly&nbsp;negated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863713">notNegated</span>&nbsp;<span class="op" id="3863724">:=</span>&nbsp;<span class="ident" id="3863727">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863735">if</span>&nbsp;<span class="builtinfunc" id="3863738">len</span><span class="op" id="3863741">(</span><span class="ident" id="3863742">chunk</span><span class="op" id="3863747">)</span>&nbsp;<span class="op" id="3863749">&gt;</span>&nbsp;<span class="num" id="3863751">0</span>&nbsp;<span class="op" id="3863753">&amp;&amp;</span>&nbsp;<span class="ident" id="3863756">chunk</span><span class="op" id="3863761">[</span><span class="num" id="3863762">0</span><span class="op" id="3863763">]</span>&nbsp;<span class="op" id="3863765">==</span>&nbsp;<span class="string" id="3863768">&#39;^&#39;</span>&nbsp;<span class="op" id="3863772">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863778">notNegated</span>&nbsp;<span class="op" id="3863789">=</span>&nbsp;<span class="ident" id="3863791">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863801">chunk</span>&nbsp;<span class="op" id="3863807">=</span>&nbsp;<span class="ident" id="3863809">chunk</span><span class="op" id="3863814">[</span><span class="num" id="3863815">1</span><span class="op" id="3863816">:</span><span class="op" id="3863817">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3863827">//&nbsp;parse&nbsp;all&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863850">match</span>&nbsp;<span class="op" id="3863856">:=</span>&nbsp;<span class="ident" id="3863859">false</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863868">nrange</span>&nbsp;<span class="op" id="3863875">:=</span>&nbsp;<span class="num" id="3863878">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863883">for</span>&nbsp;<span class="op" id="3863887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863893">if</span>&nbsp;<span class="builtinfunc" id="3863896">len</span><span class="op" id="3863899">(</span><span class="ident" id="3863900">chunk</span><span class="op" id="3863905">)</span>&nbsp;<span class="op" id="3863907">&gt;</span>&nbsp;<span class="num" id="3863909">0</span>&nbsp;<span class="op" id="3863911">&amp;&amp;</span>&nbsp;<span class="ident" id="3863914">chunk</span><span class="op" id="3863919">[</span><span class="num" id="3863920">0</span><span class="op" id="3863921">]</span>&nbsp;<span class="op" id="3863923">==</span>&nbsp;<span class="string" id="3863926">&#39;]&#39;</span>&nbsp;<span class="op" id="3863930">&amp;&amp;</span>&nbsp;<span class="ident" id="3863933">nrange</span>&nbsp;<span class="op" id="3863940">&gt;</span>&nbsp;<span class="num" id="3863942">0</span>&nbsp;<span class="op" id="3863944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3863951">chunk</span>&nbsp;<span class="op" id="3863957">=</span>&nbsp;<span class="ident" id="3863959">chunk</span><span class="op" id="3863964">[</span><span class="num" id="3863965">1</span><span class="op" id="3863966">:</span><span class="op" id="3863967">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863974">break</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3863984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3863990">var</span>&nbsp;<span class="ident" id="3863994">lo</span><span class="op" id="3863996">,</span>&nbsp;<span class="ident" id="3863998">hi</span>&nbsp;<span class="builtintype" id="3864001">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864010">if</span>&nbsp;<span class="ident" id="3864013">lo</span><span class="op" id="3864015">,</span>&nbsp;<span class="ident" id="3864017">chunk</span><span class="op" id="3864022">,</span>&nbsp;<span class="ident" id="3864024">err</span>&nbsp;<span class="op" id="3864028">=</span>&nbsp;<span class="ident" id="3864030">getEsc</span><span class="op" id="3864036">(</span><span class="ident" id="3864037">chunk</span><span class="op" id="3864042">)</span><span class="op" id="3864043">;</span>&nbsp;<span class="ident" id="3864045">err</span>&nbsp;<span class="op" id="3864049">!=</span>&nbsp;<span class="ident" id="3864052">nil</span>&nbsp;<span class="op" id="3864056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864063">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864074">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864080">hi</span>&nbsp;<span class="op" id="3864083">=</span>&nbsp;<span class="ident" id="3864085">lo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864092">if</span>&nbsp;<span class="ident" id="3864095">chunk</span><span class="op" id="3864100">[</span><span class="num" id="3864101">0</span><span class="op" id="3864102">]</span>&nbsp;<span class="op" id="3864104">==</span>&nbsp;<span class="string" id="3864107">&#39;-&#39;</span>&nbsp;<span class="op" id="3864111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864118">if</span>&nbsp;<span class="ident" id="3864121">hi</span><span class="op" id="3864123">,</span>&nbsp;<span class="ident" id="3864125">chunk</span><span class="op" id="3864130">,</span>&nbsp;<span class="ident" id="3864132">err</span>&nbsp;<span class="op" id="3864136">=</span>&nbsp;<span class="ident" id="3864138">getEsc</span><span class="op" id="3864144">(</span><span class="ident" id="3864145">chunk</span><span class="op" id="3864150">[</span><span class="num" id="3864151">1</span><span class="op" id="3864152">:</span><span class="op" id="3864153">]</span><span class="op" id="3864154">)</span><span class="op" id="3864155">;</span>&nbsp;<span class="ident" id="3864157">err</span>&nbsp;<span class="op" id="3864161">!=</span>&nbsp;<span class="ident" id="3864164">nil</span>&nbsp;<span class="op" id="3864168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864176">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864188">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864200">if</span>&nbsp;<span class="ident" id="3864203">lo</span>&nbsp;<span class="op" id="3864206">&lt;=</span>&nbsp;<span class="ident" id="3864209">r</span>&nbsp;<span class="op" id="3864211">&amp;&amp;</span>&nbsp;<span class="ident" id="3864214">r</span>&nbsp;<span class="op" id="3864216">&lt;=</span>&nbsp;<span class="ident" id="3864219">hi</span>&nbsp;<span class="op" id="3864222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864229">match</span>&nbsp;<span class="op" id="3864235">=</span>&nbsp;<span class="ident" id="3864237">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864252">nrange</span><span class="op" id="3864258">++</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864269">if</span>&nbsp;<span class="ident" id="3864272">match</span>&nbsp;<span class="op" id="3864278">!=</span>&nbsp;<span class="ident" id="3864281">notNegated</span>&nbsp;<span class="op" id="3864292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864298">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864313">case</span>&nbsp;<span class="string" id="3864318">&#39;?&#39;</span><span class="op" id="3864321">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864326">if</span>&nbsp;<span class="ident" id="3864329">s</span><span class="op" id="3864330">[</span><span class="num" id="3864331">0</span><span class="op" id="3864332">]</span>&nbsp;<span class="op" id="3864334">==</span>&nbsp;<span class="string" id="3864337">&#39;/&#39;</span>&nbsp;<span class="op" id="3864341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864347">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864362">_</span><span class="op" id="3864363">,</span>&nbsp;<span class="ident" id="3864365">n</span>&nbsp;<span class="op" id="3864367">:=</span>&nbsp;<span class="ident" id="3864370">utf8</span><span class="op" id="3864374">.</span><span class="ident" id="3864375">DecodeRuneInString</span><span class="op" id="3864393">(</span><span class="ident" id="3864394">s</span><span class="op" id="3864395">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864400">s</span>&nbsp;<span class="op" id="3864402">=</span>&nbsp;<span class="ident" id="3864404">s</span><span class="op" id="3864405">[</span><span class="ident" id="3864406">n</span><span class="op" id="3864407">:</span><span class="op" id="3864408">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864413">chunk</span>&nbsp;<span class="op" id="3864419">=</span>&nbsp;<span class="ident" id="3864421">chunk</span><span class="op" id="3864426">[</span><span class="num" id="3864427">1</span><span class="op" id="3864428">:</span><span class="op" id="3864429">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864434">case</span>&nbsp;<span class="string" id="3864439">&#39;\\&#39;</span><span class="op" id="3864443">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864448">chunk</span>&nbsp;<span class="op" id="3864454">=</span>&nbsp;<span class="ident" id="3864456">chunk</span><span class="op" id="3864461">[</span><span class="num" id="3864462">1</span><span class="op" id="3864463">:</span><span class="op" id="3864464">]</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864469">if</span>&nbsp;<span class="builtinfunc" id="3864472">len</span><span class="op" id="3864475">(</span><span class="ident" id="3864476">chunk</span><span class="op" id="3864481">)</span>&nbsp;<span class="op" id="3864483">==</span>&nbsp;<span class="num" id="3864486">0</span>&nbsp;<span class="op" id="3864488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864494">err</span>&nbsp;<span class="op" id="3864498">=</span>&nbsp;<span class="ident" id="3864500">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864518">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864533">fallthrough</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864548">default</span><span class="op" id="3864555">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864560">if</span>&nbsp;<span class="ident" id="3864563">chunk</span><span class="op" id="3864568">[</span><span class="num" id="3864569">0</span><span class="op" id="3864570">]</span>&nbsp;<span class="op" id="3864572">!=</span>&nbsp;<span class="ident" id="3864575">s</span><span class="op" id="3864576">[</span><span class="num" id="3864577">0</span><span class="op" id="3864578">]</span>&nbsp;<span class="op" id="3864580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864586">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864596">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864601">s</span>&nbsp;<span class="op" id="3864603">=</span>&nbsp;<span class="ident" id="3864605">s</span><span class="op" id="3864606">[</span><span class="num" id="3864607">1</span><span class="op" id="3864608">:</span><span class="op" id="3864609">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864614">chunk</span>&nbsp;<span class="op" id="3864620">=</span>&nbsp;<span class="ident" id="3864622">chunk</span><span class="op" id="3864627">[</span><span class="num" id="3864628">1</span><span class="op" id="3864629">:</span><span class="op" id="3864630">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864640">return</span>&nbsp;<span class="ident" id="3864647">s</span><span class="op" id="3864648">,</span>&nbsp;<span class="ident" id="3864650">true</span><span class="op" id="3864654">,</span>&nbsp;<span class="ident" id="3864656">nil</span><br>
<span class="lineno">185</span><span class="op" id="3864660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3864663">//&nbsp;getEsc&nbsp;gets&nbsp;a&nbsp;possibly-escaped&nbsp;character&nbsp;from&nbsp;chunk,&nbsp;for&nbsp;a&nbsp;character&nbsp;class.</span><br>
<span class="lineno"></span><span class="keyword" id="3864742">func</span>&nbsp;<span class="ident" id="3864747">getEsc</span><span class="op" id="3864753">(</span><span class="ident" id="3864754">chunk</span>&nbsp;<span class="builtintype" id="3864760">string</span><span class="op" id="3864766">)</span>&nbsp;<span class="op" id="3864768">(</span><span class="ident" id="3864769">r</span>&nbsp;<span class="builtintype" id="3864771">rune</span><span class="op" id="3864775">,</span>&nbsp;<span class="ident" id="3864777">nchunk</span>&nbsp;<span class="builtintype" id="3864784">string</span><span class="op" id="3864790">,</span>&nbsp;<span class="ident" id="3864792">err</span>&nbsp;<span class="builtintype" id="3864796">error</span><span class="op" id="3864801">)</span>&nbsp;<span class="op" id="3864803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864806">if</span>&nbsp;<span class="builtinfunc" id="3864809">len</span><span class="op" id="3864812">(</span><span class="ident" id="3864813">chunk</span><span class="op" id="3864818">)</span>&nbsp;<span class="op" id="3864820">==</span>&nbsp;<span class="num" id="3864823">0</span>&nbsp;<span class="op" id="3864825">||</span>&nbsp;<span class="ident" id="3864828">chunk</span><span class="op" id="3864833">[</span><span class="num" id="3864834">0</span><span class="op" id="3864835">]</span>&nbsp;<span class="op" id="3864837">==</span>&nbsp;<span class="string" id="3864840">&#39;-&#39;</span>&nbsp;<span class="op" id="3864844">||</span>&nbsp;<span class="ident" id="3864847">chunk</span><span class="op" id="3864852">[</span><span class="num" id="3864853">0</span><span class="op" id="3864854">]</span>&nbsp;<span class="op" id="3864856">==</span>&nbsp;<span class="string" id="3864859">&#39;]&#39;</span>&nbsp;<span class="op" id="3864863">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864867">err</span>&nbsp;<span class="op" id="3864871">=</span>&nbsp;<span class="ident" id="3864873">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864889">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3864897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864900">if</span>&nbsp;<span class="ident" id="3864903">chunk</span><span class="op" id="3864908">[</span><span class="num" id="3864909">0</span><span class="op" id="3864910">]</span>&nbsp;<span class="op" id="3864912">==</span>&nbsp;<span class="string" id="3864915">&#39;\\&#39;</span>&nbsp;<span class="op" id="3864920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864924">chunk</span>&nbsp;<span class="op" id="3864930">=</span>&nbsp;<span class="ident" id="3864932">chunk</span><span class="op" id="3864937">[</span><span class="num" id="3864938">1</span><span class="op" id="3864939">:</span><span class="op" id="3864940">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864944">if</span>&nbsp;<span class="builtinfunc" id="3864947">len</span><span class="op" id="3864950">(</span><span class="ident" id="3864951">chunk</span><span class="op" id="3864956">)</span>&nbsp;<span class="op" id="3864958">==</span>&nbsp;<span class="num" id="3864961">0</span>&nbsp;<span class="op" id="3864963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3864968">err</span>&nbsp;<span class="op" id="3864972">=</span>&nbsp;<span class="ident" id="3864974">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3864991">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865003">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865006">r</span><span class="op" id="3865007">,</span>&nbsp;<span class="ident" id="3865009">n</span>&nbsp;<span class="op" id="3865011">:=</span>&nbsp;<span class="ident" id="3865014">utf8</span><span class="op" id="3865018">.</span><span class="ident" id="3865019">DecodeRuneInString</span><span class="op" id="3865037">(</span><span class="ident" id="3865038">chunk</span><span class="op" id="3865043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865046">if</span>&nbsp;<span class="ident" id="3865049">r</span>&nbsp;<span class="op" id="3865051">==</span>&nbsp;<span class="ident" id="3865054">utf8</span><span class="op" id="3865058">.</span><span class="ident" id="3865059">RuneError</span>&nbsp;<span class="op" id="3865069">&amp;&amp;</span>&nbsp;<span class="ident" id="3865072">n</span>&nbsp;<span class="op" id="3865074">==</span>&nbsp;<span class="num" id="3865077">1</span>&nbsp;<span class="op" id="3865079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865083">err</span>&nbsp;<span class="op" id="3865087">=</span>&nbsp;<span class="ident" id="3865089">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865107">nchunk</span>&nbsp;<span class="op" id="3865114">=</span>&nbsp;<span class="ident" id="3865116">chunk</span><span class="op" id="3865121">[</span><span class="ident" id="3865122">n</span><span class="op" id="3865123">:</span><span class="op" id="3865124">]</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865127">if</span>&nbsp;<span class="builtinfunc" id="3865130">len</span><span class="op" id="3865133">(</span><span class="ident" id="3865134">nchunk</span><span class="op" id="3865140">)</span>&nbsp;<span class="op" id="3865142">==</span>&nbsp;<span class="num" id="3865145">0</span>&nbsp;<span class="op" id="3865147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3865151">err</span>&nbsp;<span class="op" id="3865155">=</span>&nbsp;<span class="ident" id="3865157">ErrBadPattern</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3865172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3865175">return</span><br>
<span class="lineno"></span><span class="op" id="3865182">}</span>
</div>
</body>
</html>
