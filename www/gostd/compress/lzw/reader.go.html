<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/lzw</h2>
<ul>
<li><a href="/gostd/compress/lzw/reader.go.html" class="current">reader.go</a></li>
<li><a href="/gostd/compress/lzw/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/lzw/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/lzw/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5733345">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5733400">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5733454">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5733505">//&nbsp;Package&nbsp;lzw&nbsp;implements&nbsp;the&nbsp;Lempel-Ziv-Welch&nbsp;compressed&nbsp;data&nbsp;format,</span><br>
<span class="lineno"></span><span class="comment" id="5733576">//&nbsp;described&nbsp;in&nbsp;T.&nbsp;A.&nbsp;Welch,&nbsp;``A&nbsp;Technique&nbsp;for&nbsp;High-Performance&nbsp;Data</span><br>
<span class="lineno"></span><span class="comment" id="5733645">//&nbsp;Compression&#39;&#39;,&nbsp;Computer,&nbsp;17(6)&nbsp;(June&nbsp;1984),&nbsp;pp&nbsp;8-19.</span><br>
<span class="lineno"></span><span class="comment" id="5733701">//</span><br>
<span class="lineno"></span><span class="comment" id="5733704">//&nbsp;In&nbsp;particular,&nbsp;it&nbsp;implements&nbsp;LZW&nbsp;as&nbsp;used&nbsp;by&nbsp;the&nbsp;GIF&nbsp;and&nbsp;PDF&nbsp;file</span><br>
<span class="lineno">10</span><span class="comment" id="5733772">//&nbsp;formats,&nbsp;which&nbsp;means&nbsp;variable-width&nbsp;codes&nbsp;up&nbsp;to&nbsp;12&nbsp;bits&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="5733845">//&nbsp;two&nbsp;non-literal&nbsp;codes&nbsp;are&nbsp;a&nbsp;clear&nbsp;code&nbsp;and&nbsp;an&nbsp;EOF&nbsp;code.</span><br>
<span class="lineno"></span><span class="comment" id="5733904">//</span><br>
<span class="lineno"></span><span class="comment" id="5733907">//&nbsp;The&nbsp;TIFF&nbsp;file&nbsp;format&nbsp;uses&nbsp;a&nbsp;similar&nbsp;but&nbsp;incompatible&nbsp;version&nbsp;of&nbsp;the&nbsp;LZW</span><br>
<span class="lineno"></span><span class="comment" id="5733982">//&nbsp;algorithm.&nbsp;See&nbsp;the&nbsp;golang.org/x/image/tiff/lzw&nbsp;package&nbsp;for&nbsp;an</span><br>
<span class="lineno">15</span><span class="comment" id="5734047">//&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="keyword" id="5734066">package</span>&nbsp;<span class="ident" id="5734074">lzw</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5734079">//&nbsp;TODO(nigeltao):&nbsp;check&nbsp;that&nbsp;PDF&nbsp;uses&nbsp;LZW&nbsp;in&nbsp;the&nbsp;same&nbsp;way&nbsp;as&nbsp;GIF,</span><br>
<span class="lineno"></span><span class="comment" id="5734146">//&nbsp;modulo&nbsp;LSB/MSB&nbsp;packing&nbsp;order.</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5734180">import</span>&nbsp;<span class="op" id="5734187">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5734190">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5734199">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5734209">&#34;fmt&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5734216">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5734221">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5734224">//&nbsp;Order&nbsp;specifies&nbsp;the&nbsp;bit&nbsp;ordering&nbsp;in&nbsp;an&nbsp;LZW&nbsp;data&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="5734283">type</span>&nbsp;<span class="ident" id="5734288">Order</span>&nbsp;<span class="builtintype" id="5734294">int</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="5734299">const</span>&nbsp;<span class="op" id="5734305">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734308">//&nbsp;LSB&nbsp;means&nbsp;Least&nbsp;Significant&nbsp;Bits&nbsp;first,&nbsp;as&nbsp;used&nbsp;in&nbsp;the&nbsp;GIF&nbsp;file&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734384">LSB</span>&nbsp;<span class="ident" id="5734388"><a href="/gostd/compress/lzw/reader.go.html#5734288">Order</a></span>&nbsp;<span class="op" id="5734394">=</span>&nbsp;<span class="ident" id="5734396">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734402">//&nbsp;MSB&nbsp;means&nbsp;Most&nbsp;Significant&nbsp;Bits&nbsp;first,&nbsp;as&nbsp;used&nbsp;in&nbsp;the&nbsp;TIFF&nbsp;and&nbsp;PDF</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734473">//&nbsp;file&nbsp;formats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734491">MSB</span><br>
<span class="lineno"></span><span class="op" id="5734495">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5734498">const</span>&nbsp;<span class="op" id="5734504">(</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734507">maxWidth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5734526">=</span>&nbsp;<span class="num" id="5734528">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734532">decoderInvalidCode</span>&nbsp;<span class="op" id="5734551">=</span>&nbsp;<span class="num" id="5734553">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734561">flushBuffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5734580">=</span>&nbsp;<span class="num" id="5734582">1</span>&nbsp;<span class="op" id="5734584">&lt;&lt;</span>&nbsp;<span class="ident" id="5734587"><a href="/gostd/compress/lzw/reader.go.html#5734507">maxWidth</a></span><br>
<span class="lineno"></span><span class="op" id="5734596">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5734599">//&nbsp;decoder&nbsp;is&nbsp;the&nbsp;state&nbsp;from&nbsp;which&nbsp;the&nbsp;readXxx&nbsp;method&nbsp;converts&nbsp;a&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="5734669">//&nbsp;stream&nbsp;into&nbsp;a&nbsp;code&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="5734699">type</span>&nbsp;<span class="ident" id="5734704">decoder</span>&nbsp;<span class="keyword" id="5734712">struct</span>&nbsp;<span class="op" id="5734719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734722">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734731"><a href="/gostd/compress/lzw/reader.go.html#5734216">io</a></span><span class="op" id="5734733">.</span><span class="ident" id="5734734"><a href="/gostd/io/io.go.html#1426965">ByteReader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734746">bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5734755">uint32</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734763">nBits</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5734772">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734778">width</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5734787">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734793">read</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734802">func</span><span class="op" id="5734806">(</span><span class="op" id="5734807">*</span><span class="ident" id="5734808"><a href="/gostd/compress/lzw/reader.go.html#5734704">decoder</a></span><span class="op" id="5734815">)</span>&nbsp;<span class="op" id="5734817">(</span><span class="builtintype" id="5734818">uint16</span><span class="op" id="5734824">,</span>&nbsp;<span class="builtintype" id="5734826">error</span><span class="op" id="5734831">)</span>&nbsp;<span class="comment" id="5734833">//&nbsp;readLSB&nbsp;or&nbsp;readMSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734856">litWidth</span>&nbsp;<span class="builtintype" id="5734865">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734896">//&nbsp;width&nbsp;in&nbsp;bits&nbsp;of&nbsp;literal&nbsp;codes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734931">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5734940">error</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734948">//&nbsp;The&nbsp;first&nbsp;1&lt;&lt;litWidth&nbsp;codes&nbsp;are&nbsp;literal&nbsp;codes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734999">//&nbsp;The&nbsp;next&nbsp;two&nbsp;codes&nbsp;mean&nbsp;clear&nbsp;and&nbsp;EOF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735042">//&nbsp;Other&nbsp;valid&nbsp;codes&nbsp;are&nbsp;in&nbsp;the&nbsp;range&nbsp;[lo,&nbsp;hi]&nbsp;where&nbsp;lo&nbsp;:=&nbsp;clear&nbsp;+&nbsp;2,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735113">//&nbsp;with&nbsp;the&nbsp;upper&nbsp;bound&nbsp;incrementing&nbsp;on&nbsp;each&nbsp;code&nbsp;seen.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735170">//&nbsp;overflow&nbsp;is&nbsp;the&nbsp;code&nbsp;at&nbsp;which&nbsp;hi&nbsp;overflows&nbsp;the&nbsp;code&nbsp;width.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735233">//&nbsp;last&nbsp;is&nbsp;the&nbsp;most&nbsp;recently&nbsp;seen&nbsp;code,&nbsp;or&nbsp;decoderInvalidCode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735297">clear</span><span class="op" id="5735302">,</span>&nbsp;<span class="ident" id="5735304">eof</span><span class="op" id="5735307">,</span>&nbsp;<span class="ident" id="5735309">hi</span><span class="op" id="5735311">,</span>&nbsp;<span class="ident" id="5735313">overflow</span><span class="op" id="5735321">,</span>&nbsp;<span class="ident" id="5735323">last</span>&nbsp;<span class="builtintype" id="5735328">uint16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735337">//&nbsp;Each&nbsp;code&nbsp;c&nbsp;in&nbsp;[lo,&nbsp;hi]&nbsp;expands&nbsp;to&nbsp;two&nbsp;or&nbsp;more&nbsp;bytes.&nbsp;For&nbsp;c&nbsp;!=&nbsp;hi:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735408">//&nbsp;&nbsp;&nbsp;suffix[c]&nbsp;is&nbsp;the&nbsp;last&nbsp;of&nbsp;these&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735452">//&nbsp;&nbsp;&nbsp;prefix[c]&nbsp;is&nbsp;the&nbsp;code&nbsp;for&nbsp;all&nbsp;but&nbsp;the&nbsp;last&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735507">//&nbsp;&nbsp;&nbsp;This&nbsp;code&nbsp;can&nbsp;either&nbsp;be&nbsp;a&nbsp;literal&nbsp;code&nbsp;or&nbsp;another&nbsp;code&nbsp;in&nbsp;[lo,&nbsp;c).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735580">//&nbsp;The&nbsp;c&nbsp;==&nbsp;hi&nbsp;case&nbsp;is&nbsp;a&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735620">suffix</span>&nbsp;<span class="op" id="5735627">[</span><span class="num" id="5735628">1</span>&nbsp;<span class="op" id="5735630">&lt;&lt;</span>&nbsp;<span class="ident" id="5735633"><a href="/gostd/compress/lzw/reader.go.html#5734507">maxWidth</a></span><span class="op" id="5735641">]</span><span class="builtintype" id="5735642">uint8</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735649">prefix</span>&nbsp;<span class="op" id="5735656">[</span><span class="num" id="5735657">1</span>&nbsp;<span class="op" id="5735659">&lt;&lt;</span>&nbsp;<span class="ident" id="5735662"><a href="/gostd/compress/lzw/reader.go.html#5734507">maxWidth</a></span><span class="op" id="5735670">]</span><span class="builtintype" id="5735671">uint16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735680">//&nbsp;output&nbsp;is&nbsp;the&nbsp;temporary&nbsp;output&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735723">//&nbsp;Literal&nbsp;codes&nbsp;are&nbsp;accumulated&nbsp;from&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735787">//&nbsp;Non-literal&nbsp;codes&nbsp;decode&nbsp;to&nbsp;a&nbsp;sequence&nbsp;of&nbsp;suffixes&nbsp;that&nbsp;are&nbsp;first</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735857">//&nbsp;written&nbsp;right-to-left&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;buffer&nbsp;before&nbsp;being&nbsp;copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735930">//&nbsp;to&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735962">//&nbsp;It&nbsp;is&nbsp;flushed&nbsp;when&nbsp;it&nbsp;contains&nbsp;&gt;=&nbsp;1&lt;&lt;maxWidth&nbsp;bytes,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5736019">//&nbsp;so&nbsp;that&nbsp;there&nbsp;is&nbsp;always&nbsp;room&nbsp;to&nbsp;decode&nbsp;an&nbsp;entire&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736078">output</span>&nbsp;<span class="op" id="5736085">[</span><span class="num" id="5736086">2</span>&nbsp;<span class="op" id="5736088">*</span>&nbsp;<span class="num" id="5736090">1</span>&nbsp;<span class="op" id="5736092">&lt;&lt;</span>&nbsp;<span class="ident" id="5736095"><a href="/gostd/compress/lzw/reader.go.html#5734507">maxWidth</a></span><span class="op" id="5736103">]</span><span class="builtintype" id="5736104">byte</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736110">o</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5736117">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5736124">//&nbsp;write&nbsp;index&nbsp;into&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736152">toRead</span>&nbsp;<span class="op" id="5736159">[</span><span class="op" id="5736160">]</span><span class="builtintype" id="5736161">byte</span>&nbsp;<span class="comment" id="5736166">//&nbsp;bytes&nbsp;to&nbsp;return&nbsp;from&nbsp;Read</span><br>
<span class="lineno"></span><span class="op" id="5736195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5736198">//&nbsp;readLSB&nbsp;returns&nbsp;the&nbsp;next&nbsp;code&nbsp;for&nbsp;&#34;Least&nbsp;Significant&nbsp;Bits&nbsp;first&#34;&nbsp;data.</span><br>
<span class="lineno">85</span><span class="keyword" id="5736272">func</span>&nbsp;<span class="op" id="5736277">(</span><span class="ident" id="5736278">d</span>&nbsp;<span class="op" id="5736280">*</span><span class="ident" id="5736281"><a href="/gostd/compress/lzw/reader.go.html#5734704">decoder</a></span><span class="op" id="5736288">)</span>&nbsp;<span class="ident" id="5736290">readLSB</span><span class="op" id="5736297">(</span><span class="op" id="5736298">)</span>&nbsp;<span class="op" id="5736300">(</span><span class="builtintype" id="5736301">uint16</span><span class="op" id="5736307">,</span>&nbsp;<span class="builtintype" id="5736309">error</span><span class="op" id="5736314">)</span>&nbsp;<span class="op" id="5736316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736319">for</span>&nbsp;<span class="ident" id="5736323"><a href="/gostd/compress/lzw/reader.go.html#5736278">d</a></span><span class="op" id="5736324">.</span><span class="ident" id="5736325"><a href="/gostd/compress/lzw/reader.go.html#5734763">nBits</a></span>&nbsp;<span class="op" id="5736331">&lt;</span>&nbsp;<span class="ident" id="5736333"><a href="/gostd/compress/lzw/reader.go.html#5736278">d</a></span><span class="op" id="5736334">.</span><span class="ident" id="5736335"><a href="/gostd/compress/lzw/reader.go.html#5734778">width</a></span>&nbsp;<span class="op" id="5736341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736345">x</span><span class="op" id="5736346">,</span>&nbsp;<span class="ident" id="5736348">err</span>&nbsp;<span class="op" id="5736352">:=</span>&nbsp;<span class="ident" id="5736355"><a href="/gostd/compress/lzw/reader.go.html#5736278">d</a></span><span class="op" id="5736356">.</span><span class="ident" id="5736357"><a href="/gostd/compress/lzw/reader.go.html#5734722">r</a></span><span class="op" id="5736358">.</span><span class="ident" id="5736359"><a href="/gostd/io/io.go.html#1426989">ReadByte</a></span><span class="op" id="5736367">(</span><span class="op" id="5736368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736372">if</span>&nbsp;<span class="ident" id="5736375"><a href="/gostd/compress/lzw/reader.go.html#5736348">err</a></span>&nbsp;<span class="op" id="5736379">!=</span>&nbsp;<span class="builtintype" id="5736382">nil</span>&nbsp;<span class="op" id="5736386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736391">return</span>&nbsp;<span class="num" id="5736398">0</span><span class="op" id="5736399">,</span>&nbsp;<span class="ident" id="5736401"><a href="/gostd/compress/lzw/reader.go.html#5736348">err</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5736407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736411"><a href="/gostd/compress/lzw/reader.go.html#5736278">d</a></span><span class="op" id="5736412">.</span><span class="ident" id="5736413"><a href="/gostd/compress/lzw/reader.go.html#5734746">bits</a></span>&nbsp;<span class="op" id="5736418">|=</span>&nbsp;<span class="builtintype" id="5736421">uint32</span><span class="op" id="5736427">(</span><span class="ident" id="5736428"><a href="/gostd/compress/lzw/reader.go.html#5736345">x</a></span><span class="op" id="5736429">)</span>&nbsp;<span class="op" id="5736431">&lt;&lt;</span>&nbsp;<span class="ident" id="5736434"><a href="/gostd/compress/lzw/reader.go.html#5736278">d</a></span><span class="op" id="5736435">.</span><span class="ident" id="5736436"><a href="/gostd/compress/lzw/reader.go.html#5734763">nBits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736444"><a href="/gostd/compress/lzw/reader.go.html#5736278">d</a></span><span class="op" id="5736445">.</span><span class="ident" id="5736446"><a href="/gostd/compress/lzw/reader.go.html#5734763">nBits</a></span>&nbsp;<span class="op" id="5736452">+=</span>&nbsp;<span class="num" id="5736455">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5736458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736461">code</span>&nbsp;<span class="op" id="5736466">:=</span>&nbsp;<span class="builtintype" id="5736469">uint16</span><span class="op" id="5736475">(</span><span class="ident" id="5736476"><a href="/gostd/compress/lzw/reader.go.html#5736278">d</a></span><span class="op" id="5736477">.</span><span class="ident" id="5736478"><a href="/gostd/compress/lzw/reader.go.html#5734746">bits</a></span>&nbsp;<span class="op" id="5736483">&amp;</span>&nbsp;<span class="op" id="5736485">(</span><span class="num" id="5736486">1</span><span class="op" id="5736487">&lt;&lt;</span><span class="ident" id="5736489"><a href="/gostd/compress/lzw/reader.go.html#5736278">d</a></span><span class="op" id="5736490">.</span><span class="ident" id="5736491"><a href="/gostd/compress/lzw/reader.go.html#5734778">width</a></span>&nbsp;<span class="op" id="5736497">-</span>&nbsp;<span class="num" id="5736499">1</span><span class="op" id="5736500">)</span><span class="op" id="5736501">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736504"><a href="/gostd/compress/lzw/reader.go.html#5736278">d</a></span><span class="op" id="5736505">.</span><span class="ident" id="5736506"><a href="/gostd/compress/lzw/reader.go.html#5734746">bits</a></span>&nbsp;<span class="op" id="5736511">&gt;&gt;=</span>&nbsp;<span class="ident" id="5736515"><a href="/gostd/compress/lzw/reader.go.html#5736278">d</a></span><span class="op" id="5736516">.</span><span class="ident" id="5736517"><a href="/gostd/compress/lzw/reader.go.html#5734778">width</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736524"><a href="/gostd/compress/lzw/reader.go.html#5736278">d</a></span><span class="op" id="5736525">.</span><span class="ident" id="5736526"><a href="/gostd/compress/lzw/reader.go.html#5734763">nBits</a></span>&nbsp;<span class="op" id="5736532">-=</span>&nbsp;<span class="ident" id="5736535"><a href="/gostd/compress/lzw/reader.go.html#5736278">d</a></span><span class="op" id="5736536">.</span><span class="ident" id="5736537"><a href="/gostd/compress/lzw/reader.go.html#5734778">width</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736544">return</span>&nbsp;<span class="ident" id="5736551"><a href="/gostd/compress/lzw/reader.go.html#5736461">code</a></span><span class="op" id="5736555">,</span>&nbsp;<span class="builtintype" id="5736557">nil</span><br>
<span class="lineno"></span><span class="op" id="5736561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="5736564">//&nbsp;readMSB&nbsp;returns&nbsp;the&nbsp;next&nbsp;code&nbsp;for&nbsp;&#34;Most&nbsp;Significant&nbsp;Bits&nbsp;first&#34;&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="5736637">func</span>&nbsp;<span class="op" id="5736642">(</span><span class="ident" id="5736643">d</span>&nbsp;<span class="op" id="5736645">*</span><span class="ident" id="5736646"><a href="/gostd/compress/lzw/reader.go.html#5734704">decoder</a></span><span class="op" id="5736653">)</span>&nbsp;<span class="ident" id="5736655">readMSB</span><span class="op" id="5736662">(</span><span class="op" id="5736663">)</span>&nbsp;<span class="op" id="5736665">(</span><span class="builtintype" id="5736666">uint16</span><span class="op" id="5736672">,</span>&nbsp;<span class="builtintype" id="5736674">error</span><span class="op" id="5736679">)</span>&nbsp;<span class="op" id="5736681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736684">for</span>&nbsp;<span class="ident" id="5736688"><a href="/gostd/compress/lzw/reader.go.html#5736643">d</a></span><span class="op" id="5736689">.</span><span class="ident" id="5736690"><a href="/gostd/compress/lzw/reader.go.html#5734763">nBits</a></span>&nbsp;<span class="op" id="5736696">&lt;</span>&nbsp;<span class="ident" id="5736698"><a href="/gostd/compress/lzw/reader.go.html#5736643">d</a></span><span class="op" id="5736699">.</span><span class="ident" id="5736700"><a href="/gostd/compress/lzw/reader.go.html#5734778">width</a></span>&nbsp;<span class="op" id="5736706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736710">x</span><span class="op" id="5736711">,</span>&nbsp;<span class="ident" id="5736713">err</span>&nbsp;<span class="op" id="5736717">:=</span>&nbsp;<span class="ident" id="5736720"><a href="/gostd/compress/lzw/reader.go.html#5736643">d</a></span><span class="op" id="5736721">.</span><span class="ident" id="5736722"><a href="/gostd/compress/lzw/reader.go.html#5734722">r</a></span><span class="op" id="5736723">.</span><span class="ident" id="5736724"><a href="/gostd/io/io.go.html#1426989">ReadByte</a></span><span class="op" id="5736732">(</span><span class="op" id="5736733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736737">if</span>&nbsp;<span class="ident" id="5736740"><a href="/gostd/compress/lzw/reader.go.html#5736713">err</a></span>&nbsp;<span class="op" id="5736744">!=</span>&nbsp;<span class="builtintype" id="5736747">nil</span>&nbsp;<span class="op" id="5736751">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736756">return</span>&nbsp;<span class="num" id="5736763">0</span><span class="op" id="5736764">,</span>&nbsp;<span class="ident" id="5736766"><a href="/gostd/compress/lzw/reader.go.html#5736713">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5736772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736776"><a href="/gostd/compress/lzw/reader.go.html#5736643">d</a></span><span class="op" id="5736777">.</span><span class="ident" id="5736778"><a href="/gostd/compress/lzw/reader.go.html#5734746">bits</a></span>&nbsp;<span class="op" id="5736783">|=</span>&nbsp;<span class="builtintype" id="5736786">uint32</span><span class="op" id="5736792">(</span><span class="ident" id="5736793"><a href="/gostd/compress/lzw/reader.go.html#5736710">x</a></span><span class="op" id="5736794">)</span>&nbsp;<span class="op" id="5736796">&lt;&lt;</span>&nbsp;<span class="op" id="5736799">(</span><span class="num" id="5736800">24</span>&nbsp;<span class="op" id="5736803">-</span>&nbsp;<span class="ident" id="5736805"><a href="/gostd/compress/lzw/reader.go.html#5736643">d</a></span><span class="op" id="5736806">.</span><span class="ident" id="5736807"><a href="/gostd/compress/lzw/reader.go.html#5734763">nBits</a></span><span class="op" id="5736812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736816"><a href="/gostd/compress/lzw/reader.go.html#5736643">d</a></span><span class="op" id="5736817">.</span><span class="ident" id="5736818"><a href="/gostd/compress/lzw/reader.go.html#5734763">nBits</a></span>&nbsp;<span class="op" id="5736824">+=</span>&nbsp;<span class="num" id="5736827">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5736830">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736833">code</span>&nbsp;<span class="op" id="5736838">:=</span>&nbsp;<span class="builtintype" id="5736841">uint16</span><span class="op" id="5736847">(</span><span class="ident" id="5736848"><a href="/gostd/compress/lzw/reader.go.html#5736643">d</a></span><span class="op" id="5736849">.</span><span class="ident" id="5736850"><a href="/gostd/compress/lzw/reader.go.html#5734746">bits</a></span>&nbsp;<span class="op" id="5736855">&gt;&gt;</span>&nbsp;<span class="op" id="5736858">(</span><span class="num" id="5736859">32</span>&nbsp;<span class="op" id="5736862">-</span>&nbsp;<span class="ident" id="5736864"><a href="/gostd/compress/lzw/reader.go.html#5736643">d</a></span><span class="op" id="5736865">.</span><span class="ident" id="5736866"><a href="/gostd/compress/lzw/reader.go.html#5734778">width</a></span><span class="op" id="5736871">)</span><span class="op" id="5736872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736875"><a href="/gostd/compress/lzw/reader.go.html#5736643">d</a></span><span class="op" id="5736876">.</span><span class="ident" id="5736877"><a href="/gostd/compress/lzw/reader.go.html#5734746">bits</a></span>&nbsp;<span class="op" id="5736882">&lt;&lt;=</span>&nbsp;<span class="ident" id="5736886"><a href="/gostd/compress/lzw/reader.go.html#5736643">d</a></span><span class="op" id="5736887">.</span><span class="ident" id="5736888"><a href="/gostd/compress/lzw/reader.go.html#5734778">width</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736895"><a href="/gostd/compress/lzw/reader.go.html#5736643">d</a></span><span class="op" id="5736896">.</span><span class="ident" id="5736897"><a href="/gostd/compress/lzw/reader.go.html#5734763">nBits</a></span>&nbsp;<span class="op" id="5736903">-=</span>&nbsp;<span class="ident" id="5736906"><a href="/gostd/compress/lzw/reader.go.html#5736643">d</a></span><span class="op" id="5736907">.</span><span class="ident" id="5736908"><a href="/gostd/compress/lzw/reader.go.html#5734778">width</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736915">return</span>&nbsp;<span class="ident" id="5736922"><a href="/gostd/compress/lzw/reader.go.html#5736833">code</a></span><span class="op" id="5736926">,</span>&nbsp;<span class="builtintype" id="5736928">nil</span><br>
<span class="lineno"></span><span class="op" id="5736932">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="5736935">func</span>&nbsp;<span class="op" id="5736940">(</span><span class="ident" id="5736941">d</span>&nbsp;<span class="op" id="5736943">*</span><span class="ident" id="5736944"><a href="/gostd/compress/lzw/reader.go.html#5734704">decoder</a></span><span class="op" id="5736951">)</span>&nbsp;<span class="ident" id="5736953">Read</span><span class="op" id="5736957">(</span><span class="ident" id="5736958">b</span>&nbsp;<span class="op" id="5736960">[</span><span class="op" id="5736961">]</span><span class="builtintype" id="5736962">byte</span><span class="op" id="5736966">)</span>&nbsp;<span class="op" id="5736968">(</span><span class="builtintype" id="5736969">int</span><span class="op" id="5736972">,</span>&nbsp;<span class="builtintype" id="5736974">error</span><span class="op" id="5736979">)</span>&nbsp;<span class="op" id="5736981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736984">for</span>&nbsp;<span class="op" id="5736988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736992">if</span>&nbsp;<span class="builtinfunc" id="5736995">len</span><span class="op" id="5736998">(</span><span class="ident" id="5736999"><a href="/gostd/compress/lzw/reader.go.html#5736941">d</a></span><span class="op" id="5737000">.</span><span class="ident" id="5737001"><a href="/gostd/compress/lzw/reader.go.html#5736152">toRead</a></span><span class="op" id="5737007">)</span>&nbsp;<span class="op" id="5737009">&gt;</span>&nbsp;<span class="num" id="5737011">0</span>&nbsp;<span class="op" id="5737013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737018">n</span>&nbsp;<span class="op" id="5737020">:=</span>&nbsp;<span class="builtinfunc" id="5737023">copy</span><span class="op" id="5737027">(</span><span class="ident" id="5737028"><a href="/gostd/compress/lzw/reader.go.html#5736958">b</a></span><span class="op" id="5737029">,</span>&nbsp;<span class="ident" id="5737031"><a href="/gostd/compress/lzw/reader.go.html#5736941">d</a></span><span class="op" id="5737032">.</span><span class="ident" id="5737033"><a href="/gostd/compress/lzw/reader.go.html#5736152">toRead</a></span><span class="op" id="5737039">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737044"><a href="/gostd/compress/lzw/reader.go.html#5736941">d</a></span><span class="op" id="5737045">.</span><span class="ident" id="5737046"><a href="/gostd/compress/lzw/reader.go.html#5736152">toRead</a></span>&nbsp;<span class="op" id="5737053">=</span>&nbsp;<span class="ident" id="5737055"><a href="/gostd/compress/lzw/reader.go.html#5736941">d</a></span><span class="op" id="5737056">.</span><span class="ident" id="5737057"><a href="/gostd/compress/lzw/reader.go.html#5736152">toRead</a></span><span class="op" id="5737063">[</span><span class="ident" id="5737064"><a href="/gostd/compress/lzw/reader.go.html#5737018">n</a></span><span class="op" id="5737065">:</span><span class="op" id="5737066">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737071">return</span>&nbsp;<span class="ident" id="5737078"><a href="/gostd/compress/lzw/reader.go.html#5737018">n</a></span><span class="op" id="5737079">,</span>&nbsp;<span class="builtintype" id="5737081">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5737087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737091">if</span>&nbsp;<span class="ident" id="5737094"><a href="/gostd/compress/lzw/reader.go.html#5736941">d</a></span><span class="op" id="5737095">.</span><span class="ident" id="5737096"><a href="/gostd/compress/lzw/reader.go.html#5734931">err</a></span>&nbsp;<span class="op" id="5737100">!=</span>&nbsp;<span class="builtintype" id="5737103">nil</span>&nbsp;<span class="op" id="5737107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737112">return</span>&nbsp;<span class="num" id="5737119">0</span><span class="op" id="5737120">,</span>&nbsp;<span class="ident" id="5737122"><a href="/gostd/compress/lzw/reader.go.html#5736941">d</a></span><span class="op" id="5737123">.</span><span class="ident" id="5737124"><a href="/gostd/compress/lzw/reader.go.html#5734931">err</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5737130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737134"><a href="/gostd/compress/lzw/reader.go.html#5736941">d</a></span><span class="op" id="5737135">.</span><span class="ident" id="5737136"><a href="/gostd/compress/lzw/reader.go.html#5737335">decode</a></span><span class="op" id="5737142">(</span><span class="op" id="5737143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5737146">}</span><br>
<span class="lineno"></span><span class="op" id="5737148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="5737151">//&nbsp;decode&nbsp;decompresses&nbsp;bytes&nbsp;from&nbsp;r&nbsp;and&nbsp;leaves&nbsp;them&nbsp;in&nbsp;d.toRead.</span><br>
<span class="lineno"></span><span class="comment" id="5737216">//&nbsp;read&nbsp;specifies&nbsp;how&nbsp;to&nbsp;decode&nbsp;bytes&nbsp;into&nbsp;codes.</span><br>
<span class="lineno"></span><span class="comment" id="5737266">//&nbsp;litWidth&nbsp;is&nbsp;the&nbsp;width&nbsp;in&nbsp;bits&nbsp;of&nbsp;literal&nbsp;codes.</span><br>
<span class="lineno"></span><span class="keyword" id="5737317">func</span>&nbsp;<span class="op" id="5737322">(</span><span class="ident" id="5737323">d</span>&nbsp;<span class="op" id="5737325">*</span><span class="ident" id="5737326"><a href="/gostd/compress/lzw/reader.go.html#5734704">decoder</a></span><span class="op" id="5737333">)</span>&nbsp;<span class="ident" id="5737335">decode</span><span class="op" id="5737341">(</span><span class="op" id="5737342">)</span>&nbsp;<span class="op" id="5737344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5737347">//&nbsp;Loop&nbsp;over&nbsp;the&nbsp;code&nbsp;stream,&nbsp;converting&nbsp;codes&nbsp;into&nbsp;decompressed&nbsp;bytes.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737420">for</span>&nbsp;<span class="op" id="5737424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737428">code</span><span class="op" id="5737432">,</span>&nbsp;<span class="ident" id="5737434">err</span>&nbsp;<span class="op" id="5737438">:=</span>&nbsp;<span class="ident" id="5737441"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737442">.</span><span class="ident" id="5737443"><a href="/gostd/compress/lzw/reader.go.html#5734793">read</a></span><span class="op" id="5737447">(</span><span class="ident" id="5737448"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737453">if</span>&nbsp;<span class="ident" id="5737456"><a href="/gostd/compress/lzw/reader.go.html#5737434">err</a></span>&nbsp;<span class="op" id="5737460">!=</span>&nbsp;<span class="builtintype" id="5737463">nil</span>&nbsp;<span class="op" id="5737467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737472">if</span>&nbsp;<span class="ident" id="5737475"><a href="/gostd/compress/lzw/reader.go.html#5737434">err</a></span>&nbsp;<span class="op" id="5737479">==</span>&nbsp;<span class="ident" id="5737482"><a href="/gostd/compress/lzw/reader.go.html#5734216">io</a></span><span class="op" id="5737484">.</span><span class="ident" id="5737485"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="5737489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737495"><a href="/gostd/compress/lzw/reader.go.html#5737434">err</a></span>&nbsp;<span class="op" id="5737499">=</span>&nbsp;<span class="ident" id="5737501"><a href="/gostd/compress/lzw/reader.go.html#5734216">io</a></span><span class="op" id="5737503">.</span><span class="ident" id="5737504"><a href="/gostd/io/io.go.html#1420096">ErrUnexpectedEOF</a></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5737524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737529"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737530">.</span><span class="ident" id="5737531"><a href="/gostd/compress/lzw/reader.go.html#5734931">err</a></span>&nbsp;<span class="op" id="5737535">=</span>&nbsp;<span class="ident" id="5737537"><a href="/gostd/compress/lzw/reader.go.html#5737434">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737544">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5737553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737557">switch</span>&nbsp;<span class="op" id="5737564">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737568">case</span>&nbsp;<span class="ident" id="5737573"><a href="/gostd/compress/lzw/reader.go.html#5737428">code</a></span>&nbsp;<span class="op" id="5737578">&lt;</span>&nbsp;<span class="ident" id="5737580"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737581">.</span><span class="ident" id="5737582"><a href="/gostd/compress/lzw/reader.go.html#5735297">clear</a></span><span class="op" id="5737587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5737592">//&nbsp;We&nbsp;have&nbsp;a&nbsp;literal&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737622"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737623">.</span><span class="ident" id="5737624"><a href="/gostd/compress/lzw/reader.go.html#5736078">output</a></span><span class="op" id="5737630">[</span><span class="ident" id="5737631"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737632">.</span><span class="ident" id="5737633"><a href="/gostd/compress/lzw/reader.go.html#5736110">o</a></span><span class="op" id="5737634">]</span>&nbsp;<span class="op" id="5737636">=</span>&nbsp;<span class="builtintype" id="5737638">uint8</span><span class="op" id="5737643">(</span><span class="ident" id="5737644"><a href="/gostd/compress/lzw/reader.go.html#5737428">code</a></span><span class="op" id="5737648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737653"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737654">.</span><span class="ident" id="5737655"><a href="/gostd/compress/lzw/reader.go.html#5736110">o</a></span><span class="op" id="5737656">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737662">if</span>&nbsp;<span class="ident" id="5737665"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737666">.</span><span class="ident" id="5737667"><a href="/gostd/compress/lzw/reader.go.html#5735323">last</a></span>&nbsp;<span class="op" id="5737672">!=</span>&nbsp;<span class="ident" id="5737675"><a href="/gostd/compress/lzw/reader.go.html#5734532">decoderInvalidCode</a></span>&nbsp;<span class="op" id="5737694">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5737700">//&nbsp;Save&nbsp;what&nbsp;the&nbsp;hi&nbsp;code&nbsp;expands&nbsp;to.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737741"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737742">.</span><span class="ident" id="5737743"><a href="/gostd/compress/lzw/reader.go.html#5735620">suffix</a></span><span class="op" id="5737749">[</span><span class="ident" id="5737750"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737751">.</span><span class="ident" id="5737752"><a href="/gostd/compress/lzw/reader.go.html#5735309">hi</a></span><span class="op" id="5737754">]</span>&nbsp;<span class="op" id="5737756">=</span>&nbsp;<span class="builtintype" id="5737758">uint8</span><span class="op" id="5737763">(</span><span class="ident" id="5737764"><a href="/gostd/compress/lzw/reader.go.html#5737428">code</a></span><span class="op" id="5737768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737774"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737775">.</span><span class="ident" id="5737776"><a href="/gostd/compress/lzw/reader.go.html#5735649">prefix</a></span><span class="op" id="5737782">[</span><span class="ident" id="5737783"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737784">.</span><span class="ident" id="5737785"><a href="/gostd/compress/lzw/reader.go.html#5735309">hi</a></span><span class="op" id="5737787">]</span>&nbsp;<span class="op" id="5737789">=</span>&nbsp;<span class="ident" id="5737791"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737792">.</span><span class="ident" id="5737793"><a href="/gostd/compress/lzw/reader.go.html#5735323">last</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5737801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737805">case</span>&nbsp;<span class="ident" id="5737810"><a href="/gostd/compress/lzw/reader.go.html#5737428">code</a></span>&nbsp;<span class="op" id="5737815">==</span>&nbsp;<span class="ident" id="5737818"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737819">.</span><span class="ident" id="5737820"><a href="/gostd/compress/lzw/reader.go.html#5735297">clear</a></span><span class="op" id="5737825">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737830"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737831">.</span><span class="ident" id="5737832"><a href="/gostd/compress/lzw/reader.go.html#5734778">width</a></span>&nbsp;<span class="op" id="5737838">=</span>&nbsp;<span class="num" id="5737840">1</span>&nbsp;<span class="op" id="5737842">+</span>&nbsp;<span class="builtintype" id="5737844">uint</span><span class="op" id="5737848">(</span><span class="ident" id="5737849"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737850">.</span><span class="ident" id="5737851"><a href="/gostd/compress/lzw/reader.go.html#5734856">litWidth</a></span><span class="op" id="5737859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737864"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737865">.</span><span class="ident" id="5737866"><a href="/gostd/compress/lzw/reader.go.html#5735309">hi</a></span>&nbsp;<span class="op" id="5737869">=</span>&nbsp;<span class="ident" id="5737871"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737872">.</span><span class="ident" id="5737873"><a href="/gostd/compress/lzw/reader.go.html#5735304">eof</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737880"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737881">.</span><span class="ident" id="5737882"><a href="/gostd/compress/lzw/reader.go.html#5735313">overflow</a></span>&nbsp;<span class="op" id="5737891">=</span>&nbsp;<span class="num" id="5737893">1</span>&nbsp;<span class="op" id="5737895">&lt;&lt;</span>&nbsp;<span class="ident" id="5737898"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737899">.</span><span class="ident" id="5737900"><a href="/gostd/compress/lzw/reader.go.html#5734778">width</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737909"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737910">.</span><span class="ident" id="5737911"><a href="/gostd/compress/lzw/reader.go.html#5735323">last</a></span>&nbsp;<span class="op" id="5737916">=</span>&nbsp;<span class="ident" id="5737918"><a href="/gostd/compress/lzw/reader.go.html#5734532">decoderInvalidCode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737940">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737951">case</span>&nbsp;<span class="ident" id="5737956"><a href="/gostd/compress/lzw/reader.go.html#5737428">code</a></span>&nbsp;<span class="op" id="5737961">==</span>&nbsp;<span class="ident" id="5737964"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737965">.</span><span class="ident" id="5737966"><a href="/gostd/compress/lzw/reader.go.html#5735304">eof</a></span><span class="op" id="5737969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737974"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737975">.</span><span class="ident" id="5737976"><a href="/gostd/compress/lzw/reader.go.html#5739090">flush</a></span><span class="op" id="5737981">(</span><span class="op" id="5737982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737987"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5737988">.</span><span class="ident" id="5737989"><a href="/gostd/compress/lzw/reader.go.html#5734931">err</a></span>&nbsp;<span class="op" id="5737993">=</span>&nbsp;<span class="ident" id="5737995"><a href="/gostd/compress/lzw/reader.go.html#5734216">io</a></span><span class="op" id="5737997">.</span><span class="ident" id="5737998"><a href="/gostd/io/io.go.html#1419950">EOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738005">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738014">case</span>&nbsp;<span class="ident" id="5738019"><a href="/gostd/compress/lzw/reader.go.html#5737428">code</a></span>&nbsp;<span class="op" id="5738024">&lt;=</span>&nbsp;<span class="ident" id="5738027"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738028">.</span><span class="ident" id="5738029"><a href="/gostd/compress/lzw/reader.go.html#5735309">hi</a></span><span class="op" id="5738031">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738036">c</span><span class="op" id="5738037">,</span>&nbsp;<span class="ident" id="5738039">i</span>&nbsp;<span class="op" id="5738041">:=</span>&nbsp;<span class="ident" id="5738044"><a href="/gostd/compress/lzw/reader.go.html#5737428">code</a></span><span class="op" id="5738048">,</span>&nbsp;<span class="builtinfunc" id="5738050">len</span><span class="op" id="5738053">(</span><span class="ident" id="5738054"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738055">.</span><span class="ident" id="5738056"><a href="/gostd/compress/lzw/reader.go.html#5736078">output</a></span><span class="op" id="5738062">)</span><span class="op" id="5738063">-</span><span class="num" id="5738064">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738069">if</span>&nbsp;<span class="ident" id="5738072"><a href="/gostd/compress/lzw/reader.go.html#5737428">code</a></span>&nbsp;<span class="op" id="5738077">==</span>&nbsp;<span class="ident" id="5738080"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738081">.</span><span class="ident" id="5738082"><a href="/gostd/compress/lzw/reader.go.html#5735309">hi</a></span>&nbsp;<span class="op" id="5738085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5738091">//&nbsp;code&nbsp;==&nbsp;hi&nbsp;is&nbsp;a&nbsp;special&nbsp;case&nbsp;which&nbsp;expands&nbsp;to&nbsp;the&nbsp;last&nbsp;expansion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5738163">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;head&nbsp;of&nbsp;the&nbsp;last&nbsp;expansion.&nbsp;To&nbsp;find&nbsp;the&nbsp;head,&nbsp;we&nbsp;walk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5738240">//&nbsp;the&nbsp;prefix&nbsp;chain&nbsp;until&nbsp;we&nbsp;find&nbsp;a&nbsp;literal&nbsp;code.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738294"><a href="/gostd/compress/lzw/reader.go.html#5738036">c</a></span>&nbsp;<span class="op" id="5738296">=</span>&nbsp;<span class="ident" id="5738298"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738299">.</span><span class="ident" id="5738300"><a href="/gostd/compress/lzw/reader.go.html#5735323">last</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738309">for</span>&nbsp;<span class="ident" id="5738313"><a href="/gostd/compress/lzw/reader.go.html#5738036">c</a></span>&nbsp;<span class="op" id="5738315">&gt;=</span>&nbsp;<span class="ident" id="5738318"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738319">.</span><span class="ident" id="5738320"><a href="/gostd/compress/lzw/reader.go.html#5735297">clear</a></span>&nbsp;<span class="op" id="5738326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738333"><a href="/gostd/compress/lzw/reader.go.html#5738036">c</a></span>&nbsp;<span class="op" id="5738335">=</span>&nbsp;<span class="ident" id="5738337"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738338">.</span><span class="ident" id="5738339"><a href="/gostd/compress/lzw/reader.go.html#5735649">prefix</a></span><span class="op" id="5738345">[</span><span class="ident" id="5738346"><a href="/gostd/compress/lzw/reader.go.html#5738036">c</a></span><span class="op" id="5738347">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5738353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738359"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738360">.</span><span class="ident" id="5738361"><a href="/gostd/compress/lzw/reader.go.html#5736078">output</a></span><span class="op" id="5738367">[</span><span class="ident" id="5738368"><a href="/gostd/compress/lzw/reader.go.html#5738039">i</a></span><span class="op" id="5738369">]</span>&nbsp;<span class="op" id="5738371">=</span>&nbsp;<span class="builtintype" id="5738373">uint8</span><span class="op" id="5738378">(</span><span class="ident" id="5738379"><a href="/gostd/compress/lzw/reader.go.html#5738036">c</a></span><span class="op" id="5738380">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738386"><a href="/gostd/compress/lzw/reader.go.html#5738039">i</a></span><span class="op" id="5738387">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738394"><a href="/gostd/compress/lzw/reader.go.html#5738036">c</a></span>&nbsp;<span class="op" id="5738396">=</span>&nbsp;<span class="ident" id="5738398"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738399">.</span><span class="ident" id="5738400"><a href="/gostd/compress/lzw/reader.go.html#5735323">last</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5738408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5738413">//&nbsp;Copy&nbsp;the&nbsp;suffix&nbsp;chain&nbsp;into&nbsp;output&nbsp;and&nbsp;then&nbsp;write&nbsp;that&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738479">for</span>&nbsp;<span class="ident" id="5738483"><a href="/gostd/compress/lzw/reader.go.html#5738036">c</a></span>&nbsp;<span class="op" id="5738485">&gt;=</span>&nbsp;<span class="ident" id="5738488"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738489">.</span><span class="ident" id="5738490"><a href="/gostd/compress/lzw/reader.go.html#5735297">clear</a></span>&nbsp;<span class="op" id="5738496">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738502"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738503">.</span><span class="ident" id="5738504"><a href="/gostd/compress/lzw/reader.go.html#5736078">output</a></span><span class="op" id="5738510">[</span><span class="ident" id="5738511"><a href="/gostd/compress/lzw/reader.go.html#5738039">i</a></span><span class="op" id="5738512">]</span>&nbsp;<span class="op" id="5738514">=</span>&nbsp;<span class="ident" id="5738516"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738517">.</span><span class="ident" id="5738518"><a href="/gostd/compress/lzw/reader.go.html#5735620">suffix</a></span><span class="op" id="5738524">[</span><span class="ident" id="5738525"><a href="/gostd/compress/lzw/reader.go.html#5738036">c</a></span><span class="op" id="5738526">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738532"><a href="/gostd/compress/lzw/reader.go.html#5738039">i</a></span><span class="op" id="5738533">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738540"><a href="/gostd/compress/lzw/reader.go.html#5738036">c</a></span>&nbsp;<span class="op" id="5738542">=</span>&nbsp;<span class="ident" id="5738544"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738545">.</span><span class="ident" id="5738546"><a href="/gostd/compress/lzw/reader.go.html#5735649">prefix</a></span><span class="op" id="5738552">[</span><span class="ident" id="5738553"><a href="/gostd/compress/lzw/reader.go.html#5738036">c</a></span><span class="op" id="5738554">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5738559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738564"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738565">.</span><span class="ident" id="5738566"><a href="/gostd/compress/lzw/reader.go.html#5736078">output</a></span><span class="op" id="5738572">[</span><span class="ident" id="5738573"><a href="/gostd/compress/lzw/reader.go.html#5738039">i</a></span><span class="op" id="5738574">]</span>&nbsp;<span class="op" id="5738576">=</span>&nbsp;<span class="builtintype" id="5738578">uint8</span><span class="op" id="5738583">(</span><span class="ident" id="5738584"><a href="/gostd/compress/lzw/reader.go.html#5738036">c</a></span><span class="op" id="5738585">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738590"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738591">.</span><span class="ident" id="5738592"><a href="/gostd/compress/lzw/reader.go.html#5736110">o</a></span>&nbsp;<span class="op" id="5738594">+=</span>&nbsp;<span class="builtinfunc" id="5738597">copy</span><span class="op" id="5738601">(</span><span class="ident" id="5738602"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738603">.</span><span class="ident" id="5738604"><a href="/gostd/compress/lzw/reader.go.html#5736078">output</a></span><span class="op" id="5738610">[</span><span class="ident" id="5738611"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738612">.</span><span class="ident" id="5738613"><a href="/gostd/compress/lzw/reader.go.html#5736110">o</a></span><span class="op" id="5738614">:</span><span class="op" id="5738615">]</span><span class="op" id="5738616">,</span>&nbsp;<span class="ident" id="5738618"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738619">.</span><span class="ident" id="5738620"><a href="/gostd/compress/lzw/reader.go.html#5736078">output</a></span><span class="op" id="5738626">[</span><span class="ident" id="5738627"><a href="/gostd/compress/lzw/reader.go.html#5738039">i</a></span><span class="op" id="5738628">:</span><span class="op" id="5738629">]</span><span class="op" id="5738630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738635">if</span>&nbsp;<span class="ident" id="5738638"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738639">.</span><span class="ident" id="5738640"><a href="/gostd/compress/lzw/reader.go.html#5735323">last</a></span>&nbsp;<span class="op" id="5738645">!=</span>&nbsp;<span class="ident" id="5738648"><a href="/gostd/compress/lzw/reader.go.html#5734532">decoderInvalidCode</a></span>&nbsp;<span class="op" id="5738667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5738673">//&nbsp;Save&nbsp;what&nbsp;the&nbsp;hi&nbsp;code&nbsp;expands&nbsp;to.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738714"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738715">.</span><span class="ident" id="5738716"><a href="/gostd/compress/lzw/reader.go.html#5735620">suffix</a></span><span class="op" id="5738722">[</span><span class="ident" id="5738723"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738724">.</span><span class="ident" id="5738725"><a href="/gostd/compress/lzw/reader.go.html#5735309">hi</a></span><span class="op" id="5738727">]</span>&nbsp;<span class="op" id="5738729">=</span>&nbsp;<span class="builtintype" id="5738731">uint8</span><span class="op" id="5738736">(</span><span class="ident" id="5738737"><a href="/gostd/compress/lzw/reader.go.html#5738036">c</a></span><span class="op" id="5738738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738744"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738745">.</span><span class="ident" id="5738746"><a href="/gostd/compress/lzw/reader.go.html#5735649">prefix</a></span><span class="op" id="5738752">[</span><span class="ident" id="5738753"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738754">.</span><span class="ident" id="5738755"><a href="/gostd/compress/lzw/reader.go.html#5735309">hi</a></span><span class="op" id="5738757">]</span>&nbsp;<span class="op" id="5738759">=</span>&nbsp;<span class="ident" id="5738761"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738762">.</span><span class="ident" id="5738763"><a href="/gostd/compress/lzw/reader.go.html#5735323">last</a></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5738771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738775">default</span><span class="op" id="5738782">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738787"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738788">.</span><span class="ident" id="5738789"><a href="/gostd/compress/lzw/reader.go.html#5734931">err</a></span>&nbsp;<span class="op" id="5738793">=</span>&nbsp;<span class="ident" id="5738795"><a href="/gostd/compress/lzw/reader.go.html#5734199">errors</a></span><span class="op" id="5738801">.</span><span class="ident" id="5738802"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5738805">(</span><span class="string" id="5738806">&#34;lzw:&nbsp;invalid&nbsp;code&#34;</span><span class="op" id="5738825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738830">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5738839">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738843"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738844">.</span><span class="ident" id="5738845"><a href="/gostd/compress/lzw/reader.go.html#5735323">last</a></span><span class="op" id="5738849">,</span>&nbsp;<span class="ident" id="5738851"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738852">.</span><span class="ident" id="5738853"><a href="/gostd/compress/lzw/reader.go.html#5735309">hi</a></span>&nbsp;<span class="op" id="5738856">=</span>&nbsp;<span class="ident" id="5738858"><a href="/gostd/compress/lzw/reader.go.html#5737428">code</a></span><span class="op" id="5738862">,</span>&nbsp;<span class="ident" id="5738864"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738865">.</span><span class="ident" id="5738866"><a href="/gostd/compress/lzw/reader.go.html#5735309">hi</a></span><span class="op" id="5738868">+</span><span class="num" id="5738869">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738873">if</span>&nbsp;<span class="ident" id="5738876"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738877">.</span><span class="ident" id="5738878"><a href="/gostd/compress/lzw/reader.go.html#5735309">hi</a></span>&nbsp;<span class="op" id="5738881">&gt;=</span>&nbsp;<span class="ident" id="5738884"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738885">.</span><span class="ident" id="5738886"><a href="/gostd/compress/lzw/reader.go.html#5735313">overflow</a></span>&nbsp;<span class="op" id="5738895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738900">if</span>&nbsp;<span class="ident" id="5738903"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738904">.</span><span class="ident" id="5738905"><a href="/gostd/compress/lzw/reader.go.html#5734778">width</a></span>&nbsp;<span class="op" id="5738911">==</span>&nbsp;<span class="ident" id="5738914"><a href="/gostd/compress/lzw/reader.go.html#5734507">maxWidth</a></span>&nbsp;<span class="op" id="5738923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738929"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738930">.</span><span class="ident" id="5738931"><a href="/gostd/compress/lzw/reader.go.html#5735323">last</a></span>&nbsp;<span class="op" id="5738936">=</span>&nbsp;<span class="ident" id="5738938"><a href="/gostd/compress/lzw/reader.go.html#5734532">decoderInvalidCode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5738960">}</span>&nbsp;<span class="keyword" id="5738962">else</span>&nbsp;<span class="op" id="5738967">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738973"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738974">.</span><span class="ident" id="5738975"><a href="/gostd/compress/lzw/reader.go.html#5734778">width</a></span><span class="op" id="5738980">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738987"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5738988">.</span><span class="ident" id="5738989"><a href="/gostd/compress/lzw/reader.go.html#5735313">overflow</a></span>&nbsp;<span class="op" id="5738998">&lt;&lt;=</span>&nbsp;<span class="num" id="5739002">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5739007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5739011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739015">if</span>&nbsp;<span class="ident" id="5739018"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5739019">.</span><span class="ident" id="5739020"><a href="/gostd/compress/lzw/reader.go.html#5736110">o</a></span>&nbsp;<span class="op" id="5739022">&gt;=</span>&nbsp;<span class="ident" id="5739025"><a href="/gostd/compress/lzw/reader.go.html#5734561">flushBuffer</a></span>&nbsp;<span class="op" id="5739037">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5739042"><a href="/gostd/compress/lzw/reader.go.html#5737323">d</a></span><span class="op" id="5739043">.</span><span class="ident" id="5739044"><a href="/gostd/compress/lzw/reader.go.html#5739090">flush</a></span><span class="op" id="5739049">(</span><span class="op" id="5739050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739055">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5739064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5739067">}</span><br>
<span class="lineno"></span><span class="op" id="5739069">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="5739072">func</span>&nbsp;<span class="op" id="5739077">(</span><span class="ident" id="5739078">d</span>&nbsp;<span class="op" id="5739080">*</span><span class="ident" id="5739081"><a href="/gostd/compress/lzw/reader.go.html#5734704">decoder</a></span><span class="op" id="5739088">)</span>&nbsp;<span class="ident" id="5739090">flush</span><span class="op" id="5739095">(</span><span class="op" id="5739096">)</span>&nbsp;<span class="op" id="5739098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5739101"><a href="/gostd/compress/lzw/reader.go.html#5739078">d</a></span><span class="op" id="5739102">.</span><span class="ident" id="5739103"><a href="/gostd/compress/lzw/reader.go.html#5736152">toRead</a></span>&nbsp;<span class="op" id="5739110">=</span>&nbsp;<span class="ident" id="5739112"><a href="/gostd/compress/lzw/reader.go.html#5739078">d</a></span><span class="op" id="5739113">.</span><span class="ident" id="5739114"><a href="/gostd/compress/lzw/reader.go.html#5736078">output</a></span><span class="op" id="5739120">[</span><span class="op" id="5739121">:</span><span class="ident" id="5739122"><a href="/gostd/compress/lzw/reader.go.html#5739078">d</a></span><span class="op" id="5739123">.</span><span class="ident" id="5739124"><a href="/gostd/compress/lzw/reader.go.html#5736110">o</a></span><span class="op" id="5739125">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5739128"><a href="/gostd/compress/lzw/reader.go.html#5739078">d</a></span><span class="op" id="5739129">.</span><span class="ident" id="5739130"><a href="/gostd/compress/lzw/reader.go.html#5736110">o</a></span>&nbsp;<span class="op" id="5739132">=</span>&nbsp;<span class="num" id="5739134">0</span><br>
<span class="lineno"></span><span class="op" id="5739136">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="5739139">var</span>&nbsp;<span class="ident" id="5739143">errClosed</span>&nbsp;<span class="op" id="5739153">=</span>&nbsp;<span class="ident" id="5739155"><a href="/gostd/compress/lzw/reader.go.html#5734199">errors</a></span><span class="op" id="5739161">.</span><span class="ident" id="5739162"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5739165">(</span><span class="string" id="5739166">&#34;compress/lzw:&nbsp;reader/writer&nbsp;is&nbsp;closed&#34;</span><span class="op" id="5739205">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5739208">func</span>&nbsp;<span class="op" id="5739213">(</span><span class="ident" id="5739214">d</span>&nbsp;<span class="op" id="5739216">*</span><span class="ident" id="5739217"><a href="/gostd/compress/lzw/reader.go.html#5734704">decoder</a></span><span class="op" id="5739224">)</span>&nbsp;<span class="ident" id="5739226">Close</span><span class="op" id="5739231">(</span><span class="op" id="5739232">)</span>&nbsp;<span class="builtintype" id="5739234">error</span>&nbsp;<span class="op" id="5739240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5739243"><a href="/gostd/compress/lzw/reader.go.html#5739214">d</a></span><span class="op" id="5739244">.</span><span class="ident" id="5739245"><a href="/gostd/compress/lzw/reader.go.html#5734931">err</a></span>&nbsp;<span class="op" id="5739249">=</span>&nbsp;<span class="ident" id="5739251"><a href="/gostd/compress/lzw/reader.go.html#5739143">errClosed</a></span>&nbsp;<span class="comment" id="5739261">//&nbsp;in&nbsp;case&nbsp;any&nbsp;Reads&nbsp;come&nbsp;along</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739294">return</span>&nbsp;<span class="builtintype" id="5739301">nil</span><br>
<span class="lineno"></span><span class="op" id="5739305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5739308">//&nbsp;NewReader&nbsp;creates&nbsp;a&nbsp;new&nbsp;io.ReadCloser.</span><br>
<span class="lineno"></span><span class="comment" id="5739350">//&nbsp;Reads&nbsp;from&nbsp;the&nbsp;returned&nbsp;io.ReadCloser&nbsp;read&nbsp;and&nbsp;decompress&nbsp;data&nbsp;from&nbsp;r.</span><br>
<span class="lineno">225</span><span class="comment" id="5739424">//&nbsp;If&nbsp;r&nbsp;does&nbsp;not&nbsp;also&nbsp;implement&nbsp;io.ByteReader,</span><br>
<span class="lineno"></span><span class="comment" id="5739471">//&nbsp;the&nbsp;decompressor&nbsp;may&nbsp;read&nbsp;more&nbsp;data&nbsp;than&nbsp;necessary&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="5739533">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;call&nbsp;Close&nbsp;on&nbsp;the&nbsp;ReadCloser&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="5739607">//&nbsp;finished&nbsp;reading.</span><br>
<span class="lineno"></span><span class="comment" id="5739628">//&nbsp;The&nbsp;number&nbsp;of&nbsp;bits&nbsp;to&nbsp;use&nbsp;for&nbsp;literal&nbsp;codes,&nbsp;litWidth,&nbsp;must&nbsp;be&nbsp;in&nbsp;the</span><br>
<span class="lineno">230</span><span class="comment" id="5739701">//&nbsp;range&nbsp;[2,8]&nbsp;and&nbsp;is&nbsp;typically&nbsp;8.</span><br>
<span class="lineno"></span><span class="keyword" id="5739736">func</span>&nbsp;<span class="ident" id="5739741">NewReader</span><span class="op" id="5739750">(</span><span class="ident" id="5739751">r</span>&nbsp;<span class="ident" id="5739753"><a href="/gostd/compress/lzw/reader.go.html#5734216">io</a></span><span class="op" id="5739755">.</span><span class="ident" id="5739756"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="5739762">,</span>&nbsp;<span class="ident" id="5739764">order</span>&nbsp;<span class="ident" id="5739770"><a href="/gostd/compress/lzw/reader.go.html#5734288">Order</a></span><span class="op" id="5739775">,</span>&nbsp;<span class="ident" id="5739777">litWidth</span>&nbsp;<span class="builtintype" id="5739786">int</span><span class="op" id="5739789">)</span>&nbsp;<span class="ident" id="5739791"><a href="/gostd/compress/lzw/reader.go.html#5734216">io</a></span><span class="op" id="5739793">.</span><span class="ident" id="5739794"><a href="/gostd/io/io.go.html#1423414">ReadCloser</a></span>&nbsp;<span class="op" id="5739805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5739808">d</span>&nbsp;<span class="op" id="5739810">:=</span>&nbsp;<span class="builtinfunc" id="5739813">new</span><span class="op" id="5739816">(</span><span class="ident" id="5739817"><a href="/gostd/compress/lzw/reader.go.html#5734704">decoder</a></span><span class="op" id="5739824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739827">switch</span>&nbsp;<span class="ident" id="5739834"><a href="/gostd/compress/lzw/reader.go.html#5739764">order</a></span>&nbsp;<span class="op" id="5739840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739843">case</span>&nbsp;<span class="ident" id="5739848"><a href="/gostd/compress/lzw/reader.go.html#5734384">LSB</a></span><span class="op" id="5739851">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5739855"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5739856">.</span><span class="ident" id="5739857"><a href="/gostd/compress/lzw/reader.go.html#5734793">read</a></span>&nbsp;<span class="op" id="5739862">=</span>&nbsp;<span class="op" id="5739864">(</span><span class="op" id="5739865">*</span><span class="ident" id="5739866"><a href="/gostd/compress/lzw/reader.go.html#5734704">decoder</a></span><span class="op" id="5739873">)</span><span class="op" id="5739874">.</span><span class="ident" id="5739875"><a href="/gostd/compress/lzw/reader.go.html#5736290">readLSB</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739884">case</span>&nbsp;<span class="ident" id="5739889"><a href="/gostd/compress/lzw/reader.go.html#5734491">MSB</a></span><span class="op" id="5739892">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5739896"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5739897">.</span><span class="ident" id="5739898"><a href="/gostd/compress/lzw/reader.go.html#5734793">read</a></span>&nbsp;<span class="op" id="5739903">=</span>&nbsp;<span class="op" id="5739905">(</span><span class="op" id="5739906">*</span><span class="ident" id="5739907"><a href="/gostd/compress/lzw/reader.go.html#5734704">decoder</a></span><span class="op" id="5739914">)</span><span class="op" id="5739915">.</span><span class="ident" id="5739916"><a href="/gostd/compress/lzw/reader.go.html#5736655">readMSB</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739925">default</span><span class="op" id="5739932">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5739936"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5739937">.</span><span class="ident" id="5739938"><a href="/gostd/compress/lzw/reader.go.html#5734931">err</a></span>&nbsp;<span class="op" id="5739942">=</span>&nbsp;<span class="ident" id="5739944"><a href="/gostd/compress/lzw/reader.go.html#5734199">errors</a></span><span class="op" id="5739950">.</span><span class="ident" id="5739951"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5739954">(</span><span class="string" id="5739955">&#34;lzw:&nbsp;unknown&nbsp;order&#34;</span><span class="op" id="5739975">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739979">return</span>&nbsp;<span class="ident" id="5739986"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5739989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739992">if</span>&nbsp;<span class="ident" id="5739995"><a href="/gostd/compress/lzw/reader.go.html#5739777">litWidth</a></span>&nbsp;<span class="op" id="5740004">&lt;</span>&nbsp;<span class="num" id="5740006">2</span>&nbsp;<span class="op" id="5740008">||</span>&nbsp;<span class="num" id="5740011">8</span>&nbsp;<span class="op" id="5740013">&lt;</span>&nbsp;<span class="ident" id="5740015"><a href="/gostd/compress/lzw/reader.go.html#5739777">litWidth</a></span>&nbsp;<span class="op" id="5740024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740028"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5740029">.</span><span class="ident" id="5740030"><a href="/gostd/compress/lzw/reader.go.html#5734931">err</a></span>&nbsp;<span class="op" id="5740034">=</span>&nbsp;<span class="ident" id="5740036"><a href="/gostd/compress/lzw/reader.go.html#5734209">fmt</a></span><span class="op" id="5740039">.</span><span class="ident" id="5740040"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="5740046">(</span><span class="string" id="5740047">&#34;lzw:&nbsp;litWidth&nbsp;%d&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="5740078">,</span>&nbsp;<span class="ident" id="5740080"><a href="/gostd/compress/lzw/reader.go.html#5739777">litWidth</a></span><span class="op" id="5740088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5740092">return</span>&nbsp;<span class="ident" id="5740099"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5740102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5740105">if</span>&nbsp;<span class="ident" id="5740108">br</span><span class="op" id="5740110">,</span>&nbsp;<span class="ident" id="5740112">ok</span>&nbsp;<span class="op" id="5740115">:=</span>&nbsp;<span class="ident" id="5740118"><a href="/gostd/compress/lzw/reader.go.html#5739751">r</a></span><span class="op" id="5740119">.</span><span class="op" id="5740120">(</span><span class="ident" id="5740121"><a href="/gostd/compress/lzw/reader.go.html#5734216">io</a></span><span class="op" id="5740123">.</span><span class="ident" id="5740124"><a href="/gostd/io/io.go.html#1426965">ByteReader</a></span><span class="op" id="5740134">)</span><span class="op" id="5740135">;</span>&nbsp;<span class="ident" id="5740137"><a href="/gostd/compress/lzw/reader.go.html#5740112">ok</a></span>&nbsp;<span class="op" id="5740140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740144"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5740145">.</span><span class="ident" id="5740146"><a href="/gostd/compress/lzw/reader.go.html#5734722">r</a></span>&nbsp;<span class="op" id="5740148">=</span>&nbsp;<span class="ident" id="5740150"><a href="/gostd/compress/lzw/reader.go.html#5740108">br</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5740154">}</span>&nbsp;<span class="keyword" id="5740156">else</span>&nbsp;<span class="op" id="5740161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740165"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5740166">.</span><span class="ident" id="5740167"><a href="/gostd/compress/lzw/reader.go.html#5734722">r</a></span>&nbsp;<span class="op" id="5740169">=</span>&nbsp;<span class="ident" id="5740171"><a href="/gostd/compress/lzw/reader.go.html#5734190">bufio</a></span><span class="op" id="5740176">.</span><span class="ident" id="5740177"><a href="/gostd/bufio/bufio.go.html#1355792">NewReader</a></span><span class="op" id="5740186">(</span><span class="ident" id="5740187"><a href="/gostd/compress/lzw/reader.go.html#5739751">r</a></span><span class="op" id="5740188">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5740191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740194"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5740195">.</span><span class="ident" id="5740196"><a href="/gostd/compress/lzw/reader.go.html#5734856">litWidth</a></span>&nbsp;<span class="op" id="5740205">=</span>&nbsp;<span class="ident" id="5740207"><a href="/gostd/compress/lzw/reader.go.html#5739777">litWidth</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740217"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5740218">.</span><span class="ident" id="5740219"><a href="/gostd/compress/lzw/reader.go.html#5734778">width</a></span>&nbsp;<span class="op" id="5740225">=</span>&nbsp;<span class="num" id="5740227">1</span>&nbsp;<span class="op" id="5740229">+</span>&nbsp;<span class="builtintype" id="5740231">uint</span><span class="op" id="5740235">(</span><span class="ident" id="5740236"><a href="/gostd/compress/lzw/reader.go.html#5739777">litWidth</a></span><span class="op" id="5740244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740247"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5740248">.</span><span class="ident" id="5740249"><a href="/gostd/compress/lzw/reader.go.html#5735297">clear</a></span>&nbsp;<span class="op" id="5740255">=</span>&nbsp;<span class="builtintype" id="5740257">uint16</span><span class="op" id="5740263">(</span><span class="num" id="5740264">1</span><span class="op" id="5740265">)</span>&nbsp;<span class="op" id="5740267">&lt;&lt;</span>&nbsp;<span class="builtintype" id="5740270">uint</span><span class="op" id="5740274">(</span><span class="ident" id="5740275"><a href="/gostd/compress/lzw/reader.go.html#5739777">litWidth</a></span><span class="op" id="5740283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740286"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5740287">.</span><span class="ident" id="5740288"><a href="/gostd/compress/lzw/reader.go.html#5735304">eof</a></span><span class="op" id="5740291">,</span>&nbsp;<span class="ident" id="5740293"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5740294">.</span><span class="ident" id="5740295"><a href="/gostd/compress/lzw/reader.go.html#5735309">hi</a></span>&nbsp;<span class="op" id="5740298">=</span>&nbsp;<span class="ident" id="5740300"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5740301">.</span><span class="ident" id="5740302"><a href="/gostd/compress/lzw/reader.go.html#5735297">clear</a></span><span class="op" id="5740307">+</span><span class="num" id="5740308">1</span><span class="op" id="5740309">,</span>&nbsp;<span class="ident" id="5740311"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5740312">.</span><span class="ident" id="5740313"><a href="/gostd/compress/lzw/reader.go.html#5735297">clear</a></span><span class="op" id="5740318">+</span><span class="num" id="5740319">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740322"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5740323">.</span><span class="ident" id="5740324"><a href="/gostd/compress/lzw/reader.go.html#5735313">overflow</a></span>&nbsp;<span class="op" id="5740333">=</span>&nbsp;<span class="builtintype" id="5740335">uint16</span><span class="op" id="5740341">(</span><span class="num" id="5740342">1</span><span class="op" id="5740343">)</span>&nbsp;<span class="op" id="5740345">&lt;&lt;</span>&nbsp;<span class="ident" id="5740348"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5740349">.</span><span class="ident" id="5740350"><a href="/gostd/compress/lzw/reader.go.html#5734778">width</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740357"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><span class="op" id="5740358">.</span><span class="ident" id="5740359"><a href="/gostd/compress/lzw/reader.go.html#5735323">last</a></span>&nbsp;<span class="op" id="5740364">=</span>&nbsp;<span class="ident" id="5740366"><a href="/gostd/compress/lzw/reader.go.html#5734532">decoderInvalidCode</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5740387">return</span>&nbsp;<span class="ident" id="5740394"><a href="/gostd/compress/lzw/reader.go.html#5739808">d</a></span><br>
<span class="lineno"></span><span class="op" id="5740396">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
