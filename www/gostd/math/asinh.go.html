<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1521161">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1521216">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1521270">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1521321">package</span>&nbsp;<span class="ident" id="1521329">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1521335">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1521395">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_asinh.c</span><br>
<span class="lineno"></span><span class="comment" id="1521455">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno">10</span><span class="comment" id="1521514">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="1521544">//</span><br>
<span class="lineno"></span><span class="comment" id="1521547">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1521603">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1521672">//</span><br>
<span class="lineno">15</span><span class="comment" id="1521675">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno"></span><span class="comment" id="1521734">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1521790">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1521847">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1521864">//&nbsp;====================================================</span><br>
<span class="lineno">20</span><span class="comment" id="1521920">//</span><br>
<span class="lineno"></span><span class="comment" id="1521923">//</span><br>
<span class="lineno"></span><span class="comment" id="1521926">//&nbsp;asinh(x)</span><br>
<span class="lineno"></span><span class="comment" id="1521938">//&nbsp;Method&nbsp;:</span><br>
<span class="lineno"></span><span class="comment" id="1521950">//&nbsp;&nbsp;&nbsp;&nbspBased&nbsp;on</span><br>
<span class="lineno">25</span><span class="comment" id="1521962">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asinh(x)&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;log&nbsp;[&nbsp;|x|&nbsp;+&nbsp;sqrt(x*x+1)&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="1522020">//&nbsp;&nbsp;&nbsp;&nbspwe&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="1522031">//&nbsp;&nbsp;&nbsp;&nbspasinh(x)&nbsp;:=&nbsp;x&nbsp;&nbsp;if&nbsp;&nbsp;1+x*x=1,</span><br>
<span class="lineno"></span><span class="comment" id="1522062">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;sign(x)*(log(x)+ln2))&nbsp;for&nbsp;large&nbsp;|x|,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="1522119">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;sign(x)*log(2|x|+1/(|x|+sqrt(x*x+1)))&nbsp;if|x|&gt;2,&nbsp;else</span><br>
<span class="lineno">30</span><span class="comment" id="1522186">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;sign(x)*log1p(|x|&nbsp;+&nbsp;x**2/(1&nbsp;+&nbsp;sqrt(1+x**2)))</span><br>
<span class="lineno"></span><span class="comment" id="1522246">//</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1522250">//&nbsp;Asinh&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;hyperbolic&nbsp;sine&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1522301">//</span><br>
<span class="lineno">35</span><span class="comment" id="1522304">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1522326">//&nbsp;&nbsp;&nbsp;&nbspAsinh(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="1522346">//&nbsp;&nbsp;&nbsp;&nbspAsinh(±Inf)&nbsp;=&nbsp;±Inf</span><br>
<span class="lineno"></span><span class="comment" id="1522370">//&nbsp;&nbsp;&nbsp;&nbspAsinh(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1522390">func</span>&nbsp;<span class="ident" id="1522395">Asinh</span><span class="op" id="1522400">(</span><span class="ident" id="1522401">x</span>&nbsp;<span class="builtintype" id="1522403">float64</span><span class="op" id="1522410">)</span>&nbsp;<span class="builtintype" id="1522412">float64</span>&nbsp;<span class="op" id="1522420">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1522423">const</span>&nbsp;<span class="op" id="1522429">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522433">Ln2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1522442">=</span>&nbsp;<span class="num" id="1522444">6.93147180559945286227e-01</span>&nbsp;<span class="comment" id="1522471">//&nbsp;0x3FE62E42FEFA39EF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522495">NearZero</span>&nbsp;<span class="op" id="1522504">=</span>&nbsp;<span class="num" id="1522506">1.0</span>&nbsp;<span class="op" id="1522510">/</span>&nbsp;<span class="op" id="1522512">(</span><span class="num" id="1522513">1</span>&nbsp;<span class="op" id="1522515">&lt;&lt;</span>&nbsp;<span class="num" id="1522518">28</span><span class="op" id="1522520">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1522533">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522545">Large</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1522554">=</span>&nbsp;<span class="num" id="1522556">1</span>&nbsp;<span class="op" id="1522558">&lt;&lt;</span>&nbsp;<span class="num" id="1522561">28</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1522583">//&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1522593">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1522596">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1522614">if</span>&nbsp;<span class="ident" id="1522617">IsNaN</span><span class="op" id="1522622">(</span><span class="ident" id="1522623">x</span><span class="op" id="1522624">)</span>&nbsp;<span class="op" id="1522626">||</span>&nbsp;<span class="ident" id="1522629">IsInf</span><span class="op" id="1522634">(</span><span class="ident" id="1522635">x</span><span class="op" id="1522636">,</span>&nbsp;<span class="num" id="1522638">0</span><span class="op" id="1522639">)</span>&nbsp;<span class="op" id="1522641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1522645">return</span>&nbsp;<span class="ident" id="1522652">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1522655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522658">sign</span>&nbsp;<span class="op" id="1522663">:=</span>&nbsp;<span class="builtintype" id="1522666">false</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1522673">if</span>&nbsp;<span class="ident" id="1522676">x</span>&nbsp;<span class="op" id="1522678">&lt;</span>&nbsp;<span class="num" id="1522680">0</span>&nbsp;<span class="op" id="1522682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522686">x</span>&nbsp;<span class="op" id="1522688">=</span>&nbsp;<span class="op" id="1522690">-</span><span class="ident" id="1522691">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522695">sign</span>&nbsp;<span class="op" id="1522700">=</span>&nbsp;<span class="builtintype" id="1522702">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1522708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1522711">var</span>&nbsp;<span class="ident" id="1522715">temp</span>&nbsp;<span class="builtintype" id="1522720">float64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1522729">switch</span>&nbsp;<span class="op" id="1522736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1522739">case</span>&nbsp;<span class="ident" id="1522744">x</span>&nbsp;<span class="op" id="1522746">&gt;</span>&nbsp;<span class="ident" id="1522748">Large</span><span class="op" id="1522753">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522757">temp</span>&nbsp;<span class="op" id="1522762">=</span>&nbsp;<span class="ident" id="1522764">Log</span><span class="op" id="1522767">(</span><span class="ident" id="1522768">x</span><span class="op" id="1522769">)</span>&nbsp;<span class="op" id="1522771">+</span>&nbsp;<span class="ident" id="1522773">Ln2</span>&nbsp;<span class="comment" id="1522777">//&nbsp;|x|&nbsp;&gt;&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1522793">case</span>&nbsp;<span class="ident" id="1522798">x</span>&nbsp;<span class="op" id="1522800">&gt;</span>&nbsp;<span class="num" id="1522802">2</span><span class="op" id="1522803">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522807">temp</span>&nbsp;<span class="op" id="1522812">=</span>&nbsp;<span class="ident" id="1522814">Log</span><span class="op" id="1522817">(</span><span class="num" id="1522818">2</span><span class="op" id="1522819">*</span><span class="ident" id="1522820">x</span>&nbsp;<span class="op" id="1522822">+</span>&nbsp;<span class="num" id="1522824">1</span><span class="op" id="1522825">/</span><span class="op" id="1522826">(</span><span class="ident" id="1522827">Sqrt</span><span class="op" id="1522831">(</span><span class="ident" id="1522832">x</span><span class="op" id="1522833">*</span><span class="ident" id="1522834">x</span><span class="op" id="1522835">+</span><span class="num" id="1522836">1</span><span class="op" id="1522837">)</span><span class="op" id="1522838">+</span><span class="ident" id="1522839">x</span><span class="op" id="1522840">)</span><span class="op" id="1522841">)</span>&nbsp;<span class="comment" id="1522843">//&nbsp;2**28&nbsp;&gt;&nbsp;|x|&nbsp;&gt;&nbsp;2.0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1522865">case</span>&nbsp;<span class="ident" id="1522870">x</span>&nbsp;<span class="op" id="1522872">&lt;</span>&nbsp;<span class="ident" id="1522874">NearZero</span><span class="op" id="1522882">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522886">temp</span>&nbsp;<span class="op" id="1522891">=</span>&nbsp;<span class="ident" id="1522893">x</span>&nbsp;<span class="comment" id="1522895">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1522912">default</span><span class="op" id="1522919">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522923">temp</span>&nbsp;<span class="op" id="1522928">=</span>&nbsp;<span class="ident" id="1522930">Log1p</span><span class="op" id="1522935">(</span><span class="ident" id="1522936">x</span>&nbsp;<span class="op" id="1522938">+</span>&nbsp;<span class="ident" id="1522940">x</span><span class="op" id="1522941">*</span><span class="ident" id="1522942">x</span><span class="op" id="1522943">/</span><span class="op" id="1522944">(</span><span class="num" id="1522945">1</span><span class="op" id="1522946">+</span><span class="ident" id="1522947">Sqrt</span><span class="op" id="1522951">(</span><span class="num" id="1522952">1</span><span class="op" id="1522953">+</span><span class="ident" id="1522954">x</span><span class="op" id="1522955">*</span><span class="ident" id="1522956">x</span><span class="op" id="1522957">)</span><span class="op" id="1522958">)</span><span class="op" id="1522959">)</span>&nbsp;<span class="comment" id="1522961">//&nbsp;2.0&nbsp;&gt;&nbsp;|x|&nbsp;&gt;&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1522984">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1522987">if</span>&nbsp;<span class="ident" id="1522990">sign</span>&nbsp;<span class="op" id="1522995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522999">temp</span>&nbsp;<span class="op" id="1523004">=</span>&nbsp;<span class="op" id="1523006">-</span><span class="ident" id="1523007">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1523013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523016">return</span>&nbsp;<span class="ident" id="1523023">temp</span><br>
<span class="lineno"></span><span class="op" id="1523028">}</span>
</div>
</body>
</html>
