<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8187457">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8187512">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8187566">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8187617">package</span>&nbsp;<span class="ident" id="8187625">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8187631">import</span>&nbsp;<span class="op" id="8187638">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8187641">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8187652">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="8187662">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8187665">func</span>&nbsp;<span class="ident" id="8187670">TestConsumeToken</span><span class="op" id="8187686">(</span><span class="ident" id="8187687">t</span>&nbsp;<span class="op" id="8187689">*</span><span class="ident" id="8187690">testing</span><span class="op" id="8187697">.</span><span class="ident" id="8187698">T</span><span class="op" id="8187699">)</span>&nbsp;<span class="op" id="8187701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187704">tests</span>&nbsp;<span class="op" id="8187710">:=</span>&nbsp;<span class="op" id="8187713">[</span><span class="op" id="8187714">...</span><span class="op" id="8187717">]</span><span class="op" id="8187718">[</span><span class="num" id="8187719">3</span><span class="op" id="8187720">]</span><span class="builtintype" id="8187721">string</span><span class="op" id="8187727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187731">{</span><span class="string" id="8187732">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8187741">,</span>&nbsp;<span class="string" id="8187743">&#34;foo&#34;</span><span class="op" id="8187748">,</span>&nbsp;<span class="string" id="8187750">&#34;&nbsp;bar&#34;</span><span class="op" id="8187756">}</span><span class="op" id="8187757">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187761">{</span><span class="string" id="8187762">&#34;bar&#34;</span><span class="op" id="8187767">,</span>&nbsp;<span class="string" id="8187769">&#34;bar&#34;</span><span class="op" id="8187774">,</span>&nbsp;<span class="string" id="8187776">&#34;&#34;</span><span class="op" id="8187778">}</span><span class="op" id="8187779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187783">{</span><span class="string" id="8187784">&#34;&#34;</span><span class="op" id="8187786">,</span>&nbsp;<span class="string" id="8187788">&#34;&#34;</span><span class="op" id="8187790">,</span>&nbsp;<span class="string" id="8187792">&#34;&#34;</span><span class="op" id="8187794">}</span><span class="op" id="8187795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187799">{</span><span class="string" id="8187800">&#34;&nbsp;foo&#34;</span><span class="op" id="8187806">,</span>&nbsp;<span class="string" id="8187808">&#34;&#34;</span><span class="op" id="8187810">,</span>&nbsp;<span class="string" id="8187812">&#34;&nbsp;foo&#34;</span><span class="op" id="8187818">}</span><span class="op" id="8187819">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8187825">for</span>&nbsp;<span class="ident" id="8187829">_</span><span class="op" id="8187830">,</span>&nbsp;<span class="ident" id="8187832">test</span>&nbsp;<span class="op" id="8187837">:=</span>&nbsp;<span class="keyword" id="8187840">range</span>&nbsp;<span class="ident" id="8187846">tests</span>&nbsp;<span class="op" id="8187852">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187856">token</span><span class="op" id="8187861">,</span>&nbsp;<span class="ident" id="8187863">rest</span>&nbsp;<span class="op" id="8187868">:=</span>&nbsp;<span class="ident" id="8187871">consumeToken</span><span class="op" id="8187883">(</span><span class="ident" id="8187884">test</span><span class="op" id="8187888">[</span><span class="num" id="8187889">0</span><span class="op" id="8187890">]</span><span class="op" id="8187891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187895">expectedToken</span>&nbsp;<span class="op" id="8187909">:=</span>&nbsp;<span class="ident" id="8187912">test</span><span class="op" id="8187916">[</span><span class="num" id="8187917">1</span><span class="op" id="8187918">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187922">expectedRest</span>&nbsp;<span class="op" id="8187935">:=</span>&nbsp;<span class="ident" id="8187938">test</span><span class="op" id="8187942">[</span><span class="num" id="8187943">2</span><span class="op" id="8187944">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8187948">if</span>&nbsp;<span class="ident" id="8187951">token</span>&nbsp;<span class="op" id="8187957">!=</span>&nbsp;<span class="ident" id="8187960">expectedToken</span>&nbsp;<span class="op" id="8187974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187979">t</span><span class="op" id="8187980">.</span><span class="ident" id="8187981">Errorf</span><span class="op" id="8187987">(</span><span class="string" id="8187988">&#34;expected&nbsp;to&nbsp;consume&nbsp;token&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="8188040">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188046">expectedToken</span><span class="op" id="8188059">,</span>&nbsp;<span class="ident" id="8188061">token</span><span class="op" id="8188066">,</span>&nbsp;<span class="ident" id="8188068">test</span><span class="op" id="8188072">[</span><span class="num" id="8188073">0</span><span class="op" id="8188074">]</span><span class="op" id="8188075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188079">}</span>&nbsp;<span class="keyword" id="8188081">else</span>&nbsp;<span class="keyword" id="8188086">if</span>&nbsp;<span class="ident" id="8188089">rest</span>&nbsp;<span class="op" id="8188094">!=</span>&nbsp;<span class="ident" id="8188097">expectedRest</span>&nbsp;<span class="op" id="8188110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188115">t</span><span class="op" id="8188116">.</span><span class="ident" id="8188117">Errorf</span><span class="op" id="8188123">(</span><span class="string" id="8188124">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;&#39;%s&#39;,&nbsp;not&nbsp;&#39;%s&#39;&nbsp;after&nbsp;reading&nbsp;token&nbsp;&#39;%s&#39;&nbsp;from&nbsp;&#39;%s&#39;&#34;</span><span class="op" id="8188197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188203">expectedRest</span><span class="op" id="8188215">,</span>&nbsp;<span class="ident" id="8188217">rest</span><span class="op" id="8188221">,</span>&nbsp;<span class="ident" id="8188223">token</span><span class="op" id="8188228">,</span>&nbsp;<span class="ident" id="8188230">test</span><span class="op" id="8188234">[</span><span class="num" id="8188235">0</span><span class="op" id="8188236">]</span><span class="op" id="8188237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188241">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188244">}</span><br>
<span class="lineno"></span><span class="op" id="8188246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8188249">func</span>&nbsp;<span class="ident" id="8188254">TestConsumeValue</span><span class="op" id="8188270">(</span><span class="ident" id="8188271">t</span>&nbsp;<span class="op" id="8188273">*</span><span class="ident" id="8188274">testing</span><span class="op" id="8188281">.</span><span class="ident" id="8188282">T</span><span class="op" id="8188283">)</span>&nbsp;<span class="op" id="8188285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188288">tests</span>&nbsp;<span class="op" id="8188294">:=</span>&nbsp;<span class="op" id="8188297">[</span><span class="op" id="8188298">...</span><span class="op" id="8188301">]</span><span class="op" id="8188302">[</span><span class="num" id="8188303">3</span><span class="op" id="8188304">]</span><span class="builtintype" id="8188305">string</span><span class="op" id="8188311">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188315">{</span><span class="string" id="8188316">&#34;foo&nbsp;bar&#34;</span><span class="op" id="8188325">,</span>&nbsp;<span class="string" id="8188327">&#34;foo&#34;</span><span class="op" id="8188332">,</span>&nbsp;<span class="string" id="8188334">&#34;&nbsp;bar&#34;</span><span class="op" id="8188340">}</span><span class="op" id="8188341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188345">{</span><span class="string" id="8188346">&#34;bar&#34;</span><span class="op" id="8188351">,</span>&nbsp;<span class="string" id="8188353">&#34;bar&#34;</span><span class="op" id="8188358">,</span>&nbsp;<span class="string" id="8188360">&#34;&#34;</span><span class="op" id="8188362">}</span><span class="op" id="8188363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188367">{</span><span class="string" id="8188368">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="8188375">,</span>&nbsp;<span class="string" id="8188377">&#34;&#34;</span><span class="op" id="8188379">,</span>&nbsp;<span class="string" id="8188381">&#34;&nbsp;bar&nbsp;&#34;</span><span class="op" id="8188388">}</span><span class="op" id="8188389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188393">{</span><span class="string" id="8188394">`&#34;My&nbsp;value&#34;end`</span><span class="op" id="8188409">,</span>&nbsp;<span class="string" id="8188411">&#34;My&nbsp;value&#34;</span><span class="op" id="8188421">,</span>&nbsp;<span class="string" id="8188423">&#34;end&#34;</span><span class="op" id="8188428">}</span><span class="op" id="8188429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188433">{</span><span class="string" id="8188434">`&#34;My&nbsp;value&#34;&nbsp;end`</span><span class="op" id="8188450">,</span>&nbsp;<span class="string" id="8188452">&#34;My&nbsp;value&#34;</span><span class="op" id="8188462">,</span>&nbsp;<span class="string" id="8188464">&#34;&nbsp;end&#34;</span><span class="op" id="8188470">}</span><span class="op" id="8188471">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188475">{</span><span class="string" id="8188476">`&#34;\\&#34;&nbsp;rest`</span><span class="op" id="8188487">,</span>&nbsp;<span class="string" id="8188489">&#34;\\&#34;</span><span class="op" id="8188493">,</span>&nbsp;<span class="string" id="8188495">&#34;&nbsp;rest&#34;</span><span class="op" id="8188502">}</span><span class="op" id="8188503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188507">{</span><span class="string" id="8188508">`&#34;My&nbsp;\&#34;&nbsp;value&#34;end`</span><span class="op" id="8188526">,</span>&nbsp;<span class="string" id="8188528">&#34;My&nbsp;\&#34;&nbsp;value&#34;</span><span class="op" id="8188541">,</span>&nbsp;<span class="string" id="8188543">&#34;end&#34;</span><span class="op" id="8188548">}</span><span class="op" id="8188549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188553">{</span><span class="string" id="8188554">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="8188564">,</span>&nbsp;<span class="string" id="8188566">&#34;&#34;</span><span class="op" id="8188568">,</span>&nbsp;<span class="string" id="8188570">`&#34;\&#34;&nbsp;rest`</span><span class="op" id="8188580">}</span><span class="op" id="8188581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8188587">for</span>&nbsp;<span class="ident" id="8188591">_</span><span class="op" id="8188592">,</span>&nbsp;<span class="ident" id="8188594">test</span>&nbsp;<span class="op" id="8188599">:=</span>&nbsp;<span class="keyword" id="8188602">range</span>&nbsp;<span class="ident" id="8188608">tests</span>&nbsp;<span class="op" id="8188614">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188618">value</span><span class="op" id="8188623">,</span>&nbsp;<span class="ident" id="8188625">rest</span>&nbsp;<span class="op" id="8188630">:=</span>&nbsp;<span class="ident" id="8188633">consumeValue</span><span class="op" id="8188645">(</span><span class="ident" id="8188646">test</span><span class="op" id="8188650">[</span><span class="num" id="8188651">0</span><span class="op" id="8188652">]</span><span class="op" id="8188653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188657">expectedValue</span>&nbsp;<span class="op" id="8188671">:=</span>&nbsp;<span class="ident" id="8188674">test</span><span class="op" id="8188678">[</span><span class="num" id="8188679">1</span><span class="op" id="8188680">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188684">expectedRest</span>&nbsp;<span class="op" id="8188697">:=</span>&nbsp;<span class="ident" id="8188700">test</span><span class="op" id="8188704">[</span><span class="num" id="8188705">2</span><span class="op" id="8188706">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8188710">if</span>&nbsp;<span class="ident" id="8188713">value</span>&nbsp;<span class="op" id="8188719">!=</span>&nbsp;<span class="ident" id="8188722">expectedValue</span>&nbsp;<span class="op" id="8188736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188741">t</span><span class="op" id="8188742">.</span><span class="ident" id="8188743">Errorf</span><span class="op" id="8188749">(</span><span class="string" id="8188750">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8188802">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188808">expectedValue</span><span class="op" id="8188821">,</span>&nbsp;<span class="ident" id="8188823">value</span><span class="op" id="8188828">,</span>&nbsp;<span class="ident" id="8188830">test</span><span class="op" id="8188834">[</span><span class="num" id="8188835">0</span><span class="op" id="8188836">]</span><span class="op" id="8188837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188841">}</span>&nbsp;<span class="keyword" id="8188843">else</span>&nbsp;<span class="keyword" id="8188848">if</span>&nbsp;<span class="ident" id="8188851">rest</span>&nbsp;<span class="op" id="8188856">!=</span>&nbsp;<span class="ident" id="8188859">expectedRest</span>&nbsp;<span class="op" id="8188872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188877">t</span><span class="op" id="8188878">.</span><span class="ident" id="8188879">Errorf</span><span class="op" id="8188885">(</span><span class="string" id="8188886">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;value&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8188959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188965">expectedRest</span><span class="op" id="8188977">,</span>&nbsp;<span class="ident" id="8188979">rest</span><span class="op" id="8188983">,</span>&nbsp;<span class="ident" id="8188985">value</span><span class="op" id="8188990">,</span>&nbsp;<span class="ident" id="8188992">test</span><span class="op" id="8188996">[</span><span class="num" id="8188997">0</span><span class="op" id="8188998">]</span><span class="op" id="8188999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189003">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189006">}</span><br>
<span class="lineno"></span><span class="op" id="8189008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8189011">func</span>&nbsp;<span class="ident" id="8189016">TestConsumeMediaParam</span><span class="op" id="8189037">(</span><span class="ident" id="8189038">t</span>&nbsp;<span class="op" id="8189040">*</span><span class="ident" id="8189041">testing</span><span class="op" id="8189048">.</span><span class="ident" id="8189049">T</span><span class="op" id="8189050">)</span>&nbsp;<span class="op" id="8189052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8189055">tests</span>&nbsp;<span class="op" id="8189061">:=</span>&nbsp;<span class="op" id="8189064">[</span><span class="op" id="8189065">...</span><span class="op" id="8189068">]</span><span class="op" id="8189069">[</span><span class="num" id="8189070">4</span><span class="op" id="8189071">]</span><span class="builtintype" id="8189072">string</span><span class="op" id="8189078">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189082">{</span><span class="string" id="8189083">&#34;&nbsp;;&nbsp;foo=bar&#34;</span><span class="op" id="8189095">,</span>&nbsp;<span class="string" id="8189097">&#34;foo&#34;</span><span class="op" id="8189102">,</span>&nbsp;<span class="string" id="8189104">&#34;bar&#34;</span><span class="op" id="8189109">,</span>&nbsp;<span class="string" id="8189111">&#34;&#34;</span><span class="op" id="8189113">}</span><span class="op" id="8189114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189118">{</span><span class="string" id="8189119">&#34;;&nbsp;foo=bar&#34;</span><span class="op" id="8189130">,</span>&nbsp;<span class="string" id="8189132">&#34;foo&#34;</span><span class="op" id="8189137">,</span>&nbsp;<span class="string" id="8189139">&#34;bar&#34;</span><span class="op" id="8189144">,</span>&nbsp;<span class="string" id="8189146">&#34;&#34;</span><span class="op" id="8189148">}</span><span class="op" id="8189149">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189153">{</span><span class="string" id="8189154">&#34;;foo=bar&#34;</span><span class="op" id="8189164">,</span>&nbsp;<span class="string" id="8189166">&#34;foo&#34;</span><span class="op" id="8189171">,</span>&nbsp;<span class="string" id="8189173">&#34;bar&#34;</span><span class="op" id="8189178">,</span>&nbsp;<span class="string" id="8189180">&#34;&#34;</span><span class="op" id="8189182">}</span><span class="op" id="8189183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189187">{</span><span class="string" id="8189188">&#34;;FOO=bar&#34;</span><span class="op" id="8189198">,</span>&nbsp;<span class="string" id="8189200">&#34;foo&#34;</span><span class="op" id="8189205">,</span>&nbsp;<span class="string" id="8189207">&#34;bar&#34;</span><span class="op" id="8189212">,</span>&nbsp;<span class="string" id="8189214">&#34;&#34;</span><span class="op" id="8189216">}</span><span class="op" id="8189217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189221">{</span><span class="string" id="8189222">`;foo=&#34;bar&#34;`</span><span class="op" id="8189234">,</span>&nbsp;<span class="string" id="8189236">&#34;foo&#34;</span><span class="op" id="8189241">,</span>&nbsp;<span class="string" id="8189243">&#34;bar&#34;</span><span class="op" id="8189248">,</span>&nbsp;<span class="string" id="8189250">&#34;&#34;</span><span class="op" id="8189252">}</span><span class="op" id="8189253">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189257">{</span><span class="string" id="8189258">`;foo=&#34;bar&#34;;&nbsp;`</span><span class="op" id="8189272">,</span>&nbsp;<span class="string" id="8189274">&#34;foo&#34;</span><span class="op" id="8189279">,</span>&nbsp;<span class="string" id="8189281">&#34;bar&#34;</span><span class="op" id="8189286">,</span>&nbsp;<span class="string" id="8189288">&#34;;&nbsp;&#34;</span><span class="op" id="8189292">}</span><span class="op" id="8189293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189297">{</span><span class="string" id="8189298">`;foo=&#34;bar&#34;;&nbsp;foo=baz`</span><span class="op" id="8189319">,</span>&nbsp;<span class="string" id="8189321">&#34;foo&#34;</span><span class="op" id="8189326">,</span>&nbsp;<span class="string" id="8189328">&#34;bar&#34;</span><span class="op" id="8189333">,</span>&nbsp;<span class="string" id="8189335">&#34;;&nbsp;foo=baz&#34;</span><span class="op" id="8189346">}</span><span class="op" id="8189347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189351">{</span><span class="string" id="8189352">`&nbsp;;&nbsp;boundary=----CUT;`</span><span class="op" id="8189374">,</span>&nbsp;<span class="string" id="8189376">&#34;boundary&#34;</span><span class="op" id="8189386">,</span>&nbsp;<span class="string" id="8189388">&#34;----CUT&#34;</span><span class="op" id="8189397">,</span>&nbsp;<span class="string" id="8189399">&#34;;&#34;</span><span class="op" id="8189402">}</span><span class="op" id="8189403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189407">{</span><span class="string" id="8189408">`&nbsp;;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8189449">,</span>&nbsp;<span class="string" id="8189451">&#34;key&#34;</span><span class="op" id="8189456">,</span>&nbsp;<span class="string" id="8189458">&#34;value&#34;</span><span class="op" id="8189465">,</span>&nbsp;<span class="string" id="8189467">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8189496">}</span><span class="op" id="8189497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189501">{</span><span class="string" id="8189502">`;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8189531">,</span>&nbsp;<span class="string" id="8189533">&#34;blah&#34;</span><span class="op" id="8189539">,</span>&nbsp;<span class="string" id="8189541">&#34;value&#34;</span><span class="op" id="8189548">,</span>&nbsp;<span class="string" id="8189550">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8189564">}</span><span class="op" id="8189565">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189569">{</span><span class="string" id="8189570">`;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8189584">,</span>&nbsp;<span class="string" id="8189586">&#34;name&#34;</span><span class="op" id="8189592">,</span>&nbsp;<span class="string" id="8189594">&#34;foo&#34;</span><span class="op" id="8189599">,</span>&nbsp;<span class="string" id="8189601">`&nbsp;`</span><span class="op" id="8189604">}</span><span class="op" id="8189605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8189611">for</span>&nbsp;<span class="ident" id="8189615">_</span><span class="op" id="8189616">,</span>&nbsp;<span class="ident" id="8189618">test</span>&nbsp;<span class="op" id="8189623">:=</span>&nbsp;<span class="keyword" id="8189626">range</span>&nbsp;<span class="ident" id="8189632">tests</span>&nbsp;<span class="op" id="8189638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8189642">param</span><span class="op" id="8189647">,</span>&nbsp;<span class="ident" id="8189649">value</span><span class="op" id="8189654">,</span>&nbsp;<span class="ident" id="8189656">rest</span>&nbsp;<span class="op" id="8189661">:=</span>&nbsp;<span class="ident" id="8189664">consumeMediaParam</span><span class="op" id="8189681">(</span><span class="ident" id="8189682">test</span><span class="op" id="8189686">[</span><span class="num" id="8189687">0</span><span class="op" id="8189688">]</span><span class="op" id="8189689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8189693">expectedParam</span>&nbsp;<span class="op" id="8189707">:=</span>&nbsp;<span class="ident" id="8189710">test</span><span class="op" id="8189714">[</span><span class="num" id="8189715">1</span><span class="op" id="8189716">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8189720">expectedValue</span>&nbsp;<span class="op" id="8189734">:=</span>&nbsp;<span class="ident" id="8189737">test</span><span class="op" id="8189741">[</span><span class="num" id="8189742">2</span><span class="op" id="8189743">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8189747">expectedRest</span>&nbsp;<span class="op" id="8189760">:=</span>&nbsp;<span class="ident" id="8189763">test</span><span class="op" id="8189767">[</span><span class="num" id="8189768">3</span><span class="op" id="8189769">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8189773">if</span>&nbsp;<span class="ident" id="8189776">param</span>&nbsp;<span class="op" id="8189782">!=</span>&nbsp;<span class="ident" id="8189785">expectedParam</span>&nbsp;<span class="op" id="8189799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8189804">t</span><span class="op" id="8189805">.</span><span class="ident" id="8189806">Errorf</span><span class="op" id="8189812">(</span><span class="string" id="8189813">&#34;expected&nbsp;to&nbsp;consume&nbsp;param&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8189865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8189871">expectedParam</span><span class="op" id="8189884">,</span>&nbsp;<span class="ident" id="8189886">param</span><span class="op" id="8189891">,</span>&nbsp;<span class="ident" id="8189893">test</span><span class="op" id="8189897">[</span><span class="num" id="8189898">0</span><span class="op" id="8189899">]</span><span class="op" id="8189900">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8189904">}</span>&nbsp;<span class="keyword" id="8189906">else</span>&nbsp;<span class="keyword" id="8189911">if</span>&nbsp;<span class="ident" id="8189914">value</span>&nbsp;<span class="op" id="8189920">!=</span>&nbsp;<span class="ident" id="8189923">expectedValue</span>&nbsp;<span class="op" id="8189937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8189942">t</span><span class="op" id="8189943">.</span><span class="ident" id="8189944">Errorf</span><span class="op" id="8189950">(</span><span class="string" id="8189951">&#34;expected&nbsp;to&nbsp;consume&nbsp;value&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8190003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190009">expectedValue</span><span class="op" id="8190022">,</span>&nbsp;<span class="ident" id="8190024">value</span><span class="op" id="8190029">,</span>&nbsp;<span class="ident" id="8190031">test</span><span class="op" id="8190035">[</span><span class="num" id="8190036">0</span><span class="op" id="8190037">]</span><span class="op" id="8190038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190042">}</span>&nbsp;<span class="keyword" id="8190044">else</span>&nbsp;<span class="keyword" id="8190049">if</span>&nbsp;<span class="ident" id="8190052">rest</span>&nbsp;<span class="op" id="8190057">!=</span>&nbsp;<span class="ident" id="8190060">expectedRest</span>&nbsp;<span class="op" id="8190073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190078">t</span><span class="op" id="8190079">.</span><span class="ident" id="8190080">Errorf</span><span class="op" id="8190086">(</span><span class="string" id="8190087">&#34;expected&nbsp;to&nbsp;have&nbsp;left&nbsp;[%s],&nbsp;not&nbsp;[%s]&nbsp;after&nbsp;reading&nbsp;[%s/%s]&nbsp;from&nbsp;[%s]&#34;</span><span class="op" id="8190157">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190163">expectedRest</span><span class="op" id="8190175">,</span>&nbsp;<span class="ident" id="8190177">rest</span><span class="op" id="8190181">,</span>&nbsp;<span class="ident" id="8190183">param</span><span class="op" id="8190188">,</span>&nbsp;<span class="ident" id="8190190">value</span><span class="op" id="8190195">,</span>&nbsp;<span class="ident" id="8190197">test</span><span class="op" id="8190201">[</span><span class="num" id="8190202">0</span><span class="op" id="8190203">]</span><span class="op" id="8190204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190211">}</span><br>
<span class="lineno"></span><span class="op" id="8190213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="8190216">type</span>&nbsp;<span class="ident" id="8190221">mediaTypeTest</span>&nbsp;<span class="keyword" id="8190235">struct</span>&nbsp;<span class="op" id="8190242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190245">in</span>&nbsp;<span class="builtintype" id="8190248">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190256">t</span>&nbsp;&nbsp;<span class="builtintype" id="8190259">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190267">p</span>&nbsp;&nbsp;<span class="keyword" id="8190270">map</span><span class="op" id="8190273">[</span><span class="builtintype" id="8190274">string</span><span class="op" id="8190280">]</span><span class="builtintype" id="8190281">string</span><br>
<span class="lineno"></span><span class="op" id="8190288">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="8190291">func</span>&nbsp;<span class="ident" id="8190296">TestParseMediaType</span><span class="op" id="8190314">(</span><span class="ident" id="8190315">t</span>&nbsp;<span class="op" id="8190317">*</span><span class="ident" id="8190318">testing</span><span class="op" id="8190325">.</span><span class="ident" id="8190326">T</span><span class="op" id="8190327">)</span>&nbsp;<span class="op" id="8190329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8190332">//&nbsp;Convenience&nbsp;map&nbsp;initializer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190364">m</span>&nbsp;<span class="op" id="8190366">:=</span>&nbsp;<span class="keyword" id="8190369">func</span><span class="op" id="8190373">(</span><span class="ident" id="8190374">s</span>&nbsp;<span class="op" id="8190376">...</span><span class="builtintype" id="8190379">string</span><span class="op" id="8190385">)</span>&nbsp;<span class="keyword" id="8190387">map</span><span class="op" id="8190390">[</span><span class="builtintype" id="8190391">string</span><span class="op" id="8190397">]</span><span class="builtintype" id="8190398">string</span>&nbsp;<span class="op" id="8190405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190409">sm</span>&nbsp;<span class="op" id="8190412">:=</span>&nbsp;<span class="builtinfunc" id="8190415">make</span><span class="op" id="8190419">(</span><span class="keyword" id="8190420">map</span><span class="op" id="8190423">[</span><span class="builtintype" id="8190424">string</span><span class="op" id="8190430">]</span><span class="builtintype" id="8190431">string</span><span class="op" id="8190437">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8190441">for</span>&nbsp;<span class="ident" id="8190445">i</span>&nbsp;<span class="op" id="8190447">:=</span>&nbsp;<span class="num" id="8190450">0</span><span class="op" id="8190451">;</span>&nbsp;<span class="ident" id="8190453">i</span>&nbsp;<span class="op" id="8190455">&lt;</span>&nbsp;<span class="builtinfunc" id="8190457">len</span><span class="op" id="8190460">(</span><span class="ident" id="8190461">s</span><span class="op" id="8190462">)</span><span class="op" id="8190463">;</span>&nbsp;<span class="ident" id="8190465">i</span>&nbsp;<span class="op" id="8190467">+=</span>&nbsp;<span class="num" id="8190470">2</span>&nbsp;<span class="op" id="8190472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190477">sm</span><span class="op" id="8190479">[</span><span class="ident" id="8190480">s</span><span class="op" id="8190481">[</span><span class="ident" id="8190482">i</span><span class="op" id="8190483">]</span><span class="op" id="8190484">]</span>&nbsp;<span class="op" id="8190486">=</span>&nbsp;<span class="ident" id="8190488">s</span><span class="op" id="8190489">[</span><span class="ident" id="8190490">i</span><span class="op" id="8190491">+</span><span class="num" id="8190492">1</span><span class="op" id="8190493">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8190501">return</span>&nbsp;<span class="ident" id="8190508">sm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190512">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190516">nameFoo</span>&nbsp;<span class="op" id="8190524">:=</span>&nbsp;<span class="keyword" id="8190527">map</span><span class="op" id="8190530">[</span><span class="builtintype" id="8190531">string</span><span class="op" id="8190537">]</span><span class="builtintype" id="8190538">string</span><span class="op" id="8190544">{</span><span class="string" id="8190545">&#34;name&#34;</span><span class="op" id="8190551">:</span>&nbsp;<span class="string" id="8190553">&#34;foo&#34;</span><span class="op" id="8190558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190561">tests</span>&nbsp;<span class="op" id="8190567">:=</span>&nbsp;<span class="op" id="8190570">[</span><span class="op" id="8190571">]</span><span class="ident" id="8190572">mediaTypeTest</span><span class="op" id="8190585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190589">{</span><span class="string" id="8190590">`form-data;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8190613">,</span>&nbsp;<span class="string" id="8190615">&#34;form-data&#34;</span><span class="op" id="8190626">,</span>&nbsp;<span class="ident" id="8190628">nameFoo</span><span class="op" id="8190635">}</span><span class="op" id="8190636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190640">{</span><span class="string" id="8190641">`&nbsp;form-data&nbsp;;&nbsp;name=foo`</span><span class="op" id="8190664">,</span>&nbsp;<span class="string" id="8190666">&#34;form-data&#34;</span><span class="op" id="8190677">,</span>&nbsp;<span class="ident" id="8190679">nameFoo</span><span class="op" id="8190686">}</span><span class="op" id="8190687">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190691">{</span><span class="string" id="8190692">`FORM-DATA;name=&#34;foo&#34;`</span><span class="op" id="8190714">,</span>&nbsp;<span class="string" id="8190716">&#34;form-data&#34;</span><span class="op" id="8190727">,</span>&nbsp;<span class="ident" id="8190729">nameFoo</span><span class="op" id="8190736">}</span><span class="op" id="8190737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190741">{</span><span class="string" id="8190742">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8190767">,</span>&nbsp;<span class="string" id="8190769">&#34;form-data&#34;</span><span class="op" id="8190780">,</span>&nbsp;<span class="ident" id="8190782">nameFoo</span><span class="op" id="8190789">}</span><span class="op" id="8190790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190794">{</span><span class="string" id="8190795">`&nbsp;FORM-DATA&nbsp;;&nbsp;name=&#34;foo&#34;`</span><span class="op" id="8190820">,</span>&nbsp;<span class="string" id="8190822">&#34;form-data&#34;</span><span class="op" id="8190833">,</span>&nbsp;<span class="ident" id="8190835">nameFoo</span><span class="op" id="8190842">}</span><span class="op" id="8190843">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190848">{</span><span class="string" id="8190849">`form-data;&nbsp;key=value;&nbsp;&nbsp;blah=&#34;value&#34;;name=&#34;foo&#34;&nbsp;`</span><span class="op" id="8190898">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8190903">&#34;form-data&#34;</span><span class="op" id="8190914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190919">m</span><span class="op" id="8190920">(</span><span class="string" id="8190921">&#34;key&#34;</span><span class="op" id="8190926">,</span>&nbsp;<span class="string" id="8190928">&#34;value&#34;</span><span class="op" id="8190935">,</span>&nbsp;<span class="string" id="8190937">&#34;blah&#34;</span><span class="op" id="8190943">,</span>&nbsp;<span class="string" id="8190945">&#34;value&#34;</span><span class="op" id="8190952">,</span>&nbsp;<span class="string" id="8190954">&#34;name&#34;</span><span class="op" id="8190960">,</span>&nbsp;<span class="string" id="8190962">&#34;foo&#34;</span><span class="op" id="8190967">)</span><span class="op" id="8190968">}</span><span class="op" id="8190969">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190974">{</span><span class="string" id="8190975">`foo;&nbsp;key=val1;&nbsp;key=the-key-appears-again-which-is-bogus`</span><span class="op" id="8191032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8191037">&#34;&#34;</span><span class="op" id="8191039">,</span>&nbsp;<span class="ident" id="8191041">m</span><span class="op" id="8191042">(</span><span class="op" id="8191043">)</span><span class="op" id="8191044">}</span><span class="op" id="8191045">,</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8191050">//&nbsp;From&nbsp;RFC&nbsp;2231:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8191070">{</span><span class="string" id="8191071">`application/x-stuff;&nbsp;title*=us-ascii&#39;en-us&#39;This%20is%20%2A%2A%2Afun%2A%2A%2A`</span><span class="op" id="8191149">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8191154">&#34;application/x-stuff&#34;</span><span class="op" id="8191175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191180">m</span><span class="op" id="8191181">(</span><span class="string" id="8191182">&#34;title&#34;</span><span class="op" id="8191189">,</span>&nbsp;<span class="string" id="8191191">&#34;This&nbsp;is&nbsp;***fun***&#34;</span><span class="op" id="8191210">)</span><span class="op" id="8191211">}</span><span class="op" id="8191212">,</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8191217">{</span><span class="string" id="8191218">`message/external-body;&nbsp;access-type=URL;&nbsp;`</span>&nbsp;<span class="op" id="8191261">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8191266">`URL*0=&#34;ftp://&#34;;`</span>&nbsp;<span class="op" id="8191284">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8191289">`URL*1=&#34;cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;`</span><span class="op" id="8191347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8191352">&#34;message/external-body&#34;</span><span class="op" id="8191375">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191380">m</span><span class="op" id="8191381">(</span><span class="string" id="8191382">&#34;access-type&#34;</span><span class="op" id="8191395">,</span>&nbsp;<span class="string" id="8191397">&#34;URL&#34;</span><span class="op" id="8191402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8191408">&#34;url&#34;</span><span class="op" id="8191413">,</span>&nbsp;<span class="string" id="8191415">&#34;ftp://cs.utk.edu/pub/moore/bulk-mailer/bulk-mailer.tar&#34;</span><span class="op" id="8191471">)</span><span class="op" id="8191472">}</span><span class="op" id="8191473">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8191478">{</span><span class="string" id="8191479">`application/x-stuff;&nbsp;`</span>&nbsp;<span class="op" id="8191503">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8191508">`title*0*=us-ascii&#39;en&#39;This%20is%20even%20more%20;&nbsp;`</span>&nbsp;<span class="op" id="8191560">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8191565">`title*1*=%2A%2A%2Afun%2A%2A%2A%20;&nbsp;`</span>&nbsp;<span class="op" id="8191603">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8191608">`title*2=&#34;isn&#39;t&nbsp;it!&#34;`</span><span class="op" id="8191629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8191634">&#34;application/x-stuff&#34;</span><span class="op" id="8191655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191660">m</span><span class="op" id="8191661">(</span><span class="string" id="8191662">&#34;title&#34;</span><span class="op" id="8191669">,</span>&nbsp;<span class="string" id="8191671">&#34;This&nbsp;is&nbsp;even&nbsp;more&nbsp;***fun***&nbsp;isn&#39;t&nbsp;it!&#34;</span><span class="op" id="8191710">)</span><span class="op" id="8191711">}</span><span class="op" id="8191712">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8191717">//&nbsp;Tests&nbsp;from&nbsp;http://greenbytes.de/tech/tc2231/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8191767">//&nbsp;TODO(bradfitz):&nbsp;add&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;tests&nbsp;from&nbsp;that&nbsp;site.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8191830">{</span><span class="string" id="8191831">`attachment;&nbsp;filename=&#34;f\oo.html&#34;`</span><span class="op" id="8191865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8191870">&#34;attachment&#34;</span><span class="op" id="8191882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191887">m</span><span class="op" id="8191888">(</span><span class="string" id="8191889">&#34;filename&#34;</span><span class="op" id="8191899">,</span>&nbsp;<span class="string" id="8191901">&#34;foo.html&#34;</span><span class="op" id="8191911">)</span><span class="op" id="8191912">}</span><span class="op" id="8191913">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8191917">{</span><span class="string" id="8191918">`attachment;&nbsp;filename=&#34;\&#34;quoting\&#34;&nbsp;tested.html&#34;`</span><span class="op" id="8191966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8191971">&#34;attachment&#34;</span><span class="op" id="8191983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191988">m</span><span class="op" id="8191989">(</span><span class="string" id="8191990">&#34;filename&#34;</span><span class="op" id="8192000">,</span>&nbsp;<span class="string" id="8192002">`&#34;quoting&#34;&nbsp;tested.html`</span><span class="op" id="8192025">)</span><span class="op" id="8192026">}</span><span class="op" id="8192027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192031">{</span><span class="string" id="8192032">`attachment;&nbsp;filename=&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;`</span><span class="op" id="8192081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8192086">&#34;attachment&#34;</span><span class="op" id="8192098">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8192103">m</span><span class="op" id="8192104">(</span><span class="string" id="8192105">&#34;filename&#34;</span><span class="op" id="8192115">,</span>&nbsp;<span class="string" id="8192117">&#34;Here&#39;s&nbsp;a&nbsp;semicolon;.html&#34;</span><span class="op" id="8192143">)</span><span class="op" id="8192144">}</span><span class="op" id="8192145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192149">{</span><span class="string" id="8192150">`attachment;&nbsp;foo=&#34;\&#34;\\&#34;;filename=&#34;foo.html&#34;`</span><span class="op" id="8192194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8192199">&#34;attachment&#34;</span><span class="op" id="8192211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8192216">m</span><span class="op" id="8192217">(</span><span class="string" id="8192218">&#34;foo&#34;</span><span class="op" id="8192223">,</span>&nbsp;<span class="string" id="8192225">&#34;\&#34;\\&#34;</span><span class="op" id="8192231">,</span>&nbsp;<span class="string" id="8192233">&#34;filename&#34;</span><span class="op" id="8192243">,</span>&nbsp;<span class="string" id="8192245">&#34;foo.html&#34;</span><span class="op" id="8192255">)</span><span class="op" id="8192256">}</span><span class="op" id="8192257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192261">{</span><span class="string" id="8192262">`attachment;&nbsp;filename=foo.html`</span><span class="op" id="8192293">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8192298">&#34;attachment&#34;</span><span class="op" id="8192310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8192315">m</span><span class="op" id="8192316">(</span><span class="string" id="8192317">&#34;filename&#34;</span><span class="op" id="8192327">,</span>&nbsp;<span class="string" id="8192329">&#34;foo.html&#34;</span><span class="op" id="8192339">)</span><span class="op" id="8192340">}</span><span class="op" id="8192341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192345">{</span><span class="string" id="8192346">`attachment;&nbsp;filename=foo.html&nbsp;;`</span><span class="op" id="8192379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8192384">&#34;attachment&#34;</span><span class="op" id="8192396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8192401">m</span><span class="op" id="8192402">(</span><span class="string" id="8192403">&#34;filename&#34;</span><span class="op" id="8192413">,</span>&nbsp;<span class="string" id="8192415">&#34;foo.html&#34;</span><span class="op" id="8192425">)</span><span class="op" id="8192426">}</span><span class="op" id="8192427">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192431">{</span><span class="string" id="8192432">`attachment;&nbsp;filename=&#39;foo.html&#39;`</span><span class="op" id="8192465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8192470">&#34;attachment&#34;</span><span class="op" id="8192482">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8192487">m</span><span class="op" id="8192488">(</span><span class="string" id="8192489">&#34;filename&#34;</span><span class="op" id="8192499">,</span>&nbsp;<span class="string" id="8192501">&#34;foo.html&#34;</span><span class="op" id="8192511">)</span><span class="op" id="8192512">}</span><span class="op" id="8192513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192517">{</span><span class="string" id="8192518">`attachment;&nbsp;filename=&#34;foo-%41.html&#34;`</span><span class="op" id="8192555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8192560">&#34;attachment&#34;</span><span class="op" id="8192572">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8192577">m</span><span class="op" id="8192578">(</span><span class="string" id="8192579">&#34;filename&#34;</span><span class="op" id="8192589">,</span>&nbsp;<span class="string" id="8192591">&#34;foo-%41.html&#34;</span><span class="op" id="8192605">)</span><span class="op" id="8192606">}</span><span class="op" id="8192607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192611">{</span><span class="string" id="8192612">`attachment;&nbsp;filename=&#34;foo-%\41.html&#34;`</span><span class="op" id="8192650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8192655">&#34;attachment&#34;</span><span class="op" id="8192667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8192672">m</span><span class="op" id="8192673">(</span><span class="string" id="8192674">&#34;filename&#34;</span><span class="op" id="8192684">,</span>&nbsp;<span class="string" id="8192686">&#34;foo-%41.html&#34;</span><span class="op" id="8192700">)</span><span class="op" id="8192701">}</span><span class="op" id="8192702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192706">{</span><span class="string" id="8192707">`filename=foo.html`</span><span class="op" id="8192726">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8192731">&#34;&#34;</span><span class="op" id="8192733">,</span>&nbsp;<span class="ident" id="8192735">m</span><span class="op" id="8192736">(</span><span class="op" id="8192737">)</span><span class="op" id="8192738">}</span><span class="op" id="8192739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192743">{</span><span class="string" id="8192744">`x=y;&nbsp;filename=foo.html`</span><span class="op" id="8192768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8192773">&#34;&#34;</span><span class="op" id="8192775">,</span>&nbsp;<span class="ident" id="8192777">m</span><span class="op" id="8192778">(</span><span class="op" id="8192779">)</span><span class="op" id="8192780">}</span><span class="op" id="8192781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192785">{</span><span class="string" id="8192786">`&#34;foo;&nbsp;filename=bar;baz&#34;;&nbsp;filename=qux`</span><span class="op" id="8192825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8192830">&#34;&#34;</span><span class="op" id="8192832">,</span>&nbsp;<span class="ident" id="8192834">m</span><span class="op" id="8192835">(</span><span class="op" id="8192836">)</span><span class="op" id="8192837">}</span><span class="op" id="8192838">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192842">{</span><span class="string" id="8192843">`inline;&nbsp;attachment;&nbsp;filename=foo.html`</span><span class="op" id="8192882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8192887">&#34;&#34;</span><span class="op" id="8192889">,</span>&nbsp;<span class="ident" id="8192891">m</span><span class="op" id="8192892">(</span><span class="op" id="8192893">)</span><span class="op" id="8192894">}</span><span class="op" id="8192895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192899">{</span><span class="string" id="8192900">`attachment;&nbsp;filename=&#34;foo.html&#34;.txt`</span><span class="op" id="8192937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8192942">&#34;&#34;</span><span class="op" id="8192944">,</span>&nbsp;<span class="ident" id="8192946">m</span><span class="op" id="8192947">(</span><span class="op" id="8192948">)</span><span class="op" id="8192949">}</span><span class="op" id="8192950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192954">{</span><span class="string" id="8192955">`attachment;&nbsp;filename=&#34;bar`</span><span class="op" id="8192982">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8192987">&#34;&#34;</span><span class="op" id="8192989">,</span>&nbsp;<span class="ident" id="8192991">m</span><span class="op" id="8192992">(</span><span class="op" id="8192993">)</span><span class="op" id="8192994">}</span><span class="op" id="8192995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192999">{</span><span class="string" id="8193000">`attachment;&nbsp;creation-date=&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;`</span><span class="op" id="8193061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8193066">&#34;attachment&#34;</span><span class="op" id="8193078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193083">m</span><span class="op" id="8193084">(</span><span class="string" id="8193085">&#34;creation-date&#34;</span><span class="op" id="8193100">,</span>&nbsp;<span class="string" id="8193102">&#34;Wed,&nbsp;12&nbsp;Feb&nbsp;1997&nbsp;16:29:51&nbsp;-0500&#34;</span><span class="op" id="8193135">)</span><span class="op" id="8193136">}</span><span class="op" id="8193137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193141">{</span><span class="string" id="8193142">`foobar`</span><span class="op" id="8193150">,</span>&nbsp;<span class="string" id="8193152">&#34;foobar&#34;</span><span class="op" id="8193160">,</span>&nbsp;<span class="ident" id="8193162">m</span><span class="op" id="8193163">(</span><span class="op" id="8193164">)</span><span class="op" id="8193165">}</span><span class="op" id="8193166">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193170">{</span><span class="string" id="8193171">`attachment;&nbsp;filename*&nbsp;=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="8193218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8193223">&#34;attachment&#34;</span><span class="op" id="8193235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193240">m</span><span class="op" id="8193241">(</span><span class="string" id="8193242">&#34;filename&#34;</span><span class="op" id="8193252">,</span>&nbsp;<span class="string" id="8193254">&#34;foo-.html&#34;</span><span class="op" id="8193267">)</span><span class="op" id="8193268">}</span><span class="op" id="8193269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193273">{</span><span class="string" id="8193274">`attachment;&nbsp;filename*=UTF-8&#39;&#39;A-%2541.html`</span><span class="op" id="8193317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8193322">&#34;attachment&#34;</span><span class="op" id="8193334">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193339">m</span><span class="op" id="8193340">(</span><span class="string" id="8193341">&#34;filename&#34;</span><span class="op" id="8193351">,</span>&nbsp;<span class="string" id="8193353">&#34;A-%41.html&#34;</span><span class="op" id="8193365">)</span><span class="op" id="8193366">}</span><span class="op" id="8193367">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193371">{</span><span class="string" id="8193372">`attachment;&nbsp;filename*0=&#34;foo.&#34;;&nbsp;filename*1=&#34;html&#34;`</span><span class="op" id="8193422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8193427">&#34;attachment&#34;</span><span class="op" id="8193439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193444">m</span><span class="op" id="8193445">(</span><span class="string" id="8193446">&#34;filename&#34;</span><span class="op" id="8193456">,</span>&nbsp;<span class="string" id="8193458">&#34;foo.html&#34;</span><span class="op" id="8193468">)</span><span class="op" id="8193469">}</span><span class="op" id="8193470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193474">{</span><span class="string" id="8193475">`attachment;&nbsp;filename*0*=UTF-8&#39;&#39;foo-%c3%a4;&nbsp;filename*1=&#34;.html&#34;`</span><span class="op" id="8193538">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8193543">&#34;attachment&#34;</span><span class="op" id="8193555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193560">m</span><span class="op" id="8193561">(</span><span class="string" id="8193562">&#34;filename&#34;</span><span class="op" id="8193572">,</span>&nbsp;<span class="string" id="8193574">&#34;foo-.html&#34;</span><span class="op" id="8193587">)</span><span class="op" id="8193588">}</span><span class="op" id="8193589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193593">{</span><span class="string" id="8193594">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*01=&#34;bar&#34;`</span><span class="op" id="8193643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8193648">&#34;attachment&#34;</span><span class="op" id="8193660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193665">m</span><span class="op" id="8193666">(</span><span class="string" id="8193667">&#34;filename&#34;</span><span class="op" id="8193677">,</span>&nbsp;<span class="string" id="8193679">&#34;foo&#34;</span><span class="op" id="8193684">)</span><span class="op" id="8193685">}</span><span class="op" id="8193686">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193690">{</span><span class="string" id="8193691">`attachment;&nbsp;filename*0=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="8193739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8193744">&#34;attachment&#34;</span><span class="op" id="8193756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193761">m</span><span class="op" id="8193762">(</span><span class="string" id="8193763">&#34;filename&#34;</span><span class="op" id="8193773">,</span>&nbsp;<span class="string" id="8193775">&#34;foo&#34;</span><span class="op" id="8193780">)</span><span class="op" id="8193781">}</span><span class="op" id="8193782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193786">{</span><span class="string" id="8193787">`attachment;&nbsp;filename*1=&#34;foo&#34;;&nbsp;filename*2=&#34;bar&#34;`</span><span class="op" id="8193835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8193840">&#34;attachment&#34;</span><span class="op" id="8193852">,</span>&nbsp;<span class="ident" id="8193854">m</span><span class="op" id="8193855">(</span><span class="op" id="8193856">)</span><span class="op" id="8193857">}</span><span class="op" id="8193858">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193862">{</span><span class="string" id="8193863">`attachment;&nbsp;filename*1=&#34;bar&#34;;&nbsp;filename*0=&#34;foo&#34;`</span><span class="op" id="8193911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8193916">&#34;attachment&#34;</span><span class="op" id="8193928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193933">m</span><span class="op" id="8193934">(</span><span class="string" id="8193935">&#34;filename&#34;</span><span class="op" id="8193945">,</span>&nbsp;<span class="string" id="8193947">&#34;foobar&#34;</span><span class="op" id="8193955">)</span><span class="op" id="8193956">}</span><span class="op" id="8193957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193961">{</span><span class="string" id="8193962">`attachment;&nbsp;filename=&#34;foo-ae.html&#34;;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html`</span><span class="op" id="8194032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8194037">&#34;attachment&#34;</span><span class="op" id="8194049">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194054">m</span><span class="op" id="8194055">(</span><span class="string" id="8194056">&#34;filename&#34;</span><span class="op" id="8194066">,</span>&nbsp;<span class="string" id="8194068">&#34;foo-.html&#34;</span><span class="op" id="8194081">)</span><span class="op" id="8194082">}</span><span class="op" id="8194083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8194087">{</span><span class="string" id="8194088">`attachment;&nbsp;filename*=UTF-8&#39;&#39;foo-%c3%a4.html;&nbsp;filename=&#34;foo-ae.html&#34;`</span><span class="op" id="8194158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8194163">&#34;attachment&#34;</span><span class="op" id="8194175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194180">m</span><span class="op" id="8194181">(</span><span class="string" id="8194182">&#34;filename&#34;</span><span class="op" id="8194192">,</span>&nbsp;<span class="string" id="8194194">&#34;foo-.html&#34;</span><span class="op" id="8194207">)</span><span class="op" id="8194208">}</span><span class="op" id="8194209">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8194214">//&nbsp;Browsers&nbsp;also&nbsp;just&nbsp;send&nbsp;UTF-8&nbsp;directly&nbsp;without&nbsp;RFC&nbsp;2231,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8194276">//&nbsp;at&nbsp;least&nbsp;when&nbsp;the&nbsp;source&nbsp;page&nbsp;is&nbsp;served&nbsp;with&nbsp;UTF-8.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8194333">{</span><span class="string" id="8194334">`form-data;&nbsp;firstname=&#34;&#34;;&nbsp;lastname=&#34;&#34;`</span><span class="op" id="8194398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8194403">&#34;form-data&#34;</span><span class="op" id="8194414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194419">m</span><span class="op" id="8194420">(</span><span class="string" id="8194421">&#34;firstname&#34;</span><span class="op" id="8194432">,</span>&nbsp;<span class="string" id="8194434">&#34;&#34;</span><span class="op" id="8194444">,</span>&nbsp;<span class="string" id="8194446">&#34;lastname&#34;</span><span class="op" id="8194456">,</span>&nbsp;<span class="string" id="8194458">&#34;&#34;</span><span class="op" id="8194478">)</span><span class="op" id="8194479">}</span><span class="op" id="8194480">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8194483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194486">for</span>&nbsp;<span class="ident" id="8194490">_</span><span class="op" id="8194491">,</span>&nbsp;<span class="ident" id="8194493">test</span>&nbsp;<span class="op" id="8194498">:=</span>&nbsp;<span class="keyword" id="8194501">range</span>&nbsp;<span class="ident" id="8194507">tests</span>&nbsp;<span class="op" id="8194513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194517">mt</span><span class="op" id="8194519">,</span>&nbsp;<span class="ident" id="8194521">params</span><span class="op" id="8194527">,</span>&nbsp;<span class="ident" id="8194529">err</span>&nbsp;<span class="op" id="8194533">:=</span>&nbsp;<span class="ident" id="8194536">ParseMediaType</span><span class="op" id="8194550">(</span><span class="ident" id="8194551">test</span><span class="op" id="8194555">.</span><span class="ident" id="8194556">in</span><span class="op" id="8194558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194562">if</span>&nbsp;<span class="ident" id="8194565">err</span>&nbsp;<span class="op" id="8194569">!=</span>&nbsp;<span class="ident" id="8194572">nil</span>&nbsp;<span class="op" id="8194576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194581">if</span>&nbsp;<span class="ident" id="8194584">test</span><span class="op" id="8194588">.</span><span class="ident" id="8194589">t</span>&nbsp;<span class="op" id="8194591">!=</span>&nbsp;<span class="string" id="8194594">&#34;&#34;</span>&nbsp;<span class="op" id="8194597">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194603">t</span><span class="op" id="8194604">.</span><span class="ident" id="8194605">Errorf</span><span class="op" id="8194611">(</span><span class="string" id="8194612">&#34;for&nbsp;input&nbsp;%q,&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8194648">,</span>&nbsp;<span class="ident" id="8194650">test</span><span class="op" id="8194654">.</span><span class="ident" id="8194655">in</span><span class="op" id="8194657">,</span>&nbsp;<span class="ident" id="8194659">err</span><span class="op" id="8194662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194668">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8194680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194685">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8194696">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194700">if</span>&nbsp;<span class="ident" id="8194703">g</span><span class="op" id="8194704">,</span>&nbsp;<span class="ident" id="8194706">e</span>&nbsp;<span class="op" id="8194708">:=</span>&nbsp;<span class="ident" id="8194711">mt</span><span class="op" id="8194713">,</span>&nbsp;<span class="ident" id="8194715">test</span><span class="op" id="8194719">.</span><span class="ident" id="8194720">t</span><span class="op" id="8194721">;</span>&nbsp;<span class="ident" id="8194723">g</span>&nbsp;<span class="op" id="8194725">!=</span>&nbsp;<span class="ident" id="8194728">e</span>&nbsp;<span class="op" id="8194730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194735">t</span><span class="op" id="8194736">.</span><span class="ident" id="8194737">Errorf</span><span class="op" id="8194743">(</span><span class="string" id="8194744">&#34;for&nbsp;input&nbsp;%q,&nbsp;expected&nbsp;type&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8194784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194790">test</span><span class="op" id="8194794">.</span><span class="ident" id="8194795">in</span><span class="op" id="8194797">,</span>&nbsp;<span class="ident" id="8194799">e</span><span class="op" id="8194800">,</span>&nbsp;<span class="ident" id="8194802">g</span><span class="op" id="8194803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194808">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8194819">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194823">if</span>&nbsp;<span class="builtinfunc" id="8194826">len</span><span class="op" id="8194829">(</span><span class="ident" id="8194830">params</span><span class="op" id="8194836">)</span>&nbsp;<span class="op" id="8194838">==</span>&nbsp;<span class="num" id="8194841">0</span>&nbsp;<span class="op" id="8194843">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="8194846">len</span><span class="op" id="8194849">(</span><span class="ident" id="8194850">test</span><span class="op" id="8194854">.</span><span class="ident" id="8194855">p</span><span class="op" id="8194856">)</span>&nbsp;<span class="op" id="8194858">==</span>&nbsp;<span class="num" id="8194861">0</span>&nbsp;<span class="op" id="8194863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194868">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8194879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194883">if</span>&nbsp;<span class="op" id="8194886">!</span><span class="ident" id="8194887">reflect</span><span class="op" id="8194894">.</span><span class="ident" id="8194895">DeepEqual</span><span class="op" id="8194904">(</span><span class="ident" id="8194905">params</span><span class="op" id="8194911">,</span>&nbsp;<span class="ident" id="8194913">test</span><span class="op" id="8194917">.</span><span class="ident" id="8194918">p</span><span class="op" id="8194919">)</span>&nbsp;<span class="op" id="8194921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194926">t</span><span class="op" id="8194927">.</span><span class="ident" id="8194928">Errorf</span><span class="op" id="8194934">(</span><span class="string" id="8194935">&#34;for&nbsp;input&nbsp;%q,&nbsp;wrong&nbsp;params.\n&#34;</span><span class="op" id="8194966">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8194972">&#34;expected:&nbsp;%#v\n&#34;</span><span class="op" id="8194989">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8194995">&#34;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;got:&nbsp;%#v&#34;</span><span class="op" id="8195010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195016">test</span><span class="op" id="8195020">.</span><span class="ident" id="8195021">in</span><span class="op" id="8195023">,</span>&nbsp;<span class="ident" id="8195025">test</span><span class="op" id="8195029">.</span><span class="ident" id="8195030">p</span><span class="op" id="8195031">,</span>&nbsp;<span class="ident" id="8195033">params</span><span class="op" id="8195039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195046">}</span><br>
<span class="lineno">245</span><span class="op" id="8195048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8195051">type</span>&nbsp;<span class="ident" id="8195056">badMediaTypeTest</span>&nbsp;<span class="keyword" id="8195073">struct</span>&nbsp;<span class="op" id="8195080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195083">in</span>&nbsp;&nbsp;<span class="builtintype" id="8195087">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195095">err</span>&nbsp;<span class="builtintype" id="8195099">string</span><br>
<span class="lineno">250</span><span class="op" id="8195106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8195109">var</span>&nbsp;<span class="ident" id="8195113">badMediaTypeTests</span>&nbsp;<span class="op" id="8195131">=</span>&nbsp;<span class="op" id="8195133">[</span><span class="op" id="8195134">]</span><span class="ident" id="8195135">badMediaTypeTest</span><span class="op" id="8195151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195154">{</span><span class="string" id="8195155">&#34;bogus&nbsp;;=========&#34;</span><span class="op" id="8195173">,</span>&nbsp;<span class="string" id="8195175">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="8195206">}</span><span class="op" id="8195207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195210">{</span><span class="string" id="8195211">&#34;bogus/&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="8195241">,</span>&nbsp;<span class="string" id="8195243">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="8195277">}</span><span class="op" id="8195278">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195281">{</span><span class="string" id="8195282">&#34;bogus/bogus&lt;script&gt;alert&lt;/script&gt;&#34;</span><span class="op" id="8195317">,</span>&nbsp;<span class="string" id="8195319">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="8195365">}</span><span class="op" id="8195366">,</span><br>
<span class="lineno"></span><span class="op" id="8195368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8195371">func</span>&nbsp;<span class="ident" id="8195376">TestParseMediaTypeBogus</span><span class="op" id="8195399">(</span><span class="ident" id="8195400">t</span>&nbsp;<span class="op" id="8195402">*</span><span class="ident" id="8195403">testing</span><span class="op" id="8195410">.</span><span class="ident" id="8195411">T</span><span class="op" id="8195412">)</span>&nbsp;<span class="op" id="8195414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195417">for</span>&nbsp;<span class="ident" id="8195421">_</span><span class="op" id="8195422">,</span>&nbsp;<span class="ident" id="8195424">tt</span>&nbsp;<span class="op" id="8195427">:=</span>&nbsp;<span class="keyword" id="8195430">range</span>&nbsp;<span class="ident" id="8195436">badMediaTypeTests</span>&nbsp;<span class="op" id="8195454">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195458">mt</span><span class="op" id="8195460">,</span>&nbsp;<span class="ident" id="8195462">params</span><span class="op" id="8195468">,</span>&nbsp;<span class="ident" id="8195470">err</span>&nbsp;<span class="op" id="8195474">:=</span>&nbsp;<span class="ident" id="8195477">ParseMediaType</span><span class="op" id="8195491">(</span><span class="ident" id="8195492">tt</span><span class="op" id="8195494">.</span><span class="ident" id="8195495">in</span><span class="op" id="8195497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195501">if</span>&nbsp;<span class="ident" id="8195504">err</span>&nbsp;<span class="op" id="8195508">==</span>&nbsp;<span class="ident" id="8195511">nil</span>&nbsp;<span class="op" id="8195515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195520">t</span><span class="op" id="8195521">.</span><span class="ident" id="8195522">Errorf</span><span class="op" id="8195528">(</span><span class="string" id="8195529">&#34;ParseMediaType(%q)&nbsp;=&nbsp;nil&nbsp;error;&nbsp;want&nbsp;parse&nbsp;error&#34;</span><span class="op" id="8195579">,</span>&nbsp;<span class="ident" id="8195581">tt</span><span class="op" id="8195583">.</span><span class="ident" id="8195584">in</span><span class="op" id="8195586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195591">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195602">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195606">if</span>&nbsp;<span class="ident" id="8195609">err</span><span class="op" id="8195612">.</span><span class="ident" id="8195613">Error</span><span class="op" id="8195618">(</span><span class="op" id="8195619">)</span>&nbsp;<span class="op" id="8195621">!=</span>&nbsp;<span class="ident" id="8195624">tt</span><span class="op" id="8195626">.</span><span class="ident" id="8195627">err</span>&nbsp;<span class="op" id="8195631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195636">t</span><span class="op" id="8195637">.</span><span class="ident" id="8195638">Errorf</span><span class="op" id="8195644">(</span><span class="string" id="8195645">&#34;ParseMediaType(%q)&nbsp;=&nbsp;err&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8195683">,</span>&nbsp;<span class="ident" id="8195685">tt</span><span class="op" id="8195687">.</span><span class="ident" id="8195688">in</span><span class="op" id="8195690">,</span>&nbsp;<span class="ident" id="8195692">err</span><span class="op" id="8195695">.</span><span class="ident" id="8195696">Error</span><span class="op" id="8195701">(</span><span class="op" id="8195702">)</span><span class="op" id="8195703">,</span>&nbsp;<span class="ident" id="8195705">tt</span><span class="op" id="8195707">.</span><span class="ident" id="8195708">err</span><span class="op" id="8195711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195719">if</span>&nbsp;<span class="ident" id="8195722">params</span>&nbsp;<span class="op" id="8195729">!=</span>&nbsp;<span class="ident" id="8195732">nil</span>&nbsp;<span class="op" id="8195736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195741">t</span><span class="op" id="8195742">.</span><span class="ident" id="8195743">Errorf</span><span class="op" id="8195749">(</span><span class="string" id="8195750">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-nil&nbsp;params&nbsp;on&nbsp;error&#34;</span><span class="op" id="8195799">,</span>&nbsp;<span class="ident" id="8195801">tt</span><span class="op" id="8195803">.</span><span class="ident" id="8195804">in</span><span class="op" id="8195806">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195814">if</span>&nbsp;<span class="ident" id="8195817">mt</span>&nbsp;<span class="op" id="8195820">!=</span>&nbsp;<span class="string" id="8195823">&#34;&#34;</span>&nbsp;<span class="op" id="8195826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195831">t</span><span class="op" id="8195832">.</span><span class="ident" id="8195833">Errorf</span><span class="op" id="8195839">(</span><span class="string" id="8195840">&#34;ParseMediaType(%q):&nbsp;got&nbsp;non-empty&nbsp;media&nbsp;type&nbsp;string&nbsp;on&nbsp;error&#34;</span><span class="op" id="8195902">,</span>&nbsp;<span class="ident" id="8195904">tt</span><span class="op" id="8195906">.</span><span class="ident" id="8195907">in</span><span class="op" id="8195909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195916">}</span><br>
<span class="lineno">275</span><span class="op" id="8195918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8195921">type</span>&nbsp;<span class="ident" id="8195926">formatTest</span>&nbsp;<span class="keyword" id="8195937">struct</span>&nbsp;<span class="op" id="8195944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195947">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8195954">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195962">params</span>&nbsp;<span class="keyword" id="8195969">map</span><span class="op" id="8195972">[</span><span class="builtintype" id="8195973">string</span><span class="op" id="8195979">]</span><span class="builtintype" id="8195980">string</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195988">want</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8195995">string</span><br>
<span class="lineno"></span><span class="op" id="8196002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8196005">var</span>&nbsp;<span class="ident" id="8196009">formatTests</span>&nbsp;<span class="op" id="8196021">=</span>&nbsp;<span class="op" id="8196023">[</span><span class="op" id="8196024">]</span><span class="ident" id="8196025">formatTest</span><span class="op" id="8196035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196038">{</span><span class="string" id="8196039">&#34;noslash&#34;</span><span class="op" id="8196048">,</span>&nbsp;<span class="ident" id="8196050">nil</span><span class="op" id="8196053">,</span>&nbsp;<span class="string" id="8196055">&#34;&#34;</span><span class="op" id="8196057">}</span><span class="op" id="8196058">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196061">{</span><span class="string" id="8196062">&#34;foo&nbsp;bar/baz&#34;</span><span class="op" id="8196075">,</span>&nbsp;<span class="ident" id="8196077">nil</span><span class="op" id="8196080">,</span>&nbsp;<span class="string" id="8196082">&#34;&#34;</span><span class="op" id="8196084">}</span><span class="op" id="8196085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196088">{</span><span class="string" id="8196089">&#34;foo/bar&nbsp;baz&#34;</span><span class="op" id="8196102">,</span>&nbsp;<span class="ident" id="8196104">nil</span><span class="op" id="8196107">,</span>&nbsp;<span class="string" id="8196109">&#34;&#34;</span><span class="op" id="8196111">}</span><span class="op" id="8196112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196115">{</span><span class="string" id="8196116">&#34;foo/BAR&#34;</span><span class="op" id="8196125">,</span>&nbsp;<span class="ident" id="8196127">nil</span><span class="op" id="8196130">,</span>&nbsp;<span class="string" id="8196132">&#34;foo/bar&#34;</span><span class="op" id="8196141">}</span><span class="op" id="8196142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196145">{</span><span class="string" id="8196146">&#34;foo/BAR&#34;</span><span class="op" id="8196155">,</span>&nbsp;<span class="keyword" id="8196157">map</span><span class="op" id="8196160">[</span><span class="builtintype" id="8196161">string</span><span class="op" id="8196167">]</span><span class="builtintype" id="8196168">string</span><span class="op" id="8196174">{</span><span class="string" id="8196175">&#34;X&#34;</span><span class="op" id="8196178">:</span>&nbsp;<span class="string" id="8196180">&#34;Y&#34;</span><span class="op" id="8196183">}</span><span class="op" id="8196184">,</span>&nbsp;<span class="string" id="8196186">&#34;foo/bar;&nbsp;x=Y&#34;</span><span class="op" id="8196200">}</span><span class="op" id="8196201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196204">{</span><span class="string" id="8196205">&#34;foo/BAR&#34;</span><span class="op" id="8196214">,</span>&nbsp;<span class="keyword" id="8196216">map</span><span class="op" id="8196219">[</span><span class="builtintype" id="8196220">string</span><span class="op" id="8196226">]</span><span class="builtintype" id="8196227">string</span><span class="op" id="8196233">{</span><span class="string" id="8196234">&#34;space&#34;</span><span class="op" id="8196241">:</span>&nbsp;<span class="string" id="8196243">&#34;With&nbsp;space&#34;</span><span class="op" id="8196255">}</span><span class="op" id="8196256">,</span>&nbsp;<span class="string" id="8196258">`foo/bar;&nbsp;space=&#34;With&nbsp;space&#34;`</span><span class="op" id="8196287">}</span><span class="op" id="8196288">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196291">{</span><span class="string" id="8196292">&#34;foo/BAR&#34;</span><span class="op" id="8196301">,</span>&nbsp;<span class="keyword" id="8196303">map</span><span class="op" id="8196306">[</span><span class="builtintype" id="8196307">string</span><span class="op" id="8196313">]</span><span class="builtintype" id="8196314">string</span><span class="op" id="8196320">{</span><span class="string" id="8196321">&#34;quote&#34;</span><span class="op" id="8196328">:</span>&nbsp;<span class="string" id="8196330">`With&nbsp;&#34;quote`</span><span class="op" id="8196343">}</span><span class="op" id="8196344">,</span>&nbsp;<span class="string" id="8196346">`foo/bar;&nbsp;quote=&#34;With&nbsp;\&#34;quote&#34;`</span><span class="op" id="8196377">}</span><span class="op" id="8196378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196381">{</span><span class="string" id="8196382">&#34;foo/BAR&#34;</span><span class="op" id="8196391">,</span>&nbsp;<span class="keyword" id="8196393">map</span><span class="op" id="8196396">[</span><span class="builtintype" id="8196397">string</span><span class="op" id="8196403">]</span><span class="builtintype" id="8196404">string</span><span class="op" id="8196410">{</span><span class="string" id="8196411">&#34;bslash&#34;</span><span class="op" id="8196419">:</span>&nbsp;<span class="string" id="8196421">`With&nbsp;\backslash`</span><span class="op" id="8196438">}</span><span class="op" id="8196439">,</span>&nbsp;<span class="string" id="8196441">`foo/bar;&nbsp;bslash=&#34;With&nbsp;\\backslash&#34;`</span><span class="op" id="8196477">}</span><span class="op" id="8196478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196481">{</span><span class="string" id="8196482">&#34;foo/BAR&#34;</span><span class="op" id="8196491">,</span>&nbsp;<span class="keyword" id="8196493">map</span><span class="op" id="8196496">[</span><span class="builtintype" id="8196497">string</span><span class="op" id="8196503">]</span><span class="builtintype" id="8196504">string</span><span class="op" id="8196510">{</span><span class="string" id="8196511">&#34;both&#34;</span><span class="op" id="8196517">:</span>&nbsp;<span class="string" id="8196519">`With&nbsp;\backslash&nbsp;and&nbsp;&#34;quote`</span><span class="op" id="8196547">}</span><span class="op" id="8196548">,</span>&nbsp;<span class="string" id="8196550">`foo/bar;&nbsp;both=&#34;With&nbsp;\\backslash&nbsp;and&nbsp;\&#34;quote&#34;`</span><span class="op" id="8196596">}</span><span class="op" id="8196597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196600">{</span><span class="string" id="8196601">&#34;foo/BAR&#34;</span><span class="op" id="8196610">,</span>&nbsp;<span class="keyword" id="8196612">map</span><span class="op" id="8196615">[</span><span class="builtintype" id="8196616">string</span><span class="op" id="8196622">]</span><span class="builtintype" id="8196623">string</span><span class="op" id="8196629">{</span><span class="string" id="8196630">&#34;&#34;</span><span class="op" id="8196632">:</span>&nbsp;<span class="string" id="8196634">&#34;empty&nbsp;attribute&#34;</span><span class="op" id="8196651">}</span><span class="op" id="8196652">,</span>&nbsp;<span class="string" id="8196654">&#34;&#34;</span><span class="op" id="8196656">}</span><span class="op" id="8196657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196660">{</span><span class="string" id="8196661">&#34;foo/BAR&#34;</span><span class="op" id="8196670">,</span>&nbsp;<span class="keyword" id="8196672">map</span><span class="op" id="8196675">[</span><span class="builtintype" id="8196676">string</span><span class="op" id="8196682">]</span><span class="builtintype" id="8196683">string</span><span class="op" id="8196689">{</span><span class="string" id="8196690">&#34;bad&nbsp;attribute&#34;</span><span class="op" id="8196705">:</span>&nbsp;<span class="string" id="8196707">&#34;baz&#34;</span><span class="op" id="8196712">}</span><span class="op" id="8196713">,</span>&nbsp;<span class="string" id="8196715">&#34;&#34;</span><span class="op" id="8196717">}</span><span class="op" id="8196718">,</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196721">{</span><span class="string" id="8196722">&#34;foo/BAR&#34;</span><span class="op" id="8196731">,</span>&nbsp;<span class="keyword" id="8196733">map</span><span class="op" id="8196736">[</span><span class="builtintype" id="8196737">string</span><span class="op" id="8196743">]</span><span class="builtintype" id="8196744">string</span><span class="op" id="8196750">{</span><span class="string" id="8196751">&#34;nonascii&#34;</span><span class="op" id="8196761">:</span>&nbsp;<span class="string" id="8196763">&#34;not&nbsp;an&nbsp;ascii&nbsp;character:&nbsp;&#34;</span><span class="op" id="8196791">}</span><span class="op" id="8196792">,</span>&nbsp;<span class="string" id="8196794">&#34;&#34;</span><span class="op" id="8196796">}</span><span class="op" id="8196797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196800">{</span><span class="string" id="8196801">&#34;foo/bar&#34;</span><span class="op" id="8196810">,</span>&nbsp;<span class="keyword" id="8196812">map</span><span class="op" id="8196815">[</span><span class="builtintype" id="8196816">string</span><span class="op" id="8196822">]</span><span class="builtintype" id="8196823">string</span><span class="op" id="8196829">{</span><span class="string" id="8196830">&#34;a&#34;</span><span class="op" id="8196833">:</span>&nbsp;<span class="string" id="8196835">&#34;av&#34;</span><span class="op" id="8196839">,</span>&nbsp;<span class="string" id="8196841">&#34;b&#34;</span><span class="op" id="8196844">:</span>&nbsp;<span class="string" id="8196846">&#34;bv&#34;</span><span class="op" id="8196850">,</span>&nbsp;<span class="string" id="8196852">&#34;c&#34;</span><span class="op" id="8196855">:</span>&nbsp;<span class="string" id="8196857">&#34;cv&#34;</span><span class="op" id="8196861">}</span><span class="op" id="8196862">,</span>&nbsp;<span class="string" id="8196864">&#34;foo/bar;&nbsp;a=av;&nbsp;b=bv;&nbsp;c=cv&#34;</span><span class="op" id="8196891">}</span><span class="op" id="8196892">,</span><br>
<span class="lineno"></span><span class="op" id="8196894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8196897">func</span>&nbsp;<span class="ident" id="8196902">TestFormatMediaType</span><span class="op" id="8196921">(</span><span class="ident" id="8196922">t</span>&nbsp;<span class="op" id="8196924">*</span><span class="ident" id="8196925">testing</span><span class="op" id="8196932">.</span><span class="ident" id="8196933">T</span><span class="op" id="8196934">)</span>&nbsp;<span class="op" id="8196936">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8196939">for</span>&nbsp;<span class="ident" id="8196943">i</span><span class="op" id="8196944">,</span>&nbsp;<span class="ident" id="8196946">tt</span>&nbsp;<span class="op" id="8196949">:=</span>&nbsp;<span class="keyword" id="8196952">range</span>&nbsp;<span class="ident" id="8196958">formatTests</span>&nbsp;<span class="op" id="8196970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196974">got</span>&nbsp;<span class="op" id="8196978">:=</span>&nbsp;<span class="ident" id="8196981">FormatMediaType</span><span class="op" id="8196996">(</span><span class="ident" id="8196997">tt</span><span class="op" id="8196999">.</span><span class="ident" id="8197000">typ</span><span class="op" id="8197003">,</span>&nbsp;<span class="ident" id="8197005">tt</span><span class="op" id="8197007">.</span><span class="ident" id="8197008">params</span><span class="op" id="8197014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8197018">if</span>&nbsp;<span class="ident" id="8197021">got</span>&nbsp;<span class="op" id="8197025">!=</span>&nbsp;<span class="ident" id="8197028">tt</span><span class="op" id="8197030">.</span><span class="ident" id="8197031">want</span>&nbsp;<span class="op" id="8197036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8197041">t</span><span class="op" id="8197042">.</span><span class="ident" id="8197043">Errorf</span><span class="op" id="8197049">(</span><span class="string" id="8197050">&#34;%d.&nbsp;FormatMediaType(%q,&nbsp;%v)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8197093">,</span>&nbsp;<span class="ident" id="8197095">i</span><span class="op" id="8197096">,</span>&nbsp;<span class="ident" id="8197098">tt</span><span class="op" id="8197100">.</span><span class="ident" id="8197101">typ</span><span class="op" id="8197104">,</span>&nbsp;<span class="ident" id="8197106">tt</span><span class="op" id="8197108">.</span><span class="ident" id="8197109">params</span><span class="op" id="8197115">,</span>&nbsp;<span class="ident" id="8197117">got</span><span class="op" id="8197120">,</span>&nbsp;<span class="ident" id="8197122">tt</span><span class="op" id="8197124">.</span><span class="ident" id="8197125">want</span><span class="op" id="8197129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197133">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8197136">}</span><br>
<span class="lineno"></span><span class="op" id="8197138">}</span>
</div>
</body>
</html>
