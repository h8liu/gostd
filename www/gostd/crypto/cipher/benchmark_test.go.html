<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html" class="current">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="119224">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="119279">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="119333">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="119384">package</span>&nbsp;<span class="ident" id="119392">cipher_test</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="119405">import</span>&nbsp;<span class="op" id="119412">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="119415">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="119429">&#34;crypto/cipher&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="119446">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="119456">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="119459">func</span>&nbsp;<span class="ident" id="119464">BenchmarkAESGCMSeal1K</span><span class="op" id="119485">(</span><span class="ident" id="119486">b</span>&nbsp;<span class="op" id="119488">*</span><span class="ident" id="119489">testing</span><span class="op" id="119496">.</span><span class="ident" id="119497">B</span><span class="op" id="119498">)</span>&nbsp;<span class="op" id="119500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="119503">buf</span>&nbsp;<span class="op" id="119507">:=</span>&nbsp;<span class="builtinfunc" id="119510">make</span><span class="op" id="119514">(</span><span class="op" id="119515">[</span><span class="op" id="119516">]</span><span class="builtintype" id="119517">byte</span><span class="op" id="119521">,</span>&nbsp;<span class="num" id="119523">1024</span><span class="op" id="119527">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="119530">b</span><span class="op" id="119531">.</span><span class="ident" id="119532">SetBytes</span><span class="op" id="119540">(</span><span class="ident" id="119541">int64</span><span class="op" id="119546">(</span><span class="builtinfunc" id="119547">len</span><span class="op" id="119550">(</span><span class="ident" id="119551">buf</span><span class="op" id="119554">)</span><span class="op" id="119555">)</span><span class="op" id="119556">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="119560">var</span>&nbsp;<span class="ident" id="119564">key</span>&nbsp;<span class="op" id="119568">[</span><span class="num" id="119569">16</span><span class="op" id="119571">]</span><span class="builtintype" id="119572">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="119578">var</span>&nbsp;<span class="ident" id="119582">nonce</span>&nbsp;<span class="op" id="119588">[</span><span class="num" id="119589">12</span><span class="op" id="119591">]</span><span class="builtintype" id="119592">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="119598">aes</span><span class="op" id="119601">,</span>&nbsp;<span class="ident" id="119603">_</span>&nbsp;<span class="op" id="119605">:=</span>&nbsp;<span class="ident" id="119608">aes</span><span class="op" id="119611">.</span><span class="ident" id="119612">NewCipher</span><span class="op" id="119621">(</span><span class="ident" id="119622">key</span><span class="op" id="119625">[</span><span class="op" id="119626">:</span><span class="op" id="119627">]</span><span class="op" id="119628">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="119631">aesgcm</span><span class="op" id="119637">,</span>&nbsp;<span class="ident" id="119639">_</span>&nbsp;<span class="op" id="119641">:=</span>&nbsp;<span class="ident" id="119644">cipher</span><span class="op" id="119650">.</span><span class="ident" id="119651">NewGCM</span><span class="op" id="119657">(</span><span class="ident" id="119658">aes</span><span class="op" id="119661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="119664">var</span>&nbsp;<span class="ident" id="119668">out</span>&nbsp;<span class="op" id="119672">[</span><span class="op" id="119673">]</span><span class="builtintype" id="119674">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="119681">b</span><span class="op" id="119682">.</span><span class="ident" id="119683">ResetTimer</span><span class="op" id="119693">(</span><span class="op" id="119694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="119697">for</span>&nbsp;<span class="ident" id="119701">i</span>&nbsp;<span class="op" id="119703">:=</span>&nbsp;<span class="num" id="119706">0</span><span class="op" id="119707">;</span>&nbsp;<span class="ident" id="119709">i</span>&nbsp;<span class="op" id="119711">&lt;</span>&nbsp;<span class="ident" id="119713">b</span><span class="op" id="119714">.</span><span class="ident" id="119715">N</span><span class="op" id="119716">;</span>&nbsp;<span class="ident" id="119718">i</span><span class="op" id="119719">++</span>&nbsp;<span class="op" id="119722">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="119726">out</span>&nbsp;<span class="op" id="119730">=</span>&nbsp;<span class="ident" id="119732">aesgcm</span><span class="op" id="119738">.</span><span class="ident" id="119739">Seal</span><span class="op" id="119743">(</span><span class="ident" id="119744">out</span><span class="op" id="119747">[</span><span class="op" id="119748">:</span><span class="num" id="119749">0</span><span class="op" id="119750">]</span><span class="op" id="119751">,</span>&nbsp;<span class="ident" id="119753">nonce</span><span class="op" id="119758">[</span><span class="op" id="119759">:</span><span class="op" id="119760">]</span><span class="op" id="119761">,</span>&nbsp;<span class="ident" id="119763">buf</span><span class="op" id="119766">,</span>&nbsp;<span class="ident" id="119768">nonce</span><span class="op" id="119773">[</span><span class="op" id="119774">:</span><span class="op" id="119775">]</span><span class="op" id="119776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="119779">}</span><br>
<span class="lineno"></span><span class="op" id="119781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="119784">func</span>&nbsp;<span class="ident" id="119789">BenchmarkAESGCMOpen1K</span><span class="op" id="119810">(</span><span class="ident" id="119811">b</span>&nbsp;<span class="op" id="119813">*</span><span class="ident" id="119814">testing</span><span class="op" id="119821">.</span><span class="ident" id="119822">B</span><span class="op" id="119823">)</span>&nbsp;<span class="op" id="119825">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="119828">buf</span>&nbsp;<span class="op" id="119832">:=</span>&nbsp;<span class="builtinfunc" id="119835">make</span><span class="op" id="119839">(</span><span class="op" id="119840">[</span><span class="op" id="119841">]</span><span class="builtintype" id="119842">byte</span><span class="op" id="119846">,</span>&nbsp;<span class="num" id="119848">1024</span><span class="op" id="119852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="119855">b</span><span class="op" id="119856">.</span><span class="ident" id="119857">SetBytes</span><span class="op" id="119865">(</span><span class="ident" id="119866">int64</span><span class="op" id="119871">(</span><span class="builtinfunc" id="119872">len</span><span class="op" id="119875">(</span><span class="ident" id="119876">buf</span><span class="op" id="119879">)</span><span class="op" id="119880">)</span><span class="op" id="119881">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="119885">var</span>&nbsp;<span class="ident" id="119889">key</span>&nbsp;<span class="op" id="119893">[</span><span class="num" id="119894">16</span><span class="op" id="119896">]</span><span class="builtintype" id="119897">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="119903">var</span>&nbsp;<span class="ident" id="119907">nonce</span>&nbsp;<span class="op" id="119913">[</span><span class="num" id="119914">12</span><span class="op" id="119916">]</span><span class="builtintype" id="119917">byte</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="119923">aes</span><span class="op" id="119926">,</span>&nbsp;<span class="ident" id="119928">_</span>&nbsp;<span class="op" id="119930">:=</span>&nbsp;<span class="ident" id="119933">aes</span><span class="op" id="119936">.</span><span class="ident" id="119937">NewCipher</span><span class="op" id="119946">(</span><span class="ident" id="119947">key</span><span class="op" id="119950">[</span><span class="op" id="119951">:</span><span class="op" id="119952">]</span><span class="op" id="119953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="119956">aesgcm</span><span class="op" id="119962">,</span>&nbsp;<span class="ident" id="119964">_</span>&nbsp;<span class="op" id="119966">:=</span>&nbsp;<span class="ident" id="119969">cipher</span><span class="op" id="119975">.</span><span class="ident" id="119976">NewGCM</span><span class="op" id="119982">(</span><span class="ident" id="119983">aes</span><span class="op" id="119986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="119989">var</span>&nbsp;<span class="ident" id="119993">out</span>&nbsp;<span class="op" id="119997">[</span><span class="op" id="119998">]</span><span class="builtintype" id="119999">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120005">out</span>&nbsp;<span class="op" id="120009">=</span>&nbsp;<span class="ident" id="120011">aesgcm</span><span class="op" id="120017">.</span><span class="ident" id="120018">Seal</span><span class="op" id="120022">(</span><span class="ident" id="120023">out</span><span class="op" id="120026">[</span><span class="op" id="120027">:</span><span class="num" id="120028">0</span><span class="op" id="120029">]</span><span class="op" id="120030">,</span>&nbsp;<span class="ident" id="120032">nonce</span><span class="op" id="120037">[</span><span class="op" id="120038">:</span><span class="op" id="120039">]</span><span class="op" id="120040">,</span>&nbsp;<span class="ident" id="120042">buf</span><span class="op" id="120045">,</span>&nbsp;<span class="ident" id="120047">nonce</span><span class="op" id="120052">[</span><span class="op" id="120053">:</span><span class="op" id="120054">]</span><span class="op" id="120055">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120059">b</span><span class="op" id="120060">.</span><span class="ident" id="120061">ResetTimer</span><span class="op" id="120071">(</span><span class="op" id="120072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="120075">for</span>&nbsp;<span class="ident" id="120079">i</span>&nbsp;<span class="op" id="120081">:=</span>&nbsp;<span class="num" id="120084">0</span><span class="op" id="120085">;</span>&nbsp;<span class="ident" id="120087">i</span>&nbsp;<span class="op" id="120089">&lt;</span>&nbsp;<span class="ident" id="120091">b</span><span class="op" id="120092">.</span><span class="ident" id="120093">N</span><span class="op" id="120094">;</span>&nbsp;<span class="ident" id="120096">i</span><span class="op" id="120097">++</span>&nbsp;<span class="op" id="120100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120104">_</span><span class="op" id="120105">,</span>&nbsp;<span class="ident" id="120107">err</span>&nbsp;<span class="op" id="120111">:=</span>&nbsp;<span class="ident" id="120114">aesgcm</span><span class="op" id="120120">.</span><span class="ident" id="120121">Open</span><span class="op" id="120125">(</span><span class="ident" id="120126">buf</span><span class="op" id="120129">[</span><span class="op" id="120130">:</span><span class="num" id="120131">0</span><span class="op" id="120132">]</span><span class="op" id="120133">,</span>&nbsp;<span class="ident" id="120135">nonce</span><span class="op" id="120140">[</span><span class="op" id="120141">:</span><span class="op" id="120142">]</span><span class="op" id="120143">,</span>&nbsp;<span class="ident" id="120145">out</span><span class="op" id="120148">,</span>&nbsp;<span class="ident" id="120150">nonce</span><span class="op" id="120155">[</span><span class="op" id="120156">:</span><span class="op" id="120157">]</span><span class="op" id="120158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="120162">if</span>&nbsp;<span class="ident" id="120165">err</span>&nbsp;<span class="op" id="120169">!=</span>&nbsp;<span class="builtintype" id="120172">nil</span>&nbsp;<span class="op" id="120176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120181">b</span><span class="op" id="120182">.</span><span class="ident" id="120183">Errorf</span><span class="op" id="120189">(</span><span class="string" id="120190">&#34;Open:&nbsp;%v&#34;</span><span class="op" id="120200">,</span>&nbsp;<span class="ident" id="120202">err</span><span class="op" id="120205">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="120209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="120212">}</span><br>
<span class="lineno"></span><span class="op" id="120214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="120217">//&nbsp;If&nbsp;we&nbsp;test&nbsp;exactly&nbsp;1K&nbsp;blocks,&nbsp;we&nbsp;would&nbsp;generate&nbsp;exact&nbsp;multiples&nbsp;of</span><br>
<span class="lineno">50</span><span class="comment" id="120287">//&nbsp;the&nbsp;cipher&#39;s&nbsp;block&nbsp;size,&nbsp;and&nbsp;the&nbsp;cipher&nbsp;stream&nbsp;fragments&nbsp;would</span><br>
<span class="lineno"></span><span class="comment" id="120353">//&nbsp;always&nbsp;be&nbsp;wordsize&nbsp;aligned,&nbsp;whereas&nbsp;non-aligned&nbsp;is&nbsp;a&nbsp;more&nbsp;typical</span><br>
<span class="lineno"></span><span class="comment" id="120422">//&nbsp;use-case.</span><br>
<span class="lineno"></span><span class="keyword" id="120435">const</span>&nbsp;<span class="ident" id="120441">almost1K</span>&nbsp;<span class="op" id="120450">=</span>&nbsp;<span class="num" id="120452">1024</span>&nbsp;<span class="op" id="120457">-</span>&nbsp;<span class="num" id="120459">5</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="120462">func</span>&nbsp;<span class="ident" id="120467">BenchmarkAESCFBEncrypt1K</span><span class="op" id="120491">(</span><span class="ident" id="120492">b</span>&nbsp;<span class="op" id="120494">*</span><span class="ident" id="120495">testing</span><span class="op" id="120502">.</span><span class="ident" id="120503">B</span><span class="op" id="120504">)</span>&nbsp;<span class="op" id="120506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120509">buf</span>&nbsp;<span class="op" id="120513">:=</span>&nbsp;<span class="builtinfunc" id="120516">make</span><span class="op" id="120520">(</span><span class="op" id="120521">[</span><span class="op" id="120522">]</span><span class="builtintype" id="120523">byte</span><span class="op" id="120527">,</span>&nbsp;<span class="ident" id="120529">almost1K</span><span class="op" id="120537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120540">b</span><span class="op" id="120541">.</span><span class="ident" id="120542">SetBytes</span><span class="op" id="120550">(</span><span class="ident" id="120551">int64</span><span class="op" id="120556">(</span><span class="builtinfunc" id="120557">len</span><span class="op" id="120560">(</span><span class="ident" id="120561">buf</span><span class="op" id="120564">)</span><span class="op" id="120565">)</span><span class="op" id="120566">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="120570">var</span>&nbsp;<span class="ident" id="120574">key</span>&nbsp;<span class="op" id="120578">[</span><span class="num" id="120579">16</span><span class="op" id="120581">]</span><span class="builtintype" id="120582">byte</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="120588">var</span>&nbsp;<span class="ident" id="120592">iv</span>&nbsp;<span class="op" id="120595">[</span><span class="num" id="120596">16</span><span class="op" id="120598">]</span><span class="builtintype" id="120599">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120605">aes</span><span class="op" id="120608">,</span>&nbsp;<span class="ident" id="120610">_</span>&nbsp;<span class="op" id="120612">:=</span>&nbsp;<span class="ident" id="120615">aes</span><span class="op" id="120618">.</span><span class="ident" id="120619">NewCipher</span><span class="op" id="120628">(</span><span class="ident" id="120629">key</span><span class="op" id="120632">[</span><span class="op" id="120633">:</span><span class="op" id="120634">]</span><span class="op" id="120635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120638">ctr</span>&nbsp;<span class="op" id="120642">:=</span>&nbsp;<span class="ident" id="120645">cipher</span><span class="op" id="120651">.</span><span class="ident" id="120652">NewCFBEncrypter</span><span class="op" id="120667">(</span><span class="ident" id="120668">aes</span><span class="op" id="120671">,</span>&nbsp;<span class="ident" id="120673">iv</span><span class="op" id="120675">[</span><span class="op" id="120676">:</span><span class="op" id="120677">]</span><span class="op" id="120678">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120682">b</span><span class="op" id="120683">.</span><span class="ident" id="120684">ResetTimer</span><span class="op" id="120694">(</span><span class="op" id="120695">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="120698">for</span>&nbsp;<span class="ident" id="120702">i</span>&nbsp;<span class="op" id="120704">:=</span>&nbsp;<span class="num" id="120707">0</span><span class="op" id="120708">;</span>&nbsp;<span class="ident" id="120710">i</span>&nbsp;<span class="op" id="120712">&lt;</span>&nbsp;<span class="ident" id="120714">b</span><span class="op" id="120715">.</span><span class="ident" id="120716">N</span><span class="op" id="120717">;</span>&nbsp;<span class="ident" id="120719">i</span><span class="op" id="120720">++</span>&nbsp;<span class="op" id="120723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120727">ctr</span><span class="op" id="120730">.</span><span class="ident" id="120731">XORKeyStream</span><span class="op" id="120743">(</span><span class="ident" id="120744">buf</span><span class="op" id="120747">,</span>&nbsp;<span class="ident" id="120749">buf</span><span class="op" id="120752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="120755">}</span><br>
<span class="lineno"></span><span class="op" id="120757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="120760">func</span>&nbsp;<span class="ident" id="120765">BenchmarkAESCFBDecrypt1K</span><span class="op" id="120789">(</span><span class="ident" id="120790">b</span>&nbsp;<span class="op" id="120792">*</span><span class="ident" id="120793">testing</span><span class="op" id="120800">.</span><span class="ident" id="120801">B</span><span class="op" id="120802">)</span>&nbsp;<span class="op" id="120804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120807">buf</span>&nbsp;<span class="op" id="120811">:=</span>&nbsp;<span class="builtinfunc" id="120814">make</span><span class="op" id="120818">(</span><span class="op" id="120819">[</span><span class="op" id="120820">]</span><span class="builtintype" id="120821">byte</span><span class="op" id="120825">,</span>&nbsp;<span class="ident" id="120827">almost1K</span><span class="op" id="120835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120838">b</span><span class="op" id="120839">.</span><span class="ident" id="120840">SetBytes</span><span class="op" id="120848">(</span><span class="ident" id="120849">int64</span><span class="op" id="120854">(</span><span class="builtinfunc" id="120855">len</span><span class="op" id="120858">(</span><span class="ident" id="120859">buf</span><span class="op" id="120862">)</span><span class="op" id="120863">)</span><span class="op" id="120864">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="120868">var</span>&nbsp;<span class="ident" id="120872">key</span>&nbsp;<span class="op" id="120876">[</span><span class="num" id="120877">16</span><span class="op" id="120879">]</span><span class="builtintype" id="120880">byte</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="120886">var</span>&nbsp;<span class="ident" id="120890">iv</span>&nbsp;<span class="op" id="120893">[</span><span class="num" id="120894">16</span><span class="op" id="120896">]</span><span class="builtintype" id="120897">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120903">aes</span><span class="op" id="120906">,</span>&nbsp;<span class="ident" id="120908">_</span>&nbsp;<span class="op" id="120910">:=</span>&nbsp;<span class="ident" id="120913">aes</span><span class="op" id="120916">.</span><span class="ident" id="120917">NewCipher</span><span class="op" id="120926">(</span><span class="ident" id="120927">key</span><span class="op" id="120930">[</span><span class="op" id="120931">:</span><span class="op" id="120932">]</span><span class="op" id="120933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120936">ctr</span>&nbsp;<span class="op" id="120940">:=</span>&nbsp;<span class="ident" id="120943">cipher</span><span class="op" id="120949">.</span><span class="ident" id="120950">NewCFBDecrypter</span><span class="op" id="120965">(</span><span class="ident" id="120966">aes</span><span class="op" id="120969">,</span>&nbsp;<span class="ident" id="120971">iv</span><span class="op" id="120973">[</span><span class="op" id="120974">:</span><span class="op" id="120975">]</span><span class="op" id="120976">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="120980">b</span><span class="op" id="120981">.</span><span class="ident" id="120982">ResetTimer</span><span class="op" id="120992">(</span><span class="op" id="120993">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="120996">for</span>&nbsp;<span class="ident" id="121000">i</span>&nbsp;<span class="op" id="121002">:=</span>&nbsp;<span class="num" id="121005">0</span><span class="op" id="121006">;</span>&nbsp;<span class="ident" id="121008">i</span>&nbsp;<span class="op" id="121010">&lt;</span>&nbsp;<span class="ident" id="121012">b</span><span class="op" id="121013">.</span><span class="ident" id="121014">N</span><span class="op" id="121015">;</span>&nbsp;<span class="ident" id="121017">i</span><span class="op" id="121018">++</span>&nbsp;<span class="op" id="121021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121025">ctr</span><span class="op" id="121028">.</span><span class="ident" id="121029">XORKeyStream</span><span class="op" id="121041">(</span><span class="ident" id="121042">buf</span><span class="op" id="121045">,</span>&nbsp;<span class="ident" id="121047">buf</span><span class="op" id="121050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="121053">}</span><br>
<span class="lineno"></span><span class="op" id="121055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="121058">func</span>&nbsp;<span class="ident" id="121063">BenchmarkAESOFB1K</span><span class="op" id="121080">(</span><span class="ident" id="121081">b</span>&nbsp;<span class="op" id="121083">*</span><span class="ident" id="121084">testing</span><span class="op" id="121091">.</span><span class="ident" id="121092">B</span><span class="op" id="121093">)</span>&nbsp;<span class="op" id="121095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121098">buf</span>&nbsp;<span class="op" id="121102">:=</span>&nbsp;<span class="builtinfunc" id="121105">make</span><span class="op" id="121109">(</span><span class="op" id="121110">[</span><span class="op" id="121111">]</span><span class="builtintype" id="121112">byte</span><span class="op" id="121116">,</span>&nbsp;<span class="ident" id="121118">almost1K</span><span class="op" id="121126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121129">b</span><span class="op" id="121130">.</span><span class="ident" id="121131">SetBytes</span><span class="op" id="121139">(</span><span class="ident" id="121140">int64</span><span class="op" id="121145">(</span><span class="builtinfunc" id="121146">len</span><span class="op" id="121149">(</span><span class="ident" id="121150">buf</span><span class="op" id="121153">)</span><span class="op" id="121154">)</span><span class="op" id="121155">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="121159">var</span>&nbsp;<span class="ident" id="121163">key</span>&nbsp;<span class="op" id="121167">[</span><span class="num" id="121168">16</span><span class="op" id="121170">]</span><span class="builtintype" id="121171">byte</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="121177">var</span>&nbsp;<span class="ident" id="121181">iv</span>&nbsp;<span class="op" id="121184">[</span><span class="num" id="121185">16</span><span class="op" id="121187">]</span><span class="builtintype" id="121188">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121194">aes</span><span class="op" id="121197">,</span>&nbsp;<span class="ident" id="121199">_</span>&nbsp;<span class="op" id="121201">:=</span>&nbsp;<span class="ident" id="121204">aes</span><span class="op" id="121207">.</span><span class="ident" id="121208">NewCipher</span><span class="op" id="121217">(</span><span class="ident" id="121218">key</span><span class="op" id="121221">[</span><span class="op" id="121222">:</span><span class="op" id="121223">]</span><span class="op" id="121224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121227">ctr</span>&nbsp;<span class="op" id="121231">:=</span>&nbsp;<span class="ident" id="121234">cipher</span><span class="op" id="121240">.</span><span class="ident" id="121241">NewOFB</span><span class="op" id="121247">(</span><span class="ident" id="121248">aes</span><span class="op" id="121251">,</span>&nbsp;<span class="ident" id="121253">iv</span><span class="op" id="121255">[</span><span class="op" id="121256">:</span><span class="op" id="121257">]</span><span class="op" id="121258">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121262">b</span><span class="op" id="121263">.</span><span class="ident" id="121264">ResetTimer</span><span class="op" id="121274">(</span><span class="op" id="121275">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="121278">for</span>&nbsp;<span class="ident" id="121282">i</span>&nbsp;<span class="op" id="121284">:=</span>&nbsp;<span class="num" id="121287">0</span><span class="op" id="121288">;</span>&nbsp;<span class="ident" id="121290">i</span>&nbsp;<span class="op" id="121292">&lt;</span>&nbsp;<span class="ident" id="121294">b</span><span class="op" id="121295">.</span><span class="ident" id="121296">N</span><span class="op" id="121297">;</span>&nbsp;<span class="ident" id="121299">i</span><span class="op" id="121300">++</span>&nbsp;<span class="op" id="121303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121307">ctr</span><span class="op" id="121310">.</span><span class="ident" id="121311">XORKeyStream</span><span class="op" id="121323">(</span><span class="ident" id="121324">buf</span><span class="op" id="121327">,</span>&nbsp;<span class="ident" id="121329">buf</span><span class="op" id="121332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="121335">}</span><br>
<span class="lineno"></span><span class="op" id="121337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="121340">func</span>&nbsp;<span class="ident" id="121345">BenchmarkAESCTR1K</span><span class="op" id="121362">(</span><span class="ident" id="121363">b</span>&nbsp;<span class="op" id="121365">*</span><span class="ident" id="121366">testing</span><span class="op" id="121373">.</span><span class="ident" id="121374">B</span><span class="op" id="121375">)</span>&nbsp;<span class="op" id="121377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121380">buf</span>&nbsp;<span class="op" id="121384">:=</span>&nbsp;<span class="builtinfunc" id="121387">make</span><span class="op" id="121391">(</span><span class="op" id="121392">[</span><span class="op" id="121393">]</span><span class="builtintype" id="121394">byte</span><span class="op" id="121398">,</span>&nbsp;<span class="ident" id="121400">almost1K</span><span class="op" id="121408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121411">b</span><span class="op" id="121412">.</span><span class="ident" id="121413">SetBytes</span><span class="op" id="121421">(</span><span class="ident" id="121422">int64</span><span class="op" id="121427">(</span><span class="builtinfunc" id="121428">len</span><span class="op" id="121431">(</span><span class="ident" id="121432">buf</span><span class="op" id="121435">)</span><span class="op" id="121436">)</span><span class="op" id="121437">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="121441">var</span>&nbsp;<span class="ident" id="121445">key</span>&nbsp;<span class="op" id="121449">[</span><span class="num" id="121450">16</span><span class="op" id="121452">]</span><span class="builtintype" id="121453">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="121459">var</span>&nbsp;<span class="ident" id="121463">iv</span>&nbsp;<span class="op" id="121466">[</span><span class="num" id="121467">16</span><span class="op" id="121469">]</span><span class="builtintype" id="121470">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121476">aes</span><span class="op" id="121479">,</span>&nbsp;<span class="ident" id="121481">_</span>&nbsp;<span class="op" id="121483">:=</span>&nbsp;<span class="ident" id="121486">aes</span><span class="op" id="121489">.</span><span class="ident" id="121490">NewCipher</span><span class="op" id="121499">(</span><span class="ident" id="121500">key</span><span class="op" id="121503">[</span><span class="op" id="121504">:</span><span class="op" id="121505">]</span><span class="op" id="121506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121509">ctr</span>&nbsp;<span class="op" id="121513">:=</span>&nbsp;<span class="ident" id="121516">cipher</span><span class="op" id="121522">.</span><span class="ident" id="121523">NewCTR</span><span class="op" id="121529">(</span><span class="ident" id="121530">aes</span><span class="op" id="121533">,</span>&nbsp;<span class="ident" id="121535">iv</span><span class="op" id="121537">[</span><span class="op" id="121538">:</span><span class="op" id="121539">]</span><span class="op" id="121540">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121544">b</span><span class="op" id="121545">.</span><span class="ident" id="121546">ResetTimer</span><span class="op" id="121556">(</span><span class="op" id="121557">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="121560">for</span>&nbsp;<span class="ident" id="121564">i</span>&nbsp;<span class="op" id="121566">:=</span>&nbsp;<span class="num" id="121569">0</span><span class="op" id="121570">;</span>&nbsp;<span class="ident" id="121572">i</span>&nbsp;<span class="op" id="121574">&lt;</span>&nbsp;<span class="ident" id="121576">b</span><span class="op" id="121577">.</span><span class="ident" id="121578">N</span><span class="op" id="121579">;</span>&nbsp;<span class="ident" id="121581">i</span><span class="op" id="121582">++</span>&nbsp;<span class="op" id="121585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121589">ctr</span><span class="op" id="121592">.</span><span class="ident" id="121593">XORKeyStream</span><span class="op" id="121605">(</span><span class="ident" id="121606">buf</span><span class="op" id="121609">,</span>&nbsp;<span class="ident" id="121611">buf</span><span class="op" id="121614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="121617">}</span><br>
<span class="lineno"></span><span class="op" id="121619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="121622">func</span>&nbsp;<span class="ident" id="121627">BenchmarkAESCBCEncrypt1K</span><span class="op" id="121651">(</span><span class="ident" id="121652">b</span>&nbsp;<span class="op" id="121654">*</span><span class="ident" id="121655">testing</span><span class="op" id="121662">.</span><span class="ident" id="121663">B</span><span class="op" id="121664">)</span>&nbsp;<span class="op" id="121666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121669">buf</span>&nbsp;<span class="op" id="121673">:=</span>&nbsp;<span class="builtinfunc" id="121676">make</span><span class="op" id="121680">(</span><span class="op" id="121681">[</span><span class="op" id="121682">]</span><span class="builtintype" id="121683">byte</span><span class="op" id="121687">,</span>&nbsp;<span class="num" id="121689">1024</span><span class="op" id="121693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121696">b</span><span class="op" id="121697">.</span><span class="ident" id="121698">SetBytes</span><span class="op" id="121706">(</span><span class="ident" id="121707">int64</span><span class="op" id="121712">(</span><span class="builtinfunc" id="121713">len</span><span class="op" id="121716">(</span><span class="ident" id="121717">buf</span><span class="op" id="121720">)</span><span class="op" id="121721">)</span><span class="op" id="121722">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="121726">var</span>&nbsp;<span class="ident" id="121730">key</span>&nbsp;<span class="op" id="121734">[</span><span class="num" id="121735">16</span><span class="op" id="121737">]</span><span class="builtintype" id="121738">byte</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="121744">var</span>&nbsp;<span class="ident" id="121748">iv</span>&nbsp;<span class="op" id="121751">[</span><span class="num" id="121752">16</span><span class="op" id="121754">]</span><span class="builtintype" id="121755">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121761">aes</span><span class="op" id="121764">,</span>&nbsp;<span class="ident" id="121766">_</span>&nbsp;<span class="op" id="121768">:=</span>&nbsp;<span class="ident" id="121771">aes</span><span class="op" id="121774">.</span><span class="ident" id="121775">NewCipher</span><span class="op" id="121784">(</span><span class="ident" id="121785">key</span><span class="op" id="121788">[</span><span class="op" id="121789">:</span><span class="op" id="121790">]</span><span class="op" id="121791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121794">cbc</span>&nbsp;<span class="op" id="121798">:=</span>&nbsp;<span class="ident" id="121801">cipher</span><span class="op" id="121807">.</span><span class="ident" id="121808">NewCBCEncrypter</span><span class="op" id="121823">(</span><span class="ident" id="121824">aes</span><span class="op" id="121827">,</span>&nbsp;<span class="ident" id="121829">iv</span><span class="op" id="121831">[</span><span class="op" id="121832">:</span><span class="op" id="121833">]</span><span class="op" id="121834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="121837">for</span>&nbsp;<span class="ident" id="121841">i</span>&nbsp;<span class="op" id="121843">:=</span>&nbsp;<span class="num" id="121846">0</span><span class="op" id="121847">;</span>&nbsp;<span class="ident" id="121849">i</span>&nbsp;<span class="op" id="121851">&lt;</span>&nbsp;<span class="ident" id="121853">b</span><span class="op" id="121854">.</span><span class="ident" id="121855">N</span><span class="op" id="121856">;</span>&nbsp;<span class="ident" id="121858">i</span><span class="op" id="121859">++</span>&nbsp;<span class="op" id="121862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121866">cbc</span><span class="op" id="121869">.</span><span class="ident" id="121870">CryptBlocks</span><span class="op" id="121881">(</span><span class="ident" id="121882">buf</span><span class="op" id="121885">,</span>&nbsp;<span class="ident" id="121887">buf</span><span class="op" id="121890">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="121893">}</span><br>
<span class="lineno"></span><span class="op" id="121895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="121898">func</span>&nbsp;<span class="ident" id="121903">BenchmarkAESCBCDecrypt1K</span><span class="op" id="121927">(</span><span class="ident" id="121928">b</span>&nbsp;<span class="op" id="121930">*</span><span class="ident" id="121931">testing</span><span class="op" id="121938">.</span><span class="ident" id="121939">B</span><span class="op" id="121940">)</span>&nbsp;<span class="op" id="121942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121945">buf</span>&nbsp;<span class="op" id="121949">:=</span>&nbsp;<span class="builtinfunc" id="121952">make</span><span class="op" id="121956">(</span><span class="op" id="121957">[</span><span class="op" id="121958">]</span><span class="builtintype" id="121959">byte</span><span class="op" id="121963">,</span>&nbsp;<span class="num" id="121965">1024</span><span class="op" id="121969">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="121972">b</span><span class="op" id="121973">.</span><span class="ident" id="121974">SetBytes</span><span class="op" id="121982">(</span><span class="ident" id="121983">int64</span><span class="op" id="121988">(</span><span class="builtinfunc" id="121989">len</span><span class="op" id="121992">(</span><span class="ident" id="121993">buf</span><span class="op" id="121996">)</span><span class="op" id="121997">)</span><span class="op" id="121998">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="122002">var</span>&nbsp;<span class="ident" id="122006">key</span>&nbsp;<span class="op" id="122010">[</span><span class="num" id="122011">16</span><span class="op" id="122013">]</span><span class="builtintype" id="122014">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="122020">var</span>&nbsp;<span class="ident" id="122024">iv</span>&nbsp;<span class="op" id="122027">[</span><span class="num" id="122028">16</span><span class="op" id="122030">]</span><span class="builtintype" id="122031">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="122037">aes</span><span class="op" id="122040">,</span>&nbsp;<span class="ident" id="122042">_</span>&nbsp;<span class="op" id="122044">:=</span>&nbsp;<span class="ident" id="122047">aes</span><span class="op" id="122050">.</span><span class="ident" id="122051">NewCipher</span><span class="op" id="122060">(</span><span class="ident" id="122061">key</span><span class="op" id="122064">[</span><span class="op" id="122065">:</span><span class="op" id="122066">]</span><span class="op" id="122067">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="122070">cbc</span>&nbsp;<span class="op" id="122074">:=</span>&nbsp;<span class="ident" id="122077">cipher</span><span class="op" id="122083">.</span><span class="ident" id="122084">NewCBCDecrypter</span><span class="op" id="122099">(</span><span class="ident" id="122100">aes</span><span class="op" id="122103">,</span>&nbsp;<span class="ident" id="122105">iv</span><span class="op" id="122107">[</span><span class="op" id="122108">:</span><span class="op" id="122109">]</span><span class="op" id="122110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="122113">for</span>&nbsp;<span class="ident" id="122117">i</span>&nbsp;<span class="op" id="122119">:=</span>&nbsp;<span class="num" id="122122">0</span><span class="op" id="122123">;</span>&nbsp;<span class="ident" id="122125">i</span>&nbsp;<span class="op" id="122127">&lt;</span>&nbsp;<span class="ident" id="122129">b</span><span class="op" id="122130">.</span><span class="ident" id="122131">N</span><span class="op" id="122132">;</span>&nbsp;<span class="ident" id="122134">i</span><span class="op" id="122135">++</span>&nbsp;<span class="op" id="122138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="122142">cbc</span><span class="op" id="122145">.</span><span class="ident" id="122146">CryptBlocks</span><span class="op" id="122157">(</span><span class="ident" id="122158">buf</span><span class="op" id="122161">,</span>&nbsp;<span class="ident" id="122163">buf</span><span class="op" id="122166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="122169">}</span><br>
<span class="lineno"></span><span class="op" id="122171">}</span>
</div>
</body>
</html>
