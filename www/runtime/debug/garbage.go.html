<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2968150">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2968206">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2968260">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2968311">package</span>&nbsp;<span class="ident" id="2968319">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2968326">import</span>&nbsp;<span class="op" id="2968333">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2968336">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2968347">&#34;sort&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2968355">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="2968362">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2968365">//&nbsp;GCStats&nbsp;collect&nbsp;information&nbsp;about&nbsp;recent&nbsp;garbage&nbsp;collections.</span><br>
<span class="lineno"></span><span class="keyword" id="2968430">type</span>&nbsp;<span class="ident" id="2968435">GCStats</span>&nbsp;<span class="keyword" id="2968443">struct</span>&nbsp;<span class="op" id="2968450">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968453">LastGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2968468">time</span><span class="op" id="2968472">.</span><span class="ident" id="2968473">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2968484">//&nbsp;time&nbsp;of&nbsp;last&nbsp;collection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968512">NumGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2968527">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2968543">//&nbsp;number&nbsp;of&nbsp;garbage&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968577">PauseTotal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2968592">time</span><span class="op" id="2968596">.</span><span class="ident" id="2968597">Duration</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2968608">//&nbsp;total&nbsp;pause&nbsp;for&nbsp;all&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968644">Pause</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2968659">[</span><span class="op" id="2968660">]</span><span class="ident" id="2968661">time</span><span class="op" id="2968665">.</span><span class="ident" id="2968666">Duration</span>&nbsp;<span class="comment" id="2968675">//&nbsp;pause&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968712">PauseEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2968727">[</span><span class="op" id="2968728">]</span><span class="ident" id="2968729">time</span><span class="op" id="2968733">.</span><span class="ident" id="2968734">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2968743">//&nbsp;pause&nbsp;end&nbsp;times&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2968790">PauseQuantiles</span>&nbsp;<span class="op" id="2968805">[</span><span class="op" id="2968806">]</span><span class="ident" id="2968807">time</span><span class="op" id="2968811">.</span><span class="ident" id="2968812">Duration</span><br>
<span class="lineno"></span><span class="op" id="2968821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2968824">//&nbsp;ReadGCStats&nbsp;reads&nbsp;statistics&nbsp;about&nbsp;garbage&nbsp;collection&nbsp;into&nbsp;stats.</span><br>
<span class="lineno"></span><span class="comment" id="2968893">//&nbsp;The&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;pause&nbsp;history&nbsp;is&nbsp;system-dependent;</span><br>
<span class="lineno">25</span><span class="comment" id="2968960">//&nbsp;stats.Pause&nbsp;slice&nbsp;will&nbsp;be&nbsp;reused&nbsp;if&nbsp;large&nbsp;enough,&nbsp;reallocated&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="2969036">//&nbsp;ReadGCStats&nbsp;may&nbsp;use&nbsp;the&nbsp;full&nbsp;capacity&nbsp;of&nbsp;the&nbsp;stats.Pause&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="2969103">//&nbsp;If&nbsp;stats.PauseQuantiles&nbsp;is&nbsp;non-empty,&nbsp;ReadGCStats&nbsp;fills&nbsp;it&nbsp;with&nbsp;quantiles</span><br>
<span class="lineno"></span><span class="comment" id="2969180">//&nbsp;summarizing&nbsp;the&nbsp;distribution&nbsp;of&nbsp;pause&nbsp;time.&nbsp;For&nbsp;example,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2969243">//&nbsp;len(stats.PauseQuantiles)&nbsp;is&nbsp;5,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with&nbsp;the&nbsp;minimum,</span><br>
<span class="lineno">30</span><span class="comment" id="2969314">//&nbsp;25%,&nbsp;50%,&nbsp;75%,&nbsp;and&nbsp;maximum&nbsp;pause&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="2969357">func</span>&nbsp;<span class="ident" id="2969362">ReadGCStats</span><span class="op" id="2969373">(</span><span class="ident" id="2969374">stats</span>&nbsp;<span class="op" id="2969380">*</span><span class="ident" id="2969381">GCStats</span><span class="op" id="2969388">)</span>&nbsp;<span class="op" id="2969390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2969393">//&nbsp;Create&nbsp;a&nbsp;buffer&nbsp;with&nbsp;space&nbsp;for&nbsp;at&nbsp;least&nbsp;two&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2969455">//&nbsp;pause&nbsp;history&nbsp;tracked&nbsp;by&nbsp;the&nbsp;runtime.&nbsp;One&nbsp;will&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2969518">//&nbsp;to&nbsp;the&nbsp;caller&nbsp;and&nbsp;the&nbsp;other&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;transfer&nbsp;buffer</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2969582">//&nbsp;for&nbsp;end&nbsp;times&nbsp;history&nbsp;and&nbsp;as&nbsp;a&nbsp;temporary&nbsp;buffer&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2969638">//&nbsp;computing&nbsp;quantiles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2969663">const</span>&nbsp;<span class="ident" id="2969669">maxPause</span>&nbsp;<span class="op" id="2969678">=</span>&nbsp;<span class="builtinfunc" id="2969680">len</span><span class="op" id="2969683">(</span><span class="op" id="2969684">(</span><span class="op" id="2969685">(</span><span class="op" id="2969686">*</span><span class="ident" id="2969687">runtime</span><span class="op" id="2969694">.</span><span class="ident" id="2969695">MemStats</span><span class="op" id="2969703">)</span><span class="op" id="2969704">(</span><span class="ident" id="2969705">nil</span><span class="op" id="2969708">)</span><span class="op" id="2969709">)</span><span class="op" id="2969710">.</span><span class="ident" id="2969711">PauseNs</span><span class="op" id="2969718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2969721">if</span>&nbsp;<span class="builtinfunc" id="2969724">cap</span><span class="op" id="2969727">(</span><span class="ident" id="2969728">stats</span><span class="op" id="2969733">.</span><span class="ident" id="2969734">Pause</span><span class="op" id="2969739">)</span>&nbsp;<span class="op" id="2969741">&lt;</span>&nbsp;<span class="num" id="2969743">2</span><span class="op" id="2969744">*</span><span class="ident" id="2969745">maxPause</span><span class="op" id="2969753">+</span><span class="num" id="2969754">3</span>&nbsp;<span class="op" id="2969756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2969760">stats</span><span class="op" id="2969765">.</span><span class="ident" id="2969766">Pause</span>&nbsp;<span class="op" id="2969772">=</span>&nbsp;<span class="builtinfunc" id="2969774">make</span><span class="op" id="2969778">(</span><span class="op" id="2969779">[</span><span class="op" id="2969780">]</span><span class="ident" id="2969781">time</span><span class="op" id="2969785">.</span><span class="ident" id="2969786">Duration</span><span class="op" id="2969794">,</span>&nbsp;<span class="num" id="2969796">2</span><span class="op" id="2969797">*</span><span class="ident" id="2969798">maxPause</span><span class="op" id="2969806">+</span><span class="num" id="2969807">3</span><span class="op" id="2969808">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2969811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2969815">//&nbsp;readGCStats&nbsp;fills&nbsp;in&nbsp;the&nbsp;pause&nbsp;and&nbsp;end&nbsp;times&nbsp;histories&nbsp;(up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2969881">//&nbsp;maxPause&nbsp;entries)&nbsp;and&nbsp;then&nbsp;three&nbsp;more:&nbsp;Unix&nbsp;ns&nbsp;time&nbsp;of&nbsp;last&nbsp;GC,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2969949">//&nbsp;number&nbsp;of&nbsp;GC,&nbsp;and&nbsp;total&nbsp;pause&nbsp;time&nbsp;in&nbsp;nanoseconds.&nbsp;Here&nbsp;we</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2970012">//&nbsp;depend&nbsp;on&nbsp;the&nbsp;fact&nbsp;that&nbsp;time.Duration&#39;s&nbsp;native&nbsp;unit&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2970071">//&nbsp;nanoseconds,&nbsp;so&nbsp;the&nbsp;pauses&nbsp;and&nbsp;the&nbsp;total&nbsp;pause&nbsp;time&nbsp;do&nbsp;not&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2970139">//&nbsp;any&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970159">readGCStats</span><span class="op" id="2970170">(</span><span class="op" id="2970171">&amp;</span><span class="ident" id="2970172">stats</span><span class="op" id="2970177">.</span><span class="ident" id="2970178">Pause</span><span class="op" id="2970183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970186">n</span>&nbsp;<span class="op" id="2970188">:=</span>&nbsp;<span class="builtinfunc" id="2970191">len</span><span class="op" id="2970194">(</span><span class="ident" id="2970195">stats</span><span class="op" id="2970200">.</span><span class="ident" id="2970201">Pause</span><span class="op" id="2970206">)</span>&nbsp;<span class="op" id="2970208">-</span>&nbsp;<span class="num" id="2970210">3</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970213">stats</span><span class="op" id="2970218">.</span><span class="ident" id="2970219">LastGC</span>&nbsp;<span class="op" id="2970226">=</span>&nbsp;<span class="ident" id="2970228">time</span><span class="op" id="2970232">.</span><span class="ident" id="2970233">Unix</span><span class="op" id="2970237">(</span><span class="num" id="2970238">0</span><span class="op" id="2970239">,</span>&nbsp;<span class="ident" id="2970241">int64</span><span class="op" id="2970246">(</span><span class="ident" id="2970247">stats</span><span class="op" id="2970252">.</span><span class="ident" id="2970253">Pause</span><span class="op" id="2970258">[</span><span class="ident" id="2970259">n</span><span class="op" id="2970260">]</span><span class="op" id="2970261">)</span><span class="op" id="2970262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970265">stats</span><span class="op" id="2970270">.</span><span class="ident" id="2970271">NumGC</span>&nbsp;<span class="op" id="2970277">=</span>&nbsp;<span class="ident" id="2970279">int64</span><span class="op" id="2970284">(</span><span class="ident" id="2970285">stats</span><span class="op" id="2970290">.</span><span class="ident" id="2970291">Pause</span><span class="op" id="2970296">[</span><span class="ident" id="2970297">n</span><span class="op" id="2970298">+</span><span class="num" id="2970299">1</span><span class="op" id="2970300">]</span><span class="op" id="2970301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970304">stats</span><span class="op" id="2970309">.</span><span class="ident" id="2970310">PauseTotal</span>&nbsp;<span class="op" id="2970321">=</span>&nbsp;<span class="ident" id="2970323">stats</span><span class="op" id="2970328">.</span><span class="ident" id="2970329">Pause</span><span class="op" id="2970334">[</span><span class="ident" id="2970335">n</span><span class="op" id="2970336">+</span><span class="num" id="2970337">2</span><span class="op" id="2970338">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970341">n</span>&nbsp;<span class="op" id="2970343">/=</span>&nbsp;<span class="num" id="2970346">2</span>&nbsp;<span class="comment" id="2970348">//&nbsp;buffer&nbsp;holds&nbsp;pauses&nbsp;and&nbsp;end&nbsp;times</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970386">stats</span><span class="op" id="2970391">.</span><span class="ident" id="2970392">Pause</span>&nbsp;<span class="op" id="2970398">=</span>&nbsp;<span class="ident" id="2970400">stats</span><span class="op" id="2970405">.</span><span class="ident" id="2970406">Pause</span><span class="op" id="2970411">[</span><span class="op" id="2970412">:</span><span class="ident" id="2970413">n</span><span class="op" id="2970414">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970418">if</span>&nbsp;<span class="builtinfunc" id="2970421">cap</span><span class="op" id="2970424">(</span><span class="ident" id="2970425">stats</span><span class="op" id="2970430">.</span><span class="ident" id="2970431">PauseEnd</span><span class="op" id="2970439">)</span>&nbsp;<span class="op" id="2970441">&lt;</span>&nbsp;<span class="ident" id="2970443">maxPause</span>&nbsp;<span class="op" id="2970452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970456">stats</span><span class="op" id="2970461">.</span><span class="ident" id="2970462">PauseEnd</span>&nbsp;<span class="op" id="2970471">=</span>&nbsp;<span class="builtinfunc" id="2970473">make</span><span class="op" id="2970477">(</span><span class="op" id="2970478">[</span><span class="op" id="2970479">]</span><span class="ident" id="2970480">time</span><span class="op" id="2970484">.</span><span class="ident" id="2970485">Time</span><span class="op" id="2970489">,</span>&nbsp;<span class="num" id="2970491">0</span><span class="op" id="2970492">,</span>&nbsp;<span class="ident" id="2970494">maxPause</span><span class="op" id="2970502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2970505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970508">stats</span><span class="op" id="2970513">.</span><span class="ident" id="2970514">PauseEnd</span>&nbsp;<span class="op" id="2970523">=</span>&nbsp;<span class="ident" id="2970525">stats</span><span class="op" id="2970530">.</span><span class="ident" id="2970531">PauseEnd</span><span class="op" id="2970539">[</span><span class="op" id="2970540">:</span><span class="num" id="2970541">0</span><span class="op" id="2970542">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970545">for</span>&nbsp;<span class="ident" id="2970549">_</span><span class="op" id="2970550">,</span>&nbsp;<span class="ident" id="2970552">ns</span>&nbsp;<span class="op" id="2970555">:=</span>&nbsp;<span class="keyword" id="2970558">range</span>&nbsp;<span class="ident" id="2970564">stats</span><span class="op" id="2970569">.</span><span class="ident" id="2970570">Pause</span><span class="op" id="2970575">[</span><span class="ident" id="2970576">n</span>&nbsp;<span class="op" id="2970578">:</span>&nbsp;<span class="ident" id="2970580">n</span><span class="op" id="2970581">+</span><span class="ident" id="2970582">n</span><span class="op" id="2970583">]</span>&nbsp;<span class="op" id="2970585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970589">stats</span><span class="op" id="2970594">.</span><span class="ident" id="2970595">PauseEnd</span>&nbsp;<span class="op" id="2970604">=</span>&nbsp;<span class="builtinfunc" id="2970606">append</span><span class="op" id="2970612">(</span><span class="ident" id="2970613">stats</span><span class="op" id="2970618">.</span><span class="ident" id="2970619">PauseEnd</span><span class="op" id="2970627">,</span>&nbsp;<span class="ident" id="2970629">time</span><span class="op" id="2970633">.</span><span class="ident" id="2970634">Unix</span><span class="op" id="2970638">(</span><span class="num" id="2970639">0</span><span class="op" id="2970640">,</span>&nbsp;<span class="ident" id="2970642">int64</span><span class="op" id="2970647">(</span><span class="ident" id="2970648">ns</span><span class="op" id="2970650">)</span><span class="op" id="2970651">)</span><span class="op" id="2970652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2970655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970659">if</span>&nbsp;<span class="builtinfunc" id="2970662">len</span><span class="op" id="2970665">(</span><span class="ident" id="2970666">stats</span><span class="op" id="2970671">.</span><span class="ident" id="2970672">PauseQuantiles</span><span class="op" id="2970686">)</span>&nbsp;<span class="op" id="2970688">&gt;</span>&nbsp;<span class="num" id="2970690">0</span>&nbsp;<span class="op" id="2970692">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970696">if</span>&nbsp;<span class="ident" id="2970699">n</span>&nbsp;<span class="op" id="2970701">==</span>&nbsp;<span class="num" id="2970704">0</span>&nbsp;<span class="op" id="2970706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2970711">for</span>&nbsp;<span class="ident" id="2970715">i</span>&nbsp;<span class="op" id="2970717">:=</span>&nbsp;<span class="keyword" id="2970720">range</span>&nbsp;<span class="ident" id="2970726">stats</span><span class="op" id="2970731">.</span><span class="ident" id="2970732">PauseQuantiles</span>&nbsp;<span class="op" id="2970747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970753">stats</span><span class="op" id="2970758">.</span><span class="ident" id="2970759">PauseQuantiles</span><span class="op" id="2970773">[</span><span class="ident" id="2970774">i</span><span class="op" id="2970775">]</span>&nbsp;<span class="op" id="2970777">=</span>&nbsp;<span class="num" id="2970779">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2970784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2970788">}</span>&nbsp;<span class="keyword" id="2970790">else</span>&nbsp;<span class="op" id="2970795">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2970800">//&nbsp;There&#39;s&nbsp;room&nbsp;for&nbsp;a&nbsp;second&nbsp;copy&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;stats.Pause.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2970865">//&nbsp;See&nbsp;the&nbsp;allocation&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970918">sorted</span>&nbsp;<span class="op" id="2970925">:=</span>&nbsp;<span class="ident" id="2970928">stats</span><span class="op" id="2970933">.</span><span class="ident" id="2970934">Pause</span><span class="op" id="2970939">[</span><span class="ident" id="2970940">n</span>&nbsp;<span class="op" id="2970942">:</span>&nbsp;<span class="ident" id="2970944">n</span><span class="op" id="2970945">+</span><span class="ident" id="2970946">n</span><span class="op" id="2970947">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2970952">copy</span><span class="op" id="2970956">(</span><span class="ident" id="2970957">sorted</span><span class="op" id="2970963">,</span>&nbsp;<span class="ident" id="2970965">stats</span><span class="op" id="2970970">.</span><span class="ident" id="2970971">Pause</span><span class="op" id="2970976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2970981">sort</span><span class="op" id="2970985">.</span><span class="ident" id="2970986">Sort</span><span class="op" id="2970990">(</span><span class="ident" id="2970991">byDuration</span><span class="op" id="2971001">(</span><span class="ident" id="2971002">sorted</span><span class="op" id="2971008">)</span><span class="op" id="2971009">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971014">nq</span>&nbsp;<span class="op" id="2971017">:=</span>&nbsp;<span class="builtinfunc" id="2971020">len</span><span class="op" id="2971023">(</span><span class="ident" id="2971024">stats</span><span class="op" id="2971029">.</span><span class="ident" id="2971030">PauseQuantiles</span><span class="op" id="2971044">)</span>&nbsp;<span class="op" id="2971046">-</span>&nbsp;<span class="num" id="2971048">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2971053">for</span>&nbsp;<span class="ident" id="2971057">i</span>&nbsp;<span class="op" id="2971059">:=</span>&nbsp;<span class="num" id="2971062">0</span><span class="op" id="2971063">;</span>&nbsp;<span class="ident" id="2971065">i</span>&nbsp;<span class="op" id="2971067">&lt;</span>&nbsp;<span class="ident" id="2971069">nq</span><span class="op" id="2971071">;</span>&nbsp;<span class="ident" id="2971073">i</span><span class="op" id="2971074">++</span>&nbsp;<span class="op" id="2971077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971083">stats</span><span class="op" id="2971088">.</span><span class="ident" id="2971089">PauseQuantiles</span><span class="op" id="2971103">[</span><span class="ident" id="2971104">i</span><span class="op" id="2971105">]</span>&nbsp;<span class="op" id="2971107">=</span>&nbsp;<span class="ident" id="2971109">sorted</span><span class="op" id="2971115">[</span><span class="builtinfunc" id="2971116">len</span><span class="op" id="2971119">(</span><span class="ident" id="2971120">sorted</span><span class="op" id="2971126">)</span><span class="op" id="2971127">*</span><span class="ident" id="2971128">i</span><span class="op" id="2971129">/</span><span class="ident" id="2971130">nq</span><span class="op" id="2971132">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2971137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971142">stats</span><span class="op" id="2971147">.</span><span class="ident" id="2971148">PauseQuantiles</span><span class="op" id="2971162">[</span><span class="ident" id="2971163">nq</span><span class="op" id="2971165">]</span>&nbsp;<span class="op" id="2971167">=</span>&nbsp;<span class="ident" id="2971169">sorted</span><span class="op" id="2971175">[</span><span class="builtinfunc" id="2971176">len</span><span class="op" id="2971179">(</span><span class="ident" id="2971180">sorted</span><span class="op" id="2971186">)</span><span class="op" id="2971187">-</span><span class="num" id="2971188">1</span><span class="op" id="2971189">]</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2971193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2971196">}</span><br>
<span class="lineno"></span><span class="op" id="2971198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2971201">type</span>&nbsp;<span class="ident" id="2971206">byDuration</span>&nbsp;<span class="op" id="2971217">[</span><span class="op" id="2971218">]</span><span class="ident" id="2971219">time</span><span class="op" id="2971223">.</span><span class="ident" id="2971224">Duration</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="2971234">func</span>&nbsp;<span class="op" id="2971239">(</span><span class="ident" id="2971240">x</span>&nbsp;<span class="ident" id="2971242">byDuration</span><span class="op" id="2971252">)</span>&nbsp;<span class="ident" id="2971254">Len</span><span class="op" id="2971257">(</span><span class="op" id="2971258">)</span>&nbsp;<span class="builtintype" id="2971260">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2971274">{</span>&nbsp;<span class="keyword" id="2971276">return</span>&nbsp;<span class="builtinfunc" id="2971283">len</span><span class="op" id="2971286">(</span><span class="ident" id="2971287">x</span><span class="op" id="2971288">)</span>&nbsp;<span class="op" id="2971290">}</span><br>
<span class="lineno"></span><span class="keyword" id="2971292">func</span>&nbsp;<span class="op" id="2971297">(</span><span class="ident" id="2971298">x</span>&nbsp;<span class="ident" id="2971300">byDuration</span><span class="op" id="2971310">)</span>&nbsp;<span class="ident" id="2971312">Swap</span><span class="op" id="2971316">(</span><span class="ident" id="2971317">i</span><span class="op" id="2971318">,</span>&nbsp;<span class="ident" id="2971320">j</span>&nbsp;<span class="builtintype" id="2971322">int</span><span class="op" id="2971325">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2971332">{</span>&nbsp;<span class="ident" id="2971334">x</span><span class="op" id="2971335">[</span><span class="ident" id="2971336">i</span><span class="op" id="2971337">]</span><span class="op" id="2971338">,</span>&nbsp;<span class="ident" id="2971340">x</span><span class="op" id="2971341">[</span><span class="ident" id="2971342">j</span><span class="op" id="2971343">]</span>&nbsp;<span class="op" id="2971345">=</span>&nbsp;<span class="ident" id="2971347">x</span><span class="op" id="2971348">[</span><span class="ident" id="2971349">j</span><span class="op" id="2971350">]</span><span class="op" id="2971351">,</span>&nbsp;<span class="ident" id="2971353">x</span><span class="op" id="2971354">[</span><span class="ident" id="2971355">i</span><span class="op" id="2971356">]</span>&nbsp;<span class="op" id="2971358">}</span><br>
<span class="lineno"></span><span class="keyword" id="2971360">func</span>&nbsp;<span class="op" id="2971365">(</span><span class="ident" id="2971366">x</span>&nbsp;<span class="ident" id="2971368">byDuration</span><span class="op" id="2971378">)</span>&nbsp;<span class="ident" id="2971380">Less</span><span class="op" id="2971384">(</span><span class="ident" id="2971385">i</span><span class="op" id="2971386">,</span>&nbsp;<span class="ident" id="2971388">j</span>&nbsp;<span class="builtintype" id="2971390">int</span><span class="op" id="2971393">)</span>&nbsp;<span class="builtintype" id="2971395">bool</span>&nbsp;<span class="op" id="2971400">{</span>&nbsp;<span class="keyword" id="2971402">return</span>&nbsp;<span class="ident" id="2971409">x</span><span class="op" id="2971410">[</span><span class="ident" id="2971411">i</span><span class="op" id="2971412">]</span>&nbsp;<span class="op" id="2971414">&lt;</span>&nbsp;<span class="ident" id="2971416">x</span><span class="op" id="2971417">[</span><span class="ident" id="2971418">j</span><span class="op" id="2971419">]</span>&nbsp;<span class="op" id="2971421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="2971424">//&nbsp;SetGCPercent&nbsp;sets&nbsp;the&nbsp;garbage&nbsp;collection&nbsp;target&nbsp;percentage:</span><br>
<span class="lineno"></span><span class="comment" id="2971487">//&nbsp;a&nbsp;collection&nbsp;is&nbsp;triggered&nbsp;when&nbsp;the&nbsp;ratio&nbsp;of&nbsp;freshly&nbsp;allocated&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="2971557">//&nbsp;to&nbsp;live&nbsp;data&nbsp;remaining&nbsp;after&nbsp;the&nbsp;previous&nbsp;collection&nbsp;reaches&nbsp;this&nbsp;percentage.</span><br>
<span class="lineno"></span><span class="comment" id="2971638">//&nbsp;SetGCPercent&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="2971684">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;GOGC&nbsp;environment&nbsp;variable</span><br>
<span class="lineno">95</span><span class="comment" id="2971753">//&nbsp;at&nbsp;startup,&nbsp;or&nbsp;100&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="2971803">//&nbsp;A&nbsp;negative&nbsp;percentage&nbsp;disables&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span><span class="keyword" id="2971857">func</span>&nbsp;<span class="ident" id="2971862">SetGCPercent</span><span class="op" id="2971874">(</span><span class="ident" id="2971875">percent</span>&nbsp;<span class="builtintype" id="2971883">int</span><span class="op" id="2971886">)</span>&nbsp;<span class="builtintype" id="2971888">int</span>&nbsp;<span class="op" id="2971892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971895">old</span>&nbsp;<span class="op" id="2971899">:=</span>&nbsp;<span class="ident" id="2971902">setGCPercent</span><span class="op" id="2971914">(</span><span class="builtintype" id="2971915">int32</span><span class="op" id="2971920">(</span><span class="ident" id="2971921">percent</span><span class="op" id="2971928">)</span><span class="op" id="2971929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2971932">runtime</span><span class="op" id="2971939">.</span><span class="ident" id="2971940">GC</span><span class="op" id="2971942">(</span><span class="op" id="2971943">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2971946">return</span>&nbsp;<span class="builtintype" id="2971953">int</span><span class="op" id="2971956">(</span><span class="ident" id="2971957">old</span><span class="op" id="2971960">)</span><br>
<span class="lineno"></span><span class="op" id="2971962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2971965">//&nbsp;FreeOSMemory&nbsp;forces&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;followed&nbsp;by&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2972024">//&nbsp;attempt&nbsp;to&nbsp;return&nbsp;as&nbsp;much&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system</span><br>
<span class="lineno">105</span><span class="comment" id="2972084">//&nbsp;as&nbsp;possible.&nbsp;(Even&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;called,&nbsp;the&nbsp;runtime&nbsp;gradually</span><br>
<span class="lineno"></span><span class="comment" id="2972151">//&nbsp;returns&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system&nbsp;in&nbsp;a&nbsp;background&nbsp;task.)</span><br>
<span class="lineno"></span><span class="keyword" id="2972216">func</span>&nbsp;<span class="ident" id="2972221">FreeOSMemory</span><span class="op" id="2972233">(</span><span class="op" id="2972234">)</span>&nbsp;<span class="op" id="2972236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2972239">freeOSMemory</span><span class="op" id="2972251">(</span><span class="op" id="2972252">)</span><br>
<span class="lineno"></span><span class="op" id="2972254">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="2972257">//&nbsp;SetMaxStack&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;amount&nbsp;of&nbsp;memory&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2972311">//&nbsp;can&nbsp;be&nbsp;used&nbsp;by&nbsp;a&nbsp;single&nbsp;goroutine&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="2972355">//&nbsp;If&nbsp;any&nbsp;goroutine&nbsp;exceeds&nbsp;this&nbsp;limit&nbsp;while&nbsp;growing&nbsp;its&nbsp;stack,</span><br>
<span class="lineno"></span><span class="comment" id="2972419">//&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno">115</span><span class="comment" id="2972443">//&nbsp;SetMaxStack&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="2972488">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;1&nbsp;GB&nbsp;on&nbsp;64-bit&nbsp;systems,&nbsp;250&nbsp;MB&nbsp;on&nbsp;32-bit&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="2972564">//</span><br>
<span class="lineno"></span><span class="comment" id="2972567">//&nbsp;SetMaxStack&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2972631">//&nbsp;goroutines&nbsp;that&nbsp;enter&nbsp;an&nbsp;infinite&nbsp;recursion.&nbsp;It&nbsp;only&nbsp;limits&nbsp;future</span><br>
<span class="lineno">120</span><span class="comment" id="2972701">//&nbsp;stack&nbsp;growth.</span><br>
<span class="lineno"></span><span class="keyword" id="2972718">func</span>&nbsp;<span class="ident" id="2972723">SetMaxStack</span><span class="op" id="2972734">(</span><span class="ident" id="2972735">bytes</span>&nbsp;<span class="builtintype" id="2972741">int</span><span class="op" id="2972744">)</span>&nbsp;<span class="builtintype" id="2972746">int</span>&nbsp;<span class="op" id="2972750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2972753">return</span>&nbsp;<span class="ident" id="2972760">setMaxStack</span><span class="op" id="2972771">(</span><span class="ident" id="2972772">bytes</span><span class="op" id="2972777">)</span><br>
<span class="lineno"></span><span class="op" id="2972779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="2972782">//&nbsp;SetMaxThreads&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span><span class="comment" id="2972843">//&nbsp;threads&nbsp;that&nbsp;the&nbsp;Go&nbsp;program&nbsp;can&nbsp;use.&nbsp;If&nbsp;it&nbsp;attempts&nbsp;to&nbsp;use&nbsp;more&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="2972915">//&nbsp;this&nbsp;many,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="comment" id="2972950">//&nbsp;SetMaxThreads&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="2972997">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;10,000&nbsp;threads.</span><br>
<span class="lineno">130</span><span class="comment" id="2973039">//</span><br>
<span class="lineno"></span><span class="comment" id="2973042">//&nbsp;The&nbsp;limit&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;operating&nbsp;system&nbsp;threads,&nbsp;not&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="2973119">//&nbsp;of&nbsp;goroutines.&nbsp;A&nbsp;Go&nbsp;program&nbsp;creates&nbsp;a&nbsp;new&nbsp;thread&nbsp;only&nbsp;when&nbsp;a&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="2973193">//&nbsp;is&nbsp;ready&nbsp;to&nbsp;run&nbsp;but&nbsp;all&nbsp;the&nbsp;existing&nbsp;threads&nbsp;are&nbsp;blocked&nbsp;in&nbsp;system&nbsp;calls,&nbsp;cgo&nbsp;calls,</span><br>
<span class="lineno"></span><span class="comment" id="2973281">//&nbsp;or&nbsp;are&nbsp;locked&nbsp;to&nbsp;other&nbsp;goroutines&nbsp;due&nbsp;to&nbsp;use&nbsp;of&nbsp;runtime.LockOSThread.</span><br>
<span class="lineno">135</span><span class="comment" id="2973354">//</span><br>
<span class="lineno"></span><span class="comment" id="2973357">//&nbsp;SetMaxThreads&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2973423">//&nbsp;programs&nbsp;that&nbsp;create&nbsp;an&nbsp;unbounded&nbsp;number&nbsp;of&nbsp;threads.&nbsp;The&nbsp;idea&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2973491">//&nbsp;to&nbsp;take&nbsp;down&nbsp;the&nbsp;program&nbsp;before&nbsp;it&nbsp;takes&nbsp;down&nbsp;the&nbsp;operating&nbsp;system.</span><br>
<span class="lineno"></span><span class="keyword" id="2973562">func</span>&nbsp;<span class="ident" id="2973567">SetMaxThreads</span><span class="op" id="2973580">(</span><span class="ident" id="2973581">threads</span>&nbsp;<span class="builtintype" id="2973589">int</span><span class="op" id="2973592">)</span>&nbsp;<span class="builtintype" id="2973594">int</span>&nbsp;<span class="op" id="2973598">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2973601">return</span>&nbsp;<span class="ident" id="2973608">setMaxThreads</span><span class="op" id="2973621">(</span><span class="ident" id="2973622">threads</span><span class="op" id="2973629">)</span><br>
<span class="lineno"></span><span class="op" id="2973631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2973634">//&nbsp;SetPanicOnFault&nbsp;controls&nbsp;the&nbsp;runtime&#39;s&nbsp;behavior&nbsp;when&nbsp;a&nbsp;program&nbsp;faults</span><br>
<span class="lineno"></span><span class="comment" id="2973707">//&nbsp;at&nbsp;an&nbsp;unexpected&nbsp;(non-nil)&nbsp;address.&nbsp;Such&nbsp;faults&nbsp;are&nbsp;typically&nbsp;caused&nbsp;by</span><br>
<span class="lineno">145</span><span class="comment" id="2973782">//&nbsp;bugs&nbsp;such&nbsp;as&nbsp;runtime&nbsp;memory&nbsp;corruption,&nbsp;so&nbsp;the&nbsp;default&nbsp;response&nbsp;is&nbsp;to&nbsp;crash</span><br>
<span class="lineno"></span><span class="comment" id="2973861">//&nbsp;the&nbsp;program.&nbsp;Programs&nbsp;working&nbsp;with&nbsp;memory-mapped&nbsp;files&nbsp;or&nbsp;unsafe</span><br>
<span class="lineno"></span><span class="comment" id="2973929">//&nbsp;manipulation&nbsp;of&nbsp;memory&nbsp;may&nbsp;cause&nbsp;faults&nbsp;at&nbsp;non-nil&nbsp;addresses&nbsp;in&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="2974001">//&nbsp;dramatic&nbsp;situations;&nbsp;SetPanicOnFault&nbsp;allows&nbsp;such&nbsp;programs&nbsp;to&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="2974073">//&nbsp;that&nbsp;the&nbsp;runtime&nbsp;trigger&nbsp;only&nbsp;a&nbsp;panic,&nbsp;not&nbsp;a&nbsp;crash.</span><br>
<span class="lineno">150</span><span class="comment" id="2974128">//&nbsp;SetPanicOnFault&nbsp;applies&nbsp;only&nbsp;to&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span><span class="comment" id="2974186">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="keyword" id="2974222">func</span>&nbsp;<span class="ident" id="2974227">SetPanicOnFault</span><span class="op" id="2974242">(</span><span class="ident" id="2974243">enabled</span>&nbsp;<span class="builtintype" id="2974251">bool</span><span class="op" id="2974255">)</span>&nbsp;<span class="builtintype" id="2974257">bool</span>&nbsp;<span class="op" id="2974262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2974265">return</span>&nbsp;<span class="ident" id="2974272">setPanicOnFault</span><span class="op" id="2974287">(</span><span class="ident" id="2974288">enabled</span><span class="op" id="2974295">)</span><br>
<span class="lineno"></span><span class="op" id="2974297">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="2974300">//&nbsp;WriteHeapDump&nbsp;writes&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;heap&nbsp;and&nbsp;the&nbsp;objects&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2974369">//&nbsp;it&nbsp;to&nbsp;the&nbsp;given&nbsp;file&nbsp;descriptor.</span><br>
<span class="lineno"></span><span class="comment" id="2974405">//&nbsp;The&nbsp;heap&nbsp;dump&nbsp;format&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://golang.org/s/go13heapdump.</span><br>
<span class="lineno"></span><span class="keyword" id="2974477">func</span>&nbsp;<span class="ident" id="2974482">WriteHeapDump</span><span class="op" id="2974495">(</span><span class="ident" id="2974496">fd</span>&nbsp;<span class="builtintype" id="2974499">uintptr</span><span class="op" id="2974506">)</span>
</div>
</body>
</html>
