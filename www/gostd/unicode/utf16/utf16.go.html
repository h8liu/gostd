<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode/utf16</h2>
<ul>
<li><a href="/gostd/unicode/utf16/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16.go.html" class="current">utf16.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16_test.go.html">utf16_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5314813">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5314869">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5314923">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5314974">//&nbsp;Package&nbsp;utf16&nbsp;implements&nbsp;encoding&nbsp;and&nbsp;decoding&nbsp;of&nbsp;UTF-16&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="keyword" id="5315045">package</span>&nbsp;<span class="ident" id="5315053">utf16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5315060">//&nbsp;The&nbsp;conditions&nbsp;replacementChar==unicode.ReplacementChar&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5315123">//&nbsp;maxRune==unicode.MaxRune&nbsp;are&nbsp;verified&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno">10</span><span class="comment" id="5315178">//&nbsp;Defining&nbsp;them&nbsp;locally&nbsp;avoids&nbsp;this&nbsp;package&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5315254">const</span>&nbsp;<span class="op" id="5315260">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5315263">replacementChar</span>&nbsp;<span class="op" id="5315279">=</span>&nbsp;<span class="string" id="5315281">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5315294">//&nbsp;Unicode&nbsp;replacement&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5315328">maxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5315344">=</span>&nbsp;<span class="string" id="5315346">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="5315359">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno">15</span><span class="op" id="5315396">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5315399">const</span>&nbsp;<span class="op" id="5315405">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5315408">//&nbsp;0xd800-0xdc00&nbsp;encodes&nbsp;the&nbsp;high&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5315462">//&nbsp;0xdc00-0xe000&nbsp;encodes&nbsp;the&nbsp;low&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5315515">//&nbsp;the&nbsp;value&nbsp;is&nbsp;those&nbsp;20&nbsp;bits&nbsp;plus&nbsp;0x10000.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5315560">surr1</span>&nbsp;<span class="op" id="5315566">=</span>&nbsp;<span class="num" id="5315568">0xd800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5315576">surr2</span>&nbsp;<span class="op" id="5315582">=</span>&nbsp;<span class="num" id="5315584">0xdc00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5315592">surr3</span>&nbsp;<span class="op" id="5315598">=</span>&nbsp;<span class="num" id="5315600">0xe000</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5315609">surrSelf</span>&nbsp;<span class="op" id="5315618">=</span>&nbsp;<span class="num" id="5315620">0x10000</span><br>
<span class="lineno"></span><span class="op" id="5315628">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5315631">//&nbsp;IsSurrogate&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;specified&nbsp;Unicode&nbsp;code&nbsp;point</span><br>
<span class="lineno"></span><span class="comment" id="5315695">//&nbsp;can&nbsp;appear&nbsp;in&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">30</span><span class="keyword" id="5315730">func</span>&nbsp;<span class="ident" id="5315735">IsSurrogate</span><span class="op" id="5315746">(</span><span class="ident" id="5315747">r</span>&nbsp;<span class="builtintype" id="5315749">rune</span><span class="op" id="5315753">)</span>&nbsp;<span class="builtintype" id="5315755">bool</span>&nbsp;<span class="op" id="5315760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5315763">return</span>&nbsp;<span class="ident" id="5315770">surr1</span>&nbsp;<span class="op" id="5315776">&lt;=</span>&nbsp;<span class="ident" id="5315779">r</span>&nbsp;<span class="op" id="5315781">&amp;&amp;</span>&nbsp;<span class="ident" id="5315784">r</span>&nbsp;<span class="op" id="5315786">&lt;</span>&nbsp;<span class="ident" id="5315788">surr3</span><br>
<span class="lineno"></span><span class="op" id="5315794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5315797">//&nbsp;DecodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;decoding&nbsp;of&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">35</span><span class="comment" id="5315860">//&nbsp;If&nbsp;the&nbsp;pair&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;UTF-16&nbsp;surrogate&nbsp;pair,&nbsp;DecodeRune&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="5315932">//&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;code&nbsp;point&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="5315978">func</span>&nbsp;<span class="ident" id="5315983">DecodeRune</span><span class="op" id="5315993">(</span><span class="ident" id="5315994">r1</span><span class="op" id="5315996">,</span>&nbsp;<span class="ident" id="5315998">r2</span>&nbsp;<span class="builtintype" id="5316001">rune</span><span class="op" id="5316005">)</span>&nbsp;<span class="builtintype" id="5316007">rune</span>&nbsp;<span class="op" id="5316012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5316015">if</span>&nbsp;<span class="ident" id="5316018">surr1</span>&nbsp;<span class="op" id="5316024">&lt;=</span>&nbsp;<span class="ident" id="5316027">r1</span>&nbsp;<span class="op" id="5316030">&amp;&amp;</span>&nbsp;<span class="ident" id="5316033">r1</span>&nbsp;<span class="op" id="5316036">&lt;</span>&nbsp;<span class="ident" id="5316038">surr2</span>&nbsp;<span class="op" id="5316044">&amp;&amp;</span>&nbsp;<span class="ident" id="5316047">surr2</span>&nbsp;<span class="op" id="5316053">&lt;=</span>&nbsp;<span class="ident" id="5316056">r2</span>&nbsp;<span class="op" id="5316059">&amp;&amp;</span>&nbsp;<span class="ident" id="5316062">r2</span>&nbsp;<span class="op" id="5316065">&lt;</span>&nbsp;<span class="ident" id="5316067">surr3</span>&nbsp;<span class="op" id="5316073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5316077">return</span>&nbsp;<span class="op" id="5316084">(</span><span class="ident" id="5316085">r1</span><span class="op" id="5316087">-</span><span class="ident" id="5316088">surr1</span><span class="op" id="5316093">)</span><span class="op" id="5316094">&lt;&lt;</span><span class="num" id="5316096">10</span>&nbsp;<span class="op" id="5316099">|</span>&nbsp;<span class="op" id="5316101">(</span><span class="ident" id="5316102">r2</span>&nbsp;<span class="op" id="5316105">-</span>&nbsp;<span class="ident" id="5316107">surr2</span><span class="op" id="5316112">)</span>&nbsp;<span class="op" id="5316114">+</span>&nbsp;<span class="num" id="5316116">0x10000</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5316125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5316128">return</span>&nbsp;<span class="ident" id="5316135">replacementChar</span><br>
<span class="lineno"></span><span class="op" id="5316151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5316154">//&nbsp;EncodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;surrogate&nbsp;pair&nbsp;r1,&nbsp;r2&nbsp;for&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno">45</span><span class="comment" id="5316229">//&nbsp;If&nbsp;the&nbsp;rune&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;does&nbsp;not&nbsp;need&nbsp;encoding,</span><br>
<span class="lineno"></span><span class="comment" id="5316305">//&nbsp;EncodeRune&nbsp;returns&nbsp;U+FFFD,&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="5316343">func</span>&nbsp;<span class="ident" id="5316348">EncodeRune</span><span class="op" id="5316358">(</span><span class="ident" id="5316359">r</span>&nbsp;<span class="builtintype" id="5316361">rune</span><span class="op" id="5316365">)</span>&nbsp;<span class="op" id="5316367">(</span><span class="ident" id="5316368">r1</span><span class="op" id="5316370">,</span>&nbsp;<span class="ident" id="5316372">r2</span>&nbsp;<span class="builtintype" id="5316375">rune</span><span class="op" id="5316379">)</span>&nbsp;<span class="op" id="5316381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5316384">if</span>&nbsp;<span class="ident" id="5316387">r</span>&nbsp;<span class="op" id="5316389">&lt;</span>&nbsp;<span class="ident" id="5316391">surrSelf</span>&nbsp;<span class="op" id="5316400">||</span>&nbsp;<span class="ident" id="5316403">r</span>&nbsp;<span class="op" id="5316405">&gt;</span>&nbsp;<span class="ident" id="5316407">maxRune</span>&nbsp;<span class="op" id="5316415">||</span>&nbsp;<span class="ident" id="5316418">IsSurrogate</span><span class="op" id="5316429">(</span><span class="ident" id="5316430">r</span><span class="op" id="5316431">)</span>&nbsp;<span class="op" id="5316433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5316437">return</span>&nbsp;<span class="ident" id="5316444">replacementChar</span><span class="op" id="5316459">,</span>&nbsp;<span class="ident" id="5316461">replacementChar</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5316478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5316481">r</span>&nbsp;<span class="op" id="5316483">-=</span>&nbsp;<span class="ident" id="5316486">surrSelf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5316496">return</span>&nbsp;<span class="ident" id="5316503">surr1</span>&nbsp;<span class="op" id="5316509">+</span>&nbsp;<span class="op" id="5316511">(</span><span class="ident" id="5316512">r</span><span class="op" id="5316513">&gt;&gt;</span><span class="num" id="5316515">10</span><span class="op" id="5316517">)</span><span class="op" id="5316518">&amp;</span><span class="num" id="5316519">0x3ff</span><span class="op" id="5316524">,</span>&nbsp;<span class="ident" id="5316526">surr2</span>&nbsp;<span class="op" id="5316532">+</span>&nbsp;<span class="ident" id="5316534">r</span><span class="op" id="5316535">&amp;</span><span class="num" id="5316536">0x3ff</span><br>
<span class="lineno"></span><span class="op" id="5316542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="5316545">//&nbsp;Encode&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;of&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5316621">func</span>&nbsp;<span class="ident" id="5316626">Encode</span><span class="op" id="5316632">(</span><span class="ident" id="5316633">s</span>&nbsp;<span class="op" id="5316635">[</span><span class="op" id="5316636">]</span><span class="builtintype" id="5316637">rune</span><span class="op" id="5316641">)</span>&nbsp;<span class="op" id="5316643">[</span><span class="op" id="5316644">]</span><span class="builtintype" id="5316645">uint16</span>&nbsp;<span class="op" id="5316652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5316655">n</span>&nbsp;<span class="op" id="5316657">:=</span>&nbsp;<span class="builtinfunc" id="5316660">len</span><span class="op" id="5316663">(</span><span class="ident" id="5316664">s</span><span class="op" id="5316665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5316668">for</span>&nbsp;<span class="ident" id="5316672">_</span><span class="op" id="5316673">,</span>&nbsp;<span class="ident" id="5316675">v</span>&nbsp;<span class="op" id="5316677">:=</span>&nbsp;<span class="keyword" id="5316680">range</span>&nbsp;<span class="ident" id="5316686">s</span>&nbsp;<span class="op" id="5316688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5316692">if</span>&nbsp;<span class="ident" id="5316695">v</span>&nbsp;<span class="op" id="5316697">&gt;=</span>&nbsp;<span class="ident" id="5316700">surrSelf</span>&nbsp;<span class="op" id="5316709">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5316714">n</span><span class="op" id="5316715">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5316720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5316723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5316727">a</span>&nbsp;<span class="op" id="5316729">:=</span>&nbsp;<span class="builtinfunc" id="5316732">make</span><span class="op" id="5316736">(</span><span class="op" id="5316737">[</span><span class="op" id="5316738">]</span><span class="builtintype" id="5316739">uint16</span><span class="op" id="5316745">,</span>&nbsp;<span class="ident" id="5316747">n</span><span class="op" id="5316748">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5316751">n</span>&nbsp;<span class="op" id="5316753">=</span>&nbsp;<span class="num" id="5316755">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5316758">for</span>&nbsp;<span class="ident" id="5316762">_</span><span class="op" id="5316763">,</span>&nbsp;<span class="ident" id="5316765">v</span>&nbsp;<span class="op" id="5316767">:=</span>&nbsp;<span class="keyword" id="5316770">range</span>&nbsp;<span class="ident" id="5316776">s</span>&nbsp;<span class="op" id="5316778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5316782">switch</span>&nbsp;<span class="op" id="5316789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5316793">case</span>&nbsp;<span class="ident" id="5316798">v</span>&nbsp;<span class="op" id="5316800">&lt;</span>&nbsp;<span class="num" id="5316802">0</span><span class="op" id="5316803">,</span>&nbsp;<span class="ident" id="5316805">surr1</span>&nbsp;<span class="op" id="5316811">&lt;=</span>&nbsp;<span class="ident" id="5316814">v</span>&nbsp;<span class="op" id="5316816">&amp;&amp;</span>&nbsp;<span class="ident" id="5316819">v</span>&nbsp;<span class="op" id="5316821">&lt;</span>&nbsp;<span class="ident" id="5316823">surr3</span><span class="op" id="5316828">,</span>&nbsp;<span class="ident" id="5316830">v</span>&nbsp;<span class="op" id="5316832">&gt;</span>&nbsp;<span class="ident" id="5316834">maxRune</span><span class="op" id="5316841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5316846">v</span>&nbsp;<span class="op" id="5316848">=</span>&nbsp;<span class="ident" id="5316850">replacementChar</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5316869">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5316883">case</span>&nbsp;<span class="ident" id="5316888">v</span>&nbsp;<span class="op" id="5316890">&lt;</span>&nbsp;<span class="ident" id="5316892">surrSelf</span><span class="op" id="5316900">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5316905">a</span><span class="op" id="5316906">[</span><span class="ident" id="5316907">n</span><span class="op" id="5316908">]</span>&nbsp;<span class="op" id="5316910">=</span>&nbsp;<span class="builtintype" id="5316912">uint16</span><span class="op" id="5316918">(</span><span class="ident" id="5316919">v</span><span class="op" id="5316920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5316925">n</span><span class="op" id="5316926">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5316931">default</span><span class="op" id="5316938">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5316943">r1</span><span class="op" id="5316945">,</span>&nbsp;<span class="ident" id="5316947">r2</span>&nbsp;<span class="op" id="5316950">:=</span>&nbsp;<span class="ident" id="5316953">EncodeRune</span><span class="op" id="5316963">(</span><span class="ident" id="5316964">v</span><span class="op" id="5316965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5316970">a</span><span class="op" id="5316971">[</span><span class="ident" id="5316972">n</span><span class="op" id="5316973">]</span>&nbsp;<span class="op" id="5316975">=</span>&nbsp;<span class="builtintype" id="5316977">uint16</span><span class="op" id="5316983">(</span><span class="ident" id="5316984">r1</span><span class="op" id="5316986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5316991">a</span><span class="op" id="5316992">[</span><span class="ident" id="5316993">n</span><span class="op" id="5316994">+</span><span class="num" id="5316995">1</span><span class="op" id="5316996">]</span>&nbsp;<span class="op" id="5316998">=</span>&nbsp;<span class="builtintype" id="5317000">uint16</span><span class="op" id="5317006">(</span><span class="ident" id="5317007">r2</span><span class="op" id="5317009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5317014">n</span>&nbsp;<span class="op" id="5317016">+=</span>&nbsp;<span class="num" id="5317019">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5317023">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5317026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5317029">return</span>&nbsp;<span class="ident" id="5317036">a</span><span class="op" id="5317037">[</span><span class="num" id="5317038">0</span><span class="op" id="5317039">:</span><span class="ident" id="5317040">n</span><span class="op" id="5317041">]</span><br>
<span class="lineno"></span><span class="op" id="5317043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5317046">//&nbsp;Decode&nbsp;returns&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;represented</span><br>
<span class="lineno">85</span><span class="comment" id="5317108">//&nbsp;by&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5317137">func</span>&nbsp;<span class="ident" id="5317142">Decode</span><span class="op" id="5317148">(</span><span class="ident" id="5317149">s</span>&nbsp;<span class="op" id="5317151">[</span><span class="op" id="5317152">]</span><span class="builtintype" id="5317153">uint16</span><span class="op" id="5317159">)</span>&nbsp;<span class="op" id="5317161">[</span><span class="op" id="5317162">]</span><span class="builtintype" id="5317163">rune</span>&nbsp;<span class="op" id="5317168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5317171">a</span>&nbsp;<span class="op" id="5317173">:=</span>&nbsp;<span class="builtinfunc" id="5317176">make</span><span class="op" id="5317180">(</span><span class="op" id="5317181">[</span><span class="op" id="5317182">]</span><span class="builtintype" id="5317183">rune</span><span class="op" id="5317187">,</span>&nbsp;<span class="builtinfunc" id="5317189">len</span><span class="op" id="5317192">(</span><span class="ident" id="5317193">s</span><span class="op" id="5317194">)</span><span class="op" id="5317195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5317198">n</span>&nbsp;<span class="op" id="5317200">:=</span>&nbsp;<span class="num" id="5317203">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5317206">for</span>&nbsp;<span class="ident" id="5317210">i</span>&nbsp;<span class="op" id="5317212">:=</span>&nbsp;<span class="num" id="5317215">0</span><span class="op" id="5317216">;</span>&nbsp;<span class="ident" id="5317218">i</span>&nbsp;<span class="op" id="5317220">&lt;</span>&nbsp;<span class="builtinfunc" id="5317222">len</span><span class="op" id="5317225">(</span><span class="ident" id="5317226">s</span><span class="op" id="5317227">)</span><span class="op" id="5317228">;</span>&nbsp;<span class="ident" id="5317230">i</span><span class="op" id="5317231">++</span>&nbsp;<span class="op" id="5317234">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5317238">switch</span>&nbsp;<span class="ident" id="5317245">r</span>&nbsp;<span class="op" id="5317247">:=</span>&nbsp;<span class="ident" id="5317250">s</span><span class="op" id="5317251">[</span><span class="ident" id="5317252">i</span><span class="op" id="5317253">]</span><span class="op" id="5317254">;</span>&nbsp;<span class="op" id="5317256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5317260">case</span>&nbsp;<span class="ident" id="5317265">surr1</span>&nbsp;<span class="op" id="5317271">&lt;=</span>&nbsp;<span class="ident" id="5317274">r</span>&nbsp;<span class="op" id="5317276">&amp;&amp;</span>&nbsp;<span class="ident" id="5317279">r</span>&nbsp;<span class="op" id="5317281">&lt;</span>&nbsp;<span class="ident" id="5317283">surr2</span>&nbsp;<span class="op" id="5317289">&amp;&amp;</span>&nbsp;<span class="ident" id="5317292">i</span><span class="op" id="5317293">+</span><span class="num" id="5317294">1</span>&nbsp;<span class="op" id="5317296">&lt;</span>&nbsp;<span class="builtinfunc" id="5317298">len</span><span class="op" id="5317301">(</span><span class="ident" id="5317302">s</span><span class="op" id="5317303">)</span>&nbsp;<span class="op" id="5317305">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5317311">surr2</span>&nbsp;<span class="op" id="5317317">&lt;=</span>&nbsp;<span class="ident" id="5317320">s</span><span class="op" id="5317321">[</span><span class="ident" id="5317322">i</span><span class="op" id="5317323">+</span><span class="num" id="5317324">1</span><span class="op" id="5317325">]</span>&nbsp;<span class="op" id="5317327">&amp;&amp;</span>&nbsp;<span class="ident" id="5317330">s</span><span class="op" id="5317331">[</span><span class="ident" id="5317332">i</span><span class="op" id="5317333">+</span><span class="num" id="5317334">1</span><span class="op" id="5317335">]</span>&nbsp;<span class="op" id="5317337">&lt;</span>&nbsp;<span class="ident" id="5317339">surr3</span><span class="op" id="5317344">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5317349">//&nbsp;valid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5317380">a</span><span class="op" id="5317381">[</span><span class="ident" id="5317382">n</span><span class="op" id="5317383">]</span>&nbsp;<span class="op" id="5317385">=</span>&nbsp;<span class="ident" id="5317387">DecodeRune</span><span class="op" id="5317397">(</span><span class="builtintype" id="5317398">rune</span><span class="op" id="5317402">(</span><span class="ident" id="5317403">r</span><span class="op" id="5317404">)</span><span class="op" id="5317405">,</span>&nbsp;<span class="builtintype" id="5317407">rune</span><span class="op" id="5317411">(</span><span class="ident" id="5317412">s</span><span class="op" id="5317413">[</span><span class="ident" id="5317414">i</span><span class="op" id="5317415">+</span><span class="num" id="5317416">1</span><span class="op" id="5317417">]</span><span class="op" id="5317418">)</span><span class="op" id="5317419">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5317424">i</span><span class="op" id="5317425">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5317431">n</span><span class="op" id="5317432">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5317437">case</span>&nbsp;<span class="ident" id="5317442">surr1</span>&nbsp;<span class="op" id="5317448">&lt;=</span>&nbsp;<span class="ident" id="5317451">r</span>&nbsp;<span class="op" id="5317453">&amp;&amp;</span>&nbsp;<span class="ident" id="5317456">r</span>&nbsp;<span class="op" id="5317458">&lt;</span>&nbsp;<span class="ident" id="5317460">surr3</span><span class="op" id="5317465">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5317470">//&nbsp;invalid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5317503">a</span><span class="op" id="5317504">[</span><span class="ident" id="5317505">n</span><span class="op" id="5317506">]</span>&nbsp;<span class="op" id="5317508">=</span>&nbsp;<span class="ident" id="5317510">replacementChar</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5317529">n</span><span class="op" id="5317530">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5317535">default</span><span class="op" id="5317542">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5317547">//&nbsp;normal&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5317565">a</span><span class="op" id="5317566">[</span><span class="ident" id="5317567">n</span><span class="op" id="5317568">]</span>&nbsp;<span class="op" id="5317570">=</span>&nbsp;<span class="builtintype" id="5317572">rune</span><span class="op" id="5317576">(</span><span class="ident" id="5317577">r</span><span class="op" id="5317578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5317583">n</span><span class="op" id="5317584">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5317589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5317592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5317595">return</span>&nbsp;<span class="ident" id="5317602">a</span><span class="op" id="5317603">[</span><span class="num" id="5317604">0</span><span class="op" id="5317605">:</span><span class="ident" id="5317606">n</span><span class="op" id="5317607">]</span><br>
<span class="lineno"></span><span class="op" id="5317609">}</span>
</div>
</body>
</html>
