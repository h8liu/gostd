<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/tar</h2>
<ul>
<li><a href="/gostd/archive/tar/common.go.html">common.go</a></li>
<li><a href="/gostd/archive/tar/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/tar/reader.go.html">reader.go</a></li>
<li><a href="/gostd/archive/tar/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/tar/stat_atim.go.html">stat_atim.go</a></li>
<li><a href="/gostd/archive/tar/stat_unix.go.html">stat_unix.go</a></li>
<li><a href="/gostd/archive/tar/tar_test.go.html">tar_test.go</a></li>
<li><a href="/gostd/archive/tar/writer.go.html" class="current">writer.go</a></li>
<li><a href="/gostd/archive/tar/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5641176">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5641231">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5641285">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5641336">package</span>&nbsp;<span class="ident" id="5641344">tar</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5641349">//&nbsp;TODO(dsymonds):</span><br>
<span class="lineno"></span><span class="comment" id="5641368">//&nbsp;-&nbsp;catch&nbsp;more&nbsp;errors&nbsp;(no&nbsp;first&nbsp;header,&nbsp;etc.)</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="5641416">import</span>&nbsp;<span class="op" id="5641423">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5641426">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5641435">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5641445">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5641452">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5641458">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5641464">&#34;path&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5641472">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5641483">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5641494">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="5641501">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5641504">var</span>&nbsp;<span class="op" id="5641508">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5641511">ErrWriteTooLong</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5641530">=</span>&nbsp;<span class="ident" id="5641532"><a href="/gostd/archive/tar/writer.go.html#5641435">errors</a></span><span class="op" id="5641538">.</span><span class="ident" id="5641539"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5641542">(</span><span class="string" id="5641543">&#34;archive/tar:&nbsp;write&nbsp;too&nbsp;long&#34;</span><span class="op" id="5641572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5641575">ErrFieldTooLong</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5641594">=</span>&nbsp;<span class="ident" id="5641596"><a href="/gostd/archive/tar/writer.go.html#5641435">errors</a></span><span class="op" id="5641602">.</span><span class="ident" id="5641603"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5641606">(</span><span class="string" id="5641607">&#34;archive/tar:&nbsp;header&nbsp;field&nbsp;too&nbsp;long&#34;</span><span class="op" id="5641643">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5641646">ErrWriteAfterClose</span>&nbsp;<span class="op" id="5641665">=</span>&nbsp;<span class="ident" id="5641667"><a href="/gostd/archive/tar/writer.go.html#5641435">errors</a></span><span class="op" id="5641673">.</span><span class="ident" id="5641674"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5641677">(</span><span class="string" id="5641678">&#34;archive/tar:&nbsp;write&nbsp;after&nbsp;close&#34;</span><span class="op" id="5641710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5641713">errNameTooLong</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5641732">=</span>&nbsp;<span class="ident" id="5641734"><a href="/gostd/archive/tar/writer.go.html#5641435">errors</a></span><span class="op" id="5641740">.</span><span class="ident" id="5641741"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5641744">(</span><span class="string" id="5641745">&#34;archive/tar:&nbsp;name&nbsp;too&nbsp;long&#34;</span><span class="op" id="5641773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5641776">errInvalidHeader</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5641795">=</span>&nbsp;<span class="ident" id="5641797"><a href="/gostd/archive/tar/writer.go.html#5641435">errors</a></span><span class="op" id="5641803">.</span><span class="ident" id="5641804"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="5641807">(</span><span class="string" id="5641808">&#34;archive/tar:&nbsp;header&nbsp;field&nbsp;too&nbsp;long&nbsp;or&nbsp;contains&nbsp;invalid&nbsp;values&#34;</span><span class="op" id="5641871">)</span><br>
<span class="lineno"></span><span class="op" id="5641873">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="5641876">//&nbsp;A&nbsp;Writer&nbsp;provides&nbsp;sequential&nbsp;writing&nbsp;of&nbsp;a&nbsp;tar&nbsp;archive&nbsp;in&nbsp;POSIX.1&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="5641952">//&nbsp;A&nbsp;tar&nbsp;archive&nbsp;consists&nbsp;of&nbsp;a&nbsp;sequence&nbsp;of&nbsp;files.</span><br>
<span class="lineno"></span><span class="comment" id="5642002">//&nbsp;Call&nbsp;WriteHeader&nbsp;to&nbsp;begin&nbsp;a&nbsp;new&nbsp;file,&nbsp;and&nbsp;then&nbsp;call&nbsp;Write&nbsp;to&nbsp;supply&nbsp;that&nbsp;file&#39;s&nbsp;data,</span><br>
<span class="lineno"></span><span class="comment" id="5642091">//&nbsp;writing&nbsp;at&nbsp;most&nbsp;hdr.Size&nbsp;bytes&nbsp;in&nbsp;total.</span><br>
<span class="lineno"></span><span class="keyword" id="5642135">type</span>&nbsp;<span class="ident" id="5642140">Writer</span>&nbsp;<span class="keyword" id="5642147">struct</span>&nbsp;<span class="op" id="5642154">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5642157">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5642168"><a href="/gostd/archive/tar/writer.go.html#5641452">io</a></span><span class="op" id="5642170">.</span><span class="ident" id="5642171"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5642179">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5642190">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5642197">nb</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5642208">int64</span>&nbsp;<span class="comment" id="5642214">//&nbsp;number&nbsp;of&nbsp;unwritten&nbsp;bytes&nbsp;for&nbsp;current&nbsp;file&nbsp;entry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5642267">pad</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5642278">int64</span>&nbsp;<span class="comment" id="5642284">//&nbsp;amount&nbsp;of&nbsp;padding&nbsp;to&nbsp;write&nbsp;after&nbsp;current&nbsp;file&nbsp;entry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5642340">closed</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5642351">bool</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5642357">usedBinary</span>&nbsp;<span class="builtintype" id="5642368">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5642384">//&nbsp;whether&nbsp;the&nbsp;binary&nbsp;numeric&nbsp;field&nbsp;extension&nbsp;was&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5642440">preferPax</span>&nbsp;&nbsp;<span class="builtintype" id="5642451">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5642467">//&nbsp;use&nbsp;pax&nbsp;header&nbsp;instead&nbsp;of&nbsp;binary&nbsp;numeric&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5642519">hdrBuff</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5642530">[</span><span class="ident" id="5642531"><a href="/gostd/archive/tar/common.go.html#5610510">blockSize</a></span><span class="op" id="5642540">]</span><span class="builtintype" id="5642541">byte</span>&nbsp;<span class="comment" id="5642546">//&nbsp;buffer&nbsp;to&nbsp;use&nbsp;in&nbsp;writeHeader&nbsp;when&nbsp;writing&nbsp;a&nbsp;regular&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5642609">paxHdrBuff</span>&nbsp;<span class="op" id="5642620">[</span><span class="ident" id="5642621"><a href="/gostd/archive/tar/common.go.html#5610510">blockSize</a></span><span class="op" id="5642630">]</span><span class="builtintype" id="5642631">byte</span>&nbsp;<span class="comment" id="5642636">//&nbsp;buffer&nbsp;to&nbsp;use&nbsp;in&nbsp;writeHeader&nbsp;when&nbsp;writing&nbsp;a&nbsp;pax&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="5642694">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5642697">//&nbsp;NewWriter&nbsp;creates&nbsp;a&nbsp;new&nbsp;Writer&nbsp;writing&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="5642745">func</span>&nbsp;<span class="ident" id="5642750">NewWriter</span><span class="op" id="5642759">(</span><span class="ident" id="5642760">w</span>&nbsp;<span class="ident" id="5642762"><a href="/gostd/archive/tar/writer.go.html#5641452">io</a></span><span class="op" id="5642764">.</span><span class="ident" id="5642765"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="5642771">)</span>&nbsp;<span class="op" id="5642773">*</span><span class="ident" id="5642774"><a href="/gostd/archive/tar/writer.go.html#5642140">Writer</a></span>&nbsp;<span class="op" id="5642781">{</span>&nbsp;<span class="keyword" id="5642783">return</span>&nbsp;<span class="op" id="5642790">&amp;</span><span class="ident" id="5642791"><a href="/gostd/archive/tar/writer.go.html#5642140">Writer</a></span><span class="op" id="5642797">{</span><span class="ident" id="5642798"><a href="/gostd/archive/tar/writer.go.html#5642157">w</a></span><span class="op" id="5642799">:</span>&nbsp;<span class="ident" id="5642801"><a href="/gostd/archive/tar/writer.go.html#5642760">w</a></span><span class="op" id="5642802">}</span>&nbsp;<span class="op" id="5642804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5642807">//&nbsp;Flush&nbsp;finishes&nbsp;writing&nbsp;the&nbsp;current&nbsp;file&nbsp;(optional).</span><br>
<span class="lineno">50</span><span class="keyword" id="5642862">func</span>&nbsp;<span class="op" id="5642867">(</span><span class="ident" id="5642868">tw</span>&nbsp;<span class="op" id="5642871">*</span><span class="ident" id="5642872"><a href="/gostd/archive/tar/writer.go.html#5642140">Writer</a></span><span class="op" id="5642878">)</span>&nbsp;<span class="ident" id="5642880">Flush</span><span class="op" id="5642885">(</span><span class="op" id="5642886">)</span>&nbsp;<span class="builtintype" id="5642888">error</span>&nbsp;<span class="op" id="5642894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5642897">if</span>&nbsp;<span class="ident" id="5642900"><a href="/gostd/archive/tar/writer.go.html#5642868">tw</a></span><span class="op" id="5642902">.</span><span class="ident" id="5642903"><a href="/gostd/archive/tar/writer.go.html#5642197">nb</a></span>&nbsp;<span class="op" id="5642906">&gt;</span>&nbsp;<span class="num" id="5642908">0</span>&nbsp;<span class="op" id="5642910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5642914"><a href="/gostd/archive/tar/writer.go.html#5642868">tw</a></span><span class="op" id="5642916">.</span><span class="ident" id="5642917"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span>&nbsp;<span class="op" id="5642921">=</span>&nbsp;<span class="ident" id="5642923"><a href="/gostd/archive/tar/writer.go.html#5641445">fmt</a></span><span class="op" id="5642926">.</span><span class="ident" id="5642927"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="5642933">(</span><span class="string" id="5642934">&#34;archive/tar:&nbsp;missed&nbsp;writing&nbsp;%d&nbsp;bytes&#34;</span><span class="op" id="5642972">,</span>&nbsp;<span class="ident" id="5642974"><a href="/gostd/archive/tar/writer.go.html#5642868">tw</a></span><span class="op" id="5642976">.</span><span class="ident" id="5642977"><a href="/gostd/archive/tar/writer.go.html#5642197">nb</a></span><span class="op" id="5642979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5642983">return</span>&nbsp;<span class="ident" id="5642990"><a href="/gostd/archive/tar/writer.go.html#5642868">tw</a></span><span class="op" id="5642992">.</span><span class="ident" id="5642993"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5642998">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5643002">n</span>&nbsp;<span class="op" id="5643004">:=</span>&nbsp;<span class="ident" id="5643007"><a href="/gostd/archive/tar/writer.go.html#5642868">tw</a></span><span class="op" id="5643009">.</span><span class="ident" id="5643010"><a href="/gostd/archive/tar/writer.go.html#5642197">nb</a></span>&nbsp;<span class="op" id="5643013">+</span>&nbsp;<span class="ident" id="5643015"><a href="/gostd/archive/tar/writer.go.html#5642868">tw</a></span><span class="op" id="5643017">.</span><span class="ident" id="5643018"><a href="/gostd/archive/tar/writer.go.html#5642267">pad</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5643023">for</span>&nbsp;<span class="ident" id="5643027"><a href="/gostd/archive/tar/writer.go.html#5643002">n</a></span>&nbsp;<span class="op" id="5643029">&gt;</span>&nbsp;<span class="num" id="5643031">0</span>&nbsp;<span class="op" id="5643033">&amp;&amp;</span>&nbsp;<span class="ident" id="5643036"><a href="/gostd/archive/tar/writer.go.html#5642868">tw</a></span><span class="op" id="5643038">.</span><span class="ident" id="5643039"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span>&nbsp;<span class="op" id="5643043">==</span>&nbsp;<span class="builtintype" id="5643046">nil</span>&nbsp;<span class="op" id="5643050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5643054">nr</span>&nbsp;<span class="op" id="5643057">:=</span>&nbsp;<span class="ident" id="5643060"><a href="/gostd/archive/tar/writer.go.html#5643002">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5643064">if</span>&nbsp;<span class="ident" id="5643067"><a href="/gostd/archive/tar/writer.go.html#5643054">nr</a></span>&nbsp;<span class="op" id="5643070">&gt;</span>&nbsp;<span class="ident" id="5643072"><a href="/gostd/archive/tar/common.go.html#5610510">blockSize</a></span>&nbsp;<span class="op" id="5643082">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5643087"><a href="/gostd/archive/tar/writer.go.html#5643054">nr</a></span>&nbsp;<span class="op" id="5643090">=</span>&nbsp;<span class="ident" id="5643092"><a href="/gostd/archive/tar/common.go.html#5610510">blockSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5643104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5643108">var</span>&nbsp;<span class="ident" id="5643112">nw</span>&nbsp;<span class="builtintype" id="5643115">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5643121"><a href="/gostd/archive/tar/writer.go.html#5643112">nw</a></span><span class="op" id="5643123">,</span>&nbsp;<span class="ident" id="5643125"><a href="/gostd/archive/tar/writer.go.html#5642868">tw</a></span><span class="op" id="5643127">.</span><span class="ident" id="5643128"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span>&nbsp;<span class="op" id="5643132">=</span>&nbsp;<span class="ident" id="5643134"><a href="/gostd/archive/tar/writer.go.html#5642868">tw</a></span><span class="op" id="5643136">.</span><span class="ident" id="5643137"><a href="/gostd/archive/tar/writer.go.html#5642157">w</a></span><span class="op" id="5643138">.</span><span class="ident" id="5643139"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="5643144">(</span><span class="ident" id="5643145"><a href="/gostd/archive/tar/common.go.html#5616783">zeroBlock</a></span><span class="op" id="5643154">[</span><span class="num" id="5643155">0</span><span class="op" id="5643156">:</span><span class="ident" id="5643157"><a href="/gostd/archive/tar/writer.go.html#5643054">nr</a></span><span class="op" id="5643159">]</span><span class="op" id="5643160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5643164"><a href="/gostd/archive/tar/writer.go.html#5643002">n</a></span>&nbsp;<span class="op" id="5643166">-=</span>&nbsp;<span class="builtintype" id="5643169">int64</span><span class="op" id="5643174">(</span><span class="ident" id="5643175"><a href="/gostd/archive/tar/writer.go.html#5643112">nw</a></span><span class="op" id="5643177">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5643180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5643183"><a href="/gostd/archive/tar/writer.go.html#5642868">tw</a></span><span class="op" id="5643185">.</span><span class="ident" id="5643186"><a href="/gostd/archive/tar/writer.go.html#5642197">nb</a></span>&nbsp;<span class="op" id="5643189">=</span>&nbsp;<span class="num" id="5643191">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5643194"><a href="/gostd/archive/tar/writer.go.html#5642868">tw</a></span><span class="op" id="5643196">.</span><span class="ident" id="5643197"><a href="/gostd/archive/tar/writer.go.html#5642267">pad</a></span>&nbsp;<span class="op" id="5643201">=</span>&nbsp;<span class="num" id="5643203">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5643206">return</span>&nbsp;<span class="ident" id="5643213"><a href="/gostd/archive/tar/writer.go.html#5642868">tw</a></span><span class="op" id="5643215">.</span><span class="ident" id="5643216"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span><br>
<span class="lineno"></span><span class="op" id="5643220">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="5643223">//&nbsp;Write&nbsp;s&nbsp;into&nbsp;b,&nbsp;terminating&nbsp;it&nbsp;with&nbsp;a&nbsp;NUL&nbsp;if&nbsp;there&nbsp;is&nbsp;room.</span><br>
<span class="lineno"></span><span class="comment" id="5643286">//&nbsp;If&nbsp;the&nbsp;value&nbsp;is&nbsp;too&nbsp;long&nbsp;for&nbsp;the&nbsp;field&nbsp;and&nbsp;allowPax&nbsp;is&nbsp;true&nbsp;add&nbsp;a&nbsp;paxheader&nbsp;record&nbsp;instead</span><br>
<span class="lineno"></span><span class="keyword" id="5643380">func</span>&nbsp;<span class="op" id="5643385">(</span><span class="ident" id="5643386">tw</span>&nbsp;<span class="op" id="5643389">*</span><span class="ident" id="5643390"><a href="/gostd/archive/tar/writer.go.html#5642140">Writer</a></span><span class="op" id="5643396">)</span>&nbsp;<span class="ident" id="5643398">cString</span><span class="op" id="5643405">(</span><span class="ident" id="5643406">b</span>&nbsp;<span class="op" id="5643408">[</span><span class="op" id="5643409">]</span><span class="builtintype" id="5643410">byte</span><span class="op" id="5643414">,</span>&nbsp;<span class="ident" id="5643416">s</span>&nbsp;<span class="builtintype" id="5643418">string</span><span class="op" id="5643424">,</span>&nbsp;<span class="ident" id="5643426">allowPax</span>&nbsp;<span class="builtintype" id="5643435">bool</span><span class="op" id="5643439">,</span>&nbsp;<span class="ident" id="5643441">paxKeyword</span>&nbsp;<span class="builtintype" id="5643452">string</span><span class="op" id="5643458">,</span>&nbsp;<span class="ident" id="5643460">paxHeaders</span>&nbsp;<span class="keyword" id="5643471">map</span><span class="op" id="5643474">[</span><span class="builtintype" id="5643475">string</span><span class="op" id="5643481">]</span><span class="builtintype" id="5643482">string</span><span class="op" id="5643488">)</span>&nbsp;<span class="op" id="5643490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5643493">needsPaxHeader</span>&nbsp;<span class="op" id="5643508">:=</span>&nbsp;<span class="ident" id="5643511"><a href="/gostd/archive/tar/writer.go.html#5643426">allowPax</a></span>&nbsp;<span class="op" id="5643520">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5643523">len</span><span class="op" id="5643526">(</span><span class="ident" id="5643527"><a href="/gostd/archive/tar/writer.go.html#5643416">s</a></span><span class="op" id="5643528">)</span>&nbsp;<span class="op" id="5643530">&gt;</span>&nbsp;<span class="builtinfunc" id="5643532">len</span><span class="op" id="5643535">(</span><span class="ident" id="5643536"><a href="/gostd/archive/tar/writer.go.html#5643406">b</a></span><span class="op" id="5643537">)</span>&nbsp;<span class="op" id="5643539">||</span>&nbsp;<span class="op" id="5643542">!</span><span class="ident" id="5643543"><a href="/gostd/archive/tar/common.go.html#5617413">isASCII</a></span><span class="op" id="5643550">(</span><span class="ident" id="5643551"><a href="/gostd/archive/tar/writer.go.html#5643416">s</a></span><span class="op" id="5643552">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5643555">if</span>&nbsp;<span class="ident" id="5643558"><a href="/gostd/archive/tar/writer.go.html#5643493">needsPaxHeader</a></span>&nbsp;<span class="op" id="5643573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5643577"><a href="/gostd/archive/tar/writer.go.html#5643460">paxHeaders</a></span><span class="op" id="5643587">[</span><span class="ident" id="5643588"><a href="/gostd/archive/tar/writer.go.html#5643441">paxKeyword</a></span><span class="op" id="5643598">]</span>&nbsp;<span class="op" id="5643600">=</span>&nbsp;<span class="ident" id="5643602"><a href="/gostd/archive/tar/writer.go.html#5643416">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5643606">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5643614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5643617">if</span>&nbsp;<span class="builtinfunc" id="5643620">len</span><span class="op" id="5643623">(</span><span class="ident" id="5643624"><a href="/gostd/archive/tar/writer.go.html#5643416">s</a></span><span class="op" id="5643625">)</span>&nbsp;<span class="op" id="5643627">&gt;</span>&nbsp;<span class="builtinfunc" id="5643629">len</span><span class="op" id="5643632">(</span><span class="ident" id="5643633"><a href="/gostd/archive/tar/writer.go.html#5643406">b</a></span><span class="op" id="5643634">)</span>&nbsp;<span class="op" id="5643636">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5643640">if</span>&nbsp;<span class="ident" id="5643643"><a href="/gostd/archive/tar/writer.go.html#5643386">tw</a></span><span class="op" id="5643645">.</span><span class="ident" id="5643646"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span>&nbsp;<span class="op" id="5643650">==</span>&nbsp;<span class="builtintype" id="5643653">nil</span>&nbsp;<span class="op" id="5643657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5643662"><a href="/gostd/archive/tar/writer.go.html#5643386">tw</a></span><span class="op" id="5643664">.</span><span class="ident" id="5643665"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span>&nbsp;<span class="op" id="5643669">=</span>&nbsp;<span class="ident" id="5643671"><a href="/gostd/archive/tar/writer.go.html#5641575">ErrFieldTooLong</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5643689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5643693">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5643701">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5643704">ascii</span>&nbsp;<span class="op" id="5643710">:=</span>&nbsp;<span class="ident" id="5643713"><a href="/gostd/archive/tar/common.go.html#5617522">toASCII</a></span><span class="op" id="5643720">(</span><span class="ident" id="5643721"><a href="/gostd/archive/tar/writer.go.html#5643416">s</a></span><span class="op" id="5643722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5643725">copy</span><span class="op" id="5643729">(</span><span class="ident" id="5643730"><a href="/gostd/archive/tar/writer.go.html#5643406">b</a></span><span class="op" id="5643731">,</span>&nbsp;<span class="ident" id="5643733"><a href="/gostd/archive/tar/writer.go.html#5643704">ascii</a></span><span class="op" id="5643738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5643741">if</span>&nbsp;<span class="builtinfunc" id="5643744">len</span><span class="op" id="5643747">(</span><span class="ident" id="5643748"><a href="/gostd/archive/tar/writer.go.html#5643704">ascii</a></span><span class="op" id="5643753">)</span>&nbsp;<span class="op" id="5643755">&lt;</span>&nbsp;<span class="builtinfunc" id="5643757">len</span><span class="op" id="5643760">(</span><span class="ident" id="5643761"><a href="/gostd/archive/tar/writer.go.html#5643406">b</a></span><span class="op" id="5643762">)</span>&nbsp;<span class="op" id="5643764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5643768"><a href="/gostd/archive/tar/writer.go.html#5643406">b</a></span><span class="op" id="5643769">[</span><span class="builtinfunc" id="5643770">len</span><span class="op" id="5643773">(</span><span class="ident" id="5643774"><a href="/gostd/archive/tar/writer.go.html#5643704">ascii</a></span><span class="op" id="5643779">)</span><span class="op" id="5643780">]</span>&nbsp;<span class="op" id="5643782">=</span>&nbsp;<span class="num" id="5643784">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5643787">}</span><br>
<span class="lineno">90</span><span class="op" id="5643789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5643792">//&nbsp;Encode&nbsp;x&nbsp;as&nbsp;an&nbsp;octal&nbsp;ASCII&nbsp;string&nbsp;and&nbsp;write&nbsp;it&nbsp;into&nbsp;b&nbsp;with&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span><span class="keyword" id="5643869">func</span>&nbsp;<span class="op" id="5643874">(</span><span class="ident" id="5643875">tw</span>&nbsp;<span class="op" id="5643878">*</span><span class="ident" id="5643879"><a href="/gostd/archive/tar/writer.go.html#5642140">Writer</a></span><span class="op" id="5643885">)</span>&nbsp;<span class="ident" id="5643887">octal</span><span class="op" id="5643892">(</span><span class="ident" id="5643893">b</span>&nbsp;<span class="op" id="5643895">[</span><span class="op" id="5643896">]</span><span class="builtintype" id="5643897">byte</span><span class="op" id="5643901">,</span>&nbsp;<span class="ident" id="5643903">x</span>&nbsp;<span class="builtintype" id="5643905">int64</span><span class="op" id="5643910">)</span>&nbsp;<span class="op" id="5643912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5643915">s</span>&nbsp;<span class="op" id="5643917">:=</span>&nbsp;<span class="ident" id="5643920"><a href="/gostd/archive/tar/writer.go.html#5641472">strconv</a></span><span class="op" id="5643927">.</span><span class="ident" id="5643928"><a href="/gostd/strconv/itoa.go.html#2407133">FormatInt</a></span><span class="op" id="5643937">(</span><span class="ident" id="5643938"><a href="/gostd/archive/tar/writer.go.html#5643903">x</a></span><span class="op" id="5643939">,</span>&nbsp;<span class="num" id="5643941">8</span><span class="op" id="5643942">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5643945">//&nbsp;leading&nbsp;zeros,&nbsp;but&nbsp;leave&nbsp;room&nbsp;for&nbsp;a&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5643990">for</span>&nbsp;<span class="builtinfunc" id="5643994">len</span><span class="op" id="5643997">(</span><span class="ident" id="5643998"><a href="/gostd/archive/tar/writer.go.html#5643915">s</a></span><span class="op" id="5643999">)</span><span class="op" id="5644000">+</span><span class="num" id="5644001">1</span>&nbsp;<span class="op" id="5644003">&lt;</span>&nbsp;<span class="builtinfunc" id="5644005">len</span><span class="op" id="5644008">(</span><span class="ident" id="5644009"><a href="/gostd/archive/tar/writer.go.html#5643893">b</a></span><span class="op" id="5644010">)</span>&nbsp;<span class="op" id="5644012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5644016"><a href="/gostd/archive/tar/writer.go.html#5643915">s</a></span>&nbsp;<span class="op" id="5644018">=</span>&nbsp;<span class="string" id="5644020">&#34;0&#34;</span>&nbsp;<span class="op" id="5644024">+</span>&nbsp;<span class="ident" id="5644026"><a href="/gostd/archive/tar/writer.go.html#5643915">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5644029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5644032"><a href="/gostd/archive/tar/writer.go.html#5643875">tw</a></span><span class="op" id="5644034">.</span><span class="ident" id="5644035"><a href="/gostd/archive/tar/writer.go.html#5643398">cString</a></span><span class="op" id="5644042">(</span><span class="ident" id="5644043"><a href="/gostd/archive/tar/writer.go.html#5643893">b</a></span><span class="op" id="5644044">,</span>&nbsp;<span class="ident" id="5644046"><a href="/gostd/archive/tar/writer.go.html#5643915">s</a></span><span class="op" id="5644047">,</span>&nbsp;<span class="builtintype" id="5644049">false</span><span class="op" id="5644054">,</span>&nbsp;<span class="ident" id="5644056"><a href="/gostd/archive/tar/common.go.html#5615195">paxNone</a></span><span class="op" id="5644063">,</span>&nbsp;<span class="builtintype" id="5644065">nil</span><span class="op" id="5644068">)</span><br>
<span class="lineno">100</span><span class="op" id="5644070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5644073">//&nbsp;Write&nbsp;x&nbsp;into&nbsp;b,&nbsp;either&nbsp;as&nbsp;octal&nbsp;or&nbsp;as&nbsp;binary&nbsp;(GNUtar/star&nbsp;extension).</span><br>
<span class="lineno"></span><span class="comment" id="5644146">//&nbsp;If&nbsp;the&nbsp;value&nbsp;is&nbsp;too&nbsp;long&nbsp;for&nbsp;the&nbsp;field&nbsp;and&nbsp;writingPax&nbsp;is&nbsp;enabled&nbsp;both&nbsp;for&nbsp;the&nbsp;field&nbsp;and&nbsp;the&nbsp;add&nbsp;a&nbsp;paxheader&nbsp;record&nbsp;instead</span><br>
<span class="lineno"></span><span class="keyword" id="5644272">func</span>&nbsp;<span class="op" id="5644277">(</span><span class="ident" id="5644278">tw</span>&nbsp;<span class="op" id="5644281">*</span><span class="ident" id="5644282"><a href="/gostd/archive/tar/writer.go.html#5642140">Writer</a></span><span class="op" id="5644288">)</span>&nbsp;<span class="ident" id="5644290">numeric</span><span class="op" id="5644297">(</span><span class="ident" id="5644298">b</span>&nbsp;<span class="op" id="5644300">[</span><span class="op" id="5644301">]</span><span class="builtintype" id="5644302">byte</span><span class="op" id="5644306">,</span>&nbsp;<span class="ident" id="5644308">x</span>&nbsp;<span class="builtintype" id="5644310">int64</span><span class="op" id="5644315">,</span>&nbsp;<span class="ident" id="5644317">allowPax</span>&nbsp;<span class="builtintype" id="5644326">bool</span><span class="op" id="5644330">,</span>&nbsp;<span class="ident" id="5644332">paxKeyword</span>&nbsp;<span class="builtintype" id="5644343">string</span><span class="op" id="5644349">,</span>&nbsp;<span class="ident" id="5644351">paxHeaders</span>&nbsp;<span class="keyword" id="5644362">map</span><span class="op" id="5644365">[</span><span class="builtintype" id="5644366">string</span><span class="op" id="5644372">]</span><span class="builtintype" id="5644373">string</span><span class="op" id="5644379">)</span>&nbsp;<span class="op" id="5644381">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5644384">//&nbsp;Try&nbsp;octal&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5644405">s</span>&nbsp;<span class="op" id="5644407">:=</span>&nbsp;<span class="ident" id="5644410"><a href="/gostd/archive/tar/writer.go.html#5641472">strconv</a></span><span class="op" id="5644417">.</span><span class="ident" id="5644418"><a href="/gostd/strconv/itoa.go.html#2407133">FormatInt</a></span><span class="op" id="5644427">(</span><span class="ident" id="5644428"><a href="/gostd/archive/tar/writer.go.html#5644308">x</a></span><span class="op" id="5644429">,</span>&nbsp;<span class="num" id="5644431">8</span><span class="op" id="5644432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5644435">if</span>&nbsp;<span class="builtinfunc" id="5644438">len</span><span class="op" id="5644441">(</span><span class="ident" id="5644442"><a href="/gostd/archive/tar/writer.go.html#5644405">s</a></span><span class="op" id="5644443">)</span>&nbsp;<span class="op" id="5644445">&lt;</span>&nbsp;<span class="builtinfunc" id="5644447">len</span><span class="op" id="5644450">(</span><span class="ident" id="5644451"><a href="/gostd/archive/tar/writer.go.html#5644298">b</a></span><span class="op" id="5644452">)</span>&nbsp;<span class="op" id="5644454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5644458"><a href="/gostd/archive/tar/writer.go.html#5644278">tw</a></span><span class="op" id="5644460">.</span><span class="ident" id="5644461"><a href="/gostd/archive/tar/writer.go.html#5643887">octal</a></span><span class="op" id="5644466">(</span><span class="ident" id="5644467"><a href="/gostd/archive/tar/writer.go.html#5644298">b</a></span><span class="op" id="5644468">,</span>&nbsp;<span class="ident" id="5644470"><a href="/gostd/archive/tar/writer.go.html#5644308">x</a></span><span class="op" id="5644471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5644475">return</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5644483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5644487">//&nbsp;If&nbsp;it&nbsp;is&nbsp;too&nbsp;long&nbsp;for&nbsp;octal,&nbsp;and&nbsp;pax&nbsp;is&nbsp;preferred,&nbsp;use&nbsp;a&nbsp;pax&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5644559">if</span>&nbsp;<span class="ident" id="5644562"><a href="/gostd/archive/tar/writer.go.html#5644317">allowPax</a></span>&nbsp;<span class="op" id="5644571">&amp;&amp;</span>&nbsp;<span class="ident" id="5644574"><a href="/gostd/archive/tar/writer.go.html#5644278">tw</a></span><span class="op" id="5644576">.</span><span class="ident" id="5644577"><a href="/gostd/archive/tar/writer.go.html#5642440">preferPax</a></span>&nbsp;<span class="op" id="5644587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5644591"><a href="/gostd/archive/tar/writer.go.html#5644278">tw</a></span><span class="op" id="5644593">.</span><span class="ident" id="5644594"><a href="/gostd/archive/tar/writer.go.html#5643887">octal</a></span><span class="op" id="5644599">(</span><span class="ident" id="5644600"><a href="/gostd/archive/tar/writer.go.html#5644298">b</a></span><span class="op" id="5644601">,</span>&nbsp;<span class="num" id="5644603">0</span><span class="op" id="5644604">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5644608">s</span>&nbsp;<span class="op" id="5644610">:=</span>&nbsp;<span class="ident" id="5644613"><a href="/gostd/archive/tar/writer.go.html#5641472">strconv</a></span><span class="op" id="5644620">.</span><span class="ident" id="5644621"><a href="/gostd/strconv/itoa.go.html#2407133">FormatInt</a></span><span class="op" id="5644630">(</span><span class="ident" id="5644631"><a href="/gostd/archive/tar/writer.go.html#5644308">x</a></span><span class="op" id="5644632">,</span>&nbsp;<span class="num" id="5644634">10</span><span class="op" id="5644636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5644640"><a href="/gostd/archive/tar/writer.go.html#5644351">paxHeaders</a></span><span class="op" id="5644650">[</span><span class="ident" id="5644651"><a href="/gostd/archive/tar/writer.go.html#5644332">paxKeyword</a></span><span class="op" id="5644661">]</span>&nbsp;<span class="op" id="5644663">=</span>&nbsp;<span class="ident" id="5644665"><a href="/gostd/archive/tar/writer.go.html#5644608">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5644669">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5644677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5644681">//&nbsp;Too&nbsp;big:&nbsp;use&nbsp;binary&nbsp;(big-endian).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5644719"><a href="/gostd/archive/tar/writer.go.html#5644278">tw</a></span><span class="op" id="5644721">.</span><span class="ident" id="5644722"><a href="/gostd/archive/tar/writer.go.html#5642357">usedBinary</a></span>&nbsp;<span class="op" id="5644733">=</span>&nbsp;<span class="builtintype" id="5644735">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5644741">for</span>&nbsp;<span class="ident" id="5644745">i</span>&nbsp;<span class="op" id="5644747">:=</span>&nbsp;<span class="builtinfunc" id="5644750">len</span><span class="op" id="5644753">(</span><span class="ident" id="5644754"><a href="/gostd/archive/tar/writer.go.html#5644298">b</a></span><span class="op" id="5644755">)</span>&nbsp;<span class="op" id="5644757">-</span>&nbsp;<span class="num" id="5644759">1</span><span class="op" id="5644760">;</span>&nbsp;<span class="ident" id="5644762"><a href="/gostd/archive/tar/writer.go.html#5644308">x</a></span>&nbsp;<span class="op" id="5644764">&gt;</span>&nbsp;<span class="num" id="5644766">0</span>&nbsp;<span class="op" id="5644768">&amp;&amp;</span>&nbsp;<span class="ident" id="5644771"><a href="/gostd/archive/tar/writer.go.html#5644745">i</a></span>&nbsp;<span class="op" id="5644773">&gt;=</span>&nbsp;<span class="num" id="5644776">0</span><span class="op" id="5644777">;</span>&nbsp;<span class="ident" id="5644779"><a href="/gostd/archive/tar/writer.go.html#5644745">i</a></span><span class="op" id="5644780">--</span>&nbsp;<span class="op" id="5644783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5644787"><a href="/gostd/archive/tar/writer.go.html#5644298">b</a></span><span class="op" id="5644788">[</span><span class="ident" id="5644789"><a href="/gostd/archive/tar/writer.go.html#5644745">i</a></span><span class="op" id="5644790">]</span>&nbsp;<span class="op" id="5644792">=</span>&nbsp;<span class="builtintype" id="5644794">byte</span><span class="op" id="5644798">(</span><span class="ident" id="5644799"><a href="/gostd/archive/tar/writer.go.html#5644308">x</a></span><span class="op" id="5644800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5644804"><a href="/gostd/archive/tar/writer.go.html#5644308">x</a></span>&nbsp;<span class="op" id="5644806">&gt;&gt;=</span>&nbsp;<span class="num" id="5644810">8</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5644813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5644816"><a href="/gostd/archive/tar/writer.go.html#5644298">b</a></span><span class="op" id="5644817">[</span><span class="num" id="5644818">0</span><span class="op" id="5644819">]</span>&nbsp;<span class="op" id="5644821">|=</span>&nbsp;<span class="num" id="5644824">0x80</span>&nbsp;<span class="comment" id="5644829">//&nbsp;highest&nbsp;bit&nbsp;indicates&nbsp;binary&nbsp;format</span><br>
<span class="lineno"></span><span class="op" id="5644868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5644871">var</span>&nbsp;<span class="op" id="5644875">(</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5644878">minTime</span>&nbsp;<span class="op" id="5644886">=</span>&nbsp;<span class="ident" id="5644888"><a href="/gostd/archive/tar/writer.go.html#5641494">time</a></span><span class="op" id="5644892">.</span><span class="ident" id="5644893"><a href="/gostd/time/time.go.html#2748704">Unix</a></span><span class="op" id="5644897">(</span><span class="num" id="5644898">0</span><span class="op" id="5644899">,</span>&nbsp;<span class="num" id="5644901">0</span><span class="op" id="5644902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5644905">//&nbsp;There&nbsp;is&nbsp;room&nbsp;for&nbsp;11&nbsp;octal&nbsp;digits&nbsp;(33&nbsp;bits)&nbsp;of&nbsp;mtime.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5644963">maxTime</span>&nbsp;<span class="op" id="5644971">=</span>&nbsp;<span class="ident" id="5644973"><a href="/gostd/archive/tar/writer.go.html#5644878">minTime</a></span><span class="op" id="5644980">.</span><span class="ident" id="5644981"><a href="/gostd/time/time.go.html#2738615">Add</a></span><span class="op" id="5644984">(</span><span class="op" id="5644985">(</span><span class="num" id="5644986">1</span><span class="op" id="5644987">&lt;&lt;</span><span class="num" id="5644989">33</span>&nbsp;<span class="op" id="5644992">-</span>&nbsp;<span class="num" id="5644994">1</span><span class="op" id="5644995">)</span>&nbsp;<span class="op" id="5644997">*</span>&nbsp;<span class="ident" id="5644999"><a href="/gostd/archive/tar/writer.go.html#5641494">time</a></span><span class="op" id="5645003">.</span><span class="ident" id="5645004"><a href="/gostd/time/time.go.html#2734862">Second</a></span><span class="op" id="5645010">)</span><br>
<span class="lineno"></span><span class="op" id="5645012">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="5645015">//&nbsp;WriteHeader&nbsp;writes&nbsp;hdr&nbsp;and&nbsp;prepares&nbsp;to&nbsp;accept&nbsp;the&nbsp;file&#39;s&nbsp;contents.</span><br>
<span class="lineno"></span><span class="comment" id="5645085">//&nbsp;WriteHeader&nbsp;calls&nbsp;Flush&nbsp;if&nbsp;it&nbsp;is&nbsp;not&nbsp;the&nbsp;first&nbsp;header.</span><br>
<span class="lineno"></span><span class="comment" id="5645143">//&nbsp;Calling&nbsp;after&nbsp;a&nbsp;Close&nbsp;will&nbsp;return&nbsp;ErrWriteAfterClose.</span><br>
<span class="lineno"></span><span class="keyword" id="5645200">func</span>&nbsp;<span class="op" id="5645205">(</span><span class="ident" id="5645206">tw</span>&nbsp;<span class="op" id="5645209">*</span><span class="ident" id="5645210"><a href="/gostd/archive/tar/writer.go.html#5642140">Writer</a></span><span class="op" id="5645216">)</span>&nbsp;<span class="ident" id="5645218">WriteHeader</span><span class="op" id="5645229">(</span><span class="ident" id="5645230">hdr</span>&nbsp;<span class="op" id="5645234">*</span><span class="ident" id="5645235"><a href="/gostd/archive/tar/common.go.html#5611313">Header</a></span><span class="op" id="5645241">)</span>&nbsp;<span class="builtintype" id="5645243">error</span>&nbsp;<span class="op" id="5645249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5645252">return</span>&nbsp;<span class="ident" id="5645259"><a href="/gostd/archive/tar/writer.go.html#5645206">tw</a></span><span class="op" id="5645261">.</span><span class="ident" id="5645262"><a href="/gostd/archive/tar/writer.go.html#5645600">writeHeader</a></span><span class="op" id="5645273">(</span><span class="ident" id="5645274"><a href="/gostd/archive/tar/writer.go.html#5645230">hdr</a></span><span class="op" id="5645277">,</span>&nbsp;<span class="builtintype" id="5645279">true</span><span class="op" id="5645283">)</span><br>
<span class="lineno">140</span><span class="op" id="5645285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5645288">//&nbsp;WriteHeader&nbsp;writes&nbsp;hdr&nbsp;and&nbsp;prepares&nbsp;to&nbsp;accept&nbsp;the&nbsp;file&#39;s&nbsp;contents.</span><br>
<span class="lineno"></span><span class="comment" id="5645358">//&nbsp;WriteHeader&nbsp;calls&nbsp;Flush&nbsp;if&nbsp;it&nbsp;is&nbsp;not&nbsp;the&nbsp;first&nbsp;header.</span><br>
<span class="lineno"></span><span class="comment" id="5645416">//&nbsp;Calling&nbsp;after&nbsp;a&nbsp;Close&nbsp;will&nbsp;return&nbsp;ErrWriteAfterClose.</span><br>
<span class="lineno">145</span><span class="comment" id="5645473">//&nbsp;As&nbsp;this&nbsp;method&nbsp;is&nbsp;called&nbsp;internally&nbsp;by&nbsp;writePax&nbsp;header&nbsp;to&nbsp;allow&nbsp;it&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5645546">//&nbsp;suppress&nbsp;writing&nbsp;the&nbsp;pax&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5645582">func</span>&nbsp;<span class="op" id="5645587">(</span><span class="ident" id="5645588">tw</span>&nbsp;<span class="op" id="5645591">*</span><span class="ident" id="5645592"><a href="/gostd/archive/tar/writer.go.html#5642140">Writer</a></span><span class="op" id="5645598">)</span>&nbsp;<span class="ident" id="5645600">writeHeader</span><span class="op" id="5645611">(</span><span class="ident" id="5645612">hdr</span>&nbsp;<span class="op" id="5645616">*</span><span class="ident" id="5645617"><a href="/gostd/archive/tar/common.go.html#5611313">Header</a></span><span class="op" id="5645623">,</span>&nbsp;<span class="ident" id="5645625">allowPax</span>&nbsp;<span class="builtintype" id="5645634">bool</span><span class="op" id="5645638">)</span>&nbsp;<span class="builtintype" id="5645640">error</span>&nbsp;<span class="op" id="5645646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5645649">if</span>&nbsp;<span class="ident" id="5645652"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5645654">.</span><span class="ident" id="5645655"><a href="/gostd/archive/tar/writer.go.html#5642340">closed</a></span>&nbsp;<span class="op" id="5645662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5645666">return</span>&nbsp;<span class="ident" id="5645673"><a href="/gostd/archive/tar/writer.go.html#5641646">ErrWriteAfterClose</a></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5645693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5645696">if</span>&nbsp;<span class="ident" id="5645699"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5645701">.</span><span class="ident" id="5645702"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span>&nbsp;<span class="op" id="5645706">==</span>&nbsp;<span class="builtintype" id="5645709">nil</span>&nbsp;<span class="op" id="5645713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5645717"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5645719">.</span><span class="ident" id="5645720"><a href="/gostd/archive/tar/writer.go.html#5642880">Flush</a></span><span class="op" id="5645725">(</span><span class="op" id="5645726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5645729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5645732">if</span>&nbsp;<span class="ident" id="5645735"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5645737">.</span><span class="ident" id="5645738"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span>&nbsp;<span class="op" id="5645742">!=</span>&nbsp;<span class="builtintype" id="5645745">nil</span>&nbsp;<span class="op" id="5645749">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5645753">return</span>&nbsp;<span class="ident" id="5645760"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5645762">.</span><span class="ident" id="5645763"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5645768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5645772">//&nbsp;a&nbsp;map&nbsp;to&nbsp;hold&nbsp;pax&nbsp;header&nbsp;records,&nbsp;if&nbsp;any&nbsp;are&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5645828">paxHeaders</span>&nbsp;<span class="op" id="5645839">:=</span>&nbsp;<span class="builtinfunc" id="5645842">make</span><span class="op" id="5645846">(</span><span class="keyword" id="5645847">map</span><span class="op" id="5645850">[</span><span class="builtintype" id="5645851">string</span><span class="op" id="5645857">]</span><span class="builtintype" id="5645858">string</span><span class="op" id="5645864">)</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5645868">//&nbsp;TODO(shanemhansen):&nbsp;we&nbsp;might&nbsp;want&nbsp;to&nbsp;use&nbsp;PAX&nbsp;headers&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5645929">//&nbsp;subsecond&nbsp;time&nbsp;resolution,&nbsp;but&nbsp;for&nbsp;now&nbsp;let&#39;s&nbsp;just&nbsp;capture</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5645991">//&nbsp;too&nbsp;long&nbsp;fields&nbsp;or&nbsp;non&nbsp;ascii&nbsp;characters</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5646036">var</span>&nbsp;<span class="ident" id="5646040">header</span>&nbsp;<span class="op" id="5646047">[</span><span class="op" id="5646048">]</span><span class="builtintype" id="5646049">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5646056">//&nbsp;We&nbsp;need&nbsp;to&nbsp;select&nbsp;which&nbsp;scratch&nbsp;buffer&nbsp;to&nbsp;use&nbsp;carefully,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5646117">//&nbsp;since&nbsp;this&nbsp;method&nbsp;is&nbsp;called&nbsp;recursively&nbsp;to&nbsp;write&nbsp;PAX&nbsp;headers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5646183">//&nbsp;If&nbsp;allowPax&nbsp;is&nbsp;true,&nbsp;this&nbsp;is&nbsp;the&nbsp;non-recursive&nbsp;call,&nbsp;and&nbsp;we&nbsp;will&nbsp;use&nbsp;hdrBuff.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5646265">//&nbsp;If&nbsp;allowPax&nbsp;is&nbsp;false,&nbsp;we&nbsp;are&nbsp;being&nbsp;called&nbsp;by&nbsp;writePAXHeader,&nbsp;and&nbsp;hdrBuff&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5646345">//&nbsp;already&nbsp;being&nbsp;used&nbsp;by&nbsp;the&nbsp;non-recursive&nbsp;call,&nbsp;so&nbsp;we&nbsp;must&nbsp;use&nbsp;paxHdrBuff.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5646422"><a href="/gostd/archive/tar/writer.go.html#5646040">header</a></span>&nbsp;<span class="op" id="5646429">=</span>&nbsp;<span class="ident" id="5646431"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5646433">.</span><span class="ident" id="5646434"><a href="/gostd/archive/tar/writer.go.html#5642519">hdrBuff</a></span><span class="op" id="5646441">[</span><span class="op" id="5646442">:</span><span class="op" id="5646443">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5646446">if</span>&nbsp;<span class="op" id="5646449">!</span><span class="ident" id="5646450"><a href="/gostd/archive/tar/writer.go.html#5645625">allowPax</a></span>&nbsp;<span class="op" id="5646459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5646463"><a href="/gostd/archive/tar/writer.go.html#5646040">header</a></span>&nbsp;<span class="op" id="5646470">=</span>&nbsp;<span class="ident" id="5646472"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5646474">.</span><span class="ident" id="5646475"><a href="/gostd/archive/tar/writer.go.html#5642609">paxHdrBuff</a></span><span class="op" id="5646485">[</span><span class="op" id="5646486">:</span><span class="op" id="5646487">]</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5646490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5646493">copy</span><span class="op" id="5646497">(</span><span class="ident" id="5646498"><a href="/gostd/archive/tar/writer.go.html#5646040">header</a></span><span class="op" id="5646504">,</span>&nbsp;<span class="ident" id="5646506"><a href="/gostd/archive/tar/common.go.html#5616783">zeroBlock</a></span><span class="op" id="5646515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5646518">s</span>&nbsp;<span class="op" id="5646520">:=</span>&nbsp;<span class="ident" id="5646523"><a href="/gostd/archive/tar/common.go.html#5617305">slicer</a></span><span class="op" id="5646529">(</span><span class="ident" id="5646530"><a href="/gostd/archive/tar/writer.go.html#5646040">header</a></span><span class="op" id="5646536">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5646540">//&nbsp;keep&nbsp;a&nbsp;reference&nbsp;to&nbsp;the&nbsp;filename&nbsp;to&nbsp;allow&nbsp;to&nbsp;overwrite&nbsp;it&nbsp;later&nbsp;if&nbsp;we&nbsp;detect&nbsp;that&nbsp;we&nbsp;can&nbsp;use&nbsp;ustar&nbsp;longnames&nbsp;instead&nbsp;of&nbsp;pax</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5646668">pathHeaderBytes</span>&nbsp;<span class="op" id="5646684">:=</span>&nbsp;<span class="ident" id="5646687"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5646688">.</span><span class="ident" id="5646689"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5646693">(</span><span class="ident" id="5646694"><a href="/gostd/archive/tar/common.go.html#5612074">fileNameSize</a></span><span class="op" id="5646706">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5646710"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5646712">.</span><span class="ident" id="5646713"><a href="/gostd/archive/tar/writer.go.html#5643398">cString</a></span><span class="op" id="5646720">(</span><span class="ident" id="5646721"><a href="/gostd/archive/tar/writer.go.html#5646668">pathHeaderBytes</a></span><span class="op" id="5646736">,</span>&nbsp;<span class="ident" id="5646738"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5646741">.</span><span class="ident" id="5646742"><a href="/gostd/archive/tar/common.go.html#5611330">Name</a></span><span class="op" id="5646746">,</span>&nbsp;<span class="builtintype" id="5646748">true</span><span class="op" id="5646752">,</span>&nbsp;<span class="ident" id="5646754"><a href="/gostd/archive/tar/common.go.html#5615076">paxPath</a></span><span class="op" id="5646761">,</span>&nbsp;<span class="ident" id="5646763"><a href="/gostd/archive/tar/writer.go.html#5645828">paxHeaders</a></span><span class="op" id="5646773">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5646777">//&nbsp;Handle&nbsp;out&nbsp;of&nbsp;range&nbsp;ModTime&nbsp;carefully.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5646820">var</span>&nbsp;<span class="ident" id="5646824">modTime</span>&nbsp;<span class="builtintype" id="5646832">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5646839">if</span>&nbsp;<span class="op" id="5646842">!</span><span class="ident" id="5646843"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5646846">.</span><span class="ident" id="5646847"><a href="/gostd/archive/tar/common.go.html#5611557">ModTime</a></span><span class="op" id="5646854">.</span><span class="ident" id="5646855"><a href="/gostd/time/time.go.html#2722823">Before</a></span><span class="op" id="5646861">(</span><span class="ident" id="5646862"><a href="/gostd/archive/tar/writer.go.html#5644878">minTime</a></span><span class="op" id="5646869">)</span>&nbsp;<span class="op" id="5646871">&amp;&amp;</span>&nbsp;<span class="op" id="5646874">!</span><span class="ident" id="5646875"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5646878">.</span><span class="ident" id="5646879"><a href="/gostd/archive/tar/common.go.html#5611557">ModTime</a></span><span class="op" id="5646886">.</span><span class="ident" id="5646887"><a href="/gostd/time/time.go.html#2722668">After</a></span><span class="op" id="5646892">(</span><span class="ident" id="5646893"><a href="/gostd/archive/tar/writer.go.html#5644963">maxTime</a></span><span class="op" id="5646900">)</span>&nbsp;<span class="op" id="5646902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5646906"><a href="/gostd/archive/tar/writer.go.html#5646824">modTime</a></span>&nbsp;<span class="op" id="5646914">=</span>&nbsp;<span class="ident" id="5646916"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5646919">.</span><span class="ident" id="5646920"><a href="/gostd/archive/tar/common.go.html#5611557">ModTime</a></span><span class="op" id="5646927">.</span><span class="ident" id="5646928"><a href="/gostd/time/time.go.html#2744150">Unix</a></span><span class="op" id="5646932">(</span><span class="op" id="5646933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5646936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5646940"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5646942">.</span><span class="ident" id="5646943"><a href="/gostd/archive/tar/writer.go.html#5643887">octal</a></span><span class="op" id="5646948">(</span><span class="ident" id="5646949"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5646950">.</span><span class="ident" id="5646951"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5646955">(</span><span class="num" id="5646956">8</span><span class="op" id="5646957">)</span><span class="op" id="5646958">,</span>&nbsp;<span class="ident" id="5646960"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5646963">.</span><span class="ident" id="5646964"><a href="/gostd/archive/tar/common.go.html#5611381">Mode</a></span><span class="op" id="5646968">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5647004">//&nbsp;100:108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5647016"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5647018">.</span><span class="ident" id="5647019"><a href="/gostd/archive/tar/writer.go.html#5644290">numeric</a></span><span class="op" id="5647026">(</span><span class="ident" id="5647027"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5647028">.</span><span class="ident" id="5647029"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5647033">(</span><span class="num" id="5647034">8</span><span class="op" id="5647035">)</span><span class="op" id="5647036">,</span>&nbsp;<span class="builtintype" id="5647038">int64</span><span class="op" id="5647043">(</span><span class="ident" id="5647044"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5647047">.</span><span class="ident" id="5647048"><a href="/gostd/archive/tar/common.go.html#5611431">Uid</a></span><span class="op" id="5647051">)</span><span class="op" id="5647052">,</span>&nbsp;<span class="builtintype" id="5647054">true</span><span class="op" id="5647058">,</span>&nbsp;<span class="ident" id="5647060"><a href="/gostd/archive/tar/common.go.html#5615120">paxUid</a></span><span class="op" id="5647066">,</span>&nbsp;<span class="ident" id="5647068"><a href="/gostd/archive/tar/writer.go.html#5645828">paxHeaders</a></span><span class="op" id="5647078">)</span>&nbsp;<span class="comment" id="5647080">//&nbsp;108:116</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5647092"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5647094">.</span><span class="ident" id="5647095"><a href="/gostd/archive/tar/writer.go.html#5644290">numeric</a></span><span class="op" id="5647102">(</span><span class="ident" id="5647103"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5647104">.</span><span class="ident" id="5647105"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5647109">(</span><span class="num" id="5647110">8</span><span class="op" id="5647111">)</span><span class="op" id="5647112">,</span>&nbsp;<span class="builtintype" id="5647114">int64</span><span class="op" id="5647119">(</span><span class="ident" id="5647120"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5647123">.</span><span class="ident" id="5647124"><a href="/gostd/archive/tar/common.go.html#5611473">Gid</a></span><span class="op" id="5647127">)</span><span class="op" id="5647128">,</span>&nbsp;<span class="builtintype" id="5647130">true</span><span class="op" id="5647134">,</span>&nbsp;<span class="ident" id="5647136"><a href="/gostd/archive/tar/common.go.html#5614983">paxGid</a></span><span class="op" id="5647142">,</span>&nbsp;<span class="ident" id="5647144"><a href="/gostd/archive/tar/writer.go.html#5645828">paxHeaders</a></span><span class="op" id="5647154">)</span>&nbsp;<span class="comment" id="5647156">//&nbsp;116:124</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5647168"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5647170">.</span><span class="ident" id="5647171"><a href="/gostd/archive/tar/writer.go.html#5644290">numeric</a></span><span class="op" id="5647178">(</span><span class="ident" id="5647179"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5647180">.</span><span class="ident" id="5647181"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5647185">(</span><span class="num" id="5647186">12</span><span class="op" id="5647188">)</span><span class="op" id="5647189">,</span>&nbsp;<span class="ident" id="5647191"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5647194">.</span><span class="ident" id="5647195"><a href="/gostd/archive/tar/common.go.html#5611516">Size</a></span><span class="op" id="5647199">,</span>&nbsp;<span class="builtintype" id="5647201">true</span><span class="op" id="5647205">,</span>&nbsp;<span class="ident" id="5647207"><a href="/gostd/archive/tar/common.go.html#5615098">paxSize</a></span><span class="op" id="5647214">,</span>&nbsp;<span class="ident" id="5647216"><a href="/gostd/archive/tar/writer.go.html#5645828">paxHeaders</a></span><span class="op" id="5647226">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5647232">//&nbsp;124:136</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5647244"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5647246">.</span><span class="ident" id="5647247"><a href="/gostd/archive/tar/writer.go.html#5644290">numeric</a></span><span class="op" id="5647254">(</span><span class="ident" id="5647255"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5647256">.</span><span class="ident" id="5647257"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5647261">(</span><span class="num" id="5647262">12</span><span class="op" id="5647264">)</span><span class="op" id="5647265">,</span>&nbsp;<span class="ident" id="5647267"><a href="/gostd/archive/tar/writer.go.html#5646824">modTime</a></span><span class="op" id="5647274">,</span>&nbsp;<span class="builtintype" id="5647276">false</span><span class="op" id="5647281">,</span>&nbsp;<span class="ident" id="5647283"><a href="/gostd/archive/tar/common.go.html#5615195">paxNone</a></span><span class="op" id="5647290">,</span>&nbsp;<span class="builtintype" id="5647292">nil</span><span class="op" id="5647295">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5647308">//&nbsp;136:148&nbsp;---&nbsp;consider&nbsp;using&nbsp;pax&nbsp;for&nbsp;finer&nbsp;granularity</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5647365"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5647366">.</span><span class="ident" id="5647367"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5647371">(</span><span class="num" id="5647372">8</span><span class="op" id="5647373">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5647429">//&nbsp;chksum&nbsp;(148:156)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5647450"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5647451">.</span><span class="ident" id="5647452"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5647456">(</span><span class="num" id="5647457">1</span><span class="op" id="5647458">)</span><span class="op" id="5647459">[</span><span class="num" id="5647460">0</span><span class="op" id="5647461">]</span>&nbsp;<span class="op" id="5647463">=</span>&nbsp;<span class="ident" id="5647465"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5647468">.</span><span class="ident" id="5647469"><a href="/gostd/archive/tar/common.go.html#5611596">Typeflag</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5647514">//&nbsp;156:157</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5647527"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5647529">.</span><span class="ident" id="5647530"><a href="/gostd/archive/tar/writer.go.html#5643398">cString</a></span><span class="op" id="5647537">(</span><span class="ident" id="5647538"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5647539">.</span><span class="ident" id="5647540"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5647544">(</span><span class="num" id="5647545">100</span><span class="op" id="5647548">)</span><span class="op" id="5647549">,</span>&nbsp;<span class="ident" id="5647551"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5647554">.</span><span class="ident" id="5647555"><a href="/gostd/archive/tar/common.go.html#5611642">Linkname</a></span><span class="op" id="5647563">,</span>&nbsp;<span class="builtintype" id="5647565">true</span><span class="op" id="5647569">,</span>&nbsp;<span class="ident" id="5647571"><a href="/gostd/archive/tar/common.go.html#5615027">paxLinkpath</a></span><span class="op" id="5647582">,</span>&nbsp;<span class="ident" id="5647584"><a href="/gostd/archive/tar/writer.go.html#5645828">paxHeaders</a></span><span class="op" id="5647594">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5647598">copy</span><span class="op" id="5647602">(</span><span class="ident" id="5647603"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5647604">.</span><span class="ident" id="5647605"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5647609">(</span><span class="num" id="5647610">8</span><span class="op" id="5647611">)</span><span class="op" id="5647612">,</span>&nbsp;<span class="op" id="5647614">[</span><span class="op" id="5647615">]</span><span class="builtintype" id="5647616">byte</span><span class="op" id="5647620">(</span><span class="string" id="5647621">&#34;ustar\x0000&#34;</span><span class="op" id="5647634">)</span><span class="op" id="5647635">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5647660">//&nbsp;257:265</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5647672"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5647674">.</span><span class="ident" id="5647675"><a href="/gostd/archive/tar/writer.go.html#5643398">cString</a></span><span class="op" id="5647682">(</span><span class="ident" id="5647683"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5647684">.</span><span class="ident" id="5647685"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5647689">(</span><span class="num" id="5647690">32</span><span class="op" id="5647692">)</span><span class="op" id="5647693">,</span>&nbsp;<span class="ident" id="5647695"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5647698">.</span><span class="ident" id="5647699"><a href="/gostd/archive/tar/common.go.html#5611687">Uname</a></span><span class="op" id="5647704">,</span>&nbsp;<span class="builtintype" id="5647706">true</span><span class="op" id="5647710">,</span>&nbsp;<span class="ident" id="5647712"><a href="/gostd/archive/tar/common.go.html#5615141">paxUname</a></span><span class="op" id="5647720">,</span>&nbsp;<span class="ident" id="5647722"><a href="/gostd/archive/tar/writer.go.html#5645828">paxHeaders</a></span><span class="op" id="5647732">)</span>&nbsp;<span class="comment" id="5647734">//&nbsp;265:297</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5647746"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5647748">.</span><span class="ident" id="5647749"><a href="/gostd/archive/tar/writer.go.html#5643398">cString</a></span><span class="op" id="5647756">(</span><span class="ident" id="5647757"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5647758">.</span><span class="ident" id="5647759"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5647763">(</span><span class="num" id="5647764">32</span><span class="op" id="5647766">)</span><span class="op" id="5647767">,</span>&nbsp;<span class="ident" id="5647769"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5647772">.</span><span class="ident" id="5647773"><a href="/gostd/archive/tar/common.go.html#5611731">Gname</a></span><span class="op" id="5647778">,</span>&nbsp;<span class="builtintype" id="5647780">true</span><span class="op" id="5647784">,</span>&nbsp;<span class="ident" id="5647786"><a href="/gostd/archive/tar/common.go.html#5615004">paxGname</a></span><span class="op" id="5647794">,</span>&nbsp;<span class="ident" id="5647796"><a href="/gostd/archive/tar/writer.go.html#5645828">paxHeaders</a></span><span class="op" id="5647806">)</span>&nbsp;<span class="comment" id="5647808">//&nbsp;297:329</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5647820"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5647822">.</span><span class="ident" id="5647823"><a href="/gostd/archive/tar/writer.go.html#5644290">numeric</a></span><span class="op" id="5647830">(</span><span class="ident" id="5647831"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5647832">.</span><span class="ident" id="5647833"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5647837">(</span><span class="num" id="5647838">8</span><span class="op" id="5647839">)</span><span class="op" id="5647840">,</span>&nbsp;<span class="ident" id="5647842"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5647845">.</span><span class="ident" id="5647846"><a href="/gostd/archive/tar/common.go.html#5611776">Devmajor</a></span><span class="op" id="5647854">,</span>&nbsp;<span class="builtintype" id="5647856">false</span><span class="op" id="5647861">,</span>&nbsp;<span class="ident" id="5647863"><a href="/gostd/archive/tar/common.go.html#5615195">paxNone</a></span><span class="op" id="5647870">,</span>&nbsp;<span class="builtintype" id="5647872">nil</span><span class="op" id="5647875">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5647882">//&nbsp;329:337</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5647894"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5647896">.</span><span class="ident" id="5647897"><a href="/gostd/archive/tar/writer.go.html#5644290">numeric</a></span><span class="op" id="5647904">(</span><span class="ident" id="5647905"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5647906">.</span><span class="ident" id="5647907"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5647911">(</span><span class="num" id="5647912">8</span><span class="op" id="5647913">)</span><span class="op" id="5647914">,</span>&nbsp;<span class="ident" id="5647916"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5647919">.</span><span class="ident" id="5647920"><a href="/gostd/archive/tar/common.go.html#5611843">Devminor</a></span><span class="op" id="5647928">,</span>&nbsp;<span class="builtintype" id="5647930">false</span><span class="op" id="5647935">,</span>&nbsp;<span class="ident" id="5647937"><a href="/gostd/archive/tar/common.go.html#5615195">paxNone</a></span><span class="op" id="5647944">,</span>&nbsp;<span class="builtintype" id="5647946">nil</span><span class="op" id="5647949">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5647956">//&nbsp;337:345</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5647969">//&nbsp;keep&nbsp;a&nbsp;reference&nbsp;to&nbsp;the&nbsp;prefix&nbsp;to&nbsp;allow&nbsp;to&nbsp;overwrite&nbsp;it&nbsp;later&nbsp;if&nbsp;we&nbsp;detect&nbsp;that&nbsp;we&nbsp;can&nbsp;use&nbsp;ustar&nbsp;longnames&nbsp;instead&nbsp;of&nbsp;pax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5648095">prefixHeaderBytes</span>&nbsp;<span class="op" id="5648113">:=</span>&nbsp;<span class="ident" id="5648116"><a href="/gostd/archive/tar/writer.go.html#5646518">s</a></span><span class="op" id="5648117">.</span><span class="ident" id="5648118"><a href="/gostd/archive/tar/common.go.html#5617338">next</a></span><span class="op" id="5648122">(</span><span class="num" id="5648123">155</span><span class="op" id="5648126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5648129"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5648131">.</span><span class="ident" id="5648132"><a href="/gostd/archive/tar/writer.go.html#5643398">cString</a></span><span class="op" id="5648139">(</span><span class="ident" id="5648140"><a href="/gostd/archive/tar/writer.go.html#5648095">prefixHeaderBytes</a></span><span class="op" id="5648157">,</span>&nbsp;<span class="string" id="5648159">&#34;&#34;</span><span class="op" id="5648161">,</span>&nbsp;<span class="builtintype" id="5648163">false</span><span class="op" id="5648168">,</span>&nbsp;<span class="ident" id="5648170"><a href="/gostd/archive/tar/common.go.html#5615195">paxNone</a></span><span class="op" id="5648177">,</span>&nbsp;<span class="builtintype" id="5648179">nil</span><span class="op" id="5648182">)</span>&nbsp;<span class="comment" id="5648184">//&nbsp;345:500&nbsp;&nbsp;prefix</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5648205">//&nbsp;Use&nbsp;the&nbsp;GNU&nbsp;magic&nbsp;instead&nbsp;of&nbsp;POSIX&nbsp;magic&nbsp;if&nbsp;we&nbsp;used&nbsp;any&nbsp;GNU&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5648281">if</span>&nbsp;<span class="ident" id="5648284"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5648286">.</span><span class="ident" id="5648287"><a href="/gostd/archive/tar/writer.go.html#5642357">usedBinary</a></span>&nbsp;<span class="op" id="5648298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5648302">copy</span><span class="op" id="5648306">(</span><span class="ident" id="5648307"><a href="/gostd/archive/tar/writer.go.html#5646040">header</a></span><span class="op" id="5648313">[</span><span class="num" id="5648314">257</span><span class="op" id="5648317">:</span><span class="num" id="5648318">265</span><span class="op" id="5648321">]</span><span class="op" id="5648322">,</span>&nbsp;<span class="op" id="5648324">[</span><span class="op" id="5648325">]</span><span class="builtintype" id="5648326">byte</span><span class="op" id="5648330">(</span><span class="string" id="5648331">&#34;ustar&nbsp;&nbsp;\x00&#34;</span><span class="op" id="5648344">)</span><span class="op" id="5648345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5648348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5648352">_</span><span class="op" id="5648353">,</span>&nbsp;<span class="ident" id="5648355">paxPathUsed</span>&nbsp;<span class="op" id="5648367">:=</span>&nbsp;<span class="ident" id="5648370"><a href="/gostd/archive/tar/writer.go.html#5645828">paxHeaders</a></span><span class="op" id="5648380">[</span><span class="ident" id="5648381"><a href="/gostd/archive/tar/common.go.html#5615076">paxPath</a></span><span class="op" id="5648388">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5648391">//&nbsp;try&nbsp;to&nbsp;use&nbsp;a&nbsp;ustar&nbsp;header&nbsp;when&nbsp;only&nbsp;the&nbsp;name&nbsp;is&nbsp;too&nbsp;long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5648452">if</span>&nbsp;<span class="op" id="5648455">!</span><span class="ident" id="5648456"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5648458">.</span><span class="ident" id="5648459"><a href="/gostd/archive/tar/writer.go.html#5642440">preferPax</a></span>&nbsp;<span class="op" id="5648469">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5648472">len</span><span class="op" id="5648475">(</span><span class="ident" id="5648476"><a href="/gostd/archive/tar/writer.go.html#5645828">paxHeaders</a></span><span class="op" id="5648486">)</span>&nbsp;<span class="op" id="5648488">==</span>&nbsp;<span class="num" id="5648491">1</span>&nbsp;<span class="op" id="5648493">&amp;&amp;</span>&nbsp;<span class="ident" id="5648496"><a href="/gostd/archive/tar/writer.go.html#5648355">paxPathUsed</a></span>&nbsp;<span class="op" id="5648508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5648512">suffix</span>&nbsp;<span class="op" id="5648519">:=</span>&nbsp;<span class="ident" id="5648522"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5648525">.</span><span class="ident" id="5648526"><a href="/gostd/archive/tar/common.go.html#5611330">Name</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5648533">prefix</span>&nbsp;<span class="op" id="5648540">:=</span>&nbsp;<span class="string" id="5648543">&#34;&#34;</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5648548">if</span>&nbsp;<span class="builtinfunc" id="5648551">len</span><span class="op" id="5648554">(</span><span class="ident" id="5648555"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5648558">.</span><span class="ident" id="5648559"><a href="/gostd/archive/tar/common.go.html#5611330">Name</a></span><span class="op" id="5648563">)</span>&nbsp;<span class="op" id="5648565">&gt;</span>&nbsp;<span class="ident" id="5648567"><a href="/gostd/archive/tar/common.go.html#5612074">fileNameSize</a></span>&nbsp;<span class="op" id="5648580">&amp;&amp;</span>&nbsp;<span class="ident" id="5648583"><a href="/gostd/archive/tar/common.go.html#5617413">isASCII</a></span><span class="op" id="5648590">(</span><span class="ident" id="5648591"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5648594">.</span><span class="ident" id="5648595"><a href="/gostd/archive/tar/common.go.html#5611330">Name</a></span><span class="op" id="5648599">)</span>&nbsp;<span class="op" id="5648601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5648606">var</span>&nbsp;<span class="ident" id="5648610">err</span>&nbsp;<span class="builtintype" id="5648614">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5648623"><a href="/gostd/archive/tar/writer.go.html#5648533">prefix</a></span><span class="op" id="5648629">,</span>&nbsp;<span class="ident" id="5648631"><a href="/gostd/archive/tar/writer.go.html#5648512">suffix</a></span><span class="op" id="5648637">,</span>&nbsp;<span class="ident" id="5648639"><a href="/gostd/archive/tar/writer.go.html#5648610">err</a></span>&nbsp;<span class="op" id="5648643">=</span>&nbsp;<span class="ident" id="5648645"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5648647">.</span><span class="ident" id="5648648"><a href="/gostd/archive/tar/writer.go.html#5650107">splitUSTARLongName</a></span><span class="op" id="5648666">(</span><span class="ident" id="5648667"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5648670">.</span><span class="ident" id="5648671"><a href="/gostd/archive/tar/common.go.html#5611330">Name</a></span><span class="op" id="5648675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5648680">if</span>&nbsp;<span class="ident" id="5648683"><a href="/gostd/archive/tar/writer.go.html#5648610">err</a></span>&nbsp;<span class="op" id="5648687">==</span>&nbsp;<span class="builtintype" id="5648690">nil</span>&nbsp;<span class="op" id="5648694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5648700">//&nbsp;ok&nbsp;we&nbsp;can&nbsp;use&nbsp;a&nbsp;ustar&nbsp;long&nbsp;name&nbsp;instead&nbsp;of&nbsp;pax,&nbsp;now&nbsp;correct&nbsp;the&nbsp;fields</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5648779">//&nbsp;remove&nbsp;the&nbsp;path&nbsp;field&nbsp;from&nbsp;the&nbsp;pax&nbsp;header.&nbsp;this&nbsp;will&nbsp;suppress&nbsp;the&nbsp;pax&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5648863">delete</span><span class="op" id="5648869">(</span><span class="ident" id="5648870"><a href="/gostd/archive/tar/writer.go.html#5645828">paxHeaders</a></span><span class="op" id="5648880">,</span>&nbsp;<span class="ident" id="5648882"><a href="/gostd/archive/tar/common.go.html#5615076">paxPath</a></span><span class="op" id="5648889">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5648896">//&nbsp;update&nbsp;the&nbsp;path&nbsp;fields</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5648926"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5648928">.</span><span class="ident" id="5648929"><a href="/gostd/archive/tar/writer.go.html#5643398">cString</a></span><span class="op" id="5648936">(</span><span class="ident" id="5648937"><a href="/gostd/archive/tar/writer.go.html#5646668">pathHeaderBytes</a></span><span class="op" id="5648952">,</span>&nbsp;<span class="ident" id="5648954"><a href="/gostd/archive/tar/writer.go.html#5648512">suffix</a></span><span class="op" id="5648960">,</span>&nbsp;<span class="builtintype" id="5648962">false</span><span class="op" id="5648967">,</span>&nbsp;<span class="ident" id="5648969"><a href="/gostd/archive/tar/common.go.html#5615195">paxNone</a></span><span class="op" id="5648976">,</span>&nbsp;<span class="builtintype" id="5648978">nil</span><span class="op" id="5648981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5648987"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5648989">.</span><span class="ident" id="5648990"><a href="/gostd/archive/tar/writer.go.html#5643398">cString</a></span><span class="op" id="5648997">(</span><span class="ident" id="5648998"><a href="/gostd/archive/tar/writer.go.html#5648095">prefixHeaderBytes</a></span><span class="op" id="5649015">,</span>&nbsp;<span class="ident" id="5649017"><a href="/gostd/archive/tar/writer.go.html#5648533">prefix</a></span><span class="op" id="5649023">,</span>&nbsp;<span class="builtintype" id="5649025">false</span><span class="op" id="5649030">,</span>&nbsp;<span class="ident" id="5649032"><a href="/gostd/archive/tar/common.go.html#5615195">paxNone</a></span><span class="op" id="5649039">,</span>&nbsp;<span class="builtintype" id="5649041">nil</span><span class="op" id="5649044">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5649051">//&nbsp;Use&nbsp;the&nbsp;ustar&nbsp;magic&nbsp;if&nbsp;we&nbsp;used&nbsp;ustar&nbsp;long&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5649107">if</span>&nbsp;<span class="builtinfunc" id="5649110">len</span><span class="op" id="5649113">(</span><span class="ident" id="5649114"><a href="/gostd/archive/tar/writer.go.html#5648533">prefix</a></span><span class="op" id="5649120">)</span>&nbsp;<span class="op" id="5649122">&gt;</span>&nbsp;<span class="num" id="5649124">0</span>&nbsp;<span class="op" id="5649126">&amp;&amp;</span>&nbsp;<span class="op" id="5649129">!</span><span class="ident" id="5649130"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5649132">.</span><span class="ident" id="5649133"><a href="/gostd/archive/tar/writer.go.html#5642357">usedBinary</a></span>&nbsp;<span class="op" id="5649144">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5649151">copy</span><span class="op" id="5649155">(</span><span class="ident" id="5649156"><a href="/gostd/archive/tar/writer.go.html#5646040">header</a></span><span class="op" id="5649162">[</span><span class="num" id="5649163">257</span><span class="op" id="5649166">:</span><span class="num" id="5649167">265</span><span class="op" id="5649170">]</span><span class="op" id="5649171">,</span>&nbsp;<span class="op" id="5649173">[</span><span class="op" id="5649174">]</span><span class="builtintype" id="5649175">byte</span><span class="op" id="5649179">(</span><span class="string" id="5649180">&#34;ustar\x00&#34;</span><span class="op" id="5649191">)</span><span class="op" id="5649192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5649198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5649203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5649207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5649210">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5649214">//&nbsp;The&nbsp;chksum&nbsp;field&nbsp;is&nbsp;terminated&nbsp;by&nbsp;a&nbsp;NUL&nbsp;and&nbsp;a&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5649271">//&nbsp;This&nbsp;is&nbsp;different&nbsp;from&nbsp;the&nbsp;other&nbsp;octal&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649322">chksum</span><span class="op" id="5649328">,</span>&nbsp;<span class="ident" id="5649330">_</span>&nbsp;<span class="op" id="5649332">:=</span>&nbsp;<span class="ident" id="5649335"><a href="/gostd/archive/tar/common.go.html#5616951">checksum</a></span><span class="op" id="5649343">(</span><span class="ident" id="5649344"><a href="/gostd/archive/tar/writer.go.html#5646040">header</a></span><span class="op" id="5649350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649353"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5649355">.</span><span class="ident" id="5649356"><a href="/gostd/archive/tar/writer.go.html#5643887">octal</a></span><span class="op" id="5649361">(</span><span class="ident" id="5649362"><a href="/gostd/archive/tar/writer.go.html#5646040">header</a></span><span class="op" id="5649368">[</span><span class="num" id="5649369">148</span><span class="op" id="5649372">:</span><span class="num" id="5649373">155</span><span class="op" id="5649376">]</span><span class="op" id="5649377">,</span>&nbsp;<span class="ident" id="5649379"><a href="/gostd/archive/tar/writer.go.html#5649322">chksum</a></span><span class="op" id="5649385">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649388"><a href="/gostd/archive/tar/writer.go.html#5646040">header</a></span><span class="op" id="5649394">[</span><span class="num" id="5649395">155</span><span class="op" id="5649398">]</span>&nbsp;<span class="op" id="5649400">=</span>&nbsp;<span class="string" id="5649402">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5649408">if</span>&nbsp;<span class="ident" id="5649411"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5649413">.</span><span class="ident" id="5649414"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span>&nbsp;<span class="op" id="5649418">!=</span>&nbsp;<span class="builtintype" id="5649421">nil</span>&nbsp;<span class="op" id="5649425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5649429">//&nbsp;problem&nbsp;with&nbsp;header;&nbsp;probably&nbsp;integer&nbsp;too&nbsp;big&nbsp;for&nbsp;a&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5649493">return</span>&nbsp;<span class="ident" id="5649500"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5649502">.</span><span class="ident" id="5649503"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5649508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5649512">if</span>&nbsp;<span class="ident" id="5649515"><a href="/gostd/archive/tar/writer.go.html#5645625">allowPax</a></span>&nbsp;<span class="op" id="5649524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5649528">for</span>&nbsp;<span class="ident" id="5649532">k</span><span class="op" id="5649533">,</span>&nbsp;<span class="ident" id="5649535">v</span>&nbsp;<span class="op" id="5649537">:=</span>&nbsp;<span class="keyword" id="5649540">range</span>&nbsp;<span class="ident" id="5649546"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5649549">.</span><span class="ident" id="5649550"><a href="/gostd/archive/tar/common.go.html#5611991">Xattrs</a></span>&nbsp;<span class="op" id="5649557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649562"><a href="/gostd/archive/tar/writer.go.html#5645828">paxHeaders</a></span><span class="op" id="5649572">[</span><span class="ident" id="5649573"><a href="/gostd/archive/tar/common.go.html#5615164">paxXattr</a></span><span class="op" id="5649581">+</span><span class="ident" id="5649582"><a href="/gostd/archive/tar/writer.go.html#5649532">k</a></span><span class="op" id="5649583">]</span>&nbsp;<span class="op" id="5649585">=</span>&nbsp;<span class="ident" id="5649587"><a href="/gostd/archive/tar/writer.go.html#5649535">v</a></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5649591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5649594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5649598">if</span>&nbsp;<span class="builtinfunc" id="5649601">len</span><span class="op" id="5649604">(</span><span class="ident" id="5649605"><a href="/gostd/archive/tar/writer.go.html#5645828">paxHeaders</a></span><span class="op" id="5649615">)</span>&nbsp;<span class="op" id="5649617">&gt;</span>&nbsp;<span class="num" id="5649619">0</span>&nbsp;<span class="op" id="5649621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5649625">if</span>&nbsp;<span class="op" id="5649628">!</span><span class="ident" id="5649629"><a href="/gostd/archive/tar/writer.go.html#5645625">allowPax</a></span>&nbsp;<span class="op" id="5649638">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5649643">return</span>&nbsp;<span class="ident" id="5649650"><a href="/gostd/archive/tar/writer.go.html#5641776">errInvalidHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5649669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5649673">if</span>&nbsp;<span class="ident" id="5649676">err</span>&nbsp;<span class="op" id="5649680">:=</span>&nbsp;<span class="ident" id="5649683"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5649685">.</span><span class="ident" id="5649686"><a href="/gostd/archive/tar/writer.go.html#5650764">writePAXHeader</a></span><span class="op" id="5649700">(</span><span class="ident" id="5649701"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5649704">,</span>&nbsp;<span class="ident" id="5649706"><a href="/gostd/archive/tar/writer.go.html#5645828">paxHeaders</a></span><span class="op" id="5649716">)</span><span class="op" id="5649717">;</span>&nbsp;<span class="ident" id="5649719"><a href="/gostd/archive/tar/writer.go.html#5649676">err</a></span>&nbsp;<span class="op" id="5649723">!=</span>&nbsp;<span class="builtintype" id="5649726">nil</span>&nbsp;<span class="op" id="5649730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5649735">return</span>&nbsp;<span class="ident" id="5649742"><a href="/gostd/archive/tar/writer.go.html#5649676">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5649748">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5649751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649754"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5649756">.</span><span class="ident" id="5649757"><a href="/gostd/archive/tar/writer.go.html#5642197">nb</a></span>&nbsp;<span class="op" id="5649760">=</span>&nbsp;<span class="builtintype" id="5649762">int64</span><span class="op" id="5649767">(</span><span class="ident" id="5649768"><a href="/gostd/archive/tar/writer.go.html#5645612">hdr</a></span><span class="op" id="5649771">.</span><span class="ident" id="5649772"><a href="/gostd/archive/tar/common.go.html#5611516">Size</a></span><span class="op" id="5649776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649779"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5649781">.</span><span class="ident" id="5649782"><a href="/gostd/archive/tar/writer.go.html#5642267">pad</a></span>&nbsp;<span class="op" id="5649786">=</span>&nbsp;<span class="op" id="5649788">(</span><span class="ident" id="5649789"><a href="/gostd/archive/tar/common.go.html#5610510">blockSize</a></span>&nbsp;<span class="op" id="5649799">-</span>&nbsp;<span class="op" id="5649801">(</span><span class="ident" id="5649802"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5649804">.</span><span class="ident" id="5649805"><a href="/gostd/archive/tar/writer.go.html#5642197">nb</a></span>&nbsp;<span class="op" id="5649808">%</span>&nbsp;<span class="ident" id="5649810"><a href="/gostd/archive/tar/common.go.html#5610510">blockSize</a></span><span class="op" id="5649819">)</span><span class="op" id="5649820">)</span>&nbsp;<span class="op" id="5649822">%</span>&nbsp;<span class="ident" id="5649824"><a href="/gostd/archive/tar/common.go.html#5610510">blockSize</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5649836">_</span><span class="op" id="5649837">,</span>&nbsp;<span class="ident" id="5649839"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5649841">.</span><span class="ident" id="5649842"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span>&nbsp;<span class="op" id="5649846">=</span>&nbsp;<span class="ident" id="5649848"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5649850">.</span><span class="ident" id="5649851"><a href="/gostd/archive/tar/writer.go.html#5642157">w</a></span><span class="op" id="5649852">.</span><span class="ident" id="5649853"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="5649858">(</span><span class="ident" id="5649859"><a href="/gostd/archive/tar/writer.go.html#5646040">header</a></span><span class="op" id="5649865">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5649868">return</span>&nbsp;<span class="ident" id="5649875"><a href="/gostd/archive/tar/writer.go.html#5645588">tw</a></span><span class="op" id="5649877">.</span><span class="ident" id="5649878"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span><br>
<span class="lineno"></span><span class="op" id="5649882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5649885">//&nbsp;writeUSTARLongName&nbsp;splits&nbsp;a&nbsp;USTAR&nbsp;long&nbsp;name&nbsp;hdr.Name.</span><br>
<span class="lineno"></span><span class="comment" id="5649942">//&nbsp;name&nbsp;must&nbsp;be&nbsp;&lt;&nbsp;256&nbsp;characters.&nbsp;errNameTooLong&nbsp;is&nbsp;returned</span><br>
<span class="lineno">275</span><span class="comment" id="5650003">//&nbsp;if&nbsp;hdr.Name&nbsp;can&#39;t&nbsp;be&nbsp;split.&nbsp;The&nbsp;splitting&nbsp;heuristic</span><br>
<span class="lineno"></span><span class="comment" id="5650058">//&nbsp;is&nbsp;compatible&nbsp;with&nbsp;gnu&nbsp;tar.</span><br>
<span class="lineno"></span><span class="keyword" id="5650089">func</span>&nbsp;<span class="op" id="5650094">(</span><span class="ident" id="5650095">tw</span>&nbsp;<span class="op" id="5650098">*</span><span class="ident" id="5650099"><a href="/gostd/archive/tar/writer.go.html#5642140">Writer</a></span><span class="op" id="5650105">)</span>&nbsp;<span class="ident" id="5650107">splitUSTARLongName</span><span class="op" id="5650125">(</span><span class="ident" id="5650126">name</span>&nbsp;<span class="builtintype" id="5650131">string</span><span class="op" id="5650137">)</span>&nbsp;<span class="op" id="5650139">(</span><span class="ident" id="5650140">prefix</span><span class="op" id="5650146">,</span>&nbsp;<span class="ident" id="5650148">suffix</span>&nbsp;<span class="builtintype" id="5650155">string</span><span class="op" id="5650161">,</span>&nbsp;<span class="ident" id="5650163">err</span>&nbsp;<span class="builtintype" id="5650167">error</span><span class="op" id="5650172">)</span>&nbsp;<span class="op" id="5650174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5650177">length</span>&nbsp;<span class="op" id="5650184">:=</span>&nbsp;<span class="builtinfunc" id="5650187">len</span><span class="op" id="5650190">(</span><span class="ident" id="5650191"><a href="/gostd/archive/tar/writer.go.html#5650126">name</a></span><span class="op" id="5650195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5650198">if</span>&nbsp;<span class="ident" id="5650201"><a href="/gostd/archive/tar/writer.go.html#5650177">length</a></span>&nbsp;<span class="op" id="5650208">&gt;</span>&nbsp;<span class="ident" id="5650210"><a href="/gostd/archive/tar/common.go.html#5612151">fileNamePrefixSize</a></span><span class="op" id="5650228">+</span><span class="num" id="5650229">1</span>&nbsp;<span class="op" id="5650231">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5650235"><a href="/gostd/archive/tar/writer.go.html#5650177">length</a></span>&nbsp;<span class="op" id="5650242">=</span>&nbsp;<span class="ident" id="5650244"><a href="/gostd/archive/tar/common.go.html#5612151">fileNamePrefixSize</a></span>&nbsp;<span class="op" id="5650263">+</span>&nbsp;<span class="num" id="5650265">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5650268">}</span>&nbsp;<span class="keyword" id="5650270">else</span>&nbsp;<span class="keyword" id="5650275">if</span>&nbsp;<span class="ident" id="5650278"><a href="/gostd/archive/tar/writer.go.html#5650126">name</a></span><span class="op" id="5650282">[</span><span class="ident" id="5650283"><a href="/gostd/archive/tar/writer.go.html#5650177">length</a></span><span class="op" id="5650289">-</span><span class="num" id="5650290">1</span><span class="op" id="5650291">]</span>&nbsp;<span class="op" id="5650293">==</span>&nbsp;<span class="string" id="5650296">&#39;/&#39;</span>&nbsp;<span class="op" id="5650300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5650304"><a href="/gostd/archive/tar/writer.go.html#5650177">length</a></span><span class="op" id="5650310">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5650314">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5650317">i</span>&nbsp;<span class="op" id="5650319">:=</span>&nbsp;<span class="ident" id="5650322"><a href="/gostd/archive/tar/writer.go.html#5641483">strings</a></span><span class="op" id="5650329">.</span><span class="ident" id="5650330"><a href="/gostd/strings/strings.go.html#2969551">LastIndex</a></span><span class="op" id="5650339">(</span><span class="ident" id="5650340"><a href="/gostd/archive/tar/writer.go.html#5650126">name</a></span><span class="op" id="5650344">[</span><span class="op" id="5650345">:</span><span class="ident" id="5650346"><a href="/gostd/archive/tar/writer.go.html#5650177">length</a></span><span class="op" id="5650352">]</span><span class="op" id="5650353">,</span>&nbsp;<span class="string" id="5650355">&#34;/&#34;</span><span class="op" id="5650358">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5650361">//&nbsp;nlen&nbsp;contains&nbsp;the&nbsp;resulting&nbsp;length&nbsp;in&nbsp;the&nbsp;name&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5650419">//&nbsp;plen&nbsp;contains&nbsp;the&nbsp;resulting&nbsp;length&nbsp;in&nbsp;the&nbsp;prefix&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5650479">nlen</span>&nbsp;<span class="op" id="5650484">:=</span>&nbsp;<span class="builtinfunc" id="5650487">len</span><span class="op" id="5650490">(</span><span class="ident" id="5650491"><a href="/gostd/archive/tar/writer.go.html#5650126">name</a></span><span class="op" id="5650495">)</span>&nbsp;<span class="op" id="5650497">-</span>&nbsp;<span class="ident" id="5650499"><a href="/gostd/archive/tar/writer.go.html#5650317">i</a></span>&nbsp;<span class="op" id="5650501">-</span>&nbsp;<span class="num" id="5650503">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5650506">plen</span>&nbsp;<span class="op" id="5650511">:=</span>&nbsp;<span class="ident" id="5650514"><a href="/gostd/archive/tar/writer.go.html#5650317">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5650517">if</span>&nbsp;<span class="ident" id="5650520"><a href="/gostd/archive/tar/writer.go.html#5650317">i</a></span>&nbsp;<span class="op" id="5650522">&lt;=</span>&nbsp;<span class="num" id="5650525">0</span>&nbsp;<span class="op" id="5650527">||</span>&nbsp;<span class="ident" id="5650530"><a href="/gostd/archive/tar/writer.go.html#5650479">nlen</a></span>&nbsp;<span class="op" id="5650535">&gt;</span>&nbsp;<span class="ident" id="5650537"><a href="/gostd/archive/tar/common.go.html#5612074">fileNameSize</a></span>&nbsp;<span class="op" id="5650550">||</span>&nbsp;<span class="ident" id="5650553"><a href="/gostd/archive/tar/writer.go.html#5650479">nlen</a></span>&nbsp;<span class="op" id="5650558">==</span>&nbsp;<span class="num" id="5650561">0</span>&nbsp;<span class="op" id="5650563">||</span>&nbsp;<span class="ident" id="5650566"><a href="/gostd/archive/tar/writer.go.html#5650506">plen</a></span>&nbsp;<span class="op" id="5650571">&gt;</span>&nbsp;<span class="ident" id="5650573"><a href="/gostd/archive/tar/common.go.html#5612151">fileNamePrefixSize</a></span>&nbsp;<span class="op" id="5650592">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5650596"><a href="/gostd/archive/tar/writer.go.html#5650163">err</a></span>&nbsp;<span class="op" id="5650600">=</span>&nbsp;<span class="ident" id="5650602"><a href="/gostd/archive/tar/writer.go.html#5641713">errNameTooLong</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5650619">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5650627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5650630"><a href="/gostd/archive/tar/writer.go.html#5650140">prefix</a></span><span class="op" id="5650636">,</span>&nbsp;<span class="ident" id="5650638"><a href="/gostd/archive/tar/writer.go.html#5650148">suffix</a></span>&nbsp;<span class="op" id="5650645">=</span>&nbsp;<span class="ident" id="5650647"><a href="/gostd/archive/tar/writer.go.html#5650126">name</a></span><span class="op" id="5650651">[</span><span class="op" id="5650652">:</span><span class="ident" id="5650653"><a href="/gostd/archive/tar/writer.go.html#5650317">i</a></span><span class="op" id="5650654">]</span><span class="op" id="5650655">,</span>&nbsp;<span class="ident" id="5650657"><a href="/gostd/archive/tar/writer.go.html#5650126">name</a></span><span class="op" id="5650661">[</span><span class="ident" id="5650662"><a href="/gostd/archive/tar/writer.go.html#5650317">i</a></span><span class="op" id="5650663">+</span><span class="num" id="5650664">1</span><span class="op" id="5650665">:</span><span class="op" id="5650666">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5650669">return</span><br>
<span class="lineno">295</span><span class="op" id="5650676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5650679">//&nbsp;writePaxHeader&nbsp;writes&nbsp;an&nbsp;extended&nbsp;pax&nbsp;header&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5650734">//&nbsp;archive.</span><br>
<span class="lineno"></span><span class="keyword" id="5650746">func</span>&nbsp;<span class="op" id="5650751">(</span><span class="ident" id="5650752">tw</span>&nbsp;<span class="op" id="5650755">*</span><span class="ident" id="5650756"><a href="/gostd/archive/tar/writer.go.html#5642140">Writer</a></span><span class="op" id="5650762">)</span>&nbsp;<span class="ident" id="5650764">writePAXHeader</span><span class="op" id="5650778">(</span><span class="ident" id="5650779">hdr</span>&nbsp;<span class="op" id="5650783">*</span><span class="ident" id="5650784"><a href="/gostd/archive/tar/common.go.html#5611313">Header</a></span><span class="op" id="5650790">,</span>&nbsp;<span class="ident" id="5650792">paxHeaders</span>&nbsp;<span class="keyword" id="5650803">map</span><span class="op" id="5650806">[</span><span class="builtintype" id="5650807">string</span><span class="op" id="5650813">]</span><span class="builtintype" id="5650814">string</span><span class="op" id="5650820">)</span>&nbsp;<span class="builtintype" id="5650822">error</span>&nbsp;<span class="op" id="5650828">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5650831">//&nbsp;Prepare&nbsp;extended&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5650859">ext</span>&nbsp;<span class="op" id="5650863">:=</span>&nbsp;<span class="builtinfunc" id="5650866">new</span><span class="op" id="5650869">(</span><span class="ident" id="5650870"><a href="/gostd/archive/tar/common.go.html#5611313">Header</a></span><span class="op" id="5650876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5650879"><a href="/gostd/archive/tar/writer.go.html#5650859">ext</a></span><span class="op" id="5650882">.</span><span class="ident" id="5650883"><a href="/gostd/archive/tar/common.go.html#5611596">Typeflag</a></span>&nbsp;<span class="op" id="5650892">=</span>&nbsp;<span class="ident" id="5650894"><a href="/gostd/archive/tar/common.go.html#5610936">TypeXHeader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5650907">//&nbsp;Setting&nbsp;ModTime&nbsp;is&nbsp;required&nbsp;for&nbsp;reader&nbsp;parsing&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5650961">//&nbsp;succeed,&nbsp;and&nbsp;seems&nbsp;harmless&nbsp;enough.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651001"><a href="/gostd/archive/tar/writer.go.html#5650859">ext</a></span><span class="op" id="5651004">.</span><span class="ident" id="5651005"><a href="/gostd/archive/tar/common.go.html#5611557">ModTime</a></span>&nbsp;<span class="op" id="5651013">=</span>&nbsp;<span class="ident" id="5651015"><a href="/gostd/archive/tar/writer.go.html#5650779">hdr</a></span><span class="op" id="5651018">.</span><span class="ident" id="5651019"><a href="/gostd/archive/tar/common.go.html#5611557">ModTime</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5651028">//&nbsp;The&nbsp;spec&nbsp;asks&nbsp;that&nbsp;we&nbsp;namespace&nbsp;our&nbsp;pseudo&nbsp;files</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5651081">//&nbsp;with&nbsp;the&nbsp;current&nbsp;pid.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651107">pid</span>&nbsp;<span class="op" id="5651111">:=</span>&nbsp;<span class="ident" id="5651114"><a href="/gostd/archive/tar/writer.go.html#5641458">os</a></span><span class="op" id="5651116">.</span><span class="ident" id="5651117"><a href="/gostd/os/exec.go.html#2435259">Getpid</a></span><span class="op" id="5651123">(</span><span class="op" id="5651124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651127">dir</span><span class="op" id="5651130">,</span>&nbsp;<span class="ident" id="5651132">file</span>&nbsp;<span class="op" id="5651137">:=</span>&nbsp;<span class="ident" id="5651140"><a href="/gostd/archive/tar/writer.go.html#5641464">path</a></span><span class="op" id="5651144">.</span><span class="ident" id="5651145"><a href="/gostd/path/path.go.html#3923666">Split</a></span><span class="op" id="5651150">(</span><span class="ident" id="5651151"><a href="/gostd/archive/tar/writer.go.html#5650779">hdr</a></span><span class="op" id="5651154">.</span><span class="ident" id="5651155"><a href="/gostd/archive/tar/common.go.html#5611330">Name</a></span><span class="op" id="5651159">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651162">fullName</span>&nbsp;<span class="op" id="5651171">:=</span>&nbsp;<span class="ident" id="5651174"><a href="/gostd/archive/tar/writer.go.html#5641464">path</a></span><span class="op" id="5651178">.</span><span class="ident" id="5651179"><a href="/gostd/path/path.go.html#3923957">Join</a></span><span class="op" id="5651183">(</span><span class="ident" id="5651184"><a href="/gostd/archive/tar/writer.go.html#5651127">dir</a></span><span class="op" id="5651187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651191"><a href="/gostd/archive/tar/writer.go.html#5641445">fmt</a></span><span class="op" id="5651194">.</span><span class="ident" id="5651195"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="5651202">(</span><span class="string" id="5651203">&#34;PaxHeaders.%d&#34;</span><span class="op" id="5651218">,</span>&nbsp;<span class="ident" id="5651220"><a href="/gostd/archive/tar/writer.go.html#5651107">pid</a></span><span class="op" id="5651223">)</span><span class="op" id="5651224">,</span>&nbsp;<span class="ident" id="5651226"><a href="/gostd/archive/tar/writer.go.html#5651132">file</a></span><span class="op" id="5651230">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651234">ascii</span>&nbsp;<span class="op" id="5651240">:=</span>&nbsp;<span class="ident" id="5651243"><a href="/gostd/archive/tar/common.go.html#5617522">toASCII</a></span><span class="op" id="5651250">(</span><span class="ident" id="5651251"><a href="/gostd/archive/tar/writer.go.html#5651162">fullName</a></span><span class="op" id="5651259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651262">if</span>&nbsp;<span class="builtinfunc" id="5651265">len</span><span class="op" id="5651268">(</span><span class="ident" id="5651269"><a href="/gostd/archive/tar/writer.go.html#5651234">ascii</a></span><span class="op" id="5651274">)</span>&nbsp;<span class="op" id="5651276">&gt;</span>&nbsp;<span class="num" id="5651278">100</span>&nbsp;<span class="op" id="5651282">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651286"><a href="/gostd/archive/tar/writer.go.html#5651234">ascii</a></span>&nbsp;<span class="op" id="5651292">=</span>&nbsp;<span class="ident" id="5651294"><a href="/gostd/archive/tar/writer.go.html#5651234">ascii</a></span><span class="op" id="5651299">[</span><span class="op" id="5651300">:</span><span class="num" id="5651301">100</span><span class="op" id="5651304">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5651307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651310"><a href="/gostd/archive/tar/writer.go.html#5650859">ext</a></span><span class="op" id="5651313">.</span><span class="ident" id="5651314"><a href="/gostd/archive/tar/common.go.html#5611330">Name</a></span>&nbsp;<span class="op" id="5651319">=</span>&nbsp;<span class="ident" id="5651321"><a href="/gostd/archive/tar/writer.go.html#5651234">ascii</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5651328">//&nbsp;Construct&nbsp;the&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651351">var</span>&nbsp;<span class="ident" id="5651355">buf</span>&nbsp;<span class="ident" id="5651359"><a href="/gostd/archive/tar/writer.go.html#5641426">bytes</a></span><span class="op" id="5651364">.</span><span class="ident" id="5651365"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651374">for</span>&nbsp;<span class="ident" id="5651378">k</span><span class="op" id="5651379">,</span>&nbsp;<span class="ident" id="5651381">v</span>&nbsp;<span class="op" id="5651383">:=</span>&nbsp;<span class="keyword" id="5651386">range</span>&nbsp;<span class="ident" id="5651392"><a href="/gostd/archive/tar/writer.go.html#5650792">paxHeaders</a></span>&nbsp;<span class="op" id="5651403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651407"><a href="/gostd/archive/tar/writer.go.html#5641445">fmt</a></span><span class="op" id="5651410">.</span><span class="ident" id="5651411"><a href="/gostd/fmt/print.go.html#2144247">Fprint</a></span><span class="op" id="5651417">(</span><span class="op" id="5651418">&amp;</span><span class="ident" id="5651419"><a href="/gostd/archive/tar/writer.go.html#5651355">buf</a></span><span class="op" id="5651422">,</span>&nbsp;<span class="ident" id="5651424"><a href="/gostd/archive/tar/writer.go.html#5651773">paxHeader</a></span><span class="op" id="5651433">(</span><span class="ident" id="5651434"><a href="/gostd/archive/tar/writer.go.html#5651378">k</a></span><span class="op" id="5651435">+</span><span class="string" id="5651436">&#34;=&#34;</span><span class="op" id="5651439">+</span><span class="ident" id="5651440"><a href="/gostd/archive/tar/writer.go.html#5651381">v</a></span><span class="op" id="5651441">)</span><span class="op" id="5651442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5651445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651449"><a href="/gostd/archive/tar/writer.go.html#5650859">ext</a></span><span class="op" id="5651452">.</span><span class="ident" id="5651453"><a href="/gostd/archive/tar/common.go.html#5611516">Size</a></span>&nbsp;<span class="op" id="5651458">=</span>&nbsp;<span class="builtintype" id="5651460">int64</span><span class="op" id="5651465">(</span><span class="builtinfunc" id="5651466">len</span><span class="op" id="5651469">(</span><span class="ident" id="5651470"><a href="/gostd/archive/tar/writer.go.html#5651355">buf</a></span><span class="op" id="5651473">.</span><span class="ident" id="5651474"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="5651479">(</span><span class="op" id="5651480">)</span><span class="op" id="5651481">)</span><span class="op" id="5651482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651485">if</span>&nbsp;<span class="ident" id="5651488">err</span>&nbsp;<span class="op" id="5651492">:=</span>&nbsp;<span class="ident" id="5651495"><a href="/gostd/archive/tar/writer.go.html#5650752">tw</a></span><span class="op" id="5651497">.</span><span class="ident" id="5651498"><a href="/gostd/archive/tar/writer.go.html#5645600">writeHeader</a></span><span class="op" id="5651509">(</span><span class="ident" id="5651510"><a href="/gostd/archive/tar/writer.go.html#5650859">ext</a></span><span class="op" id="5651513">,</span>&nbsp;<span class="builtintype" id="5651515">false</span><span class="op" id="5651520">)</span><span class="op" id="5651521">;</span>&nbsp;<span class="ident" id="5651523"><a href="/gostd/archive/tar/writer.go.html#5651488">err</a></span>&nbsp;<span class="op" id="5651527">!=</span>&nbsp;<span class="builtintype" id="5651530">nil</span>&nbsp;<span class="op" id="5651534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651538">return</span>&nbsp;<span class="ident" id="5651545"><a href="/gostd/archive/tar/writer.go.html#5651488">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5651550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651553">if</span>&nbsp;<span class="ident" id="5651556">_</span><span class="op" id="5651557">,</span>&nbsp;<span class="ident" id="5651559">err</span>&nbsp;<span class="op" id="5651563">:=</span>&nbsp;<span class="ident" id="5651566"><a href="/gostd/archive/tar/writer.go.html#5650752">tw</a></span><span class="op" id="5651568">.</span><span class="ident" id="5651569"><a href="/gostd/archive/tar/writer.go.html#5652342">Write</a></span><span class="op" id="5651574">(</span><span class="ident" id="5651575"><a href="/gostd/archive/tar/writer.go.html#5651355">buf</a></span><span class="op" id="5651578">.</span><span class="ident" id="5651579"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="5651584">(</span><span class="op" id="5651585">)</span><span class="op" id="5651586">)</span><span class="op" id="5651587">;</span>&nbsp;<span class="ident" id="5651589"><a href="/gostd/archive/tar/writer.go.html#5651559">err</a></span>&nbsp;<span class="op" id="5651593">!=</span>&nbsp;<span class="builtintype" id="5651596">nil</span>&nbsp;<span class="op" id="5651600">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651604">return</span>&nbsp;<span class="ident" id="5651611"><a href="/gostd/archive/tar/writer.go.html#5651559">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5651616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651619">if</span>&nbsp;<span class="ident" id="5651622">err</span>&nbsp;<span class="op" id="5651626">:=</span>&nbsp;<span class="ident" id="5651629"><a href="/gostd/archive/tar/writer.go.html#5650752">tw</a></span><span class="op" id="5651631">.</span><span class="ident" id="5651632"><a href="/gostd/archive/tar/writer.go.html#5642880">Flush</a></span><span class="op" id="5651637">(</span><span class="op" id="5651638">)</span><span class="op" id="5651639">;</span>&nbsp;<span class="ident" id="5651641"><a href="/gostd/archive/tar/writer.go.html#5651622">err</a></span>&nbsp;<span class="op" id="5651645">!=</span>&nbsp;<span class="builtintype" id="5651648">nil</span>&nbsp;<span class="op" id="5651652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651656">return</span>&nbsp;<span class="ident" id="5651663"><a href="/gostd/archive/tar/writer.go.html#5651622">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5651668">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651671">return</span>&nbsp;<span class="builtintype" id="5651678">nil</span><br>
<span class="lineno"></span><span class="op" id="5651682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5651685">//&nbsp;paxHeader&nbsp;formats&nbsp;a&nbsp;single&nbsp;pax&nbsp;record,&nbsp;prefixing&nbsp;it&nbsp;with&nbsp;the&nbsp;appropriate&nbsp;length</span><br>
<span class="lineno"></span><span class="keyword" id="5651768">func</span>&nbsp;<span class="ident" id="5651773">paxHeader</span><span class="op" id="5651782">(</span><span class="ident" id="5651783">msg</span>&nbsp;<span class="builtintype" id="5651787">string</span><span class="op" id="5651793">)</span>&nbsp;<span class="builtintype" id="5651795">string</span>&nbsp;<span class="op" id="5651802">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651805">const</span>&nbsp;<span class="ident" id="5651811">padding</span>&nbsp;<span class="op" id="5651819">=</span>&nbsp;<span class="num" id="5651821">2</span>&nbsp;<span class="comment" id="5651823">//&nbsp;Extra&nbsp;padding&nbsp;for&nbsp;space&nbsp;and&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651863">size</span>&nbsp;<span class="op" id="5651868">:=</span>&nbsp;<span class="builtinfunc" id="5651871">len</span><span class="op" id="5651874">(</span><span class="ident" id="5651875"><a href="/gostd/archive/tar/writer.go.html#5651783">msg</a></span><span class="op" id="5651878">)</span>&nbsp;<span class="op" id="5651880">+</span>&nbsp;<span class="ident" id="5651882"><a href="/gostd/archive/tar/writer.go.html#5651811">padding</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651891"><a href="/gostd/archive/tar/writer.go.html#5651863">size</a></span>&nbsp;<span class="op" id="5651896">+=</span>&nbsp;<span class="builtinfunc" id="5651899">len</span><span class="op" id="5651902">(</span><span class="ident" id="5651903"><a href="/gostd/archive/tar/writer.go.html#5641472">strconv</a></span><span class="op" id="5651910">.</span><span class="ident" id="5651911"><a href="/gostd/strconv/itoa.go.html#2407288">Itoa</a></span><span class="op" id="5651915">(</span><span class="ident" id="5651916"><a href="/gostd/archive/tar/writer.go.html#5651863">size</a></span><span class="op" id="5651920">)</span><span class="op" id="5651921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5651924">record</span>&nbsp;<span class="op" id="5651931">:=</span>&nbsp;<span class="ident" id="5651934"><a href="/gostd/archive/tar/writer.go.html#5641445">fmt</a></span><span class="op" id="5651937">.</span><span class="ident" id="5651938"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="5651945">(</span><span class="string" id="5651946">&#34;%d&nbsp;%s\n&#34;</span><span class="op" id="5651955">,</span>&nbsp;<span class="ident" id="5651957"><a href="/gostd/archive/tar/writer.go.html#5651863">size</a></span><span class="op" id="5651961">,</span>&nbsp;<span class="ident" id="5651963"><a href="/gostd/archive/tar/writer.go.html#5651783">msg</a></span><span class="op" id="5651966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5651969">if</span>&nbsp;<span class="builtinfunc" id="5651972">len</span><span class="op" id="5651975">(</span><span class="ident" id="5651976"><a href="/gostd/archive/tar/writer.go.html#5651924">record</a></span><span class="op" id="5651982">)</span>&nbsp;<span class="op" id="5651984">!=</span>&nbsp;<span class="ident" id="5651987"><a href="/gostd/archive/tar/writer.go.html#5651863">size</a></span>&nbsp;<span class="op" id="5651992">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5651996">//&nbsp;Final&nbsp;adjustment&nbsp;if&nbsp;adding&nbsp;size&nbsp;increased</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5652043">//&nbsp;the&nbsp;number&nbsp;of&nbsp;digits&nbsp;in&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652077"><a href="/gostd/archive/tar/writer.go.html#5651863">size</a></span>&nbsp;<span class="op" id="5652082">=</span>&nbsp;<span class="builtinfunc" id="5652084">len</span><span class="op" id="5652087">(</span><span class="ident" id="5652088"><a href="/gostd/archive/tar/writer.go.html#5651924">record</a></span><span class="op" id="5652094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652098"><a href="/gostd/archive/tar/writer.go.html#5651924">record</a></span>&nbsp;<span class="op" id="5652105">=</span>&nbsp;<span class="ident" id="5652107"><a href="/gostd/archive/tar/writer.go.html#5641445">fmt</a></span><span class="op" id="5652110">.</span><span class="ident" id="5652111"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="5652118">(</span><span class="string" id="5652119">&#34;%d&nbsp;%s\n&#34;</span><span class="op" id="5652128">,</span>&nbsp;<span class="ident" id="5652130"><a href="/gostd/archive/tar/writer.go.html#5651863">size</a></span><span class="op" id="5652134">,</span>&nbsp;<span class="ident" id="5652136"><a href="/gostd/archive/tar/writer.go.html#5651783">msg</a></span><span class="op" id="5652139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5652142">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5652145">return</span>&nbsp;<span class="ident" id="5652152"><a href="/gostd/archive/tar/writer.go.html#5651924">record</a></span><br>
<span class="lineno"></span><span class="op" id="5652159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5652162">//&nbsp;Write&nbsp;writes&nbsp;to&nbsp;the&nbsp;current&nbsp;entry&nbsp;in&nbsp;the&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno"></span><span class="comment" id="5652219">//&nbsp;Write&nbsp;returns&nbsp;the&nbsp;error&nbsp;ErrWriteTooLong&nbsp;if&nbsp;more&nbsp;than</span><br>
<span class="lineno">355</span><span class="comment" id="5652275">//&nbsp;hdr.Size&nbsp;bytes&nbsp;are&nbsp;written&nbsp;after&nbsp;WriteHeader.</span><br>
<span class="lineno"></span><span class="keyword" id="5652324">func</span>&nbsp;<span class="op" id="5652329">(</span><span class="ident" id="5652330">tw</span>&nbsp;<span class="op" id="5652333">*</span><span class="ident" id="5652334"><a href="/gostd/archive/tar/writer.go.html#5642140">Writer</a></span><span class="op" id="5652340">)</span>&nbsp;<span class="ident" id="5652342">Write</span><span class="op" id="5652347">(</span><span class="ident" id="5652348">b</span>&nbsp;<span class="op" id="5652350">[</span><span class="op" id="5652351">]</span><span class="builtintype" id="5652352">byte</span><span class="op" id="5652356">)</span>&nbsp;<span class="op" id="5652358">(</span><span class="ident" id="5652359">n</span>&nbsp;<span class="builtintype" id="5652361">int</span><span class="op" id="5652364">,</span>&nbsp;<span class="ident" id="5652366">err</span>&nbsp;<span class="builtintype" id="5652370">error</span><span class="op" id="5652375">)</span>&nbsp;<span class="op" id="5652377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5652380">if</span>&nbsp;<span class="ident" id="5652383"><a href="/gostd/archive/tar/writer.go.html#5652330">tw</a></span><span class="op" id="5652385">.</span><span class="ident" id="5652386"><a href="/gostd/archive/tar/writer.go.html#5642340">closed</a></span>&nbsp;<span class="op" id="5652393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652397"><a href="/gostd/archive/tar/writer.go.html#5652366">err</a></span>&nbsp;<span class="op" id="5652401">=</span>&nbsp;<span class="ident" id="5652403"><a href="/gostd/archive/tar/writer.go.html#5641511">ErrWriteTooLong</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5652421">return</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5652429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652432">overwrite</span>&nbsp;<span class="op" id="5652442">:=</span>&nbsp;<span class="builtintype" id="5652445">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5652452">if</span>&nbsp;<span class="builtintype" id="5652455">int64</span><span class="op" id="5652460">(</span><span class="builtinfunc" id="5652461">len</span><span class="op" id="5652464">(</span><span class="ident" id="5652465"><a href="/gostd/archive/tar/writer.go.html#5652348">b</a></span><span class="op" id="5652466">)</span><span class="op" id="5652467">)</span>&nbsp;<span class="op" id="5652469">&gt;</span>&nbsp;<span class="ident" id="5652471"><a href="/gostd/archive/tar/writer.go.html#5652330">tw</a></span><span class="op" id="5652473">.</span><span class="ident" id="5652474"><a href="/gostd/archive/tar/writer.go.html#5642197">nb</a></span>&nbsp;<span class="op" id="5652477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652481"><a href="/gostd/archive/tar/writer.go.html#5652348">b</a></span>&nbsp;<span class="op" id="5652483">=</span>&nbsp;<span class="ident" id="5652485"><a href="/gostd/archive/tar/writer.go.html#5652348">b</a></span><span class="op" id="5652486">[</span><span class="num" id="5652487">0</span><span class="op" id="5652488">:</span><span class="ident" id="5652489"><a href="/gostd/archive/tar/writer.go.html#5652330">tw</a></span><span class="op" id="5652491">.</span><span class="ident" id="5652492"><a href="/gostd/archive/tar/writer.go.html#5642197">nb</a></span><span class="op" id="5652494">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652498"><a href="/gostd/archive/tar/writer.go.html#5652432">overwrite</a></span>&nbsp;<span class="op" id="5652508">=</span>&nbsp;<span class="builtintype" id="5652510">true</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5652516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652519"><a href="/gostd/archive/tar/writer.go.html#5652359">n</a></span><span class="op" id="5652520">,</span>&nbsp;<span class="ident" id="5652522"><a href="/gostd/archive/tar/writer.go.html#5652366">err</a></span>&nbsp;<span class="op" id="5652526">=</span>&nbsp;<span class="ident" id="5652528"><a href="/gostd/archive/tar/writer.go.html#5652330">tw</a></span><span class="op" id="5652530">.</span><span class="ident" id="5652531"><a href="/gostd/archive/tar/writer.go.html#5642157">w</a></span><span class="op" id="5652532">.</span><span class="ident" id="5652533"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="5652538">(</span><span class="ident" id="5652539"><a href="/gostd/archive/tar/writer.go.html#5652348">b</a></span><span class="op" id="5652540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652543"><a href="/gostd/archive/tar/writer.go.html#5652330">tw</a></span><span class="op" id="5652545">.</span><span class="ident" id="5652546"><a href="/gostd/archive/tar/writer.go.html#5642197">nb</a></span>&nbsp;<span class="op" id="5652549">-=</span>&nbsp;<span class="builtintype" id="5652552">int64</span><span class="op" id="5652557">(</span><span class="ident" id="5652558"><a href="/gostd/archive/tar/writer.go.html#5652359">n</a></span><span class="op" id="5652559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5652562">if</span>&nbsp;<span class="ident" id="5652565"><a href="/gostd/archive/tar/writer.go.html#5652366">err</a></span>&nbsp;<span class="op" id="5652569">==</span>&nbsp;<span class="builtintype" id="5652572">nil</span>&nbsp;<span class="op" id="5652576">&amp;&amp;</span>&nbsp;<span class="ident" id="5652579"><a href="/gostd/archive/tar/writer.go.html#5652432">overwrite</a></span>&nbsp;<span class="op" id="5652589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652593"><a href="/gostd/archive/tar/writer.go.html#5652366">err</a></span>&nbsp;<span class="op" id="5652597">=</span>&nbsp;<span class="ident" id="5652599"><a href="/gostd/archive/tar/writer.go.html#5641511">ErrWriteTooLong</a></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5652617">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5652625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652628"><a href="/gostd/archive/tar/writer.go.html#5652330">tw</a></span><span class="op" id="5652630">.</span><span class="ident" id="5652631"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span>&nbsp;<span class="op" id="5652635">=</span>&nbsp;<span class="ident" id="5652637"><a href="/gostd/archive/tar/writer.go.html#5652366">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5652642">return</span><br>
<span class="lineno"></span><span class="op" id="5652649">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="comment" id="5652652">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;tar&nbsp;archive,&nbsp;flushing&nbsp;any&nbsp;unwritten</span><br>
<span class="lineno"></span><span class="comment" id="5652708">//&nbsp;data&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno"></span><span class="keyword" id="5652742">func</span>&nbsp;<span class="op" id="5652747">(</span><span class="ident" id="5652748">tw</span>&nbsp;<span class="op" id="5652751">*</span><span class="ident" id="5652752"><a href="/gostd/archive/tar/writer.go.html#5642140">Writer</a></span><span class="op" id="5652758">)</span>&nbsp;<span class="ident" id="5652760">Close</span><span class="op" id="5652765">(</span><span class="op" id="5652766">)</span>&nbsp;<span class="builtintype" id="5652768">error</span>&nbsp;<span class="op" id="5652774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5652777">if</span>&nbsp;<span class="ident" id="5652780"><a href="/gostd/archive/tar/writer.go.html#5652748">tw</a></span><span class="op" id="5652782">.</span><span class="ident" id="5652783"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span>&nbsp;<span class="op" id="5652787">!=</span>&nbsp;<span class="builtintype" id="5652790">nil</span>&nbsp;<span class="op" id="5652794">||</span>&nbsp;<span class="ident" id="5652797"><a href="/gostd/archive/tar/writer.go.html#5652748">tw</a></span><span class="op" id="5652799">.</span><span class="ident" id="5652800"><a href="/gostd/archive/tar/writer.go.html#5642340">closed</a></span>&nbsp;<span class="op" id="5652807">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5652811">return</span>&nbsp;<span class="ident" id="5652818"><a href="/gostd/archive/tar/writer.go.html#5652748">tw</a></span><span class="op" id="5652820">.</span><span class="ident" id="5652821"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5652826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652829"><a href="/gostd/archive/tar/writer.go.html#5652748">tw</a></span><span class="op" id="5652831">.</span><span class="ident" id="5652832"><a href="/gostd/archive/tar/writer.go.html#5642880">Flush</a></span><span class="op" id="5652837">(</span><span class="op" id="5652838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652841"><a href="/gostd/archive/tar/writer.go.html#5652748">tw</a></span><span class="op" id="5652843">.</span><span class="ident" id="5652844"><a href="/gostd/archive/tar/writer.go.html#5642340">closed</a></span>&nbsp;<span class="op" id="5652851">=</span>&nbsp;<span class="builtintype" id="5652853">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5652859">if</span>&nbsp;<span class="ident" id="5652862"><a href="/gostd/archive/tar/writer.go.html#5652748">tw</a></span><span class="op" id="5652864">.</span><span class="ident" id="5652865"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span>&nbsp;<span class="op" id="5652869">!=</span>&nbsp;<span class="builtintype" id="5652872">nil</span>&nbsp;<span class="op" id="5652876">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5652880">return</span>&nbsp;<span class="ident" id="5652887"><a href="/gostd/archive/tar/writer.go.html#5652748">tw</a></span><span class="op" id="5652889">.</span><span class="ident" id="5652890"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5652895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5652899">//&nbsp;trailer:&nbsp;two&nbsp;zero&nbsp;blocks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5652928">for</span>&nbsp;<span class="ident" id="5652932">i</span>&nbsp;<span class="op" id="5652934">:=</span>&nbsp;<span class="num" id="5652937">0</span><span class="op" id="5652938">;</span>&nbsp;<span class="ident" id="5652940"><a href="/gostd/archive/tar/writer.go.html#5652932">i</a></span>&nbsp;<span class="op" id="5652942">&lt;</span>&nbsp;<span class="num" id="5652944">2</span><span class="op" id="5652945">;</span>&nbsp;<span class="ident" id="5652947"><a href="/gostd/archive/tar/writer.go.html#5652932">i</a></span><span class="op" id="5652948">++</span>&nbsp;<span class="op" id="5652951">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5652955">_</span><span class="op" id="5652956">,</span>&nbsp;<span class="ident" id="5652958"><a href="/gostd/archive/tar/writer.go.html#5652748">tw</a></span><span class="op" id="5652960">.</span><span class="ident" id="5652961"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span>&nbsp;<span class="op" id="5652965">=</span>&nbsp;<span class="ident" id="5652967"><a href="/gostd/archive/tar/writer.go.html#5652748">tw</a></span><span class="op" id="5652969">.</span><span class="ident" id="5652970"><a href="/gostd/archive/tar/writer.go.html#5642157">w</a></span><span class="op" id="5652971">.</span><span class="ident" id="5652972"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="5652977">(</span><span class="ident" id="5652978"><a href="/gostd/archive/tar/common.go.html#5616783">zeroBlock</a></span><span class="op" id="5652987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5652991">if</span>&nbsp;<span class="ident" id="5652994"><a href="/gostd/archive/tar/writer.go.html#5652748">tw</a></span><span class="op" id="5652996">.</span><span class="ident" id="5652997"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span>&nbsp;<span class="op" id="5653001">!=</span>&nbsp;<span class="builtintype" id="5653004">nil</span>&nbsp;<span class="op" id="5653008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5653013">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5653021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5653024">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5653027">return</span>&nbsp;<span class="ident" id="5653034"><a href="/gostd/archive/tar/writer.go.html#5652748">tw</a></span><span class="op" id="5653036">.</span><span class="ident" id="5653037"><a href="/gostd/archive/tar/writer.go.html#5642179">err</a></span><br>
<span class="lineno"></span><span class="op" id="5653041">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
