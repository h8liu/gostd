<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6676852">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6676908">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6676962">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6677013">package</span>&nbsp;<span class="ident" id="6677021">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6677031">import</span>&nbsp;<span class="op" id="6677038">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6677041">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6677053">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6677063">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6677066">var</span>&nbsp;<span class="ident" id="6677070">toFromBigTests</span>&nbsp;<span class="op" id="6677085">=</span>&nbsp;<span class="op" id="6677087">[</span><span class="op" id="6677088">]</span><span class="builtintype" id="6677089">string</span><span class="op" id="6677095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6677098">&#34;0&#34;</span><span class="op" id="6677101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6677104">&#34;1&#34;</span><span class="op" id="6677107">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6677110">&#34;23&#34;</span><span class="op" id="6677114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6677117">&#34;b70e0cb46bb4bf7f321390b94a03c1d356c01122343280d6105c1d21&#34;</span><span class="op" id="6677175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6677178">&#34;706a46d476dcb76798e6046d89474788d164c18032d268fd10704fa6&#34;</span><span class="op" id="6677236">,</span><br>
<span class="lineno"></span><span class="op" id="6677238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="6677241">func</span>&nbsp;<span class="ident" id="6677246">p224AlternativeToBig</span><span class="op" id="6677266">(</span><span class="ident" id="6677267">in</span>&nbsp;<span class="op" id="6677270">*</span><span class="ident" id="6677271">p224FieldElement</span><span class="op" id="6677287">)</span>&nbsp;<span class="op" id="6677289">*</span><span class="ident" id="6677290">big</span><span class="op" id="6677293">.</span><span class="ident" id="6677294">Int</span>&nbsp;<span class="op" id="6677298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677301">ret</span>&nbsp;<span class="op" id="6677305">:=</span>&nbsp;<span class="builtinfunc" id="6677308">new</span><span class="op" id="6677311">(</span><span class="ident" id="6677312">big</span><span class="op" id="6677315">.</span><span class="ident" id="6677316">Int</span><span class="op" id="6677319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677322">tmp</span>&nbsp;<span class="op" id="6677326">:=</span>&nbsp;<span class="builtinfunc" id="6677329">new</span><span class="op" id="6677332">(</span><span class="ident" id="6677333">big</span><span class="op" id="6677336">.</span><span class="ident" id="6677337">Int</span><span class="op" id="6677340">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677344">for</span>&nbsp;<span class="ident" id="6677348">i</span>&nbsp;<span class="op" id="6677350">:=</span>&nbsp;<span class="builtintype" id="6677353">uint</span><span class="op" id="6677357">(</span><span class="num" id="6677358">0</span><span class="op" id="6677359">)</span><span class="op" id="6677360">;</span>&nbsp;<span class="ident" id="6677362">i</span>&nbsp;<span class="op" id="6677364">&lt;</span>&nbsp;<span class="num" id="6677366">8</span><span class="op" id="6677367">;</span>&nbsp;<span class="ident" id="6677369">i</span><span class="op" id="6677370">++</span>&nbsp;<span class="op" id="6677373">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677377">tmp</span><span class="op" id="6677380">.</span><span class="ident" id="6677381">SetInt64</span><span class="op" id="6677389">(</span><span class="ident" id="6677390">int64</span><span class="op" id="6677395">(</span><span class="ident" id="6677396">in</span><span class="op" id="6677398">[</span><span class="ident" id="6677399">i</span><span class="op" id="6677400">]</span><span class="op" id="6677401">)</span><span class="op" id="6677402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677406">tmp</span><span class="op" id="6677409">.</span><span class="ident" id="6677410">Lsh</span><span class="op" id="6677413">(</span><span class="ident" id="6677414">tmp</span><span class="op" id="6677417">,</span>&nbsp;<span class="num" id="6677419">28</span><span class="op" id="6677421">*</span><span class="ident" id="6677422">i</span><span class="op" id="6677423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677427">ret</span><span class="op" id="6677430">.</span><span class="ident" id="6677431">Add</span><span class="op" id="6677434">(</span><span class="ident" id="6677435">ret</span><span class="op" id="6677438">,</span>&nbsp;<span class="ident" id="6677440">tmp</span><span class="op" id="6677443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677449">ret</span><span class="op" id="6677452">.</span><span class="ident" id="6677453">Mod</span><span class="op" id="6677456">(</span><span class="ident" id="6677457">ret</span><span class="op" id="6677460">,</span>&nbsp;<span class="ident" id="6677462">p224</span><span class="op" id="6677466">.</span><span class="ident" id="6677467">P</span><span class="op" id="6677468">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677471">return</span>&nbsp;<span class="ident" id="6677478">ret</span><br>
<span class="lineno"></span><span class="op" id="6677482">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6677485">func</span>&nbsp;<span class="ident" id="6677490">TestToFromBig</span><span class="op" id="6677503">(</span><span class="ident" id="6677504">t</span>&nbsp;<span class="op" id="6677506">*</span><span class="ident" id="6677507">testing</span><span class="op" id="6677514">.</span><span class="ident" id="6677515">T</span><span class="op" id="6677516">)</span>&nbsp;<span class="op" id="6677518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677521">for</span>&nbsp;<span class="ident" id="6677525">i</span><span class="op" id="6677526">,</span>&nbsp;<span class="ident" id="6677528">test</span>&nbsp;<span class="op" id="6677533">:=</span>&nbsp;<span class="keyword" id="6677536">range</span>&nbsp;<span class="ident" id="6677542">toFromBigTests</span>&nbsp;<span class="op" id="6677557">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677561">n</span><span class="op" id="6677562">,</span>&nbsp;<span class="ident" id="6677564">_</span>&nbsp;<span class="op" id="6677566">:=</span>&nbsp;<span class="builtinfunc" id="6677569">new</span><span class="op" id="6677572">(</span><span class="ident" id="6677573">big</span><span class="op" id="6677576">.</span><span class="ident" id="6677577">Int</span><span class="op" id="6677580">)</span><span class="op" id="6677581">.</span><span class="ident" id="6677582">SetString</span><span class="op" id="6677591">(</span><span class="ident" id="6677592">test</span><span class="op" id="6677596">,</span>&nbsp;<span class="num" id="6677598">16</span><span class="op" id="6677600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677604">var</span>&nbsp;<span class="ident" id="6677608">x</span>&nbsp;<span class="ident" id="6677610">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677629">p224FromBig</span><span class="op" id="6677640">(</span><span class="op" id="6677641">&amp;</span><span class="ident" id="6677642">x</span><span class="op" id="6677643">,</span>&nbsp;<span class="ident" id="6677645">n</span><span class="op" id="6677646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677650">m</span>&nbsp;<span class="op" id="6677652">:=</span>&nbsp;<span class="ident" id="6677655">p224ToBig</span><span class="op" id="6677664">(</span><span class="op" id="6677665">&amp;</span><span class="ident" id="6677666">x</span><span class="op" id="6677667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677671">if</span>&nbsp;<span class="ident" id="6677674">n</span><span class="op" id="6677675">.</span><span class="ident" id="6677676">Cmp</span><span class="op" id="6677679">(</span><span class="ident" id="6677680">m</span><span class="op" id="6677681">)</span>&nbsp;<span class="op" id="6677683">!=</span>&nbsp;<span class="num" id="6677686">0</span>&nbsp;<span class="op" id="6677688">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677693">t</span><span class="op" id="6677694">.</span><span class="ident" id="6677695">Errorf</span><span class="op" id="6677701">(</span><span class="string" id="6677702">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&#34;</span><span class="op" id="6677717">,</span>&nbsp;<span class="ident" id="6677719">i</span><span class="op" id="6677720">,</span>&nbsp;<span class="ident" id="6677722">n</span><span class="op" id="6677723">,</span>&nbsp;<span class="ident" id="6677725">m</span><span class="op" id="6677726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677734">q</span>&nbsp;<span class="op" id="6677736">:=</span>&nbsp;<span class="ident" id="6677739">p224AlternativeToBig</span><span class="op" id="6677759">(</span><span class="op" id="6677760">&amp;</span><span class="ident" id="6677761">x</span><span class="op" id="6677762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6677766">if</span>&nbsp;<span class="ident" id="6677769">n</span><span class="op" id="6677770">.</span><span class="ident" id="6677771">Cmp</span><span class="op" id="6677774">(</span><span class="ident" id="6677775">q</span><span class="op" id="6677776">)</span>&nbsp;<span class="op" id="6677778">!=</span>&nbsp;<span class="num" id="6677781">0</span>&nbsp;<span class="op" id="6677783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6677788">t</span><span class="op" id="6677789">.</span><span class="ident" id="6677790">Errorf</span><span class="op" id="6677796">(</span><span class="string" id="6677797">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&nbsp;(alternative)&#34;</span><span class="op" id="6677826">,</span>&nbsp;<span class="ident" id="6677828">i</span><span class="op" id="6677829">,</span>&nbsp;<span class="ident" id="6677831">n</span><span class="op" id="6677832">,</span>&nbsp;<span class="ident" id="6677834">m</span><span class="op" id="6677835">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6677842">}</span><br>
<span class="lineno"></span><span class="op" id="6677844">}</span>
</div>
</body>
</html>
