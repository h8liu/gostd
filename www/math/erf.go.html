<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2258606">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2258661">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2258715">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2258766">package</span>&nbsp;<span class="ident" id="2258774">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2258780">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;error&nbsp;function&nbsp;and&nbsp;complementary&nbsp;error&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2258852">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2258906">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_erf.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2258958">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2259013">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2259043">//</span><br>
<span class="lineno"></span><span class="comment" id="2259046">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2259102">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2259171">//</span><br>
<span class="lineno"></span><span class="comment" id="2259174">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2259233">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2259289">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2259346">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2259363">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2259419">//</span><br>
<span class="lineno">25</span><span class="comment" id="2259422">//</span><br>
<span class="lineno"></span><span class="comment" id="2259425">//&nbsp;double&nbsp;erf(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2259449">//&nbsp;double&nbsp;erfc(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="2259474">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2259505">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|\</span><br>
<span class="lineno">30</span><span class="comment" id="2259537">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;&nbsp;---------&nbsp;&nbsp;|&nbsp;exp(-t*t)dt</span><br>
<span class="lineno"></span><span class="comment" id="2259580">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqrt(pi)&nbsp;\|</span><br>
<span class="lineno"></span><span class="comment" id="2259611">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2259642">//</span><br>
<span class="lineno"></span><span class="comment" id="2259645">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;&nbsp;1-erf(x)</span><br>
<span class="lineno">35</span><span class="comment" id="2259672">//&nbsp;&nbsp;Note&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2259686">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(-x)&nbsp;=&nbsp;-erf(x)</span><br>
<span class="lineno"></span><span class="comment" id="2259720">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(-x)&nbsp;=&nbsp;2&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2259759">//</span><br>
<span class="lineno"></span><span class="comment" id="2259762">//&nbsp;Method:</span><br>
<span class="lineno">40</span><span class="comment" id="2259773">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2259808">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;x&nbsp;+&nbsp;x*R(x**2)</span><br>
<span class="lineno"></span><span class="comment" id="2259844">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;1&nbsp;-&nbsp;erf(x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[-.84375,0.25]</span><br>
<span class="lineno"></span><span class="comment" id="2259910">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.5&nbsp;+&nbsp;((0.5-x)-x*R)&nbsp;&nbsp;if&nbsp;x&nbsp;in&nbsp;[0.25,0.84375]</span><br>
<span class="lineno"></span><span class="comment" id="2259976">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;R&nbsp;=&nbsp;P/Q&nbsp;where&nbsp;P&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;8&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="2260040">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q&nbsp;is&nbsp;an&nbsp;odd&nbsp;poly&nbsp;of&nbsp;degree&nbsp;10.</span><br>
<span class="lineno"></span><span class="comment" id="2260082">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-57.90</span><br>
<span class="lineno"></span><span class="comment" id="2260138">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;R&nbsp;-&nbsp;(erf(x)-x)/x&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2260188">//</span><br>
<span class="lineno"></span><span class="comment" id="2260191">//</span><br>
<span class="lineno">50</span><span class="comment" id="2260194">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark.&nbsp;The&nbsp;formula&nbsp;is&nbsp;derived&nbsp;by&nbsp;noting</span><br>
<span class="lineno"></span><span class="comment" id="2260246">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;=&nbsp;(2/sqrt(pi))*(x&nbsp;-&nbsp;x**3/3&nbsp;+&nbsp;x**5/10&nbsp;-&nbsp;x**7/42&nbsp;+&nbsp;....)</span><br>
<span class="lineno"></span><span class="comment" id="2260320">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2260340">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2/sqrt(pi)&nbsp;=&nbsp;1.128379167095512573896158903121545171688</span><br>
<span class="lineno"></span><span class="comment" id="2260407">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;close&nbsp;to&nbsp;one.&nbsp;The&nbsp;interval&nbsp;is&nbsp;chosen&nbsp;because&nbsp;the&nbsp;fix</span><br>
<span class="lineno">55</span><span class="comment" id="2260474">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;point&nbsp;of&nbsp;erf(x)&nbsp;is&nbsp;near&nbsp;0.6174&nbsp;(i.e.,&nbsp;erf(x)=x&nbsp;when&nbsp;x&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2260542">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near&nbsp;0.6174),&nbsp;and&nbsp;by&nbsp;some&nbsp;experiment,&nbsp;0.84375&nbsp;is&nbsp;chosen&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2260612">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guarantee&nbsp;the&nbsp;error&nbsp;is&nbsp;less&nbsp;than&nbsp;one&nbsp;ulp&nbsp;for&nbsp;erf.</span><br>
<span class="lineno"></span><span class="comment" id="2260673">//</span><br>
<span class="lineno"></span><span class="comment" id="2260676">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;For&nbsp;|x|&nbsp;in&nbsp;[0.84375,1.25],&nbsp;let&nbsp;s&nbsp;=&nbsp;|x|&nbsp;-&nbsp;1,&nbsp;and</span><br>
<span class="lineno">60</span><span class="comment" id="2260735">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0.84506291151&nbsp;rounded&nbsp;to&nbsp;single&nbsp;(24&nbsp;bits)</span><br>
<span class="lineno"></span><span class="comment" id="2260792">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;(c&nbsp;&nbsp;+&nbsp;P1(s)/Q1(s))</span><br>
<span class="lineno"></span><span class="comment" id="2260847">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1-c)&nbsp;&nbsp;-&nbsp;P1(s)/Q1(s)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2260903">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+(c+P1(s)/Q1(s))&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2260959">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P1/Q1&nbsp;-&nbsp;(erf(|x|)-c)|&nbsp;&lt;=&nbsp;2**-59.06</span><br>
<span class="lineno">65</span><span class="comment" id="2261011">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark:&nbsp;here&nbsp;we&nbsp;use&nbsp;the&nbsp;taylor&nbsp;series&nbsp;expansion&nbsp;at&nbsp;x=1.</span><br>
<span class="lineno"></span><span class="comment" id="2261078">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;=&nbsp;erf(1)&nbsp;+&nbsp;s*Poly(s)</span><br>
<span class="lineno"></span><span class="comment" id="2261124">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.845..&nbsp;+&nbsp;P1(s)/Q1(s)</span><br>
<span class="lineno"></span><span class="comment" id="2261173">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;That&nbsp;is,&nbsp;we&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2261238">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(1+s)&nbsp;-&nbsp;(c&nbsp;=&nbsp;(single)0.84506291151)</span><br>
<span class="lineno">70</span><span class="comment" id="2261301">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;|P1/Q1|&lt;&nbsp;0.078&nbsp;for&nbsp;x&nbsp;in&nbsp;[0.84375,1.25]</span><br>
<span class="lineno"></span><span class="comment" id="2261361">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2261378">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2261421">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q1(s)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2261464">//</span><br>
<span class="lineno">75</span><span class="comment" id="2261467">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1.25,1/0.35(~2.857143)],</span><br>
<span class="lineno"></span><span class="comment" id="2261513">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R1/S1)</span><br>
<span class="lineno"></span><span class="comment" id="2261568">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;1&nbsp;-&nbsp;erfc(x)</span><br>
<span class="lineno"></span><span class="comment" id="2261606">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2261623">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R1(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">80</span><span class="comment" id="2261678">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S1(z)&nbsp;=&nbsp;degree&nbsp;8&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2261721">//</span><br>
<span class="lineno"></span><span class="comment" id="2261724">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;x&nbsp;in&nbsp;[1/0.35,28]</span><br>
<span class="lineno"></span><span class="comment" id="2261756">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2261820">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;(1/x)*exp(-x*x-0.5625+R2/S2)&nbsp;if&nbsp;-6&lt;x&lt;0</span><br>
<span class="lineno">85</span><span class="comment" id="2261891">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.0&nbsp;-&nbsp;tiny&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;x&nbsp;&lt;=&nbsp;-6)</span><br>
<span class="lineno"></span><span class="comment" id="2261952">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;erfc(x))&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;6,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="2262017">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)*(1.0&nbsp;-&nbsp;tiny)</span><br>
<span class="lineno"></span><span class="comment" id="2262064">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2262081">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R2(z)&nbsp;=&nbsp;degree&nbsp;6&nbsp;poly&nbsp;in&nbsp;z,&nbsp;(z=1/x**2)</span><br>
<span class="lineno">90</span><span class="comment" id="2262136">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S2(z)&nbsp;=&nbsp;degree&nbsp;7&nbsp;poly&nbsp;in&nbsp;z</span><br>
<span class="lineno"></span><span class="comment" id="2262179">//</span><br>
<span class="lineno"></span><span class="comment" id="2262182">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note1:</span><br>
<span class="lineno"></span><span class="comment" id="2262197">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To&nbsp;compute&nbsp;exp(-x*x-0.5625+R/S),&nbsp;let&nbsp;s&nbsp;be&nbsp;a&nbsp;single</span><br>
<span class="lineno"></span><span class="comment" id="2262259">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision&nbsp;number&nbsp;and&nbsp;s&nbsp;:=&nbsp;x;&nbsp;then</span><br>
<span class="lineno">95</span><span class="comment" id="2262304">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*x&nbsp;=&nbsp;-s*s&nbsp;+&nbsp;(s-x)*(s+x)</span><br>
<span class="lineno"></span><span class="comment" id="2262346">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x-0.5626+R/S)&nbsp;=</span><br>
<span class="lineno"></span><span class="comment" id="2262385">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);</span><br>
<span class="lineno"></span><span class="comment" id="2262448">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note2:</span><br>
<span class="lineno"></span><span class="comment" id="2262463">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;4&nbsp;and&nbsp;5&nbsp;make&nbsp;use&nbsp;of&nbsp;the&nbsp;asymptotic&nbsp;series</span><br>
<span class="lineno">100</span><span class="comment" id="2262521">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp(-x*x)</span><br>
<span class="lineno"></span><span class="comment" id="2262557">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;~&nbsp;----------&nbsp;*&nbsp;(&nbsp;1&nbsp;+&nbsp;Poly(1/x**2)&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="2262617">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x*sqrt(pi)</span><br>
<span class="lineno"></span><span class="comment" id="2262654">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;rational&nbsp;approximation&nbsp;to&nbsp;approximate</span><br>
<span class="lineno"></span><span class="comment" id="2262710">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g(s)=f(1/x**2)&nbsp;=&nbsp;log(erfc(x)*x)&nbsp;-&nbsp;x*x&nbsp;+&nbsp;0.5625</span><br>
<span class="lineno">105</span><span class="comment" id="2262773">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;error&nbsp;bound&nbsp;for&nbsp;R1/S1&nbsp;and&nbsp;R2/S2</span><br>
<span class="lineno"></span><span class="comment" id="2262828">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R1/S1&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-62.57)</span><br>
<span class="lineno"></span><span class="comment" id="2262874">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|R2/S2&nbsp;-&nbsp;f(x)|&nbsp;&nbsp;&lt;&nbsp;2**(-61.52)</span><br>
<span class="lineno"></span><span class="comment" id="2262920">//</span><br>
<span class="lineno"></span><span class="comment" id="2262923">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;For&nbsp;inf&nbsp;&gt;&nbsp;x&nbsp;&gt;=&nbsp;28</span><br>
<span class="lineno">110</span><span class="comment" id="2262952">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(x)&nbsp;&nbsp;=&nbsp;sign(x)&nbsp;*(1&nbsp;-&nbsp;tiny)&nbsp;&nbsp;(raise&nbsp;inexact)</span><br>
<span class="lineno"></span><span class="comment" id="2263015">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(x)&nbsp;=&nbsp;tiny*tiny&nbsp;(raise&nbsp;underflow)&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2263078">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;-&nbsp;tiny&nbsp;if&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2263120">//</span><br>
<span class="lineno"></span><span class="comment" id="2263123">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;Special&nbsp;case:</span><br>
<span class="lineno">115</span><span class="comment" id="2263148">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erf(0)&nbsp;&nbsp;=&nbsp;0,&nbsp;erf(inf)&nbsp;&nbsp;=&nbsp;1,&nbsp;erf(-inf)&nbsp;=&nbsp;-1,</span><br>
<span class="lineno"></span><span class="comment" id="2263208">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc(0)&nbsp;=&nbsp;1,&nbsp;erfc(inf)&nbsp;=&nbsp;0,&nbsp;erfc(-inf)&nbsp;=&nbsp;2,</span><br>
<span class="lineno"></span><span class="comment" id="2263268">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;erfc/erf(NaN)&nbsp;is&nbsp;NaN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2263306">const</span>&nbsp;<span class="op" id="2263312">(</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263315">erx</span>&nbsp;<span class="op" id="2263319">=</span>&nbsp;<span class="num" id="2263321">8.45062911510467529297e-01</span>&nbsp;<span class="comment" id="2263348">//&nbsp;0x3FEB0AC160000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2263371">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;in&nbsp;[0,&nbsp;0.84375]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263430">efx</span>&nbsp;&nbsp;<span class="op" id="2263435">=</span>&nbsp;<span class="num" id="2263437">1.28379167095512586316e-01</span>&nbsp;&nbsp;<span class="comment" id="2263465">//&nbsp;0x3FC06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263488">efx8</span>&nbsp;<span class="op" id="2263493">=</span>&nbsp;<span class="num" id="2263495">1.02703333676410069053e+00</span>&nbsp;&nbsp;<span class="comment" id="2263523">//&nbsp;0x3FF06EBA8214DB69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263546">pp0</span>&nbsp;&nbsp;<span class="op" id="2263551">=</span>&nbsp;<span class="num" id="2263553">1.28379167095512558561e-01</span>&nbsp;&nbsp;<span class="comment" id="2263581">//&nbsp;0x3FC06EBA8214DB68</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263604">pp1</span>&nbsp;&nbsp;<span class="op" id="2263609">=</span>&nbsp;<span class="op" id="2263611">-</span><span class="num" id="2263612">3.25042107247001499370e-01</span>&nbsp;<span class="comment" id="2263639">//&nbsp;0xBFD4CD7D691CB913</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263662">pp2</span>&nbsp;&nbsp;<span class="op" id="2263667">=</span>&nbsp;<span class="op" id="2263669">-</span><span class="num" id="2263670">2.84817495755985104766e-02</span>&nbsp;<span class="comment" id="2263697">//&nbsp;0xBF9D2A51DBD7194F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263720">pp3</span>&nbsp;&nbsp;<span class="op" id="2263725">=</span>&nbsp;<span class="op" id="2263727">-</span><span class="num" id="2263728">5.77027029648944159157e-03</span>&nbsp;<span class="comment" id="2263755">//&nbsp;0xBF77A291236668E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263778">pp4</span>&nbsp;&nbsp;<span class="op" id="2263783">=</span>&nbsp;<span class="op" id="2263785">-</span><span class="num" id="2263786">2.37630166566501626084e-05</span>&nbsp;<span class="comment" id="2263813">//&nbsp;0xBEF8EAD6120016AC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263836">qq1</span>&nbsp;&nbsp;<span class="op" id="2263841">=</span>&nbsp;<span class="num" id="2263843">3.97917223959155352819e-01</span>&nbsp;&nbsp;<span class="comment" id="2263871">//&nbsp;0x3FD97779CDDADC09</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263894">qq2</span>&nbsp;&nbsp;<span class="op" id="2263899">=</span>&nbsp;<span class="num" id="2263901">6.50222499887672944485e-02</span>&nbsp;&nbsp;<span class="comment" id="2263929">//&nbsp;0x3FB0A54C5536CEBA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2263952">qq3</span>&nbsp;&nbsp;<span class="op" id="2263957">=</span>&nbsp;<span class="num" id="2263959">5.08130628187576562776e-03</span>&nbsp;&nbsp;<span class="comment" id="2263987">//&nbsp;0x3F74D022C4D36B0F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264010">qq4</span>&nbsp;&nbsp;<span class="op" id="2264015">=</span>&nbsp;<span class="num" id="2264017">1.32494738004321644526e-04</span>&nbsp;&nbsp;<span class="comment" id="2264045">//&nbsp;0x3F215DC9221C1A10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264068">qq5</span>&nbsp;&nbsp;<span class="op" id="2264073">=</span>&nbsp;<span class="op" id="2264075">-</span><span class="num" id="2264076">3.96022827877536812320e-06</span>&nbsp;<span class="comment" id="2264103">//&nbsp;0xBED09C4342A26120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2264126">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erf&nbsp;&nbsp;in&nbsp;[0.84375,&nbsp;1.25]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264189">pa0</span>&nbsp;<span class="op" id="2264193">=</span>&nbsp;<span class="op" id="2264195">-</span><span class="num" id="2264196">2.36211856075265944077e-03</span>&nbsp;<span class="comment" id="2264223">//&nbsp;0xBF6359B8BEF77538</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264246">pa1</span>&nbsp;<span class="op" id="2264250">=</span>&nbsp;<span class="num" id="2264252">4.14856118683748331666e-01</span>&nbsp;&nbsp;<span class="comment" id="2264280">//&nbsp;0x3FDA8D00AD92B34D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264303">pa2</span>&nbsp;<span class="op" id="2264307">=</span>&nbsp;<span class="op" id="2264309">-</span><span class="num" id="2264310">3.72207876035701323847e-01</span>&nbsp;<span class="comment" id="2264337">//&nbsp;0xBFD7D240FBB8C3F1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264360">pa3</span>&nbsp;<span class="op" id="2264364">=</span>&nbsp;<span class="num" id="2264366">3.18346619901161753674e-01</span>&nbsp;&nbsp;<span class="comment" id="2264394">//&nbsp;0x3FD45FCA805120E4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264417">pa4</span>&nbsp;<span class="op" id="2264421">=</span>&nbsp;<span class="op" id="2264423">-</span><span class="num" id="2264424">1.10894694282396677476e-01</span>&nbsp;<span class="comment" id="2264451">//&nbsp;0xBFBC63983D3E28EC</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264474">pa5</span>&nbsp;<span class="op" id="2264478">=</span>&nbsp;<span class="num" id="2264480">3.54783043256182359371e-02</span>&nbsp;&nbsp;<span class="comment" id="2264508">//&nbsp;0x3FA22A36599795EB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264531">pa6</span>&nbsp;<span class="op" id="2264535">=</span>&nbsp;<span class="op" id="2264537">-</span><span class="num" id="2264538">2.16637559486879084300e-03</span>&nbsp;<span class="comment" id="2264565">//&nbsp;0xBF61BF380A96073F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264588">qa1</span>&nbsp;<span class="op" id="2264592">=</span>&nbsp;<span class="num" id="2264594">1.06420880400844228286e-01</span>&nbsp;&nbsp;<span class="comment" id="2264622">//&nbsp;0x3FBB3E6618EEE323</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264645">qa2</span>&nbsp;<span class="op" id="2264649">=</span>&nbsp;<span class="num" id="2264651">5.40397917702171048937e-01</span>&nbsp;&nbsp;<span class="comment" id="2264679">//&nbsp;0x3FE14AF092EB6F33</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264702">qa3</span>&nbsp;<span class="op" id="2264706">=</span>&nbsp;<span class="num" id="2264708">7.18286544141962662868e-02</span>&nbsp;&nbsp;<span class="comment" id="2264736">//&nbsp;0x3FB2635CD99FE9A7</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264759">qa4</span>&nbsp;<span class="op" id="2264763">=</span>&nbsp;<span class="num" id="2264765">1.26171219808761642112e-01</span>&nbsp;&nbsp;<span class="comment" id="2264793">//&nbsp;0x3FC02660E763351F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264816">qa5</span>&nbsp;<span class="op" id="2264820">=</span>&nbsp;<span class="num" id="2264822">1.36370839120290507362e-02</span>&nbsp;&nbsp;<span class="comment" id="2264850">//&nbsp;0x3F8BEDC26B51DD1C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264873">qa6</span>&nbsp;<span class="op" id="2264877">=</span>&nbsp;<span class="num" id="2264879">1.19844998467991074170e-02</span>&nbsp;&nbsp;<span class="comment" id="2264907">//&nbsp;0x3F888B545735151D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2264930">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1.25,&nbsp;1/0.35]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2264992">ra0</span>&nbsp;<span class="op" id="2264996">=</span>&nbsp;<span class="op" id="2264998">-</span><span class="num" id="2264999">9.86494403484714822705e-03</span>&nbsp;<span class="comment" id="2265026">//&nbsp;0xBF843412600D6435</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265049">ra1</span>&nbsp;<span class="op" id="2265053">=</span>&nbsp;<span class="op" id="2265055">-</span><span class="num" id="2265056">6.93858572707181764372e-01</span>&nbsp;<span class="comment" id="2265083">//&nbsp;0xBFE63416E4BA7360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265106">ra2</span>&nbsp;<span class="op" id="2265110">=</span>&nbsp;<span class="op" id="2265112">-</span><span class="num" id="2265113">1.05586262253232909814e+01</span>&nbsp;<span class="comment" id="2265140">//&nbsp;0xC0251E0441B0E726</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265163">ra3</span>&nbsp;<span class="op" id="2265167">=</span>&nbsp;<span class="op" id="2265169">-</span><span class="num" id="2265170">6.23753324503260060396e+01</span>&nbsp;<span class="comment" id="2265197">//&nbsp;0xC04F300AE4CBA38D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265220">ra4</span>&nbsp;<span class="op" id="2265224">=</span>&nbsp;<span class="op" id="2265226">-</span><span class="num" id="2265227">1.62396669462573470355e+02</span>&nbsp;<span class="comment" id="2265254">//&nbsp;0xC0644CB184282266</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265277">ra5</span>&nbsp;<span class="op" id="2265281">=</span>&nbsp;<span class="op" id="2265283">-</span><span class="num" id="2265284">1.84605092906711035994e+02</span>&nbsp;<span class="comment" id="2265311">//&nbsp;0xC067135CEBCCABB2</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265334">ra6</span>&nbsp;<span class="op" id="2265338">=</span>&nbsp;<span class="op" id="2265340">-</span><span class="num" id="2265341">8.12874355063065934246e+01</span>&nbsp;<span class="comment" id="2265368">//&nbsp;0xC054526557E4D2F2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265391">ra7</span>&nbsp;<span class="op" id="2265395">=</span>&nbsp;<span class="op" id="2265397">-</span><span class="num" id="2265398">9.81432934416914548592e+00</span>&nbsp;<span class="comment" id="2265425">//&nbsp;0xC023A0EFC69AC25C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265448">sa1</span>&nbsp;<span class="op" id="2265452">=</span>&nbsp;<span class="num" id="2265454">1.96512716674392571292e+01</span>&nbsp;&nbsp;<span class="comment" id="2265482">//&nbsp;0x4033A6B9BD707687</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265505">sa2</span>&nbsp;<span class="op" id="2265509">=</span>&nbsp;<span class="num" id="2265511">1.37657754143519042600e+02</span>&nbsp;&nbsp;<span class="comment" id="2265539">//&nbsp;0x4061350C526AE721</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265562">sa3</span>&nbsp;<span class="op" id="2265566">=</span>&nbsp;<span class="num" id="2265568">4.34565877475229228821e+02</span>&nbsp;&nbsp;<span class="comment" id="2265596">//&nbsp;0x407B290DD58A1A71</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265619">sa4</span>&nbsp;<span class="op" id="2265623">=</span>&nbsp;<span class="num" id="2265625">6.45387271733267880336e+02</span>&nbsp;&nbsp;<span class="comment" id="2265653">//&nbsp;0x40842B1921EC2868</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265676">sa5</span>&nbsp;<span class="op" id="2265680">=</span>&nbsp;<span class="num" id="2265682">4.29008140027567833386e+02</span>&nbsp;&nbsp;<span class="comment" id="2265710">//&nbsp;0x407AD02157700314</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265733">sa6</span>&nbsp;<span class="op" id="2265737">=</span>&nbsp;<span class="num" id="2265739">1.08635005541779435134e+02</span>&nbsp;&nbsp;<span class="comment" id="2265767">//&nbsp;0x405B28A3EE48AE2C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265790">sa7</span>&nbsp;<span class="op" id="2265794">=</span>&nbsp;<span class="num" id="2265796">6.57024977031928170135e+00</span>&nbsp;&nbsp;<span class="comment" id="2265824">//&nbsp;0x401A47EF8E484A93</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265847">sa8</span>&nbsp;<span class="op" id="2265851">=</span>&nbsp;<span class="op" id="2265853">-</span><span class="num" id="2265854">6.04244152148580987438e-02</span>&nbsp;<span class="comment" id="2265881">//&nbsp;0xBFAEEFF2EE749A62</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2265904">//&nbsp;Coefficients&nbsp;for&nbsp;approximation&nbsp;to&nbsp;&nbsp;erfc&nbsp;in&nbsp;[1/.35,&nbsp;28]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2265963">rb0</span>&nbsp;<span class="op" id="2265967">=</span>&nbsp;<span class="op" id="2265969">-</span><span class="num" id="2265970">9.86494292470009928597e-03</span>&nbsp;<span class="comment" id="2265997">//&nbsp;0xBF84341239E86F4A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266020">rb1</span>&nbsp;<span class="op" id="2266024">=</span>&nbsp;<span class="op" id="2266026">-</span><span class="num" id="2266027">7.99283237680523006574e-01</span>&nbsp;<span class="comment" id="2266054">//&nbsp;0xBFE993BA70C285DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266077">rb2</span>&nbsp;<span class="op" id="2266081">=</span>&nbsp;<span class="op" id="2266083">-</span><span class="num" id="2266084">1.77579549177547519889e+01</span>&nbsp;<span class="comment" id="2266111">//&nbsp;0xC031C209555F995A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266134">rb3</span>&nbsp;<span class="op" id="2266138">=</span>&nbsp;<span class="op" id="2266140">-</span><span class="num" id="2266141">1.60636384855821916062e+02</span>&nbsp;<span class="comment" id="2266168">//&nbsp;0xC064145D43C5ED98</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266191">rb4</span>&nbsp;<span class="op" id="2266195">=</span>&nbsp;<span class="op" id="2266197">-</span><span class="num" id="2266198">6.37566443368389627722e+02</span>&nbsp;<span class="comment" id="2266225">//&nbsp;0xC083EC881375F228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266248">rb5</span>&nbsp;<span class="op" id="2266252">=</span>&nbsp;<span class="op" id="2266254">-</span><span class="num" id="2266255">1.02509513161107724954e+03</span>&nbsp;<span class="comment" id="2266282">//&nbsp;0xC09004616A2E5992</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266305">rb6</span>&nbsp;<span class="op" id="2266309">=</span>&nbsp;<span class="op" id="2266311">-</span><span class="num" id="2266312">4.83519191608651397019e+02</span>&nbsp;<span class="comment" id="2266339">//&nbsp;0xC07E384E9BDC383F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266362">sb1</span>&nbsp;<span class="op" id="2266366">=</span>&nbsp;<span class="num" id="2266368">3.03380607434824582924e+01</span>&nbsp;&nbsp;<span class="comment" id="2266396">//&nbsp;0x403E568B261D5190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266419">sb2</span>&nbsp;<span class="op" id="2266423">=</span>&nbsp;<span class="num" id="2266425">3.25792512996573918826e+02</span>&nbsp;&nbsp;<span class="comment" id="2266453">//&nbsp;0x40745CAE221B9F0A</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266476">sb3</span>&nbsp;<span class="op" id="2266480">=</span>&nbsp;<span class="num" id="2266482">1.53672958608443695994e+03</span>&nbsp;&nbsp;<span class="comment" id="2266510">//&nbsp;0x409802EB189D5118</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266533">sb4</span>&nbsp;<span class="op" id="2266537">=</span>&nbsp;<span class="num" id="2266539">3.19985821950859553908e+03</span>&nbsp;&nbsp;<span class="comment" id="2266567">//&nbsp;0x40A8FFB7688C246A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266590">sb5</span>&nbsp;<span class="op" id="2266594">=</span>&nbsp;<span class="num" id="2266596">2.55305040643316442583e+03</span>&nbsp;&nbsp;<span class="comment" id="2266624">//&nbsp;0x40A3F219CEDF3BE6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266647">sb6</span>&nbsp;<span class="op" id="2266651">=</span>&nbsp;<span class="num" id="2266653">4.74528541206955367215e+02</span>&nbsp;&nbsp;<span class="comment" id="2266681">//&nbsp;0x407DA874E79FE763</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266704">sb7</span>&nbsp;<span class="op" id="2266708">=</span>&nbsp;<span class="op" id="2266710">-</span><span class="num" id="2266711">2.24409524465858183362e+01</span>&nbsp;<span class="comment" id="2266738">//&nbsp;0xC03670E242712D62</span><br>
<span class="lineno">180</span><span class="op" id="2266760">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2266763">//&nbsp;Erf&nbsp;returns&nbsp;the&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2266803">//</span><br>
<span class="lineno"></span><span class="comment" id="2266806">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">185</span><span class="comment" id="2266828">//&nbsp;&nbsp;&nbsp;&nbspErf(+Inf)&nbsp;=&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2266845">//&nbsp;&nbsp;&nbsp;&nbspErf(-Inf)&nbsp;=&nbsp;-1</span><br>
<span class="lineno"></span><span class="comment" id="2266863">//&nbsp;&nbsp;&nbsp;&nbspErf(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2266881">func</span>&nbsp;<span class="ident" id="2266886">Erf</span><span class="op" id="2266889">(</span><span class="ident" id="2266890">x</span>&nbsp;<span class="builtintype" id="2266892">float64</span><span class="op" id="2266899">)</span>&nbsp;<span class="builtintype" id="2266901">float64</span>&nbsp;<span class="op" id="2266909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2266912">const</span>&nbsp;<span class="op" id="2266918">(</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266922">VeryTiny</span>&nbsp;<span class="op" id="2266931">=</span>&nbsp;<span class="num" id="2266933">2.848094538889218e-306</span>&nbsp;<span class="comment" id="2266956">//&nbsp;0x0080000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2266980">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2266989">=</span>&nbsp;<span class="num" id="2266991">1.0</span>&nbsp;<span class="op" id="2266995">/</span>&nbsp;<span class="op" id="2266997">(</span><span class="num" id="2266998">1</span>&nbsp;<span class="op" id="2267000">&lt;&lt;</span>&nbsp;<span class="num" id="2267003">28</span><span class="op" id="2267005">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2267014">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2267028">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267046">switch</span>&nbsp;<span class="op" id="2267053">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267056">case</span>&nbsp;<span class="ident" id="2267061"><a href="/math/bits.go.html#2252065">IsNaN</a></span><span class="op" id="2267066">(</span><span class="ident" id="2267067"><a href="/math/erf.go.html#2266890">x</a></span><span class="op" id="2267068">)</span><span class="op" id="2267069">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267073">return</span>&nbsp;<span class="ident" id="2267080"><a href="/math/bits.go.html#2251945">NaN</a></span><span class="op" id="2267083">(</span><span class="op" id="2267084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267087">case</span>&nbsp;<span class="ident" id="2267092"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2267097">(</span><span class="ident" id="2267098"><a href="/math/erf.go.html#2266890">x</a></span><span class="op" id="2267099">,</span>&nbsp;<span class="num" id="2267101">1</span><span class="op" id="2267102">)</span><span class="op" id="2267103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267107">return</span>&nbsp;<span class="num" id="2267114">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267117">case</span>&nbsp;<span class="ident" id="2267122"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2267127">(</span><span class="ident" id="2267128"><a href="/math/erf.go.html#2266890">x</a></span><span class="op" id="2267129">,</span>&nbsp;<span class="op" id="2267131">-</span><span class="num" id="2267132">1</span><span class="op" id="2267133">)</span><span class="op" id="2267134">:</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267138">return</span>&nbsp;<span class="op" id="2267145">-</span><span class="num" id="2267146">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267152">sign</span>&nbsp;<span class="op" id="2267157">:=</span>&nbsp;<span class="builtintype" id="2267160">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267167">if</span>&nbsp;<span class="ident" id="2267170"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2267172">&lt;</span>&nbsp;<span class="num" id="2267174">0</span>&nbsp;<span class="op" id="2267176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267180"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2267182">=</span>&nbsp;<span class="op" id="2267184">-</span><span class="ident" id="2267185"><a href="/math/erf.go.html#2266890">x</a></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267189"><a href="/math/erf.go.html#2267152">sign</a></span>&nbsp;<span class="op" id="2267194">=</span>&nbsp;<span class="builtintype" id="2267196">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267205">if</span>&nbsp;<span class="ident" id="2267208"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2267210">&lt;</span>&nbsp;<span class="num" id="2267212">0.84375</span>&nbsp;<span class="op" id="2267220">{</span>&nbsp;<span class="comment" id="2267222">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267241">var</span>&nbsp;<span class="ident" id="2267245">temp</span>&nbsp;<span class="builtintype" id="2267250">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267260">if</span>&nbsp;<span class="ident" id="2267263"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2267265">&lt;</span>&nbsp;<span class="ident" id="2267267"><a href="/math/erf.go.html#2266980">Small</a></span>&nbsp;<span class="op" id="2267273">{</span>&nbsp;<span class="comment" id="2267275">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267294">if</span>&nbsp;<span class="ident" id="2267297"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2267299">&lt;</span>&nbsp;<span class="ident" id="2267301"><a href="/math/erf.go.html#2266922">VeryTiny</a></span>&nbsp;<span class="op" id="2267310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267316"><a href="/math/erf.go.html#2267245">temp</a></span>&nbsp;<span class="op" id="2267321">=</span>&nbsp;<span class="num" id="2267323">0.125</span>&nbsp;<span class="op" id="2267329">*</span>&nbsp;<span class="op" id="2267331">(</span><span class="num" id="2267332">8.0</span><span class="op" id="2267335">*</span><span class="ident" id="2267336"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2267338">+</span>&nbsp;<span class="ident" id="2267340"><a href="/math/erf.go.html#2263488">efx8</a></span><span class="op" id="2267344">*</span><span class="ident" id="2267345"><a href="/math/erf.go.html#2266890">x</a></span><span class="op" id="2267346">)</span>&nbsp;<span class="comment" id="2267348">//&nbsp;avoid&nbsp;underflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267370">}</span>&nbsp;<span class="keyword" id="2267372">else</span>&nbsp;<span class="op" id="2267377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267383"><a href="/math/erf.go.html#2267245">temp</a></span>&nbsp;<span class="op" id="2267388">=</span>&nbsp;<span class="ident" id="2267390"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2267392">+</span>&nbsp;<span class="ident" id="2267394"><a href="/math/erf.go.html#2263430">efx</a></span><span class="op" id="2267397">*</span><span class="ident" id="2267398"><a href="/math/erf.go.html#2266890">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267403">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267407">}</span>&nbsp;<span class="keyword" id="2267409">else</span>&nbsp;<span class="op" id="2267414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267419">z</span>&nbsp;<span class="op" id="2267421">:=</span>&nbsp;<span class="ident" id="2267424"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2267426">*</span>&nbsp;<span class="ident" id="2267428"><a href="/math/erf.go.html#2266890">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267433">r</span>&nbsp;<span class="op" id="2267435">:=</span>&nbsp;<span class="ident" id="2267438"><a href="/math/erf.go.html#2263546">pp0</a></span>&nbsp;<span class="op" id="2267442">+</span>&nbsp;<span class="ident" id="2267444"><a href="/math/erf.go.html#2267419">z</a></span><span class="op" id="2267445">*</span><span class="op" id="2267446">(</span><span class="ident" id="2267447"><a href="/math/erf.go.html#2263604">pp1</a></span><span class="op" id="2267450">+</span><span class="ident" id="2267451"><a href="/math/erf.go.html#2267419">z</a></span><span class="op" id="2267452">*</span><span class="op" id="2267453">(</span><span class="ident" id="2267454"><a href="/math/erf.go.html#2263662">pp2</a></span><span class="op" id="2267457">+</span><span class="ident" id="2267458"><a href="/math/erf.go.html#2267419">z</a></span><span class="op" id="2267459">*</span><span class="op" id="2267460">(</span><span class="ident" id="2267461"><a href="/math/erf.go.html#2263720">pp3</a></span><span class="op" id="2267464">+</span><span class="ident" id="2267465"><a href="/math/erf.go.html#2267419">z</a></span><span class="op" id="2267466">*</span><span class="ident" id="2267467"><a href="/math/erf.go.html#2263778">pp4</a></span><span class="op" id="2267470">)</span><span class="op" id="2267471">)</span><span class="op" id="2267472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267477">s</span>&nbsp;<span class="op" id="2267479">:=</span>&nbsp;<span class="num" id="2267482">1</span>&nbsp;<span class="op" id="2267484">+</span>&nbsp;<span class="ident" id="2267486"><a href="/math/erf.go.html#2267419">z</a></span><span class="op" id="2267487">*</span><span class="op" id="2267488">(</span><span class="ident" id="2267489"><a href="/math/erf.go.html#2263836">qq1</a></span><span class="op" id="2267492">+</span><span class="ident" id="2267493"><a href="/math/erf.go.html#2267419">z</a></span><span class="op" id="2267494">*</span><span class="op" id="2267495">(</span><span class="ident" id="2267496"><a href="/math/erf.go.html#2263894">qq2</a></span><span class="op" id="2267499">+</span><span class="ident" id="2267500"><a href="/math/erf.go.html#2267419">z</a></span><span class="op" id="2267501">*</span><span class="op" id="2267502">(</span><span class="ident" id="2267503"><a href="/math/erf.go.html#2263952">qq3</a></span><span class="op" id="2267506">+</span><span class="ident" id="2267507"><a href="/math/erf.go.html#2267419">z</a></span><span class="op" id="2267508">*</span><span class="op" id="2267509">(</span><span class="ident" id="2267510"><a href="/math/erf.go.html#2264010">qq4</a></span><span class="op" id="2267513">+</span><span class="ident" id="2267514"><a href="/math/erf.go.html#2267419">z</a></span><span class="op" id="2267515">*</span><span class="ident" id="2267516"><a href="/math/erf.go.html#2264068">qq5</a></span><span class="op" id="2267519">)</span><span class="op" id="2267520">)</span><span class="op" id="2267521">)</span><span class="op" id="2267522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267527">y</span>&nbsp;<span class="op" id="2267529">:=</span>&nbsp;<span class="ident" id="2267532"><a href="/math/erf.go.html#2267433">r</a></span>&nbsp;<span class="op" id="2267534">/</span>&nbsp;<span class="ident" id="2267536"><a href="/math/erf.go.html#2267477">s</a></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267541"><a href="/math/erf.go.html#2267245">temp</a></span>&nbsp;<span class="op" id="2267546">=</span>&nbsp;<span class="ident" id="2267548"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2267550">+</span>&nbsp;<span class="ident" id="2267552"><a href="/math/erf.go.html#2266890">x</a></span><span class="op" id="2267553">*</span><span class="ident" id="2267554"><a href="/math/erf.go.html#2267527">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267562">if</span>&nbsp;<span class="ident" id="2267565"><a href="/math/erf.go.html#2267152">sign</a></span>&nbsp;<span class="op" id="2267570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267575">return</span>&nbsp;<span class="op" id="2267582">-</span><span class="ident" id="2267583"><a href="/math/erf.go.html#2267245">temp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267590">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267594">return</span>&nbsp;<span class="ident" id="2267601"><a href="/math/erf.go.html#2267245">temp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267610">if</span>&nbsp;<span class="ident" id="2267613"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2267615">&lt;</span>&nbsp;<span class="num" id="2267617">1.25</span>&nbsp;<span class="op" id="2267622">{</span>&nbsp;<span class="comment" id="2267624">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267651">s</span>&nbsp;<span class="op" id="2267653">:=</span>&nbsp;<span class="ident" id="2267656"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2267658">-</span>&nbsp;<span class="num" id="2267660">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267664">P</span>&nbsp;<span class="op" id="2267666">:=</span>&nbsp;<span class="ident" id="2267669"><a href="/math/erf.go.html#2264189">pa0</a></span>&nbsp;<span class="op" id="2267673">+</span>&nbsp;<span class="ident" id="2267675"><a href="/math/erf.go.html#2267651">s</a></span><span class="op" id="2267676">*</span><span class="op" id="2267677">(</span><span class="ident" id="2267678"><a href="/math/erf.go.html#2264246">pa1</a></span><span class="op" id="2267681">+</span><span class="ident" id="2267682"><a href="/math/erf.go.html#2267651">s</a></span><span class="op" id="2267683">*</span><span class="op" id="2267684">(</span><span class="ident" id="2267685"><a href="/math/erf.go.html#2264303">pa2</a></span><span class="op" id="2267688">+</span><span class="ident" id="2267689"><a href="/math/erf.go.html#2267651">s</a></span><span class="op" id="2267690">*</span><span class="op" id="2267691">(</span><span class="ident" id="2267692"><a href="/math/erf.go.html#2264360">pa3</a></span><span class="op" id="2267695">+</span><span class="ident" id="2267696"><a href="/math/erf.go.html#2267651">s</a></span><span class="op" id="2267697">*</span><span class="op" id="2267698">(</span><span class="ident" id="2267699"><a href="/math/erf.go.html#2264417">pa4</a></span><span class="op" id="2267702">+</span><span class="ident" id="2267703"><a href="/math/erf.go.html#2267651">s</a></span><span class="op" id="2267704">*</span><span class="op" id="2267705">(</span><span class="ident" id="2267706"><a href="/math/erf.go.html#2264474">pa5</a></span><span class="op" id="2267709">+</span><span class="ident" id="2267710"><a href="/math/erf.go.html#2267651">s</a></span><span class="op" id="2267711">*</span><span class="ident" id="2267712"><a href="/math/erf.go.html#2264531">pa6</a></span><span class="op" id="2267715">)</span><span class="op" id="2267716">)</span><span class="op" id="2267717">)</span><span class="op" id="2267718">)</span><span class="op" id="2267719">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267723">Q</span>&nbsp;<span class="op" id="2267725">:=</span>&nbsp;<span class="num" id="2267728">1</span>&nbsp;<span class="op" id="2267730">+</span>&nbsp;<span class="ident" id="2267732"><a href="/math/erf.go.html#2267651">s</a></span><span class="op" id="2267733">*</span><span class="op" id="2267734">(</span><span class="ident" id="2267735"><a href="/math/erf.go.html#2264588">qa1</a></span><span class="op" id="2267738">+</span><span class="ident" id="2267739"><a href="/math/erf.go.html#2267651">s</a></span><span class="op" id="2267740">*</span><span class="op" id="2267741">(</span><span class="ident" id="2267742"><a href="/math/erf.go.html#2264645">qa2</a></span><span class="op" id="2267745">+</span><span class="ident" id="2267746"><a href="/math/erf.go.html#2267651">s</a></span><span class="op" id="2267747">*</span><span class="op" id="2267748">(</span><span class="ident" id="2267749"><a href="/math/erf.go.html#2264702">qa3</a></span><span class="op" id="2267752">+</span><span class="ident" id="2267753"><a href="/math/erf.go.html#2267651">s</a></span><span class="op" id="2267754">*</span><span class="op" id="2267755">(</span><span class="ident" id="2267756"><a href="/math/erf.go.html#2264759">qa4</a></span><span class="op" id="2267759">+</span><span class="ident" id="2267760"><a href="/math/erf.go.html#2267651">s</a></span><span class="op" id="2267761">*</span><span class="op" id="2267762">(</span><span class="ident" id="2267763"><a href="/math/erf.go.html#2264816">qa5</a></span><span class="op" id="2267766">+</span><span class="ident" id="2267767"><a href="/math/erf.go.html#2267651">s</a></span><span class="op" id="2267768">*</span><span class="ident" id="2267769"><a href="/math/erf.go.html#2264873">qa6</a></span><span class="op" id="2267772">)</span><span class="op" id="2267773">)</span><span class="op" id="2267774">)</span><span class="op" id="2267775">)</span><span class="op" id="2267776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267780">if</span>&nbsp;<span class="ident" id="2267783"><a href="/math/erf.go.html#2267152">sign</a></span>&nbsp;<span class="op" id="2267788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267793">return</span>&nbsp;<span class="op" id="2267800">-</span><span class="ident" id="2267801"><a href="/math/erf.go.html#2263315">erx</a></span>&nbsp;<span class="op" id="2267805">-</span>&nbsp;<span class="ident" id="2267807"><a href="/math/erf.go.html#2267664">P</a></span><span class="op" id="2267808">/</span><span class="ident" id="2267809"><a href="/math/erf.go.html#2267723">Q</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267817">return</span>&nbsp;<span class="ident" id="2267824"><a href="/math/erf.go.html#2263315">erx</a></span>&nbsp;<span class="op" id="2267828">+</span>&nbsp;<span class="ident" id="2267830"><a href="/math/erf.go.html#2267664">P</a></span><span class="op" id="2267831">/</span><span class="ident" id="2267832"><a href="/math/erf.go.html#2267723">Q</a></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267838">if</span>&nbsp;<span class="ident" id="2267841"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2267843">&gt;=</span>&nbsp;<span class="num" id="2267846">6</span>&nbsp;<span class="op" id="2267848">{</span>&nbsp;<span class="comment" id="2267850">//&nbsp;inf&nbsp;&gt;&nbsp;|x|&nbsp;&gt;=&nbsp;6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267870">if</span>&nbsp;<span class="ident" id="2267873"><a href="/math/erf.go.html#2267152">sign</a></span>&nbsp;<span class="op" id="2267878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267883">return</span>&nbsp;<span class="op" id="2267890">-</span><span class="num" id="2267891">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267895">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267899">return</span>&nbsp;<span class="num" id="2267906">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2267909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267912">s</span>&nbsp;<span class="op" id="2267914">:=</span>&nbsp;<span class="num" id="2267917">1</span>&nbsp;<span class="op" id="2267919">/</span>&nbsp;<span class="op" id="2267921">(</span><span class="ident" id="2267922"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2267924">*</span>&nbsp;<span class="ident" id="2267926"><a href="/math/erf.go.html#2266890">x</a></span><span class="op" id="2267927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267930">var</span>&nbsp;<span class="ident" id="2267934">R</span><span class="op" id="2267935">,</span>&nbsp;<span class="ident" id="2267937">S</span>&nbsp;<span class="builtintype" id="2267939">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2267948">if</span>&nbsp;<span class="ident" id="2267951"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2267953">&lt;</span>&nbsp;<span class="num" id="2267955">1</span><span class="op" id="2267956">/</span><span class="num" id="2267957">0.35</span>&nbsp;<span class="op" id="2267962">{</span>&nbsp;<span class="comment" id="2267964">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2267996"><a href="/math/erf.go.html#2267934">R</a></span>&nbsp;<span class="op" id="2267998">=</span>&nbsp;<span class="ident" id="2268000"><a href="/math/erf.go.html#2264992">ra0</a></span>&nbsp;<span class="op" id="2268004">+</span>&nbsp;<span class="ident" id="2268006"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268007">*</span><span class="op" id="2268008">(</span><span class="ident" id="2268009"><a href="/math/erf.go.html#2265049">ra1</a></span><span class="op" id="2268012">+</span><span class="ident" id="2268013"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268014">*</span><span class="op" id="2268015">(</span><span class="ident" id="2268016"><a href="/math/erf.go.html#2265106">ra2</a></span><span class="op" id="2268019">+</span><span class="ident" id="2268020"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268021">*</span><span class="op" id="2268022">(</span><span class="ident" id="2268023"><a href="/math/erf.go.html#2265163">ra3</a></span><span class="op" id="2268026">+</span><span class="ident" id="2268027"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268028">*</span><span class="op" id="2268029">(</span><span class="ident" id="2268030"><a href="/math/erf.go.html#2265220">ra4</a></span><span class="op" id="2268033">+</span><span class="ident" id="2268034"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268035">*</span><span class="op" id="2268036">(</span><span class="ident" id="2268037"><a href="/math/erf.go.html#2265277">ra5</a></span><span class="op" id="2268040">+</span><span class="ident" id="2268041"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268042">*</span><span class="op" id="2268043">(</span><span class="ident" id="2268044"><a href="/math/erf.go.html#2265334">ra6</a></span><span class="op" id="2268047">+</span><span class="ident" id="2268048"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268049">*</span><span class="ident" id="2268050"><a href="/math/erf.go.html#2265391">ra7</a></span><span class="op" id="2268053">)</span><span class="op" id="2268054">)</span><span class="op" id="2268055">)</span><span class="op" id="2268056">)</span><span class="op" id="2268057">)</span><span class="op" id="2268058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268062"><a href="/math/erf.go.html#2267937">S</a></span>&nbsp;<span class="op" id="2268064">=</span>&nbsp;<span class="num" id="2268066">1</span>&nbsp;<span class="op" id="2268068">+</span>&nbsp;<span class="ident" id="2268070"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268071">*</span><span class="op" id="2268072">(</span><span class="ident" id="2268073"><a href="/math/erf.go.html#2265448">sa1</a></span><span class="op" id="2268076">+</span><span class="ident" id="2268077"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268078">*</span><span class="op" id="2268079">(</span><span class="ident" id="2268080"><a href="/math/erf.go.html#2265505">sa2</a></span><span class="op" id="2268083">+</span><span class="ident" id="2268084"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268085">*</span><span class="op" id="2268086">(</span><span class="ident" id="2268087"><a href="/math/erf.go.html#2265562">sa3</a></span><span class="op" id="2268090">+</span><span class="ident" id="2268091"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268092">*</span><span class="op" id="2268093">(</span><span class="ident" id="2268094"><a href="/math/erf.go.html#2265619">sa4</a></span><span class="op" id="2268097">+</span><span class="ident" id="2268098"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268099">*</span><span class="op" id="2268100">(</span><span class="ident" id="2268101"><a href="/math/erf.go.html#2265676">sa5</a></span><span class="op" id="2268104">+</span><span class="ident" id="2268105"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268106">*</span><span class="op" id="2268107">(</span><span class="ident" id="2268108"><a href="/math/erf.go.html#2265733">sa6</a></span><span class="op" id="2268111">+</span><span class="ident" id="2268112"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268113">*</span><span class="op" id="2268114">(</span><span class="ident" id="2268115"><a href="/math/erf.go.html#2265790">sa7</a></span><span class="op" id="2268118">+</span><span class="ident" id="2268119"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268120">*</span><span class="ident" id="2268121"><a href="/math/erf.go.html#2265847">sa8</a></span><span class="op" id="2268124">)</span><span class="op" id="2268125">)</span><span class="op" id="2268126">)</span><span class="op" id="2268127">)</span><span class="op" id="2268128">)</span><span class="op" id="2268129">)</span><span class="op" id="2268130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268133">}</span>&nbsp;<span class="keyword" id="2268135">else</span>&nbsp;<span class="op" id="2268140">{</span>&nbsp;<span class="comment" id="2268142">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268175"><a href="/math/erf.go.html#2267934">R</a></span>&nbsp;<span class="op" id="2268177">=</span>&nbsp;<span class="ident" id="2268179"><a href="/math/erf.go.html#2265963">rb0</a></span>&nbsp;<span class="op" id="2268183">+</span>&nbsp;<span class="ident" id="2268185"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268186">*</span><span class="op" id="2268187">(</span><span class="ident" id="2268188"><a href="/math/erf.go.html#2266020">rb1</a></span><span class="op" id="2268191">+</span><span class="ident" id="2268192"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268193">*</span><span class="op" id="2268194">(</span><span class="ident" id="2268195"><a href="/math/erf.go.html#2266077">rb2</a></span><span class="op" id="2268198">+</span><span class="ident" id="2268199"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268200">*</span><span class="op" id="2268201">(</span><span class="ident" id="2268202"><a href="/math/erf.go.html#2266134">rb3</a></span><span class="op" id="2268205">+</span><span class="ident" id="2268206"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268207">*</span><span class="op" id="2268208">(</span><span class="ident" id="2268209"><a href="/math/erf.go.html#2266191">rb4</a></span><span class="op" id="2268212">+</span><span class="ident" id="2268213"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268214">*</span><span class="op" id="2268215">(</span><span class="ident" id="2268216"><a href="/math/erf.go.html#2266248">rb5</a></span><span class="op" id="2268219">+</span><span class="ident" id="2268220"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268221">*</span><span class="ident" id="2268222"><a href="/math/erf.go.html#2266305">rb6</a></span><span class="op" id="2268225">)</span><span class="op" id="2268226">)</span><span class="op" id="2268227">)</span><span class="op" id="2268228">)</span><span class="op" id="2268229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268233"><a href="/math/erf.go.html#2267937">S</a></span>&nbsp;<span class="op" id="2268235">=</span>&nbsp;<span class="num" id="2268237">1</span>&nbsp;<span class="op" id="2268239">+</span>&nbsp;<span class="ident" id="2268241"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268242">*</span><span class="op" id="2268243">(</span><span class="ident" id="2268244"><a href="/math/erf.go.html#2266362">sb1</a></span><span class="op" id="2268247">+</span><span class="ident" id="2268248"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268249">*</span><span class="op" id="2268250">(</span><span class="ident" id="2268251"><a href="/math/erf.go.html#2266419">sb2</a></span><span class="op" id="2268254">+</span><span class="ident" id="2268255"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268256">*</span><span class="op" id="2268257">(</span><span class="ident" id="2268258"><a href="/math/erf.go.html#2266476">sb3</a></span><span class="op" id="2268261">+</span><span class="ident" id="2268262"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268263">*</span><span class="op" id="2268264">(</span><span class="ident" id="2268265"><a href="/math/erf.go.html#2266533">sb4</a></span><span class="op" id="2268268">+</span><span class="ident" id="2268269"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268270">*</span><span class="op" id="2268271">(</span><span class="ident" id="2268272"><a href="/math/erf.go.html#2266590">sb5</a></span><span class="op" id="2268275">+</span><span class="ident" id="2268276"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268277">*</span><span class="op" id="2268278">(</span><span class="ident" id="2268279"><a href="/math/erf.go.html#2266647">sb6</a></span><span class="op" id="2268282">+</span><span class="ident" id="2268283"><a href="/math/erf.go.html#2267912">s</a></span><span class="op" id="2268284">*</span><span class="ident" id="2268285"><a href="/math/erf.go.html#2266704">sb7</a></span><span class="op" id="2268288">)</span><span class="op" id="2268289">)</span><span class="op" id="2268290">)</span><span class="op" id="2268291">)</span><span class="op" id="2268292">)</span><span class="op" id="2268293">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268299">z</span>&nbsp;<span class="op" id="2268301">:=</span>&nbsp;<span class="ident" id="2268304"><a href="/math/unsafe.go.html#2380889">Float64frombits</a></span><span class="op" id="2268319">(</span><span class="ident" id="2268320"><a href="/math/unsafe.go.html#2380703">Float64bits</a></span><span class="op" id="2268331">(</span><span class="ident" id="2268332"><a href="/math/erf.go.html#2266890">x</a></span><span class="op" id="2268333">)</span>&nbsp;<span class="op" id="2268335">&amp;</span>&nbsp;<span class="num" id="2268337">0xffffffff00000000</span><span class="op" id="2268355">)</span>&nbsp;<span class="comment" id="2268357">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268396">r</span>&nbsp;<span class="op" id="2268398">:=</span>&nbsp;<span class="ident" id="2268401"><a href="/math/exp.go.html#2270578">Exp</a></span><span class="op" id="2268404">(</span><span class="op" id="2268405">-</span><span class="ident" id="2268406"><a href="/math/erf.go.html#2268299">z</a></span><span class="op" id="2268407">*</span><span class="ident" id="2268408"><a href="/math/erf.go.html#2268299">z</a></span><span class="op" id="2268409">-</span><span class="num" id="2268410">0.5625</span><span class="op" id="2268416">)</span>&nbsp;<span class="op" id="2268418">*</span>&nbsp;<span class="ident" id="2268420"><a href="/math/exp.go.html#2270578">Exp</a></span><span class="op" id="2268423">(</span><span class="op" id="2268424">(</span><span class="ident" id="2268425"><a href="/math/erf.go.html#2268299">z</a></span><span class="op" id="2268426">-</span><span class="ident" id="2268427"><a href="/math/erf.go.html#2266890">x</a></span><span class="op" id="2268428">)</span><span class="op" id="2268429">*</span><span class="op" id="2268430">(</span><span class="ident" id="2268431"><a href="/math/erf.go.html#2268299">z</a></span><span class="op" id="2268432">+</span><span class="ident" id="2268433"><a href="/math/erf.go.html#2266890">x</a></span><span class="op" id="2268434">)</span><span class="op" id="2268435">+</span><span class="ident" id="2268436"><a href="/math/erf.go.html#2267934">R</a></span><span class="op" id="2268437">/</span><span class="ident" id="2268438"><a href="/math/erf.go.html#2267937">S</a></span><span class="op" id="2268439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268442">if</span>&nbsp;<span class="ident" id="2268445"><a href="/math/erf.go.html#2267152">sign</a></span>&nbsp;<span class="op" id="2268450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268454">return</span>&nbsp;<span class="ident" id="2268461"><a href="/math/erf.go.html#2268396">r</a></span><span class="op" id="2268462">/</span><span class="ident" id="2268463"><a href="/math/erf.go.html#2266890">x</a></span>&nbsp;<span class="op" id="2268465">-</span>&nbsp;<span class="num" id="2268467">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268473">return</span>&nbsp;<span class="num" id="2268480">1</span>&nbsp;<span class="op" id="2268482">-</span>&nbsp;<span class="ident" id="2268484"><a href="/math/erf.go.html#2268396">r</a></span><span class="op" id="2268485">/</span><span class="ident" id="2268486"><a href="/math/erf.go.html#2266890">x</a></span><br>
<span class="lineno"></span><span class="op" id="2268488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2268491">//&nbsp;Erfc&nbsp;returns&nbsp;the&nbsp;complementary&nbsp;error&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno">260</span><span class="comment" id="2268546">//</span><br>
<span class="lineno"></span><span class="comment" id="2268549">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2268571">//&nbsp;&nbsp;&nbsp;&nbspErfc(+Inf)&nbsp;=&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="2268589">//&nbsp;&nbsp;&nbsp;&nbspErfc(-Inf)&nbsp;=&nbsp;2</span><br>
<span class="lineno"></span><span class="comment" id="2268607">//&nbsp;&nbsp;&nbsp;&nbspErfc(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">265</span><span class="keyword" id="2268626">func</span>&nbsp;<span class="ident" id="2268631">Erfc</span><span class="op" id="2268635">(</span><span class="ident" id="2268636">x</span>&nbsp;<span class="builtintype" id="2268638">float64</span><span class="op" id="2268645">)</span>&nbsp;<span class="builtintype" id="2268647">float64</span>&nbsp;<span class="op" id="2268655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268658">const</span>&nbsp;<span class="ident" id="2268664">Tiny</span>&nbsp;<span class="op" id="2268669">=</span>&nbsp;<span class="num" id="2268671">1.0</span>&nbsp;<span class="op" id="2268675">/</span>&nbsp;<span class="op" id="2268677">(</span><span class="num" id="2268678">1</span>&nbsp;<span class="op" id="2268680">&lt;&lt;</span>&nbsp;<span class="num" id="2268683">56</span><span class="op" id="2268685">)</span>&nbsp;<span class="comment" id="2268687">//&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2268698">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268716">switch</span>&nbsp;<span class="op" id="2268723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268726">case</span>&nbsp;<span class="ident" id="2268731"><a href="/math/bits.go.html#2252065">IsNaN</a></span><span class="op" id="2268736">(</span><span class="ident" id="2268737"><a href="/math/erf.go.html#2268636">x</a></span><span class="op" id="2268738">)</span><span class="op" id="2268739">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268743">return</span>&nbsp;<span class="ident" id="2268750"><a href="/math/bits.go.html#2251945">NaN</a></span><span class="op" id="2268753">(</span><span class="op" id="2268754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268757">case</span>&nbsp;<span class="ident" id="2268762"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2268767">(</span><span class="ident" id="2268768"><a href="/math/erf.go.html#2268636">x</a></span><span class="op" id="2268769">,</span>&nbsp;<span class="num" id="2268771">1</span><span class="op" id="2268772">)</span><span class="op" id="2268773">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268777">return</span>&nbsp;<span class="num" id="2268784">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268787">case</span>&nbsp;<span class="ident" id="2268792"><a href="/math/bits.go.html#2252563">IsInf</a></span><span class="op" id="2268797">(</span><span class="ident" id="2268798"><a href="/math/erf.go.html#2268636">x</a></span><span class="op" id="2268799">,</span>&nbsp;<span class="op" id="2268801">-</span><span class="num" id="2268802">1</span><span class="op" id="2268803">)</span><span class="op" id="2268804">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268808">return</span>&nbsp;<span class="num" id="2268815">2</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268821">sign</span>&nbsp;<span class="op" id="2268826">:=</span>&nbsp;<span class="builtintype" id="2268829">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268836">if</span>&nbsp;<span class="ident" id="2268839"><a href="/math/erf.go.html#2268636">x</a></span>&nbsp;<span class="op" id="2268841">&lt;</span>&nbsp;<span class="num" id="2268843">0</span>&nbsp;<span class="op" id="2268845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268849"><a href="/math/erf.go.html#2268636">x</a></span>&nbsp;<span class="op" id="2268851">=</span>&nbsp;<span class="op" id="2268853">-</span><span class="ident" id="2268854"><a href="/math/erf.go.html#2268636">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268858"><a href="/math/erf.go.html#2268821">sign</a></span>&nbsp;<span class="op" id="2268863">=</span>&nbsp;<span class="builtintype" id="2268865">true</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268874">if</span>&nbsp;<span class="ident" id="2268877"><a href="/math/erf.go.html#2268636">x</a></span>&nbsp;<span class="op" id="2268879">&lt;</span>&nbsp;<span class="num" id="2268881">0.84375</span>&nbsp;<span class="op" id="2268889">{</span>&nbsp;<span class="comment" id="2268891">//&nbsp;|x|&nbsp;&lt;&nbsp;0.84375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268910">var</span>&nbsp;<span class="ident" id="2268914">temp</span>&nbsp;<span class="builtintype" id="2268919">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2268929">if</span>&nbsp;<span class="ident" id="2268932"><a href="/math/erf.go.html#2268636">x</a></span>&nbsp;<span class="op" id="2268934">&lt;</span>&nbsp;<span class="ident" id="2268936"><a href="/math/erf.go.html#2268664">Tiny</a></span>&nbsp;<span class="op" id="2268941">{</span>&nbsp;<span class="comment" id="2268943">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268962"><a href="/math/erf.go.html#2268914">temp</a></span>&nbsp;<span class="op" id="2268967">=</span>&nbsp;<span class="ident" id="2268969"><a href="/math/erf.go.html#2268636">x</a></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2268973">}</span>&nbsp;<span class="keyword" id="2268975">else</span>&nbsp;<span class="op" id="2268980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268985">z</span>&nbsp;<span class="op" id="2268987">:=</span>&nbsp;<span class="ident" id="2268990"><a href="/math/erf.go.html#2268636">x</a></span>&nbsp;<span class="op" id="2268992">*</span>&nbsp;<span class="ident" id="2268994"><a href="/math/erf.go.html#2268636">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2268999">r</span>&nbsp;<span class="op" id="2269001">:=</span>&nbsp;<span class="ident" id="2269004"><a href="/math/erf.go.html#2263546">pp0</a></span>&nbsp;<span class="op" id="2269008">+</span>&nbsp;<span class="ident" id="2269010"><a href="/math/erf.go.html#2268985">z</a></span><span class="op" id="2269011">*</span><span class="op" id="2269012">(</span><span class="ident" id="2269013"><a href="/math/erf.go.html#2263604">pp1</a></span><span class="op" id="2269016">+</span><span class="ident" id="2269017"><a href="/math/erf.go.html#2268985">z</a></span><span class="op" id="2269018">*</span><span class="op" id="2269019">(</span><span class="ident" id="2269020"><a href="/math/erf.go.html#2263662">pp2</a></span><span class="op" id="2269023">+</span><span class="ident" id="2269024"><a href="/math/erf.go.html#2268985">z</a></span><span class="op" id="2269025">*</span><span class="op" id="2269026">(</span><span class="ident" id="2269027"><a href="/math/erf.go.html#2263720">pp3</a></span><span class="op" id="2269030">+</span><span class="ident" id="2269031"><a href="/math/erf.go.html#2268985">z</a></span><span class="op" id="2269032">*</span><span class="ident" id="2269033"><a href="/math/erf.go.html#2263778">pp4</a></span><span class="op" id="2269036">)</span><span class="op" id="2269037">)</span><span class="op" id="2269038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269043">s</span>&nbsp;<span class="op" id="2269045">:=</span>&nbsp;<span class="num" id="2269048">1</span>&nbsp;<span class="op" id="2269050">+</span>&nbsp;<span class="ident" id="2269052"><a href="/math/erf.go.html#2268985">z</a></span><span class="op" id="2269053">*</span><span class="op" id="2269054">(</span><span class="ident" id="2269055"><a href="/math/erf.go.html#2263836">qq1</a></span><span class="op" id="2269058">+</span><span class="ident" id="2269059"><a href="/math/erf.go.html#2268985">z</a></span><span class="op" id="2269060">*</span><span class="op" id="2269061">(</span><span class="ident" id="2269062"><a href="/math/erf.go.html#2263894">qq2</a></span><span class="op" id="2269065">+</span><span class="ident" id="2269066"><a href="/math/erf.go.html#2268985">z</a></span><span class="op" id="2269067">*</span><span class="op" id="2269068">(</span><span class="ident" id="2269069"><a href="/math/erf.go.html#2263952">qq3</a></span><span class="op" id="2269072">+</span><span class="ident" id="2269073"><a href="/math/erf.go.html#2268985">z</a></span><span class="op" id="2269074">*</span><span class="op" id="2269075">(</span><span class="ident" id="2269076"><a href="/math/erf.go.html#2264010">qq4</a></span><span class="op" id="2269079">+</span><span class="ident" id="2269080"><a href="/math/erf.go.html#2268985">z</a></span><span class="op" id="2269081">*</span><span class="ident" id="2269082"><a href="/math/erf.go.html#2264068">qq5</a></span><span class="op" id="2269085">)</span><span class="op" id="2269086">)</span><span class="op" id="2269087">)</span><span class="op" id="2269088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269093">y</span>&nbsp;<span class="op" id="2269095">:=</span>&nbsp;<span class="ident" id="2269098"><a href="/math/erf.go.html#2268999">r</a></span>&nbsp;<span class="op" id="2269100">/</span>&nbsp;<span class="ident" id="2269102"><a href="/math/erf.go.html#2269043">s</a></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269107">if</span>&nbsp;<span class="ident" id="2269110"><a href="/math/erf.go.html#2268636">x</a></span>&nbsp;<span class="op" id="2269112">&lt;</span>&nbsp;<span class="num" id="2269114">0.25</span>&nbsp;<span class="op" id="2269119">{</span>&nbsp;<span class="comment" id="2269121">//&nbsp;|x|&nbsp;&lt;&nbsp;1/4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269138"><a href="/math/erf.go.html#2268914">temp</a></span>&nbsp;<span class="op" id="2269143">=</span>&nbsp;<span class="ident" id="2269145"><a href="/math/erf.go.html#2268636">x</a></span>&nbsp;<span class="op" id="2269147">+</span>&nbsp;<span class="ident" id="2269149"><a href="/math/erf.go.html#2268636">x</a></span><span class="op" id="2269150">*</span><span class="ident" id="2269151"><a href="/math/erf.go.html#2269093">y</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2269156">}</span>&nbsp;<span class="keyword" id="2269158">else</span>&nbsp;<span class="op" id="2269163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269169"><a href="/math/erf.go.html#2268914">temp</a></span>&nbsp;<span class="op" id="2269174">=</span>&nbsp;<span class="num" id="2269176">0.5</span>&nbsp;<span class="op" id="2269180">+</span>&nbsp;<span class="op" id="2269182">(</span><span class="ident" id="2269183"><a href="/math/erf.go.html#2268636">x</a></span><span class="op" id="2269184">*</span><span class="ident" id="2269185"><a href="/math/erf.go.html#2269093">y</a></span>&nbsp;<span class="op" id="2269187">+</span>&nbsp;<span class="op" id="2269189">(</span><span class="ident" id="2269190"><a href="/math/erf.go.html#2268636">x</a></span>&nbsp;<span class="op" id="2269192">-</span>&nbsp;<span class="num" id="2269194">0.5</span><span class="op" id="2269197">)</span><span class="op" id="2269198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2269203">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2269207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269211">if</span>&nbsp;<span class="ident" id="2269214"><a href="/math/erf.go.html#2268821">sign</a></span>&nbsp;<span class="op" id="2269219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269224">return</span>&nbsp;<span class="num" id="2269231">1</span>&nbsp;<span class="op" id="2269233">+</span>&nbsp;<span class="ident" id="2269235"><a href="/math/erf.go.html#2268914">temp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2269242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269246">return</span>&nbsp;<span class="num" id="2269253">1</span>&nbsp;<span class="op" id="2269255">-</span>&nbsp;<span class="ident" id="2269257"><a href="/math/erf.go.html#2268914">temp</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2269263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269266">if</span>&nbsp;<span class="ident" id="2269269"><a href="/math/erf.go.html#2268636">x</a></span>&nbsp;<span class="op" id="2269271">&lt;</span>&nbsp;<span class="num" id="2269273">1.25</span>&nbsp;<span class="op" id="2269278">{</span>&nbsp;<span class="comment" id="2269280">//&nbsp;0.84375&nbsp;&lt;=&nbsp;|x|&nbsp;&lt;&nbsp;1.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269307">s</span>&nbsp;<span class="op" id="2269309">:=</span>&nbsp;<span class="ident" id="2269312"><a href="/math/erf.go.html#2268636">x</a></span>&nbsp;<span class="op" id="2269314">-</span>&nbsp;<span class="num" id="2269316">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269320">P</span>&nbsp;<span class="op" id="2269322">:=</span>&nbsp;<span class="ident" id="2269325"><a href="/math/erf.go.html#2264189">pa0</a></span>&nbsp;<span class="op" id="2269329">+</span>&nbsp;<span class="ident" id="2269331"><a href="/math/erf.go.html#2269307">s</a></span><span class="op" id="2269332">*</span><span class="op" id="2269333">(</span><span class="ident" id="2269334"><a href="/math/erf.go.html#2264246">pa1</a></span><span class="op" id="2269337">+</span><span class="ident" id="2269338"><a href="/math/erf.go.html#2269307">s</a></span><span class="op" id="2269339">*</span><span class="op" id="2269340">(</span><span class="ident" id="2269341"><a href="/math/erf.go.html#2264303">pa2</a></span><span class="op" id="2269344">+</span><span class="ident" id="2269345"><a href="/math/erf.go.html#2269307">s</a></span><span class="op" id="2269346">*</span><span class="op" id="2269347">(</span><span class="ident" id="2269348"><a href="/math/erf.go.html#2264360">pa3</a></span><span class="op" id="2269351">+</span><span class="ident" id="2269352"><a href="/math/erf.go.html#2269307">s</a></span><span class="op" id="2269353">*</span><span class="op" id="2269354">(</span><span class="ident" id="2269355"><a href="/math/erf.go.html#2264417">pa4</a></span><span class="op" id="2269358">+</span><span class="ident" id="2269359"><a href="/math/erf.go.html#2269307">s</a></span><span class="op" id="2269360">*</span><span class="op" id="2269361">(</span><span class="ident" id="2269362"><a href="/math/erf.go.html#2264474">pa5</a></span><span class="op" id="2269365">+</span><span class="ident" id="2269366"><a href="/math/erf.go.html#2269307">s</a></span><span class="op" id="2269367">*</span><span class="ident" id="2269368"><a href="/math/erf.go.html#2264531">pa6</a></span><span class="op" id="2269371">)</span><span class="op" id="2269372">)</span><span class="op" id="2269373">)</span><span class="op" id="2269374">)</span><span class="op" id="2269375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269379">Q</span>&nbsp;<span class="op" id="2269381">:=</span>&nbsp;<span class="num" id="2269384">1</span>&nbsp;<span class="op" id="2269386">+</span>&nbsp;<span class="ident" id="2269388"><a href="/math/erf.go.html#2269307">s</a></span><span class="op" id="2269389">*</span><span class="op" id="2269390">(</span><span class="ident" id="2269391"><a href="/math/erf.go.html#2264588">qa1</a></span><span class="op" id="2269394">+</span><span class="ident" id="2269395"><a href="/math/erf.go.html#2269307">s</a></span><span class="op" id="2269396">*</span><span class="op" id="2269397">(</span><span class="ident" id="2269398"><a href="/math/erf.go.html#2264645">qa2</a></span><span class="op" id="2269401">+</span><span class="ident" id="2269402"><a href="/math/erf.go.html#2269307">s</a></span><span class="op" id="2269403">*</span><span class="op" id="2269404">(</span><span class="ident" id="2269405"><a href="/math/erf.go.html#2264702">qa3</a></span><span class="op" id="2269408">+</span><span class="ident" id="2269409"><a href="/math/erf.go.html#2269307">s</a></span><span class="op" id="2269410">*</span><span class="op" id="2269411">(</span><span class="ident" id="2269412"><a href="/math/erf.go.html#2264759">qa4</a></span><span class="op" id="2269415">+</span><span class="ident" id="2269416"><a href="/math/erf.go.html#2269307">s</a></span><span class="op" id="2269417">*</span><span class="op" id="2269418">(</span><span class="ident" id="2269419"><a href="/math/erf.go.html#2264816">qa5</a></span><span class="op" id="2269422">+</span><span class="ident" id="2269423"><a href="/math/erf.go.html#2269307">s</a></span><span class="op" id="2269424">*</span><span class="ident" id="2269425"><a href="/math/erf.go.html#2264873">qa6</a></span><span class="op" id="2269428">)</span><span class="op" id="2269429">)</span><span class="op" id="2269430">)</span><span class="op" id="2269431">)</span><span class="op" id="2269432">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269436">if</span>&nbsp;<span class="ident" id="2269439"><a href="/math/erf.go.html#2268821">sign</a></span>&nbsp;<span class="op" id="2269444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269449">return</span>&nbsp;<span class="num" id="2269456">1</span>&nbsp;<span class="op" id="2269458">+</span>&nbsp;<span class="ident" id="2269460"><a href="/math/erf.go.html#2263315">erx</a></span>&nbsp;<span class="op" id="2269464">+</span>&nbsp;<span class="ident" id="2269466"><a href="/math/erf.go.html#2269320">P</a></span><span class="op" id="2269467">/</span><span class="ident" id="2269468"><a href="/math/erf.go.html#2269379">Q</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2269472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269476">return</span>&nbsp;<span class="num" id="2269483">1</span>&nbsp;<span class="op" id="2269485">-</span>&nbsp;<span class="ident" id="2269487"><a href="/math/erf.go.html#2263315">erx</a></span>&nbsp;<span class="op" id="2269491">-</span>&nbsp;<span class="ident" id="2269493"><a href="/math/erf.go.html#2269320">P</a></span><span class="op" id="2269494">/</span><span class="ident" id="2269495"><a href="/math/erf.go.html#2269379">Q</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2269499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269502">if</span>&nbsp;<span class="ident" id="2269505"><a href="/math/erf.go.html#2268636">x</a></span>&nbsp;<span class="op" id="2269507">&lt;</span>&nbsp;<span class="num" id="2269509">28</span>&nbsp;<span class="op" id="2269512">{</span>&nbsp;<span class="comment" id="2269514">//&nbsp;|x|&nbsp;&lt;&nbsp;28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269528">s</span>&nbsp;<span class="op" id="2269530">:=</span>&nbsp;<span class="num" id="2269533">1</span>&nbsp;<span class="op" id="2269535">/</span>&nbsp;<span class="op" id="2269537">(</span><span class="ident" id="2269538"><a href="/math/erf.go.html#2268636">x</a></span>&nbsp;<span class="op" id="2269540">*</span>&nbsp;<span class="ident" id="2269542"><a href="/math/erf.go.html#2268636">x</a></span><span class="op" id="2269543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269547">var</span>&nbsp;<span class="ident" id="2269551">R</span><span class="op" id="2269552">,</span>&nbsp;<span class="ident" id="2269554">S</span>&nbsp;<span class="builtintype" id="2269556">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269566">if</span>&nbsp;<span class="ident" id="2269569"><a href="/math/erf.go.html#2268636">x</a></span>&nbsp;<span class="op" id="2269571">&lt;</span>&nbsp;<span class="num" id="2269573">1</span><span class="op" id="2269574">/</span><span class="num" id="2269575">0.35</span>&nbsp;<span class="op" id="2269580">{</span>&nbsp;<span class="comment" id="2269582">//&nbsp;|x|&nbsp;&lt;&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269614"><a href="/math/erf.go.html#2269551">R</a></span>&nbsp;<span class="op" id="2269616">=</span>&nbsp;<span class="ident" id="2269618"><a href="/math/erf.go.html#2264992">ra0</a></span>&nbsp;<span class="op" id="2269622">+</span>&nbsp;<span class="ident" id="2269624"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269625">*</span><span class="op" id="2269626">(</span><span class="ident" id="2269627"><a href="/math/erf.go.html#2265049">ra1</a></span><span class="op" id="2269630">+</span><span class="ident" id="2269631"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269632">*</span><span class="op" id="2269633">(</span><span class="ident" id="2269634"><a href="/math/erf.go.html#2265106">ra2</a></span><span class="op" id="2269637">+</span><span class="ident" id="2269638"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269639">*</span><span class="op" id="2269640">(</span><span class="ident" id="2269641"><a href="/math/erf.go.html#2265163">ra3</a></span><span class="op" id="2269644">+</span><span class="ident" id="2269645"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269646">*</span><span class="op" id="2269647">(</span><span class="ident" id="2269648"><a href="/math/erf.go.html#2265220">ra4</a></span><span class="op" id="2269651">+</span><span class="ident" id="2269652"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269653">*</span><span class="op" id="2269654">(</span><span class="ident" id="2269655"><a href="/math/erf.go.html#2265277">ra5</a></span><span class="op" id="2269658">+</span><span class="ident" id="2269659"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269660">*</span><span class="op" id="2269661">(</span><span class="ident" id="2269662"><a href="/math/erf.go.html#2265334">ra6</a></span><span class="op" id="2269665">+</span><span class="ident" id="2269666"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269667">*</span><span class="ident" id="2269668"><a href="/math/erf.go.html#2265391">ra7</a></span><span class="op" id="2269671">)</span><span class="op" id="2269672">)</span><span class="op" id="2269673">)</span><span class="op" id="2269674">)</span><span class="op" id="2269675">)</span><span class="op" id="2269676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269681"><a href="/math/erf.go.html#2269554">S</a></span>&nbsp;<span class="op" id="2269683">=</span>&nbsp;<span class="num" id="2269685">1</span>&nbsp;<span class="op" id="2269687">+</span>&nbsp;<span class="ident" id="2269689"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269690">*</span><span class="op" id="2269691">(</span><span class="ident" id="2269692"><a href="/math/erf.go.html#2265448">sa1</a></span><span class="op" id="2269695">+</span><span class="ident" id="2269696"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269697">*</span><span class="op" id="2269698">(</span><span class="ident" id="2269699"><a href="/math/erf.go.html#2265505">sa2</a></span><span class="op" id="2269702">+</span><span class="ident" id="2269703"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269704">*</span><span class="op" id="2269705">(</span><span class="ident" id="2269706"><a href="/math/erf.go.html#2265562">sa3</a></span><span class="op" id="2269709">+</span><span class="ident" id="2269710"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269711">*</span><span class="op" id="2269712">(</span><span class="ident" id="2269713"><a href="/math/erf.go.html#2265619">sa4</a></span><span class="op" id="2269716">+</span><span class="ident" id="2269717"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269718">*</span><span class="op" id="2269719">(</span><span class="ident" id="2269720"><a href="/math/erf.go.html#2265676">sa5</a></span><span class="op" id="2269723">+</span><span class="ident" id="2269724"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269725">*</span><span class="op" id="2269726">(</span><span class="ident" id="2269727"><a href="/math/erf.go.html#2265733">sa6</a></span><span class="op" id="2269730">+</span><span class="ident" id="2269731"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269732">*</span><span class="op" id="2269733">(</span><span class="ident" id="2269734"><a href="/math/erf.go.html#2265790">sa7</a></span><span class="op" id="2269737">+</span><span class="ident" id="2269738"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269739">*</span><span class="ident" id="2269740"><a href="/math/erf.go.html#2265847">sa8</a></span><span class="op" id="2269743">)</span><span class="op" id="2269744">)</span><span class="op" id="2269745">)</span><span class="op" id="2269746">)</span><span class="op" id="2269747">)</span><span class="op" id="2269748">)</span><span class="op" id="2269749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2269753">}</span>&nbsp;<span class="keyword" id="2269755">else</span>&nbsp;<span class="op" id="2269760">{</span>&nbsp;<span class="comment" id="2269762">//&nbsp;|x|&nbsp;&gt;=&nbsp;1&nbsp;/&nbsp;0.35&nbsp;~&nbsp;2.857143</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269795">if</span>&nbsp;<span class="ident" id="2269798"><a href="/math/erf.go.html#2268821">sign</a></span>&nbsp;<span class="op" id="2269803">&amp;&amp;</span>&nbsp;<span class="ident" id="2269806"><a href="/math/erf.go.html#2268636">x</a></span>&nbsp;<span class="op" id="2269808">&gt;</span>&nbsp;<span class="num" id="2269810">6</span>&nbsp;<span class="op" id="2269812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2269818">return</span>&nbsp;<span class="num" id="2269825">2</span>&nbsp;<span class="comment" id="2269827">//&nbsp;x&nbsp;&lt;&nbsp;-6</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2269840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269845"><a href="/math/erf.go.html#2269551">R</a></span>&nbsp;<span class="op" id="2269847">=</span>&nbsp;<span class="ident" id="2269849"><a href="/math/erf.go.html#2265963">rb0</a></span>&nbsp;<span class="op" id="2269853">+</span>&nbsp;<span class="ident" id="2269855"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269856">*</span><span class="op" id="2269857">(</span><span class="ident" id="2269858"><a href="/math/erf.go.html#2266020">rb1</a></span><span class="op" id="2269861">+</span><span class="ident" id="2269862"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269863">*</span><span class="op" id="2269864">(</span><span class="ident" id="2269865"><a href="/math/erf.go.html#2266077">rb2</a></span><span class="op" id="2269868">+</span><span class="ident" id="2269869"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269870">*</span><span class="op" id="2269871">(</span><span class="ident" id="2269872"><a href="/math/erf.go.html#2266134">rb3</a></span><span class="op" id="2269875">+</span><span class="ident" id="2269876"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269877">*</span><span class="op" id="2269878">(</span><span class="ident" id="2269879"><a href="/math/erf.go.html#2266191">rb4</a></span><span class="op" id="2269882">+</span><span class="ident" id="2269883"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269884">*</span><span class="op" id="2269885">(</span><span class="ident" id="2269886"><a href="/math/erf.go.html#2266248">rb5</a></span><span class="op" id="2269889">+</span><span class="ident" id="2269890"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269891">*</span><span class="ident" id="2269892"><a href="/math/erf.go.html#2266305">rb6</a></span><span class="op" id="2269895">)</span><span class="op" id="2269896">)</span><span class="op" id="2269897">)</span><span class="op" id="2269898">)</span><span class="op" id="2269899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269904"><a href="/math/erf.go.html#2269554">S</a></span>&nbsp;<span class="op" id="2269906">=</span>&nbsp;<span class="num" id="2269908">1</span>&nbsp;<span class="op" id="2269910">+</span>&nbsp;<span class="ident" id="2269912"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269913">*</span><span class="op" id="2269914">(</span><span class="ident" id="2269915"><a href="/math/erf.go.html#2266362">sb1</a></span><span class="op" id="2269918">+</span><span class="ident" id="2269919"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269920">*</span><span class="op" id="2269921">(</span><span class="ident" id="2269922"><a href="/math/erf.go.html#2266419">sb2</a></span><span class="op" id="2269925">+</span><span class="ident" id="2269926"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269927">*</span><span class="op" id="2269928">(</span><span class="ident" id="2269929"><a href="/math/erf.go.html#2266476">sb3</a></span><span class="op" id="2269932">+</span><span class="ident" id="2269933"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269934">*</span><span class="op" id="2269935">(</span><span class="ident" id="2269936"><a href="/math/erf.go.html#2266533">sb4</a></span><span class="op" id="2269939">+</span><span class="ident" id="2269940"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269941">*</span><span class="op" id="2269942">(</span><span class="ident" id="2269943"><a href="/math/erf.go.html#2266590">sb5</a></span><span class="op" id="2269946">+</span><span class="ident" id="2269947"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269948">*</span><span class="op" id="2269949">(</span><span class="ident" id="2269950"><a href="/math/erf.go.html#2266647">sb6</a></span><span class="op" id="2269953">+</span><span class="ident" id="2269954"><a href="/math/erf.go.html#2269528">s</a></span><span class="op" id="2269955">*</span><span class="ident" id="2269956"><a href="/math/erf.go.html#2266704">sb7</a></span><span class="op" id="2269959">)</span><span class="op" id="2269960">)</span><span class="op" id="2269961">)</span><span class="op" id="2269962">)</span><span class="op" id="2269963">)</span><span class="op" id="2269964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2269968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2269972">z</span>&nbsp;<span class="op" id="2269974">:=</span>&nbsp;<span class="ident" id="2269977"><a href="/math/unsafe.go.html#2380889">Float64frombits</a></span><span class="op" id="2269992">(</span><span class="ident" id="2269993"><a href="/math/unsafe.go.html#2380703">Float64bits</a></span><span class="op" id="2270004">(</span><span class="ident" id="2270005"><a href="/math/erf.go.html#2268636">x</a></span><span class="op" id="2270006">)</span>&nbsp;<span class="op" id="2270008">&amp;</span>&nbsp;<span class="num" id="2270010">0xffffffff00000000</span><span class="op" id="2270028">)</span>&nbsp;<span class="comment" id="2270030">//&nbsp;pseudo-single&nbsp;(20-bit)&nbsp;precision&nbsp;x</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2270070">r</span>&nbsp;<span class="op" id="2270072">:=</span>&nbsp;<span class="ident" id="2270075"><a href="/math/exp.go.html#2270578">Exp</a></span><span class="op" id="2270078">(</span><span class="op" id="2270079">-</span><span class="ident" id="2270080"><a href="/math/erf.go.html#2269972">z</a></span><span class="op" id="2270081">*</span><span class="ident" id="2270082"><a href="/math/erf.go.html#2269972">z</a></span><span class="op" id="2270083">-</span><span class="num" id="2270084">0.5625</span><span class="op" id="2270090">)</span>&nbsp;<span class="op" id="2270092">*</span>&nbsp;<span class="ident" id="2270094"><a href="/math/exp.go.html#2270578">Exp</a></span><span class="op" id="2270097">(</span><span class="op" id="2270098">(</span><span class="ident" id="2270099"><a href="/math/erf.go.html#2269972">z</a></span><span class="op" id="2270100">-</span><span class="ident" id="2270101"><a href="/math/erf.go.html#2268636">x</a></span><span class="op" id="2270102">)</span><span class="op" id="2270103">*</span><span class="op" id="2270104">(</span><span class="ident" id="2270105"><a href="/math/erf.go.html#2269972">z</a></span><span class="op" id="2270106">+</span><span class="ident" id="2270107"><a href="/math/erf.go.html#2268636">x</a></span><span class="op" id="2270108">)</span><span class="op" id="2270109">+</span><span class="ident" id="2270110"><a href="/math/erf.go.html#2269551">R</a></span><span class="op" id="2270111">/</span><span class="ident" id="2270112"><a href="/math/erf.go.html#2269554">S</a></span><span class="op" id="2270113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270117">if</span>&nbsp;<span class="ident" id="2270120"><a href="/math/erf.go.html#2268821">sign</a></span>&nbsp;<span class="op" id="2270125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270130">return</span>&nbsp;<span class="num" id="2270137">2</span>&nbsp;<span class="op" id="2270139">-</span>&nbsp;<span class="ident" id="2270141"><a href="/math/erf.go.html#2270070">r</a></span><span class="op" id="2270142">/</span><span class="ident" id="2270143"><a href="/math/erf.go.html#2268636">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270151">return</span>&nbsp;<span class="ident" id="2270158"><a href="/math/erf.go.html#2270070">r</a></span>&nbsp;<span class="op" id="2270160">/</span>&nbsp;<span class="ident" id="2270162"><a href="/math/erf.go.html#2268636">x</a></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270168">if</span>&nbsp;<span class="ident" id="2270171"><a href="/math/erf.go.html#2268821">sign</a></span>&nbsp;<span class="op" id="2270176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270180">return</span>&nbsp;<span class="num" id="2270187">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2270190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2270193">return</span>&nbsp;<span class="num" id="2270200">0</span><br>
<span class="lineno">335</span><span class="op" id="2270202">}</span>
</div>
</body>
</html>
