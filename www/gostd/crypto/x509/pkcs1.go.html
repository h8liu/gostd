<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3806887">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3806942">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3806996">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3807047">package</span>&nbsp;<span class="ident" id="3807055">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3807061">import</span>&nbsp;<span class="op" id="3807068">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3807071">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3807085">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3807102">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3807112">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="3807123">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3807126">//&nbsp;pkcs1PrivateKey&nbsp;is&nbsp;a&nbsp;structure&nbsp;which&nbsp;mirrors&nbsp;the&nbsp;PKCS#1&nbsp;ASN.1&nbsp;for&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno">15</span><span class="keyword" id="3807215">type</span>&nbsp;<span class="ident" id="3807220">pkcs1PrivateKey</span>&nbsp;<span class="keyword" id="3807236">struct</span>&nbsp;<span class="op" id="3807243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807246">Version</span>&nbsp;<span class="builtintype" id="3807254">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807259">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807267">*</span><span class="ident" id="3807268">big</span><span class="op" id="3807271">.</span><span class="ident" id="3807272">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807277">E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3807285">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807290">D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807298">*</span><span class="ident" id="3807299">big</span><span class="op" id="3807302">.</span><span class="ident" id="3807303">Int</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807308">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807316">*</span><span class="ident" id="3807317">big</span><span class="op" id="3807320">.</span><span class="ident" id="3807321">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807326">Q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3807334">*</span><span class="ident" id="3807335">big</span><span class="op" id="3807338">.</span><span class="ident" id="3807339">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3807344">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values,&nbsp;if&nbsp;present,&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807417">Dp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3807422">*</span><span class="ident" id="3807423">big</span><span class="op" id="3807426">.</span><span class="ident" id="3807427">Int</span>&nbsp;<span class="string" id="3807431">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807450">Dq</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3807455">*</span><span class="ident" id="3807456">big</span><span class="op" id="3807459">.</span><span class="ident" id="3807460">Int</span>&nbsp;<span class="string" id="3807464">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807483">Qinv</span>&nbsp;<span class="op" id="3807488">*</span><span class="ident" id="3807489">big</span><span class="op" id="3807492">.</span><span class="ident" id="3807493">Int</span>&nbsp;<span class="string" id="3807497">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807517">AdditionalPrimes</span>&nbsp;<span class="op" id="3807534">[</span><span class="op" id="3807535">]</span><span class="ident" id="3807536">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="string" id="3807560">`asn1:&#34;optional,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3807588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="3807591">type</span>&nbsp;<span class="ident" id="3807596">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="keyword" id="3807620">struct</span>&nbsp;<span class="op" id="3807627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807630">Prime</span>&nbsp;<span class="op" id="3807636">*</span><span class="ident" id="3807637">big</span><span class="op" id="3807640">.</span><span class="ident" id="3807641">Int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3807647">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807707">Exp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3807713">*</span><span class="ident" id="3807714">big</span><span class="op" id="3807717">.</span><span class="ident" id="3807718">Int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807723">Coeff</span>&nbsp;<span class="op" id="3807729">*</span><span class="ident" id="3807730">big</span><span class="op" id="3807733">.</span><span class="ident" id="3807734">Int</span><br>
<span class="lineno"></span><span class="op" id="3807738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3807741">//&nbsp;ParsePKCS1PrivateKey&nbsp;returns&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key&nbsp;from&nbsp;its&nbsp;ASN.1&nbsp;PKCS#1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="3807832">func</span>&nbsp;<span class="ident" id="3807837">ParsePKCS1PrivateKey</span><span class="op" id="3807857">(</span><span class="ident" id="3807858">der</span>&nbsp;<span class="op" id="3807862">[</span><span class="op" id="3807863">]</span><span class="builtintype" id="3807864">byte</span><span class="op" id="3807868">)</span>&nbsp;<span class="op" id="3807870">(</span><span class="ident" id="3807871">key</span>&nbsp;<span class="op" id="3807875">*</span><span class="ident" id="3807876">rsa</span><span class="op" id="3807879">.</span><span class="ident" id="3807880">PrivateKey</span><span class="op" id="3807890">,</span>&nbsp;<span class="ident" id="3807892">err</span>&nbsp;<span class="builtintype" id="3807896">error</span><span class="op" id="3807901">)</span>&nbsp;<span class="op" id="3807903">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807906">var</span>&nbsp;<span class="ident" id="3807910">priv</span>&nbsp;<span class="ident" id="3807915">pkcs1PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807932">rest</span><span class="op" id="3807936">,</span>&nbsp;<span class="ident" id="3807938">err</span>&nbsp;<span class="op" id="3807942">:=</span>&nbsp;<span class="ident" id="3807945">asn1</span><span class="op" id="3807949">.</span><span class="ident" id="3807950">Unmarshal</span><span class="op" id="3807959">(</span><span class="ident" id="3807960">der</span><span class="op" id="3807963">,</span>&nbsp;<span class="op" id="3807965">&amp;</span><span class="ident" id="3807966">priv</span><span class="op" id="3807970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807973">if</span>&nbsp;<span class="builtinfunc" id="3807976">len</span><span class="op" id="3807979">(</span><span class="ident" id="3807980">rest</span><span class="op" id="3807984">)</span>&nbsp;<span class="op" id="3807986">&gt;</span>&nbsp;<span class="num" id="3807988">0</span>&nbsp;<span class="op" id="3807990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807994">err</span>&nbsp;<span class="op" id="3807998">=</span>&nbsp;<span class="ident" id="3808000">asn1</span><span class="op" id="3808004">.</span><span class="ident" id="3808005">SyntaxError</span><span class="op" id="3808016">{</span><span class="ident" id="3808017">Msg</span><span class="op" id="3808020">:</span>&nbsp;<span class="string" id="3808022">&#34;trailing&nbsp;data&#34;</span><span class="op" id="3808037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808041">return</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808052">if</span>&nbsp;<span class="ident" id="3808055">err</span>&nbsp;<span class="op" id="3808059">!=</span>&nbsp;<span class="ident" id="3808062">nil</span>&nbsp;<span class="op" id="3808066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808070">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808082">if</span>&nbsp;<span class="ident" id="3808085">priv</span><span class="op" id="3808089">.</span><span class="ident" id="3808090">Version</span>&nbsp;<span class="op" id="3808098">&gt;</span>&nbsp;<span class="num" id="3808100">1</span>&nbsp;<span class="op" id="3808102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808106">return</span>&nbsp;<span class="ident" id="3808113">nil</span><span class="op" id="3808116">,</span>&nbsp;<span class="ident" id="3808118">errors</span><span class="op" id="3808124">.</span><span class="ident" id="3808125">New</span><span class="op" id="3808128">(</span><span class="string" id="3808129">&#34;x509:&nbsp;unsupported&nbsp;private&nbsp;key&nbsp;version&#34;</span><span class="op" id="3808168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808175">if</span>&nbsp;<span class="ident" id="3808178">priv</span><span class="op" id="3808182">.</span><span class="ident" id="3808183">N</span><span class="op" id="3808184">.</span><span class="ident" id="3808185">Sign</span><span class="op" id="3808189">(</span><span class="op" id="3808190">)</span>&nbsp;<span class="op" id="3808192">&lt;=</span>&nbsp;<span class="num" id="3808195">0</span>&nbsp;<span class="op" id="3808197">||</span>&nbsp;<span class="ident" id="3808200">priv</span><span class="op" id="3808204">.</span><span class="ident" id="3808205">D</span><span class="op" id="3808206">.</span><span class="ident" id="3808207">Sign</span><span class="op" id="3808211">(</span><span class="op" id="3808212">)</span>&nbsp;<span class="op" id="3808214">&lt;=</span>&nbsp;<span class="num" id="3808217">0</span>&nbsp;<span class="op" id="3808219">||</span>&nbsp;<span class="ident" id="3808222">priv</span><span class="op" id="3808226">.</span><span class="ident" id="3808227">P</span><span class="op" id="3808228">.</span><span class="ident" id="3808229">Sign</span><span class="op" id="3808233">(</span><span class="op" id="3808234">)</span>&nbsp;<span class="op" id="3808236">&lt;=</span>&nbsp;<span class="num" id="3808239">0</span>&nbsp;<span class="op" id="3808241">||</span>&nbsp;<span class="ident" id="3808244">priv</span><span class="op" id="3808248">.</span><span class="ident" id="3808249">Q</span><span class="op" id="3808250">.</span><span class="ident" id="3808251">Sign</span><span class="op" id="3808255">(</span><span class="op" id="3808256">)</span>&nbsp;<span class="op" id="3808258">&lt;=</span>&nbsp;<span class="num" id="3808261">0</span>&nbsp;<span class="op" id="3808263">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808267">return</span>&nbsp;<span class="ident" id="3808274">nil</span><span class="op" id="3808277">,</span>&nbsp;<span class="ident" id="3808279">errors</span><span class="op" id="3808285">.</span><span class="ident" id="3808286">New</span><span class="op" id="3808289">(</span><span class="string" id="3808290">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;value&#34;</span><span class="op" id="3808341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808348">key</span>&nbsp;<span class="op" id="3808352">=</span>&nbsp;<span class="builtinfunc" id="3808354">new</span><span class="op" id="3808357">(</span><span class="ident" id="3808358">rsa</span><span class="op" id="3808361">.</span><span class="ident" id="3808362">PrivateKey</span><span class="op" id="3808372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808375">key</span><span class="op" id="3808378">.</span><span class="ident" id="3808379">PublicKey</span>&nbsp;<span class="op" id="3808389">=</span>&nbsp;<span class="ident" id="3808391">rsa</span><span class="op" id="3808394">.</span><span class="ident" id="3808395">PublicKey</span><span class="op" id="3808404">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808408">E</span><span class="op" id="3808409">:</span>&nbsp;<span class="ident" id="3808411">priv</span><span class="op" id="3808415">.</span><span class="ident" id="3808416">E</span><span class="op" id="3808417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808421">N</span><span class="op" id="3808422">:</span>&nbsp;<span class="ident" id="3808424">priv</span><span class="op" id="3808428">.</span><span class="ident" id="3808429">N</span><span class="op" id="3808430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808437">key</span><span class="op" id="3808440">.</span><span class="ident" id="3808441">D</span>&nbsp;<span class="op" id="3808443">=</span>&nbsp;<span class="ident" id="3808445">priv</span><span class="op" id="3808449">.</span><span class="ident" id="3808450">D</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808453">key</span><span class="op" id="3808456">.</span><span class="ident" id="3808457">Primes</span>&nbsp;<span class="op" id="3808464">=</span>&nbsp;<span class="builtinfunc" id="3808466">make</span><span class="op" id="3808470">(</span><span class="op" id="3808471">[</span><span class="op" id="3808472">]</span><span class="op" id="3808473">*</span><span class="ident" id="3808474">big</span><span class="op" id="3808477">.</span><span class="ident" id="3808478">Int</span><span class="op" id="3808481">,</span>&nbsp;<span class="num" id="3808483">2</span><span class="op" id="3808484">+</span><span class="builtinfunc" id="3808485">len</span><span class="op" id="3808488">(</span><span class="ident" id="3808489">priv</span><span class="op" id="3808493">.</span><span class="ident" id="3808494">AdditionalPrimes</span><span class="op" id="3808510">)</span><span class="op" id="3808511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808514">key</span><span class="op" id="3808517">.</span><span class="ident" id="3808518">Primes</span><span class="op" id="3808524">[</span><span class="num" id="3808525">0</span><span class="op" id="3808526">]</span>&nbsp;<span class="op" id="3808528">=</span>&nbsp;<span class="ident" id="3808530">priv</span><span class="op" id="3808534">.</span><span class="ident" id="3808535">P</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808538">key</span><span class="op" id="3808541">.</span><span class="ident" id="3808542">Primes</span><span class="op" id="3808548">[</span><span class="num" id="3808549">1</span><span class="op" id="3808550">]</span>&nbsp;<span class="op" id="3808552">=</span>&nbsp;<span class="ident" id="3808554">priv</span><span class="op" id="3808558">.</span><span class="ident" id="3808559">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808562">for</span>&nbsp;<span class="ident" id="3808566">i</span><span class="op" id="3808567">,</span>&nbsp;<span class="ident" id="3808569">a</span>&nbsp;<span class="op" id="3808571">:=</span>&nbsp;<span class="keyword" id="3808574">range</span>&nbsp;<span class="ident" id="3808580">priv</span><span class="op" id="3808584">.</span><span class="ident" id="3808585">AdditionalPrimes</span>&nbsp;<span class="op" id="3808602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808606">if</span>&nbsp;<span class="ident" id="3808609">a</span><span class="op" id="3808610">.</span><span class="ident" id="3808611">Prime</span><span class="op" id="3808616">.</span><span class="ident" id="3808617">Sign</span><span class="op" id="3808621">(</span><span class="op" id="3808622">)</span>&nbsp;<span class="op" id="3808624">&lt;=</span>&nbsp;<span class="num" id="3808627">0</span>&nbsp;<span class="op" id="3808629">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808634">return</span>&nbsp;<span class="ident" id="3808641">nil</span><span class="op" id="3808644">,</span>&nbsp;<span class="ident" id="3808646">errors</span><span class="op" id="3808652">.</span><span class="ident" id="3808653">New</span><span class="op" id="3808656">(</span><span class="string" id="3808657">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;prime&#34;</span><span class="op" id="3808708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808716">key</span><span class="op" id="3808719">.</span><span class="ident" id="3808720">Primes</span><span class="op" id="3808726">[</span><span class="ident" id="3808727">i</span><span class="op" id="3808728">+</span><span class="num" id="3808729">2</span><span class="op" id="3808730">]</span>&nbsp;<span class="op" id="3808732">=</span>&nbsp;<span class="ident" id="3808734">a</span><span class="op" id="3808735">.</span><span class="ident" id="3808736">Prime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3808744">//&nbsp;We&nbsp;ignore&nbsp;the&nbsp;other&nbsp;two&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3808807">//&nbsp;them&nbsp;as&nbsp;needed.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808831">err</span>&nbsp;<span class="op" id="3808835">=</span>&nbsp;<span class="ident" id="3808837">key</span><span class="op" id="3808840">.</span><span class="ident" id="3808841">Validate</span><span class="op" id="3808849">(</span><span class="op" id="3808850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808853">if</span>&nbsp;<span class="ident" id="3808856">err</span>&nbsp;<span class="op" id="3808860">!=</span>&nbsp;<span class="ident" id="3808863">nil</span>&nbsp;<span class="op" id="3808867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808871">return</span>&nbsp;<span class="ident" id="3808878">nil</span><span class="op" id="3808881">,</span>&nbsp;<span class="ident" id="3808883">err</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808891">key</span><span class="op" id="3808894">.</span><span class="ident" id="3808895">Precompute</span><span class="op" id="3808905">(</span><span class="op" id="3808906">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808910">return</span><br>
<span class="lineno"></span><span class="op" id="3808917">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="3808920">//&nbsp;MarshalPKCS1PrivateKey&nbsp;converts&nbsp;a&nbsp;private&nbsp;key&nbsp;to&nbsp;ASN.1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="3808996">func</span>&nbsp;<span class="ident" id="3809001">MarshalPKCS1PrivateKey</span><span class="op" id="3809023">(</span><span class="ident" id="3809024">key</span>&nbsp;<span class="op" id="3809028">*</span><span class="ident" id="3809029">rsa</span><span class="op" id="3809032">.</span><span class="ident" id="3809033">PrivateKey</span><span class="op" id="3809043">)</span>&nbsp;<span class="op" id="3809045">[</span><span class="op" id="3809046">]</span><span class="builtintype" id="3809047">byte</span>&nbsp;<span class="op" id="3809052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809055">key</span><span class="op" id="3809058">.</span><span class="ident" id="3809059">Precompute</span><span class="op" id="3809069">(</span><span class="op" id="3809070">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809074">version</span>&nbsp;<span class="op" id="3809082">:=</span>&nbsp;<span class="num" id="3809085">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809088">if</span>&nbsp;<span class="builtinfunc" id="3809091">len</span><span class="op" id="3809094">(</span><span class="ident" id="3809095">key</span><span class="op" id="3809098">.</span><span class="ident" id="3809099">Primes</span><span class="op" id="3809105">)</span>&nbsp;<span class="op" id="3809107">&gt;</span>&nbsp;<span class="num" id="3809109">2</span>&nbsp;<span class="op" id="3809111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809115">version</span>&nbsp;<span class="op" id="3809123">=</span>&nbsp;<span class="num" id="3809125">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3809128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809132">priv</span>&nbsp;<span class="op" id="3809137">:=</span>&nbsp;<span class="ident" id="3809140">pkcs1PrivateKey</span><span class="op" id="3809155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809159">Version</span><span class="op" id="3809166">:</span>&nbsp;<span class="ident" id="3809168">version</span><span class="op" id="3809175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809179">N</span><span class="op" id="3809180">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809188">key</span><span class="op" id="3809191">.</span><span class="ident" id="3809192">N</span><span class="op" id="3809193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809197">E</span><span class="op" id="3809198">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809206">key</span><span class="op" id="3809209">.</span><span class="ident" id="3809210">PublicKey</span><span class="op" id="3809219">.</span><span class="ident" id="3809220">E</span><span class="op" id="3809221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809225">D</span><span class="op" id="3809226">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809234">key</span><span class="op" id="3809237">.</span><span class="ident" id="3809238">D</span><span class="op" id="3809239">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809243">P</span><span class="op" id="3809244">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809252">key</span><span class="op" id="3809255">.</span><span class="ident" id="3809256">Primes</span><span class="op" id="3809262">[</span><span class="num" id="3809263">0</span><span class="op" id="3809264">]</span><span class="op" id="3809265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809269">Q</span><span class="op" id="3809270">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809278">key</span><span class="op" id="3809281">.</span><span class="ident" id="3809282">Primes</span><span class="op" id="3809288">[</span><span class="num" id="3809289">1</span><span class="op" id="3809290">]</span><span class="op" id="3809291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809295">Dp</span><span class="op" id="3809297">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809304">key</span><span class="op" id="3809307">.</span><span class="ident" id="3809308">Precomputed</span><span class="op" id="3809319">.</span><span class="ident" id="3809320">Dp</span><span class="op" id="3809322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809326">Dq</span><span class="op" id="3809328">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809335">key</span><span class="op" id="3809338">.</span><span class="ident" id="3809339">Precomputed</span><span class="op" id="3809350">.</span><span class="ident" id="3809351">Dq</span><span class="op" id="3809353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809357">Qinv</span><span class="op" id="3809361">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3809366">key</span><span class="op" id="3809369">.</span><span class="ident" id="3809370">Precomputed</span><span class="op" id="3809381">.</span><span class="ident" id="3809382">Qinv</span><span class="op" id="3809386">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3809389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809393">priv</span><span class="op" id="3809397">.</span><span class="ident" id="3809398">AdditionalPrimes</span>&nbsp;<span class="op" id="3809415">=</span>&nbsp;<span class="builtinfunc" id="3809417">make</span><span class="op" id="3809421">(</span><span class="op" id="3809422">[</span><span class="op" id="3809423">]</span><span class="ident" id="3809424">pkcs1AdditionalRSAPrime</span><span class="op" id="3809447">,</span>&nbsp;<span class="builtinfunc" id="3809449">len</span><span class="op" id="3809452">(</span><span class="ident" id="3809453">key</span><span class="op" id="3809456">.</span><span class="ident" id="3809457">Precomputed</span><span class="op" id="3809468">.</span><span class="ident" id="3809469">CRTValues</span><span class="op" id="3809478">)</span><span class="op" id="3809479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809482">for</span>&nbsp;<span class="ident" id="3809486">i</span><span class="op" id="3809487">,</span>&nbsp;<span class="ident" id="3809489">values</span>&nbsp;<span class="op" id="3809496">:=</span>&nbsp;<span class="keyword" id="3809499">range</span>&nbsp;<span class="ident" id="3809505">key</span><span class="op" id="3809508">.</span><span class="ident" id="3809509">Precomputed</span><span class="op" id="3809520">.</span><span class="ident" id="3809521">CRTValues</span>&nbsp;<span class="op" id="3809531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809535">priv</span><span class="op" id="3809539">.</span><span class="ident" id="3809540">AdditionalPrimes</span><span class="op" id="3809556">[</span><span class="ident" id="3809557">i</span><span class="op" id="3809558">]</span><span class="op" id="3809559">.</span><span class="ident" id="3809560">Prime</span>&nbsp;<span class="op" id="3809566">=</span>&nbsp;<span class="ident" id="3809568">key</span><span class="op" id="3809571">.</span><span class="ident" id="3809572">Primes</span><span class="op" id="3809578">[</span><span class="num" id="3809579">2</span><span class="op" id="3809580">+</span><span class="ident" id="3809581">i</span><span class="op" id="3809582">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809586">priv</span><span class="op" id="3809590">.</span><span class="ident" id="3809591">AdditionalPrimes</span><span class="op" id="3809607">[</span><span class="ident" id="3809608">i</span><span class="op" id="3809609">]</span><span class="op" id="3809610">.</span><span class="ident" id="3809611">Exp</span>&nbsp;<span class="op" id="3809615">=</span>&nbsp;<span class="ident" id="3809617">values</span><span class="op" id="3809623">.</span><span class="ident" id="3809624">Exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809630">priv</span><span class="op" id="3809634">.</span><span class="ident" id="3809635">AdditionalPrimes</span><span class="op" id="3809651">[</span><span class="ident" id="3809652">i</span><span class="op" id="3809653">]</span><span class="op" id="3809654">.</span><span class="ident" id="3809655">Coeff</span>&nbsp;<span class="op" id="3809661">=</span>&nbsp;<span class="ident" id="3809663">values</span><span class="op" id="3809669">.</span><span class="ident" id="3809670">Coeff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3809677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809681">b</span><span class="op" id="3809682">,</span>&nbsp;<span class="ident" id="3809684">_</span>&nbsp;<span class="op" id="3809686">:=</span>&nbsp;<span class="ident" id="3809689">asn1</span><span class="op" id="3809693">.</span><span class="ident" id="3809694">Marshal</span><span class="op" id="3809701">(</span><span class="ident" id="3809702">priv</span><span class="op" id="3809706">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809709">return</span>&nbsp;<span class="ident" id="3809716">b</span><br>
<span class="lineno"></span><span class="op" id="3809718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3809721">//&nbsp;rsaPublicKey&nbsp;reflects&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;a&nbsp;PKCS#1&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3809790">type</span>&nbsp;<span class="ident" id="3809795">rsaPublicKey</span>&nbsp;<span class="keyword" id="3809808">struct</span>&nbsp;<span class="op" id="3809815">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809818">N</span>&nbsp;<span class="op" id="3809820">*</span><span class="ident" id="3809821">big</span><span class="op" id="3809824">.</span><span class="ident" id="3809825">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809830">E</span>&nbsp;<span class="builtintype" id="3809832">int</span><br>
<span class="lineno"></span><span class="op" id="3809836">}</span>
</div>
</body>
</html>
