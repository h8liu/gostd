<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3474250">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3474305">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3474359">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3474410">package</span>&nbsp;<span class="ident" id="3474418">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3474424">import</span>&nbsp;<span class="op" id="3474431">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3474434">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3474443">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3474453">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3474460">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3474468">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3474479">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="3474489">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3474492">//&nbsp;FormatMediaType&nbsp;serializes&nbsp;mediatype&nbsp;t&nbsp;and&nbsp;the&nbsp;parameters</span><br>
<span class="lineno"></span><span class="comment" id="3474553">//&nbsp;param&nbsp;as&nbsp;a&nbsp;media&nbsp;type&nbsp;conforming&nbsp;to&nbsp;RFC&nbsp;2045&nbsp;and&nbsp;RFC&nbsp;2616.</span><br>
<span class="lineno"></span><span class="comment" id="3474615">//&nbsp;The&nbsp;type&nbsp;and&nbsp;parameter&nbsp;names&nbsp;are&nbsp;written&nbsp;in&nbsp;lower-case.</span><br>
<span class="lineno"></span><span class="comment" id="3474674">//&nbsp;When&nbsp;any&nbsp;of&nbsp;the&nbsp;arguments&nbsp;result&nbsp;in&nbsp;a&nbsp;standard&nbsp;violation&nbsp;then</span><br>
<span class="lineno">20</span><span class="comment" id="3474739">//&nbsp;FormatMediaType&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3474784">func</span>&nbsp;<span class="ident" id="3474789">FormatMediaType</span><span class="op" id="3474804">(</span><span class="ident" id="3474805">t</span>&nbsp;<span class="builtintype" id="3474807">string</span><span class="op" id="3474813">,</span>&nbsp;<span class="ident" id="3474815">param</span>&nbsp;<span class="keyword" id="3474821">map</span><span class="op" id="3474824">[</span><span class="builtintype" id="3474825">string</span><span class="op" id="3474831">]</span><span class="builtintype" id="3474832">string</span><span class="op" id="3474838">)</span>&nbsp;<span class="builtintype" id="3474840">string</span>&nbsp;<span class="op" id="3474847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3474850">slash</span>&nbsp;<span class="op" id="3474856">:=</span>&nbsp;<span class="ident" id="3474859">strings</span><span class="op" id="3474866">.</span><span class="ident" id="3474867">Index</span><span class="op" id="3474872">(</span><span class="ident" id="3474873">t</span><span class="op" id="3474874">,</span>&nbsp;<span class="string" id="3474876">&#34;/&#34;</span><span class="op" id="3474879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3474882">if</span>&nbsp;<span class="ident" id="3474885">slash</span>&nbsp;<span class="op" id="3474891">==</span>&nbsp;<span class="op" id="3474894">-</span><span class="num" id="3474895">1</span>&nbsp;<span class="op" id="3474897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3474901">return</span>&nbsp;<span class="string" id="3474908">&#34;&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3474912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3474915">major</span><span class="op" id="3474920">,</span>&nbsp;<span class="ident" id="3474922">sub</span>&nbsp;<span class="op" id="3474926">:=</span>&nbsp;<span class="ident" id="3474929">t</span><span class="op" id="3474930">[</span><span class="op" id="3474931">:</span><span class="ident" id="3474932">slash</span><span class="op" id="3474937">]</span><span class="op" id="3474938">,</span>&nbsp;<span class="ident" id="3474940">t</span><span class="op" id="3474941">[</span><span class="ident" id="3474942">slash</span><span class="op" id="3474947">+</span><span class="num" id="3474948">1</span><span class="op" id="3474949">:</span><span class="op" id="3474950">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3474953">if</span>&nbsp;<span class="op" id="3474956">!</span><span class="ident" id="3474957">isToken</span><span class="op" id="3474964">(</span><span class="ident" id="3474965">major</span><span class="op" id="3474970">)</span>&nbsp;<span class="op" id="3474972">||</span>&nbsp;<span class="op" id="3474975">!</span><span class="ident" id="3474976">isToken</span><span class="op" id="3474983">(</span><span class="ident" id="3474984">sub</span><span class="op" id="3474987">)</span>&nbsp;<span class="op" id="3474989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3474993">return</span>&nbsp;<span class="string" id="3475000">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3475004">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475007">var</span>&nbsp;<span class="ident" id="3475011">b</span>&nbsp;<span class="ident" id="3475013">bytes</span><span class="op" id="3475018">.</span><span class="ident" id="3475019">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475027">b</span><span class="op" id="3475028">.</span><span class="ident" id="3475029">WriteString</span><span class="op" id="3475040">(</span><span class="ident" id="3475041">strings</span><span class="op" id="3475048">.</span><span class="ident" id="3475049">ToLower</span><span class="op" id="3475056">(</span><span class="ident" id="3475057">major</span><span class="op" id="3475062">)</span><span class="op" id="3475063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475066">b</span><span class="op" id="3475067">.</span><span class="ident" id="3475068">WriteByte</span><span class="op" id="3475077">(</span><span class="string" id="3475078">&#39;/&#39;</span><span class="op" id="3475081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475084">b</span><span class="op" id="3475085">.</span><span class="ident" id="3475086">WriteString</span><span class="op" id="3475097">(</span><span class="ident" id="3475098">strings</span><span class="op" id="3475105">.</span><span class="ident" id="3475106">ToLower</span><span class="op" id="3475113">(</span><span class="ident" id="3475114">sub</span><span class="op" id="3475117">)</span><span class="op" id="3475118">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475122">attrs</span>&nbsp;<span class="op" id="3475128">:=</span>&nbsp;<span class="builtinfunc" id="3475131">make</span><span class="op" id="3475135">(</span><span class="op" id="3475136">[</span><span class="op" id="3475137">]</span><span class="builtintype" id="3475138">string</span><span class="op" id="3475144">,</span>&nbsp;<span class="num" id="3475146">0</span><span class="op" id="3475147">,</span>&nbsp;<span class="builtinfunc" id="3475149">len</span><span class="op" id="3475152">(</span><span class="ident" id="3475153">param</span><span class="op" id="3475158">)</span><span class="op" id="3475159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475162">for</span>&nbsp;<span class="ident" id="3475166">a</span>&nbsp;<span class="op" id="3475168">:=</span>&nbsp;<span class="keyword" id="3475171">range</span>&nbsp;<span class="ident" id="3475177">param</span>&nbsp;<span class="op" id="3475183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475187">attrs</span>&nbsp;<span class="op" id="3475193">=</span>&nbsp;<span class="builtinfunc" id="3475195">append</span><span class="op" id="3475201">(</span><span class="ident" id="3475202">attrs</span><span class="op" id="3475207">,</span>&nbsp;<span class="ident" id="3475209">a</span><span class="op" id="3475210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3475213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475216">sort</span><span class="op" id="3475220">.</span><span class="ident" id="3475221">Strings</span><span class="op" id="3475228">(</span><span class="ident" id="3475229">attrs</span><span class="op" id="3475234">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475238">for</span>&nbsp;<span class="ident" id="3475242">_</span><span class="op" id="3475243">,</span>&nbsp;<span class="ident" id="3475245">attribute</span>&nbsp;<span class="op" id="3475255">:=</span>&nbsp;<span class="keyword" id="3475258">range</span>&nbsp;<span class="ident" id="3475264">attrs</span>&nbsp;<span class="op" id="3475270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475274">value</span>&nbsp;<span class="op" id="3475280">:=</span>&nbsp;<span class="ident" id="3475283">param</span><span class="op" id="3475288">[</span><span class="ident" id="3475289">attribute</span><span class="op" id="3475298">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475302">b</span><span class="op" id="3475303">.</span><span class="ident" id="3475304">WriteByte</span><span class="op" id="3475313">(</span><span class="string" id="3475314">&#39;;&#39;</span><span class="op" id="3475317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475321">b</span><span class="op" id="3475322">.</span><span class="ident" id="3475323">WriteByte</span><span class="op" id="3475332">(</span><span class="string" id="3475333">&#39;&nbsp;&#39;</span><span class="op" id="3475336">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475340">if</span>&nbsp;<span class="op" id="3475343">!</span><span class="ident" id="3475344">isToken</span><span class="op" id="3475351">(</span><span class="ident" id="3475352">attribute</span><span class="op" id="3475361">)</span>&nbsp;<span class="op" id="3475363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475368">return</span>&nbsp;<span class="string" id="3475375">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3475380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475384">b</span><span class="op" id="3475385">.</span><span class="ident" id="3475386">WriteString</span><span class="op" id="3475397">(</span><span class="ident" id="3475398">strings</span><span class="op" id="3475405">.</span><span class="ident" id="3475406">ToLower</span><span class="op" id="3475413">(</span><span class="ident" id="3475414">attribute</span><span class="op" id="3475423">)</span><span class="op" id="3475424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475428">b</span><span class="op" id="3475429">.</span><span class="ident" id="3475430">WriteByte</span><span class="op" id="3475439">(</span><span class="string" id="3475440">&#39;=&#39;</span><span class="op" id="3475443">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475447">if</span>&nbsp;<span class="ident" id="3475450">isToken</span><span class="op" id="3475457">(</span><span class="ident" id="3475458">value</span><span class="op" id="3475463">)</span>&nbsp;<span class="op" id="3475465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475470">b</span><span class="op" id="3475471">.</span><span class="ident" id="3475472">WriteString</span><span class="op" id="3475483">(</span><span class="ident" id="3475484">value</span><span class="op" id="3475489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475494">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3475505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475510">b</span><span class="op" id="3475511">.</span><span class="ident" id="3475512">WriteByte</span><span class="op" id="3475521">(</span><span class="string" id="3475522">&#39;&#34;&#39;</span><span class="op" id="3475525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475529">offset</span>&nbsp;<span class="op" id="3475536">:=</span>&nbsp;<span class="num" id="3475539">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475543">for</span>&nbsp;<span class="ident" id="3475547">index</span><span class="op" id="3475552">,</span>&nbsp;<span class="ident" id="3475554">character</span>&nbsp;<span class="op" id="3475564">:=</span>&nbsp;<span class="keyword" id="3475567">range</span>&nbsp;<span class="ident" id="3475573">value</span>&nbsp;<span class="op" id="3475579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475584">if</span>&nbsp;<span class="ident" id="3475587">character</span>&nbsp;<span class="op" id="3475597">==</span>&nbsp;<span class="string" id="3475600">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3475604">||</span>&nbsp;<span class="ident" id="3475607">character</span>&nbsp;<span class="op" id="3475617">==</span>&nbsp;<span class="string" id="3475620">&#39;\\&#39;</span>&nbsp;<span class="op" id="3475625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475631">b</span><span class="op" id="3475632">.</span><span class="ident" id="3475633">WriteString</span><span class="op" id="3475644">(</span><span class="ident" id="3475645">value</span><span class="op" id="3475650">[</span><span class="ident" id="3475651">offset</span><span class="op" id="3475657">:</span><span class="ident" id="3475658">index</span><span class="op" id="3475663">]</span><span class="op" id="3475664">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475670">offset</span>&nbsp;<span class="op" id="3475677">=</span>&nbsp;<span class="ident" id="3475679">index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475689">b</span><span class="op" id="3475690">.</span><span class="ident" id="3475691">WriteByte</span><span class="op" id="3475700">(</span><span class="string" id="3475701">&#39;\\&#39;</span><span class="op" id="3475705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3475710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475715">if</span>&nbsp;<span class="ident" id="3475718">character</span><span class="op" id="3475727">&amp;</span><span class="num" id="3475728">0x80</span>&nbsp;<span class="op" id="3475733">!=</span>&nbsp;<span class="num" id="3475736">0</span>&nbsp;<span class="op" id="3475738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475744">return</span>&nbsp;<span class="string" id="3475751">&#34;&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3475757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3475761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475765">b</span><span class="op" id="3475766">.</span><span class="ident" id="3475767">WriteString</span><span class="op" id="3475778">(</span><span class="ident" id="3475779">value</span><span class="op" id="3475784">[</span><span class="ident" id="3475785">offset</span><span class="op" id="3475791">:</span><span class="op" id="3475792">]</span><span class="op" id="3475793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475797">b</span><span class="op" id="3475798">.</span><span class="ident" id="3475799">WriteByte</span><span class="op" id="3475808">(</span><span class="string" id="3475809">&#39;&#34;&#39;</span><span class="op" id="3475812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3475815">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475818">return</span>&nbsp;<span class="ident" id="3475825">b</span><span class="op" id="3475826">.</span><span class="ident" id="3475827">String</span><span class="op" id="3475833">(</span><span class="op" id="3475834">)</span><br>
<span class="lineno"></span><span class="op" id="3475836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3475839">func</span>&nbsp;<span class="ident" id="3475844">checkMediaTypeDisposition</span><span class="op" id="3475869">(</span><span class="ident" id="3475870">s</span>&nbsp;<span class="builtintype" id="3475872">string</span><span class="op" id="3475878">)</span>&nbsp;<span class="builtintype" id="3475880">error</span>&nbsp;<span class="op" id="3475886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475889">typ</span><span class="op" id="3475892">,</span>&nbsp;<span class="ident" id="3475894">rest</span>&nbsp;<span class="op" id="3475899">:=</span>&nbsp;<span class="ident" id="3475902">consumeToken</span><span class="op" id="3475914">(</span><span class="ident" id="3475915">s</span><span class="op" id="3475916">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475919">if</span>&nbsp;<span class="ident" id="3475922">typ</span>&nbsp;<span class="op" id="3475926">==</span>&nbsp;<span class="string" id="3475929">&#34;&#34;</span>&nbsp;<span class="op" id="3475932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475936">return</span>&nbsp;<span class="ident" id="3475943">errors</span><span class="op" id="3475949">.</span><span class="ident" id="3475950">New</span><span class="op" id="3475953">(</span><span class="string" id="3475954">&#34;mime:&nbsp;no&nbsp;media&nbsp;type&#34;</span><span class="op" id="3475975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3475978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475981">if</span>&nbsp;<span class="ident" id="3475984">rest</span>&nbsp;<span class="op" id="3475989">==</span>&nbsp;<span class="string" id="3475992">&#34;&#34;</span>&nbsp;<span class="op" id="3475995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475999">return</span>&nbsp;<span class="ident" id="3476006">nil</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3476011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476014">if</span>&nbsp;<span class="op" id="3476017">!</span><span class="ident" id="3476018">strings</span><span class="op" id="3476025">.</span><span class="ident" id="3476026">HasPrefix</span><span class="op" id="3476035">(</span><span class="ident" id="3476036">rest</span><span class="op" id="3476040">,</span>&nbsp;<span class="string" id="3476042">&#34;/&#34;</span><span class="op" id="3476045">)</span>&nbsp;<span class="op" id="3476047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476051">return</span>&nbsp;<span class="ident" id="3476058">errors</span><span class="op" id="3476064">.</span><span class="ident" id="3476065">New</span><span class="op" id="3476068">(</span><span class="string" id="3476069">&#34;mime:&nbsp;expected&nbsp;slash&nbsp;after&nbsp;first&nbsp;token&#34;</span><span class="op" id="3476109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3476112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476115">subtype</span><span class="op" id="3476122">,</span>&nbsp;<span class="ident" id="3476124">rest</span>&nbsp;<span class="op" id="3476129">:=</span>&nbsp;<span class="ident" id="3476132">consumeToken</span><span class="op" id="3476144">(</span><span class="ident" id="3476145">rest</span><span class="op" id="3476149">[</span><span class="num" id="3476150">1</span><span class="op" id="3476151">:</span><span class="op" id="3476152">]</span><span class="op" id="3476153">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476156">if</span>&nbsp;<span class="ident" id="3476159">subtype</span>&nbsp;<span class="op" id="3476167">==</span>&nbsp;<span class="string" id="3476170">&#34;&#34;</span>&nbsp;<span class="op" id="3476173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476177">return</span>&nbsp;<span class="ident" id="3476184">errors</span><span class="op" id="3476190">.</span><span class="ident" id="3476191">New</span><span class="op" id="3476194">(</span><span class="string" id="3476195">&#34;mime:&nbsp;expected&nbsp;token&nbsp;after&nbsp;slash&#34;</span><span class="op" id="3476229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3476232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476235">if</span>&nbsp;<span class="ident" id="3476238">rest</span>&nbsp;<span class="op" id="3476243">!=</span>&nbsp;<span class="string" id="3476246">&#34;&#34;</span>&nbsp;<span class="op" id="3476249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476253">return</span>&nbsp;<span class="ident" id="3476260">errors</span><span class="op" id="3476266">.</span><span class="ident" id="3476267">New</span><span class="op" id="3476270">(</span><span class="string" id="3476271">&#34;mime:&nbsp;unexpected&nbsp;content&nbsp;after&nbsp;media&nbsp;subtype&#34;</span><span class="op" id="3476317">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3476320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476323">return</span>&nbsp;<span class="ident" id="3476330">nil</span><br>
<span class="lineno"></span><span class="op" id="3476334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3476337">//&nbsp;ParseMediaType&nbsp;parses&nbsp;a&nbsp;media&nbsp;type&nbsp;value&nbsp;and&nbsp;any&nbsp;optional</span><br>
<span class="lineno">95</span><span class="comment" id="3476398">//&nbsp;parameters,&nbsp;per&nbsp;RFC&nbsp;1521.&nbsp;&nbsp;Media&nbsp;types&nbsp;are&nbsp;the&nbsp;values&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3476458">//&nbsp;Content-Type&nbsp;and&nbsp;Content-Disposition&nbsp;headers&nbsp;(RFC&nbsp;2183).</span><br>
<span class="lineno"></span><span class="comment" id="3476518">//&nbsp;On&nbsp;success,&nbsp;ParseMediaType&nbsp;returns&nbsp;the&nbsp;media&nbsp;type&nbsp;converted</span><br>
<span class="lineno"></span><span class="comment" id="3476581">//&nbsp;to&nbsp;lowercase&nbsp;and&nbsp;trimmed&nbsp;of&nbsp;white&nbsp;space&nbsp;and&nbsp;a&nbsp;non-nil&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="3476643">//&nbsp;The&nbsp;returned&nbsp;map,&nbsp;params,&nbsp;maps&nbsp;from&nbsp;the&nbsp;lowercase</span><br>
<span class="lineno">100</span><span class="comment" id="3476696">//&nbsp;attribute&nbsp;to&nbsp;the&nbsp;attribute&nbsp;value&nbsp;with&nbsp;its&nbsp;case&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="keyword" id="3476757">func</span>&nbsp;<span class="ident" id="3476762">ParseMediaType</span><span class="op" id="3476776">(</span><span class="ident" id="3476777">v</span>&nbsp;<span class="builtintype" id="3476779">string</span><span class="op" id="3476785">)</span>&nbsp;<span class="op" id="3476787">(</span><span class="ident" id="3476788">mediatype</span>&nbsp;<span class="builtintype" id="3476798">string</span><span class="op" id="3476804">,</span>&nbsp;<span class="ident" id="3476806">params</span>&nbsp;<span class="keyword" id="3476813">map</span><span class="op" id="3476816">[</span><span class="builtintype" id="3476817">string</span><span class="op" id="3476823">]</span><span class="builtintype" id="3476824">string</span><span class="op" id="3476830">,</span>&nbsp;<span class="ident" id="3476832">err</span>&nbsp;<span class="builtintype" id="3476836">error</span><span class="op" id="3476841">)</span>&nbsp;<span class="op" id="3476843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476846">i</span>&nbsp;<span class="op" id="3476848">:=</span>&nbsp;<span class="ident" id="3476851">strings</span><span class="op" id="3476858">.</span><span class="ident" id="3476859">Index</span><span class="op" id="3476864">(</span><span class="ident" id="3476865">v</span><span class="op" id="3476866">,</span>&nbsp;<span class="string" id="3476868">&#34;;&#34;</span><span class="op" id="3476871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476874">if</span>&nbsp;<span class="ident" id="3476877">i</span>&nbsp;<span class="op" id="3476879">==</span>&nbsp;<span class="op" id="3476882">-</span><span class="num" id="3476883">1</span>&nbsp;<span class="op" id="3476885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476889">i</span>&nbsp;<span class="op" id="3476891">=</span>&nbsp;<span class="builtinfunc" id="3476893">len</span><span class="op" id="3476896">(</span><span class="ident" id="3476897">v</span><span class="op" id="3476898">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3476901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476904">mediatype</span>&nbsp;<span class="op" id="3476914">=</span>&nbsp;<span class="ident" id="3476916">strings</span><span class="op" id="3476923">.</span><span class="ident" id="3476924">TrimSpace</span><span class="op" id="3476933">(</span><span class="ident" id="3476934">strings</span><span class="op" id="3476941">.</span><span class="ident" id="3476942">ToLower</span><span class="op" id="3476949">(</span><span class="ident" id="3476950">v</span><span class="op" id="3476951">[</span><span class="num" id="3476952">0</span><span class="op" id="3476953">:</span><span class="ident" id="3476954">i</span><span class="op" id="3476955">]</span><span class="op" id="3476956">)</span><span class="op" id="3476957">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476961">err</span>&nbsp;<span class="op" id="3476965">=</span>&nbsp;<span class="ident" id="3476967">checkMediaTypeDisposition</span><span class="op" id="3476992">(</span><span class="ident" id="3476993">mediatype</span><span class="op" id="3477002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477005">if</span>&nbsp;<span class="ident" id="3477008">err</span>&nbsp;<span class="op" id="3477012">!=</span>&nbsp;<span class="ident" id="3477015">nil</span>&nbsp;<span class="op" id="3477019">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477023">return</span>&nbsp;<span class="string" id="3477030">&#34;&#34;</span><span class="op" id="3477032">,</span>&nbsp;<span class="ident" id="3477034">nil</span><span class="op" id="3477037">,</span>&nbsp;<span class="ident" id="3477039">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3477044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477048">params</span>&nbsp;<span class="op" id="3477055">=</span>&nbsp;<span class="builtinfunc" id="3477057">make</span><span class="op" id="3477061">(</span><span class="keyword" id="3477062">map</span><span class="op" id="3477065">[</span><span class="builtintype" id="3477066">string</span><span class="op" id="3477072">]</span><span class="builtintype" id="3477073">string</span><span class="op" id="3477079">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3477083">//&nbsp;Map&nbsp;of&nbsp;base&nbsp;parameter&nbsp;name&nbsp;-&gt;&nbsp;parameter&nbsp;name&nbsp;-&gt;&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3477141">//&nbsp;for&nbsp;parameters&nbsp;containing&nbsp;a&nbsp;&#39;*&#39;&nbsp;character.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3477188">//&nbsp;Lazily&nbsp;initialized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477212">var</span>&nbsp;<span class="ident" id="3477216">continuation</span>&nbsp;<span class="keyword" id="3477229">map</span><span class="op" id="3477232">[</span><span class="builtintype" id="3477233">string</span><span class="op" id="3477239">]</span><span class="keyword" id="3477240">map</span><span class="op" id="3477243">[</span><span class="builtintype" id="3477244">string</span><span class="op" id="3477250">]</span><span class="builtintype" id="3477251">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477260">v</span>&nbsp;<span class="op" id="3477262">=</span>&nbsp;<span class="ident" id="3477264">v</span><span class="op" id="3477265">[</span><span class="ident" id="3477266">i</span><span class="op" id="3477267">:</span><span class="op" id="3477268">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477271">for</span>&nbsp;<span class="builtinfunc" id="3477275">len</span><span class="op" id="3477278">(</span><span class="ident" id="3477279">v</span><span class="op" id="3477280">)</span>&nbsp;<span class="op" id="3477282">&gt;</span>&nbsp;<span class="num" id="3477284">0</span>&nbsp;<span class="op" id="3477286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477290">v</span>&nbsp;<span class="op" id="3477292">=</span>&nbsp;<span class="ident" id="3477294">strings</span><span class="op" id="3477301">.</span><span class="ident" id="3477302">TrimLeftFunc</span><span class="op" id="3477314">(</span><span class="ident" id="3477315">v</span><span class="op" id="3477316">,</span>&nbsp;<span class="ident" id="3477318">unicode</span><span class="op" id="3477325">.</span><span class="ident" id="3477326">IsSpace</span><span class="op" id="3477333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477337">if</span>&nbsp;<span class="builtinfunc" id="3477340">len</span><span class="op" id="3477343">(</span><span class="ident" id="3477344">v</span><span class="op" id="3477345">)</span>&nbsp;<span class="op" id="3477347">==</span>&nbsp;<span class="num" id="3477350">0</span>&nbsp;<span class="op" id="3477352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477357">break</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3477365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477369">key</span><span class="op" id="3477372">,</span>&nbsp;<span class="ident" id="3477374">value</span><span class="op" id="3477379">,</span>&nbsp;<span class="ident" id="3477381">rest</span>&nbsp;<span class="op" id="3477386">:=</span>&nbsp;<span class="ident" id="3477389">consumeMediaParam</span><span class="op" id="3477406">(</span><span class="ident" id="3477407">v</span><span class="op" id="3477408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477412">if</span>&nbsp;<span class="ident" id="3477415">key</span>&nbsp;<span class="op" id="3477419">==</span>&nbsp;<span class="string" id="3477422">&#34;&#34;</span>&nbsp;<span class="op" id="3477425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477430">if</span>&nbsp;<span class="ident" id="3477433">strings</span><span class="op" id="3477440">.</span><span class="ident" id="3477441">TrimSpace</span><span class="op" id="3477450">(</span><span class="ident" id="3477451">rest</span><span class="op" id="3477455">)</span>&nbsp;<span class="op" id="3477457">==</span>&nbsp;<span class="string" id="3477460">&#34;;&#34;</span>&nbsp;<span class="op" id="3477464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3477470">//&nbsp;Ignore&nbsp;trailing&nbsp;semicolons.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3477505">//&nbsp;Not&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477526">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3477536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3477541">//&nbsp;Parse&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477560">return</span>&nbsp;<span class="string" id="3477567">&#34;&#34;</span><span class="op" id="3477569">,</span>&nbsp;<span class="ident" id="3477571">nil</span><span class="op" id="3477574">,</span>&nbsp;<span class="ident" id="3477576">errors</span><span class="op" id="3477582">.</span><span class="ident" id="3477583">New</span><span class="op" id="3477586">(</span><span class="string" id="3477587">&#34;mime:&nbsp;invalid&nbsp;media&nbsp;parameter&#34;</span><span class="op" id="3477618">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3477622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477627">pmap</span>&nbsp;<span class="op" id="3477632">:=</span>&nbsp;<span class="ident" id="3477635">params</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477644">if</span>&nbsp;<span class="ident" id="3477647">idx</span>&nbsp;<span class="op" id="3477651">:=</span>&nbsp;<span class="ident" id="3477654">strings</span><span class="op" id="3477661">.</span><span class="ident" id="3477662">Index</span><span class="op" id="3477667">(</span><span class="ident" id="3477668">key</span><span class="op" id="3477671">,</span>&nbsp;<span class="string" id="3477673">&#34;*&#34;</span><span class="op" id="3477676">)</span><span class="op" id="3477677">;</span>&nbsp;<span class="ident" id="3477679">idx</span>&nbsp;<span class="op" id="3477683">!=</span>&nbsp;<span class="op" id="3477686">-</span><span class="num" id="3477687">1</span>&nbsp;<span class="op" id="3477689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477694">baseName</span>&nbsp;<span class="op" id="3477703">:=</span>&nbsp;<span class="ident" id="3477706">key</span><span class="op" id="3477709">[</span><span class="op" id="3477710">:</span><span class="ident" id="3477711">idx</span><span class="op" id="3477714">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477719">if</span>&nbsp;<span class="ident" id="3477722">continuation</span>&nbsp;<span class="op" id="3477735">==</span>&nbsp;<span class="ident" id="3477738">nil</span>&nbsp;<span class="op" id="3477742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477748">continuation</span>&nbsp;<span class="op" id="3477761">=</span>&nbsp;<span class="builtinfunc" id="3477763">make</span><span class="op" id="3477767">(</span><span class="keyword" id="3477768">map</span><span class="op" id="3477771">[</span><span class="builtintype" id="3477772">string</span><span class="op" id="3477778">]</span><span class="keyword" id="3477779">map</span><span class="op" id="3477782">[</span><span class="builtintype" id="3477783">string</span><span class="op" id="3477789">]</span><span class="builtintype" id="3477790">string</span><span class="op" id="3477796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3477801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477806">var</span>&nbsp;<span class="ident" id="3477810">ok</span>&nbsp;<span class="builtintype" id="3477813">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477821">if</span>&nbsp;<span class="ident" id="3477824">pmap</span><span class="op" id="3477828">,</span>&nbsp;<span class="ident" id="3477830">ok</span>&nbsp;<span class="op" id="3477833">=</span>&nbsp;<span class="ident" id="3477835">continuation</span><span class="op" id="3477847">[</span><span class="ident" id="3477848">baseName</span><span class="op" id="3477856">]</span><span class="op" id="3477857">;</span>&nbsp;<span class="op" id="3477859">!</span><span class="ident" id="3477860">ok</span>&nbsp;<span class="op" id="3477863">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477869">continuation</span><span class="op" id="3477881">[</span><span class="ident" id="3477882">baseName</span><span class="op" id="3477890">]</span>&nbsp;<span class="op" id="3477892">=</span>&nbsp;<span class="builtinfunc" id="3477894">make</span><span class="op" id="3477898">(</span><span class="keyword" id="3477899">map</span><span class="op" id="3477902">[</span><span class="builtintype" id="3477903">string</span><span class="op" id="3477909">]</span><span class="builtintype" id="3477910">string</span><span class="op" id="3477916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477922">pmap</span>&nbsp;<span class="op" id="3477927">=</span>&nbsp;<span class="ident" id="3477929">continuation</span><span class="op" id="3477941">[</span><span class="ident" id="3477942">baseName</span><span class="op" id="3477950">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3477955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3477959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477963">if</span>&nbsp;<span class="ident" id="3477966">_</span><span class="op" id="3477967">,</span>&nbsp;<span class="ident" id="3477969">exists</span>&nbsp;<span class="op" id="3477976">:=</span>&nbsp;<span class="ident" id="3477979">pmap</span><span class="op" id="3477983">[</span><span class="ident" id="3477984">key</span><span class="op" id="3477987">]</span><span class="op" id="3477988">;</span>&nbsp;<span class="ident" id="3477990">exists</span>&nbsp;<span class="op" id="3477997">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3478002">//&nbsp;Duplicate&nbsp;parameter&nbsp;name&nbsp;is&nbsp;bogus.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478043">return</span>&nbsp;<span class="string" id="3478050">&#34;&#34;</span><span class="op" id="3478052">,</span>&nbsp;<span class="ident" id="3478054">nil</span><span class="op" id="3478057">,</span>&nbsp;<span class="ident" id="3478059">errors</span><span class="op" id="3478065">.</span><span class="ident" id="3478066">New</span><span class="op" id="3478069">(</span><span class="string" id="3478070">&#34;mime:&nbsp;duplicate&nbsp;parameter&nbsp;name&#34;</span><span class="op" id="3478102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3478106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478110">pmap</span><span class="op" id="3478114">[</span><span class="ident" id="3478115">key</span><span class="op" id="3478118">]</span>&nbsp;<span class="op" id="3478120">=</span>&nbsp;<span class="ident" id="3478122">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478130">v</span>&nbsp;<span class="op" id="3478132">=</span>&nbsp;<span class="ident" id="3478134">rest</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3478140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3478144">//&nbsp;Stitch&nbsp;together&nbsp;any&nbsp;continuations&nbsp;or&nbsp;things&nbsp;with&nbsp;stars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3478203">//&nbsp;(i.e.&nbsp;RFC&nbsp;2231&nbsp;things&nbsp;with&nbsp;stars:&nbsp;&#34;foo*0&#34;&nbsp;or&nbsp;&#34;foo*&#34;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478260">var</span>&nbsp;<span class="ident" id="3478264">buf</span>&nbsp;<span class="ident" id="3478268">bytes</span><span class="op" id="3478273">.</span><span class="ident" id="3478274">Buffer</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478282">for</span>&nbsp;<span class="ident" id="3478286">key</span><span class="op" id="3478289">,</span>&nbsp;<span class="ident" id="3478291">pieceMap</span>&nbsp;<span class="op" id="3478300">:=</span>&nbsp;<span class="keyword" id="3478303">range</span>&nbsp;<span class="ident" id="3478309">continuation</span>&nbsp;<span class="op" id="3478322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478326">singlePartKey</span>&nbsp;<span class="op" id="3478340">:=</span>&nbsp;<span class="ident" id="3478343">key</span>&nbsp;<span class="op" id="3478347">+</span>&nbsp;<span class="string" id="3478349">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478355">if</span>&nbsp;<span class="ident" id="3478358">v</span><span class="op" id="3478359">,</span>&nbsp;<span class="ident" id="3478361">ok</span>&nbsp;<span class="op" id="3478364">:=</span>&nbsp;<span class="ident" id="3478367">pieceMap</span><span class="op" id="3478375">[</span><span class="ident" id="3478376">singlePartKey</span><span class="op" id="3478389">]</span><span class="op" id="3478390">;</span>&nbsp;<span class="ident" id="3478392">ok</span>&nbsp;<span class="op" id="3478395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478400">decv</span>&nbsp;<span class="op" id="3478405">:=</span>&nbsp;<span class="ident" id="3478408">decode2231Enc</span><span class="op" id="3478421">(</span><span class="ident" id="3478422">v</span><span class="op" id="3478423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478428">params</span><span class="op" id="3478434">[</span><span class="ident" id="3478435">key</span><span class="op" id="3478438">]</span>&nbsp;<span class="op" id="3478440">=</span>&nbsp;<span class="ident" id="3478442">decv</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478450">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3478461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478466">buf</span><span class="op" id="3478469">.</span><span class="ident" id="3478470">Reset</span><span class="op" id="3478475">(</span><span class="op" id="3478476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478480">valid</span>&nbsp;<span class="op" id="3478486">:=</span>&nbsp;<span class="builtintype" id="3478489">false</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478497">for</span>&nbsp;<span class="ident" id="3478501">n</span>&nbsp;<span class="op" id="3478503">:=</span>&nbsp;<span class="num" id="3478506">0</span><span class="op" id="3478507">;</span>&nbsp;<span class="op" id="3478509">;</span>&nbsp;<span class="ident" id="3478511">n</span><span class="op" id="3478512">++</span>&nbsp;<span class="op" id="3478515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478520">simplePart</span>&nbsp;<span class="op" id="3478531">:=</span>&nbsp;<span class="ident" id="3478534">fmt</span><span class="op" id="3478537">.</span><span class="ident" id="3478538">Sprintf</span><span class="op" id="3478545">(</span><span class="string" id="3478546">&#34;%s*%d&#34;</span><span class="op" id="3478553">,</span>&nbsp;<span class="ident" id="3478555">key</span><span class="op" id="3478558">,</span>&nbsp;<span class="ident" id="3478560">n</span><span class="op" id="3478561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478566">if</span>&nbsp;<span class="ident" id="3478569">v</span><span class="op" id="3478570">,</span>&nbsp;<span class="ident" id="3478572">ok</span>&nbsp;<span class="op" id="3478575">:=</span>&nbsp;<span class="ident" id="3478578">pieceMap</span><span class="op" id="3478586">[</span><span class="ident" id="3478587">simplePart</span><span class="op" id="3478597">]</span><span class="op" id="3478598">;</span>&nbsp;<span class="ident" id="3478600">ok</span>&nbsp;<span class="op" id="3478603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478609">valid</span>&nbsp;<span class="op" id="3478615">=</span>&nbsp;<span class="builtintype" id="3478617">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478626">buf</span><span class="op" id="3478629">.</span><span class="ident" id="3478630">WriteString</span><span class="op" id="3478641">(</span><span class="ident" id="3478642">v</span><span class="op" id="3478643">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478649">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3478661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478666">encodedPart</span>&nbsp;<span class="op" id="3478678">:=</span>&nbsp;<span class="ident" id="3478681">simplePart</span>&nbsp;<span class="op" id="3478692">+</span>&nbsp;<span class="string" id="3478694">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478701">if</span>&nbsp;<span class="ident" id="3478704">v</span><span class="op" id="3478705">,</span>&nbsp;<span class="ident" id="3478707">ok</span>&nbsp;<span class="op" id="3478710">:=</span>&nbsp;<span class="ident" id="3478713">pieceMap</span><span class="op" id="3478721">[</span><span class="ident" id="3478722">encodedPart</span><span class="op" id="3478733">]</span><span class="op" id="3478734">;</span>&nbsp;<span class="ident" id="3478736">ok</span>&nbsp;<span class="op" id="3478739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478745">valid</span>&nbsp;<span class="op" id="3478751">=</span>&nbsp;<span class="builtintype" id="3478753">true</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478762">if</span>&nbsp;<span class="ident" id="3478765">n</span>&nbsp;<span class="op" id="3478767">==</span>&nbsp;<span class="num" id="3478770">0</span>&nbsp;<span class="op" id="3478772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478779">buf</span><span class="op" id="3478782">.</span><span class="ident" id="3478783">WriteString</span><span class="op" id="3478794">(</span><span class="ident" id="3478795">decode2231Enc</span><span class="op" id="3478808">(</span><span class="ident" id="3478809">v</span><span class="op" id="3478810">)</span><span class="op" id="3478811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3478817">}</span>&nbsp;<span class="keyword" id="3478819">else</span>&nbsp;<span class="op" id="3478824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478831">decv</span><span class="op" id="3478835">,</span>&nbsp;<span class="ident" id="3478837">_</span>&nbsp;<span class="op" id="3478839">:=</span>&nbsp;<span class="ident" id="3478842">percentHexUnescape</span><span class="op" id="3478860">(</span><span class="ident" id="3478861">v</span><span class="op" id="3478862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478869">buf</span><span class="op" id="3478872">.</span><span class="ident" id="3478873">WriteString</span><span class="op" id="3478884">(</span><span class="ident" id="3478885">decv</span><span class="op" id="3478889">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3478895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3478900">}</span>&nbsp;<span class="keyword" id="3478902">else</span>&nbsp;<span class="op" id="3478907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478913">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3478922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3478926">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478930">if</span>&nbsp;<span class="ident" id="3478933">valid</span>&nbsp;<span class="op" id="3478939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478944">params</span><span class="op" id="3478950">[</span><span class="ident" id="3478951">key</span><span class="op" id="3478954">]</span>&nbsp;<span class="op" id="3478956">=</span>&nbsp;<span class="ident" id="3478958">buf</span><span class="op" id="3478961">.</span><span class="ident" id="3478962">String</span><span class="op" id="3478968">(</span><span class="op" id="3478969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3478973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3478976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478980">return</span><br>
<span class="lineno"></span><span class="op" id="3478987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3478990">func</span>&nbsp;<span class="ident" id="3478995">decode2231Enc</span><span class="op" id="3479008">(</span><span class="ident" id="3479009">v</span>&nbsp;<span class="builtintype" id="3479011">string</span><span class="op" id="3479017">)</span>&nbsp;<span class="builtintype" id="3479019">string</span>&nbsp;<span class="op" id="3479026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479029">sv</span>&nbsp;<span class="op" id="3479032">:=</span>&nbsp;<span class="ident" id="3479035">strings</span><span class="op" id="3479042">.</span><span class="ident" id="3479043">SplitN</span><span class="op" id="3479049">(</span><span class="ident" id="3479050">v</span><span class="op" id="3479051">,</span>&nbsp;<span class="string" id="3479053">&#34;&#39;&#34;</span><span class="op" id="3479056">,</span>&nbsp;<span class="num" id="3479058">3</span><span class="op" id="3479059">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479062">if</span>&nbsp;<span class="builtinfunc" id="3479065">len</span><span class="op" id="3479068">(</span><span class="ident" id="3479069">sv</span><span class="op" id="3479071">)</span>&nbsp;<span class="op" id="3479073">!=</span>&nbsp;<span class="num" id="3479076">3</span>&nbsp;<span class="op" id="3479078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479082">return</span>&nbsp;<span class="string" id="3479089">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3479093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3479096">//&nbsp;TODO:&nbsp;ignoring&nbsp;lang&nbsp;in&nbsp;sv[1]&nbsp;for&nbsp;now.&nbsp;If&nbsp;anybody&nbsp;needs&nbsp;it&nbsp;we&#39;ll</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3479164">//&nbsp;need&nbsp;to&nbsp;decide&nbsp;how&nbsp;to&nbsp;expose&nbsp;it&nbsp;in&nbsp;the&nbsp;API.&nbsp;But&nbsp;I&#39;m&nbsp;not&nbsp;sure</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3479229">//&nbsp;anybody&nbsp;uses&nbsp;it&nbsp;in&nbsp;practice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479262">charset</span>&nbsp;<span class="op" id="3479270">:=</span>&nbsp;<span class="ident" id="3479273">strings</span><span class="op" id="3479280">.</span><span class="ident" id="3479281">ToLower</span><span class="op" id="3479288">(</span><span class="ident" id="3479289">sv</span><span class="op" id="3479291">[</span><span class="num" id="3479292">0</span><span class="op" id="3479293">]</span><span class="op" id="3479294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479297">if</span>&nbsp;<span class="ident" id="3479300">charset</span>&nbsp;<span class="op" id="3479308">!=</span>&nbsp;<span class="string" id="3479311">&#34;us-ascii&#34;</span>&nbsp;<span class="op" id="3479322">&amp;&amp;</span>&nbsp;<span class="ident" id="3479325">charset</span>&nbsp;<span class="op" id="3479333">!=</span>&nbsp;<span class="string" id="3479336">&#34;utf-8&#34;</span>&nbsp;<span class="op" id="3479344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3479348">//&nbsp;TODO:&nbsp;unsupported&nbsp;encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479380">return</span>&nbsp;<span class="string" id="3479387">&#34;&#34;</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3479391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479394">encv</span><span class="op" id="3479398">,</span>&nbsp;<span class="ident" id="3479400">_</span>&nbsp;<span class="op" id="3479402">:=</span>&nbsp;<span class="ident" id="3479405">percentHexUnescape</span><span class="op" id="3479423">(</span><span class="ident" id="3479424">sv</span><span class="op" id="3479426">[</span><span class="num" id="3479427">2</span><span class="op" id="3479428">]</span><span class="op" id="3479429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479432">return</span>&nbsp;<span class="ident" id="3479439">encv</span><br>
<span class="lineno"></span><span class="op" id="3479444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="3479447">func</span>&nbsp;<span class="ident" id="3479452">isNotTokenChar</span><span class="op" id="3479466">(</span><span class="ident" id="3479467">r</span>&nbsp;<span class="builtintype" id="3479469">rune</span><span class="op" id="3479473">)</span>&nbsp;<span class="builtintype" id="3479475">bool</span>&nbsp;<span class="op" id="3479480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479483">return</span>&nbsp;<span class="op" id="3479490">!</span><span class="ident" id="3479491">isTokenChar</span><span class="op" id="3479502">(</span><span class="ident" id="3479503">r</span><span class="op" id="3479504">)</span><br>
<span class="lineno"></span><span class="op" id="3479506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3479509">//&nbsp;consumeToken&nbsp;consumes&nbsp;a&nbsp;token&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;provided</span><br>
<span class="lineno">220</span><span class="comment" id="3479573">//&nbsp;string,&nbsp;per&nbsp;RFC&nbsp;2045&nbsp;section&nbsp;5.1&nbsp;(referenced&nbsp;from&nbsp;2183),&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="3479644">//&nbsp;the&nbsp;token&nbsp;consumed&nbsp;and&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;string.&nbsp;&nbsp;Returns&nbsp;(&#34;&#34;,&nbsp;v)&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3479714">//&nbsp;failure&nbsp;to&nbsp;consume&nbsp;at&nbsp;least&nbsp;one&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="3479760">func</span>&nbsp;<span class="ident" id="3479765">consumeToken</span><span class="op" id="3479777">(</span><span class="ident" id="3479778">v</span>&nbsp;<span class="builtintype" id="3479780">string</span><span class="op" id="3479786">)</span>&nbsp;<span class="op" id="3479788">(</span><span class="ident" id="3479789">token</span><span class="op" id="3479794">,</span>&nbsp;<span class="ident" id="3479796">rest</span>&nbsp;<span class="builtintype" id="3479801">string</span><span class="op" id="3479807">)</span>&nbsp;<span class="op" id="3479809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479812">notPos</span>&nbsp;<span class="op" id="3479819">:=</span>&nbsp;<span class="ident" id="3479822">strings</span><span class="op" id="3479829">.</span><span class="ident" id="3479830">IndexFunc</span><span class="op" id="3479839">(</span><span class="ident" id="3479840">v</span><span class="op" id="3479841">,</span>&nbsp;<span class="ident" id="3479843">isNotTokenChar</span><span class="op" id="3479857">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479860">if</span>&nbsp;<span class="ident" id="3479863">notPos</span>&nbsp;<span class="op" id="3479870">==</span>&nbsp;<span class="op" id="3479873">-</span><span class="num" id="3479874">1</span>&nbsp;<span class="op" id="3479876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479880">return</span>&nbsp;<span class="ident" id="3479887">v</span><span class="op" id="3479888">,</span>&nbsp;<span class="string" id="3479890">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3479894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479897">if</span>&nbsp;<span class="ident" id="3479900">notPos</span>&nbsp;<span class="op" id="3479907">==</span>&nbsp;<span class="num" id="3479910">0</span>&nbsp;<span class="op" id="3479912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479916">return</span>&nbsp;<span class="string" id="3479923">&#34;&#34;</span><span class="op" id="3479925">,</span>&nbsp;<span class="ident" id="3479927">v</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3479930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479933">return</span>&nbsp;<span class="ident" id="3479940">v</span><span class="op" id="3479941">[</span><span class="num" id="3479942">0</span><span class="op" id="3479943">:</span><span class="ident" id="3479944">notPos</span><span class="op" id="3479950">]</span><span class="op" id="3479951">,</span>&nbsp;<span class="ident" id="3479953">v</span><span class="op" id="3479954">[</span><span class="ident" id="3479955">notPos</span><span class="op" id="3479961">:</span><span class="op" id="3479962">]</span><br>
<span class="lineno"></span><span class="op" id="3479964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3479967">//&nbsp;consumeValue&nbsp;consumes&nbsp;a&nbsp;&#34;value&#34;&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;where&nbsp;a&nbsp;value&nbsp;is</span><br>
<span class="lineno">235</span><span class="comment" id="3480033">//&nbsp;either&nbsp;a&nbsp;&#39;token&#39;&nbsp;or&nbsp;a&nbsp;&#39;quoted-string&#39;.&nbsp;&nbsp;On&nbsp;success,&nbsp;consumeValue</span><br>
<span class="lineno"></span><span class="comment" id="3480101">//&nbsp;returns&nbsp;the&nbsp;value&nbsp;consumed&nbsp;(and&nbsp;de-quoted/escaped,&nbsp;if&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3480160">//&nbsp;quoted-string)&nbsp;and&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;string.&nbsp;&nbsp;On&nbsp;failure,&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3480227">//&nbsp;(&#34;&#34;,&nbsp;v).</span><br>
<span class="lineno"></span><span class="keyword" id="3480239">func</span>&nbsp;<span class="ident" id="3480244">consumeValue</span><span class="op" id="3480256">(</span><span class="ident" id="3480257">v</span>&nbsp;<span class="builtintype" id="3480259">string</span><span class="op" id="3480265">)</span>&nbsp;<span class="op" id="3480267">(</span><span class="ident" id="3480268">value</span><span class="op" id="3480273">,</span>&nbsp;<span class="ident" id="3480275">rest</span>&nbsp;<span class="builtintype" id="3480280">string</span><span class="op" id="3480286">)</span>&nbsp;<span class="op" id="3480288">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480291">if</span>&nbsp;<span class="op" id="3480294">!</span><span class="ident" id="3480295">strings</span><span class="op" id="3480302">.</span><span class="ident" id="3480303">HasPrefix</span><span class="op" id="3480312">(</span><span class="ident" id="3480313">v</span><span class="op" id="3480314">,</span>&nbsp;<span class="string" id="3480316">`&#34;`</span><span class="op" id="3480319">)</span>&nbsp;<span class="op" id="3480321">&amp;&amp;</span>&nbsp;<span class="op" id="3480324">!</span><span class="ident" id="3480325">strings</span><span class="op" id="3480332">.</span><span class="ident" id="3480333">HasPrefix</span><span class="op" id="3480342">(</span><span class="ident" id="3480343">v</span><span class="op" id="3480344">,</span>&nbsp;<span class="string" id="3480346">`&#39;`</span><span class="op" id="3480349">)</span>&nbsp;<span class="op" id="3480351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480355">return</span>&nbsp;<span class="ident" id="3480362">consumeToken</span><span class="op" id="3480374">(</span><span class="ident" id="3480375">v</span><span class="op" id="3480376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3480379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480383">leadQuote</span>&nbsp;<span class="op" id="3480393">:=</span>&nbsp;<span class="builtintype" id="3480396">rune</span><span class="op" id="3480400">(</span><span class="ident" id="3480401">v</span><span class="op" id="3480402">[</span><span class="num" id="3480403">0</span><span class="op" id="3480404">]</span><span class="op" id="3480405">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3480409">//&nbsp;parse&nbsp;a&nbsp;quoted-string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480435">rest</span>&nbsp;<span class="op" id="3480440">=</span>&nbsp;<span class="ident" id="3480442">v</span><span class="op" id="3480443">[</span><span class="num" id="3480444">1</span><span class="op" id="3480445">:</span><span class="op" id="3480446">]</span>&nbsp;<span class="comment" id="3480448">//&nbsp;consume&nbsp;the&nbsp;leading&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480478">buffer</span>&nbsp;<span class="op" id="3480485">:=</span>&nbsp;<span class="builtinfunc" id="3480488">new</span><span class="op" id="3480491">(</span><span class="ident" id="3480492">bytes</span><span class="op" id="3480497">.</span><span class="ident" id="3480498">Buffer</span><span class="op" id="3480504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480507">var</span>&nbsp;<span class="ident" id="3480511">idx</span>&nbsp;<span class="builtintype" id="3480515">int</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480520">var</span>&nbsp;<span class="ident" id="3480524">r</span>&nbsp;<span class="builtintype" id="3480526">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480532">var</span>&nbsp;<span class="ident" id="3480536">nextIsLiteral</span>&nbsp;<span class="builtintype" id="3480550">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480556">for</span>&nbsp;<span class="ident" id="3480560">idx</span><span class="op" id="3480563">,</span>&nbsp;<span class="ident" id="3480565">r</span>&nbsp;<span class="op" id="3480567">=</span>&nbsp;<span class="keyword" id="3480569">range</span>&nbsp;<span class="ident" id="3480575">rest</span>&nbsp;<span class="op" id="3480580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480584">switch</span>&nbsp;<span class="op" id="3480591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480595">case</span>&nbsp;<span class="ident" id="3480600">nextIsLiteral</span><span class="op" id="3480613">:</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480618">buffer</span><span class="op" id="3480624">.</span><span class="ident" id="3480625">WriteRune</span><span class="op" id="3480634">(</span><span class="ident" id="3480635">r</span><span class="op" id="3480636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480641">nextIsLiteral</span>&nbsp;<span class="op" id="3480655">=</span>&nbsp;<span class="builtintype" id="3480657">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480665">case</span>&nbsp;<span class="ident" id="3480670">r</span>&nbsp;<span class="op" id="3480672">==</span>&nbsp;<span class="ident" id="3480675">leadQuote</span><span class="op" id="3480684">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480689">return</span>&nbsp;<span class="ident" id="3480696">buffer</span><span class="op" id="3480702">.</span><span class="ident" id="3480703">String</span><span class="op" id="3480709">(</span><span class="op" id="3480710">)</span><span class="op" id="3480711">,</span>&nbsp;<span class="ident" id="3480713">rest</span><span class="op" id="3480717">[</span><span class="ident" id="3480718">idx</span><span class="op" id="3480721">+</span><span class="num" id="3480722">1</span><span class="op" id="3480723">:</span><span class="op" id="3480724">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480728">case</span>&nbsp;<span class="ident" id="3480733">r</span>&nbsp;<span class="op" id="3480735">==</span>&nbsp;<span class="string" id="3480738">&#39;\\&#39;</span><span class="op" id="3480742">:</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480747">nextIsLiteral</span>&nbsp;<span class="op" id="3480761">=</span>&nbsp;<span class="builtintype" id="3480763">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480770">case</span>&nbsp;<span class="ident" id="3480775">r</span>&nbsp;<span class="op" id="3480777">!=</span>&nbsp;<span class="string" id="3480780">&#39;\r&#39;</span>&nbsp;<span class="op" id="3480785">&amp;&amp;</span>&nbsp;<span class="ident" id="3480788">r</span>&nbsp;<span class="op" id="3480790">!=</span>&nbsp;<span class="string" id="3480793">&#39;\n&#39;</span><span class="op" id="3480797">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480802">buffer</span><span class="op" id="3480808">.</span><span class="ident" id="3480809">WriteRune</span><span class="op" id="3480818">(</span><span class="ident" id="3480819">r</span><span class="op" id="3480820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480824">default</span><span class="op" id="3480831">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480836">return</span>&nbsp;<span class="string" id="3480843">&#34;&#34;</span><span class="op" id="3480845">,</span>&nbsp;<span class="ident" id="3480847">v</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3480851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3480854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480857">return</span>&nbsp;<span class="string" id="3480864">&#34;&#34;</span><span class="op" id="3480866">,</span>&nbsp;<span class="ident" id="3480868">v</span><br>
<span class="lineno"></span><span class="op" id="3480870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="keyword" id="3480873">func</span>&nbsp;<span class="ident" id="3480878">consumeMediaParam</span><span class="op" id="3480895">(</span><span class="ident" id="3480896">v</span>&nbsp;<span class="builtintype" id="3480898">string</span><span class="op" id="3480904">)</span>&nbsp;<span class="op" id="3480906">(</span><span class="ident" id="3480907">param</span><span class="op" id="3480912">,</span>&nbsp;<span class="ident" id="3480914">value</span><span class="op" id="3480919">,</span>&nbsp;<span class="ident" id="3480921">rest</span>&nbsp;<span class="builtintype" id="3480926">string</span><span class="op" id="3480932">)</span>&nbsp;<span class="op" id="3480934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480937">rest</span>&nbsp;<span class="op" id="3480942">=</span>&nbsp;<span class="ident" id="3480944">strings</span><span class="op" id="3480951">.</span><span class="ident" id="3480952">TrimLeftFunc</span><span class="op" id="3480964">(</span><span class="ident" id="3480965">v</span><span class="op" id="3480966">,</span>&nbsp;<span class="ident" id="3480968">unicode</span><span class="op" id="3480975">.</span><span class="ident" id="3480976">IsSpace</span><span class="op" id="3480983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480986">if</span>&nbsp;<span class="op" id="3480989">!</span><span class="ident" id="3480990">strings</span><span class="op" id="3480997">.</span><span class="ident" id="3480998">HasPrefix</span><span class="op" id="3481007">(</span><span class="ident" id="3481008">rest</span><span class="op" id="3481012">,</span>&nbsp;<span class="string" id="3481014">&#34;;&#34;</span><span class="op" id="3481017">)</span>&nbsp;<span class="op" id="3481019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481023">return</span>&nbsp;<span class="string" id="3481030">&#34;&#34;</span><span class="op" id="3481032">,</span>&nbsp;<span class="string" id="3481034">&#34;&#34;</span><span class="op" id="3481036">,</span>&nbsp;<span class="ident" id="3481038">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3481041">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481045">rest</span>&nbsp;<span class="op" id="3481050">=</span>&nbsp;<span class="ident" id="3481052">rest</span><span class="op" id="3481056">[</span><span class="num" id="3481057">1</span><span class="op" id="3481058">:</span><span class="op" id="3481059">]</span>&nbsp;<span class="comment" id="3481061">//&nbsp;consume&nbsp;semicolon</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481083">rest</span>&nbsp;<span class="op" id="3481088">=</span>&nbsp;<span class="ident" id="3481090">strings</span><span class="op" id="3481097">.</span><span class="ident" id="3481098">TrimLeftFunc</span><span class="op" id="3481110">(</span><span class="ident" id="3481111">rest</span><span class="op" id="3481115">,</span>&nbsp;<span class="ident" id="3481117">unicode</span><span class="op" id="3481124">.</span><span class="ident" id="3481125">IsSpace</span><span class="op" id="3481132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481135">param</span><span class="op" id="3481140">,</span>&nbsp;<span class="ident" id="3481142">rest</span>&nbsp;<span class="op" id="3481147">=</span>&nbsp;<span class="ident" id="3481149">consumeToken</span><span class="op" id="3481161">(</span><span class="ident" id="3481162">rest</span><span class="op" id="3481166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481169">param</span>&nbsp;<span class="op" id="3481175">=</span>&nbsp;<span class="ident" id="3481177">strings</span><span class="op" id="3481184">.</span><span class="ident" id="3481185">ToLower</span><span class="op" id="3481192">(</span><span class="ident" id="3481193">param</span><span class="op" id="3481198">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481201">if</span>&nbsp;<span class="ident" id="3481204">param</span>&nbsp;<span class="op" id="3481210">==</span>&nbsp;<span class="string" id="3481213">&#34;&#34;</span>&nbsp;<span class="op" id="3481216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481220">return</span>&nbsp;<span class="string" id="3481227">&#34;&#34;</span><span class="op" id="3481229">,</span>&nbsp;<span class="string" id="3481231">&#34;&#34;</span><span class="op" id="3481233">,</span>&nbsp;<span class="ident" id="3481235">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3481238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481242">rest</span>&nbsp;<span class="op" id="3481247">=</span>&nbsp;<span class="ident" id="3481249">strings</span><span class="op" id="3481256">.</span><span class="ident" id="3481257">TrimLeftFunc</span><span class="op" id="3481269">(</span><span class="ident" id="3481270">rest</span><span class="op" id="3481274">,</span>&nbsp;<span class="ident" id="3481276">unicode</span><span class="op" id="3481283">.</span><span class="ident" id="3481284">IsSpace</span><span class="op" id="3481291">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481294">if</span>&nbsp;<span class="op" id="3481297">!</span><span class="ident" id="3481298">strings</span><span class="op" id="3481305">.</span><span class="ident" id="3481306">HasPrefix</span><span class="op" id="3481315">(</span><span class="ident" id="3481316">rest</span><span class="op" id="3481320">,</span>&nbsp;<span class="string" id="3481322">&#34;=&#34;</span><span class="op" id="3481325">)</span>&nbsp;<span class="op" id="3481327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481331">return</span>&nbsp;<span class="string" id="3481338">&#34;&#34;</span><span class="op" id="3481340">,</span>&nbsp;<span class="string" id="3481342">&#34;&#34;</span><span class="op" id="3481344">,</span>&nbsp;<span class="ident" id="3481346">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3481349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481352">rest</span>&nbsp;<span class="op" id="3481357">=</span>&nbsp;<span class="ident" id="3481359">rest</span><span class="op" id="3481363">[</span><span class="num" id="3481364">1</span><span class="op" id="3481365">:</span><span class="op" id="3481366">]</span>&nbsp;<span class="comment" id="3481368">//&nbsp;consume&nbsp;equals&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481392">rest</span>&nbsp;<span class="op" id="3481397">=</span>&nbsp;<span class="ident" id="3481399">strings</span><span class="op" id="3481406">.</span><span class="ident" id="3481407">TrimLeftFunc</span><span class="op" id="3481419">(</span><span class="ident" id="3481420">rest</span><span class="op" id="3481424">,</span>&nbsp;<span class="ident" id="3481426">unicode</span><span class="op" id="3481433">.</span><span class="ident" id="3481434">IsSpace</span><span class="op" id="3481441">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481444">value</span><span class="op" id="3481449">,</span>&nbsp;<span class="ident" id="3481451">rest</span>&nbsp;<span class="op" id="3481456">=</span>&nbsp;<span class="ident" id="3481458">consumeValue</span><span class="op" id="3481470">(</span><span class="ident" id="3481471">rest</span><span class="op" id="3481475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481478">if</span>&nbsp;<span class="ident" id="3481481">value</span>&nbsp;<span class="op" id="3481487">==</span>&nbsp;<span class="string" id="3481490">&#34;&#34;</span>&nbsp;<span class="op" id="3481493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481497">return</span>&nbsp;<span class="string" id="3481504">&#34;&#34;</span><span class="op" id="3481506">,</span>&nbsp;<span class="string" id="3481508">&#34;&#34;</span><span class="op" id="3481510">,</span>&nbsp;<span class="ident" id="3481512">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3481515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481518">return</span>&nbsp;<span class="ident" id="3481525">param</span><span class="op" id="3481530">,</span>&nbsp;<span class="ident" id="3481532">value</span><span class="op" id="3481537">,</span>&nbsp;<span class="ident" id="3481539">rest</span><br>
<span class="lineno">295</span><span class="op" id="3481544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3481547">func</span>&nbsp;<span class="ident" id="3481552">percentHexUnescape</span><span class="op" id="3481570">(</span><span class="ident" id="3481571">s</span>&nbsp;<span class="builtintype" id="3481573">string</span><span class="op" id="3481579">)</span>&nbsp;<span class="op" id="3481581">(</span><span class="builtintype" id="3481582">string</span><span class="op" id="3481588">,</span>&nbsp;<span class="builtintype" id="3481590">error</span><span class="op" id="3481595">)</span>&nbsp;<span class="op" id="3481597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481600">//&nbsp;Count&nbsp;%,&nbsp;check&nbsp;that&nbsp;they&#39;re&nbsp;well-formed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481645">percents</span>&nbsp;<span class="op" id="3481654">:=</span>&nbsp;<span class="num" id="3481657">0</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481660">for</span>&nbsp;<span class="ident" id="3481664">i</span>&nbsp;<span class="op" id="3481666">:=</span>&nbsp;<span class="num" id="3481669">0</span><span class="op" id="3481670">;</span>&nbsp;<span class="ident" id="3481672">i</span>&nbsp;<span class="op" id="3481674">&lt;</span>&nbsp;<span class="builtinfunc" id="3481676">len</span><span class="op" id="3481679">(</span><span class="ident" id="3481680">s</span><span class="op" id="3481681">)</span><span class="op" id="3481682">;</span>&nbsp;<span class="op" id="3481684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481688">if</span>&nbsp;<span class="ident" id="3481691">s</span><span class="op" id="3481692">[</span><span class="ident" id="3481693">i</span><span class="op" id="3481694">]</span>&nbsp;<span class="op" id="3481696">!=</span>&nbsp;<span class="string" id="3481699">&#39;%&#39;</span>&nbsp;<span class="op" id="3481703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481708">i</span><span class="op" id="3481709">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481715">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3481726">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481730">percents</span><span class="op" id="3481738">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481743">if</span>&nbsp;<span class="ident" id="3481746">i</span><span class="op" id="3481747">+</span><span class="num" id="3481748">2</span>&nbsp;<span class="op" id="3481750">&gt;=</span>&nbsp;<span class="builtinfunc" id="3481753">len</span><span class="op" id="3481756">(</span><span class="ident" id="3481757">s</span><span class="op" id="3481758">)</span>&nbsp;<span class="op" id="3481760">||</span>&nbsp;<span class="op" id="3481763">!</span><span class="ident" id="3481764">ishex</span><span class="op" id="3481769">(</span><span class="ident" id="3481770">s</span><span class="op" id="3481771">[</span><span class="ident" id="3481772">i</span><span class="op" id="3481773">+</span><span class="num" id="3481774">1</span><span class="op" id="3481775">]</span><span class="op" id="3481776">)</span>&nbsp;<span class="op" id="3481778">||</span>&nbsp;<span class="op" id="3481781">!</span><span class="ident" id="3481782">ishex</span><span class="op" id="3481787">(</span><span class="ident" id="3481788">s</span><span class="op" id="3481789">[</span><span class="ident" id="3481790">i</span><span class="op" id="3481791">+</span><span class="num" id="3481792">2</span><span class="op" id="3481793">]</span><span class="op" id="3481794">)</span>&nbsp;<span class="op" id="3481796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481801">s</span>&nbsp;<span class="op" id="3481803">=</span>&nbsp;<span class="ident" id="3481805">s</span><span class="op" id="3481806">[</span><span class="ident" id="3481807">i</span><span class="op" id="3481808">:</span><span class="op" id="3481809">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481814">if</span>&nbsp;<span class="builtinfunc" id="3481817">len</span><span class="op" id="3481820">(</span><span class="ident" id="3481821">s</span><span class="op" id="3481822">)</span>&nbsp;<span class="op" id="3481824">&gt;</span>&nbsp;<span class="num" id="3481826">3</span>&nbsp;<span class="op" id="3481828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481834">s</span>&nbsp;<span class="op" id="3481836">=</span>&nbsp;<span class="ident" id="3481838">s</span><span class="op" id="3481839">[</span><span class="num" id="3481840">0</span><span class="op" id="3481841">:</span><span class="num" id="3481842">3</span><span class="op" id="3481843">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3481848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481853">return</span>&nbsp;<span class="string" id="3481860">&#34;&#34;</span><span class="op" id="3481862">,</span>&nbsp;<span class="ident" id="3481864">fmt</span><span class="op" id="3481867">.</span><span class="ident" id="3481868">Errorf</span><span class="op" id="3481874">(</span><span class="string" id="3481875">&#34;mime:&nbsp;bogus&nbsp;characters&nbsp;after&nbsp;%%:&nbsp;%q&#34;</span><span class="op" id="3481912">,</span>&nbsp;<span class="ident" id="3481914">s</span><span class="op" id="3481915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3481919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481923">i</span>&nbsp;<span class="op" id="3481925">+=</span>&nbsp;<span class="num" id="3481928">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3481931">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481934">if</span>&nbsp;<span class="ident" id="3481937">percents</span>&nbsp;<span class="op" id="3481946">==</span>&nbsp;<span class="num" id="3481949">0</span>&nbsp;<span class="op" id="3481951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481955">return</span>&nbsp;<span class="ident" id="3481962">s</span><span class="op" id="3481963">,</span>&nbsp;<span class="ident" id="3481965">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3481970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481974">t</span>&nbsp;<span class="op" id="3481976">:=</span>&nbsp;<span class="builtinfunc" id="3481979">make</span><span class="op" id="3481983">(</span><span class="op" id="3481984">[</span><span class="op" id="3481985">]</span><span class="builtintype" id="3481986">byte</span><span class="op" id="3481990">,</span>&nbsp;<span class="builtinfunc" id="3481992">len</span><span class="op" id="3481995">(</span><span class="ident" id="3481996">s</span><span class="op" id="3481997">)</span><span class="op" id="3481998">-</span><span class="num" id="3481999">2</span><span class="op" id="3482000">*</span><span class="ident" id="3482001">percents</span><span class="op" id="3482009">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482012">j</span>&nbsp;<span class="op" id="3482014">:=</span>&nbsp;<span class="num" id="3482017">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482020">for</span>&nbsp;<span class="ident" id="3482024">i</span>&nbsp;<span class="op" id="3482026">:=</span>&nbsp;<span class="num" id="3482029">0</span><span class="op" id="3482030">;</span>&nbsp;<span class="ident" id="3482032">i</span>&nbsp;<span class="op" id="3482034">&lt;</span>&nbsp;<span class="builtinfunc" id="3482036">len</span><span class="op" id="3482039">(</span><span class="ident" id="3482040">s</span><span class="op" id="3482041">)</span><span class="op" id="3482042">;</span>&nbsp;<span class="op" id="3482044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482048">switch</span>&nbsp;<span class="ident" id="3482055">s</span><span class="op" id="3482056">[</span><span class="ident" id="3482057">i</span><span class="op" id="3482058">]</span>&nbsp;<span class="op" id="3482060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482064">case</span>&nbsp;<span class="string" id="3482069">&#39;%&#39;</span><span class="op" id="3482072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482077">t</span><span class="op" id="3482078">[</span><span class="ident" id="3482079">j</span><span class="op" id="3482080">]</span>&nbsp;<span class="op" id="3482082">=</span>&nbsp;<span class="ident" id="3482084">unhex</span><span class="op" id="3482089">(</span><span class="ident" id="3482090">s</span><span class="op" id="3482091">[</span><span class="ident" id="3482092">i</span><span class="op" id="3482093">+</span><span class="num" id="3482094">1</span><span class="op" id="3482095">]</span><span class="op" id="3482096">)</span><span class="op" id="3482097">&lt;&lt;</span><span class="num" id="3482099">4</span>&nbsp;<span class="op" id="3482101">|</span>&nbsp;<span class="ident" id="3482103">unhex</span><span class="op" id="3482108">(</span><span class="ident" id="3482109">s</span><span class="op" id="3482110">[</span><span class="ident" id="3482111">i</span><span class="op" id="3482112">+</span><span class="num" id="3482113">2</span><span class="op" id="3482114">]</span><span class="op" id="3482115">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482120">j</span><span class="op" id="3482121">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482127">i</span>&nbsp;<span class="op" id="3482129">+=</span>&nbsp;<span class="num" id="3482132">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482136">default</span><span class="op" id="3482143">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482148">t</span><span class="op" id="3482149">[</span><span class="ident" id="3482150">j</span><span class="op" id="3482151">]</span>&nbsp;<span class="op" id="3482153">=</span>&nbsp;<span class="ident" id="3482155">s</span><span class="op" id="3482156">[</span><span class="ident" id="3482157">i</span><span class="op" id="3482158">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482163">j</span><span class="op" id="3482164">++</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482170">i</span><span class="op" id="3482171">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3482176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3482179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482182">return</span>&nbsp;<span class="builtintype" id="3482189">string</span><span class="op" id="3482195">(</span><span class="ident" id="3482196">t</span><span class="op" id="3482197">)</span><span class="op" id="3482198">,</span>&nbsp;<span class="ident" id="3482200">nil</span><br>
<span class="lineno"></span><span class="op" id="3482204">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="keyword" id="3482207">func</span>&nbsp;<span class="ident" id="3482212">ishex</span><span class="op" id="3482217">(</span><span class="ident" id="3482218">c</span>&nbsp;<span class="builtintype" id="3482220">byte</span><span class="op" id="3482224">)</span>&nbsp;<span class="builtintype" id="3482226">bool</span>&nbsp;<span class="op" id="3482231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482234">switch</span>&nbsp;<span class="op" id="3482241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482244">case</span>&nbsp;<span class="string" id="3482249">&#39;0&#39;</span>&nbsp;<span class="op" id="3482253">&lt;=</span>&nbsp;<span class="ident" id="3482256">c</span>&nbsp;<span class="op" id="3482258">&amp;&amp;</span>&nbsp;<span class="ident" id="3482261">c</span>&nbsp;<span class="op" id="3482263">&lt;=</span>&nbsp;<span class="string" id="3482266">&#39;9&#39;</span><span class="op" id="3482269">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482273">return</span>&nbsp;<span class="builtintype" id="3482280">true</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482286">case</span>&nbsp;<span class="string" id="3482291">&#39;a&#39;</span>&nbsp;<span class="op" id="3482295">&lt;=</span>&nbsp;<span class="ident" id="3482298">c</span>&nbsp;<span class="op" id="3482300">&amp;&amp;</span>&nbsp;<span class="ident" id="3482303">c</span>&nbsp;<span class="op" id="3482305">&lt;=</span>&nbsp;<span class="string" id="3482308">&#39;f&#39;</span><span class="op" id="3482311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482315">return</span>&nbsp;<span class="builtintype" id="3482322">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482328">case</span>&nbsp;<span class="string" id="3482333">&#39;A&#39;</span>&nbsp;<span class="op" id="3482337">&lt;=</span>&nbsp;<span class="ident" id="3482340">c</span>&nbsp;<span class="op" id="3482342">&amp;&amp;</span>&nbsp;<span class="ident" id="3482345">c</span>&nbsp;<span class="op" id="3482347">&lt;=</span>&nbsp;<span class="string" id="3482350">&#39;F&#39;</span><span class="op" id="3482353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482357">return</span>&nbsp;<span class="builtintype" id="3482364">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3482370">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482373">return</span>&nbsp;<span class="builtintype" id="3482380">false</span><br>
<span class="lineno"></span><span class="op" id="3482386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3482389">func</span>&nbsp;<span class="ident" id="3482394">unhex</span><span class="op" id="3482399">(</span><span class="ident" id="3482400">c</span>&nbsp;<span class="builtintype" id="3482402">byte</span><span class="op" id="3482406">)</span>&nbsp;<span class="builtintype" id="3482408">byte</span>&nbsp;<span class="op" id="3482413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482416">switch</span>&nbsp;<span class="op" id="3482423">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482426">case</span>&nbsp;<span class="string" id="3482431">&#39;0&#39;</span>&nbsp;<span class="op" id="3482435">&lt;=</span>&nbsp;<span class="ident" id="3482438">c</span>&nbsp;<span class="op" id="3482440">&amp;&amp;</span>&nbsp;<span class="ident" id="3482443">c</span>&nbsp;<span class="op" id="3482445">&lt;=</span>&nbsp;<span class="string" id="3482448">&#39;9&#39;</span><span class="op" id="3482451">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482455">return</span>&nbsp;<span class="ident" id="3482462">c</span>&nbsp;<span class="op" id="3482464">-</span>&nbsp;<span class="string" id="3482466">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482471">case</span>&nbsp;<span class="string" id="3482476">&#39;a&#39;</span>&nbsp;<span class="op" id="3482480">&lt;=</span>&nbsp;<span class="ident" id="3482483">c</span>&nbsp;<span class="op" id="3482485">&amp;&amp;</span>&nbsp;<span class="ident" id="3482488">c</span>&nbsp;<span class="op" id="3482490">&lt;=</span>&nbsp;<span class="string" id="3482493">&#39;f&#39;</span><span class="op" id="3482496">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482500">return</span>&nbsp;<span class="ident" id="3482507">c</span>&nbsp;<span class="op" id="3482509">-</span>&nbsp;<span class="string" id="3482511">&#39;a&#39;</span>&nbsp;<span class="op" id="3482515">+</span>&nbsp;<span class="num" id="3482517">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482521">case</span>&nbsp;<span class="string" id="3482526">&#39;A&#39;</span>&nbsp;<span class="op" id="3482530">&lt;=</span>&nbsp;<span class="ident" id="3482533">c</span>&nbsp;<span class="op" id="3482535">&amp;&amp;</span>&nbsp;<span class="ident" id="3482538">c</span>&nbsp;<span class="op" id="3482540">&lt;=</span>&nbsp;<span class="string" id="3482543">&#39;F&#39;</span><span class="op" id="3482546">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482550">return</span>&nbsp;<span class="ident" id="3482557">c</span>&nbsp;<span class="op" id="3482559">-</span>&nbsp;<span class="string" id="3482561">&#39;A&#39;</span>&nbsp;<span class="op" id="3482565">+</span>&nbsp;<span class="num" id="3482567">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3482571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482574">return</span>&nbsp;<span class="num" id="3482581">0</span><br>
<span class="lineno"></span><span class="op" id="3482583">}</span>
</div>
</body>
</html>
